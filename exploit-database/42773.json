{
    "source": "exploit-database", 
    "exploit": "IyAjICMgIyAjIA0KIyBFeHBsb2l0IFRpdGxlOiBDbGF5ZGlwIExhcmF2ZWwgQWlyYm5iIENsb25lIDEuMCAtIEFyYml0cmFyeSBGaWxlIFVwbG9hZA0KIyBEb3JrOiBOL0ENCiMgRGF0ZTogMjIuMDkuMjAxNw0KIyBWZW5kb3IgSG9tZXBhZ2U6IGh0dHBzOi8vd3d3LmNsYXlkaXAuY29tLw0KIyBTb2Z0d2FyZSBMaW5rOiBodHRwczovL3d3dy5jbGF5ZGlwLmNvbS9haXJibmItY2xvbmUuaHRtbA0KIyBEZW1vOiBodHRwczovL3d3dy5jbGF5ZGlwLmNvbS9haXJibmJfZGVtby5odG1sDQojIFZlcnNpb246IE4vQQ0KIyBDYXRlZ29yeTogV2ViYXBwcw0KIyBUZXN0ZWQgb246IFdpTjdfeDY0L0thTGlMaW51WF94NjQNCiMgQ1ZFOiBDVkUtMjAxNy0xNDcwNA0KIyAjICMgIyAjDQojIEV4cGxvaXQgQXV0aG9yOiBJaHNhbiBTZW5jYW4NCiMgQXV0aG9yIFdlYjogaHR0cDovL2loc2FuLm5ldA0KIyBBdXRob3IgU29jaWFsOiBAaWhzYW5zZW5jYW4NCiMgIyAjICMgIw0KIyBEZXNjcmlwdGlvbjoNCiMgDQojIFRoZSB2dWxuZXJhYmlsaXR5IGFsbG93cyBhbiB1c2VycyB1cGxvYWQgYXJiaXRyYXJ5IGZpbGUuLi4uDQojIA0KIyBWdWxuZXJhYmxlIFNvdXJjZToNCiMNCiMgLi4uLi4uLi4uLi4uLjENCiMgICAgcHVibGljIGZ1bmN0aW9uIGltYWdlU3VibWl0KFJlcXVlc3QgJHJlcXVlc3QpDQojICAgIHsNCiAgICAgICAgJHRoaXMtPnZhbGlkYXRlKCRyZXF1ZXN0LCBbDQogICAgICAgICAgICAnaW1hZ2UnID0+ICdpbWFnZXxtaW1lczpqcGVnLHBuZyxqcGcsZ2lmLHN2Z3xtYXg6MjA0OCcsDQogICAgICAgIF0pOw0KIyAgICAgICAgaWYgKCRyZXF1ZXN0LT5oYXNGaWxlKCdwcm9maWxlX2ltZ19uYW1lJykpIHsNCiMgICAgICAgICAgICAkZmlsZSA9ICRyZXF1ZXN0LT5maWxlKCdwcm9maWxlX2ltZ19uYW1lJyk7DQojICAgICAgICAgICAgLy9nZXR0aW5nIHRpbWVzdGFtcA0KIyAgICAgICAgICAgICR0aW1lc3RhbXAgPSBzdHJfcmVwbGFjZShbJyAnLCAnOiddLCAnLScsIENhcmJvbjo6bm93KCktPnRvRGF0ZVRpbWVTdHJpbmcoKSk7DQojICAgICAgICAgICAgJGltZ19uYW1lID0gJHRpbWVzdGFtcC4gJy0nIC4kZmlsZS0+Z2V0Q2xpZW50T3JpZ2luYWxOYW1lKCk7DQojICAgICAgICAgICAgLy8kaW1hZ2UtPmZpbGVQYXRoID0gJGltZ19uYW1lOw0KIyAgICAgICAgICAgICRmaWxlLT5tb3ZlKHB1YmxpY19wYXRoKCkuJy9pbWFnZXMvcHJvZmlsZScsICRpbWdfbmFtZSk7DQojICAgICAgICAgICAgJHBvc3REYXRhID0gYXJyYXkoJ3Byb2ZpbGVfaW1nX25hbWUnID0+ICRpbWdfbmFtZSwgJ3Byb2ZpbGVfcGhvdG9fYXBwcm92ZScgPT4gMCk7DQojICAgICAgICAgICAgJHVzZXIgPSAkdGhpcy0+dXNlclJlcG9zaXRvcnktPnVwZGF0ZVVzZXIoJHBvc3REYXRhKTsNCiMgICAgICAgICAgICBmbGFzaCgnUHJvZmlsZSBJbWFnZSBVcGRhdGVkIFN1Y2Nlc3NmdWxseScsICdzdWNjZXNzJyk7DQojICAgICAgICAgICAgaWYoJHJlcXVlc3QtPmdldCgndXBsb2FkcGFnZScpID09IDIpIHsNCiMgICAgICAgICAgICAgICAgcmV0dXJuIFxSZWRpcmVjdDo6dG8oJ3VzZXIvZWRpdC91cGxvYWRwaG90bycpOw0KIyAgICAgICAgICAgIH0NCiMgICAgICAgICAgICByZXR1cm4gXFJlZGlyZWN0Ojp0bygndXNlci9kYXNoYm9hcmQnKTsNCiMgICAgICAgIH0NCiMNCiMgICAgfQ0KIyAuLi4uLi4uLi4uLi4uMg0KIyAgICBwdWJsaWMgZnVuY3Rpb24gcHJvb2Zfc3VibWl0KFJlcXVlc3QgJHJlcXVlc3QpDQojICAgIHsNCiMgICAgICAgIGlmICgkcmVxdWVzdC0+aGFzRmlsZSgncHJvZmlsZV9pbWdfbmFtZScpKSB7DQojICAgICAgICAgICAgJGZpbGUgPSAkcmVxdWVzdC0+ZmlsZSgncHJvZmlsZV9pbWdfbmFtZScpOw0KIyAgICAgICAgICAgIC8vZ2V0dGluZyB0aW1lc3RhbXANCiMgICAgICAgICAgICAkdGltZXN0YW1wID0gc3RyX3JlcGxhY2UoWycgJywgJzonXSwgJy0nLCBDYXJib246Om5vdygpLT50b0RhdGVUaW1lU3RyaW5nKCkpOw0KIyAgICAgICAgICAgICRpbWdfbmFtZSA9ICR0aW1lc3RhbXAuICctJyAuJGZpbGUtPmdldENsaWVudE9yaWdpbmFsTmFtZSgpOw0KIyAgICAgICAgICAgIC8vJGltYWdlLT5maWxlUGF0aCA9ICRpbWdfbmFtZTsNCiMgICAgICAgICAgICAkZmlsZS0+bW92ZShwdWJsaWNfcGF0aCgpLicvaW1hZ2VzL3Byb29mJywgJGltZ19uYW1lKTsNCiMgICAgICAgICAgICAkcG9zdERhdGEgPSBhcnJheSgnaWRwcm9vZl9pbWdfc3JjJyA9PiAkaW1nX25hbWUsICdpZF9wcm9vZl9hcHByb3ZlZCcgPT4gMCk7DQojICAgICAgICAgICAgJHVzZXIgPSAkdGhpcy0+dXNlclJlcG9zaXRvcnktPnVwZGF0ZVVzZXIoJHBvc3REYXRhKTsNCiMgICAgICAgICAgICBmbGFzaCgnUHJvb2YgVXBkYXRlZCBTdWNjZXNzZnVsbHknLCAnc3VjY2VzcycpOw0KIyAgICAgICAgICAgIHJldHVybiBcUmVkaXJlY3Q6OnRvKCd1c2VyL2VkaXQvdXBsb2FkcHJvb2YnKTsNCiMgICAgICAgIH0NCiMNCiMgICAgfQ0KIyAuLi4uLi4uLi4uLi4uDQojDQojIFByb29mIG9mIENvbmNlcHQ6IA0KIyANCiMgaHR0cDovL2xvY2FsaG9zdC9bUEFUSF0vdXNlci9lZGl0L3VwbG9hZHBob3RvDQojIGh0dHA6Ly9sb2NhbGhvc3QvW1BBVEhdL3VzZXIvZWRpdC91cGxvYWRwcm9vZg0KIyANCiMgaHR0cDovL2xvY2FsaG9zdC9bUEFUSF0vaW1hZ2VzL3Byb2ZpbGUvWyR0aW1lc3RhbXBdLlBocA0KIyANCiMgRXRjLi4NCiMgIyAjICMgIw==", 
    "filename": "platforms/php/webapps/42773.txt", 
    "id": "42773", 
    "cves": [
        "CVE-2017-14704"
    ]
}