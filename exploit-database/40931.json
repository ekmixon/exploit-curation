{
    "source": "exploit-database", 
    "exploit": "U291cmNlOiBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvcHJvamVjdC16ZXJvL2lzc3Vlcy9kZXRhaWw/aWQ9OTY1DQoNCnNldF9kcF9jb250cm9sX3BvcnQgaXMgYSBNSUcgbWV0aG9kIG9uIHRoZSBob3N0X3ByaXZfcG9ydCBzbyB0aGlzIGJ1ZyBpcyBhIHJvb3QtPmtlcm5lbCBlc2NhbGF0aW9uLg0KDQogIGtlcm5fcmV0dXJuX3QNCiAgc2V0X2RwX2NvbnRyb2xfcG9ydCgNCiAgICBob3N0X3ByaXZfdCBob3N0X3ByaXYsDQogICAgaXBjX3BvcnRfdCAgY29udHJvbF9wb3J0KSANCiAgew0KICAgICAgICAgIGlmIChob3N0X3ByaXYgPT0gSE9TVF9QUklWX05VTEwpDQogICAgICAgICAgICAgICAgICByZXR1cm4gKEtFUk5fSU5WQUxJRF9IT1NUKTsNCg0KICAgIGlmIChJUF9WQUxJRChkeW5hbWljX3BhZ2VyX2NvbnRyb2xfcG9ydCkpDQogICAgICBpcGNfcG9ydF9yZWxlYXNlX3NlbmQoZHluYW1pY19wYWdlcl9jb250cm9sX3BvcnQpOw0KDQogICAgZHluYW1pY19wYWdlcl9jb250cm9sX3BvcnQgPSBjb250cm9sX3BvcnQ7DQogICAgcmV0dXJuIEtFUk5fU1VDQ0VTUzsNCiAgfQ0KDQpUaGlzIHNob3VsZCBiZSBhbiBhdG9taWMgb3BlcmF0aW9uOyB0aGVyZSdzIG5vIGxvY2tpbmcgc28gdHdvIHRocmVhZHMgY2FuIHJhY2UgdG8gc2VlIHRoZSBzYW1lIHZhbHVlIGZvcg0KZHluYW1pY19wYWdlcl9jb250cm9sX3BvcnQgYW5kIHJlbGVhc2UgdHdvIHJlZmVyZW5jZXMgd2hlbiB0aGUga2VybmVsIG9ubHkgaG9sZHMgb25lLg0KDQpUaGlzIFBvQyB0cmlnZ2VycyB0aGUgYnVnIHN1Y2ggdGhhdCB0aGUgZmlyc3QgdGhyZWFkIGZyZWVzIHRoZSBwb3J0IGFuZCB0aGUgc2Vjb25kIHVzZXMgaXQ7IGENCm1vcmUgc2Vuc2libGUgYXBwcm9hY2ggdG93YXJkcyBleHBsb2l0aW5nIGl0IHdvdWxkIGJlIHRvIHVzZSB0aGlzIHJhY2UgdG8gdHJ5IHRvIGRlY3JlbWVudCB0aGUgcmVmZXJlbmNlIGNvdW50DQpvZiBhIHBvcnQgd2l0aCB0d28gcmVmZXJlbmNlcyB0byB6ZXJvIHN1Y2ggdGhhdCB5b3UgZW5kIHVwIHdpdGggYSBkYW5nbGluZyBwb3J0IHBvaW50ZXIuDQoNClRlc3RlZCBvbiBNYWNPUyAxMC4xMiAxNkEzMjMNCiANCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KDQovKiBpYW5iZWVyICovDQoNClJFQUQgVEhJUyBGSVJTVDoNCmlmIHlvdSBkbyBub3QgaGF2ZSBhbiBpUG9kIHRvdWNoIDZnIHJ1bm5pbmcgMTAuMS4xICgxNGIxMDApIG9yIGFuZCBpUGFkIG1pbmkgMiBydW5uaW5nIDEwLjEuMSAoMTRiMTAwKSB0aGlzIHByb2plY3Qgd2lsbA0Kbm90IHdvcmsgb3V0IG9mIHRoZSBib3goKikhIFlvdSBuZWVkIHRvIGZpeCB1cCBhIGNvdXBsZSBvZiBvZmZzZXRzIC0gc2VlIHRoZSBzZWN0aW9uIGZ1dGhlciBkb3duDQoiQWRkaW5nIHN1cHBvcnQgZm9yIG1vcmUgZGV2aWNlcyINCg0KKCopIG1vcmUgcHJlY2lzZWx5LCBJIG9ubHkgaGF2ZSB0aG9zZSBkZXZpY2VzIGFuZCBoYXZlIG9ubHkgdGVzdGVkIGl0IG9uIHRoZW0uDQooKikgMWI0MTUwIHdpbGwgcHJvYmFibHkgYWxzbyB3b3JrLCBJIGhhdmVuJ3QgdGVzdGVkIGl0Lg0KDQpDb250ZW50czoNCiAxIC0gQnVpbGQgSW5zdHJ1Y3Rpb25zDQogMiAtIEFkZGluZyBzdXBwb3J0IGZvciBvdGhlciBkZXZpY2VzDQogMyAtIE5vdGVzIG9uIHRoZSBidWdzIGFuZCBleHBsb2l0cw0KDQoqKiogKDEpIEJ1aWxkIEluc3RydWN0aW9ucyAqKioNCg0KICogZG93bmxvYWQgYW5kIGluc3RhbGwgWGNvZGUgOC4xIG9yIGhpZ2hlcg0KDQogKiBkb3dubG9hZCBKb25hdGhhbiBMZXZpbuKAmXMgY29sbGVjdGlvbiBvZiBhcm02NCBpT1MgYmluYXJpZXM6DQogICAgKyBGb2xsb3cgdGhlIGxpbmsgZm9yICJUaGUgNjQtYml0IHRneiBwYWNrIiBoZXJlOg0KICAgICAgaHR0cDovL25ld29zeGJvb2suY29tL3Rvb2xzL2lPU0JpbmFyaWVzLmh0bWwgKHlvdSB3YW50IGlvc2JpbnBhY2s2NC50Z3opDQogICAgKyBleHRyYWN0IGl0IGludG8gdGhlIGlvc2JpbnBhY2s2NCBkaXJlY3Rvcnkgd2hpY2ggaXMgYWxyZWFkeSBpbiB0aGUgbWFjaF9wb3J0YWwNCiAgICAgIHNvdXJjZSBkaXIgc28gdGhhdCBkaXJlY3RseSB1bmRlcm5lYXRoIGlvc2JpbnBhY2s2NCB5b3UgaGF2ZSB0aGUgYmluLywgZXRjLywgc2Jpbi8sIHVzci8gZGlyZWN0b3JpZXMNCiAgICAgIFdoZW4geW91IGV4cGFuZCB0aGUgaW9zYmlucGFjazY0IGRpcmVjdG9yeSBpbiB0aGUgeGNvZGUgZm9sZGVyIHZpZXcgeW91IHNob3VsZCBzZWUgdGhvc2UgZm9sZGVycw0KDQogKiBvcGVuIHRoaXMgLnhjb2RlcHJvag0KDQogKiBpZiB5b3UgZG9uJ3QgaGF2ZSBhbiBhcHBsZSBpZCBtYWtlIG9uZSBub3cgYXQgaHR0cHM6Ly9hcHBsZWlkLmFwcGxlLmNvbQ0KDQogKiBpZiB5b3UgZG9uJ3QgaGF2ZSBhIGRldmVsb3BlciBzaWduaW5nIGNlcnRpZmljYXRlIHlvdSBjYW4gbWFrZSBhIGZyZWUgb25lIG5vdyBpbiBYY29kZQ0KDQogKiBpbiBYY29kZSBnbyBYY29kZS0+UHJlZmVyZW5jZS0+QWNjb3VudHMgYW5kIGNsaWNrIHRoZSAnKycgaW4gdGhlIGxvd2VyIGxlZnQgaGFuZCBjb3JuZXIgYW5kIGFkZCB5b3VyIGFwcGxlIGlkDQoNCiAqIHNlbGVjdCB5b3VyIGFjY291bnQgdGhlbiAiVmlldyBEZXRhaWxzIiBhbmQgdW5kZXIgc2lnbmluZyBpZGVudGl0ZXMgY2xpY2sgQ3JlYXRlIG5leHQgdG8gaU9TIERldmVsb3BtZW50DQoNCiAqIGNvbm5lY3QgeW91ciBpRGV2aWNlIGFuZCBjbGljayAidHJ1c3QiIGluIHRoZSBwb3AgdXAgb24gaXQNCg0KICogd2FpdCBmb3IgeGNvZGUgdG8gcHJvY2VzcyBzeW1ib2wgZmlsZXMgZm9yIHRoaXMgZGV2aWNlDQoNCiAqIGluIHRoZSBib3ggdG8gdGhlIHJpZ2h0IG9mIHRoZSBwbGF5IGFuZCBzdG9wIGJ1dHRvbnMgaW4gdGhlIHRvcCBsZWZ0IGNvcm5lciBvZiB0aGUgeGNvZGUgd2luZG93IHNlbGVjdCB5b3VyIGlEZXZpY2UNCg0KICogaW4gdGhlIGxlZnQgaGFuZCB3aW5kb3cgcGFuZSBzZWxlY3QgdGhlIG1hY2hfcG9ydGFsIHByb2plY3QgYW5kIG5hdmlnYXRlIHRvIHRoZSBHZW5lcmFsIHRhYg0KDQogKiBpbiB0aGUgc2lnbmluZyB3aW5kb3cgc2VsZWN0IHlvdXIgcGVyc29uYWwgdGVhbQ0KDQogKiBXZSBub3cgbmVlZCB0byBmaXggdXAgYSBmZXcgdGhpbmdzOg0KDQogKiBnbyB0byBCdWlsZCBTZXR0aW5ncyAtPiBQYWNrYWdpbmcgYW5kIGdpdmUgeW91ciBwcm9qZWN0IGEgbmV3LCB1bmlxdWUgYnVuZGxlIGlkZW50aWZpZXINCiAgICAoZWcgY2hhbmdlIGl0IGZyb20gImNvbS5leGFtcGxlLm1hY2hfcG9ydGFsIiB0byAiY29tLmlvcy50ZXN0LmFjY291bnQubWFjaF9wb3J0YWwiDQogICAgIHdoZXJlIGlvcy50ZXN0LmFjY291bnQgaXMgeW91ciBhcHBsZSBpZC4gKGl0IGRvZXNu4oCZdCBoYXZlIHRvIGJlIHlvdXIgYXBwbGUgaWQsIGp1c3QgYSB1bmlxdWUgc3RyaW5nKSkNCg0KICogV2UgYWxzbyBuZWVkIHRvIHJlZ2lzdGVyIGEgdW5pcXVlIEFwcCBHcm91cDoNCg0KICogSW4gdGhlIGNhcGFiaWxpdGllcyB2aWV3IHNjcm9sbCBkb3duIHRvIHRoZSBBcHAgR3JvdXBzIHNlY3Rpb24sIHJlbW92ZSB0aGUgZXhpc3RpbmcgQXBwIEdyb3VwICgiZ3JvdXAubWFjaF9wb3J0YWwiKQ0KICAgYW5kIGFkZCBhIG5ldyB1bmlxdWUgb25lIChlZyAiZ3JvdXAuaW9zLnRlc3QuYWNjb3VudC5tYWNoX3BvcnRhbCIpDQoNCiAqIG9wZW4gamFpbGJyZWFrLmMgYW5kIGNoYW5nZSB0aGUgYXBwX2dyb3VwIHZhcmlhYmxlIHRvIHRoaXMgbmV3IGFwcCBncm91cCBpZC4NCg0KICogb24gdGhlIGlEZXZpY2UgZ28gdG8gc2V0dGluZ3MgLT4gR2VuZXJhbCAtPiBEZXZpY2UgTWFuYWdlbWVudCBhbmQgc2VsZWN0IHlvdXIgYXBwbGUgSUQgYW5kIGNsaWNrIHRydXN0DQoNCiAqIGluIHhjb2RlIGNsaWNrIHZpZXcgLT4gZGVidWcgYXJlYSAtPiBhY3RpdmF0ZSBjb25zb2xlIHNvIHlvdSBjYW4gc2VlIGRlYnVnZ2luZyBvdXRwdXQgKHRoZXJlJ3Mgbm8gb3V0cHV0IG9uIHRoZSBpRGV2aWNlIHNjcmVlbiBhdCBhbGwsIHRoYXQncyBub3JtYWwpDQoNCiAqIG1ha2Ugc3VyZSB5b3VyIGlEZXZpY2UgYW5kIGhvc3QgYXJlIGNvbm5lY3RlZCB0byB0aGUgc2FtZSB3aWZpIG5ldHdvcmsgYW5kIHRoYXQgbmV0d29yayBhbGxvd3MgY2xpZW50IHRvIGNsaWVudCBjb25uZWN0aW9ucy4gTm90ZSBkb3duIHRoZSBpRGV2aWNlJ3MgaXAgYWRkcmVzcy4NCg0KICogY2xpY2sgcGxheSB0byBydW4gdGhlIGFwcCBvbiB0aGUgaURldmljZS4gSWYgaXQgZmFpbHMgcHJlc3MgYW5kIGhvbGQgdGhlIHBvd2VyIGFuZCBob21lIGJ1dHRvbnMgdG8gcmVzZXQgdGhlIGRldmljZS4gSWYgWGNvZGUgYXNrcyB5b3UgdG8gZW5hYmxlIGRldmVsb3BlciBtb2RlIG9uIHRoaXMgbWFjIGFncmVlLg0KDQogKiBpZiBpdCBzdWNjZWVkcyB5b3Ugc2hvdWxkIHNlZToNCiAgICAic2hlbGwgbGlzdGVuaW5nIG9uIHBvcnQgNDE0MSINCiAgIHByaW50ZWQgdG8gdGhlIGRlYnVnIGNvbnNvbA0KDQogKiB0aGUga2VybmVsIGV4cGxvaXQgaXMgb25seSBhcm91bmQgNTAlIHJlbGlhYmxlICh0aGlzIGNhbiBjZXJ0YWlubHkgYmUgaW1wcm92ZWQsIHJlYWQgdGhlIGNvZGUgYW5kIG1ha2UgaXQgYmV0dGVyISkNCiAgICAgaXQgd2lsbCBmYWlsIG1vcmUgb2Z0ZW4gaWYgdGhlcmUgaXMgaGlnaCBzeXN0ZW0gbG9hZCAtIHRyeSBsZWF2aW5nIHRoZSBkZXZpY2UgZm9yIGEgbWludXRlIGFmdGVyIHJlYm9vdGluZyBpdCBhbmQgY29ubmVjdGluZyBpdCB0byB5b3UgbWFjIGJlZm9yZSB0cnlpbmcgYWdhaW4NCg0KICogY29ubmVjdCB0byB0aGF0IHBvcnQgd2l0aCBuZXRjYXQ6DQogICAgIG5jIFguWC5YLlggNDE0MQ0KICAgd2hlcmUgWC5YLlguWCBpcyB5b3VyIGlEZXZpY2XigJlzIGlwIGFkZHJlc3MNCg0KICogeW91IGhhdmUgYSByb290IHNoZWxsIDopIFRoZXJl4oCZcyBubyBjb250cm9sbGluZyB0ZXJtaW5hbCBzbyBmYW5jeSBjdXJzZXMgZ3VpIHN0dWZmIHdvbid0IHdvcmsgdW5sZXNzIHlvdSBmaXggdGhhdA0KDQogKiB5b3UgY2FuIHJ1biBhbnkgcHNldWRvLXNpZ25lZCB0aGluIEFSTTY0IGJpbmFyaWVzIC0gaWYgeW91IHdhbnQgdGhlIGtlcm5lbCB0YXNrIHBvcnQgaXQncyBob3N0IHNwZWNpYWwgcG9ydCA0DQoNCiAqIGNvcHkgeW91ciBjdXN0b20gdGVzdGluZyB0b29scyB0byB0aGUgaW9zYmlucGFjazY0IGRpcmVjdG9yeSBhbmQgdGhleSdsbCBiZSBidW5kbGVkIHdpdGggdGhlIC5hcHAgc28geW91IGNhbiBydW4gdGhlbSBmcm9tIHRoZSBzaGVsbA0KDQogKiB5b3UncmUgcnVubmluZyBhcyBhbiB1bnNhbmRib3hlZCByb290IHVzZXIgc28geW91IGNhbiB0YWxrIHRvIGFueSBpb2tpdCB1c2VyIGNsaWVudHMvbWFjaCBzZXJ2aWNlcw0KDQogKiBhbWZpZCBpcyBwYXRjaGVkIHRvIGFsbG93IGFueSBzaWduYXR1cmVzL2VudGl0bGVtZW50cw0KDQogKiBXaGVuIHlvdeKAmXJlIGRvbmUgaG9sZCBwb3dlciBhbmQgaG9tZSB0byByZXNldCB0aGUgZGV2aWNlDQoNCioqKiAoMikgQWRkaW5nIHN1cHBvcnQgZm9yIG90aGVyIGRldmljZXMgKioqDQogKiB5b3UgaGF2ZSB0byBkbyB0aGlzIG1hbnVhbGx5LCBzb3JyeSENCg0KICogZG93bmxvYWQgdGhlIGlwc3cgZm9yIHlvdXIgZGV2aWNlIGZyb20gaHR0cHM6Ly93d3cudGhlaXBob25ld2lraS5jb20vd2lraS9GaXJtd2FyZQ0KICAgVGhlIGJ1Z3MgYXJlIHRoZXJlIGluIGFueSB2ZXJzaW9uIDw9IDEwLjEuMSBidXQgdGhlIGZ1cnRoZXIgYmFjayB5b3UgZ28gdGhlIG1vcmUgb2Zmc2V0cw0KICAgd2lsbCBiZSB3cm9uZyBzbyBpZGVhbGx5IHN0aWNrIHRvIDEwLjEuMSAoYW5kIGZvciBhbnl0aGluZyBlYXJsaWVyIHRoYXQgaU9TIDEwIHRoZSBrZXJuZWwgY2FjaGUNCiAgIGlzIGVuY3J5cHRlZCBzbyB5b3UnbGwgaGF2ZSB0byBkbyB0aGUgcmVzdCB5b3Vyc2VsZikNCg0KICogZm9yID49IGlPUyAxMCB1bnppcCB0aGUgaXBzdyBhbmQgaGV4ZHVtcCB0aGUga2VybmVsLnJlbGVhc2UuKiBmaWxlIGxpa2UgdGhpczoNCg0KJCBoZXhkdW1wIC1DIGtlcm5lbGNhY2hlLnJlbGVhc2UubjUxIHwgaGVhZA0KMDAwMDAwMDAgIDMwIDgzIGI1IDliIDBkIDE2IDA0IDQ5ICA0ZCAzNCA1MCAxNiAwNCA2YiA3MiA2ZSAgfDAuLi4uLi5JTTRQLi5rcm58DQowMDAwMDAxMCAgNmMgMTYgMWMgNGIgNjUgNzIgNmUgNjUgIDZjIDQzIDYxIDYzIDY4IDY1IDQyIDc1ICB8bC4uS2VybmVsQ2FjaGVCdXwNCjAwMDAwMDIwICA2OSA2YyA2NCA2NSA3MiAyZCAzMSAzMSAgMzYgMzIgMmUgMzIgMzAgMmUgMzEgMDQgIHxpbGRlci0xMTYyLjIwLjEufA0KMDAwMDAwMzAgIDgzIGI1IDlhIGRlIDYzIDZmIDZkIDcwICA2YyA3YSA3MyA3MyA4MyAxMyA3ZCBhZSAgfC4uLi5jb21wbHpzcy4ufS58DQowMDAwMDA0MCAgMDEgNjQgODAgMDAgMDAgYjUgMjkgNWUgIDAwIDAwIDAwIDAxIDAwIDAwIDAwIDAwICB8LmQuLi4uKV4uLi4uLi4uLnwNCjAwMDAwMDUwICAwMCAwMCAwMCAwMCAwMCAwMCAwMCAwMCAgMDAgMDAgMDAgMDAgMDAgMDAgMDAgMDAgIHwuLi4uLi4uLi4uLi4uLi4ufA0KKg0KMDAwMDAxYjAgIDAwIDAwIDAwIDAwIGZmIGNmIGZhIGVkICBmZSAwYyAwMCAwMCAwMSBkNSAwMCBmNiAgfC4uLi4uLi4uLi4uLi4uLi58DQowMDAwMDFjMCAgZjAgMDIgZjYgZjAgMTQgZjYgZjAgMzggIDBlIDlhIGYzIGYxIDIwIGY2IGYxIDAwICB8Li4uLi4uLjguLi4uIC4uLnwNCjAwMDAwMWQwICAxOSBmZiBmMSBmNSBmMCA1ZiA5ZiA1ZiAgNTQgNDUgNTggNTQgMDkgMDIgMWMgMDMgIHwuLi4uLl8uX1RFWFQuLi4ufA0KDQogKiBub3RlIGRvd24gdGhlIG9mZnNldCBvZiB0aGUgZmYgY2YgZmEgZWQgZmUgYnl0ZSBzZXF1ZW5jZSAoaW4gdGhpcyBjYXNlIGl0J3MgMHgxYjQpDQoNCiAqIGNvbXBpbGUgbHpzc2RlYyBmcm9tIGh0dHA6Ly9uYWg2LmNvbS9+aXRzbWUvY3ZzLXhkYWRldnRvb2xzL2lwaG9uZS90b29scy9senNzZGVjLmNwcA0KDQogKiBydW4gYSBjb21tYW5kIGxpa2U6IGx6c3NkZWMgLW8gMHgxYjQgPCBrZXJuZWwucmVsZWFzZS5uNTEgPiBrZXJuZWwuZGVjb21wcmVzc2VkDQoNCiAqIG9wZW4gdGhlIGRlY29tcHJlc3NlZCBrZXJuZWxjYWNoZSBpbiBhIHJlY2VudCB2ZXJzaW9uIG9mIElEQSBQcm8gKHdpdGggc3VwcG9ydCBmb3IgaU9TIGtleHRjYWNoZXMpDQoNCiAqIHNheSB5ZXMgd2hlbiBJREEgYXNrcyB0byBzcGxpdCBieSBrZXh0DQoNCiAqIGxldCB0aGUgYXV0by1hbmFseXNpcyBydW4gLSBkZXBlbmRpbmcgb24gaG93IGZhc3QgeW91ciBjb21wdXRlciBpcyB0aGlzIG1pZ2h0IHRha2UgYSB3aGlsZSEgKGl0IHRha2VzIG15IDIwMTMgTUJQIGFib3V0IDMwIG1pbnV0ZXMpDQoNCiAqIGdvIHZpZXcgLT4gb3BlbiBzdWJ2aWV3cyAtPiBzZWdtZW50cyBhbmQgZmluZCB0aGUgX19URVhUOkhFQURFUiBzZWdtZW50LCB0aGUgc3RhcnQgc2hvdWxkIGJlIEZGRkZGRkYwMDcwMDQwMDANCiAgIGlmIGl0IGlzbid0IG5vdGUgdGhpcyBkb3duIGFzIHlvdSdsbCBuZWVkIHRvIHdvcmsgb3V0IGEgY291cGxlIG9mIG9mZnNldHMgcmVsYXRpdmUgdG8gdGhpcw0KDQogKiBnbyB2aWV3IC0+IG9wZW4gc3Vidmlld3MgLT4gbmFtZXMgYW5kIGZpbmQgdGhlIGtlcm5wcm9jIGRhdGEgc3ltYm9sLg0KDQogKiBzdWJ0cmFjdCB0aGUgX19URVhUOkhFQURFUiB2YWx1ZSBmcm9tIHRoYXQsIHRoaXMgaXMgdGhlIGtlcm5wcm9jIG9mZnNldA0KICAgICBlZyBmb3IgaVBob25lIDVTIDEwLjEuMSBrZXJucHJvYyBpcyBhdCBGRkZGRkZGMDA3NUFFMEUwIG1ha2luZyB0aGUgb2Zmc2V0OiAweDVBQTBFMA0KDQogKiBub3cgdGhlIGhhcmRlciBvbmUhIFdlIG5lZWQgdG8gZmluZCBhbGxwcm9jIHdoaWNoIGlzbid0IGV4cG9ydGVkIHNvIGlzIGhhcmRlciB0byBmaW5kOg0KDQogKiBnbyB2aWV3IC0+IG9wZW4gc3Vidmlld3MgLT4gc3RyaW5ncyBhbmQgZmluZCB0aGUgc3RyaW5nICJwZ3JwX2FkZCA6IHBncnAgaXMgZGVhZCBhZGRpbmcgcHJvY2VzcyINCg0KICogaGl0ICd4JyBvbiB0aGUgYXV0b2dlbmVyYXRlZCBzdHJpbmcgc3ltYm9sIG5hbWU7IHlvdSBzaG91bGQgc2VlIHRoaXMgc3ltYm9sIHJlZmVyZW5jZWQgZnJvbSB0d28gZnVuY3Rpb25zDQoNCiAqIG9wZW4gdGhlIHNtYWxsZXIgb2YgdGhvc2UgZnVuY3Rpb25zIGluIHRoZSBJREEgZ3JhcGggdmlldw0KDQogKiB0aGlzIGlzIHBncnBfYWRkIGluIHRoZSBYTlUgc291cmNlDQoNCiAqIHNjcm9sbCB0byB0aGUgYm90dG9tIG9mIHRoZSBDRkcsIHRoZSBmaW5hbCB0aHJlZSBub2RlcyBhbGwgcmVmZXJlbmNlIHRoZSBzYW1lIGdsb2JhbCB2YXJpYWJsZSB3aXRoIGNvZGUgbGlrZSB0aGlzOg0KICAgIEFEUlAgIFg4LCAjcXdvcmRfRkZGRkZGRjAwNzVBODEyOEBQQUdFDQogICAgTERSICAgWDksIFtYOCwjcXdvcmRfRkZGRkZGRjAwNzVBODEyOEBQQUdFT0ZGXQ0KDQogKiB0aGF0J3MgdGhlIGFkZHJlc3Mgb2YgYWxscHJvYyAtIHN1YnRyYWN0IHRoZSBrZXJuZWwgYmFzZSB0byBnZXQgdGhlIG9mZnNldCwgaW4gdGhpcyBjYXNlIGl0J3M6IDB4NUE0MTI4DQoNCiAqIG9wZW4gb2Zmc2V0LmMgYW5kIGFkZCBzdXBwb3J0IGZvciB5b3VyIGRldmljZS4gWW91IHNob3VsZCBvbmx5IGhhdmUgdG8gdXBkYXRlIHRob3NlIHR3byB2YXJpYWJsZSAoa2VybnByb2MgYW5kIGFsbHByb2MpDQogICBUaGUgc3RydWN0dXJlIG9mZnNldHMgc2hvdWxkIHN0YXkgdGhlIHNhbWUsIGF0IGxlYXN0IGZvciByZWNlbnQga2VybmVscy4gSWYgeW91IHdhbnQgdG8gdGFyZ2V0IGEgbXVjaCBvbGRlciBrZXJuZWwgeW91J2xsDQogICBhbHNvIGhhdmUgdG8gd29yayBvdXQgYWxsIHRoZSBzdHJ1Y3R1cmUgb2Zmc2V0cyAtIHRoaXMgaXMgbXVjaCBtb3JlIGZpZGRseS4NCg0KICogMzItYml0IGRldmljZXM6DQogICBBbGwgdGhlIG9mZnNldHMgd2lsbCBiZSB0b3RhbGx5IGRpZmZlcmVudCBhbmQgdGhlIGNvZGUgd2hpY2ggbWFuaXB1bGF0ZXMgdGhlIGtlcm5lbCBkYXRhIHN0cnVjdHVyZXMgd2lsbCBhbHNvIGJlIGNvbXBsZXRlbHkgd3JvbmcuDQogICBUaGVyZSdzIG5vIHJlYXNvbiBpdCB3b3VsZG4ndCB3b3JrIGJ1dCB5b3UnbGwgaGF2ZSB0byBmaXggdGhlIGNvZGUgdG8gbWFrZSBpdCB3b3JrDQoNCioqKiBmaXhpbmcgdXNlcnNwYWNlIHN0dWZmICoqKg0KDQpJIGFsc28gcmVseSBvbiBhIGhhbmRmdWwgb2Ygb2Zmc2V0cyBpbiBhbWZpZDsgeW91IHNob3VsZCBiZSBhYmxlIHRvIGZpbmQgdGhvc2UgdmVyeSBlYXNpbHkgaWYgdGhleSdyZSBkaWZmZXJlbnQgb24geW91ciB0YXJnZXQuDQpTZWUgdGhlIGNvZGUgYW5kIGFsc2UgdGhlIHNlY3Rpb24gIlBhdGNoIGFtZmlkIiBiZWxvdy4NCg0KKioqICgzKSBOb3RlcyBvbiB0aGUgYnVncyBhbmQgZXhwbG9pdHMgKioqDQoNClRoaXMgcHJvamVjdCBpcyBjYWxsZWQgIm1hY2hfcG9ydGFsIiAtIGl0J3MgdGhlIHJlc3VsdCBvZiBhIHJlc2VhcmNoIHByb2plY3QgSSBkaWQgdGhpcyB5ZWFyIGxvb2tpbmcgYXQgbWFjaCBwb3J0cy4gKEFsbCB0aGUgYnVncyB1c2VkDQppbnZvbHZlIG1hY2ggcG9ydHMgOi0pICkgVGhlcmUgYXJlIHR3byBtYWluIGJ1Z3MgcGx1cyBvbmUgbW9yZSB3aGljaCBpcyBvbmx5IHVzZWQgdG8gZm9yY2UgYSBzZXJ2aWNlIHRvIHJlc3RhcnQ6DQoNCkNWRS0yMDE2LTc2Mzc6IEJyb2tlbiBrZXJuZWwgbWFjaCBwb3J0IG5hbWUgdXJlZiBoYW5kbGluZyBvbiBpT1MvTWFjT1MgY2FuIGxlYWQgdG8gcHJpdmlsZWdlZCBwb3J0IG5hbWUgcmVwbGFjZW1lbnQgaW4gb3RoZXIgcHJvY2Vzc2VzDQoNCkNWRS0yMDE2LTc2NDQ6IFhOVSBrZXJuZWwgVWFGIGR1ZSB0byBsYWNrIG9mIGxvY2tpbmcgaW4gc2V0X2RwX2NvbnRyb2xfcG9ydA0KDQpDVkUtMjAxNi03NjYxOiBNYWNPUy9pT1MgYXJiaXRyYXJ5IHBvcnQgcmVwbGFjZW1lbnQgaW4gcG93ZXJkDQoNClRoZXJlIGlzIG5vIHVudGV0aGVyIChwZXJzaXN0ZW50IGNvZGVzaWduaW5nIGJ5cGFzcykgYnV0IHRoZSBleHBsb2l0IHdpbGwgdGVtcG9yYXJpbHkgZGlzYWJsZSBjb2Rlc2lnbmluZyB3aGlsZSBpdCBydW5zIHNvIHlvdSBjYW4gcnVuDQp1bnNpZ25lZCBiaW5hcmllcy4NCg0KVGhlIGhpZ2ggbGV2ZWwgZXhwbG9pdCBmbG93IGlzIGxpa2UgdGhpczoNCg0KSSB1c2UgQ1ZFLTIwMTYtNzYzNyB0byByZXBsYWNlIGxhdW5jaGQncyBzZW5kIHJpZ2h0IHRvIGNvbS5hcHBsZS5pb2hpZGV2ZW50c3lzdGVtIHdpdGggYSBzZW5kIHJpZ2h0IHRvIGEgcG9ydCBmb3Igd2hpY2ggSSBob2xkIHRoZSByZWNlaXZlIHJpZ2h0Lg0KSSB1c2UgQ1ZFLTIwMTYtNzY2MSB0byBjcmFzaCB0aGUgcG93ZXJkIGRhZW1vbiAod2hpY2ggcnVucyBhcyByb290KS4gSXQgZ2V0cyBhdXRvbWF0aWNhbGx5IHJlc3RhcnRlZCBhbmQgYXMgcGFydCBvZiBpdHMgc3RhcnR1cCBpdCB3aWxsDQpsb29rdXAgdGhlIGNvbS5hcHBsZS5pb2hpZGV2ZW50c3lzdGVtIG1hY2ggc2VydmljZSBhbmQgc2VuZCBpdHMgb3duIHRhc2sgcG9ydCB0byB0aGF0IHNlcnZpY2UuIFNpbmNlIEkgaG9sZCB0aGUgcmVjZWl2ZQ0KcmlnaHQgZm9yIHRoYXQgcG9ydCB0aGlzIG1lYW5zIHRoYXQgcG93ZXJkIGFjdHVhbGx5IHNlbmRzIG1lIGl0cyB0YXNrIHBvcnQgZ2l2aW5nIG1lIGNvbXBsZXRlIGNvbnRyb2wgb3ZlciBpdCA6LSkNCkkgdXNlIHBvd2VyZCdzIHRhc2sgcG9ydCB0byBnZXQgdGhlIGhvc3RfcHJpdiBwb3J0IHdoaWNoIEkgdXNlIHRvIHRyaWdnZXIgdGhlIGtlcm5lbCBidWcuDQoNClRoZSBrZXJuZWwgYnVnIGlzIGEgbGFjayBvZiBsb2NraW5nIHdoZW4gcmVsZWFzaW5nIGEgcmVmZXJlbmNlIG9uIGEgcG9ydC4gSSBhbGxvY2F0ZSBhIGxhcmdlIG51bWJlciBvZiBtYWNoIHBvcnRzIHRoZW4gdHJpZ2dlciB0aGUgYnVnIG9uIGFyb3VuZCAyMA0Kb2YgdGhlbSB3aGljaCBhcmUgbGlrZWx5IHRvIGJlIGFsbG9jYXRlZCBuZWFyIGVhY2ggb3RoZXIgaW4gdGhlIGtlcm5lbC4gSSB1c2Ugbm8tbW9yZS1zZW5kZXJzIG5vdGlmaWNhdGlvbnMgc28gSSBjYW4gZGV0ZXJtaW5pc3RpY2FsbHkga25vdyB3aGVuIEkndmUNCm1hbmFnZWQgdG8gb3Zlci1yZWxlYXNlIGEgcG9ydCBzbyB0aGF0IEkgY2FuIGFjdHVhbGx5IGdpdmUgbXlzZWxmIGRhbmdsaW5nIHBvcnQgcG9pbnRlcnMgYXQgYW4gZXhhY3QgcG9pbnQgaW4gdGltZSBsYXRlci4NCg0KSSBmcmVlIGFsbCB0aGVzZSBtYWNoIHBvcnRzIChsZWF2aW5nIG15c2VsZiB3aXRoIH4yMCBkYW5nbGluZyBtYWNoIHBvcnQgcG9pbnRlcnMpIGFuZCBmb3JjZSBhIHpvbmUgR0MuIEkgdHJ5IHRvIG1vdmUNCnRoZSBwYWdlIHBvaW50ZWQgdG8gYnkgYWxsIHRoZSBkYW5nbGluZyBwb3J0IHBvaW50ZXJzIGludG8gdGhlIGthbGxvYy40MDk2IHpvbmUgYW5kIHRoZW4gSSBzZW5kIG15c2VsZiBhIGxhcmdlIG51bWJlciBvZiBtYWNoIG1lc3NhZ2UgY29udGFpbmluZyBPT0wNCnBvcnRzIHdpdGggc2VuZCByaWdodHMgdG8gdGhlIGhvc3QgcG9ydC4gSSBzZXQgdXAgdGhlc2UgT09MIHBvcnQgcGFnZXMgc28gdGhhdCBvdmVybGFwcGluZyB0aGUgZGFuZ2xpbmcgcG9ydCdzIGNvbnRleHQgcG9pbnRlcnMgdGhlcmUncyBhIHBvaW50ZXINCnRvIHRoZSBob3N0IHBvcnQgaXBjX3BvcnQgYW5kIHRoZSBkYW5nbGluZyBwb3J0J3MgbG9jayBhbmQgaXNfZ3VhcmRlZCBmaWVsZHMgYXJlIHJlcGxhY2VkIHdpdGggTlVMTCBwb2ludGVycy4NCg0KSWYgdGhhdCBhbGwgd29ya2VkIEkgY2FuIGNhbGwgbWFjaF9wb3J0X2dldF9jb250ZXh0IG9uIGVhY2ggb2YgdGhlIGRhbmdsaW5nIHBvcnRzIGFuZCBJIHNob3VsZCBnZXQgYmFjayB0aGUgYWRkcmVzcyBvZiB0aGUgaG9zdCBwb3J0IGlwY19wb3J0Lg0KDQpUaGUga2VybmVsIHRhc2sgcG9ydCBpcyBhbGxvY2F0ZWQgYXQgYXJvdW5kIHRoZSBzYW1lIHRpbWUgYXMgdGhlIGhvc3QgcG9ydCBhbmQgYXMgc3VjaCB0aGV5IGJvdGggZW5kIHVwIGluIHRoZSBzYW1lIGtlcm5lbCB6b25lIHBhZ2UuIEkgd29yaw0Kb3V0IHRoZSBiYXNlIG9mIHRoaXMgcGFnZSB0aGVuIGNhbGwgbWFjaF9wb3J0X3NldF9jb250ZXh0IG9uIGFsbCBvZiB0aGUgZGFuZ2xpbmcgcG9ydHMgcGFzc2luZyBlYWNoIHBvc3NpYmxlIGFkZHJlc3Mgb2YgdGhlIGtlcm5lbCB0YXNrIHBvcnQNCmluIHR1cm4uIEkgdGhlbiByZWNlaXZlIGFsbCB0aGUgcG9ydHMgSSBzZW50IHRvIG15c2VsZiBhbmQgaWYgZXZlcnl0aGluZyB3b3JrZWQgSSd2ZSBlbmRlZCByZWNlaXZpbmcgYSBzZW5kIHJpZ2h0IHRvIHRoZSBrZXJuZWwgdGFzayBwb3J0IDopDQoNCkhlcmUncyBhIG1vcmUgZGV0YWlsZWQgd3JpdGV1cCBvZiB0aGUgc2FuZGJveCBlc2NhcGUgcGFydCBvZiB0aGUgZXhwbG9pdC4gWW91J2xsIGhhdmUgdG8gcmVhZCB0aGUgY29kZSBmb3IgdGhlIGtlcm5lbCBleHBsb2l0LCBJIGhhdmVuJ3Qgd3JpdHRlbg0KYSBsb25nZXIgd3JpdGV1cCBmb3IgdGhhdCB5ZXQuDQoNCioqKiBTYW5kYm94IGVzY2FwZSAqKioNCg0KV2hlbiBzZW5kaW5nIGFuZCByZWNlaXZpbmcgbWFjaCBtZXNzYWdlcyBmcm9tIHVzZXJzcGFjZSB0aGVyZSBhcmUgdHdvIGltcG9ydGFudCBrZXJuZWwgb2JqZWN0czsgaXBjX2VudHJ5IGFuZA0KaXBjX29iamVjdC4NCg0KaXBjX2VudHJ5J3MgYXJlIHRoZSBwZXItcHJvY2VzcyBoYW5kbGVzIG9yIG5hbWVzIHdoaWNoIGEgcHJvY2VzcyB1c2VzIHRvIHJlZmVyIHRvIGEgcGFydGljdWxhciBpcGNfb2JqZWN0Lg0KDQppcGNfb2JqZWN0IGlzIHRoZSBhY3R1YWwgbWVzc2FnZSBxdWV1ZSAob3Iga2VybmVsIG9iamVjdCkgd2hpY2ggdGhlIHBvcnQgcmVmZXJzIHRvLg0KDQppcGNfZW50cnlzIGhhdmUgYSBwb2ludGVyIHRvIHRoZSBpcGNfb2JqZWN0IHRoZXkgYXJlIGEgaGFuZGxlIGZvciBhbG9uZyB3aXRoIHRoZSBpZV9iaXRzIGZpZWxkIHdoaWNoIGNvbnRhaW5zDQp0aGUgdXJlZnMgYW5kIGNhcGFjaWxpdHkgYml0cyBmb3IgdGhpcyBuYW1lL2hhbmRsZSAod2hldGhlciB0aGlzIGlzIGEgc2VuZCByaWdodCwgcmVjZWl2ZSByaWdodCBldGMuKQ0KDQogIHN0cnVjdCBpcGNfZW50cnkgew0KICAgIHN0cnVjdCBpcGNfb2JqZWN0ICppZV9vYmplY3Q7DQogICAgaXBjX2VudHJ5X2JpdHNfdCBpZV9iaXRzOw0KICAgIG1hY2hfcG9ydF9pbmRleF90IGllX2luZGV4Ow0KICAgIHVuaW9uIHsNCiAgICAgIG1hY2hfcG9ydF9pbmRleF90IG5leHQ7ICAgLyogbmV4dCBpbiBmcmVlbGlzdCwgb3IuLi4gICovDQogICAgICBpcGNfdGFibGVfaW5kZXhfdCByZXF1ZXN0OyAgLyogZGVhZCBuYW1lIHJlcXVlc3Qgbm90aWZ5ICovDQogICAgfSBpbmRleDsNCiAgfTsNCg0KI2RlZmluZSBJRV9CSVRTX1VSRUZTX01BU0sgIDB4MDAwMGZmZmYgIC8qIDE2IGJpdHMgb2YgdXNlci1yZWZlcmVuY2UgKi8NCiNkZWZpbmUgSUVfQklUU19VUkVGUyhiaXRzKSAoKGJpdHMpICYgSUVfQklUU19VUkVGU19NQVNLKQ0KDQpUaGUgbG93IDE2IGJpdHMgb2YgdGhlIGllX2JpdHMgZmllbGQgYXJlIHRoZSB1c2VyLXJlZmVyZW5jZSAodXJlZikgY291bnQgZm9yIHRoaXMgbmFtZS4NCg0KRWFjaCB0aW1lIGEgbmV3IHJpZ2h0IGlzIHJlY2VpdmVkIGJ5IGEgcHJvY2VzcywgaWYgaXQgYWxyZWFkeSBoYWQgYSBuYW1lIGZvciB0aGF0IHJpZ2h0IHRoZSBrZXJuZWwgd2lsbA0KaW5jcmVtZW50IHRoZSB1cmVmcyBjb3VudC4gVXNlcnNwYWNlIGNhbiBhbHNvIGFyYml0cmFyaWx5IGNvbnRyb2wgdGhpcyByZWZlcmVuY2UgY291bnQgdmlhIG1hY2hfcG9ydF9tb2RfcmVmcw0KYW5kIG1hY2hfcG9ydF9kZWFsbG9jYXRlLiBXaGVuIHRoZSByZWZlcmVuY2UgY291bnQgaGl0cyAwIHRoZSBlbnRyeSBpcyBmcmVlJ2QgYW5kIHRoZSBuYW1lIGNhbiBiZSByZS11c2VkIHRvDQpuYW1lIGFub3RoZXIgcmlnaHQgKHRoaXMgaXMgYWN0dWFsbHkgb25seSB0aGUgY2FzZSBmb3Igc2VuZCByaWdodHMpLg0KDQppcGNfcmlnaHRfY29weW91dCBpcyBjYWxsZWQgd2hlbiBhIHJpZ2h0IHdpbGwgYmUgY29waWVkIGludG8gYSBzcGFjZSAoZm9yIGV4YW1wbGUgYnkgc2VuZGluZyBhIHBvcnQgcmlnaHQgaW4gYSBtYWNoDQptZXNzYWdlIHRvIGFub3RoZXIgcHJvY2Vzcy4pIEhlcmUncyB0aGUgY29kZSB0byBoYW5kbGUgdGhlIHNlbmRpbmcgb2YgYSBzZW5kIHJpZ2h0Og0KDQogICAgY2FzZSBNQUNIX01TR19UWVBFX1BPUlRfU0VORDoNCiAgICAgICAgYXNzZXJ0KHBvcnQtPmlwX3NyaWdodHMgPiAwKTsNCiAgICAgICAgDQogICAgICAgIGlmIChiaXRzICYgTUFDSF9QT1JUX1RZUEVfU0VORCkgew0KICAgICAgICAgICAgbWFjaF9wb3J0X3VyZWZzX3QgdXJlZnMgPSBJRV9CSVRTX1VSRUZTKGJpdHMpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBhc3NlcnQocG9ydC0+aXBfc3JpZ2h0cyA+IDEpOw0KICAgICAgICAgICAgYXNzZXJ0KHVyZWZzID4gMCk7DQogICAgICAgICAgICBhc3NlcnQodXJlZnMgPCBNQUNIX1BPUlRfVVJFRlNfTUFYKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKHVyZWZzKzEgPT0gTUFDSF9QT1JUX1VSRUZTX01BWCkgew0KICAgICAgICAgICAgICAgIGlmIChvdmVyZmxvdykgew0KICAgICAgICAgICAgICAgICAgICAvKiBsZWF2ZSB1cmVmcyBwZWdnZWQgdG8gbWF4aW11bSAqLyAgICAgPC0tLS0gKDEpDQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBwb3J0LT5pcF9zcmlnaHRzLS07DQogICAgICAgICAgICAgICAgICAgIGlwX3VubG9jayhwb3J0KTsNCiAgICAgICAgICAgICAgICAgICAgaXBfcmVsZWFzZShwb3J0KTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEtFUk5fU1VDQ0VTUzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaXBfdW5sb2NrKHBvcnQpOw0KICAgICAgICAgICAgICAgIHJldHVybiBLRVJOX1VSRUZTX09WRVJGTE9XOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcG9ydC0+aXBfc3JpZ2h0cy0tOw0KICAgICAgICAgICAgaXBfdW5sb2NrKHBvcnQpOw0KICAgICAgICAgICAgaXBfcmVsZWFzZShwb3J0KTsNCiAgICAgICANCiAgICAgLi4uICAgICANCiAgICAgICAgDQogICAgICAgIGVudHJ5LT5pZV9iaXRzID0gKGJpdHMgfCBNQUNIX1BPUlRfVFlQRV9TRU5EKSArIDE7ICA8LS0tLSAoMikNCiAgICAgICAgaXBjX2VudHJ5X21vZGlmaWVkKHNwYWNlLCBuYW1lLCBlbnRyeSk7DQogICAgICAgIGJyZWFrOw0KDQoNCklmIGNvcHlpbmcgdGhpcyByaWdodCBpbnRvIHRoaXMgc3BhY2Ugd291bGQgY2F1c2UgdGhhdCByaWdodCdzIG5hbWUncyB1cmVmcyBjb3VudCBpbiB0aGF0IHNwYWNlIHRvIGhpdCAweGZmZmYNCnRoZW4gKGlmIG92ZXJmbG93IGlzIHRydWUpIHdlIHJlYWNoIHRoZSBjb2RlIGF0ICgxKSB3aGljaCBjbGFpbXMgaW4gdGhlIGNvbW1lbnQgdGhhdCBpdCB3aWxsIGxlYXZlIHVyZWZzIHBlZ2dlZCBhdCBtYXhpbXVtLg0KVGhpcyBicmFuY2ggZG9lc24ndCBpbmNyZWFzZSB0aGUgdXJlZnMgYnV0IHN0aWxsIHJldHVybnMgS0VSTl9TVUNDRVNTLiBBbG1vc3QgYWxsIGNhbGxlcnMgcGFzcyBvdmVyZmxvdz10cnVlLg0KDQpUaGUgcmVhc29uIGZvciB0aGlzICJwZWdnaW5nIiB3YXMgcHJvYmFibHkgbm90IHRvIHByZXZlbnQgdGhlIHJlZmVyZW5jZSBjb3VudCBmcm9tIGJlY29taW5nIGluY29ycmVjdCBidXQgcmF0aGVyIGJlY2F1c2UNCmF0ICgyKSBpZiB0aGUgdXJlZnMgY291bnQgd2Fzbid0IGNhcHBlZCB0aGUgcmVmZXJlbmNlIGNvdW50IHdvdWxkIG92ZXJmbG93IHRoZSAxNi1iaXQgYml0ZmllbGQgaW50byB0aGUgY2FwYWJpbGl0eSBiaXRzLg0KDQpUaGUgaXNzdWUgaXMgdGhhdCB0aGUgdXJlZnMgY291bnQgaXNuJ3QgInBlZ2dlZCIgYXQgYWxsLiBJIHdvdWxkIGV4cGVjdCAicGVnZ2VkIiB0byBtZWFuIHRoYXQgdGhlIHVyZWZzIGNvdW50IHdpbGwgbm93IHN0YXkgYXQgMHhmZmZlDQphbmQgY2Fubm90IGJlIGRlY3JlbWVudGVkIC0gbGVha2luZyB0aGUgbmFtZSBhbmQgYXNzb2NpYXRlZCBpcGNfb2JqZWN0IGJ1dCBhdm9pZGluZyB0aGUgcG9zc2liaWx0eSBvZiBhIG5hbWUgYmVpbmcgb3Zlci1yZWxlYXNlZC4NCg0KSW4gZmFjdCBhbGwgdGhhdCB0aGUgInBlZyIgZG9lcyBpcyBwcmV2ZW50IHRoZSB1cmVmcyBjb3VudCBmcm9tIGV4Y2VlZGluZyAweGZmZmU7IGl0IGRvZXNuJ3QgcHJldmVudCB1c2Vyc3BhY2UgZnJvbSBiZWxpZXZpbmcNCml0IGhhcyBtb3JlIHVyZWZzIHRoYW4gdGhhdCAoYnkgZWcgbWFraW5nIHRoZSBjb3B5b3V0J3MgZmFpbC4pDQoNCldoYXQgZG9lcyB0aGlzIGFjdHVhbGx5IG1lYW4/DQoNCkxldCdzIGNvbnNpZGVyIHRoZSBiZWhhdmlvdXIgb2YgbWFjaF9tc2dfc2VydmVyIG9yIGRpc3BhdGNoX21pZ19zZXJ2ZXIuIFRoZXkgcmVjZWl2ZSBtYWNoIHNlcnZpY2UgbWVzc2FnZXMgaW4gYSBsb29wIGFuZCBpZiB0aGUgbWVzc2FnZQ0KdGhleSByZWNlaWV2ZWQgZGlkbid0IGNvcnJpc3BvbmQgdG8gdGhlIE1JRyBzY2hlbWEgdGhleSBwYXNzIHRoYXQgcmVjZWl2ZWQgbWVzc2FnZSB0byBtYWNoX21zZ19kZXN0cm95LiBIZXJlJ3MgdGhlIGNvZGUgd2hlcmUgbWFjaF9tc2dfZGVzdHJveQ0KZGVzdHJveXMgYW4gb29sX3BvcnRzX2Rlc2NyaXB0b3JfdDoNCg0KICAgIGNhc2UgTUFDSF9NU0dfT09MX1BPUlRTX0RFU0NSSVBUT1IgOiB7DQogICAgICBtYWNoX3BvcnRfdCAgICAgICAgICAgICAgICAgKnBvcnRzOw0KICAgICAgbWFjaF9tc2dfb29sX3BvcnRzX2Rlc2NyaXB0b3JfdCAqZHNjOw0KICAgICAgbWFjaF9tc2dfdHlwZV9udW1iZXJfdCAgICAgIGo7DQoNCiAgICAgIC8qDQogICAgICAgKiBEZXN0cm95IHBvcnQgcmlnaHRzIGNhcnJpZWQgaW4gdGhlIG1lc3NhZ2UgDQogICAgICAgKi8NCiAgICAgIGRzYyA9ICZzYWRkci0+b29sX3BvcnRzOw0KICAgICAgcG9ydHMgPSAobWFjaF9wb3J0X3QgKikgZHNjLT5hZGRyZXNzOw0KICAgICAgZm9yIChqID0gMDsgaiA8IGRzYy0+Y291bnQ7IGorKywgcG9ydHMrKykgIHsNCiAgICAgICAgICBtYWNoX21zZ19kZXN0cm95X3BvcnQoKnBvcnRzLCBkc2MtPmRpc3Bvc2l0aW9uKTsgLy8gY2FsbHMgbWFjaF9wb3J0X2RlYWxsb2NhdGUNCiAgICAgIH0NCiAgICAuLi4NCg0KVGhpcyB3aWxsIGNhbGwgbWFjaF9wb3J0X2RlYWxsb2NhdGUgZm9yIGVhY2ggb29sX3BvcnQgbmFtZSByZWNlaXZlZC4NCg0KSWYgd2Ugc2VuZCBzdWNoIGEgc2VydmljZSBhIG1hY2ggbWVzc2FnZSB3aXRoIGVnIDB4MjAwMDAgY29waWVzIG9mIHRoZSBzYW1lIHBvcnQgcmlnaHQgYXMgb29sIHBvcnRzIHRoZSBpcGNfZW50cnkgZm9yIHRoYXQgbmFtZSB3aWxsIGFjdHVhbGx5IG9ubHkgaGF2ZQ0KMHhmZmZlIHVyZWZzLiBBZnRlciAweGZmZmUgY2FsbHMgdG8gbWFjaF9wb3J0X2RlYWxsb2NhdGUgdGhlIHVyZWZzIHdpbGwgaGl0IDAgYW5kIHRoZSBrZXJuZWwgd2lsbCBmcmVlIHRoZSBpcGNfZW50cnkgYW5kIG1hcmsgdGhhdCBuYW1lIGFzIGZyZWUuIEZyb20gdGhpcw0KcG9pbnQgb24gdGhlIG5hbWUgY2FuIGJlIHJlLXVzZWQgdG8gbmFtZSBhbm90aGVyIHJpZ2h0IChmb3IgZXhhbXBsZSBieSBzZW5kaW5nIGFub3RoZXIgbWVzc2FnZSByZWNlaXZlZCBvbiBhbm90aGVyIHRocmVhZCkgYnV0IHRoZSBmaXJzdCB0aHJlYWQgd2lsbA0Kc3RpbGwgY2FsbCBtYWNoX3BvcnRfZGVhbGxvY2F0ZSAweDEwMDAyIHRpbWVzIG9uIHRoYXQgbmFtZS4NCg0KVGhpcyBsZWFkcyB0byBzb21ldGhpbmcgbGlrZSBhIHVzZS1hZnRlci1kZWFsbG9jYXRlIG9mIHRoZSBtYWNoIHBvcnQgbmFtZSAtIHN0cmljdGx5IGEgdXNlcnNwYWNlIGJ1ZyAodGhlcmUncyBubyBrZXJuZWwgbWVtb3J5IGNvcnJ1cHRpb24gZXRjIGhlcmUpIGJ1dA0KY2F1c2VkIGJ5IGEga2VybmVsIGJ1Zy4NCg0KVGhlIGNoYWxsZW5nZSB0byBleHBsb2l0aW5nIHRoaXMgYnVnIGlzIGdldHRpbmcgdGhlIGV4YWN0IHNhbWUgcG9ydCBuYW1lIHJldXNlZA0KaW4gYW4gaW50ZXJlc3Rpbmcgd2F5Lg0KDQpUaGlzIHJlcXVpcmVzIHVzIHRvIGRpZyBpbiBhIGJpdCB0byBleGFjbHkgd2hhdCBhIHBvcnQgbmFtZSBpcywgaG93IHRoZXkncmUgYWxsb2NhdGVkDQphbmQgdW5kZXIgd2hhdCBjaXJjdW1zdGFuY2VzIHRoZXknbGwgYmUgcmV1c2VkLg0KDQpNYWNoIHBvcnRzIGFyZSBzdG9yZWQgaW4gYSBmbGF0IGFycmF5IG9mIGlwY19lbnRyeXM6DQoNCiAgc3RydWN0IGlwY19lbnRyeSB7DQogICAgc3RydWN0IGlwY19vYmplY3QgKmllX29iamVjdDsNCiAgICBpcGNfZW50cnlfYml0c190IGllX2JpdHM7DQogICAgbWFjaF9wb3J0X2luZGV4X3QgaWVfaW5kZXg7DQogICAgdW5pb24gew0KICAgICAgbWFjaF9wb3J0X2luZGV4X3QgbmV4dDsgICAvKiBuZXh0IGluIGZyZWVsaXN0LCBvci4uLiAgKi8NCiAgICAgIGlwY190YWJsZV9pbmRleF90IHJlcXVlc3Q7ICAvKiBkZWFkIG5hbWUgcmVxdWVzdCBub3RpZnkgKi8NCiAgICB9IGluZGV4Ow0KICB9Ow0KDQptYWNoIHBvcnQgbmFtZXMgYXJlIG1hZGUgdXAgb2YgdHdvIGZpZWxkcywgdGhlIHVwcGVyIDI0IGJpdHMgYXJlIGFuIGluZGV4IGludG8gdGhlIGlwY19lbnRyeXMgdGFibGUNCmFuZCB0aGUgbG93ZXIgOCBiaXRzIGFyZSBhIGdlbmVyYXRpb24gbnVtYmVyLiBFYWNoIHRpbWUgYW4gZW50cnkgaW4gdGhlIGlwY19lbnRyeXMgdGFibGUgaXMgcmV1c2VkDQp0aGUgZ2VuZXJhdGlvbiBudW1iZXIgaXMgaW5jcmVtZW50ZWQuIFRoZXJlIGFyZSA2NCBnZW5lcmF0aW9ucywgc28gYWZ0ZXIgYW4gZW50cnkgaGFzIGJlZW4gcmVhbGxvY2F0ZWQNCjY0IHRpbWVzIGl0IHdpbGwgaGF2ZSB0aGUgc2FtZSBnZW5lcmF0aW9uIG51bWJlci4NCg0KVGhlIGdlbmVyYXRpb24gbnVtYmVyIGlzIGNoZWNrZWQgaW4gaXBjX2VudHJ5X2xvb2t1cDoNCg0KICBpZiAoaW5kZXggPCAgc3BhY2UtPmlzX3RhYmxlX3NpemUpIHsNCiAgICAgICAgICAgICAgICBlbnRyeSA9ICZzcGFjZS0+aXNfdGFibGVbaW5kZXhdOw0KICAgIGlmIChJRV9CSVRTX0dFTihlbnRyeS0+aWVfYml0cykgIT0gTUFDSF9QT1JUX0dFTihuYW1lKSB8fA0KICAgICAgICBJRV9CSVRTX1RZUEUoZW50cnktPmllX2JpdHMpID09IE1BQ0hfUE9SVF9UWVBFX05PTkUpDQogICAgICBlbnRyeSA9IElFX05VTEw7ICAgIA0KICB9DQoNCmhlcmUgZW50cnkgaXMgdGhlIGlwY19lbnRyeSBzdHJ1Y3QgaW4gdGhlIGtlcm5lbCBhbmQgbmFtZSBpcyB0aGUgdXNlci1zdXBwbGllZCBtYWNoIHBvcnQgbmFtZS4NCg0KRW50cnkgYWxsb2NhdGlvbjoNClRoZSBpcGNfZW50cnkgdGFibGUgbWFpbnRhaW5zIGEgc2ltcGxlIExJRk8gZnJlZSBsaXN0IGZvciBlbnRyaWVzOyBpZiB0aGlzIGxpc3QgaXMgZnJlZSB0aGUgdGFibGUgd2lsbCANCmJlIGdyb3duLiBUaGUgdGFibGUgaXMgbmV2ZXIgc2hydW5rLg0KDQpSZWxpYWJseSBsb29waW5nIG1hY2ggcG9ydCBuYW1lczoNClRvIGV4cGxvaXQgdGhpcyBidWcgd2UgbmVlZCBhIHByaW1pdGl2ZSB0aGF0IGFsbG93cyB1cyB0byBsb29wIGEgbWFjaCBwb3J0J3MgZ2VuZXJhdGlvbiBudW1iZXIgYXJvdW5kLg0KDQpBZnRlciB0cmlnZ2VyaW5nIHRoZSB1cmVmcyBidWcgdG8gZnJlZSB0aGUgdGFyZ2V0IG1hY2ggcG9ydCBuYW1lIGluIHRoZSB0YXJnZXQgcHJvY2VzcyB3ZSBpbW1lZGlhdGVseQ0Kc2VuZCBhIG1lc3NhZ2Ugd2l0aCBOIG9vbCBwb3J0cyAod2l0aCBzZW5kIHJpZ2h0cykgYW5kIG5vIHJlcGx5IHBvcnQuIFNpbmNlIHRoZSB0YXJnZXQgcG9ydCB3YXMgdGhlIG1vc3QgcmVjZW50bHkNCmZyZWVkIGl0IHdpbGwgYmUgYXQgdGhlIGhlYWQgb2YgdGhlIGZyZWVsaXN0IGFuZCB3aWxsIGJlIHJldXNlZCB0byBuYW1lIHRoZSBmaXJzdCBvZiB0aGUgb29sIHBvcnRzDQpjb250YWluZWQgaW4gdGhlIG1lc3NhZ2UgKGJ1dCB3aXRoIGFuIGluY3JlbWVudGVkIGdlbmVyYXRpb24gbnVtYmVyLikNClNpbmNlIHRoaXMgbWVzc2FnZSBpcyBub3QgZXhwZWN0ZWQgYnkgdGhlIHNlcnZpY2UgKGluIHRoaXMgY2FzZSB3ZSBzZW5kIGFuDQppbnZhbGlkIFhQQyByZXF1ZXN0IHRvIGxhdW5jaGQpIGl0IHdpbGwgZ2V0IHBhc3NlZCB0byBtYWNoX21zZ19kZXN0cm95IHdoaWNoIHdpbGwgcGFzcyBlYWNoIG9mIA0KdGhlIHBvcnRzIHRvIG1hY2hfcG9ydF9kZWFsbG9jYXRlIGZyZWVpbmcgdGhlbSBpbiB0aGUgb3JkZXIgaW4gd2hpY2ggdGhleSBhcHBlYXIgaW4gdGhlIG1lc3NhZ2UuIFNpbmNlIHRoZQ0KZnJlZWQgcG9ydCB3YXMgcmV1c2VkIHRvIG5hbWUgdGhlIGZpcnN0IG9vbCBwb3J0IGl0IHdpbGwgYmUgdGhlIGZpcnN0IHRvIGJlIGZyZWVkLiBUaGlzIHdpbGwgcHVzaCB0aGUgbmFtZQ0KTiBlbnRyaWVzIGRvd24gdGhlIGZyZWVsaXN0Lg0KDQpXZSB0aGVuIHNlbmQgYW5vdGhlciA2MiBvZiB0aGVzZSBsb29wZXIgbWVzc2FnZXMgYnV0IHdpdGggMk4gb29sIHBvcnRzLiBUaGlzIGhhcyB0aGUgZWZmZWN0IG9mIGxvb3BpbmcgdGhlIGdlbmVyYXRpb24NCm51bWJlciBvZiB0aGUgdGFyZ2V0IHBvcnQgYXJvdW5kIHdoaWxlIGxlYXZpbmcgaXQgaW4gYXBwcm94aW1hdGVseSB0aGUgbWlkZGxlIG9mIHRoZSBmcmVlbGlzdC4gVGhlIG5leHQgdGltZSB0aGUgdGFyZ2V0IGVudHJ5DQppbiB0aGUgdGFibGUgaXMgYWxsb2NhdGVkIGl0IHdpbGwgaGF2ZSBleGFjdGx5IHRoZSBzYW1lIG1hY2ggcG9ydCBuYW1lIGFzIHRoZSBvcmlnaW5hbCB0YXJnZXQgcmlnaHQgd2UNCnRyaWdnZXJlZCB0aGUgdXJlZnMgYnVnIG9uLg0KDQpGb3IgdGhpcyBpT1MgZXhwbG9pdCBJIHRhcmdldCB0aGUgc2VuZCByaWdodCB0byBjb20uYXBwbGUuaW9oaWRldmVudHN5c3RlbSB3aGljaCBsYXVuY2hkIGhhcywgYW5kIHdoaWNoIEkgY2FuIGxvb2t1cCBmcm9tIGluc2lkZSB0aGUNCmNvbnRhaW5lciBzYW5kYm94DQoNCkkgbG9vayB1cCB0aGUgaW9oaWRldmVudHN5c3RlbSBzZXJ2aWNlIGluIGxhdW5jaGQgdGhlbiB1c2UgdGhlIHVyZWZzIGJ1ZyB0byBmcmVlIGxhdW5jaGQncyBzZW5kIHJpZ2h0IGFuZCB1c2UgdGhlDQpsb29wZXIgbWVzc2FnZXMgdG8gc3BpbiB0aGUgZ2VuZXJhdGlvbiBudW1iZXIgcm91bmQuIEkgdGhlbiByZWdpc3RlciBhIGxhcmdlIG51bWJlciBvZiBkdW1teSBzZXJ2aWNlcw0Kd2l0aCBsYXVuY2hkIHNvIHRoYXQgb25lIG9mIHRoZW0gcmV1c2VzIHRoZSBzYW1lIG1hY2ggcG9ydCBuYW1lIGFzIGxhdW5jaGQgdGhpbmtzIHRoZSBpb2hpZGV2ZW50c3lzdGVtIHNlcnZpY2UgaGFzLg0KKFdlIGNhbid0IHJlZ2lzdGVyIGdsb2JhbCBtYWNoIHNlcnZpY2VzIGZyb20gaW5zaWRlIHRoZSBjb250YWluZXIgc2FuZGJveCBidXQgd2UgY2FuIHJlZ2lzdGVyIEFwcCBHcm91cC1yZXN0cmljdGVkDQpzZXJ2aWNlcywgd2hpY2ggd29yayBqdXN0IHRoZSBzYW1lIGZvciBvdXIgcHVycG9zZXMuIFRoaXMgaXMgd2h5IHRoZSBleHBsb2l0IG5lZWRzIHRoZSBBcHAgR3JvdXBzIGNhcGFiaWxpdHkuKQ0KDQpOb3cgd2hlbiBhbnkgcHJvY2VzcyBsb29rcyB1cCBjb20uYXBwbGUuaW9oaWRldmVudHN5c3RlbSBsYXVuY2hkIHdpbGwgYWN0dWFsbHkgc2VuZCB0aGVtIGEgc2VuZCByaWdodA0KdG8gb25lIG9mIG15IGR1bW15IHNlcnZpY2VzIDopDQoNCkkgYWRkIGFsbCB0aG9zZSBkdW1teSBzZXJ2aWNlcyB0byBhIHBvcnRzZXQgYW5kIHVzZSB0aGF0IHJlY2lldmUgcmlnaHQgYW5kIHRoZSBsZWdpdGltYXRlIGlvaGlkZXZlbnRzeXN0ZW0gc2VuZCByaWdodA0KSSBzdGlsbCBoYXZlIHRvIE1JVE0gYWxsIHRoZXNlIG5ldyBjb25uZWN0aW9ucyB0byBpb2hpZGV2ZW50c3lzdGVtLiBBcyBtZW50aW9uZWQgZWFybGllciBjbGllbnRzIG9mIGlvaGlkZXZlbnRzeXN0ZW0gc2VuZA0KaXQgdGhlaXIgdGFzayBwb3J0cywgc28gYWxsIEkgaGF2ZSB0byBkbyBpcyBjcmFzaCBhIHByb2Nlc3Mgd2hpY2ggcnVucyBhcyByb290IGFuZCBpcyBhIGNsaWVudCBvZiBpb2hpZGV2ZW50c3lzdGVtLiBXaGVuIGl0DQpyZXN0YXJ0cyBpdCB3aWxsIHNlbmQgaXQncyB0YXNrIHBvcnQgdG8gbWUgOi0pDQoNCioqKiBQb3dlcmQgY3Jhc2hlciAqKioNCg0KVG8gY3Jhc2ggcG93ZXJkIEkgdXNlIENWRS0yMDE2LTc2NjE6DQoNCnBvd2VyZCBjaGVja3MgaW4gd2l0aCBsYXVuY2hkIHRvIGdldCBhIHNlcnZlciBwb3J0IGFuZCB0aGVuIHdyYXBzIHRoYXQgaW4gYSBDRlBvcnQ6DQoNCiAgcG1TZXJ2ZXJNYWNoUG9ydCA9IF9TQ19DRk1hY2hQb3J0Q3JlYXRlV2l0aFBvcnQoDQogICAgICAgICAgICAgICAgICAgICAgICAgICJQb3dlck1hbmFnZW1lbnQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2ZXJQb3J0LCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgbWlnX3NlcnZlcl9jYWxsYmFjaywgDQogICAgICAgICAgICAgICAgICAgICAgICAgICZjb250ZXh0KTsNCg0KSXQgYWxzbyBhc2tzIHRvIHJlY2VpdmUgZGVhZCBuYW1lIG5vdGlmaWNhdGlvbnMgZm9yIG90aGVyIHBvcnRzIG9uIHRoYXQgc2FtZSBzZXJ2ZXIgcG9ydDoNCg0KICBtYWNoX3BvcnRfcmVxdWVzdF9ub3RpZmljYXRpb24oDQogICAgICAgICAgICAgIG1hY2hfdGFza19zZWxmKCksICAgICAgICAgICAvLyB0YXNrDQogICAgICAgICAgICAgIG5vdGlmeV9wb3J0X2luLCAgICAgICAgICAgICAgICAgLy8gcG9ydCB0aGF0IHdpbGwgZGllDQogICAgICAgICAgICAgIE1BQ0hfTk9USUZZX0RFQURfTkFNRSwgICAgICAvLyBtc2dpZA0KICAgICAgICAgICAgICAxLCAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWFrZS1zZW5kIGNvdW50DQogICAgICAgICAgICAgIENGTWFjaFBvcnRHZXRQb3J0KHBtU2VydmVyTWFjaFBvcnQpLCAgICAgICAgLy8gbm90aWZ5IHBvcnQNCiAgICAgICAgICAgICAgTUFDSF9NU0dfVFlQRV9NQUtFX1NFTkRfT05DRSwgICAgICAgICAgICAgICAvLyBub3RpZnlQb2x5DQogICAgICAgICAgICAgICZvbGROb3RpZnkpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJldmlvdXMNCg0KbWlnX3NlcnZlcl9jYWxsYmFjayBpcyBjYWxsZWQgb2ZmIG9mIHRoZSBtYWNoIHBvcnQgcnVuIGxvb3Agc291cmNlIHRvIGhhbmRsZSBuZXcgbWVzc2FnZXMgb24gcG1TZXJ2ZXJNYWNoUG9ydDoNCg0KICBzdGF0aWMgdm9pZA0KICBtaWdfc2VydmVyX2NhbGxiYWNrKENGTWFjaFBvcnRSZWYgcG9ydCwgdm9pZCAqbXNnLCBDRkluZGV4IHNpemUsIHZvaWQgKmluZm8pDQogIHsNCiAgICAgIG1pZ19yZXBseV9lcnJvcl90ICogYnVmUmVxdWVzdCA9IG1zZzsNCiAgICAgIG1pZ19yZXBseV9lcnJvcl90ICogYnVmUmVwbHkgPSBDRkFsbG9jYXRvckFsbG9jYXRlKA0KICAgICAgICAgIE5VTEwsIF9wb3dlcm1hbmFnZW1lbnRfc3Vic3lzdGVtLm1heHNpemUsIDApOw0KICAgICAgbWFjaF9tc2dfcmV0dXJuX3QgICBtcjsNCiAgICAgIGludCAgICAgICAgICAgICAgICAgb3B0aW9uczsNCg0KICAgICAgX19NQUNIX1BPUlRfREVCVUcodHJ1ZSwgIm1pZ19zZXJ2ZXJfY2FsbGJhY2siLCBzZXJ2ZXJQb3J0KTsNCiAgICAgIA0KICAgICAgLyogd2UgaGF2ZSBhIHJlcXVlc3QgbWVzc2FnZSAqLw0KICAgICAgKHZvaWQpIHBtX21pZ19kZW11eCgmYnVmUmVxdWVzdC0+SGVhZCwgJmJ1ZlJlcGx5LT5IZWFkKTsNCg0KVGhpcyBwYXNzZXMgdGhlIHJhdyBtZXNzYWdlIHRvIHBtX21pZ19kZW11eDoNCg0KICBzdGF0aWMgYm9vbGVhbl90IA0KICBwbV9taWdfZGVtdXgoDQogICAgICBtYWNoX21zZ19oZWFkZXJfdCAqIHJlcXVlc3QsDQogICAgICBtYWNoX21zZ19oZWFkZXJfdCAqIHJlcGx5KQ0KICB7DQogICAgICBtYWNoX2RlYWRfbmFtZV9ub3RpZmljYXRpb25fdCAqZGVhZFJlcXVlc3QgPSANCiAgICAgICAgICAgICAgICAgICAgICAobWFjaF9kZWFkX25hbWVfbm90aWZpY2F0aW9uX3QgKilyZXF1ZXN0Ow0KICAgICAgYm9vbGVhbl90IHByb2Nlc3NlZCA9IEZBTFNFOw0KDQogICAgICBwcm9jZXNzZWQgPSBwb3dlcm1hbmFnZW1lbnRfc2VydmVyKHJlcXVlc3QsIHJlcGx5KTsNCg0KICAgICAgaWYgKHByb2Nlc3NlZCkgDQogICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICANCiAgICAgIGlmIChNQUNIX05PVElGWV9ERUFEX05BTUUgPT0gcmVxdWVzdC0+bXNnaF9pZCkgDQogICAgICB7DQogICAgICAgICAgX19NQUNIX1BPUlRfREVCVUcodHJ1ZSwgInBtX21pZ19kZW11eDogRGVhZCBuYW1lIHBvcnQgc2hvdWxkIGhhdmUgMSsgc2VuZCByaWdodChzKSIsIGRlYWRSZXF1ZXN0LT5ub3RfcG9ydCk7DQoNCiAgICAgICAgICBQTUNvbm5lY3Rpb25IYW5kbGVEZWFkTmFtZShkZWFkUmVxdWVzdC0+bm90X3BvcnQpOw0KDQogICAgICAgICAgX19NQUNIX1BPUlRfREVCVUcodHJ1ZSwgInBtX21pZ19kZW11eDogRGVhbGxvY2F0aW5nIGRlYWQgbmFtZSBwb3J0IiwgZGVhZFJlcXVlc3QtPm5vdF9wb3J0KTsNCiAgICAgICAgICBtYWNoX3BvcnRfZGVhbGxvY2F0ZShtYWNoX3Rhc2tfc2VsZigpLCBkZWFkUmVxdWVzdC0+bm90X3BvcnQpOw0KICAgICAgICAgIA0KICAgICAgICAgIHJlcGx5LT5tc2doX2JpdHMgICAgICAgICAgICA9IDA7DQogICAgICAgICAgcmVwbHktPm1zZ2hfcmVtb3RlX3BvcnQgICAgID0gTUFDSF9QT1JUX05VTEw7DQoNCiAgICAgICAgICByZXR1cm4gVFJVRTsNCiAgICAgIH0NCg0KVGhpcyBwYXNzZXMgdGhlIG1lc3NhZ2UgdG8gdGhlIE1JRy1nZW5lcmF0ZWQgY29kZSBmb3IgdGhlIHBvd2VybWFuYWdlbWVudCBzdWJzeXN0ZW0sIGlmIHRoYXQgZmFpbHMgKGJlY2F1c2UgdGhlIG1zZ2hfaWQgZG9lc24ndA0KbWF0Y2ggdGhlIHN1YnN5c3RlbSBmb3IgZXhhbXBsZSkgdGhlbiB0aGlzIGNvbXBhcmVzIHRoZSBtZXNzYWdlJ3MgbXNnaF9pZCBmaWVsZCB0byBNQUNIX05PVElGWV9ERUFEX05BTUUuDQoNCmRlYWRSZXF1ZXN0IGlzIHRoZSBtZXNzYWdlIGNhc3QgdG8gYSBtYWNoX2RlYWRfbmFtZV9ub3RpZmljYXRpb25fdCB3aGljaCBpcyBkZWZpbmVkIGxpa2UgdGhpcyBpbiBtYWNoL25vdGlmeS5oOg0KDQogIHR5cGVkZWYgc3RydWN0IHsNCiAgICAgIG1hY2hfbXNnX2hlYWRlcl90ICAgbm90X2hlYWRlcjsNCiAgICAgIE5EUl9yZWNvcmRfdCAgICAgICAgTkRSOw0KICAgICAgbWFjaF9wb3J0X25hbWVfdCBub3RfcG9ydDsvKiBNQUNIX01TR19UWVBFX1BPUlRfTkFNRSAqLw0KICAgICAgbWFjaF9tc2dfZm9ybWF0XzBfdHJhaWxlcl90IHRyYWlsZXI7DQogIH0gbWFjaF9kZWFkX25hbWVfbm90aWZpY2F0aW9uX3Q7DQoNClRoaXMgaXMgYSBzaW1wbGUgbWVzc2FnZSwgbm90IGEgY29tcGxleCBvbmUuIG5vdF9wb3J0IGlzIGp1c3QgYSBjb21wbGV0ZWx5IGNvbnRyb2xsZWQgaW50ZWdlciB3aGljaCBpbiB0aGlzIGNhc2Ugd2lsbCBnZXQgcGFzc2VkIGRpcmVjdGx5IHRvDQptYWNoX3BvcnRfZGVhbGxvY2F0ZS4NCg0KVGhlIHBvd2VyZCBjb2RlIGV4cGVjdHMgdGhhdCBvbmx5IHRoZSBrZXJuZWwgd2lsbCBzZW5kIGEgTUFDSF9OT1RJRllfREVBRF9OQU1FIG1lc3NhZ2UgYnV0IGFjdHVhbGx5IGFueW9uZSBjYW4gc2VuZCB0aGlzIGFuZCBmb3JjZSB0aGUgcHJpdmlsZWdlZCBwcm9jZXNzDQp0byBkcm9wIGEgcmVmZXJlbmNlIG9uIGEgY29udHJvbGxlZCBtYWNoIHBvcnQgbmFtZSA6KQ0KDQpNdWx0aXBsZXhpbmcgdGhlc2UgdHdvIHRoaW5ncyAobm90aWZpY2F0aW9ucyBhbmQgYSBtYWNoIHNlcnZpY2UpIG9udG8gdGhlIHNhbWUgcG9ydCBpc24ndCBwb3NzaWJsZSB0byBkbyBzYWZlbHkgYXMgdGhlIGtlcm5lbCBkb2Vzbid0IHByZXZlbnQNCnVzZXItPnVzZXIgc3Bvb2Zpbmcgb2Ygbm90aWZpY2F0aW9uIG1lc3NhZ2VzIC0gdXN1YWxseSB0aGlzIHdvdWxkbid0IGJlIGEgcHJvYmxlbSBhcyBhdHRhY2tlcnMgc2hvdWxkbid0IGhhdmUgYWNjZXNzIHRvIHRoZSBub3RpZmljYXRpb24gcG9ydC4NCg0KWW91IGNvdWxkIHByb2JhYmx5IGRvIHF1aXRlIGludGVyZXN0aW5nIHRoaW5ncyB3aXRoIHRoaXMgYnVnIGJ1dCBpbiB0aGlzIGNhc2UgSSBqdXN0IHdhbnQgdG8gY3Jhc2ggdGhlIHNlcnZpY2UuIEkgZG8gdGhhdCBieSBzcG9vZmluZyBuby1tb3JlLXNlbmRlcnMNCm5vdGlmaWNhdGlvbnMgZm9yIHBvd2VyZCdzIHRhc2sgcG9ydC4gT25jZSBwb3dlcmQncyBzZW5kIHJpZ2h0IHRvIGl0cyBvd24gdGFzayBwb3J0IGhhcyBiZWVuIGZyZWVkIHByZXR0eSBtdWNoIGV2ZXJ5dGhpbmcgYnJlYWtzIC0gaW4gdGhpcyBjYXNlDQpJIHNlbmQgYSBjb3B5X3Bvd2Vyc291cmNlc19pbmZvIG1lc3NhZ2UsIHRoZSByZWNldmluZyBjb2RlIGRvZXNuJ3QgY2hlY2sgdGhlIHJldHVybiB2YWx1ZSBvZiBhIGNhbGwgdG8gbWFjaF92bV9hbGxvY2F0ZSB3aGljaCBmYWlscyBiZWNhdXNlIHRoZQ0KdGFzaydzIHRhc2sgcG9ydCBpcyB3cm9uZyBhbmQgbGVhZHMgdG8gdGhlIHVzZSBvZiBhbiB1bmluaXRpYWxpemVkIHBvaW50ZXIuDQoNCioqKiBLZXJuZWwgQnVnICoqKioNCg0KU2VlIGFib3ZlIGZvciBhIHNob3J0IHdyaXRldXAgb2YgdGhlIGtlcm5lbCBidWcgZXhwbG9pdC4gSSB3aWxsIHRyeSB0byB3cml0ZSBhIGxvbmctZm9ybSB3cml0ZXVwIHNvb24sIGJ1dCB0aGUgY29kZSBzaG91bGQgYmUga2luZCBvZiBjbGVhci4NCg0KKioqIFBvc3QtZXhwbG9pdGF0aW9uICoqKioNCg0KSSd2ZSB0YWtlbiBhIHNsaWdodGx5IGRpZmZlcmVudCBhcHByb2FjaCBwb3N0LWV4cGxvaXRhdGlvbi4gRXZlcnl0aGluZyBpcyBkYXRhLW9ubHksIEkgZG9uJ3QgbWFrZSBhbnkgcGF0Y2hlcyB0byByL28ga2VybmVsIG1lbW9yeS4gVGhpcyBtZWFucw0KdGhpbmdzIHNob3VsZCBhbHNvIHdvcmsgb24gdGhlIGlQaG9uZSA3IGJ1dCBJIGRvbid0IGhhdmUgb25lIHRvIHRlc3QgOigNCg0KVGhlcmUgYXJlIGEgbnVtYmVyIG9mIGRvd25zaWRlcyB0byB0YWtpbmcgdGhpcyBhcHByb2FjaCB0aG91Z2g6DQogICogdGVjaG5pY2FsbHkgYSBsb3Qgb2YgdGhlc2UgdGhpbmdzIEkgZG8gYXJlIHJhY3ksIGJ1dCBpbiBwcmF0aWNlIGl0IHdvcmtzIHBlcmZlY3RseSB3ZWxsIGVub3VnaCBmb3IgYSByZXNlYXJjaCBwbGF0Zm9ybQ0KICAqIHNvbWUgdGhpbmdzIGJlY29tZSBxdWl0ZSBmaWRkbHkgd2hpY2ggYXJlIHNpbXBsZSB3aXRoIGEgVEVYVCBwYXRjaA0KDQpUaGlzIGlzIGFsc28gYSByZXNlYXJjaCBwcm9qZWN0IGZvciBtZTsgdGhlcmUgYXJlIGFsbW9zdCBjZXJ0YWlubHkgZmFyIG1vcmUgZG93bnNpZGVzIHRoYXQgSSdtIG5vdCBhd2FyZSBvZi4gaU9TIGlzIGNvbXBsZXgsIHVuZG9jdW1lbnRlZCBwbGFjZQ0KYW5kIEkgZG9uJ3QgcmVhbGx5IGtub3cgd2hhdCBJJ20gZG9pbmchDQoNClRoZSBmbG93IHdvcmtzIGxpa2UgdGhpczoNCg0KV2FsayB0aGUgcHJvY2VzcyBsaXN0IGFuZCBmaW5kIHRoZSBmb2xsb3dpbmcgdGFza3M6DQogYW1maWQNCiBtYWNoX3BvcnRhbA0KIGNvbnRhaW5lcm1hbmFnZXJkDQogbGF1bmNoZA0KDQpEaXNhYmxlIHRoZSBzYW5kYm94Og0KICBzYl9ldmFsdWF0ZSBoYXMgYSBzaG9ydC1jaXJjdWl0IHN1Y2Nlc3MgcGF0aCBpZiB0aGUgcHJvY2VzcyBoYXMgdGhlIGtlcm5fY3JlZCBjcmVkZW50aWFsczsgbmVpdGhlciB0aGUgcGxhZm9ybSBwb2xpY3kgbm9yDQogIHRoZSBwcm9jZXNzJ3Mgc2FuZGJveCBwcm9maWxlIHdpbGwgYmUgZXZhbHVhdGVkLiBXZSBjYW4gdXNlIHRoZSBrZXJuZWwgbWVtb3J5IGFjY2VzcyB0byBnaXZlIHRoZSBtYWNoX3BvcnRhbCBwcm9jZXNzIHRoZQ0KICBrZXJuZWwncyBjcmVkZW50aWFscyBhbmQgd2UncmUgbm8gbG9uZ2VyIHNhbmRib3hlZC4NCg0KRml4IGxhdW5jaGQ6DQogIFRoZSBzYW5kYm94IGVzY2FwZSBtYWRlIGEgbWVzcyBpbiBsYXVuY2hkIHNvIEkgZml4IHVwIGxhdW5jaGQncyBzZW5kIHJpZ2h0IHRvIGlvaGlkZXZlbnRzeXN0ZW0gdG8gcG9pbnQgYmFjayB0byB0aGUgY29ycmVjdCBwb3J0Lg0KICBJIHRoZW4gcmVzdGFydCBwb3dlcmQgYmVjYXVzZSBvdGhlcndpc2Ugd2UgaGl0IGEgd2F0Y2hkb2cgdGltZW91dC4NCg0KUGF0Y2ggYW1maWQ6DQogIEluIG9yZGVyIHRvIHJ1biB1bnNpZ25lZCBiaW5hcmllcyBhbmQgaGF2ZSBzb21ldGhpZ24gbGlrZSBhIHByb3BlciBzaGVsbCBlbnZpcm9ubWVudCB3ZSBuZWVkIHRvIGNvbnZpbmNlIGFtZmlkIHRvIGFsbG93IGJpbmFyaWVzIHdpdGggaW52YWxpZA0KICBzaWduYXR1cmVzLiBQcmV2aW91cyBlZmZvcnRzIGluIHRoaXMgYXJlYSBoYXZlIHJlcGxhY2VkIGFtZmlkcyBpbXBvcnQgb2YgTUlTVmFsaWRhdGVTaWduYXR1cmUgdG8gYSBmdW5jdGlvbiB3aGljaCB3b3VsZCBhbHdheXMgcmV0dXJuIDAgKHN1Y2Nlc3MpDQogIGJ1dCBhbWZpZCBub3cgY2FsbHMgTUlTVmFsaWRhdGVTaWduYXR1cmVBbmRDb3B5SW5mbyB3aGljaCB0YWtlcyBhbiBvdXQgcG9pbnRlciB0byBhIENGRGljdGlvbmFyeSB3aGljaCBpcyBleHBlY3RlZCB0byBjb250YWluIHRoZSBjb3JyZWN0IENESGFzaA0KICBzbyBqdXN0IHJlcGxhY2luZyB0aGUgaW1wb3J0IHdvbid0IHdvcmsuIEkgaW5zdGVhZCBzZXQgbXlzZWxmIGFzIGFtZmlkJ3MgZXhjZXB0aW9uIGhhbmRsZXIgYW5kIHBvaW50IHRoZSBNSVNWYWxpZGF0ZVNpZ25hdHVyZUFuZENvcHlJbmZvIHRvIGFuIGludmFsaWQNCiAgYWRkcmVzcy4gVGhpcyBtZWFucyB0aGF0IGFtZmlkIHdpbGwgY3Jhc2ggd2hlbmV2ZXIgaXQgdmFsaWRhdGVzIGEgc2lnbmF0dXJlLCBhbmQgc2luY2Ugd2UncmUgdGhlIGV4Y2VwdGlvbiBoYW5kbGVyIHdlIGdldCBhIG1lc3NhZ2Ugb24gdGhlIGV4Y2VwdGlvbiBwb3J0DQogIHdpdGggdGhlIGNyYXNoaW5nIHRocmVhZCBzdGF0ZS4gSSByZWFkIHRoZSBwYXRoIHRvIHRoZSBmaWxlIHRvIGJlIHZhbGlkYXRlZCBmcm9tIGFtZmlkJ3MgYWRkcmVzcyBzcGFjZSwgY29tcHV0ZSB0aGUgQ0RIYXNoIFNIQTEgbXlzZWxmIGFuZCB3cml0ZSB0aGF0IGludG8gdGhlDQogIHJlcGx5IG1lc3NhZ2Ugd2hpY2ggYW1maWQgd2lsbCBzZW5kIGJhY2sgdG8gdGhlIGtlcm5lbCB0aGVuIHJlc3VtZSBleGVjdXRpb24gb2YgYW1maWQgc28gaXQgY2FuIHNlbmQgdGhlIHJlcGx5Lg0KDQpVbnNhbmRib3ggY29udGFpbmVybWFuZ2VyZDoNCiAgU2luY2UgSSBoYXZlbid0IGhhZCB0aW1lIHRvIGludmVzdGlnYXRlIEx2Vk0geWV0IEkgZG9uJ3QgcmVtb3VudCB0aGUgcm9vdGZzIHIvdyB3aGljaCBtZWFucyB0aGF0IGFsbCB0aGUgYmluYXJpZXMgd2UgcnVuIGFyZSBmcm9tIHRoZSB1c2VyIHBhcnRpdGlvbi4gVGhpcyBtZWFucw0KICB0aGF0IHdlIGNhbid0IHByZXZlbnQgdGhlIGtlcm5lbCBmcm9tIHJlcXVlc3RpbmcgdGhhdCBjb250YWluZXJtYW5hZ2VyZCBhbGxvY2F0ZSBhIGNvbnRhaW5lciBmb3IgdGhlbS4gSSBkaWQgdGVzdCBvdXQgZG9pbmcgYSBzaW1pbGFyIHBhdGNoIGZvciBjb250YWluZXJtYW5hZ2VyZA0KICBhcyBJIGRpZCBmb3IgYW1maWQgd2hpY2ggcGFyc2VkIHRoZSBzYl9wYWNrYnVmZiByZXF1ZXN0cyBmcm9tIHRoZSBrZXJuZWwgYW5kIGZpeGVkIHRoZW0gdXAgc28gdGhhdCBjb250YWluZXJtYW5hZ2VyZCBkaWRuJ3QgZ2V0IHVwc2V0IGJ1dCBpdCBzZWVtZWQgZWFzaWVyIHRvDQogIGp1c3QgdW5zYW5kYm94IGl0IHNvIGl0IGNhbiBtYWtlIHRoZSBkaXJlY3RvcmllcyBpdCB3YW50cy4gVGhpcyBkZWNpc2lvbiBzaG91bGQgYmUgcmV2aXNpdGVkLCBpdCdzIG5vdCBpZGVhbCENCg0KTWFrZSBzdXJlIGFsbCBjaGlsZCBwcm9jZXNzZXMgYXJlIGFsc28gdW5zYW5kYm94ZWQ6DQogIFNpbmNlIHRoZSBzYW5kYm94IGRlZmVhdCBpbnZvbHZlcyBjaGVhdGluZyBieSB1c2luZyB0aGUga2Vybl9jcmVkIHdlIG5lZWQgYSB3YXkgdG8gbWFrZSBzdXJlIGFsbCBvdXIgY2hpbGQgcHJvY2Vzc2VzIGFsc28gaGF2ZSB0aGUga2Vybl9jcmVkLiBUaGlzIGlzIGtpbmQgb2YgYSBoYWNrDQogIGJ1dCBpdCB3b3JrcyBmaW5lIGZvciBteSBwdXJwb3Nlcy4gWW91IHNob3VsZCByZWFsbHkgcmV2aXNpdCB0aGlzIGlmIHlvdSB3YW50IHRvIGltcHJvdmUgb24gdGhpcyBjb2RlIQ0KICBJIGFsbG9jYXRlIGEgbmV3IG1hY2ggcG9ydCBhbmQgc2V0IHRoYXQgYXMgbXkgYm9vdHN0cmFwIHBvcnQgYW5kIHNwaW4gdXAgYSB0aHJlYWQgd2hpY2ggbWl0bSdzIGJldHdlZW4gdGhhdCBwb3J0IGFuZCBhIHJlYWwgc2VuZCByaWdodCB0byBsYXVuY2hkLiBJIHJlcXVlc3QgYW4gYXVkaXQNCiAgdHJhaWxlciB3aXRoIGVhY2ggbWVzc2FnZSB3aGljaCBhbGxvd3MgbWUgdG8gZ2V0IHRoZSBzZW5kZXIgb2YgdGhlIG1lc3NhZ2UgYW5kIHRodXMgYmUgbm90aWZpZWQgd2hlbiBhIG5ldyBjaGlsZCBzdGFydHMuIEkgdGhlbiB1c2UgdGhlIGtlcm5lbCBtZW1vcnkgYWNjZXNzIHRvDQogIGZpbmQgdGhhdCBwaWQncyBwcm9jIHN0cnVjdHVyZSBhbmQgZ2l2ZSBpdCBhbmQgYWxsIGl0cyB0aHJlYWRzIHRoZSBrZXJuZWwgY3JlZHMuIEEgY29uc3RydWN0b3IgaW4gbGlieHBjIHdpbGwgbWFrZSBhIHN5bmNocm9ub3VzIHJlcXVlc3QgdG8gdGhlIGJvb3RzdHJhcA0KICBwb3J0IGR1cmluZyBkeWxkIGluaXRpYWxpemF0aW9uIGJlZm9yZSBhbnkgYXBwbGljYXRpb24gY29kZSBhY3R1YWxseSBydW5zIHNvIHRoaXMgd29ya3Mgd2VsbCBlbm91Z2ggdG8gYWxsb3cgYWxsIG91ciBjaGlsZHJlbiB0byBydW4gdW5zYW5kYm94ZWQNCg0KU2V0IGtlcm5lbCB0YXNrIHBvcnQgYXMgaG9zdCBzcGVjaWFsIHBvcnQ6DQogIEkgYWxzbyBzZXQgdGhlIGtlcm5lbCB0YXNrIHBvcnQgYXMgaG9zdCBzcGVjaWFsIHBvcnQgNCBzbyB5b3UgY2FuIGVhc2lseSBnZXQgYXQgaXQgd2l0aG91dCBoYXZpbmcgdG8gcmV3cml0ZSB0aGUgZXhwbG9pdCBjb2RlLg0KDQpTaGVsbDoNCiAgSSBjaG1vZCBldmVyeXRoaW5nIGluIHRoZSBpb3NiaW5wYWNrNjQgZGlyZWN0b3J5IHRvIGJlIGV4ZWN1dGFibGUgdGhlbiBydW4gYmFzaCBvbiBhIGJpbmQgc2hlbGwgb24gcG9ydCA0MTQxLiBUaGlzIGlzbid0IGlkZWFsIGJ1dCBpcyBlbm91Z2ggdG8gcnVuIHRlc3QgdG9vbHMNCiAgYW5kIGV4cGxvcmUgdGhlIHN5c3RlbSwgdGFsayB0byBhbGwgdGhlIHVzZXJjbGllbnRzLCBkZXZpY2VzLCBtYWNoIHNlcnZpY2VzLCBzeXNjdGxzIGV0YyB0aGF0IHlvdSB3YW50IHRvLg0KDQoNClByb29mcyBvZiBDb25jZXB0Og0KaHR0cHM6Ly9naXRodWIuY29tL29mZmVuc2l2ZS1zZWN1cml0eS9leHBsb2l0LWRhdGFiYXNlLWJpbi1zcGxvaXRzL3Jhdy9tYXN0ZXIvc3Bsb2l0cy80MDkzMS56aXA=", 
    "filename": "platforms/multiple/local/40931.txt", 
    "id": "40931", 
    "cves": [
        "CVE-2016-7644", 
        "CVE-2016-7661", 
        "CVE-2016-7637"
    ]
}